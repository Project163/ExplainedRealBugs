diff --git a/java/common/src/main/java/org/apache/shindig/common/xml/XmlUtil.java b/java/common/src/main/java/org/apache/shindig/common/xml/XmlUtil.java
index 7171f418f..11403e8d6 100644
--- a/java/common/src/main/java/org/apache/shindig/common/xml/XmlUtil.java
+++ b/java/common/src/main/java/org/apache/shindig/common/xml/XmlUtil.java
@@ -194,15 +194,19 @@ public class XmlUtil {
    * or https URI.
    * @param node
    * @param attr
-   * @param def
-   * @return the parsed uri, or def if the attribute is not a valid http or
+   * @param base
+   *@param def  @return the parsed uri, or def if the attribute is not a valid http or
    * https URI.
    */
-  public static Uri getHttpUriAttribute(Node node, String attr, Uri def) {
+  public static Uri getHttpUriAttribute(Node node, String attr, Uri base, Uri def) {
     Uri uri = getUriAttribute(node, attr, def);
     if (uri == null) {
       return def;
     }
+    // resolve to base before checking
+    if (base != null) {
+      uri = base.resolve(uri);
+    }
     if (!"http".equalsIgnoreCase(uri.getScheme()) && !"https".equalsIgnoreCase(uri.getScheme())) {
       return def;
     }
@@ -213,11 +217,12 @@ public class XmlUtil {
    * Retrieves an attribute as a URI, and verifies that the URI is an http or https URI.
    * @param node
    * @param attr
+   * @param base
    * @return the parsed uri, or null if the attribute is not a valid http or
    * https URI.
    */
-  public static Uri getHttpUriAttribute(Node node, String attr) {
-    return getHttpUriAttribute(node, attr, null);
+  public static Uri getHttpUriAttribute(Node node, String attr, Uri base) {
+    return getHttpUriAttribute(node, attr, base, null);
   }
 
   /**
diff --git a/java/common/src/test/java/org/apache/shindig/common/xml/XmlUtilTest.java b/java/common/src/test/java/org/apache/shindig/common/xml/XmlUtilTest.java
index 0627cdb2a..ba1a6a539 100644
--- a/java/common/src/test/java/org/apache/shindig/common/xml/XmlUtilTest.java
+++ b/java/common/src/test/java/org/apache/shindig/common/xml/XmlUtilTest.java
@@ -106,9 +106,9 @@ public class XmlUtilTest {
 
   @Test
   public void testHttpUriAttribute() {
-    assertEquals(HTTPS_URI_VALUE, XmlUtil.getHttpUriAttribute(node, HTTPS_URI_ATTR));
-    assertNull(XmlUtil.getHttpUriAttribute(node, FTP_URI_ATTR));
-    assertEquals(HTTPS_URI_VALUE, XmlUtil.getHttpUriAttribute(node, FTP_URI_ATTR, HTTPS_URI_VALUE));
+    assertEquals(HTTPS_URI_VALUE, XmlUtil.getHttpUriAttribute(node, HTTPS_URI_ATTR, null));
+    assertNull(XmlUtil.getHttpUriAttribute(node, FTP_URI_ATTR, null));
+    assertEquals(HTTPS_URI_VALUE, XmlUtil.getHttpUriAttribute(node, FTP_URI_ATTR, null, HTTPS_URI_VALUE));
   }
 
   @Test(expected=XmlException.class)
