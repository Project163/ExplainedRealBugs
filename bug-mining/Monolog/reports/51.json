{"url":"https://api.github.com/repos/Seldaek/monolog/issues/663","repository_url":"https://api.github.com/repos/Seldaek/monolog","labels_url":"https://api.github.com/repos/Seldaek/monolog/issues/663/labels{/name}","comments_url":"https://api.github.com/repos/Seldaek/monolog/issues/663/comments","events_url":"https://api.github.com/repos/Seldaek/monolog/issues/663/events","html_url":"https://github.com/Seldaek/monolog/issues/663","id":109798386,"node_id":"MDU6SXNzdWUxMDk3OTgzODY=","number":663,"title":"WebProcessor constructor logic seems weird using with Cascade","user":{"login":"nonnenmacher","id":440919,"node_id":"MDQ6VXNlcjQ0MDkxOQ==","avatar_url":"https://avatars.githubusercontent.com/u/440919?v=4","gravatar_id":"","url":"https://api.github.com/users/nonnenmacher","html_url":"https://github.com/nonnenmacher","followers_url":"https://api.github.com/users/nonnenmacher/followers","following_url":"https://api.github.com/users/nonnenmacher/following{/other_user}","gists_url":"https://api.github.com/users/nonnenmacher/gists{/gist_id}","starred_url":"https://api.github.com/users/nonnenmacher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nonnenmacher/subscriptions","organizations_url":"https://api.github.com/users/nonnenmacher/orgs","repos_url":"https://api.github.com/users/nonnenmacher/repos","events_url":"https://api.github.com/users/nonnenmacher/events{/privacy}","received_events_url":"https://api.github.com/users/nonnenmacher/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":87833791,"node_id":"MDU6TGFiZWw4NzgzMzc5MQ==","url":"https://api.github.com/repos/Seldaek/monolog/labels/Feature","name":"Feature","color":"009800","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2015-10-05T13:41:04Z","updated_at":"2015-10-14T13:13:33Z","closed_at":"2015-10-14T13:09:20Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I'm trying to use Cascade to isolate my logger configuration in one spot.\n\nHowever, when trying pass `extraFields` (e.g X-FORWARD-FOR) from Cascade config\nto WebProcessor constructor seems to do the _reverse logic_ from what a standard human \ncan think of first !\n\nThe actual code _remove_ all matching _fieldname_ that is passed in the constructor argument array `$extraFields` from the _default_ member `$this->extraFields`\n\nIf I use a configuration entry like \n\n``````\n```\n  processors:\n  monolog.processor.web:\n     class: Monolog\\Processor\\WebProcessor\n     extra_fields:\n         url: REQUEST_URI\n         forwarded: REMOTE_ADDR\n```\n``````\n\nThe current code (at end of constructor) read as\n\n``` php\n        if (null !== $extraFields) {\n            foreach (array_keys($this->extraFields) as $fieldName) {\n                if (!in_array($fieldName, $extraFields)) {\n                    unset($this->extraFields[$fieldName]);\n                }\n            }\n        }\n```\n\nand end with the `url` entry removed from the `$this->extraFields` and no _added_ extra entry for `forwarded` stuffed into the record['extra'] when adorning the log entry.\n\nHowever with the following code modifications\n\n``` php\n      if (null !== $extraFields) {\n            foreach ($extraFields as $extraName => $serverName) {\n                if (!in_array($extraName, $this->extraFields)) {\n                    $this->addExtraField($extraName,$serverName);\n                }\n            }\n        }\n```\n\nEverything sound fine.\n\nNo extra field with same name and all provided `name` to `server var` is mapped properly.\n\nIs this is a bug or a feature that I do not use as intended ??\n","closed_by":{"login":"Seldaek","id":183678,"node_id":"MDQ6VXNlcjE4MzY3OA==","avatar_url":"https://avatars.githubusercontent.com/u/183678?v=4","gravatar_id":"","url":"https://api.github.com/users/Seldaek","html_url":"https://github.com/Seldaek","followers_url":"https://api.github.com/users/Seldaek/followers","following_url":"https://api.github.com/users/Seldaek/following{/other_user}","gists_url":"https://api.github.com/users/Seldaek/gists{/gist_id}","starred_url":"https://api.github.com/users/Seldaek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Seldaek/subscriptions","organizations_url":"https://api.github.com/users/Seldaek/orgs","repos_url":"https://api.github.com/users/Seldaek/repos","events_url":"https://api.github.com/users/Seldaek/events{/privacy}","received_events_url":"https://api.github.com/users/Seldaek/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Seldaek/monolog/issues/663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Seldaek/monolog/issues/663/timeline","performed_via_github_app":null,"state_reason":"completed"}