<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:53:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[STR-2971] one of validator.Resources.getActionMessage method does not respect message&apos;s &quot;bundle&quot; attribute</title>
                <link>https://issues.apache.org/jira/browse/STR-2971</link>
                <project id="12311043" key="STR">Struts 1</project>
                    <description>&lt;p&gt;I have a custom validator that uses the currently-loged-in user&apos;s date format preferences to validate date input. I use the following code to return error messages when there is a problem:&lt;/p&gt;

&lt;p&gt;    if(error)&lt;/p&gt;
    {
	    errors.add(field.getKey(),
		       Resources.getActionMessage(request, va, field));
	    return Boolean.FALSE;
    }

&lt;p&gt;The variables &apos;field&apos; (commons.validator.Field), &apos;request&apos;, (HttpServletRequest) and &apos;va&apos; (commons.validator.ValidatorAction) are all passed-in as parameters to this method, similar to other validateFoo(...) methods/classes.&lt;/p&gt;

&lt;p&gt;I recently separated my application resources (strings) into separate files based upon user role, to help manage the avalance of strings I had to deal with. I added a &quot;bundle&quot; attribute to my &amp;lt;msg&amp;gt; elements in my validation configuration file. This works for all of the stock validators, but not mine. I checked to see what the difference was between my code and the validators defined in struts.validator.FieldChecks, and they use this:&lt;/p&gt;

&lt;p&gt;            errors.add(field.getKey(),&lt;br/&gt;
                       Resources.getActionMessage(validator, request, va, field));&lt;/p&gt;

&lt;p&gt;Note the addition of that first parameter. I checked the code for these two different methods in the Resources class, and it appears that the latter will use the bundle attribute and get the appropriate message resource.&lt;/p&gt;

&lt;p&gt;I&apos;m happy to change my code to use this other method &amp;#8211; it&apos;s no sweat to make that change. But I was suprised to see that this particular variety of the getActionMessage method did not respect the bundle setting, and also did not document that behavior.&lt;/p&gt;

&lt;p&gt;The &quot;working&quot; method uses the ValidatorAction parameter (missing in the method in question) to get the ServletContext where the MessageResources objects can be located. Since the HttpServletRequest is available in the &quot;non-working&quot; method, I believe this can still be achieved.&lt;/p&gt;

&lt;p&gt;Perhaps this &quot;non-working&quot; method should be deprecated in favor of the second method? Or, is there some historical reason why it needs to exist, and exhibit this behavior?&lt;/p&gt;</description>
                <environment>Struts 1.2.9, commons-validator 1.1.4</environment>
        <key id="12450510">STR-2971</key>
            <summary>one of validator.Resources.getActionMessage method does not respect message&apos;s &quot;bundle&quot; attribute</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="niallp">Niall Pemberton</assignee>
                                    <reporter username="chris@christopherschultz.net">Christopher Schultz</reporter>
                        <labels>
                    </labels>
                <created>Wed, 8 Nov 2006 13:44:32 +0000</created>
                <updated>Wed, 4 Jul 2007 03:36:26 +0000</updated>
                            <resolved>Mon, 27 Nov 2006 04:30:13 +0000</resolved>
                                    <version>1.2.9</version>
                                    <fixVersion>1.3.6</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12817106" author="niallp" created="Thu, 9 Nov 2006 01:52:47 +0000"  >&lt;p&gt;History of this was that the flavour that works with bundles was added when bundle support was added. Can&apos;t actually remember why I introduced a new method, except that getting the ServletContext via the Session causes a session to be created if it doesn&apos;t already exist - the ServletContext in the Validator object is retrieved from the Servlet which is available in the ActionForm when the Validator object is initialized.&lt;/p&gt;

&lt;p&gt;I agree that the old method should have been deprecated, which I have now done&lt;/p&gt;

&lt;p&gt;   &lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=472736&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=472736&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Niall&lt;/p&gt;</comment>
                            <comment id="12814722" author="chris@christopherschultz.net" created="Thu, 9 Nov 2006 14:29:17 +0000"  >&lt;p&gt;Niall,&lt;br/&gt;
I would highly recommend adding documentation that mentions the fact that the now-deprecated method does not support bundles specified in &amp;lt;msg&amp;gt; elements. That gives the reader some indication of why it was deprecated, and why it is more appropriate to use the alternate method.&lt;/p&gt;

&lt;p&gt;-chris&lt;/p&gt;</comment>
                            <comment id="12817107" author="niallp" created="Thu, 9 Nov 2006 18:58:39 +0000"  >&lt;p&gt;OK, any chance of a patch with what you would like to see?&lt;/p&gt;</comment>
                            <comment id="12814798" author="chris@christopherschultz.net" created="Thu, 16 Nov 2006 13:51:31 +0000"  >&lt;p&gt;I don&apos;t have the struts source code, and I would just add method javadoc, so I&apos;ll just drop in this comment if you don&apos;t mind. How about something like this, added to the method javadoc:&lt;/p&gt;

&lt;p&gt;     *&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Note that this method does not respect any bundle information stored with the&lt;/li&gt;
	&lt;li&gt;field&apos;s &amp;lt;msg&amp;lt; elements, and so localization does not work properly. This method is&lt;/li&gt;
	&lt;li&gt;deprecated for this reason, and you should use&lt;/li&gt;
	&lt;li&gt;{@link #getActionMessage(Validator,HttpServletRequest,ValidatorAction,Field)}&lt;/li&gt;
	&lt;li&gt;instead.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Had I seen this comment in the Javadoc, I would have been able to solve this problem myself without playing around too much.&lt;/p&gt;

&lt;p&gt;If anyone objects to the deprecation of this method, we could always re-write it to properly work with the bundle. In the &quot;preferred&quot; method, the Validator argument is used for no other reason than to get the ServletContext. Since /this/ method has access to the request, the ServletContext can be obtained from there just as easily. Maybe there&apos;s a reason to prefer the one available from the Validator object, but it seems like it&apos;s the same thing to me.&lt;/p&gt;

&lt;p&gt;-chris&lt;/p&gt;</comment>
                            <comment id="12817119" author="jirareport" created="Thu, 16 Nov 2006 22:32:50 +0000"  >&lt;p&gt;While looking at the source I noticed that there is no getActionError(Validator, HttpServletRequest, ValidatorAction, Field) method; and that the getActionError method that is there does not support bundles. Should it?&lt;/p&gt;</comment>
                            <comment id="12817112" author="niallp" created="Sat, 18 Nov 2006 02:32:03 +0000"  >&lt;p&gt;Chris,&lt;br/&gt;
 I&apos;ve added a warning based on your suggestion - thanks:&lt;br/&gt;
        &lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=476419&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=476419&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Henri,&lt;br/&gt;
There is no getActionError() method at all in Struts 1.3.x - it was deprecated in Struts 1.2.x and remove in Struts 1.3.x. Support for alternatvie resource bundles was only added in Struts 1.3 and hasn&apos;t been back ported to 1.2 (which is why the Validator dependency in Struts 1.2.x was left at Validator 1.1.4)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34694</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 2 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0a9rb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>57854</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>