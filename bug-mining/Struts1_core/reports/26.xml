<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:53:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[STR-1674] Cancellation does not work as intended without form</title>
                <link>https://issues.apache.org/jira/browse/STR-1674</link>
                <project id="12311043" key="STR">Struts 1</project>
                    <description>&lt;p&gt;If the action mapping does not contain a form bean name, e.g.:&lt;/p&gt;

&lt;p&gt;&amp;lt;action path=&quot;/this/action&quot;&lt;br/&gt;
        type=&quot;action.class.name&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;using isCancelled() in that action will always return false.  The code in &lt;br/&gt;
org.apache.struts.action.RequestProcessor.processPopulate returns if the form &lt;br/&gt;
is null before setting the Globals.CANCEL_KEY attribute.  &lt;/p&gt;

&lt;p&gt;It seems to me that since a request parameter is used to detect the cancel &lt;br/&gt;
button (the return request.getParameter(Constants.CANCEL_KEY) != null line), &lt;br/&gt;
the setting of the request attribute should not depend on whether the action &lt;br/&gt;
mapping uses a form.&lt;/p&gt;</description>
                <environment>Operating System: All&lt;br/&gt;
Platform: All</environment>
        <key id="12447627">STR-1674</key>
            <summary>Cancellation does not work as intended without form</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pbenedict">Paul Benedict</assignee>
                                    <reporter username="patman_coda@yahoo.com">Patrick Dumontel</reporter>
                        <labels>
                    </labels>
                <created>Wed, 13 Aug 2003 00:49:56 +0000</created>
                <updated>Sat, 7 Jul 2007 15:05:03 +0000</updated>
                            <resolved>Sat, 7 Jul 2007 15:05:03 +0000</resolved>
                                    <version>1.1.0</version>
                                    <fixVersion>1.4.0</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12812353" author="sraeburn@apache.org" created="Sun, 31 Aug 2003 10:40:44 +0000"  >&lt;p&gt;The isCancelled() method uses a request &lt;b&gt;attribute&lt;/b&gt;, not a request parameter:&lt;br/&gt;
  return (request.getAttribute(Globals.CANCEL_KEY) != null);&lt;/p&gt;

&lt;p&gt;In any case, the purpose of the method is to detect whether the Cancel button on&lt;br/&gt;
a form has been pressed. Without a form, the method has no meaning.&lt;/p&gt;

&lt;p&gt;If you want to &quot;cancel&quot; an operation where you are not using a form, eg via a&lt;br/&gt;
link, then you can simply set the link target appropriately.&lt;/p&gt;</comment>
                            <comment id="12812378" author="jmikus@gmail.com" created="Wed, 8 Mar 2006 16:38:42 +0000"  >&lt;p&gt;Struts allows to submit a form with no corresponding ActionForm. This works&lt;br/&gt;
great, especially for dispatch-type actions. All events assigned to form&apos;s&lt;br/&gt;
buttons are properly delivered to handler methods. All but Cancel event,&lt;br/&gt;
cancelled method is not invoked.&lt;/p&gt;

&lt;p&gt;RequestProcessor.processPopulate method looks like this:&lt;/p&gt;


&lt;p&gt;    protected void processPopulate(...) {&lt;/p&gt;

&lt;p&gt;        if (form == null) &lt;/p&gt;
{
            return;
        }&lt;br/&gt;
&lt;br/&gt;
        form.setServlet(this.servlet);&lt;br/&gt;
        form.reset(mapping, request);&lt;br/&gt;
        &lt;br/&gt;
        if (mapping.getMultipartClass() != null) {
            request.setAttribute(Globals.MULTIPART_KEY,
                                 mapping.getMultipartClass());
        }&lt;br/&gt;
        &lt;br/&gt;
        RequestUtils.populate(form, mapping.getPrefix(), mapping.getSuffix(),&lt;br/&gt;
                              request);&lt;br/&gt;
&lt;br/&gt;
        if ((request.getParameter(Constants.CANCEL_PROPERTY) != null) ||&lt;br/&gt;
            (request.getParameter(Constants.CANCEL_PROPERTY_X) != null)) {
                
            request.setAttribute(Globals.CANCEL_KEY, Boolean.TRUE);
        }&lt;br/&gt;
    }&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
I suggest checking for cancel button first and return immediately if Cancel was&lt;br/&gt;
activated without populating a form:&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
    protected void processPopulate(...) {&lt;br/&gt;
&lt;br/&gt;
        if ((request.getParameter(Constants.CANCEL_PROPERTY) != null) ||&lt;br/&gt;
            (request.getParameter(Constants.CANCEL_PROPERTY_X) != null)) {
                
            request.setAttribute(Globals.CANCEL_KEY, Boolean.TRUE);
            return;
        }&lt;br/&gt;
&lt;br/&gt;
        if (form == null) {            return;        }

&lt;p&gt;        form.setServlet(this.servlet);&lt;br/&gt;
        form.reset(mapping, request);&lt;/p&gt;

&lt;p&gt;        if (mapping.getMultipartClass() != null) &lt;/p&gt;
{
            request.setAttribute(Globals.MULTIPART_KEY,
                                 mapping.getMultipartClass());
        }

&lt;p&gt;        RequestUtils.populate(form, mapping.getPrefix(), mapping.getSuffix(),&lt;br/&gt;
                              request);&lt;/p&gt;

&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;1. I have several forms with no ActionForm attached. Currently I have to define&lt;br/&gt;
a dummy form bean in the struts_config.xml file to make Cancel button work.&lt;br/&gt;
2. I can also send a Cancel event via link and I want to handle it in the&lt;br/&gt;
uniform manner, that is, in &quot;cancelled&quot; method.&lt;br/&gt;
3. Another improvement from this change is that form is not populated if user&lt;br/&gt;
activated Cancel button.&lt;/p&gt;</comment>
                            <comment id="12812605" author="paul4christ79@yahoo.com" created="Thu, 9 Mar 2006 10:17:40 +0000"  >&lt;p&gt;I take interest in this issue. I have to admit, I do see merit in the argument&lt;br/&gt;
that isCancelled() is not working propertly when a form is unavailable. It is&lt;br/&gt;
perfectly legit in Struts to work with formless actions, and there is no&lt;br/&gt;
documentation stating that isCancelled() is tied to a form. I furthermore&lt;br/&gt;
disagree with Steve in comment #1 because people do not usually capture buttons&lt;br/&gt;
in their forms. But in regards to comment #3, cancelling a formless action in&lt;br/&gt;
Struts 1.2.9+ requires having the cancellable flag set to true. I point that out&lt;br/&gt;
to verify your thinking is thorough?&lt;/p&gt;

&lt;p&gt;If I can get a third agreeing opinion, I vote to move up the cancellation&lt;br/&gt;
handling and setting it. &lt;/p&gt;</comment>
                            <comment id="12812272" author="jmikus@gmail.com" created="Thu, 9 Mar 2006 10:37:55 +0000"  >&lt;p&gt;(In reply to comment #3)&lt;br/&gt;
&amp;gt; But in regards to comment #2, cancelling a formless action in&lt;br/&gt;
&amp;gt; Struts 1.2.9+ requires having the cancellable flag set to true. I point that out&lt;br/&gt;
&amp;gt; to verify your thinking is thorough?&lt;/p&gt;

&lt;p&gt;Paul, could you rephrase your remark, please? I suggest to set Cancel flag if&lt;br/&gt;
Cancel button is activated, whether form is present or not. I guess I am missing&lt;br/&gt;
something in regards to 1.2.9&lt;/p&gt;</comment>
                            <comment id="12812562" author="paul4christ79@yahoo.com" created="Thu, 9 Mar 2006 10:45:36 +0000"  >&lt;p&gt;Comment #4: I suggest to set Cancel flag if Cancel button is activated, whether&lt;br/&gt;
form is present or not.&lt;/p&gt;

&lt;p&gt;I understand this, and I am additionally pointing out the that &lt;a href=&quot;https://issues.apache.org/jira/browse/STR-2742&quot; title=&quot;Validation always skipped with Globals.CANCEL_KEY&quot; class=&quot;issue-link&quot; data-issue-key=&quot;STR-2742&quot;&gt;&lt;del&gt;STR-2742&lt;/del&gt;&lt;/a&gt; is&lt;br/&gt;
being resolved in 1.2.9, which prevents the cancel key from always being&lt;br/&gt;
accepted. Just to make sure everything is thought out, you know you&apos;ll have to&lt;br/&gt;
(when you upgrade) have the cancellable=&quot;true&quot; property set in the action&lt;br/&gt;
mappings, right?&lt;/p&gt;</comment>
                            <comment id="12816351" author="niallp" created="Fri, 10 Mar 2006 12:59:19 +0000"  >&lt;p&gt;Paul&apos;s point is a good one - the changes made to how &quot;cancel&quot; is handled for &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/STR-2742&quot; title=&quot;Validation always skipped with Globals.CANCEL_KEY&quot; class=&quot;issue-link&quot; data-issue-key=&quot;STR-2742&quot;&gt;&lt;del&gt;STR-2742&lt;/del&gt;&lt;/a&gt; need to be considered when deciding on what action to take here.&lt;/p&gt;

&lt;p&gt;Having said that I don&apos;t object to Michaels suggestion - the &quot;cancelleable&quot; &lt;br/&gt;
feature only applies when struts handles validation - which requires an &lt;br/&gt;
ActionForm and validate set to true - otherwise its ignored.&lt;/p&gt;

&lt;p&gt;Perhaps the way to ensure everyone is kept happy is to implement this for the &lt;br/&gt;
ComposableRequestProcessor in Struts 1.3 by factoring it out into a separate &lt;br/&gt;
Command. That way anyone not liking the default behaviour can easily change it.&lt;/p&gt;

&lt;p&gt;Anyone wanting this in the original RequestProcessor could easily implement it &lt;br/&gt;
either by having a custom RequestProcessor - or have a &quot;base&quot; Action that &lt;br/&gt;
actually checks the request parameters in isCancelled(). i.e...&lt;/p&gt;

&lt;p&gt;protected boolean isCancelled(HttpServletRequest request) {&lt;br/&gt;
    if ((request.getParameter(Constants.CANCEL_PROPERTY) != null) ||&lt;br/&gt;
       (request.getParameter(Constants.CANCEL_PROPERTY_X) != null)) &lt;/p&gt;
{
        return true;
    }
&lt;p&gt; else &lt;/p&gt;
{
        return false;
    }
&lt;p&gt;}&lt;/p&gt;</comment>
                            <comment id="12808338" author="pbenedict" created="Mon, 2 Jul 2007 03:25:51 +0000"  >&lt;p&gt;I am on board with Michael and Niall. The cancel attribute should be the first thing checked, and skip population if it is canceled. Aside the fact that this enhancement is sound, I&apos;ve seen many people on the boards who are always trying to retain the form&apos;s original data on cancellation. This would be a great change of behavior.&lt;/p&gt;</comment>
                            <comment id="12808331" author="pbenedict" created="Mon, 2 Jul 2007 04:00:22 +0000"  >&lt;p&gt;Preventing form population on cancellation will promote safety for developers. Because the validator does not run for the use case, any data Struts captures cannot be guaranteed and yet a sloppy developer may miss this oversight. &lt;/p&gt;</comment>
                            <comment id="12808505" author="pbenedict" created="Sat, 7 Jul 2007 03:32:55 +0000"  >&lt;p&gt;See &lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/struts-dev/200707.mbox/%3c55afdc850707052022o273e7ec3u9775e1e3fb9bb831@mail.gmail.com%3e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mail-archives.apache.org/mod_mbox/struts-dev/200707.mbox/%3c55afdc850707052022o273e7ec3u9775e1e3fb9bb831@mail.gmail.com%3e&lt;/a&gt; on concerns and alternative solutions.&lt;/p&gt;</comment>
                            <comment id="12808482" author="pbenedict" created="Sat, 7 Jul 2007 05:03:30 +0000"  >&lt;p&gt;I am attaching my proposal for the change based on Niall&apos;s feedback, plus some other enhancements.&lt;/p&gt;

&lt;p&gt;First, I have pushed isReset and isPopulate into the abstract class because ActionConfig has &quot;reset&quot; and &quot;populate&quot; properties. These properties are Struts-proper and should have identical effect for any servlet or portlet or other implementation. Otherwise the conditional would have to be included in every subclass.&lt;/p&gt;

&lt;p&gt;Second, I have added an &quot;populateOnCancel&quot; property to the command that is configured for the entire app. It&apos;s an optional property which allows the form to be not populated if cancellation occurs. However, I find myself not liking this implementation and don&apos;t know how to resolve it. It is not clear when this property applies. Right now, it can apply if reset/populate are correct for the action, and then the cancellation property is checked.&lt;/p&gt;

&lt;p&gt;Third, I have a difficult time accepting that setting the MULTIPART_KEY into the request scope belongs in reset(). Since it&apos;s relied upon in populate(), I believe the proper place is in the latter method. If reset() is not called, but populate() is, the key should still be set.&lt;/p&gt;

&lt;p&gt;Opinions regarded necessary &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12808473" author="pbenedict" created="Sat, 7 Jul 2007 15:05:03 +0000"  >&lt;p&gt;I have limited this change to the original suggestion: unconditionally detecting when the action is canceled. For determining whether cancellation should prevent form population, I have opened up &lt;a href=&quot;https://issues.apache.org/jira/browse/STR-3066&quot; title=&quot;Cancellation to prevent form population&quot; class=&quot;issue-link&quot; data-issue-key=&quot;STR-3066&quot;&gt;STR-3066&lt;/a&gt; for discussion.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22357</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>182893</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 21 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0dvdj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79012</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>