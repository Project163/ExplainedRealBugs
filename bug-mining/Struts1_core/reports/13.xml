<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:53:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[STR-2925] Seemingly random message resources in another language</title>
                <link>https://issues.apache.org/jira/browse/STR-2925</link>
                <project id="12311043" key="STR">Struts 1</project>
                    <description>&lt;p&gt;Suppose you have two properties files:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ApplicationResources_de.properties (German)&lt;/li&gt;
	&lt;li&gt;ApplicationResources.properties (English, default)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Both contain a key named &quot;street&quot;.&lt;/p&gt;

&lt;p&gt;The JVM&apos;s default locale is de_DE (German, Germany).&lt;/p&gt;

&lt;p&gt;Now you access the struts application with a browser which is set to accept de_DE.&lt;/p&gt;

&lt;p&gt;The class PropertyMessageResources is trying to get this key from a properties file with the extension &quot;de_DE&quot; and doesn&apos;t find one. Then it searches for a properties file with the extension &quot;de&quot; and finds one. In this process the key &quot;de.street&quot; is created internally. Additionally the value is &quot;cached&quot; under the key &quot;de_DE.street&quot; in case the user will access it again.&lt;/p&gt;

&lt;p&gt;Now suppose that another user with a browser set to accept en_US accesses the application after this first user.&lt;/p&gt;

&lt;p&gt;What happens is that the class PropertyMessageResources first tries &quot;en_US&quot; extension, then &quot;en&quot; extension and finds nothing. In the next step the default locale of the JVM is tried, which in this case is &quot;de_DE&quot;. No properties file is loaded as there is none, but the &quot;cached&quot; key &quot;de_DE.street&quot; is used, which is NOT correct. This leads to seemingly random labels in another language as other keys, which haven&apos;t been accessed with the default locale earlier, may not have been &quot;cached&quot; in this way and are taken from the properties file without any extension (and are therefore correctly in English).&lt;/p&gt;

&lt;p&gt;Further investigation of the matter yields the following results:&lt;br/&gt;
o JSTL (Apache implementation) tries all variants of the requested locale and then the one without any extensions (en_US -&amp;gt; en -&amp;gt; none)&lt;br/&gt;
o Java (ResourceBundle) tries all variants of the requested locale, all variants of the default locale and then the one without any extensions (en_US -&amp;gt; en -&amp;gt; de_DE -&amp;gt; de -&amp;gt; none)&lt;br/&gt;
o Struts tries all variants of the requested locale, the full default locale and then the one without any extension (en_US -&amp;gt; en -&amp;gt; de_DE -&amp;gt; none) (and &quot;caches&quot; the value in a way that creates the aformentioned bug)&lt;/p&gt;

&lt;p&gt;I agree with &lt;a href=&quot;https://issues.apache.org/jira/browse/STR-2077&quot; title=&quot;PropertyMessageResources behaviour different from PropertyResourceBundle&quot; class=&quot;issue-link&quot; data-issue-key=&quot;STR-2077&quot;&gt;&lt;del&gt;STR-2077&lt;/del&gt;&lt;/a&gt; that this deviation from the Java standard creates confusion and I think that the easiest way of solving the two problems would be to use the standard ResourceBundle mechanism as suggested in &lt;a href=&quot;https://issues.apache.org/jira/browse/STR-1340&quot; title=&quot;Loading language files does not use Resource Bundle&quot; class=&quot;issue-link&quot; data-issue-key=&quot;STR-1340&quot;&gt;STR-1340&lt;/a&gt;. An even easier solution would be for Struts to ignore the default language of the JVM and thus make it react like JSTL (which is very desirable anyway as many of us use JSTL and Struts-EL in combination).&lt;/p&gt;

&lt;p&gt;The problem can be avoided by setting the default locale of the JVM to the language of the default properties file.&lt;/p&gt;</description>
                <environment>Struts 1.2.9</environment>
        <key id="12450495">STR-2925</key>
            <summary>Seemingly random message resources in another language</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="niallp">Niall Pemberton</assignee>
                                    <reporter username="rrodewald">Robert Rodewald</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Aug 2006 14:05:19 +0000</created>
                <updated>Wed, 4 Jul 2007 03:36:23 +0000</updated>
                            <resolved>Wed, 29 Nov 2006 12:24:01 +0000</resolved>
                                                    <fixVersion>1.3.6</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12817128" author="niallp" created="Wed, 29 Nov 2006 12:24:01 +0000"  >&lt;p&gt;I have added a &quot;compatibility mode&quot; configuration option to PropertyMessageResources. It can now be configured to operate in one of three modes:&lt;/p&gt;

&lt;p&gt;1) &quot;Default&quot; mode - default, backwardly compatible, Struts behaviour (i.e. the way its always worked).&lt;br/&gt;
2) &quot;JSTL&quot; mode - compatible with how JSTL finds messages (fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/STR-2925&quot; title=&quot;Seemingly random message resources in another language&quot; class=&quot;issue-link&quot; data-issue-key=&quot;STR-2925&quot;&gt;&lt;del&gt;STR-2925&lt;/del&gt;&lt;/a&gt;)&lt;br/&gt;
3) &quot;Resource&quot; mode - compatible with how Java&apos;s &amp;lt;code&amp;gt;PropertyResourceBundle&amp;lt;/code&amp;gt;  finds messages (fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/STR-2077&quot; title=&quot;PropertyMessageResources behaviour different from PropertyResourceBundle&quot; class=&quot;issue-link&quot; data-issue-key=&quot;STR-2077&quot;&gt;&lt;del&gt;STR-2077&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;To configure for &quot;JSTL&quot; mode:&lt;/p&gt;

&lt;p&gt;    &amp;lt;message-resources parameter=&quot;mypackage.MyMessageResources&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;set-property key=&quot;mode&quot; value=&quot;JSTL&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;message-resources&amp;gt;&lt;/p&gt;

&lt;p&gt;To configure for &quot;Resource&quot; mode:&lt;/p&gt;

&lt;p&gt;    &amp;lt;message-resources parameter=&quot;mypackage.MyMessageResources&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;set-property key=&quot;mode&quot; value=&quot;resource&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;message-resources&amp;gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=480549&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=480549&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12450048">STR-2923</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34739</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0aa1b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>57899</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>