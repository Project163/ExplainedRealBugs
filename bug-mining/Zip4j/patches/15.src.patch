diff --git a/src/main/java/net/lingala/zip4j/io/outputstream/CompressedOutputStream.java b/src/main/java/net/lingala/zip4j/io/outputstream/CompressedOutputStream.java
index b5f06e0..294fc44 100644
--- a/src/main/java/net/lingala/zip4j/io/outputstream/CompressedOutputStream.java
+++ b/src/main/java/net/lingala/zip4j/io/outputstream/CompressedOutputStream.java
@@ -26,10 +26,6 @@ abstract class CompressedOutputStream extends OutputStream {
     cipherOutputStream.write(b, off, len);
   }
 
-  protected void decrementBytesWrittenForThisEntry(int value) {
-    cipherOutputStream.decrementBytesWrittenForThisEntry(value);
-  }
-
   protected void closeEntry() throws IOException {
     cipherOutputStream.closeEntry();
   }
diff --git a/src/main/java/net/lingala/zip4j/io/outputstream/DeflaterOutputStream.java b/src/main/java/net/lingala/zip4j/io/outputstream/DeflaterOutputStream.java
index f0efbff..8141b64 100755
--- a/src/main/java/net/lingala/zip4j/io/outputstream/DeflaterOutputStream.java
+++ b/src/main/java/net/lingala/zip4j/io/outputstream/DeflaterOutputStream.java
@@ -27,13 +27,10 @@ class DeflaterOutputStream extends CompressedOutputStream {
 
   private byte[] buff = new byte[BUFF_SIZE];
   protected Deflater deflater;
-  private boolean firstBytesRead;
 
   public DeflaterOutputStream(CipherOutputStream cipherOutputStream, CompressionLevel compressionLevel) {
     super(cipherOutputStream);
-    deflater = new Deflater();
-    deflater.setLevel(compressionLevel.getLevel());
-    firstBytesRead = false;
+    deflater = new Deflater(compressionLevel.getLevel(), true);
   }
 
   public void write(byte[] b) throws IOException {
@@ -56,20 +53,7 @@ class DeflaterOutputStream extends CompressedOutputStream {
   private void deflate() throws IOException {
     int len = deflater.deflate(buff, 0, buff.length);
     if (len > 0) {
-      if (deflater.finished()) {
-        if (len == 4) return;
-        if (len < 4) {
-          decrementBytesWrittenForThisEntry(4 - len);
-          return;
-        }
-        len -= 4;
-      }
-      if (!firstBytesRead) {
-        super.write(buff, 2, len - 2);
-        firstBytesRead = true;
-      } else {
-        super.write(buff, 0, len);
-      }
+      super.write(buff, 0, len);
     }
   }
 
@@ -80,7 +64,6 @@ class DeflaterOutputStream extends CompressedOutputStream {
         deflate();
       }
     }
-    firstBytesRead = false;
     deflater.end();
     super.closeEntry();
   }
diff --git a/src/test/java/net/lingala/zip4j/AddFilesToZipIT.java b/src/test/java/net/lingala/zip4j/AddFilesToZipIT.java
index 9a7aa83..9a4dc8d 100644
--- a/src/test/java/net/lingala/zip4j/AddFilesToZipIT.java
+++ b/src/test/java/net/lingala/zip4j/AddFilesToZipIT.java
@@ -195,6 +195,19 @@ public class AddFilesToZipIT extends AbstractIT {
         EncryptionMethod.AES, AesKeyStrength.KEY_STRENGTH_256);
   }
 
+  @Test
+  public void testAddFileWithAfterDeflateRemainingBytesTestFile() throws IOException {
+    ZipParameters zipParameters = createZipParameters(EncryptionMethod.AES, AesKeyStrength.KEY_STRENGTH_256);
+    zipParameters.setAesVersion(AesVersion.TWO);
+    ZipFile zipFile = new ZipFile(generatedZipFile, PASSWORD);
+
+    zipFile.addFile(TestUtils.getTestFileFromResources("after_deflate_remaining_bytes.bin"), zipParameters);
+
+    ZipFileVerifier.verifyZipFileByExtractingAllFiles(generatedZipFile, PASSWORD, outputFolder, 1);
+    verifyZipFileContainsFiles(generatedZipFile, singletonList("after_deflate_remaining_bytes.bin"),
+        CompressionMethod.DEFLATE, EncryptionMethod.AES, AesKeyStrength.KEY_STRENGTH_256);
+  }
+
   @Test
   public void testAddFileProgressMonitorThrowsExceptionWhenPerformingActionInBusyState() throws ZipException {
     expectedException.expectMessage("invalid operation - Zip4j is in busy state");
diff --git a/src/test/resources/test-files/after_deflate_remaining_bytes.bin b/src/test/resources/test-files/after_deflate_remaining_bytes.bin
new file mode 100755
index 0000000..f136e0c
Binary files /dev/null and b/src/test/resources/test-files/after_deflate_remaining_bytes.bin differ
