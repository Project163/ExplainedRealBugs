diff --git a/src/main/java/net/lingala/zip4j/tasks/AbstractExtractFileTask.java b/src/main/java/net/lingala/zip4j/tasks/AbstractExtractFileTask.java
index 58d92df..a061da8 100644
--- a/src/main/java/net/lingala/zip4j/tasks/AbstractExtractFileTask.java
+++ b/src/main/java/net/lingala/zip4j/tasks/AbstractExtractFileTask.java
@@ -39,7 +39,8 @@ public abstract class AbstractExtractFileTask<T> extends AsyncZipTask<T> {
     progressMonitor.setFileName(outputFile.getAbsolutePath());
 
     // make sure no file is extracted outside of the target directory (a.k.a zip slip)
-    if (!outputFile.getCanonicalPath().startsWith(new File(outputPath).getCanonicalPath())) {
+    String outputCanonicalPath = (new File(outputPath).getCanonicalPath()) + File.separator;
+    if (!outputFile.getCanonicalPath().startsWith(outputCanonicalPath)) {
       throw new ZipException("illegal file name that breaks out of the target directory: "
           + fileHeader.getFileName());
     }
diff --git a/src/test/java/net/lingala/zip4j/MiscZipFileIT.java b/src/test/java/net/lingala/zip4j/MiscZipFileIT.java
index 82f064b..ee4206a 100644
--- a/src/test/java/net/lingala/zip4j/MiscZipFileIT.java
+++ b/src/test/java/net/lingala/zip4j/MiscZipFileIT.java
@@ -435,6 +435,21 @@ public class MiscZipFileIT extends AbstractIT {
     }
   }
 
+  @Test
+  public void testZipSlipFixWithFileNameStartingWithParentDirectoryThrowsException() throws ZipException {
+    ZipFile zipFile = new ZipFile(generatedZipFile);
+    ZipParameters zipParameters = new ZipParameters();
+    zipParameters.setFileNameInZip("../somename.pdf");
+    zipFile.addFile(FILES_TO_ADD.get(0), zipParameters);
+
+    expectedException.expectMessage("illegal file name that breaks out of the target directory");
+    expectedException.expect(ZipException.class);
+
+    // Important here is that the name of the file in zip ("somename.pdf") should start with the
+    // name of the directory being extracted to ("some"). "somename.pdf" starts with "some".
+    zipFile.extractAll(outputFolder.getPath() + File.separator + "some");
+  }
+
   @Test
   public void testUnzipFileZipSlipWithNotNormalizedTarget() throws IOException {
     ZipFile zipFile = new ZipFile(generatedZipFile, PASSWORD);
