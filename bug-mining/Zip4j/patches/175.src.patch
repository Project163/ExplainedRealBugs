diff --git a/src/main/java/net/lingala/zip4j/headers/HeaderReader.java b/src/main/java/net/lingala/zip4j/headers/HeaderReader.java
index 63292ee..7b458af 100755
--- a/src/main/java/net/lingala/zip4j/headers/HeaderReader.java
+++ b/src/main/java/net/lingala/zip4j/headers/HeaderReader.java
@@ -650,7 +650,8 @@ public class HeaderReader {
 
       if (extraDataRecord.getHeader() == HeaderSignature.AES_EXTRA_DATA_RECORD.getValue()) {
 
-        if (extraDataRecord.getData() == null) {
+        byte[] aesExtraDataRecordBytes = extraDataRecord.getData();
+        if (aesExtraDataRecordBytes == null || aesExtraDataRecordBytes.length != 9) {
           throw new ZipException("corrupt AES extra data records");
         }
 
diff --git a/src/test/java/net/lingala/zip4j/io/inputstream/ZipInputStreamIT.java b/src/test/java/net/lingala/zip4j/io/inputstream/ZipInputStreamIT.java
index 4870d60..b36f8d0 100644
--- a/src/test/java/net/lingala/zip4j/io/inputstream/ZipInputStreamIT.java
+++ b/src/test/java/net/lingala/zip4j/io/inputstream/ZipInputStreamIT.java
@@ -319,6 +319,15 @@ public class ZipInputStreamIT extends AbstractIT {
         null, InternalZipConstants.BUFF_SIZE, false, 1);
   }
 
+  @Test
+  public void testExtractZipFileWithInvalidAesExtraDataRecordThrowsException() throws IOException {
+    expectedException.expect(ZipException.class);
+    expectedException.expectMessage("corrupt AES extra data records");
+
+    extractZipFileWithInputStreams(TestUtils.getTestArchiveFromResources("invalid_aes_extra_data_record_length_in_header"),
+        null, InternalZipConstants.BUFF_SIZE, false, 1);
+  }
+
   private void extractZipFileWithInputStreams(File zipFile, char[] password) throws IOException {
     extractZipFileWithInputStreams(zipFile, password, InternalZipConstants.BUFF_SIZE);
   }
diff --git a/src/test/resources/test-archives/invalid_aes_extra_data_record_length_in_header b/src/test/resources/test-archives/invalid_aes_extra_data_record_length_in_header
new file mode 100644
index 0000000..00c5959
Binary files /dev/null and b/src/test/resources/test-archives/invalid_aes_extra_data_record_length_in_header differ
