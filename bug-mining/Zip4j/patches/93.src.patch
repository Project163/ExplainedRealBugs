diff --git a/src/main/java/net/lingala/zip4j/io/inputstream/ZipInputStream.java b/src/main/java/net/lingala/zip4j/io/inputstream/ZipInputStream.java
index 9e8c27f..314c858 100755
--- a/src/main/java/net/lingala/zip4j/io/inputstream/ZipInputStream.java
+++ b/src/main/java/net/lingala/zip4j/io/inputstream/ZipInputStream.java
@@ -93,17 +93,7 @@ public class ZipInputStream extends InputStream {
 
     if (fileHeader != null) {
       localFileHeader.setCrc(fileHeader.getCrc());
-
-      // In case of jar files, directories' compressed size in file header is 2 and local file header is 0.
-      // The actual value of compressed size in file header should be 0.
-      // This is a workaround to ignore the comprressed size from file header if directory and is deflate and
-      // compressed sizes does not match
-      if (!(fileHeader.isDirectory()
-          && fileHeader.getCompressionMethod().equals(CompressionMethod.DEFLATE)
-          && fileHeader.getCompressedSize() != localFileHeader.getCompressedSize())) {
-        localFileHeader.setCompressedSize(fileHeader.getCompressedSize());
-      }
-
+      localFileHeader.setCompressedSize(fileHeader.getCompressedSize());
       localFileHeader.setUncompressedSize(fileHeader.getUncompressedSize());
       canSkipExtendedLocalFileHeader = true;
     } else {
@@ -310,7 +300,7 @@ public class ZipInputStream extends InputStream {
   }
 
   private void readUntilEndOfEntry() throws IOException {
-    if (localFileHeader.getCompressedSize() == 0) {
+    if (localFileHeader.isDirectory() || localFileHeader.getCompressedSize() == 0) {
       return;
     }
 
diff --git a/src/test/java/net/lingala/zip4j/ExtractZipFileIT.java b/src/test/java/net/lingala/zip4j/ExtractZipFileIT.java
index 40e8e54..6e150ff 100644
--- a/src/test/java/net/lingala/zip4j/ExtractZipFileIT.java
+++ b/src/test/java/net/lingala/zip4j/ExtractZipFileIT.java
@@ -476,9 +476,13 @@ public class ExtractZipFileIT extends AbstractIT {
   }
 
   @Test
-  public void testExtractJarFile() throws IOException {
-    ZipFile zipFile = new ZipFile(TestUtils.getTestArchiveFromResources("zip4j-for-testing.jar"));
-    zipFile.extractAll(outputFolder.getPath());
+  public void testExtractJarFileWithFileHeaderCompressedSize2() throws IOException {
+    extractFile(TestUtils.getTestArchiveFromResources("jar-dir-fh-entry-size-2.jar"));
+  }
+
+  @Test
+  public void testExtractJarFileWithOnlyFileAndLocalFileHeaderCompressedSize2() throws IOException {
+    extractFile(TestUtils.getTestArchiveFromResources("jar-dir-lfh-and-fh-entry-size-2.jar"));
   }
 
   private void addFileToZip(ZipFile zipFile, String fileName, EncryptionMethod encryptionMethod, String password) throws ZipException {
@@ -556,7 +560,9 @@ public class ExtractZipFileIT extends AbstractIT {
     return file.get();
   }
 
-  private File createZipFileAndSplit(List<File> filesToAddToZip, long splitLength, boolean encrypt, EncryptionMethod encryptionMethod) throws IOException {
+  private File createZipFileAndSplit(List<File> filesToAddToZip, long splitLength, boolean encrypt,
+                                     EncryptionMethod encryptionMethod) throws IOException {
+
     ZipFile zipFile = new ZipFile(generatedZipFile, PASSWORD);
     ZipParameters zipParameters = new ZipParameters();
     zipParameters.setEncryptFiles(encrypt);
@@ -566,4 +572,8 @@ public class ExtractZipFileIT extends AbstractIT {
     return TestUtils.splitFileWith7ZipFormat(zipFile.getFile(), temporaryFolder.getRoot(), splitLength);
   }
 
+  private void extractFile(File fileToExtract) throws IOException {
+    ZipFile zipFile = new ZipFile(fileToExtract);
+    zipFile.extractAll(outputFolder.getPath());
+  }
 }
diff --git a/src/test/java/net/lingala/zip4j/io/inputstream/ZipInputStreamIT.java b/src/test/java/net/lingala/zip4j/io/inputstream/ZipInputStreamIT.java
index 8f948b5..d24bd42 100644
--- a/src/test/java/net/lingala/zip4j/io/inputstream/ZipInputStreamIT.java
+++ b/src/test/java/net/lingala/zip4j/io/inputstream/ZipInputStreamIT.java
@@ -191,7 +191,7 @@ public class ZipInputStreamIT extends AbstractIT {
   @Test
   public void testExtractJarFile() throws IOException {
     byte[] b = new byte[4096];
-    File jarFile = getTestArchiveFromResources("zip4j-for-testing.jar");
+    File jarFile = getTestArchiveFromResources("jar-dir-fh-entry-size-2.jar");
     try (ZipInputStream zipInputStream = new ZipInputStream(new FileInputStream(jarFile))) {
       while (zipInputStream.getNextEntry() != null) {
         zipInputStream.read(b);
diff --git a/src/test/resources/test-archives/zip4j-for-testing.jar b/src/test/resources/test-archives/jar-dir-fh-entry-size-2.jar
similarity index 100%
rename from src/test/resources/test-archives/zip4j-for-testing.jar
rename to src/test/resources/test-archives/jar-dir-fh-entry-size-2.jar
diff --git a/src/test/resources/test-archives/jar-dir-lfh-and-fh-entry-size-2.jar b/src/test/resources/test-archives/jar-dir-lfh-and-fh-entry-size-2.jar
new file mode 100644
index 0000000..46c5bf7
Binary files /dev/null and b/src/test/resources/test-archives/jar-dir-lfh-and-fh-entry-size-2.jar differ
