{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/370","repository_url":"https://api.github.com/repos/srikanth-lingala/zip4j","labels_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/370/labels{/name}","comments_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/370/comments","events_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/370/events","html_url":"https://github.com/srikanth-lingala/zip4j/issues/370","id":1034443036,"node_id":"I_kwDOCwUnhM49qFkc","number":370,"title":"java.lang.IllegalArgumentException in `net.lingala.zip4j.model.enums.AesVersion.getFromVersionNumber::AesVersion.java:42` zip4j 2.9.0","user":{"login":"ZanderHuang","id":18213663,"node_id":"MDQ6VXNlcjE4MjEzNjYz","avatar_url":"https://avatars.githubusercontent.com/u/18213663?v=4","gravatar_id":"","url":"https://api.github.com/users/ZanderHuang","html_url":"https://github.com/ZanderHuang","followers_url":"https://api.github.com/users/ZanderHuang/followers","following_url":"https://api.github.com/users/ZanderHuang/following{/other_user}","gists_url":"https://api.github.com/users/ZanderHuang/gists{/gist_id}","starred_url":"https://api.github.com/users/ZanderHuang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ZanderHuang/subscriptions","organizations_url":"https://api.github.com/users/ZanderHuang/orgs","repos_url":"https://api.github.com/users/ZanderHuang/repos","events_url":"https://api.github.com/users/ZanderHuang/events{/privacy}","received_events_url":"https://api.github.com/users/ZanderHuang/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1623761937,"node_id":"MDU6TGFiZWwxNjIzNzYxOTM3","url":"https://api.github.com/repos/srikanth-lingala/zip4j/labels/resolved","name":"resolved","color":"b8dd11","default":false,"description":""},{"id":1973950881,"node_id":"MDU6TGFiZWwxOTczOTUwODgx","url":"https://api.github.com/repos/srikanth-lingala/zip4j/labels/improvement","name":"improvement","color":"f2aeb5","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":1,"created_at":"2021-10-24T15:22:46Z","updated_at":"2022-03-28T15:17:31Z","closed_at":"2022-03-28T15:17:31Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"This vulnerability is of java.lang.IllegalArgumentException, and can be triggered in latest version zip4j (2.9.0).\r\nIt is caused by passing an illegal or inappropriate argument into a method. and can be used for attackers to launch DoS (Denial of Service) attack for any java program that uses this library (since the user of zip4j doesn't know they need to catch this kind of exception) ( CWE-248: Uncaught exception).\r\nLikely, the root cause of this crash is in `net.lingala.zip4j.model.enums.AesVersion.getFromVersionNumber::AesVersion.java:42`.\r\n\r\nThis exception function is indirectly being called by other functions and this exception is not documented under these functions. Users are not aware of it when the documentation is only done in the exception function alone. https://github.com/srikanth-lingala/zip4j/blob/ce1cff61c019d61f5db603cba908118a3a0e3b93/src/main/java/net/lingala/zip4j/model/enums/AesVersion.java#L42\r\n\r\nSee more detail from the following crash stack.\r\n\r\n# Crash stack:\r\nThe crash thread's stack is as follows:\r\n\r\n```\r\nnet.lingala.zip4j.model.enums.AesVersion.getFromVersionNumber::AesVersion.java:42\r\nnet.lingala.zip4j.headers.HeaderReader.readAesExtraDataRecord::HeaderReader.java:673\r\nnet.lingala.zip4j.headers.HeaderReader.readAesExtraDataRecord::HeaderReader.java:642\r\nnet.lingala.zip4j.headers.HeaderReader.readLocalFileHeader::HeaderReader.java:576\r\nnet.lingala.zip4j.io.inputstream.ZipInputStream.getNextEntry::ZipInputStream.java:91\r\nnet.lingala.zip4j.io.inputstream.ZipInputStream.getNextEntry::ZipInputStream.java:83\r\ncom.test.Entry.main::Entry.java:37\r\n```\r\n\r\n\r\n# Steps to reproduce: \r\n\r\n1. Build the following java code with the corresponding zip4j library (version 2.9.0).\r\n\r\n```\r\n## Download zip4j_env_reproduce.tar.gz from https://drive.google.com/file/d/1MekCBIghKxIW4j-TLjZkm8ovvLb_grm5/view?usp=sharing\r\ntar -xf zip4j_env_reproduce.tar.gz\r\ncd zip4j_env_reproduce\r\nbash build.sh\r\n```\r\n\r\n2. Run the built program to see the crash by feeding one of the poc file contained in the pocs.tar.gz, e.g. :\r\n(poc file can be downloaded from https://drive.google.com/file/d/1zmf8t4ymGTDkR4TMlnmagAMEYr7aI_a4/view?usp=sharing)\r\n```\r\njava -jar target/Entry-1.0-SNAPSHOT-jar-with-dependencies.jar pocs/crash-5a7ba1bb7c04660bc7e2e748ea3f0d2358e71ff1\r\n```\r\n\r\nAny further discussion for this vulnerability including fix is welcomed! ","closed_by":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/370/timeline","performed_via_github_app":null,"state_reason":"completed"}