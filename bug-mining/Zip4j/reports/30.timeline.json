[{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/520255378","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-520255378","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":520255378,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMDI1NTM3OA==","user":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-11T19:52:22Z","updated_at":"2019-08-11T19:52:22Z","body":"Can you please also attach the zip file? It will greatly help me in investigating the issue. Thanks","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/520255378/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/520313702","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-520313702","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":520313702,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMDMxMzcwMg==","user":{"login":"JensSchliesser","id":12368111,"node_id":"MDQ6VXNlcjEyMzY4MTEx","avatar_url":"https://avatars.githubusercontent.com/u/12368111?v=4","gravatar_id":"","url":"https://api.github.com/users/JensSchliesser","html_url":"https://github.com/JensSchliesser","followers_url":"https://api.github.com/users/JensSchliesser/followers","following_url":"https://api.github.com/users/JensSchliesser/following{/other_user}","gists_url":"https://api.github.com/users/JensSchliesser/gists{/gist_id}","starred_url":"https://api.github.com/users/JensSchliesser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JensSchliesser/subscriptions","organizations_url":"https://api.github.com/users/JensSchliesser/orgs","repos_url":"https://api.github.com/users/JensSchliesser/repos","events_url":"https://api.github.com/users/JensSchliesser/events{/privacy}","received_events_url":"https://api.github.com/users/JensSchliesser/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-12T06:44:40Z","updated_at":"2019-08-12T06:44:40Z","body":"sry I cannot give you the zip because it contains a lot private customer data.  :(\r\n\r\nFind attached some screenshots from the 1.3.3 fileheader, the 2.1.2 fileheader and the decompressed crc value of the 2.1.2 extraction (the crc in the 2.1.2 extraction matches the crc in 1.3.3 but not in 2.1.2), maybe this might help.\r\n\r\nI donÂ´t know if this is might be the problem: but in the 1.3.3 version you are reading the CRC value of the LocalFileHeader as little Endian int, but in the 2.1.x version as long little Endian. (Line 169 in HeaderReader)\r\n\r\n<img width=\"694\" alt=\"133_fileheader\" src=\"https://user-images.githubusercontent.com/12368111/62848459-17d25c80-bcdc-11e9-8ee0-15670d8042ef.png\">\r\n<img width=\"1064\" alt=\"212_decompress\" src=\"https://user-images.githubusercontent.com/12368111/62848460-186af300-bcdc-11e9-9f43-a09e34402474.png\">\r\n![212_fileheader](https://user-images.githubusercontent.com/12368111/62848461-186af300-bcdc-11e9-9c75-3d933a79668f.jpg)\r\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/520313702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"JensSchliesser","id":12368111,"node_id":"MDQ6VXNlcjEyMzY4MTEx","avatar_url":"https://avatars.githubusercontent.com/u/12368111?v=4","gravatar_id":"","url":"https://api.github.com/users/JensSchliesser","html_url":"https://github.com/JensSchliesser","followers_url":"https://api.github.com/users/JensSchliesser/followers","following_url":"https://api.github.com/users/JensSchliesser/following{/other_user}","gists_url":"https://api.github.com/users/JensSchliesser/gists{/gist_id}","starred_url":"https://api.github.com/users/JensSchliesser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JensSchliesser/subscriptions","organizations_url":"https://api.github.com/users/JensSchliesser/orgs","repos_url":"https://api.github.com/users/JensSchliesser/repos","events_url":"https://api.github.com/users/JensSchliesser/events{/privacy}","received_events_url":"https://api.github.com/users/JensSchliesser/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/521180792","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-521180792","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":521180792,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMTE4MDc5Mg==","user":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-14T09:51:39Z","updated_at":"2019-08-14T09:51:39Z","body":"It will be difficult to investigate the issue without the zip file. So please bear with my questions. \r\n\r\nIs this the only zip file for which you have this issue or are you able to reproduce this issue with any other zip file as well? If yes, can you please create a dummy zip (without sensitive data) and send it to me?\r\nWhich tool have to used to generate the zip file?\r\n","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/521180792/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/521238516","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-521238516","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":521238516,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMTIzODUxNg==","user":{"login":"azhao-2019","id":48702589,"node_id":"MDQ6VXNlcjQ4NzAyNTg5","avatar_url":"https://avatars.githubusercontent.com/u/48702589?v=4","gravatar_id":"","url":"https://api.github.com/users/azhao-2019","html_url":"https://github.com/azhao-2019","followers_url":"https://api.github.com/users/azhao-2019/followers","following_url":"https://api.github.com/users/azhao-2019/following{/other_user}","gists_url":"https://api.github.com/users/azhao-2019/gists{/gist_id}","starred_url":"https://api.github.com/users/azhao-2019/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/azhao-2019/subscriptions","organizations_url":"https://api.github.com/users/azhao-2019/orgs","repos_url":"https://api.github.com/users/azhao-2019/repos","events_url":"https://api.github.com/users/azhao-2019/events{/privacy}","received_events_url":"https://api.github.com/users/azhao-2019/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-14T13:08:53Z","updated_at":"2019-08-14T13:08:53Z","body":"i use the 'net.lingala.zip4j:zip4j:2.1.2' .\r\nit zip and unzip is ok, \r\nbut when i want to get the \"zipFile.getInputStream(fileHeader)\", the \"zipInputStream.available() = 0\"","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/521238516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"azhao-2019","id":48702589,"node_id":"MDQ6VXNlcjQ4NzAyNTg5","avatar_url":"https://avatars.githubusercontent.com/u/48702589?v=4","gravatar_id":"","url":"https://api.github.com/users/azhao-2019","html_url":"https://github.com/azhao-2019","followers_url":"https://api.github.com/users/azhao-2019/followers","following_url":"https://api.github.com/users/azhao-2019/following{/other_user}","gists_url":"https://api.github.com/users/azhao-2019/gists{/gist_id}","starred_url":"https://api.github.com/users/azhao-2019/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/azhao-2019/subscriptions","organizations_url":"https://api.github.com/users/azhao-2019/orgs","repos_url":"https://api.github.com/users/azhao-2019/repos","events_url":"https://api.github.com/users/azhao-2019/events{/privacy}","received_events_url":"https://api.github.com/users/azhao-2019/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/521244285","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-521244285","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":521244285,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMTI0NDI4NQ==","user":{"login":"azhao-2019","id":48702589,"node_id":"MDQ6VXNlcjQ4NzAyNTg5","avatar_url":"https://avatars.githubusercontent.com/u/48702589?v=4","gravatar_id":"","url":"https://api.github.com/users/azhao-2019","html_url":"https://github.com/azhao-2019","followers_url":"https://api.github.com/users/azhao-2019/followers","following_url":"https://api.github.com/users/azhao-2019/following{/other_user}","gists_url":"https://api.github.com/users/azhao-2019/gists{/gist_id}","starred_url":"https://api.github.com/users/azhao-2019/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/azhao-2019/subscriptions","organizations_url":"https://api.github.com/users/azhao-2019/orgs","repos_url":"https://api.github.com/users/azhao-2019/repos","events_url":"https://api.github.com/users/azhao-2019/events{/privacy}","received_events_url":"https://api.github.com/users/azhao-2019/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-14T13:24:39Z","updated_at":"2019-08-14T13:24:39Z","body":"`public static String zip(Context context, String password) {\r\n\t\t\r\n\t\ttry {\r\n\t\t\tString cache = context.getFilesDir().getPath() + File.separator + \"cache.zip\";\r\n\t\t\tLog.e(\"cache\", \"cache=\" + cache);\r\n\t\t\t\r\n\t\t\tInputStream assetInputStream = context.getAssets().open(\"demo.p12\");\r\n\t\t\t\r\n\t\t\tZipFile zipFile1 = new ZipFile(cache, password.toCharArray());\r\n\t\t\t\r\n\t\t\tZipParameters zipParameters = new ZipParameters();\r\n\t\t\tint available = assetInputStream.available();\r\n\t\t\t//available  = 2543\r\n\t\t\tLog.e(\"cache \", \" available = \" + available);\r\n\t\t\tzipParameters.setEntrySize(available);\r\n\t\t\t\r\n\t\t\tzipParameters.setEncryptFiles(true);\r\n\t\t\tzipParameters.setEncryptionMethod(EncryptionMethod.AES);\r\n\t\t\t// Below line is optional. AES 256 is used by default. You can override it to use AES 128. AES 192 is supported only for extracting.\r\n\t\t\tzipParameters.setAesKeyStrength(AesKeyStrength.KEY_STRENGTH_256);\r\n\t\t\t\r\n\t\t\tzipParameters.setFileNameInZip(\"demo01.p12\");\r\n\t\t\tzipParameters.setCompressionMethod(CompressionMethod.STORE);\r\n\t\t\tzipFile1.addStream(assetInputStream, zipParameters);\r\n\t\t\t// I can get the correct zip file.\r\n\t\t\t//I can open this zip file on my computer.\r\n\t\t} catch (Exception e) {\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\tpublic static InputStream getCerInputStream(Context context, String name, String pass) throws Exception {\r\n\t\tString cache = context.getFilesDir().getPath() + File.separator + \"cache.zip\";\r\n\t\tLog.e(\"cache \", cache);\r\n\t\t\r\n\t\tZipFile zipFile = new ZipFile(cache, pass.toCharArray());\r\n\t\tList<FileHeader> fileHeaders = zipFile.getFileHeaders();\r\n\t\tint size = fileHeaders.size();\r\n\t\t//size = 1\r\n\t\tLog.e(\"cache \", \"size = \" + size);\r\n\t\tfor (int i = 0; i < size; i++) {\r\n\t\t\tFileHeader fileHeader = fileHeaders.get(i);\r\n\t\t\t\r\n\t\t\t//name = demo01.p12\r\n\t\t\tLog.e(\"cache \", \"name = \" + fileHeader.getFileName());\r\n\t\t\tZipInputStream zipInputStream = zipFile.getInputStream(fileHeader);\r\n\t\t\t\r\n\t\t\t//false\r\n\t\t\tLog.e(\"cache \", \" zipInputStream = \" + (zipInputStream == null));\r\n\t\t\t\r\n\t\t\t// TODO: size = 0 , There's a problem. zipInputStream shouldn't be zero.\r\n\t\t\tLog.e(\"cache \", \" zipInputStream size= \" + zipInputStream.available());\r\n\t\t\t\r\n\t\t\t//unzip test\r\n\t\t\tString cachePath = context.getFilesDir().getPath();\r\n\t\t\tzipFile.extractFile(fileHeader.getFileName(), cachePath);\r\n\t\t\t\r\n\t\t\tString cachePath33 = context.getFilesDir().getPath() + File.separator + fileHeader.getFileName();\r\n\t\t\t\r\n\t\t\tFileInputStream inputStream = new FileInputStream(cachePath33);\r\n\t\t\t//size = 2543\r\n\t\t\tLog.e(\"cache \", \"inputStream size = \" + inputStream.available());\r\n\t\t\treturn zipFile.getInputStream(fileHeader);\r\n\t\t}\r\n\t\t\r\n\t\treturn null;\r\n\t}`","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/521244285/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"azhao-2019","id":48702589,"node_id":"MDQ6VXNlcjQ4NzAyNTg5","avatar_url":"https://avatars.githubusercontent.com/u/48702589?v=4","gravatar_id":"","url":"https://api.github.com/users/azhao-2019","html_url":"https://github.com/azhao-2019","followers_url":"https://api.github.com/users/azhao-2019/followers","following_url":"https://api.github.com/users/azhao-2019/following{/other_user}","gists_url":"https://api.github.com/users/azhao-2019/gists{/gist_id}","starred_url":"https://api.github.com/users/azhao-2019/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/azhao-2019/subscriptions","organizations_url":"https://api.github.com/users/azhao-2019/orgs","repos_url":"https://api.github.com/users/azhao-2019/repos","events_url":"https://api.github.com/users/azhao-2019/events{/privacy}","received_events_url":"https://api.github.com/users/azhao-2019/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/521530019","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-521530019","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":521530019,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMTUzMDAxOQ==","user":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-15T06:24:56Z","updated_at":"2019-08-15T06:24:56Z","body":"@azhao-2019 It would have been good if you have opened a new issue for your case. Your issue has nothing to do with the issue reported in this issue.\r\n\r\n`available()` is quite hard (if not impossible) to implement correctly on a ZipInputStream. And this is the reason even Java's ZipInputStream returns either a 0 or 1 for `available()`, which is quite understandable (0 when end of stream is reached, and 1 when not). Zip4j did not implement available method so far because of this inconsistency. But I will implement something like Java's 0 or 1 when `available` method is called. Will include this in next release.\r\n\r\nFor any further communication on this issue, please open a new issue. Thanks.","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/521530019/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2558661543,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjU1ODY2MTU0Mw==","url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/events/2558661543","actor":{"login":"azhao-2019","id":48702589,"node_id":"MDQ6VXNlcjQ4NzAyNTg5","avatar_url":"https://avatars.githubusercontent.com/u/48702589?v=4","gravatar_id":"","url":"https://api.github.com/users/azhao-2019","html_url":"https://github.com/azhao-2019","followers_url":"https://api.github.com/users/azhao-2019/followers","following_url":"https://api.github.com/users/azhao-2019/following{/other_user}","gists_url":"https://api.github.com/users/azhao-2019/gists{/gist_id}","starred_url":"https://api.github.com/users/azhao-2019/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/azhao-2019/subscriptions","organizations_url":"https://api.github.com/users/azhao-2019/orgs","repos_url":"https://api.github.com/users/azhao-2019/repos","events_url":"https://api.github.com/users/azhao-2019/events{/privacy}","received_events_url":"https://api.github.com/users/azhao-2019/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-08-15T06:24:57Z","performed_via_github_app":null},{"id":2558661545,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI1NTg2NjE1NDU=","url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/events/2558661545","actor":{"login":"azhao-2019","id":48702589,"node_id":"MDQ6VXNlcjQ4NzAyNTg5","avatar_url":"https://avatars.githubusercontent.com/u/48702589?v=4","gravatar_id":"","url":"https://api.github.com/users/azhao-2019","html_url":"https://github.com/azhao-2019","followers_url":"https://api.github.com/users/azhao-2019/followers","following_url":"https://api.github.com/users/azhao-2019/following{/other_user}","gists_url":"https://api.github.com/users/azhao-2019/gists{/gist_id}","starred_url":"https://api.github.com/users/azhao-2019/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/azhao-2019/subscriptions","organizations_url":"https://api.github.com/users/azhao-2019/orgs","repos_url":"https://api.github.com/users/azhao-2019/repos","events_url":"https://api.github.com/users/azhao-2019/events{/privacy}","received_events_url":"https://api.github.com/users/azhao-2019/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-08-15T06:24:57Z","performed_via_github_app":null},{"id":2564409522,"node_id":"MDEyOkxhYmVsZWRFdmVudDI1NjQ0MDk1MjI=","url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/events/2564409522","actor":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-08-18T11:26:38Z","label":{"name":"help wanted","color":"008672"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522313811","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-522313811","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":522313811,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMjMxMzgxMQ==","user":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-18T11:34:55Z","updated_at":"2019-08-18T11:34:55Z","body":"@JensSchliesser \r\n\r\n> in the 1.3.3 version you are reading the CRC value of the LocalFileHeader as little Endian int, but in the 2.1.x version as long little Endian.\r\n\r\nThis is an intended fix. It was an issue in v1.x. If you look at your screenshot with 1.x, crc value is negative. This should not be the case. This was an issue because crc was defined as an int in 1.x which should be a long and the negative value was long rounding off to an int. \r\n\r\n**And regarding this issue:**\r\n\r\nI tried a lot to reproduce this issue. I tried with several zip files of varying sizes and content and used a code similar to yours (although a much cut down version). Below is the code I used:\r\n\r\n```\r\n    final Charset charset = Charset.forName(\"Cp1252\");\r\n    ZipFile zipFile = new ZipFile(\"/Users/slingala/Downloads/zip4j_src_1.3.2-patched.zip\");\r\n\r\n    for (FileHeader fileHeader : zipFile.getFileHeaders()) {\r\n      ZipInputStream zipInputStream = zipFile.getInputStream(fileHeader);\r\n      System.out.println(IOUtils.toString(zipInputStream, charset));\r\n      zipInputStream.close();\r\n    }\r\n```\r\n\r\nEach of the zip files I used successfully printed out the content successfully and I was not able to reproduce this issue. Unfortunately without a zip file it will be pretty hard to investigate what is going wrong. If you are able to generate a sample zip file with which you can reproduce this issue, and one that you can share with me, it would be great if you can send it to me. I am very interested to investigate and fix this issue, but without being able to reproduce it, unfortunately, I am in an unhelpful situation.\r\n\r\n","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522313811/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2564412832,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjU2NDQxMjgzMg==","url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/events/2564412832","actor":{"login":"JensSchliesser","id":12368111,"node_id":"MDQ6VXNlcjEyMzY4MTEx","avatar_url":"https://avatars.githubusercontent.com/u/12368111?v=4","gravatar_id":"","url":"https://api.github.com/users/JensSchliesser","html_url":"https://github.com/JensSchliesser","followers_url":"https://api.github.com/users/JensSchliesser/followers","following_url":"https://api.github.com/users/JensSchliesser/following{/other_user}","gists_url":"https://api.github.com/users/JensSchliesser/gists{/gist_id}","starred_url":"https://api.github.com/users/JensSchliesser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JensSchliesser/subscriptions","organizations_url":"https://api.github.com/users/JensSchliesser/orgs","repos_url":"https://api.github.com/users/JensSchliesser/repos","events_url":"https://api.github.com/users/JensSchliesser/events{/privacy}","received_events_url":"https://api.github.com/users/JensSchliesser/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-08-18T11:34:56Z","performed_via_github_app":null},{"id":2564412833,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI1NjQ0MTI4MzM=","url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/events/2564412833","actor":{"login":"JensSchliesser","id":12368111,"node_id":"MDQ6VXNlcjEyMzY4MTEx","avatar_url":"https://avatars.githubusercontent.com/u/12368111?v=4","gravatar_id":"","url":"https://api.github.com/users/JensSchliesser","html_url":"https://github.com/JensSchliesser","followers_url":"https://api.github.com/users/JensSchliesser/followers","following_url":"https://api.github.com/users/JensSchliesser/following{/other_user}","gists_url":"https://api.github.com/users/JensSchliesser/gists{/gist_id}","starred_url":"https://api.github.com/users/JensSchliesser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JensSchliesser/subscriptions","organizations_url":"https://api.github.com/users/JensSchliesser/orgs","repos_url":"https://api.github.com/users/JensSchliesser/repos","events_url":"https://api.github.com/users/JensSchliesser/events{/privacy}","received_events_url":"https://api.github.com/users/JensSchliesser/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-08-18T11:34:56Z","performed_via_github_app":null},{"id":2564437312,"node_id":"MDE0OlVubGFiZWxlZEV2ZW50MjU2NDQzNzMxMg==","url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/events/2564437312","actor":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2019-08-18T12:32:50Z","label":{"name":"help wanted","color":"008672"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522319817","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-522319817","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":522319817,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMjMxOTgxNw==","user":{"login":"JensSchliesser","id":12368111,"node_id":"MDQ6VXNlcjEyMzY4MTEx","avatar_url":"https://avatars.githubusercontent.com/u/12368111?v=4","gravatar_id":"","url":"https://api.github.com/users/JensSchliesser","html_url":"https://github.com/JensSchliesser","followers_url":"https://api.github.com/users/JensSchliesser/followers","following_url":"https://api.github.com/users/JensSchliesser/following{/other_user}","gists_url":"https://api.github.com/users/JensSchliesser/gists{/gist_id}","starred_url":"https://api.github.com/users/JensSchliesser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JensSchliesser/subscriptions","organizations_url":"https://api.github.com/users/JensSchliesser/orgs","repos_url":"https://api.github.com/users/JensSchliesser/repos","events_url":"https://api.github.com/users/JensSchliesser/events{/privacy}","received_events_url":"https://api.github.com/users/JensSchliesser/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-18T12:55:27Z","updated_at":"2019-08-18T12:56:50Z","body":"Hello,\r\n\r\nthank you for all your efforts. I will really try to get such a ZIP from our dev System, which contains obfuscated private data.\r\n\r\n> This is an intended fix. It was an issue in v1.x. If you look at your screenshot with 1.x, crc value is negative. This should not be the case. This was an issue because crc was defined as an int in 1.x which should be a long and the negative value was long rounding off to an int.\r\n\r\nOkay but the CRC Checksum returned from crc32.update in the decompression method in 2.1.2 is **indeed negative**. (see screenshot below) . Which should **NOT** be the case as you said, but its the same as in  the 1.x Version.\r\n\r\n<img width=\"1064\" alt=\"212_decompress\" src=\"https://user-images.githubusercontent.com/12368111/63224683-07345180-c1c8-11e9-985b-cffa07e20ef7.png\">\r\n\r\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522319817/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"JensSchliesser","id":12368111,"node_id":"MDQ6VXNlcjEyMzY4MTEx","avatar_url":"https://avatars.githubusercontent.com/u/12368111?v=4","gravatar_id":"","url":"https://api.github.com/users/JensSchliesser","html_url":"https://github.com/JensSchliesser","followers_url":"https://api.github.com/users/JensSchliesser/followers","following_url":"https://api.github.com/users/JensSchliesser/following{/other_user}","gists_url":"https://api.github.com/users/JensSchliesser/gists{/gist_id}","starred_url":"https://api.github.com/users/JensSchliesser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JensSchliesser/subscriptions","organizations_url":"https://api.github.com/users/JensSchliesser/orgs","repos_url":"https://api.github.com/users/JensSchliesser/repos","events_url":"https://api.github.com/users/JensSchliesser/events{/privacy}","received_events_url":"https://api.github.com/users/JensSchliesser/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522321897","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-522321897","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":522321897,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMjMyMTg5Nw==","user":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-18T13:25:08Z","updated_at":"2019-08-18T13:37:06Z","body":"> Okay but the CRC Checksum returned from crc32.update in the decompression method in 2.1.2 is indeed negative.\r\n\r\nThat is because, Java's CRC32 internally stores the crc as an int. But the value we should be looking at is `Crc32.getValue()` which returns a long. The negative value I was referring to was within zip4j code which should not be the case in v2.x. This crc value should be the same as the value stored in the zip file headers. I just printed out the value I see in your debug screen -270911946 as a long (-270911946 & 0xffffffffL) and I get the value 4024055350, which is the value stored in the header as I see from one of your earlier screenshots. So, you should not be getting this error. \r\n\r\nCan you please debug and let me know both the crc's on [line 250 in ZipInputStream][1]?\r\n\r\n[1]: https://github.com/srikanth-lingala/zip4j/blob/master/src/main/java/net/lingala/zip4j/io/inputstream/ZipInputStream.java#L250","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522321897/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522339805","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-522339805","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":522339805,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMjMzOTgwNQ==","user":{"login":"JensSchliesser","id":12368111,"node_id":"MDQ6VXNlcjEyMzY4MTEx","avatar_url":"https://avatars.githubusercontent.com/u/12368111?v=4","gravatar_id":"","url":"https://api.github.com/users/JensSchliesser","html_url":"https://github.com/JensSchliesser","followers_url":"https://api.github.com/users/JensSchliesser/followers","following_url":"https://api.github.com/users/JensSchliesser/following{/other_user}","gists_url":"https://api.github.com/users/JensSchliesser/gists{/gist_id}","starred_url":"https://api.github.com/users/JensSchliesser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JensSchliesser/subscriptions","organizations_url":"https://api.github.com/users/JensSchliesser/orgs","repos_url":"https://api.github.com/users/JensSchliesser/repos","events_url":"https://api.github.com/users/JensSchliesser/events{/privacy}","received_events_url":"https://api.github.com/users/JensSchliesser/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-18T17:25:05Z","updated_at":"2019-08-18T17:25:05Z","body":"Can you send me a mail to jens.schliesser@gmail.com ? I can send you a link to a non working file ","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522339805/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"JensSchliesser","id":12368111,"node_id":"MDQ6VXNlcjEyMzY4MTEx","avatar_url":"https://avatars.githubusercontent.com/u/12368111?v=4","gravatar_id":"","url":"https://api.github.com/users/JensSchliesser","html_url":"https://github.com/JensSchliesser","followers_url":"https://api.github.com/users/JensSchliesser/followers","following_url":"https://api.github.com/users/JensSchliesser/following{/other_user}","gists_url":"https://api.github.com/users/JensSchliesser/gists{/gist_id}","starred_url":"https://api.github.com/users/JensSchliesser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JensSchliesser/subscriptions","organizations_url":"https://api.github.com/users/JensSchliesser/orgs","repos_url":"https://api.github.com/users/JensSchliesser/repos","events_url":"https://api.github.com/users/JensSchliesser/events{/privacy}","received_events_url":"https://api.github.com/users/JensSchliesser/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522340171","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-522340171","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":522340171,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMjM0MDE3MQ==","user":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-18T17:29:57Z","updated_at":"2019-08-18T17:29:57Z","body":"Mail sent","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522340171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522350409","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-522350409","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":522350409,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMjM1MDQwOQ==","user":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-18T19:57:02Z","updated_at":"2019-08-18T19:57:02Z","body":"The issue here is not with the extraction of the zip file, but rather with the tool that created the zip file. To explain this issue, I first have to explain a bit about the zip file format. Below is a copy-paste of this explanation I made in relation to another issue here:\r\n\r\n> An entry (file) in a zip file has the following format:\r\n> \r\n> [LOCAL_FILE_HEADER][....DATA....][DATA_DESCRIPTOR]\r\n> \r\n> And the above format repeats for the number of files present in the zip file, and at the end of the file, there are some additional headers containing information of the overall zip file (number of entries, and a lot of other info). (Note: the actual entry structure can get a lot more complicated with differing scenarios, the above entry structure is a very simplified version, just enough to make my point here).\r\n> \r\n> DATA_DESCRIPTOR in the above structure is an optional header block. This header block contains the crc, compressed size and uncompressed size of the entry. This header block can be used if these sizes are not known upfront. Imagine working with streams, in this case, you do not know the size of compressed data upfront. You only know that information after you finish writing the data. But since we are working with streams, we cannot go back to the point where localfileheaders were written to update that data (compressed and uncompressed sizes). It is in this scenario, that DATA_DESCRIPTOR can be used. In such cases, crc, compressed size and uncompressed size are marked as 0 in localfilheader and the actual data is available in either DATA_DESCRIPTOR or the fileheader. This is totally as per the zip specification. And all zip tools should handle that scenario.\r\n> \r\n\r\nThe issue with your zip file is that the entry header flag in local file header says that there is a data descriptor present at the end of the entry, but there is no such entry defined at the end of the data. This flag in the local file header should not be set for these files. Can you please let me know which tool you have used to create the zip file? If it was zip4j, please mention the version and also the code you used to create the zip file.","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522350409/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522350542","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-522350542","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":522350542,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMjM1MDU0Mg==","user":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-18T19:58:45Z","updated_at":"2019-08-18T20:18:00Z","body":"And also, the reason your code works with zip4j v1.x and other zip tools is that they do not rely on the local file header of the zip file, and rather rely more on the file header (which is a file meta data at the end of the zip file). Zip4j v2.x relies more on the local file header, which had to be done to make it support streams, and since the local file header data is corrupt, you get this exception with zip4j v2.x.","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522350542/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522352591","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-522352591","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":522352591,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMjM1MjU5MQ==","user":{"login":"JensSchliesser","id":12368111,"node_id":"MDQ6VXNlcjEyMzY4MTEx","avatar_url":"https://avatars.githubusercontent.com/u/12368111?v=4","gravatar_id":"","url":"https://api.github.com/users/JensSchliesser","html_url":"https://github.com/JensSchliesser","followers_url":"https://api.github.com/users/JensSchliesser/followers","following_url":"https://api.github.com/users/JensSchliesser/following{/other_user}","gists_url":"https://api.github.com/users/JensSchliesser/gists{/gist_id}","starred_url":"https://api.github.com/users/JensSchliesser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JensSchliesser/subscriptions","organizations_url":"https://api.github.com/users/JensSchliesser/orgs","repos_url":"https://api.github.com/users/JensSchliesser/repos","events_url":"https://api.github.com/users/JensSchliesser/events{/privacy}","received_events_url":"https://api.github.com/users/JensSchliesser/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-18T20:26:07Z","updated_at":"2019-08-18T20:31:55Z","body":"Thank you for explanations! The file was (is) created by an older .NET application. Despite your analysis itÂ´s really hard to explain someone why this is an error of **their** application, if all tested zip tools (unzip, WinZIP, 7z, unarchiver etc) can extract the archive and are not reporting any checksum errors. Maybe relying that hard on that header entry and the missing descriptor and terminating with an exception is a little hard (in comparison with all the other zip tools which seems to ignore that).\r\n\r\nBtw: the strange thing is: the other file I sent you (the working one) was created by the same .NET application","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522352591/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"JensSchliesser","id":12368111,"node_id":"MDQ6VXNlcjEyMzY4MTEx","avatar_url":"https://avatars.githubusercontent.com/u/12368111?v=4","gravatar_id":"","url":"https://api.github.com/users/JensSchliesser","html_url":"https://github.com/JensSchliesser","followers_url":"https://api.github.com/users/JensSchliesser/followers","following_url":"https://api.github.com/users/JensSchliesser/following{/other_user}","gists_url":"https://api.github.com/users/JensSchliesser/gists{/gist_id}","starred_url":"https://api.github.com/users/JensSchliesser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JensSchliesser/subscriptions","organizations_url":"https://api.github.com/users/JensSchliesser/orgs","repos_url":"https://api.github.com/users/JensSchliesser/repos","events_url":"https://api.github.com/users/JensSchliesser/events{/privacy}","received_events_url":"https://api.github.com/users/JensSchliesser/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522354200","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-522354200","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":522354200,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMjM1NDIwMA==","user":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-18T20:48:27Z","updated_at":"2019-08-18T21:13:01Z","body":"All other tools have the luxury of not having to deal with streams. They only work with files. As long as the tools work with files, they can skip relying on local header entry and only rely on the header entries from the zip file metadata. Even zip4j v1.x, which lacked support for streams, relied on file metadata headers. But one of the most requested features for zip4j since v1.x was the support of streams. And with introduction of streams, I have to rely on local file header. \r\n\r\nIf **they** still don't understand after explaining this, then they do not follow the zip specification, and or do not understand the zip specification. This is a very simple mistake that they are doing, and nothing too complicated. When they set the data descriptor flag in headers, then they actually have to define a data descriptor in the zip file. If they do not intend to write data descriptor, then the flag should not be set in the file headers. They don't have to dig deep into zip specification to understand this. This is a very basic zip concept. Please refer them to section 4.3.9 of the [zip specification][1], and section 4.3.6 describes the structure of a zip file.\r\n\r\nThat said, I will see what I can do to rely at least partially on file metadata. I personally am not a big fan for a fix for this in zip4j because this will be like introducing fixes in zip4j for bugs in other zip tools/libraries, which will bring additional complexity to zip4j and might be difficult to maintain over the long run. I cannot promise a \"fix\" for this, but I have to first analyse the complexity it brings to zip4j and see if it will be feasible. I think it is easiest (depends on who owns the .NET application) if they can fix it.\r\n\r\n[1]: https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522354200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522431751","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-522431751","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":522431751,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMjQzMTc1MQ==","user":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-19T06:30:48Z","updated_at":"2019-08-19T06:30:48Z","body":"> Btw: the strange thing is: the other file I sent you (the working one) was created by the same .NET application\r\n\r\nProbably because this bug occurs in that .NET application in some special cases only. ","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/522431751/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/523633092","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-523633092","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":523633092,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzYzMzA5Mg==","user":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-08-21T20:21:36Z","updated_at":"2019-08-21T20:23:21Z","body":"After a lot of thoughts and playing around with the code, I have decided not to include any code change for this in zip4j. As mentioned earlier, this is not a bug in zip4j. This is a bug in the tool that created the zip file. A code change for this in zip4j would mean reading from zip metadata when available (reading from files and not from streams). But what if the zip metadata is not properly defined because of a bug in another tool or the same tool. And moreover even if I make necessary code changes, this will not be fixed when reading streams and thereby making it inconsistent. The couple of main reasons for me not to do any code changes for this are that doing a code change for this means patching zip4j for bugs in other tools and also that there is no guarantee that some other tool generates the zip metadata correctly. The right thing to do in this case, in my opinion, is to fix the tool that generated the zip file. Sorry that I can't be of more help, but I hope you understand my point.","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/523633092/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2574387391,"node_id":"MDExOkNsb3NlZEV2ZW50MjU3NDM4NzM5MQ==","url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/events/2574387391","actor":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2019-08-21T20:21:36Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/531128139","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-531128139","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":531128139,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMTEyODEzOQ==","user":{"login":"jochenr","id":14962274,"node_id":"MDQ6VXNlcjE0OTYyMjc0","avatar_url":"https://avatars.githubusercontent.com/u/14962274?v=4","gravatar_id":"","url":"https://api.github.com/users/jochenr","html_url":"https://github.com/jochenr","followers_url":"https://api.github.com/users/jochenr/followers","following_url":"https://api.github.com/users/jochenr/following{/other_user}","gists_url":"https://api.github.com/users/jochenr/gists{/gist_id}","starred_url":"https://api.github.com/users/jochenr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jochenr/subscriptions","organizations_url":"https://api.github.com/users/jochenr/orgs","repos_url":"https://api.github.com/users/jochenr/repos","events_url":"https://api.github.com/users/jochenr/events{/privacy}","received_events_url":"https://api.github.com/users/jochenr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-09-13T07:19:15Z","updated_at":"2019-09-13T07:19:15Z","body":"Hello,\r\nwe have exactly the same issue as JensSchliesser.\r\nThe company that sends us the passsword protected ZIP files feels confident that their ZIPs files are following the spec.\r\nThay say that they use the C1Zip library:\r\nhttps://www.grapecity.com/controls/studio/zip\r\n\r\nUsing the command \"zipinfo -v <ZIP Filename>\" I get this output:\r\n`Archive:  XXXXX.zip\r\nThere is no zipfile comment.\r\n\r\nEnd-of-central-directory record:\r\n-------------------------------\r\n\r\n  Zip archive file size:                  23995033 (00000000016E2299h)\r\n  Actual end-cent-dir record offset:      23995011 (00000000016E2283h)\r\n  Expected end-cent-dir record offset:    23995011 (00000000016E2283h)\r\n  (based on the length of the central directory and its expected offset)\r\n\r\n  This zipfile constitutes the sole disk of a single-part archive; its\r\n  central directory contains 2 entries.\r\n  The central directory is 138 (000000000000008Ah) bytes long,\r\n  and its (expected) offset in bytes from the beginning of the zipfile\r\n  is 23994873 (00000000016E21F9h).\r\n\r\n\r\nCentral directory entry #1:\r\n---------------------------\r\n\r\n  XXXX1.txt\r\n\r\n  offset of local header from start of archive:   0\r\n                                                  (0000000000000000h) bytes\r\n  file system or operating system of origin:      MS-DOS, OS/2 or NT FAT\r\n  version of encoding software:                   2.0\r\n  minimum file system compatibility required:     MS-DOS, OS/2 or NT FAT\r\n  minimum software version required to extract:   2.0\r\n  compression method:                             deflated\r\n  compression sub-type (deflation):               normal\r\n  file security status:                           encrypted\r\n  extended local header:                          yes\r\n  file last modified on (DOS date/time):          2019 Sep 4 15:01:56\r\n  32-bit CRC value (hex):                         a4ab40d8\r\n  compressed size:                                241 bytes\r\n  uncompressed size:                              871 bytes\r\n  length of filename:                             16 characters\r\n  length of extra field:                          0 bytes\r\n  length of file comment:                         0 characters\r\n  disk number on which file begins:               disk 1\r\n  apparent file type:                             binary\r\n  non-MSDOS external file attributes:             000000 hex\r\n  MS-DOS file attributes (20 hex):                arc \r\n\r\n  There is no file comment.\r\n\r\nCentral directory entry #2:\r\n---------------------------\r\n\r\n  XXXX2.xml\r\n\r\n  offset of local header from start of archive:   287\r\n                                                  (000000000000011Fh) bytes\r\n  file system or operating system of origin:      MS-DOS, OS/2 or NT FAT\r\n  version of encoding software:                   2.0\r\n  minimum file system compatibility required:     MS-DOS, OS/2 or NT FAT\r\n  minimum software version required to extract:   2.0\r\n  compression method:                             deflated\r\n  compression sub-type (deflation):               normal\r\n  file security status:                           encrypted\r\n  extended local header:                          yes\r\n  file last modified on (DOS date/time):          2019 Sep 4 15:01:56\r\n  32-bit CRC value (hex):                         ae99fc07\r\n  compressed size:                                23994526 bytes\r\n  uncompressed size:                              156580261 bytes\r\n  length of filename:                             30 characters\r\n  length of extra field:                          0 bytes\r\n  length of file comment:                         0 characters\r\n  disk number on which file begins:               disk 1\r\n  apparent file type:                             binary\r\n  non-MSDOS external file attributes:             000000 hex\r\n  MS-DOS file attributes (20 hex):                arc \r\n\r\n  There is no file comment.\r\n`\r\n\r\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/531128139/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jochenr","id":14962274,"node_id":"MDQ6VXNlcjE0OTYyMjc0","avatar_url":"https://avatars.githubusercontent.com/u/14962274?v=4","gravatar_id":"","url":"https://api.github.com/users/jochenr","html_url":"https://github.com/jochenr","followers_url":"https://api.github.com/users/jochenr/followers","following_url":"https://api.github.com/users/jochenr/following{/other_user}","gists_url":"https://api.github.com/users/jochenr/gists{/gist_id}","starred_url":"https://api.github.com/users/jochenr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jochenr/subscriptions","organizations_url":"https://api.github.com/users/jochenr/orgs","repos_url":"https://api.github.com/users/jochenr/repos","events_url":"https://api.github.com/users/jochenr/events{/privacy}","received_events_url":"https://api.github.com/users/jochenr/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/531195640","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-531195640","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":531195640,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMTE5NTY0MA==","user":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-09-13T11:05:18Z","updated_at":"2019-09-13T11:05:18Z","body":"@jochenr Would it be possible to send me a sample zip file with which you can reproduce this issue? Unfortunately the most important data I need is missing in the output above.\r\n\r\nIf in fact the issue here is the same as explained above (extended local header flag present, but header missing), then the issue is with the tool that created the zip file. But to pinpoint if this is the same root cause, having a reproducible zip file would be of great help. It would be hard to say the root cause based on the exception because there can be several reasons for it.\r\n\r\nIf you are unable to send a zip file, can you please set a breakpoint [here][1] and let me know the value of `localFileHeader.isDataDescriptorExists()` after `localFileHeader` has been populated. And also, please set a breakpoint [here][2], and let me know the content of the `intBuff`. If the value of `localFileHeader.isDataDescriptorExists()` is true and the content of `intBuff` is `[80, 75, 3, 4]`, then this is the same issue as originally reported here. If not, then unfortunately, I cannot say more and I will need the zip file to investigate the issue. When you are debugging, can you also please let me know the value of `fileHeader.isDataDescriptorExists()` in the [first breakpoint][1].\r\n\r\n[1]: https://github.com/srikanth-lingala/zip4j/blob/master/src/main/java/net/lingala/zip4j/io/inputstream/ZipInputStream.java#L72\r\n[2]: https://github.com/srikanth-lingala/zip4j/blob/a7afefc93e6dec0e7c37f21098c228e1eeb1ea6f/src/main/java/net/lingala/zip4j/headers/HeaderReader.java#L593","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/531195640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2631978854,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjYzMTk3ODg1NA==","url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/events/2631978854","actor":{"login":"jochenr","id":14962274,"node_id":"MDQ6VXNlcjE0OTYyMjc0","avatar_url":"https://avatars.githubusercontent.com/u/14962274?v=4","gravatar_id":"","url":"https://api.github.com/users/jochenr","html_url":"https://github.com/jochenr","followers_url":"https://api.github.com/users/jochenr/followers","following_url":"https://api.github.com/users/jochenr/following{/other_user}","gists_url":"https://api.github.com/users/jochenr/gists{/gist_id}","starred_url":"https://api.github.com/users/jochenr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jochenr/subscriptions","organizations_url":"https://api.github.com/users/jochenr/orgs","repos_url":"https://api.github.com/users/jochenr/repos","events_url":"https://api.github.com/users/jochenr/events{/privacy}","received_events_url":"https://api.github.com/users/jochenr/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-09-13T11:05:18Z","performed_via_github_app":null},{"id":2631978857,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI2MzE5Nzg4NTc=","url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/events/2631978857","actor":{"login":"jochenr","id":14962274,"node_id":"MDQ6VXNlcjE0OTYyMjc0","avatar_url":"https://avatars.githubusercontent.com/u/14962274?v=4","gravatar_id":"","url":"https://api.github.com/users/jochenr","html_url":"https://github.com/jochenr","followers_url":"https://api.github.com/users/jochenr/followers","following_url":"https://api.github.com/users/jochenr/following{/other_user}","gists_url":"https://api.github.com/users/jochenr/gists{/gist_id}","starred_url":"https://api.github.com/users/jochenr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jochenr/subscriptions","organizations_url":"https://api.github.com/users/jochenr/orgs","repos_url":"https://api.github.com/users/jochenr/repos","events_url":"https://api.github.com/users/jochenr/events{/privacy}","received_events_url":"https://api.github.com/users/jochenr/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-09-13T11:05:18Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/531197748","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-531197748","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":531197748,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMTE5Nzc0OA==","user":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-09-13T11:13:37Z","updated_at":"2019-09-13T11:13:37Z","body":"BTW, for the last entry in the zip file (in your case 2nd file as there are 2 files in your zip), the value of `intBuff` might not be `[80, 75, 3, 4]` but might be `[80, 75, 1, 2]`. So, if a zip file that you are testing only has 1 file in it, you might see `[80, 75, 1, 2]` and not `[80, 75, 3, 4]` for `intBuff`","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/531197748/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/531220676","html_url":"https://github.com/srikanth-lingala/zip4j/issues/39#issuecomment-531220676","issue_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/39","id":531220676,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMTIyMDY3Ng==","user":{"login":"jochenr","id":14962274,"node_id":"MDQ6VXNlcjE0OTYyMjc0","avatar_url":"https://avatars.githubusercontent.com/u/14962274?v=4","gravatar_id":"","url":"https://api.github.com/users/jochenr","html_url":"https://github.com/jochenr","followers_url":"https://api.github.com/users/jochenr/followers","following_url":"https://api.github.com/users/jochenr/following{/other_user}","gists_url":"https://api.github.com/users/jochenr/gists{/gist_id}","starred_url":"https://api.github.com/users/jochenr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jochenr/subscriptions","organizations_url":"https://api.github.com/users/jochenr/orgs","repos_url":"https://api.github.com/users/jochenr/repos","events_url":"https://api.github.com/users/jochenr/events{/privacy}","received_events_url":"https://api.github.com/users/jochenr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-09-13T12:38:13Z","updated_at":"2019-09-13T12:38:13Z","body":"Thank you very much for the fast response.\r\n\r\nUnfortunately I am not allowed to give you the original file. But my colleagues are asking for a test ZIP from the company that sends us the files.\r\nAs you proposed I debugged the failing extraction:\r\nWhen the first breakpoint is reached it has a value of **dataDescriptorExists=true** for the localFileHeader and **dataDescriptorExists=true** for the fileHeader.\r\nThe second breakpoint shows this value: **intBuff=[80, 75, 3, 4]**\r\n\r\nSo it seems to be the same issue.\r\n\r\n![grafik](https://user-images.githubusercontent.com/14962274/64862892-eed31d80-d633-11e9-973e-990f7efa7a8e.png)\r\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/comments/531220676/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jochenr","id":14962274,"node_id":"MDQ6VXNlcjE0OTYyMjc0","avatar_url":"https://avatars.githubusercontent.com/u/14962274?v=4","gravatar_id":"","url":"https://api.github.com/users/jochenr","html_url":"https://github.com/jochenr","followers_url":"https://api.github.com/users/jochenr/followers","following_url":"https://api.github.com/users/jochenr/following{/other_user}","gists_url":"https://api.github.com/users/jochenr/gists{/gist_id}","starred_url":"https://api.github.com/users/jochenr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jochenr/subscriptions","organizations_url":"https://api.github.com/users/jochenr/orgs","repos_url":"https://api.github.com/users/jochenr/repos","events_url":"https://api.github.com/users/jochenr/events{/privacy}","received_events_url":"https://api.github.com/users/jochenr/received_events","type":"User","user_view_type":"public","site_admin":false}}]