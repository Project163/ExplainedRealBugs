{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/117","repository_url":"https://api.github.com/repos/srikanth-lingala/zip4j","labels_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/117/labels{/name}","comments_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/117/comments","events_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/117/events","html_url":"https://github.com/srikanth-lingala/zip4j/issues/117","id":535606596,"node_id":"MDU6SXNzdWU1MzU2MDY1OTY=","number":117,"title":"net.lingala.zip4j.exception.ZipException: Expected central directory entry not found (#1)","user":{"login":"dancencheung","id":10287384,"node_id":"MDQ6VXNlcjEwMjg3Mzg0","avatar_url":"https://avatars.githubusercontent.com/u/10287384?v=4","gravatar_id":"","url":"https://api.github.com/users/dancencheung","html_url":"https://github.com/dancencheung","followers_url":"https://api.github.com/users/dancencheung/followers","following_url":"https://api.github.com/users/dancencheung/following{/other_user}","gists_url":"https://api.github.com/users/dancencheung/gists{/gist_id}","starred_url":"https://api.github.com/users/dancencheung/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dancencheung/subscriptions","organizations_url":"https://api.github.com/users/dancencheung/orgs","repos_url":"https://api.github.com/users/dancencheung/repos","events_url":"https://api.github.com/users/dancencheung/events{/privacy}","received_events_url":"https://api.github.com/users/dancencheung/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1347122727,"node_id":"MDU6TGFiZWwxMzQ3MTIyNzI3","url":"https://api.github.com/repos/srikanth-lingala/zip4j/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":16,"created_at":"2019-12-10T09:38:50Z","updated_at":"2024-05-15T09:59:15Z","closed_at":"2019-12-18T19:54:27Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"\r\nFor some zip file, I can execute ZipFile.addFile() successfully.\r\nBut for other zip file, error happened:\r\nI can execute ZipFile.addFile() without any error; But after that, when I open the zipFile, I do not find the file I added to the zipFile; And I can not open the zipFile(after execute ZipFile.addFile) by zip4j, Exception happened.\r\n\r\nException:\r\n```\r\nnet.lingala.zip4j.exception.ZipException: Expected central directory entry not found (#1)\r\n\tat net.lingala.zip4j.headers.HeaderReader.readCentralDirectory(HeaderReader.java:156)\r\n\tat net.lingala.zip4j.headers.HeaderReader.readAllHeaders(HeaderReader.java:86)\r\n\tat net.lingala.zip4j.ZipFile.readZipInfo(ZipFile.java:851)\r\n\tat net.lingala.zip4j.ZipFile.addFiles(ZipFile.java:283)\r\n\tat net.lingala.zip4j.ZipFile.addFile(ZipFile.java:244)\r\n\tat com.dancen.util.filecompressor.MyZipUtil.main(MyZipUtil.java:43)\r\n```\r\n\r\n\r\ntestCode:\r\n```\r\npublic static void main(String[] args)\r\n{\r\n\ttry\r\n\t{\r\n\t\tString zipFilePath = \"C:\\\\Users\\\\zhang\\\\Desktop\\\\pro.apk\";\r\n\t\tString filePathInZip = \"lib/test/test.so\";\t\t\r\n\t\tString filePath = \"apk/lib/x86/libArmArchEncrypt.so\";\r\n\t\t\r\n\t\tZipParameters zipParameters = new ZipParameters();\r\n\t\tzipParameters.setCompressionMethod(CompressionMethod.DEFLATE);\r\n\t\tzipParameters.setCompressionLevel(CompressionLevel.NORMAL);\r\n\t\tzipParameters.setFileNameInZip(filePathInZip);\r\n\t\tzipParameters.setOverrideExistingFilesInZip(true);\r\n\t\t\r\n\t\tZipFile zipFile = new ZipFile(zipFilePath);\r\n\t\tzipFile.addFile(new File(filePath), zipParameters);\r\n\t}\r\n\tcatch(Exception e)\r\n\t{\r\n\t\te.printStackTrace();\r\n\t}\r\n}\r\n```\r\n\r\nTest Again, I change the zipParameters, setCompressionMethod as CompressionMethod.STORE, Now everything OK.\r\n\r\nTestCode:\r\n```\t\r\npublic static void main(String[] args)\r\n{\r\n\ttry\r\n\t{\r\n\t\tString zipFilePath = \"C:\\\\Users\\\\zhang\\\\Desktop\\\\pro.apk\";\r\n\t\tString filePathInZip = \"lib/test/test.so\";\t\t\r\n\t\tString filePath = \"apk/lib/x86/libArmArchEncrypt.so\";\r\n\t\t\r\n\t\tZipParameters zipParameters = new ZipParameters();\r\n\t\tzipParameters.setCompressionMethod(CompressionMethod.STORE);\r\n\t\tzipParameters.setFileNameInZip(filePathInZip);\r\n\t\tzipParameters.setOverrideExistingFilesInZip(true);\r\n\t\t\r\n\t\tZipFile zipFile = new ZipFile(zipFilePath);\r\n\t\tzipFile.addFile(new File(filePath), zipParameters);\r\n\t}\r\n\tcatch(Exception e)\r\n\t{\r\n\t\te.printStackTrace();\r\n\t}\r\n}\r\n```","closed_by":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/117/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/117/timeline","performed_via_github_app":null,"state_reason":"completed"}