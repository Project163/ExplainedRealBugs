{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/373","repository_url":"https://api.github.com/repos/srikanth-lingala/zip4j","labels_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/373/labels{/name}","comments_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/373/comments","events_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/373/events","html_url":"https://github.com/srikanth-lingala/zip4j/issues/373","id":1034444442,"node_id":"I_kwDOCwUnhM49qF6a","number":373,"title":"java.lang.NullPointerException in `net.lingala.zip4j.io.inputstream.AesCipherInputStream.getSalt::AesCipherInputStream.java:161` zip4j 2.9.0","user":{"login":"ZanderHuang","id":18213663,"node_id":"MDQ6VXNlcjE4MjEzNjYz","avatar_url":"https://avatars.githubusercontent.com/u/18213663?v=4","gravatar_id":"","url":"https://api.github.com/users/ZanderHuang","html_url":"https://github.com/ZanderHuang","followers_url":"https://api.github.com/users/ZanderHuang/followers","following_url":"https://api.github.com/users/ZanderHuang/following{/other_user}","gists_url":"https://api.github.com/users/ZanderHuang/gists{/gist_id}","starred_url":"https://api.github.com/users/ZanderHuang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ZanderHuang/subscriptions","organizations_url":"https://api.github.com/users/ZanderHuang/orgs","repos_url":"https://api.github.com/users/ZanderHuang/repos","events_url":"https://api.github.com/users/ZanderHuang/events{/privacy}","received_events_url":"https://api.github.com/users/ZanderHuang/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1347122727,"node_id":"MDU6TGFiZWwxMzQ3MTIyNzI3","url":"https://api.github.com/repos/srikanth-lingala/zip4j/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1623761937,"node_id":"MDU6TGFiZWwxNjIzNzYxOTM3","url":"https://api.github.com/repos/srikanth-lingala/zip4j/labels/resolved","name":"resolved","color":"b8dd11","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":2,"created_at":"2021-10-24T15:29:24Z","updated_at":"2022-03-28T15:16:52Z","closed_at":"2022-03-28T15:16:51Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"This vulnerability is of java.lang.NullPointerException, and can be triggered in latest version zip4j (2.9.0).\r\nIt is caused by not checking the pointer before dereference it and also failing to catch the runtime java exception (it should be wrapped as one kind of JSONException) and can be used for attackers to launch DoS (Denial of Service) attack for any java program that uses this library (since the user of zip4j doesn't know they need to catch this kind of exception) (CWE-476: NULL Pointer Dereference, CWE-248: Uncaught exception).\r\nLikely, the root cause of this crash is in `net.lingala.zip4j.io.inputstream.AesCipherInputStream.getSalt::AesCipherInputStream.java:161`.\r\nhttps://github.com/srikanth-lingala/zip4j/blob/ce1cff61c019d61f5db603cba908118a3a0e3b93/src/main/java/net/lingala/zip4j/io/inputstream/AesCipherInputStream.java#L161  The variable \"aesExtraDataRecord\" has a NULL value and it results in NullPointerException.\r\n\r\nSee more detail from the following crash stack.\r\n\r\n# Crash stack:\r\nThe crash thread's stack is as follows:\r\n\r\n```\r\nnet.lingala.zip4j.io.inputstream.AesCipherInputStream.getSalt::AesCipherInputStream.java:161\r\nnet.lingala.zip4j.io.inputstream.AesCipherInputStream.initializeDecrypter::AesCipherInputStream.java:37\r\nnet.lingala.zip4j.io.inputstream.AesCipherInputStream.initializeDecrypter::AesCipherInputStream.java:18\r\nnet.lingala.zip4j.io.inputstream.CipherInputStream.<init>::CipherInputStream.java:25\r\nnet.lingala.zip4j.io.inputstream.AesCipherInputStream.<init>::AesCipherInputStream.java:32\r\nnet.lingala.zip4j.io.inputstream.ZipInputStream.initializeCipherInputStream::ZipInputStream.java:234\r\nnet.lingala.zip4j.io.inputstream.ZipInputStream.initializeEntryInputStream::ZipInputStream.java:223\r\nnet.lingala.zip4j.io.inputstream.ZipInputStream.getNextEntry::ZipInputStream.java:113\r\nnet.lingala.zip4j.io.inputstream.ZipInputStream.getNextEntry::ZipInputStream.java:83\r\ncom.test.Entry.main::Entry.java:37\r\n```\r\n\r\n\r\n# Steps to reproduce: \r\n\r\n1. Build the following java code with the corresponding zip4j library (version 2.9.0).\r\n\r\n```\r\n## Download zip4j_env_reproduce.tar.gz from https://drive.google.com/file/d/1MekCBIghKxIW4j-TLjZkm8ovvLb_grm5/view?usp=sharing\r\ntar -xf zip4j_env_reproduce.tar.gz\r\ncd zip4j_env_reproduce\r\nbash build.sh\r\n```\r\n\r\n2. Run the built program to see the crash by feeding one of the poc file contained in the pocs.tar.gz, e.g. :\r\n(poc file can be downloaded from https://drive.google.com/file/d/1OM47k2Q9nGgj32UU-npTN2FrUePo7ehF/view?usp=sharing)\r\n```\r\njava -jar target/Entry-1.0-SNAPSHOT-jar-with-dependencies.jar pocs/crash-d6e84c761cc0e655ae615ce3473793935ee337bf\r\n```\r\n\r\nAny further discussion for this vulnerability including fix is welcomed! ","closed_by":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/373/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/373/timeline","performed_via_github_app":null,"state_reason":"completed"}