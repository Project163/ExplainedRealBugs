{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/403","repository_url":"https://api.github.com/repos/srikanth-lingala/zip4j","labels_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/403/labels{/name}","comments_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/403/comments","events_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/403/events","html_url":"https://github.com/srikanth-lingala/zip4j/issues/403","id":1118198817,"node_id":"I_kwDOCwUnhM5Cplwh","number":403,"title":"Incorrect decoding of file names with some zip files","user":{"login":"jimfcarroll","id":372696,"node_id":"MDQ6VXNlcjM3MjY5Ng==","avatar_url":"https://avatars.githubusercontent.com/u/372696?v=4","gravatar_id":"","url":"https://api.github.com/users/jimfcarroll","html_url":"https://github.com/jimfcarroll","followers_url":"https://api.github.com/users/jimfcarroll/followers","following_url":"https://api.github.com/users/jimfcarroll/following{/other_user}","gists_url":"https://api.github.com/users/jimfcarroll/gists{/gist_id}","starred_url":"https://api.github.com/users/jimfcarroll/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimfcarroll/subscriptions","organizations_url":"https://api.github.com/users/jimfcarroll/orgs","repos_url":"https://api.github.com/users/jimfcarroll/repos","events_url":"https://api.github.com/users/jimfcarroll/events{/privacy}","received_events_url":"https://api.github.com/users/jimfcarroll/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1623761937,"node_id":"MDU6TGFiZWwxNjIzNzYxOTM3","url":"https://api.github.com/repos/srikanth-lingala/zip4j/labels/resolved","name":"resolved","color":"b8dd11","default":false,"description":""},{"id":1973950881,"node_id":"MDU6TGFiZWwxOTczOTUwODgx","url":"https://api.github.com/repos/srikanth-lingala/zip4j/labels/improvement","name":"improvement","color":"f2aeb5","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":4,"created_at":"2022-01-29T12:05:51Z","updated_at":"2022-06-03T10:17:41Z","closed_at":"2022-03-28T15:14:47Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I have a zip file where zip4j doesn't decode the file names correctly while all of the command line utilities and Apache's VFS2 do. From the contents of the zip file it looks like it was made on a Mac. Here is the output of test code I wrote. The first 2 lines are using Apache VFS2. The second 2 lines are from using Zip4j's `ZipInputStream`\r\n\r\n```\r\nAquinas, St. Thomas/Primary/Français/Aquin - De l'éternite du monde.doc\r\n9:Français\r\nAquinas, St. Thomas/Primary/Franc╠ºais/Aquin - De l'e╠üternite du monde.doc\r\n10:Franc╠ºais\r\n```\r\n\r\nThe file is 700MB so I can't really attach it here. I tried to create a smaller file by unzipping the archive and rezipping only that file but Zip4j worked fine on the rezipped file. \r\n\r\nI saw issue https://github.com/srikanth-lingala/zip4j/issues/304 which I'm not sure is related. In any case I don't have control over the zip files I'm unzipping and so I don't know the encoding beforehand.\r\n\r\nFor completeness the following is my test code. It prints out the name of the 184th entry in the zip file:\r\n\r\n```\r\nimport java.io.File;\r\nimport java.io.FileInputStream;\r\n\r\nimport org.apache.commons.compress.archivers.ArchiveEntry;\r\nimport org.apache.commons.compress.archivers.zip.ZipArchiveInputStream;\r\n\r\nimport net.lingala.zip4j.io.inputstream.ZipInputStream;\r\nimport net.lingala.zip4j.model.LocalFileHeader;\r\n\r\npublic class TestEncoding {\r\n    public static String pickOutDirName(final String name) {\r\n        final int start = name.indexOf(\"Fran\");\r\n        final int end = name.substring(start).indexOf('/') + start;\r\n        return name.substring(start, end);\r\n    }\r\n\r\n    public static void main(final String[] args) throws Exception {\r\n        final String fullPath = \"/path/to/zip/file.zip\";\r\n        final File file = new File(fullPath);\r\n\r\n        int entryCount = 0;\r\n        try(ZipArchiveInputStream isa = new ZipArchiveInputStream(new FileInputStream(file));) {\r\n            for(ArchiveEntry entry = isa.getNextEntry(); entry != null; entry = isa.getNextEntry()) {\r\n                if(entryCount == 184) {\r\n                    final String name = entry.getName();\r\n                    final String dirName = pickOutDirName(name);\r\n                    System.out.println(name);\r\n                    System.out.println(dirName.length() + \":\" + dirName);\r\n                    break;\r\n                }\r\n                entryCount++;\r\n            }\r\n        }\r\n\r\n        entryCount = 0;\r\n        try(ZipInputStream isz = new ZipInputStream(new FileInputStream(file));) {\r\n            for(LocalFileHeader entry = isz.getNextEntry(); entry != null; entry = isz.getNextEntry()) {\r\n                if(entryCount == 184) {\r\n                    final String name = entry.getFileName();\r\n                    final String dirName = pickOutDirName(name);\r\n                    System.out.println(name);\r\n                    System.out.println(dirName.length() + \":\" + dirName);\r\n                    break;\r\n                }\r\n                entryCount++;\r\n            }\r\n        }\r\n    }\r\n}\r\n```\r\n","closed_by":{"login":"srikanth-lingala","id":3450302,"node_id":"MDQ6VXNlcjM0NTAzMDI=","avatar_url":"https://avatars.githubusercontent.com/u/3450302?v=4","gravatar_id":"","url":"https://api.github.com/users/srikanth-lingala","html_url":"https://github.com/srikanth-lingala","followers_url":"https://api.github.com/users/srikanth-lingala/followers","following_url":"https://api.github.com/users/srikanth-lingala/following{/other_user}","gists_url":"https://api.github.com/users/srikanth-lingala/gists{/gist_id}","starred_url":"https://api.github.com/users/srikanth-lingala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srikanth-lingala/subscriptions","organizations_url":"https://api.github.com/users/srikanth-lingala/orgs","repos_url":"https://api.github.com/users/srikanth-lingala/repos","events_url":"https://api.github.com/users/srikanth-lingala/events{/privacy}","received_events_url":"https://api.github.com/users/srikanth-lingala/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/403/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/srikanth-lingala/zip4j/issues/403/timeline","performed_via_github_app":null,"state_reason":"completed"}