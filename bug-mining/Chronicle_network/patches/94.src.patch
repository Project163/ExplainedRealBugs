diff --git a/src/main/java/net/openhft/chronicle/network/internal/SocketExceptionUtil.java b/src/main/java/net/openhft/chronicle/network/internal/SocketExceptionUtil.java
index 25e82d1b78..fc79f08ff9 100644
--- a/src/main/java/net/openhft/chronicle/network/internal/SocketExceptionUtil.java
+++ b/src/main/java/net/openhft/chronicle/network/internal/SocketExceptionUtil.java
@@ -20,9 +20,20 @@ public final class SocketExceptionUtil {
      * @return true if the exception is one that signifies the connection was reset
      */
     public static boolean isAConnectionResetException(IOException e) {
-        String message = e.getMessage();
-        return message != null &&
-                (message.equals("Connection reset by peer")
-                        || e instanceof SocketException && message.equals("Connection reset"));
+        return isALinuxJava12OrLessConnectionResetException(e)
+                || isAWindowsConnectionResetException(e)
+                || isALinuxJava13OrGreaterConnectionResetException(e);
+    }
+
+    private static boolean isALinuxJava13OrGreaterConnectionResetException(IOException e) {
+        return e.getClass().equals(SocketException.class) && "Connection reset".equals(e.getMessage());
+    }
+
+    private static boolean isAWindowsConnectionResetException(IOException e) {
+        return e.getClass().equals(IOException.class) && "An existing connection was forcibly closed by the remote host".equals(e.getMessage());
+    }
+
+    private static boolean isALinuxJava12OrLessConnectionResetException(IOException e) {
+        return e.getClass().equals(IOException.class) && "Connection reset by peer".equals(e.getMessage());
     }
 }
diff --git a/src/test/java/net/openhft/chronicle/network/NetworkTestCommon.java b/src/test/java/net/openhft/chronicle/network/NetworkTestCommon.java
index 5fb73b801a..ae1d1bd8d9 100644
--- a/src/test/java/net/openhft/chronicle/network/NetworkTestCommon.java
+++ b/src/test/java/net/openhft/chronicle/network/NetworkTestCommon.java
@@ -47,7 +47,7 @@ public class NetworkTestCommon {
     }
 
     public void expectException(String message) {
-        expectException(k -> k.message.contains(message) || (k.throwable != null && k.throwable.getMessage().contains(message)), message);
+        expectException(k -> k.message.contains(message) || (k.throwable != null && k.throwable.getMessage() != null && k.throwable.getMessage().contains(message)), message);
     }
 
     public void expectException(Predicate<ExceptionKey> predicate, String description) {
diff --git a/src/test/java/net/openhft/chronicle/network/TCPRegistryTest.java b/src/test/java/net/openhft/chronicle/network/TCPRegistryTest.java
index c447b0430b..42efe15c83 100644
--- a/src/test/java/net/openhft/chronicle/network/TCPRegistryTest.java
+++ b/src/test/java/net/openhft/chronicle/network/TCPRegistryTest.java
@@ -1,5 +1,6 @@
 package net.openhft.chronicle.network;
 
+import org.junit.After;
 import org.junit.Before;
 import org.junit.Test;
 import org.junit.runner.RunWith;
@@ -9,10 +10,11 @@ import java.io.IOException;
 import java.util.Arrays;
 import java.util.Collection;
 
-import static org.junit.Assert.*;
+import static org.junit.Assert.assertNotNull;
+import static org.junit.Assert.fail;
 
 @RunWith(Parameterized.class)
-public class TCPRegistryTest {
+public class TCPRegistryTest extends NetworkTestCommon {
 
     private final boolean useCrossProcess;
 
@@ -32,6 +34,11 @@ public class TCPRegistryTest {
         }
     }
 
+    @After
+    public void tearDown() {
+        TCPRegistry.useInMemoryRegistry();
+    }
+
     @Test
     public void testResetClearsRegistry() throws IOException {
         TCPRegistry.createServerSocketChannelFor("host1", "host2", "host3");
diff --git a/src/test/java/net/openhft/chronicle/network/internal/SocketExceptionUtilTest.java b/src/test/java/net/openhft/chronicle/network/internal/SocketExceptionUtilTest.java
index efff601b61..b099e9fc5b 100644
--- a/src/test/java/net/openhft/chronicle/network/internal/SocketExceptionUtilTest.java
+++ b/src/test/java/net/openhft/chronicle/network/internal/SocketExceptionUtilTest.java
@@ -1,6 +1,7 @@
 package net.openhft.chronicle.network.internal;
 
 import net.openhft.chronicle.core.Jvm;
+import net.openhft.chronicle.network.NetworkTestCommon;
 import net.openhft.chronicle.network.TCPRegistry;
 import net.openhft.chronicle.network.tcp.ChronicleServerSocketChannel;
 import net.openhft.chronicle.network.tcp.ChronicleSocketChannel;
@@ -19,7 +20,7 @@ import java.util.concurrent.Executors;
 import static net.openhft.chronicle.network.internal.SocketExceptionUtil.isAConnectionResetException;
 import static org.junit.Assert.*;
 
-public class SocketExceptionUtilTest {
+public class SocketExceptionUtilTest extends NetworkTestCommon {
 
     /**
      * Original means of detection
@@ -70,8 +71,7 @@ public class SocketExceptionUtilTest {
         ExecutorService executorService = Executors.newSingleThreadExecutor();
         executorService.submit(() -> {
             // Server logic
-            try {
-                final ChronicleSocketChannel csc = serverSocketChannel.accept();
+            try (final ChronicleSocketChannel csc = serverSocketChannel.accept()) {
                 Jvm.pause(100); // make sure the client read has started
                 final Socket socket = csc.socketChannel().socket();
                 socket.setSoLinger(true, 0);
@@ -80,11 +80,15 @@ public class SocketExceptionUtilTest {
                 fail(e.getMessage());
             }
         });
-        final ChronicleSocketChannel clientSocketChannel = ChronicleSocketChannelFactory.wrap(false, TCPRegistry.lookup("server-address"));
-        try {
+        try (final ChronicleSocketChannel clientSocketChannel = ChronicleSocketChannelFactory.wrap(false, TCPRegistry.lookup("server-address"))) {
             clientSocketChannel.read(ByteBuffer.allocate(1000));
+            fail("Read should throw Connection reset exception");
         } catch (IOException e) {
-            assertTrue(isAConnectionResetException(e));
+            final boolean identifiedCorrectly = isAConnectionResetException(e);
+            if (!identifiedCorrectly) {
+                Jvm.error().on(SocketExceptionUtilTest.class, "Didn't identify connection reset exception correctly", e);
+            }
+            assertTrue(identifiedCorrectly);
         }
         Threads.shutdown(executorService);
     }
diff --git a/src/test/java/net/openhft/chronicle/network/internal/lookuptable/FileBasedHostnamePortLookupTableTest.java b/src/test/java/net/openhft/chronicle/network/internal/lookuptable/FileBasedHostnamePortLookupTableTest.java
index 2522edbab3..3e74ba873c 100644
--- a/src/test/java/net/openhft/chronicle/network/internal/lookuptable/FileBasedHostnamePortLookupTableTest.java
+++ b/src/test/java/net/openhft/chronicle/network/internal/lookuptable/FileBasedHostnamePortLookupTableTest.java
@@ -1,8 +1,10 @@
 package net.openhft.chronicle.network.internal.lookuptable;
 
 import net.openhft.chronicle.core.Jvm;
+import net.openhft.chronicle.core.OS;
 import net.openhft.chronicle.core.io.Closeable;
 import net.openhft.chronicle.core.io.IOTools;
+import net.openhft.chronicle.network.NetworkTestCommon;
 import org.junit.After;
 import org.junit.Before;
 import org.junit.Test;
@@ -15,13 +17,16 @@ import java.util.stream.IntStream;
 import static java.lang.String.format;
 import static org.junit.Assert.*;
 
-public class FileBasedHostnamePortLookupTableTest {
+public class FileBasedHostnamePortLookupTableTest extends NetworkTestCommon {
 
     public static final String TEST_TABLE_FILENAME = "FileBasedHostnamePortLookupTableTest";
     private FileBasedHostnamePortLookupTable lookupTable;
 
     @Before
     public void setUp() {
+        if (OS.isWindows()) {
+            expectException("Error deleting the shared lookup table");
+        }
         IOTools.deleteDirWithFilesOrThrow(TEST_TABLE_FILENAME);
         lookupTable = new FileBasedHostnamePortLookupTable(TEST_TABLE_FILENAME);
     }
