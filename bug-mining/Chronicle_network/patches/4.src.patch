diff --git a/src/main/java/net/openhft/chronicle/network/VanillaNetworkContext.java b/src/main/java/net/openhft/chronicle/network/VanillaNetworkContext.java
index f60543987c..be82f3c683 100755
--- a/src/main/java/net/openhft/chronicle/network/VanillaNetworkContext.java
+++ b/src/main/java/net/openhft/chronicle/network/VanillaNetworkContext.java
@@ -180,16 +180,16 @@ public class VanillaNetworkContext<T extends VanillaNetworkContext> implements N
      * @return true if state changed to closed; false if nothing changed.
      */
     protected boolean closeAtomically() {
-        if (isClosed.getAndSet(false)) {
+        if (isClosed.compareAndSet(false, true)) {
             Closeable.closeQuietly(networkStatsListener);
             return true;
         }
         else {
+            //was already closed.
             return false;
         }
     }
 
-
     @Override
     public boolean isClosed() {
         return isClosed.get();
diff --git a/src/test/java/net/openhft/chronicle/network/VanillaNetworkContextTest.java b/src/test/java/net/openhft/chronicle/network/VanillaNetworkContextTest.java
new file mode 100644
index 0000000000..46eb0b1d4a
--- /dev/null
+++ b/src/test/java/net/openhft/chronicle/network/VanillaNetworkContextTest.java
@@ -0,0 +1,28 @@
+package net.openhft.chronicle.network;
+
+import org.junit.Test;
+import static org.junit.Assert.*;
+
+public class VanillaNetworkContextTest {
+
+    @Test
+    public void testCloseAtomically() {
+        final VanillaNetworkContext v = new VanillaNetworkContext();
+        assertEquals(false, v.isClosed());
+        assertEquals(true, v.closeAtomically());
+        assertEquals(true, v.isClosed());
+        assertEquals(false, v.closeAtomically());
+        assertEquals(true, v.isClosed());
+    }
+
+    @Test
+    public void testClose() {
+        final VanillaNetworkContext v = new VanillaNetworkContext();
+        assertEquals(false, v.isClosed());
+        v.close();
+        assertEquals(true, v.isClosed());
+        assertEquals(false, v.closeAtomically());
+        assertEquals(true, v.isClosed());
+    }
+
+}
