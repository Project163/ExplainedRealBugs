{"url":"https://api.github.com/repos/spring-projects/spring-framework/issues/35730","repository_url":"https://api.github.com/repos/spring-projects/spring-framework","labels_url":"https://api.github.com/repos/spring-projects/spring-framework/issues/35730/labels{/name}","comments_url":"https://api.github.com/repos/spring-projects/spring-framework/issues/35730/comments","events_url":"https://api.github.com/repos/spring-projects/spring-framework/issues/35730/events","html_url":"https://github.com/spring-projects/spring-framework/issues/35730","id":3573787797,"node_id":"I_kwDOABGHUc7VA6yV","number":35730,"title":"PathMatchingResourcePatternResolver fails with absolute paths in JAR manifest Class-Path entries","user":{"login":"Artur-","id":260340,"node_id":"MDQ6VXNlcjI2MDM0MA==","avatar_url":"https://avatars.githubusercontent.com/u/260340?v=4","gravatar_id":"","url":"https://api.github.com/users/Artur-","html_url":"https://github.com/Artur-","followers_url":"https://api.github.com/users/Artur-/followers","following_url":"https://api.github.com/users/Artur-/following{/other_user}","gists_url":"https://api.github.com/users/Artur-/gists{/gist_id}","starred_url":"https://api.github.com/users/Artur-/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Artur-/subscriptions","organizations_url":"https://api.github.com/users/Artur-/orgs","repos_url":"https://api.github.com/users/Artur-/repos","events_url":"https://api.github.com/users/Artur-/events{/privacy}","received_events_url":"https://api.github.com/users/Artur-/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1188512000,"node_id":"MDU6TGFiZWwxMTg4NTEyMDAw","url":"https://api.github.com/repos/spring-projects/spring-framework/labels/in:%20core","name":"in: core","color":"e8f9de","default":false,"description":"Issues in core modules (aop, beans, core, context, expression)"},{"id":1189497922,"node_id":"MDU6TGFiZWwxMTg5NDk3OTIy","url":"https://api.github.com/repos/spring-projects/spring-framework/labels/status:%20superseded","name":"status: superseded","color":"fef2c0","default":false,"description":"An issue that has been superseded by another"}],"state":"closed","locked":false,"assignee":{"login":"jhoeller","id":1263688,"node_id":"MDQ6VXNlcjEyNjM2ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1263688?v=4","gravatar_id":"","url":"https://api.github.com/users/jhoeller","html_url":"https://github.com/jhoeller","followers_url":"https://api.github.com/users/jhoeller/followers","following_url":"https://api.github.com/users/jhoeller/following{/other_user}","gists_url":"https://api.github.com/users/jhoeller/gists{/gist_id}","starred_url":"https://api.github.com/users/jhoeller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhoeller/subscriptions","organizations_url":"https://api.github.com/users/jhoeller/orgs","repos_url":"https://api.github.com/users/jhoeller/repos","events_url":"https://api.github.com/users/jhoeller/events{/privacy}","received_events_url":"https://api.github.com/users/jhoeller/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"jhoeller","id":1263688,"node_id":"MDQ6VXNlcjEyNjM2ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1263688?v=4","gravatar_id":"","url":"https://api.github.com/users/jhoeller","html_url":"https://github.com/jhoeller","followers_url":"https://api.github.com/users/jhoeller/followers","following_url":"https://api.github.com/users/jhoeller/following{/other_user}","gists_url":"https://api.github.com/users/jhoeller/gists{/gist_id}","starred_url":"https://api.github.com/users/jhoeller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhoeller/subscriptions","organizations_url":"https://api.github.com/users/jhoeller/orgs","repos_url":"https://api.github.com/users/jhoeller/repos","events_url":"https://api.github.com/users/jhoeller/events{/privacy}","received_events_url":"https://api.github.com/users/jhoeller/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":1,"created_at":"2025-10-31T08:03:25Z","updated_at":"2025-11-01T11:49:13Z","closed_at":"2025-10-31T12:25:45Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"PathMatchingResourcePatternResolver incorrectly rejects absolute paths in JAR manifest Class-Path entries, causing classpath scanning to fail with patterns like `classpath*:**/*.class`.\n\nMinimal reproduction: https://github.com/Artur-/spring-manifest-bug-demo\n\n```sh\ngit clone https://github.com/Artur-/spring-manifest-bug-demo.git\ncd spring-manifest-bug-demo\nmvn dependency:resolve\n./create-classpath-jar.sh\n./run-test.sh\n```\n\nResult:\n- classpath*:**/*.class → 2 classes ❌ (missing dependencies)\n- classpath*:org/**/*.class → 458 classes ✓ (works correctly)\n\n## Root Cause\n\nFile: PathMatchingResourcePatternResolver.java:615\n\n```java\nFile candidate = new File(parent, path);\nif (candidate.isFile() && candidate.getCanonicalPath().contains(parent.getCanonicalPath())) {\n    manifestEntries.add(ClassPathManifestEntry.of(candidate));\n}\n```\n\nThe security check rejects JARs that aren't within the parent directory. However, when Gradle creates a classpath JAR on Windows (to avoid the ~8KB command-line limit), it uses absolute paths to dependency JARs in the user's .gradle/caches/ directory. These are legitimate dependencies, not files that should be restricted to the parent directory.\n\nExample of valid manifest created by Gradle:\nClasspath JAR location: `C:/project/build/tmp/bootRun/classpath.jar`\nManifest Class-Path: `C:/Users/developer/.gradle/caches/modules-2/files-2.1/.../spring-core-6.2.1.jar`\n\nThe code extracts:\n```\nparent = \"C:/project/build/tmp/bootRun/\"  (parent of classpath.jar)\npath = \"C:/Users/developer/.gradle/caches/.../spring-core-6.2.1.jar\"  (from manifest)\n```\n\nThe check fails because the Gradle cache path doesn't contain the bootRun directory path, but these are valid dependency JARs that should be loaded.\n\n##  When This Occurs\n\n  - Windows with Gradle (classpath exceeds ~8KB limit)\n  - IntelliJ IDEA with classpath shortening\n  - Any build tool using absolute paths in manifest Class-Path\n\n\nRelated Issues\n\n- #18260, #28276, #24480\n- vaadin/flow#21051\n","closed_by":{"login":"jhoeller","id":1263688,"node_id":"MDQ6VXNlcjEyNjM2ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1263688?v=4","gravatar_id":"","url":"https://api.github.com/users/jhoeller","html_url":"https://github.com/jhoeller","followers_url":"https://api.github.com/users/jhoeller/followers","following_url":"https://api.github.com/users/jhoeller/following{/other_user}","gists_url":"https://api.github.com/users/jhoeller/gists{/gist_id}","starred_url":"https://api.github.com/users/jhoeller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhoeller/subscriptions","organizations_url":"https://api.github.com/users/jhoeller/orgs","repos_url":"https://api.github.com/users/jhoeller/repos","events_url":"https://api.github.com/users/jhoeller/events{/privacy}","received_events_url":"https://api.github.com/users/jhoeller/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/spring-projects/spring-framework/issues/35730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/spring-projects/spring-framework/issues/35730/timeline","performed_via_github_app":null,"state_reason":"duplicate"}