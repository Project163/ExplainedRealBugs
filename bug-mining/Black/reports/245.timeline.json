[{"id":11268977801,"node_id":"LE_lADOB3dpmM556NtnzwAAAAKfrvSJ","url":"https://api.github.com/repos/psf/black/issues/events/11268977801","actor":{"login":"Feuermurmel","id":50332,"node_id":"MDQ6VXNlcjUwMzMy","avatar_url":"https://avatars.githubusercontent.com/u/50332?v=4","gravatar_id":"","url":"https://api.github.com/users/Feuermurmel","html_url":"https://github.com/Feuermurmel","followers_url":"https://api.github.com/users/Feuermurmel/followers","following_url":"https://api.github.com/users/Feuermurmel/following{/other_user}","gists_url":"https://api.github.com/users/Feuermurmel/gists{/gist_id}","starred_url":"https://api.github.com/users/Feuermurmel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Feuermurmel/subscriptions","organizations_url":"https://api.github.com/users/Feuermurmel/orgs","repos_url":"https://api.github.com/users/Feuermurmel/repos","events_url":"https://api.github.com/users/Feuermurmel/events{/privacy}","received_events_url":"https://api.github.com/users/Feuermurmel/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-12-17T17:31:35Z","label":{"name":"T: bug","color":"d73a4a"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/psf/black/issues/comments/1860443368","html_url":"https://github.com/psf/black/issues/4116#issuecomment-1860443368","issue_url":"https://api.github.com/repos/psf/black/issues/4116","id":1860443368,"node_id":"IC_kwDOB3dpmM5u5Bzo","user":{"login":"Feuermurmel","id":50332,"node_id":"MDQ6VXNlcjUwMzMy","avatar_url":"https://avatars.githubusercontent.com/u/50332?v=4","gravatar_id":"","url":"https://api.github.com/users/Feuermurmel","html_url":"https://github.com/Feuermurmel","followers_url":"https://api.github.com/users/Feuermurmel/followers","following_url":"https://api.github.com/users/Feuermurmel/following{/other_user}","gists_url":"https://api.github.com/users/Feuermurmel/gists{/gist_id}","starred_url":"https://api.github.com/users/Feuermurmel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Feuermurmel/subscriptions","organizations_url":"https://api.github.com/users/Feuermurmel/orgs","repos_url":"https://api.github.com/users/Feuermurmel/repos","events_url":"https://api.github.com/users/Feuermurmel/events{/privacy}","received_events_url":"https://api.github.com/users/Feuermurmel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-18T13:02:43Z","updated_at":"2023-12-19T12:53:58Z","body":"_(moved out of the description)_\r\n\r\nI ran into this bug while writing automated tests for a script that is used to merge branches where `black` has already been applied (e.g. `main`) into feature branches where `black` has not yet been introduced. Some of the tests will switch branches in a test repository and run `black` multiple times, which triggers the situation above.\r\n\r\nI'm assuming that this is the classic problem of detecting file modifications on file systems with low timestamp resolution. My tests are done on APFS, idk what resolution it uses, but it looks like Python only sees whole seconds:\r\n\r\n```\r\n>>> Path('.bash_history').stat()\r\nos.stat_result(st_mode=33152, st_ino=63875, st_dev=16777234, st_nlink=1, st_uid=508, st_gid=20, st_size=571981, st_atime=1702832484, st_mtime=1702832484, st_ctime=1702832484)\r\n```\r\n\r\nLet's say it's `t=100`, the file is updated for the first time and `black` is run. `black` records a timestamp of `100` for the file in its cache, and, while it's still `t=100`, the file is updated again. Now the file's timestamp matches the cache, while the file's content doesn't. `black` can be run at any later time and will not identify the file as having changed.\r\n\r\nThe usual solution to this is to only record a cache entry if the timestamp of the file is strictly older (`<`) than `t`. That way, we can prevent that the file can be changed again without the timestamp also changing. In this example, when it's run the first time, `black` would compare the file's timestamp with the current time (`100`), and, because the timestamp of the file is not  `< 100`, won't record the file in the cache after processing it. That way, the file will definitely be processed again next time.\r\n\r\nI'm not sure what the best way is to get the current time `t`. The above algorithm only works if `t` is queried in a way that applies the same rounding as the current filesystem does. The most reliable way is probably to create some temporary file next to the processed file and `stat()` it.\r\n\r\nAn alterniatve would be to assume some maximum error due to rounding (e.g. 2 seconds) and then subtract that from `t` before using it to decide whether to record a file in the cache (i.e. only record the file if it's timestamp is `< t - 2s`).","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/psf/black/issues/comments/1860443368/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Feuermurmel","id":50332,"node_id":"MDQ6VXNlcjUwMzMy","avatar_url":"https://avatars.githubusercontent.com/u/50332?v=4","gravatar_id":"","url":"https://api.github.com/users/Feuermurmel","html_url":"https://github.com/Feuermurmel","followers_url":"https://api.github.com/users/Feuermurmel/followers","following_url":"https://api.github.com/users/Feuermurmel/following{/other_user}","gists_url":"https://api.github.com/users/Feuermurmel/gists{/gist_id}","starred_url":"https://api.github.com/users/Feuermurmel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Feuermurmel/subscriptions","organizations_url":"https://api.github.com/users/Feuermurmel/orgs","repos_url":"https://api.github.com/users/Feuermurmel/repos","events_url":"https://api.github.com/users/Feuermurmel/events{/privacy}","received_events_url":"https://api.github.com/users/Feuermurmel/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/psf/black/issues/comments/1868782685","html_url":"https://github.com/psf/black/issues/4116#issuecomment-1868782685","issue_url":"https://api.github.com/repos/psf/black/issues/4116","id":1868782685,"node_id":"IC_kwDOB3dpmM5vY1xd","user":{"login":"hauntsaninja","id":12621235,"node_id":"MDQ6VXNlcjEyNjIxMjM1","avatar_url":"https://avatars.githubusercontent.com/u/12621235?v=4","gravatar_id":"","url":"https://api.github.com/users/hauntsaninja","html_url":"https://github.com/hauntsaninja","followers_url":"https://api.github.com/users/hauntsaninja/followers","following_url":"https://api.github.com/users/hauntsaninja/following{/other_user}","gists_url":"https://api.github.com/users/hauntsaninja/gists{/gist_id}","starred_url":"https://api.github.com/users/hauntsaninja/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hauntsaninja/subscriptions","organizations_url":"https://api.github.com/users/hauntsaninja/orgs","repos_url":"https://api.github.com/users/hauntsaninja/repos","events_url":"https://api.github.com/users/hauntsaninja/events{/privacy}","received_events_url":"https://api.github.com/users/hauntsaninja/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-25T06:34:46Z","updated_at":"2023-12-25T06:36:26Z","body":"Thanks for the issue!\r\n\r\nNote that Python seems to print st_mtime rounded when it isn't necessarily:\r\n```\r\n>>> Path('README.md').stat()\r\nos.stat_result(st_mode=33188, st_ino=130742331, st_dev=16777233, st_nlink=1, st_uid=502, st_gid=20, st_size=9778, st_atime=1698998129, st_mtime=1698998129, st_ctime=1698998129)\r\n>>> Path('README.md').stat().st_mtime\r\n1698998129.3546484\r\n```\r\n\r\nI think this is a regression ‚Äî @cdce8p do you remember why https://github.com/psf/black/pull/3821 starts rounding mtimes in the cache? I'm guessing you were copying logic inside mypy, which based on https://github.com/python/mypy/commit/f63ccbba3ec614f363b2872f3a8d40d1328d30f7 I'm thinking doesn't really applies to black? Opened https://github.com/psf/black/pull/4128 to remove it, let me know what you think","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/psf/black/issues/comments/1868782685/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"hauntsaninja","id":12621235,"node_id":"MDQ6VXNlcjEyNjIxMjM1","avatar_url":"https://avatars.githubusercontent.com/u/12621235?v=4","gravatar_id":"","url":"https://api.github.com/users/hauntsaninja","html_url":"https://github.com/hauntsaninja","followers_url":"https://api.github.com/users/hauntsaninja/followers","following_url":"https://api.github.com/users/hauntsaninja/following{/other_user}","gists_url":"https://api.github.com/users/hauntsaninja/gists{/gist_id}","starred_url":"https://api.github.com/users/hauntsaninja/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hauntsaninja/subscriptions","organizations_url":"https://api.github.com/users/hauntsaninja/orgs","repos_url":"https://api.github.com/users/hauntsaninja/repos","events_url":"https://api.github.com/users/hauntsaninja/events{/privacy}","received_events_url":"https://api.github.com/users/hauntsaninja/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11334176882,"node_id":"MEE_lADOB3dpmM556NtnzwAAAAKjkdBy","url":"https://api.github.com/repos/psf/black/issues/events/11334176882","actor":{"login":"cdce8p","id":30130371,"node_id":"MDQ6VXNlcjMwMTMwMzcx","avatar_url":"https://avatars.githubusercontent.com/u/30130371?v=4","gravatar_id":"","url":"https://api.github.com/users/cdce8p","html_url":"https://github.com/cdce8p","followers_url":"https://api.github.com/users/cdce8p/followers","following_url":"https://api.github.com/users/cdce8p/following{/other_user}","gists_url":"https://api.github.com/users/cdce8p/gists{/gist_id}","starred_url":"https://api.github.com/users/cdce8p/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdce8p/subscriptions","organizations_url":"https://api.github.com/users/cdce8p/orgs","repos_url":"https://api.github.com/users/cdce8p/repos","events_url":"https://api.github.com/users/cdce8p/events{/privacy}","received_events_url":"https://api.github.com/users/cdce8p/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-12-25T06:34:46Z","performed_via_github_app":null},{"id":11334176887,"node_id":"SE_lADOB3dpmM556NtnzwAAAAKjkdB3","url":"https://api.github.com/repos/psf/black/issues/events/11334176887","actor":{"login":"cdce8p","id":30130371,"node_id":"MDQ6VXNlcjMwMTMwMzcx","avatar_url":"https://avatars.githubusercontent.com/u/30130371?v=4","gravatar_id":"","url":"https://api.github.com/users/cdce8p","html_url":"https://github.com/cdce8p","followers_url":"https://api.github.com/users/cdce8p/followers","following_url":"https://api.github.com/users/cdce8p/following{/other_user}","gists_url":"https://api.github.com/users/cdce8p/gists{/gist_id}","starred_url":"https://api.github.com/users/cdce8p/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdce8p/subscriptions","organizations_url":"https://api.github.com/users/cdce8p/orgs","repos_url":"https://api.github.com/users/cdce8p/repos","events_url":"https://api.github.com/users/cdce8p/events{/privacy}","received_events_url":"https://api.github.com/users/cdce8p/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-12-25T06:34:46Z","performed_via_github_app":null},{"id":11334180649,"node_id":"REFE_lADOB3dpmM556NtnzwAAAAKjkd8p","url":"https://api.github.com/repos/psf/black/issues/events/11334180649","actor":{"login":"hauntsaninja","id":12621235,"node_id":"MDQ6VXNlcjEyNjIxMjM1","avatar_url":"https://avatars.githubusercontent.com/u/12621235?v=4","gravatar_id":"","url":"https://api.github.com/users/hauntsaninja","html_url":"https://github.com/hauntsaninja","followers_url":"https://api.github.com/users/hauntsaninja/followers","following_url":"https://api.github.com/users/hauntsaninja/following{/other_user}","gists_url":"https://api.github.com/users/hauntsaninja/gists{/gist_id}","starred_url":"https://api.github.com/users/hauntsaninja/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hauntsaninja/subscriptions","organizations_url":"https://api.github.com/users/hauntsaninja/orgs","repos_url":"https://api.github.com/users/hauntsaninja/repos","events_url":"https://api.github.com/users/hauntsaninja/events{/privacy}","received_events_url":"https://api.github.com/users/hauntsaninja/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"ed5e79c315208eac8265517eec85194a063e139d","commit_url":"https://api.github.com/repos/hauntsaninja/black/commits/ed5e79c315208eac8265517eec85194a063e139d","created_at":"2023-12-25T06:36:01Z","performed_via_github_app":null},{"actor":{"login":"hauntsaninja","id":12621235,"node_id":"MDQ6VXNlcjEyNjIxMjM1","avatar_url":"https://avatars.githubusercontent.com/u/12621235?v=4","gravatar_id":"","url":"https://api.github.com/users/hauntsaninja","html_url":"https://github.com/hauntsaninja","followers_url":"https://api.github.com/users/hauntsaninja/followers","following_url":"https://api.github.com/users/hauntsaninja/following{/other_user}","gists_url":"https://api.github.com/users/hauntsaninja/gists{/gist_id}","starred_url":"https://api.github.com/users/hauntsaninja/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hauntsaninja/subscriptions","organizations_url":"https://api.github.com/users/hauntsaninja/orgs","repos_url":"https://api.github.com/users/hauntsaninja/repos","events_url":"https://api.github.com/users/hauntsaninja/events{/privacy}","received_events_url":"https://api.github.com/users/hauntsaninja/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-25T06:36:08Z","updated_at":"2023-12-25T06:36:08Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/psf/black/issues/4128","repository_url":"https://api.github.com/repos/psf/black","labels_url":"https://api.github.com/repos/psf/black/issues/4128/labels{/name}","comments_url":"https://api.github.com/repos/psf/black/issues/4128/comments","events_url":"https://api.github.com/repos/psf/black/issues/4128/events","html_url":"https://github.com/psf/black/pull/4128","id":2055432090,"node_id":"PR_kwDOB3dpmM5iupVh","number":4128,"title":"Do not round cache mtimes","user":{"login":"hauntsaninja","id":12621235,"node_id":"MDQ6VXNlcjEyNjIxMjM1","avatar_url":"https://avatars.githubusercontent.com/u/12621235?v=4","gravatar_id":"","url":"https://api.github.com/users/hauntsaninja","html_url":"https://github.com/hauntsaninja","followers_url":"https://api.github.com/users/hauntsaninja/followers","following_url":"https://api.github.com/users/hauntsaninja/following{/other_user}","gists_url":"https://api.github.com/users/hauntsaninja/gists{/gist_id}","starred_url":"https://api.github.com/users/hauntsaninja/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hauntsaninja/subscriptions","organizations_url":"https://api.github.com/users/hauntsaninja/orgs","repos_url":"https://api.github.com/users/hauntsaninja/repos","events_url":"https://api.github.com/users/hauntsaninja/events{/privacy}","received_events_url":"https://api.github.com/users/hauntsaninja/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-12-25T06:36:08Z","updated_at":"2023-12-28T06:25:00Z","closed_at":"2023-12-28T06:24:57Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":125266328,"node_id":"MDEwOlJlcG9zaXRvcnkxMjUyNjYzMjg=","name":"black","full_name":"psf/black","private":false,"owner":{"login":"psf","id":50630501,"node_id":"MDEyOk9yZ2FuaXphdGlvbjUwNjMwNTAx","avatar_url":"https://avatars.githubusercontent.com/u/50630501?v=4","gravatar_id":"","url":"https://api.github.com/users/psf","html_url":"https://github.com/psf","followers_url":"https://api.github.com/users/psf/followers","following_url":"https://api.github.com/users/psf/following{/other_user}","gists_url":"https://api.github.com/users/psf/gists{/gist_id}","starred_url":"https://api.github.com/users/psf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/psf/subscriptions","organizations_url":"https://api.github.com/users/psf/orgs","repos_url":"https://api.github.com/users/psf/repos","events_url":"https://api.github.com/users/psf/events{/privacy}","received_events_url":"https://api.github.com/users/psf/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/psf/black","description":"The uncompromising Python code formatter","fork":false,"url":"https://api.github.com/repos/psf/black","forks_url":"https://api.github.com/repos/psf/black/forks","keys_url":"https://api.github.com/repos/psf/black/keys{/key_id}","collaborators_url":"https://api.github.com/repos/psf/black/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/psf/black/teams","hooks_url":"https://api.github.com/repos/psf/black/hooks","issue_events_url":"https://api.github.com/repos/psf/black/issues/events{/number}","events_url":"https://api.github.com/repos/psf/black/events","assignees_url":"https://api.github.com/repos/psf/black/assignees{/user}","branches_url":"https://api.github.com/repos/psf/black/branches{/branch}","tags_url":"https://api.github.com/repos/psf/black/tags","blobs_url":"https://api.github.com/repos/psf/black/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/psf/black/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/psf/black/git/refs{/sha}","trees_url":"https://api.github.com/repos/psf/black/git/trees{/sha}","statuses_url":"https://api.github.com/repos/psf/black/statuses/{sha}","languages_url":"https://api.github.com/repos/psf/black/languages","stargazers_url":"https://api.github.com/repos/psf/black/stargazers","contributors_url":"https://api.github.com/repos/psf/black/contributors","subscribers_url":"https://api.github.com/repos/psf/black/subscribers","subscription_url":"https://api.github.com/repos/psf/black/subscription","commits_url":"https://api.github.com/repos/psf/black/commits{/sha}","git_commits_url":"https://api.github.com/repos/psf/black/git/commits{/sha}","comments_url":"https://api.github.com/repos/psf/black/comments{/number}","issue_comment_url":"https://api.github.com/repos/psf/black/issues/comments{/number}","contents_url":"https://api.github.com/repos/psf/black/contents/{+path}","compare_url":"https://api.github.com/repos/psf/black/compare/{base}...{head}","merges_url":"https://api.github.com/repos/psf/black/merges","archive_url":"https://api.github.com/repos/psf/black/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/psf/black/downloads","issues_url":"https://api.github.com/repos/psf/black/issues{/number}","pulls_url":"https://api.github.com/repos/psf/black/pulls{/number}","milestones_url":"https://api.github.com/repos/psf/black/milestones{/number}","notifications_url":"https://api.github.com/repos/psf/black/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/psf/black/labels{/name}","releases_url":"https://api.github.com/repos/psf/black/releases{/id}","deployments_url":"https://api.github.com/repos/psf/black/deployments","created_at":"2018-03-14T19:54:45Z","updated_at":"2025-11-09T16:48:04Z","pushed_at":"2025-11-05T18:14:18Z","git_url":"git://github.com/psf/black.git","ssh_url":"git@github.com:psf/black.git","clone_url":"https://github.com/psf/black.git","svn_url":"https://github.com/psf/black","homepage":"https://black.readthedocs.io/en/stable/","size":7569,"stargazers_count":41126,"watchers_count":41126,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":2665,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":337,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["autopep8","code","codeformatter","formatter","gofmt","hacktoberfest","pre-commit-hook","python","yapf"],"visibility":"public","forks":2665,"open_issues":337,"watchers":41126,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/psf/black/pulls/4128","html_url":"https://github.com/psf/black/pull/4128","diff_url":"https://github.com/psf/black/pull/4128.diff","patch_url":"https://github.com/psf/black/pull/4128.patch","merged_at":"2023-12-28T06:24:57Z"},"body":"Fixes #4116\r\n\r\nThis logic was introduced in #3821, I believe as a result of copying logic inside mypy that I think isn't relevant to Black","reactions":{"url":"https://api.github.com/repos/psf/black/issues/4128/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/psf/black/issues/4128/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/psf/black/issues/comments/1868845509","html_url":"https://github.com/psf/black/issues/4116#issuecomment-1868845509","issue_url":"https://api.github.com/repos/psf/black/issues/4116","id":1868845509,"node_id":"IC_kwDOB3dpmM5vZFHF","user":{"login":"cdce8p","id":30130371,"node_id":"MDQ6VXNlcjMwMTMwMzcx","avatar_url":"https://avatars.githubusercontent.com/u/30130371?v=4","gravatar_id":"","url":"https://api.github.com/users/cdce8p","html_url":"https://github.com/cdce8p","followers_url":"https://api.github.com/users/cdce8p/followers","following_url":"https://api.github.com/users/cdce8p/following{/other_user}","gists_url":"https://api.github.com/users/cdce8p/gists{/gist_id}","starred_url":"https://api.github.com/users/cdce8p/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdce8p/subscriptions","organizations_url":"https://api.github.com/users/cdce8p/orgs","repos_url":"https://api.github.com/users/cdce8p/repos","events_url":"https://api.github.com/users/cdce8p/events{/privacy}","received_events_url":"https://api.github.com/users/cdce8p/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-25T08:16:14Z","updated_at":"2023-12-25T08:16:14Z","body":"> @cdce8p do you remember why #3821 starts rounding mtimes in the cache? I'm guessing you were copying logic inside mypy, which based on [python/mypy@f63ccbb](https://github.com/python/mypy/commit/f63ccbba3ec614f363b2872f3a8d40d1328d30f7) I'm thinking doesn't really applies to black? Opened #4128 to remove it, let me know what you think\r\n\r\nYeah, I looked at the mypy implementation when I added that feature to black. My best guess (why mypy is doing so) is that it might help reduce the overall cache size if the mtimes are stored as integers instead of floats. IIRC that's also what I had in mind for black but alas I never seem to have added it. Removing the int conversion in #4128 seems fine to me.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/psf/black/issues/comments/1868845509/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"cdce8p","id":30130371,"node_id":"MDQ6VXNlcjMwMTMwMzcx","avatar_url":"https://avatars.githubusercontent.com/u/30130371?v=4","gravatar_id":"","url":"https://api.github.com/users/cdce8p","html_url":"https://github.com/cdce8p","followers_url":"https://api.github.com/users/cdce8p/followers","following_url":"https://api.github.com/users/cdce8p/following{/other_user}","gists_url":"https://api.github.com/users/cdce8p/gists{/gist_id}","starred_url":"https://api.github.com/users/cdce8p/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdce8p/subscriptions","organizations_url":"https://api.github.com/users/cdce8p/orgs","repos_url":"https://api.github.com/users/cdce8p/repos","events_url":"https://api.github.com/users/cdce8p/events{/privacy}","received_events_url":"https://api.github.com/users/cdce8p/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11334573827,"node_id":"MEE_lADOB3dpmM556NtnzwAAAAKjl98D","url":"https://api.github.com/repos/psf/black/issues/events/11334573827","actor":{"login":"cdce8p","id":30130371,"node_id":"MDQ6VXNlcjMwMTMwMzcx","avatar_url":"https://avatars.githubusercontent.com/u/30130371?v=4","gravatar_id":"","url":"https://api.github.com/users/cdce8p","html_url":"https://github.com/cdce8p","followers_url":"https://api.github.com/users/cdce8p/followers","following_url":"https://api.github.com/users/cdce8p/following{/other_user}","gists_url":"https://api.github.com/users/cdce8p/gists{/gist_id}","starred_url":"https://api.github.com/users/cdce8p/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdce8p/subscriptions","organizations_url":"https://api.github.com/users/cdce8p/orgs","repos_url":"https://api.github.com/users/cdce8p/repos","events_url":"https://api.github.com/users/cdce8p/events{/privacy}","received_events_url":"https://api.github.com/users/cdce8p/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-12-25T08:16:14Z","performed_via_github_app":null},{"id":11334573836,"node_id":"SE_lADOB3dpmM556NtnzwAAAAKjl98M","url":"https://api.github.com/repos/psf/black/issues/events/11334573836","actor":{"login":"cdce8p","id":30130371,"node_id":"MDQ6VXNlcjMwMTMwMzcx","avatar_url":"https://avatars.githubusercontent.com/u/30130371?v=4","gravatar_id":"","url":"https://api.github.com/users/cdce8p","html_url":"https://github.com/cdce8p","followers_url":"https://api.github.com/users/cdce8p/followers","following_url":"https://api.github.com/users/cdce8p/following{/other_user}","gists_url":"https://api.github.com/users/cdce8p/gists{/gist_id}","starred_url":"https://api.github.com/users/cdce8p/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdce8p/subscriptions","organizations_url":"https://api.github.com/users/cdce8p/orgs","repos_url":"https://api.github.com/users/cdce8p/repos","events_url":"https://api.github.com/users/cdce8p/events{/privacy}","received_events_url":"https://api.github.com/users/cdce8p/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-12-25T08:16:14Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/psf/black/issues/comments/1868944833","html_url":"https://github.com/psf/black/issues/4116#issuecomment-1868944833","issue_url":"https://api.github.com/repos/psf/black/issues/4116","id":1868944833,"node_id":"IC_kwDOB3dpmM5vZdXB","user":{"login":"Feuermurmel","id":50332,"node_id":"MDQ6VXNlcjUwMzMy","avatar_url":"https://avatars.githubusercontent.com/u/50332?v=4","gravatar_id":"","url":"https://api.github.com/users/Feuermurmel","html_url":"https://github.com/Feuermurmel","followers_url":"https://api.github.com/users/Feuermurmel/followers","following_url":"https://api.github.com/users/Feuermurmel/following{/other_user}","gists_url":"https://api.github.com/users/Feuermurmel/gists{/gist_id}","starred_url":"https://api.github.com/users/Feuermurmel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Feuermurmel/subscriptions","organizations_url":"https://api.github.com/users/Feuermurmel/orgs","repos_url":"https://api.github.com/users/Feuermurmel/repos","events_url":"https://api.github.com/users/Feuermurmel/events{/privacy}","received_events_url":"https://api.github.com/users/Feuermurmel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-25T11:42:09Z","updated_at":"2023-12-25T11:42:09Z","body":"https://github.com/psf/black/pull/4128 indeed fixes the behavior!\r\n\r\n```\r\n$ pip3 install --force-reinstall git+ssh://git@github.com/hauntsaninja/black.git@cache-rounding\r\n[...]\r\n$ ./bug.sh \r\n+ echo 'print (1)'\r\n+ black file.py\r\nreformatted file.py\r\n\r\nAll done! ‚ú® üç∞ ‚ú®\r\n1 file reformatted.\r\n+ echo 'print ()'\r\n+ black file.py\r\nreformatted file.py\r\n\r\nAll done! ‚ú® üç∞ ‚ú®\r\n1 file reformatted.\r\n+ cat file.py\r\nprint()\r\n```\r\n\r\n(no space between `print` and `()` on last line)","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/psf/black/issues/comments/1868944833/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Feuermurmel","id":50332,"node_id":"MDQ6VXNlcjUwMzMy","avatar_url":"https://avatars.githubusercontent.com/u/50332?v=4","gravatar_id":"","url":"https://api.github.com/users/Feuermurmel","html_url":"https://github.com/Feuermurmel","followers_url":"https://api.github.com/users/Feuermurmel/followers","following_url":"https://api.github.com/users/Feuermurmel/following{/other_user}","gists_url":"https://api.github.com/users/Feuermurmel/gists{/gist_id}","starred_url":"https://api.github.com/users/Feuermurmel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Feuermurmel/subscriptions","organizations_url":"https://api.github.com/users/Feuermurmel/orgs","repos_url":"https://api.github.com/users/Feuermurmel/repos","events_url":"https://api.github.com/users/Feuermurmel/events{/privacy}","received_events_url":"https://api.github.com/users/Feuermurmel/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11348775953,"node_id":"CE_lADOB3dpmM556NtnzwAAAAKkcJQR","url":"https://api.github.com/repos/psf/black/issues/events/11348775953","actor":{"login":"hauntsaninja","id":12621235,"node_id":"MDQ6VXNlcjEyNjIxMjM1","avatar_url":"https://avatars.githubusercontent.com/u/12621235?v=4","gravatar_id":"","url":"https://api.github.com/users/hauntsaninja","html_url":"https://github.com/hauntsaninja","followers_url":"https://api.github.com/users/hauntsaninja/followers","following_url":"https://api.github.com/users/hauntsaninja/following{/other_user}","gists_url":"https://api.github.com/users/hauntsaninja/gists{/gist_id}","starred_url":"https://api.github.com/users/hauntsaninja/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hauntsaninja/subscriptions","organizations_url":"https://api.github.com/users/hauntsaninja/orgs","repos_url":"https://api.github.com/users/hauntsaninja/repos","events_url":"https://api.github.com/users/hauntsaninja/events{/privacy}","received_events_url":"https://api.github.com/users/hauntsaninja/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2023-12-28T06:24:58Z","state_reason":null,"performed_via_github_app":null},{"id":11348776004,"node_id":"REFE_lADOB3dpmM556NtnzwAAAAKkcJRE","url":"https://api.github.com/repos/psf/black/issues/events/11348776004","actor":{"login":"hauntsaninja","id":12621235,"node_id":"MDQ6VXNlcjEyNjIxMjM1","avatar_url":"https://avatars.githubusercontent.com/u/12621235?v=4","gravatar_id":"","url":"https://api.github.com/users/hauntsaninja","html_url":"https://github.com/hauntsaninja","followers_url":"https://api.github.com/users/hauntsaninja/followers","following_url":"https://api.github.com/users/hauntsaninja/following{/other_user}","gists_url":"https://api.github.com/users/hauntsaninja/gists{/gist_id}","starred_url":"https://api.github.com/users/hauntsaninja/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hauntsaninja/subscriptions","organizations_url":"https://api.github.com/users/hauntsaninja/orgs","repos_url":"https://api.github.com/users/hauntsaninja/repos","events_url":"https://api.github.com/users/hauntsaninja/events{/privacy}","received_events_url":"https://api.github.com/users/hauntsaninja/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"bf6cabc8049cbdf4d0b8af33134317a0190a614f","commit_url":"https://api.github.com/repos/psf/black/commits/bf6cabc8049cbdf4d0b8af33134317a0190a614f","created_at":"2023-12-28T06:24:59Z","performed_via_github_app":null}]