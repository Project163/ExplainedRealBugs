{"url":"https://api.github.com/repos/psf/black/issues/2293","repository_url":"https://api.github.com/repos/psf/black","labels_url":"https://api.github.com/repos/psf/black/issues/2293/labels{/name}","comments_url":"https://api.github.com/repos/psf/black/issues/2293/comments","events_url":"https://api.github.com/repos/psf/black/issues/2293/events","html_url":"https://github.com/psf/black/issues/2293","id":907651776,"node_id":"MDU6SXNzdWU5MDc2NTE3NzY=","number":2293,"title":"String processing doesn't respect existing code formatting for f-strings","user":{"login":"Jackenmen","id":6032823,"node_id":"MDQ6VXNlcjYwMzI4MjM=","avatar_url":"https://avatars.githubusercontent.com/u/6032823?v=4","gravatar_id":"","url":"https://api.github.com/users/Jackenmen","html_url":"https://github.com/Jackenmen","followers_url":"https://api.github.com/users/Jackenmen/followers","following_url":"https://api.github.com/users/Jackenmen/following{/other_user}","gists_url":"https://api.github.com/users/Jackenmen/gists{/gist_id}","starred_url":"https://api.github.com/users/Jackenmen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jackenmen/subscriptions","organizations_url":"https://api.github.com/users/Jackenmen/orgs","repos_url":"https://api.github.com/users/Jackenmen/repos","events_url":"https://api.github.com/users/Jackenmen/events{/privacy}","received_events_url":"https://api.github.com/users/Jackenmen/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2021-05-31T18:25:22Z","updated_at":"2021-06-07T14:03:39Z","closed_at":"2021-06-07T14:03:39Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Describe the bug**\r\n\r\nThere is some issue with how Black splits the string if at least one of them is an f-string.\r\n\r\n**To Reproduce**\r\n\r\nFor example:\r\n1. Take this file:\r\n```py\r\nmessage = (\r\n    f\"1. Go to Google Developers Console and log in with your Google account.\"\r\n    \"(https://console.developers.google.com/)\"\r\n    \"2. You should be prompted to create a new project (name does not matter).\"\r\n    \"3. Click on Enable APIs and Services at the top.\"\r\n    \"4. In the list of APIs choose or search for YouTube Data API v3 and \"\r\n    \"click on it. Choose Enable.\"\r\n    \"5. Click on Credentials on the left navigation bar.\"\r\n    \"6. Click on Create Credential at the top.\"\r\n    '7. At the top click the link for \"API key\".'\r\n    \"8. No application restrictions are needed. Click Create at the bottom.\"\r\n    \"9. You now have a key to add to `{prefix}set api youtube api_key`\"\r\n)\r\n```\r\n2. Run _Black_ on it with `--experimental-string-processing` flag\r\n3. See rather bad formatting even though the original respected line length:\r\n```py\r\nmessage = (\r\n    f\"1. Go to Google Developers Console and log in with your Google account.\"\r\n    f\"(https://console.developers.google.com/\"\r\n    f\")2. You should be prompted to create a new project (name does not matter\"\r\n    f\").3. Click on Enable APIs and Services at the t\"\r\n    f\"op.4. In the list of APIs choose or search for YouTube Data API v3 \"\r\n    f\"and click on it. Choose En\"\r\n    f\"able.5. Click on Credentials on the left navigatio\"\r\n    f\"n bar.6. Click on Create Credential at t\"\r\n    f'he top.7. At the top click the link for \"A'\r\n    f'PI key\".8. No application restrictions are needed. Click Create at th'\r\n    f\"e bottom.9. You now have a key to add to `{{prefix}}set api youtube api_key`\"\r\n)\r\n```\r\nI'm also not sure why it splits in the middle of the word?\r\n\r\n**Expected behavior**\r\n\r\nNo \r\n\r\n**Environment (please complete the following information):**\r\n\r\n- Version: main (cf75673 at the time of testing)\r\n- OS and Python version: Windows 10/Python 3.8.9\r\n\r\n**Does this bug also happen on main?**\r\n\r\nYes\r\n\r\n**Additional context**\r\n\r\nN/A\r\n","closed_by":{"login":"JelleZijlstra","id":906600,"node_id":"MDQ6VXNlcjkwNjYwMA==","avatar_url":"https://avatars.githubusercontent.com/u/906600?v=4","gravatar_id":"","url":"https://api.github.com/users/JelleZijlstra","html_url":"https://github.com/JelleZijlstra","followers_url":"https://api.github.com/users/JelleZijlstra/followers","following_url":"https://api.github.com/users/JelleZijlstra/following{/other_user}","gists_url":"https://api.github.com/users/JelleZijlstra/gists{/gist_id}","starred_url":"https://api.github.com/users/JelleZijlstra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JelleZijlstra/subscriptions","organizations_url":"https://api.github.com/users/JelleZijlstra/orgs","repos_url":"https://api.github.com/users/JelleZijlstra/repos","events_url":"https://api.github.com/users/JelleZijlstra/events{/privacy}","received_events_url":"https://api.github.com/users/JelleZijlstra/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/psf/black/issues/2293/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"timeline_url":"https://api.github.com/repos/psf/black/issues/2293/timeline","performed_via_github_app":null,"state_reason":"completed"}