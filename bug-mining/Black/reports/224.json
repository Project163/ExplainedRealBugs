{"url":"https://api.github.com/repos/psf/black/issues/3532","repository_url":"https://api.github.com/repos/psf/black","labels_url":"https://api.github.com/repos/psf/black/issues/3532/labels{/name}","comments_url":"https://api.github.com/repos/psf/black/issues/3532/comments","events_url":"https://api.github.com/repos/psf/black/issues/3532/events","html_url":"https://github.com/psf/black/issues/3532","id":1562140450,"node_id":"I_kwDOB3dpmM5dHF8i","number":3532,"title":"Preview crashes on await (yield)","user":{"login":"jakkdl","id":11260241,"node_id":"MDQ6VXNlcjExMjYwMjQx","avatar_url":"https://avatars.githubusercontent.com/u/11260241?v=4","gravatar_id":"","url":"https://api.github.com/users/jakkdl","html_url":"https://github.com/jakkdl","followers_url":"https://api.github.com/users/jakkdl/followers","following_url":"https://api.github.com/users/jakkdl/following{/other_user}","gists_url":"https://api.github.com/users/jakkdl/gists{/gist_id}","starred_url":"https://api.github.com/users/jakkdl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jakkdl/subscriptions","organizations_url":"https://api.github.com/users/jakkdl/orgs","repos_url":"https://api.github.com/users/jakkdl/repos","events_url":"https://api.github.com/users/jakkdl/events{/privacy}","received_events_url":"https://api.github.com/users/jakkdl/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":867432792,"node_id":"MDU6TGFiZWw4Njc0MzI3OTI=","url":"https://api.github.com/repos/psf/black/labels/T:%20bug","name":"T: bug","color":"d73a4a","default":false,"description":"Something isn't working"},{"id":2272618118,"node_id":"MDU6TGFiZWwyMjcyNjE4MTE4","url":"https://api.github.com/repos/psf/black/labels/C:%20crash","name":"C: crash","color":"ff0000","default":false,"description":"Black is crashing"},{"id":4923632282,"node_id":"LA_kwDOB3dpmM8AAAABJXiqmg","url":"https://api.github.com/repos/psf/black/labels/C:%20preview%20style","name":"C: preview style","color":"E4C5D3","default":false,"description":"Issues with the preview and unstable style. Add the name of the responsible feature in the title."}],"state":"closed","locked":false,"assignee":{"login":"ichard26","id":63936253,"node_id":"MDQ6VXNlcjYzOTM2MjUz","avatar_url":"https://avatars.githubusercontent.com/u/63936253?v=4","gravatar_id":"","url":"https://api.github.com/users/ichard26","html_url":"https://github.com/ichard26","followers_url":"https://api.github.com/users/ichard26/followers","following_url":"https://api.github.com/users/ichard26/following{/other_user}","gists_url":"https://api.github.com/users/ichard26/gists{/gist_id}","starred_url":"https://api.github.com/users/ichard26/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ichard26/subscriptions","organizations_url":"https://api.github.com/users/ichard26/orgs","repos_url":"https://api.github.com/users/ichard26/repos","events_url":"https://api.github.com/users/ichard26/events{/privacy}","received_events_url":"https://api.github.com/users/ichard26/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"ichard26","id":63936253,"node_id":"MDQ6VXNlcjYzOTM2MjUz","avatar_url":"https://avatars.githubusercontent.com/u/63936253?v=4","gravatar_id":"","url":"https://api.github.com/users/ichard26","html_url":"https://github.com/ichard26","followers_url":"https://api.github.com/users/ichard26/followers","following_url":"https://api.github.com/users/ichard26/following{/other_user}","gists_url":"https://api.github.com/users/ichard26/gists{/gist_id}","starred_url":"https://api.github.com/users/ichard26/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ichard26/subscriptions","organizations_url":"https://api.github.com/users/ichard26/orgs","repos_url":"https://api.github.com/users/ichard26/repos","events_url":"https://api.github.com/users/ichard26/events{/privacy}","received_events_url":"https://api.github.com/users/ichard26/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":3,"created_at":"2023-01-30T10:17:14Z","updated_at":"2023-01-31T09:26:45Z","closed_at":"2023-01-31T02:53:16Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"\r\n\r\n**Describe the bug**\r\n`black --preview` crashes on seeing `await (yield)`\r\nThis is certainly not good code or anything, but is code we have [in one of our test files](https://github.com/Zac-HD/flake8-trio/blob/ec04f75f6c58515f58316870272fab315b828a35/tests/eval_files/trio108.py#L31-L34) in flake8-trio. Non-preview black has no issues with it.\r\n\r\n**To Reproduce**\r\n\r\n\r\nFor example, take this code:\r\n\r\n```python\r\nasync def foo():\r\n    await (yield)\r\n```\r\n\r\nAnd run it with these arguments:\r\n\r\n```sh\r\n$ black --preview myfile.py \r\n```\r\n\r\nThe resulting error is:\r\n\r\n```\r\nerror: cannot format myfile.py: blib2to3.pytree.Node object expected; got blib2to3.pytree.Leaf\r\n\r\nOh no! ðŸ’¥ ðŸ’” ðŸ’¥\r\n1 file failed to reformat.\r\n```\r\n\r\n**Expected behavior**\r\n\r\nNot crashing\r\n\r\n**Environment**\r\n\r\n<!-- Please complete the following information: -->\r\n```sh\r\n$ black --version\r\nblack, 22.12.0 (compiled: yes)\r\nPython (CPython) 3.11.0\r\n$ python --version\r\nPython 3.11.0\r\n$ uname -sro\r\nLinux 6.1.1-arch1-1 GNU/Linux\r\n```","closed_by":{"login":"ichard26","id":63936253,"node_id":"MDQ6VXNlcjYzOTM2MjUz","avatar_url":"https://avatars.githubusercontent.com/u/63936253?v=4","gravatar_id":"","url":"https://api.github.com/users/ichard26","html_url":"https://github.com/ichard26","followers_url":"https://api.github.com/users/ichard26/followers","following_url":"https://api.github.com/users/ichard26/following{/other_user}","gists_url":"https://api.github.com/users/ichard26/gists{/gist_id}","starred_url":"https://api.github.com/users/ichard26/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ichard26/subscriptions","organizations_url":"https://api.github.com/users/ichard26/orgs","repos_url":"https://api.github.com/users/ichard26/repos","events_url":"https://api.github.com/users/ichard26/events{/privacy}","received_events_url":"https://api.github.com/users/ichard26/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/psf/black/issues/3532/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/psf/black/issues/3532/timeline","performed_via_github_app":null,"state_reason":"completed"}