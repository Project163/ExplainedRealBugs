{"url":"https://api.github.com/repos/obsproject/obs-studio/issues/9733","repository_url":"https://api.github.com/repos/obsproject/obs-studio","labels_url":"https://api.github.com/repos/obsproject/obs-studio/issues/9733/labels{/name}","comments_url":"https://api.github.com/repos/obsproject/obs-studio/issues/9733/comments","events_url":"https://api.github.com/repos/obsproject/obs-studio/issues/9733/events","html_url":"https://github.com/obsproject/obs-studio/issues/9733","id":1952692609,"node_id":"I_kwDOAMnsBs50Y7mB","number":9733,"title":"OBS Studio Crashes on Arch Linux after selecting screen (pipewire)","user":{"login":"jonhoo","id":176295,"node_id":"MDQ6VXNlcjE3NjI5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/176295?v=4","gravatar_id":"","url":"https://api.github.com/users/jonhoo","html_url":"https://github.com/jonhoo","followers_url":"https://api.github.com/users/jonhoo/followers","following_url":"https://api.github.com/users/jonhoo/following{/other_user}","gists_url":"https://api.github.com/users/jonhoo/gists{/gist_id}","starred_url":"https://api.github.com/users/jonhoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jonhoo/subscriptions","organizations_url":"https://api.github.com/users/jonhoo/orgs","repos_url":"https://api.github.com/users/jonhoo/repos","events_url":"https://api.github.com/users/jonhoo/events{/privacy}","received_events_url":"https://api.github.com/users/jonhoo/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1652703726,"node_id":"MDU6TGFiZWwxNjUyNzAzNzI2","url":"https://api.github.com/repos/obsproject/obs-studio/labels/Linux","name":"Linux","color":"709bc9","default":false,"description":"Affects Linux"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":16,"created_at":"2023-10-19T16:52:39Z","updated_at":"2023-10-29T08:46:03Z","closed_at":"2023-10-28T21:26:30Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Operating System Info\n\nOther\n\n### Other OS\n\nArch Linux\n\n### OBS Studio Version\n\nGit\n\n### OBS Studio Version (Other)\n\nb29a44a67db76c6f665bcc0887730d689e6b908d\n\n### OBS Studio Log URL\n\nOBS won't let me upload an old-enough log file. Will attach instead.\n\n### OBS Studio Crash Log URL\n\n_No response_\n\n### Expected Behavior\n\nFull screen recording on selected monitor.\n\n### Current Behavior\n\nOBS crashes after the second time I select the screen (I'm not sure why, but OBS always asks me twice for which screen to use on start-up), with:\r\n```\r\n(lldb) bt\r\n* thread #28, name = 'PipeWire thread', stop reason = signal SIGSEGV: invalid address (fault address: 0x30)\r\n  * frame #0: 0x00007fffc7e3e8ec linux-pipewire.so`renegotiate_format(data=0x0000555557a102e0, expirations=<unavailable>) at pipewire.c:631:2\r\n    frame #1: 0x00007fffbffe4cc9 libspa-support.so`source_event_func(source=0x00005555574dcc60) at loop.c:663:2\r\n    frame #2: 0x00007fffbffe6666 libspa-support.so`loop_iterate(object=0x00005555574af308, timeout=<unavailable>) at loop.c:496:4\r\n    frame #3: 0x00007fff88cda14d libpipewire-0.3.so.0`do_loop(user_data=0x0000555557315260) at thread-loop.c:295:14\r\n    frame #4: 0x00007ffff3eaa9eb libc.so.6`start_thread(arg=<unavailable>) at pthread_create.c:444:8\r\n    frame #5: 0x00007ffff3f2e7cc libc.so.6`__clone3 at clone3.S:78\r\n```\r\n\r\nI'm running:\r\n- obs-studio @ b29a44a67db76c6f665bcc0887730d689e6b908d\r\n- pipewire: 0.3.82\r\n- hyprland: 0.30.0\r\n- xdg-desktop-portal-hyprland: 1.2.2\r\n\r\non Arch Linux. The logs just prior to the crash are:\r\n\r\n```\r\n09:01:45.260: [pipewire] Asking for desktop\r\n09:01:46.292: [pipewire] Asking for desktop\r\n09:01:46.293: [pipewire] desktop selected, setting up screencast\r\n09:01:46.294: [pipewire] desktop selected, setting up screencast\r\n09:01:46.565: [pipewire] Server version: 0.3.82\r\n09:01:46.565: [pipewire] Library version: 0.3.82\r\n09:01:46.565: [pipewire] Header version: 0.3.82\r\n09:01:46.565: [pipewire] Created stream 0x5555574dccd0\r\n09:01:46.565: [pipewire] Stream 0x5555574dccd0 state: \"connecting\" (error: none)\r\n09:01:46.566: [pipewire] Playing stream 0x5555574dccd0\r\n09:01:46.602: [pipewire] Stream 0x5555574dccd0 state: \"paused\" (error: none)\r\n09:01:46.603: [pipewire] Server version: 0.3.82\r\n09:01:46.603: [pipewire] Library version: 0.3.82\r\n09:01:46.603: [pipewire] Header version: 0.3.82\r\n09:01:46.603: [pipewire] Negotiated format:\r\n09:01:46.603: [pipewire]     Format: 8 (Spa:Enum:VideoFormat:BGRx)\r\n09:01:46.603: [pipewire]     Modifier: 0x0\r\n09:01:46.603: [pipewire]     Size: 3840x2160\r\n09:01:46.603: [pipewire]     Framerate: 0/1\r\n09:01:46.603: [pipewire] Created stream 0x555557511cf0\r\n09:01:46.603: [pipewire] Stream 0x555557511cf0 state: \"connecting\" (error: none)\r\n09:01:46.603: [pipewire] Playing stream 0x555557511cf0\r\n09:01:46.603: [pipewire] Stream 0x555557511cf0 state: \"paused\" (error: none)\r\n09:01:46.603: [pipewire] Negotiated format:\r\n09:01:46.603: [pipewire]     Format: 8 (Spa:Enum:VideoFormat:BGRx)\r\n09:01:46.603: [pipewire]     Modifier: 0x200000028a37f04\r\n09:01:46.603: [pipewire]     Size: 3840x2160\r\n09:01:46.603: [pipewire]     Framerate: 0/1\r\n09:01:46.604: [pipewire] Stream 0x5555574dccd0 state: \"streaming\" (error: none)\r\n09:01:46.605: [pipewire] Negotiated format:\r\n09:01:46.605: [pipewire]     Format: 8 (Spa:Enum:VideoFormat:BGRx)\r\n09:01:46.605: [pipewire]     Modifier: 0x0\r\n09:01:46.605: [pipewire]     Size: 3840x2160\r\n09:01:46.605: [pipewire]     Framerate: 0/1\r\n09:01:46.606: [pipewire] Negotiated format:\r\n09:01:46.606: [pipewire]     Format: 8 (Spa:Enum:VideoFormat:BGRx)\r\n09:01:46.606: [pipewire]     Modifier: 0x200000028a37f04\r\n09:01:46.606: [pipewire]     Size: 3840x2160\r\n09:01:46.606: [pipewire]     Framerate: 0/1\r\n09:01:46.623: Cannot create EGLImage: Arguments are inconsistent (for example, a valid context requires buffers not supplied by a valid surface).\r\n09:01:46.623: [pipewire] Renegotiating stream\r\n```\r\n\r\nIf I remove all the pipewire inputs from my scene JSON config, then OBS starts just fine (and doesn't prompt me to select a screen). If I then try to _add_ a window capture via Pipewire, it crashes again (after I select the screen).\r\n\r\nLog file from crashing run: \r\n[2023-10-19 09-17-06.txt](https://github.com/obsproject/obs-studio/files/13045495/2023-10-19.09-17-06.txt)\r\n\n\n### Steps to Reproduce\n\n1. Open OBS Studio\r\n1. Add pipewire as a source\r\n1. Select a screen\r\n1. Crash\r\n\n\n### Anything else we should know?\n\nNot sure if this is related to https://github.com/obsproject/obs-studio/issues/9617.\r\n\r\nI'm using a build of Git HEAD.\r\n\r\nDowngrading pipewire and xdg-desktop-portal-hyprland, restarting, and then starting OBS fixes the problem.","closed_by":{"login":"GeorgesStavracas","id":3518204,"node_id":"MDQ6VXNlcjM1MTgyMDQ=","avatar_url":"https://avatars.githubusercontent.com/u/3518204?v=4","gravatar_id":"","url":"https://api.github.com/users/GeorgesStavracas","html_url":"https://github.com/GeorgesStavracas","followers_url":"https://api.github.com/users/GeorgesStavracas/followers","following_url":"https://api.github.com/users/GeorgesStavracas/following{/other_user}","gists_url":"https://api.github.com/users/GeorgesStavracas/gists{/gist_id}","starred_url":"https://api.github.com/users/GeorgesStavracas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GeorgesStavracas/subscriptions","organizations_url":"https://api.github.com/users/GeorgesStavracas/orgs","repos_url":"https://api.github.com/users/GeorgesStavracas/repos","events_url":"https://api.github.com/users/GeorgesStavracas/events{/privacy}","received_events_url":"https://api.github.com/users/GeorgesStavracas/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/obsproject/obs-studio/issues/9733/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/obsproject/obs-studio/issues/9733/timeline","performed_via_github_app":null,"state_reason":"completed"}