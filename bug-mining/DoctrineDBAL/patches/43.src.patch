diff --git a/lib/Doctrine/DBAL/Connection.php b/lib/Doctrine/DBAL/Connection.php
index 23c2af2cc..d2f5b8a9b 100644
--- a/lib/Doctrine/DBAL/Connection.php
+++ b/lib/Doctrine/DBAL/Connection.php
@@ -9,6 +9,7 @@ use Doctrine\DBAL\Cache\CacheException;
 use Doctrine\DBAL\Cache\QueryCacheProfile;
 use Doctrine\DBAL\Cache\ResultCacheStatement;
 use Doctrine\DBAL\Driver\Connection as DriverConnection;
+use Doctrine\DBAL\Driver\PDO\Statement as PDODriverStatement;
 use Doctrine\DBAL\Driver\PingableConnection;
 use Doctrine\DBAL\Driver\ResultStatement;
 use Doctrine\DBAL\Driver\ServerInfoAwareConnection;
@@ -21,6 +22,7 @@ use Doctrine\DBAL\Query\QueryBuilder;
 use Doctrine\DBAL\Schema\AbstractSchemaManager;
 use Doctrine\DBAL\Types\Type;
 use Doctrine\Deprecations\Deprecation;
+use PDO;
 use Throwable;
 use Traversable;
 
@@ -193,7 +195,18 @@ class Connection implements DriverConnection
         $this->params  = $params;
 
         if (isset($params['pdo'])) {
+            Deprecation::trigger(
+                'doctrine/dbal',
+                'https://github.com/doctrine/dbal/pull/3554',
+                'Passing a user provided PDO instance directly to Doctrine is deprecated.'
+            );
+
+            if (! $params['pdo'] instanceof PDO) {
+                throw Exception::invalidPdoInstance();
+            }
+
             $this->_conn = $params['pdo'];
+            $this->_conn->setAttribute(PDO::ATTR_STATEMENT_CLASS, [PDODriverStatement::class, []]);
             unset($this->params['pdo']);
         }
 
diff --git a/lib/Doctrine/DBAL/DriverManager.php b/lib/Doctrine/DBAL/DriverManager.php
index d084e2203..2ef49c498 100644
--- a/lib/Doctrine/DBAL/DriverManager.php
+++ b/lib/Doctrine/DBAL/DriverManager.php
@@ -8,10 +8,8 @@ use Doctrine\DBAL\Driver\IBMDB2;
 use Doctrine\DBAL\Driver\Mysqli;
 use Doctrine\DBAL\Driver\OCI8;
 use Doctrine\DBAL\Driver\PDO;
-use Doctrine\DBAL\Driver\PDO\Statement as PDODriverStatement;
 use Doctrine\DBAL\Driver\SQLAnywhere;
 use Doctrine\DBAL\Driver\SQLSrv;
-use Doctrine\Deprecations\Deprecation;
 
 use function array_keys;
 use function array_merge;
@@ -244,14 +242,7 @@ final class DriverManager
         }
 
         if (isset($params['pdo'])) {
-            Deprecation::trigger(
-                'doctrine/dbal',
-                'https://github.com/doctrine/dbal/pull/3554',
-                'Passing a user provided PDO instance directly to Doctrine is deprecated.'
-            );
-
             $params['pdo']->setAttribute(\PDO::ATTR_ERRMODE, \PDO::ERRMODE_EXCEPTION);
-            $params['pdo']->setAttribute(\PDO::ATTR_STATEMENT_CLASS, [PDODriverStatement::class, []]);
             $params['driver'] = 'pdo_' . $params['pdo']->getAttribute(\PDO::ATTR_DRIVER_NAME);
         }
 
diff --git a/phpstan.neon.dist b/phpstan.neon.dist
index 587ebe654..15e2e42ae 100644
--- a/phpstan.neon.dist
+++ b/phpstan.neon.dist
@@ -114,3 +114,9 @@ parameters:
             message: '~^Parameter #1 \$scheme of static method Doctrine\\DBAL\\DriverManager::parseDatabaseUrlScheme\(\) expects string\|null, int\|string\|null given\.$~'
             paths:
                 - %currentWorkingDirectory%/lib/Doctrine/DBAL/DriverManager.php
+
+        # Until 3.x, $_conn does accept PDO
+        -
+            message: '~^Property Doctrine\\DBAL\\Connection::\$_conn \(Doctrine\\DBAL\\Driver\\Connection\|null\) does not accept PDO\.$~'
+            paths:
+                - %currentWorkingDirectory%/lib/Doctrine/DBAL/Connection.php
diff --git a/tests/Doctrine/Tests/DBAL/ConnectionTest.php b/tests/Doctrine/Tests/DBAL/ConnectionTest.php
index 3e5440ac5..515e4fc62 100644
--- a/tests/Doctrine/Tests/DBAL/ConnectionTest.php
+++ b/tests/Doctrine/Tests/DBAL/ConnectionTest.php
@@ -23,11 +23,10 @@ use Doctrine\DBAL\ParameterType;
 use Doctrine\DBAL\Platforms\AbstractPlatform;
 use Doctrine\DBAL\Result;
 use Doctrine\Tests\DbalTestCase;
+use PDO;
 use PHPUnit\Framework\MockObject\MockObject;
 use stdClass;
 
-use function call_user_func_array;
-
 /**
  * @requires extension pdo_mysql
  */
@@ -646,11 +645,22 @@ EOF
         self::assertSame($result, $conn->fetchAll($statement, $params, $types));
     }
 
+    public function testConnectionThrowsExceptionWhenInvalidPDOProvided(): void
+    {
+        $driverMock = $this->createMock(Driver::class);
+        $pdo        = $this->createMock(stdClass::class);
+
+        $this->expectException(Exception::class);
+
+        new Connection(['pdo' => $pdo], $driverMock);
+    }
+
     public function testConnectionDoesNotMaintainTwoReferencesToExternalPDO(): void
     {
         $driverMock = $this->createMock(Driver::class);
+        $pdo        = $this->createMock(PDO::class);
 
-        $conn = new Connection(['pdo' => new stdClass()], $driverMock);
+        $conn = new Connection(['pdo' => $pdo], $driverMock);
 
         self::assertArrayNotHasKey('pdo', $conn->getParams());
     }
@@ -658,22 +668,17 @@ EOF
     public function testPassingExternalPDOMeansConnectionIsConnected(): void
     {
         $driverMock = $this->createMock(Driver::class);
+        $pdo        = $this->createMock(PDO::class);
 
-        $conn = new Connection(['pdo' => new stdClass()], $driverMock);
+        $conn = new Connection(['pdo' => $pdo], $driverMock);
 
         self::assertTrue($conn->isConnected(), 'Connection is not connected after passing external PDO');
     }
 
     public function testCallingDeleteWithNoDeletionCriteriaResultsInInvalidArgumentException(): void
     {
-        $driver  = $this->createMock(Driver::class);
-        $pdoMock = $this->createMock(\Doctrine\DBAL\Driver\Connection::class);
-
-        // should never execute queries with invalid arguments
-        $pdoMock->expects($this->never())->method('exec');
-        $pdoMock->expects($this->never())->method('prepare');
-
-        $conn = new Connection(['pdo' => $pdoMock], $driver);
+        $driver = $this->createMock(Driver::class);
+        $conn   = new Connection([], $driver);
 
         $this->expectException(InvalidArgumentException::class);
         $conn->delete('kittens', []);
@@ -700,23 +705,22 @@ EOF
      */
     public function testCallConnectOnce(string $method, array $params): void
     {
-        $driverMock   = $this->createMock(Driver::class);
-        $pdoMock      = $this->createMock(Connection::class);
-        $platformMock = $this->createMock(AbstractPlatform::class);
-        $stmtMock     = $this->createMock(Statement::class);
+        $wrappedConnection = $this->createMock(DriverConnection::class);
+        $driver            = $this->createMock(Driver::class);
+        $stmt              = $this->createMock(Statement::class);
+        $driver->expects(self::once())
+            ->method('connect')
+            ->willReturn($wrappedConnection);
 
-        $pdoMock->expects($this->any())
+        $wrappedConnection
             ->method('prepare')
-            ->will($this->returnValue($stmtMock));
+            ->will($this->returnValue($stmt));
 
-        $conn = (new MockBuilderProxy($this->getMockBuilder(Connection::class)))
-            ->onlyMethods(['connect'])
-            ->setConstructorArgs([['pdo' => $pdoMock, 'platform' => $platformMock], $driverMock])
-            ->getMock();
+        $platform = $this->createMock(AbstractPlatform::class);
 
-        $conn->expects($this->once())->method('connect');
+        $conn = new Connection(['platform' => $platform], $driver);
 
-        call_user_func_array([$conn, $method], $params);
+        $conn->$method(...$params);
     }
 
     public function testPlatformDetectionIsTriggerOnlyOnceOnRetrievingPlatform(): void
diff --git a/tests/Doctrine/Tests/DBAL/Functional/ConnectionTest.php b/tests/Doctrine/Tests/DBAL/Functional/ConnectionTest.php
index b1423f353..6f1c888be 100644
--- a/tests/Doctrine/Tests/DBAL/Functional/ConnectionTest.php
+++ b/tests/Doctrine/Tests/DBAL/Functional/ConnectionTest.php
@@ -10,6 +10,7 @@ use Doctrine\DBAL\Connection;
 use Doctrine\DBAL\ConnectionException;
 use Doctrine\DBAL\Driver;
 use Doctrine\DBAL\Driver\Connection as DriverConnection;
+use Doctrine\DBAL\Driver\PDOSqlite\Driver as PDODriver;
 use Doctrine\DBAL\DriverManager;
 use Doctrine\DBAL\ForwardCompatibility;
 use Doctrine\DBAL\ParameterType;
@@ -363,7 +364,22 @@ class ConnectionTest extends DbalFunctionalTestCase
 
         $result = $connection->executeQuery('SELECT 1');
 
-        self::assertInstanceOf(ForwardCompatibility\Result::class, $result);
+        self::assertInstanceOf(ForwardCompatibility\DriverResultStatement::class, $result);
+    }
+
+    /**
+     * @requires extension pdo_sqlite
+     */
+    public function testUserProvidedPDOConnectionWithoutDriverManager(): void
+    {
+        $connection = new Connection(
+            ['pdo' => new PDO('sqlite::memory:')],
+            new PDODriver()
+        );
+
+        $result = $connection->executeQuery('SELECT 1');
+
+        self::assertInstanceOf(ForwardCompatibility\DriverResultStatement::class, $result);
     }
 
     public function testResultCompatibilityWhenExecutingQueryWithoutParam(): void
