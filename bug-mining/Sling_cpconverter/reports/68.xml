<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:36:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SLING-9956] RepPolicyEntryHandler ignores ACEs on repository level</title>
                <link>https://issues.apache.org/jira/browse/SLING-9956</link>
                <project id="12310710" key="SLING">Sling</project>
                    <description>&lt;p&gt;based on my reading of &lt;a href=&quot;https://github.com/apache/sling-org-apache-sling-feature-cpconverter/blob/master/src/main/java/org/apache/sling/feature/cpconverter/handlers/RepPolicyEntryHandler.java#L56&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/sling-org-apache-sling-feature-cpconverter/blob/master/src/main/java/org/apache/sling/feature/cpconverter/handlers/RepPolicyEntryHandler.java#L56&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;i don&apos;t see how the converter would handle service user permissions that are defined for the repository level that in JCR access control management API are defined using a &lt;tt&gt;null&lt;/tt&gt; path.&lt;/p&gt;

&lt;p&gt;with the default authorization module in oak the corresponding ACL is stored at the root node with a dedicated policy node named &lt;tt&gt;rep:repoPolicy&lt;/tt&gt; (see &lt;a href=&quot;http://jackrabbit.apache.org/oak/docs/security/accesscontrol/default.html#representation&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jackrabbit.apache.org/oak/docs/security/accesscontrol/default.html#representation&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;i guess this bug requires 3 steps:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;adjust the regexp in the handler&lt;/li&gt;
	&lt;li&gt;adjust &quot;Acl&quot; class (which reprents an Ace) to make sure repo-level aces are properly identified (e.g. extra method isRepositoryLevel or set the correct path field to null)&lt;/li&gt;
	&lt;li&gt;adjust &lt;a href=&quot;https://github.com/apache/sling-org-apache-sling-feature-cpconverter/blob/master/src/main/java/org/apache/sling/feature/cpconverter/acl/DefaultAclManager.java#L242&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/sling-org-apache-sling-feature-cpconverter/blob/master/src/main/java/org/apache/sling/feature/cpconverter/acl/DefaultAclManager.java#L242&lt;/a&gt; to proper create repository level entries with repo-init. according to &lt;a href=&quot;https://sling.apache.org/documentation/bundles/repository-initialization.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://sling.apache.org/documentation/bundles/repository-initialization.html&lt;/a&gt; this is achieved using the following special path:&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
set ACL &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; alice,bob
    allow jcr:namespaceManagement on :repository
end
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13343566">SLING-9956</key>
            <summary>RepPolicyEntryHandler ignores ACEs on repository level</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="angela">Angela Schreiber</assignee>
                                    <reporter username="angela">Angela Schreiber</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Dec 2020 13:37:05 +0000</created>
                <updated>Mon, 17 May 2021 11:38:48 +0000</updated>
                            <resolved>Wed, 13 Jan 2021 15:56:45 +0000</resolved>
                                                    <fixVersion>Content-Package to Feature Model Converter 1.1.0</fixVersion>
                                    <component>Content-Package to Feature Model Converter</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="17263974" author="anchela" created="Wed, 13 Jan 2021 08:10:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=karlpauls&quot; class=&quot;user-hover&quot; rel=&quot;karlpauls&quot;&gt;karlpauls&lt;/a&gt;, proposed patch attached. i will create a PR once changes from &lt;a href=&quot;https://github.com/apache/sling-org-apache-sling-feature-cpconverter/pull/46&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/sling-org-apache-sling-feature-cpconverter/pull/46&lt;/a&gt; are successfully merged into the main branch and i have any conflicts resolved.&lt;/p&gt;

&lt;p&gt;a few notes/questions regarding the patch:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the regex in the new RepRepoPolicyEntryHandler looks a rather ugly to me.... if you have a better idea on how to do this without changing too much of the logic in RepPolicyEntryHandler, please let me know.&lt;/li&gt;
	&lt;li&gt;RepoPath: should isRepositoryPath be reflected in the equals/hashcode methods?&lt;/li&gt;
	&lt;li&gt;DefaultAclManager: the method getRepoInitPath introduced in the patch has a param SystemUser which is not used yet.... but will it be needed for &lt;a href=&quot;https://issues.apache.org/jira/browse/SLING-9692&quot; title=&quot;Add support for principal-based access control entries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SLING-9692&quot;&gt;&lt;del&gt;SLING-9692&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/SLING-9953&quot; title=&quot;ACEs on/below user nodes are ignored upon conversion&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SLING-9953&quot;&gt;&lt;del&gt;SLING-9953&lt;/del&gt;&lt;/a&gt;. since i derived the patch from some initial work done for those issues i decided to leave it in.&lt;/li&gt;
	&lt;li&gt;TestUtils: i noticed that quite some test copy the logic on how to mock the fvault parts. i didn&apos;t yet replace all copies (just the one in the SystemUserHandlerTest). should i rather create a separate improvement for that?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17264135" author="anchela" created="Wed, 13 Jan 2021 13:12:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kpauls&quot; class=&quot;user-hover&quot; rel=&quot;kpauls&quot;&gt;kpauls&lt;/a&gt;, i think the fix should in addition make sure that no &lt;tt&gt;create path .....&lt;/tt&gt; repo-init statements are issued for entries pointing to the repository level. that is still missing. reopening.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="13343791">SLING-9966</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13324463">SLING-9692</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                            <outwardlinks description="requires">
                                        <issuelink>
            <issuekey id="13344016">SLING-9976</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13018666" name="SLING-9956.patch" size="21487" author="angela" created="Wed, 13 Jan 2021 07:58:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 43 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0l3dk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>