<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:36:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SLING-9961] DefaultAclManager: redundant creation of intermediate path</title>
                <link>https://issues.apache.org/jira/browse/SLING-9961</link>
                <project id="12310710" key="SLING">Sling</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// TODO does it harm?!?
&lt;/span&gt;addSystemUserPath(formatter, systemUser.getPath());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;where the method looks as follows:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; void addSystemUserPath(Formatter formatter, RepoPath path) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (preProvidedSystemPaths.add(path)) {
            formatter.format(&lt;span class=&quot;code-quote&quot;&gt;&quot;create path (rep:AuthorizableFolder) %s%n&quot;&lt;/span&gt;, path);
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;i would strong recommend to drop that. the content-package-feature-model-converter already has quite some hardcoded stuff.... how the intermediate path argument passed to &lt;tt&gt;UserManager.createSystemUser(String id, String intermediatePath)&lt;/tt&gt; is used and what node types are used to create the hierarchy should be considered an implementation detail and it doesn&apos;t make sense IMHO to eagerly create the tree structure in a feature like this. in fact i would consider this a bug that may sooner or later cause the converter to fail during repo-init execution.&lt;/p&gt;

&lt;p&gt;btw: the comment already implies that the author was not sure of the usefulness.... why not verifying and fixing the code or dropping the TODO before releasing the module?&lt;/p&gt;
</description>
                <environment></environment>
        <key id="13343629">SLING-9961</key>
            <summary>DefaultAclManager: redundant creation of intermediate path</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="karlpauls">Karl Pauls</assignee>
                                    <reporter username="angela">Angela Schreiber</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Dec 2020 18:13:35 +0000</created>
                <updated>Mon, 17 May 2021 11:39:01 +0000</updated>
                            <resolved>Wed, 13 Jan 2021 16:57:54 +0000</resolved>
                                                    <fixVersion>Content-Package to Feature Model Converter 1.1.0</fixVersion>
                                    <component>Content-Package to Feature Model Converter</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17241858" author="cziegeler" created="Tue, 1 Dec 2020 20:43:05 +0000"  >&lt;p&gt;Agreed, I think we should simply drop that code&lt;/p&gt;</comment>
                            <comment id="17242128" author="anchela" created="Wed, 2 Dec 2020 07:59:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cziegeler&quot; class=&quot;user-hover&quot; rel=&quot;cziegeler&quot;&gt;cziegeler&lt;/a&gt;, i investigated a bit further while trying to work on an initial draft for &lt;a href=&quot;https://issues.apache.org/jira/browse/SLING-9692&quot; title=&quot;Add support for principal-based access control entries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SLING-9692&quot;&gt;&lt;del&gt;SLING-9692&lt;/del&gt;&lt;/a&gt;. i found that is was an attempt to fix &lt;a href=&quot;https://issues.apache.org/jira/browse/SLING-8586&quot; title=&quot;[cp2fm] &amp;quot;create service user&amp;quot; repoinit instruction throws javax.jcr.nodetype.ConstraintViolationException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SLING-8586&quot;&gt;&lt;del&gt;SLING-8586&lt;/del&gt;&lt;/a&gt; &lt;em&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;cp2fm&amp;#93;&lt;/span&gt; &quot;create service user&quot; repoinit instruction throws javax.jcr.nodetype.ConstraintViolationException&lt;/em&gt;. IMHO that exception was caused by another bug as the exception mentioned in the description indicates that an attempt was made to create  a node named &lt;em&gt;replication-user&lt;/em&gt; with type &lt;em&gt;sling:Folder&lt;/em&gt;. the node name suggests that this should actually be a node of type &lt;em&gt;rep:User&lt;/em&gt; or &lt;em&gt;rep:SystemUser&lt;/em&gt; and the mentioned exception would be raised if one would attempt to create a node with type &lt;em&gt;sling:Folder&lt;/em&gt; below a parent node with primary type &lt;em&gt;rep:AuthorizableFolder&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;looking at the usage of &lt;em&gt;sling:Folder&lt;/em&gt; in the converter code i found &lt;tt&gt;DefaultAclManager.computePathType&lt;/tt&gt; which returns it as default path. this method is used here &lt;a href=&quot;https://github.com/apache/sling-org-apache-sling-feature-cpconverter/blob/master/src/main/java/org/apache/sling/feature/cpconverter/accesscontrol/DefaultAclManager.java#L160&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/sling-org-apache-sling-feature-cpconverter/blob/master/src/main/java/org/apache/sling/feature/cpconverter/accesscontrol/DefaultAclManager.java#L160&lt;/a&gt;. that might again be a side effect of the missing/wrong handling of access control entries located below or at the user node (see &lt;a href=&quot;https://issues.apache.org/jira/browse/SLING-9953&quot; title=&quot;ACEs on/below user nodes are ignored upon conversion&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SLING-9953&quot;&gt;&lt;del&gt;SLING-9953&lt;/del&gt;&lt;/a&gt;). in other words: IMO there needs to be code in place that properly detects special paths like any user home node or the repo-level &apos;null&apos; path and doing so may actually fix the root cause for the exception.&lt;/p&gt;

&lt;p&gt;one final note regarding the &lt;tt&gt;addPaths&lt;/tt&gt; method: when addressing &lt;a href=&quot;https://issues.apache.org/jira/browse/SLING-9692&quot; title=&quot;Add support for principal-based access control entries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SLING-9692&quot;&gt;&lt;del&gt;SLING-9692&lt;/del&gt;&lt;/a&gt; the creation of access control paths where a given ACE will take effect anyway should be limited to resource-based access control. with principal-based access control it&apos;s not longer required that the effective path actually exists as the entries are not stored there &lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://jackrabbit.apache.org/oak/docs/security/authorization/principalbased.html#Implementation_Details&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jackrabbit.apache.org/oak/docs/security/authorization/principalbased.html#Implementation_Details&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="13324463">SLING-9692</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13343712">SLING-9962</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 49 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0l3rk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>