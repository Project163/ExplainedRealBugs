<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:37:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SLING-10790] BundleEntryHandler.extractArtifactId may use wrong GAV</title>
                <link>https://issues.apache.org/jira/browse/SLING-10790</link>
                <project id="12310710" key="SLING">Sling</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kpauls&quot; class=&quot;user-hover&quot; rel=&quot;kpauls&quot;&gt;kpauls&lt;/a&gt;, if my reading of &lt;tt&gt;BundleEntryHandler.extractArtifactId&lt;/tt&gt; is correct it the method might be ending up using the wrong groupId/artifactId/version.&lt;/p&gt;

&lt;p&gt;the code will loop over jar-entries and stop if the extracted GAV matches the bundle name. however, groupId/artifactId/version are not reset to &lt;tt&gt;null&lt;/tt&gt; in case they were successfully extracted but didn&apos;t end up matching the bundle name i.e. &lt;blockquote&gt;&lt;p&gt;it was the pom.properties  we were looking for&lt;/p&gt;&lt;/blockquote&gt;.&lt;/p&gt;

&lt;p&gt;i can&apos;t tell how big of an issue that is (and how likely). but given the fact that there is some extra effort to verify that the parsed pom is actually the right one, it might actually be relevant. the relies on a compliant content package that does contain a matching pom, which may or may not be the case... &lt;br/&gt;
logging a warning or throwing a ConverterException in case of violation might help spotting troublesome content packages instead of getting some sort of side effect if another pom was spotted.&lt;/p&gt;

&lt;p&gt;a heavily simplified copy of the method:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; artifactId = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; version = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; groupId = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; classifier = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;

        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Enumeration&amp;lt;JarEntry&amp;gt; e = jarFile.entries(); e.hasMoreElements();) {
            [...]
            &lt;span class=&quot;code-comment&quot;&gt;// extract groupId/artifactId/version
&lt;/span&gt;            [...]
       
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (groupId != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; artifactId != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; version != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                &lt;span class=&quot;code-comment&quot;&gt;// bundleName is now the bare name without extension
&lt;/span&gt;                &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; synthesized = artifactId + &lt;span class=&quot;code-quote&quot;&gt;&quot;-&quot;&lt;/span&gt; + version;

                &lt;span class=&quot;code-comment&quot;&gt;// it was the pom.properties  we were looking &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;
&lt;/span&gt;                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (bundleName.startsWith(synthesized) || bundleName.equals(artifactId)) {

                    [...]
                    
                    &lt;span class=&quot;code-comment&quot;&gt;// no need to iterate further
&lt;/span&gt;                    &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
                }
            }
        }

        
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (groupId == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            [...]
        }

        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArtifactId(groupId, artifactId, version, classifier, JAR_TYPE);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;feel free to resolve as not a problem in case my reading of the code is all wrong.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13398965">SLING-10790</key>
            <summary>BundleEntryHandler.extractArtifactId may use wrong GAV</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="angela">Angela Schreiber</reporter>
                        <labels>
                    </labels>
                <created>Thu, 2 Sep 2021 14:28:56 +0000</created>
                <updated>Mon, 16 May 2022 12:12:34 +0000</updated>
                                                                            <component>Content-Package to Feature Model Converter</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17410530" author="cziegeler" created="Mon, 6 Sep 2021 10:56:06 +0000"  >&lt;p&gt;The longer I stare at this method, the more I think it is wrong or at least overcomplicated&lt;br/&gt;
If a bundle is built by Maven it always has both, the properties file and the pom file; so checking for both is unnecessary.&lt;br/&gt;
It should be enough to get the properties.&lt;br/&gt;
But then the result from the properties file (or the path of the pom.xml) is validated against the bundle name and only used if it matches. If nothing is found, the bundle name is used.&lt;/p&gt;

&lt;p&gt;So I think we can simplify this by:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;extracting artifact id, classifier and version from the bundle name&lt;/li&gt;
	&lt;li&gt;trying to get the group id from the path of the pom.xml (like is done today), if not found fall back to the current code&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17410541" author="karlpauls" created="Mon, 6 Sep 2021 11:17:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cziegeler&quot; class=&quot;user-hover&quot; rel=&quot;cziegeler&quot;&gt;cziegeler&lt;/a&gt;, I agree that should be the case - however, we had cases where a bundle didn&apos;t have both. Furthermore, I seem to remember cases where there was more than one pom. Ultimately, I&apos;m not sure the classifier would be necessarily reflected in the bundle name. &lt;/p&gt;

&lt;p&gt;I guess that is part of why the code is so complicated, it tries to find the pom properties, if not, it tries to see if a pom is there that seems to match (however, it seems like it has some potential ordering problems in that assuming it is possible to have the order of the entries in a way where a matching pom comes first that isn&apos;t the right one). &lt;/p&gt;

&lt;p&gt;Cleaning it up makes a lot of sense - just wanted to point out what I remember from previous issues.&lt;/p&gt;</comment>
                            <comment id="17410603" author="cziegeler" created="Mon, 6 Sep 2021 13:24:16 +0000"  >&lt;p&gt;yes, several poms as well as several properties files are possible (usually caused by embedding).&lt;br/&gt;
I was wondering about a potential ordering problem here as well &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17537505" author="cziegeler" created="Mon, 16 May 2022 12:11:02 +0000"  >&lt;p&gt;I refactored the code in &lt;a href=&quot;https://github.com/apache/sling-org-apache-sling-feature-cpconverter/commit/68f71b3ba0a8f54c4d307e0ca179e7cc8a8c17c0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/sling-org-apache-sling-feature-cpconverter/commit/68f71b3ba0a8f54c4d307e0ca179e7cc8a8c17c0&lt;/a&gt; &lt;br/&gt;
It seems if we actually reset groupId etc. then a lot of tests start failing, therefore I didn&apos;t not do this. But at least the code is now a little bit easier to read&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13398871">SLING-10784</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 25 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ujm0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>