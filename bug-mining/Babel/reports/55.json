{"url":"https://api.github.com/repos/babel/babel/issues/11197","repository_url":"https://api.github.com/repos/babel/babel","labels_url":"https://api.github.com/repos/babel/babel/issues/11197/labels{/name}","comments_url":"https://api.github.com/repos/babel/babel/issues/11197/comments","events_url":"https://api.github.com/repos/babel/babel/issues/11197/events","html_url":"https://github.com/babel/babel/issues/11197","id":574677830,"node_id":"MDU6SXNzdWU1NzQ2Nzc4MzA=","number":11197,"title":"Transpilation fails when chaining off optionally chained keys that share names with certain reserved keywords (e.g. class and function)","user":{"login":"Vages","id":3520744,"node_id":"MDQ6VXNlcjM1MjA3NDQ=","avatar_url":"https://avatars.githubusercontent.com/u/3520744?v=4","gravatar_id":"","url":"https://api.github.com/users/Vages","html_url":"https://github.com/Vages","followers_url":"https://api.github.com/users/Vages/followers","following_url":"https://api.github.com/users/Vages/following{/other_user}","gists_url":"https://api.github.com/users/Vages/gists{/gist_id}","starred_url":"https://api.github.com/users/Vages/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Vages/subscriptions","organizations_url":"https://api.github.com/users/Vages/orgs","repos_url":"https://api.github.com/users/Vages/repos","events_url":"https://api.github.com/users/Vages/events{/privacy}","received_events_url":"https://api.github.com/users/Vages/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":438612746,"node_id":"MDU6TGFiZWw0Mzg2MTI3NDY=","url":"https://api.github.com/repos/babel/babel/labels/good%20first%20issue","name":"good first issue","color":"bfdadc","default":true,"description":null},{"id":448844939,"node_id":"MDU6TGFiZWw0NDg4NDQ5Mzk=","url":"https://api.github.com/repos/babel/babel/labels/pkg:%20parser","name":"pkg: parser","color":"c2e0c6","default":false,"description":""},{"id":516500452,"node_id":"MDU6TGFiZWw1MTY1MDA0NTI=","url":"https://api.github.com/repos/babel/babel/labels/Has%20PR","name":"Has PR","color":"bfdadc","default":false,"description":null},{"id":711599268,"node_id":"MDU6TGFiZWw3MTE1OTkyNjg=","url":"https://api.github.com/repos/babel/babel/labels/Spec:%20Optional%20Chaining","name":"Spec: Optional Chaining","color":"1d76db","default":false,"description":null},{"id":919437103,"node_id":"MDU6TGFiZWw5MTk0MzcxMDM=","url":"https://api.github.com/repos/babel/babel/labels/outdated","name":"outdated","color":"ededed","default":false,"description":"A closed issue/PR that is archived due to age. Recommended to make a new issue"}],"state":"closed","locked":true,"assignee":{"login":"Vages","id":3520744,"node_id":"MDQ6VXNlcjM1MjA3NDQ=","avatar_url":"https://avatars.githubusercontent.com/u/3520744?v=4","gravatar_id":"","url":"https://api.github.com/users/Vages","html_url":"https://github.com/Vages","followers_url":"https://api.github.com/users/Vages/followers","following_url":"https://api.github.com/users/Vages/following{/other_user}","gists_url":"https://api.github.com/users/Vages/gists{/gist_id}","starred_url":"https://api.github.com/users/Vages/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Vages/subscriptions","organizations_url":"https://api.github.com/users/Vages/orgs","repos_url":"https://api.github.com/users/Vages/repos","events_url":"https://api.github.com/users/Vages/events{/privacy}","received_events_url":"https://api.github.com/users/Vages/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"Vages","id":3520744,"node_id":"MDQ6VXNlcjM1MjA3NDQ=","avatar_url":"https://avatars.githubusercontent.com/u/3520744?v=4","gravatar_id":"","url":"https://api.github.com/users/Vages","html_url":"https://github.com/Vages","followers_url":"https://api.github.com/users/Vages/followers","following_url":"https://api.github.com/users/Vages/following{/other_user}","gists_url":"https://api.github.com/users/Vages/gists{/gist_id}","starred_url":"https://api.github.com/users/Vages/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Vages/subscriptions","organizations_url":"https://api.github.com/users/Vages/orgs","repos_url":"https://api.github.com/users/Vages/repos","events_url":"https://api.github.com/users/Vages/events{/privacy}","received_events_url":"https://api.github.com/users/Vages/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":4,"created_at":"2020-03-03T13:43:56Z","updated_at":"2020-06-03T04:05:40Z","closed_at":"2020-03-03T17:27:42Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Bug Report\r\n\r\n- [x] I would like to work on a fix!\r\n\r\n**Current Behavior**\r\n\r\nI have a statement that goes something like the following: `const a = foo?.class.bar`. This does not transpile, and I'm quite sure I've found the reason why: Because I'm trying to chain `bar` off the optionally chained `class`. \r\n\r\nI've been playing around in the REPL using only `@babel/plugin-proposal-optional-chaining v7.6.0` plugin:\r\nhttps://babeljs.io/repl#?browsers=&build=&builtIns=false&spec=false&loose=false&code_lz=MYewdgzgLgBAhjAvDAZiEB-AdMANnCCLAIzgCcg&debug=false&forceAllTransforms=false&shippedProposals=false&circleciRepo=&evaluate=false&fileSize=false&timeTravel=false&sourceType=module&lineWrap=true&presets=&prettier=false&targets=&version=7.8.6&externalPlugins=%40babel%2Fplugin-proposal-optional-chaining%407.6.0\r\n\r\nThe following expressions do *not* work in babel (but works fine in the Chrome console, v80):\r\n```javascript\r\nfoo?.class.baz\r\nfoo?.function.baz\r\nfoo?.bar?.class.bar\r\nfoo?.function?.baz\r\n```\r\n\r\nThe following expressions *do* work:\r\n```javascript\r\nfoo?.bar.class.bar\r\nfoo?.class\r\nfoo?.['function'].bar\r\nfoo?.['class'].bar\r\nfoo.class.bar\r\nfoo?.let.bar\r\nfoo?.const.bar\r\nfoo?.var.bar\r\n```\r\n\r\n*From this, I've formed the following hypothesis*: \r\n- Using the reserved keywords `class` or `function` directly after an optional chaining operator, followed by a regular or optional chain leads to babel being unable to transpile the expression, e.g. `foo?.class.baz`. \r\n- The effect disappears when using bracket notation around `function` or `class`, e.g. `foo?.['class'].bar`. \r\n- Using other keywords (e.g. `var`, `let` and `const`) or just not chaining off the `class` or `function` expression also leads to the effect disappearing, e.g. `foo?.let.bar` and `foo.class.bar`. \r\n- And if there's no optional chaining operator in the first place, it also works fine, e.g. `foo.class.bar`\r\n\r\n**Expected behavior/code**\r\nI expect the code to transpile and to behave as if using non-reserved keywords, i.e. the way the non-transpiled code behaves in Chrome \r\n","closed_by":{"login":"nicolo-ribaudo","id":7000710,"node_id":"MDQ6VXNlcjcwMDA3MTA=","avatar_url":"https://avatars.githubusercontent.com/u/7000710?v=4","gravatar_id":"","url":"https://api.github.com/users/nicolo-ribaudo","html_url":"https://github.com/nicolo-ribaudo","followers_url":"https://api.github.com/users/nicolo-ribaudo/followers","following_url":"https://api.github.com/users/nicolo-ribaudo/following{/other_user}","gists_url":"https://api.github.com/users/nicolo-ribaudo/gists{/gist_id}","starred_url":"https://api.github.com/users/nicolo-ribaudo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicolo-ribaudo/subscriptions","organizations_url":"https://api.github.com/users/nicolo-ribaudo/orgs","repos_url":"https://api.github.com/users/nicolo-ribaudo/repos","events_url":"https://api.github.com/users/nicolo-ribaudo/events{/privacy}","received_events_url":"https://api.github.com/users/nicolo-ribaudo/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/babel/babel/issues/11197/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/babel/babel/issues/11197/timeline","performed_via_github_app":null,"state_reason":"completed"}