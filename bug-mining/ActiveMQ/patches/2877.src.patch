diff --git a/activemq-broker/src/main/java/org/apache/activemq/broker/region/IndirectMessageReference.java b/activemq-broker/src/main/java/org/apache/activemq/broker/region/IndirectMessageReference.java
index c1b5f3c4e..104dcb0a4 100644
--- a/activemq-broker/src/main/java/org/apache/activemq/broker/region/IndirectMessageReference.java
+++ b/activemq-broker/src/main/java/org/apache/activemq/broker/region/IndirectMessageReference.java
@@ -204,4 +204,9 @@ public class IndirectMessageReference implements QueueMessageReference {
     public boolean isAdvisory() {
        return message.isAdvisory();
     }
+
+    @Override
+    public boolean canProcessAsExpired() {
+        return message.canProcessAsExpired();
+    }
 }
diff --git a/activemq-broker/src/main/java/org/apache/activemq/broker/region/NullMessageReference.java b/activemq-broker/src/main/java/org/apache/activemq/broker/region/NullMessageReference.java
index bef9b230e..e8d26a84f 100644
--- a/activemq-broker/src/main/java/org/apache/activemq/broker/region/NullMessageReference.java
+++ b/activemq-broker/src/main/java/org/apache/activemq/broker/region/NullMessageReference.java
@@ -154,4 +154,9 @@ public final class NullMessageReference implements QueueMessageReference {
         return false;
     }
 
+    @Override
+    public boolean canProcessAsExpired() {
+        return false;
+    }
+
 }
diff --git a/activemq-broker/src/main/java/org/apache/activemq/broker/region/PrefetchSubscription.java b/activemq-broker/src/main/java/org/apache/activemq/broker/region/PrefetchSubscription.java
index bc045669b..52544409d 100755
--- a/activemq-broker/src/main/java/org/apache/activemq/broker/region/PrefetchSubscription.java
+++ b/activemq-broker/src/main/java/org/apache/activemq/broker/region/PrefetchSubscription.java
@@ -323,7 +323,9 @@ public abstract class PrefetchSubscription extends AbstractSubscription {
                     }
                     if (inAckRange) {
                         Destination regionDestination = nodeDest;
-                        regionDestination.messageExpired(context, this, node);
+                        if (broker.isExpired(node)) {
+                            regionDestination.messageExpired(context, this, node);
+                        }
                         iter.remove();
                         nodeDest.getDestinationStatistics().getInflight().decrement();
 
diff --git a/activemq-broker/src/main/java/org/apache/activemq/broker/region/RegionBroker.java b/activemq-broker/src/main/java/org/apache/activemq/broker/region/RegionBroker.java
index 961618de8..69e0930cf 100755
--- a/activemq-broker/src/main/java/org/apache/activemq/broker/region/RegionBroker.java
+++ b/activemq-broker/src/main/java/org/apache/activemq/broker/region/RegionBroker.java
@@ -735,19 +735,7 @@ public class RegionBroker extends EmptyBroker {
 
     @Override
     public boolean isExpired(MessageReference messageReference) {
-        boolean expired = false;
-        if (messageReference.isExpired()) {
-            try {
-                // prevent duplicate expiry processing
-                Message message = messageReference.getMessage();
-                synchronized (message) {
-                    expired = stampAsExpired(message);
-                }
-            } catch (IOException e) {
-                LOG.warn("unexpected exception on message expiry determination for: {}", messageReference, e);
-            }
-        }
-        return expired;
+        return messageReference.canProcessAsExpired();
     }
 
     private boolean stampAsExpired(Message message) throws IOException {
diff --git a/activemq-broker/src/main/java/org/apache/activemq/broker/region/Topic.java b/activemq-broker/src/main/java/org/apache/activemq/broker/region/Topic.java
index c43f55e82..bf803c104 100755
--- a/activemq-broker/src/main/java/org/apache/activemq/broker/region/Topic.java
+++ b/activemq-broker/src/main/java/org/apache/activemq/broker/region/Topic.java
@@ -527,9 +527,11 @@ public class Topic extends BaseDestination implements Task {
                     // It could take while before we receive the commit
                     // operation.. by that time the message could have
                     // expired..
-                    if (broker.isExpired(message)) {
-                        getDestinationStatistics().getExpired().increment();
-                        broker.messageExpired(context, message, null);
+                    if (message.isExpired()) {
+                        if (broker.isExpired(message)) {
+                            getDestinationStatistics().getExpired().increment();
+                            broker.messageExpired(context, message, null);
+                        }
                         message.decrementReferenceCount();
                         return;
                     }
diff --git a/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/FilePendingMessageCursor.java b/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/FilePendingMessageCursor.java
index 5bd0cdaa5..20b2bc534 100755
--- a/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/FilePendingMessageCursor.java
+++ b/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/FilePendingMessageCursor.java
@@ -483,7 +483,7 @@ public class FilePendingMessageCursor extends AbstractPendingMessageCursor imple
 
     private void discardExpiredMessage(MessageReference reference) {
         LOG.debug("Discarding expired message {}", reference);
-        if (broker.isExpired(reference)) {
+        if (reference.isExpired() && broker.isExpired(reference)) {
             ConnectionContext context = new ConnectionContext(new NonCachedMessageEvaluationContext());
             context.setBroker(broker);
             ((Destination)reference.getRegionDestination()).messageExpired(context, null, new IndirectMessageReference(reference.getMessage()));
diff --git a/activemq-client/src/main/java/org/apache/activemq/broker/region/MessageReference.java b/activemq-client/src/main/java/org/apache/activemq/broker/region/MessageReference.java
index 64c91fa0a..50d23ed9e 100755
--- a/activemq-client/src/main/java/org/apache/activemq/broker/region/MessageReference.java
+++ b/activemq-client/src/main/java/org/apache/activemq/broker/region/MessageReference.java
@@ -63,5 +63,7 @@ public interface MessageReference {
      * @return true if the message is an advisory
      */
     boolean isAdvisory();
+
+    boolean canProcessAsExpired();
     
 }
diff --git a/activemq-client/src/main/java/org/apache/activemq/command/Message.java b/activemq-client/src/main/java/org/apache/activemq/command/Message.java
index a500768f1..83f3201b3 100755
--- a/activemq-client/src/main/java/org/apache/activemq/command/Message.java
+++ b/activemq-client/src/main/java/org/apache/activemq/command/Message.java
@@ -24,6 +24,7 @@ import java.io.OutputStream;
 import java.util.Collections;
 import java.util.HashMap;
 import java.util.Map;
+import java.util.concurrent.atomic.AtomicBoolean;
 import java.util.zip.DeflaterOutputStream;
 
 import javax.jms.JMSException;
@@ -94,6 +95,7 @@ public abstract class Message extends BaseCommand implements MarshallAware, Mess
     private transient ActiveMQConnection connection;
     transient MessageDestination regionDestination;
     transient MemoryUsage memoryUsage;
+    transient AtomicBoolean processAsExpired = new AtomicBoolean(false);
 
     private BrokerId[] brokerPath;
     private BrokerId[] cluster;
@@ -837,4 +839,9 @@ public abstract class Message extends BaseCommand implements MarshallAware, Mess
         }
         return super.toString(overrideFields);
     }
+
+    @Override
+    public boolean canProcessAsExpired() {
+        return processAsExpired.compareAndSet(false, true);
+    }
 }
diff --git a/activemq-unit-tests/src/test/java/org/apache/activemq/broker/region/cursors/OrderPendingListTest.java b/activemq-unit-tests/src/test/java/org/apache/activemq/broker/region/cursors/OrderPendingListTest.java
index 827c39b6e..74c7686b6 100644
--- a/activemq-unit-tests/src/test/java/org/apache/activemq/broker/region/cursors/OrderPendingListTest.java
+++ b/activemq-unit-tests/src/test/java/org/apache/activemq/broker/region/cursors/OrderPendingListTest.java
@@ -498,5 +498,10 @@ public class OrderPendingListTest {
         public boolean isAdvisory() {
             return false;
         }
+
+        @Override
+        public boolean canProcessAsExpired() {
+            return false;
+        }
     }
 }
diff --git a/activemq-unit-tests/src/test/java/org/apache/activemq/broker/region/cursors/PrioritizedPendingListTest.java b/activemq-unit-tests/src/test/java/org/apache/activemq/broker/region/cursors/PrioritizedPendingListTest.java
index 8ecc9511a..f95fb974c 100644
--- a/activemq-unit-tests/src/test/java/org/apache/activemq/broker/region/cursors/PrioritizedPendingListTest.java
+++ b/activemq-unit-tests/src/test/java/org/apache/activemq/broker/region/cursors/PrioritizedPendingListTest.java
@@ -349,5 +349,10 @@ public class PrioritizedPendingListTest {
         public boolean isAdvisory() {
             return false;
         }
+
+        @Override
+        public boolean canProcessAsExpired() {
+            return false;
+        }
     }
 }
diff --git a/activemq-unit-tests/src/test/java/org/apache/activemq/usecases/ExpiredMessagesTest.java b/activemq-unit-tests/src/test/java/org/apache/activemq/usecases/ExpiredMessagesTest.java
index 02055991f..0187aadc8 100644
--- a/activemq-unit-tests/src/test/java/org/apache/activemq/usecases/ExpiredMessagesTest.java
+++ b/activemq-unit-tests/src/test/java/org/apache/activemq/usecases/ExpiredMessagesTest.java
@@ -34,7 +34,6 @@ import org.slf4j.LoggerFactory;
 
 import javax.jms.*;
 
-import java.io.File;
 import java.util.concurrent.atomic.AtomicLong;
 
 import static org.apache.activemq.TestSupport.getDestination;
