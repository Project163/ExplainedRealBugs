diff --git a/activemq-core/src/main/java/org/apache/activemq/kaha/impl/data/DataFile.java b/activemq-core/src/main/java/org/apache/activemq/kaha/impl/data/DataFile.java
index a486180a2..80ea52180 100644
--- a/activemq-core/src/main/java/org/apache/activemq/kaha/impl/data/DataFile.java
+++ b/activemq-core/src/main/java/org/apache/activemq/kaha/impl/data/DataFile.java
@@ -28,8 +28,8 @@ import java.io.RandomAccessFile;
  */
 class DataFile {
 
-    private File file;
-    private Integer number;
+    private final File file;
+    private final Integer number;
     private int referenceCount;
     private RandomAccessFile randomAcessFile;
     private Object writerData;
diff --git a/activemq-core/src/main/java/org/apache/activemq/kaha/impl/data/DataManagerImpl.java b/activemq-core/src/main/java/org/apache/activemq/kaha/impl/data/DataManagerImpl.java
index 9988d5743..e6daae6e9 100644
--- a/activemq-core/src/main/java/org/apache/activemq/kaha/impl/data/DataManagerImpl.java
+++ b/activemq-core/src/main/java/org/apache/activemq/kaha/impl/data/DataManagerImpl.java
@@ -31,6 +31,7 @@ import org.apache.activemq.kaha.StoreLocation;
 import org.apache.activemq.kaha.impl.DataManager;
 import org.apache.activemq.kaha.impl.index.RedoStoreIndexItem;
 import org.apache.activemq.util.IOExceptionSupport;
+import org.apache.activemq.util.IOHelper;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 
@@ -65,7 +66,7 @@ public final class DataManagerImpl implements DataManager {
         this.name = name;
         this.storeSize=storeSize;
 
-        dataFilePrefix = NAME_PREFIX + name + "-";
+        dataFilePrefix = IOHelper.toFileSystemSafeName(NAME_PREFIX + name + "-");
         // build up list of current dataFiles
         File[] files = dir.listFiles(new FilenameFilter() {
             public boolean accept(File dir, String n) {
