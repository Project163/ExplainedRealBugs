diff --git a/activemq-mqtt/src/main/java/org/apache/activemq/transport/mqtt/strategy/AbstractMQTTSubscriptionStrategy.java b/activemq-mqtt/src/main/java/org/apache/activemq/transport/mqtt/strategy/AbstractMQTTSubscriptionStrategy.java
index d77c51b08..121b8296f 100644
--- a/activemq-mqtt/src/main/java/org/apache/activemq/transport/mqtt/strategy/AbstractMQTTSubscriptionStrategy.java
+++ b/activemq-mqtt/src/main/java/org/apache/activemq/transport/mqtt/strategy/AbstractMQTTSubscriptionStrategy.java
@@ -129,7 +129,11 @@ public abstract class AbstractMQTTSubscriptionStrategy implements MQTTSubscripti
 
         // use actual client id used to create connection to lookup connection
         // context
-        final String connectionInfoClientId = protocol.getClientId();
+        String connectionInfoClientId = protocol.getClientId();
+        // for zero-byte client ids we used connection id
+        if (connectionInfoClientId == null || connectionInfoClientId.isEmpty()) {
+            connectionInfoClientId = protocol.getConnectionId().toString();
+        }
         final ConnectionContext connectionContext = regionBroker.getConnectionContext(connectionInfoClientId);
 
         // get all matching Topics
diff --git a/activemq-mqtt/src/test/java/org/apache/activemq/transport/mqtt/MQTTTest.java b/activemq-mqtt/src/test/java/org/apache/activemq/transport/mqtt/MQTTTest.java
index c9f106d13..3bb875803 100644
--- a/activemq-mqtt/src/test/java/org/apache/activemq/transport/mqtt/MQTTTest.java
+++ b/activemq-mqtt/src/test/java/org/apache/activemq/transport/mqtt/MQTTTest.java
@@ -966,6 +966,29 @@ public class MQTTTest extends MQTTTestSupport {
         newConnection.disconnect();
     }
 
+    @Test(timeout = 60 * 1000)
+    public void testNoClientId() throws Exception {
+        final MQTT mqtt = createMQTTConnection("", true);
+        final BlockingConnection connection = mqtt.blockingConnection();
+        connection.connect();
+        Wait.waitFor(new Wait.Condition() {
+            @Override
+            public boolean isSatisified() throws Exception {
+                return connection.isConnected();
+            }
+        });
+
+        connection.subscribe(new Topic[]{new Topic("TopicA", QoS.AT_LEAST_ONCE)});
+        connection.publish("TopicA", "test".getBytes(), QoS.AT_LEAST_ONCE, true);
+        Message message = connection.receive(3, TimeUnit.SECONDS);
+        assertNotNull(message);
+        Thread.sleep(2000);
+        connection.subscribe(new Topic[]{new Topic("TopicA", QoS.AT_LEAST_ONCE)});
+        //TODO fix audit problem for retained messages
+        //message = connection.receive(3, TimeUnit.SECONDS);
+        //assertNotNull(message);
+    }
+
     @Test(timeout = 60 * 1000)
     public void testCleanSession() throws Exception {
         final String CLIENTID = "cleansession";
