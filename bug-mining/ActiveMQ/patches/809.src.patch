diff --git a/activemq-core/src/main/java/org/apache/activemq/store/kahadb/KahaDBStore.java b/activemq-core/src/main/java/org/apache/activemq/store/kahadb/KahaDBStore.java
index e43853e87..1dddef796 100644
--- a/activemq-core/src/main/java/org/apache/activemq/store/kahadb/KahaDBStore.java
+++ b/activemq-core/src/main/java/org/apache/activemq/store/kahadb/KahaDBStore.java
@@ -207,13 +207,7 @@ public class KahaDBStore extends MessageDatabase implements PersistenceAdapter {
                     public Boolean execute(Transaction tx) throws IOException {
                         // Iterate through all index entries to get a count of messages in the destination.
                         StoredDestination sd = getStoredDestination(dest, tx);
-                        boolean result = true;
-                        for (Iterator<Entry<Location, Long>> iterator = sd.locationIndex.iterator(tx); iterator.hasNext();) {
-                            iterator.next();
-                            result = false;
-                            break;
-                        }
-                        return result;
+                        return sd.locationIndex.isEmpty(tx);
                     }
                 });
             }
diff --git a/kahadb/src/main/java/org/apache/kahadb/index/BTreeIndex.java b/kahadb/src/main/java/org/apache/kahadb/index/BTreeIndex.java
index 4cba413a8..350a654ce 100644
--- a/kahadb/src/main/java/org/apache/kahadb/index/BTreeIndex.java
+++ b/kahadb/src/main/java/org/apache/kahadb/index/BTreeIndex.java
@@ -220,6 +220,10 @@ public class BTreeIndex<Key,Value> implements Index<Key,Value> {
         pw.flush();
     }
 
+    synchronized public boolean isEmpty(final Transaction tx) throws IOException {
+        return getRoot(tx).isEmpty(tx);
+    }
+
     synchronized public Iterator<Map.Entry<Key,Value>> iterator(final Transaction tx) throws IOException {
         return getRoot(tx).iterator(tx);
     }
diff --git a/kahadb/src/main/java/org/apache/kahadb/index/BTreeNode.java b/kahadb/src/main/java/org/apache/kahadb/index/BTreeNode.java
index 372f43022..a32de749c 100644
--- a/kahadb/src/main/java/org/apache/kahadb/index/BTreeNode.java
+++ b/kahadb/src/main/java/org/apache/kahadb/index/BTreeNode.java
@@ -507,6 +507,10 @@ public final class BTreeNode<Key,Value> {
         }
     }
     
+    public boolean isEmpty(final Transaction tx) throws IOException {
+        return keys.length==0;
+    }
+
     public void visit(Transaction tx, BTreeVisitor<Key, Value> visitor) throws IOException {
         if (visitor == null) {
             throw new IllegalArgumentException("Visitor cannot be null");
