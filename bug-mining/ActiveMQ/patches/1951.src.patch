diff --git a/activemq-amqp/src/main/java/org/apache/activemq/transport/amqp/AmqpProtocolConverter.java b/activemq-amqp/src/main/java/org/apache/activemq/transport/amqp/AmqpProtocolConverter.java
index dc621e532..bb37ecc65 100644
--- a/activemq-amqp/src/main/java/org/apache/activemq/transport/amqp/AmqpProtocolConverter.java
+++ b/activemq-amqp/src/main/java/org/apache/activemq/transport/amqp/AmqpProtocolConverter.java
@@ -136,7 +136,7 @@ class AmqpProtocolConverter {
                 public void receivedFrame(TransportFrame transportFrame) {
                     if (TRACE_FRAMES.isTraceEnabled()) {
                         TRACE_FRAMES.trace(String.format("%s | RECV: %s",
-                            AmqpProtocolConverter.this.amqpTransport.getRemoteAddress(), transportFrame.getBody()));
+                                AmqpProtocolConverter.this.amqpTransport.getRemoteAddress(), transportFrame.getBody()));
                     }
                 }
 
@@ -144,7 +144,7 @@ class AmqpProtocolConverter {
                 public void sentFrame(TransportFrame transportFrame) {
                     if (TRACE_FRAMES.isTraceEnabled()) {
                         TRACE_FRAMES.trace(String.format("%s | SENT: %s",
-                            AmqpProtocolConverter.this.amqpTransport.getRemoteAddress(), transportFrame.getBody()));
+                                AmqpProtocolConverter.this.amqpTransport.getRemoteAddress(), transportFrame.getBody()));
                     }
                 }
             });
@@ -741,6 +741,9 @@ class AmqpProtocolConverter {
         private final Sender sender;
         private final boolean presettle;
         private boolean closed;
+        public ConsumerInfo info;
+        private boolean endOfBrowse = false;
+
 
         public ConsumerContext(ConsumerId consumerId, Sender sender) {
             this.consumerId = consumerId;
@@ -825,7 +828,8 @@ class AmqpProtocolConverter {
                     final ActiveMQMessage jms = (ActiveMQMessage) md.getMessage();
                     if (jms == null) {
                         // It's the end of browse signal.
-                        sender.drained();
+                        endOfBrowse = true;
+                        drainCheck();
                     } else {
                         jms.setRedeliveryCounter(md.getRedeliveryCounter());
                         jms.setReadOnlyBody(true);
@@ -900,6 +904,11 @@ class AmqpProtocolConverter {
 
         @Override
         public void drainCheck() {
+            // If we are a browser.. lets not say we are drained until
+            // we hit the end of browse message.
+            if( info.isBrowser() && !endOfBrowse)
+                return;
+
             if (outbound.isEmpty()) {
                 sender.drained();
             }
@@ -1018,6 +1027,7 @@ class AmqpProtocolConverter {
 
             subscriptionsByConsumerId.put(id, consumerContext);
             ConsumerInfo consumerInfo = new ConsumerInfo(id);
+            consumerContext.info = consumerInfo;
             consumerInfo.setSelector(selector);
             consumerInfo.setNoRangeAcks(true);
             consumerInfo.setDestination(dest);
diff --git a/activemq-amqp/src/test/resources/test.properties b/activemq-amqp/src/test/resources/test.properties
new file mode 100644
index 000000000..ac4ca8f1d
--- /dev/null
+++ b/activemq-amqp/src/test/resources/test.properties
@@ -0,0 +1,17 @@
+#
+# Licensed to the Apache Software Foundation (ASF) under one or more
+# contributor license agreements.  See the NOTICE file distributed with
+# this work for additional information regarding copyright ownership.
+# The ASF licenses this file to You under the Apache License, Version 2.0
+# (the "License"); you may not use this file except in compliance with
+# the License.  You may obtain a copy of the License at
+#
+#      http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
+timeout=10000
\ No newline at end of file
