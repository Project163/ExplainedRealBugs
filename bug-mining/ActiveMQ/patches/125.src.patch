diff --git a/activemq-core/src/main/java/org/apache/activemq/broker/AbstractConnection.java b/activemq-core/src/main/java/org/apache/activemq/broker/AbstractConnection.java
index 97a33c309..5ab20b9ce 100755
--- a/activemq-core/src/main/java/org/apache/activemq/broker/AbstractConnection.java
+++ b/activemq-core/src/main/java/org/apache/activemq/broker/AbstractConnection.java
@@ -96,6 +96,7 @@ public abstract class AbstractConnection implements Service, Connection, Task, C
     
     private WireFormatInfo wireFormatInfo;    
     protected boolean disposed=false;
+    protected IOException transportException;
     
     static class ConnectionState extends org.apache.activemq.state.ConnectionState {
         private final ConnectionContext context;
@@ -176,6 +177,7 @@ public abstract class AbstractConnection implements Service, Connection, Task, C
     
     public void serviceTransportException(IOException e) {
         if( !disposed ) {
+            transportException = e;	
             if( transportLog.isDebugEnabled() )
                 transportLog.debug("Transport failed: "+e,e);
             ServiceSupport.dispose(this);
diff --git a/activemq-core/src/main/java/org/apache/activemq/broker/TransportConnection.java b/activemq-core/src/main/java/org/apache/activemq/broker/TransportConnection.java
index debc7fe5e..415e8dba0 100755
--- a/activemq-core/src/main/java/org/apache/activemq/broker/TransportConnection.java
+++ b/activemq-core/src/main/java/org/apache/activemq/broker/TransportConnection.java
@@ -22,13 +22,11 @@ import java.io.IOException;
 import org.apache.activemq.broker.ft.MasterBroker;
 import org.apache.activemq.command.BrokerInfo;
 import org.apache.activemq.command.Command;
-import org.apache.activemq.command.MessageDispatch;
 import org.apache.activemq.command.Response;
 import org.apache.activemq.command.ShutdownInfo;
 import org.apache.activemq.thread.TaskRunnerFactory;
 import org.apache.activemq.transport.DefaultTransportListener;
 import org.apache.activemq.transport.Transport;
-import org.apache.activemq.transport.TransportListener;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 
@@ -85,7 +83,12 @@ public class TransportConnection extends AbstractConnection {
             if (masterBroker != null){
                 masterBroker.stop();
             }
-            transport.oneway(new ShutdownInfo());
+            
+            // If the transport has not failed yet,
+            // notify the peer that we are doing a normal shutdown.
+            if( transportException == null ) {
+            	transport.oneway(new ShutdownInfo());
+            }
         } catch (Exception ignore) {
             //ignore.printStackTrace();
         }
diff --git a/activemq-core/src/main/java/org/apache/activemq/transport/tcp/TcpTransport.java b/activemq-core/src/main/java/org/apache/activemq/transport/tcp/TcpTransport.java
index 85e6e5e38..db2fe822e 100755
--- a/activemq-core/src/main/java/org/apache/activemq/transport/tcp/TcpTransport.java
+++ b/activemq-core/src/main/java/org/apache/activemq/transport/tcp/TcpTransport.java
@@ -296,11 +296,13 @@ public class TcpTransport extends TransportThreadSupport implements Transport, S
         initializeStreams();
 	}
 
-    protected void doStop(ServiceStopper stopper) throws Exception {    	
-        closeStreams();
+    protected void doStop(ServiceStopper stopper) throws Exception {   
+    	// Closing the streams flush the sockets before closing.. if the socket
+    	// is hung.. then this hangs the close.
+        // closeStreams();
         if (socket != null) {
             socket.close();
-        }
+        }    	
     }
 
     protected void initializeStreams() throws IOException {
