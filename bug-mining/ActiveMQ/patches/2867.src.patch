diff --git a/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/FilePendingMessageCursor.java b/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/FilePendingMessageCursor.java
index 3c2bd5f84..5bd0cdaa5 100755
--- a/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/FilePendingMessageCursor.java
+++ b/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/FilePendingMessageCursor.java
@@ -358,7 +358,7 @@ public class FilePendingMessageCursor extends AbstractPendingMessageCursor imple
 
     @Override
     public synchronized long messageSize() {
-        return memoryList.messageSize() + (isDiskListEmpty() ? 0 : (int)getDiskList().messageSize());
+        return memoryList.messageSize() + (isDiskListEmpty() ? 0 : getDiskList().messageSize());
     }
 
     /**
diff --git a/activemq-kahadb-store/src/main/java/org/apache/activemq/store/kahadb/disk/index/ListNode.java b/activemq-kahadb-store/src/main/java/org/apache/activemq/store/kahadb/disk/index/ListNode.java
index 8fed0422b..9efcd258c 100644
--- a/activemq-kahadb-store/src/main/java/org/apache/activemq/store/kahadb/disk/index/ListNode.java
+++ b/activemq-kahadb-store/src/main/java/org/apache/activemq/store/kahadb/disk/index/ListNode.java
@@ -203,7 +203,7 @@ public final class ListNode<Key, Value> {
             }
             try {
                 entryToRemove.unlink();
-                entryToRemove = null;
+
                 ListNode<Key, Value> toRemoveNode = null;
                 if (currentNode.entries.isEmpty()) {
                     // may need to free this node
@@ -237,7 +237,9 @@ public final class ListNode<Key, Value> {
                         currentNode = previousNode;
                     }
                 }
+
                 targetList.onRemove(entryToRemove);
+                entryToRemove = null;
 
                 if (toRemoveNode != null) {
                     tx.free(toRemoveNode.getPage());
diff --git a/activemq-unit-tests/src/test/java/org/apache/activemq/store/kahadb/plist/PListTest.java b/activemq-unit-tests/src/test/java/org/apache/activemq/store/kahadb/plist/PListTest.java
index 555503e8e..1c33f1ab3 100644
--- a/activemq-unit-tests/src/test/java/org/apache/activemq/store/kahadb/plist/PListTest.java
+++ b/activemq-unit-tests/src/test/java/org/apache/activemq/store/kahadb/plist/PListTest.java
@@ -32,6 +32,7 @@ import java.util.concurrent.Executors;
 import java.util.concurrent.TimeUnit;
 
 import org.apache.activemq.store.PList;
+import org.apache.activemq.store.PList.PListIterator;
 import org.apache.activemq.store.PListEntry;
 import org.apache.activemq.util.ByteSequence;
 import org.apache.activemq.util.IOHelper;
@@ -74,6 +75,7 @@ public class PListTest {
             plist.addLast(test, bs);
         }
         assertEquals(plist.size(), COUNT);
+        assertTrue(plist.messageSize() > 0);
         int count = 0;
         for (ByteSequence bs : map.values()) {
             String origStr = new String(bs.getData(), bs.getOffset(), bs.getLength());
@@ -95,6 +97,7 @@ public class PListTest {
             plist.addFirst(test, bs);
         }
         assertEquals(plist.size(), COUNT);
+        assertTrue(plist.messageSize() > 0);
         long count = plist.size() - 1;
         for (ByteSequence bs : map.values()) {
             String origStr = new String(bs.getData(), bs.getOffset(), bs.getLength());
@@ -125,6 +128,7 @@ public class PListTest {
             entry = plist.getFirst();
         }
         assertEquals(0, plist.size());
+        assertEquals(0, plist.messageSize());
     }
 
     @Test
@@ -132,6 +136,7 @@ public class PListTest {
         doTestRemove(1);
         plist.destroy();
         assertEquals(0, plist.size());
+        assertEquals(0, plist.messageSize());
     }
 
     @Test
@@ -146,6 +151,7 @@ public class PListTest {
         }
         plist.destroy();
         assertEquals(0, plist.size());
+        assertEquals(0, plist.messageSize());
     }
 
     @Test
