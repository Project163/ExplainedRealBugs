diff --git a/activemq-core/src/main/java/org/apache/activemq/command/ActiveMQBytesMessage.java b/activemq-core/src/main/java/org/apache/activemq/command/ActiveMQBytesMessage.java
index e18327797..8a1345aef 100755
--- a/activemq-core/src/main/java/org/apache/activemq/command/ActiveMQBytesMessage.java
+++ b/activemq-core/src/main/java/org/apache/activemq/command/ActiveMQBytesMessage.java
@@ -785,7 +785,7 @@ public class ActiveMQBytesMessage extends ActiveMQMessage implements BytesMessag
                 }
                 length = 0;
                 compressed = true;
-                Deflater deflater = new Deflater(Deflater.BEST_SPEED);
+                final Deflater deflater = new Deflater(Deflater.BEST_SPEED);
                 os = new FilterOutputStream(new DeflaterOutputStream(os, deflater)) {
                     public void write(byte[] arg0) throws IOException {
                         length += arg0.length;
@@ -801,6 +801,12 @@ public class ActiveMQBytesMessage extends ActiveMQMessage implements BytesMessag
                         length++;
                         out.write(arg0);
                     }
+
+                    @Override
+                    public void close() throws IOException {
+                        deflater.end();
+                        super.close();
+                    }
                 };
             }
             this.dataOut = new DataOutputStream(os);
