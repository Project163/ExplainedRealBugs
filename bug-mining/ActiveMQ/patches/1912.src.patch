diff --git a/activemq-kahadb-store/src/main/java/org/apache/activemq/store/kahadb/MessageDatabase.java b/activemq-kahadb-store/src/main/java/org/apache/activemq/store/kahadb/MessageDatabase.java
index 4d3973aee..1a1c71850 100644
--- a/activemq-kahadb-store/src/main/java/org/apache/activemq/store/kahadb/MessageDatabase.java
+++ b/activemq-kahadb-store/src/main/java/org/apache/activemq/store/kahadb/MessageDatabase.java
@@ -594,13 +594,16 @@ public abstract class MessageDatabase extends ServiceSupport implements BrokerSe
                 }
             });
 
-            // rollback any recovered inflight local transactions
+            // rollback any recovered inflight local transactions, and discard any inflight XA transactions.
             Set<TransactionId> toRollback = new HashSet<TransactionId>();
+            Set<TransactionId> toDiscard = new HashSet<TransactionId>();
             synchronized (inflightTransactions) {
                 for (Iterator<TransactionId> it = inflightTransactions.keySet().iterator(); it.hasNext(); ) {
                     TransactionId id = it.next();
                     if (id.isLocalTransaction()) {
                         toRollback.add(id);
+                    } else {
+                        toDiscard.add(id);
                     }
                 }
                 for (TransactionId tx: toRollback) {
@@ -609,6 +612,12 @@ public abstract class MessageDatabase extends ServiceSupport implements BrokerSe
                     }
                     store(new KahaRollbackCommand().setTransactionInfo(TransactionIdConversion.convertToLocal(tx)), false, null, null);
                 }
+                for (TransactionId tx: toDiscard) {
+                    if (LOG.isDebugEnabled()) {
+                        LOG.debug("discarding recovered in-flight XA transaction " + tx);
+                    }
+                    inflightTransactions.remove(tx);
+                }
             }
 
             synchronized (preparedTransactions) {
