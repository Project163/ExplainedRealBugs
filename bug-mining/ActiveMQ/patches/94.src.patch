diff --git a/activemq-core/src/main/java/org/apache/activemq/broker/BrokerService.java b/activemq-core/src/main/java/org/apache/activemq/broker/BrokerService.java
index 8c27ab1b3..e3a17f0e0 100644
--- a/activemq-core/src/main/java/org/apache/activemq/broker/BrokerService.java
+++ b/activemq-core/src/main/java/org/apache/activemq/broker/BrokerService.java
@@ -988,7 +988,7 @@ public class BrokerService implements Service, Serializable {
 
     protected DefaultPersistenceAdapterFactory createPersistenceFactory() {
         DefaultPersistenceAdapterFactory factory = new DefaultPersistenceAdapterFactory();
-        factory.setDataDirectory(getDataDirectory());
+        factory.setDataDirectoryFile(getDataDirectory());
         factory.setTaskRunnerFactory(getTaskRunnerFactory());
         return factory;
     }
diff --git a/activemq-core/src/main/java/org/apache/activemq/store/DefaultPersistenceAdapterFactory.java b/activemq-core/src/main/java/org/apache/activemq/store/DefaultPersistenceAdapterFactory.java
index 55b0a9e78..f3304e15a 100755
--- a/activemq-core/src/main/java/org/apache/activemq/store/DefaultPersistenceAdapterFactory.java
+++ b/activemq-core/src/main/java/org/apache/activemq/store/DefaultPersistenceAdapterFactory.java
@@ -125,7 +125,7 @@ public class DefaultPersistenceAdapterFactory extends DataSourceSupport implemen
 
     public File getJournalArchiveDirectory() {
         if( journalArchiveDirectory == null && useQuickJournal ) {
-            journalArchiveDirectory = new File(getDataDirectory(), "journal");
+            journalArchiveDirectory = new File(getDataDirectoryFile(), "journal");
         }
         return journalArchiveDirectory;
     }
@@ -162,7 +162,7 @@ public class DefaultPersistenceAdapterFactory extends DataSourceSupport implemen
      * @throws IOException
      */
     protected void createJournal() throws IOException {
-        File journalDir = new File(getDataDirectory(), "journal").getCanonicalFile();
+        File journalDir = new File(getDataDirectoryFile(), "journal").getCanonicalFile();
         if( failIfJournalIsLocked ) {
             journal = new JournalImpl(journalDir, journalLogFiles, journalLogFileSize, getJournalArchiveDirectory());
         } else {
diff --git a/activemq-core/src/main/java/org/apache/activemq/store/jdbc/DataSourceSupport.java b/activemq-core/src/main/java/org/apache/activemq/store/jdbc/DataSourceSupport.java
index 4cc9c5dbf..fe0b1e666 100644
--- a/activemq-core/src/main/java/org/apache/activemq/store/jdbc/DataSourceSupport.java
+++ b/activemq-core/src/main/java/org/apache/activemq/store/jdbc/DataSourceSupport.java
@@ -31,7 +31,8 @@ import java.io.IOException;
  */
 public class DataSourceSupport {
 
-    private File dataDirectory;
+    private String dataDirectory = "activemq-data";
+    private File dataDirectoryFile;
     private DataSource dataSource;
 
     public DataSourceSupport() {
@@ -41,14 +42,22 @@ public class DataSourceSupport {
         this.dataSource = dataSource;
     }
 
-    public File getDataDirectory() {
-        if (dataDirectory == null) {
-            dataDirectory = new File("activemq-data");
+    public File getDataDirectoryFile() {
+        if (dataDirectoryFile == null) {
+            dataDirectoryFile = new File(getDataDirectory());
         }
+        return dataDirectoryFile;
+    }
+
+    public void setDataDirectoryFile(File dataDirectory) {
+        this.dataDirectoryFile = dataDirectory;
+    }
+
+    public String getDataDirectory() {
         return dataDirectory;
     }
 
-    public void setDataDirectory(File dataDirectory) {
+    public void setDataDirectory(String dataDirectory) {
         this.dataDirectory = dataDirectory;
     }
 
@@ -69,7 +78,7 @@ public class DataSourceSupport {
     protected DataSource createDataSource() throws IOException {
 
         // Setup the Derby datasource.
-        System.setProperty("derby.system.home", getDataDirectory().getCanonicalPath());
+        System.setProperty("derby.system.home", getDataDirectoryFile().getCanonicalPath());
         System.setProperty("derby.storage.fileSyncTransactionLog", "true");
         System.setProperty("derby.storage.pageCacheSize", "100");
 
diff --git a/activemq-core/src/test/java/org/apache/activemq/usecases/JDBCDurableSubscriptionTest.java b/activemq-core/src/test/java/org/apache/activemq/usecases/JDBCDurableSubscriptionTest.java
index 9ba3d168c..4d739ce59 100755
--- a/activemq-core/src/test/java/org/apache/activemq/usecases/JDBCDurableSubscriptionTest.java
+++ b/activemq-core/src/test/java/org/apache/activemq/usecases/JDBCDurableSubscriptionTest.java
@@ -30,7 +30,7 @@ public class JDBCDurableSubscriptionTest extends DurableSubscriptionTestSupport
     protected PersistenceAdapter createPersistenceAdapter() throws IOException {
         File dataDir = new File("target/test-data/durableJDBC");
         DefaultPersistenceAdapterFactory factory = new DefaultPersistenceAdapterFactory();
-        factory.setDataDirectory(dataDir);
+        factory.setDataDirectoryFile(dataDir);
         factory.setUseJournal(false);
         return factory.createPersistenceAdapter();
     }
diff --git a/activemq-core/src/test/java/org/apache/activemq/usecases/JournalDurableSubscriptionTest.java b/activemq-core/src/test/java/org/apache/activemq/usecases/JournalDurableSubscriptionTest.java
index 35762e689..9679ee44a 100755
--- a/activemq-core/src/test/java/org/apache/activemq/usecases/JournalDurableSubscriptionTest.java
+++ b/activemq-core/src/test/java/org/apache/activemq/usecases/JournalDurableSubscriptionTest.java
@@ -30,7 +30,7 @@ public class JournalDurableSubscriptionTest extends DurableSubscriptionTestSuppo
     protected PersistenceAdapter createPersistenceAdapter() throws IOException {
         File dataDir = new File("target/test-data/durableJournal");
         DefaultPersistenceAdapterFactory factory = new DefaultPersistenceAdapterFactory();
-        factory.setDataDirectory(dataDir);
+        factory.setDataDirectoryFile(dataDir);
         factory.setUseJournal(true);
         factory.setJournalLogFileSize(1024*64); 
         return factory.createPersistenceAdapter();
