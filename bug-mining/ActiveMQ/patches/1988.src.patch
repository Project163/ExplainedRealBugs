diff --git a/activemq-broker/src/main/java/org/apache/activemq/broker/region/DurableTopicSubscription.java b/activemq-broker/src/main/java/org/apache/activemq/broker/region/DurableTopicSubscription.java
index 25752f269..b7fa2fe30 100755
--- a/activemq-broker/src/main/java/org/apache/activemq/broker/region/DurableTopicSubscription.java
+++ b/activemq-broker/src/main/java/org/apache/activemq/broker/region/DurableTopicSubscription.java
@@ -162,17 +162,19 @@ public class DurableTopicSubscription extends PrefetchSubscription implements Us
             }
 
             synchronized (pendingLock) {
-                pending.setSystemUsage(memoryManager);
-                pending.setMemoryUsageHighWaterMark(getCursorMemoryHighWaterMark());
-                pending.setMaxAuditDepth(getMaxAuditDepth());
-                pending.setMaxProducersToAudit(getMaxProducersToAudit());
-                pending.start();
-                // If nothing was in the persistent store, then try to use the
-                // recovery policy.
-                if (pending.isEmpty()) {
-                    for (Destination destination : durableDestinations.values()) {
-                        Topic topic = (Topic) destination;
-                        topic.recoverRetroactiveMessages(context, this);
+                if (!((StoreDurableSubscriberCursor) pending).isStarted() || !keepDurableSubsActive) {
+                    pending.setSystemUsage(memoryManager);
+                    pending.setMemoryUsageHighWaterMark(getCursorMemoryHighWaterMark());
+                    pending.setMaxAuditDepth(getMaxAuditDepth());
+                    pending.setMaxProducersToAudit(getMaxProducersToAudit());
+                    pending.start();
+                    // If nothing was in the persistent store, then try to use the
+                    // recovery policy.
+                    if (pending.isEmpty()) {
+                        for (Destination destination : durableDestinations.values()) {
+                            Topic topic = (Topic) destination;
+                            topic.recoverRetroactiveMessages(context, this);
+                        }
                     }
                 }
             }
@@ -195,7 +197,9 @@ public class DurableTopicSubscription extends PrefetchSubscription implements Us
         List<MessageReference> savedDispateched = null;
 
         synchronized (pendingLock) {
-            pending.stop();
+            if (!keepDurableSubsActive) {
+                pending.stop();
+            }
 
             synchronized (dispatchLock) {
                 for (Destination destination : durableDestinations.values()) {
diff --git a/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/AbstractPendingMessageCursor.java b/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/AbstractPendingMessageCursor.java
index d39966a47..b962a1a8d 100755
--- a/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/AbstractPendingMessageCursor.java
+++ b/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/AbstractPendingMessageCursor.java
@@ -309,7 +309,7 @@ public abstract class AbstractPendingMessageCursor implements PendingMessageCurs
         }
     }
     
-    protected synchronized boolean isStarted() {
+    public synchronized boolean isStarted() {
         return started;
     }
     
diff --git a/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/AbstractStoreCursor.java b/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/AbstractStoreCursor.java
index 7f05bfff0..c04a302e2 100644
--- a/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/AbstractStoreCursor.java
+++ b/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/AbstractStoreCursor.java
@@ -211,7 +211,7 @@ public abstract class AbstractStoreCursor extends AbstractPendingMessageCursor i
     }
 
     
-    public final synchronized void addMessageFirst(MessageReference node) throws Exception {
+    public synchronized void addMessageFirst(MessageReference node) throws Exception {
         setCacheEnabled(false);
         size++;
     }
diff --git a/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/TopicStorePrefetch.java b/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/TopicStorePrefetch.java
index b1b3a2b19..fd65faa5c 100755
--- a/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/TopicStorePrefetch.java
+++ b/activemq-broker/src/main/java/org/apache/activemq/broker/region/cursors/TopicStorePrefetch.java
@@ -16,6 +16,7 @@
  */
 package org.apache.activemq.broker.region.cursors;
 
+import org.apache.activemq.broker.region.MessageReference;
 import org.apache.activemq.broker.region.Subscription;
 import org.apache.activemq.broker.region.Topic;
 import org.apache.activemq.command.Message;
@@ -59,6 +60,11 @@ class TopicStorePrefetch extends AbstractStoreCursor {
         // shouldn't get called
         throw new RuntimeException("Not supported");
     }
+
+    public synchronized void addMessageFirst(MessageReference node) throws Exception {
+        batchList.addMessageFirst(node);
+        size++;
+    }
     
         
     @Override
diff --git a/activemq-unit-tests/src/test/java/org/apache/activemq/bugs/DurableConsumerTest.java b/activemq-unit-tests/src/test/java/org/apache/activemq/bugs/DurableConsumerTest.java
index 449a563e6..eeee82b54 100755
--- a/activemq-unit-tests/src/test/java/org/apache/activemq/bugs/DurableConsumerTest.java
+++ b/activemq-unit-tests/src/test/java/org/apache/activemq/bugs/DurableConsumerTest.java
@@ -213,6 +213,7 @@ public class DurableConsumerTest extends CombinationTestSupport{
     public void testConcurrentDurableConsumer() throws Exception{
         
         broker.start();
+        broker.waitUntilStarted();
         
         factory = createConnectionFactory();
         final String topicName = getName();
@@ -253,7 +254,7 @@ public class DurableConsumerTest extends CombinationTestSupport{
                                 }
                             }
                         } while (msg == null);
-                        
+
                         consumerConnection.close();
                     }
                     assertTrue(received >= acked);
@@ -408,6 +409,7 @@ public class DurableConsumerTest extends CombinationTestSupport{
         super.tearDown();
         if (broker != null) {
             broker.stop();
+            broker.waitUntilStopped();
             broker = null;
         }
     }
diff --git a/activemq-unit-tests/src/test/java/org/apache/activemq/usecases/DurableSubSelectorDelayWithRestartTest.java b/activemq-unit-tests/src/test/java/org/apache/activemq/usecases/DurableSubSelectorDelayWithRestartTest.java
index 1cd6b30a0..1bfd52e64 100644
--- a/activemq-unit-tests/src/test/java/org/apache/activemq/usecases/DurableSubSelectorDelayWithRestartTest.java
+++ b/activemq-unit-tests/src/test/java/org/apache/activemq/usecases/DurableSubSelectorDelayWithRestartTest.java
@@ -225,8 +225,10 @@ public class DurableSubSelectorDelayWithRestartTest {
                 } while (true);
 
             } finally {
-                sess.close();
-                con.close();
+                try {
+                    sess.close();
+                    con.close();
+                } catch (Exception e) {}
 
                 LOG.info(toString() + " OFFLINE.");
             }
diff --git a/activemq-unit-tests/src/test/java/org/apache/activemq/usecases/DurableSubscriptionOfflineTest.java b/activemq-unit-tests/src/test/java/org/apache/activemq/usecases/DurableSubscriptionOfflineTest.java
index 2f35b78dd..fe68be664 100644
--- a/activemq-unit-tests/src/test/java/org/apache/activemq/usecases/DurableSubscriptionOfflineTest.java
+++ b/activemq-unit-tests/src/test/java/org/apache/activemq/usecases/DurableSubscriptionOfflineTest.java
@@ -130,6 +130,7 @@ public class DurableSubscriptionOfflineTest extends org.apache.activemq.TestSupp
             ((KahaDBPersistenceAdapter)broker.getPersistenceAdapter()).setJournalMaxFileLength(journalMaxFileLength);
         }
         broker.start();
+        broker.waitUntilStarted();
     }
 
     private void destroyBroker() throws Exception {
@@ -1120,6 +1121,7 @@ public class DurableSubscriptionOfflineTest extends org.apache.activemq.TestSupp
             LOG.info("Iteration: " + i);
             doTestOrderOnActivateDeactivate();
             broker.stop();
+            broker.waitUntilStopped();
             createBroker(true /*deleteAllMessages*/);
         }
     }
