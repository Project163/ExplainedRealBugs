diff --git a/activemq-core/src/main/java/org/apache/activemq/store/kahadb/MessageDatabase.java b/activemq-core/src/main/java/org/apache/activemq/store/kahadb/MessageDatabase.java
index 979509c51..4b155baf7 100644
--- a/activemq-core/src/main/java/org/apache/activemq/store/kahadb/MessageDatabase.java
+++ b/activemq-core/src/main/java/org/apache/activemq/store/kahadb/MessageDatabase.java
@@ -92,6 +92,7 @@ public class MessageDatabase extends ServiceSupport implements BrokerServiceAwar
 
     public static final int CLOSED_STATE = 1;
     public static final int OPEN_STATE = 2;
+    private static final long NOT_ACKED = -1;
 
 
     protected class Metadata {
@@ -945,7 +946,7 @@ public class MessageDatabase extends ServiceSupport implements BrokerServiceAwar
         if (command.hasSubscriptionInfo()) {
             String subscriptionKey = command.getSubscriptionKey();
             sd.subscriptions.put(tx, subscriptionKey, command);
-            long ackLocation=-1;
+            long ackLocation=NOT_ACKED;
             if (!command.getRetroactive()) {
                 ackLocation = sd.nextMessageId-1;
             }
@@ -1263,6 +1264,16 @@ public class MessageDatabase extends ServiceSupport implements BrokerServiceAwar
                 Entry<String, Long> entry = iterator.next();
                 addAckLocation(rc, entry.getValue(), entry.getKey());
             }
+            
+            if (rc.nextMessageId == 0) {
+                // check for existing durable sub all acked out - pull next seq from acks as messages are gone
+                if (!rc.ackPositions.isEmpty()) {
+                    Long lastAckedMessageId = rc.ackPositions.lastKey();
+                    if (lastAckedMessageId != NOT_ACKED) {
+                        rc.nextMessageId = lastAckedMessageId+1;
+                    }
+                }
+            }
 
         }
         return rc;
diff --git a/activemq-core/src/test/java/org/apache/activemq/usecases/DurableConsumerCloseAndReconnectTest.java b/activemq-core/src/test/java/org/apache/activemq/usecases/DurableConsumerCloseAndReconnectTest.java
index b1b30d42d..ce6517d0e 100755
--- a/activemq-core/src/test/java/org/apache/activemq/usecases/DurableConsumerCloseAndReconnectTest.java
+++ b/activemq-core/src/test/java/org/apache/activemq/usecases/DurableConsumerCloseAndReconnectTest.java
@@ -46,6 +46,26 @@ public class DurableConsumerCloseAndReconnectTest extends TestSupport {
     private Destination destination;
     private int messageCount;
 
+    
+    @Override
+    protected void setUp() throws Exception {
+        super.setUp();
+        deleteAllMessages();
+    }
+
+    @Override
+    protected void tearDown() throws Exception {
+        super.tearDown();
+        deleteAllMessages();
+    }
+
+    private void deleteAllMessages() throws Exception {
+        ActiveMQConnectionFactory fac = new ActiveMQConnectionFactory("vm://localhost?broker.deleteAllMessagesOnStartup=true");
+        Connection dummyConnection = fac.createConnection();
+        dummyConnection.start();
+        dummyConnection.close();
+    }
+    
     protected ActiveMQConnectionFactory createConnectionFactory() throws Exception {
         return new ActiveMQConnectionFactory("vm://localhost?broker.deleteAllMessagesOnStartup=false");
     }
@@ -60,12 +80,7 @@ public class DurableConsumerCloseAndReconnectTest extends TestSupport {
         dummyConnection.close();
 
         // now lets try again without one connection open
-        consumeMessagesDeliveredWhileConsumerClosed();
-        // now delete the db
-        ActiveMQConnectionFactory fac = new ActiveMQConnectionFactory("vm://localhost?broker.deleteAllMessagesOnStartup=true");
-        dummyConnection = fac.createConnection();
-        dummyConnection.start();
-        dummyConnection.close();
+        consumeMessagesDeliveredWhileConsumerClosed();       
     }
 
     protected void consumeMessagesDeliveredWhileConsumerClosed() throws Exception {
