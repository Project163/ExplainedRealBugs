diff --git a/activemq-web/src/main/java/org/apache/activemq/web/MessageQuery.java b/activemq-web/src/main/java/org/apache/activemq/web/MessageQuery.java
index ee06001c9..040fb60ad 100644
--- a/activemq-web/src/main/java/org/apache/activemq/web/MessageQuery.java
+++ b/activemq-web/src/main/java/org/apache/activemq/web/MessageQuery.java
@@ -112,6 +112,20 @@ public class MessageQuery extends QueueBrowseQuery {
         return null;
     }
 
+    public Map<String, Object> getPropertiesMap() throws JMSException {
+        Map<String, Object> answer = new HashMap<String, Object>();
+        Message aMessage = getMessage();
+        Enumeration iter = aMessage.getPropertyNames();
+        while (iter.hasMoreElements()) {
+            String name = (String) iter.nextElement();
+            Object value = aMessage.getObjectProperty(name);
+            if (value != null) {
+                answer.put(name, value);
+            }
+        }
+        return answer;
+    }
+
     protected Map<String, Object> createMapBody(MapMessage mapMessage) throws JMSException {
         Map<String, Object> answer = new HashMap<String, Object>();
         Enumeration iter = mapMessage.getMapNames();
diff --git a/activemq-web/src/main/java/org/apache/activemq/web/WebClient.java b/activemq-web/src/main/java/org/apache/activemq/web/WebClient.java
index 483e36177..2f72f2d83 100644
--- a/activemq-web/src/main/java/org/apache/activemq/web/WebClient.java
+++ b/activemq-web/src/main/java/org/apache/activemq/web/WebClient.java
@@ -263,7 +263,11 @@ public class WebClient implements HttpSessionActivationListener, HttpSessionBind
 
     public Connection getConnection() throws JMSException {
         if (connection == null) {
-            connection = factory.createConnection(username, password);
+            if (username != null && password != null) {
+                connection = factory.createConnection(username, password);
+            } else {
+                connection = factory.createConnection();
+            }
             connection.start();
         }
         return connection;
