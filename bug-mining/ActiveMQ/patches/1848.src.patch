diff --git a/activemq-broker/src/main/java/org/apache/activemq/network/DemandForwardingBridgeSupport.java b/activemq-broker/src/main/java/org/apache/activemq/network/DemandForwardingBridgeSupport.java
index 824be408b..8fa5c41f2 100644
--- a/activemq-broker/src/main/java/org/apache/activemq/network/DemandForwardingBridgeSupport.java
+++ b/activemq-broker/src/main/java/org/apache/activemq/network/DemandForwardingBridgeSupport.java
@@ -365,6 +365,7 @@ public abstract class DemandForwardingBridgeSupport implements NetworkBridge, Br
 
             // Before we try and build the bridge lets check if we are in a loop
             // and if so just stop now before registering anything.
+            remoteBrokerId = remoteBrokerInfo.getBrokerId();
             if (localBrokerId.equals(remoteBrokerId)) {
                  if (LOG.isTraceEnabled()) {
                      LOG.trace(configuration.getBrokerName() +
@@ -373,11 +374,12 @@ public abstract class DemandForwardingBridgeSupport implements NetworkBridge, Br
                  }
                  ServiceSupport.dispose(localBroker);
                  ServiceSupport.dispose(remoteBroker);
+                 // the bridge is left in a bit of limbo, but it won't get retried
+                 // in this state.
                  return;
             }
 
             // Fill in the remote broker's information now.
-            remoteBrokerId = remoteBrokerInfo.getBrokerId();
             remoteBrokerPath[0] = remoteBrokerId;
             remoteBrokerName = remoteBrokerInfo.getBrokerName();
         } catch (Throwable e) {
diff --git a/activemq-unit-tests/src/test/java/org/apache/activemq/network/NetworkLoopBackTest.java b/activemq-unit-tests/src/test/java/org/apache/activemq/network/NetworkLoopBackTest.java
new file mode 100644
index 000000000..4e4c11195
--- /dev/null
+++ b/activemq-unit-tests/src/test/java/org/apache/activemq/network/NetworkLoopBackTest.java
@@ -0,0 +1,66 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.activemq.network;
+
+import org.apache.activemq.util.Wait;
+import org.junit.Test;
+
+import org.apache.activemq.broker.BrokerService;
+import org.apache.activemq.broker.TransportConnector;
+
+import static junit.framework.Assert.assertEquals;
+import static junit.framework.Assert.assertTrue;
+
+public class NetworkLoopBackTest {
+    @Test
+    public void testLoopbackOnDifferentUrlScheme() throws Exception {
+        final BrokerService brokerServce = new BrokerService();
+        brokerServce.setPersistent(false);
+
+        TransportConnector transportConnector = brokerServce.addConnector("nio://0.0.0.0:0");
+        // connection filter is bypassed when scheme is different
+        final NetworkConnector networkConnector = brokerServce.addNetworkConnector("static:(tcp://"
+                + transportConnector.getConnectUri().getHost() + ":" +  transportConnector.getConnectUri().getPort() + ")");
+
+        brokerServce.start();
+        brokerServce.waitUntilStarted();
+
+        try {
+            Wait.waitFor(new Wait.Condition() {
+                @Override
+                public boolean isSatisified() throws Exception {
+                    return 1 == networkConnector.bridges.size();
+                }
+            });
+
+            final DemandForwardingBridgeSupport loopbackBridge = (DemandForwardingBridgeSupport) networkConnector.bridges.elements().nextElement();
+            assertTrue("nc started", networkConnector.isStarted());
+
+            assertTrue("It should get disposed", Wait.waitFor(new Wait.Condition() {
+                @Override
+                public boolean isSatisified() throws Exception {
+                    return loopbackBridge.getRemoteBroker().isDisposed();
+                }
+            }));
+
+            assertEquals("No peer brokers", 0, brokerServce.getBroker().getPeerBrokerInfos().length);
+
+        } finally {
+            brokerServce.stop();
+        }
+    }
+}
\ No newline at end of file
