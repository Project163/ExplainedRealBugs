diff --git a/activemq-core/src/main/java/org/apache/activemq/store/kahadb/MessageDatabase.java b/activemq-core/src/main/java/org/apache/activemq/store/kahadb/MessageDatabase.java
index 67bbdb695..bb51663cc 100644
--- a/activemq-core/src/main/java/org/apache/activemq/store/kahadb/MessageDatabase.java
+++ b/activemq-core/src/main/java/org/apache/activemq/store/kahadb/MessageDatabase.java
@@ -1333,6 +1333,7 @@ public abstract class MessageDatabase extends ServiceSupport implements BrokerSe
             if (sd.subscriptions.isEmpty(tx)) {
                 sd.messageIdIndex.clear(tx);
                 sd.locationIndex.clear(tx);
+                sd.orderIndex.clear(tx);
             }
         }
     }
@@ -2541,6 +2542,14 @@ public abstract class MessageDatabase extends ServiceSupport implements BrokerSe
             }
         }
 
+        void clear(Transaction tx) throws IOException {
+            this.remove(tx);
+            this.resetCursorPosition();
+            this.allocate(tx);
+            this.load(tx);
+            this.configureLast(tx);
+        }
+
         void remove(Transaction tx) throws IOException {
             defaultPriorityIndex.clear(tx);
             defaultPriorityIndex.unload(tx);
