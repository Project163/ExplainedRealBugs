diff --git a/activemq-web-console/src/main/java/org/apache/activemq/web/handler/BindingBeanNameUrlHandlerMapping.java b/activemq-web-console/src/main/java/org/apache/activemq/web/handler/BindingBeanNameUrlHandlerMapping.java
index 3e83ea121..f000607ad 100644
--- a/activemq-web-console/src/main/java/org/apache/activemq/web/handler/BindingBeanNameUrlHandlerMapping.java
+++ b/activemq-web-console/src/main/java/org/apache/activemq/web/handler/BindingBeanNameUrlHandlerMapping.java
@@ -17,7 +17,6 @@
 package org.apache.activemq.web.handler;
 
 import java.util.Arrays;
-import java.util.UUID;
 
 import javax.servlet.http.HttpServletRequest;
 
@@ -25,15 +24,16 @@ import org.apache.activemq.web.DestinationFacade;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 import org.springframework.web.bind.ServletRequestDataBinder;
-import org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping;
 import org.springframework.web.servlet.HandlerExecutionChain;
+import org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping;
 
 /**
- * 
+ *
  */
 public class BindingBeanNameUrlHandlerMapping extends BeanNameUrlHandlerMapping {
     private static final transient Logger LOG = LoggerFactory.getLogger(BindingBeanNameUrlHandlerMapping.class);
 
+    @Override
     protected Object getHandlerInternal(HttpServletRequest request) throws Exception {
         Object object = super.getHandlerInternal(request);
 
@@ -45,21 +45,21 @@ public class BindingBeanNameUrlHandlerMapping extends BeanNameUrlHandlerMapping
             HandlerExecutionChain handlerExecutionChain = (HandlerExecutionChain) object;
             object = handlerExecutionChain.getHandler();
         }
-        
+
         if (object != null) {
-        	// prevent CSRF attacks
-        	if (object instanceof DestinationFacade) {
-        		// check supported methods
-        		if (!Arrays.asList(((DestinationFacade)object).getSupportedHttpMethods()).contains(request.getMethod())) {
-        			throw new UnsupportedOperationException("Unsupported method " + request.getMethod() + " for path " + request.getRequestURI());
-        		}
-        		// check the 'secret'
-        		if (!request.getSession().getAttribute("secret").equals(request.getParameter("secret"))) {
-        			throw new UnsupportedOperationException("Possible CSRF attack");
-        		}
-        	}
-        	
-        	
+            // prevent CSRF attacks
+            if (object instanceof DestinationFacade) {
+                // check supported methods
+                if (!Arrays.asList(((DestinationFacade)object).getSupportedHttpMethods()).contains(request.getMethod())) {
+                    throw new UnsupportedOperationException("Unsupported method " + request.getMethod() + " for path " + request.getRequestURI());
+                }
+                // check the 'secret'
+                if (request.getSession().getAttribute("secret") == null ||
+                    !request.getSession().getAttribute("secret").equals(request.getParameter("secret"))) {
+                    throw new UnsupportedOperationException("Possible CSRF attack");
+                }
+            }
+
             ServletRequestDataBinder binder = new ServletRequestDataBinder(object, "request");
             try {
                 binder.bind(request);
@@ -73,7 +73,7 @@ public class BindingBeanNameUrlHandlerMapping extends BeanNameUrlHandlerMapping
                 throw e;
             }
         }
-        
+
         return object;
     }
 }
