diff --git a/activemq-client/src/main/java/org/apache/activemq/util/ByteSequence.java b/activemq-client/src/main/java/org/apache/activemq/util/ByteSequence.java
index ac1e01ae6..5a19f4349 100644
--- a/activemq-client/src/main/java/org/apache/activemq/util/ByteSequence.java
+++ b/activemq-client/src/main/java/org/apache/activemq/util/ByteSequence.java
@@ -75,7 +75,11 @@ public class ByteSequence {
 
     public void reset() {
         length = remaining();
-        System.arraycopy(data, offset, data, 0, length);
+        if (length > 0) {
+            System.arraycopy(data, offset, data, 0, length);
+        } else {
+            length = 0;
+        }
         offset = 0;
     }
 
diff --git a/activemq-kahadb-store/src/main/java/org/apache/activemq/store/kahadb/disk/journal/Journal.java b/activemq-kahadb-store/src/main/java/org/apache/activemq/store/kahadb/disk/journal/Journal.java
index 8e04414c1..67d4c8688 100644
--- a/activemq-kahadb-store/src/main/java/org/apache/activemq/store/kahadb/disk/journal/Journal.java
+++ b/activemq-kahadb-store/src/main/java/org/apache/activemq/store/kahadb/disk/journal/Journal.java
@@ -627,7 +627,13 @@ public class Journal {
     private void ensureAvailable(ByteSequence bs, RandomAccessFile reader, int required) throws IOException {
         if (bs.remaining() < required) {
             bs.reset();
-            bs.setLength(bs.length + reader.read(bs.data, bs.length, bs.data.length - bs.length));
+            int read = reader.read(bs.data, bs.length, bs.data.length - bs.length);
+            if (read < 0) {
+                if (bs.remaining() == 0) {
+                    throw new EOFException("request for " + required + " bytes reached EOF");
+                }
+            }
+            bs.setLength(bs.length + read);
         }
     }
 
