diff --git a/activemq-core/src/main/java/org/apache/activemq/kaha/impl/index/hash/HashIndex.java b/activemq-core/src/main/java/org/apache/activemq/kaha/impl/index/hash/HashIndex.java
index 072470728..3bc8dcda0 100644
--- a/activemq-core/src/main/java/org/apache/activemq/kaha/impl/index/hash/HashIndex.java
+++ b/activemq-core/src/main/java/org/apache/activemq/kaha/impl/index/hash/HashIndex.java
@@ -542,6 +542,7 @@ public class HashIndex implements Index, HashIndexMBean {
                 while (capacity < newCapacity) {
                     capacity <<= 1;
                 }
+                newCapacity=capacity;
                 if (newCapacity != numberOfBins) {
                     LOG.info("Resize hash bins " + this.name + " from " + numberOfBins + " to " + newCapacity);
                     
