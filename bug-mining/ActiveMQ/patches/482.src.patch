diff --git a/activemq-core/src/main/java/org/apache/activemq/command/ActiveMQStreamMessage.java b/activemq-core/src/main/java/org/apache/activemq/command/ActiveMQStreamMessage.java
index 34ad027a3..5501e53d3 100755
--- a/activemq-core/src/main/java/org/apache/activemq/command/ActiveMQStreamMessage.java
+++ b/activemq-core/src/main/java/org/apache/activemq/command/ActiveMQStreamMessage.java
@@ -1087,7 +1087,9 @@ public class ActiveMQStreamMessage extends ActiveMQMessage implements StreamMess
             writeDouble(((Double)value).doubleValue());
         } else if (value instanceof byte[]) {
             writeBytes((byte[])value);
-        }
+        }else if (value instanceof Long) {
+            writeLong(((Long)value).longValue());
+        } 
     }
 
     /**
diff --git a/activemq-core/src/test/java/org/apache/activemq/command/ActiveMQStreamMessageTest.java b/activemq-core/src/test/java/org/apache/activemq/command/ActiveMQStreamMessageTest.java
index 49088a39f..d4f80b2e8 100755
--- a/activemq-core/src/test/java/org/apache/activemq/command/ActiveMQStreamMessageTest.java
+++ b/activemq-core/src/test/java/org/apache/activemq/command/ActiveMQStreamMessageTest.java
@@ -409,6 +409,11 @@ public class ActiveMQStreamMessageTest extends TestCase {
                 fail("Should have thrown exception");
             } catch (MessageFormatException mfe) {
             }
+            msg = new ActiveMQStreamMessage();
+            msg.writeObject(new Long("1"));
+            // reset so it's readable now
+            msg.reset();
+            assertEquals(new Long("1"), msg.readObject());
         } catch (JMSException jmsEx) {
             jmsEx.printStackTrace();
             assertTrue(false);
@@ -474,7 +479,7 @@ public class ActiveMQStreamMessageTest extends TestCase {
         }
     }
 
-    public void testReadDouble() {
+    public void testReadDouble()  {
         ActiveMQStreamMessage msg = new ActiveMQStreamMessage();
         try {
             double test = 4.4d;
@@ -535,6 +540,7 @@ public class ActiveMQStreamMessageTest extends TestCase {
             jmsEx.printStackTrace();
             assertTrue(false);
         }
+      
     }
 
     public void testReadString() {
