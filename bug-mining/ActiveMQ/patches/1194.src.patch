diff --git a/activemq-core/src/main/java/org/apache/activemq/transport/discovery/DiscoveryTransportFactory.java b/activemq-core/src/main/java/org/apache/activemq/transport/discovery/DiscoveryTransportFactory.java
index 5fd30687f..6a0def814 100755
--- a/activemq-core/src/main/java/org/apache/activemq/transport/discovery/DiscoveryTransportFactory.java
+++ b/activemq-core/src/main/java/org/apache/activemq/transport/discovery/DiscoveryTransportFactory.java
@@ -37,7 +37,7 @@ public class DiscoveryTransportFactory extends FailoverTransportFactory {
     public Transport createTransport(CompositeData compositeData) throws IOException {
         Map<String, String> parameters = new HashMap<String, String>(compositeData.getParameters());
         FailoverTransport failoverTransport = createTransport(parameters);
-        return createTransport(failoverTransport, compositeData);
+        return createTransport(failoverTransport, compositeData, parameters);
     }
     
     /**
@@ -48,10 +48,9 @@ public class DiscoveryTransportFactory extends FailoverTransportFactory {
      * @return a transport that reports discovered brokers to a specific composite transport.
      * @throws IOException
      */
-    public static DiscoveryTransport createTransport(CompositeTransport compositeTransport, CompositeData compositeData) throws IOException {                
+    public static DiscoveryTransport createTransport(CompositeTransport compositeTransport, CompositeData compositeData, Map<String, String> parameters) throws IOException {
         DiscoveryTransport transport = new DiscoveryTransport(compositeTransport);
-        
-        Map<String, String> parameters = new HashMap<String, String>(compositeData.getParameters());
+
         IntrospectionSupport.setProperties(transport, parameters);
         transport.setParameters(parameters);
         
diff --git a/activemq-core/src/main/java/org/apache/activemq/transport/fanout/FanoutTransportFactory.java b/activemq-core/src/main/java/org/apache/activemq/transport/fanout/FanoutTransportFactory.java
index 5cc84c940..cc5568577 100755
--- a/activemq-core/src/main/java/org/apache/activemq/transport/fanout/FanoutTransportFactory.java
+++ b/activemq-core/src/main/java/org/apache/activemq/transport/fanout/FanoutTransportFactory.java
@@ -64,7 +64,7 @@ public class FanoutTransportFactory extends TransportFactory {
         CompositeData compositeData = URISupport.parseComposite(location);
         Map<String, String> parameters = compositeData.getParameters();
         FanoutTransport fanoutTransport = createTransport(parameters);        
-        DiscoveryTransport discoveryTransport = DiscoveryTransportFactory.createTransport(fanoutTransport, compositeData);        
+        DiscoveryTransport discoveryTransport = DiscoveryTransportFactory.createTransport(fanoutTransport, compositeData, parameters);
         return discoveryTransport;
     }
 
diff --git a/activemq-core/src/test/java/org/apache/activemq/transport/discovery/DiscoveryTransportNoBrokerTest.java b/activemq-core/src/test/java/org/apache/activemq/transport/discovery/DiscoveryTransportNoBrokerTest.java
index 02aadb0f0..a4fe6accb 100644
--- a/activemq-core/src/test/java/org/apache/activemq/transport/discovery/DiscoveryTransportNoBrokerTest.java
+++ b/activemq-core/src/test/java/org/apache/activemq/transport/discovery/DiscoveryTransportNoBrokerTest.java
@@ -125,7 +125,7 @@ public class DiscoveryTransportNoBrokerTest extends CombinationTestSupport {
         CompositeData compositeData = URISupport.parseComposite(uri);
         
         StubCompositeTransport compositeTransport = new StubCompositeTransport();      
-        DiscoveryTransport discoveryTransport = DiscoveryTransportFactory.createTransport(compositeTransport, compositeData);
+        DiscoveryTransport discoveryTransport = DiscoveryTransportFactory.createTransport(compositeTransport, compositeData, compositeData.getParameters());
         
         discoveryTransport.onServiceAdd(new DiscoveryEvent("tcp://localhost:61616"));        
         assertEquals("expected added URI after discovery event", compositeTransport.getTransportURIs().length, 1);
@@ -141,7 +141,7 @@ public class DiscoveryTransportNoBrokerTest extends CombinationTestSupport {
         CompositeData compositeData = URISupport.parseComposite(uri);
         
         StubCompositeTransport compositeTransport = new StubCompositeTransport();      
-        DiscoveryTransport discoveryTransport = DiscoveryTransportFactory.createTransport(compositeTransport, compositeData);
+        DiscoveryTransport discoveryTransport = DiscoveryTransportFactory.createTransport(compositeTransport, compositeData, compositeData.getParameters());
         
         final String serviceName = "tcp://localhost:61616";
         discoveryTransport.onServiceAdd(new DiscoveryEvent(serviceName));        
diff --git a/activemq-core/src/test/java/org/apache/activemq/transport/discovery/DiscoveryUriTest.java b/activemq-core/src/test/java/org/apache/activemq/transport/discovery/DiscoveryUriTest.java
index fe1f9522d..ddbf45d1a 100644
--- a/activemq-core/src/test/java/org/apache/activemq/transport/discovery/DiscoveryUriTest.java
+++ b/activemq-core/src/test/java/org/apache/activemq/transport/discovery/DiscoveryUriTest.java
@@ -40,7 +40,7 @@ public class DiscoveryUriTest extends EmbeddedBrokerTestSupport {
     }
 
     public void testConnect() throws Exception {
-        ActiveMQConnectionFactory factory = new ActiveMQConnectionFactory("discovery:(multicast://default?group=test&reconnectDelay=1000&maxReconnectAttempts=30&useExponentialBackOff=false)");
+        ActiveMQConnectionFactory factory = new ActiveMQConnectionFactory("discovery:(multicast://default?group=test)?reconnectDelay=1000&maxReconnectAttempts=30&useExponentialBackOff=false");
         Connection conn = factory.createConnection();
         conn.start();
 
@@ -51,4 +51,15 @@ public class DiscoveryUriTest extends EmbeddedBrokerTestSupport {
         Message msg = consumer.receive(1000);
         assertNotNull(msg);
     }
+
+    public void testFailedConnect() throws Exception {
+        try {
+            ActiveMQConnectionFactory factory = new ActiveMQConnectionFactory("discovery:(multicast://default?group=test1)?reconnectDelay=1000&maxReconnectAttempts=3&useExponentialBackOff=false");
+            Connection conn = factory.createConnection();
+            conn.start();
+        } catch (Exception e) {
+            return;
+        }
+        fail("Expected connection failure");
+    }
 }
