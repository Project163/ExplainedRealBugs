diff --git a/activemq-core/src/main/java/org/apache/activemq/broker/TransportConnector.java b/activemq-core/src/main/java/org/apache/activemq/broker/TransportConnector.java
index 3bcbaa7d7..7123e2c8c 100755
--- a/activemq-core/src/main/java/org/apache/activemq/broker/TransportConnector.java
+++ b/activemq-core/src/main/java/org/apache/activemq/broker/TransportConnector.java
@@ -240,7 +240,7 @@ public class TransportConnector implements Connector, BrokerServiceAware {
         
         DiscoveryAgent da = getDiscoveryAgent();
         if (da != null) {
-            da.registerService(getConnectUri().toString());
+            da.registerService(getPublishableConnectString());
             da.start();
         }
         if (enableStatusMonitor) {
@@ -251,6 +251,20 @@ public class TransportConnector implements Connector, BrokerServiceAware {
         LOG.info("Connector " + getName() + " Started");
     }
 
+    private String getPublishableConnectString() throws Exception {
+        URI connectUri = getConnectUri();
+        String publishableConnectString = connectUri.toString();
+        // strip off server side query parameters which may not be compatible to clients
+        if (connectUri.getRawQuery() != null) {
+            publishableConnectString = 
+                publishableConnectString.substring(0, publishableConnectString.indexOf(connectUri.getRawQuery()) -1); 
+        }
+        if (LOG.isDebugEnabled()) {
+            LOG.debug("Publishing: " + publishableConnectString + " for broker transport URI: " + connectUri);
+        }
+        return publishableConnectString;
+    }
+
     public void stop() throws Exception {
         ServiceStopper ss = new ServiceStopper();
         if (discoveryAgent != null) {
diff --git a/activemq-core/src/main/java/org/apache/activemq/transport/discovery/DiscoveryTransport.java b/activemq-core/src/main/java/org/apache/activemq/transport/discovery/DiscoveryTransport.java
index 7cbcd6e25..57c6b5934 100755
--- a/activemq-core/src/main/java/org/apache/activemq/transport/discovery/DiscoveryTransport.java
+++ b/activemq-core/src/main/java/org/apache/activemq/transport/discovery/DiscoveryTransport.java
@@ -18,6 +18,7 @@ package org.apache.activemq.transport.discovery;
 
 import java.net.URI;
 import java.net.URISyntaxException;
+import java.util.Map;
 import java.util.concurrent.ConcurrentHashMap;
 
 import org.apache.activemq.command.DiscoveryEvent;
@@ -41,6 +42,8 @@ public class DiscoveryTransport extends TransportFilter implements DiscoveryList
     private DiscoveryAgent discoveryAgent;
     private final ConcurrentHashMap<String, URI> serviceURIs = new ConcurrentHashMap<String, URI>();
 
+    private Map<String, String> parameters;
+
     public DiscoveryTransport(CompositeTransport next) {
         super(next);
         this.next = next;
@@ -71,13 +74,27 @@ public class DiscoveryTransport extends TransportFilter implements DiscoveryList
                 URI uri = new URI(url);
                 serviceURIs.put(event.getServiceName(), uri);
                 LOG.info("Adding new broker connection URL: " + uri);
-                next.add(new URI[] {uri});
+                next.add(new URI[] {applyParameters(uri)});
             } catch (URISyntaxException e) {
                 LOG.warn("Could not connect to remote URI: " + url + " due to bad URI syntax: " + e, e);
             }
         }
     }
 
+    private URI applyParameters(URI uri) throws URISyntaxException {
+        if (parameters != null && !parameters.isEmpty()) {
+            StringBuffer newQuery = uri.getRawQuery() != null ? new StringBuffer(uri.getRawQuery()) : new StringBuffer() ;
+            for ( Map.Entry<String, String> param: parameters.entrySet()) {
+                if (newQuery.length()!=0) {
+                    newQuery.append(';');
+                }
+                newQuery.append(param.getKey()).append('=').append(param.getValue());
+            }
+            uri = new URI(uri.getScheme(), uri.getAuthority(), uri.getPath(), newQuery.toString(), uri.getFragment());
+        }
+        return uri;
+}
+
     public void onServiceRemove(DiscoveryEvent event) {
         URI uri = serviceURIs.get(event.getServiceName());
         if (uri != null) {
@@ -93,4 +110,8 @@ public class DiscoveryTransport extends TransportFilter implements DiscoveryList
         this.discoveryAgent = discoveryAgent;
     }
 
+    public void setParameters(Map<String, String> parameters) {
+       this.parameters = parameters;      
+    }
+
 }
diff --git a/activemq-core/src/main/java/org/apache/activemq/transport/discovery/DiscoveryTransportFactory.java b/activemq-core/src/main/java/org/apache/activemq/transport/discovery/DiscoveryTransportFactory.java
index 4a4ab4b23..d3c2dacd0 100755
--- a/activemq-core/src/main/java/org/apache/activemq/transport/discovery/DiscoveryTransportFactory.java
+++ b/activemq-core/src/main/java/org/apache/activemq/transport/discovery/DiscoveryTransportFactory.java
@@ -39,7 +39,7 @@ public class DiscoveryTransportFactory extends FailoverTransportFactory {
         DiscoveryAgent discoveryAgent = DiscoveryAgentFactory.createDiscoveryAgent(compositData.getComponents()[0]);
         transport.setDiscoveryAgent(discoveryAgent);
         IntrospectionSupport.setProperties(transport, parameters);
-
+        transport.setParameters(parameters);
         return transport;
     }
 
diff --git a/activemq-core/src/main/java/org/apache/activemq/transport/discovery/multicast/MulticastDiscoveryAgent.java b/activemq-core/src/main/java/org/apache/activemq/transport/discovery/multicast/MulticastDiscoveryAgent.java
index 4a3813933..277417b22 100755
--- a/activemq-core/src/main/java/org/apache/activemq/transport/discovery/multicast/MulticastDiscoveryAgent.java
+++ b/activemq-core/src/main/java/org/apache/activemq/transport/discovery/multicast/MulticastDiscoveryAgent.java
@@ -28,6 +28,7 @@ import java.util.Iterator;
 import java.util.Map;
 import java.util.concurrent.ConcurrentHashMap;
 import java.util.concurrent.Executor;
+import java.util.concurrent.ExecutorService;
 import java.util.concurrent.LinkedBlockingQueue;
 import java.util.concurrent.ThreadFactory;
 import java.util.concurrent.ThreadPoolExecutor;
@@ -176,7 +177,7 @@ public class MulticastDiscoveryAgent implements DiscoveryAgent, Runnable {
     private long lastAdvertizeTime;
     private AtomicBoolean started = new AtomicBoolean(false);
     private boolean reportAdvertizeFailed = true;
-    private Executor executor = null;
+    private ExecutorService executor = null;
 
     /**
      * Set the discovery listener
@@ -315,6 +316,8 @@ public class MulticastDiscoveryAgent implements DiscoveryAgent, Runnable {
             if (mcast != null) {
                 mcast.close();
             }
+            runner.interrupt();
+            getExecutor().shutdownNow();
         }
     }
 
@@ -488,7 +491,7 @@ public class MulticastDiscoveryAgent implements DiscoveryAgent, Runnable {
         }
     }
 
-    private Executor getExecutor() {
+    private ExecutorService getExecutor() {
         if (executor == null) {
             final String threadName = "Notifier-" + this.toString();
             executor = new ThreadPoolExecutor(1, 1, 30, TimeUnit.SECONDS, new LinkedBlockingQueue<Runnable>(), new ThreadFactory() {
diff --git a/activemq-core/src/test/java/org/apache/activemq/transport/discovery/DiscoveryTransportNoBrokerTest.java b/activemq-core/src/test/java/org/apache/activemq/transport/discovery/DiscoveryTransportNoBrokerTest.java
index 89f5188d0..06944f517 100644
--- a/activemq-core/src/test/java/org/apache/activemq/transport/discovery/DiscoveryTransportNoBrokerTest.java
+++ b/activemq-core/src/test/java/org/apache/activemq/transport/discovery/DiscoveryTransportNoBrokerTest.java
@@ -16,11 +16,16 @@
  */
 package org.apache.activemq.transport.discovery;
 
+import java.net.URI;
+import java.util.Vector;
+
 import javax.jms.Connection;
 import javax.jms.JMSException;
 
 import org.apache.activemq.ActiveMQConnectionFactory;
 import org.apache.activemq.CombinationTestSupport;
+import org.apache.activemq.broker.BrokerService;
+import org.apache.activemq.broker.TransportConnector;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 
@@ -28,6 +33,51 @@ public class DiscoveryTransportNoBrokerTest extends CombinationTestSupport {
 
     private static final Log LOG = LogFactory.getLog(DiscoveryTransportNoBrokerTest.class);
     
+
+    public void testNoExtraThreads() throws Exception {
+        BrokerService broker = new BrokerService();
+        TransportConnector tcp = broker.addConnector("tcp://localhost:0?transport.closeAsync=false");
+        String group = "GR-" +  System.currentTimeMillis();
+        URI discoveryUri = new URI("multicast://default?group=" + group);
+        tcp.setDiscoveryUri(discoveryUri);
+        broker.start();
+        broker.waitUntilStarted();
+        
+        Vector<String> existingNames = new Vector<String>();
+        Thread[] threads = getThreads();
+        for (Thread t : threads) {
+            existingNames.add(t.getName());
+        }
+        final int idleThreadCount = threads.length;
+        LOG.info("Broker started - thread Count:" + idleThreadCount);
+        
+       final int noConnectionToCreate = 10;
+        for (int i=0; i<10;i++) {
+            ActiveMQConnectionFactory factory = 
+                new ActiveMQConnectionFactory("discovery:(multicast://239.255.2.3:6155?group=" + group +")?closeAsync=false");
+            LOG.info("Connecting.");
+            Connection connection = factory.createConnection();
+            connection.setClientID("test");  
+            connection.close();
+        }
+        Thread.sleep(2000);
+        threads = getThreads();
+        for (Thread t : threads) {
+            if (!existingNames.contains(t.getName())) {
+                LOG.info("Remaining thread:" + t);
+            }
+        }
+        assertTrue("no extra threads per connection", Thread.activeCount() - idleThreadCount < noConnectionToCreate);
+    }
+   
+    
+    private Thread[] getThreads() {
+        Thread[] threads = new Thread[Thread.activeCount()];
+        Thread.enumerate(threads);
+        return threads;
+    }
+
+
     public void testMaxReconnectAttempts() throws JMSException {
         try {
             ActiveMQConnectionFactory factory = new ActiveMQConnectionFactory("discovery:(multicast://doesNOTexist)");
