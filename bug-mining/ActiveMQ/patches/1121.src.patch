diff --git a/activemq-core/src/main/java/org/apache/activemq/security/SimpleAuthenticationBroker.java b/activemq-core/src/main/java/org/apache/activemq/security/SimpleAuthenticationBroker.java
index 3b5ca10e7..b194d7746 100644
--- a/activemq-core/src/main/java/org/apache/activemq/security/SimpleAuthenticationBroker.java
+++ b/activemq-core/src/main/java/org/apache/activemq/security/SimpleAuthenticationBroker.java
@@ -92,7 +92,13 @@ public class SimpleAuthenticationBroker extends BrokerFilter {
             context.setSecurityContext(s);
             securityContexts.add(s);
         }
-        super.addConnection(context, info);
+        try {
+            super.addConnection(context, info);
+        } catch (Exception e) {
+            securityContexts.remove(s);
+            context.setSecurityContext(null);
+            throw e;
+        }
     }
 
     public void removeConnection(ConnectionContext context, ConnectionInfo info, Throwable error)
