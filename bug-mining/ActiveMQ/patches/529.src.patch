diff --git a/activemq-core/src/main/java/org/apache/activemq/ActiveMQSession.java b/activemq-core/src/main/java/org/apache/activemq/ActiveMQSession.java
index dea1d241a..5e8393314 100755
--- a/activemq-core/src/main/java/org/apache/activemq/ActiveMQSession.java
+++ b/activemq-core/src/main/java/org/apache/activemq/ActiveMQSession.java
@@ -554,7 +554,7 @@ public class ActiveMQSession implements Session, QueueSession, TopicSession, Sta
      */
     public void close() throws JMSException {
         if (!closed) {
-            if (getTransacted()) {
+            if (getTransactionContext().isInXATransaction()) {
                 if (!synchronizationRegistered) {
                     synchronizationRegistered = true;
                     getTransactionContext().addSynchronization(new Synchronization() {
diff --git a/activemq-core/src/test/java/org/apache/activemq/broker/ft/TransactedTopicMasterSlaveTest.java b/activemq-core/src/test/java/org/apache/activemq/broker/ft/TransactedTopicMasterSlaveTest.java
index 04a4c1282..da4fee6c5 100644
--- a/activemq-core/src/test/java/org/apache/activemq/broker/ft/TransactedTopicMasterSlaveTest.java
+++ b/activemq-core/src/test/java/org/apache/activemq/broker/ft/TransactedTopicMasterSlaveTest.java
@@ -23,7 +23,7 @@ import org.apache.activemq.broker.BrokerService;
 import org.apache.activemq.test.JmsResourceProvider;
 
 /**
- * Test failover for Queues
+ * Test failover for Topics
  */
 public class TransactedTopicMasterSlaveTest extends JmsTopicTransactionTest {
     protected BrokerService slave;
