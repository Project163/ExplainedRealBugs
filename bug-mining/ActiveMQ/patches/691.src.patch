diff --git a/activemq-core/src/main/java/org/apache/activemq/ActiveMQConnection.java b/activemq-core/src/main/java/org/apache/activemq/ActiveMQConnection.java
index 5fe95dac3..106d8b72f 100755
--- a/activemq-core/src/main/java/org/apache/activemq/ActiveMQConnection.java
+++ b/activemq-core/src/main/java/org/apache/activemq/ActiveMQConnection.java
@@ -1435,7 +1435,7 @@ public class ActiveMQConnection implements Connection, TopicConnection, QueueCon
 
         if (isConnectionInfoSentToBroker) {
             if (!transportFailed.get() && !closing.get()) {
-                asyncSendPacket(info.createRemoveCommand());
+                syncSendPacket(info.createRemoveCommand());
             }
             isConnectionInfoSentToBroker = false;
         }
diff --git a/activemq-core/src/main/java/org/apache/activemq/TransactionContext.java b/activemq-core/src/main/java/org/apache/activemq/TransactionContext.java
index 8faa7617a..07d593f6f 100755
--- a/activemq-core/src/main/java/org/apache/activemq/TransactionContext.java
+++ b/activemq-core/src/main/java/org/apache/activemq/TransactionContext.java
@@ -64,7 +64,7 @@ public class TransactionContext implements XAResource {
     private static final Log LOG = LogFactory.getLog(TransactionContext.class);
 
     // XATransactionId -> ArrayList of TransactionContext objects
-    private final ConcurrentHashMap<TransactionId, List<TransactionContext>> ENDED_XA_TRANSACTION_CONTEXTS = new ConcurrentHashMap<TransactionId, List<TransactionContext>>();
+    private final static ConcurrentHashMap<TransactionId, List<TransactionContext>> ENDED_XA_TRANSACTION_CONTEXTS = new ConcurrentHashMap<TransactionId, List<TransactionContext>>();
 
     private final ActiveMQConnection connection;
     private final LongSequenceGenerator localTransactionIdGenerator;
diff --git a/activemq-ra/src/test/java/org/apache/activemq/ra/JmsXARollback2CxTransactionTest.java b/activemq-ra/src/test/java/org/apache/activemq/ra/JmsXARollback2CxTransactionTest.java
index 4a171ca67..a3320ff39 100644
--- a/activemq-ra/src/test/java/org/apache/activemq/ra/JmsXARollback2CxTransactionTest.java
+++ b/activemq-ra/src/test/java/org/apache/activemq/ra/JmsXARollback2CxTransactionTest.java
@@ -63,8 +63,14 @@ public class JmsXARollback2CxTransactionTest extends JmsQueueTransactionTest {
         return (ConnectionFactory) managedConnectionFactory.createConnectionFactory(connectionManager);
     }
 
-    public void xtestRepeatReceiveTwoThenRollback() throws Exception {
+    public void testReconnectWithClientId() throws Exception {
         for (index = 0; index< 20; index ++) {
+            reconnect();
+        }
+    }
+
+    public void testRepeatReceiveTwoThenRollback() throws Exception {
+        for (index = 0; index< 2; index ++) {
             testReceiveTwoThenRollback();
         }
     }
