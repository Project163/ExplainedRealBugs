diff --git a/activemq-core/src/main/java/org/apache/activemq/broker/region/AbstractSubscription.java b/activemq-core/src/main/java/org/apache/activemq/broker/region/AbstractSubscription.java
index 7b81e50f0..f7dd16fff 100755
--- a/activemq-core/src/main/java/org/apache/activemq/broker/region/AbstractSubscription.java
+++ b/activemq-core/src/main/java/org/apache/activemq/broker/region/AbstractSubscription.java
@@ -198,7 +198,7 @@ public abstract class AbstractSubscription implements Subscription {
     public void addDestination(Destination destination) {
         
     }
-    
+       
     
     /**
      * Remove a destination
@@ -207,6 +207,10 @@ public abstract class AbstractSubscription implements Subscription {
     public void removeDestination(Destination destination) {
         
     }
+    
+    public int countBeforeFull() {
+        return getDispatchedQueueSize() - info.getPrefetchSize();
+    }
 
     protected void doAddRecoveredMessage(MessageReference message) throws Exception {
         add(message);
diff --git a/activemq-core/src/main/java/org/apache/activemq/broker/region/BaseDestination.java b/activemq-core/src/main/java/org/apache/activemq/broker/region/BaseDestination.java
index 83987ff99..c78ad64f3 100755
--- a/activemq-core/src/main/java/org/apache/activemq/broker/region/BaseDestination.java
+++ b/activemq-core/src/main/java/org/apache/activemq/broker/region/BaseDestination.java
@@ -34,10 +34,10 @@ import org.apache.activemq.usage.Usage;
  */
 public abstract class BaseDestination implements Destination {
     /**
-     * The default number of messages to page in to the destination
+     * The maximum number of messages to page in to the destination
      * from persistent storage
      */
-    public static final int DEFAULT_PAGE_SIZE=200;
+    public static final int MAX_PAGE_SIZE=200;
    
     protected final ActiveMQDestination destination;
     protected final Broker broker;
@@ -48,7 +48,7 @@ public abstract class BaseDestination implements Destination {
     private int maxProducersToAudit=1024;
     private int maxAuditDepth=2048;
     private boolean enableAudit=true;
-    private int maxPageSize=DEFAULT_PAGE_SIZE;
+    private int maxPageSize=MAX_PAGE_SIZE;
     private boolean useCache=true;
     private int minimumMessageSize=1024;
     private boolean lazyDispatch=false;
diff --git a/activemq-core/src/main/java/org/apache/activemq/broker/region/Queue.java b/activemq-core/src/main/java/org/apache/activemq/broker/region/Queue.java
index 3f2781838..4dfa731bd 100755
--- a/activemq-core/src/main/java/org/apache/activemq/broker/region/Queue.java
+++ b/activemq-core/src/main/java/org/apache/activemq/broker/region/Queue.java
@@ -228,7 +228,6 @@ public class Queue extends BaseDestination implements Task {
             // duplicates
             // etc.
             doPageIn(false);
-//            msgContext.setDestination(destination);
 
             synchronized (pagedInMessages) {
                 RecoveryDispatch rd = new RecoveryDispatch();
@@ -240,13 +239,17 @@ public class Queue extends BaseDestination implements Task {
             if( sub instanceof QueueBrowserSubscription ) {
                 ((QueueBrowserSubscription)sub).incrementQueueRef();
             }
-            
+            if (!this.optimizedDispatch) {
+                    wakeup();
+            }
         }finally {
             dispatchLock.unlock();
         }
+        if (this.optimizedDispatch) {
         // Outside of dispatchLock() to maintain the lock hierarchy of
         // iteratingMutex -> dispatchLock. - see https://issues.apache.org/activemq/browse/AMQ-1878
-        wakeup();
+            wakeup();
+        }
     }
 
     public void removeSubscription(ConnectionContext context, Subscription sub)
@@ -300,12 +303,17 @@ public class Queue extends BaseDestination implements Task {
             if (consumers.isEmpty()) {
                 messages.gc();
             }
+            if (!this.optimizedDispatch) {
+                wakeup();
+            }
         }finally {
             dispatchLock.unlock();
         }
-        // Outside of dispatchLock() to maintain the lock hierarchy of
-        // iteratingMutex -> dispatchLock. - see https://issues.apache.org/activemq/browse/AMQ-1878
-        wakeup();
+        if (this.optimizedDispatch) {
+            // Outside of dispatchLock() to maintain the lock hierarchy of
+            // iteratingMutex -> dispatchLock. - see https://issues.apache.org/activemq/browse/AMQ-1878
+            wakeup();
+        }
     }
 
     public void send(final ProducerBrokerExchange producerExchange, final Message message) throws Exception {
@@ -1099,6 +1107,7 @@ public class Queue extends BaseDestination implements Task {
         dispatchLock.lock();
         try{
             int toPageIn = (getMaxPageSize()+(int)destinationStatistics.getInflight().getCount()) - pagedInMessages.size();
+            toPageIn = Math.min(toPageIn,getMaxPageSize());
             if (isLazyDispatch()&& !force) {
              // Only page in the minimum number of messages which can be dispatched immediately.
              toPageIn = Math.min(getConsumerMessageCountBeforeFull(), toPageIn);
@@ -1142,7 +1151,7 @@ public class Queue extends BaseDestination implements Task {
         dispatchLock.lock();
         try {
             if(!pagedInPendingDispatch.isEmpty()) {
-//                System.out.println(getName()+": dispatching from pending: "+pagedInPendingDispatch.size());
+ //              System.out.println(getName()+": dispatching from pending: "+pagedInPendingDispatch.size());
                 // Try to first dispatch anything that had not been dispatched before.
                 pagedInPendingDispatch = doActualDispatch(pagedInPendingDispatch);
 //                System.out.println(getName()+": new pending list1: "+pagedInPendingDispatch.size());
@@ -1237,9 +1246,8 @@ public class Queue extends BaseDestination implements Task {
         boolean zeroPrefetch = false;
         synchronized (consumers) {
             for (Subscription s : consumers) {
-            	PrefetchSubscription ps = (PrefetchSubscription) s;
-            	zeroPrefetch |= ps.getPrefetchSize() == 0;
-            	int countBeforeFull = ps.countBeforeFull();
+            	zeroPrefetch |= s.getPrefetchSize() == 0;
+            	int countBeforeFull = s.countBeforeFull();
                 total += countBeforeFull;
             }
         }
diff --git a/activemq-core/src/main/java/org/apache/activemq/broker/region/Subscription.java b/activemq-core/src/main/java/org/apache/activemq/broker/region/Subscription.java
index 3ec5955e9..e5c921ebe 100755
--- a/activemq-core/src/main/java/org/apache/activemq/broker/region/Subscription.java
+++ b/activemq-core/src/main/java/org/apache/activemq/broker/region/Subscription.java
@@ -216,4 +216,9 @@ public interface Subscription extends SubscriptionRecovery {
      * @return true if a browser
      */
     boolean isBrowser();
+    
+    /**
+     * @return the number of messages this subscription can accept before its full
+     */
+    int countBeforeFull();
 }
diff --git a/activemq-core/src/main/java/org/apache/activemq/broker/region/Topic.java b/activemq-core/src/main/java/org/apache/activemq/broker/region/Topic.java
index b14041431..47164791d 100755
--- a/activemq-core/src/main/java/org/apache/activemq/broker/region/Topic.java
+++ b/activemq-core/src/main/java/org/apache/activemq/broker/region/Topic.java
@@ -220,11 +220,8 @@ public class Topic  extends BaseDestination  implements Task{
                             if (subscription.matches(message, msgContext)) {
                                 subscription.add(message);
                             }
-                        } catch (InterruptedException e) {
-                            Thread.currentThread().interrupt();
                         } catch (IOException e) {
-                            // TODO: Need to handle this better.
-                            e.printStackTrace();
+                           LOG.error("Failed to recover this message " + message);
                         }
                         return true;
                     }
@@ -570,7 +567,6 @@ public class Topic  extends BaseDestination  implements Task{
                     return;
                 }
             }
-            
             MessageEvaluationContext msgContext = context.getMessageEvaluationContext();
             msgContext.setDestination(destination);
             msgContext.setMessageReference(message);
diff --git a/activemq-core/src/main/java/org/apache/activemq/broker/region/policy/PolicyEntry.java b/activemq-core/src/main/java/org/apache/activemq/broker/region/policy/PolicyEntry.java
index 97561af89..6d230aeb9 100644
--- a/activemq-core/src/main/java/org/apache/activemq/broker/region/policy/PolicyEntry.java
+++ b/activemq-core/src/main/java/org/apache/activemq/broker/region/policy/PolicyEntry.java
@@ -58,7 +58,7 @@ public class PolicyEntry extends DestinationMapEntry {
     private boolean enableAudit=true;
     private boolean producerFlowControl = true;
     private boolean optimizedDispatch=false;
-    private int maxPageSize=100;
+    private int maxPageSize=BaseDestination.MAX_PAGE_SIZE;
     private boolean useCache=true;
     private long minimumMessageSize=1024;
     private boolean useConsumerPriority=true;
