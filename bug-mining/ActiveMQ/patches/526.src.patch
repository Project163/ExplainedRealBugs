diff --git a/activemq-core/src/main/java/org/apache/activemq/xbean/XBeanBrokerService.java b/activemq-core/src/main/java/org/apache/activemq/xbean/XBeanBrokerService.java
index 446445a8f..2a039866d 100644
--- a/activemq-core/src/main/java/org/apache/activemq/xbean/XBeanBrokerService.java
+++ b/activemq-core/src/main/java/org/apache/activemq/xbean/XBeanBrokerService.java
@@ -16,7 +16,10 @@
  */
 package org.apache.activemq.xbean;
 
+import java.io.IOException;
+
 import org.apache.activemq.broker.BrokerService;
+import org.apache.activemq.usage.SystemUsage;
 import org.springframework.beans.BeansException;
 import org.springframework.beans.factory.DisposableBean;
 import org.springframework.beans.factory.InitializingBean;
@@ -48,6 +51,7 @@ public class XBeanBrokerService extends BrokerService implements InitializingBea
     }
 
     public void afterPropertiesSet() throws Exception {
+        ensureSystemUsageHasStore();
         if (start) {
             start();
         }
@@ -62,6 +66,16 @@ public class XBeanBrokerService extends BrokerService implements InitializingBea
         }
     }
 
+    private void ensureSystemUsageHasStore() throws IOException {
+        SystemUsage usage = getSystemUsage();
+        if (usage.getStoreUsage().getStore() == null) {
+            usage.getStoreUsage().setStore(getPersistenceAdapter());
+        }
+        if (usage.getTempUsage().getStore() == null) {
+            usage.getTempUsage().setStore(getTempDataStore());
+        }
+    }
+
     public void destroy() throws Exception {
         stop();
     }
diff --git a/activemq-core/src/test/java/org/apache/activemq/config/ConfigTest.java b/activemq-core/src/test/java/org/apache/activemq/config/ConfigTest.java
index 3e6fe65d0..88311a234 100755
--- a/activemq-core/src/test/java/org/apache/activemq/config/ConfigTest.java
+++ b/activemq-core/src/test/java/org/apache/activemq/config/ConfigTest.java
@@ -104,6 +104,8 @@ public class ConfigTest extends TestCase {
             // System.out.print("Checking persistence adapter factory
             // settings... ");
             broker.getPersistenceAdapter();
+            
+            assertTrue(broker.getSystemUsage().getStoreUsage().getStore() instanceof JournalPersistenceAdapter);
 
             LOG.info("Success");
         } finally {
@@ -240,6 +242,9 @@ public class ConfigTest extends TestCase {
             assertEquals("SystemUsage Config Error (TempUsage.limit)", 1024 * 1024 * 100, systemUsage.getTempUsage().getLimit());
             assertEquals("SystemUsage Config Error (StoreUsage.limit)", 1024 * 1024 * 1024, systemUsage.getStoreUsage().getLimit());
             assertEquals("SystemUsage Config Error (StoreUsage.name)", "foo", systemUsage.getStoreUsage().getName());
+            
+            assertNotNull(systemUsage.getStoreUsage().getStore());
+            assertTrue(systemUsage.getStoreUsage().getStore() instanceof MemoryPersistenceAdapter);
                         
             LOG.info("Success");
 
diff --git a/activemq-core/src/test/java/org/apache/activemq/memory/MemoryPropertyTest.java b/activemq-core/src/test/java/org/apache/activemq/memory/MemoryPropertyTest.java
index b51b30342..a0c132031 100644
--- a/activemq-core/src/test/java/org/apache/activemq/memory/MemoryPropertyTest.java
+++ b/activemq-core/src/test/java/org/apache/activemq/memory/MemoryPropertyTest.java
@@ -75,6 +75,9 @@ public class MemoryPropertyTest extends TestCase {
         assertEquals(1024, broker.getSystemUsage().getMemoryUsage().getLimit());
         assertEquals(34, broker.getSystemUsage().getMemoryUsage().getPercentUsageMinDelta());
         
+        assertNotNull(broker.getSystemUsage().getStoreUsage().getStore());
+        // non persistent broker so no temp storage
+        assertNull(broker.getSystemUsage().getTempUsage().getStore());
     }
 
 }
diff --git a/activemq-core/src/test/java/org/apache/activemq/transport/failover/FailoverTimeoutTest.java b/activemq-core/src/test/java/org/apache/activemq/transport/failover/FailoverTimeoutTest.java
index 7828e05c5..45517db68 100644
--- a/activemq-core/src/test/java/org/apache/activemq/transport/failover/FailoverTimeoutTest.java
+++ b/activemq-core/src/test/java/org/apache/activemq/transport/failover/FailoverTimeoutTest.java
@@ -40,7 +40,6 @@ public class FailoverTimeoutTest extends TestCase {
 		try {
 			producer.send(message);
 		} catch (JMSException jmse) {
-			jmse.printStackTrace();
 			assertEquals("Failover timeout of " + timeout + " ms reached.", jmse.getMessage());
 		}
 		
