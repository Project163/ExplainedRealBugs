diff --git a/activemq-core/src/main/java/org/apache/activemq/broker/BrokerService.java b/activemq-core/src/main/java/org/apache/activemq/broker/BrokerService.java
index c37c9d93e..9feee0226 100644
--- a/activemq-core/src/main/java/org/apache/activemq/broker/BrokerService.java
+++ b/activemq-core/src/main/java/org/apache/activemq/broker/BrokerService.java
@@ -2231,7 +2231,7 @@ public class BrokerService implements Service {
         return this.executor;
     }
     
-    protected synchronized Scheduler getScheduler() {
+    public synchronized Scheduler getScheduler() {
         if (this.scheduler==null) {
             this.scheduler = new Scheduler("ActiveMQ Broker["+getBrokerName()+"] Scheduler");
             try {
diff --git a/activemq-core/src/main/java/org/apache/activemq/store/amq/AMQPersistenceAdapter.java b/activemq-core/src/main/java/org/apache/activemq/store/amq/AMQPersistenceAdapter.java
index 397c5023a..fbecdb8fb 100644
--- a/activemq-core/src/main/java/org/apache/activemq/store/amq/AMQPersistenceAdapter.java
+++ b/activemq-core/src/main/java/org/apache/activemq/store/amq/AMQPersistenceAdapter.java
@@ -174,11 +174,13 @@ public class AMQPersistenceAdapter implements PersistenceAdapter, UsageListener,
         }
         if (this.brokerService != null) {
             this.taskRunnerFactory = this.brokerService.getTaskRunnerFactory();
-        }else {
+            this.scheduler = this.brokerService.getScheduler();
+        } else {
+            this.taskRunnerFactory = new TaskRunnerFactory("AMQPersistenceAdaptor Task", getJournalThreadPriority(),
+                true, 1000, isUseDedicatedTaskRunner());
             this.scheduler = new Scheduler("AMQPersistenceAdapter Scheduler");
         }
-        this.taskRunnerFactory= new TaskRunnerFactory("AMQPersistenceAdaptor Task", getJournalThreadPriority(),
-                true, 1000, isUseDedicatedTaskRunner());
+
         IOHelper.mkdirs(this.directory);
         lockFile = new RandomAccessFile(new File(directory, "lock"), "rw");
         lock();
@@ -201,10 +203,6 @@ public class AMQPersistenceAdapter implements PersistenceAdapter, UsageListener,
         referenceStoreAdapter.setUsageManager(usageManager);
         referenceStoreAdapter.setMaxDataFileLength(getMaxReferenceFileLength());
         
-        if (brokerService != null) {
-            this.scheduler = this.brokerService.getBroker().getScheduler();
-        }
-                
         if (failIfJournalIsLocked) {
             asyncDataManager.lock();
         } else {
@@ -336,6 +334,11 @@ public class AMQPersistenceAdapter implements PersistenceAdapter, UsageListener,
         IOException firstException = null;
         referenceStoreAdapter.stop();
         referenceStoreAdapter = null;
+
+        if (this.brokerService == null) {
+            this.taskRunnerFactory.shutdown();
+            this.scheduler.stop();
+        }
         try {
             LOG.debug("Journal close");
             asyncDataManager.close();
diff --git a/activemq-core/src/main/java/org/apache/activemq/store/journal/JournalPersistenceAdapter.java b/activemq-core/src/main/java/org/apache/activemq/store/journal/JournalPersistenceAdapter.java
index f00742bd8..e6579f73f 100755
--- a/activemq-core/src/main/java/org/apache/activemq/store/journal/JournalPersistenceAdapter.java
+++ b/activemq-core/src/main/java/org/apache/activemq/store/journal/JournalPersistenceAdapter.java
@@ -333,8 +333,6 @@ public class JournalPersistenceAdapter implements PersistenceAdapter, JournalEve
     /**
      * When we checkpoint we move all the journalled data to long term storage.
      * 
-     * @param stopping
-     * @param b
      */
     public void checkpoint(boolean sync, boolean fullCheckpoint) {
         try {
