diff --git a/activemq-core/src/main/java/org/apache/activemq/ActiveMQConnection.java b/activemq-core/src/main/java/org/apache/activemq/ActiveMQConnection.java
index 0b456247c..dbc3fa0df 100755
--- a/activemq-core/src/main/java/org/apache/activemq/ActiveMQConnection.java
+++ b/activemq-core/src/main/java/org/apache/activemq/ActiveMQConnection.java
@@ -529,53 +529,57 @@ public class ActiveMQConnection implements Connection, TopicConnection, QueueCon
     public void close() throws JMSException {
         checkClosed();
 
-        // If we were running, lets stop first.
-        stop();
+        try {
+            // If we were running, lets stop first.
+            stop();
 
-        synchronized (this) {
-            if (!closed.get()) {
-                closing.set(true);
+            synchronized (this) {
+                if (!closed.get()) {
+                    closing.set(true);
 
-                if( advisoryConsumer!=null ) {
-                    advisoryConsumer.dispose();
-                    advisoryConsumer=null;
-                }
+                    if (advisoryConsumer != null) {
+                        advisoryConsumer.dispose();
+                        advisoryConsumer = null;
+                    }
 
-                for (Iterator i = this.sessions.iterator(); i.hasNext();) {
-                    ActiveMQSession s = (ActiveMQSession) i.next();
-                    s.dispose();
-                }
-                for (Iterator i = this.connectionConsumers.iterator(); i.hasNext();) {
-                    ActiveMQConnectionConsumer c = (ActiveMQConnectionConsumer) i.next();
-                    c.dispose();
-                }
-                for (Iterator i = this.inputStreams.iterator(); i.hasNext();) {
-                    ActiveMQInputStream c = (ActiveMQInputStream) i.next();
-                    c.dispose();
-                }
-                for (Iterator i = this.outputStreams.iterator(); i.hasNext();) {
-                    ActiveMQOutputStream c = (ActiveMQOutputStream) i.next();
-                    c.dispose();
-                }
-                
-                
-                if (isConnectionInfoSentToBroker) {
-                    syncSendPacket(info.createRemoveCommand(),closeTimeout);
-                }
+                    for (Iterator i = this.sessions.iterator(); i.hasNext();) {
+                        ActiveMQSession s = (ActiveMQSession) i.next();
+                        s.dispose();
+                    }
+                    for (Iterator i = this.connectionConsumers.iterator(); i.hasNext();) {
+                        ActiveMQConnectionConsumer c = (ActiveMQConnectionConsumer) i.next();
+                        c.dispose();
+                    }
+                    for (Iterator i = this.inputStreams.iterator(); i.hasNext();) {
+                        ActiveMQInputStream c = (ActiveMQInputStream) i.next();
+                        c.dispose();
+                    }
+                    for (Iterator i = this.outputStreams.iterator(); i.hasNext();) {
+                        ActiveMQOutputStream c = (ActiveMQOutputStream) i.next();
+                        c.dispose();
+                    }
+
+                    if (isConnectionInfoSentToBroker) {
+                        syncSendPacket(info.createRemoveCommand(), closeTimeout);
+                    }
 
-                asyncSendPacket(new ShutdownInfo());
-                ServiceSupport.dispose(this.transport);
+                    asyncSendPacket(new ShutdownInfo());
+                    ServiceSupport.dispose(this.transport);
 
-                started.set(false);
+                    started.set(false);
 
-                // TODO : ActiveMQConnectionFactory.onConnectionClose() not
-                // yet implemented.
-                // factory.onConnectionClose(this);
-                
-                closed.set(true);
-                closing.set(false);
+                    // TODO : ActiveMQConnectionFactory.onConnectionClose() not
+                    // yet implemented.
+                    // factory.onConnectionClose(this);
+
+                    closed.set(true);
+                    closing.set(false);
+                }
             }
         }
+        finally {
+            factoryStats.removeConnection(this);
+        }
     }
 
     /**
