diff --git a/activemq-core/src/main/java/org/apache/activemq/broker/region/Topic.java b/activemq-core/src/main/java/org/apache/activemq/broker/region/Topic.java
index 119d78ecb..f55f29aab 100755
--- a/activemq-core/src/main/java/org/apache/activemq/broker/region/Topic.java
+++ b/activemq-core/src/main/java/org/apache/activemq/broker/region/Topic.java
@@ -222,7 +222,9 @@ public class Topic extends BaseDestination implements Task {
                     info = null;
                 } else {
                     synchronized (consumers) {
-                        consumers.add(subscription);
+                    	if (!consumers.contains(subscription)) {
+                    		consumers.add(subscription);
+                    	}
                     }
                 }
             }
diff --git a/activemq-core/src/test/java/org/apache/activemq/usecases/DurableSubscriptionActivationTest.java b/activemq-core/src/test/java/org/apache/activemq/usecases/DurableSubscriptionActivationTest.java
index 602ec1ddb..6b57c4b20 100644
--- a/activemq-core/src/test/java/org/apache/activemq/usecases/DurableSubscriptionActivationTest.java
+++ b/activemq-core/src/test/java/org/apache/activemq/usecases/DurableSubscriptionActivationTest.java
@@ -27,7 +27,7 @@ import org.apache.activemq.broker.BrokerService;
 import org.apache.activemq.broker.region.Destination;
 import org.apache.activemq.command.ActiveMQDestination;
 import org.apache.activemq.command.ActiveMQTopic;
-import org.apache.activemq.store.amq.AMQPersistenceAdapter;
+import org.apache.activemq.store.kahadb.KahaDBPersistenceAdapter;
 
 public class DurableSubscriptionActivationTest extends org.apache.activemq.TestSupport {
 
@@ -47,7 +47,7 @@ public class DurableSubscriptionActivationTest extends org.apache.activemq.TestS
 
     protected void setUp() throws Exception {
         topic = (ActiveMQTopic) createDestination();
-        createBroker();
+        createBroker(true);
         super.setUp();
     }
 
@@ -58,16 +58,18 @@ public class DurableSubscriptionActivationTest extends org.apache.activemq.TestS
 
     protected void restartBroker() throws Exception {
         destroyBroker();
-        createBroker();
+        createBroker(false);
     }
 
-    private void createBroker() throws Exception {
+    private void createBroker(boolean delete) throws Exception {
         broker = BrokerFactory.createBroker("broker:(vm://localhost)");
         broker.setKeepDurableSubsActive(true);
         broker.setPersistent(true);
-        AMQPersistenceAdapter persistenceAdapter = new AMQPersistenceAdapter();
-        persistenceAdapter.setDirectory(new File("activemq-data/" + getName()));
-        broker.setPersistenceAdapter(persistenceAdapter);
+        broker.setDeleteAllMessagesOnStartup(delete);
+        KahaDBPersistenceAdapter kahadb = new KahaDBPersistenceAdapter();
+        kahadb.setDirectory(new File("activemq-data/" + getName() + "-kahadb"));
+        kahadb.setJournalMaxFileLength(500 * 1024);
+        broker.setPersistenceAdapter(kahadb);
         broker.setBrokerName(getName());
 
         // only if we pre-create the destinations
@@ -85,14 +87,37 @@ public class DurableSubscriptionActivationTest extends org.apache.activemq.TestS
             broker.stop();
     }
 
-    public void testActivateWithExistingTopic() throws Exception {
+    public void testActivateWithExistingTopic1() throws Exception {
         // create durable subscription
         Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
         session.createDurableSubscriber(topic, "SubsId");
 
         Destination d = broker.getDestination(topic);
-        assertTrue("More than one consumer.", d.getConsumers().size() == 1);
-        
+        assertTrue("More than one consumer found: " + d.getConsumers().size(), d.getConsumers().size() == 1);
+
+        // restart the broker
+        restartBroker();
+
+        // activate
+        session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
+        session.createDurableSubscriber(topic, "SubsId");
+
+        assertTrue("More than one consumer found: " + d.getConsumers().size(), d.getConsumers().size() == 1);
+
+        // re-activate
+        connection.close();
+        connection = createConnection();
+        session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
+        session.createDurableSubscriber(topic, "SubsId");
+
+        assertTrue("More than one consumer found: " + d.getConsumers().size(), d.getConsumers().size() == 1);
+    }
+
+    public void testActivateWithExistingTopic2() throws Exception {
+        // create durable subscription
+        Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
+        session.createDurableSubscriber(topic, "SubsId");
+
         // restart the broker
         restartBroker();
 
@@ -100,7 +125,8 @@ public class DurableSubscriptionActivationTest extends org.apache.activemq.TestS
         session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
         session.createDurableSubscriber(topic, "SubsId");
 
-        assertTrue("More than one consumer.", d.getConsumers().size() == 1);
+        Destination d = broker.getDestination(topic);
+        assertTrue("More than one consumer found: " + d.getConsumers().size(), d.getConsumers().size() == 1);
 
         // re-activate
         connection.close();
@@ -108,6 +134,6 @@ public class DurableSubscriptionActivationTest extends org.apache.activemq.TestS
         session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
         session.createDurableSubscriber(topic, "SubsId");
 
-        assertTrue("More than one consumer.", d.getConsumers().size() == 1);
+        assertTrue("More than one consumer found: " + d.getConsumers().size(), d.getConsumers().size() == 1);
     }
 }
