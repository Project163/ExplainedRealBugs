diff --git a/activemq-core/src/test/java/org/apache/activemq/AutoFailTestSupport.java b/activemq-core/src/test/java/org/apache/activemq/AutoFailTestSupport.java
index ce57c1963..df501a728 100644
--- a/activemq-core/src/test/java/org/apache/activemq/AutoFailTestSupport.java
+++ b/activemq-core/src/test/java/org/apache/activemq/AutoFailTestSupport.java
@@ -16,6 +16,8 @@
  */
 package org.apache.activemq;
 
+import java.util.Map;
+import java.util.Map.Entry;
 import java.util.concurrent.atomic.AtomicBoolean;
 
 import junit.framework.TestCase;
@@ -78,6 +80,7 @@ public abstract class AutoFailTestSupport extends TestCase {
                     if (!isTestSuccess.get()) {
                         LOG.error("Test case has exceeded the maximum allotted time to run of: " + getMaxTestTime() + " ms.");
                         LOG.fatal("Test case has exceeded the maximum allotted time to run of: " + getMaxTestTime() + " ms.");
+                        dumpAllThreads(getName());
                         System.exit(EXIT_ERROR);
                     }
                 }
@@ -138,4 +141,15 @@ public abstract class AutoFailTestSupport extends TestCase {
     public long getMaxTestTime() {
         return this.maxTestTime;
     }
+    
+    
+    public static void dumpAllThreads(String prefix) {
+        Map<Thread, StackTraceElement[]> stacks = Thread.getAllStackTraces();
+        for (Entry<Thread, StackTraceElement[]> stackEntry : stacks.entrySet()) {
+            System.err.println(prefix + " " + stackEntry.getKey());
+            for(StackTraceElement element : stackEntry.getValue()) {
+                System.err.println("     " + element);
+            }
+        }
+    }
 }
diff --git a/activemq-core/src/test/java/org/apache/activemq/bugs/AMQ1936Test.java b/activemq-core/src/test/java/org/apache/activemq/bugs/AMQ1936Test.java
index 8178623b7..0c02706f2 100644
--- a/activemq-core/src/test/java/org/apache/activemq/bugs/AMQ1936Test.java
+++ b/activemq-core/src/test/java/org/apache/activemq/bugs/AMQ1936Test.java
@@ -17,6 +17,7 @@
 package org.apache.activemq.bugs;
 
 import org.apache.activemq.ActiveMQConnectionFactory;
+import org.apache.activemq.AutoFailTestSupport;
 import org.apache.activemq.broker.BrokerService;
 import org.apache.activemq.util.Wait;
 import org.apache.log4j.Logger;
@@ -200,23 +201,14 @@ public class AMQ1936Test extends TestCase{
             }
         }, 1*60*1000);
         if (!ok) {
-            dumpAllThreads("--STUCK?--");
+            AutoFailTestSupport.dumpAllThreads("--STUCK?--");
         }
         assertEquals( "Number of messages received does not match the number sent", TEST_MESSAGE_COUNT, messages.size( ) );
         assertEquals( TEST_MESSAGE_COUNT,  messageCount.get() );
     }
     
     
-    private void dumpAllThreads(String prefix) {
-        Map<Thread, StackTraceElement[]> stacks = Thread.getAllStackTraces();
-        for (Entry<Thread, StackTraceElement[]> stackEntry : stacks.entrySet()) {
-            System.err.println(prefix + stackEntry.getKey());
-            for(StackTraceElement element : stackEntry.getValue()) {
-                System.err.println("     " + element);
-            }
-        }
-        
-    }
+    
     private final static class ThreadedMessageReceiver implements Runnable {
        
         private String queueName            = null;
diff --git a/activemq-core/src/test/java/org/apache/activemq/bugs/AMQ2183Test.java b/activemq-core/src/test/java/org/apache/activemq/bugs/AMQ2183Test.java
index 476affdc2..f84d9d157 100644
--- a/activemq-core/src/test/java/org/apache/activemq/bugs/AMQ2183Test.java
+++ b/activemq-core/src/test/java/org/apache/activemq/bugs/AMQ2183Test.java
@@ -32,6 +32,7 @@ import javax.jms.Session;
 import junit.framework.TestCase;
 
 import org.apache.activemq.ActiveMQConnectionFactory;
+import org.apache.activemq.AutoFailTestSupport;
 import org.apache.activemq.broker.BrokerService;
 import org.apache.activemq.command.ActiveMQQueue;
 import org.apache.activemq.command.ActiveMQTopic;
@@ -40,7 +41,7 @@ import org.apache.activemq.util.Wait.Condition;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 
-public class AMQ2183Test extends TestCase implements UncaughtExceptionHandler, MessageListener {
+public class AMQ2183Test extends AutoFailTestSupport implements UncaughtExceptionHandler, MessageListener {
        
     private static final Log LOG = LogFactory.getLog(AMQ2183Test.class);
     private static final int maxSent = 2000;    
@@ -55,7 +56,8 @@ public class AMQ2183Test extends TestCase implements UncaughtExceptionHandler, M
     }
     
     public void setUp() throws Exception {
-    
+        setAutoFail(true);
+        super.setUp();
         master = new BrokerService();
         slave = new BrokerService();
         
