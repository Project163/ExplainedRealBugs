diff --git a/activemq-core/src/main/java/org/apache/activemq/command/ActiveMQMessage.java b/activemq-core/src/main/java/org/apache/activemq/command/ActiveMQMessage.java
index 6529f7dab..ee5dddf57 100755
--- a/activemq-core/src/main/java/org/apache/activemq/command/ActiveMQMessage.java
+++ b/activemq-core/src/main/java/org/apache/activemq/command/ActiveMQMessage.java
@@ -593,11 +593,14 @@ public class ActiveMQMessage extends Message implements org.apache.activemq.Mess
     }
 
     public String getStringProperty(String name) throws JMSException {
-        Object value = getObjectProperty(name);
-        if (value == null) {
-            if (name.equals("JMSXUserID")) {
-                value = getUserID();
+        Object value = null;
+        if (name.equals("JMSXUserID")) {
+            value = getUserID();
+            if (value == null) {
+                value = getObjectProperty(name);
             }
+        } else {
+            value = getObjectProperty(name);
         }
         if (value == null) {
             return null;
diff --git a/activemq-core/src/test/java/org/apache/activemq/test/JmsTopicSendReceiveWithEmbeddedBrokerAndUserIDTest.java b/activemq-core/src/test/java/org/apache/activemq/test/JmsTopicSendReceiveWithEmbeddedBrokerAndUserIDTest.java
index 4a5b3186a..3a1e9bf9f 100644
--- a/activemq-core/src/test/java/org/apache/activemq/test/JmsTopicSendReceiveWithEmbeddedBrokerAndUserIDTest.java
+++ b/activemq-core/src/test/java/org/apache/activemq/test/JmsTopicSendReceiveWithEmbeddedBrokerAndUserIDTest.java
@@ -60,4 +60,21 @@ public class JmsTopicSendReceiveWithEmbeddedBrokerAndUserIDTest extends JmsTopic
             assertEquals("JMSXUserID header", userName, userID);
         }
     }
+
+    public void testSpoofedJMSXUserIdIsIgnored() throws Exception {
+        Thread.sleep(1000);
+        messages.clear();
+
+        for (int i = 0; i < data.length; i++) {
+            Message message = createMessage(i);
+            configureMessage(message);
+            message.setStringProperty("JMSXUserID", "spoofedId");
+            if (verbose) {
+                LOG.info("About to send a message: " + message + " with text: " + data[i]);
+            }
+            sendMessage(i, message);
+        }
+        assertMessagesAreReceived();
+        LOG.info("" + data.length + " messages(s) received, closing down connections");
+    }
 }
diff --git a/activemq-core/src/test/java/org/apache/activemq/test/message/NestedMapAndListPropertyTest.java b/activemq-core/src/test/java/org/apache/activemq/test/message/NestedMapAndListPropertyTest.java
index bdc8baa1d..aa1c8012c 100644
--- a/activemq-core/src/test/java/org/apache/activemq/test/message/NestedMapAndListPropertyTest.java
+++ b/activemq-core/src/test/java/org/apache/activemq/test/message/NestedMapAndListPropertyTest.java
@@ -66,6 +66,7 @@ public class NestedMapAndListPropertyTest extends JmsTopicSendReceiveWithTwoConn
         assertEquals("listField[0]", "a", list.get(0));
         assertEquals("listField[1]", "b", list.get(1));
         assertEquals("listField[2]", "c", list.get(2));
+        assertEquals("JohnDoe", message.getStringProperty("JMSXUserID"));
     }
 
     protected Message createMessage(int index) throws JMSException {
@@ -85,6 +86,7 @@ public class NestedMapAndListPropertyTest extends JmsTopicSendReceiveWithTwoConn
 
         answer.setObjectProperty("mapField", nestedMap);
         answer.setObjectProperty("listField", Arrays.asList(new Object[] {"a", "b", "c"}));
+        answer.setStringProperty("JMSXUserID", "JohnDoe");
 
         return answer;
     }
