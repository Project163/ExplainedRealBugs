diff --git a/activemq-core/src/main/java/org/apache/activemq/transport/vm/VMTransportFactory.java b/activemq-core/src/main/java/org/apache/activemq/transport/vm/VMTransportFactory.java
index 2f05b9818..ced1fcf82 100755
--- a/activemq-core/src/main/java/org/apache/activemq/transport/vm/VMTransportFactory.java
+++ b/activemq-core/src/main/java/org/apache/activemq/transport/vm/VMTransportFactory.java
@@ -104,6 +104,7 @@ public class VMTransportFactory extends TransportFactory{
             if(server==null){
                 server=(VMTransportServer) bind(location,true);
                 TransportConnector connector=new TransportConnector(broker.getBroker(),server);
+                connector.setTaskRunnerFactory( broker.getTaskRunnerFactory() );
                 connector.start();
                 connectors.put(host,connector);
             }
