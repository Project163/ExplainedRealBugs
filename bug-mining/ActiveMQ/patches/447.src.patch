diff --git a/activemq-core/src/main/java/org/apache/activemq/transport/peer/PeerTransportFactory.java b/activemq-core/src/main/java/org/apache/activemq/transport/peer/PeerTransportFactory.java
index 4bdcdb29a..c5f710667 100755
--- a/activemq-core/src/main/java/org/apache/activemq/transport/peer/PeerTransportFactory.java
+++ b/activemq-core/src/main/java/org/apache/activemq/transport/peer/PeerTransportFactory.java
@@ -92,8 +92,8 @@ public class PeerTransportFactory extends TransportFactory {
                     IntrospectionSupport.setProperties(service, brokerOptions);
                     service.setBrokerName(finalBroker);
                     TransportConnector c = service.addConnector("tcp://localhost:0");
-                    c.setDiscoveryUri(new URI("multicast://" + finalGroup));
-                    service.addNetworkConnector("multicast://" + finalGroup);
+                    c.setDiscoveryUri(new URI("multicast://default?group=" + finalGroup));
+                    service.addNetworkConnector("multicast://default?group=" + finalGroup);
                     return service;
                 }
             });
diff --git a/activemq-core/src/test/java/org/apache/activemq/JmsMultipleBrokersTestSupport.java b/activemq-core/src/test/java/org/apache/activemq/JmsMultipleBrokersTestSupport.java
index bd6478a96..915f0d73c 100644
--- a/activemq-core/src/test/java/org/apache/activemq/JmsMultipleBrokersTestSupport.java
+++ b/activemq-core/src/test/java/org/apache/activemq/JmsMultipleBrokersTestSupport.java
@@ -129,8 +129,8 @@ public class JmsMultipleBrokersTestSupport extends CombinationTestSupport {
             }
 
             TransportConnector transport = (TransportConnector)transportConnectors.get(0);
-            transport.setDiscoveryUri(new URI("multicast://" + groupName));
-            broker.addNetworkConnector("multicast://" + groupName);
+            transport.setDiscoveryUri(new URI("multicast://default?group=" + groupName));
+            broker.addNetworkConnector("multicast://default?group=" + groupName);
         }
 
         // Multicasting may take longer to setup
diff --git a/activemq-core/src/test/java/org/apache/activemq/broker/BrokerServiceTest.java b/activemq-core/src/test/java/org/apache/activemq/broker/BrokerServiceTest.java
index 5625017a7..5da180e86 100644
--- a/activemq-core/src/test/java/org/apache/activemq/broker/BrokerServiceTest.java
+++ b/activemq-core/src/test/java/org/apache/activemq/broker/BrokerServiceTest.java
@@ -54,7 +54,7 @@ public class BrokerServiceTest extends TestCase {
         BrokerService service = new BrokerService();
         service.setPersistent(false);
         service.setUseJmx(true);
-        NetworkConnector connector = service.addNetworkConnector("multicast://group-"+System.currentTimeMillis());
+        NetworkConnector connector = service.addNetworkConnector("multicast://default?group=group-"+System.currentTimeMillis());
         service.start();
 
         service.removeNetworkConnector(connector);
@@ -66,7 +66,7 @@ public class BrokerServiceTest extends TestCase {
         BrokerService service = new BrokerService();
         service.setPersistent(false);
         service.setUseJmx(false);
-        NetworkConnector connector = service.addNetworkConnector("multicast://group-"+System.currentTimeMillis());
+        NetworkConnector connector = service.addNetworkConnector("multicast://default?group=group-"+System.currentTimeMillis());
         service.start();
 
         service.removeNetworkConnector(connector);
diff --git a/activemq-core/src/test/java/org/apache/activemq/network/NetworkLoadTest.java b/activemq-core/src/test/java/org/apache/activemq/network/NetworkLoadTest.java
index 3cbfbb2f7..52414245f 100644
--- a/activemq-core/src/test/java/org/apache/activemq/network/NetworkLoadTest.java
+++ b/activemq-core/src/test/java/org/apache/activemq/network/NetworkLoadTest.java
@@ -203,11 +203,11 @@ public class NetworkLoadTest extends TestCase {
         TransportConnector transportConnector = new TransportConnector();
         transportConnector.setUri(new URI("tcp://localhost:"+(60000+brokerId)));
         
-        transportConnector.setDiscoveryUri(new URI("multicast://"+groupId));        
+        transportConnector.setDiscoveryUri(new URI("multicast://default?group="+groupId));        
         broker.addConnector(transportConnector);
                         
         DiscoveryNetworkConnector networkConnector = new DiscoveryNetworkConnector();
-        networkConnector.setUri(new URI("multicast://"+groupId));
+        networkConnector.setUri(new URI("multicast://default?group="+groupId));
 	    networkConnector.setBridgeTempDestinations(true);
 	    networkConnector.setPrefetchSize(1);
 	    broker.addNetworkConnector(networkConnector);
diff --git a/activemq-core/src/test/java/org/apache/activemq/transport/TopicClusterTest.java b/activemq-core/src/test/java/org/apache/activemq/transport/TopicClusterTest.java
index a939bcc7f..8badf1623 100755
--- a/activemq-core/src/test/java/org/apache/activemq/transport/TopicClusterTest.java
+++ b/activemq-core/src/test/java/org/apache/activemq/transport/TopicClusterTest.java
@@ -112,8 +112,8 @@ public class TopicClusterTest extends TestCase implements MessageListener {
 
         String url = "tcp://localhost:0";
         TransportConnector connector = container.addConnector(url);
-        connector.setDiscoveryUri(new URI("multicast://"+groupId));
-        container.addNetworkConnector("multicast://"+groupId);
+        connector.setDiscoveryUri(new URI("multicast://default?group="+groupId));
+        container.addNetworkConnector("multicast://default?group="+groupId);
         container.start();
 
         services.add(container);
diff --git a/activemq-core/src/test/java/org/apache/activemq/transport/discovery/DiscoveryTransportBrokerTest.java b/activemq-core/src/test/java/org/apache/activemq/transport/discovery/DiscoveryTransportBrokerTest.java
index 611a3e22d..667b4dcc0 100755
--- a/activemq-core/src/test/java/org/apache/activemq/transport/discovery/DiscoveryTransportBrokerTest.java
+++ b/activemq-core/src/test/java/org/apache/activemq/transport/discovery/DiscoveryTransportBrokerTest.java
@@ -134,7 +134,7 @@ public class DiscoveryTransportBrokerTest extends NetworkTestSupport {
     	if ( groupName == null ) {
     		groupName = "group-"+System.currentTimeMillis();
     	}
-        return "multicast://"+groupName;
+        return "multicast://default?group="+groupName;
     }
 
     protected TransportConnector createRemoteConnector() throws Exception, IOException, URISyntaxException {
diff --git a/activemq-core/src/test/java/org/apache/activemq/usecases/TwoBrokerMulticastQueueTest.java b/activemq-core/src/test/java/org/apache/activemq/usecases/TwoBrokerMulticastQueueTest.java
index 158077326..4f196fb7e 100644
--- a/activemq-core/src/test/java/org/apache/activemq/usecases/TwoBrokerMulticastQueueTest.java
+++ b/activemq-core/src/test/java/org/apache/activemq/usecases/TwoBrokerMulticastQueueTest.java
@@ -140,43 +140,43 @@ public class TwoBrokerMulticastQueueTest extends CombinationTestSupport {
     }
 
     public void testSendReceiveUsingDiscovery() throws Exception {
-        sendUri = "discovery:multicast://"+groupId;
-        recvUri = "discovery:multicast://"+groupId;
+        sendUri = "discovery:multicast://default?group="+groupId;
+        recvUri = "discovery:multicast://default?group="+groupId;
         createMulticastBrokerNetwork();
         doSendReceiveTest();
     }
 
     public void testMultipleConsumersConnectUsingDiscovery() throws Exception {
-        sendUri = "discovery:multicast://"+groupId;
-        recvUri = "discovery:multicast://"+groupId;
+        sendUri = "discovery:multicast://default?group="+groupId;
+        recvUri = "discovery:multicast://default?group="+groupId;
         createMulticastBrokerNetwork();
         doMultipleConsumersConnectTest();
     }
 
     public void testSendReceiveUsingAutoAssignFailover() throws Exception {
-        sendUri = "failover:(discovery:multicast://"+groupId+")";
-        recvUri = "failover:(discovery:multicast://"+groupId+")";
+        sendUri = "failover:(discovery:multicast:default?group=//"+groupId+")";
+        recvUri = "failover:(discovery:multicast:default?group=//"+groupId+")";
         createAutoAssignMulticastBrokerNetwork();
         doSendReceiveTest();
     }
 
     public void testMultipleConsumersConnectUsingAutoAssignFailover() throws Exception {
-        sendUri = "failover:(discovery:multicast://"+groupId+")";
-        recvUri = "failover:(discovery:multicast://"+groupId+")";
+        sendUri = "failover:(discovery:multicast:default?group=//"+groupId+")";
+        recvUri = "failover:(discovery:multicast:default?group=//"+groupId+")";
         createAutoAssignMulticastBrokerNetwork();
         doMultipleConsumersConnectTest();
     }
 
     public void testSendReceiveUsingAutoAssignDiscovery() throws Exception {
-        sendUri = "discovery:multicast://"+groupId;
-        recvUri = "discovery:multicast://"+groupId;
+        sendUri = "discovery:multicast://default?group="+groupId;
+        recvUri = "discovery:multicast://default?group="+groupId;
         createAutoAssignMulticastBrokerNetwork();
         doSendReceiveTest();
     }
 
     public void testMultipleConsumersConnectUsingAutoAssignDiscovery() throws Exception {
-        sendUri = "discovery:multicast://"+groupId;
-        recvUri = "discovery:multicast://"+groupId;
+        sendUri = "discovery:multicast://default?group="+groupId;
+        recvUri = "discovery:multicast://default?group="+groupId;
         createAutoAssignMulticastBrokerNetwork();
         doMultipleConsumersConnectTest();
     }
diff --git a/activemq-core/src/test/resources/org/apache/activemq/transport/stomp/stomp-auth-broker.xml b/activemq-core/src/test/resources/org/apache/activemq/transport/stomp/stomp-auth-broker.xml
index 0d9eb26ad..be94eadad 100644
--- a/activemq-core/src/test/resources/org/apache/activemq/transport/stomp/stomp-auth-broker.xml
+++ b/activemq-core/src/test/resources/org/apache/activemq/transport/stomp/stomp-auth-broker.xml
@@ -25,7 +25,7 @@
   		<property name="annotatedClass"><value>org.apache.activemq.transport.stomp.SamplePojo</value></property>
   </bean>
 
-  <broker useJmx="false" persistent="false" xmlns="http://activemq.apache.org/schema/core" populateJMSXUserID="true">
+  <broker useJmx="true" persistent="false" xmlns="http://activemq.apache.org/schema/core" populateJMSXUserID="true">
 
 	<transportConnectors>
 		<transportConnector name="stomp"   uri="stomp://localhost:61613"/>
diff --git a/activemq-core/src/test/resources/org/apache/activemq/usecases/multicast-broker-1.xml b/activemq-core/src/test/resources/org/apache/activemq/usecases/multicast-broker-1.xml
index cc20eb531..ee6a6b74c 100644
--- a/activemq-core/src/test/resources/org/apache/activemq/usecases/multicast-broker-1.xml
+++ b/activemq-core/src/test/resources/org/apache/activemq/usecases/multicast-broker-1.xml
@@ -21,11 +21,11 @@
 
   <broker brokerName="BrokerA" persistent="false" useJmx="false" xmlns="http://activemq.apache.org/schema/core">
     <transportConnectors>
-      <transportConnector uri="tcp://localhost:61616" discoveryUri="multicast://${groupId}"/>
+      <transportConnector uri="tcp://localhost:61616" discoveryUri="multicast://default?group=${groupId}"/>
     </transportConnectors>
 
     <networkConnectors>
-      <networkConnector uri="multicast://${groupId}"/>
+      <networkConnector uri="multicast://default?group=${groupId}"/>
     </networkConnectors>
 
     <persistenceAdapter>
diff --git a/activemq-core/src/test/resources/org/apache/activemq/usecases/multicast-broker-2.xml b/activemq-core/src/test/resources/org/apache/activemq/usecases/multicast-broker-2.xml
index 72c6c80f3..b97ddb02b 100644
--- a/activemq-core/src/test/resources/org/apache/activemq/usecases/multicast-broker-2.xml
+++ b/activemq-core/src/test/resources/org/apache/activemq/usecases/multicast-broker-2.xml
@@ -21,11 +21,11 @@
 
   <broker brokerName="BrokerB" persistent="false" useJmx="false" xmlns="http://activemq.apache.org/schema/core">
     <transportConnectors>
-      <transportConnector uri="tcp://localhost:61617" discoveryUri="multicast://${groupId}"/>
+      <transportConnector uri="tcp://localhost:61617" discoveryUri="multicast://default?group=${groupId}"/>
     </transportConnectors>
 
     <networkConnectors>
-      <networkConnector uri="multicast://${groupId}"/>
+      <networkConnector uri="multicast://default?group=${groupId}"/>
     </networkConnectors>
 
     <persistenceAdapter>
diff --git a/activemq-core/src/test/resources/org/apache/activemq/usecases/multicast-broker-auto.xml b/activemq-core/src/test/resources/org/apache/activemq/usecases/multicast-broker-auto.xml
index 8c15683d9..078e10ed4 100644
--- a/activemq-core/src/test/resources/org/apache/activemq/usecases/multicast-broker-auto.xml
+++ b/activemq-core/src/test/resources/org/apache/activemq/usecases/multicast-broker-auto.xml
@@ -21,11 +21,11 @@
 
   <broker brokerName="BrokerB" persistent="false" useJmx="false" xmlns="http://activemq.apache.org/schema/core">
     <transportConnectors>
-      <transportConnector uri="tcp://localhost:0" discoveryUri="multicast://${groupId}"/>
+      <transportConnector uri="tcp://localhost:0" discoveryUri="multicast://default?group=${groupId}"/>
     </transportConnectors>
 
     <networkConnectors>
-      <networkConnector uri="multicast://${groupId}"/>
+      <networkConnector uri="multicast://default?group=${groupId}"/>
     </networkConnectors>
 
     <persistenceAdapter>
diff --git a/activemq-core/src/test/resources/org/apache/activemq/usecases/receiver-discovery.xml b/activemq-core/src/test/resources/org/apache/activemq/usecases/receiver-discovery.xml
index c8a80824e..48ba24789 100644
--- a/activemq-core/src/test/resources/org/apache/activemq/usecases/receiver-discovery.xml
+++ b/activemq-core/src/test/resources/org/apache/activemq/usecases/receiver-discovery.xml
@@ -21,11 +21,11 @@
 
   <broker brokerName="receiver" persistent="false" useJmx="false" xmlns="http://activemq.apache.org/schema/core">
     <transportConnectors>
-      <transportConnector uri="tcp://localhost:0" discoveryUri="multicast://${groupId}"/>
+      <transportConnector uri="tcp://localhost:0" discoveryUri="multicast://default?group=${groupId}"/>
     </transportConnectors>
 
     <networkConnectors>
-      <networkConnector uri="multicast://${groupId}"/>
+      <networkConnector uri="multicast://default?group=${groupId}"/>
     </networkConnectors>
 
     <persistenceAdapter>
diff --git a/activemq-core/src/test/resources/org/apache/activemq/usecases/sender-discovery.xml b/activemq-core/src/test/resources/org/apache/activemq/usecases/sender-discovery.xml
index 4757a7d61..2b2d7c52b 100644
--- a/activemq-core/src/test/resources/org/apache/activemq/usecases/sender-discovery.xml
+++ b/activemq-core/src/test/resources/org/apache/activemq/usecases/sender-discovery.xml
@@ -21,11 +21,11 @@
 
   <broker brokerName="sender" persistent="false" useJmx="false" xmlns="http://activemq.apache.org/schema/core">
     <transportConnectors>
-      <transportConnector uri="tcp://localhost:0" discoveryUri="multicast://${groupId}"/>
+      <transportConnector uri="tcp://localhost:0" discoveryUri="multicast://default?group=${groupId}"/>
     </transportConnectors>
 
     <networkConnectors>
-      <networkConnector uri="multicast://${groupId}"/>
+      <networkConnector uri="multicast://default?group=${groupId}"/>
     </networkConnectors>
 
     <persistenceAdapter>
