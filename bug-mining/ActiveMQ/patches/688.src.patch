diff --git a/kahadb/src/main/java/org/apache/kahadb/util/LockFile.java b/kahadb/src/main/java/org/apache/kahadb/util/LockFile.java
index d26b394fa..36848325d 100644
--- a/kahadb/src/main/java/org/apache/kahadb/util/LockFile.java
+++ b/kahadb/src/main/java/org/apache/kahadb/util/LockFile.java
@@ -55,18 +55,23 @@ public class LockFile {
         }
         
         IOHelper.mkdirs(file.getParentFile());
-        if (readFile == null) {
-            readFile = new RandomAccessFile(file, "rw");
-        }
+        
         if (lock == null) {
+            readFile = new RandomAccessFile(file, "rw");
+            IOException reason = null;
             try {
                 lock = readFile.getChannel().tryLock();
             } catch (OverlappingFileLockException e) {
-                throw IOExceptionSupport.create("File '" + file + "' could not be locked.",e);
+                reason = IOExceptionSupport.create("File '" + file + "' could not be locked.",e);
             }
             if (lock != null) {
                 lockCounter++;
             } else {
+                // new read file for next attempt
+                closeReadFile();
+                if (reason != null) {
+                    throw reason;
+                }
                 throw new IOException("File '" + file + "' could not be locked.");
             }
               
@@ -93,6 +98,14 @@ public class LockFile {
             }
             lock = null;
         }
+        closeReadFile();
+        
+        if( deleteOnUnlock ) {
+            file.delete();
+        }
+    }
+
+    private void closeReadFile() {
         // close the file.
         if (readFile != null) {
             try {
@@ -102,9 +115,6 @@ public class LockFile {
             readFile = null;
         }
         
-        if( deleteOnUnlock ) {
-            file.delete();
-        }
     }
 
 }
