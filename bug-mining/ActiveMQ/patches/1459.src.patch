diff --git a/activemq-core/src/main/java/org/apache/activemq/store/kahadb/KahaDBStore.java b/activemq-core/src/main/java/org/apache/activemq/store/kahadb/KahaDBStore.java
index 1fe00acf6..192814041 100644
--- a/activemq-core/src/main/java/org/apache/activemq/store/kahadb/KahaDBStore.java
+++ b/activemq-core/src/main/java/org/apache/activemq/store/kahadb/KahaDBStore.java
@@ -287,11 +287,15 @@ public class KahaDBStore extends MessageDatabase implements PersistenceAdapter {
 
     @Override
     void rollbackStatsOnDuplicate(KahaDestination commandDestination) {
-        RegionBroker regionBroker = (RegionBroker) brokerService.getRegionBroker();
-        Set<Destination> destinationSet = regionBroker.getDestinations(convert(commandDestination));
-        for (Destination destination : destinationSet) {
-            destination.getDestinationStatistics().getMessages().decrement();
-            destination.getDestinationStatistics().getEnqueues().decrement();
+        if (brokerService != null) {
+            RegionBroker regionBroker = (RegionBroker) brokerService.getRegionBroker();
+            if (regionBroker != null) {
+                Set<Destination> destinationSet = regionBroker.getDestinations(convert(commandDestination));
+                for (Destination destination : destinationSet) {
+                    destination.getDestinationStatistics().getMessages().decrement();
+                    destination.getDestinationStatistics().getEnqueues().decrement();
+                }
+            }
         }
     }
 
