<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:01:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-4277] activemq-web - REST GET 204</title>
                <link>https://issues.apache.org/jira/browse/AMQ-4277</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Using 5.7 REST API I can GET a message from a topic but if a new message is POSTed to that same topic before the GET has been reissued (less than 20ms behind the POST and using the same session as the previous GET) the GET will timeout with a 204 and does not retrieve the message. This may be as designed for topics (queues are not an option) but I am just looking for confirmation. I assumed the first GET would have provided a topic subscription and the broker would hold a topic message for which there is a subscriber for longer than 20ms? This is not a stress test and is recreated with a simple producer and a separate consumer usually within the first couple of message exchanges. It has been noticed that when the topic message is POSTed without an outstanding GET to receive it, the following exception is logged: &lt;/p&gt;

&lt;p&gt;2013-01-22 01:09:37,484 | DEBUG | Async client internal exception occurred with no exception listener registered: java.lang.IllegalStateException: DISPATCHED,initial | org.apache.activemq.ActiveMQConnection | ActiveMQ Session Task-1 &lt;br/&gt;
java.lang.IllegalStateException: DISPATCHED,initial &lt;br/&gt;
        at org.eclipse.jetty.server.AsyncContinuation.dispatch(AsyncContinuation.java:408) &lt;br/&gt;
        at org.eclipse.jetty.server.AsyncContinuation.resume(AsyncContinuation.java:815) &lt;br/&gt;
        at org.apache.activemq.web.MessageServlet$Listener.onMessageAvailable(MessageServlet.java:409) &lt;br/&gt;
        at org.apache.activemq.ActiveMQMessageConsumer.dispatch(ActiveMQMessageConsumer.java:1343) &lt;br/&gt;
        at org.apache.activemq.ActiveMQSessionExecutor.dispatch(ActiveMQSessionExecutor.java:131) &lt;br/&gt;
        at org.apache.activemq.ActiveMQSessionExecutor.iterate(ActiveMQSessionExecutor.java:202) &lt;br/&gt;
        at org.apache.activemq.thread.PooledTaskRunner.runTask(PooledTaskRunner.java:129) &lt;br/&gt;
        at org.apache.activemq.thread.PooledTaskRunner$1.run(PooledTaskRunner.java:47) &lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110) &lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) &lt;br/&gt;
        at java.lang.Thread.run(Thread.java:722) &lt;/p&gt;

&lt;p&gt;Are there any configuration modifications available to have the topic messages retained for at least 1 second?&lt;/p&gt;</description>
                <environment>&lt;p&gt;windows 7 and windows xp&lt;/p&gt;</environment>
        <key id="12629323">AMQ-4277</key>
            <summary>activemq-web - REST GET 204</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10101">Abandoned</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="hhuang">Huang Hua</reporter>
                        <labels>
                    </labels>
                <created>Fri, 25 Jan 2013 21:30:33 +0000</created>
                <updated>Sun, 13 Mar 2022 14:16:05 +0000</updated>
                            <resolved>Sun, 13 Mar 2022 14:16:05 +0000</resolved>
                                    <version>5.7.0</version>
                                    <fixVersion>NEEDS_REVIEW</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="13563064" author="hhuang" created="Fri, 25 Jan 2013 21:34:20 +0000"  >&lt;p&gt;We posted this problem on activemq user forum. Dejan suggested us to open a jira for it. &lt;a href=&quot;http://activemq.2283324.n4.nabble.com/REST-GET-204-td4662037.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.2283324.n4.nabble.com/REST-GET-204-td4662037.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13563067" author="hhuang" created="Fri, 25 Jan 2013 21:39:05 +0000"  >&lt;p&gt;We have created a test case to reproduce the problem. Please find it in the attached file RestTest.java. The test case is testPostAndGetWithTopic()&lt;/p&gt;</comment>
                            <comment id="13564395" author="tabish121" created="Mon, 28 Jan 2013 16:39:51 +0000"  >&lt;p&gt;Have you tried this against a v5.8.0 SNAPSHOT ?  I just rand you tests against the latest and they pass. &lt;/p&gt;</comment>
                            <comment id="13564430" author="hhuang" created="Mon, 28 Jan 2013 17:39:35 +0000"  >&lt;p&gt;Thanks for checking it with v5.8.0. Could you please let us know where to find a snapshot of it?&lt;/p&gt;</comment>
                            <comment id="13564443" author="tabish121" created="Mon, 28 Jan 2013 17:52:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://repository.apache.org/content/repositories/snapshots/org/apache/activemq/apache-activemq/5.8-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/repositories/snapshots/org/apache/activemq/apache-activemq/5.8-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13564452" author="hhuang" created="Mon, 28 Jan 2013 18:02:10 +0000"  >&lt;p&gt;Could you please point me to the source files for that snapshot also? That way I will be able to build and run my junit test. Thanks!&lt;/p&gt;</comment>
                            <comment id="13564470" author="hhuang" created="Mon, 28 Jan 2013 18:14:26 +0000"  >&lt;p&gt;Never mind, I have found a copy of the source for web-demo. I will run the test and let you know. Thanks!&lt;/p&gt;</comment>
                            <comment id="13566841" author="sw124773" created="Wed, 30 Jan 2013 19:50:30 +0000"  >&lt;p&gt;Issue still exists using 5.8 1/30 snapshot.&lt;/p&gt;

&lt;p&gt;2013-01-30 14:40:04,884 | DEBUG | Enabled read interest SCEP@c1568f&lt;/p&gt;
{l(/192.168.213.128:2735)&amp;lt;-&amp;gt;r(/192.168.213.1:8161),d=true,open=true,ishut=false,oshut=false,rb=false,wb=false,w=true,i=1r}
&lt;p&gt;-{AsyncHttpConnection@119d715,g=HttpGenerator&lt;/p&gt;
{s=4,h=0,b=0,c=-1}
&lt;p&gt;,p=HttpParser&lt;/p&gt;
{s=0,l=36,c=88}
&lt;p&gt;,r=9} | org.eclipse.jetty.server.AsyncHttpConnection | qtp23063580-28&lt;br/&gt;
2013-01-30 14:40:04,884 | DEBUG | Async client internal exception occurred with no exception listener registered: java.lang.IllegalStateException: DISPATCHED,initial | org.apache.activemq.ActiveMQConnection | ActiveMQ Session Task-1&lt;br/&gt;
java.lang.IllegalStateException: DISPATCHED,initial&lt;br/&gt;
	at org.eclipse.jetty.server.AsyncContinuation.dispatch(AsyncContinuation.java:408)&lt;br/&gt;
	at org.eclipse.jetty.server.AsyncContinuation.resume(AsyncContinuation.java:815)&lt;br/&gt;
	at org.apache.activemq.web.MessageServlet$Listener.onMessageAvailable(MessageServlet.java:409)&lt;br/&gt;
	at org.apache.activemq.ActiveMQMessageConsumer.dispatch(ActiveMQMessageConsumer.java:1343)&lt;br/&gt;
	at org.apache.activemq.ActiveMQSessionExecutor.dispatch(ActiveMQSessionExecutor.java:131)&lt;br/&gt;
	at org.apache.activemq.ActiveMQSessionExecutor.iterate(ActiveMQSessionExecutor.java:202)&lt;br/&gt;
	at org.apache.activemq.thread.PooledTaskRunner.runTask(PooledTaskRunner.java:129)&lt;br/&gt;
	at org.apache.activemq.thread.PooledTaskRunner$1.run(PooledTaskRunner.java:47)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)&lt;br/&gt;
	at java.lang.Thread.run(Unknown Source)&lt;/p&gt;</comment>
                            <comment id="13571719" author="hhuang" created="Tue, 5 Feb 2013 20:57:55 +0000"  >&lt;p&gt;Hi Tomothy,&lt;/p&gt;

&lt;p&gt;I modified RestTest.java to add one more assertion to check the received messages. After that change, the test &quot;testPostAndGetWithTopic()&quot; fails with the latest activemq-web and activemq-web-demo code (trunk revision 1442742). Could you please re-run the test when you get a chance?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;

&lt;p&gt;Helen&lt;/p&gt;</comment>
                            <comment id="13571725" author="hhuang" created="Tue, 5 Feb 2013 21:03:21 +0000"  >&lt;p&gt;I have updated RestTest.java in the attachment.&lt;/p&gt;</comment>
                            <comment id="13571839" author="tabish121" created="Tue, 5 Feb 2013 22:54:30 +0000"  >&lt;p&gt;Created a patch from the modified test to make things simpler.&lt;/p&gt;</comment>
                            <comment id="13571842" author="tabish121" created="Tue, 5 Feb 2013 22:55:11 +0000"  >&lt;p&gt;Now there&apos;s a failing test.  Hopefully after 5.8 is done someone will have time to investigate this further. &lt;/p&gt;</comment>
                            <comment id="13784105" author="davsclaus" created="Wed, 2 Oct 2013 15:56:46 +0000"  >&lt;p&gt;Let me take a look tomorrow.&lt;/p&gt;</comment>
                            <comment id="13784931" author="davsclaus" created="Thu, 3 Oct 2013 08:57:39 +0000"  >&lt;p&gt;Added the unit test and disabled parts of it which fails. &lt;br/&gt;
Moving to 5.10.&lt;/p&gt;</comment>
                            <comment id="14026324" author="dejanb" created="Tue, 10 Jun 2014 11:02:57 +0000"  >&lt;p&gt;Let&apos;s examine this issue again&lt;/p&gt;</comment>
                            <comment id="17505732" author="christopher.l.shannon" created="Sun, 13 Mar 2022 14:16:05 +0000"  >&lt;p&gt;closing issues not updated in more than 5 years as abandoned&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12568113" name="AMQ4277TestPatch.txt" size="3402" author="tabish" created="Tue, 5 Feb 2013 22:54:30 +0000"/>
                            <attachment id="12566562" name="RestTest.java" size="11550" author="hhuang" created="Fri, 25 Jan 2013 21:39:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>309471</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 35 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1fawv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>297529</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>