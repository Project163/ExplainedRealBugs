<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:59:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-7517] bin/activemq sets ACTIVEMQ_CLASSPATH to likely non-existing directory $ACTIVEMQ_BASE/../lib</title>
                <link>https://issues.apache.org/jira/browse/AMQ-7517</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;the bin/activemq script executes these lines by default (i.e. when none of the relevant environment variables are set):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-bash&quot;&gt;
  ACTIVEMQ_HOME=&lt;span class=&quot;code-quote-red&quot;&gt;&quot;`getActiveMQHome`&quot;&lt;/span&gt;
  ACTIVEMQ_BASE=&lt;span class=&quot;code-quote-red&quot;&gt;&quot;$ACTIVEMQ_HOME&quot;&lt;/span&gt;
ACTIVEMQ_CLASSPATH=&lt;span class=&quot;code-quote-red&quot;&gt;&quot;$ACTIVEMQ_BASE/../lib/:$ACTIVEMQ_USER_CLASSPATH&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;getActiveMQHome returns (effectively) the parent directory of the &lt;em&gt;bin&lt;/em&gt; subdirectory, i.e., the root of the distribution tar file, so ACTIVEMQ_CLASSPATH ends up set to the a &lt;em&gt;lib&lt;/em&gt; subdirectory which may or may not exist in the path where &lt;em&gt;the user decided&lt;/em&gt; to extract the distribution tar file.&lt;/p&gt;

&lt;p&gt;Meanwhile the &lt;em&gt;lib&lt;/em&gt; subdirectory of the distribution ($ACTIVEMQ_BASE/lib) does not seem to be referenced anywhere in the script.&lt;/p&gt;

&lt;p&gt;ActiveMQ does not seem to have any problem with that, though, so maybe this setting is not so important.&lt;br/&gt;
 &#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13317159">AMQ-7517</key>
            <summary>bin/activemq sets ACTIVEMQ_CLASSPATH to likely non-existing directory $ACTIVEMQ_BASE/../lib</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbonofre">Jean-Baptiste Onofr&#233;</assignee>
                                    <reporter username="flado">Vladimir Andreev</reporter>
                        <labels>
                    </labels>
                <created>Thu, 16 Jul 2020 12:33:55 +0000</created>
                <updated>Sat, 31 May 2025 05:57:53 +0000</updated>
                            <resolved>Sat, 31 May 2025 05:57:53 +0000</resolved>
                                    <version>5.16.0</version>
                    <version>5.15.12</version>
                                    <fixVersion>6.2.0</fixVersion>
                    <fixVersion>5.19.1</fixVersion>
                    <fixVersion>6.1.7</fixVersion>
                                    <component>Command Line Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="17242241" author="jbonofre" created="Wed, 2 Dec 2020 10:43:18 +0000"  >&lt;p&gt;What&apos;s your point here ? If you extract ActiveMQ in different location (not ActiveMQ &quot;standard&quot;), you have to update &lt;tt&gt;bin/activemq&lt;/tt&gt;. Thoughts ?&lt;/p&gt;</comment>
                            <comment id="17242353" author="flado" created="Wed, 2 Dec 2020 12:58:27 +0000"  >&lt;p&gt;My point is, the intention appears to be to add&#160;$ACTIVEMQ_BASE/lib to the class path, and not&#160;$ACTIVEMQ_BASE/&lt;font color=&quot;#FF0000&quot;&gt;&lt;b&gt;../&lt;/b&gt;&lt;font color=&quot;#172b4d&quot;&gt;&lt;/font&gt;l&lt;/font&gt;&lt;font color=&quot;&quot;&gt;&lt;/font&gt;ib which in all likelihood does not exist.&lt;/p&gt;

&lt;p&gt;As far as I can tell, there is no &quot;ActiveMQ standard&quot;, at least not according to the &quot;Getting Started&quot; guide, which states &quot;Extract the files from the zipped tarball into a directory of your choice&quot;. So I&apos;m free to extract the tarball into an empty directory, say &quot;/apps&quot;. Thus I&apos;d get &lt;b&gt;/apps/apache-activemq-5.16.0&lt;/b&gt; with subdirectories &lt;b&gt;bin&lt;/b&gt;, &lt;b&gt;lib&lt;/b&gt;, and so on. Then running&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/apps/apache-activemq-5.16.0/bin/activemq
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;would result in the directory&lt;/p&gt;

&lt;p&gt;/apps/lib&lt;/p&gt;

&lt;p&gt;being added to&#160;ACTIVEMQ_CLASSPATH. Since my /apps was initially empty, the directory &lt;b&gt;/apps/lib&lt;/b&gt; would not exist. At the same time, the directory&#160;/apps/apache-activemq-5.16.0/lib would&#160;&lt;b&gt;not&lt;/b&gt; get added to&#160;ACTIVEMQ_CLASSPATH (I don&apos;t know it it should, though, even though it contains quite a lot of JARs).&lt;/p&gt;</comment>
                            <comment id="17242431" author="jbonofre" created="Wed, 2 Dec 2020 15:18:24 +0000"  >&lt;p&gt;By standard, I mean relative to the current exec folder. But I get your point, you want something more &quot;flexible&quot;. I will do some improvements here. Thanks.&lt;/p&gt;</comment>
                            <comment id="17242477" author="flado" created="Wed, 2 Dec 2020 16:16:11 +0000"  >&lt;p&gt;Sorry, but no! That is exactly the problem - it&apos;s fine to be relative to the current exec folder and I don&apos;t need any more flexibility (in fact I think it inadvertently provides too much flexibility, see below), but &lt;b&gt;relative to the current exec folder&lt;/b&gt; the script climbs the directory tree one level too many. It is, in my uninformed opinion, a typo or something: the &lt;b&gt;../&lt;/b&gt;&#160;is just too much and should be removed and the line was intended to read like this:&lt;br/&gt;
ACTIVEMQ_CLASSPATH=&quot;$ACTIVEMQ_BASE/lib/:$ACTIVEMQ_USER_CLASSPATH&quot;&lt;br/&gt;
I&apos;m sorry I can&apos;t express it any clearer than that.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Below:&lt;/p&gt;

&lt;p&gt;I could argue it is a security risk to leave it with the extra&#160; ../ like that. The admin might have installed ActiveMQ in a folder and then given only read and execute permissions to the users, but if ActiveMQ&apos;s parent folder ($ACTIVEMQ_BASE/&lt;b&gt;..&lt;/b&gt;&#160;&#160;or, equivalently, &lt;span class=&quot;error&quot;&gt;&amp;#91;current exec folder&amp;#93;&lt;/span&gt;/../..) is writable to the users, an attacker might create a lib subfolder there and put their own malicious code in it which would then be automatically added to ActiveMQ&apos;s CLASSPATH.&lt;/p&gt;</comment>
                            <comment id="17242479" author="jbonofre" created="Wed, 2 Dec 2020 16:18:26 +0000"  >&lt;p&gt;Sorry, we mean the same thing (I wasn&apos;t clear in my previous message) &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;So fully agree, I will improve (similar to the karaf script I did).&lt;/p&gt;</comment>
                            <comment id="17955361" author="jira-bot" created="Sat, 31 May 2025 05:56:06 +0000"  >&lt;p&gt;Commit caeb4cad03d197e432213221d4a52ec5e6010ae1 in activemq&apos;s branch refs/heads/main from JB Onofr&#233;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=caeb4cad03&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=caeb4cad03&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-7517&quot; title=&quot;bin/activemq sets ACTIVEMQ_CLASSPATH to likely non-existing directory $ACTIVEMQ_BASE/../lib&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-7517&quot;&gt;&lt;del&gt;AMQ-7517&lt;/del&gt;&lt;/a&gt;: Remove lib in the default classpath (#1442)&lt;/p&gt;
</comment>
                            <comment id="17955362" author="jira-bot" created="Sat, 31 May 2025 05:56:55 +0000"  >&lt;p&gt;Commit 048651b97ca1789444c22e45dd193bacb6f801b6 in activemq&apos;s branch refs/heads/activemq-6.1.x from JB Onofr&#233;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=048651b97c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=048651b97c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-7517&quot; title=&quot;bin/activemq sets ACTIVEMQ_CLASSPATH to likely non-existing directory $ACTIVEMQ_BASE/../lib&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-7517&quot;&gt;&lt;del&gt;AMQ-7517&lt;/del&gt;&lt;/a&gt;: Remove lib in the default classpath (#1442)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit caeb4cad03d197e432213221d4a52ec5e6010ae1)&lt;/p&gt;</comment>
                            <comment id="17955363" author="jira-bot" created="Sat, 31 May 2025 05:57:19 +0000"  >&lt;p&gt;Commit 36af213703961b4ec12c63c84170981ea30ec000 in activemq&apos;s branch refs/heads/activemq-5.19.x from JB Onofr&#233;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=36af213703&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=36af213703&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-7517&quot; title=&quot;bin/activemq sets ACTIVEMQ_CLASSPATH to likely non-existing directory $ACTIVEMQ_BASE/../lib&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-7517&quot;&gt;&lt;del&gt;AMQ-7517&lt;/del&gt;&lt;/a&gt;: Remove lib in the default classpath (#1442)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit caeb4cad03d197e432213221d4a52ec5e6010ae1)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0gto8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>