<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:45:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-2706] Memory leak &amp; huge thread count in broker</title>
                <link>https://issues.apache.org/jira/browse/AMQ-2706</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;I&apos;m using request/replay pattern where client on BrokerA  creates message and start listening response from temporary-queue, consumer listening on BrokerB, after getting message it sends respond back to the temporary queue.&lt;br/&gt;
After getting message back, client on BrokerA removes temporary queue and closes session and closes connection&lt;br/&gt;
Now if I take a look to the jmx then everythink is OK on BrokerA side. No hangig tmp queues no too many threads. On BrokerB every message lives hanging temporary queue and thread. Even if I shut down BrokerA there are still hanging tmp queue on brokerB and one extra thread.&lt;br/&gt;
Now if I send 10k messages from BrokerA there is 10K temporary quest and 10K threads on brokerA&lt;/p&gt;

&lt;p&gt;Example setup:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Broker A  &amp;lt;NetworkConnector duplex=true&amp;gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; -----&amp;gt;  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  Broker B &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


</description>
                <environment>&lt;p&gt;Linux ubuntu/Java HotSpot(TM) 64-Bit Server VM (build 14.1-b02, mixed mode)&lt;/p&gt;</environment>
        <key id="12483291">AMQ-2706</key>
            <summary>Memory leak &amp; huge thread count in broker</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                            <parent id="12483633">AMQ-2742</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dejanb">Dejan Bosanac</assignee>
                                    <reporter username="kalamaks">Andres</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Apr 2010 14:15:48 +0000</created>
                <updated>Thu, 20 May 2010 11:02:08 +0000</updated>
                            <resolved>Fri, 7 May 2010 15:52:25 +0000</resolved>
                                    <version>5.3.1</version>
                                    <fixVersion>5.4.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12942510" author="kalamaks" created="Thu, 22 Apr 2010 14:17:15 +0000"  >&lt;p&gt;JMX consle&lt;/p&gt;</comment>
                            <comment id="12942518" author="kalamaks" created="Thu, 22 Apr 2010 14:23:33 +0000"  >&lt;p&gt;there is 2 classes (Client = BrokerA  and Server = BrokerB ) for reproducing a problem&lt;/p&gt;</comment>
                            <comment id="12942607" author="dejanb" created="Fri, 7 May 2010 15:52:25 +0000"  >&lt;p&gt;Fixed with svn revision 942131.&lt;/p&gt;

&lt;p&gt;The problem was with destination infos not being propagated to the remote broker, so temp destination were kept lingering.&lt;/p&gt;

&lt;p&gt;However, I think your solution with new temp queue for every message is not optimal, and you should use one temp queue and correlation id. See &lt;a href=&quot;http://activemq.apache.org/how-should-i-implement-request-response-with-jms.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.apache.org/how-should-i-implement-request-response-with-jms.html&lt;/a&gt; for more info&lt;/p&gt;</comment>
                            <comment id="12942608" author="kalamaks" created="Fri, 7 May 2010 18:47:36 +0000"  >&lt;p&gt;tnx Dejan&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12461677" name="memtest.zip" size="3097367" author="kalamaks" created="Thu, 22 Apr 2010 14:23:32 +0000"/>
                            <attachment id="12461675" name="snapshot6.png" size="86886" author="kalamaks" created="Thu, 22 Apr 2010 14:17:15 +0000"/>
                            <attachment id="12461676" name="snapshot7.png" size="101849" author="kalamaks" created="Thu, 22 Apr 2010 14:17:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>74836</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 29 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0rpuv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>159833</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>