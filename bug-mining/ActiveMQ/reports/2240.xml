<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:04:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-5068] Support hardening/persisting the JMSRedeliveryFlag across restarts</title>
                <link>https://issues.apache.org/jira/browse/AMQ-5068</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;WMQ supports a HARDENBO&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; flag on the redelivery flag impl. Which persists before dispatch. And has a corresponding performance impact.&lt;br/&gt;
So we need to implement an additional journal command to persist delivery attempts and update the counter on restart/recovery to get parity.&lt;/p&gt;

&lt;p&gt;This will allow the redeliverFlag to be guaranteed to flag a potential duplicate dispatch in the event of a hard broker failure just after dispatch.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://publib.boulder.ibm.com/infocenter/wmqv7/v7r0/index.jsp?topic=%2Fcom.ibm.mq.explorer.doc%2Fe_properties_queues.htm&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://publib.boulder.ibm.com/infocenter/wmqv7/v7r0/index.jsp?topic=%2Fcom.ibm.mq.explorer.doc%2Fe_properties_queues.htm&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12696246">AMQ-5068</key>
            <summary>Support hardening/persisting the JMSRedeliveryFlag across restarts</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gtully">Gary Tully</assignee>
                                    <reporter username="gtully">Gary Tully</reporter>
                        <labels>
                            <label>JMSRedelivered</label>
                            <label>persistence</label>
                            <label>recovery</label>
                            <label>redelivery</label>
                    </labels>
                <created>Thu, 20 Feb 2014 13:47:00 +0000</created>
                <updated>Fri, 11 Dec 2015 17:34:49 +0000</updated>
                            <resolved>Wed, 26 Mar 2014 11:21:15 +0000</resolved>
                                    <version>5.9.0</version>
                                    <fixVersion>5.10.0</fixVersion>
                                    <component>Message Store</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13935092" author="gtully" created="Fri, 14 Mar 2014 14:50:57 +0000"  >&lt;p&gt;The persisting on rollback is fine when the broker stays alive or dies after a rollback or shuts down gracefully.&lt;br/&gt;
But if there is no transaction, or the broker aborts (and does not get a chance to write any more) we have a problem.&lt;/p&gt;

&lt;p&gt;This new solution requires writing &apos;before&apos; we dispatch, so if we reread the store we know it &apos;may be&apos; a duplicate dispatch.&lt;/p&gt;

&lt;p&gt;It is about duplicate dispatch rather than duplicate delivery.&lt;/p&gt;</comment>
                            <comment id="13947821" author="gtully" created="Wed, 26 Mar 2014 11:21:15 +0000"  >&lt;p&gt;Fix in &lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/activemq/commit/266d23ef&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/activemq/commit/266d23ef&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;enabled via destination policy&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;policyEntry ... persistJMSRedelivered=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; /&amp;gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This ensures that the JMSRedelivered header will always be set on a restart.&lt;br/&gt;
Note: this is only done once, to preserve the redelivered flag. the redelivery count is not preserved.&lt;/p&gt;</comment>
                            <comment id="13947822" author="gtully" created="Wed, 26 Mar 2014 11:21:42 +0000"  >&lt;p&gt;implemented for kahadb, leveldb and jdbc message stores.&lt;/p&gt;</comment>
                            <comment id="15053029" author="jira-bot" created="Fri, 11 Dec 2015 17:06:45 +0000"  >&lt;p&gt;Commit c78eddce7ed3045b5508dd6713252dca8766436c in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=c78eddc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=c78eddc&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;revert sync ack send for &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-3519&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-3519&lt;/a&gt; due to rework in &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-5068&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-5068&lt;/a&gt; - sync send no longer needed because redelivered flag is persisted before dispatch. This avoids a roundtrip overhead on individual ack, ie priority or nonBlockingRedelivery options in the mix&lt;/p&gt;</comment>
                            <comment id="15053071" author="jira-bot" created="Fri, 11 Dec 2015 17:34:49 +0000"  >&lt;p&gt;Commit f8488916c2cc04c402e437fdbc2f61f118189d08 in activemq&apos;s branch refs/heads/activemq-5.13.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=f848891&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=f848891&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;revert sync ack send for &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-3519&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-3519&lt;/a&gt; due to rework in &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-5068&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-5068&lt;/a&gt; - sync send no longer needed because redelivered flag is persisted before dispatch. This avoids a roundtrip overhead on individual ack, ie priority or nonBlockingRedelivery options in the mix&lt;/p&gt;

&lt;p&gt;(cherry picked from commit c78eddce7ed3045b5508dd6713252dca8766436c)&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12525233">AMQ-3519</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>374722</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 49 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1skov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>375022</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>