<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:59:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-4554] NumberFormatException when parsing JMSXProducerTXID</title>
                <link>https://issues.apache.org/jira/browse/AMQ-4554</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;When creating a simple message using ActiveMQ and trying to receive that same message. We get the following stacktrace when trying to retrieve JMSXProducerTXID.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[SEVERE] Thread death for Transacted Thread caused by For input string: &quot;TX:ID:ID-PC12010.local-59923-1369316134520-2:10:1&quot;
java.lang.NumberFormatException: For input string: &quot;TX:ID:ID-PC12010.local-59923-1369316134520-2:10:1&quot;
    at java.lang.NumberFormatException.forInputString(NumberFormatException.java:48)
    at java.lang.Integer.parseInt(Integer.java:449)
    at java.lang.Integer.&amp;lt;init&amp;gt;(Integer.java:660)
    at org.apache.activemq.filter.PropertyExpression$14.evaluate(PropertyExpression.java:147)
    at org.apache.activemq.filter.PropertyExpression.evaluate(PropertyExpression.java:194)
    at org.apache.activemq.command.ActiveMQMessage.getObjectProperty(ActiveMQMessage.java:509)
    at org.apache.activemq.command.ActiveMQMessage.getStringProperty(ActiveMQMessage.java:604)
    at com.id.scriptura.documentflow.standard.impl.jms.JMSMessageConsumerStep$TransactedMessageReceiver.run(Unknown Source)
    at java.lang.Thread.run(Thread.java:680)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This property is set by ActiveMQ and NOT by our application. The code for retrieving is like this:&lt;/p&gt;

&lt;p&gt;msg.getStringProperty(JMSXProducerTXID)&lt;/p&gt;</description>
                <environment>&lt;p&gt;Mac / Windows&lt;/p&gt;</environment>
        <key id="12649289">AMQ-4554</key>
            <summary>NumberFormatException when parsing JMSXProducerTXID</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tabish">Timothy A. Bish</assignee>
                                    <reporter username="nbrys">Nico Brys</reporter>
                        <labels>
                    </labels>
                <created>Fri, 24 May 2013 09:39:43 +0000</created>
                <updated>Fri, 24 May 2013 21:38:29 +0000</updated>
                            <resolved>Fri, 24 May 2013 21:38:29 +0000</resolved>
                                    <version>5.5.1</version>
                                    <fixVersion>5.9.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13666167" author="nbrys" created="Fri, 24 May 2013 09:44:44 +0000"  >&lt;p&gt;The code from activeMQ&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  JMS_PROPERTY_EXPRESSIONS.put(&quot;JMSXProducerTXID&quot;, new SubExpression() {
 
           public Object evaluate(Message message) {
               TransactionId txId = message.getOriginalTransactionId();
               if (txId == null) {
                   txId = message.getTransactionId();
               }
               if (txId == null) {
                   return null;
               }
               return new Integer(txId.toString());
           }
       });
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;JMS Spec:&lt;/p&gt;

&lt;p&gt;MSXProducerTXID String Provider on&lt;br/&gt;
Send&lt;br/&gt;
The transaction identifier of the&lt;br/&gt;
transaction within which this&lt;br/&gt;
message was produced&lt;/p&gt;

&lt;p&gt;Please see: &lt;a href=&quot;http://docs.oracle.com/cd/E19957-01/816-5904-10/816-5904-10.pdf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.oracle.com/cd/E19957-01/816-5904-10/816-5904-10.pdf&lt;/a&gt; page 36&lt;/p&gt;</comment>
                            <comment id="13666174" author="tabish121" created="Fri, 24 May 2013 10:17:17 +0000"  >&lt;p&gt;Recommend you create a unit test that reproduces your issue, also you should try testing a later release, 5.5.1 is a bit old these days. &lt;/p&gt;</comment>
                            <comment id="13666180" author="nbrys" created="Fri, 24 May 2013 10:22:52 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tabish121&quot; class=&quot;user-hover&quot; rel=&quot;tabish121&quot;&gt;tabish121&lt;/a&gt;, the version doesn&apos;t mather. The source code is still the same (See my previous comment... This source is from there current release).&lt;/p&gt;

&lt;p&gt;The test case is rather easy.. Just send a message with activeMQ and receive message with ActiveMQ where you request the property...&lt;/p&gt;

&lt;p&gt;Found this also:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ConnectionFactory connectionFactory = new ActiveMQConnectionFactory(ActiveMQConnection.DEFAULT_USER, 
ActiveMQConnection.DEFAULT_PASSWORD, ActiveMQConnection.DEFAULT_BROKER_URL)
Connection connection = connectionFactory.createConnection();	
connection.start();
Session producerSession = connection.createSession(true, Session.SESSION_TRANSACTED);
MessageProducer producer = producerSession.createProducer(producerSession.createQueue(&quot;myQueue&quot;));
TextMessage producerMessage = producerSession.createTextMessage(&quot;Test Message&quot;);
producer.send(producerMessage);
producer.close();
producerSession.commit();
producerSession.close();
Session consumerSession = connection.createSession(true, Session.SESSION_TRANSACTED);
MessageConsumer consumer = consumerSession.createConsumer(consumerSession.createQueue(&quot;myQueue&quot;));
Message consumerMessage = consumer.receive(1000);
System.out.println(consumerMessage.getStringProperty(&quot;JMSXProducerTXID&quot;));
consumer.close();
consumerSession.commit();
consumerSession.close();
connection.close();&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13666182" author="nbrys" created="Fri, 24 May 2013 10:27:27 +0000"  >&lt;p&gt;See fisheye:&lt;br/&gt;
&lt;a href=&quot;https://fisheye6.atlassian.com/browse/~br=trunk/activemq/trunk/activemq-client/src/main/java/org/apache/activemq/filter/PropertyExpression.java?r=1483600&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://fisheye6.atlassian.com/browse/~br=trunk/activemq/trunk/activemq-client/src/main/java/org/apache/activemq/filter/PropertyExpression.java?r=1483600&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13666707" author="tabish121" created="Fri, 24 May 2013 21:38:29 +0000"  >&lt;p&gt;Fixed on trunk, test added to protect the fix&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>329616</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 26 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1kv8f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>329951</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>