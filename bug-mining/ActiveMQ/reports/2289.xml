<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:04:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-5189] Rollback on XASession when closing back to pool</title>
                <link>https://issues.apache.org/jira/browse/AMQ-5189</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;If you have a pool of XASession under load (heavy load might be necessary) I register sometimes following Exception &quot;Cannot rollback() inside an XASession&quot; in afterCompletion synchronisation. After some analysis and patching with logging I recognized that the session object is returned back to pool before setting the xa flag back to false. This leads to the effect that this session gets be used again by another thread while the earlier one switches the xa flag to false.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows, UNIX&lt;/p&gt;</environment>
        <key id="12714812">AMQ-5189</key>
            <summary>Rollback on XASession when closing back to pool</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tabish">Timothy A. Bish</assignee>
                                    <reporter username="graben">Benjamin Graf</reporter>
                        <labels>
                    </labels>
                <created>Fri, 16 May 2014 17:20:15 +0000</created>
                <updated>Thu, 29 May 2014 14:33:55 +0000</updated>
                            <resolved>Thu, 29 May 2014 14:33:55 +0000</resolved>
                                    <version>5.7.0</version>
                    <version>5.8.0</version>
                    <version>5.9.0</version>
                    <version>5.9.1</version>
                                    <fixVersion>5.10.0</fixVersion>
                                    <component>Pool</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14000709" author="graben" created="Sat, 17 May 2014 08:22:31 +0000"  >&lt;p&gt;A solution might be to register a PooledSessionEventListener in XA synchronisation which does the ignore and xa flagging onSessionClosed.&lt;/p&gt;</comment>
                            <comment id="14001747" author="geerzo" created="Mon, 19 May 2014 15:03:27 +0000"  >&lt;p&gt;I think this issue was fixed in 5.9. Can you confirm it&apos;s an issue in the newer versions because or provide a test case because I&apos;m not seeing the issue currently.&lt;/p&gt;</comment>
                            <comment id="14002100" author="graben" created="Mon, 19 May 2014 18:12:30 +0000"  >&lt;p&gt;Since this problem is not deterministic its quite hard to deliver a test case. But if you look at the code you can see that this problem does still exist in trunk code.&lt;br/&gt;
Look at XaConnectionPool line 106 where the close operation on the PooledSession object is invoked which returns itself back into the pool in line 152. But the Synchronization object of XaConnectionPool does still change values after that in line 107 and 108 while the pool object might be used again in another thread. So it is obvious that a collition can occured!&lt;/p&gt;</comment>
                            <comment id="14009517" author="graben" created="Tue, 27 May 2014 09:10:40 +0000"  >&lt;p&gt;Any feedback on my comment?&lt;/p&gt;</comment>
                            <comment id="14012155" author="graben" created="Thu, 29 May 2014 07:27:04 +0000"  >&lt;p&gt;Patch suggestion&lt;/p&gt;</comment>
                            <comment id="14012402" author="tabish121" created="Thu, 29 May 2014 14:33:55 +0000"  >&lt;p&gt;Nice idea, patch looks good, applied to trunk. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12647313" name="vcs-diff962688386413870521.patch" size="10235" author="graben" created="Thu, 29 May 2014 07:27:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>393125</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 25 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1vp2n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>393291</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>