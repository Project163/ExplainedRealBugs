<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:05:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-4000] Durable subscription not getting unregistered on networked broker</title>
                <link>https://issues.apache.org/jira/browse/AMQ-4000</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;In a network of two brokers, a durable subscription is correctly propagated across to the remote broker. However when the consumer unsubscribes from the durable subscription again, it is only removed on the local broker but not on the remote broker. The remote broker keeps its durable subscription alive.&lt;/p&gt;

&lt;p&gt;As a consequence messages sent to the topic destination on the remote broker for which the durable subscriptions existed, are passed on to the local broker, although there is no active subscription on the local broker. The local broker will discard these msgs but unnecessary traffic has already occurred on the network bridge.&lt;/p&gt;</description>
                <environment>&lt;p&gt;network of brokers, durable topic subscriptions.&lt;/p&gt;</environment>
        <key id="12605217">AMQ-4000</key>
            <summary>Durable subscription not getting unregistered on networked broker</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ceposta">Christian Posta</assignee>
                                    <reporter username="tmielke">Torsten Mielke</reporter>
                        <labels>
                            <label>durable_subscription</label>
                            <label>networks</label>
                    </labels>
                <created>Tue, 28 Aug 2012 12:46:29 +0000</created>
                <updated>Wed, 7 Oct 2015 12:02:59 +0000</updated>
                            <resolved>Mon, 21 Jul 2014 12:44:50 +0000</resolved>
                                    <version>5.6.0</version>
                                    <fixVersion>5.10.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="13443128" author="tmielke" created="Tue, 28 Aug 2012 12:50:18 +0000"  >&lt;p&gt;Attaching patch file containing JUnit test but no fix yet. &lt;/p&gt;</comment>
                            <comment id="13444017" author="tmielke" created="Wed, 29 Aug 2012 12:44:51 +0000"  >&lt;p&gt;org.apache.activemq.advisory.AdvisoryBroker does not override the method &lt;br/&gt;
public void removeSubscription(ConnectionContext context, RemoveSubscriptionInfo info);&lt;/p&gt;

&lt;p&gt;of class org.apache.activemq.broker.BrokerFilter.&lt;/p&gt;

&lt;p&gt;Its the AdvisoryBroker that is responsible for creating and firing the advisory message to inform other brokers in the network that a durable subscription got removed. &lt;br/&gt;
So AdvisoryBroker needs to override method removeSubscription() accordingly. &lt;/p&gt;</comment>
                            <comment id="13576306" author="ceposta" created="Tue, 12 Feb 2013 02:33:28 +0000"  >&lt;p&gt;Before this gets fixed, I suppose the workaround is to use offlineDurableSubscriberTimeout? &lt;/p&gt;</comment>
                            <comment id="13578953" author="ceposta" created="Fri, 15 Feb 2013 05:24:04 +0000"  >&lt;p&gt;Thanks Torsten for the good test. Fixed with r1446447.&lt;br/&gt;
Give it a shot on your end when you get a sec.&lt;/p&gt;</comment>
                            <comment id="13579109" author="gtully" created="Fri, 15 Feb 2013 11:24:10 +0000"  >&lt;p&gt;@Christian looking at that fix i think it may be may be missing the conduit nature if durable subs. So with two durable subs and one unsub, i think we will loose the bridged sub. Maybe just checkup on that. Not sure if there are failing tests that will show that.&lt;br/&gt;
but my thought is that the conduit durables need to be reference counted w.r.t to durable unsubscribes vs disconnects.&lt;/p&gt;</comment>
                            <comment id="13579224" author="ceposta" created="Fri, 15 Feb 2013 14:54:51 +0000"  >&lt;p&gt;Gary, that sounds right... I missed it. Let me write the unit test and get that in there&lt;/p&gt;</comment>
                            <comment id="13582569" author="gtully" created="Wed, 20 Feb 2013 21:58:46 +0000"  >&lt;p&gt;I reverted the change, we can revisit.&lt;/p&gt;</comment>
                            <comment id="13587550" author="kearls" created="Tue, 26 Feb 2013 21:04:00 +0000"  >&lt;p&gt;FYI, DurableSubInBrokerNetworkTest.testDurableSubNetwork is currently failing&lt;/p&gt;</comment>
                            <comment id="13658304" author="dejanb" created="Wed, 15 May 2013 12:36:33 +0000"  >&lt;p&gt;As a first step we need a proper way to send advisories when durable sub unsubscribes. I started with Christian&apos;s solution but noted a couple of cases that were not covered, like sending advisory when unsubscribing using JMX and after restarting a broker. I committed a new fix in svn revision 1482790. I&apos;ll now proceed to trying to implement the rest of this feature.&lt;/p&gt;</comment>
                            <comment id="13660751" author="dejanb" created="Fri, 17 May 2013 14:33:21 +0000"  >&lt;p&gt;Pushed another commit 1483827. It keeps track of durable subs in demand suscription and unregister local durable when there&apos;s no remote durable subs any more. The DurableSubInBrokerNetworkTest now passes but there is more work in this area. We need to make sure we have a proper state after broker restart and work well with mix of non-durable and durable subs on the same topic.&lt;/p&gt;</comment>
                            <comment id="13660761" author="tabish121" created="Fri, 17 May 2013 14:44:00 +0000"  >&lt;p&gt;In the latest commit you added a new field to ConsumerInfo clientId with the openwire annotation set to version=1, shouldn&apos;t that be version=10 in order to keep backwards compatibility? &lt;/p&gt;</comment>
                            <comment id="13660837" author="dejanb" created="Fri, 17 May 2013 16:29:13 +0000"  >&lt;p&gt;Thanks for spotting! Fixed and bumped operwire version to 10 in svn commit 1483902&lt;/p&gt;</comment>
                            <comment id="13923827" author="gtully" created="Fri, 7 Mar 2014 12:10:33 +0000"  >&lt;p&gt;@Christian - this looks done but there is a test that is excluded in the unit-test pom as broken that maybe can come back into the fold.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;!-- https:&lt;span class=&quot;code-comment&quot;&gt;//issues.apache.org/jira/browse/AMQ-4000 --&amp;gt;
&lt;/span&gt;                &amp;lt;exclude&amp;gt;**/DurableSubInBrokerNetworkTest.*&amp;lt;/exclude&amp;gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14068469" author="gtully" created="Mon, 21 Jul 2014 12:44:51 +0000"  >&lt;p&gt;test enabled on trunk - fix looks complete&lt;br/&gt;
&lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/activemq/commit/0ebbd5d9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/activemq/commit/0ebbd5d9&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14944888" author="jira-bot" created="Tue, 6 Oct 2015 11:17:33 +0000"  >&lt;p&gt;Commit dc06c8dc7540233aad6722afe554c2ea505754e2 in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=dc06c8d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=dc06c8d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-5994&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-5994&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-4000&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-4000&lt;/a&gt; - proper fix for duplicate sub info from the store on recovery failure from AMQ2149Test. Additional test from Christopher L&lt;/p&gt;</comment>
                            <comment id="14946739" author="jira-bot" created="Wed, 7 Oct 2015 12:02:59 +0000"  >&lt;p&gt;Commit 8ef31b91e6db5a10cebc79785f075649d8ba0a56 in activemq&apos;s branch refs/heads/activemq-5.12.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=8ef31b9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=8ef31b9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-5994&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-5994&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-4000&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-4000&lt;/a&gt; - proper fix for duplicate sub info from the store on recovery failure from AMQ2149Test. Additional test from Christopher L&lt;/p&gt;

&lt;p&gt;(cherry picked from commit dc06c8dc7540233aad6722afe554c2ea505754e2)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12542762" name="JUnitTest.patch" size="4676" author="tmielke" created="Tue, 28 Aug 2012 12:50:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>253886</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 6 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ea9z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>81427</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>