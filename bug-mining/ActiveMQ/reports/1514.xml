<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:54:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-3836] STOMP 1.0 protocol (SUBSCRIBE destination) broken on ActiveMQ 5.6.0</title>
                <link>https://issues.apache.org/jira/browse/AMQ-3836</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Destination specification on STOMP using activemq 5.6.0 is broken.&lt;/p&gt;

&lt;p&gt;Before 5.6.0, you had to specify &quot;/queue/my_queue&quot;. Now, activemq automatically includes a &quot;/queue/&quot; on destination name, whether needed or not.&lt;/p&gt;

&lt;p&gt;For instance, sending messages to &quot;/queue/nagios-events&quot; works. Subscribing to &quot;/queue/nagios-events&quot; creates an additional queue named &quot;/queue/queue/nagios-events&quot;.&lt;/p&gt;

&lt;p&gt;Message sending is also affected, although it accepts both &quot;/queue/nagios-events&quot; and &quot;nagios-events&quot;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Centos 5 running Apache ActiveMQ 5.6.0, jre-1.6.0_20-fcs&lt;/p&gt;</environment>
        <key id="12554913">AMQ-3836</key>
            <summary>STOMP 1.0 protocol (SUBSCRIBE destination) broken on ActiveMQ 5.6.0</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tabish">Timothy A. Bish</assignee>
                                    <reporter username="dmichellis">Deives Michellis</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 May 2012 14:31:32 +0000</created>
                <updated>Thu, 31 May 2012 20:27:43 +0000</updated>
                            <resolved>Thu, 31 May 2012 20:27:43 +0000</resolved>
                                    <version>5.6.0</version>
                                    <fixVersion>5.7.0</fixVersion>
                                    <component>STOMP</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13273304" author="tabish121" created="Fri, 11 May 2012 14:44:39 +0000"  >&lt;p&gt;Recommend you create a JUnit test case to demonstrate your issue.&lt;/p&gt;</comment>
                            <comment id="13273309" author="dmichellis" created="Fri, 11 May 2012 14:48:13 +0000"  >&lt;p&gt;I have absolutely no idea how to do that. I am not a java guy, sorry&lt;/p&gt;</comment>
                            <comment id="13273321" author="tabish121" created="Fri, 11 May 2012 14:58:57 +0000"  >&lt;p&gt;StompTest.java in our unit tests has plenty of examples, barring that please create a test case using the client you are currently using.  &lt;/p&gt;</comment>
                            <comment id="13274623" author="tabish121" created="Mon, 14 May 2012 14:43:31 +0000"  >&lt;p&gt;You&apos;ll need to provide a test case, can&apos;t reproduce this so far.&lt;/p&gt;</comment>
                            <comment id="13285859" author="giles7777" created="Wed, 30 May 2012 18:12:08 +0000"  >&lt;p&gt;I&apos;m seeing the same problem.  We&apos;re using a modified first.php from the fuse php client.  I&apos;ll clean it up and attach it.&lt;/p&gt;</comment>
                            <comment id="13285867" author="giles7777" created="Wed, 30 May 2012 18:19:25 +0000"  >&lt;p&gt;modified first.php from fuse stomp php client.  the result on 5.5.1 comes back as:&lt;/p&gt;

&lt;p&gt;Notice the destination has a /queue on it in 5.6.0  We checked the STOMP frame and its not coming from the client.&lt;/p&gt;

&lt;p&gt;In 5.5.1 we get this result:&lt;/p&gt;

&lt;p&gt;Received headers&lt;br/&gt;
s_scale =&amp;gt; 0.001&lt;br/&gt;
message-id =&amp;gt; ID:tony-desktop-53600-1338396365864-2:12:-1:1:1&lt;br/&gt;
d_serviceName =&amp;gt; ModelUpload&lt;br/&gt;
destination =&amp;gt; /topic/testtopic&lt;br/&gt;
timestamp =&amp;gt; 1338399414341&lt;br/&gt;
s_modelID =&amp;gt; 123456&lt;br/&gt;
expires =&amp;gt; 0&lt;br/&gt;
priority =&amp;gt; 4&lt;/p&gt;

&lt;p&gt;In 5.6.0 we get this result:&lt;/p&gt;

&lt;p&gt;Received headers&lt;br/&gt;
s_scale =&amp;gt;  0.001&lt;br/&gt;
message-id =&amp;gt; ID:maker-55961-1338400788753-2:2:-1:1:1&lt;br/&gt;
d_serviceName =&amp;gt;  ModelUpload&lt;br/&gt;
destination =&amp;gt; /queue//topic/testtopic&lt;br/&gt;
timestamp =&amp;gt; 1338401617112&lt;br/&gt;
s_modelID =&amp;gt;  123456&lt;br/&gt;
expires =&amp;gt; 0&lt;br/&gt;
priority =&amp;gt; 4&lt;/p&gt;



&lt;p&gt;Here is the frame that was sent:&lt;/p&gt;

&lt;p&gt;SEND&lt;br/&gt;
d_serviceName: ModelUpload&lt;br/&gt;
s_modelID: 123456&lt;br/&gt;
s_scale: 0.001&lt;br/&gt;
destination: /topic/testtopic&lt;/p&gt;

&lt;p&gt;test&lt;/p&gt;


&lt;p&gt;&amp;#8212;&lt;br/&gt;
I suspect its something in the FrameTranslator, digging in there.  &lt;/p&gt;</comment>
                            <comment id="13285875" author="tabish121" created="Wed, 30 May 2012 18:23:06 +0000"  >&lt;p&gt;Why not try and reproduce it with a JUnit test?  There&apos;s already a large number of them in StompTest.java to work from.&lt;/p&gt;</comment>
                            <comment id="13285878" author="giles7777" created="Wed, 30 May 2012 18:27:08 +0000"  >&lt;p&gt;I will.  Just getting my head around the problem, so far we&apos;re learning stomp from the php client.  &lt;/p&gt;</comment>
                            <comment id="13286191" author="giles7777" created="Wed, 30 May 2012 23:40:12 +0000"  >&lt;p&gt;The issue is with STOMP clients that put spaces after values as in destination: /topic/test&lt;/p&gt;

&lt;p&gt;The convert destination method in LegacyFrameTranslator does a startsWith(&quot;/topic&quot;) to detect topics.  &lt;/p&gt;

&lt;p&gt;The fuse stomp php client puts a space on items.  My read of the stomp spec shows examples without it.  But it doesn&apos;t really make it clear.  We&apos;re looking around at a few other clients to see what they do.&lt;/p&gt;

&lt;p&gt;If its common of clients then it might make sense to deal with it on the server.  The other php stomp client does not put spaces in its values.  &lt;/p&gt;

&lt;p&gt;I can easily make a junit test for this case if you want it, but I kinda expect this will be labeled under &quot;client error&quot; or maybe incomplete spec language(my pet peeve).  &lt;/p&gt;</comment>
                            <comment id="13286803" author="giles7777" created="Thu, 31 May 2012 18:24:05 +0000"  >&lt;p&gt;I found this language in the STOMP specification under Value Encoding:&lt;/p&gt;

&lt;p&gt;The STOMP 1.0 specification included many example frames with padding in the headers and many servers and clients were implemented to trim or pad header values. This causes problems if applications want to send headers that SHOULD not get trimmed. In STOMP 1.1, clients and servers MUST never trim or pad headers with spaces.&lt;/p&gt;


&lt;p&gt;So I believe we should not do any space removal.  I think this ticket can be closed.&lt;/p&gt;</comment>
                            <comment id="13286811" author="tabish121" created="Thu, 31 May 2012 18:34:52 +0000"  >&lt;p&gt;Agreed the spec was a bit vague in this regard.  In 5.6 we removed the header trimming in order to not discard spaces that a client had intentionally placed there.  It might be good to at least do a test on a trimmed destination value before assuming its a queue and getting into this scenario.&lt;/p&gt;</comment>
                            <comment id="13286899" author="tabish121" created="Thu, 31 May 2012 20:27:43 +0000"  >&lt;p&gt;Fixed to attempt to find the right destination with spaces padding trimmed before falling back to the configured fallback handler.  Also updated the Stomp PHP client to not pad headers.  &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12530245" name="firsttony.php" size="1596" author="giles7777" created="Wed, 30 May 2012 18:19:25 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239166</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 25 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ahtz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>59162</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>