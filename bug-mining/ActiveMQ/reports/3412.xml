<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:51:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-8518] NPE when starting ActiveMQ</title>
                <link>https://issues.apache.org/jira/browse/AMQ-8518</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;When upgrading a broker to 5.16.4, I noticed a NPE during startup. This seems to be caused by an incoming STOMP packet at that time.&lt;/p&gt;

&lt;p&gt;Here is what has been logged:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2022-02-28T12:59:33.411+0100 [WrapperSimpleAppMain] INFO BrokerService - Apache ActiveMQ 5.16.4 (broker, broker) started
2022-02-28T12:59:33.411+0100 [WrapperSimpleAppMain] INFO BrokerService - For help or more information please see: http:&lt;span class=&quot;code-comment&quot;&gt;//activemq.apache.org
&lt;/span&gt;2022-02-28T12:59:34.084+0100 [ActiveMQ NIO Worker 5] WARN Service - Async error occurred
java.lang.NullPointerException
	at org.apache.activemq.filter.DestinationMapNode.appendMatchingValues(DestinationMapNode.java:238)
	at org.apache.activemq.filter.DestinationMap.findWildcardMatches(DestinationMap.java:194)
	at org.apache.activemq.filter.DestinationMap.findWildcardMatches(DestinationMap.java:187)
	at org.apache.activemq.filter.DestinationMap.unsynchronizedGet(DestinationMap.java:84)
	at org.apache.activemq.broker.region.AbstractRegion.getDestinations(AbstractRegion.java:327)
	at org.apache.activemq.broker.region.RegionBroker.getDestinations(RegionBroker.java:176)
	at org.apache.activemq.broker.BrokerFilter.getDestinations(BrokerFilter.java:84)
	at org.apache.activemq.broker.BrokerFilter.getDestinations(BrokerFilter.java:84)
	at org.apache.activemq.broker.BrokerFilter.getDestinations(BrokerFilter.java:84)
	at org.apache.activemq.broker.BrokerFilter.getDestinations(BrokerFilter.java:84)
	at org.apache.activemq.broker.BrokerFilter.getDestinations(BrokerFilter.java:84)
	at org.apache.activemq.broker.BrokerFilter.getDestinations(BrokerFilter.java:84)
	at org.apache.activemq.broker.BrokerFilter.getDestinations(BrokerFilter.java:84)
	at org.apache.activemq.broker.BrokerFilter.getDestinations(BrokerFilter.java:84)
	at org.apache.activemq.broker.region.virtual.VirtualTopicInterceptor.send(VirtualTopicInterceptor.java:81)
	at org.apache.activemq.broker.region.virtual.VirtualTopicInterceptor.send(VirtualTopicInterceptor.java:73)
	at org.apache.activemq.broker.region.DestinationFilter.send(DestinationFilter.java:138)
	at org.apache.activemq.broker.region.AbstractRegion.send(AbstractRegion.java:511)
	at org.apache.activemq.broker.region.RegionBroker.send(RegionBroker.java:477)
	at org.apache.activemq.broker.jmx.ManagedRegionBroker.send(ManagedRegionBroker.java:293)
	at org.apache.activemq.broker.CompositeDestinationBroker.send(CompositeDestinationBroker.java:96)
	at org.apache.activemq.broker.TransactionBroker.send(TransactionBroker.java:295)
	at org.apache.activemq.broker.BrokerFilter.send(BrokerFilter.java:154)
	at org.apache.activemq.broker.UserIDBroker.send(UserIDBroker.java:60)
	at org.apache.activemq.broker.BrokerFilter.send(BrokerFilter.java:154)
	at org.apache.activemq.security.AuthorizationBroker.send(AuthorizationBroker.java:226)
	at org.apache.activemq.broker.BrokerFilter.send(BrokerFilter.java:154)
	at org.apache.activemq.broker.BrokerFilter.send(BrokerFilter.java:154)
	at org.apache.activemq.broker.BrokerFilter.send(BrokerFilter.java:154)
	at org.apache.activemq.broker.util.TimeStampingBrokerPlugin.send(TimeStampingBrokerPlugin.java:132)
	at org.apache.activemq.broker.BrokerFilter.send(BrokerFilter.java:154)
	at org.apache.activemq.broker.TransportConnection.processMessage(TransportConnection.java:580)
	at org.apache.activemq.command.ActiveMQMessage.visit(ActiveMQMessage.java:769)
	at org.apache.activemq.broker.TransportConnection.service(TransportConnection.java:335)
	at org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:200)
	at org.apache.activemq.transport.MutexTransport.onCommand(MutexTransport.java:45)
	at org.apache.activemq.transport.AbstractInactivityMonitor.onCommand(AbstractInactivityMonitor.java:301)
	at org.apache.activemq.transport.stomp.StompTransportFilter.sendToActiveMQ(StompTransportFilter.java:97)
	at org.apache.activemq.transport.stomp.ProtocolConverter.sendToActiveMQ(ProtocolConverter.java:179)
	at org.apache.activemq.transport.stomp.ProtocolConverter.onStompSend(ProtocolConverter.java:347)
	at org.apache.activemq.transport.stomp.ProtocolConverter.onStompCommand(ProtocolConverter.java:237)
	at org.apache.activemq.transport.stomp.StompTransportFilter.onCommand(StompTransportFilter.java:85)
	at org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:83)
	at org.apache.activemq.transport.nio.NIOSSLTransport.doConsume(NIOSSLTransport.java:509)
	at org.apache.activemq.transport.stomp.StompNIOSSLTransport.doConsume(StompNIOSSLTransport.java:92)
	at org.apache.activemq.transport.stomp.StompCodec.processCommand(StompCodec.java:133)
	at org.apache.activemq.transport.stomp.StompCodec.parse(StompCodec.java:119)
	at org.apache.activemq.transport.stomp.StompNIOSSLTransport.processCommand(StompNIOSSLTransport.java:80)
	at org.apache.activemq.transport.nio.NIOSSLTransport.serviceRead(NIOSSLTransport.java:284)
	at org.apache.activemq.transport.nio.NIOSSLTransport$1.onSelect(NIOSSLTransport.java:176)
	at org.apache.activemq.transport.nio.SelectorSelection.onSelect(SelectorSelection.java:98)
	at org.apache.activemq.transport.nio.SelectorWorker$1.run(SelectorWorker.java:123)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
2022-02-28T12:59:34.126+0100 [ActiveMQ BrokerService[broker] Task-10] ERROR TaskRunnerFactory - Error in thread &lt;span class=&quot;code-quote&quot;&gt;&apos;ActiveMQ BrokerService[broker] Task-10&apos;&lt;/span&gt;
java.lang.NullPointerException
	at org.apache.activemq.transport.stomp.StompWireFormat.encodeHeader(StompWireFormat.java:306)
	at org.apache.activemq.transport.stomp.StompWireFormat.marshalHeaders(StompWireFormat.java:85)
	at org.apache.activemq.transport.stomp.StompWireFormat.marshal(StompWireFormat.java:106)
	at org.apache.activemq.transport.tcp.TcpTransport.oneway(TcpTransport.java:193)
	at org.apache.activemq.transport.stomp.StompTransportFilter.sendToStomp(StompTransportFilter.java:108)
	at org.apache.activemq.transport.stomp.ProtocolConverter.sendToStomp(ProtocolConverter.java:183)
	at org.apache.activemq.transport.stomp.ProtocolConverter.handleException(ProtocolConverter.java:316)
	at org.apache.activemq.transport.stomp.ProtocolConverter.onActiveMQCommand(ProtocolConverter.java:886)
	at org.apache.activemq.transport.stomp.StompTransportFilter.oneway(StompTransportFilter.java:72)
	at org.apache.activemq.transport.AbstractInactivityMonitor.doOnewaySend(AbstractInactivityMonitor.java:335)
	at org.apache.activemq.transport.AbstractInactivityMonitor.oneway(AbstractInactivityMonitor.java:317)
	at org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:68)
	at org.apache.activemq.broker.TransportConnection.dispatch(TransportConnection.java:1483)
	at org.apache.activemq.broker.TransportConnection.processDispatch(TransportConnection.java:981)
	at org.apache.activemq.broker.TransportConnection.iterate(TransportConnection.java:1032)
	at org.apache.activemq.thread.PooledTaskRunner.runTask(PooledTaskRunner.java:133)
	at org.apache.activemq.thread.PooledTaskRunner$1.run(PooledTaskRunner.java:48)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I then restarted the broker once more and this went fine so I cannot reproduce the problem.&lt;/p&gt;

&lt;p&gt;I hope that the stack trace is enough to understand what happened.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13430983">AMQ-8518</key>
            <summary>NPE when starting ActiveMQ</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbonofre">Jean-Baptiste Onofr&#233;</assignee>
                                    <reporter username="lionel.cons">Lionel Cons</reporter>
                        <labels>
                    </labels>
                <created>Mon, 28 Feb 2022 12:08:02 +0000</created>
                <updated>Tue, 19 Apr 2022 06:30:20 +0000</updated>
                            <resolved>Tue, 19 Apr 2022 06:30:20 +0000</resolved>
                                    <version>5.16.4</version>
                                    <fixVersion>5.17.1</fixVersion>
                    <fixVersion>5.16.5</fixVersion>
                    <fixVersion>5.18.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="600">10m</timespent>
                                <comments>
                            <comment id="17499571" author="jbonofre" created="Tue, 1 Mar 2022 14:27:10 +0000"  >&lt;p&gt;Thanks for the report, I will take a look.&lt;/p&gt;</comment>
                            <comment id="17524093" author="jira-bot" created="Tue, 19 Apr 2022 06:28:51 +0000"  >&lt;p&gt;Commit 0849ae02116b9da3251b026546ce2fb049589dbe in activemq&apos;s branch refs/heads/main from Jean-Baptiste Onofr&#233;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=0849ae021&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=0849ae021&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-8518&quot; title=&quot;NPE when starting ActiveMQ&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-8518&quot;&gt;&lt;del&gt;AMQ-8518&lt;/del&gt;&lt;/a&gt; Avoid NPE if path is null (at startup)&lt;/p&gt;</comment>
                            <comment id="17524094" author="jira-bot" created="Tue, 19 Apr 2022 06:28:52 +0000"  >&lt;p&gt;Commit d09fe4569528891c5d0fdfc0d2bb87be00e0d862 in activemq&apos;s branch refs/heads/main from Jean-Baptiste Onofr&#233;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=d09fe4569&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=d09fe4569&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Merge pull request #829 from jbonofre/&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-8518&quot; title=&quot;NPE when starting ActiveMQ&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-8518&quot;&gt;&lt;del&gt;AMQ-8518&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-8518&quot; title=&quot;NPE when starting ActiveMQ&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-8518&quot;&gt;&lt;del&gt;AMQ-8518&lt;/del&gt;&lt;/a&gt; Avoid NPE if path is null (at startup)&lt;/p&gt;</comment>
                            <comment id="17524095" author="jira-bot" created="Tue, 19 Apr 2022 06:29:37 +0000"  >&lt;p&gt;Commit 68bed90c99c09bf96c8944b890022d8ff28ca969 in activemq&apos;s branch refs/heads/activemq-5.17.x from Jean-Baptiste Onofr&#233;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=68bed90c9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=68bed90c9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-8518&quot; title=&quot;NPE when starting ActiveMQ&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-8518&quot;&gt;&lt;del&gt;AMQ-8518&lt;/del&gt;&lt;/a&gt; Avoid NPE if path is null (at startup)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 0849ae02116b9da3251b026546ce2fb049589dbe)&lt;/p&gt;</comment>
                            <comment id="17524096" author="jira-bot" created="Tue, 19 Apr 2022 06:30:11 +0000"  >&lt;p&gt;Commit 4b1264fbe821f4d69f3205a19b7d81ba6c77ed4c in activemq&apos;s branch refs/heads/activemq-5.16.x from Jean-Baptiste Onofr&#233;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=4b1264fbe&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=4b1264fbe&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-8518&quot; title=&quot;NPE when starting ActiveMQ&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-8518&quot;&gt;&lt;del&gt;AMQ-8518&lt;/del&gt;&lt;/a&gt; Avoid NPE if path is null (at startup)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 0849ae02116b9da3251b026546ce2fb049589dbe)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 30 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1004w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>