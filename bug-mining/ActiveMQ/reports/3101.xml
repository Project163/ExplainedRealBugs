<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:41:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-6815] KahaDB checkpoint needs to fail fast in the event of journal write failure</title>
                <link>https://issues.apache.org/jira/browse/AMQ-6815</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;KahaDB checkpoint does some async updated to the journal and syncs to the index. However the async journal updates can error out and not get reported leading to the index metadata being stale. This can lead to reading an invalid location on restart which may result in full recovery of the index.&lt;/p&gt;

&lt;p&gt;Any exception from the async store needs to cause the checkpoint to fail.&lt;/p&gt;

&lt;p&gt;In addition, on reading a corrupt location, we can do a sanity check to avoid a potential OOM by validating the size before allocation.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13103273">AMQ-6815</key>
            <summary>KahaDB checkpoint needs to fail fast in the event of journal write failure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gtully">Gary Tully</assignee>
                                    <reporter username="gtully">Gary Tully</reporter>
                        <labels>
                    </labels>
                <created>Tue, 19 Sep 2017 15:48:04 +0000</created>
                <updated>Tue, 2 May 2023 14:34:56 +0000</updated>
                            <resolved>Thu, 11 Jan 2018 13:06:49 +0000</resolved>
                                    <version>5.15.0</version>
                                    <fixVersion>5.15.3</fixVersion>
                    <fixVersion>5.16.0</fixVersion>
                                    <component>KahaDB</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16171933" author="jira-bot" created="Tue, 19 Sep 2017 15:51:14 +0000"  >&lt;p&gt;Commit 8c3ef6cadb46d9694c68aa649a7952eb1612279f in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=8c3ef6c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=8c3ef6c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6815&quot; title=&quot;KahaDB checkpoint needs to fail fast in the event of journal write failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6815&quot;&gt;&lt;del&gt;AMQ-6815&lt;/del&gt;&lt;/a&gt; have checkpoint validate status of async writes to avoid stale metadata and validate location size on read to avoid potential oom on restart&lt;/p&gt;</comment>
                            <comment id="16171945" author="jira-bot" created="Tue, 19 Sep 2017 16:01:37 +0000"  >&lt;p&gt;Commit b5f7c15b2518334d338f9fad54696f62ba4c268b in activemq&apos;s branch refs/heads/activemq-5.15.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=b5f7c15&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=b5f7c15&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6815&quot; title=&quot;KahaDB checkpoint needs to fail fast in the event of journal write failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6815&quot;&gt;&lt;del&gt;AMQ-6815&lt;/del&gt;&lt;/a&gt; have checkpoint validate status of async writes to avoid stale metadata and validate location size on read to avoid potential oom on restart&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 8c3ef6cadb46d9694c68aa649a7952eb1612279f)&lt;/p&gt;</comment>
                            <comment id="16322169" author="jira-bot" created="Thu, 11 Jan 2018 12:57:12 +0000"  >&lt;p&gt;Commit ec6fa190999160676cab900038b268b2d40a4d5c in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=ec6fa19&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=ec6fa19&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6815&quot; title=&quot;KahaDB checkpoint needs to fail fast in the event of journal write failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6815&quot;&gt;&lt;del&gt;AMQ-6815&lt;/del&gt;&lt;/a&gt; rework to drop the batch reference from Location such that batches are free for gc when index pages are agressively cached&lt;/p&gt;</comment>
                            <comment id="16322176" author="christopher.l.shannon" created="Thu, 11 Jan 2018 13:03:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt; - thanks for fixing this memory leak...I actually saw an OOM error because of this a couple weeks ago before vacation but I didn&apos;t get a chance to get back to investigating it yet.  &lt;/p&gt;</comment>
                            <comment id="16322192" author="jira-bot" created="Thu, 11 Jan 2018 13:25:55 +0000"  >&lt;p&gt;Commit d8f8ae9f925b905968c51b386049c5b2d9b6b2d0 in activemq&apos;s branch refs/heads/activemq-5.15.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=d8f8ae9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=d8f8ae9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6815&quot; title=&quot;KahaDB checkpoint needs to fail fast in the event of journal write failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6815&quot;&gt;&lt;del&gt;AMQ-6815&lt;/del&gt;&lt;/a&gt; rework to drop the batch reference from Location such that batches are free for gc when index pages are agressively cached&lt;/p&gt;

&lt;p&gt;(cherry picked from commit ec6fa190999160676cab900038b268b2d40a4d5c)&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13534602">AMQ-9254</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 44 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3k8pj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>