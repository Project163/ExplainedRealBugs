<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:31:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-725] Messages Sent by JMS that contain header properties cause error when STOMP client registers a Subscriber</title>
                <link>https://issues.apache.org/jira/browse/AMQ-725</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;I am using the lastest 4.0 release build of ActiveMQ and I have been trying to produce messages in a JMS client and receive the messages in a STOMP client.&lt;/p&gt;

&lt;p&gt;What I have found is that if the JMS Client adds header properties to the message to be delivered to ActiveMQ then when I subscribe with the STOMP client I am receiving the Error listed below.  If I remove all header properties then the message is transmitted correctly.  I have also found that if I send messages with a STOMP client that has header properties then everything works correctly.&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
at java.util.Hashtable.put(Unknown Source)&lt;br/&gt;
at java.util.Hashtable.putAll(Unknown Source)&lt;br/&gt;
at org.apache.activemq.transport.stomp.FrameBuilder.addHeaders(FrameBuilder.java:65)&lt;br/&gt;
at org.apache.activemq.transport.stomp.Subscription.receive(Subscription.java:76)&lt;br/&gt;
at org.apache.activemq.transport.stomp.StompWireFormat.writeCommand(StompWireFormat.java:154)&lt;br/&gt;
at org.apache.activemq.transport.stomp.StompWireFormat.marshal(StompWireFormat.java:305)&lt;br/&gt;
at org.apache.activemq.transport.tcp.TcpTransport.oneway(TcpTransport.java:124)&lt;br/&gt;
at org.apache.activemq.transport.InactivityMonitor.oneway(InactivityMonitor.java:141)&lt;br/&gt;
at org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:44)&lt;br/&gt;
at org.apache.activemq.transport.ResponseCorrelator.oneway(ResponseCorrelator.java:60)&lt;br/&gt;
at org.apache.activemq.broker.TransportConnection.dispatch(TransportConnection.java:211)&lt;br/&gt;
at org.apache.activemq.broker.AbstractConnection.processDispatch(AbstractConnection.java:581)&lt;br/&gt;
at org.apache.activemq.broker.AbstractConnection.iterate(AbstractConnection.java:597)&lt;br/&gt;
at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:87)&lt;br/&gt;
at org.apache.activemq.thread.DedicatedTaskRunner.access$000(DedicatedTaskRunner.java:24)&lt;br/&gt;
at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:38)&lt;/p&gt;
</description>
                <environment>&lt;p&gt;Running on WinXP with Sun JDK1.5.0_06&lt;/p&gt;</environment>
        <key id="12481708">AMQ-725</key>
            <summary>Messages Sent by JMS that contain header properties cause error when STOMP client registers a Subscriber</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chirino">Hiram R. Chirino</assignee>
                                    <reporter username="wrpkm">William MacDonald</reporter>
                        <labels>
                    </labels>
                <created>Fri, 26 May 2006 02:17:04 +0000</created>
                <updated>Wed, 8 Nov 2006 23:58:03 +0000</updated>
                            <resolved>Mon, 3 Jul 2006 00:00:29 +0000</resolved>
                                    <version>4.0</version>
                                    <fixVersion>4.1.0</fixVersion>
                                    <component>Transport</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12937992" author="chirino" created="Thu, 15 Jun 2006 08:06:19 +0000"  >&lt;p&gt;Lets try to get this fix for the next release.&lt;/p&gt;</comment>
                            <comment id="12938158" author="wrpkm" created="Sun, 2 Jul 2006 07:45:08 +0000"  >&lt;p&gt;I have tested this with the new 4.01 release of ActiveMQ using the default configuration file and I am still having the problem.&lt;/p&gt;

&lt;p&gt;After performing a TCP connections to the Broker on the listener defined as tcp://wrpkmnb:61613?wireFormat=stomp:&lt;/p&gt;

&lt;p&gt;I transmit the connection message:&lt;/p&gt;

&lt;p&gt;CONNECT\010login:billm\010passcode:billm\010client-id:webProcessor\010\010\000&lt;/p&gt;

&lt;p&gt;After which I receive the message:&lt;/p&gt;

&lt;p&gt;CONNECTED\010session:webProcessor\010\010\000\010&lt;/p&gt;

&lt;p&gt;I then try to subscribe to a queue:&lt;/p&gt;

&lt;p&gt;SUBSCRIBE\010destination:/queue/WebRequest\010id:webProcessorconsumer:2\010ack:client\010activemq.prefetchSize:1\010\010\000&lt;/p&gt;

&lt;p&gt;And no response is returned from the Broker but the log shows the following message.&lt;/p&gt;

&lt;p&gt;Exception in thread &quot;ActiveMQ Connection Dispatcher: 28939486&quot; java.lang.NullPointerException&lt;br/&gt;
    at java.util.Hashtable.put(Unknown Source)&lt;br/&gt;
    at java.util.Hashtable.putAll(Unknown Source)&lt;br/&gt;
    at org.apache.activemq.transport.stomp.FrameBuilder.addHeaders(FrameBuilder.java:65)&lt;br/&gt;
    at org.apache.activemq.transport.stomp.Subscription.receive(Subscription.java:76)&lt;br/&gt;
    at org.apache.activemq.transport.stomp.StompWireFormat.writeCommand(StompWireFormat.java:154)&lt;br/&gt;
    at org.apache.activemq.transport.stomp.StompWireFormat.marshal(StompWireFormat.java:305)&lt;br/&gt;
    at org.apache.activemq.transport.tcp.TcpTransport.oneway(TcpTransport.java:124)&lt;br/&gt;
    at org.apache.activemq.transport.InactivityMonitor.oneway(InactivityMonitor.java:141)&lt;br/&gt;
    at org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:44)&lt;br/&gt;
    at org.apache.activemq.transport.ResponseCorrelator.oneway(ResponseCorrelator.java:60)&lt;br/&gt;
    at org.apache.activemq.broker.TransportConnection.dispatch(TransportConnection.java:211)&lt;br/&gt;
    at org.apache.activemq.broker.AbstractConnection.processDispatch(AbstractConnection.java:581)&lt;br/&gt;
    at org.apache.activemq.broker.AbstractConnection.iterate(AbstractConnection.java:597)&lt;br/&gt;
    at org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:87)&lt;br/&gt;
    at org.apache.activemq.thread.DedicatedTaskRunner.access$000(DedicatedTaskRunner.java:24)&lt;br/&gt;
    at org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:38)&lt;/p&gt;

&lt;p&gt;For readability I have replaced the linefeeds with \010 and the nulls with \000 representations.&lt;/p&gt;</comment>
                            <comment id="12937906" author="chirino" created="Mon, 3 Jul 2006 00:00:29 +0000"  >&lt;p&gt;I just tested against 4.1-SNAPSHOT and this is working.&lt;/p&gt;</comment>
                            <comment id="12938527" author="wrpkm" created="Wed, 8 Nov 2006 23:58:02 +0000"  >
&lt;p&gt;   [[ Old comment, sent by email on Tue, 20 Jun 2006 19:17:14 +0000 ]]&lt;/p&gt;

&lt;p&gt;Hiram,&lt;/p&gt;

&lt;p&gt;Sorry for the delay in responding, I have been out of the country.&lt;/p&gt;

&lt;p&gt;I will put together a test case, in the next day or so, showing the data &lt;br/&gt;
transmitted to and from the broker as I am not using the standard Stomp &lt;br/&gt;
clients, I have implemented a Stomp client in the Progress 4GL programming &lt;br/&gt;
language.&lt;/p&gt;

&lt;p&gt;William MacDonald&lt;br/&gt;
Ontario, Canada&lt;/p&gt;
</comment>
                            <comment id="12938562" author="wrpkm" created="Wed, 8 Nov 2006 23:58:03 +0000"  >
&lt;p&gt;   [[ Old comment, sent by email on Sat, 01 Jul 2006 20:53:00 -0400 ]]&lt;/p&gt;

&lt;p&gt;I have tested this with the new 4.01 release of ActiveMQ using the&lt;br/&gt;
default configuration file and I am still having the problem.&lt;/p&gt;

&lt;p&gt;After performing a TCP connections to the Broker on the listener defined&lt;br/&gt;
as tcp://wrpkmnb:61613?wireFormat=stomp:&lt;/p&gt;

&lt;p&gt;I transmit the connection message:&lt;/p&gt;

&lt;p&gt;&lt;b&gt;CONNECT\010login:billm\010passcode:billm\010client-id:webProcessor\010\010\000&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;After which I receive the message:&lt;br/&gt;
*&lt;br/&gt;
CONNECTED\010session:webProcessor\010\010\000\010*&lt;/p&gt;

&lt;p&gt;I then try to subscribe to a queue:&lt;/p&gt;

&lt;p&gt;&lt;b&gt;SUBSCRIBE\010destination:/queue/WebRequest\010id:webProcessorconsumer:2\010ack:client\010activemq.prefetchSize:1\010\010\000&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;And no response is returned from the Broker but the log shows the&lt;br/&gt;
following message.&lt;/p&gt;

&lt;p&gt;*Exception in thread &quot;ActiveMQ Connection Dispatcher: 28939486&quot;&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
    at java.util.Hashtable.put(Unknown Source)&lt;br/&gt;
    at java.util.Hashtable.putAll(Unknown Source)&lt;br/&gt;
    at&lt;br/&gt;
org.apache.activemq.transport.stomp.FrameBuilder.addHeaders(FrameBuilder.java:65)&lt;br/&gt;
    at&lt;br/&gt;
org.apache.activemq.transport.stomp.Subscription.receive(Subscription.java:76)&lt;br/&gt;
    at&lt;br/&gt;
org.apache.activemq.transport.stomp.StompWireFormat.writeCommand(StompWireFormat.java:154)&lt;br/&gt;
    at&lt;br/&gt;
org.apache.activemq.transport.stomp.StompWireFormat.marshal(StompWireFormat.java:305)&lt;br/&gt;
    at&lt;br/&gt;
org.apache.activemq.transport.tcp.TcpTransport.oneway(TcpTransport.java:124)&lt;br/&gt;
    at&lt;br/&gt;
org.apache.activemq.transport.InactivityMonitor.oneway(InactivityMonitor.java:141)&lt;br/&gt;
    at&lt;br/&gt;
org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:44)&lt;br/&gt;
    at&lt;br/&gt;
org.apache.activemq.transport.ResponseCorrelator.oneway(ResponseCorrelator.java:60)&lt;br/&gt;
    at&lt;br/&gt;
org.apache.activemq.broker.TransportConnection.dispatch(TransportConnection.java:211)&lt;br/&gt;
    at&lt;br/&gt;
org.apache.activemq.broker.AbstractConnection.processDispatch(AbstractConnection.java:581)&lt;br/&gt;
    at&lt;br/&gt;
org.apache.activemq.broker.AbstractConnection.iterate(AbstractConnection.java:597)&lt;br/&gt;
    at&lt;br/&gt;
org.apache.activemq.thread.DedicatedTaskRunner.runTask(DedicatedTaskRunner.java:87)&lt;br/&gt;
    at&lt;br/&gt;
org.apache.activemq.thread.DedicatedTaskRunner.access$000(DedicatedTaskRunner.java:24)&lt;br/&gt;
    at&lt;br/&gt;
org.apache.activemq.thread.DedicatedTaskRunner$1.run(DedicatedTaskRunner.java:38)*&lt;/p&gt;

&lt;p&gt;For readability I have replaced the linefeeds with \010 and the nulls&lt;br/&gt;
with \000 representations.&lt;/p&gt;

&lt;p&gt;William&lt;/p&gt;

</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>84347</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 3 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0rzp3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161427</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>