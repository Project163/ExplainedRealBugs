<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:01:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-4677] LevelDB can&apos;t move all message data logs that are no longer used</title>
                <link>https://issues.apache.org/jira/browse/AMQ-4677</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Producers and consumers of a single thread to send and consume 50,000 messages, each message size is 600K, capacity of 28G or so;&lt;/p&gt;

&lt;p&gt;Problem: after the message is sent and consumption, there are 7G about the file is not clear.&lt;/p&gt;

&lt;p&gt;By the way, kahaDB have an attribute &quot;cleanupInterval&quot;, Why levelDB without this?&lt;/p&gt;</description>
                <environment>&lt;p&gt;OS:&lt;br/&gt;
Windows 7 Professional&lt;/p&gt;

&lt;p&gt;MQ:&lt;br/&gt;
&amp;lt;persistenceAdapter&amp;gt;&lt;br/&gt;
    &amp;lt;levelDB directory=&quot;D:/temp/levelDB&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/persistenceAdapter&amp;gt;&lt;/p&gt;
</environment>
        <key id="12663008">AMQ-4677</key>
            <summary>LevelDB can&apos;t move all message data logs that are no longer used</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="kearls">Kevin Anthony Earls</assignee>
                                    <reporter username="hank.hua">Hank.X.Hua</reporter>
                        <labels>
                    </labels>
                <created>Sat, 10 Aug 2013 01:17:02 +0000</created>
                <updated>Tue, 31 Jan 2017 19:43:27 +0000</updated>
                            <resolved>Tue, 31 Jan 2017 19:43:27 +0000</resolved>
                                    <version>5.8.0</version>
                                    <fixVersion>5.x</fixVersion>
                                    <component>LevelDB</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="13739692" author="tabish121" created="Wed, 14 Aug 2013 14:10:09 +0000"  >&lt;p&gt;LevelDB works quite a bit differently from KahaDB.  Compaction occurs in a much more lazy manner however you can force a compaction by acquiring the LevelDB MBean and calling the compact method.  &lt;/p&gt;</comment>
                            <comment id="13740800" author="hank.hua" created="Thu, 15 Aug 2013 08:19:21 +0000"  >&lt;p&gt;I found the compaction occurs,but it only make the data log file increase slowly,after activemq runs a long time the data log file will increase very big (above 7G) and increase continuously.I want the activemq can move all message data logs that are no longer used as kahaDB works.&lt;br/&gt;
Thanks for your help.&lt;/p&gt;</comment>
                            <comment id="13741485" author="tabish121" created="Thu, 15 Aug 2013 21:12:37 +0000"  >&lt;p&gt;Attached is a test case that shows that against the latest 5.9-SNAPSHOT the level db data is cleared as expected.  &lt;/p&gt;</comment>
                            <comment id="13741486" author="tabish121" created="Thu, 15 Aug 2013 21:13:16 +0000"  >&lt;p&gt;Created a test case that verifies that trunk leveldb store cleans up as the data is consumed from the store.&lt;/p&gt;</comment>
                            <comment id="13742055" author="hank.hua" created="Fri, 16 Aug 2013 09:21:17 +0000"  >&lt;p&gt;Thanks for your help. I will wait for the official 5.9 version, and now I use kahaDB&lt;/p&gt;</comment>
                            <comment id="13802667" author="hank.hua" created="Wed, 23 Oct 2013 07:27:11 +0000"  >&lt;p&gt;In ActiveMQ 5.9.0,leveldb store can&apos;t cleans up all as the data is consumed from the store when send messages faster than the rate of consumption.Stop sending messages, the message is consumed when finished, there are many DataLog not cleared.&lt;/p&gt;</comment>
                            <comment id="13803895" author="hank.hua" created="Thu, 24 Oct 2013 06:22:18 +0000"  >&lt;p&gt;Another scene, first send 2000 messages to the MQ, each message 428kb, stop sending the message, when  the messages all be consumed,more than 400mb of DataLog not cleared&lt;/p&gt;</comment>
                            <comment id="13803987" author="lionel.cons" created="Thu, 24 Oct 2013 08:38:36 +0000"  >&lt;p&gt;This seems related to &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-4810&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-4810&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Note the Apollo issue linked from &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-4810&quot; title=&quot;LevelDB store does not seem to garbage collect its files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-4810&quot;&gt;&lt;del&gt;AMQ-4810&lt;/del&gt;&lt;/a&gt;...&lt;/p&gt;</comment>
                            <comment id="13931495" author="hank.hua" created="Wed, 12 Mar 2014 07:51:04 +0000"  >&lt;p&gt;Windows hava this problem,linux is right.&lt;/p&gt;</comment>
                            <comment id="14239215" author="barthv" created="Tue, 9 Dec 2014 09:58:08 +0000"  >&lt;p&gt;+1&lt;br/&gt;
&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;http://reho.st/self/13d16a568bef4156da7793ef3da28f08642890d9.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="15847383" author="tabish121" created="Tue, 31 Jan 2017 19:43:27 +0000"  >&lt;p&gt;LevelDB is deprecated and no longer maintained.  &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12598295" name="AMQ4677Test.java" size="6399" author="tabish" created="Thu, 15 Aug 2013 21:12:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>343010</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 42 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1n5k7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>343314</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>