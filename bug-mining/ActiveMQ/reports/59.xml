<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:30:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-689] Endpoint failed to process message: NullPointerException</title>
                <link>https://issues.apache.org/jira/browse/AMQ-689</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;I have redelivery configured, but when it fails in all attempts (through a RuntimeException), I get the following message:&lt;/p&gt;

&lt;p&gt;11:00:54,775 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ServerSessionImpl:0&amp;#93;&lt;/span&gt; Endpoint failed to process message.&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
	at org.apache.activemq.ra.ServerSessionImpl.afterDelivery(ServerSessionImpl.java:218)&lt;br/&gt;
	at org.apache.activemq.ActiveMQSession.run(ActiveMQSession.java:723)&lt;br/&gt;
	at org.apache.activemq.ra.ServerSessionImpl.run(ServerSessionImpl.java:163)&lt;br/&gt;
	at org.apache.geronimo.connector.work.WorkerContext.run(WorkerContext.java:291)&lt;br/&gt;
	at EDU.oswego.cs.dl.util.concurrent.PooledExecutor$Worker.run(Unknown Source)&lt;br/&gt;
	at java.lang.Thread.run(Unknown Source)&lt;br/&gt;
11:00:54,775 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;ServerSessionImpl:0&amp;#93;&lt;/span&gt; Endpoint failed to process message. Reason: java.lang.NullPointerException&lt;br/&gt;
11:00:54,775 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ServerSessionImpl:0&amp;#93;&lt;/span&gt; run loop end&lt;br/&gt;
11:00:54,775 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ServerSessionImpl:0&amp;#93;&lt;/span&gt; Endpoint did not release properly: org.apache.activemq.ra.InvalidMessageEndpointException&lt;br/&gt;
org.apache.activemq.ra.InvalidMessageEndpointException&lt;br/&gt;
	at org.apache.activemq.ra.MessageEndpointProxy$MessageEndpointDead.release(MessageEndpointProxy.java:156)&lt;br/&gt;
	at org.apache.activemq.ra.MessageEndpointProxy.release(MessageEndpointProxy.java:68)&lt;br/&gt;
	at org.apache.activemq.ra.ServerSessionImpl.close(ServerSessionImpl.java:250)&lt;br/&gt;
	at org.apache.activemq.ra.ServerSessionPoolImpl.removeFromPool(ServerSessionPoolImpl.java:180)&lt;br/&gt;
	at org.apache.activemq.ra.ServerSessionImpl.run(ServerSessionImpl.java:177)&lt;br/&gt;
	at org.apache.geronimo.connector.work.WorkerContext.run(WorkerContext.java:291)&lt;br/&gt;
	at EDU.oswego.cs.dl.util.concurrent.PooledExecutor$Worker.run(Unknown Source)&lt;br/&gt;
	at java.lang.Thread.run(Unknown Source)&lt;br/&gt;
11:00:54,775 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ServerSessionImpl:0&amp;#93;&lt;/span&gt; Run finished&lt;br/&gt;
11:00:54,775 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ServerSessionImpl:0&amp;#93;&lt;/span&gt; Work completed: javax.resource.spi.work.WorkEvent&lt;span class=&quot;error&quot;&gt;&amp;#91;source=Work :ServerSessionImpl:0&amp;#93;&lt;/span&gt;&lt;br/&gt;
11:00:54,790 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ServerSessionPoolImpl&amp;#93;&lt;/span&gt; ServerSession requested.&lt;/p&gt;

&lt;p&gt;The code that throws this NPE is ServerSessionImpl, whose excerpt I send below. There are more reports of this &lt;/p&gt;

&lt;p&gt;            try &lt;/p&gt;
{
                endpoint.afterDelivery();
            }
&lt;p&gt; catch (Throwable e) &lt;/p&gt;
{
                throw new RuntimeException(&quot;Endpoint after delivery notification failure&quot;, e);
            }
&lt;p&gt; finally {&lt;br/&gt;
                if( session.getTransactionContext().isInLocalTransaction() ) { &amp;lt;&amp;lt;&amp;lt;&amp;lt;--------------------------- NPE&lt;br/&gt;
                    if( !useRAManagedTx ) &lt;/p&gt;
{
                        // Sanitiy Check: If the local transaction has not been commited..
                        // Commit it now.
                        log.warn(&quot;Local transaction had not been commited.  Commiting now.&quot;);
                    }
&lt;p&gt;                    try &lt;/p&gt;
{
                        session.commit();
                    }
&lt;p&gt; catch (JMSException e) &lt;/p&gt;
{
                        log.info(&quot;Commit failed:&quot;, e);
                    }
&lt;p&gt;                }&lt;br/&gt;
            }&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows XP SP2, Eclipse, Tomcat 5.5.15, Spring 1.2.6, Hibernate 3.1.2, Jencks 1.1.3, ActiveMQ 4.0 RC2 and SNAPSHOT (Apr 6th 2006)&lt;/p&gt;</environment>
        <key id="12481637">AMQ-689</key>
            <summary>Endpoint failed to process message: NullPointerException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="rcastro">Rodrigo De Castro</reporter>
                        <labels>
                    </labels>
                <created>Sat, 15 Apr 2006 18:16:43 +0000</created>
                <updated>Mon, 22 May 2006 17:39:27 +0000</updated>
                            <resolved>Mon, 22 May 2006 17:39:27 +0000</resolved>
                                    <version>4.0 RC2</version>
                                    <fixVersion>4.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12937873" author="jstrachan" created="Mon, 22 May 2006 17:39:27 +0000"  >&lt;p&gt;thanks for spotting this one&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>84299</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 28 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i17zlj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>254737</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>