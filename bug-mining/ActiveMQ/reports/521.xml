<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:39:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-2052] unsubscribing a durable subscriber does not properly clean up undelivered messages</title>
                <link>https://issues.apache.org/jira/browse/AMQ-2052</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Working on the tck I found a lot of messages like &lt;br/&gt;
2008-12-25 11:37:08,567 ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;RecoveryListenerAdapter&amp;#93;&lt;/span&gt; Message id ID:pb.local-56923-1230232035140-2:13:1:1:1 could not be recovered from the data store - already dispatched&lt;br/&gt;
in the log.  I can reproduce this with the attached test case (It could probably be in a better module, but I started looking here.)&lt;/p&gt;

&lt;p&gt;To see the error put a breakpoint at RecoveryListenerAdapter line 61 and run the test.  The required steps to reproduce seem to be:&lt;/p&gt;

&lt;p&gt;1. create a durable subscriber on a topic.&lt;br/&gt;
2. send a message to the topic.&lt;br/&gt;
3. close the subscriber and unsubscribe.&lt;br/&gt;
4. create a new durable subscriber on the same topic.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12482865">AMQ-2052</key>
            <summary>unsubscribing a durable subscriber does not properly clean up undelivered messages</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="djencks">David Jencks</assignee>
                                    <reporter username="djencks">David Jencks</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Jan 2009 12:10:21 +0000</created>
                <updated>Thu, 3 Sep 2009 15:51:07 +0000</updated>
                            <resolved>Thu, 3 Sep 2009 15:51:07 +0000</resolved>
                                    <version>5.3.0</version>
                                    <fixVersion>5.3.0</fixVersion>
                                    <component>Message Store</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12940611" author="djencks" created="Thu, 1 Jan 2009 12:15:44 +0000"  >&lt;p&gt;Test case to deomonstrate the problem.  Note that the test passes, you have to put a breakpoint to see the problem.&lt;/p&gt;</comment>
                            <comment id="12940602" author="djencks" created="Thu, 1 Jan 2009 20:18:57 +0000"  >&lt;p&gt;The actual problem causing this is confusion over when to use a file-system-safened ID.  Fixed in rev 730596.&lt;/p&gt;

&lt;p&gt;I&apos;m also changing the RecoveryListenerAdapter to throw an exception when it gets into this inconsistent state. Rev 730598.&lt;/p&gt;

&lt;p&gt;I may try to simplify when and where the file system safening occurs.  I also plan to move the test case to a better location.&lt;/p&gt;</comment>
                            <comment id="12940623" author="djencks" created="Thu, 1 Jan 2009 20:28:21 +0000"  >&lt;p&gt;Code inspection shows there are still a lot more confusions about when to use a file system safened name.&lt;/p&gt;</comment>
                            <comment id="12940620" author="djencks" created="Thu, 1 Jan 2009 21:44:48 +0000"  >&lt;p&gt;I think rev 730614 is an OK fix.... still need the test case.&lt;/p&gt;</comment>
                            <comment id="12940639" author="djencks" created="Fri, 2 Jan 2009 19:12:17 +0000"  >&lt;p&gt;One more major file name problem... rev 730817.  Surprisingly this only caused 13 test failures.&lt;/p&gt;</comment>
                            <comment id="12941510" author="jet3723" created="Fri, 19 Jun 2009 13:57:40 +0000"  >&lt;p&gt;What is the work around after the store gets into this state? Is there one?&lt;/p&gt;</comment>
                            <comment id="12941636" author="gtully" created="Thu, 25 Jun 2009 16:22:54 +0000"  >&lt;p&gt;David, are you done with this or is there more work needed to get the tck passing?&lt;/p&gt;</comment>
                            <comment id="12941652" author="djencks" created="Thu, 3 Sep 2009 15:51:07 +0000"  >&lt;p&gt;I&apos;ve fixed all the problems I can find related to this so I&apos;m closing this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12461281" name="AMQ-2052-test.patch" size="3903" author="djencks" created="Thu, 1 Jan 2009 12:15:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>75101</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 12 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0tsof:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>171955</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>