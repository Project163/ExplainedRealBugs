<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:36:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-1705] Deadlock between VMTransport and QueueThread</title>
                <link>https://issues.apache.org/jira/browse/AMQ-1705</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;After restarting the central broker in a simple network of brokers, which consists of one central  standalone broker and multiple embedded broker, each intercepting one jms consumer, all producers run into a deadlock.&lt;/p&gt;

&lt;p&gt;&quot;VMTransport&quot; daemon prio=3 tid=0x093bd000 nid=0x901 waiting for monitor entry &lt;span class=&quot;error&quot;&gt;&amp;#91;0xa30d5000..0xa30d5af0&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: BLOCKED (on object monitor)&lt;br/&gt;
        at org.apache.activemq.broker.region.PrefetchSubscription.add(PrefetchSubscription.java:450)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting to lock &amp;lt;0xdb314578&amp;gt; (a java.lang.Object)&lt;br/&gt;
        at org.apache.activemq.broker.region.Queue.addSubscription(Queue.java:210)&lt;br/&gt;
        at org.apache.activemq.broker.region.AbstractRegion.addConsumer(AbstractRegion.java:265)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0xaf37ca60&amp;gt; (a java.lang.Object)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0xdb0c36f0&amp;gt; (a java.lang.Object)&lt;br/&gt;
        at org.apache.activemq.broker.region.RegionBroker.addConsumer(RegionBroker.java:380)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.addConsumer(BrokerFilter.java:85)&lt;br/&gt;
        at org.apache.activemq.advisory.AdvisoryBroker.addConsumer(AdvisoryBroker.java:83)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.addConsumer(BrokerFilter.java:85)&lt;br/&gt;
        at org.apache.activemq.broker.MutableBrokerFilter.addConsumer(MutableBrokerFilter.java:92)&lt;br/&gt;
        at org.apache.activemq.broker.TransportConnection.processAddConsumer(TransportConnection.java:529)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&quot;QueueThread:queue://de.gameduell.service.user.UserCache.MessageQueue&quot; daemon prio=3 tid=0x086b8000 nid=0x25 waiting for monitor entry [0xa2fdf000..0xa2fdf8f&lt;br/&gt;
0]&lt;br/&gt;
   java.lang.Thread.State: BLOCKED (on object monitor)&lt;br/&gt;
        at org.apache.activemq.broker.region.AbstractRegion.lookup(AbstractRegion.java:367)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting to lock &amp;lt;0xaf37ca60&amp;gt; (a java.lang.Object)&lt;br/&gt;
        at org.apache.activemq.broker.region.AbstractRegion.send(AbstractRegion.java:332)&lt;br/&gt;
        at org.apache.activemq.broker.region.RegionBroker.send(RegionBroker.java:445)&lt;br/&gt;
        at org.apache.activemq.broker.TransactionBroker.send(TransactionBroker.java:224)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.send(BrokerFilter.java:125)&lt;br/&gt;
        at org.apache.activemq.broker.CompositeDestinationBroker.send(CompositeDestinationBroker.java:95)&lt;br/&gt;
        at org.apache.activemq.broker.MutableBrokerFilter.send(MutableBrokerFilter.java:132)&lt;br/&gt;
        at org.apache.activemq.util.BrokerSupport.resend(BrokerSupport.java:56)&lt;br/&gt;
        at org.apache.activemq.broker.region.RegionBroker.sendToDeadLetterQueue(RegionBroker.java:712)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.sendToDeadLetterQueue(BrokerFilter.java:257)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.sendToDeadLetterQueue(BrokerFilter.java:257)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.sendToDeadLetterQueue(BrokerFilter.java:257)&lt;br/&gt;
        at org.apache.activemq.broker.MutableBrokerFilter.sendToDeadLetterQueue(MutableBrokerFilter.java:270)&lt;br/&gt;
        at org.apache.activemq.broker.region.RegionBroker.messageExpired(RegionBroker.java:679)&lt;br/&gt;
        at org.apache.activemq.broker.region.PrefetchSubscription.dispatchPending(PrefetchSubscription.java:491)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0xdb314578&amp;gt; (a java.lang.Object)&lt;br/&gt;
        at org.apache.activemq.broker.region.PrefetchSubscription.add(PrefetchSubscription.java:144)&lt;br/&gt;
        at org.apache.activemq.broker.region.Queue.iterate(Queue.java:929)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0xaf905fc8&amp;gt; (a org.apache.activemq.broker.region.Queue$2)&lt;br/&gt;
        at org.apache.activemq.thread.DeterministicTaskRunner.runTask(DeterministicTaskRunner.java:84)&lt;br/&gt;
        at org.apache.activemq.thread.DeterministicTaskRunner$1.run(DeterministicTaskRunner.java:41)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;the full jstack output and bot broker configs are attached.&lt;br/&gt;
activemq.xml is the config of the central broker.&lt;br/&gt;
activemq-embedded.xml is the config of the embbed one.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Active MQ 5.1.0-RC2&lt;br/&gt;
java version &quot;1.6.0_04&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.6.0_04-b12)&lt;br/&gt;
Java HotSpot(TM) Server VM (build 10.0-b19, mixed mode)&lt;br/&gt;
Solaris 10&lt;/p&gt;</environment>
        <key id="12482470">AMQ-1705</key>
            <summary>Deadlock between VMTransport and QueueThread</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rajdavies">Robert Davies</assignee>
                                    <reporter username="cw_krebs">Carsten Krebs</reporter>
                        <labels>
                    </labels>
                <created>Wed, 30 Apr 2008 15:48:29 +0000</created>
                <updated>Thu, 1 May 2008 06:33:21 +0000</updated>
                            <resolved>Thu, 1 May 2008 06:33:21 +0000</resolved>
                                    <version>5.1.0</version>
                                    <fixVersion>5.2.0</fixVersion>
                                    <component>Transport</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12939613" author="rajdavies" created="Thu, 1 May 2008 06:33:21 +0000"  >&lt;p&gt;Fixed by SVN revision 652438&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12461002" name="ASF.LICENSE.NOT.GRANTED--activemq-embedded.xml" size="2114" author="cw_krebs" created="Wed, 30 Apr 2008 15:48:29 +0000"/>
                            <attachment id="12460981" name="ASF.LICENSE.NOT.GRANTED--activemq.xml" size="1940" author="cw_krebs" created="Wed, 30 Apr 2008 15:48:29 +0000"/>
                            <attachment id="12461074" name="ASF.LICENSE.NOT.GRANTED--jstack.log" size="104116" author="cw_krebs" created="Wed, 30 Apr 2008 15:48:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>84795</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 30 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0s1xb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161788</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>