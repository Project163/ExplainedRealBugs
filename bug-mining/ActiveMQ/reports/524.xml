<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:39:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-2053] AMQMessageStore.flushLatch can apparently get stuck</title>
                <link>https://issues.apache.org/jira/browse/AMQ-2053</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;A couple hours into the tck I see everything freeze.  Looking at the threads there are a lot of waits on Queue.dispatchLock in addSubscription but one thread made it through to AMQMessageStore and is waiting at line 316 in flush on the countdown latch.&lt;/p&gt;

&lt;p&gt;Only problem I can see causing this so far is the countdown in asyncWrite not being in a finally block.  I don&apos;t see any exceptions in the log.... so not sure yet.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12482753">AMQ-2053</key>
            <summary>AMQMessageStore.flushLatch can apparently get stuck</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="djencks">David Jencks</assignee>
                                    <reporter username="djencks">David Jencks</reporter>
                        <labels>
                    </labels>
                <created>Sun, 4 Jan 2009 01:41:58 +0000</created>
                <updated>Wed, 7 Jan 2009 08:11:27 +0000</updated>
                            <resolved>Wed, 7 Jan 2009 08:11:27 +0000</resolved>
                                    <version>5.3.0</version>
                                    <fixVersion>5.3.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                                                            <comments>
                            <comment id="12940643" author="djencks" created="Wed, 7 Jan 2009 07:54:47 +0000"  >&lt;p&gt;Problem is that the AMQMessageStore is closed but not removed from the cache inside the PersistenceAdapter.  Next time a Queue (or Topic) is created it gets the stopped and unusable message store from the cache.&lt;/p&gt;

&lt;p&gt;After chatting with Hiram on the dev list I think introducing methods to remove the message store from the persistence adapter is the best way forward.&lt;/p&gt;

&lt;p&gt;Looking at svn history this problem was introduced in the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-1842&quot; title=&quot;HashIndex leaks file handles when destination is removed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-1842&quot;&gt;&lt;del&gt;AMQ-1842&lt;/del&gt;&lt;/a&gt;, rev 729939, where the calls to stop the MessageStore were introduced.&lt;/p&gt;</comment>
                            <comment id="12940632" author="djencks" created="Wed, 7 Jan 2009 07:57:03 +0000"  >&lt;p&gt;Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-1842&quot; title=&quot;HashIndex leaks file handles when destination is removed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-1842&quot;&gt;&lt;del&gt;AMQ-1842&lt;/del&gt;&lt;/a&gt; introduced this problem... message stores were closed (good) but not removed from persistence adapter cache (bad)&lt;/p&gt;</comment>
                            <comment id="12940627" author="djencks" created="Wed, 7 Jan 2009 08:11:27 +0000"  >&lt;p&gt;New methods introduced in rev 732259.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                            <subtask id="12482726">AMQ-1842</subtask>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>75100</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 46 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14bx3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>233394</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>