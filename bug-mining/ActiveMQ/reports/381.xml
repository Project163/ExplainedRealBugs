<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:37:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-1788] deadlock on message expiration</title>
                <link>https://issues.apache.org/jira/browse/AMQ-1788</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Detected deadlock in AMQ 5.1.0 between transport thread (removing consumer) and QueueThread (sending expired messages to DLQ): &lt;/p&gt;

&lt;p&gt;Name: VMTransport &lt;br/&gt;
State: BLOCKED on java.lang.Object@7176e6 owned by: QueueThread:queue://some_queue &lt;br/&gt;
Total blocked: 31  Total waited: 525 &lt;/p&gt;

&lt;p&gt;Stack trace: &lt;br/&gt;
at org.apache.activemq.broker.region.PrefetchSubscription.remove(PrefetchSubscription.java:463) &lt;br/&gt;
at org.apache.activemq.broker.region.Queue.removeSubscription(Queue.java:300) &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;locked java.util.ArrayList@14aa305&lt;br/&gt;
at org.apache.activemq.broker.region.AbstractRegion.removeConsumer(AbstractRegion.java:313) &lt;/li&gt;
	&lt;li&gt;locked java.lang.Object@da6a6b&lt;br/&gt;
at org.apache.activemq.broker.region.RegionBroker.removeConsumer(RegionBroker.java:400) &lt;br/&gt;
at org.apache.activemq.broker.BrokerFilter.removeConsumer(BrokerFilter.java:113) &lt;br/&gt;
at org.apache.activemq.advisory.AdvisoryBroker.removeConsumer(AdvisoryBroker.java:222) &lt;br/&gt;
at org.apache.activemq.broker.BrokerFilter.removeConsumer(BrokerFilter.java:113) &lt;br/&gt;
at org.apache.activemq.broker.MutableBrokerFilter.removeConsumer(MutableBrokerFilter.java:120) &lt;br/&gt;
at org.apache.activemq.broker.TransportConnection.processRemoveConsumer(TransportConnection.java:552) &lt;br/&gt;
at org.apache.activemq.command.RemoveInfo.visit(RemoveInfo.java:64) &lt;br/&gt;
at org.apache.activemq.broker.TransportConnection.service(TransportConnection.java:292) &lt;br/&gt;
at org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:180) &lt;br/&gt;
at org.apache.activemq.transport.ResponseCorrelator.onCommand(ResponseCorrelator.java:104) &lt;br/&gt;
at org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:68) &lt;br/&gt;
at org.apache.activemq.transport.vm.VMTransport.iterate(VMTransport.java:205) &lt;br/&gt;
at org.apache.activemq.thread.PooledTaskRunner.runTask(PooledTaskRunner.java:122) &lt;br/&gt;
at org.apache.activemq.thread.PooledTaskRunner$1.run(PooledTaskRunner.java:43) &lt;br/&gt;
java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) &lt;br/&gt;
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) &lt;br/&gt;
java.lang.Thread.run(Thread.java:619) &lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Name: QueueThread:queue://some_queue &lt;br/&gt;
State: BLOCKED on java.lang.Object@da6a6b owned by: VMTransport &lt;br/&gt;
Total blocked: 107  Total waited: 1.363 &lt;/p&gt;

&lt;p&gt;Stack trace: &lt;br/&gt;
at org.apache.activemq.broker.region.AbstractRegion.lookup(AbstractRegion.java:372) &lt;br/&gt;
at org.apache.activemq.broker.region.AbstractRegion.send(AbstractRegion.java:336) &lt;br/&gt;
at org.apache.activemq.broker.region.RegionBroker.send(RegionBroker.java:445) &lt;br/&gt;
at org.apache.activemq.broker.TransactionBroker.send(TransactionBroker.java:224) &lt;br/&gt;
at org.apache.activemq.broker.BrokerFilter.send(BrokerFilter.java:125) &lt;br/&gt;
at org.apache.activemq.broker.CompositeDestinationBroker.send(CompositeDestinationBroker.java:95) &lt;br/&gt;
at org.apache.activemq.broker.MutableBrokerFilter.send(MutableBrokerFilter.java:132) &lt;br/&gt;
at org.apache.activemq.util.BrokerSupport.resend(BrokerSupport.java:56) &lt;br/&gt;
at org.apache.activemq.broker.region.RegionBroker.sendToDeadLetterQueue(RegionBroker.java:712) &lt;br/&gt;
at org.apache.activemq.broker.BrokerFilter.sendToDeadLetterQueue(BrokerFilter.java:257) &lt;br/&gt;
at org.apache.activemq.broker.BrokerFilter.sendToDeadLetterQueue(BrokerFilter.java:257) &lt;br/&gt;
at org.apache.activemq.broker.BrokerFilter.sendToDeadLetterQueue(BrokerFilter.java:257) &lt;br/&gt;
at org.apache.activemq.broker.MutableBrokerFilter.sendToDeadLetterQueue(MutableBrokerFilter.java:270) &lt;br/&gt;
at org.apache.activemq.broker.region.RegionBroker.messageExpired(RegionBroker.java:679) &lt;br/&gt;
at org.apache.activemq.broker.region.PrefetchSubscription.dispatchPending(PrefetchSubscription.java:496) &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;locked java.lang.Object@7176e6&lt;br/&gt;
at org.apache.activemq.broker.region.PrefetchSubscription.add(PrefetchSubscription.java:144) &lt;br/&gt;
at org.apache.activemq.broker.region.Queue.iterate(Queue.java:936) &lt;/li&gt;
	&lt;li&gt;locked org.apache.activemq.broker.region.Queue$2@e02b5&lt;br/&gt;
at org.apache.activemq.thread.DeterministicTaskRunner.runTask(DeterministicTaskRunner.java:84) &lt;br/&gt;
at org.apache.activemq.thread.DeterministicTaskRunner$1.run(DeterministicTaskRunner.java:41) &lt;br/&gt;
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) &lt;br/&gt;
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) &lt;br/&gt;
at java.lang.Thread.run(Thread.java:619)&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment>&lt;p&gt;Win XP, JVM 1.6&lt;/p&gt;</environment>
        <key id="12482057">AMQ-1788</key>
            <summary>deadlock on message expiration</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rajdavies">Robert Davies</assignee>
                                    <reporter username="mlukica">Mario Lukica</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Jun 2008 17:44:45 +0000</created>
                <updated>Mon, 7 Dec 2009 19:48:56 +0000</updated>
                            <resolved>Wed, 11 Jun 2008 10:36:59 +0000</resolved>
                                    <version>5.1.0</version>
                                    <fixVersion>5.2.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12939814" author="mlukica" created="Tue, 10 Jun 2008 17:56:26 +0000"  >&lt;p&gt;Reposting stack traces without jira formatting:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Name: VMTransport 
State: BLOCKED on java.lang.Object@7176e6 owned by: QueueThread:queue://some_queue 
Total blocked: 31  Total waited: 525 

Stack trace: 
at org.apache.activemq.broker.region.PrefetchSubscription.remove(PrefetchSubscription.java:463) 
at org.apache.activemq.broker.region.Queue.removeSubscription(Queue.java:300) 
   - locked java.util.ArrayList@14aa305 
at org.apache.activemq.broker.region.AbstractRegion.removeConsumer(AbstractRegion.java:313) 
   - locked java.lang.Object@da6a6b 
at org.apache.activemq.broker.region.RegionBroker.removeConsumer(RegionBroker.java:400) 
at org.apache.activemq.broker.BrokerFilter.removeConsumer(BrokerFilter.java:113) 
at org.apache.activemq.advisory.AdvisoryBroker.removeConsumer(AdvisoryBroker.java:222) 
at org.apache.activemq.broker.BrokerFilter.removeConsumer(BrokerFilter.java:113) 
at org.apache.activemq.broker.MutableBrokerFilter.removeConsumer(MutableBrokerFilter.java:120) 
at org.apache.activemq.broker.TransportConnection.processRemoveConsumer(TransportConnection.java:552) 
at org.apache.activemq.command.RemoveInfo.visit(RemoveInfo.java:64) 
at org.apache.activemq.broker.TransportConnection.service(TransportConnection.java:292) 
at org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:180) 
at org.apache.activemq.transport.ResponseCorrelator.onCommand(ResponseCorrelator.java:104) 
at org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:68) 
at org.apache.activemq.transport.vm.VMTransport.iterate(VMTransport.java:205) 
at org.apache.activemq.thread.PooledTaskRunner.runTask(PooledTaskRunner.java:122) 
at org.apache.activemq.thread.PooledTaskRunner$1.run(PooledTaskRunner.java:43) 
java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) 
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) 
java.lang.Thread.run(Thread.java:619) 

Name: QueueThread:queue://some_queue 
State: BLOCKED on java.lang.Object@da6a6b owned by: VMTransport 
Total blocked: 107  Total waited: 1.363 

Stack trace: 
at org.apache.activemq.broker.region.AbstractRegion.lookup(AbstractRegion.java:372) 
at org.apache.activemq.broker.region.AbstractRegion.send(AbstractRegion.java:336) 
at org.apache.activemq.broker.region.RegionBroker.send(RegionBroker.java:445) 
at org.apache.activemq.broker.TransactionBroker.send(TransactionBroker.java:224) 
at org.apache.activemq.broker.BrokerFilter.send(BrokerFilter.java:125) 
at org.apache.activemq.broker.CompositeDestinationBroker.send(CompositeDestinationBroker.java:95) 
at org.apache.activemq.broker.MutableBrokerFilter.send(MutableBrokerFilter.java:132) 
at org.apache.activemq.util.BrokerSupport.resend(BrokerSupport.java:56) 
at org.apache.activemq.broker.region.RegionBroker.sendToDeadLetterQueue(RegionBroker.java:712) 
at org.apache.activemq.broker.BrokerFilter.sendToDeadLetterQueue(BrokerFilter.java:257) 
at org.apache.activemq.broker.BrokerFilter.sendToDeadLetterQueue(BrokerFilter.java:257) 
at org.apache.activemq.broker.BrokerFilter.sendToDeadLetterQueue(BrokerFilter.java:257) 
at org.apache.activemq.broker.MutableBrokerFilter.sendToDeadLetterQueue(MutableBrokerFilter.java:270) 
at org.apache.activemq.broker.region.RegionBroker.messageExpired(RegionBroker.java:679) 
at org.apache.activemq.broker.region.PrefetchSubscription.dispatchPending(PrefetchSubscription.java:496) 
   - locked java.lang.Object@7176e6 
at org.apache.activemq.broker.region.PrefetchSubscription.add(PrefetchSubscription.java:144) 
at org.apache.activemq.broker.region.Queue.iterate(Queue.java:936) 
   - locked org.apache.activemq.broker.region.Queue$2@e02b5 
at org.apache.activemq.thread.DeterministicTaskRunner.runTask(DeterministicTaskRunner.java:84) 
at org.apache.activemq.thread.DeterministicTaskRunner$1.run(DeterministicTaskRunner.java:41) 
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) 
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) 
at java.lang.Thread.run(Thread.java:619)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12939794" author="rajdavies" created="Wed, 11 Jun 2008 10:36:59 +0000"  >&lt;p&gt;Fixed by SVN revision 666607&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>84771</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 24 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0tszr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>172006</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>