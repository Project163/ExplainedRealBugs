<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:41:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-6811] ReduceMemoryFootprint does not work on messages with no body</title>
                <link>https://issues.apache.org/jira/browse/AMQ-6811</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;I was debugging an out of memory error on a broker that was caused by the unmarshalled message properties being in memory even though the reduceMemoryFootprint flag was set to true so this map should have been cleared after send.  &lt;/p&gt;

&lt;p&gt;Upon further investigation I realized it was because the isMarshalled() method on a message only checks if the marshalled content is not null however the check should actually be if the content is not null OR if the unmarshalled value is null/empty (ie no body set at all).  This same check is already done properly for header properties and just needs to be extended for the body.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13102580">AMQ-6811</key>
            <summary>ReduceMemoryFootprint does not work on messages with no body</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cshannon">Christopher L. Shannon</assignee>
                                    <reporter username="cshannon">Christopher L. Shannon</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 Sep 2017 14:10:22 +0000</created>
                <updated>Fri, 15 Sep 2017 16:22:23 +0000</updated>
                            <resolved>Fri, 15 Sep 2017 14:12:59 +0000</resolved>
                                    <version>5.15.0</version>
                                    <fixVersion>5.15.1</fixVersion>
                    <fixVersion>5.16.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16167914" author="jira-bot" created="Fri, 15 Sep 2017 14:12:14 +0000"  >&lt;p&gt;Commit f82993d9c2315d7ea6c35d164f7665987cdbe1b8 in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cshannon&quot; class=&quot;user-hover&quot; rel=&quot;cshannon&quot;&gt;cshannon&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=f82993d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=f82993d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6811&quot; title=&quot;ReduceMemoryFootprint does not work on messages with no body&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6811&quot;&gt;&lt;del&gt;AMQ-6811&lt;/del&gt;&lt;/a&gt; - fix reduceMemoryFootprint when no message body&lt;/p&gt;

&lt;p&gt;ReduceMemoryFootprint will now properly detect that a message is&lt;br/&gt;
marshalled even if there is no message body so the headers can be&lt;br/&gt;
cleared out after message send&lt;/p&gt;</comment>
                            <comment id="16167916" author="jira-bot" created="Fri, 15 Sep 2017 14:12:53 +0000"  >&lt;p&gt;Commit 01f6aeb0128263408522981cadefd41c9216bfa8 in activemq&apos;s branch refs/heads/activemq-5.15.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cshannon&quot; class=&quot;user-hover&quot; rel=&quot;cshannon&quot;&gt;cshannon&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=01f6aeb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=01f6aeb&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6811&quot; title=&quot;ReduceMemoryFootprint does not work on messages with no body&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6811&quot;&gt;&lt;del&gt;AMQ-6811&lt;/del&gt;&lt;/a&gt; - fix reduceMemoryFootprint when no message body&lt;/p&gt;

&lt;p&gt;ReduceMemoryFootprint will now properly detect that a message is&lt;br/&gt;
marshalled even if there is no message body so the headers can be&lt;br/&gt;
cleared out after message send&lt;/p&gt;

&lt;p&gt;(cherry picked from commit f82993d9c2315d7ea6c35d164f7665987cdbe1b8)&lt;/p&gt;</comment>
                            <comment id="16168101" author="tabish121" created="Fri, 15 Sep 2017 16:16:53 +0000"  >&lt;p&gt;Your unit test somehow ended up in src/main/java ...  which is messing up builds from the command line &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/activemq/blob/master/activemq-client/src/main/java/org/apache/activemq/command/ActiveMQMessageIsMarshalledTest.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/activemq/blob/master/activemq-client/src/main/java/org/apache/activemq/command/ActiveMQMessageIsMarshalledTest.java&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16168108" author="jira-bot" created="Fri, 15 Sep 2017 16:21:45 +0000"  >&lt;p&gt;Commit 6b27708ae15818d025e9f65a1bf8d54a31e01045 in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cshannon&quot; class=&quot;user-hover&quot; rel=&quot;cshannon&quot;&gt;cshannon&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=6b27708&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=6b27708&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6811&quot; title=&quot;ReduceMemoryFootprint does not work on messages with no body&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6811&quot;&gt;&lt;del&gt;AMQ-6811&lt;/del&gt;&lt;/a&gt; - moving ActiveMQMessageIsMarshalled test to src/test/java&lt;/p&gt;</comment>
                            <comment id="16168110" author="jira-bot" created="Fri, 15 Sep 2017 16:22:03 +0000"  >&lt;p&gt;Commit 2015888ad7eb24a5888e6e55a70de33bbb9854a5 in activemq&apos;s branch refs/heads/activemq-5.15.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cshannon&quot; class=&quot;user-hover&quot; rel=&quot;cshannon&quot;&gt;cshannon&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=2015888&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=2015888&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6811&quot; title=&quot;ReduceMemoryFootprint does not work on messages with no body&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6811&quot;&gt;&lt;del&gt;AMQ-6811&lt;/del&gt;&lt;/a&gt; - moving ActiveMQMessageIsMarshalled test to src/test/java&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 6b27708ae15818d025e9f65a1bf8d54a31e01045)&lt;/p&gt;</comment>
                            <comment id="16168112" author="christopher.l.shannon" created="Fri, 15 Sep 2017 16:22:23 +0000"  >&lt;p&gt;Thanks, I moved it to the right location.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 9 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3k4hb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>