<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:35:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-6404] AMQP/JMS message transformation broken.</title>
                <link>https://issues.apache.org/jira/browse/AMQ-6404</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;The changes introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6374&quot; title=&quot;AMQP: Improve message transformation to provide better cross protocol messaging&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6374&quot;&gt;&lt;del&gt;AMQ-6374&lt;/del&gt;&lt;/a&gt; broke the transformation between AMQP and JMS for UTF-8 text messages.&lt;/p&gt;

&lt;p&gt;I have enabled the JMS message transformer for the AMQP transport connector. If I send a UTF-8 text message over AMQP and then reads it back over AMQP I get an empty message body.&lt;/p&gt;

&lt;p&gt;I have looked at the code and found the bad code. It is in the &lt;tt&gt;org.apache.activemq.transport.amqp.message.ActiveMQJMSVendor&lt;/tt&gt; class.&lt;/p&gt;

&lt;p&gt;When the inbound message arrives the &lt;tt&gt;createTextMessage(String)&lt;/tt&gt; method is called. That method creates an &lt;tt&gt;ActiveMQTextMessage&lt;/tt&gt; instance whose data is set with the &lt;tt&gt;setText&lt;/tt&gt; method.&lt;/p&gt;

&lt;p&gt;When the outbound message is to be sent the &lt;tt&gt;getBinaryFromMessageBody(TextMessage)&lt;/tt&gt; method is called. This method tries to get the data with the &lt;tt&gt;getContent&lt;/tt&gt; method, but that method always returns &lt;tt&gt;null&lt;/tt&gt;. The &lt;tt&gt;getText&lt;/tt&gt; method returns the correct data, but is not used here.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12999164">AMQ-6404</key>
            <summary>AMQP/JMS message transformation broken.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tabish">Timothy A. Bish</assignee>
                                    <reporter username="hakanj">H&#229;kan Johansson</reporter>
                        <labels>
                    </labels>
                <created>Tue, 23 Aug 2016 09:45:34 +0000</created>
                <updated>Fri, 2 Sep 2016 08:41:08 +0000</updated>
                            <resolved>Tue, 23 Aug 2016 14:15:56 +0000</resolved>
                                    <version>5.14.0</version>
                                    <fixVersion>5.14.1</fixVersion>
                    <fixVersion>5.15.0</fixVersion>
                                    <component>AMQP</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15432790" author="tabish121" created="Tue, 23 Aug 2016 13:37:54 +0000"  >&lt;p&gt;Do you have a unit test that can reproduce this.  It&apos;s unusual that the content of the message on the broker has been unmarshaled.&lt;/p&gt;</comment>
                            <comment id="15432841" author="jira-bot" created="Tue, 23 Aug 2016 14:04:48 +0000"  >&lt;p&gt;Commit 1030fb184216d00e3fd43a416931acd3b2fc6794 in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tabish121&quot; class=&quot;user-hover&quot; rel=&quot;tabish121&quot;&gt;tabish121&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=1030fb1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=1030fb1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6404&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-6404&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Add check for unmarshalled text body and handle that case.&lt;/p&gt;</comment>
                            <comment id="15432843" author="jira-bot" created="Tue, 23 Aug 2016 14:07:26 +0000"  >&lt;p&gt;Commit 680d082a179902d14cf38a8afde7c2c12a062106 in activemq&apos;s branch refs/heads/activemq-5.14.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tabish121&quot; class=&quot;user-hover&quot; rel=&quot;tabish121&quot;&gt;tabish121&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=680d082&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=680d082&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6404&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-6404&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Add check for unmarshalled text body and handle that case.&lt;br/&gt;
(cherry picked from commit 1030fb184216d00e3fd43a416931acd3b2fc6794)&lt;/p&gt;</comment>
                            <comment id="15432848" author="hakanj" created="Tue, 23 Aug 2016 14:08:05 +0000"  >&lt;p&gt;I tested this with a trivial program using the &quot;qpid_messaging&quot; api (from qpid-cpp).&lt;br/&gt;
I just wrote a simple &quot;hello&quot; message without any special attributes set and then read it back again.&lt;/p&gt;

&lt;p&gt;I will try to create a unit test in the &quot;AmqpTransformerTest.java&quot; file and post it here when I am done.&lt;/p&gt;</comment>
                            <comment id="15432863" author="tabish121" created="Tue, 23 Aug 2016 14:15:56 +0000"  >&lt;p&gt;I&apos;ve added a small fix to check the text if the content is bare so it should now handle this case.  &lt;/p&gt;</comment>
                            <comment id="15432928" author="hakanj" created="Tue, 23 Aug 2016 14:43:53 +0000"  >&lt;p&gt;That was quick.&lt;br/&gt;
Thanks for your help.&lt;/p&gt;</comment>
                            <comment id="15432933" author="tabish121" created="Tue, 23 Aug 2016 14:46:06 +0000"  >&lt;p&gt;Still worth testing if you manage to create a Java reproducer to check that all cases are handled.&lt;/p&gt;</comment>
                            <comment id="15457955" author="hakanj" created="Fri, 2 Sep 2016 08:41:08 +0000"  >&lt;p&gt;Do you know when the next release is planned?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12992415">AMQ-6374</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 11 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i32n1j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>