<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:34:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-1038] Incorrect redelivery behavior and counters</title>
                <link>https://issues.apache.org/jira/browse/AMQ-1038</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Our understanding is that the RedeliveryPolicy maxRedeliveryCount controls the maximum number of times a message will be redelivered (assumed to be a global count and not a per-consumer count). The behavior we are seeing is that messages are redelivered more times than we specified. The problem may be related to the way the redelivery counter is being maintained. We see the redelivery counter incrementing by one for redeliveries to a specific consumer, but then it resets to a lower number when the message is redelivered to a different consumer.&lt;/p&gt;

&lt;p&gt;I have attached a test case to demonstrate the problem. The first test is a simple baseline example that passes. The second test shows that messages are being redelivered too many times for the redelivery policy. The third tests catches a regression in the delivery count (redelivery count + 1) when sending a rolled back message to a new consumer.&lt;/p&gt;

&lt;p&gt;The test suite uses an embedded broker using the VM protocol so it should be standalone.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows XP Pro&lt;br/&gt;
java version &quot;1.5.0_06&quot;&lt;/p&gt;</environment>
        <key id="12482156">AMQ-1038</key>
            <summary>Incorrect redelivery behavior and counters</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chirino">Hiram R. Chirino</assignee>
                                    <reporter username="sbate">Steve Bate</reporter>
                        <labels>
                    </labels>
                <created>Thu, 9 Nov 2006 20:20:11 +0000</created>
                <updated>Wed, 3 Oct 2007 23:34:59 +0000</updated>
                            <resolved>Wed, 3 Oct 2007 23:34:59 +0000</resolved>
                                    <version>4.0.1</version>
                                    <fixVersion>5.0.0</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12936819" author="memelet" created="Fri, 19 Jan 2007 20:55:09 +0000"  >&lt;p&gt;Any chance that this will get some attention? The current behavior pretty much requires that redelivery be implemented in client code by incrementing a message property and putting a cloned message back on the queue.&lt;/p&gt;</comment>
                            <comment id="12939058" author="chirino" created="Wed, 3 Oct 2007 23:34:59 +0000"  >&lt;p&gt;We have now fixed this in rev 581747.  &lt;/p&gt;

&lt;p&gt;The test case need to be sightly adjusted because every time rollback() occurs the redelivery counter is increased and when the consumer  holding the dispatched message is closed, the redelivery counter is also increased.  So by the time the fist consumer in the test case closes out it&apos;s session, the message will be marked redelivered as 4 times (test case assumes it will only be redelivered 3 times, 1 for each rollback).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12460555" name="ASF.LICENSE.NOT.GRANTED--RedeliveryTest.java" size="11700" author="sbate" created="Thu, 9 Nov 2006 20:20:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>84370</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 8 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0rzvr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161457</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>