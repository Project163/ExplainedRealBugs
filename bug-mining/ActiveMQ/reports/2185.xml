<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:03:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-5035] deleting durable subscriber exception</title>
                <link>https://issues.apache.org/jira/browse/AMQ-5035</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;refer to &lt;a href=&quot;http://activemq.2283324.n4.nabble.com/deleting-durable-subscriber-exception-tp4677521.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.2283324.n4.nabble.com/deleting-durable-subscriber-exception-tp4677521.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;getting following exception when deleting a durable subscriber with schedulerSupport set to true on the broker&lt;/p&gt;

&lt;p&gt;2014-02-06 15:25:44,042 | WARN  | /admin/deleteSubscriber.action | org.eclipse.jetty.servlet.ServletHandler | qtp1100010806-60 &lt;br/&gt;
java.lang.ClassCastException: org.apache.activemq.broker.scheduler.SchedulerBroker cannot be cast to org.apache.activemq.broker.region.RegionBroker &lt;br/&gt;
        at org.apache.activemq.advisory.AdvisoryBroker.removeSubscription(AdvisoryBroker.java:280) &lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.removeSubscription(BrokerFilter.java:112) &lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.removeSubscription(BrokerFilter.java:112) &lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.removeSubscription(BrokerFilter.java:112) &lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.removeSubscription(BrokerFilter.java:112) &lt;br/&gt;
        at org.apache.activemq.broker.MutableBrokerFilter.removeSubscription(MutableBrokerFilter.java:117) &lt;br/&gt;
        at org.apache.activemq.broker.jmx.BrokerView.destroyDurableSubscriber(BrokerView.java:430) &lt;br/&gt;
        at org.apache.activemq.web.controller.DeleteSubscriber.handleRequest(DeleteSubscriber.java:38) &lt;br/&gt;
        at org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter.handle(SimpleControllerHandlerAdapter.java:48) &lt;br/&gt;
        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:925) &lt;br/&gt;
        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:856) &lt;br/&gt;
        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:936) &lt;br/&gt;
        at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:827) &lt;br/&gt;
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:693) &lt;br/&gt;
        at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:812) &lt;br/&gt;
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:806) &lt;br/&gt;
        at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:652) &lt;br/&gt;
        at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1320) &lt;br/&gt;
        at org.apache.activemq.web.AuditFilter.doFilter(AuditFilter.java:59) &lt;br/&gt;
        at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1291) &lt;br/&gt;
        at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99) &lt;br/&gt;
        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) &lt;br/&gt;
        at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1291) &lt;br/&gt;
        at org.apache.activemq.web.filter.ApplicationContextFilter.doFilter(ApplicationContextFilter.java:102) &lt;br/&gt;
        at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1291) &lt;br/&gt;
        at com.opensymphony.sitemesh.webapp.SiteMeshFilter.obtainContent(SiteMeshFilter.java:129) &lt;br/&gt;
        at com.opensymphony.sitemesh.webapp.SiteMeshFilter.doFilter(SiteMeshFilter.java:77) &lt;br/&gt;
        at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1291) &lt;br/&gt;
        at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:443) &lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:137) &lt;br/&gt;
        at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:521) &lt;br/&gt;
        at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:227) &lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1044) &lt;br/&gt;
        at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:372) &lt;br/&gt;
        at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:189) &lt;br/&gt;
        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:978) &lt;br/&gt;
        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:135) &lt;br/&gt;
        at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:154) &lt;br/&gt;
        at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:521) &lt;br/&gt;
        at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:154) &lt;br/&gt;
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:116) &lt;br/&gt;
        at org.eclipse.jetty.server.Server.handle(Server.java:367) &lt;br/&gt;
        at org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:486) &lt;br/&gt;
        at org.eclipse.jetty.server.AbstractHttpConnection.headerComplete(AbstractHttpConnection.java:926) &lt;br/&gt;
        at org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.headerComplete(AbstractHttpConnection.java:988) &lt;br/&gt;
        at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:640) &lt;br/&gt;
        at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:235) &lt;br/&gt;
        at org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:82) &lt;br/&gt;
        at org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:628) &lt;br/&gt;
        at org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:52) &lt;br/&gt;
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:608) &lt;br/&gt;
        at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:543) &lt;br/&gt;
        at java.lang.Thread.run(Thread.java:695) &lt;/p&gt;


&lt;p&gt;To reproduce:&lt;br/&gt;
1. Download fresh copy and install &lt;br/&gt;
2. Edit conf/activemq.xml and change broker line to &lt;br/&gt;
&amp;lt;broker xmlns=&quot;http://activemq.apache.org/schema/core&quot; brokerName=&quot;localhost&quot; dataDirectory=&quot;${activemq.data}&quot; schedulerSupport=&quot;true&quot;&amp;gt; &lt;/p&gt;

&lt;p&gt;3. Go to admin console and create a topic, &lt;a href=&quot;http://localhost:8161/admin/topics.jsp&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8161/admin/topics.jsp&lt;/a&gt;&lt;br/&gt;
4. Go to admin console and create durable subscriber to topic above &lt;a href=&quot;http://localhost:8161/admin/subscribers.jsp&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8161/admin/subscribers.jsp&lt;/a&gt;&lt;br/&gt;
5. Delete the durable subscriber using link on same page and it will fail &lt;/p&gt;

&lt;p&gt;Repeat all steps above but this time set schedulerSupport=false. Then it will delete the durable without any errors. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12694094">AMQ-5035</key>
            <summary>deleting durable subscriber exception</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tabish">Timothy A. Bish</assignee>
                                    <reporter username="mtran">Minh Tran</reporter>
                        <labels>
                    </labels>
                <created>Sat, 8 Feb 2014 12:41:10 +0000</created>
                <updated>Mon, 2 Dec 2019 11:42:23 +0000</updated>
                            <resolved>Mon, 10 Feb 2014 23:16:28 +0000</resolved>
                                    <version>5.9.0</version>
                                    <fixVersion>5.10.0</fixVersion>
                                    <component>Broker</component>
                    <component>Job Scheduler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13896730" author="tabish121" created="Mon, 10 Feb 2014 16:21:50 +0000"  >&lt;p&gt;Testing on trunk and cannot reproduce&lt;/p&gt;</comment>
                            <comment id="13897075" author="mtran" created="Mon, 10 Feb 2014 21:54:57 +0000"  >&lt;p&gt;But on the mailing list, you said you could reproduce the bug?&lt;/p&gt;

&lt;p&gt;&quot;Yup, there&apos;s a bug there.  The key is to set isUseJmx(false) in the test &lt;br/&gt;
Christian created and then the exception will show up. &quot;&lt;/p&gt;</comment>
                            <comment id="13897088" author="mtran" created="Mon, 10 Feb 2014 22:01:34 +0000"  >&lt;p&gt;Re-opening because problem still exists on the snapshot&lt;br/&gt;
&lt;a href=&quot;http://repository.apache.org/content/repositories/snapshots/org/apache/activemq/apache-activemq/5.10-SNAPSHOT/apache-activemq-5.10-20131220.123112-36-bin.zip&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://repository.apache.org/content/repositories/snapshots/org/apache/activemq/apache-activemq/5.10-SNAPSHOT/apache-activemq-5.10-20131220.123112-36-bin.zip&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13897096" author="tabish121" created="Mon, 10 Feb 2014 22:05:25 +0000"  >&lt;p&gt;My assessment was incorrect and the problem is not reproducible using the test steps you have outlined.  If you can produce a junit test case please do otherwise this is considered a non-issue. &lt;/p&gt;</comment>
                            <comment id="13897107" author="mtran" created="Mon, 10 Feb 2014 22:12:46 +0000"  >&lt;p&gt;Ok I&apos;ll see what I can do about the unit test. Is there any possible way that the unit test Christian has written behaves differently from normal startup?&lt;/p&gt;</comment>
                            <comment id="13897113" author="tabish121" created="Mon, 10 Feb 2014 22:17:25 +0000"  >&lt;p&gt;If you turn on TRACE level logging you can see the configuration progress and see if there&apos;s any differences.  &lt;/p&gt;</comment>
                            <comment id="13897119" author="mtran" created="Mon, 10 Feb 2014 22:22:11 +0000"  >&lt;p&gt;Ok thanks for the tip&lt;/p&gt;</comment>
                            <comment id="13897148" author="mtran" created="Mon, 10 Feb 2014 22:42:40 +0000"  >&lt;p&gt;Would you be able to tell me which maven project contains the EmbeddedBrokerAndConnectionTestSupport class that Christian has used in his unit test? I can&apos;t see it in any of the jars in the activemq installation.&lt;/p&gt;</comment>
                            <comment id="13897184" author="tabish121" created="Mon, 10 Feb 2014 23:16:28 +0000"  >&lt;p&gt;Ok, added some contingency code in AdvisoryBroker to ensure it will always find a region broker even if configuration causes an unexpected chain.  &lt;/p&gt;

&lt;p&gt;Try the next SNAPSHOT build and see how that goes.  &lt;/p&gt;</comment>
                            <comment id="13897272" author="mtran" created="Mon, 10 Feb 2014 23:23:54 +0000"  >&lt;p&gt;Thanks, I appreciate it.&lt;/p&gt;</comment>
                            <comment id="16985984" author="jira-bot" created="Mon, 2 Dec 2019 11:42:23 +0000"  >&lt;p&gt;Commit 4d6409b3b82c1c6ab534cf0da253971e008bc13f in activemq&apos;s branch refs/heads/master from gtully&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=4d6409b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=4d6409b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-5035&quot; title=&quot;deleting durable subscriber exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-5035&quot;&gt;&lt;del&gt;AMQ-5035&lt;/del&gt;&lt;/a&gt; - fix intermittent failure due to async close&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>372603</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 50 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1s7on:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>372907</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>