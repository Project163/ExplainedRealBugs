<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:57:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-4108] Cannot receive &apos;ActiveMQ.Advisory.MasterBroker&apos; messages when master dies and slave takes control</title>
                <link>https://issues.apache.org/jira/browse/AMQ-4108</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Message consumers do not receive &apos;ActiveMQ.Advisory.MasterBroker&apos; advisory messages when the master is killed and the slave takes over.&lt;/p&gt;

&lt;p&gt;Steps:&lt;/p&gt;

&lt;p&gt;1) Start Master and Slave brokers in Pure &quot;Master / Slave&quot; Configuration.&lt;br/&gt;
2) Create a client consumer for the &apos;ActiveMQ.Advisory.MasterBroker&apos; topic. (See code below)&lt;br/&gt;
3) Kill the Master broker. (kill -9)&lt;br/&gt;
4) The client will failover to the slave. Note the Web Console shows there is one en-queued message for the &apos;ActiveMQ.Advisory.MasterBroker&apos; topic.&lt;br/&gt;
5) The consumer will never receive/dequeue this message. (Event after restarting the client)&lt;/p&gt;


&lt;p&gt;Two other observations:&lt;/p&gt;

&lt;p&gt;1) Other advisories (such as the &apos;ActiveMQ.Advisory.Connection&apos;)are working. This only seems to be a problem with &apos;ActiveMQ.Advisory.MasterBroker&apos;.&lt;/p&gt;

&lt;p&gt;2) Sending a message to the &apos;ActiveMQ.Advisory.MasterBroker&apos; topic via the Web Console is properly received and dequeued by the consumer.&lt;/p&gt;


&lt;p&gt;Code:&lt;/p&gt;

&lt;p&gt;Session session = conn.createSession(false, Session.AUTO_ACKNOWLEDGE);&lt;br/&gt;
MessageConsumer consumer = session.createConsumer( AdvisorySupport.getMasterBrokerAdvisoryTopic() );&lt;br/&gt;
// It will receive Connection Advisory messages! Just not MasterBroker advisory messages &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
//MessageConsumer consumer = session.createConsumer( AdvisorySupport.getConnectionAdvisoryTopic() );&lt;/p&gt;

&lt;p&gt;Message msg = null;&lt;br/&gt;
while (true) {&lt;br/&gt;
        // Also doesn&apos;t work with MessageListener implementation&lt;br/&gt;
        msg = consumer.receive(30000);&lt;br/&gt;
        System.out.println(name + &quot; Received: &quot; + msg);&lt;br/&gt;
} &lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows or Linux. Java 1.7.0_07. &lt;/p&gt;</environment>
        <key id="12611903">AMQ-4108</key>
            <summary>Cannot receive &apos;ActiveMQ.Advisory.MasterBroker&apos; messages when master dies and slave takes control</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dejanb">Dejan Bosanac</assignee>
                                    <reporter username="ajcohen">Andrew Cohen</reporter>
                        <labels>
                            <label>advisory</label>
                    </labels>
                <created>Mon, 15 Oct 2012 20:42:51 +0000</created>
                <updated>Thu, 2 May 2013 02:30:55 +0000</updated>
                            <resolved>Wed, 17 Oct 2012 15:18:27 +0000</resolved>
                                    <version>5.7.0</version>
                                    <fixVersion>5.8.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13477948" author="dejanb" created="Wed, 17 Oct 2012 15:18:27 +0000"  >&lt;p&gt;Fixed with svn revision 1399302&lt;/p&gt;

&lt;p&gt;I made ActiveMQ.Advisory.MasterBroker topic retroactive, which means that message will be sent to the consumer when it becomes available.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12612994">AMQ-4122</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248817</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 5 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0a067:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56301</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>