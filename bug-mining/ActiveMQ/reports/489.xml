<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:38:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-1995] Exception &quot;The Consumer is closed&quot; in multithreaded environment</title>
                <link>https://issues.apache.org/jira/browse/AMQ-1995</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;I got the following exception when running the TempQueueMemoryTest and increasing number of producer, consumers and messages:&lt;/p&gt;

&lt;p&gt;javax.jms.IllegalStateException: The Consumer is closed&lt;br/&gt;
	at org.apache.activemq.ActiveMQMessageConsumer.checkClosed(ActiveMQMessageConsumer.java:699)&lt;br/&gt;
	at org.apache.activemq.ActiveMQMessageConsumer.getMessageListener(ActiveMQMessageConsumer.java:339)&lt;br/&gt;
	at org.apache.activemq.ActiveMQSession.checkMessageListener(ActiveMQSession.java:1864)&lt;br/&gt;
	at org.apache.activemq.ActiveMQMessageConsumer.checkMessageListener(ActiveMQMessageConsumer.java:717)&lt;br/&gt;
	at org.apache.activemq.ActiveMQMessageConsumer.receive(ActiveMQMessageConsumer.java:457)&lt;br/&gt;
	at TempQueueMemoryTest$1Producer.run(TempQueueMemoryTest.java:94)&lt;/p&gt;

&lt;p&gt;The error happens at &quot;Message reply = consumer.receive();&quot;, the message is not received.&lt;/p&gt;

&lt;p&gt;I increased the number of consumers and produceres to 2 and the number of messages to 5000. When using larger numbers the exception is thrown more often (unpredictable how often exactly). It definitly seems to be a multithreading-related problem because it only happens with multiple threads producing/consuming and the more threads you have the more often it happens.&lt;/p&gt;

&lt;p&gt;Tested with 5.2 RC2.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows XP, JRE 1.5.0_12, 2GB Memory, Dual-core&lt;/p&gt;</environment>
        <key id="12482374">AMQ-1995</key>
            <summary>Exception &quot;The Consumer is closed&quot; in multithreaded environment</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gtully">Gary Tully</assignee>
                                    <reporter username="martinhasl">Martin Haslinger</reporter>
                        <labels>
                    </labels>
                <created>Wed, 5 Nov 2008 14:30:22 +0000</created>
                <updated>Fri, 2 Dec 2016 19:14:56 +0000</updated>
                            <resolved>Wed, 5 Nov 2008 17:02:38 +0000</resolved>
                                    <version>5.1.0</version>
                    <version>5.2.0</version>
                                    <fixVersion>5.2.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="12940428" author="gtully" created="Wed, 5 Nov 2008 16:54:57 +0000"  >&lt;p&gt;good catch. this is a bug in the test, each Producer should have its own session as a session is only intended for use by a single tread at a time as per the JMS spec.&lt;br/&gt;
I am running a quick sanity check on the changes as I type. &lt;/p&gt;</comment>
                            <comment id="12940435" author="gtully" created="Wed, 5 Nov 2008 17:02:38 +0000"  >&lt;p&gt;problem with the test code, it was not thread safe.&lt;br/&gt;
resolved in r711617.&lt;/p&gt;</comment>
                            <comment id="12940439" author="gtully" created="Thu, 6 Nov 2008 10:47:07 +0000"  >&lt;p&gt;These fixes will now make 5.2.0 rc3&lt;/p&gt;</comment>
                            <comment id="15714203" author="nitinaggarwal1991" created="Fri, 2 Dec 2016 06:10:14 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I am using apache-activemq-5.14.1 and i am getting the same error.&lt;/p&gt;

&lt;p&gt;Could you kindly assist as how can i resolve it.&lt;/p&gt;

&lt;p&gt;com.irdeto.manager.endpoint.activemq.MessageConsumerManager  - The Consumer is closed&lt;br/&gt;
javax.jms.IllegalStateException: The Consumer is closed&lt;br/&gt;
        at org.apache.activemq.ActiveMQMessageConsumer.checkClosed(ActiveMQMessageConsumer.java:880)&lt;br/&gt;
        at org.apache.activemq.ActiveMQMessageConsumer.receiveNoWait(ActiveMQMessageConsumer.java:678)&lt;br/&gt;
        at org.apache.activemq.jms.pool.PooledMessageConsumer.receiveNoWait(PooledMessageConsumer.java:72)&lt;br/&gt;
        at com.irdeto.manager.endpoint.activemq.MessageConsumerManager$2.run(MessageConsumerManager.java:105)&lt;br/&gt;
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)&lt;br/&gt;
        at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)&lt;br/&gt;
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)&lt;br/&gt;
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:745)&lt;/p&gt;


&lt;p&gt;Thanks in advance&lt;/p&gt;</comment>
                            <comment id="15715203" author="tabish121" created="Fri, 2 Dec 2016 14:02:53 +0000"  >&lt;p&gt;You get this error when you call a consumer method on a closed consumer.  Solution, don&apos;t call any consumer methods after you&apos;ve closed the consumer.  &lt;/p&gt;

&lt;p&gt;Support questions are better sent to the users mailing list. &lt;/p&gt;</comment>
                            <comment id="15715986" author="nitinaggarwal1991" created="Fri, 2 Dec 2016 19:14:56 +0000"  >&lt;p&gt;Thanks a lot for the quick response.&lt;/p&gt;

&lt;p&gt;I resolved the issue and yes u were right i was getting this error as the consumer was actually closed and a web application was trying  to connect to it.&lt;/p&gt;

&lt;p&gt;Thanks again.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>75134</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 50 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0s1sn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161767</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>