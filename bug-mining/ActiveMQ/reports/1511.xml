<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:54:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-3856] MessageServlet assumes TextMessages contain Text</title>
                <link>https://issues.apache.org/jira/browse/AMQ-3856</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;writeMessageResponse assumes that a text message will contain non null text.  It does a txt.startsWith which crashes with TextMessages with no body.&lt;/p&gt;

&lt;p&gt;It can be fixed with this code:&lt;/p&gt;

&lt;p&gt;    protected void writeMessageResponse(PrintWriter writer, Message message) throws JMSException, IOException {&lt;br/&gt;
        if (message instanceof TextMessage) {&lt;br/&gt;
            TextMessage textMsg = (TextMessage)message;&lt;br/&gt;
            String txt = textMsg.getText();&lt;/p&gt;

&lt;p&gt;            if (txt != null) {&lt;br/&gt;
                if (txt.startsWith(&quot;&amp;lt;?&quot;)) &lt;/p&gt;
{
                    txt = txt.substring(txt.indexOf(&quot;?&amp;gt;&quot;) + 2);
                }
&lt;p&gt;                writer.print(txt);&lt;br/&gt;
            }&lt;br/&gt;
        } else if (message instanceof ObjectMessage) &lt;/p&gt;
{
            ObjectMessage objectMsg = (ObjectMessage)message;
            Object object = objectMsg.getObject();
            writer.print(object.toString());
        }
&lt;p&gt;    }&lt;/p&gt;</description>
                <environment>&lt;p&gt;all&lt;/p&gt;</environment>
        <key id="12556929">AMQ-3856</key>
            <summary>MessageServlet assumes TextMessages contain Text</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tabish">Timothy A. Bish</assignee>
                                    <reporter username="giles7777">Alan Hudson</reporter>
                        <labels>
                    </labels>
                <created>Tue, 22 May 2012 21:56:02 +0000</created>
                <updated>Tue, 29 May 2012 14:21:19 +0000</updated>
                            <resolved>Tue, 29 May 2012 14:21:19 +0000</resolved>
                                    <version>5.5.1</version>
                    <version>5.6.0</version>
                                    <fixVersion>5.7.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13283386" author="tabish121" created="Fri, 25 May 2012 13:32:25 +0000"  >&lt;p&gt;Fixed in trunk, also added checks for the ObjectMessage case.&lt;/p&gt;</comment>
                            <comment id="13284452" author="giles7777" created="Mon, 28 May 2012 16:12:58 +0000"  >&lt;p&gt;Thanks for the fix.  There is one other place that needs it.  writeResponse in MessageServlet.java needs the same fix.  &lt;/p&gt;</comment>
                            <comment id="13284453" author="giles7777" created="Mon, 28 May 2012 16:13:37 +0000"  >&lt;p&gt;The same change is needed in MessageServlet.  The fix was applied to MessageListenerServlet which also needed it.  &lt;/p&gt;</comment>
                            <comment id="13284468" author="tabish121" created="Mon, 28 May 2012 16:40:36 +0000"  >&lt;p&gt;Recommend you supply some patches and even better tests for the issues you are seeing.&lt;/p&gt;</comment>
                            <comment id="13284474" author="giles7777" created="Mon, 28 May 2012 16:50:36 +0000"  >&lt;p&gt;Patches are easy I&apos;ll get those together.  Best I can tell the activemq-web module does not contain any junit tests?  or at least the src/test directory doesn&apos;t exist as in other modules.  Fairly new to coding in ActiveMQ so perhaps they are located some place else?&lt;/p&gt;

&lt;p&gt;It&apos;s possible the right place for these tests is in activemq-web-demo/src/test?  I see some reading tests but no POST requests.  If that&apos;s the right place then I&apos;ll work up some POST examples.  &lt;/p&gt;

&lt;p&gt;I&apos;ve confirmed that&apos;s the right place for the tests and have developed a test showing the problem.  I&apos;ll attach the diff.&lt;/p&gt;</comment>
                            <comment id="13284521" author="giles7777" created="Mon, 28 May 2012 19:10:28 +0000"  >&lt;p&gt;Patch for writeMessageResponse change&lt;/p&gt;</comment>
                            <comment id="13284522" author="giles7777" created="Mon, 28 May 2012 19:12:45 +0000"  >&lt;p&gt;I could not get a junit file to trigger this but I know I ran into it from a webclient before.  Best I can tell it could only happen when sync=true or a continuation is true on a getMessage.  The code is same changes made to MessageListenerServlet&lt;/p&gt;</comment>
                            <comment id="13284530" author="giles7777" created="Mon, 28 May 2012 19:38:01 +0000"  >&lt;p&gt;Add&apos;s testPost test that shows crash on empty text messages.  &lt;/p&gt;</comment>
                            <comment id="13284531" author="giles7777" created="Mon, 28 May 2012 19:38:59 +0000"  >&lt;p&gt;ok, I figured out how I was getting the crash.  It was on the consume side of a message with no text. Junit added, fix fixes crashing junit.  &lt;/p&gt;</comment>
                            <comment id="13284844" author="tabish121" created="Tue, 29 May 2012 14:21:19 +0000"  >&lt;p&gt;Applied the patch and unit tests, thanks for the contribution.  &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12529983" name="amq-3856.patch" size="942" author="giles7777" created="Mon, 28 May 2012 19:10:28 +0000"/>
                            <attachment id="12529985" name="amq-3856_junit.patch" size="1241" author="giles7777" created="Mon, 28 May 2012 19:38:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>249829</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 26 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ahrb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>59150</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>