<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:55:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-3961] Durable subscriber only receives part of the persisted messages on re-connect</title>
                <link>https://issues.apache.org/jira/browse/AMQ-3961</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;A durable subscriber is connected to ActiveMQ using the ConnectionConsumer protocol, transacted sessions, and at most 1 message per session. While the subscriber is disconnected, the publisher publishes e.g. 10 messages. When the subscriber re-connects, it only receives 2 messages of those. If it repeatedly disconnects and re-connects, it receives 2 messages each time until all messages are received.&lt;/p&gt;

&lt;p&gt;Further investigation reveals that the problem lies in class org.apache.activemq.broker.region.PrefetchSubscription which does not re-check for further pending messages to be dispatched when committed message are removed from the list of dispatched but not yet acknowledged messages.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Default configuraton of ActiveMQ under Linux or Windows&lt;/p&gt;</environment>
        <key id="12601445">AMQ-3961</key>
            <summary>Durable subscriber only receives part of the persisted messages on re-connect</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tabish">Timothy A. Bish</assignee>
                                    <reporter username="andreasmattes">Andreas Mattes</reporter>
                        <labels>
                    </labels>
                <created>Fri, 3 Aug 2012 23:56:07 +0000</created>
                <updated>Fri, 17 Aug 2012 12:48:53 +0000</updated>
                            <resolved>Fri, 17 Aug 2012 12:48:53 +0000</resolved>
                                    <version>5.6.0</version>
                                    <fixVersion>5.7.0</fixVersion>
                                    <component>Connector</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13428480" author="tabish121" created="Sat, 4 Aug 2012 00:02:21 +0000"  >&lt;p&gt;A good course of action here would be to create a JUnit test case that shows the issue and a patch that resolves it, this will ensure it stays fixed into the future. &lt;/p&gt;</comment>
                            <comment id="13428483" author="andreasmattes" created="Sat, 4 Aug 2012 00:04:08 +0000"  >&lt;p&gt;The attached file &quot;PrefetchSubscription.patch&quot; contains a tentative fix for this issue.&lt;/p&gt;</comment>
                            <comment id="13428578" author="andreasmattes" created="Sat, 4 Aug 2012 07:22:47 +0000"  >&lt;p&gt;I&apos;ll try to create a reasonable unit test, but first I have to do some further investigation in order to emulate environment and communication correctly.&lt;/p&gt;</comment>
                            <comment id="13434164" author="andreasmattes" created="Tue, 14 Aug 2012 14:49:56 +0000"  >&lt;p&gt;Find attached the following two tests demonstrating the issue:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;&quot;PrefetchSubscriptionTest.java&quot; contains a unit test which re-plays the interaction with the &quot;DurableTopicSubscription&quot; which leads to the issue with undispatched messages. Collaborating classes are partly mocked and simplified (e.g. transactions).&lt;/li&gt;
	&lt;li&gt;&quot;TestClient.java&quot; is implemented as JUnit TestCase, but not a unit test and requires an ActiveMQ server to be running at &quot;tcp://localhost:61616&quot;. It shows the issue from JMS API level.&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="13436700" author="tabish121" created="Fri, 17 Aug 2012 12:48:53 +0000"  >&lt;p&gt;Updated the TestClient test app to a JUnit based test case and applied the fix, good catch.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12540888" name="PrefetchSubscription.patch" size="512" author="andreasmattes" created="Tue, 14 Aug 2012 14:57:17 +0000"/>
                            <attachment id="12540885" name="PrefetchSubscriptionTest.java" size="8955" author="andreasmattes" created="Tue, 14 Aug 2012 14:49:56 +0000"/>
                            <attachment id="12540886" name="TestClient.java" size="4879" author="andreasmattes" created="Tue, 14 Aug 2012 14:49:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>246248</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 14 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i07jaf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>41892</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>