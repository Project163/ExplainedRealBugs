<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:41:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-6625] IOException in kahaDB needs to pause pending IOExceptionHandler intervention</title>
                <link>https://issues.apache.org/jira/browse/AMQ-6625</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;KahaDB can recover from kill -9 by replaying the journal from the last checkpoint or by detecting and reapplying partial writes to the index.&lt;br/&gt;
However this activity is compromised if the journal or index accepts subsequent writes. It an lead to skipped write batches or skipped partial updates to the index.&lt;br/&gt;
The desirable behaviour of treating an IOException as fatal and stopping the broker in the knowledge that it will restart and fully recover needs to treat the first IO error as fatal and by default not accept any further writes.&lt;br/&gt;
A more advanced IOException handler can facilitate staying alive in more specific scenarios and reactivate kahadb.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13050564">AMQ-6625</key>
            <summary>IOException in kahaDB needs to pause pending IOExceptionHandler intervention</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gtully">Gary Tully</assignee>
                                    <reporter username="gtully">Gary Tully</reporter>
                        <labels>
                    </labels>
                <created>Mon, 13 Mar 2017 13:39:23 +0000</created>
                <updated>Fri, 27 Jul 2018 12:18:18 +0000</updated>
                            <resolved>Thu, 15 Jun 2017 16:36:18 +0000</resolved>
                                    <version>5.14.0</version>
                                    <fixVersion>5.15.0</fixVersion>
                                    <component>KahaDB</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15907474" author="gtully" created="Mon, 13 Mar 2017 13:41:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-3725&quot; title=&quot;Kahadb error during SAN failover delayed write - Allow kahaDB to recover in a similar manner as the JDBC store using the IOExceptionHandler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-3725&quot;&gt;&lt;del&gt;AMQ-3725&lt;/del&gt;&lt;/a&gt; feature is better suited to the jdbc store which is internally consistent.&lt;br/&gt;
Kahadb is tolerant to a single write failure.&lt;/p&gt;</comment>
                            <comment id="15907486" author="gtully" created="Mon, 13 Mar 2017 13:47:19 +0000"  >&lt;p&gt;If the broker needs to stay up, for sync traffic &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6606&quot; title=&quot;Journal partial write can result in batch corruption on restart&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6606&quot;&gt;&lt;del&gt;AMQ-6606&lt;/del&gt;&lt;/a&gt; helps ensure the journal does not get corrupt batches.&lt;br/&gt;
KahaDBIOExceptionHandler allow this sort of behaviour by resetting kahadb after the first error. &lt;/p&gt;</comment>
                            <comment id="15907488" author="jira-bot" created="Mon, 13 Mar 2017 13:50:03 +0000"  >&lt;p&gt;Commit c5a8b2c8b11121f4999d9f05932cd040d8c9f2a7 in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=c5a8b2c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=c5a8b2c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6625&quot; title=&quot;IOException in kahaDB needs to pause pending IOExceptionHandler intervention&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6625&quot;&gt;&lt;del&gt;AMQ-6625&lt;/del&gt;&lt;/a&gt; ensure kahadb stops operation on the first IOException to facilitate auto recovery from partial writes&lt;/p&gt;</comment>
                            <comment id="15907515" author="gtully" created="Mon, 13 Mar 2017 14:07:57 +0000"  >&lt;p&gt;Prior to the handIOException up-call the journal and index pause. The appender write thread won&apos;t get recreated and the index is marked unloaded.&lt;br/&gt;
This ensures that subsequent writes will fail allowing auto recovery from a partial write to kick in on restart.&lt;br/&gt;
The DefaultIOExceptionHandler implements a resume call on kahadb that allows the stopStartConnectors behaviour or ignore all errors behaviour to be chosen if necessary.&lt;/p&gt;</comment>
                            <comment id="16050731" author="gtully" created="Thu, 15 Jun 2017 16:27:37 +0000"  >&lt;p&gt;The KahaDbIOExceptionHandler clashes with the use of the LeaseLockerIOExceptionHandler - need to push the allowIOResumption support into the persistence adapter.&lt;/p&gt;</comment>
                            <comment id="16050737" author="jira-bot" created="Thu, 15 Jun 2017 16:31:05 +0000"  >&lt;p&gt;Commit b07821ab6494b43e1ae8877eaf740effc7896b84 in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=b07821a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=b07821a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6625&quot; title=&quot;IOException in kahaDB needs to pause pending IOExceptionHandler intervention&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6625&quot;&gt;&lt;del&gt;AMQ-6625&lt;/del&gt;&lt;/a&gt; remove kahadbioexceptionhandler by pushing allowIOResumption into persistence adapter. This allows the lease locker to still be used with kahadb for stopStartConnectors support&lt;/p&gt;</comment>
                            <comment id="16050747" author="gtully" created="Thu, 15 Jun 2017 16:38:54 +0000"  >&lt;p&gt;The DefaultIOExceptionHandler implements a resume call on kahadb that allows the stopStartConnectors behaviour or ignore all errors behaviour to be chosen if necessary.&lt;/p&gt;</comment>
                            <comment id="16051663" author="jira-bot" created="Fri, 16 Jun 2017 09:29:47 +0000"  >&lt;p&gt;Commit d70852eec8b61e4d847b0d191cd88131bc606e23 in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=d70852e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=d70852e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6625&quot; title=&quot;IOException in kahaDB needs to pause pending IOExceptionHandler intervention&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6625&quot;&gt;&lt;del&gt;AMQ-6625&lt;/del&gt;&lt;/a&gt; fix mock test expectation regression&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13171677">AMQ-7010</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12543079">AMQ-3725</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13044893">AMQ-6606</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12482718">AMQ-2042</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 22 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3bblj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>