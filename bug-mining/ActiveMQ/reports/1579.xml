<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:55:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-3285] ActiveMQXAConnectionFactory does not respect various parameters for redelivery policy</title>
                <link>https://issues.apache.org/jira/browse/AMQ-3285</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;I tried to add these following parameters to my redelivery policy and activeMQ is not respecting any of them except maximumRedelivery&lt;br/&gt;
&amp;lt;spring:bean id=&quot;redeliveryPolicy&quot; class=&quot;org.apache.activemq.RedeliveryPolicy&quot;&amp;gt;&lt;br/&gt;
			&amp;lt;spring:property name=&quot;maximumRedeliveries&quot; value=&quot;5&quot;/&amp;gt;&lt;br/&gt;
			&amp;lt;spring:property name=&quot;initialRedeliveryDelay&quot; value=&quot;5000&quot;/&amp;gt;&lt;br/&gt;
						&amp;lt;spring:property name=&quot;redeliveryDelay&quot; value=&quot;2000&quot;/&amp;gt;&lt;br/&gt;
			&amp;lt;spring:property name=&quot;useExponentialBackOff&quot; value=&quot;true&quot;/&amp;gt;&lt;br/&gt;
			&amp;lt;spring:property name=&quot;backOffMultiplier&quot; value=&quot;2&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;/spring:bean&amp;gt;&lt;/p&gt;

&lt;p&gt;I have attached the project which I took from &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-1593&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-1593&lt;/a&gt; and added the above parameter to my brokerURL:&lt;br/&gt;
tcp://localhost:5000?jms.redeliveryPolicy.maximumRedeliveries=3&amp;amp;jms.redeliveryPolicy.initialRedeliveryDelay=10000&amp;amp;jms.redeliveryPolicy.deliveryDelay=10000&amp;amp;jms.redeliveryPolicy.useExponentialBackOff=true&amp;amp;jms.redeliveryPolicy.backOffMultiplier=2&lt;/p&gt;

&lt;p&gt;This test case will show you that none of the parameters like initiaRedeliveryDelay etc will take effect, except maxRedeliveries&lt;/p&gt;</description>
                <environment></environment>
        <key id="12504576">AMQ-3285</key>
            <summary>ActiveMQXAConnectionFactory does not respect various parameters for redelivery policy</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jaskiratbhatia">Jaskirat Bhatia</reporter>
                        <labels>
                    </labels>
                <created>Mon, 18 Apr 2011 18:24:21 +0000</created>
                <updated>Mon, 18 Mar 2013 10:28:05 +0000</updated>
                            <resolved>Wed, 1 Aug 2012 14:48:43 +0000</resolved>
                                    <version>5.4.0</version>
                    <version>5.4.2</version>
                    <version>5.5.0</version>
                                                    <component>JMS client</component>
                        <due></due>
                            <votes>3</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13022720" author="gtully" created="Thu, 21 Apr 2011 11:30:26 +0000"  >&lt;p&gt;not sure what the ![CDATA[ gives you or what the brokerURL string ends up as.&lt;/p&gt;

&lt;p&gt;In place of CDATA, try replacing the &apos;&amp;amp;&apos; with the entity &apos;&amp;amp;&apos; so that is validates.&lt;/p&gt;</comment>
                            <comment id="13022927" author="jaskiratbhatia" created="Thu, 21 Apr 2011 21:29:58 +0000"  >&lt;p&gt;Hi Gary&lt;br/&gt;
I tried this and still not working:&lt;br/&gt;
 &amp;lt;prop key=&quot;brokerURL&quot;&amp;gt;tcp://localhost:5000?jms.redeliveryPolicy.maximumRedeliveries=3&amp;amp;jms.redeliveryPolicy.initialRedeliveryDelay=10000&amp;amp;jms.redeliveryPolicy.deliveryDelay=10000&amp;amp;jms.redeliveryPolicy.useExponentialBackOff=true&amp;amp;jms.redeliveryPolicy.backOffMultiplier=2&amp;lt;/prop&amp;gt;&lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Jaskirat&lt;/p&gt;</comment>
                            <comment id="13026882" author="flume" created="Fri, 29 Apr 2011 06:45:59 +0000"  >&lt;p&gt;The problem lies with the fact that a PoolingConnectionFactory is used. When using the org.springframework.jms.connection.CachingConnectionFactory the various backoff-settings do take effect. This is most likely not fixable due to the fact that multiple ActiveMQMessageConsumers are created and destroyed when using the PoolingConnectionFactory while that is not the case with the CachingConnectionFactory. At least what I see is that the prolific creation and destruction of ActiveMQMessageConsumers in conjunction with the fact that this class is holding state (e.g. the redeliveryDelay property) between rollbacks tends to be contradictory.&lt;br/&gt;
Maybe someone with a better understanding of ActiveMQMessageConsumer in relation with PoolingConnectionFactory can shed some light on this. At least there is a workaround.&lt;/p&gt;</comment>
                            <comment id="13027106" author="jaskiratbhatia" created="Fri, 29 Apr 2011 17:56:13 +0000"  >&lt;p&gt;Hi Jan, nope that is not an issue. This thing works if the produced message is set to persistent, if non-persistent then all other attributes defined in the policy are ignored.&lt;/p&gt;

&lt;p&gt;So now the question would be, how to make this thing work for non-persistent messages also?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13028892" author="jaskiratbhatia" created="Wed, 4 May 2011 18:54:44 +0000"  >&lt;p&gt;Something is weird, I was able to run this with persistent message before. But now it is not working anymore.&lt;br/&gt;
Can someone help?&lt;/p&gt;</comment>
                            <comment id="13115768" author="tabish121" created="Tue, 27 Sep 2011 18:15:32 +0000"  >&lt;p&gt;This appears to be an issue of not properly using the correct escape values for the &amp;amp; character in the XML.  If an issue still occurs please provide a JUnit test case the demonstrates as the ActiveMQXAConnectionFactory delegates the property configuration to the same ActiveMQConnectionFactory that is tested quite extensively in the existing unit tests.&lt;/p&gt;</comment>
                            <comment id="13235310" author="genjosanzo" created="Thu, 22 Mar 2012 03:40:25 +0000"  >&lt;p&gt;Hi all,&lt;/p&gt;

&lt;p&gt;I&apos;ve been experiencing the very same issue Jaskirat has been talking about. I took the liberty to clean up the test he uploaded to expose even better the problem.&lt;/p&gt;

&lt;p&gt;Basically now the brokerURL is configured properly (without using CDATA and escaping the &amp;amp; to  %26 )and by debugging it I can se that the org.apache.activemq.RedeliveryPolicy is correctly configured. However some of the property I&apos;ve set (especially the useExponentialBackOff related one)&lt;/p&gt;

&lt;p&gt;Please take a look at the new attached test&lt;/p&gt;</comment>
                            <comment id="13235313" author="genjosanzo" created="Thu, 22 Mar 2012 03:45:36 +0000"  >&lt;p&gt;Ok I realized I can&apos;t attach anything being the case close so I will only post the modification I made:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Changed the brockerURL properties from the bean queueConnectionFactory to
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;prop key=&lt;span class=&quot;code-quote&quot;&gt;&quot;brokerURL&quot;&lt;/span&gt; &amp;gt;tcp:&lt;span class=&quot;code-comment&quot;&gt;//localhost:61616?jms.redeliveryPolicy.maximumRedeliveries=10%26jms.redeliveryPolicy.initialRedeliveryDelay=10000%26jms.redeliveryPolicy.deliveryDelay=10000%26jms.redeliveryPolicy.useExponentialBackOff=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;%26jms.redeliveryPolicy.backOffMultiplier=2&amp;lt;/prop&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;Replaced the pom with the following one
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&amp;lt;project xmlns=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://maven.apache.org/POM/4.0.0&quot;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;xmlns:xsi&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;/span&gt;
	xsi:schemaLocation=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&lt;/span&gt;&amp;gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;modelVersion&amp;gt;&lt;/span&gt;4.0.0&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/modelVersion&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;test&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;activemq-test&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;packaging&amp;gt;&lt;/span&gt;jar&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/packaging&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;name&amp;gt;&lt;/span&gt;activemq-xaconnection-factory-test&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;0.1&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;url&amp;gt;&lt;/span&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/url&amp;gt;&lt;/span&gt;

	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;properties&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;slf4j.version&amp;gt;&lt;/span&gt;1.6.1&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/slf4j.version&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;spring.version&amp;gt;&lt;/span&gt;3.0.6.RELEASE&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/spring.version&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/properties&amp;gt;&lt;/span&gt;

	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependencies&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.geronimo.specs&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;geronimo-jms_1.1_spec&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;1.0&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.geronimo.specs&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;geronimo-jta_1.0.1B_spec&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;1.1.1&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;junit&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;junit&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;4.9&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;scope&amp;gt;&lt;/span&gt;test&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/scope&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;

		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.springframework&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;spring-core&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${spring.version}&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.springframework&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;spring-aop&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${spring.version}&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.springframework&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;spring-jdbc&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${spring.version}&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.springframework&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;spring-context&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${spring.version}&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.springframework&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;spring-beans&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${spring.version}&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.springframework&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;spring-jms&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${spring.version}&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.slf4j&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;slf4j-api&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${slf4j.version}&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.slf4j&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;slf4j-log4j12&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${slf4j.version}&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.activemq&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;activemq-core&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;5.5.1&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.codehaus.btm&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;btm&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;2.1.2&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.springframework&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;spring-test&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${spring.version}&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;scope&amp;gt;&lt;/span&gt;test&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/scope&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;exclusions&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;exclusion&amp;gt;&lt;/span&gt;
					&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;commons-logging&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
					&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;commons-logging&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/exclusion&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/exclusions&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependencies&amp;gt;&lt;/span&gt;

	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;build&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;plugins&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;plugin&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.maven.plugins&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;maven-compiler-plugin&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt;
					&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;fork&amp;gt;&lt;/span&gt;true&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/fork&amp;gt;&lt;/span&gt;
					&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;source&amp;gt;&lt;/span&gt;1.6&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/source&amp;gt;&lt;/span&gt;
					&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;target&amp;gt;&lt;/span&gt;1.6&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/target&amp;gt;&lt;/span&gt;
					&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;meminitial&amp;gt;&lt;/span&gt;128m&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/meminitial&amp;gt;&lt;/span&gt;
					&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;maxmem&amp;gt;&lt;/span&gt;512m&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/maxmem&amp;gt;&lt;/span&gt;
					&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;encoding&amp;gt;&lt;/span&gt;UTF-8&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/encoding&amp;gt;&lt;/span&gt;
					&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;debug&amp;gt;&lt;/span&gt;true&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/debug&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/plugin&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;plugin&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.maven.plugins&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;maven-surefire-plugin&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt;
					&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;forkMode&amp;gt;&lt;/span&gt;pertest&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/forkMode&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/plugin&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;plugin&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;maven-assembly-plugin&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;2.2.1&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt;
					&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;descriptorRefs&amp;gt;&lt;/span&gt;
						&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;descriptorRef&amp;gt;&lt;/span&gt;project&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/descriptorRef&amp;gt;&lt;/span&gt;
					&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/descriptorRefs&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/plugin&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/plugins&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/build&amp;gt;&lt;/span&gt;

&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/project&amp;gt;&lt;/span&gt;

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Can the case be reopened?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13235316" author="jaskiratbhatia" created="Thu, 22 Mar 2012 03:53:08 +0000"  >&lt;p&gt;Hi Alberto&lt;br/&gt;
leme try to reopen the case. I never followed on this case, but I am sure there is a problem.&lt;/p&gt;</comment>
                            <comment id="13235317" author="jaskiratbhatia" created="Thu, 22 Mar 2012 03:53:43 +0000"  >&lt;p&gt;Based on alberto&apos;s comment I will reopen this bug&lt;/p&gt;</comment>
                            <comment id="13235564" author="genjosanzo" created="Thu, 22 Mar 2012 13:15:22 +0000"  >&lt;p&gt;Thanks Jas, please find attached the new test case&lt;/p&gt;</comment>
                            <comment id="13256638" author="jmbaker" created="Wed, 18 Apr 2012 15:23:21 +0000"  >&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;I&apos;ve got some information to add. I&apos;ve debugged this and find the following code being (correctly?) executed in ActiveMQMessageConsumer when a message is rolled back:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (redeliveryDelay &amp;gt; 0 &amp;amp;&amp;amp; !unconsumedMessages.isClosed()) {
                        &lt;span class=&quot;code-comment&quot;&gt;// Start up the delivery again a little later.
&lt;/span&gt;                        scheduler.executeAfterDelay(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Runnable&lt;/span&gt;() {
                            &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void run() {
                                &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
                                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (started.get()) {
                                        start();
                                    }
                                } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (JMSException e) {
                                    session.connection.onAsyncException(e);
                                }
                            }
                        }, redeliveryDelay);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The value of redeliveryDelay (in ms) is correct. However, the &quot;problem&quot; is the Spring DefaultMessageListener, which asks ActiveMQ for another message and it gives back the message waiting for redelivery. I can see that the thread has the same ID in the debugger, so I think the problem is better described as:&lt;/p&gt;

&lt;p&gt;&quot;ActiveMQ does not remove the message due for redelivery from the queue, but gives it out next time it&apos;s asked to do so. After X retries, it&apos;s moved to the DLQ and hence the listener will not receive it again when it asks for the next message&quot;.&lt;/p&gt;

&lt;p&gt;This is a very serious problem.&lt;/p&gt;


&lt;p&gt;J&lt;/p&gt;</comment>
                            <comment id="13426318" author="ayqooi" created="Wed, 1 Aug 2012 04:13:43 +0000"  >&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;Did this get resolved?!&lt;/p&gt;

&lt;p&gt;We are using ActiveMQ 5.5.1 (second latest.. I see that 5.6.0 is available) and am seeing this exact issue. The redeliveryDelay in the latest comment is set correctly, but the message is getting picked up immediately by the Listener...&lt;/p&gt;

&lt;p&gt;Thus, our configurations for redelivery are not being respected.&lt;/p&gt;

&lt;p&gt;Is there any intention to fix this? We are not using the persistent mechanism of ActiveMQ. Haven&apos;t tried with persistence, but this is not ideal for our scenario anyway. We want to keep messages non-persistent, but also want the redelivery to occur when a transaction is rolled back and respect the redelivery configuration so that we dont use up all of our redeliveries in such a short space of time.&lt;/p&gt;</comment>
                            <comment id="13426673" author="tabish121" created="Wed, 1 Aug 2012 14:48:10 +0000"  >&lt;p&gt;Added to /activemq-core/src/test/java/org/apache/activemq/ActiveMQXAConnectionFactoryTest.java to show that there is no issue on client.  The test case has an incorrect option &apos;deliveryDelay&apos; which should be &apos;redeliveryDelay&apos;&lt;/p&gt;</comment>
                            <comment id="13426674" author="tabish121" created="Wed, 1 Aug 2012 14:48:43 +0000"  >&lt;p&gt;Added to unit test for the /activemq-core/src/test/java/org/apache/activemq/ActiveMQXAConnectionFactoryTest.java to show options are set as supplied on the URI.&lt;/p&gt;</comment>
                            <comment id="13436754" author="genjosanzo" created="Fri, 17 Aug 2012 14:23:36 +0000"  >&lt;p&gt;Hello Timothy, I&apos;ve just run the ast version of the test case you attached but I don&apos;t see any delay between redeliveries:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2012-08-17 11:16:59,897 [queueListenerPojo-1] WARN  org.springframework.jms.listener.DefaultMessageListenerContainer  - Execution of JMS message listener failed, and no ErrorHandler has been set.
java.lang.IllegalStateException: an exception
	at test.LoggingMessageListener.onMessage(LoggingMessageListener.java:22)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:309)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
	at $Proxy13.onMessage(Unknown Source)
	at org.springframework.jms.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:560)
	at org.springframework.jms.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:498)
	at org.springframework.jms.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:467)
	at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.doReceiveAndExecute(AbstractPollingMessageListenerContainer.java:325)
	at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.receiveAndExecute(AbstractPollingMessageListenerContainer.java:243)
	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.invokeListener(DefaultMessageListenerContainer.java:1058)
	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.executeOngoingLoop(DefaultMessageListenerContainer.java:1050)
	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.run(DefaultMessageListenerContainer.java:947)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:680)
2012-08-17 11:16:59,902 [queueListenerPojo-1] INFO  test.LoggingMessageListener  - received: ActiveMQTextMessage {commandId = 10, responseRequired = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, messageId = ID:MacBook-Pro-de-Alberto-Aresca-2.local-65429-1345213018686-2:1:2:1:1, originalDestination = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, originalTransactionId = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, producerId = ID:MacBook-Pro-de-Alberto-Aresca-2.local-65429-1345213018686-2:1:2:1, destination = queue:&lt;span class=&quot;code-comment&quot;&gt;//myQueue, transactionId = XID:1114926712:737072696e672d62746d0000013934f1b46700000001:737072696e672d62746d0000013934f1b48b00000004, expiration = 0, timestamp = 1345213019275, arrival = 0, brokerInTime = 1345213019327, brokerOutTime = 1345213019901, correlationId = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, replyTo = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, persistent = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, type = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, priority = 4, groupID = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, groupSequence = 0, targetConsumerId = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, compressed = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, userID = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, content = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, marshalledProperties = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, dataStructure = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, redeliveryCounter = 10, size = 0, properties = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, readOnlyProperties = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, readOnlyBody = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, droppable = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, text = text message}
&lt;/span&gt;2012-08-17 11:16:59,903 [queueListenerPojo-1] WARN  org.springframework.jms.listener.DefaultMessageListenerContainer  - Execution of JMS message listener failed, and no ErrorHandler has been set.
java.lang.IllegalStateException: an exception
	at test.LoggingMessageListener.onMessage(LoggingMessageListener.java:22)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:309)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
	at $Proxy13.onMessage(Unknown Source)
	at org.springframework.jms.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:560)
	at org.springframework.jms.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:498)
	at org.springframework.jms.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:467)
	at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.doReceiveAndExecute(AbstractPollingMessageListenerContainer.java:325)
	at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.receiveAndExecute(AbstractPollingMessageListenerContainer.java:243)
	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.invokeListener(DefaultMessageListenerContainer.java:1058)
	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.executeOngoingLoop(DefaultMessageListenerContainer.java:1050)
	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.run(DefaultMessageListenerContainer.java:947)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:680)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As you can se from the log of my last 2 redeliveries the wait is of about 10 ms while it should be 10s*2*$(last_redelivery_timeout}&lt;/p&gt;

&lt;p&gt;Am I missing something?&lt;/p&gt;</comment>
                            <comment id="13436757" author="tabish121" created="Fri, 17 Aug 2012 14:28:20 +0000"  >&lt;p&gt;You are welcome to create a JUnit test case that shows your issue and attach it here for review.&lt;/p&gt;</comment>
                            <comment id="13436823" author="genjosanzo" created="Fri, 17 Aug 2012 16:13:29 +0000"  >&lt;p&gt;I&apos;ve used the same test replacing deliveryDelay with redeliveryDelay but i&apos;m still experiencing the same behavior and I&apos;m under the impression that whatever value I set there won&apos;t simply be taken in account by the XA Redelivery policy.&lt;/p&gt;

&lt;p&gt;I&apos;ve attached a new version of the testcase.&lt;/p&gt;</comment>
                            <comment id="13436828" author="genjosanzo" created="Fri, 17 Aug 2012 16:18:59 +0000"  >&lt;p&gt;Unfortunately I can&apos;t attach anything to the case (i guess because the case has been closed), but it can be easily reproduced by simply replacing the jms.redeliveryPolicy.deliveryDelay in the test-context.xml file to jms.redeliveryPolicy.redeliveryDelay.&lt;/p&gt;</comment>
                            <comment id="13436899" author="tabish121" created="Fri, 17 Aug 2012 17:36:17 +0000"  >&lt;p&gt;Recommend you try and modify the test case  /activemq-core/src/test/java/org/apache/activemq/ActiveMQXAConnectionFactoryTest.java to show your issue and open a new Jira ticket to track its progress. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12636594">AMQ-4367</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12519438" name="activemq-test-0.1-project.zip" size="12761" author="genjosanzo" created="Thu, 22 Mar 2012 13:15:21 +0000"/>
                            <attachment id="12476639" name="activemq-test.zip" size="13228" author="jaskiratbhatia" created="Mon, 18 Apr 2011 18:24:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33594</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 14 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ec0n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>81709</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310080" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Regression</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10092"><![CDATA[Unit Test Broken]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>