<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:35:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-1487] Bug in ActiveMQSession::send() prevents non-persistent messages from being sent sync</title>
                <link>https://issues.apache.org/jira/browse/AMQ-1487</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;I have not tested this issue against any version other than 4.0.2.&lt;/p&gt;

&lt;p&gt;ActiveMQSession::send() contains the following code:&lt;br/&gt;
        if(&lt;span class=&quot;error&quot;&gt;Unable to render embedded object: File (msg.isPersistent() ) not found.&lt;/span&gt;=null) &lt;/p&gt;
{
            this.connection.asyncSendPacket(msg);
        } else {
            this.connection.syncSendPacket(msg);
        }&lt;br/&gt;
&lt;br/&gt;
This predicate short-circuits if the message is non-persistent and sends the message async even if the message is marked with &quot;Response Required&quot;.&lt;br/&gt;
&lt;br/&gt;
Modified the predicate to:&lt;br/&gt;
        if(!msg.isResponseRequired() &amp;amp;&amp;amp; (!msg.isPersistent() || connection.isUseAsyncSend() || txid!=null)) {            this.connection.asyncSendPacket(msg);        }
&lt;p&gt; else &lt;/p&gt;
{
            this.connection.syncSendPacket(msg);
        }

&lt;p&gt;This local patch resolved my issue.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows XP, AMQ 4.0.2, Client side non-peristent but response-required message producer to an embedded broker with a failover demand forwarding bridge to a persisting broker (persisting broker has a custom broker filter to mark all incoming messages as persistent).&lt;/p&gt;</environment>
        <key id="12481820">AMQ-1487</key>
            <summary>Bug in ActiveMQSession::send() prevents non-persistent messages from being sent sync</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rajdavies">Robert Davies</assignee>
                                    <reporter username="chrish">Christian Holzer</reporter>
                        <labels>
                    </labels>
                <created>Tue, 6 Nov 2007 14:19:02 +0000</created>
                <updated>Wed, 9 Apr 2008 14:07:18 +0000</updated>
                            <resolved>Wed, 9 Apr 2008 14:07:18 +0000</resolved>
                                    <version>4.0.2</version>
                                    <fixVersion>5.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12939128" author="chrish" created="Fri, 9 Nov 2007 01:58:29 +0000"  >&lt;p&gt;Wow, that was some bad copy/paste work.  sorry.  Redoing the before/after code below:&lt;/p&gt;

&lt;p&gt;Before:&lt;br/&gt;
       if (&lt;span class=&quot;error&quot;&gt;Unable to render embedded object: File (msg.isPersistent() ) not found.&lt;/span&gt;=null)) &lt;/p&gt;
{
            this.connection.asyncSendPacket(msg);
        } else {
            this.connection.syncSendPacket(msg);
        }&lt;br/&gt;
&lt;br/&gt;
After:&lt;br/&gt;
      if(!msg.isResponseRequired() &amp;amp;&amp;amp; (!msg.isPersistent() || connection.isUseAsyncSend() || txid!=null)) {            this.connection.asyncSendPacket(msg);        }
&lt;p&gt; else &lt;/p&gt;
{
            this.connection.syncSendPacket(msg);
        }</comment>
                            <comment id="12939194" author="chrish" created="Fri, 9 Nov 2007 02:07:37 +0000"  >&lt;p&gt;sorry for the copy/past misfires.  i&apos;ve just attached the updated source file.  My modifications are clearly marked in ActiveMQSession.send()&lt;/p&gt;</comment>
                            <comment id="12939211" author="rajdavies" created="Wed, 28 Nov 2007 20:23:30 +0000"  >&lt;p&gt;this is fixed in version 5 ???&lt;/p&gt;</comment>
                            <comment id="12939506" author="rajdavies" created="Wed, 9 Apr 2008 14:07:18 +0000"  >&lt;p&gt;Fixed by svn revision 646363&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12460671" name="ActiveMQSession.java" size="71826" author="chrish" created="Fri, 9 Nov 2007 02:06:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>84414</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 33 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0s2r3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161922</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>