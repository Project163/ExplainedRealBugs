<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:00:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-4575] JDBCIOExceptionHandler does not restart TransportConnector when JMX is enabled  on broker - java.io.IOException: Transport Connector could not be registered in JMX</title>
                <link>https://issues.apache.org/jira/browse/AMQ-4575</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>
&lt;p&gt;Without JMX enabled on the broker; when the DB is shutdown and subsequently restarted the JDBCIOExceptionHandler does a shutdown and restart on the transport connector as expected.&lt;/p&gt;

&lt;p&gt;However when JMX is enabled on the broker the transport connector fails to restart throwing the following exception and subsequently shutting down the broker &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2013-06-06 15:25:22,113 [st IO exception] - INFO  DefaultIOExceptionHandler      - Stopping the broker due to exception, java.io.IOException: Transport Connector could not be registered in JMX: org.apache.activemq:type=Broker,brokerName=localhost,connector=clientConnectors,connectorName=tcp_&lt;span class=&quot;code-comment&quot;&gt;//sideshow.home_61616
&lt;/span&gt;java.io.IOException: Transport Connector could not be registered in JMX: org.apache.activemq:type=Broker,brokerName=localhost,connector=clientConnectors,connectorName=tcp_&lt;span class=&quot;code-comment&quot;&gt;//sideshow.home_61616
&lt;/span&gt;	at org.apache.activemq.util.IOExceptionSupport.create(IOExceptionSupport.java:27)
	at org.apache.activemq.broker.BrokerService.registerConnectorMBean(BrokerService.java:1972)
	at org.apache.activemq.broker.BrokerService.startTransportConnector(BrokerService.java:2434)
	at org.apache.activemq.broker.BrokerService.startAllConnectors(BrokerService.java:2351)
	at org.apache.activemq.util.DefaultIOExceptionHandler$2.run(DefaultIOExceptionHandler.java:101)
Caused by: javax.management.InstanceAlreadyExistsException: org.apache.activemq:type=Broker,brokerName=localhost,connector=clientConnectors,connectorName=tcp_&lt;span class=&quot;code-comment&quot;&gt;//sideshow.home_61616
&lt;/span&gt;	at com.sun.jmx.mbeanserver.Repository.addMBean(Repository.java:453)
	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.internal_addObject(DefaultMBeanServerInterceptor.java:1484)
	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerDynamicMBean(DefaultMBeanServerInterceptor.java:963)
	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerObject(DefaultMBeanServerInterceptor.java:917)
	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerMBean(DefaultMBeanServerInterceptor.java:312)
	at com.sun.jmx.mbeanserver.JmxMBeanServer.registerMBean(JmxMBeanServer.java:482)
	at org.apache.activemq.broker.jmx.ManagementContext.registerMBean(ManagementContext.java:380)
	at org.apache.activemq.broker.jmx.AnnotatedMBean.registerMBean(AnnotatedMBean.java:72)
	at org.apache.activemq.broker.BrokerService.registerConnectorMBean(BrokerService.java:1969)
	... 3 more

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;tested against latest apache trunk  (5.9 - snapshot)&lt;br/&gt;
svn 14900032&lt;/p&gt;</environment>
        <key id="12651332">AMQ-4575</key>
            <summary>JDBCIOExceptionHandler does not restart TransportConnector when JMX is enabled  on broker - java.io.IOException: Transport Connector could not be registered in JMX</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tabish">Timothy A. Bish</assignee>
                                    <reporter username="pgfox">Pat Fox</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Jun 2013 13:38:20 +0000</created>
                <updated>Fri, 19 Jun 2015 19:14:57 +0000</updated>
                            <resolved>Thu, 6 Jun 2013 16:33:03 +0000</resolved>
                                    <version>5.8.0</version>
                                    <fixVersion>5.9.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13677020" author="pgfox" created="Thu, 6 Jun 2013 13:42:24 +0000"  >&lt;p&gt;Attached a unit test for the issue- JDBCIOExceptionHandlerTest.java&lt;/p&gt;</comment>
                            <comment id="13677030" author="pgfox" created="Thu, 6 Jun 2013 13:54:07 +0000"  >&lt;p&gt;It seems that org.apache.activemq.broker.BrokerService.stopAllConnectors(...) does not unregister the transport connectors MBean.&lt;/p&gt;</comment>
                            <comment id="13677209" author="tabish121" created="Thu, 6 Jun 2013 16:33:03 +0000"  >&lt;p&gt;fixed on trunk.&lt;/p&gt;</comment>
                            <comment id="13983125" author="gilesdsilva" created="Mon, 28 Apr 2014 15:48:31 +0000"  >&lt;p&gt;The transport connectors are unregistered when stopping the broker service but the transport connector list is not cleared, so when we restart the broker (eg: Database failover) the transport connectors get duplicated and now we try to register them twice leading to a &quot;java.io.IOException: Transport Connector could not be registered in JMX: Failed to bind to server socket&quot;&lt;/p&gt;
</comment>
                            <comment id="13983396" author="tabish121" created="Mon, 28 Apr 2014 19:04:26 +0000"  >&lt;p&gt;Can you create a JUnit test along the lines of the JDBCIOExceptionHandlerTest that was originally added to show the issue you are running into?&lt;/p&gt;</comment>
                            <comment id="13983689" author="gilesdsilva" created="Mon, 28 Apr 2014 22:37:24 +0000"  >&lt;p&gt;Attached a unit test for the issue - Failed to bind to server socket&lt;/p&gt;</comment>
                            <comment id="13984331" author="tabish121" created="Tue, 29 Apr 2014 14:15:27 +0000"  >&lt;p&gt;The file you attached actually appears to be a copy of BrokerService.java.  &lt;/p&gt;</comment>
                            <comment id="13984395" author="gilesdsilva" created="Tue, 29 Apr 2014 15:17:49 +0000"  >&lt;p&gt;Oops! Re-attached the right one now&lt;/p&gt;</comment>
                            <comment id="14593817" author="volkerk" created="Fri, 19 Jun 2015 19:14:57 +0000"  >&lt;p&gt;Ugh. &quot;The transport connectors are unregistered when stopping the broker service but the transport connector list is not cleared&quot;. In other words they were NOT being unregistered.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12642473" name="DuplicateTransportConnectorsInListTest.java" size="8036" author="gilesdsilva" created="Tue, 29 Apr 2014 15:17:19 +0000"/>
                            <attachment id="12586499" name="JDBCIOExceptionHandlerTest.java" size="6723" author="pgfox" created="Thu, 6 Jun 2013 13:42:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>331658</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 22 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1l7sv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>331989</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>