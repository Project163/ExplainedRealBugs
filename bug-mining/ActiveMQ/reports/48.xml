<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:30:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-687] Multiple durable topics don&apos;t work with network of brokers</title>
                <link>https://issues.apache.org/jira/browse/AMQ-687</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;There is a problem with a network of brokers with regards to a single consumer subscribing to multiple durable topics.  &lt;/p&gt;

&lt;p&gt;To recreate the issue, I changed examples/ConsumerTool.java to subscribe to two durable topics, with the createDurableSubscriber calls changed to look like this:&lt;br/&gt;
                consumer = session.createDurableSubscriber(topic1, topic1.getTopicName() );&lt;br/&gt;
                consumer2 = session.createDurableSubscriber( topic2, topic2.getTopicName() );&lt;br/&gt;
This ensures that the name of the durable subscriptions are unique, rather than using the &quot;consumerName&quot; as the base example code does.&lt;/p&gt;

&lt;p&gt;The problem is with any remote brokers: it appears that the broker-to-broker code for durable subscriptions does not &lt;b&gt;uniquely&lt;/b&gt; set the subscription name for multiple durable subscriptions to different topics.  Here is the message and exception information from the remote broker:&lt;/p&gt;

&lt;p&gt;&amp;lt;INFO&amp;gt; &amp;lt;org.apache.activemq.broker.AbstractConnection.Service&amp;gt; &amp;lt; Mon 2006/04/10 10:50:52:660 &amp;gt; &amp;lt;org.apache.activemq.broker.AbstractConnection.se&lt;br/&gt;
rviceException&amp;gt; &amp;lt;Thread&lt;span class=&quot;error&quot;&gt;&amp;#91;tcp://sbtmdgca/170.137.15.64:61618,5,main&amp;#93;&lt;/span&gt;&amp;gt; Async error occurred: javax.jms.JMSException: Durable consumer is in use for&lt;br/&gt;
 client: NC_ProdDN3AsbtmdgcasbtmdgcAMQDN_inboundProdDN3Bsbtgc0bsbtgc0AMQDN and subscriptionName: ProdDN3Bsbtgc0bsbtgc0AMQDN&lt;br/&gt;
&amp;lt;INFO&amp;gt; Stack Trace follows:&lt;br/&gt;
javax.jms.JMSException: Durable consumer is in use for client: NC_ProdDN3AsbtmdgcasbtmdgcAMQDN_inboundProdDN3Bsbtgc0bsbtgc0AMQDN and subscriptio&lt;br/&gt;
nName: ProdDN3Bsbtgc0bsbtgc0AMQDN&lt;br/&gt;
        at org.apache.activemq.broker.region.TopicRegion.addConsumer(TopicRegion.java:81)&lt;br/&gt;
        at org.apache.activemq.broker.region.RegionBroker.addConsumer(RegionBroker.java:276)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.addConsumer(BrokerFilter.java:69)&lt;br/&gt;
        at org.apache.activemq.advisory.AdvisoryBroker.addConsumer(AdvisoryBroker.java:75)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.addConsumer(BrokerFilter.java:69)&lt;br/&gt;
        at org.apache.activemq.broker.MutableBrokerFilter.addConsumer(MutableBrokerFilter.java:81)&lt;br/&gt;
        at org.apache.activemq.broker.AbstractConnection.processAddConsumer(AbstractConnection.java:422)&lt;br/&gt;
        at org.apache.activemq.command.ConsumerInfo.visit(ConsumerInfo.java:291)&lt;br/&gt;
        at org.apache.activemq.broker.AbstractConnection.service(AbstractConnection.java:196)&lt;br/&gt;
        at org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:62)&lt;br/&gt;
        at org.apache.activemq.transport.ResponseCorrelator.onCommand(ResponseCorrelator.java:88)&lt;br/&gt;
        at org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:70)&lt;br/&gt;
        at org.apache.activemq.transport.vm.VMTransport.oneway(VMTransport.java:75)&lt;br/&gt;
        at org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:44)&lt;br/&gt;
        at org.apache.activemq.transport.ResponseCorrelator.oneway(ResponseCorrelator.java:55)&lt;br/&gt;
        at org.apache.activemq.network.DemandForwardingBridgeSupport.addSubscription(DemandForwardingBridgeSupport.java:344)&lt;br/&gt;
        at org.apache.activemq.network.DemandForwardingBridgeSupport.serviceRemoteConsumerAdvisory(DemandForwardingBridgeSupport.java:324)&lt;br/&gt;
        at org.apache.activemq.network.DemandForwardingBridgeSupport.serviceRemoteCommand(DemandForwardingBridgeSupport.java:274)&lt;br/&gt;
        at org.apache.activemq.network.DemandForwardingBridgeSupport$2.onCommand(DemandForwardingBridgeSupport.java:120)&lt;br/&gt;
        at org.apache.activemq.transport.ResponseCorrelator.onCommand(ResponseCorrelator.java:88)&lt;br/&gt;
        at org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:70)&lt;br/&gt;
        at org.apache.activemq.transport.failover.FailoverTransport$1.onCommand(FailoverTransport.java:103)&lt;br/&gt;
        at org.apache.activemq.transport.WireFormatNegotiator.onCommand(WireFormatNegotiator.java:114)&lt;br/&gt;
        at org.apache.activemq.transport.InactivityMonitor.onCommand(InactivityMonitor.java:122)&lt;br/&gt;
        at org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:87)&lt;br/&gt;
        at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:139)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:595)&lt;/p&gt;


&lt;p&gt;You can see that the &quot;subscriptionName&quot; used from the originating broker is the brokerName.  This will never handle multiple durable subscriptions (different topics) from the same consumer.&lt;/p&gt;

&lt;p&gt;Perhaps in addition to the brokerName, the original topic name could be used?  Or, just the topic name, since clientId is supposed to make it unique anyway.&lt;/p&gt;</description>
                <environment>&lt;p&gt;AMQ RC2, Solaris 8 / 10, JDK 1.5&lt;/p&gt;</environment>
        <key id="12481683">AMQ-687</key>
            <summary>Multiple durable topics don&apos;t work with network of brokers</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rajdavies">Robert Davies</assignee>
                                    <reporter username="yaussy">Kevin Yaussy</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 Apr 2006 00:12:59 +0000</created>
                <updated>Tue, 11 Apr 2006 01:19:02 +0000</updated>
                            <resolved>Tue, 11 Apr 2006 01:19:02 +0000</resolved>
                                    <version>4.0 RC2</version>
                                    <fixVersion>4.0 RC3</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12937732" author="rajdavies" created="Tue, 11 Apr 2006 01:19:02 +0000"  >&lt;p&gt;fix applied to generate subscriberName based on brokerName plus destination name&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>84300</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 34 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0s013:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161481</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>