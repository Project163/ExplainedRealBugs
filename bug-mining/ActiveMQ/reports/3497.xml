<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:59:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-9658] TcpTransport volatile receiveCounter is not incremented atomically</title>
                <link>https://issues.apache.org/jira/browse/AMQ-9658</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;incrementing volatile integers is not an atomic operation because the previous value must first be read, then incremented, and reset so it is a multi step process. I noticed in the TCP transport code that the receive counter was a volatile integer and not being incremented properly.  This counter is should only be incremented in the same thread anyways (it can be read by other threads like inactivity monitor) so it may not technically be an issue in practice  but it still should be handled properly.&lt;/p&gt;

&lt;p&gt;The fix is to switch to an AtomicInteger. I also noticed a minor improvement to make to to the NIOSSLtransport init code that is only used for the auto+nio+ssl transport that I will fix as well. (ensure the full initialization buffer will always be entirely read and processed when using the auto+nio+ssl transport. ) This only applies to OpenWire and AMQP.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13607322">AMQ-9658</key>
            <summary>TcpTransport volatile receiveCounter is not incremented atomically</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cshannon">Christopher L. Shannon</assignee>
                                    <reporter username="cshannon">Christopher L. Shannon</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Feb 2025 18:17:33 +0000</created>
                <updated>Thu, 6 Feb 2025 01:40:08 +0000</updated>
                            <resolved>Wed, 5 Feb 2025 15:24:16 +0000</resolved>
                                    <version>5.18.6</version>
                    <version>6.1.5</version>
                                    <fixVersion>6.2.0</fixVersion>
                    <fixVersion>5.19.0</fixVersion>
                    <fixVersion>6.1.6</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="17924109" author="jira-bot" created="Wed, 5 Feb 2025 15:02:33 +0000"  >&lt;p&gt;Commit d9e89f4b5fdb21da54e47588988161accd0fc9d6 in activemq&apos;s branch refs/heads/main from Christopher L. Shannon&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=d9e89f4b5f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=d9e89f4b5f&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-9658&quot; title=&quot;TcpTransport volatile receiveCounter is not incremented atomically&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-9658&quot;&gt;&lt;del&gt;AMQ-9658&lt;/del&gt;&lt;/a&gt; - Properly increment transport receive counter (#1389)&lt;/p&gt;

&lt;p&gt;Switch to using an AtomicInteger for tracking bytes received in a&lt;br/&gt;
TcpTransport. This makes incrementing the counter an atomic operation.&lt;br/&gt;
Previously a volatile int was used and incrementing volatiles is not&lt;br/&gt;
atomic because it&apos;s a 3 step process of read, update, set.&lt;/p&gt;

&lt;p&gt;This also makes a small fix to ensure that the full initialization&lt;br/&gt;
buffer will always be entirely read and processed when using&lt;br/&gt;
the auto+nio+ssl transport. Previous the code assumed only the first&lt;br/&gt;
command was stored in the initialization buffer but technically more&lt;br/&gt;
bytes could exist for a future command (even if unlikely with the&lt;br/&gt;
current Java implementation).&lt;/p&gt;</comment>
                            <comment id="17924111" author="jira-bot" created="Wed, 5 Feb 2025 15:06:18 +0000"  >&lt;p&gt;Commit 4c8b277fe72a7852fc5896a6dc7147d4bd813a41 in activemq&apos;s branch refs/heads/activemq-6.1.x from Christopher L. Shannon&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=4c8b277fe7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=4c8b277fe7&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-9658&quot; title=&quot;TcpTransport volatile receiveCounter is not incremented atomically&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-9658&quot;&gt;&lt;del&gt;AMQ-9658&lt;/del&gt;&lt;/a&gt; - Properly increment transport receive counter (#1389)&lt;/p&gt;

&lt;p&gt;Switch to using an AtomicInteger for tracking bytes received in a&lt;br/&gt;
TcpTransport. This makes incrementing the counter an atomic operation.&lt;br/&gt;
Previously a volatile int was used and incrementing volatiles is not&lt;br/&gt;
atomic because it&apos;s a 3 step process of read, update, set.&lt;/p&gt;

&lt;p&gt;This also makes a small fix to ensure that the full initialization&lt;br/&gt;
buffer will always be entirely read and processed when using&lt;br/&gt;
the auto+nio+ssl transport. Previous the code assumed only the first&lt;br/&gt;
command was stored in the initialization buffer but technically more&lt;br/&gt;
bytes could exist for a future command (even if unlikely with the&lt;br/&gt;
current Java implementation).&lt;/p&gt;

&lt;p&gt;(cherry picked from commit d9e89f4b5fdb21da54e47588988161accd0fc9d6)&lt;/p&gt;</comment>
                            <comment id="17924114" author="jira-bot" created="Wed, 5 Feb 2025 15:18:03 +0000"  >&lt;p&gt;Commit c124f16249536abeeac9021575c9b3366a4e4a14 in activemq&apos;s branch refs/heads/activemq-5.19.x from Christopher L. Shannon&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=c124f16249&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=c124f16249&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-9658&quot; title=&quot;TcpTransport volatile receiveCounter is not incremented atomically&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-9658&quot;&gt;&lt;del&gt;AMQ-9658&lt;/del&gt;&lt;/a&gt; - Properly increment transport receive counter (#1389)&lt;/p&gt;

&lt;p&gt;Switch to using an AtomicInteger for tracking bytes received in a&lt;br/&gt;
TcpTransport. This makes incrementing the counter an atomic operation.&lt;br/&gt;
Previously a volatile int was used and incrementing volatiles is not&lt;br/&gt;
atomic because it&apos;s a 3 step process of read, update, set.&lt;/p&gt;

&lt;p&gt;This also makes a small fix to ensure that the full initialization&lt;br/&gt;
buffer will always be entirely read and processed when using&lt;br/&gt;
the auto+nio+ssl transport. Previous the code assumed only the first&lt;br/&gt;
command was stored in the initialization buffer but technically more&lt;br/&gt;
bytes could exist for a future command (even if unlikely with the&lt;br/&gt;
current Java implementation).&lt;/p&gt;

&lt;p&gt;(cherry picked from commit d9e89f4b5fdb21da54e47588988161accd0fc9d6)&lt;/p&gt;</comment>
                            <comment id="17924336" author="jira-bot" created="Thu, 6 Feb 2025 01:35:56 +0000"  >&lt;p&gt;Commit 526e83b3cb06ed099ef239b7b7c9d0d252f17a0f in activemq&apos;s branch refs/heads/main from Christopher L. Shannon&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=526e83b3cb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=526e83b3cb&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-9658&quot; title=&quot;TcpTransport volatile receiveCounter is not incremented atomically&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-9658&quot;&gt;&lt;del&gt;AMQ-9658&lt;/del&gt;&lt;/a&gt; - Improve auto+nio+ssl transport initialization for amqp&lt;/p&gt;

&lt;p&gt;This makes small fix to ensure that the full initialization&lt;br/&gt;
buffer will always be entirely read and processed when using&lt;br/&gt;
the auto+nio+ssl transport with amqp. Previously the code assumed&lt;br/&gt;
only 8 bytes would ever exist (which should be the case under normal&lt;br/&gt;
circumstances) but now it will handle any extra bytes if a client sent&lt;br/&gt;
more.&lt;/p&gt;</comment>
                            <comment id="17924337" author="jira-bot" created="Thu, 6 Feb 2025 01:39:33 +0000"  >&lt;p&gt;Commit 88c76c00df15553edf5266ec18a1ea1be80c23d1 in activemq&apos;s branch refs/heads/activemq-6.1.x from Christopher L. Shannon&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=88c76c00df&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=88c76c00df&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-9658&quot; title=&quot;TcpTransport volatile receiveCounter is not incremented atomically&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-9658&quot;&gt;&lt;del&gt;AMQ-9658&lt;/del&gt;&lt;/a&gt; - Improve auto+nio+ssl transport initialization for amqp&lt;/p&gt;

&lt;p&gt;This makes small fix to ensure that the full initialization&lt;br/&gt;
buffer will always be entirely read and processed when using&lt;br/&gt;
the auto+nio+ssl transport with amqp. Previously the code assumed&lt;br/&gt;
only 8 bytes would ever exist (which should be the case under normal&lt;br/&gt;
circumstances) but now it will handle any extra bytes if a client sent&lt;br/&gt;
more.&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 526e83b3cb06ed099ef239b7b7c9d0d252f17a0f)&lt;/p&gt;</comment>
                            <comment id="17924338" author="jira-bot" created="Thu, 6 Feb 2025 01:40:08 +0000"  >&lt;p&gt;Commit 730cd7353e5ec78e75992070704ebf88656827da in activemq&apos;s branch refs/heads/activemq-5.19.x from Christopher L. Shannon&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=730cd7353e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=730cd7353e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-9658&quot; title=&quot;TcpTransport volatile receiveCounter is not incremented atomically&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-9658&quot;&gt;&lt;del&gt;AMQ-9658&lt;/del&gt;&lt;/a&gt; - Improve auto+nio+ssl transport initialization for amqp&lt;/p&gt;

&lt;p&gt;This makes small fix to ensure that the full initialization&lt;br/&gt;
buffer will always be entirely read and processed when using&lt;br/&gt;
the auto+nio+ssl transport with amqp. Previously the code assumed&lt;br/&gt;
only 8 bytes would ever exist (which should be the case under normal&lt;br/&gt;
circumstances) but now it will handle any extra bytes if a client sent&lt;br/&gt;
more.&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 526e83b3cb06ed099ef239b7b7c9d0d252f17a0f)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            39 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1u0kg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>