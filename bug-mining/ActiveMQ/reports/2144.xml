<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:02:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-4952] When duplicate message occur from network producer, messages blocked by cursor audit are blocked till restart</title>
                <link>https://issues.apache.org/jira/browse/AMQ-4952</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;If auditNetworkProducers is off (as it is by default) a reforward (because of a missing send reply) will be a duplicate.&lt;br/&gt;
If the initial messages is still in the store the duplicate will be trapped by the   message cursor but the message remains in the store. So on a restart the cursor is fresh (unless in the case of jdbc when there are still messages in the store) and the message gets redispatched. In the jdbc case - if the store/destination is empty there will be a resend b/c there is no sequence state to replay.&lt;br/&gt;
Duplicates detected by the cursor need to deal with the duplicate message - moving to the DLQ makes the most sense - the cause can indicate the reason  to allow separation from poison due to redelivery failure.&lt;/p&gt;

&lt;p&gt;Client duplicate detection currently uses a poison ack, so this makes the behaviour consistent.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12685909">AMQ-4952</key>
            <summary>When duplicate message occur from network producer, messages blocked by cursor audit are blocked till restart</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gtully">Gary Tully</assignee>
                                    <reporter username="gtully">Gary Tully</reporter>
                        <labels>
                            <label>duplicate</label>
                            <label>network</label>
                            <label>stuck</label>
                    </labels>
                <created>Fri, 20 Dec 2013 22:15:41 +0000</created>
                <updated>Mon, 9 Jun 2014 11:40:17 +0000</updated>
                            <resolved>Wed, 8 Jan 2014 12:52:17 +0000</resolved>
                                    <version>5.9.0</version>
                                    <fixVersion>5.9.1</fixVersion>
                    <fixVersion>5.10.0</fixVersion>
                                    <component>Message Store</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13854620" author="gtully" created="Fri, 20 Dec 2013 22:19:10 +0000"  >&lt;p&gt;linking to &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-4465&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-4465&lt;/a&gt; for more context&lt;/p&gt;

&lt;p&gt;need to deal with duplicates to prevent eventuall delivery from &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-4924&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-4924&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13865384" author="gtully" created="Wed, 8 Jan 2014 12:52:17 +0000"  >&lt;p&gt;when the cursor detects a duplicate the message is removed and referred for DLQ processing with a reasonCause of &quot;duplicate from store&quot;&lt;br/&gt;
Thus it does not remain &quot;stuck&quot; till a restart. The typical use case where this can occur is with a duplicate forward from a network connector that fails  before getting a send reply happens after the original message has been dispatched. So the store does not trap the duplicate but the cursor does.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/activemq/commit/f92d45be&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/activemq/commit/f92d45be&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13866595" author="gtully" created="Thu, 9 Jan 2014 12:21:29 +0000"  >&lt;p&gt;dealt with the audit false case and duplicate in pagedInMessages - now redirecting to DLQ and removing from the store in that case also&lt;br/&gt;
&lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/activemq/commit/cc47ab6d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/activemq/commit/cc47ab6d&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;JDBC store does not have a separate index to trap the duplicate that is still inflight. Also, cursor audit window may be too small for some use cases.&lt;br/&gt;
If there is a valid usecase where duplicates are acceptable we can revisit but all tests currently pass with the change that &apos;outlaws&apos; and deals with duplicates.&lt;/p&gt;</comment>
                            <comment id="14022284" author="gtully" created="Mon, 9 Jun 2014 11:40:17 +0000"  >&lt;p&gt;further refinement in further refinement in &lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/activemq/commit/27b3a7c3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/activemq/commit/27b3a7c3&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12718604">AMQ-5212</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12683192">AMQ-4924</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12641837">AMQ-4465</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>365018</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 24 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1qx1j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>365327</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>