<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:30:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-585] InstanceAlreadyExistsException on .war redeploy (if useJmx=&quot;true)</title>
                <link>https://issues.apache.org/jira/browse/AMQ-585</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;I am using ActiveMQ as part of a web-app deployed to Tomcat. Active MQ is configured via spring and follows the spring examples that you ship with the source in M4. If I configure the broker to use JMX (  &amp;lt;broker useJmx=&quot;true&quot;&amp;gt; ) and deploy the app to tomcat, everything goes fine. However, when I deploy a newer version of the app (hot deploy) I get the following error when the JMS consumer is created from spring:&lt;/p&gt;

&lt;p&gt;006-02-20 15:16:17,378 ERROR org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:205) Context initialization failed&lt;br/&gt;
org.springframework.beans.factory.BeanCreationException: Error creating bean with name &apos;smsResponseConsumer&apos; defined in ServletContext resource &lt;span class=&quot;error&quot;&gt;&amp;#91;/WEB-INF/applicationContext-messaging.xml&amp;#93;&lt;/span&gt;: Initialization of bean failed; nested exception is javax.jms.JMSException: org.apache.activemq:Type=Topic,Destination=ActiveMQ.Advisory.Connection,BrokerName=localhost&lt;br/&gt;
javax.jms.JMSException: org.apache.activemq:Type=Topic,Destination=ActiveMQ.Advisory.Connection,BrokerName=localhost&lt;/p&gt;

&lt;p&gt;And the root cause of this exception is:&lt;/p&gt;

&lt;p&gt;Caused by: javax.management.InstanceAlreadyExistsException: org.apache.activemq:Type=Topic,Destination=ActiveMQ.Advisory.Connection,BrokerName=localhost&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)&lt;br/&gt;
	at java.lang.reflect.Constructor.newInstance(Constructor.java:274)&lt;br/&gt;
	at org.apache.activemq.openwire.DataStreamMarshaller.createThrowable(DataStreamMarshaller.java:199)&lt;br/&gt;
	at org.apache.activemq.openwire.DataStreamMarshaller.unmarsalThrowable(DataStreamMarshaller.java:159)&lt;br/&gt;
	at org.apache.activemq.openwire.v1.ExceptionResponseMarshaller.unmarshal(ExceptionResponseMarshaller.java:67)&lt;br/&gt;
	at org.apache.activemq.openwire.OpenWireFormat.doUnmarshal(OpenWireFormat.java:214)&lt;br/&gt;
	at org.apache.activemq.openwire.OpenWireFormat.unmarshal(OpenWireFormat.java:181)&lt;br/&gt;
	at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:135)&lt;br/&gt;
	... 1 more&lt;/p&gt;

&lt;p&gt;So it appears as if the JMX entry isn&apos;t &quot;unbound&quot; when the applicaiton restarts on a redeploy.&lt;/p&gt;

&lt;p&gt;If I set JMX to false then I can redeploy the application without any errors. &lt;/p&gt;</description>
                <environment>&lt;p&gt;SuSe Linux 9.1, Sun JDK 1.4.2_08, Tomcat 5.0.28&lt;/p&gt;</environment>
        <key id="12483261">AMQ-585</key>
            <summary>InstanceAlreadyExistsException on .war redeploy (if useJmx=&quot;true)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="massdosage">Mass Dosage</reporter>
                        <labels>
                    </labels>
                <created>Mon, 20 Feb 2006 16:27:19 +0000</created>
                <updated>Tue, 26 Apr 2016 14:43:42 +0000</updated>
                            <resolved>Tue, 7 Mar 2006 11:30:15 +0000</resolved>
                                    <version>4.0 M4</version>
                                    <fixVersion>4.0 RC2</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="12937549" author="jstrachan" created="Mon, 6 Mar 2006 21:23:13 +0000"  >&lt;p&gt;BTW could you describe exactly how you are deploying ActiveMQ in spring please - as there are a few optoins. Are you using the BrokerFactoryBean?&lt;/p&gt;</comment>
                            <comment id="12937546" author="massdosage" created="Mon, 6 Mar 2006 22:52:48 +0000"  >&lt;p&gt;I am indeed using the BrokerFactoryBean. My spring config looks something like this:&lt;/p&gt;

&lt;p&gt;	&amp;lt;!-- JMS CONFIGURATION --&amp;gt;	&lt;br/&gt;
	&amp;lt;bean id=&quot;brokerContainer&quot; class=&quot;org.apache.activemq.xbean.BrokerFactoryBean&quot; depends-on=&quot;activeMQConfigurer&quot;&amp;gt;&lt;br/&gt;
		&amp;lt;property name=&quot;config&quot; value=&quot;classpath:activemq.xml&quot;/&amp;gt;&lt;br/&gt;
	&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;bean id=&quot;jmsFactory&quot; class=&quot;org.apache.activemq.ActiveMQConnectionFactory&quot;&amp;gt;&lt;br/&gt;
		&amp;lt;property name=&quot;brokerURL&quot; value=&quot;tcp://localhost:61616&quot;/&amp;gt;&lt;br/&gt;
	&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;!-- Spring JMS Template --&amp;gt;&lt;br/&gt;
	&amp;lt;bean id=&quot;jmsTemplate&quot; class=&quot;org.springframework.jms.core.JmsTemplate&quot;&amp;gt;&lt;br/&gt;
		&amp;lt;property name=&quot;connectionFactory&quot;&amp;gt;&lt;br/&gt;
			&amp;lt;!-- lets wrap in a pool to avoid creating a connection per send --&amp;gt;&lt;br/&gt;
			&amp;lt;bean class=&quot;org.springframework.jms.connection.SingleConnectionFactory&quot;&amp;gt;&lt;br/&gt;
				&amp;lt;property name=&quot;targetConnectionFactory&quot; ref=&quot;jmsFactory&quot;/&amp;gt;&lt;br/&gt;
			&amp;lt;/bean&amp;gt;&lt;br/&gt;
		&amp;lt;/property&amp;gt;&lt;br/&gt;
		&amp;lt;property name=&quot;pubSubDomain&quot; value=&quot;false&quot;/&amp;gt;&lt;br/&gt;
	&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;The broker is then configured in activemq.xml like so:&lt;/p&gt;

&lt;p&gt;  &amp;lt;broker useJmx=&quot;false&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;persistenceAdapter&amp;gt;&lt;br/&gt;
      &amp;lt;journaledJDBC journalLogFiles=&quot;5&quot; dataDirectory=&quot;#activeMQConfigurer.dataDirectory&quot; dataSource=&quot;#activeMQConfigurer.dataSource&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/persistenceAdapter&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;transportConnectors&amp;gt;&lt;br/&gt;
       &amp;lt;transportConnector uri=&quot;tcp://localhost:61616&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/transportConnectors&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;networkConnectors&amp;gt;&lt;br/&gt;
      &amp;lt;networkConnector uri=&quot;static://(tcp://localhost:61616)&quot; /&amp;gt;&lt;br/&gt;
    &amp;lt;/networkConnectors&amp;gt;&lt;/p&gt;

&lt;p&gt;  &amp;lt;/broker&amp;gt;&lt;/p&gt;

&lt;p&gt;Let me know if there is any other information you need...&lt;/p&gt;</comment>
                            <comment id="12937511" author="jstrachan" created="Tue, 7 Mar 2006 11:30:14 +0000"  >&lt;p&gt;I&apos;ve just added the test case ReconnectWithJMXEnabledTest to ensure that all of our MBeans are properly unregistered if you call BrokerService.stop() (which should happen by default if you use the BrokerFactoryBean so AFAIK this issue is now resolved.&lt;/p&gt;

&lt;p&gt;If you still have an issue, let us know more details on how you are using tomcat, spring and activemq and we can always reopen this issue&lt;/p&gt;</comment>
                            <comment id="12937651" author="jstrachan" created="Wed, 8 Mar 2006 10:03:36 +0000"  >&lt;p&gt;Incidentally if this still is an issye - is your Spring application context being closed? Do you see any logging when you undeploy the WAR? Which mechanism are you using in web.xml to load spring&lt;/p&gt;</comment>
                            <comment id="12942259" author="akornev" created="Thu, 25 Mar 2010 15:56:03 +0000"  >&lt;p&gt;Hi!&lt;br/&gt;
I use ActiveMq 5.2.0.&lt;br/&gt;
In web.xml spring context get by org.springframework.web.context.ContextLoaderListener&lt;br/&gt;
Persistent = false&lt;/p&gt;

&lt;p&gt;And I have exception:&lt;br/&gt;
javax.jms.JMSException: Could not create Transport. Reason: javax.management.InstanceAlreadyExistsException: org.apache.activemq:BrokerName=localhost,Type=Broker&lt;br/&gt;
        at org.apache.activemq.util.JMSExceptionSupport.create(JMSExceptionSupport.java:35) &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq-5.2.0.jar:5.2.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.activemq.ActiveMQConnectionFactory.createTransport(ActiveMQConnectionFactory.java:239) &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq-5.2.0.jar:5.2.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.activemq.ActiveMQConnectionFactory.createActiveMQConnection(ActiveMQConnectionFactory.java:252) &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq-5.2.0.jar:5.2.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.activemq.ActiveMQConnectionFactory.createActiveMQConnection(ActiveMQConnectionFactory.java:224) &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq-5.2.0.jar:5.2.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.activemq.ActiveMQConnectionFactory.createConnection(ActiveMQConnectionFactory.java:172) &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq-5.2.0.jar:5.2.0&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Could you please help me with my problem.&lt;/p&gt;

&lt;p&gt;Thx!&lt;/p&gt;</comment>
                            <comment id="15258194" author="stuchl4n3k" created="Tue, 26 Apr 2016 14:43:42 +0000"  >&lt;p&gt;Hello there.&lt;/p&gt;

&lt;p&gt;Sorry to bring this up again, but I am probably experiencing the same issue here 6 years later.&lt;/p&gt;

&lt;p&gt;System setup:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Linux Mint 17.3 x64&lt;/li&gt;
	&lt;li&gt;Tomcat 7 with activemq-all.jar (v5.10.0) in tomcat7/lib
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;Tomcat context.xml&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;Resource name=&lt;span class=&quot;code-quote&quot;&gt;&quot;jms/myConnectionFactory&quot;&lt;/span&gt; auth=&lt;span class=&quot;code-quote&quot;&gt;&quot;Container&quot;&lt;/span&gt;
              type=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.activemq.ActiveMQConnectionFactory&quot;&lt;/span&gt;
              description=&lt;span class=&quot;code-quote&quot;&gt;&quot;JMS Connection Factory&quot;&lt;/span&gt;
              factory=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.activemq.jndi.JNDIReferenceFactory&quot;&lt;/span&gt;
              brokerURL=&lt;span class=&quot;code-quote&quot;&gt;&quot;vm:&lt;span class=&quot;code-comment&quot;&gt;//localhost&quot;&lt;/span&gt;
&lt;/span&gt;              brokerName=&lt;span class=&quot;code-quote&quot;&gt;&quot;LocalActiveMQBroker&quot;&lt;/span&gt;
              userName=&lt;span class=&quot;code-quote&quot;&gt;&quot;activemq&quot;&lt;/span&gt; password=&lt;span class=&quot;code-quote&quot;&gt;&quot;activemq&quot;&lt;/span&gt;
              useEmbeddedBroker=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt; /&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Using JMS with Spring 4.2.5 (Spring Integration JMS &amp;amp; Java DSL config). When invoking JMS outbound adapter I get the above-mentioned &lt;tt&gt;InstanceAlreadyExistsException&lt;/tt&gt;.&lt;br/&gt;
If I add &lt;tt&gt;useJmx=&quot;false&quot;&lt;/tt&gt;, the exception disappears.&lt;/p&gt;

&lt;p&gt;To answer the questions for &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jstrachan&quot; class=&quot;user-hover&quot; rel=&quot;jstrachan&quot;&gt;jstrachan&lt;/a&gt;:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Spring context is closed. I tried clean deploy and tomcat restart as well.&lt;/li&gt;
	&lt;li&gt;I don&apos;t see any logging related to AMQ other than a clash of bindings (not related I suppose):
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;SLF4J: &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt; path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/share/tomcat7/lib/activemq-all.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt;/lib/tomcat7/webapps/ROOT/WEB-INF/lib/logback-classic-1.0.13.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http:&lt;span class=&quot;code-comment&quot;&gt;//www.slf4j.org/codes.html#multiple_bindings &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; an explanation.
&lt;/span&gt;SLF4J: Actual binding is of type [ch.qos.logback.classic.util.ContextSelectorStaticBinder]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;I load multiple xml classpath files including spring-context.xml in my web.xml. I also import some JavaConfig beans and use aop proxy.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Any ideas?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>49225</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 30 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i17z2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>254653</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>