<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:30:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-639] Broker is not re-connecting to a network of brokers after going down and then being brought back up</title>
                <link>https://issues.apache.org/jira/browse/AMQ-639</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;I have set up a network of brokers with the following configuration:&lt;/p&gt;

&lt;p&gt;&amp;lt;beans xmlns=&quot;http://activemq.org/config/1.0&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;  &amp;lt;bean class=&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;  &amp;lt;broker brokerName=&quot;bfe-${HOSTNAME}&quot; useJmx=&quot;true&quot; persistent=&quot;false&quot; managementContext=&quot;#mc&quot;&amp;gt; &lt;br/&gt;
    &amp;lt;destinationPolicy&amp;gt;&lt;br/&gt;
      &amp;lt;policyMap&amp;gt;&lt;br/&gt;
        &amp;lt;policyEntries&amp;gt;&lt;br/&gt;
          &amp;lt;policyEntry queue=&quot;&amp;gt;&quot; memoryLimit=&quot;5000000&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;/policyEntries&amp;gt;&lt;br/&gt;
      &amp;lt;/policyMap&amp;gt;&lt;br/&gt;
   &amp;lt;/destinationPolicy&amp;gt;&lt;br/&gt;
   &amp;lt;memoryManager&amp;gt;&lt;br/&gt;
     &amp;lt;usageManager limit=&quot;100000000&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/memoryManager&amp;gt; &lt;/p&gt;

&lt;p&gt;    &amp;lt;transportConnectors&amp;gt;&lt;br/&gt;
    	&amp;lt;transportConnector uri=&quot;tcp://localhost:61616&quot; discoveryUri=&quot;multicast://bfe2&quot;/&amp;gt; &lt;br/&gt;
    &amp;lt;/transportConnectors&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;networkConnectors&amp;gt;&lt;br/&gt;
      &amp;lt;!-- by default just auto discover the other brokers --&amp;gt;&lt;br/&gt;
      &amp;lt;networkConnector uri=&quot;multicast://bfe2&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/networkConnectors&amp;gt;&lt;br/&gt;
   &amp;lt;/broker&amp;gt;&lt;/p&gt;

&lt;p&gt; &amp;lt;bean id=&quot;mc&quot; class=&quot;org.apache.activemq.broker.jmx.ManagementContext&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;property name=&quot;connectorPort&quot; value=&quot;1099&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;property name=&quot;connectorPath&quot; value=&quot;/jmxrmibfe-1&quot;/&amp;gt;&lt;br/&gt;
  &amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;/beans&amp;gt;&lt;/p&gt;

&lt;p&gt;I then run a series of tests (producing and consuming on the network of brokers). Then I shut one broker down and then start it up again  it can&apos;t see the other brokers in the network but the other brokers can see it. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12481643">AMQ-639</key>
            <summary>Broker is not re-connecting to a network of brokers after going down and then being brought back up</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chirino">Hiram R. Chirino</assignee>
                                    <reporter username="bdiesenhaus">Brian Diesenhaus</reporter>
                        <labels>
                    </labels>
                <created>Thu, 16 Mar 2006 20:06:06 +0000</created>
                <updated>Mon, 1 May 2006 22:03:04 +0000</updated>
                            <resolved>Mon, 1 May 2006 22:03:04 +0000</resolved>
                                    <version>4.0 M4</version>
                                    <fixVersion>4.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12937532" author="chirino" created="Fri, 17 Mar 2006 07:41:22 +0000"  >&lt;p&gt;Thanks for the report!  Fixed.&lt;/p&gt;</comment>
                            <comment id="12937627" author="bdiesenhaus" created="Fri, 17 Mar 2006 19:11:39 +0000"  >&lt;p&gt;I did some testing this morning and here is what I found: &lt;br/&gt;
1. The broker is re-connecting. Looking at the connection in the JMX console all the brokers can see each other. This was not the case before. &lt;br/&gt;
2. The brokers that were not brought down are throwing the below exception when the broker re-connects. &lt;br/&gt;
3. Running the test again after the broker comes up only about 1/3 of the message make it to the broker that was brought back up and then it .&lt;/p&gt;


&lt;p&gt;INFO: Async error occurred: javax.jms.InvalidClientIDException: Broker: bfe-grieg - Client: NC_bfe-holst_inboundbfe-grieg already connected&lt;br/&gt;
javax.jms.InvalidClientIDException: Broker: bfe-grieg - Client: NC_bfe-holst_inboundbfe-grieg already connected&lt;br/&gt;
        at org.apache.activemq.broker.region.RegionBroker.addConnection(RegionBroker.java:151)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.addConnection(BrokerFilter.java:64)&lt;br/&gt;
        at org.apache.activemq.advisory.AdvisoryBroker.addConnection(AdvisoryBroker.java:67)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.addConnection(BrokerFilter.java:64)&lt;br/&gt;
        at org.apache.activemq.broker.MutableBrokerFilter.addConnection(MutableBrokerFilter.java:76)&lt;br/&gt;
        at org.apache.activemq.broker.AbstractConnection.processAddConnection(AbstractConnection.java:500)&lt;br/&gt;
        at org.apache.activemq.command.ConnectionInfo.visit(ConnectionInfo.java:106)&lt;br/&gt;
        at org.apache.activemq.broker.AbstractConnection.service(AbstractConnection.java:196)&lt;br/&gt;
        at org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:62)&lt;br/&gt;
        at org.apache.activemq.transport.ResponseCorrelator.onCommand(ResponseCorrelator.java:88)&lt;br/&gt;
        at org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:70)&lt;br/&gt;
        at org.apache.activemq.transport.vm.VMTransport.oneway(VMTransport.java:75)&lt;br/&gt;
        at org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:44)&lt;br/&gt;
        at org.apache.activemq.transport.ResponseCorrelator.oneway(ResponseCorrelator.java:55)&lt;br/&gt;
        at org.apache.activemq.network.DemandForwardingBridgeSupport.startLocalBridge(DemandForwardingBridgeSupport.java:175)&lt;br/&gt;
        at org.apache.activemq.network.DemandForwardingBridgeSupport$3.run(DemandForwardingBridgeSupport.java:147)&lt;/p&gt;</comment>
                            <comment id="12937599" author="jstrachan" created="Fri, 17 Mar 2006 19:35:36 +0000"  >&lt;p&gt;BTW I wonder if the exception you are getting is related to this fix...&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://jira.activemq.org/jira/browse/AMQ-600&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jira.activemq.org/jira/browse/AMQ-600&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;which was causing InvalidClientIDException to be thrown when network errors occur by handling the IOException in the wrong way&lt;/p&gt;</comment>
                            <comment id="12937600" author="jstrachan" created="Fri, 17 Mar 2006 19:35:54 +0000"  >&lt;p&gt;(BTW that issue was fixed in the last hour or so in SVN)&lt;/p&gt;</comment>
                            <comment id="12937715" author="bdiesenhaus" created="Fri, 17 Mar 2006 21:27:29 +0000"  >&lt;p&gt;I pulled the latest code with the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-600&quot; title=&quot;Broker will not release a persistant clientId if a network connection is broken then restored at the TCP layer from a remote client&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-600&quot;&gt;&lt;del&gt;AMQ-600&lt;/del&gt;&lt;/a&gt; and I am still seeing the following issues: &lt;br/&gt;
1. The brokers that were not brought down are still throwing the InvalidClientIDException when the broker that was brought down tries to re-connect.  &lt;br/&gt;
2. Only about 1/3 of the message make it to the broker that was brought back up after running the test again. &lt;/p&gt;
</comment>
                            <comment id="12937729" author="chirino" created="Tue, 25 Apr 2006 20:25:32 +0000"  >&lt;p&gt;I&apos;ve tried to setup a similar scenario.  And I do see some message loss but when the broker is taken down but that can be expected since the messages are not persistent.  Once the broker is brought back online, processing continues without message loss.  When a broker is shutdown, any transient messages he had in it&apos;s queues will be dropped.  Do you think this could explain the lost messages you&apos;ve been seeing?&lt;/p&gt;</comment>
                            <comment id="12936352" author="chirino" created="Mon, 1 May 2006 22:03:04 +0000"  >&lt;p&gt;Fixed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>49272</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 31 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0s00n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161479</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310080" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Regression</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10091"><![CDATA[Regression]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>