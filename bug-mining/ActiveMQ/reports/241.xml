<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:34:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-1382] Unnecessary creation of /activemq-data/localhost/tmp_storage directory with AMQ 5.x</title>
                <link>https://issues.apache.org/jira/browse/AMQ-1382</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;With AMQ 5.0 everytime AMQ runs the following directory structure is created:&lt;/p&gt;

&lt;p&gt;/activemq-data/localhost/tmp_storage.&lt;/p&gt;

&lt;p&gt;This didn&apos;t happen in AMQ 4.1.0.X and looks to be a side effect of the new temporary spooling feature in 5.x.&lt;/p&gt;

&lt;p&gt;Since the broker is configured to be non-persistent, ActiveMQ should not be creating this directory. &lt;/p&gt;

</description>
                <environment>&lt;p&gt;NA&lt;/p&gt;</environment>
        <key id="12482923">AMQ-1382</key>
            <summary>Unnecessary creation of /activemq-data/localhost/tmp_storage directory with AMQ 5.x</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="chirino">Hiram R. Chirino</assignee>
                                    <reporter username="dave_stanley">Dave Stanley</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Sep 2007 16:37:24 +0000</created>
                <updated>Sat, 5 Sep 2015 01:53:05 +0000</updated>
                            <resolved>Thu, 25 Jun 2009 09:50:49 +0000</resolved>
                                                    <fixVersion>5.3.0</fixVersion>
                                        <due></due>
                            <votes>7</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="12938431" author="chirino" created="Thu, 6 Sep 2007 22:14:49 +0000"  >&lt;p&gt;fixed in rev 573397&lt;/p&gt;</comment>
                            <comment id="12939740" author="romantic" created="Wed, 28 May 2008 14:21:12 +0000"  >&lt;p&gt;This issue is reproduced in activemq 5.1.0&lt;/p&gt;

&lt;p&gt;The directory structure &quot;activemq-data\localhost\tmp_storage&quot; is created within current directory after starting of ActiveMQ.&lt;br/&gt;
Persistent mode is used. Location of created directories is not controlled by &quot;directory&quot; attribute of amqPersistenceAdapter:&lt;br/&gt;
directory structure is always created in current directory and &quot;tmp_storage&quot; folder remains empty.&lt;/p&gt;

&lt;p&gt;XML Configuration file:&lt;br/&gt;
  &amp;lt;broker xmlns=&quot;http://activemq.apache.org/schema/core&quot; brokerName=&quot;localhost&quot; persistent=&quot;true&quot;&amp;gt;&lt;br/&gt;
  ...&lt;br/&gt;
    &amp;lt;persistenceAdapter&amp;gt;&lt;br/&gt;
        &amp;lt;amqPersistenceAdapter syncOnWrite=&quot;false&quot; directory=&quot;${MYROOTl}/jmsserver/data&quot; maxFileLength=&quot;100 mb&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/persistenceAdapter&amp;gt;  &lt;br/&gt;
  ...&lt;/p&gt;</comment>
                            <comment id="12939823" author="tsigelnik" created="Wed, 18 Jun 2008 12:17:38 +0000"  >&lt;p&gt;the same thing &lt;br/&gt;
tmp_storage creator ignores  &quot;directory&quot; attribute&lt;br/&gt;
I&apos;ve just added &quot;cd /var/lib/activemq&quot; to my startup script&lt;/p&gt;</comment>
                            <comment id="12940023" author="aburgel" created="Tue, 5 Aug 2008 15:24:47 +0000"  >&lt;p&gt;this still exists in 5.2-20080803.231633-64.&lt;/p&gt;

&lt;p&gt;a work around is to specify dataDirectory in your xml config like so:&lt;/p&gt;

&lt;p&gt;&amp;lt;broker xmlns=&quot;http://activemq.apache.org/schema/core&quot; brokerName=&quot;localhost&quot; persistent=&quot;true&quot; dataDirectory=&quot;/var/lib/activemq/&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;the tmp directory will be created within dataDirectory.&lt;/p&gt;</comment>
                            <comment id="12940243" author="billonahill" created="Wed, 17 Sep 2008 23:13:21 +0000"  >&lt;p&gt;FYI, the workaround mentioned above does not work in AMQ 5.1 or the latest activemq-core-5.3-20080911.231559-3 build. the settings for both dataDirectory and brokerName get ignored, regardless of whether I configure them on the broker or on the persistanceAdapter.&lt;/p&gt;</comment>
                            <comment id="12940246" author="dave_stanley" created="Thu, 18 Sep 2008 01:51:58 +0000"  >&lt;p&gt;As a workaround, I think changing the tmpDataDirectory in your spring configuration should allow you to configure the location of this directory @ a friendly location. &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;broker ... tmpDataDirectory=&lt;span class=&quot;code-quote&quot;&gt;&quot;/somplace/tmp_storage&quot;&lt;/span&gt; &amp;gt;
  ...
&amp;lt;/broker&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="12941611" author="gtully" created="Thu, 25 Jun 2009 09:50:49 +0000"  >&lt;p&gt;setting dataDirectoryFile or tmpDataDirectory  (both of which take File object) in spring xml config will allow the temp directory to be specified in 5.3.&lt;br/&gt;
An alternative is to specify the System Property ,&lt;br/&gt;
&apos;org.apache.activemq.default.directory.prefix&apos; which will be prefixed to the default data directory location activemq-data&lt;/p&gt;</comment>
                            <comment id="12941769" author="davidnewcomb" created="Mon, 20 Jul 2009 16:21:16 +0000"  >&lt;p&gt;Hiram Chirino said the issue was fixed on 06/Sep/07, but the comments suggest that the issue has reoccurred. This issue is marked as &quot;Working as Designed&quot; but the comments seem to say you should set the tmp Directory to something nicer.&lt;br/&gt;
Has the original issue been fixed or not? I&apos;ve got 5.2 and its still creating &amp;lt;somewhere&amp;gt;\activemq-data\localhost\tmp_storage. Has the code been fixed so that this folder is not created?&lt;/p&gt;</comment>
                            <comment id="13010876" author="adkudlick" created="Thu, 24 Mar 2011 19:46:15 +0000"  >&lt;p&gt;It&apos;s fixed.  I attached a unit test patch that demonstrates that the bug exists using AMQ 5.2, but not in 5.4.2&lt;/p&gt;</comment>
                            <comment id="13222155" author="xbhanu" created="Mon, 5 Mar 2012 03:43:20 +0000"  >&lt;p&gt;Seeing this issue in version 5.5.1&lt;br/&gt;
tmp_storage is hogging about 2.8 gigs wheresas the actual kahadb_dir specified by me is only 340 megs.&lt;br/&gt;
Weird thing is &amp;lt;activemq_data&amp;gt;/&amp;lt;broker_name&amp;gt;/tmp_storage gets created in our production setup but not test setup. What exactly does its creation depend upon ? and why does is it eating up so much space ?&lt;br/&gt;
Guys, any help here ?&lt;/p&gt;</comment>
                            <comment id="13222160" author="xbhanu" created="Mon, 5 Mar 2012 04:14:11 +0000"  >&lt;p&gt;Also, In my jconsole for test setup I see under the broker bean that the attribute DataDirectory points to /u/testuser/activemq-data whereas no such directory is specified/created, all kahadb logs go to the directory specified in broker xml.&lt;/p&gt;</comment>
                            <comment id="14731700" author="volkerk" created="Sat, 5 Sep 2015 01:53:05 +0000"  >&lt;p&gt;The tmp_storage directory is used to store non-persistent messages when their creation occurs faster than their consumption (i.e. when the consumer is slow). You really have no control over whether this gets created or not - it happens dynamically as needed. But you do have settings to control how much memory and disk space the broker may use, and by allocating more memory to the broker you can often prevent the use of tmp_storage.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12474553" name="AMQ-1382_Unit_Test1.patch" size="6074" author="adkudlick" created="Thu, 24 Mar 2011 19:45:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>92053</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 11 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i181on:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>255075</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>