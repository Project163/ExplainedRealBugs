<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:59:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-9383] Websocket transport options do not get applied</title>
                <link>https://issues.apache.org/jira/browse/AMQ-9383</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Configure broker transport connector like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;transportConnector name=&lt;span class=&quot;code-quote&quot;&gt;&quot;amqpws&quot;&lt;/span&gt; uri=&lt;span class=&quot;code-quote&quot;&gt;&quot;ws:&lt;span class=&quot;code-comment&quot;&gt;//0.0.0.0:5680?amqp.traceFrames=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;amp;wireFormat=amqp&amp;amp;amp;wireFormat.transformer=jms&amp;amp;amp;wireFormat.allowNonSaslConnections=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt; &lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;br/&gt;
Try to connect to this instance with rhea.js library.&lt;br/&gt;
First attempt to connect would be successful.&lt;br/&gt;
Second and all subsequent attempts would fail.&lt;br/&gt;
The only way to &quot;fix&quot; this would be a broker restart.&lt;br/&gt;
&#160;&lt;br/&gt;
The issue is here:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/activemq/blob/4bbb055187166706103d785e9665efb439792c51/activemq-http/src/main/java/org/apache/activemq/transport/ws/jetty9/WSServlet.java#L162&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/activemq/blob/4bbb055187166706103d785e9665efb439792c51/activemq-http/src/main/java/org/apache/activemq/transport/ws/jetty9/WSServlet.java#L162&lt;/a&gt;&lt;br/&gt;
&#160;&lt;br/&gt;
transportOptions would be &quot;consumed&quot; by introspection on the first connection attempt, and on subsequent attempts &quot;allowNonSaslConnections&quot; and &quot;transformer&quot; would not be there, so won&apos;t be applied to wireformat and the result would be an error.&lt;br/&gt;
&#160;&lt;br/&gt;
Interestingly this was already spotted and fixed in the same class for MQTT subprotocol here:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/activemq/blob/4bbb055187166706103d785e9665efb439792c51/activemq-http/src/main/java/org/apache/activemq/transport/ws/jetty9/WSServlet.java#L115C86-L115C86&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/activemq/blob/4bbb055187166706103d785e9665efb439792c51/activemq-http/src/main/java/org/apache/activemq/transport/ws/jetty9/WSServlet.java#L115C86-L115C86&lt;/a&gt;&lt;br/&gt;
by simply creating a copy of transport options before sending it into introspecting setters.&lt;br/&gt;
&#160;&lt;br/&gt;
Please apply the same fix.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13557007">AMQ-9383</key>
            <summary>Websocket transport options do not get applied</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbonofre">Jean-Baptiste Onofr&#233;</assignee>
                                    <reporter username="chaostya">Kostiantyn Miklevskyi</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Nov 2023 10:01:21 +0000</created>
                <updated>Sun, 3 Dec 2023 08:36:19 +0000</updated>
                            <resolved>Thu, 9 Nov 2023 14:52:07 +0000</resolved>
                                    <version>5.15.16</version>
                    <version>5.18.3</version>
                    <version>5.17.6</version>
                    <version>5.16.7</version>
                                    <fixVersion>6.0.0</fixVersion>
                    <fixVersion>5.18.4</fixVersion>
                    <fixVersion>5.17.7</fixVersion>
                    <fixVersion>5.16.8</fixVersion>
                                    <component>Transport</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="17784056" author="jbonofre" created="Wed, 8 Nov 2023 13:54:34 +0000"  >&lt;p&gt;OK, no problem for 5.16.x &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17784489" author="jira-bot" created="Thu, 9 Nov 2023 14:50:47 +0000"  >&lt;p&gt;Commit f4be8a6806206df3c9ddb6566c2e48eff767d55d in activemq&apos;s branch refs/heads/main from JB Onofr&#233;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=f4be8a680&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=f4be8a680&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-9383&quot; title=&quot;Websocket transport options do not get applied&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-9383&quot;&gt;&lt;del&gt;AMQ-9383&lt;/del&gt;&lt;/a&gt;: Copy transport options before sending in introspection setter&lt;/p&gt;</comment>
                            <comment id="17784490" author="jira-bot" created="Thu, 9 Nov 2023 14:50:47 +0000"  >&lt;p&gt;Commit d23da10da80c37d01a42af1f8347193ba2baae22 in activemq&apos;s branch refs/heads/main from JB Onofr&#233;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=d23da10da&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=d23da10da&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Merge pull request #1113 from jbonofre/&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-9383&quot; title=&quot;Websocket transport options do not get applied&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-9383&quot;&gt;&lt;del&gt;AMQ-9383&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-9383&quot; title=&quot;Websocket transport options do not get applied&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-9383&quot;&gt;&lt;del&gt;AMQ-9383&lt;/del&gt;&lt;/a&gt;: Copy transport options before sending in introspection setter&lt;/p&gt;</comment>
                            <comment id="17784491" author="jira-bot" created="Thu, 9 Nov 2023 14:51:17 +0000"  >&lt;p&gt;Commit 526c2b07bafe8418d3b29ebeec2e5bdbe17ccd00 in activemq&apos;s branch refs/heads/activemq-5.18.x from JB Onofr&#233;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=526c2b07b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=526c2b07b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-9383&quot; title=&quot;Websocket transport options do not get applied&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-9383&quot;&gt;&lt;del&gt;AMQ-9383&lt;/del&gt;&lt;/a&gt;: Copy transport options before sending in introspection setter&lt;/p&gt;

&lt;p&gt;(cherry picked from commit f4be8a6806206df3c9ddb6566c2e48eff767d55d)&lt;/p&gt;</comment>
                            <comment id="17784492" author="jira-bot" created="Thu, 9 Nov 2023 14:51:39 +0000"  >&lt;p&gt;Commit 48369bfe2bfd46264a1fb22fa0861499e7451705 in activemq&apos;s branch refs/heads/activemq-5.17.x from JB Onofr&#233;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=48369bfe2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=48369bfe2&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-9383&quot; title=&quot;Websocket transport options do not get applied&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-9383&quot;&gt;&lt;del&gt;AMQ-9383&lt;/del&gt;&lt;/a&gt;: Copy transport options before sending in introspection setter&lt;/p&gt;

&lt;p&gt;(cherry picked from commit f4be8a6806206df3c9ddb6566c2e48eff767d55d)&lt;/p&gt;</comment>
                            <comment id="17784493" author="jira-bot" created="Thu, 9 Nov 2023 14:52:06 +0000"  >&lt;p&gt;Commit 3af9001e255cf862b4f6fb4fa0c0948a62038af7 in activemq&apos;s branch refs/heads/activemq-5.16.x from JB Onofr&#233;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=3af9001e2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=3af9001e2&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-9383&quot; title=&quot;Websocket transport options do not get applied&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-9383&quot;&gt;&lt;del&gt;AMQ-9383&lt;/del&gt;&lt;/a&gt;: Copy transport options before sending in introspection setter&lt;/p&gt;

&lt;p&gt;(cherry picked from commit f4be8a6806206df3c9ddb6566c2e48eff767d55d)&lt;/p&gt;</comment>
                            <comment id="17784608" author="christopher.l.shannon" created="Thu, 9 Nov 2023 21:07:07 +0000"  >&lt;p&gt;We should not be releasing another 5.16.x release. 5.16.x was announced as EOL 1.5 years ago in May 2022. We only recently did the 5.16.7 because of the security issue but I&apos;m not in favor if doing anymore 5.15.x or 5.16.x releases etc.&#160;&lt;/p&gt;</comment>
                            <comment id="17784931" author="jbonofre" created="Fri, 10 Nov 2023 13:06:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cshannon&quot; class=&quot;user-hover&quot; rel=&quot;cshannon&quot;&gt;cshannon&lt;/a&gt; I merged on activemq-5.16.x just in case but I don&apos;t plan 5.16.x new release. I will do 5.17/5.18/6.0.&lt;/p&gt;</comment>
                            <comment id="17784934" author="christopher.l.shannon" created="Fri, 10 Nov 2023 13:09:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jbonofre&quot; class=&quot;user-hover&quot; rel=&quot;jbonofre&quot;&gt;jbonofre&lt;/a&gt; - That makes sense, thanks for the clarification&lt;/p&gt;</comment>
                            <comment id="17792495" author="chaostya" created="Sun, 3 Dec 2023 08:36:19 +0000"  >&lt;p&gt;For sure it&apos;s your call to release 5.16.x or not. I&apos;ll just mention that AWS managed ActiveMQ service allows for creating new broker instances of these versions (at the point in time of writing this comment):&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13064927/13064927_image-2023-12-03-10-35-49-522.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13064927" name="image-2023-12-03-10-35-49-522.png" size="7104" author="chaostya" created="Sun, 3 Dec 2023 08:35:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 49 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1lfyg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>