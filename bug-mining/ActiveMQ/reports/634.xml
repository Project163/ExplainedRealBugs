<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:41:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-2305] TransportConnection Ignores isShutdownOnSlaveFailure</title>
                <link>https://issues.apache.org/jira/browse/AMQ-2305</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;In a pure Master/Slave configuration, when the slave fails the TransportConnection invokes the MasterBroker&apos;s stop() method without taking into consideration the shutdownOnSlaveFailure boolean, which by default is set to false.  So even if shutdownOnSlaveFailure  is set to false, all my plugin brokers&apos; stop methods get invoked when the slave fails.  &lt;/p&gt;</description>
                <environment>&lt;p&gt;ActiveMQ 5.2, Java 5, Windoze XP Pro &lt;/p&gt;</environment>
        <key id="12482766">AMQ-2305</key>
            <summary>TransportConnection Ignores isShutdownOnSlaveFailure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gtully">Gary Tully</assignee>
                                    <reporter username="joef">Joe Francis</reporter>
                        <labels>
                    </labels>
                <created>Thu, 25 Jun 2009 12:44:14 +0000</created>
                <updated>Fri, 26 Jun 2009 18:14:31 +0000</updated>
                            <resolved>Fri, 26 Jun 2009 18:14:31 +0000</resolved>
                                    <version>5.2.0</version>
                                    <fixVersion>5.3.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12941619" author="joef" created="Thu, 25 Jun 2009 12:46:55 +0000"  >&lt;p&gt;attached patch&lt;/p&gt;</comment>
                            <comment id="12941628" author="gtully" created="Thu, 25 Jun 2009 14:11:52 +0000"  >&lt;p&gt;joe, do u have a stack trace to the stop call. I see serviceTransportException has the check, I am wondering what the other path to stop is?&lt;/p&gt;</comment>
                            <comment id="12941635" author="joef" created="Fri, 26 Jun 2009 01:27:13 +0000"  >&lt;p&gt;gary, i don&apos;t have a stack trace but below is some debug output&lt;/p&gt;

&lt;p&gt;note my embedded notes, which i&apos;ve pointed out with  &apos;&amp;lt;----&apos;&lt;/p&gt;

&lt;p&gt;the cfg files for the master and slave follow the debug output; both brokers wrote to the same log file &lt;/p&gt;

&lt;p&gt;2009-06-25 21:09:33,718 &lt;span class=&quot;error&quot;&gt;&amp;#91;/127.0.0.1:3457&amp;#93;&lt;/span&gt; INFO  TransportConnection            - Slave Broker slave is attached&lt;br/&gt;
2009-06-25 21:09:39,078 &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-4       &amp;#93;&lt;/span&gt; INFO  BrokerService                  - ActiveMQ Message Broker (slave, ID:DIEGO-3454-1245978572796-1:0) is shutting down&lt;br/&gt;
2009-06-25 21:09:39,078 &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-4       &amp;#93;&lt;/span&gt; DEBUG BrokerService                  - Caught exception, must be shutting down: java.lang.IllegalStateException: Shutdown in progress&lt;br/&gt;
2009-06-25 21:09:39,093 &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-4       &amp;#93;&lt;/span&gt; DEBUG VMTransportFactory             - Shutting down VM connectors for broker: slave&lt;br/&gt;
2009-06-25 21:09:39,093 &lt;a href=&quot;#0&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;r: vm://slave#0&lt;/a&gt; DEBUG TransportConnection            - Stopping connection: vm://slave#0&lt;br/&gt;
2009-06-25 21:09:39,093 &lt;a href=&quot;#0&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;r: vm://slave#0&lt;/a&gt; DEBUG TransportConnection            - Stopped transport: vm://slave#0&lt;br/&gt;
2009-06-25 21:09:39,093 &lt;a href=&quot;#0&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;r: vm://slave#0&lt;/a&gt; DEBUG TransportConnection            - Cleaning up connection resources: vm://slave#0&lt;br/&gt;
2009-06-25 21:09:39,093 &lt;a href=&quot;#0&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;r: vm://slave#0&lt;/a&gt; DEBUG TransportConnection            - Connection Stopped: vm://slave#0&lt;br/&gt;
2009-06-25 21:09:39,093 &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-4       &amp;#93;&lt;/span&gt; INFO  TransportConnector             - Connector vm://slave Stopped&lt;br/&gt;
2009-06-25 21:09:39,109 &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-4       &amp;#93;&lt;/span&gt; DEBUG TcpTransport                   - Stopping transport tcp://localhost/127.0.0.1:61616&lt;br/&gt;
2009-06-25 21:09:39,109 &lt;span class=&quot;error&quot;&gt;&amp;#91;/127.0.0.1:3457&amp;#93;&lt;/span&gt; DEBUG TransportConnection            - Stopping connection: /127.0.0.1:3457&lt;/p&gt;

&lt;p&gt;2009-06-25 21:09:39,109 &lt;span class=&quot;error&quot;&gt;&amp;#91;/127.0.0.1:3457&amp;#93;&lt;/span&gt; DEBUG JoeBroker                  - stop: Entered &amp;lt;---- this is my Broker plugin&apos;s stop method getting called&lt;/p&gt;

&lt;p&gt;2009-06-25 21:09:39,109 &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-4       &amp;#93;&lt;/span&gt; INFO  TransportConnector             - Connector tcp://localhost:61617 Stopped&lt;br/&gt;
2009-06-25 21:09:39,125 &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-4       &amp;#93;&lt;/span&gt; INFO  BrokerService                  - ActiveMQ JMS Message Broker (slave, ID:DIEGO-3454-1245978572796-1:0) stopped&lt;br/&gt;
org.apache.activemq:BrokerName=master,Type=XXXXX, XXXX=ActiveMQ XXXXX&lt;br/&gt;
2009-06-25 21:09:39,156 &lt;span class=&quot;error&quot;&gt;&amp;#91;/127.0.0.1:3457&amp;#93;&lt;/span&gt; DEBUG TcpTransport                   - Stopping transport tcp:///127.0.0.1:3457&lt;br/&gt;
2009-06-25 21:09:39,156 &lt;span class=&quot;error&quot;&gt;&amp;#91;/127.0.0.1:3457&amp;#93;&lt;/span&gt; DEBUG TransportConnection            - Stopped transport: /127.0.0.1:3457&lt;br/&gt;
2009-06-25 21:09:39,156 &lt;span class=&quot;error&quot;&gt;&amp;#91;/127.0.0.1:3457&amp;#93;&lt;/span&gt; DEBUG TransportConnection            - Connection Stopped: /127.0.0.1:3457&lt;br/&gt;
2009-06-25 21:09:43,437 &lt;span class=&quot;error&quot;&gt;&amp;#91;MQ ShutdownHook&amp;#93;&lt;/span&gt; INFO  BrokerService                  - ActiveMQ Message Broker (master, ID:DIEGO-3450-1245978553937-0:0) is shutting down&lt;br/&gt;
2009-06-25 21:09:43,437 &lt;span class=&quot;error&quot;&gt;&amp;#91;MQ ShutdownHook&amp;#93;&lt;/span&gt; DEBUG BrokerService                  - Caught exception, must be shutting down: java.lang.IllegalStateException: Shutdown in progress&lt;br/&gt;
2009-06-25 21:09:45,359 &lt;span class=&quot;error&quot;&gt;&amp;#91;MQ ShutdownHook&amp;#93;&lt;/span&gt; INFO  TransportConnector             - Connector tcp://localhost:61616 Stopped&lt;/p&gt;

&lt;p&gt;2009-06-25 21:09:45,375 &lt;span class=&quot;error&quot;&gt;&amp;#91;MQ ShutdownHook&amp;#93;&lt;/span&gt; DEBUG JoeBroker                  - stop: Entered &amp;lt;---- This is my plugin&apos;s stop method getting called a second time&lt;br/&gt;
2009-06-25 21:09:45,375 &lt;span class=&quot;error&quot;&gt;&amp;#91;MQ ShutdownHook&amp;#93;&lt;/span&gt; DEBUG JoeBroker                  - stop: JoeBroker has already been stopped&lt;/p&gt;

&lt;p&gt;2009-06-25 21:09:45,375 &lt;span class=&quot;error&quot;&gt;&amp;#91;MQ ShutdownHook&amp;#93;&lt;/span&gt; INFO  BrokerService                  - ActiveMQ JMS Message Broker (master, ID:DIEGO-3450-1245978553937-0:0) stopped&lt;/p&gt;


&lt;p&gt;This is the slave&apos;s  cfg file&lt;/p&gt;

&lt;p&gt;&amp;lt;beans&lt;br/&gt;
  xmlns=&quot;http://www.springframework.org/schema/beans&quot;&lt;br/&gt;
  xmlns:amq=&quot;http://activemq.org/config/1.0&quot;&lt;br/&gt;
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;br/&gt;
  xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans &lt;a href=&quot;http://www.springframework.org/schema/beans/spring-beans-2.0.xsd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.springframework.org/schema/beans/spring-beans-2.0.xsd&lt;/a&gt;&lt;br/&gt;
  &lt;a href=&quot;http://activemq.org/config/1.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.org/config/1.0&lt;/a&gt; &lt;a href=&quot;http://activemq.apache.org/schema/activemq-core.xsd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.apache.org/schema/activemq-core.xsd&lt;/a&gt;&lt;br/&gt;
  &lt;a href=&quot;http://activemq.apache.org/camel/schema/spring&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.apache.org/camel/schema/spring&lt;/a&gt; &lt;a href=&quot;http://activemq.apache.org/camel/schema/spring/camel-spring.xsd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.apache.org/camel/schema/spring/camel-spring.xsd&lt;/a&gt;&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;  &amp;lt;!-- Allows us to use system properties as variables in this configuration file --&amp;gt;&lt;br/&gt;
  &amp;lt;bean class=&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;  &amp;lt;broker xmlns=&quot;http://activemq.org/config/1.0&quot; brokerName=&quot;slave&quot; masterConnectorURI=&quot;tcp://localhost:61616&quot; deleteAllMessagesOnStartup=&quot;true&quot; persistent=&quot;false&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;!-- The transport connectors ActiveMQ will listen to --&amp;gt;&lt;br/&gt;
    &amp;lt;transportConnectors&amp;gt;&lt;br/&gt;
       &amp;lt;transportConnector uri=&quot;tcp://localhost:61617&quot; /&amp;gt;&lt;br/&gt;
    &amp;lt;/transportConnectors&amp;gt;&lt;/p&gt;

&lt;p&gt;  &amp;lt;/broker&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;/beans&amp;gt;&lt;/p&gt;


&lt;p&gt;This is the master&apos;s cfg file &lt;/p&gt;

&lt;p&gt;&amp;lt;beans&lt;br/&gt;
  xmlns=&quot;http://www.springframework.org/schema/beans&quot;&lt;br/&gt;
  xmlns:amq=&quot;http://activemq.org/config/1.0&quot;&lt;br/&gt;
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;br/&gt;
  xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans &lt;a href=&quot;http://www.springframework.org/schema/beans/spring-beans-2.0.xsd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.springframework.org/schema/beans/spring-beans-2.0.xsd&lt;/a&gt;&lt;br/&gt;
  &lt;a href=&quot;http://activemq.org/config/1.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.org/config/1.0&lt;/a&gt; &lt;a href=&quot;http://activemq.apache.org/schema/activemq-core.xsd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.apache.org/schema/activemq-core.xsd&lt;/a&gt;&lt;br/&gt;
  &lt;a href=&quot;http://activemq.apache.org/camel/schema/spring&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.apache.org/camel/schema/spring&lt;/a&gt; &lt;a href=&quot;http://activemq.apache.org/camel/schema/spring/camel-spring.xsd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.apache.org/camel/schema/spring/camel-spring.xsd&lt;/a&gt;&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;  &amp;lt;!-- Allows us to use system properties as variables in this configuration file --&amp;gt;&lt;br/&gt;
  &amp;lt;bean class=&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;  &amp;lt;broker xmlns=&quot;http://activemq.org/config/1.0&quot; brokerName=&quot;master&quot; persistent=&quot;false&quot; deleteAllMessagesOnStartup=&quot;true&quot; plugins=&quot;#joe&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;!-- The transport connectors ActiveMQ will listen to --&amp;gt;&lt;br/&gt;
    &amp;lt;transportConnectors&amp;gt;&lt;br/&gt;
       &amp;lt;transportConnector uri=&quot;tcp://localhost:61616&quot; /&amp;gt;      &lt;br/&gt;
    &amp;lt;/transportConnectors&amp;gt;&lt;/p&gt;

&lt;p&gt;  &amp;lt;/broker&amp;gt;&lt;/p&gt;

&lt;p&gt;  &amp;lt;bean id=&quot;joe&quot; class=&quot;com.ttm.activemq.joe.JoePlugin&quot;/&amp;gt;	&lt;/p&gt;

&lt;p&gt;&amp;lt;/beans&amp;gt;&lt;/p&gt;



</comment>
                            <comment id="12941646" author="gtully" created="Fri, 26 Jun 2009 18:14:31 +0000"  >&lt;p&gt;Joe, it did not commit your patch as is, but changed the MasterBroker filter to not propagate the stop request and just remove it&apos;s self. I think this is the correct thing to do in this scenario as not stopping the MasterBroker filter will just ensure that it fails to sync with the slave. The test case shows that this fix stops a plugin getting a stop request.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12461550" name="TransportConnection.patch" size="959" author="joef" created="Thu, 25 Jun 2009 12:46:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38769</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 22 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14cvz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>233551</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>