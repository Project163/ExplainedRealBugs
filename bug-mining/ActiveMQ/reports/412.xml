<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:37:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-1872] ArrayIndexOutOfBoundsException on restart of broker with durable subscriptions</title>
                <link>https://issues.apache.org/jira/browse/AMQ-1872</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;We have two brokers A &amp;amp; B, with a producer on A and durable subscriber on B. A sends 50K messages and B consumes 25K messages. Then broker B is shutdown. We then restart Broker B and restablish the durable subscription.&lt;br/&gt;
We are seeing Broker B throwing the following array out of bounds exception when cleaning up the persistent adapter indexes after the consumer reconnects to the restarted broker B.&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.ArrayIndexOutOfBoundsException&lt;br/&gt;
        at java.lang.System.arraycopy(Native Method)&lt;br/&gt;
        at org.apache.activemq.kaha.impl.index.hash.HashIndex.addToBin(HashIndex.java:431)&lt;br/&gt;
        at org.apache.activemq.kaha.impl.index.hash.HashIndex.doLoad(HashIndex.java:497)&lt;br/&gt;
        at org.apache.activemq.kaha.impl.index.hash.HashIndex.doCompress(HashIndex.java:535)&lt;br/&gt;
        at org.apache.activemq.kaha.impl.index.hash.HashIndex.load(HashIndex.java:253)&lt;br/&gt;
        at org.apache.activemq.kaha.impl.container.MapContainerImpl.load(MapContainerImpl.java:107)&lt;br/&gt;
        at org.apache.activemq.store.kahadaptor.KahaReferenceStoreAdapter.getMapReferenceContainer(KahaReferenceStoreAdapter.java:210)&lt;br/&gt;
        at org.apache.activemq.store.kahadaptor.KahaReferenceStoreAdapter.createTopicReferenceStore(KahaReferenceStoreAdapter.java:168)&lt;br/&gt;
        at org.apache.activemq.store.amq.AMQPersistenceAdapter.createTopicMessageStore(AMQPersistenceAdapter.java:461)&lt;br/&gt;
        at org.apache.activemq.broker.region.DestinationFactoryImpl.createDestination(DestinationFactoryImpl.java:94)&lt;br/&gt;
        at org.apache.activemq.broker.region.AbstractRegion.createDestination(AbstractRegion.java:425)&lt;br/&gt;
        at org.apache.activemq.broker.jmx.ManagedTopicRegion.createDestination(ManagedTopicRegion.java:56)&lt;br/&gt;
        at org.apache.activemq.broker.region.AbstractRegion.addDestination(AbstractRegion.java:120)&lt;br/&gt;
        at org.apache.activemq.broker.region.RegionBroker.addDestination(RegionBroker.java:266)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.addDestination(BrokerFilter.java:141)&lt;br/&gt;
        at org.apache.activemq.advisory.AdvisoryBroker.addDestination(AdvisoryBroker.java:147)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.addDestination(BrokerFilter.java:141)&lt;br/&gt;
        at org.apache.activemq.broker.MutableBrokerFilter.addDestination(MutableBrokerFilter.java:148)&lt;br/&gt;
        at org.apache.activemq.broker.region.AbstractRegion.lookup(AbstractRegion.java:385)&lt;br/&gt;
        at org.apache.activemq.broker.region.TopicRegion.addConsumer(TopicRegion.java:67)&lt;br/&gt;
        at org.apache.activemq.broker.region.RegionBroker.addConsumer(RegionBroker.java:383)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.addConsumer(BrokerFilter.java:85)&lt;br/&gt;
        at org.apache.activemq.advisory.AdvisoryBroker.addConsumer(AdvisoryBroker.java:83)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.addConsumer(BrokerFilter.java:85)&lt;br/&gt;
        at org.apache.activemq.broker.MutableBrokerFilter.addConsumer(MutableBrokerFilter.java:92)&lt;br/&gt;
        at org.apache.activemq.broker.TransportConnection.processAddConsumer(TransportConnection.java:529)&lt;br/&gt;
        at org.apache.activemq.command.ConsumerInfo.visit(ConsumerInfo.java:345)&lt;br/&gt;
        at org.apache.activemq.broker.TransportConnection.service(TransportConnection.java:293)&lt;br/&gt;
        at org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:181)&lt;br/&gt;
        at org.apache.activemq.transport.ResponseCorrelator.onCommand(ResponseCorrelator.java:104)&lt;br/&gt;
        at org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:68)&lt;br/&gt;
        at org.apache.activemq.transport.vm.VMTransport.iterate(VMTransport.java:205)&lt;br/&gt;
        at org.apache.activemq.thread.PooledTaskRunner.runTask(PooledTaskRunner.java:122)&lt;br/&gt;
        at org.apache.activemq.thread.PooledTaskRunner$1.run(PooledTaskRunner.java:43)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:885)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:907)&lt;br/&gt;
        ... 1 more&lt;/p&gt;</description>
                <environment></environment>
        <key id="12482567">AMQ-1872</key>
            <summary>ArrayIndexOutOfBoundsException on restart of broker with durable subscriptions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rajdavies">Robert Davies</assignee>
                                    <reporter username="rajdavies">Robert Davies</reporter>
                        <labels>
                    </labels>
                <created>Mon, 28 Jul 2008 19:43:27 +0000</created>
                <updated>Tue, 29 Jul 2008 04:22:08 +0000</updated>
                            <resolved>Tue, 29 Jul 2008 04:22:08 +0000</resolved>
                                    <version>5.1.0</version>
                    <version>5.2.0</version>
                                    <fixVersion>5.2.0</fixVersion>
                                    <component>Message Store</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12939995" author="rajdavies" created="Tue, 29 Jul 2008 04:22:08 +0000"  >&lt;p&gt;Fixed by SVN revision 680465&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>84744</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 18 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0s05r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161502</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>