<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:56:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-4123] Improve MQTT Inactivity Monitoring</title>
                <link>https://issues.apache.org/jira/browse/AMQ-4123</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;ul&gt;
	&lt;li&gt;Keep Alive should be 1.5 * the keep alive value specified by client (the grace period described in spec: &lt;a href=&quot;http://public.dhe.ibm.com/software/dw/webservices/ws-mqtt/mqtt-v3r1.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://public.dhe.ibm.com/software/dw/webservices/ws-mqtt/mqtt-v3r1.html&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;MQTTInactivityMonitor checking for KeepAliveInfo in the onCommand, but it can never get a KeepAliveInfo as it is&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;What to do when user explicitly turns Inactivity Monitor off?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Should there be defaults to close potentially dead connections?&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12613057">AMQ-4123</key>
            <summary>Improve MQTT Inactivity Monitoring</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ceposta">Christian Posta</assignee>
                                    <reporter username="ceposta">Christian Posta</reporter>
                        <labels>
                    </labels>
                <created>Mon, 22 Oct 2012 21:59:20 +0000</created>
                <updated>Tue, 30 Oct 2012 12:15:02 +0000</updated>
                            <resolved>Mon, 29 Oct 2012 20:58:02 +0000</resolved>
                                    <version>5.7.0</version>
                                    <fixVersion>5.8.0</fixVersion>
                                    <component>MQTT</component>
                    <component>Transport</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13482595" author="tabish121" created="Tue, 23 Oct 2012 19:20:27 +0000"  >&lt;p&gt;The MQTTInactivityMonitor doesn&apos;t really need to get an KeepAliveInfo so long as the receiveCounter value is updated correctly.  I committed a fix today that should make that happen now in the NIO and NIOSSL transports so all should be fine there.  &lt;/p&gt;</comment>
                            <comment id="13482600" author="ceposta" created="Tue, 23 Oct 2012 19:24:36 +0000"  >&lt;p&gt;Tim,&lt;br/&gt;
I considered that too. However, the PINGREQ/PINGRESP are frames that are part of the contract/spec that determine whether a connection should stay open (insofar as I understand). So if the PINGREQ frame isn&apos;t treated specifically in the InactivityMonitor, then it&apos;s only counting whether or not more data has come in over the wire. But in that case, you could just send in random data not related to the MQTT spec and that alone would keep the InactivityMonitor alive... Which isn&apos;t necessarily desired? &lt;/p&gt;</comment>
                            <comment id="13482614" author="tabish121" created="Tue, 23 Oct 2012 19:42:49 +0000"  >&lt;p&gt;Well technically speaking you could do that on any of the transports, but hopefully that random data would generate a marshaling exception and shutdown the connection.  &lt;/p&gt;</comment>
                            <comment id="13482615" author="tabish121" created="Tue, 23 Oct 2012 19:43:45 +0000"  >&lt;p&gt;I&apos;m not opposed to you adding in the conversion to a KeepAliveInfo, just wanted to note that its not altogether necessary. &lt;/p&gt;</comment>
                            <comment id="13482628" author="ceposta" created="Tue, 23 Oct 2012 20:07:46 +0000"  >&lt;p&gt;Yah, I hear ya. Im on the fence now too. If we use the KeepAliveInfo, then it ties the PINGREQ/RESP to the InactivityMonitor. As it is right now, when the MQTTProtocolConverter sees a PINGREQ, it responds right away with a PINGRESP regardless of whether there is an InactivityMonitor (transport.useInactivityMonitor=false). &lt;/p&gt;

&lt;p&gt;On the other hand, the InactivityMonitor is the heart-beating on the server side and the PINGREQ/RESP is the contract. My instincts say to make the PINGREQ/RESP explicit in the implementation. &lt;/p&gt;

&lt;p&gt;idk yet. i&apos;ll run my proposed changes by you before I commit.&lt;/p&gt;</comment>
                            <comment id="13482777" author="ceposta" created="Tue, 23 Oct 2012 22:55:43 +0000"  >&lt;p&gt;So I went without the KeepAliveInfo object. &lt;/p&gt;

&lt;p&gt;Also fixed the MQTTTests that were broken, added more around inactivity monitor, added default keep-alive for server side, implemented a grace-period for keep-alive.&lt;/p&gt;

&lt;p&gt;Tim, if you could review just to sanity check, that would be great.&lt;/p&gt;

&lt;p&gt;The tests around inactivity monitor are not the best (uses some Thread.sleep() calls to get the inactivity monitor to hang). If you can think of a better way, I&apos;m all ears.&lt;/p&gt;</comment>
                            <comment id="13482779" author="ceposta" created="Tue, 23 Oct 2012 22:57:08 +0000"  >&lt;p&gt;PS... there are some docs I would like to update on the wiki around MQTT. I still don&apos;t seem to have access to assign things to myself in jira, and I don&apos;t see any options to update the wiki. Is that another permission?&lt;/p&gt;</comment>
                            <comment id="13482784" author="tabish121" created="Tue, 23 Oct 2012 23:00:23 +0000"  >&lt;p&gt;There&apos;s some karma needed to edit the Wiki.&lt;/p&gt;</comment>
                            <comment id="13482797" author="tabish121" created="Tue, 23 Oct 2012 23:12:32 +0000"  >&lt;p&gt;Changes look good, not sure on the tests, will have to think on that. &lt;/p&gt;</comment>
                            <comment id="13483205" author="tabish121" created="Wed, 24 Oct 2012 13:15:48 +0000"  >&lt;p&gt;Updated the test case to remove the hard sleeps&lt;/p&gt;</comment>
                            <comment id="13483209" author="ceposta" created="Wed, 24 Oct 2012 13:18:22 +0000"  >&lt;p&gt;Ah, very nice with the waitFor(condition)... thanks!&lt;/p&gt;</comment>
                            <comment id="13486339" author="tabish121" created="Mon, 29 Oct 2012 20:52:36 +0000"  >&lt;p&gt;@Christian, is this complete now?  &lt;/p&gt;</comment>
                            <comment id="13486348" author="ceposta" created="Mon, 29 Oct 2012 20:57:42 +0000"  >&lt;p&gt;Tim,&lt;br/&gt;
Yes. Was waiting to assign it to myself, but haven&apos;t heard back from Hiram on my Jira access. I can mark it resolved&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>250454</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 4 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0aymn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>61883</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>