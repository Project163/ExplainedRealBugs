<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:37:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-1738] Messages stuck in a queue don&apos;t get dispatch (happens when consumers close out)</title>
                <link>https://issues.apache.org/jira/browse/AMQ-1738</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;We have a small timing windows when we closed out the consumer were we take messages it had &apos;locked&apos; (so that other consumer don&apos;t get the same message) and unlock them so that they are available for dispatch. During that window after we unlock those messages, we might still be concurrently sending messages to that subscription. The messages that get sent to the sub after we unlock are the messages that get stuck.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12482137">AMQ-1738</key>
            <summary>Messages stuck in a queue don&apos;t get dispatch (happens when consumers close out)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chirino">Hiram R. Chirino</assignee>
                                    <reporter username="chirino">Hiram R. Chirino</reporter>
                        <labels>
                    </labels>
                <created>Tue, 20 May 2008 18:15:00 +0000</created>
                <updated>Mon, 8 Sep 2008 17:00:12 +0000</updated>
                            <resolved>Mon, 8 Sep 2008 17:00:12 +0000</resolved>
                                    <version>5.1.0</version>
                                    <fixVersion>5.2.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12939668" author="chirino" created="Tue, 20 May 2008 19:43:16 +0000"  >&lt;p&gt;fixed in rev 658370&lt;/p&gt;</comment>
                            <comment id="12939704" author="gtully" created="Wed, 21 May 2008 13:47:14 +0000"  >&lt;p&gt;Hiram,&lt;br/&gt;
Just a thought, this looks similar to &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-1714&quot; title=&quot;messages get dispatched to a removed consumer, locked and remain unavailable - appear as missing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-1714&quot;&gt;&lt;del&gt;AMQ-1714&lt;/del&gt;&lt;/a&gt; where I though the dispatchLock held the key to subscriptions. I guess the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-1714&quot; title=&quot;messages get dispatched to a removed consumer, locked and remain unavailable - appear as missing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-1714&quot;&gt;&lt;del&gt;AMQ-1714&lt;/del&gt;&lt;/a&gt; may have made the  window smaller but it is still there &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;If you get a moment, would you cast your eye over the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-1714&quot; title=&quot;messages get dispatched to a removed consumer, locked and remain unavailable - appear as missing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-1714&quot;&gt;&lt;del&gt;AMQ-1714&lt;/del&gt;&lt;/a&gt; in this context, there may be a more complete locking strategy that will close the window such that &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-1738&quot; title=&quot;Messages stuck in a queue don&amp;#39;t get dispatch (happens when consumers close out)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-1738&quot;&gt;&lt;del&gt;AMQ-1738&lt;/del&gt;&lt;/a&gt; does not occur. That is, it may be possible to negate the check in add() that you just added if the dispatch locking logic is improved a bit.&lt;/p&gt;</comment>
                            <comment id="12939861" author="jasonrtheune" created="Fri, 27 Jun 2008 16:28:59 +0000"  >&lt;p&gt;We are still experiencing this issue.&lt;br/&gt;
Our customer reports that this issue still occurs.&lt;br/&gt;
======================================&lt;br/&gt;
The problem is the locking of Messages in the queue. &lt;br/&gt;
The class &quot;IndirectMessagereference&quot; uses the methods &quot;lock()&quot; and &quot;unlock()&quot;. &lt;br/&gt;
While adding Messages to the queue, messages are locked and unlocked continiously. &lt;br/&gt;
When a consumer is removed, the messages locked by the consumer are unlocked. &lt;/p&gt;

&lt;p&gt;At this point, the race condition appears to prevent locked messges from ever being unlocked again. &lt;br/&gt;
Locked Messages cannot be retrieved from the queue by any other consumer, so they stay there forever.&lt;/p&gt;

</comment>
                            <comment id="12939882" author="jasonrtheune" created="Fri, 27 Jun 2008 20:47:03 +0000"  >&lt;p&gt;We are willing to compensate anyon ewho could help us resolve this issue.&lt;/p&gt;

&lt;p&gt;Please contact me directly at jason.theune@openlogic.com to inquire how...!&lt;/p&gt;

&lt;p&gt;This is a great opportunity to earn CA$H for your open source contribution.&lt;/p&gt;</comment>
                            <comment id="12940192" author="gtully" created="Mon, 8 Sep 2008 17:00:12 +0000"  >&lt;p&gt;this is fully nailed in 5.2, dispatch is now very tight.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>84785</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 12 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0s1in:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161722</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>