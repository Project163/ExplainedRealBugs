<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:45:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-2687] NullPointerException at kahadb.</title>
                <link>https://issues.apache.org/jira/browse/AMQ-2687</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Hi!&lt;/p&gt;

&lt;p&gt;I am receiving a NullPointerException when trying to start up activemq after a crash.&lt;/p&gt;

&lt;p&gt;This is similar to &lt;a href=&quot;http://issues.apache.org/activemq/browse/AMQ-2512&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://issues.apache.org/activemq/browse/AMQ-2512&lt;/a&gt; and &lt;a href=&quot;http://issues.apache.org/activemq/browse/AMQ-2672&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://issues.apache.org/activemq/browse/AMQ-2672&lt;/a&gt; with the important difference that I confirmed this happens right now with:&lt;br/&gt;
   5.3.0&lt;br/&gt;
   5.3.1&lt;br/&gt;
   The current TRUNK revision (I tested with revision 931309 from SVN).&lt;/p&gt;

&lt;p&gt;Also, this happens with both the default (store) cursor and fileQueueCursor. (I tried the solution given by Dariusz Szablinski at &lt;a href=&quot;http://issues.apache.org/activemq/browse/AMQ-2512&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://issues.apache.org/activemq/browse/AMQ-2512&lt;/a&gt; but it did not help).&lt;/p&gt;

&lt;p&gt;I uploaded the full directory with activemq built from trunk together with the data directory (~85 megs) to: &lt;a href=&quot;http://rapidshare.com/files/372819396/apache-activemq-5.4-SNAPSHOT_-_svn_trunk_revision_931309_with_crashing_data.tar.gz.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://rapidshare.com/files/372819396/apache-activemq-5.4-SNAPSHOT_-_svn_trunk_revision_931309_with_crashing_data.tar.gz.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To see the issue, just try to start activemq from this distribution.&lt;/p&gt;

&lt;p&gt;ERROR | Failed to start ActiveMQ JMS Message Broker. Reason: java.lang.NullPointerException&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
        at org.apache.kahadb.index.BTreeNode$BTreeIterator.findNextPage(BTreeNode.java:109)&lt;br/&gt;
        at org.apache.kahadb.index.BTreeNode$BTreeIterator.hasNext(BTreeNode.java:120)&lt;br/&gt;
        at org.apache.activemq.store.kahadb.KahaDBStore$KahaDBMessageStore$4.execute(KahaDBStore.java:222)&lt;br/&gt;
        at org.apache.kahadb.page.Transaction.execute(Transaction.java:728)&lt;br/&gt;
        at org.apache.activemq.store.kahadb.KahaDBStore$KahaDBMessageStore.recover(KahaDBStore.java:219)&lt;br/&gt;
        at org.apache.activemq.broker.region.Queue.initialize(Queue.java:251)&lt;br/&gt;
        at org.apache.activemq.broker.region.DestinationFactoryImpl.createDestination(DestinationFactoryImpl.java:83)&lt;br/&gt;
        at org.apache.activemq.broker.region.AbstractRegion.createDestination(AbstractRegion.java:472)&lt;br/&gt;
        at org.apache.activemq.broker.jmx.ManagedQueueRegion.createDestination(ManagedQueueRegion.java:56)&lt;br/&gt;
        at org.apache.activemq.broker.region.AbstractRegion.addDestination(AbstractRegion.java:123)&lt;br/&gt;
        at org.apache.activemq.broker.region.RegionBroker.addDestination(RegionBroker.java:279)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.addDestination(BrokerFilter.java:143)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.addDestination(BrokerFilter.java:143)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.addDestination(BrokerFilter.java:143)&lt;br/&gt;
        at org.apache.activemq.advisory.AdvisoryBroker.addDestination(AdvisoryBroker.java:157)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.addDestination(BrokerFilter.java:143)&lt;br/&gt;
        at org.apache.activemq.broker.MutableBrokerFilter.addDestination(MutableBrokerFilter.java:149)&lt;br/&gt;
        at org.apache.activemq.broker.region.AbstractRegion.start(AbstractRegion.java:95)&lt;br/&gt;
        at org.apache.activemq.broker.region.RegionBroker.start(RegionBroker.java:184)&lt;br/&gt;
        at org.apache.activemq.broker.jmx.ManagedRegionBroker.start(ManagedRegionBroker.java:100)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.start(BrokerFilter.java:155)&lt;br/&gt;
        at org.apache.activemq.broker.scheduler.SchedulerBroker.start(SchedulerBroker.java:85)&lt;br/&gt;
        at org.apache.activemq.broker.TransactionBroker.start(TransactionBroker.java:112)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.start(BrokerFilter.java:155)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.start(BrokerFilter.java:155)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerService$3.start(BrokerService.java:1743)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerService.start(BrokerService.java:476)&lt;br/&gt;
        at org.apache.activemq.xbean.XBeanBrokerService.afterPropertiesSet(XBeanBrokerService.java:85)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeCustomInitMethod(AbstractAutowireCapableBeanFactory.java:1527)&lt;br/&gt;
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1468)&lt;br/&gt;
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1400)&lt;br/&gt;
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:513)&lt;br/&gt;
...&lt;/p&gt;</description>
                <environment></environment>
        <key id="12483554">AMQ-2687</key>
            <summary>NullPointerException at kahadb.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="chirino">Hiram R. Chirino</assignee>
                                    <reporter username="igorhvr">Igor Hjelmstrom Vinhas Ribeiro</reporter>
                        <labels>
                    </labels>
                <created>Tue, 6 Apr 2010 21:33:42 +0000</created>
                <updated>Tue, 23 Aug 2011 21:46:56 +0000</updated>
                            <resolved>Tue, 23 Aug 2011 21:46:56 +0000</resolved>
                                    <version>5.3.0</version>
                    <version>5.3.1</version>
                    <version>5.4.0</version>
                                                    <component>Broker</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="12942342" author="chirino" created="Fri, 9 Apr 2010 15:29:18 +0000"  >&lt;p&gt;Looks like the btree index became inconsistent.  Access logic looks ok, so I&apos;m suspecting it was the btree update logic that may be at fault.  To help me narrow down the search for the culprit.. could you let us what you were doing /w the broker and how you stopped it?  Were you only producing?  producing and consuming?  Did you stop it with a kill -9 or did you power off the box? etc. etc.&lt;/p&gt;</comment>
                            <comment id="12942171" author="igorhvr" created="Fri, 9 Apr 2010 16:24:55 +0000"  >&lt;p&gt;I was running both a producer and a consumer - both working in a queue that had roughly 300.000 messages. I then executed a &quot;prune&quot; on that queue... saw it executing for a while (it had erased a few thousand messages already), clicked on &quot;delete&quot; (for the same queue), saw the Webconsole hang/stop responding and did a kill -9 in the Java process. After that the queue would no longer start.&lt;/p&gt;

&lt;p&gt;Let me know if you need any more info, help, or want me to reproduce it again.&lt;/p&gt;</comment>
                            <comment id="12942384" author="chirino" created="Fri, 9 Apr 2010 18:27:02 +0000"  >&lt;p&gt;found a bug in how the recovery log was loaded and applied.  The net effect was that it was never applied because it was always considered inconsistent. Fixed in rev 932537 in trunk.&lt;br/&gt;
It&apos;s a long shot, but it might just fix the issue.  Igor, if you get a chance could you get a trunk update and see if the situation improves?&lt;/p&gt;</comment>
                            <comment id="13089791" author="tabish121" created="Tue, 23 Aug 2011 21:46:56 +0000"  >&lt;p&gt;Not further reports from the user, closing this.  Reopen if there is still a problem.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>63991</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 14 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0tujr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>172258</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>