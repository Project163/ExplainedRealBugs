<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:59:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-4563] Persisted messages reappear after broker restart when using amqp</title>
                <link>https://issues.apache.org/jira/browse/AMQ-4563</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;To reproduce this, do the following&lt;/p&gt;

&lt;p&gt;1. Start a broker, create a producer using amqp, and send some messages&lt;br/&gt;
2. Stop/Start broker&lt;br/&gt;
3. Create a consumer to consume messages from step 1.&lt;br/&gt;
4. Stop/Start broker&lt;br/&gt;
5. Run consumer again.  It will receive the same messages it already received in step 3.&lt;/p&gt;

&lt;p&gt;I will attach a unit test which reproduces this.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12650132">AMQ-4563</key>
            <summary>Persisted messages reappear after broker restart when using amqp</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tabish">Timothy A. Bish</assignee>
                                    <reporter username="kearls">Kevin Anthony Earls</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 May 2013 12:21:35 +0000</created>
                <updated>Thu, 27 Mar 2014 15:34:43 +0000</updated>
                            <resolved>Thu, 27 Mar 2014 15:34:43 +0000</resolved>
                                    <version>5.8.0</version>
                                    <fixVersion>5.9.0</fixVersion>
                    <fixVersion>5.10.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13670449" author="tabish121" created="Thu, 30 May 2013 16:11:44 +0000"  >&lt;p&gt;Added your great test updates on trunk, did a few tweaks to make the test to reproduce the same consistently for easier debugging.  &lt;/p&gt;</comment>
                            <comment id="13670932" author="tabish121" created="Thu, 30 May 2013 23:05:40 +0000"  >&lt;p&gt;Things will work if the Messages are produced with the ActiveMQ JMS client, however when receiving from the QPid JMS client the message has a MessageID that&apos;s not compatible with ActiveMQ so we don&apos;t correctly process the Ack.  We need to figure out how to ensure that the MessageId is set to an ActiveMQ compatible version on receive.  &lt;/p&gt;</comment>
                            <comment id="13671550" author="chirino" created="Fri, 31 May 2013 15:11:14 +0000"  >&lt;p&gt;This seems to be KahaDB specific.  The test case passes when run against LevelDB.&lt;/p&gt;</comment>
                            <comment id="13671597" author="tabish121" created="Fri, 31 May 2013 15:58:30 +0000"  >&lt;p&gt;Yeah, we sort of backed ourselves into a corner by relying on MessageID to be formatted a specific way.  Without the right values in their things like producer audit and such break.  We should probably maintain an original value in the MessageID when and resend that on dispatch as opposed to overwriting the vendor supplied one with out own. &lt;/p&gt;</comment>
                            <comment id="13671804" author="tabish121" created="Fri, 31 May 2013 20:32:02 +0000"  >&lt;p&gt;fixed.  Its not ideal to have to set the store version as its not very intuitive but at least now we can support the various use cases&lt;/p&gt;</comment>
                            <comment id="13949449" author="tabish121" created="Thu, 27 Mar 2014 15:31:41 +0000"  >&lt;p&gt;If the sending client uses a Message ID format that can be parsed into the basic ActiveMQ message id format this bug reappears.  We need to always create our own Message Id and store off the external ID in the new instance as the TextView for later reuse.  &lt;/p&gt;</comment>
                            <comment id="13949455" author="tabish121" created="Thu, 27 Mar 2014 15:34:43 +0000"  >&lt;p&gt;Fixed in: da07a11760e18edb52035129495edc97193e3fe3&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12585405" name="AMQ-4563.patch" size="6687" author="kearls" created="Thu, 30 May 2013 12:25:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>330459</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 34 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1l0fb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>330793</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>