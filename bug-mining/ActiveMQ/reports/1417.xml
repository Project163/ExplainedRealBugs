<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:53:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-3359] UDP Transport connector listens on a random port number</title>
                <link>https://issues.apache.org/jira/browse/AMQ-3359</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;The broker listens on a random UDP port number instead of the one configure in the URI. The port number changes each time the broker is restarted. However, the management console indicates that the broker&apos;s listening on the configured port number while it is not the case (netstat shows another UDP port number). The reason  is that (as seen in the following block) the UdpTransport constructor does not assign &quot;this.port&quot; from remoteLocation but only reads the address and leaves &quot;this.port&quot; to be zero. Subsequently, Java API picks any available port number when it is creating the DatagraSocket. The solution is to add this line: &quot;this.port = remoteLocation.getPort();&quot; to the following constructor as seen in the accompanying patch.&lt;/p&gt;

&lt;p&gt;public UdpTransport(OpenWireFormat wireFormat, URI remoteLocation) throws UnknownHostException, IOException {&lt;br/&gt;
        this(wireFormat);&lt;br/&gt;
        this.targetAddress = createAddress(remoteLocation);&lt;br/&gt;
        description = remoteLocation.toString() + &quot;@&quot;;&lt;br/&gt;
}&lt;/p&gt;</description>
                <environment></environment>
        <key id="12509370">AMQ-3359</key>
            <summary>UDP Transport connector listens on a random port number</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="amir.malekpour">Amir Malekpour</reporter>
                        <labels>
                            <label>broker</label>
                            <label>port</label>
                            <label>transport</label>
                            <label>udp</label>
                    </labels>
                <created>Mon, 6 Jun 2011 17:18:30 +0000</created>
                <updated>Thu, 9 Feb 2012 16:38:21 +0000</updated>
                            <resolved>Thu, 9 Feb 2012 16:38:20 +0000</resolved>
                                    <version>5.4.0</version>
                    <version>5.4.1</version>
                    <version>5.4.2</version>
                    <version>5.5.0</version>
                                                    <component>Broker</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="300">5m</timeoriginalestimate>
                            <timeestimate seconds="300">5m</timeestimate>
                                        <comments>
                            <comment id="13045673" author="tabish121" created="Tue, 7 Jun 2011 22:26:36 +0000"  >&lt;p&gt;Looks like you might need to update the unit tests to handle this fix otherwise you get a bunch of port in use exceptions.  Should also add some tests to ensure that the port value specified is used.&lt;/p&gt;</comment>
                            <comment id="13059944" author="tabish121" created="Tue, 5 Jul 2011 15:10:04 +0000"  >&lt;p&gt;After some further investigation this doesn&apos;t seem to be an issue.  The broker doesn&apos;t call the constructor that&apos;s referenced in this issue when it creates its transport server, it calls the Constructor taking a wireFormat and port number to bind to.  The constructor referenced uses the remoteLocation address to connect to the broker as expected.&lt;/p&gt;
</comment>
                            <comment id="13059946" author="tabish121" created="Tue, 5 Jul 2011 15:10:42 +0000"  >&lt;p&gt;Some testing seems to indicate that this is working as expected.  Reopen if you can provide a test case the demonstrates the problem.&lt;/p&gt;</comment>
                            <comment id="13091760" author="amir.malekpour" created="Fri, 26 Aug 2011 13:32:01 +0000"  >&lt;p&gt;Well, I have to disagree with you on this. I even resorted to &quot;println&quot; to make sure the method that is called IS the one I&apos;ve mentioned above. (Even if it wasn&apos;t this is clearly a bug in that method to ignore the provided port number, so ignoring the buggy method on the basis that it&apos;s not called does not seem sound to me, though as I sad it is called).&lt;br/&gt;
Now as for a case that proves the existence of the bug, just run the broker with UDP transport and use netstat to check if the broker is actually listening on the specified port. You&apos;ll see that it isn&apos;t. Honestly, if this is not a convincing case I don&apos;t know what is.&lt;/p&gt;</comment>
                            <comment id="13095922" author="amir.malekpour" created="Fri, 2 Sep 2011 11:37:09 +0000"  >&lt;p&gt;Well, I have to disagree with you on this. I even resorted to &quot;println&quot; to make sure the method that is called IS the one I&apos;ve mentioned above. (Even if it wasn&apos;t this is clearly a bug in that method to ignore the provided port number, so ignoring the buggy method on the basis that it&apos;s not called does not seem sound to me, though as I sad it is called).&lt;br/&gt;
Now as for a case that proves the existence of the bug, just run the broker with UDP transport and use netstat to check if the broker is actually listening on the specified port. You&apos;ll see that it isn&apos;t. Honestly, if this is not a convincing case I don&apos;t know what is.&lt;/p&gt;</comment>
                            <comment id="13182602" author="ceposta" created="Mon, 9 Jan 2012 16:21:06 +0000"  >&lt;p&gt;Amir,&lt;br/&gt;
The unit tests to which Tim refers do indeed break when applying the patch you created, as they are intended. As it appears, the different constructors in the UdpTransport class are intended for different uses. The constructor on which you made you changes is intended by the client transport creation. Which means, as you pointed out, there must be a bug because the server code is calling that constructor intended for the client. I have written a simple test to demonstrate the error, and the patch I added to the JIRA fixes the issue. Strangely, this issue&apos;s fix is related to the issue seen here: &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-3275&quot; title=&quot;Make UDP protocol work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-3275&quot;&gt;&lt;del&gt;AMQ-3275&lt;/del&gt;&lt;/a&gt;. For that JIRA, a patch was committed to the trunk (&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1089864&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1089864&lt;/a&gt;), but it appears that patch was never merged in to any release versions. Tim, maybe you can see why that is. In any event, I&apos;ve submitted my code anyway as a patch which adds comments and cleans up the code a little bit. See UdpTransportBindTest.java for a simple integration test that shows the connection broken and working before/after applying the patch.  &lt;/p&gt;</comment>
                            <comment id="13182607" author="ceposta" created="Mon, 9 Jan 2012 16:27:34 +0000"  >&lt;p&gt;sorry for the many updates and comments, but i have one more. my patch was written against the 5.4.3 tag&lt;/p&gt;</comment>
                            <comment id="13204629" author="tabish121" created="Thu, 9 Feb 2012 16:38:20 +0000"  >&lt;p&gt;Added the supplied test case to trunk, test passes.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12509927" name="AMQ-3359.patch" size="2271" author="ceposta" created="Mon, 9 Jan 2012 16:23:09 +0000"/>
                            <attachment id="12481592" name="AMQ-3359.patch" size="690" author="amir.malekpour" created="Mon, 6 Jun 2011 17:30:32 +0000"/>
                            <attachment id="12509928" name="UpdTransportBindTest.java" size="1770" author="ceposta" created="Mon, 9 Jan 2012 16:24:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>62674</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 41 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ebv3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>81684</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>