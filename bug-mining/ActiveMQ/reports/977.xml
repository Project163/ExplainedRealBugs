<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:47:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-2840] JMSX Properties not returned from message.propertyExists() and message.getPropertyNames()</title>
                <link>https://issues.apache.org/jira/browse/AMQ-2840</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Methods propertyExists() and getPropertyNames() defined in the class org.apache.activemq.command.ActiveMQMessage (activemq-core) return only custom properties. The JMSX properties (like JMSXDeliveryCount) are not being returned. This problem exists not only for a new version of ActiveMQ (5.4), but also for 5.3 (and probably for others as well).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12483498">AMQ-2840</key>
            <summary>JMSX Properties not returned from message.propertyExists() and message.getPropertyNames()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gtully">Gary Tully</assignee>
                                    <reporter username="andriyhnativ">Andriy Hnativ</reporter>
                        <labels>
                    </labels>
                <created>Tue, 20 Jul 2010 14:57:34 +0000</created>
                <updated>Tue, 7 Sep 2010 12:34:42 +0000</updated>
                            <resolved>Mon, 30 Aug 2010 15:46:59 +0000</resolved>
                                    <version>5.4.0</version>
                                    <fixVersion>5.4.1</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12940031" author="andriyhnativ" created="Tue, 20 Jul 2010 15:00:15 +0000"  >&lt;p&gt;The patch&lt;/p&gt;</comment>
                            <comment id="12939743" author="rodos77" created="Tue, 3 Aug 2010 20:07:27 +0000"  >&lt;p&gt;Any way this fix can be included in 5.4.0?  This seems like a glaring omission of very basic functionality and the fix looks simple enough.&lt;/p&gt;</comment>
                            <comment id="12938964" author="gtully" created="Mon, 9 Aug 2010 09:14:21 +0000"  >&lt;p&gt;patch applied in r983564 with thanks. added a test to keep the changes safe!&lt;/p&gt;</comment>
                            <comment id="12938052" author="genspring" created="Thu, 19 Aug 2010 04:55:46 +0000"  >&lt;p&gt;Hi, this patch broke the jms spec:&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------------------------------------------&lt;br/&gt;
/**Returns an Enumeration of all the property names. &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;Note that &lt;b&gt;JMS standard header fields are not considered properties and are not returned in this enumeration&lt;/b&gt;.&lt;br/&gt;
**/&lt;br/&gt;
Enumeration getPropertyNames()  throws JMSException&lt;br/&gt;
----------------------------------------------------------------------------------------------------&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So that this change is preventing the tck from passing.    Could you please fix this ?  &lt;/p&gt;</comment>
                            <comment id="12937894" author="gtully" created="Thu, 19 Aug 2010 09:02:15 +0000"  >&lt;p&gt;pending spec compliance issue - part of this patch needs to be reverted.&lt;/p&gt;</comment>
                            <comment id="12938007" author="gtully" created="Thu, 19 Aug 2010 09:07:10 +0000"  >&lt;p&gt;reverted the non jms spec compliant part of the patch in r987090&lt;/p&gt;</comment>
                            <comment id="12938428" author="genspring" created="Thu, 19 Aug 2010 14:50:31 +0000"  >&lt;p&gt;I found that the version of trunk is 5.5-SNAPSHOT.    Are you planing to release a 5.4.1 to fix this ?&lt;/p&gt;

&lt;p&gt;In my opinion,  a 5.4.1 with fix should be released ASAP because the user&apos;s JMS code based on the wrong implementation will not be portable.&lt;/p&gt;</comment>
                            <comment id="12938850" author="rodos77" created="Thu, 19 Aug 2010 14:52:28 +0000"  >&lt;p&gt;Guys, let&apos;s read the JMS spec carefully:&lt;/p&gt;

&lt;p&gt;The spec says that the following are standard header fields (starting with &quot;JMS&quot; prefix):&lt;br/&gt;
JMSDestination&lt;br/&gt;
JMSDeliveryMode&lt;br/&gt;
JMSExpiration&lt;br/&gt;
JMSPriority&lt;br/&gt;
JMSMessageID&lt;br/&gt;
JMSTimestamp&lt;br/&gt;
JMSCorrelationID&lt;br/&gt;
JMSReplyTo&lt;br/&gt;
JMSType&lt;br/&gt;
JMSRedelivered&lt;/p&gt;

&lt;p&gt;However, the following are NOT header fields but are JMS Defined &lt;b&gt;&lt;em&gt;Properties&lt;/em&gt;&lt;/b&gt; (starting with &quot;JMSX&quot; prefix):&lt;br/&gt;
JMSXUserID&lt;br/&gt;
JMSXAppID&lt;br/&gt;
JMSXDeliveryCount&lt;br/&gt;
JMSXGroupID&lt;br/&gt;
JMSXGroupSeq&lt;br/&gt;
JMSXProducerTXID&lt;br/&gt;
JMSXConsumerTXID&lt;br/&gt;
JMSXRcvTimestamp&lt;br/&gt;
JMSXState&lt;/p&gt;

&lt;p&gt;Of these, it looks like AMQ supports 3: JMSXDeliveryCount, JMSXGroupID and JMSXGroupSeq.  Now, the ActiveMQMessage class puts both the JMS header fields and the JMSX message properties into the same JMS_PROPERTY_SETERS map, so i agree, returning the whole map is wrong, but the JMSX properties MUST still be returned.&lt;/p&gt;

&lt;p&gt;So I think the proper solution is to replace the (reverted) line:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;result.addAll(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Vector&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;(JMS_PROPERTY_SETERS.keySet()));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;with something like:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; propName : JMS_PROPERTY_SETERS.keySet()) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (propName.startsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;JMSX&quot;&lt;/span&gt;)) {
        propsVector.add(propName);
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12938588" author="gtully" created="Thu, 19 Aug 2010 15:34:12 +0000"  >&lt;p&gt;Eugene, that seems correct, have made is so JMSX props are returned. r987193&lt;/p&gt;

&lt;p&gt;Shawn, will this pass the tck?&lt;/p&gt;

&lt;p&gt;As to a 5.4.1 asap, I agree it is a portability issue, but one few people are likely to encounter. Lets see what others think.&lt;/p&gt;</comment>
                            <comment id="12942382" author="kevan" created="Fri, 20 Aug 2010 02:45:44 +0000"  >&lt;p&gt;In Geronimo, we&apos;ve been lining up our next 2.2.x release to be based on 5.4.0. With the limited time between this regression and release, we weren&apos;t able to nail down the cause of this problem (we had made connector/transaction manager updates around the same time, which could have had some impact on our JMS tests).&lt;/p&gt;

&lt;p&gt;So, I, for one, would be interested in a 5.4.1 release &quot;soon&quot;.&lt;/p&gt;</comment>
                            <comment id="12937308" author="genspring" created="Fri, 20 Aug 2010 07:46:43 +0000"  >&lt;p&gt;Gary,  #987193  bring the same TCK Failures.    Could you revert them ?&lt;/p&gt;</comment>
                            <comment id="12942381" author="gtully" created="Fri, 20 Aug 2010 09:57:13 +0000"  >&lt;p&gt;I reverted the changes so the TCK will pass. I added a new method, getAllPropertyNames() that returns all the properties, JMS standard props and JMSX extension props, so folks who want this non standard behavior can have it in an explicitly non portable way.&lt;/p&gt;

&lt;p&gt;My bad on this late change, not sure it would have been avoided if I validated against the spec though, I would have taken Eugene&apos;s interpretation.&lt;/p&gt;

&lt;p&gt;What is the expected drop date for Geronimo, it makes sense to cut a new release for the next 2.2.x release. Think it may also makes sense to wait some time to ensure there are no other must fix issues.&lt;/p&gt;</comment>
                            <comment id="12937727" author="kevan" created="Fri, 20 Aug 2010 13:21:04 +0000"  >&lt;p&gt;Shawn, thanks for running those tests!&lt;/p&gt;

&lt;p&gt;We&apos;re also waiting for an Axis release. But I&apos;m hoping for a mid-September release. So, a 5.4.1 in 2-3 weeks should work. &lt;/p&gt;</comment>
                            <comment id="12942789" author="gtully" created="Mon, 30 Aug 2010 15:46:59 +0000"  >&lt;p&gt;resolving this. It may make sense to validate tck again, just to be sure to be sure.&lt;/p&gt;</comment>
                            <comment id="12942870" author="rickmcguire" created="Tue, 7 Sep 2010 12:34:42 +0000"  >&lt;p&gt;The axis2 release we&apos;re waiting on for the Geronimo release has finally gone to a vote.  We&apos;re going to be needed the 5.4.1 release shortly too.  The snapshot version has been looking good with the TCK. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12461771" name="patch.txt" size="1501" author="andriyhnativ" created="Tue, 20 Jul 2010 15:00:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>14794</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 12 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ba5j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>63757</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310080" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Regression</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10091"><![CDATA[Regression]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>