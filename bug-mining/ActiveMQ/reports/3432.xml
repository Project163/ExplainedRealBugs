<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:52:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-9159] TopicSubscription should only remove nodes from dispatched list that match destination</title>
                <link>https://issues.apache.org/jira/browse/AMQ-9159</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;I found a minor issue on destination removal from TopicSubscriptions where the dispatched list is cleared but really only nodes that match the removed destination should be removed. There can be multiple destinations associated if it&apos;s a wild card consumer.  &lt;del&gt;I am putting this as minor as I don&apos;t think if it&apos;s a real issue in practice as you generally can&apos;t remove a destination from an active subscription so since they only get removed when the subscription is closed we would be cleaning up the entire list anyways.&lt;/del&gt; &lt;/p&gt;

&lt;p&gt;&lt;del&gt;Either way i figure it&apos;s worth fixing. It&apos;s not easy to write a test just for this since closing the sub to remove the dest clears everything anyways (as I said) but there are plenty of existing tests that should exercise the change including the in flight statistics tests.&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;Edit: I found there is an API method to remove 1 destination from an active wildcard sub so this is a bigger deal. I have a test case that shows this works now and I will push it shortly. If you pass in a timeout greater than 0 to the removeDestination() method in Region then it will just remove the sub from the dest and not fail. The BrokerView does this &lt;a href=&quot;https://github.com/apache/activemq/blob/2b81946e34805b7f08913cd37543729f2a3ed884/activemq-broker/src/main/java/org/apache/activemq/broker/jmx/BrokerView.java#L426&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; for JMX so it&apos;s definitely possible to do from JMX and by users. &lt;/p&gt;

&lt;p&gt;The new test shows that the statistics are correct which means the in flight nodes in the list are removed when the destination is gone.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13500978">AMQ-9159</key>
            <summary>TopicSubscription should only remove nodes from dispatched list that match destination</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cshannon">Christopher L. Shannon</assignee>
                                    <reporter username="cshannon">Christopher L. Shannon</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Nov 2022 21:16:17 +0000</created>
                <updated>Thu, 17 Nov 2022 14:11:55 +0000</updated>
                            <resolved>Thu, 10 Nov 2022 21:19:07 +0000</resolved>
                                    <version>5.17.2</version>
                                    <fixVersion>5.18.0</fixVersion>
                    <fixVersion>5.17.3</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17631923" author="jira-bot" created="Thu, 10 Nov 2022 21:17:50 +0000"  >&lt;p&gt;Commit 837df23be66f9d22e4df61ae40cd70de34e064a7 in activemq&apos;s branch refs/heads/main from Christopher L. Shannon (cshannon)&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=837df23be&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=837df23be&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-9159&quot; title=&quot;TopicSubscription should only remove nodes from dispatched list that match destination&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-9159&quot;&gt;&lt;del&gt;AMQ-9159&lt;/del&gt;&lt;/a&gt; - In topic subscriptions only remove nodes from dispatched list if&lt;br/&gt;
they match the destination on destination removal&lt;/p&gt;</comment>
                            <comment id="17631924" author="jira-bot" created="Thu, 10 Nov 2022 21:18:58 +0000"  >&lt;p&gt;Commit 8062423dcdc11260347cb797a98f719de2dac7bd in activemq&apos;s branch refs/heads/activemq-5.17.x from Christopher L. Shannon (cshannon)&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=8062423dc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=8062423dc&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-9159&quot; title=&quot;TopicSubscription should only remove nodes from dispatched list that match destination&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-9159&quot;&gt;&lt;del&gt;AMQ-9159&lt;/del&gt;&lt;/a&gt; - In topic subscriptions only remove nodes from dispatched list if&lt;br/&gt;
they match the destination on destination removal&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 837df23be66f9d22e4df61ae40cd70de34e064a7)&lt;/p&gt;</comment>
                            <comment id="17635369" author="jira-bot" created="Thu, 17 Nov 2022 14:10:06 +0000"  >&lt;p&gt;Commit f6e26085cfa3693b2872b1c53354c674c0cbca49 in activemq&apos;s branch refs/heads/main from Christopher L. Shannon (cshannon)&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=f6e26085c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=f6e26085c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-9159&quot; title=&quot;TopicSubscription should only remove nodes from dispatched list that match destination&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-9159&quot;&gt;&lt;del&gt;AMQ-9159&lt;/del&gt;&lt;/a&gt; - Add a test case to verify inflight message stats for wildcard&lt;br/&gt;
consumer when a destination is removed&lt;/p&gt;</comment>
                            <comment id="17635372" author="jira-bot" created="Thu, 17 Nov 2022 14:11:55 +0000"  >&lt;p&gt;Commit 29dcd3f8bf68bcb3c30acc43793caa9bb5b0d386 in activemq&apos;s branch refs/heads/activemq-5.17.x from Christopher L. Shannon (cshannon)&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=29dcd3f8b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=29dcd3f8b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-9159&quot; title=&quot;TopicSubscription should only remove nodes from dispatched list that match destination&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-9159&quot;&gt;&lt;del&gt;AMQ-9159&lt;/del&gt;&lt;/a&gt; - Add a test case to verify inflight message stats for wildcard&lt;br/&gt;
consumer when a destination is removed&lt;/p&gt;

&lt;p&gt;(cherry picked from commit f6e26085cfa3693b2872b1c53354c674c0cbca49)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 51 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1bvp4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>