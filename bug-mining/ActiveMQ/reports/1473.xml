<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:53:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-3680] Cleanup of temporary destinations by PooledConnection and ConnectionPool either leaks temp dests or deletes too many</title>
                <link>https://issues.apache.org/jira/browse/AMQ-3680</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Creating this as follow-up on &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-3457&quot; title=&quot;temp destinations should only be deleted once all users of a pooled connection call close&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-3457&quot;&gt;&lt;del&gt;AMQ-3457&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-3457&quot; title=&quot;temp destinations should only be deleted once all users of a pooled connection call close&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-3457&quot;&gt;&lt;del&gt;AMQ-3457&lt;/del&gt;&lt;/a&gt; removed cleanup on call to close() for PooledConnection objects, causing temporary destinations to remain in the broker until all uses of the actual underlying ActiveMQ connection are closed.  Since those other uses of the underlying connection can be held indefinitely, or - on a very active system - there might be almost no time when there are no users of a connection, those temporary destinations essentially create a leak.&lt;/p&gt;

&lt;p&gt;The most correct operation would remove the temporary destination for each PooledConnection when it&apos;s close() method is called.&lt;/p&gt;

&lt;p&gt;Prior to &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-3457&quot; title=&quot;temp destinations should only be deleted once all users of a pooled connection call close&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-3457&quot;&gt;&lt;del&gt;AMQ-3457&lt;/del&gt;&lt;/a&gt;, updates for &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-2349&quot; title=&quot;Temporary destinations created with PooledConnectionFactory never get deleted&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-2349&quot;&gt;&lt;del&gt;AMQ-2349&lt;/del&gt;&lt;/a&gt; attempted to resolve this problem, but ended up being overly-aggressive, removing all of the temporary destinations from the underlying connection.  So, one PooledConnection&apos;s close() deleted temporary destinations for multiple PooledConnection objects which were still active.&lt;/p&gt;

&lt;p&gt;Test case and patch will be provided.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12539703">AMQ-3680</key>
            <summary>Cleanup of temporary destinations by PooledConnection and ConnectionPool either leaks temp dests or deletes too many</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tabish">Timothy A. Bish</assignee>
                                    <reporter username="artnaseef">Arthur Naseef</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Jan 2012 00:39:36 +0000</created>
                <updated>Fri, 13 Apr 2012 20:55:11 +0000</updated>
                            <resolved>Fri, 13 Apr 2012 20:55:11 +0000</resolved>
                                                    <fixVersion>5.6.0</fixVersion>
                                    <component>JMS client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="7200">2h</timeoriginalestimate>
                            <timeestimate seconds="7200">2h</timeestimate>
                                        <comments>
                            <comment id="13192724" author="artnaseef" created="Wed, 25 Jan 2012 00:45:22 +0000"  >&lt;p&gt;Patch which adds the correct cleanup on close() of PooledConnection.&lt;/p&gt;</comment>
                            <comment id="13192726" author="artnaseef" created="Wed, 25 Jan 2012 00:47:22 +0000"  >&lt;p&gt;JUnit that quickly demonstrates the issue.&lt;/p&gt;

&lt;p&gt;Includes code to test that a connection&apos;s temporary destinations are removed as well as another test that one connection doesn&apos;t remove the temp destinations of another.&lt;/p&gt;</comment>
                            <comment id="13253739" author="tabish121" created="Fri, 13 Apr 2012 20:55:11 +0000"  >&lt;p&gt;Fix applied with a few mods and license header additions.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12511768" name="TestConnectionPoolTempCleanup.java" size="7795" author="artnaseef" created="Wed, 25 Jan 2012 00:47:22 +0000"/>
                            <attachment id="12511767" name="pooledConnCleanupOwnTemps.patch" size="8549" author="artnaseef" created="Wed, 25 Jan 2012 00:45:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>225206</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 32 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0aian:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>59237</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>