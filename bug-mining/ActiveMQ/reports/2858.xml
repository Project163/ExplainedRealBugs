<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:35:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-6346] Concurrent access to a MQTT Transport from WebSocket client can deadlock</title>
                <link>https://issues.apache.org/jira/browse/AMQ-6346</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Just like in &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6046&quot; title=&quot;Concurrent access to a Transport from WebSocket client can deadlock&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6046&quot;&gt;&lt;del&gt;AMQ-6046&lt;/del&gt;&lt;/a&gt;, WebSocket connections can encounter a deadlock when the Jetty side allows for concurrent access to the Transport instance that forwards commands onto the broker core. &lt;/p&gt;

&lt;p&gt;This was fixed for Stomp in &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6046&quot; title=&quot;Concurrent access to a Transport from WebSocket client can deadlock&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6046&quot;&gt;&lt;del&gt;AMQ-6046&lt;/del&gt;&lt;/a&gt; but also needs to be fixed for MQTT.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12986886">AMQ-6346</key>
            <summary>Concurrent access to a MQTT Transport from WebSocket client can deadlock</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cshannon">Christopher L. Shannon</assignee>
                                    <reporter username="cshannon">Christopher L. Shannon</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Jul 2016 17:46:39 +0000</created>
                <updated>Wed, 6 Jul 2016 09:45:34 +0000</updated>
                            <resolved>Tue, 5 Jul 2016 18:20:06 +0000</resolved>
                                    <version>5.13.3</version>
                                    <fixVersion>5.13.4</fixVersion>
                    <fixVersion>5.14.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15362885" author="jira-bot" created="Tue, 5 Jul 2016 18:02:00 +0000"  >&lt;p&gt;Commit 96494f74c7142c3396f17696f345c2355c16a61c in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cshannon&quot; class=&quot;user-hover&quot; rel=&quot;cshannon&quot;&gt;cshannon&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=96494f7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=96494f7&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6346&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-6346&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Prevent concurrent access to the MQTT protocol handlers which can lead&lt;br/&gt;
to a tansport level deadlock&lt;/p&gt;</comment>
                            <comment id="15362932" author="jira-bot" created="Tue, 5 Jul 2016 18:19:43 +0000"  >&lt;p&gt;Commit 1dfd0eeb60921243bec8245edb16c07ca98c1857 in activemq&apos;s branch refs/heads/activemq-5.13.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cshannon&quot; class=&quot;user-hover&quot; rel=&quot;cshannon&quot;&gt;cshannon&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=1dfd0ee&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=1dfd0ee&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6346&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-6346&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Prevent concurrent access to the MQTT protocol handlers which can lead&lt;br/&gt;
to a tansport level deadlock&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 96494f74c7142c3396f17696f345c2355c16a61c)&lt;/p&gt;</comment>
                            <comment id="15364064" author="sylvain" created="Wed, 6 Jul 2016 09:45:34 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;device/456736a4-a32a-4eca-be21-b6d10ae4649c::06270219-c703-4575-86ee-842e7cf44d93/ping {&lt;span class=&quot;code-quote&quot;&gt;&quot;version&quot;&lt;/span&gt;:1,&lt;span class=&quot;code-quote&quot;&gt;&quot;state&quot;&lt;/span&gt;:2,&lt;span class=&quot;code-quote&quot;&gt;&quot;timestamp&quot;&lt;/span&gt;:1467798091.606}
device/456736a4-a32a-4eca-be21-b6d10ae4649c::06270219-c703-4575-86ee-842e7cf44d93/ping {&lt;span class=&quot;code-quote&quot;&gt;&quot;version&quot;&lt;/span&gt;:1,&lt;span class=&quot;code-quote&quot;&gt;&quot;state&quot;&lt;/span&gt;:0}
device/456736a4-a32a-4eca-be21-b6d10ae4649c::06270219-c703-4575-86ee-842e7cf44d93/ping (&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2016-07-06 11:44:03,537 | INFO  | send() clientId: 06270219-c703-4575-86ee-842e7cf44d93 userName: 456736a4-a32a-4eca-be21-b6d10ae4649c::06270219-c703-4575-86ee-842e7cf44d93 send: ActiveMQBytesMessage {commandId = 7, responseRequired = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, messageId = ID:deverylight-all-snapshot-39700-1467796619118-3:30:-1:1:2, originalDestination = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, originalTransactionId = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, producerId = ID:deverylight-all-snapshot-39700-1467796619118-3:30:-1:1, destination = topic:&lt;span class=&quot;code-comment&quot;&gt;//device.456736a4-a32a-4eca-be21-b6d10ae4649c::06270219-c703-4575-86ee-842e7cf44d93.ping, transactionId = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, expiration = 0, timestamp = 1467798243536, arrival = 0, brokerInTime = 0, brokerOutTime = 0, correlationId = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, replyTo = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, persistent = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, type = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, priority = 4, groupID = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, groupSequence = 0, targetConsumerId = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, compressed = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, userID = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, content = org.apache.activemq.util.ByteSequence@27666d7e, marshalledProperties = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, dataStructure = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, redeliveryCounter = 0, size = 0, properties = {ActiveMQ.MQTT.QoS=1, ActiveMQ.Retain=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;}, readOnlyProperties = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, readOnlyBody = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, droppable = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, jmsXGroupFirstForConsumer = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;} ActiveMQBytesMessage{ bytesOut = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, dataOut = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, dataIn = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; } payload: {&lt;span class=&quot;code-quote&quot;&gt;&quot;version&quot;&lt;/span&gt;:1,&lt;span class=&quot;code-quote&quot;&gt;&quot;state&quot;&lt;/span&gt;:0} | com.deveryware.deverylight.activemq.TokenAuthenticationBroker | MQTTInactivityMonitor Async Task: java.util.concurrent.ThreadPoolExecutor$Worker@1e217f8f[State = -1, empty queue]
&lt;/span&gt;2016-07-06 11:44:03,544 | INFO  | removeConnection() clientId: 06270219-c703-4575-86ee-842e7cf44d93 userName: 456736a4-a32a-4eca-be21-b6d10ae4649c::06270219-c703-4575-86ee-842e7cf44d93 info: ConnectionInfo {commandId = 0, responseRequired = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, connectionId = ID:deverylight-all-snapshot-39700-1467796619118-3:30, clientId = 06270219-c703-4575-86ee-842e7cf44d93, clientIp = ws:&lt;span class=&quot;code-comment&quot;&gt;//192.168.0.2:55942, userName = 456736a4-a32a-4eca-be21-b6d10ae4649c::06270219-c703-4575-86ee-842e7cf44d93, password = *****, brokerPath = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, brokerMasterConnector = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, manageable = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, clientMaster = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, faultTolerant = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, failoverReconnect = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;} | com.deveryware.deverylight.activemq.TokenAuthenticationBroker | MQTTInactivityMonitor Async Task: java.util.concurrent.ThreadPoolExecutor$Worker@1e217f8f[State = -1, empty queue]
&lt;/span&gt;2016-07-06 11:44:03,544 | WARN  | Transport Connection to: ws:&lt;span class=&quot;code-comment&quot;&gt;//192.168.0.2:55942 failed: org.apache.activemq.transport.InactivityIOException: Channel was inactive &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; too (&amp;gt;30000) &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;: ws://192.168.0.2:55942 | org.apache.activemq.broker.TransportConnection.Transport | MQTTInactivityMonitor Async Task: java.util.concurrent.ThreadPoolExecutor$Worker@1e217f8f[State = -1, empty queue]&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;works fine thanks!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12913723">AMQ-6046</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 19 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i30jt3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>