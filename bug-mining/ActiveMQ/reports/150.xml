<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:32:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-1045] PooledConnectionFactory does not work with the org.springframework.jms.listener.DefaultMessageListenerContainer in the failure case</title>
                <link>https://issues.apache.org/jira/browse/AMQ-1045</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;The DefaultMessageListenerContainer has retry logic built into it. When a connection dies it tried to reconnect by getting a new connection from the ConnectionFactory. Since the PooledConenctionFactory has one Connection it, it keeps on trying to give out the Connection that died. We would like the PooledConnectionFactory to be able to &quot;evict&quot; the dead connection and create a new one.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12483318">AMQ-1045</key>
            <summary>PooledConnectionFactory does not work with the org.springframework.jms.listener.DefaultMessageListenerContainer in the failure case</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="chirino">Hiram R. Chirino</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 Nov 2006 14:09:55 +0000</created>
                <updated>Tue, 27 Sep 2011 21:32:19 +0000</updated>
                            <resolved>Tue, 27 Sep 2011 21:32:19 +0000</resolved>
                                    <version>4.0</version>
                                                        <due></due>
                            <votes>5</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="12938624" author="chirino" created="Tue, 14 Nov 2006 14:13:44 +0000"  >&lt;p&gt;Fixed in trunk rev 474799 and in 4.1 branch rev 474800&lt;/p&gt;</comment>
                            <comment id="12938971" author="mickolka" created="Fri, 4 May 2007 14:06:29 +0000"  >&lt;p&gt;Similar problem&lt;br/&gt;
4.1.1 rev 533993&lt;br/&gt;
sometimes when I shut down one of ActiveMQ servers that configured in JDBC master-slave way &lt;br/&gt;
DefaultMessageListenerContainer does not reconnect.&lt;br/&gt;
Messages are published but not consumed&lt;/p&gt;

&lt;p&gt;Config of container&lt;br/&gt;
    &amp;lt;bean class=&quot;org.springframework.jms.listener.DefaultMessageListenerContainer&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;autoStartup&quot; value=&quot;${jms.sms.start}&quot; /&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;concurrentConsumers&quot; value=&quot;${jms.sms.concurrent.consumers}&quot; /&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;connectionFactory&quot; ref=&quot;jmsConnectionFactory&quot; /&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;destination&quot; ref=&quot;jmsSmsDestination&quot; /&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;messageListener&quot; ref=&quot;smsJmsListener&quot; /&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;sessionTransacted&quot; value=&quot;true&quot;&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
    &amp;lt;/bean&amp;gt;&lt;br/&gt;
Connection factory&lt;/p&gt;

&lt;p&gt;	&amp;lt;bean id=&quot;jmsConnectionFactory&quot;&lt;br/&gt;
		class=&quot;org.apache.activemq.pool.PooledConnectionFactory&quot;&lt;br/&gt;
		init-method=&quot;start&quot; destroy-method=&quot;stop&quot;&amp;gt;&lt;br/&gt;
		&amp;lt;property name=&quot;connectionFactory&quot;&amp;gt;&lt;br/&gt;
			&amp;lt;bean&lt;br/&gt;
				class=&quot;org.apache.activemq.ActiveMQConnectionFactory&quot;&amp;gt;&lt;br/&gt;
				&amp;lt;property name=&quot;brokerURL&quot;&lt;br/&gt;
					value=&quot;failover:(tcp://localhost:61616,tcp://localhost:61716)&quot; /&amp;gt;&lt;br/&gt;
				&amp;lt;property name=&quot;redeliveryPolicy&quot;&amp;gt;&lt;br/&gt;
					&amp;lt;bean class=&quot;org.apache.activemq.RedeliveryPolicy&quot;&amp;gt;&lt;br/&gt;
						&amp;lt;property name=&quot;backOffMultiplier&quot; value=&quot;3&quot;/&amp;gt;&lt;br/&gt;
						&amp;lt;property name=&quot;useExponentialBackOff&quot; value=&quot;true&quot;/&amp;gt;&lt;br/&gt;
						&amp;lt;property name=&quot;maximumRedeliveries&quot; value=&quot;11&quot;&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
						&amp;lt;property name=&quot;initialRedeliveryDelay&quot; value=&quot;2000&quot;&amp;gt;&amp;lt;/property&amp;gt;&lt;br/&gt;
					&amp;lt;/bean&amp;gt;&lt;br/&gt;
				&amp;lt;/property&amp;gt;&lt;br/&gt;
			&amp;lt;/bean&amp;gt;&lt;br/&gt;
		&amp;lt;/property&amp;gt;&lt;br/&gt;
	&amp;lt;/bean&amp;gt;&lt;/p&gt;


&lt;p&gt;Also whenit reconeects it show such messages often&lt;/p&gt;

&lt;p&gt;DEBUG AbstractRegion                 - Removing consumer: ID:MPaliyenkoN2-3962-1178284368281-1:0:1:2014&lt;br/&gt;
DEBUG AbstractRegion                 - Adding consumer: ID:MPaliyenkoN2-3962-1178284368281-1:0:1:2015&lt;br/&gt;
DEBUG AbstractRegion                 - Removing consumer: ID:MPaliyenkoN2-3962-1178284368281-1:0:1:2015&lt;br/&gt;
DEBUG AbstractRegion                 - Adding consumer: ID:MPaliyenkoN2-3962-1178284368281-1:0:1:2016&lt;br/&gt;
DEBUG AbstractRegion                 - Removing consumer: ID:MPaliyenkoN2-3962-1178284368281-1:0:1:2016&lt;br/&gt;
DEBUG AbstractRegion                 - Adding consumer: ID:MPaliyenkoN2-3962-1178284368281-1:0:1:2017&lt;br/&gt;
DEBUG AbstractRegion                 - Removing consumer: ID:MPaliyenkoN2-3962-1178284368281-1:0:1:2017&lt;br/&gt;
DEBUG AbstractRegion                 - Adding consumer: ID:MPaliyenkoN2-3962-1178284368281-1:0:1:2018&lt;/p&gt;


&lt;p&gt;After I switched several times the messages dissapeared.&lt;/p&gt;

&lt;p&gt;Server config&lt;/p&gt;

&lt;p&gt;&amp;lt;beans&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;!-- Allows us to use system properties as variables in this configuration file --&amp;gt;&lt;br/&gt;
&amp;lt;bean class=&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;broker brokerName=&quot;localhost&quot; useJmx=&quot;true&quot; xmlns=&quot;http://activemq.org/config/1.0&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;!-- Use the following to set the broker memory limit&lt;br/&gt;
&amp;lt;memoryManager&amp;gt;&lt;br/&gt;
&amp;lt;usageManager id=&quot;memory-manager&quot; limit=&quot;20 MB&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/memoryManager&amp;gt;&lt;br/&gt;
--&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;!-- Use the following to configure how ActiveMQ is exposed in JMX&lt;br/&gt;
&amp;lt;managementContext&amp;gt;&lt;br/&gt;
&amp;lt;managementContext connectorPort=&quot;1099&quot; jmxDomainName=&quot;org.apache.activemq&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/managementContext&amp;gt;&lt;br/&gt;
--&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;persistenceAdapter&amp;gt;&lt;br/&gt;
&amp;lt;jdbcPersistenceAdapter dataSource=&quot;#mysql-ds&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/persistenceAdapter&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;transportConnectors&amp;gt;&lt;br/&gt;
&amp;lt;transportConnector name=&quot;openwire&quot; uri=&quot;tcp://localhost:61616&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;transportConnector name=&quot;ssl&quot; uri=&quot;ssl://localhost:61617&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;transportConnector name=&quot;stomp&quot; uri=&quot;stomp://localhost:61613&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/transportConnectors&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;networkConnectors&amp;gt;&lt;br/&gt;
&amp;lt;!-- by default just auto discover the other brokers --&amp;gt;&lt;br/&gt;
&amp;lt;networkConnector name=&quot;default-nc&quot; uri=&quot;multicast://default&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;!--&lt;br/&gt;
&amp;lt;networkConnector name=&quot;host1 and host2&quot; uri=&quot;static://(tcp://host1:61616,tcp://host2:61616)&quot; failover=&quot;true&quot;/&amp;gt;&lt;br/&gt;
--&amp;gt;&lt;br/&gt;
&amp;lt;/networkConnectors&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;/broker&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;bean id=&quot;mysql-ds&quot; class=&quot;org.apache.commons.dbcp.BasicDataSource&quot; destroy-method=&quot;close&quot;&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;driverClassName&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost/sonoportal?relaxAutoCommit=true&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;username&quot; value=&quot;root&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;property name=&quot;password&quot; value=&quot;&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;/beans&amp;gt;&lt;/p&gt;

&lt;p&gt;please suggest&lt;/p&gt;</comment>
                            <comment id="12939473" author="djencks" created="Mon, 7 Apr 2008 22:22:02 +0000"  >&lt;p&gt;Did not get fixed in 4.1.2&lt;/p&gt;</comment>
                            <comment id="12941752" author="bunyaminsinif" created="Thu, 16 Jul 2009 15:19:38 +0000"  >&lt;p&gt;PooledConnectionFactory does not deal with pooling of consumers; for that look at a library like Jencks&lt;/p&gt;</comment>
                            <comment id="13115950" author="tabish121" created="Tue, 27 Sep 2011 21:32:19 +0000"  >&lt;p&gt;The 4.x broker line is EOL.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33745</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 9 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ttqf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>172126</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>