<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:34:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-6252] HealthView has a variety of weaknesses</title>
                <link>https://issues.apache.org/jira/browse/AMQ-6252</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;The HealthView utility has a variety of weaknesses.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;The currentState field should be volatile to ensure correct visibility in a multi-threaded environment&lt;/li&gt;
	&lt;li&gt;the assignment to the currentState field at the end of the healthList method should only happen once the &lt;em&gt;final&lt;/em&gt; string has been built.  the current code could expose a caller to a partially built string (since the field is continually re-assigned as the string is built).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;On a separate note, the semantics of this class are non-obvious.  We were monitoring our broker via jmx using the CurrentState attribute for a year or so now and i only just realized that the value is useless.  The value is useless because &lt;em&gt;it is only updated if you call the healthList() method first&lt;/em&gt;.  The CurrentState attribute is the one someone would most likely monitor using an external automated management product, yet it is not useful by itself.  I would recommend one of the following approaches:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;at the very least, the current behavior should be &lt;em&gt;clearly documented&lt;/em&gt; so that users know they have to call one of the other methods first in order to get a valid CurrentState&lt;/li&gt;
	&lt;li&gt;Alternately, it would be nice if calling the getCurrentState() by itself were sufficient.  this could be accomplished via one of the following approaches:
	&lt;ul&gt;
		&lt;li&gt;Have the BrokerService schedule a periodic task to invoke the healthList() method in order to ensure that the CurrentState attribute gets updated.&lt;/li&gt;
		&lt;li&gt;Track a &quot;last updated&quot; field within the HealthView class and have the getCurrentState() method itself invoke the healthList() method first if the currentState is too old.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12958905">AMQ-6252</key>
            <summary>HealthView has a variety of weaknesses</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tabish">Timothy A. Bish</assignee>
                                    <reporter username="jahlborn">james</reporter>
                        <labels>
                    </labels>
                <created>Thu, 14 Apr 2016 17:37:00 +0000</created>
                <updated>Thu, 14 Apr 2016 20:56:20 +0000</updated>
                            <resolved>Thu, 14 Apr 2016 20:56:20 +0000</resolved>
                                    <version>5.9.1</version>
                    <version>5.13.2</version>
                                    <fixVersion>5.13.3</fixVersion>
                    <fixVersion>5.14.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15241837" author="tabish121" created="Thu, 14 Apr 2016 20:28:08 +0000"  >&lt;p&gt;Since the Broker doesn&apos;t know if anyone is even looking at the HealthView bits it wouldn&apos;t be optimal to be doing such a heavyweight operation for no good reason which is why there isn&apos;t a scheduled task.  The last updated value has some merit although it is hard to settle on what an optimal default for that would be given that everyone would have their own opinion.  &lt;/p&gt;</comment>
                            <comment id="15241891" author="jira-bot" created="Thu, 14 Apr 2016 20:53:26 +0000"  >&lt;p&gt;Commit 19fd084a83c990f9fb75a5f2becb48ac808a1b36 in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tabish121&quot; class=&quot;user-hover&quot; rel=&quot;tabish121&quot;&gt;tabish121&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=19fd084&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=19fd084&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6252&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-6252&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Update for some added thread safety.  Adds method healthStatus that will&lt;br/&gt;
regenrate the status from the healthList data which is more intuitive&lt;br/&gt;
than the getCurrentStatus which doesn&apos;t update state and requires&lt;br/&gt;
periodic calls to healthList to capture current metrics.  &lt;/p&gt;</comment>
                            <comment id="15241892" author="jira-bot" created="Thu, 14 Apr 2016 20:53:59 +0000"  >&lt;p&gt;Commit cb6c7fb423bb7347bbe62c4ec5e2845302967b59 in activemq&apos;s branch refs/heads/activemq-5.13.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tabish121&quot; class=&quot;user-hover&quot; rel=&quot;tabish121&quot;&gt;tabish121&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=cb6c7fb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=cb6c7fb&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6252&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-6252&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Update for some added thread safety.  Adds method healthStatus that will&lt;br/&gt;
regenrate the status from the healthList data which is more intuitive&lt;br/&gt;
than the getCurrentStatus which doesn&apos;t update state and requires&lt;br/&gt;
periodic calls to healthList to capture current metrics.&lt;br/&gt;
(cherry picked from commit 19fd084a83c990f9fb75a5f2becb48ac808a1b36)&lt;/p&gt;</comment>
                            <comment id="15241901" author="tabish121" created="Thu, 14 Apr 2016 20:56:20 +0000"  >&lt;p&gt;Fixed thread safety issues and added new method healthStatus that will return a health status string after calling healthList.  This preserves the existing behavior so we don&apos;t break anyone while giving you a better entry into the health information in a poller use case. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 31 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2w4tj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>