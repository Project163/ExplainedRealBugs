<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:54:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-3841] mKahaDB causes ArrayIndexOutOfBoundsException on restart after deleting existing queues</title>
                <link>https://issues.apache.org/jira/browse/AMQ-3841</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;To replicate, use these settings in the activemq.xml&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;		&amp;lt;persistenceAdapter&amp;gt;
			&amp;lt;mKahaDB directory=&lt;span class=&quot;code-quote&quot;&gt;&quot;${activemq.data}/kahadb&quot;&lt;/span&gt;&amp;gt;
				&amp;lt;filteredPersistenceAdapters&amp;gt;
					&amp;lt;filteredKahaDB perDestination=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; &amp;gt;
						&amp;lt;persistenceAdapter&amp;gt;
							&amp;lt;kahaDB journalMaxFileLength=&lt;span class=&quot;code-quote&quot;&gt;&quot;32mb&quot;&lt;/span&gt; /&amp;gt;
						&amp;lt;/persistenceAdapter&amp;gt;
					&amp;lt;/filteredKahaDB&amp;gt;
				&amp;lt;/filteredPersistenceAdapters&amp;gt;
			&amp;lt;/mKahaDB&amp;gt;
		&amp;lt;/persistenceAdapter&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;ol&gt;
	&lt;li&gt;Start the broker&lt;/li&gt;
	&lt;li&gt;Create a queue
	&lt;ul&gt;
		&lt;li&gt;This will create the queue in the /kahadb folder&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Delete the queue
	&lt;ul&gt;
		&lt;li&gt;The queue is not deleted from the /kahadb folder&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Stop the broker&lt;/li&gt;
	&lt;li&gt;Start the broker&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;This will cause cause the stack trace that is attached.&lt;/p&gt;

&lt;p&gt;To fix this, delete the queue in the /kahadb folder and start the broker.  This allows the broker to start as normal.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows 7, JDK 6&lt;/p&gt;</environment>
        <key id="12555856">AMQ-3841</key>
            <summary>mKahaDB causes ArrayIndexOutOfBoundsException on restart after deleting existing queues</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tabish">Timothy A. Bish</assignee>
                                    <reporter username="matt_altermatt">Matt Altermatt</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 May 2012 18:26:28 +0000</created>
                <updated>Thu, 31 May 2012 15:35:32 +0000</updated>
                            <resolved>Tue, 22 May 2012 19:48:09 +0000</resolved>
                                    <version>5.6.0</version>
                                    <fixVersion>5.7.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13276102" author="matt_altermatt" created="Tue, 15 May 2012 18:27:20 +0000"  >&lt;p&gt;Stack trace from starting up the broker with a deleted queue.&lt;/p&gt;</comment>
                            <comment id="13277903" author="tabish121" created="Thu, 17 May 2012 15:48:08 +0000"  >&lt;p&gt;Unit test that can reproduce this issue.&lt;/p&gt;</comment>
                            <comment id="13281176" author="tabish121" created="Tue, 22 May 2012 19:48:09 +0000"  >&lt;p&gt;Fixed in trunk test updated to show that a destination can be removed and then later re-added without issue.&lt;/p&gt;</comment>
                            <comment id="13286569" author="mccarl1978" created="Thu, 31 May 2012 13:52:42 +0000"  >&lt;p&gt;I have one comment on the patch that fixes this issue. The KahaDBStore.getDestinations() method looks as though it would be pretty heavy, performance wise. Should the resultant List be cached instead of retrieved twice, once for .size() and once for .toArray() (lines 321 &amp;amp; 322)?&lt;/p&gt;</comment>
                            <comment id="13286662" author="tabish121" created="Thu, 31 May 2012 15:35:32 +0000"  >&lt;p&gt;Done, updated in trunk, should see it in the next nightly.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12527849" name="AMQ3841Test.java" size="4178" author="tabish" created="Thu, 17 May 2012 15:48:07 +0000"/>
                            <attachment id="12527492" name="output.txt" size="21258" author="matt_altermatt" created="Tue, 15 May 2012 18:27:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>249839</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 25 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ahtj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>59160</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>