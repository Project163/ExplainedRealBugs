<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:30:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-643] maxInactivityDuration does not seem to work properly</title>
                <link>https://issues.apache.org/jira/browse/AMQ-643</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;AMQ 4 03/17/2006 SNAPSHOT&lt;/p&gt;

&lt;p&gt;Using maxInactivityDuration causes a connection to automatically break after the inactivity duration, even though nothing is wrong with either side of the connection.&lt;/p&gt;

&lt;p&gt;Tracing it through, it looks like the KeepAliveInfo command does not require a response.  This means that the KeepAlive sent never results in receive activity.  So, if both processes are perfectly fine, just not sending any data, the connection breaks due to InactivityMonitor.readCheck.&lt;/p&gt;

&lt;p&gt;I&apos;ve changed KeepAliveInfo.java to return true for isResponseRequired.  This seems to fix the problem, from a client perspective, anyway.&lt;/p&gt;

&lt;p&gt;However, if this is used for broker-to-broker connections, and you force a problem with one of the brokers (like doing pstop on Solaris), major problems will happen:&lt;/p&gt;

&lt;p&gt;1)  The broker that is left alone seems to break the connection.  But, it continues to attempt to send messages to the failed broker.  It was mentioned in the forum at one point you were going to have the broker unregister subscriptions so it would not attempt to send messages to the failed broker.  Doesn&apos;t seem like this is in place.&lt;/p&gt;

&lt;p&gt;2) If you reawaken the pstopped broker, the two brokers never really recover properly.  Connections continue to get broken, over and over again.&lt;/p&gt;</description>
                <environment>&lt;p&gt;AMQ 4 03/17/2006 SNAPSHOT&lt;br/&gt;
Solaris 8, 10&lt;/p&gt;</environment>
        <key id="12481549">AMQ-643</key>
            <summary>maxInactivityDuration does not seem to work properly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chirino">Hiram R. Chirino</assignee>
                                    <reporter username="yaussy">Kevin Yaussy</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Mar 2006 23:54:16 +0000</created>
                <updated>Thu, 23 Mar 2006 16:43:35 +0000</updated>
                            <resolved>Thu, 23 Mar 2006 16:43:35 +0000</resolved>
                                    <version>4.0 RC2</version>
                                    <fixVersion>4.0 RC2</fixVersion>
                                    <component>Connector</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12937612" author="chirino" created="Mon, 20 Mar 2006 17:15:49 +0000"  >&lt;p&gt;Hi Kevin,&lt;/p&gt;

&lt;p&gt;The maxInactivityDuration setting has to match on both sides of the connection.  If they do then there is no need to make KeepAlives request a reply since the other side will send a KeepAlive if his side of the connection remains idle for too long.&lt;/p&gt;

&lt;p&gt;Could you attache the broker configuration scripts you using?  Thanks!&lt;/p&gt;</comment>
                            <comment id="12937669" author="yaussy" created="Mon, 20 Mar 2006 18:33:44 +0000"  >&lt;p&gt;So, in the case of the client setting the maxInactivityDuration value on its connector url, you are saying that the broker must have a maxInactivityDuration setting (with the same value) on the transportConnector url?&lt;/p&gt;

&lt;p&gt;Not quite sure why you would want to make this restriction.  Seems problematic with regards to potential timing issues.&lt;/p&gt;

&lt;p&gt;Also, if you set the maxInactivityDuration on the transportConnector url, then when you have two brokers connected to each other, they continuously drop connections and resubscribe.  If you also set maxInactivityDuration on the networkConnector url for each broker, then the brokers still drop connections and get whacked out with subcriptions.&lt;/p&gt;

&lt;p&gt;I&apos;ll attach broker XML configs in a bit.&lt;/p&gt;</comment>
                            <comment id="12937636" author="yaussy" created="Mon, 20 Mar 2006 18:40:17 +0000"  >&lt;p&gt;Attached are my broker XML configs.  We run embedded brokers, but have external access to them (i.e. the tcp connectivity).&lt;/p&gt;

&lt;p&gt;I&apos;ve tried with and without the maxInactivityDuration setting on the networkConnector url.&lt;/p&gt;</comment>
                            <comment id="12937682" author="chirino" created="Tue, 21 Mar 2006 04:45:22 +0000"  >&lt;p&gt;Hi Kevin,&lt;/p&gt;

&lt;p&gt;Yeah, I agree, making sure everybody is using the same setting is a bit of a problem.  I working on a change right now that will allow the setting to be negociated by the 2 sides of the connection when it&apos;s initialy established.&lt;/p&gt;

&lt;p&gt;If the server setting is x and the client setting is y, then the inactivity duration for the established connection will be calculated at min(x,y).  This way the client and server do not have to have their configs match up exactly.&lt;/p&gt;

&lt;p&gt;I&apos;ll update the issue once the change is commited.&lt;/p&gt;

&lt;p&gt;Regards,&lt;br/&gt;
Hiram&lt;/p&gt;</comment>
                            <comment id="12937582" author="yaussy" created="Tue, 21 Mar 2006 17:04:42 +0000"  >&lt;p&gt;However, that sounds like both sides would still have to explicitly make the setting, right?&lt;/p&gt;</comment>
                            <comment id="12937586" author="chirino" created="Tue, 21 Mar 2006 18:16:15 +0000"  >&lt;p&gt;The change has been commited.&lt;/p&gt;

&lt;p&gt;You now configure the maxInactivityDuration on the wireFormat.   So on tcp connection, it would look like:&lt;/p&gt;

&lt;p&gt;tcp://localhost:61616?wireFormat.maxInactivityDuration=10000&lt;/p&gt;
</comment>
                            <comment id="12937686" author="yaussy" created="Tue, 21 Mar 2006 18:45:50 +0000"  >&lt;p&gt;I&apos;ll try this out tomorrow after the SNAPSHOT build.&lt;/p&gt;</comment>
                            <comment id="12937734" author="yaussy" created="Thu, 23 Mar 2006 15:55:32 +0000"  >&lt;p&gt;Tried this out yesterday and it seems to work perfectly.  I was able to freeze brokers and have them disconnect from each other, but recover after unfreezing.  Same for clients.&lt;/p&gt;

&lt;p&gt;Nondurable messages are still queued to a disconnected broker, but that can be mitigated by having the asyncDispatch and an eviction strategy to your liking.  I&apos;d rather see the subscriptions dropped, and no further queuing, but maybe that wasn&apos;t doable.&lt;/p&gt;</comment>
                            <comment id="12937541" author="jstrachan" created="Thu, 23 Mar 2006 16:08:25 +0000"  >&lt;p&gt;We could always raise another feature request JIRA for the subscription dropping; also for nondurable messaging we have the option to drop old messages if consumers slow down.&lt;/p&gt;

&lt;p&gt;So is this issue resolved now?&lt;/p&gt;</comment>
                            <comment id="12937590" author="yaussy" created="Thu, 23 Mar 2006 16:17:12 +0000"  >&lt;p&gt;I&apos;m very happy with the eviction policy features.  We will make &lt;b&gt;extensive&lt;/b&gt; use of that (btw, we may want to implement an eviction  policy at some point - any way to do that ?).  However, I can raise a feature request for the subscription dropping.&lt;/p&gt;

&lt;p&gt;One thing I forgot to mention in my comment above is that the broker networkConnector url config changed again.  You now have to explicitly put on failover if you want broker-to-broker connections to use failover.  That dropped off at one point (I was trying to find where you and I conversed about that - it was some other JIRA entry), where you would get double failover transport decorators, thus causing problems with shutdown.  You said that static would do the same thing.&lt;/p&gt;

&lt;p&gt;Anyway, not a big deal, but I believe you had updated some documentation regarding this.  So, you might want to revisit that again.&lt;/p&gt;</comment>
                            <comment id="12937576" author="yaussy" created="Thu, 23 Mar 2006 16:17:33 +0000"  >&lt;p&gt;Doh!   Yes, issue resolved!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12460854" name="ASF.LICENSE.NOT.GRANTED--amq1.xml" size="2945" author="yaussy" created="Mon, 20 Mar 2006 18:40:17 +0000"/>
                            <attachment id="12460732" name="ASF.LICENSE.NOT.GRANTED--amq2.xml" size="2964" author="yaussy" created="Mon, 20 Mar 2006 18:40:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>49275</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 36 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0s2jr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161889</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310080" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Regression</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10091"><![CDATA[Regression]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>