<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:13:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-5400] Unable to keep message order using ActiveMQ-RAR </title>
                <link>https://issues.apache.org/jira/browse/AMQ-5400</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;We have an application server which processes the messages using an MDB.  We are using message grouping to keep the message processing order.&lt;/p&gt;

&lt;p&gt;It seems that it is not possible to do this, because in case the onMessage signals rollback, then the queue does not block until the redelivery time, but keeps on dispatching.&lt;/p&gt;

&lt;p&gt;ActiveMQSession.java method afterRollback() @938 is triggered in this case. Which will redeliver the message by scheduling it:&lt;/p&gt;

&lt;p&gt;connection.getScheduler().executeAfterDelay(new Runnable() {&lt;/p&gt;

&lt;p&gt;                                    @Override&lt;br/&gt;
                                    public void run() &lt;/p&gt;
{
                                        ((ActiveMQDispatcher)md.getConsumer()).dispatch(md);
                                    }
&lt;p&gt;                                }, redeliveryDelay);&lt;/p&gt;

&lt;p&gt;The session is not blocked or otherwise stopped from processing more messages, so it does it.&lt;/p&gt;

&lt;p&gt;Setting prefetch=1 for the consumer did not helped.&lt;br/&gt;
I have maxSessions=1 in the activationSpec.&lt;/p&gt;</description>
                <environment>&lt;p&gt;JBoss EAP6 + ActiveMQ 5.10.0&lt;/p&gt;</environment>
        <key id="12748888">AMQ-5400</key>
            <summary>Unable to keep message order using ActiveMQ-RAR </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gtully">Gary Tully</assignee>
                                    <reporter username="smil">Tamas Cserveny</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Oct 2014 13:47:19 +0000</created>
                <updated>Thu, 16 Jul 2015 11:40:20 +0000</updated>
                            <resolved>Thu, 16 Jul 2015 11:40:20 +0000</resolved>
                                    <version>5.9.0</version>
                    <version>5.10.0</version>
                                    <fixVersion>5.12.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14180265" author="smil" created="Wed, 22 Oct 2014 18:10:48 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I&apos;ve provided a patch which blocks the session for the time of the redelivery. It honours the isNonBlockingRedelivery flag of the connection so it can be turned off. As blocking redelivery is the default this should not be a problem.&lt;/p&gt;

&lt;p&gt;Cheers,&lt;/p&gt;

&lt;p&gt;Tamas&lt;/p&gt;</comment>
                            <comment id="14577269" author="andytaylor" created="Mon, 8 Jun 2015 14:42:27 +0000"  >&lt;p&gt;Ive reviewed your patch Tamas and it looks fine, i&apos;ll get it committed with a couple of tests ive added&lt;/p&gt;</comment>
                            <comment id="14577313" author="andytaylor" created="Mon, 8 Jun 2015 15:08:12 +0000"  >&lt;p&gt;fixed with &lt;a href=&quot;https://github.com/apache/activemq/commit/c9a3202bc3b526bdf65f239dad68f555d7b83df1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/activemq/commit/c9a3202bc3b526bdf65f239dad68f555d7b83df1&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14629597" author="gtully" created="Thu, 16 Jul 2015 11:37:01 +0000"  >&lt;p&gt;a typo in the new redelivery guard has introduced a static - stopping parallel delivery.&lt;/p&gt;</comment>
                            <comment id="14629599" author="jira-bot" created="Thu, 16 Jul 2015 11:39:41 +0000"  >&lt;p&gt;Commit c85c7c14720dffeb44633547db540533796a8388 in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=c85c7c1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=c85c7c1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-5400&quot; title=&quot;Unable to keep message order using ActiveMQ-RAR &quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-5400&quot;&gt;&lt;del&gt;AMQ-5400&lt;/del&gt;&lt;/a&gt; - rework to remove static lock - impacted parallel delivery and hense performance. Fix and additional tet&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12676410" name="block-session-until-redelivery.patch" size="3736" author="smil" created="Wed, 22 Oct 2014 20:09:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 18 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i21anz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>