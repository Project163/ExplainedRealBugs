<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:48:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-2902] ResourceAdapter logs confusing Exception upon pool connection disposal</title>
                <link>https://issues.apache.org/jira/browse/AMQ-2902</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;After upgrading to 5.4.0 we see many exceptions of the following kind being logged with level INFO:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;2010-09-07 13:23:25,824 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq.broker.TransportConnection.Transport&amp;#93;&lt;/span&gt; Transport failed: org.apache.activemq.transport.TransportDisposedIOException: Peer (vm://caa.embedded?waitForStart=300000&amp;amp;async=false#13) disposed.&lt;br/&gt;
org.apache.activemq.transport.TransportDisposedIOException: Peer (vm://caa.embedded?waitForStart=300000&amp;amp;async=false#13) disposed.&lt;br/&gt;
	at org.apache.activemq.transport.vm.VMTransport.stop(VMTransport.java:159)&lt;br/&gt;
	at org.apache.activemq.transport.vm.VMTransportServer$1.stop(VMTransportServer.java:81)&lt;br/&gt;
	at org.apache.activemq.transport.TransportFilter.stop(TransportFilter.java:65)&lt;br/&gt;
	at org.apache.activemq.transport.TransportFilter.stop(TransportFilter.java:65)&lt;br/&gt;
	at org.apache.activemq.transport.ResponseCorrelator.stop(ResponseCorrelator.java:132)&lt;br/&gt;
	at org.apache.activemq.util.ServiceSupport.dispose(ServiceSupport.java:43)&lt;br/&gt;
	at org.apache.activemq.ActiveMQConnection.close(ActiveMQConnection.java:656)&lt;br/&gt;
	at org.apache.activemq.ra.ActiveMQManagedConnection.destroy(ActiveMQManagedConnection.java:207)&lt;br/&gt;
	at org.jboss.resource.connectionmanager.InternalManagedConnectionPool.doDestroy(InternalManagedConnectionPool.java:650)&lt;br/&gt;
	at org.jboss.resource.connectionmanager.InternalManagedConnectionPool.removeTimedOut(InternalManagedConnectionPool.java:481)&lt;br/&gt;
	at org.jboss.resource.connectionmanager.IdleRemover$IdleRemoverRunnable.run(IdleRemover.java:164)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:619)&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I suppose that the cause for the message is actually harmless - hence the INFO level - but the messages are confusing and annoying nonetheless.&lt;/p&gt;</description>
                <environment>&lt;p&gt;AMQ 5.4.0 ResourceAdapter running with an embedded broker within JBoss 4.2.3&lt;/p&gt;</environment>
        <key id="12483456">AMQ-2902</key>
            <summary>ResourceAdapter logs confusing Exception upon pool connection disposal</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="hennejg">Joerg O. Henne</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Sep 2010 11:34:15 +0000</created>
                <updated>Fri, 8 Oct 2010 12:58:23 +0000</updated>
                            <resolved>Fri, 8 Oct 2010 12:58:23 +0000</resolved>
                                    <version>5.4.0</version>
                                    <fixVersion>5.4.2</fixVersion>
                                    <component>JCA Container</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="12942835" author="davsclaus" created="Wed, 8 Sep 2010 05:15:12 +0000"  >&lt;p&gt;I have been told that this is harmless and have been fixed on trunk.&lt;/p&gt;</comment>
                            <comment id="12942954" author="rjtokenlanring" created="Wed, 22 Sep 2010 09:31:32 +0000"  >&lt;p&gt;Also with 5.4.1 release (on JBoss 4.2.3.GA) this issue is present:&lt;/p&gt;

&lt;p&gt;2010-09-22 11:29:31,458 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq.broker.TransportConnection.Transport&amp;#93;&lt;/span&gt; Transport failed: org.apache.activemq.transport.TransportDisposedIOException: Peer (vm://localhost#37) disposed.&lt;br/&gt;
org.apache.activemq.transport.TransportDisposedIOException: Peer (vm://localhost#37) disposed.&lt;br/&gt;
        at org.apache.activemq.transport.vm.VMTransport.stop(VMTransport.java:159)&lt;br/&gt;
        at org.apache.activemq.transport.vm.VMTransportServer$1.stop(VMTransportServer.java:81)&lt;br/&gt;
        at org.apache.activemq.transport.TransportFilter.stop(TransportFilter.java:65)&lt;br/&gt;
        at org.apache.activemq.transport.TransportFilter.stop(TransportFilter.java:65)&lt;br/&gt;
        at org.apache.activemq.transport.ResponseCorrelator.stop(ResponseCorrelator.java:132)&lt;br/&gt;
        at org.apache.activemq.util.ServiceSupport.dispose(ServiceSupport.java:43)&lt;br/&gt;
        at org.apache.activemq.ActiveMQConnection.close(ActiveMQConnection.java:656)&lt;br/&gt;
        at org.apache.activemq.ra.ActiveMQManagedConnection.destroy(ActiveMQManagedConnection.java:207)&lt;br/&gt;
        at org.jboss.resource.connectionmanager.InternalManagedConnectionPool.doDestroy(InternalManagedConnectionPool.java:650)&lt;br/&gt;
        at org.jboss.resource.connectionmanager.InternalManagedConnectionPool.removeTimedOut(InternalManagedConnectionPool.java:481)&lt;br/&gt;
        at org.jboss.resource.connectionmanager.IdleRemover$IdleRemoverRunnable.run(IdleRemover.java:164)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:619)&lt;/p&gt;

&lt;p&gt;But this affects the broker? This could bring to errors or broker faults?&lt;/p&gt;</comment>
                            <comment id="12943023" author="basti1302" created="Fri, 1 Oct 2010 08:19:18 +0000"  >&lt;p&gt;I too see that issue in the current 5.4.1  release. This has nothing to do with JBoss. It is reproducible in an ordinary Java application (see below). Claus, who told you that is fixed in the trunk? From looking at the sources in the trunk I have the impression that the related code has not changed (but I&apos;m guessing a bit here and could be wrong). The small test below reproduces the problem. Note that the exception gets logged less frequently if you start and stop the connection before closing it (enable the two commented lines). But it still occurs. It occurs every time if you do not start and stop the connection.&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;AMQ2902.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.jms.Connection;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.jms.ConnectionFactory;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.jms.JMSException;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.activemq.ActiveMQConnectionFactory;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;AMQ2902
{
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] arguments) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; JMSException
  {
    ConnectionFactory connectionFactory = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ActiveMQConnectionFactory(
        &lt;span class=&quot;code-quote&quot;&gt;&quot;vm:&lt;span class=&quot;code-comment&quot;&gt;//localhost?broker.persistent=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;);
&lt;/span&gt;    Connection connection = connectionFactory.createConnection();
    &lt;span class=&quot;code-comment&quot;&gt;// connection.start();
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// connection.stop();
&lt;/span&gt;    connection.close();
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;Kind regards,&lt;/p&gt;

&lt;p&gt;  Bastian&lt;/p&gt;</comment>
                            <comment id="12943034" author="basti1302" created="Fri, 1 Oct 2010 08:29:18 +0000"  >&lt;p&gt;The obvious workaround is to configure log4j to not show INFO level messages from the logger in question.&lt;/p&gt;


&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; 
  &amp;lt;logger name=&quot;org.apache.activemq.broker.TransportConnection.Transport&quot;&amp;gt;
    &amp;lt;level value=&quot;warn&quot; /&amp;gt;
  &amp;lt;/logger&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 


&lt;p&gt;However, a possible (very simplistic) fix would be to change &lt;tt&gt;TRANSPORTLOG.info(&quot;Transport failed: &quot; + e, e);&lt;/tt&gt; into &lt;tt&gt;TRANSPORTLOG.info(&quot;Transport failed: &quot; + e);&lt;/tt&gt;  in &lt;tt&gt;org.apache.activemq.broker.TransportConnection&lt;/tt&gt;. Since it is only a logging on info, the stack trace is probably not of interest anyway, right?&lt;/p&gt;

&lt;p&gt;Patch:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; 
### Eclipse Workspace Patch 1.0
#P activemq-core
Index: src/main/java/org/apache/activemq/broker/TransportConnection.java
===================================================================
--- src/main/java/org/apache/activemq/broker/TransportConnection.java	(revision 1003422)
+++ src/main/java/org/apache/activemq/broker/TransportConnection.java	(working copy)
@@ -233,7 +233,7 @@
         if (!stopping.get()) {
             transportException.set(e);
             if (TRANSPORTLOG.isInfoEnabled()) {
-                TRANSPORTLOG.info(&quot;Transport failed: &quot; + e, e);
+                TRANSPORTLOG.info(&quot;Transport failed: &quot; + e);
             }
             stopAsync();
         }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="12943000" author="gtully" created="Fri, 8 Oct 2010 12:58:23 +0000"  >&lt;p&gt;resolved in r1005094&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>14843</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 7 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0b9yf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>63725</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>