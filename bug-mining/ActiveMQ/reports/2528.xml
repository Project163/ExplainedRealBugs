<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:09:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-5752] Move and copy message does not work in web console</title>
                <link>https://issues.apache.org/jira/browse/AMQ-5752</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;When moving a message with web console (clicking message, select target queue and press move) the message get&apos;s lost.&lt;/p&gt;

&lt;p&gt;The following message is found in the ActiveMQ log. It&apos;s wierd since a move should not trigger a duplicate error since the message should be moved.&lt;/p&gt;

&lt;p&gt;` INFO | Moving message FROM(ID:petters-mbp.got.vgregion.se-65058-1430309626002-5:1:1:1:1) to TO&lt;br/&gt;
 WARN | org.apache.activemq.broker.region.cursors.QueueStorePrefetch@42db79bc:TO,batchResetNeeded=false,size=0,cacheEnabled=true,maxBatchSize:1,hasSpace:true,pendingCachedIds.size:1,lastSyncCachedId:null,lastSyncCachedId-seq:null,lastAsyncCachedId:null,lastAsyncCachedId-seq:null,store=permits:9999,sd=nextSeq:3,lastRet:MessageOrderCursor:&lt;span class=&quot;error&quot;&gt;&amp;#91;def:0, low:0, high:0&amp;#93;&lt;/span&gt;,pending:0 - cursor got duplicate send ID:petters-mbp.got.vgregion.se-65058-1430309626002-5:1:1:1:1 seq: org.apache.activemq.store.kahadb.KahaDBStore$StoreQueueTask$InnerFutureTask@38864035&lt;br/&gt;
 WARN | Duplicate message add attempt rejected. Destination: QUEUE://TO, Message id: ID:petters-mbp.got.vgregion.se-65058-1430309626002-5:1:1:1:1`&lt;/p&gt;


&lt;p&gt;The same problem goes for &quot;copy&quot;. But, the original message does not get deleted. The error in the log is similar:&lt;/p&gt;

&lt;p&gt;`INFO | FROM(ID:petters-mbp.got.vgregion.se-65058-1430309626002-5:1:1:1:1) copy to TO&lt;br/&gt;
 WARN | org.apache.activemq.broker.region.cursors.QueueStorePrefetch@42db79bc:TO,batchResetNeeded=false,size=0,cacheEnabled=true,maxBatchSize:1,hasSpace:true,pendingCachedIds.size:1,lastSyncCachedId:null,lastSyncCachedId-seq:null,lastAsyncCachedId:null,lastAsyncCachedId-seq:null,store=permits:9999,sd=nextSeq:1,lastRet:MessageOrderCursor:&lt;span class=&quot;error&quot;&gt;&amp;#91;def:0, low:0, high:0&amp;#93;&lt;/span&gt;,pending:0 - cursor got duplicate send ID:petters-mbp.got.vgregion.se-65058-1430309626002-5:1:1:1:1 seq: org.apache.activemq.store.kahadb.KahaDBStore$StoreQueueTask$InnerFutureTask@571547ee&lt;br/&gt;
 WARN | Duplicate message add attempt rejected. Destination: QUEUE://TO, Message id: ID:petters-mbp.got.vgregion.se-65058-1430309626002-5:1:1:1:1`&lt;/p&gt;


&lt;p&gt;The problem with move is a bit critical since it can cause loss of important data.&lt;/p&gt;

&lt;p&gt;Verified in AMQ 5.11.0 and 5.11.1&lt;/p&gt;</description>
                <environment></environment>
        <key id="12825929">AMQ-5752</key>
            <summary>Move and copy message does not work in web console</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10101">Abandoned</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="northlander">Petter Nordlander</reporter>
                        <labels>
                    </labels>
                <created>Wed, 29 Apr 2015 12:26:59 +0000</created>
                <updated>Sun, 13 Mar 2022 14:16:10 +0000</updated>
                            <resolved>Sun, 13 Mar 2022 14:16:10 +0000</resolved>
                                    <version>5.11.0</version>
                    <version>5.11.1</version>
                                                        <due></due>
                            <votes>2</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14521347" author="gtully" created="Thu, 30 Apr 2015 11:28:06 +0000"  >&lt;p&gt;would it be possible to validate a 5.12 snapshot? &lt;br/&gt;
I did a sanity check on the unit test - org.apache.activemq.broker.jmx.MBeanTest#testMoveMessages with kahadb (it used the memory store) and it works as expected.&lt;br/&gt;
I wonder how your scenario is different from the unit test&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/activemq/blob/ad39fc00fbd9556deac2b7ed3646dae598c00125/activemq-unit-tests/src/test/java/org/apache/activemq/broker/jmx/MBeanTest.java#L121&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/activemq/blob/ad39fc00fbd9556deac2b7ed3646dae598c00125/activemq-unit-tests/src/test/java/org/apache/activemq/broker/jmx/MBeanTest.java#L121&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14521370" author="northlander" created="Thu, 30 Apr 2015 11:52:40 +0000"  >&lt;p&gt;Gave apache-activemq-5.12-20150429.222352-120 a test run. Simply downloaded the snapshot build and run &quot;bin/activemq console&quot;, so no special config.&lt;/p&gt;

&lt;p&gt;It seems that &quot;copy&quot; works as intended (did not in 5.11). However, move does not (console output below). The message get removed. I tried with both web console and JMX moveMessageTo(messageId,destinationName) - same result. So this seems not to be an issue isolated in the web console.&lt;/p&gt;

&lt;p&gt;It only affects persistent messages. Non persistent message are possible to move. Can it be that the test case uses a simplified persistence model, since it uses the memory store?&lt;/p&gt;

&lt;p&gt;The behavior is verified on both Linux and Mac.&lt;/p&gt;

&lt;p&gt; INFO | FROM(ID:petters-mbp.got.vgregion.se-58859-1430393889647-3:1:1:1:1) copy to TO&lt;br/&gt;
 INFO | Moving message FROM(ID:petters-mbp.got.vgregion.se-58859-1430393889647-3:1:1:1:1) to TO&lt;br/&gt;
 WARN | org.apache.activemq.broker.region.cursors.QueueStorePrefetch@5a87a7f9:TO,batchResetNeeded=false,size=0,cacheEnabled=true,maxBatchSize:1,hasSpace:true,pendingCachedIds.size:1,lastSyncCachedId:null,lastSyncCachedId-seq:null,lastAsyncCachedId:null,lastAsyncCachedId-seq:null,store=permits:9999,sd=nextSeq:1,lastRet:MessageOrderCursor:&lt;span class=&quot;error&quot;&gt;&amp;#91;def:0, low:0, high:0&amp;#93;&lt;/span&gt;,pending:0 - cursor got duplicate send ID:petters-mbp.got.vgregion.se-58859-1430393889647-3:1:1:1:1 seq: org.apache.activemq.store.kahadb.KahaDBStore$StoreQueueTask$InnerFutureTask@24fade&lt;/p&gt;</comment>
                            <comment id="14521447" author="gtully" created="Thu, 30 Apr 2015 12:57:09 +0000"  >&lt;p&gt;interesting. I flipped the bit in the unit test to enable persistence and, it is still good.&lt;/p&gt;

&lt;p&gt;but from the output of the log messages above, I think this is expected to some extent.&lt;/p&gt;

&lt;p&gt;The copy takes a message and then the move takes the same message. So it is the same message id. It makes sense to suppress the second insert/send.&lt;br/&gt;
It is possible to disable the cursor audit - policyEntry enableAudit=false but it looks like it is doing its job in this instance.&lt;br/&gt;
It is broken that the move results in the message being deleted though. That is a bug I think.&lt;/p&gt;</comment>
                            <comment id="14521535" author="northlander" created="Thu, 30 Apr 2015 14:07:50 +0000"  >&lt;p&gt;I also run that test (master branch) with persistence turned on and it does not replicate the issue with move. I&apos;m not sure exactly what is the difference in the test setup and the standard activemq.xml configuration as it seems to be somewhat similar.&lt;/p&gt;

&lt;p&gt;And I agree that move method deleting the message seems like a bug (to my use case, it&apos;s rather nasty).&lt;/p&gt;</comment>
                            <comment id="14521648" author="gtully" created="Thu, 30 Apr 2015 15:23:44 +0000"  >&lt;p&gt;I pushed a test that shows the nasty behaviour&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; the fix is not obvious because it points to a short fall in how we deal with duplicate sends, the store may or may not track them and the cursor may or may not be able to so at the moment a send call will not fail on a duplicate send, it has to throw an exception b/c there is currently no return state from queue.send but it will take some thought to figure out where best to deal with this.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/activemq/commit/82200b6e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/activemq/commit/82200b6e&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15339232" author="isral1" created="Mon, 20 Jun 2016 09:29:02 +0000"  >&lt;p&gt;I have tested with 5.13.3 on Windows and I could not reproduce it. I think it is solved&lt;/p&gt;</comment>
                            <comment id="17505816" author="christopher.l.shannon" created="Sun, 13 Mar 2022 14:16:10 +0000"  >&lt;p&gt;closing issues not updated in more than 5 years as abandoned&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 35 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2e2sn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>