<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:51:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-8971] ActiveMQ OSGI feature, activemq-client, using JMS 2.0 bundle, which fails resolution, from 5.16.3 on</title>
                <link>https://issues.apache.org/jira/browse/AMQ-8971</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Building an ActiveMQ client application in OSGI.&#160; Using AMQ versions 5.16.3 through 5.17.1.&lt;/p&gt;

&lt;p&gt;After building the application and loading it together with the ActiveMQ feature named &lt;tt&gt;activemq-client&lt;/tt&gt;, a resolution error occurs with the following details:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
osgi.wiring.&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;; filter:=&lt;span class=&quot;code-quote&quot;&gt;&quot;(&amp;amp;(osgi.wiring.&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;=javax.jms)(version&amp;gt;=1.1.0)(!(version&amp;gt;=2.0.0)))&quot;&lt;/span&gt; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Tracking this down, the &lt;tt&gt;activemq-client&lt;/tt&gt; feature definition contains the following:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;bundle dependency=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;&amp;gt;mvn:org.apache.geronimo.specs/geronimo-jms_2.0_spec/1.0-alpha-2&amp;lt;/bundle&amp;gt; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Using the karaf console command, package:exports | grep javax.jms, after loading the activemq-client feature, shows that this bundle ONLY exports the 2.0.0 version:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
javax.jms &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&#9474; 2.0.0 &#160; &#160; &#160; &#9474; 73 &#9474; org.apache.geronimo.specs.geronimo-jms_2.0_spec &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The same feature in 5.16.2 contains the following definition:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;bundle dependency=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;&amp;gt;mvn:org.apache.geronimo.specs/geronimo-jms_1.1_spec/1.1.1&amp;lt;/bundle&amp;gt; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;All of the ACTIVEMQ modules, except for activemq-karaf are using the following dependency:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &#160; &amp;lt;dependency&amp;gt;
&#160; &#160; &#160; &amp;lt;groupId&amp;gt;org.apache.geronimo.specs&amp;lt;/groupId&amp;gt;
&#160; &#160; &#160; &amp;lt;artifactId&amp;gt;geronimo-jms_1.1_spec&amp;lt;/artifactId&amp;gt;
&#160; &#160; &amp;lt;/dependency&amp;gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;....&lt;/p&gt;

&lt;p&gt;In Summary, compiling an ActiveMQ client application using activemq-client from versions 5.16.3 through 5.17.1, the application fails to resovle in Karaf by loading the activemq-client feature.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;STEPS TO REPRODUCE&lt;/b&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;feature:repo-add mvn:org.apache.activemq/activemq-karaf/5.17.1/xml/features-core&lt;/li&gt;
	&lt;li&gt;feature:install activemq-client&lt;/li&gt;
	&lt;li&gt;bundle:install ...application-bundle...&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;b&gt;EXPECTED RESULTS&lt;/b&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Successful load of the application bundle built against version 5.17.1 of ActiveMQ artifacts after loading the activemq-client feature&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;b&gt;ROOT CAUSE&lt;/b&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Replacing the JMS 1.0 geronimo specification bundle with the 2.0 one in the activemq-client feature causes this problem.&#160; It also seems very odd since no other internals of ActiveMQ use the JMS 2.0 spec at all.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13451382">AMQ-8971</key>
            <summary>ActiveMQ OSGI feature, activemq-client, using JMS 2.0 bundle, which fails resolution, from 5.16.3 on</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbonofre">Jean-Baptiste Onofr&#233;</assignee>
                                    <reporter username="artnaseef">Arthur Naseef</reporter>
                        <labels>
                    </labels>
                <created>Mon, 20 Jun 2022 17:32:54 +0000</created>
                <updated>Thu, 28 Jul 2022 04:51:22 +0000</updated>
                            <resolved>Thu, 28 Jul 2022 04:51:22 +0000</resolved>
                                                    <fixVersion>5.18.0</fixVersion>
                    <fixVersion>5.17.2</fixVersion>
                                    <component>OSGi/Karaf</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="2400">40m</timespent>
                                <comments>
                            <comment id="17556482" author="artnaseef" created="Mon, 20 Jun 2022 17:36:46 +0000"  >&lt;p&gt;I propose the&#160;&lt;b&gt;correct&lt;/b&gt; fix for this is to revert the feature to use the JMS 1.1 spec, since that&apos;s was ActiveMQ uses internally, and &quot;advertises&quot; to all the applications building against AMQ dependencies.&lt;/p&gt;

&lt;p&gt;Anyone that needs 2.0 can do the extra work to make it work.&#160; If we really feel strongly the need to assist, then perhaps one of the following is worth considering:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;A separate feature (e.g. activemq-client-jms2_spec) that uses the 2.0 spec instead of the 1.0, OR&lt;/li&gt;
	&lt;li&gt;A custom JMS spec bundle that resolves aginst both 1.1 and 2.0&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17556502" author="mattrpav" created="Mon, 20 Jun 2022 18:38:57 +0000"  >&lt;p&gt;#wontfix&lt;/p&gt;

&lt;p&gt;The reason to update to the JMS 2.0 jar is to allow other tools (Camel, etc) to wire up using a 2.0 spec, even though both sides only use the JMS 1.1 methods.&lt;/p&gt;

&lt;p&gt;JMS 2.0 implementation is also underway.&lt;/p&gt;

&lt;p&gt;Suggested fix: change your app to allow writing to JMS 2.0, or implement your own custom feature to pull in JMS 1.1 spec jar&lt;/p&gt;
</comment>
                            <comment id="17556503" author="artnaseef" created="Mon, 20 Jun 2022 18:42:15 +0000"  >&lt;p&gt;100% disagree with this response.&lt;/p&gt;

&lt;p&gt;Breaking the common case for an edge case is not right.&lt;/p&gt;

&lt;p&gt;Saying 2.0 impl is underway is just a distraction from the current state of affairs.&lt;/p&gt;</comment>
                            <comment id="17556504" author="artnaseef" created="Mon, 20 Jun 2022 18:42:44 +0000"  >&lt;p&gt;Please do not take unilateral action on this ticket Matt&lt;/p&gt;</comment>
                            <comment id="17556895" author="jbonofre" created="Tue, 21 Jun 2022 13:09:51 +0000"  >&lt;p&gt;See my messages on the mailing list.&lt;/p&gt;</comment>
                            <comment id="17570361" author="artnaseef" created="Sat, 23 Jul 2022 19:44:33 +0000"  >&lt;p&gt;PR created &lt;a href=&quot;https://github.com/apache/activemq/pull/861.&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/activemq/pull/861.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Created the PR instead of directly pushing to encourage discussion and additional testing of interested parties.&lt;/p&gt;</comment>
                            <comment id="17570975" author="jgenender" created="Mon, 25 Jul 2022 16:08:02 +0000"  >&lt;p&gt;This looks good to me &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=artnaseef&quot; class=&quot;user-hover&quot; rel=&quot;artnaseef&quot;&gt;artnaseef&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17572176" author="jira-bot" created="Thu, 28 Jul 2022 00:20:38 +0000"  >&lt;p&gt;Commit 2b50b3ff1b4fb145d6dd782def3948c57e6ed4d3 in activemq&apos;s branch refs/heads/main from Arthur Naseef&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=2b50b3ff1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=2b50b3ff1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-8971&quot; title=&quot;ActiveMQ OSGI feature, activemq-client, using JMS 2.0 bundle, which fails resolution, from 5.16.3 on&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-8971&quot;&gt;&lt;del&gt;AMQ-8971&lt;/del&gt;&lt;/a&gt; activemq-client karaf feature supporting both JMS 1.1 and JMS 2.0&lt;/p&gt;</comment>
                            <comment id="17572178" author="jira-bot" created="Thu, 28 Jul 2022 00:27:36 +0000"  >&lt;p&gt;Commit d98939efae0f26741b4cad860fef303d16bdb4d1 in activemq&apos;s branch refs/heads/activemq-5.17.x from Arthur Naseef&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=d98939efa&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=d98939efa&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-8971&quot; title=&quot;ActiveMQ OSGI feature, activemq-client, using JMS 2.0 bundle, which fails resolution, from 5.16.3 on&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-8971&quot;&gt;&lt;del&gt;AMQ-8971&lt;/del&gt;&lt;/a&gt; activemq-client karaf feature supporting both JMS 1.1 and JMS 2.0&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 2b50b3ff1b4fb145d6dd782def3948c57e6ed4d3)&lt;/p&gt;</comment>
                            <comment id="17572179" author="artnaseef" created="Thu, 28 Jul 2022 00:29:50 +0000"  >&lt;p&gt;Feature file updated so the bundles will work for both JMS spec versions 1.1 and 2.0.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 15 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z13fso:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>