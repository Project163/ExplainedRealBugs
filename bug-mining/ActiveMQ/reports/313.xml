<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:35:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-1629] wildcards don&apos;t work in networkconnector excludeDestinations </title>
                <link>https://issues.apache.org/jira/browse/AMQ-1629</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Version: 5.0 &lt;/p&gt;

&lt;p&gt;We have a simple setup to test excludedDestinations config ...We are using the broker and  example producer &amp;amp; consumer from the binary distribution (broker instances A &amp;amp; B are on different hosts &lt;/p&gt;

&lt;p&gt;Setup: &lt;/p&gt;

&lt;p&gt;producer &amp;#8212; A ---- B--- consumer &lt;/p&gt;

&lt;p&gt;Broker A&apos;s activemq.xml has the following for NC config (everythingelse is the same as in the orig config file):&lt;/p&gt;

&lt;p&gt;    &amp;lt;networkConnectors&amp;gt; &lt;br/&gt;
      &amp;lt;networkConnector name=&quot;toB&quot; uri=&quot;static://(tcp://B.foo.com:61616)&quot;&amp;gt; &lt;br/&gt;
           &amp;lt;excludedDestinations&amp;gt; &lt;br/&gt;
                &amp;lt;queue physicalName=&quot;TEST.&amp;gt;&quot; /&amp;gt; &lt;br/&gt;
           &amp;lt;/excludedDestinations&amp;gt; &lt;br/&gt;
     &amp;lt;/networkConnector&amp;gt; &lt;br/&gt;
    &amp;lt;/networkConnectors&amp;gt; &lt;/p&gt;

&lt;p&gt;Issue: consumer attached to Broker B sees all the messages sent to TEST.FOO (the default messages generated by the producer)&lt;/p&gt;

&lt;p&gt;We noticed that none of the queue or topic wildcards work, only specific topic or queue names work in the exclusion. However, &lt;a href=&quot;http://activemq.apache.org/networks-of-brokers.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.apache.org/networks-of-brokers.html&lt;/a&gt; states &quot;N.B. You can use wildcards in inclusive , exclusive destination properties&quot;. Are we missing anything ? &lt;/p&gt;

&lt;p&gt;Thanks &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Sridhar&lt;/li&gt;
&lt;/ul&gt;

</description>
                <environment>&lt;p&gt;linux&lt;/p&gt;</environment>
        <key id="12482699">AMQ-1629</key>
            <summary>wildcards don&apos;t work in networkconnector excludeDestinations </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rajdavies">Robert Davies</assignee>
                                    <reporter username="komandur">Sridhar Komandur</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 Mar 2008 14:57:29 +0000</created>
                <updated>Sat, 23 May 2009 07:50:01 +0000</updated>
                            <resolved>Sat, 23 May 2009 07:50:01 +0000</resolved>
                                    <version>4.1.1</version>
                    <version>5.0.0</version>
                                    <fixVersion>5.3.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12939412" author="komandur" created="Thu, 20 Mar 2008 22:51:02 +0000"  >&lt;p&gt;I did a little investigation and the problem appears to be here:&lt;/p&gt;

&lt;p&gt;DemandForwardingBridgeSupport.java:&lt;br/&gt;
    protected boolean isPermissableDestination(ActiveMQDestination destination) {&lt;br/&gt;
        // Are we not bridging temp destinations?&lt;br/&gt;
        if (destination.isTemporary() &amp;amp;&amp;amp; !configuration.isBridgeTempDestinations()) &lt;/p&gt;
{
            return false;
        }

&lt;p&gt;       A****  DestinationFilter filter = DestinationFilter.parseFilter(destination);&lt;br/&gt;
        ActiveMQDestination[] dests = excludedDestinations;&lt;br/&gt;
        if (dests != null &amp;amp;&amp;amp; dests.length &amp;gt; 0) {&lt;br/&gt;
            for (int i = 0; i &amp;lt; dests.length; i++) {&lt;br/&gt;
                ActiveMQDestination match = dests&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt;;&lt;br/&gt;
                if (match != null &amp;amp;&amp;amp; filter.matches(match)) &lt;/p&gt;
{
                    return false;
                }
&lt;p&gt;            }&lt;br/&gt;
      }&lt;/p&gt;

&lt;p&gt;The DestinationFilter returned (A above) is SimpleDestinationFilter because the destination (TEST.FOO) is &quot;simple&quot; ==&amp;gt; filter.matches tries to string comparison eventually( TEST.FOO with TEST.&amp;gt;) and does not match it.&lt;/p&gt;

&lt;p&gt; I am not very familiar with the code, but shouldn&apos;t  the DestinationFilter reflect wildcard/prefix in either excludedDestination or the queue/topic destination ? &lt;br/&gt;
Thanks&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Sridhar&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="12939419" author="komandur" created="Thu, 27 Mar 2008 20:38:24 +0000"  >&lt;p&gt;I am attaching a  patch that works with  prefixes in the excluded &amp;amp; included destinations. Please review.&lt;/p&gt;</comment>
                            <comment id="12939451" author="rajdavies" created="Wed, 9 Apr 2008 11:08:54 +0000"  >&lt;p&gt;Patch applied in svn revision 646268&lt;/p&gt;</comment>
                            <comment id="12940330" author="joef" created="Tue, 14 Oct 2008 12:26:34 +0000"  >&lt;p&gt;If you have something like this, all messages get excluded; no matter their destination&apos;s name.&lt;/p&gt;

&lt;p&gt;&amp;lt;excludedDestinations&amp;gt;       &lt;br/&gt;
    &amp;lt;queue physicalName=&quot;fubar.&amp;gt;&quot;/&amp;gt;     &lt;br/&gt;
    &amp;lt;topic physicalName=&quot;fubar.&amp;gt;&quot;/&amp;gt;         &lt;br/&gt;
&amp;lt;/excludedDestinations&amp;gt;     &lt;/p&gt;

&lt;p&gt;However, if you change it slightly like this (just took out the &apos;r&apos; in one of them), then things seem to work.&lt;/p&gt;

&lt;p&gt;&amp;lt;excludedDestinations&amp;gt;       &lt;br/&gt;
     &amp;lt;queue physicalName=&quot;fubar.&amp;gt;&quot;/&amp;gt;     &lt;br/&gt;
      &amp;lt;topic physicalName=&quot;fuba.&amp;gt;&quot;/&amp;gt;         &lt;br/&gt;
&amp;lt;/excludedDestinations&amp;gt;     &lt;/p&gt;

&lt;p&gt;If there are no dots things seem to also work.&lt;/p&gt;

&lt;p&gt;Bottom line is that this needs more attention and more thorough testing. &lt;/p&gt;</comment>
                            <comment id="12940749" author="moczarski" created="Sun, 8 Feb 2009 14:52:33 +0000"  >&lt;p&gt;I see two problems with the current implementation (version 5.2)  for excluded- and dynamically-included destinations:&lt;/p&gt;

&lt;p&gt;1. The type of the destination (queue, topic) is not distincted:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;excludedDestinations&amp;gt;&lt;/span&gt; &#8232;
   &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;topic physicalName=&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;gt;&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt; &#8232;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/excludedDestinations&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Only topics should be excluded but all queues are also excluded.&lt;/p&gt;

&lt;p&gt;2. An entry with a wildcard in the list has a side-effect on the following entries:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;excludedDestinations&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;queue physicalName=&lt;span class=&quot;code-quote&quot;&gt;&quot;exclude&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/excludedDestinations&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dynamicallyIncludedDestinations&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;queue physicalName=&lt;span class=&quot;code-quote&quot;&gt;&quot;foo.&amp;gt;&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt;
   &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;queue physicalName=&lt;span class=&quot;code-quote&quot;&gt;&quot;bar.x&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dynamicallyIncludedDestinations&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 
&lt;p&gt;A message to &lt;tt&gt;bar.x&lt;/tt&gt; will be blocked because of the wildcard in the first entry.&lt;/p&gt;

&lt;p&gt;I&apos;ve created a test case and a new patch. I would be happy for a review of test case and patch.&lt;/p&gt;</comment>
                            <comment id="12941364" author="rajdavies" created="Sat, 23 May 2009 07:50:01 +0000"  >&lt;p&gt;Fixed by SVN revision 777821&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12461283" name="DemandForwardingBridgeFilterTest.java" size="7762" author="moczarski" created="Sun, 8 Feb 2009 14:52:33 +0000"/>
                            <attachment id="12461350" name="DemandForwardingBridgeSupport.java.patch" size="2837" author="moczarski" created="Sun, 8 Feb 2009 14:52:33 +0000"/>
                            <attachment id="12460926" name="amq1629.txt" size="1604" author="komandur" created="Thu, 27 Mar 2008 20:39:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>84515</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 27 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0s24f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161820</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310080" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Regression</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10091"><![CDATA[Regression]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>