<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:35:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-6361] Message can remain inflight after consumer side expiration acknowledgements</title>
                <link>https://issues.apache.org/jira/browse/AMQ-6361</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;If the client clock is slightly ahead of the brokers clock a message could be expired on the client but not considered expired on the broker.&lt;/p&gt;

&lt;p&gt;When the expiry ACK is sent to the broker it checks if the message is also considered expired on the broker side. If the broker clock is behind the client side clock the message could be considered not expired on the broker and not&lt;br/&gt;
removed from the broker&apos;s dispatched list. This leaves the broker reporting a message inflight from the broker&apos;s perspective even though the message has been expired on the consumer(client) side&lt;/p&gt;

&lt;p&gt;The broker should treat the expired ACK as the authority on whether a message is expired and process it as such regardless of the broker side clock.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12989901">AMQ-6361</key>
            <summary>Message can remain inflight after consumer side expiration acknowledgements</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gtully">Gary Tully</assignee>
                                    <reporter username="tabish">Timothy A. Bish</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 Jul 2016 18:50:46 +0000</created>
                <updated>Tue, 26 Jul 2016 12:46:00 +0000</updated>
                            <resolved>Fri, 22 Jul 2016 14:19:30 +0000</resolved>
                                    <version>5.13.3</version>
                                    <fixVersion>5.14.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15379938" author="jira-bot" created="Fri, 15 Jul 2016 19:08:55 +0000"  >&lt;p&gt;Commit cd5ea6c27fa92a57dc68cd9632572a77b36c446c in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tabish121&quot; class=&quot;user-hover&quot; rel=&quot;tabish121&quot;&gt;tabish121&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=cd5ea6c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=cd5ea6c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6361&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-6361&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Honor the expired ack from the client as the authority on expiration&lt;/p&gt;</comment>
                            <comment id="15387618" author="gtully" created="Thu, 21 Jul 2016 12:45:54 +0000"  >&lt;p&gt;There is a regression in org.apache.activemq.usecases.ExpiredMessagesTest&lt;br/&gt;
the problem is that the stats are off b/c the message can get processed twice for expiry. The stats reports too many expired and the dlq rejects the duplicates so the stat and dlq queue size don&apos;t match for the assertion.&lt;br/&gt;
expiry is one process that has shared access to the message.&lt;/p&gt;

&lt;p&gt;peeking at adding method to messageReference to encapsulate the right to process an expired message, such that it is done once.&lt;/p&gt;</comment>
                            <comment id="15389581" author="jira-bot" created="Fri, 22 Jul 2016 14:18:59 +0000"  >&lt;p&gt;Commit 6cc2c1190da15579a9a886bad03596e14a77a677 in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=6cc2c11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=6cc2c11&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6361&quot; title=&quot;Message can remain inflight after consumer side expiration acknowledgements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6361&quot;&gt;&lt;del&gt;AMQ-6361&lt;/del&gt;&lt;/a&gt; - fix contention over expiry processing with expiry task and client expiry ack, unit test regression sorted.&lt;/p&gt;</comment>
                            <comment id="15393738" author="jira-bot" created="Tue, 26 Jul 2016 12:46:00 +0000"  >&lt;p&gt;Commit 01cfa7727dfb6e680e3a94789fd0798c36dbc87c in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=01cfa77&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=01cfa77&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6361&quot; title=&quot;Message can remain inflight after consumer side expiration acknowledgements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6361&quot;&gt;&lt;del&gt;AMQ-6361&lt;/del&gt;&lt;/a&gt; - fix additional test regression on topic sub expiry AMQ4083Test,MessageEvictionTest&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 17 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i311w7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>