<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:43:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-2306] Unable to monitor or manage slave brokers in shared filesystem master slave configuration</title>
                <link>https://issues.apache.org/jira/browse/AMQ-2306</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;It appears that when running in shared master slave configuration one cant connect to the jmx console or use activemq-admin to stop the slave.&lt;/p&gt;

&lt;p&gt;Start a slave with a master running&lt;/p&gt;

&lt;p&gt;ACTIVEMQ_HOME: /itdept/apache-activemq-5.2.0&lt;br/&gt;
ACTIVEMQ_BASE: /itdept/apache-activemq-5.2.0&lt;br/&gt;
Loading message broker from: xbean://itdept//messagebroker/activemq-config/broker3.xml&lt;br/&gt;
INFO  BrokerService                  - Using Persistence Adapter: AMQPersistenceAdapter(/datafiles/itdept//activemq-journal)&lt;br/&gt;
WARN  AMQPersistenceAdapter          - Waiting to Lock the Store /datafiles/itdept/activemq-journal&lt;/p&gt;

&lt;p&gt;Notice that no connections including jmx have been started...attempts to stop the broker with activemq-admin fail with..Caused by: java.net.ConnectException: Connection refused&lt;/p&gt;

&lt;p&gt;Kill the master and get&lt;/p&gt;

&lt;p&gt;INFO  AMQPersistenceAdapter          - Aquired lock for AMQ Store/datafiles/itdept/activemq-journal&lt;br/&gt;
INFO  BrokerService                  - ActiveMQ 5.2.0 JMS Message Broker (messagebroker3) is starting&lt;br/&gt;
INFO  BrokerService                  - For help or more information please see: &lt;a href=&quot;http://activemq.apache.org/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.apache.org/&lt;/a&gt;&lt;br/&gt;
INFO  KahaStore                      - Kaha Store using data directory /datafiles/itdept/activemq-journal/kr-store/data&lt;br/&gt;
INFO  ManagementContext              - JMX consoles can connect to service:jmx:rmi:///jndi/rmi://localhost:55563/jmxrmi&lt;br/&gt;
INFO  TransportServerThreadSupport   - Listening for connections at: tcp://0.0.0.0:55553&lt;br/&gt;
INFO  TransportConnector             - Connector tcp Started&lt;br/&gt;
INFO  BrokerService                  - ActiveMQ JMS Message Broker (messagebroker3, ID:nymb02d-59998-1245957027403-0:0) started&lt;br/&gt;
INFO  log                            - Logging to org.slf4j.impl.JCLLoggerAdapter(org.mortbay.log) via org.mortbay.log.Slf4jLog&lt;br/&gt;
INFO  log                            - jetty-6.1.9&lt;br/&gt;
INFO  log                            - WebApp@1288520654 at &lt;a href=&quot;http://0.0.0.0:55573/admin&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://0.0.0.0:55573/admin&lt;/a&gt;&lt;br/&gt;
INFO  log                            - Started SelectChannelConnector@0.0.0.0:55573&lt;/p&gt;

&lt;p&gt;Now you can connect via JMX and concole....&lt;/p&gt;

&lt;p&gt;brokers are very simply configured...&lt;/p&gt;

&lt;p&gt;broker3 &lt;/p&gt;

&lt;p&gt;&amp;lt;broker:broker useJmx=&quot;true&quot; persistent=&quot;true&quot; brokerName=&quot;messagebroker3&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;broker:managementContext&amp;gt;&lt;br/&gt;
            &amp;lt;broker:managementContext connectorPort=&quot;55563&quot; jmxDomainName=&quot;messagebroker3&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;/broker:managementContext&amp;gt;&lt;br/&gt;
        &amp;lt;broker:persistenceAdapter&amp;gt;&lt;br/&gt;
            &amp;lt;broker:amqPersistenceAdapter directory=&quot;/datafiles/itdept/activemq-journal&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;/broker:persistenceAdapter&amp;gt;&lt;br/&gt;
        &amp;lt;broker:transportConnectors&amp;gt;&lt;br/&gt;
            &amp;lt;broker:transportConnector name=&quot;tcp&quot; uri=&quot;tcp://0.0.0.0:55553&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;/broker:transportConnectors&amp;gt;&lt;br/&gt;
    &amp;lt;/broker:broker&amp;gt;&lt;/p&gt;

&lt;p&gt;broker 4 &lt;/p&gt;

&lt;p&gt; &amp;lt;broker:broker useJmx=&quot;true&quot; persistent=&quot;true&quot; brokerName=&quot;messagebroker4&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;broker:managementContext&amp;gt;&lt;br/&gt;
            &amp;lt;broker:managementContext connectorPort=&quot;55564&quot; jmxDomainName=&quot;messagebroker4&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;/broker:managementContext&amp;gt;&lt;br/&gt;
        &amp;lt;broker:persistenceAdapter&amp;gt;&lt;br/&gt;
            &amp;lt;broker:amqPersistenceAdapter directory=&quot;/datafiles/itdept/activemq-journal&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;/broker:persistenceAdapter&amp;gt;&lt;br/&gt;
        &amp;lt;broker:transportConnectors&amp;gt;&lt;br/&gt;
            &amp;lt;broker:transportConnector name=&quot;tcp&quot; uri=&quot;tcp://0.0.0.0:55554&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;/broker:transportConnectors&amp;gt;&lt;br/&gt;
    &amp;lt;/broker:broker&amp;gt;&lt;/p&gt;


</description>
                <environment></environment>
        <key id="12483112">AMQ-2306</key>
            <summary>Unable to monitor or manage slave brokers in shared filesystem master slave configuration</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dejanb">Dejan Bosanac</assignee>
                                    <reporter username="scott.clasen">Scott Clasen</reporter>
                        <labels>
                    </labels>
                <created>Thu, 25 Jun 2009 19:09:07 +0000</created>
                <updated>Sat, 8 Sep 2012 18:15:37 +0000</updated>
                            <resolved>Fri, 6 Nov 2009 14:19:34 +0000</resolved>
                                    <version>5.2.0</version>
                                    <fixVersion>5.3.1</fixVersion>
                    <fixVersion>5.4.0</fixVersion>
                                    <component>Broker</component>
                    <component>JMX</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="12941362" author="dejanb" created="Fri, 6 Nov 2009 14:19:34 +0000"  >&lt;p&gt;The broker starting sequence now first starts a jmx connector and then tries to boot the broker (including the persistence adapter). This will allow that the slave broker (with the port different than master) in shared file-system ms scenario will be reachable by jmx. However, since broker isn&apos;t started properly, there&apos;s no much point to do anything with it in this mode, except to stop it. This works fine with activemq-admin script and using &quot;terminateVm()&quot; jmx command (used by activemq-admin). I noticed that &quot;stop()&quot; jmx command doesn&apos;t fully work, since there are some threads left from persistence adapters trying to aquire locks, but that&apos;s the topic for some other issue. When master dies, the slave jmx connector becomes fully operable.&lt;/p&gt;

&lt;p&gt;In case that master and slave have the same jmx port defined (which is often the case), the slave will detect that jmx connector is not started before acquiring the lock and will try to do it again afterwards. So users that deploy with this configuration will not be affected with this change.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12606728">AMQ-4032</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>74990</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 3 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0rqvj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>159998</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>