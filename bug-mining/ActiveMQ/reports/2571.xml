<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:10:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-5705] originBrokerURL incorrectly set in advisory messages</title>
                <link>https://issues.apache.org/jira/browse/AMQ-5705</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;With a broker configured with multiple transports, the &quot;originBrokerURL&quot; property of advisory messages is incorrectly set. &lt;/p&gt;

&lt;p&gt;Assuming a broker that has two transports configured, an advisory message for a connection made to transport-A may have the &quot;originBrokerURL&quot; property set to transport-B.&lt;/p&gt;

&lt;p&gt;Looks like the &quot;originBrokerURL&quot; value is set from the getDefaultSocketURIString() method in the BrokerService class. Is there a good reason why the &quot;originBrokerURL&quot; value does not correlate with the transport where the advisory event is actually being triggered?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12787455">AMQ-5705</key>
            <summary>originBrokerURL incorrectly set in advisory messages</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gtully">Gary Tully</assignee>
                                    <reporter username="vhle01">Vu Le</reporter>
                        <labels>
                    </labels>
                <created>Wed, 1 Apr 2015 20:08:12 +0000</created>
                <updated>Tue, 23 Jun 2015 11:08:55 +0000</updated>
                            <resolved>Tue, 23 Jun 2015 11:08:55 +0000</resolved>
                                    <version>5.11.1</version>
                                    <fixVersion>5.12.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14392549" author="xabhi" created="Thu, 2 Apr 2015 10:45:00 +0000"  >&lt;p&gt;What kind of issues can be triggered by this?&lt;/p&gt;</comment>
                            <comment id="14392775" author="vhle01" created="Thu, 2 Apr 2015 14:50:23 +0000"  >&lt;p&gt;No specific issue...just noticed as I ran through some testing. That&apos;s why I was asking if there was a good reason why they values do not correlate? To me, it would make sense if they matched up.&lt;/p&gt;</comment>
                            <comment id="14392966" author="vhle01" created="Thu, 2 Apr 2015 17:12:13 +0000"  >&lt;p&gt;Actually, this is an issue for us. We are capturing metrics from the advisory messages and this is causing our metrics to be off.&lt;/p&gt;</comment>
                            <comment id="14589934" author="christopher.l.shannon" created="Wed, 17 Jun 2015 15:38:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tabish121&quot; class=&quot;user-hover&quot; rel=&quot;tabish121&quot;&gt;tabish121&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;I noticed this issue the other day and it&apos;s a bit odd to me that advisory messages relating to user actions (such as new connection or consumer, etc)  set the &lt;tt&gt;originBrokerURL&lt;/tt&gt; property with a default URL and not the actual transport URL that was used.  For example, I ran a test and set up a broker with two transports, one nio and one tcp.  I connected using nio but the algorithm picked the tcp transport url to set as the originBrokerURL property when the new connection advisory message was fired.  It would make more sense to me to set the originBrokerUrl property as the nio URL since that was the URL used.  &lt;/p&gt;

&lt;p&gt;This would be a pretty easy change as the ConnectionContext has a reference to the Connector used and we could get the publishable connection string from that if the connector has been set. For advisory messages that don&apos;t contain the connector (such as internal things like message expiration) a default URL can still be chosen in the same manor as it is now.&lt;/p&gt;

&lt;p&gt;Do you have any issue with changing this behavior? The other option is to keep the originBrokerURL behavior as is and add a new property to contain the actual transport url used by the client to connect.  That would prevent issues for existing users which might be relying on the current behavior of how the originBrokerURL property is set. &lt;/p&gt;</comment>
                            <comment id="14589941" author="tabish121" created="Wed, 17 Jun 2015 15:42:45 +0000"  >&lt;p&gt;Wouldn&apos;t bother me, I just haven&apos;t had time to look at this one other than to see it and agree that it makes sense that the value should probably match the connector.&lt;/p&gt;</comment>
                            <comment id="14589956" author="christopher.l.shannon" created="Wed, 17 Jun 2015 15:54:29 +0000"  >&lt;p&gt;Alright, thanks for the input. I&apos;ll push up a PR later today with this change.&lt;/p&gt;</comment>
                            <comment id="14590167" author="githubbot" created="Wed, 17 Jun 2015 17:49:23 +0000"  >&lt;p&gt;GitHub user cshannon opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/activemq/pull/117&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/activemq/pull/117&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-5705&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-5705&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Modifing the AdivsoryBroker to set the originBrokerURL to the transport connector&apos;s&lt;br/&gt;
    URL if it has been set versus using a default URL.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/cshannon/activemq&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/cshannon/activemq&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-5705&quot; title=&quot;originBrokerURL incorrectly set in advisory messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-5705&quot;&gt;&lt;del&gt;AMQ-5705&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/activemq/pull/117.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/activemq/pull/117.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #117&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit fc3e0261229bb90edbcf4eaeabc5ee2e1b57894d&lt;br/&gt;
Author: Christopher L. Shannon (cshannon) &amp;lt;christopher.l.shannon@gmail.com&amp;gt;&lt;br/&gt;
Date:   2015-06-17T17:47:24Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-5705&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-5705&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Modifing the AdivsoryBroker to set the originBrokerURL to the transport connector&apos;s&lt;br/&gt;
    URL if it has been set versus using a default URL.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14590620" author="githubbot" created="Wed, 17 Jun 2015 21:16:46 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/activemq/pull/117&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/activemq/pull/117&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14590621" author="tabish121" created="Wed, 17 Jun 2015 21:17:27 +0000"  >&lt;p&gt;Patch looks good, applied with thanks!&lt;/p&gt;</comment>
                            <comment id="14596053" author="gtully" created="Mon, 22 Jun 2015 15:09:36 +0000"  >&lt;p&gt;this patch breaks org.apache.activemq.network.FailoverStaticNetworkTest&lt;/p&gt;

&lt;p&gt;the PublishedAddressPolicy is now applying to the vm connector and the usage of broker name with A_B (an underscore it) fails to be converted into a valid url, blowing up with an exception. Our vm urls very loose, I think PublishedAddressPolicy needs to be a little more aware of the vm scheme. Working on a fix.&lt;/p&gt;</comment>
                            <comment id="14597482" author="gtully" created="Tue, 23 Jun 2015 11:08:55 +0000"  >&lt;p&gt;fix for test regression in &lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/activemq/commit/37c46b9b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/activemq/commit/37c46b9b&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;transforming vm urls does not make any sense because they container the brokerName&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 22 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i27nv3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310080" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Regression</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10092"><![CDATA[Unit Test Broken]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>