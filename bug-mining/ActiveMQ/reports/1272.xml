<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:51:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-3375] stomp consumer might not receive all msgs of a virtual topic queue with memory limits</title>
                <link>https://issues.apache.org/jira/browse/AMQ-3375</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Have a testcase that connects a Java stomp consumer to a virtual destination queue and consumes a fixed amount of msgs.&lt;br/&gt;
During the test I noticed that the consumer does not always receive the full amount of msgs.&lt;br/&gt;
Instead the receive times out although JMX QueueSize property is greater than 0. However when trying to browse the queue using JMX, it returns null, despite the fact that not all msgs got dequeued yet (dispatch and dequeue counter &amp;lt; enqueue counter).&lt;/p&gt;

&lt;p&gt;So far I reproduced this with a stomp producer/consumer only. The producer writes msgs to a virtual topic VirtualTopic.Foo and the consumer takes msgs off the Consumer.A.VirtualTopic.Foo queue. Using JMX I noticed all msgs got moved from the virtual topic to the queue (reflected by JMX enqueue counter) but not all msgs got consumed.&lt;/p&gt;

&lt;p&gt;So it seems the broker lost some msgs on the way. &lt;/p&gt;</description>
                <environment>&lt;p&gt;stomp consumer on virtual destination &lt;br/&gt;
Tested on Ubuntu 10.10 and MacOSX using java 6.&lt;/p&gt;</environment>
        <key id="12511337">AMQ-3375</key>
            <summary>stomp consumer might not receive all msgs of a virtual topic queue with memory limits</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gtully">Gary Tully</assignee>
                                    <reporter username="tmielke">Torsten Mielke</reporter>
                        <labels>
                            <label>stomp</label>
                            <label>virtualTopic</label>
                    </labels>
                <created>Thu, 23 Jun 2011 10:07:45 +0000</created>
                <updated>Tue, 20 Sep 2011 10:41:58 +0000</updated>
                            <resolved>Wed, 3 Aug 2011 12:23:14 +0000</resolved>
                                    <version>5.5.0</version>
                                    <fixVersion>5.6.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13053775" author="tmielke" created="Thu, 23 Jun 2011 10:08:18 +0000"  >&lt;p&gt;Attaching a test case in JUnit format. It may take a number of test runs before this test case fails (10 &amp;lt; x &amp;lt; 20).&lt;br/&gt;
For a description of the test case, have a read over the class documentation in src/test/resources/org/apache/activemq/transport/stomp/StompVirtualTopicTest.java.&lt;/p&gt;

&lt;p&gt;The test case uses an embedded broker but I have the feeling the problem is easier reproduced using an external broker with the config src/test/resources/StompVirtualTopicTest.xml. It also makes it easier to attach jconsole.&lt;/p&gt;

&lt;p&gt;To run the test case simply call mvn test.&lt;/p&gt;</comment>
                            <comment id="13056829" author="tabish121" created="Tue, 28 Jun 2011 22:38:07 +0000"  >&lt;p&gt;I can get the test to fail using the provided unit test however the problem appears to be that the socket of the StompConnection is closed before the broker has had a chance to read all the messages from the socket buffer, if you add a sleep (6 seconds on my machine) before calling close the the test passes every time.&lt;/p&gt;</comment>
                            <comment id="13057380" author="tabish121" created="Wed, 29 Jun 2011 18:29:35 +0000"  >&lt;p&gt;A reliable way to make this test case always pass is to add the receipt request header to the final produced message and do a receive to await the response, this will ensure that all messages are read by the broker and placed on the queue.&lt;/p&gt;</comment>
                            <comment id="13078708" author="gtully" created="Wed, 3 Aug 2011 12:22:11 +0000"  >&lt;p&gt;The test works once contention issues with plist creation that underpin the file pending message cursor were sorted in &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-3434&quot; title=&quot;Contention in PLIist  creation results in NPE on load - FilePendingMessageCursor&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-3434&quot;&gt;&lt;del&gt;AMQ-3434&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13078709" author="gtully" created="Wed, 3 Aug 2011 12:23:14 +0000"  >&lt;p&gt;fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-3434&quot; title=&quot;Contention in PLIist  creation results in NPE on load - FilePendingMessageCursor&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-3434&quot;&gt;&lt;del&gt;AMQ-3434&lt;/del&gt;&lt;/a&gt; - test case committed in rev: &lt;a href=&quot;http://svn.apache.org/viewvc?rev=1153463&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1153463&amp;amp;view=rev&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12517771">AMQ-3434</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12483574" name="stomp-testcase.tgz" size="6075" author="tmielke" created="Thu, 23 Jun 2011 10:08:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>14545</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 16 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0aj9r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>59395</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>