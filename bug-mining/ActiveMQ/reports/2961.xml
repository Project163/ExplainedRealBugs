<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:38:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-6491] WebSocket tries to call default servlet, when default servlet not configured</title>
                <link>https://issues.apache.org/jira/browse/AMQ-6491</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;With WebSocket connectors defined e.g.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;transportConnectors&amp;gt;
    &amp;lt;transportConnector name=&quot;ws&quot;
                        uri=&quot;ws://0.0.0.0:61614?maximumConnections=1000&amp;amp;amp;wireFormat.maxFrameSize=104857600&quot;/&amp;gt;
    &amp;lt;transportConnector name=&quot;wss&quot;
                        uri=&quot;wss://0.0.0.0:61615?transport.wantClientAuth=true&amp;amp;amp;maximumConnections=1000&amp;amp;amp;wireFormat.maxFrameSize=104857600&quot;/&amp;gt;
&amp;lt;/transportConnectors&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A request to &lt;a href=&quot;https://127.0.0.1:61615/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://127.0.0.1:61615/&lt;/a&gt; gives HTTP 500 Internal Server Error with the following in the log:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; WARN | org.eclipse.jetty.servlet.ServletHandler | /
java.lang.NullPointerException
        at org.apache.activemq.transport.ws.jetty9.WSServlet.doGet(WSServlet.java:88)[activemq-http-5.14.1.jar:5.14.1]
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:622)[tomcat-servlet-api-8.0.24.jar:]
        at org.eclipse.jetty.websocket.servlet.WebSocketServlet.service(WebSocketServlet.java:167)[jetty-all-9.2.13.v20150730.jar:9.2.13.v20150730]
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:729)[tomcat-servlet-api-8.0.24.jar:]
        at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:808)[jetty-all-9.2.13.v20150730.jar:9.2.13.v20150730]
        at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:587)[jetty-all-9.2.13.v20150730.jar:9.2.13.v20150730]
        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)[jetty-all-9.2.13.v20150730.jar:9.2.13.v20150730]
        at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:577)[jetty-all-9.2.13.v20150730.jar:9.2.13.v20150730]
        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1129)[jetty-all-9.2.13.v20150730.jar:9.2.13.v20150730]
        at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)[jetty-all-9.2.13.v20150730.jar:9.2.13.v20150730]
        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1061)[jetty-all-9.2.13.v20150730.jar:9.2.13.v20150730]
        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)[jetty-all-9.2.13.v20150730.jar:9.2.13.v20150730]
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)[jetty-all-9.2.13.v20150730.jar:9.2.13.v20150730]
        at org.eclipse.jetty.server.Server.handle(Server.java:499)[jetty-all-9.2.13.v20150730.jar:9.2.13.v20150730]
        at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:310)[jetty-all-9.2.13.v20150730.jar:9.2.13.v20150730]
        at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)[jetty-all-9.2.13.v20150730.jar:9.2.13.v20150730]
        at org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:540)[jetty-all-9.2.13.v20150730.jar:9.2.13.v20150730]
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)[jetty-all-9.2.13.v20150730.jar:9.2.13.v20150730]
        at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)[jetty-all-9.2.13.v20150730.jar:9.2.13.v20150730]
        at java.lang.Thread.run(Thread.java:745)[:1.8.0_66-internal]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This occurs because no default servlet is defined. Either ActiveMQ should not attempt to forward GET requests to the default servlet, or the embedded Jetty instances should be configured with a proper default servlet.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13016886">AMQ-6491</key>
            <summary>WebSocket tries to call default servlet, when default servlet not configured</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cshannon">Christopher L. Shannon</assignee>
                                    <reporter username="neilgreatorex">Neil Greatorex</reporter>
                        <labels>
                            <label>websocket</label>
                    </labels>
                <created>Tue, 1 Nov 2016 12:57:04 +0000</created>
                <updated>Tue, 22 Nov 2016 12:29:24 +0000</updated>
                            <resolved>Tue, 22 Nov 2016 12:29:24 +0000</resolved>
                                    <version>5.14.1</version>
                                    <fixVersion>5.15.0</fixVersion>
                    <fixVersion>5.14.2</fixVersion>
                                    <component>Transport</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15664105" author="christopher.l.shannon" created="Mon, 14 Nov 2016 14:51:02 +0000"  >&lt;p&gt;Why are you trying to make a GET request to the WebSocket servlet?&lt;/p&gt;

&lt;p&gt;I&apos;m not really sure what the best behavior is here. On one hand we could either return nothing for a response to a GET request (or register the default servlet and forward to it).  Or we could just have the WebSocket servlet not implement GET at all and throw an error because there&apos;s not really a good reason to make a GET request to the WebSocket servlet that I can think of.&lt;/p&gt;

&lt;p&gt;My preference would probably be to just return an empty response if a GET request was made and no error.&lt;/p&gt;</comment>
                            <comment id="15667499" author="neilgreatorex" created="Tue, 15 Nov 2016 15:57:38 +0000"  >&lt;p&gt;What I am attempting to do is use client certificates in order to authenticate connections from the web browser (Chrome in this case) to ActiveMQ. I&apos;ve found that in order to get Chrome to pop up the box to allow the user to choose their client certificate, I need to first make a standard HTTPS request to the WSS endpoint. Once the user has chosen to present their certificate to this connection, the WebSocket connection will also present their certificate enabling the use of it for authentication. It could be argued that this is a &quot;feature&quot; in Chrome, but I equally think that passing the request on to the non-existent default servlet is not ideal.&lt;/p&gt;

&lt;p&gt;My first preference would be to make it possible to define (somehow) a default servlet for the WebSocket servlet to pass the request onto. Failing that, I would prefer receiving an empty response over not implementing GET at all.&lt;/p&gt;</comment>
                            <comment id="15673814" author="sp4rky" created="Thu, 17 Nov 2016 14:06:55 +0000"  >&lt;p&gt;Hi, just a comment as we also get this issue.&lt;/p&gt;

&lt;p&gt;We have a lot of websocket (wss) connections from various customers , mobile or desktop, over mobile network or not etc etc ... We have ~ 7k connections , with a lot of connections dropping and initializing all the time (basically this is connected to a website , so every time a user switches to a new page =&amp;gt; new connection). &lt;/p&gt;

&lt;p&gt;in the 20 minutes, I find not less than 350 NPE with the exact same stacktrace. If I check the &quot;qtpXXXXX&quot; id at the beginning of log line and grep for it, I usually find other lines like :&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;User Agent: &lt;span class=&quot;error&quot;&gt;&amp;#91;unset&amp;#93;&lt;/span&gt; requested WebSocket version &lt;span class=&quot;error&quot;&gt;&amp;#91;-1&amp;#93;&lt;/span&gt;, Jetty supports version: &lt;span class=&quot;error&quot;&gt;&amp;#91;13&amp;#93;&lt;/span&gt; | org.eclipse.jetty.websocket.server.WebSocketServerFactory&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;and the corresponding IP are likly to be behind some enterprise proxy that (I guess) doesn&apos;t support websocket. &lt;br/&gt;
Also, most of the qtpXXX id don&apos;t have any log with the source IP. It would be good to have the source IP when an exception is raised.&lt;/p&gt;</comment>
                            <comment id="15673849" author="christopher.l.shannon" created="Thu, 17 Nov 2016 14:22:03 +0000"  >&lt;p&gt;I think the simplest thing to do is just return an empty response (no exception).  I don&apos;t really see a benefit of redirecting to a default servlet in this case.&lt;/p&gt;</comment>
                            <comment id="15686617" author="jira-bot" created="Tue, 22 Nov 2016 12:28:38 +0000"  >&lt;p&gt;Commit f40532a23d70639a027fcf87893de8683edf430f in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cshannon&quot; class=&quot;user-hover&quot; rel=&quot;cshannon&quot;&gt;cshannon&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=f40532a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=f40532a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6491&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-6491&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Changing the WebSocket servlet to return a succesful empty response&lt;br/&gt;
instead of an error when a GET request is made&lt;/p&gt;</comment>
                            <comment id="15686620" author="jira-bot" created="Tue, 22 Nov 2016 12:29:01 +0000"  >&lt;p&gt;Commit a50979e308ab97123cfcf058e1acabb2c2c6b9d9 in activemq&apos;s branch refs/heads/activemq-5.14.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cshannon&quot; class=&quot;user-hover&quot; rel=&quot;cshannon&quot;&gt;cshannon&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=a50979e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=a50979e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6491&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-6491&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Changing the WebSocket servlet to return a succesful empty response&lt;br/&gt;
instead of an error when a GET request is made&lt;/p&gt;

&lt;p&gt;(cherry picked from commit f40532a23d70639a027fcf87893de8683edf430f)&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="13012891">AMQ-6469</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i35o5j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>