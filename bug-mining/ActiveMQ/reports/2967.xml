<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:39:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-6522] KahaDB - checkForCorruptJournalFiles has hard coded 32k batch size limit in error </title>
                <link>https://issues.apache.org/jira/browse/AMQ-6522</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Using setCheckForCorruptJournalFiles=true, there is a sanity check of the journal at startup - skipping through each of the journal files validating batch record checksums and magic in an effort to detect corruption early and drop the relevant messages or error out.&lt;br/&gt;
There is an error in the check logic that assumes a batch record must be &amp;lt; 32k which is not the case if a message is &amp;gt; 32k&lt;/p&gt;

&lt;p&gt;Tidy up this check and add some more detail to the error messages.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13024048">AMQ-6522</key>
            <summary>KahaDB - checkForCorruptJournalFiles has hard coded 32k batch size limit in error </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gtully">Gary Tully</assignee>
                                    <reporter username="gtully">Gary Tully</reporter>
                        <labels>
                    </labels>
                <created>Tue, 29 Nov 2016 11:24:53 +0000</created>
                <updated>Mon, 5 Dec 2016 13:50:35 +0000</updated>
                            <resolved>Tue, 29 Nov 2016 11:35:19 +0000</resolved>
                                    <version>5.14.0</version>
                                    <fixVersion>5.15.0</fixVersion>
                    <fixVersion>5.14.2</fixVersion>
                                    <component>KahaDB</component>
                    <component>Message Store</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15705029" author="jira-bot" created="Tue, 29 Nov 2016 11:33:19 +0000"  >&lt;p&gt;Commit dad629e889b2116a778fd4f77680a1b2944b400f in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=dad629e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=dad629e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6522&quot; title=&quot;KahaDB - checkForCorruptJournalFiles has hard coded 32k batch size limit in error &quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6522&quot;&gt;&lt;del&gt;AMQ-6522&lt;/del&gt;&lt;/a&gt; - remove hardcoded 32k batch limit from recovery check of the journal, fix and test&lt;/p&gt;</comment>
                            <comment id="15705032" author="gtully" created="Tue, 29 Nov 2016 11:34:45 +0000"  >&lt;p&gt;symptom with a message &amp;gt; 32k in size&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;14:23:16,374 | ERROR | AMQ-1-thread-1   | ActiveMQServiceFactory | Exception on start: java.io.IOException: Detected missing/corrupt journal files referenced by:[xxx] 1 messages affected.
java.io.IOException: Detected missing/corrupt journal files referenced by:[xxx] 1 messages affected.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15722312" author="jira-bot" created="Mon, 5 Dec 2016 13:49:58 +0000"  >&lt;p&gt;Commit 89209d320cf5bf0c6e0755f6ba4dd33d73da5398 in activemq&apos;s branch refs/heads/activemq-5.14.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=89209d3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=89209d3&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6522&quot; title=&quot;KahaDB - checkForCorruptJournalFiles has hard coded 32k batch size limit in error &quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6522&quot;&gt;&lt;del&gt;AMQ-6522&lt;/del&gt;&lt;/a&gt; - remove hardcoded 32k batch limit from recovery check of the journal, fix and test&lt;/p&gt;

&lt;p&gt;(cherry picked from commit dad629e889b2116a778fd4f77680a1b2944b400f)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 50 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i36wcf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>