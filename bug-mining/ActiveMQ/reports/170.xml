<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:33:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-961] Problem with subscription passing with network of brokers in AMQ 4.0.2</title>
                <link>https://issues.apache.org/jira/browse/AMQ-961</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;There&apos;s an occasional problem with subscription propagation when using a network of brokers.  Test scenario uses ConsumerTool and PublisherTool in examples area of distribution.&lt;/p&gt;

&lt;p&gt;1) Start broker A (has a network connection to broker B)&lt;br/&gt;
2) Start broker B (has a network connection to broker A)&lt;br/&gt;
3) start consumer C against broker A, on FOO&lt;br/&gt;
4) start publisher P against broker B, on FOO&lt;/p&gt;

&lt;p&gt;Messages do not flow to consumer C.  In the broker B log, there&apos;s no indication it got any subscriptions from broker A.  Again, this is occasional.&lt;/p&gt;

&lt;p&gt;I&apos;ve taken a kill-3 on the brokers, both when this condition appears, and when everything is fine.  There&apos;s an obvious difference in one of the threads that hopefully will bring light to the problem.  I&apos;ve not gone into the code yet to try and find the issue, but figured I would open this issue first.&lt;/p&gt;

&lt;p&gt;Stack trace of broker A when subscriptions did NOT pass, and message flow is broken:&lt;br/&gt;
&quot;ActiveMQ Transport: tcp://perfgc1a/170.137.15.169:5112&quot; prio=10 tid=0x0030e160 nid=0x3f in Object.wait() [0x8&lt;br/&gt;
e2ff000..0x8e2ff8f0]&lt;br/&gt;
        at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x9b2b00d0&amp;gt; (a edu.emory.mathcs.backport.java.util.concurrent.CountDownLatch)&lt;br/&gt;
        at java.lang.Object.wait(Object.java:474)&lt;br/&gt;
        at edu.emory.mathcs.backport.java.util.concurrent.CountDownLatch.await(CountDownLatch.java:179)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x9b2b00d0&amp;gt; (a edu.emory.mathcs.backport.java.util.concurrent.CountDownLatch)&lt;br/&gt;
        at org.apache.activemq.network.DemandForwardingBridgeSupport.waitStarted(DemandForwardingBridgeSupport&lt;br/&gt;
.java:830)&lt;br/&gt;
        at org.apache.activemq.network.DemandForwardingBridgeSupport.serviceRemoteCommand(DemandForwardingBrid&lt;br/&gt;
geSupport.java:329)&lt;br/&gt;
        at org.apache.activemq.network.DemandForwardingBridgeSupport$2.onCommand(DemandForwardingBridgeSupport&lt;br/&gt;
.java:130)&lt;br/&gt;
        at org.apache.activemq.transport.ResponseCorrelator.onCommand(ResponseCorrelator.java:92)&lt;br/&gt;
        at org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:67)&lt;br/&gt;
        at org.apache.activemq.transport.failover.FailoverTransport$1.onCommand(FailoverTransport.java:117)&lt;br/&gt;
        at org.apache.activemq.transport.WireFormatNegotiator.onCommand(WireFormatNegotiator.java:124)&lt;br/&gt;
        at org.apache.activemq.transport.InactivityMonitor.onCommand(InactivityMonitor.java:123)&lt;br/&gt;
        at org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:88)&lt;br/&gt;
        at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:137)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:595)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;Stack trace of broker A when everything works correctly:&lt;/p&gt;

&lt;p&gt;&quot;ActiveMQ Transport: tcp://perfgc1a/170.137.15.169:5112&quot; prio=10 tid=0x01955fc8 nid=0x3f runnable &lt;span class=&quot;error&quot;&gt;&amp;#91;0x8e2cf000..0x8e2cfaf0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.net.SocketInputStream.socketRead0(Native Method)&lt;br/&gt;
        at java.net.SocketInputStream.read(SocketInputStream.java:129)&lt;br/&gt;
        at org.apache.activemq.transport.tcp.TcpBufferedInputStream.fill(TcpBufferedInputStream.java:49)&lt;br/&gt;
        at org.apache.activemq.transport.tcp.TcpBufferedInputStream.read(TcpBufferedInputStream.java:56)&lt;br/&gt;
        at java.io.DataInputStream.readInt(DataInputStream.java:353)&lt;br/&gt;
        at org.apache.activemq.openwire.OpenWireFormat.unmarshal(OpenWireFormat.java:275)&lt;br/&gt;
        at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:136)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:595)&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12481898">AMQ-961</key>
            <summary>Problem with subscription passing with network of brokers in AMQ 4.0.2</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rajdavies">Robert Davies</assignee>
                                    <reporter username="yaussy">Kevin Yaussy</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 Oct 2006 19:57:25 +0000</created>
                <updated>Sat, 30 Dec 2006 07:29:56 +0000</updated>
                            <resolved>Sat, 30 Dec 2006 07:29:56 +0000</resolved>
                                    <version>4.0.2</version>
                                    <fixVersion>5.0.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12938500" author="hbruch" created="Mon, 9 Oct 2006 06:15:18 +0000"  >&lt;p&gt;Might relate to the problem I encountered in &lt;a href=&quot;http://www.nabble.com/Failover-and-DemandForwardingBridge-tf2383410.html#a6642973&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.nabble.com/Failover-and-DemandForwardingBridge-tf2383410.html#a6642973&lt;/a&gt;.&lt;br/&gt;
Apparently, the DemandForwardingBridge does not resume correctly after a network interruption.&lt;br/&gt;
For me, the attached patch worked, but I&apos;m not aware of any side effects, so please check.&lt;/p&gt;</comment>
                            <comment id="12938413" author="yaussy" created="Mon, 9 Oct 2006 12:32:22 +0000"  >&lt;p&gt;Thanks.  I will apply this patch and try it out.&lt;/p&gt;</comment>
                            <comment id="12938436" author="yaussy" created="Mon, 9 Oct 2006 14:01:51 +0000"  >&lt;p&gt;This does appear to fix the problem.  I&apos;d had a similar problem with AMQ 4.0.1, reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-776&quot; title=&quot;ConduitBridge can malfunction when first of a set of consumers goes away&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-776&quot;&gt;&lt;del&gt;AMQ-776&lt;/del&gt;&lt;/a&gt;, which I had fixed.  But, for the second part of that problem, the original patch did not work.  This issue and the second part of &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-776&quot; title=&quot;ConduitBridge can malfunction when first of a set of consumers goes away&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-776&quot;&gt;&lt;del&gt;AMQ-776&lt;/del&gt;&lt;/a&gt;, are fixed now by your patch.  I&apos;ll update &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-776&quot; title=&quot;ConduitBridge can malfunction when first of a set of consumers goes away&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-776&quot;&gt;&lt;del&gt;AMQ-776&lt;/del&gt;&lt;/a&gt;, too.&lt;/p&gt;</comment>
                            <comment id="12938707" author="rajdavies" created="Sat, 30 Dec 2006 07:29:56 +0000"  >&lt;p&gt;Applied patch in SVN revision 491185&lt;/p&gt;

&lt;p&gt;thanks kevin Yaussy!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12460717" name="RestartDFBOnResume.diff" size="1167" author="hbruch" created="Mon, 9 Oct 2006 06:15:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>84435</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 48 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0s02f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161487</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>