<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:38:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-6500] Consuming problem with topics in ActiveMQ 5.14.1 with AMQP Qpid client</title>
                <link>https://issues.apache.org/jira/browse/AMQ-6500</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;There could only be 500 topic messages be consumed with the AMQP Qpid client with ActiveMQ 5.14.1.&lt;/p&gt;

&lt;p&gt;Specific settings :&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;No prefetch sizes are set in a policyEntry of the activemq.xml.&lt;/li&gt;
	&lt;li&gt;No prefetch sizes are set in the brokerURL in the client code.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;We get the following situation (subscriber info) at the moment a subscriber&lt;br/&gt;
connects with the Qpid client.&lt;br/&gt;
The Inflight value becomes -1000 what is very strange.&lt;/p&gt;

&lt;p&gt;Pending Queue Size  | Inflight | Enqueued | Dequeued | Prefetch&lt;br/&gt;
0                                | -1000  | 0               | 0                | 0&lt;/p&gt;

&lt;p&gt;We get the following situation when one topic message is published.&lt;br/&gt;
The Inflight value increased with 2.&lt;/p&gt;

&lt;p&gt;Pending Queue Size  | Inflight | Enqueued | Dequeued | Prefetch&lt;br/&gt;
0                                | -998    | 1                | 1               | 0&lt;/p&gt;

&lt;p&gt;We get the following situation when 500 topic messages are published.&lt;br/&gt;
The Inflight value is now 0 and the 500 messages are consumed.&lt;/p&gt;

&lt;p&gt;Pending Queue Size  | Inflight | Enqueued | Dequeued | Prefetch&lt;br/&gt;
0                                | 0         | 500            | 500           | 0&lt;/p&gt;

&lt;p&gt;At the moment message 501 is published increases the &quot;Pending Queue Size&quot; and the messages &quot;Enqueued&quot; as well. The &quot;Dequeued&quot; messages remains 500 and message 501 can&apos;t be consumed by the subscriber !&lt;/p&gt;

&lt;p&gt;Pending Queue Size  | Inflight | Enqueued | Dequeued | Prefetch&lt;br/&gt;
1                                | 0          | 501          | 500            | 0&lt;/p&gt;

&lt;p&gt;Do somebody know what happens ?  Do I something wrong or is it a real bug ?&lt;/p&gt;

&lt;p&gt;Patrick&lt;/p&gt;</description>
                <environment></environment>
        <key id="13019000">AMQ-6500</key>
            <summary>Consuming problem with topics in ActiveMQ 5.14.1 with AMQP Qpid client</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tabish">Timothy A. Bish</assignee>
                                    <reporter username="patrickv">Patrick Vansevenant</reporter>
                        <labels>
                    </labels>
                <created>Mon, 7 Nov 2016 21:20:04 +0000</created>
                <updated>Mon, 21 Nov 2016 21:09:27 +0000</updated>
                            <resolved>Fri, 18 Nov 2016 17:24:48 +0000</resolved>
                                    <version>5.14.1</version>
                                    <fixVersion>5.15.0</fixVersion>
                    <fixVersion>5.14.2</fixVersion>
                                    <component>AMQP</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15645516" author="tabish121" created="Mon, 7 Nov 2016 21:27:51 +0000"  >&lt;p&gt;Please provide a reproducer for this, testing has not shown any of these issues.&lt;/p&gt;</comment>
                            <comment id="15647124" author="patrickv" created="Tue, 8 Nov 2016 10:05:13 +0000"  >&lt;p&gt;Please find the activemq.xml config in attachment.&lt;/p&gt;

&lt;p&gt;The used qpid client with his dependencies :&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;qpid-jms-client-0.9.0.jar&lt;/li&gt;
	&lt;li&gt;proton-j-0.12.2.jar&lt;/li&gt;
	&lt;li&gt;netty-all-4.0.36.Final.jar&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I get the following situation at the moment the consumer connects :&lt;br/&gt;
&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12837944/12837944_status+when+subscriber+connects.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Is that sufficient to reproduce the problem ?&lt;/p&gt;</comment>
                            <comment id="15647728" author="tabish121" created="Tue, 8 Nov 2016 14:38:24 +0000"  >&lt;p&gt;Testing with latest Qpid JMS client and Broker I don&apos;t see this issue.  &lt;/p&gt;</comment>
                            <comment id="15647852" author="patrickv" created="Tue, 8 Nov 2016 15:28:04 +0000"  >&lt;p&gt;I have done the same test again with the latest qpid client that I know : &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;qpid-jms-client-0.11.1.jar&lt;/li&gt;
	&lt;li&gt;proton-j-0.14.0.jar&lt;/li&gt;
	&lt;li&gt;netty-all-4.0.41.Final.jar&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;And I experience the same problems.  &lt;br/&gt;
I hope that you are talking about the same version of the qpid client and his dependencies now ?&lt;/p&gt;</comment>
                            <comment id="15647901" author="tabish121" created="Tue, 8 Nov 2016 15:45:58 +0000"  >&lt;p&gt;Recommend you create a unit test that shows your usage that can reproduce the problem.&lt;/p&gt;</comment>
                            <comment id="15653704" author="patrickv" created="Thu, 10 Nov 2016 10:34:54 +0000"  >&lt;p&gt;I have added a unit test that shows the issue : &quot;JmsClientUnitTest.java&quot;.&lt;/p&gt;

&lt;p&gt;The unit test sends 1000 topic messages and only 501 are received.&lt;/p&gt;</comment>
                            <comment id="15670414" author="patrickv" created="Wed, 16 Nov 2016 13:23:15 +0000"  >&lt;p&gt;Hi Timothy,&lt;/p&gt;

&lt;p&gt;I can tell you that the problem is started in ActiveMQ 5.14.1.  &lt;br/&gt;
I don&apos;t see the problem in ActiveMQ 5.13.3, 5.13.4 or 5.14.0.&lt;/p&gt;

&lt;p&gt;Below you can see the difference between ActiveMQ 5.14.0 and ActiveMQ 5.14.1 at the moment a subscriber connects, before a message is consumed.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12839168/12839168_status+when+subscriber+connects+5.14.0+and+5.14.1.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="15677140" author="jira-bot" created="Fri, 18 Nov 2016 16:59:25 +0000"  >&lt;p&gt;Commit e050519ff6ae8079c5183f6e6372ddb3d03e91c7 in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tabish121&quot; class=&quot;user-hover&quot; rel=&quot;tabish121&quot;&gt;tabish121&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=e050519&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=e050519&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6500&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-6500&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Better handle prefetch extension and pull consumers over Topics to avoid&lt;br/&gt;
the remote not receiving all the messages available based on the credit&lt;br/&gt;
it has issued. &lt;/p&gt;</comment>
                            <comment id="15677185" author="jira-bot" created="Fri, 18 Nov 2016 17:19:11 +0000"  >&lt;p&gt;Commit 65d789b4e1d59a196aa7f8f7e42aa99769352d8e in activemq&apos;s branch refs/heads/activemq-5.14.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tabish121&quot; class=&quot;user-hover&quot; rel=&quot;tabish121&quot;&gt;tabish121&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=65d789b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=65d789b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6500&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-6500&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Better handle prefetch extension and pull consumers over Topics to avoid&lt;br/&gt;
the remote not receiving all the messages available based on the credit&lt;br/&gt;
it has issued.&lt;br/&gt;
(cherry picked from commit e050519ff6ae8079c5183f6e6372ddb3d03e91c7)&lt;/p&gt;</comment>
                            <comment id="15684735" author="patrickv" created="Mon, 21 Nov 2016 21:09:27 +0000"  >&lt;p&gt;Dear Timothy,&lt;/p&gt;

&lt;p&gt;Thank you very much for solving the problem. &lt;br/&gt;
I appreciate it a lot !&lt;/p&gt;

&lt;p&gt;Patrick&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12838337" name="JmsClientUnitTest.java" size="3283" author="patrickv" created="Thu, 10 Nov 2016 10:30:53 +0000"/>
                            <attachment id="12837941" name="activemq.xml" size="6831" author="patrickv" created="Tue, 8 Nov 2016 09:47:14 +0000"/>
                            <attachment id="12839168" name="status when subscriber connects 5.14.0 and 5.14.1.png" size="22907" author="patrickv" created="Wed, 16 Nov 2016 13:18:26 +0000"/>
                            <attachment id="12837944" name="status when subscriber connects.png" size="9497" author="patrickv" created="Tue, 8 Nov 2016 09:58:28 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3616v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>