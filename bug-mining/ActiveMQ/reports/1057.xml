<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:48:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-2948] Support ajax clients in multiple windows/tabs in a single browser</title>
                <link>https://issues.apache.org/jira/browse/AMQ-2948</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;In current ajax code, there is a 1-1 relationship between ajax client and session.  Since multiple windows in the same browser share the same session, it&apos;s impossible for the ajax code to update both windows.  Either 1 or the other will receive messages, but not both.&lt;/p&gt;

&lt;p&gt;The attached patch allows an optional &apos;clientId&apos; string to be passed to the JavaScript amq.init() function, similar to that supported by the REST servlet.  This clientId string is sent to the server with every ajax request.  In MessageListenerServlet, a new consumer is created for every new sessionid+clientId, allowing multiple windows in the same browser to send &amp;amp; receive messages independently.&lt;/p&gt;

&lt;p&gt;For some (currently) unknown reason, IE7 cannot send messages from multiple windows.  2 IE7 windows can receive messages independently with no errors, but once either IE7 window sends a message, both windows cease receiving data.  This behavior is not seen in FF (OSX or WinXP) or Safari (OSX).  All those browsers are able to send &amp;amp; receive simultaneously in multiple windows with no errors.&lt;/p&gt;</description>
                <environment>&lt;p&gt;OSX 10.6&lt;br/&gt;
Centos 5.4&lt;/p&gt;</environment>
        <key id="12483846">AMQ-2948</key>
            <summary>Support ajax clients in multiple windows/tabs in a single browser</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dejanb">Dejan Bosanac</assignee>
                                    <reporter username="alexdean">Alex Dean</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Sep 2010 17:21:57 +0000</created>
                <updated>Sun, 22 Jul 2012 04:43:35 +0000</updated>
                            <resolved>Wed, 13 Oct 2010 11:54:50 +0000</resolved>
                                    <version>5.4.1</version>
                                    <fixVersion>5.4.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12943001" author="alexdean" created="Tue, 28 Sep 2010 17:29:03 +0000"  >&lt;p&gt;There&apos;s a separate minor change in the attached patch, which ensures that the Content-Type header is always set to &apos;text/xml&apos;.&lt;/p&gt;

&lt;p&gt;In current svn code, this header is only set when a message is delivered.  When a timeout occurs (and an empty &amp;lt;ajax-response&amp;gt;&amp;lt;/ajax-response&amp;gt; is returned), the Content-Type header is set to &apos;text/plain&apos;.  The jQuery adapter attempts to parse the responseXML property of the response, which is not populated due to the Content-Type header being set to &apos;text/plain&apos;.&lt;/p&gt;

&lt;p&gt;This is seen in FIrebug as a 200 response resulting in a parseerror.  (Successful response which fired the error-handling ajax callback!)&lt;/p&gt;</comment>
                            <comment id="12943016" author="alexdean" created="Tue, 28 Sep 2010 22:20:01 +0000"  >&lt;p&gt;We have observed that ActiveMQ running with this patch does not clean up session data as quickly as we expected.  (Every reload of a browser window which uses the clientId parameter creates 5 new threads in the JVM, and these do not appear to be cleaned up.)  We&apos;re going to investigate this a bit more and possibly submit a revised patch.&lt;/p&gt;</comment>
                            <comment id="12943025" author="alexdean" created="Thu, 30 Sep 2010 21:11:13 +0000"  >&lt;p&gt;This patch replaces the original one I attached to this ticket.&lt;/p&gt;

&lt;p&gt;Changes since original patch:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private MessageListenerServlet.ClientConsumerState class refactored to AjaxWebClient (extends WebClient).&lt;/li&gt;
	&lt;li&gt;private MessageListenerServlet.Listener class refactored to AjaxListener.  AjaxWebClient uses an instance of Listener/AjaxListener, so this needs to be public.&lt;/li&gt;
	&lt;li&gt;AjaxWebClient &amp;amp; associated data for each client are now stored in a MessageListenerServlet instance variable (ajaxWebClients) rather than in sessions.&lt;/li&gt;
	&lt;li&gt;Timer/TimerTask code added to examine ajaxWebClients and clean up clients which have not been accessed in the past minute.  This solves the thread-leakage we were seeing in my initial patch.&lt;/li&gt;
	&lt;li&gt;JavaScript to append clientId parameter to all requests moved to amq.js, so no changes are required to the jquery, prototype, or dojo adapters.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;New patch also includes a new JS test, and an updated chat.html which uses a clientId (so you can open chat.html in multiple windows in the same browser) for a quick test.&lt;/p&gt;</comment>
                            <comment id="12943067" author="dejanb" created="Wed, 13 Oct 2010 11:54:50 +0000"  >&lt;p&gt;Committed with svn revision 1022071. Thanks a lot for a great work.&lt;/p&gt;

&lt;p&gt;I think there&apos;s two things left to be done to complete Ajax improvements:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Documentation on Ajax is way out of date, so we should update it with these new features - &lt;a href=&quot;http://activemq.apache.org/ajax.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.apache.org/ajax.html&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;We should automate JS tests and include them in our unit testing suite with something like WebDriver (&lt;a href=&quot;http://code.google.com/p/selenium/wiki/GettingStarted&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://code.google.com/p/selenium/wiki/GettingStarted&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13420108" author="saravanantp" created="Sun, 22 Jul 2012 04:38:58 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
I have a auction application being developed and have multiple users login at the same time for bidding. I understand that clientId in amq.init is the unique parameter that distincts each users window. Say for example, user U1 is logged in IE and user U2 is logged in Chrome at the same time. When they bid, the messages and updated price information are passing to both the users. However, when U1 logs out of the application and logs in back for bidding, he doesnt see the updated price information in his screen, which is weird. Can you please let me know if this is really an issue or I am doing something wrong, please? I use ActiveMQ 5.6.0 with Java and Spring Framework. Appreciate your response.&lt;/p&gt;

&lt;p&gt;Saravanan Thoppan&lt;/p&gt;</comment>
                            <comment id="13420109" author="saravanantp" created="Sun, 22 Jul 2012 04:43:35 +0000"  >&lt;p&gt;Slight change in my words - However, when U1 logs out of the application and logs in back for bidding and when he starts bidding, the update doesnt come to his winidow but the other users U2 sees the price information being updated on his.&lt;/p&gt;

&lt;p&gt;Saravanan Thoppan&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12461876" name="support-multiple-ajax-clients-per-session.patch" size="23902" author="alexdean" created="Thu, 30 Sep 2010 21:11:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>14838</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 18 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0b9xj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>63721</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>