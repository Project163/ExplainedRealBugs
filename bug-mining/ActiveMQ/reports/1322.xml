<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:51:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-2643] Closing a PooledConnection does not seem to return associated sessions to the SessionPool</title>
                <link>https://issues.apache.org/jira/browse/AMQ-2643</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Reading the documentation at &lt;a href=&quot;http://java.sun.com/j2ee/1.4/docs/api/javax/jms/Connection.html#close(&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://java.sun.com/j2ee/1.4/docs/api/javax/jms/Connection.html#close(&lt;/a&gt;) one would assume the associated session(s) would be closed/returned to the SessionPool when closing a connection: &quot;There is no need to close the sessions, producers, and consumers of a closed connection.&quot;&lt;/p&gt;

&lt;p&gt;But it seems if you don&apos;t also explicitly call close() on the session you will run out of Session objects in the SessionPool. &lt;br/&gt;
Looking at &lt;a href=&quot;http://www.google.com/codesearch/p?hl=en#coOE0tRomSs/trunk/activemq-core/src/main/java/org/apache/activemq/pool/PooledConnection.java&amp;amp;d=9&amp;amp;l=69&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.google.com/codesearch/p?hl=en#coOE0tRomSs/trunk/activemq-core/src/main/java/org/apache/activemq/pool/PooledConnection.java&amp;amp;d=9&amp;amp;l=69&lt;/a&gt; trunk seems to have the same behaviour.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12483604">AMQ-2643</key>
            <summary>Closing a PooledConnection does not seem to return associated sessions to the SessionPool</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tabish">Timothy A. Bish</assignee>
                                    <reporter username="henriko">Henrik Olsson</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Mar 2010 09:37:40 +0000</created>
                <updated>Fri, 7 Oct 2011 13:52:22 +0000</updated>
                            <resolved>Fri, 7 Oct 2011 13:52:22 +0000</resolved>
                                    <version>5.2.0</version>
                                    <fixVersion>5.6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13115907" author="tabish121" created="Tue, 27 Sep 2011 20:48:55 +0000"  >&lt;p&gt;Not test case provided which would be needed to reproduce the issue in question.&lt;/p&gt;</comment>
                            <comment id="13116301" author="henriko" created="Wed, 28 Sep 2011 09:02:51 +0000"  >&lt;p&gt;Still a bug, tested against 5.5.0. Making a test case&lt;/p&gt;</comment>
                            <comment id="13116302" author="henriko" created="Wed, 28 Sep 2011 09:05:56 +0000"  >&lt;p&gt;Attached a test case showing that continously requesting a connection (and a a session) from a ConnectionFactory that happens to be a PooledConnectionFactory and only closing the connection, not the session, eventually exhausts the session pool. This seems to break the contract of Connection.close since the official documentation for it states that &quot;There is no need to close the sessions, producers, and consumers of a closed connection.&quot;&lt;/p&gt;</comment>
                            <comment id="13120081" author="tabish121" created="Tue, 4 Oct 2011 13:22:58 +0000"  >&lt;p&gt;Create a usable JUnit test based on the initial test case.  This one will throw an exception if sessions are exhausted and creates its own BrokerService.  &lt;/p&gt;</comment>
                            <comment id="13122805" author="tabish121" created="Fri, 7 Oct 2011 13:52:22 +0000"  >&lt;p&gt;Fix applied in trunk.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12497632" name="PooledSessionExhaustionTest.java" size="3437" author="tabish" created="Tue, 4 Oct 2011 13:22:57 +0000"/>
                            <attachment id="12496860" name="SimpleTest.java" size="3162" author="henriko" created="Wed, 28 Sep 2011 09:03:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33650</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 7 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0akjj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>59601</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>