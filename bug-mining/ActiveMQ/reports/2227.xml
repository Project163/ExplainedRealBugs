<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:04:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-5089] Inflight Count for topics is not correct</title>
                <link>https://issues.apache.org/jira/browse/AMQ-5089</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;It is coming from: &lt;br/&gt;
&lt;a href=&quot;http://activemq.2283324.n4.nabble.com/Inflight-Count-for-topics-not-correct-td4678407.html#a4678583&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.2283324.n4.nabble.com/Inflight-Count-for-topics-not-correct-td4678407.html#a4678583&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Problem:  Inflight count is not going down for topics once consumer is disconnected or sent acknowledgements for the messages it has received.&lt;br/&gt;
For topics once inflight count is increased, it is never going back down. &lt;/p&gt;


&lt;p&gt;Test Scenario: &lt;br/&gt;
When a producer and a consumer connected to the broker but consumer is little bit slow, there will be inflight messages in the broker which are not yet acknowledged. &lt;br/&gt;
Case 1 :Now after some time when consumer acknowledged the messages, than inflight count should decrease, but that is not happening for topics.&lt;br/&gt;
Case 2 :Now If at this point of time, I stop consumer broker should make inflight count to &apos;0&apos; because those messages are not inflight now. (for queue these are now held messages and for topic those messages are dropped). But when I check in Jconsole, I found that: for a queue it is working fine and going down to 0 but for topics inflight count is not changing.&lt;/p&gt;



&lt;p&gt;Test Case: I tested with normal java consumer subscribing to a topic, I put thread.sleep(5000) while receiving messages. Now consumer will take time to acknowledge messages which are received. So that we can see inflight messages. &lt;br/&gt;
Now after 5 seconds, consumer has received the messages and also sent acknowledgement to the broker but inflight count is not decreasing. Now if I disconnects consumer inflight count should go down to &apos;0&apos;, again here also it is not changing for that topic.&lt;/p&gt;



&lt;p&gt;Thanks,&lt;br/&gt;
Anuj &lt;/p&gt;</description>
                <environment></environment>
        <key id="12699366">AMQ-5089</key>
            <summary>Inflight Count for topics is not correct</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gtully">Gary Tully</assignee>
                                    <reporter username="anujkhandelwal">Anuj Khandelwal</reporter>
                        <labels>
                    </labels>
                <created>Fri, 7 Mar 2014 08:55:59 +0000</created>
                <updated>Fri, 17 Jul 2015 18:42:35 +0000</updated>
                            <resolved>Wed, 19 Mar 2014 15:36:30 +0000</resolved>
                                    <version>5.8.0</version>
                                    <fixVersion>5.10.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13930491" author="anujkhandelwal" created="Tue, 11 Mar 2014 15:56:46 +0000"  >&lt;p&gt;Did anybody get a chance to look at this ?&lt;/p&gt;</comment>
                            <comment id="13930537" author="gtully" created="Tue, 11 Mar 2014 16:26:27 +0000"  >&lt;p&gt;I had a quick peek just now, it looks like we could improve this, we track the enqueue/dequeue count for a topic sub but don&apos;t subtract the difference from the destination inflight when the consumer goes away with pending acks. As it stands, one abortive consumer can skew the metric for the destination which otherwise would be some indication of how slow consumers are. However for topics the broker does not really care b/c there is no broker side state for non durable topic subs.&lt;/p&gt;</comment>
                            <comment id="13940577" author="gtully" created="Wed, 19 Mar 2014 15:36:30 +0000"  >&lt;p&gt;fix in &lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/activemq/commit/b136df17&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/activemq/commit/b136df17&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;client ack is now respected for topics subs - and counters decremented on ack rather than on delivered ack.&lt;br/&gt;
expired case now has its own ack type so it can be separate from delivered ack.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12845952">AMQCPP-578</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>377713</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 35 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1t32f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>378005</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>