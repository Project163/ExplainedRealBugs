<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:01:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-4641] JoramJmsTest QueryBrowserTest fails when run with amqp+nio</title>
                <link>https://issues.apache.org/jira/browse/AMQ-4641</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;If you run QueryBrowserTest using amqp+nio, you get the following:&lt;/p&gt;


&lt;p&gt;Tests run: 2, Failures: 2, Errors: 0, Skipped: 0, Time elapsed: 5.166 sec &amp;lt;&amp;lt;&amp;lt; FAILURE!&lt;br/&gt;
testSenderBrowser(org.objectweb.jtests.jms.conform.queue.QueueBrowserTest)  Time elapsed: 3.053 sec  &amp;lt;&amp;lt;&amp;lt; FAILURE!&lt;br/&gt;
junit.framework.AssertionFailedError: null&lt;br/&gt;
	at junit.framework.Assert.fail(Assert.java:55)&lt;br/&gt;
	at junit.framework.Assert.assertTrue(Assert.java:22)&lt;br/&gt;
	at junit.framework.Assert.assertTrue(Assert.java:31)&lt;br/&gt;
	at org.objectweb.jtests.jms.conform.queue.QueueBrowserTest.testSenderBrowser(QueueBrowserTest.java:103)&lt;/p&gt;

&lt;p&gt;testBrowserWithMessageSelector(org.objectweb.jtests.jms.conform.queue.QueueBrowserTest)  Time elapsed: 2.051 sec  &amp;lt;&amp;lt;&amp;lt; FAILURE!&lt;br/&gt;
junit.framework.AssertionFailedError: expected:&amp;lt;1&amp;gt; but was:&amp;lt;0&amp;gt;&lt;br/&gt;
	at junit.framework.Assert.fail(Assert.java:57)&lt;br/&gt;
	at junit.framework.Assert.failNotEquals(Assert.java:329)&lt;br/&gt;
	at junit.framework.Assert.assertEquals(Assert.java:78)&lt;br/&gt;
	at junit.framework.Assert.assertEquals(Assert.java:234)&lt;br/&gt;
	at junit.framework.Assert.assertEquals(Assert.java:241)&lt;br/&gt;
	at org.objectweb.jtests.jms.conform.queue.QueueBrowserTest.testBrowserWithMessageSelector(QueueBrowserTest.java:142)&lt;/p&gt;


&lt;p&gt;This may be similar to: &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-4376&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-4376&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12658720">AMQ-4641</key>
            <summary>JoramJmsTest QueryBrowserTest fails when run with amqp+nio</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="kearls">Kevin Anthony Earls</reporter>
                        <labels>
                    </labels>
                <created>Fri, 19 Jul 2013 10:26:48 +0000</created>
                <updated>Thu, 5 Sep 2013 16:07:02 +0000</updated>
                            <resolved>Thu, 5 Sep 2013 16:07:02 +0000</resolved>
                                                                    <component>Test Cases</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13713904" author="tabish121" created="Fri, 19 Jul 2013 18:24:50 +0000"  >&lt;p&gt;One thing you might want to do is create a version of this test in the amqp test source and dump some broker info for that destination to see why the second browser thinks there are still two messages on the Queue, they should have been ack&apos;d I think. &lt;/p&gt;</comment>
                            <comment id="13716409" author="tabish121" created="Tue, 23 Jul 2013 14:11:23 +0000"  >&lt;p&gt;I ran this last night and noticed that if you run them alone the test passes so looks like a timing issue. &lt;/p&gt;</comment>
                            <comment id="13716413" author="kearls" created="Tue, 23 Jul 2013 14:16:48 +0000"  >&lt;p&gt;Yea, I think we had the same behavior with &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-4376&quot; title=&quot;JoramJmsTest QueueBrowserTest.testSenderBrowser fails intermittently.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-4376&quot;&gt;&lt;del&gt;AMQ-4376&lt;/del&gt;&lt;/a&gt;.  I&apos;ll have to look at how Hiram fixed that.&lt;/p&gt;</comment>
                            <comment id="13728035" author="tabish121" created="Fri, 2 Aug 2013 20:15:20 +0000"  >&lt;p&gt;Seems like this might be more on the QPid side.  It appears that Acks sent back aren&apos;t synchronous so the test can move on from a message receive and create a new QueueBrowser before all the messages that were read have been Ack&apos;d at the broker side.  &lt;/p&gt;</comment>
                            <comment id="13729462" author="kearls" created="Mon, 5 Aug 2013 12:27:57 +0000"  >&lt;p&gt;Should I just add a sleep to the test?  Both pass if I add a one second sleep before calling browser.getEnumeration.&lt;/p&gt;</comment>
                            <comment id="13729504" author="tabish121" created="Mon, 5 Aug 2013 13:30:36 +0000"  >&lt;p&gt;You can try that, what it looks like is that since the acks are fired and it doesn&apos;t wait for a response the NIO worker interleaves the work for the connection and processes an ack sometimes and then gets to the other connections new browser request before going back to process the other ack.  &lt;/p&gt;</comment>
                            <comment id="13733239" author="kearls" created="Thu, 8 Aug 2013 08:02:22 +0000"  >&lt;p&gt;I submitted a pull request for joram-jms-tests which should fix this. &lt;/p&gt;</comment>
                            <comment id="13733451" author="kearls" created="Thu, 8 Aug 2013 12:39:29 +0000"  >&lt;p&gt;After joram-jms-tests are updated, we need to update their version in the pom.&lt;/p&gt;</comment>
                            <comment id="13758055" author="tabish121" created="Wed, 4 Sep 2013 17:57:18 +0000"  >&lt;p&gt;I think in the case of these tests we should probably just disable those for now as the issue lies on the QPid JMS client side and not the broker side, perhaps open an issue there indicating that the client is behaving badly as a JMS client and doing async operations when it should be sync.  &lt;/p&gt;</comment>
                            <comment id="13758970" author="kearls" created="Thu, 5 Sep 2013 10:23:21 +0000"  >&lt;p&gt;This patch replaces the existing JoramJmsNioTest with one that doesn&apos;t run QueueBrowserTest.  After applying, you can close this bug, as I have updated &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-4375&quot; title=&quot;JoramJmsTest UnifiedSessionTest and TopicConnectionTest hang when run with SSL, or on windows.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-4375&quot;&gt;&lt;del&gt;AMQ-4375&lt;/del&gt;&lt;/a&gt; to include all instances where test fail because of the qpid client.&lt;/p&gt;

&lt;p&gt;(I&apos;ve also included a minor change here to JoramSslTest.  It removes a redundant test declaration and and unneeded dependency on the Junit 3 TestCase class.  If you&apos;d prefer I can open another bug and submit it separately.)&lt;/p&gt;</comment>
                            <comment id="13759184" author="tabish121" created="Thu, 5 Sep 2013 16:07:02 +0000"  >&lt;p&gt;Applied latest patches.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12666487">AMQ-4707</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12596839" name="AMQ4641.patch" size="579" author="kearls" created="Thu, 8 Aug 2013 12:39:29 +0000"/>
                            <attachment id="12601592" name="AMQ4641_final.patch" size="4465" author="kearls" created="Thu, 5 Sep 2013 10:23:21 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>338914</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 11 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1mgf3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>339234</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>