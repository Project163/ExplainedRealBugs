<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:43:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-2516] SecurityException raised when broker tries to move expired message to DLQ</title>
                <link>https://issues.apache.org/jira/browse/AMQ-2516</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;I have enabled authentication + authorization in my broker configuration file as follows:&lt;/p&gt;

&lt;p&gt;&amp;lt;jaasAuthenticationPlugin configuration=&quot;PropertiesLogin&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;authorizationPlugin&amp;gt;&lt;br/&gt;
&amp;lt;map&amp;gt;&lt;br/&gt;
&amp;lt;authorizationMap&amp;gt;&lt;br/&gt;
&amp;lt;authorizationEntries&amp;gt;&lt;br/&gt;
&amp;lt;authorizationEntry queue=&quot;&amp;gt;&quot; read=&quot;users&quot; write=&quot;users&quot; admin=&quot;users&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;authorizationEntry topic=&quot;ActiveMQ.Advisory.&amp;gt;&quot; read=&quot;users&quot; write=&quot;users&quot; admin=&quot;users&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/authorizationEntries&amp;gt;&lt;br/&gt;
&amp;lt;/authorizationMap&amp;gt;&lt;br/&gt;
&amp;lt;/map&amp;gt;&lt;br/&gt;
&amp;lt;/authorizationPlugin&amp;gt;&lt;/p&gt;

&lt;p&gt;If I send a message with a TTL into the queue (using provided sample configured with the right username and password) and then try to look after the message in the queue after it has expired using the Web Console, I got the following exception:&lt;/p&gt;

&lt;p&gt;&quot;Caught an exception sending to DLQ: Message ID:PC198829-1539-1259168148838-0:1:1:1:1 dropped=false locked=false&lt;br/&gt;
java.lang.SecurityException: User is not authenticated.&quot;&lt;/p&gt;

&lt;p&gt;This only occurs when the broker has to deal with the DLQ as I can successfully read/write in any queue.&lt;/p&gt;

&lt;p&gt;It seems that the thread responsible for moving the message into the DLQ doesn&apos;t have the right to perform this action (username and password not propagated to its connexion context ? ).&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows XP SP2&lt;br/&gt;
Java JRE 1.6&lt;/p&gt;

&lt;p&gt;Issue found on both FUSE Message Broker 5.3.0.3 &amp;amp; 5.3.0.5 (based on Apache ActiveMQ 5.3)&lt;/p&gt;</environment>
        <key id="12482965">AMQ-2516</key>
            <summary>SecurityException raised when broker tries to move expired message to DLQ</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gtully">Gary Tully</assignee>
                                    <reporter username="nsaboy">Concombre Masqu&#233;</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 Nov 2009 14:11:21 +0000</created>
                <updated>Sat, 26 Dec 2009 20:09:37 +0000</updated>
                            <resolved>Fri, 27 Nov 2009 08:23:41 +0000</resolved>
                                    <version>5.3.0</version>
                                    <fixVersion>5.3.1</fixVersion>
                    <fixVersion>5.4.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12941885" author="nsaboy" created="Thu, 26 Nov 2009 14:13:47 +0000"  >&lt;p&gt;Find attached the ActiveMQ configuration, the log showing the security exception and a JMS sample to send a message with TTL into the queue.&lt;/p&gt;</comment>
                            <comment id="12941897" author="gtully" created="Fri, 27 Nov 2009 08:23:41 +0000"  >&lt;p&gt;resolved in r884778&lt;br/&gt;
thanks for the good description. send to dlq (when configured) now uses the brokers security context so that it is immune to authentication configuration.&lt;/p&gt;</comment>
                            <comment id="12943302" author="selikoff" created="Wed, 23 Dec 2009 23:55:09 +0000"  >&lt;p&gt;@ Concombre:  Did you find a work-around for ActiveMQ 5.3.0?  I&apos;m also using the FUSE broker and am seeing this issue.&lt;/p&gt;</comment>
                            <comment id="12941842" author="nsaboy" created="Sat, 26 Dec 2009 16:40:59 +0000"  >&lt;p&gt;@Scott: No, no workaround sorry. This issue is not a blocking one for the project I am working on so we just deal with it ignoring the errors. But we plan to upgrade to a new FUSE Message Broker release with fix for this issue as soon as possible (when available).&lt;/p&gt;</comment>
                            <comment id="12943303" author="selikoff" created="Sat, 26 Dec 2009 20:09:37 +0000"  >&lt;p&gt;@Concombre:  Since this is a one line fix, the easiest solution we found was to download the fuse source and rebuild it with maven.  It takes a bit of time for maven to automatically download all the required libraries the first time it runs, but after its done you get a full build with the solution in place.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12461428" name="activemq.log" size="421026" author="nsaboy" created="Thu, 26 Nov 2009 14:13:47 +0000"/>
                            <attachment id="12461430" name="activemq_configuration.zip" size="3926" author="nsaboy" created="Thu, 26 Nov 2009 14:13:47 +0000"/>
                            <attachment id="12461429" name="jmsproducer_sample.zip" size="1466" author="nsaboy" created="Thu, 26 Nov 2009 14:13:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>74911</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 48 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0rptz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>159829</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>