<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:34:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-6244] ActiveMQBytesMessage fails to set &apos;compressed=false&apos; following restoration of compressed message content</title>
                <link>https://issues.apache.org/jira/browse/AMQ-6244</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;&lt;tt&gt;ActiveMQBytesMessage&lt;/tt&gt; does not reset its &lt;tt&gt;compressed&lt;/tt&gt; flag to &lt;tt&gt;false&lt;/tt&gt; following the restoration of compressed message content in &lt;tt&gt;restoreOldContent()&lt;/tt&gt;.  This becomes a problem if an &lt;tt&gt;ActiveMQBytesMessage&lt;/tt&gt; is reused by a client on an uncompressed connection after originally being published on a compressed connection.&lt;/p&gt;

&lt;p&gt;Steps to reproduce:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;An &lt;tt&gt;ActiveMQBytesMessage&lt;/tt&gt; is published by a producer on a connection with compression &lt;b&gt;&lt;em&gt;enabled&lt;/em&gt;&lt;/b&gt;&lt;br/&gt;
Message State: compressed=true; content=compressed&lt;/li&gt;
	&lt;li&gt;The message is consumed by a client and republished on a connection with compression &lt;b&gt;&lt;em&gt;disabled&lt;/em&gt;&lt;/b&gt;&lt;br/&gt;
Message State: compressed=true; content=uncompressed&lt;/li&gt;
	&lt;li&gt;The message is consumed by a client and its contents are read.  The ActiveMQ client library tries to decompress the message content, but fails because the content is not compressed.  This causes the consumer to throw either a &lt;tt&gt;DataFormatException&lt;/tt&gt; or &lt;tt&gt;NegativeArraySizeException&lt;/tt&gt;.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;This JIRA is similar in nature to &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-5381&quot; title=&quot;ActiveMQBytesMessage mishandles restoration of old message contents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-5381&quot;&gt;&lt;del&gt;AMQ-5381&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I&apos;ll submit a pull request with a test to reproduce and a patch shortly.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12958479">AMQ-6244</key>
            <summary>ActiveMQBytesMessage fails to set &apos;compressed=false&apos; following restoration of compressed message content</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cshannon">Christopher L. Shannon</assignee>
                                    <reporter username="brianjohnson">Brian D. Johnson</reporter>
                        <labels>
                            <label>EasyFix</label>
                    </labels>
                <created>Wed, 13 Apr 2016 14:13:55 +0000</created>
                <updated>Wed, 13 Apr 2016 15:24:02 +0000</updated>
                            <resolved>Wed, 13 Apr 2016 15:24:02 +0000</resolved>
                                    <version>5.13.2</version>
                                    <fixVersion>5.13.3</fixVersion>
                    <fixVersion>5.14.0</fixVersion>
                                    <component>JMS client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15239329" author="githubbot" created="Wed, 13 Apr 2016 14:25:48 +0000"  >&lt;p&gt;GitHub user bdjdev opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/activemq/pull/177&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/activemq/pull/177&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6244&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-6244&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Fix and test for &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6244&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-6244&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/bdjdev/activemq&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/bdjdev/activemq&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6244&quot; title=&quot;ActiveMQBytesMessage fails to set &amp;#39;compressed=false&amp;#39; following restoration of compressed message content&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6244&quot;&gt;&lt;del&gt;AMQ-6244&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/activemq/pull/177.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/activemq/pull/177.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #177&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 7a61718e0255728b7a822b25fcf75a030be14359&lt;br/&gt;
Author: Brian D. Johnson &amp;lt;brian@thejohnsonfamily.name&amp;gt;&lt;br/&gt;
Date:   2016-04-11T20:18:26Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6244&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-6244&lt;/a&gt; - reset ActiveMQBytesMessage &apos;compressed&apos; flag after restoring compressed content&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15239408" author="jira-bot" created="Wed, 13 Apr 2016 15:22:06 +0000"  >&lt;p&gt;Commit 7a61718e0255728b7a822b25fcf75a030be14359 in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brianjohnson&quot; class=&quot;user-hover&quot; rel=&quot;brianjohnson&quot;&gt;brianjohnson&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=7a61718&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=7a61718&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6244&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-6244&lt;/a&gt; - reset ActiveMQBytesMessage &apos;compressed&apos; flag after restoring compressed content&lt;/p&gt;</comment>
                            <comment id="15239409" author="jira-bot" created="Wed, 13 Apr 2016 15:22:07 +0000"  >&lt;p&gt;Commit 66953e1a2981427af67c8c76332e34c3cc6d9ee3 in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cshannon&quot; class=&quot;user-hover&quot; rel=&quot;cshannon&quot;&gt;cshannon&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=66953e1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=66953e1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6244&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-6244&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Merging ActiveMQBytesMessage compression fix&lt;/p&gt;

&lt;p&gt;This closes #177&lt;/p&gt;</comment>
                            <comment id="15239412" author="githubbot" created="Wed, 13 Apr 2016 15:23:29 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/activemq/pull/177&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/activemq/pull/177&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15239413" author="jira-bot" created="Wed, 13 Apr 2016 15:23:34 +0000"  >&lt;p&gt;Commit 7894d8a9a1f0465c0ff26360ac364b4dc797d254 in activemq&apos;s branch refs/heads/activemq-5.13.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brianjohnson&quot; class=&quot;user-hover&quot; rel=&quot;brianjohnson&quot;&gt;brianjohnson&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=7894d8a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=7894d8a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6244&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-6244&lt;/a&gt; - reset ActiveMQBytesMessage &apos;compressed&apos; flag after restoring compressed content&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 7a61718e0255728b7a822b25fcf75a030be14359)&lt;/p&gt;</comment>
                            <comment id="15239416" author="christopher.l.shannon" created="Wed, 13 Apr 2016 15:24:02 +0000"  >&lt;p&gt;Thanks for the patch, applied to both master and 5.13.x and will be part of 5.13.3.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 31 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2w273:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>