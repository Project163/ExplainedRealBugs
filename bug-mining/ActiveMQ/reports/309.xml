<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:35:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-1511] Slave starts connectors before master fails</title>
                <link>https://issues.apache.org/jira/browse/AMQ-1511</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;A broker configured as a slave starts its connectors before the the master fails.  This is bad because a) The documentation states that this is not the case.  b) it shouldn&apos;t be the case because you don&apos;t want clients to be able to connect to the slave until it takes over as master.&lt;/p&gt;

&lt;p&gt;In looking at source, it would appear that the MasterConnector of BrokerService is not started until after all the connections are started in startAllConnection().  Unfortunately, to determine if connections should be started, isSlave() is called which relies on the MasterConnector.start() method being called.  &lt;/p&gt;

&lt;p&gt;The MasterConnector service start() method needs to be called first before isSlave will work.&lt;/p&gt;

&lt;p&gt;See broken code snippet from BrokerService below:&lt;/p&gt;


&lt;p&gt;protected void startAllConnectors() throws Exception{&lt;br/&gt;
  if (&lt;span class=&quot;error&quot;&gt;Unable to render embedded object: File (isSlave()){   // OOPS) not found.&lt;/span&gt;!! isSlave asks the MasterConnector if the master is active, but can&apos;t until its started &lt;br/&gt;
    ...&lt;br/&gt;
       if (services != null) {&lt;br/&gt;
                for (int i = 0; i &amp;lt; services.length; i++) &lt;/p&gt;
{
                    Service service = services[i];   //OOPS, MasterConnector is in this list and the surrounding if relies on it to be started
                    configureService(service);
                    service.start();   //OOPS!!!!   this should have been called for isSlave() to return the right answer.
                }
&lt;p&gt;            }&lt;br/&gt;
   }&lt;/p&gt;</description>
                <environment></environment>
        <key id="12482426">AMQ-1511</key>
            <summary>Slave starts connectors before master fails</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rajdavies">Robert Davies</assignee>
                                    <reporter username="hoorner">Howard Orner</reporter>
                        <labels>
                    </labels>
                <created>Mon, 3 Dec 2007 21:36:10 +0000</created>
                <updated>Wed, 9 Apr 2008 09:43:26 +0000</updated>
                            <resolved>Wed, 9 Apr 2008 09:43:26 +0000</resolved>
                                    <version>4.1.1</version>
                                    <fixVersion>5.1.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12939376" author="joef" created="Thu, 13 Mar 2008 20:41:18 +0000"  >&lt;p&gt;Attached is a proposed svn diff patch for this issue. With this patch, a slave broker in a pure master/slave configuration will not open transports, connectors, bridges, proxies, etc. while it is attached to its master. Also, a broker will fail to  start if you configure it to have more than one masterConnector. The code was there to prevent this, but was broken.  &lt;/p&gt;</comment>
                            <comment id="12939452" author="rajdavies" created="Wed, 9 Apr 2008 09:43:26 +0000"  >&lt;p&gt;Patch applied in svn revision 646245&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12460940" name="patchfile.txt" size="4520" author="joef" created="Thu, 13 Mar 2008 20:41:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>84523</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 33 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0s1un:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161776</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>