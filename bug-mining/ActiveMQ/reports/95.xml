<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:31:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-789] WireFormatNegotiator could hang a client or server connection if the peer disconnects before sending the wire format info</title>
                <link>https://issues.apache.org/jira/browse/AMQ-789</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description></description>
                <environment></environment>
        <key id="12481778">AMQ-789</key>
            <summary>WireFormatNegotiator could hang a client or server connection if the peer disconnects before sending the wire format info</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chirino">Hiram R. Chirino</assignee>
                                    <reporter username="chirino">Hiram R. Chirino</reporter>
                        <labels>
                    </labels>
                <created>Sun, 2 Jul 2006 02:00:33 +0000</created>
                <updated>Tue, 17 Feb 2009 23:18:21 +0000</updated>
                            <resolved>Tue, 17 Feb 2009 23:18:21 +0000</resolved>
                                    <version>4.0</version>
                                    <fixVersion>4.0.2</fixVersion>
                    <fixVersion>4.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12938089" author="chirino" created="Sun, 2 Jul 2006 02:02:45 +0000"  >&lt;p&gt;Fix in trunk revision 418497&lt;/p&gt;

&lt;p&gt;We now wait up to 15 seconds before timeing out the wireformat negociation phase.&lt;/p&gt;</comment>
                            <comment id="12938092" author="chirino" created="Thu, 20 Jul 2006 05:39:00 +0000"  >&lt;p&gt;This should also be backported to 4.0 branch&lt;/p&gt;</comment>
                            <comment id="12938263" author="chirino" created="Thu, 20 Jul 2006 05:40:02 +0000"  >&lt;p&gt;A hang could also happen if the transport is stop()ed while a send is being concurrently done.&lt;/p&gt;</comment>
                            <comment id="12938207" author="chirino" created="Thu, 20 Jul 2006 06:02:29 +0000"  >&lt;p&gt;commited in 4.0 branch in rev 423792&lt;/p&gt;</comment>
                            <comment id="12939284" author="michaelshaw" created="Thu, 13 Dec 2007 15:50:17 +0000"  >&lt;p&gt;I think I might be seeing this in 4.1.1.  &lt;br/&gt;
2007-12-13 01:08:16,917 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq.transport.failover.FailoverTransport&amp;#93;&lt;/span&gt; - Thread-3 - Waking up reconnect task&lt;br/&gt;
2007-12-13 01:08:16,965 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq.transport.failover.FailoverTransport&amp;#93;&lt;/span&gt; - ActiveMQ Task - Attempting connect to: tcp://**&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;:&lt;/b&gt;**?wireFormat.maxInactivityDuration=600000&amp;amp;soTi&lt;br/&gt;
meout=10000&lt;br/&gt;
2007-12-13 01:08:17,232 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq.transport.WireFormatNegotiator&amp;#93;&lt;/span&gt; - ActiveMQ Task - Sending: WireFormatInfo { version=2, properties=&lt;/p&gt;
{CacheSize=1024, CacheEnabled=true, SizePrefixDi
sabled=false, TcpNoDelayEnabled=true, MaxInactivityDuration=600000, TightEncodingEnabled=true, StackTraceEnabled=true}, magic=&lt;span class=&quot;error&quot;&gt;&amp;#91;A,c,t,i,v,e,M,Q&amp;#93;&lt;/span&gt;}&lt;br/&gt;
2007-12-13 01:08:17,236 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq.transport.failover.FailoverTransport&amp;#93;&lt;/span&gt; - ActiveMQ Task - Connection established&lt;br/&gt;
2007-12-13 01:08:17,237 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq.transport.failover.FailoverTransport&amp;#93;&lt;/span&gt; - Thread-3 - Started.&lt;br/&gt;
2007-12-13 01:08:17,240 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;com.highergear.lead.jms.JMSFactoryConnectionUtil&amp;#93;&lt;/span&gt; - Thread-3 - Created Connection&lt;br/&gt;
... That&apos;s all it says for hours.&lt;br/&gt;
&lt;br/&gt;
Upon restarting both broker and client:&lt;br/&gt;
&lt;br/&gt;
2007-12-13 08:46:40,633 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq.transport.failover.FailoverTransport&amp;#93;&lt;/span&gt; - Thread-3 - Waking up reconnect task&lt;br/&gt;
2007-12-13 08:46:40,680 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq.transport.failover.FailoverTransport&amp;#93;&lt;/span&gt; - ActiveMQ Task - Attempting connect to: tcp://**&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;:&lt;/b&gt;**?wireFormat.maxInactivityDuration=600000&amp;amp;soTi&lt;br/&gt;
meout=10000&lt;br/&gt;
2007-12-13 08:46:40,955 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq.transport.WireFormatNegotiator&amp;#93;&lt;/span&gt; - ActiveMQ Task - Sending: WireFormatInfo { version=2, properties={CacheSize=1024, CacheEnabled=true, SizePrefixDisabled=false, TcpNoDelayEnabled=true, MaxInactivityDuration=600000, TightEncodingEnabled=true, StackTraceEnabled=true}
&lt;p&gt;, magic=&lt;span class=&quot;error&quot;&gt;&amp;#91;A,c,t,i,v,e,M,Q&amp;#93;&lt;/span&gt;}&lt;br/&gt;
2007-12-13 08:46:40,959 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq.transport.failover.FailoverTransport&amp;#93;&lt;/span&gt; - ActiveMQ Task - Connection established&lt;br/&gt;
2007-12-13 08:46:40,961 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq.transport.failover.FailoverTransport&amp;#93;&lt;/span&gt; - Thread-3 - Started.&lt;br/&gt;
2007-12-13 08:46:40,963 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;com.highergear.lead.jms.JMSFactoryConnectionUtil&amp;#93;&lt;/span&gt; - Thread-3 - Created Connection&lt;br/&gt;
2007-12-13 08:46:40,999 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq.transport.WireFormatNegotiator&amp;#93;&lt;/span&gt; - ActiveMQ Transport: tcp:///**&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;:&lt;/b&gt;** - Received WireFormat: WireFormatInfo { version=2, properties=&lt;/p&gt;
{Cache
Size=1024, CacheEnabled=true, SizePrefixDisabled=false, TcpNoDelayEnabled=false, MaxInactivityDuration=600000, TightEncodingEnabled=false, StackTraceEnabled=true}
&lt;p&gt;, magic=&lt;span class=&quot;error&quot;&gt;&amp;#91;A,c,t,i,v,e,M,Q&amp;#93;&lt;/span&gt;}&lt;br/&gt;
2007-12-13 08:46:41,001 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq.transport.WireFormatNegotiator&amp;#93;&lt;/span&gt; - ActiveMQ Transport: tcp:///**&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;:&lt;/b&gt;** - tcp:///**&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;:&lt;/b&gt;** before negotiation: OpenWireFormat&lt;/p&gt;
{version
=2, cacheEnabled=false, stackTraceEnabled=false, tightEncodingEnabled=false, sizePrefixDisabled=false}
&lt;p&gt;2007-12-13 08:46:41,001 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.activemq.transport.WireFormatNegotiator&amp;#93;&lt;/span&gt; - ActiveMQ Transport: tcp:///**&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;:&lt;/b&gt;** - tcp:///**&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;.&lt;/b&gt;*&lt;b&gt;:&lt;/b&gt;** after negotiation: OpenWireFormat&lt;/p&gt;
{version=
2, cacheEnabled=true, stackTraceEnabled=true, tightEncodingEnabled=false, sizePrefixDisabled=false}
&lt;p&gt;2007-12-13 08:46:41,158 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;com.highergear.lead.jms.JMSFactoryConnectionUtil&amp;#93;&lt;/span&gt; - Thread-3 - Started Connection&lt;/p&gt;

&lt;p&gt;The WireFormatNegotiation is not completing and no timeout occurs that allows the client to recognize the connection is bad.&lt;/p&gt;</comment>
                            <comment id="12940560" author="robbugh@earthlink.net" created="Wed, 17 Dec 2008 20:01:29 +0000"  >&lt;p&gt;I&apos;m seeing this issue in 4.1.1 as well. Looking at the code I don&apos;t see the 15 sec. timeout mentioned in the JIRA.&lt;/p&gt;</comment>
                            <comment id="12940800" author="robbugh@earthlink.net" created="Mon, 16 Feb 2009 19:58:49 +0000"  >&lt;p&gt;What is the status of this issue? Has the fix been rolled into a release yet? --Rob&lt;/p&gt;</comment>
                            <comment id="12940581" author="robbugh@earthlink.net" created="Tue, 17 Feb 2009 23:17:56 +0000"  >&lt;p&gt;OK, the first comment answered my question. Fixed in  418497.&lt;/p&gt;
</comment>
                            <comment id="12940603" author="robbugh@earthlink.net" created="Tue, 17 Feb 2009 23:18:21 +0000"  >&lt;p&gt;Already fixed&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12481758">AMQ-768</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>84329</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 41 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1805r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>254828</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>