<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:46:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-2568] Embedded broker not shutting down cleanly because of lingering threads</title>
                <link>https://issues.apache.org/jira/browse/AMQ-2568</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;See also this thread: &lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/activemq-users/201001.mbox/%3C4E50CAAD-0600-46FB-B5D0-B623C21A362D@gmail.com%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mail-archives.apache.org/mod_mbox/activemq-users/201001.mbox/%3C4E50CAAD-0600-46FB-B5D0-B623C21A362D@gmail.com%3E&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;See also this bug: &lt;a href=&quot;http://issues.apache.org/activemq/browse/AMQ-1214&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://issues.apache.org/activemq/browse/AMQ-1214&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;========================&lt;/p&gt;

&lt;p&gt;we have a 5.3.0 embedded broker that refuses to shutdown cleanly because of lingering threads. A long time (dozens of seconds) after broker stop() is called,  these threads are still active:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;ActiveMQ Scheduler&amp;#93;&lt;/span&gt; (Daemon) Group: main&lt;/li&gt;
	&lt;li&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Timer-0&amp;#93;&lt;/span&gt; (Daemon) Group: main&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;We discovered that &lt;span class=&quot;error&quot;&gt;&amp;#91;ActiveMQ Scheduler&amp;#93;&lt;/span&gt; can be closed adding this snippet to our code:&lt;/p&gt;

&lt;p&gt;Scheduler scheduler = Scheduler.getInstance();&lt;br/&gt;
scheduler.shutdown();&lt;/p&gt;

&lt;p&gt;After doing this the other lingering thread &amp;#8211; &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;Timer-0&amp;#93;&lt;/span&gt;&quot; &amp;#8211; did not go away, but at least we discovered that this timer is JMX related: if we disable JMX connector the timer disappear.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows&lt;/p&gt;</environment>
        <key id="12483264">AMQ-2568</key>
            <summary>Embedded broker not shutting down cleanly because of lingering threads</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rajdavies">Robert Davies</assignee>
                                    <reporter username="fredmoore">Fred Moore</reporter>
                        <labels>
                    </labels>
                <created>Thu, 14 Jan 2010 15:35:07 +0000</created>
                <updated>Fri, 21 May 2010 02:20:22 +0000</updated>
                            <resolved>Thu, 20 May 2010 12:03:02 +0000</resolved>
                                    <version>5.3.0</version>
                                    <fixVersion>5.4.0</fixVersion>
                                    <component>Broker</component>
                    <component>JMX</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12942011" author="rajdavies" created="Fri, 15 Jan 2010 19:59:39 +0000"  >&lt;p&gt;There are a lot of references to the Scheuler - safer to defer this to 6.0&lt;/p&gt;</comment>
                            <comment id="12942709" author="rajdavies" created="Thu, 20 May 2010 12:03:02 +0000"  >&lt;p&gt;Fixed by SVN revision 946600&lt;/p&gt;</comment>
                            <comment id="12942716" author="candy.chiu.ad" created="Fri, 21 May 2010 02:20:22 +0000"  >&lt;p&gt;Is this related to the &quot;ActiveMQ Data File Writer&quot; thread not being cleaned up?  This thread is keeping the Java VM from exiting even after I called Scheduler.getInstance().shutdown().&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>74889</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 27 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0rqgn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>159931</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>