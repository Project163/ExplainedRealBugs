<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:01:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-4375] JoramJmsTest UnifiedSessionTest and TopicConnectionTest hang when run with SSL, or on windows.</title>
                <link>https://issues.apache.org/jira/browse/AMQ-4375</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;This test suite results in a hang when run on windows.  I&apos;ll attach a patch which excludes it on Windows for now.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows 7 and Windows 2008 Server&lt;/p&gt;</environment>
        <key id="12637206">AMQ-4375</key>
            <summary>JoramJmsTest UnifiedSessionTest and TopicConnectionTest hang when run with SSL, or on windows.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="kearls">Kevin Anthony Earls</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 Mar 2013 14:32:03 +0000</created>
                <updated>Thu, 2 Apr 2015 23:02:12 +0000</updated>
                            <resolved>Thu, 2 Apr 2015 23:02:11 +0000</resolved>
                                                                    <component>Test Cases</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13603631" author="kearls" created="Fri, 15 Mar 2013 18:19:02 +0000"  >&lt;p&gt;I thought I had a working patch, but no such luck.  I&apos;ll spend some more time on it next week and submit a patch once I get something working.&lt;/p&gt;</comment>
                            <comment id="13608171" author="kearls" created="Wed, 20 Mar 2013 20:44:01 +0000"  >&lt;p&gt;Still working on this, but now it looks like this test sometimes hangs on other platforms, including Mac, Solaris, and RHEL.&lt;/p&gt;</comment>
                            <comment id="13720813" author="kearls" created="Fri, 26 Jul 2013 14:07:28 +0000"  >&lt;p&gt;Stack trace&lt;/p&gt;</comment>
                            <comment id="13720814" author="kearls" created="Fri, 26 Jul 2013 14:07:40 +0000"  >&lt;p&gt;Stack trace attached from run with ampq+ssl&lt;/p&gt;</comment>
                            <comment id="13756035" author="kearls" created="Mon, 2 Sep 2013 12:17:28 +0000"  >&lt;p&gt;I don&apos;t think we can resolve this as long as we are using the QPID client, because starting a connection in QPID is not fully synchronous. connection.start() creates a org.apache.qpid.amqp_1_0.jms.impl.ConnectionImpl, which in turn creates a creates a org.apache.qpid.amqp_1_0.client.Connection. This Connection creates a ConnectionEndpoint in its constructor and then calls open() on that.&lt;/p&gt;

&lt;p&gt;ConnectionEndpoint.open() sends the open packet to the server. However, it doesn&apos;t wait for a response. It sets _state = ConnectionState.AWAITING_OPEN and returns. (The response from the server ends up getting handled by the thread named inputThread that Connection also creates in its constructor).&lt;/p&gt;

&lt;p&gt;This can create a short race condition, which doesn&apos;t matter most places. I think it&apos;s a problem here because it takes longer for the server to create a connection when using SSL, and the test cases in UnifiedSessionTests aren&apos;t really doing very much. For example, for testCreateDurableConnectionConsumerOnQueueConnection it creates a QueueConnection in setUp(), calls QueueConnection.createDurableConnectionConsumer() which immediately throws an IllegalStateException, and then hangs trying to close the QueueConnection in tearDown(). As far as I can tell the test ends up calling close() on the connection before it&apos;s finished opening, and the result is a deadlock.&lt;/p&gt;

&lt;p&gt;All of the tests pass if I add a short sleep to the setup to allow the connections to finish opening, but I don&apos;t think we can do that with the JoramJmsTests.&lt;/p&gt;</comment>
                            <comment id="13757593" author="kearls" created="Wed, 4 Sep 2013 09:26:47 +0000"  >&lt;p&gt;The same issue affects TopicConnectionTest, so I have closed &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-4654&quot; title=&quot;JoramJmsTest TopicConnectionTest hangs when run with amqp+ssl&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-4654&quot;&gt;&lt;del&gt;AMQ-4654&lt;/del&gt;&lt;/a&gt; as a duplicate.&lt;/p&gt;</comment>
                            <comment id="13758929" author="kearls" created="Thu, 5 Sep 2013 09:17:49 +0000"  >&lt;p&gt;This is also the root cause of &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-4641&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-4641&lt;/a&gt;, &quot;JoramJmsTest QueryBrowserTest fails when run with amqp+nio&quot;.  &lt;/p&gt;</comment>
                            <comment id="13781897" author="kearls" created="Mon, 30 Sep 2013 14:52:25 +0000"  >&lt;p&gt;This comments out UnifiedSessionTest from the JoramJmsNioTest suite, as it hangs on slower boxes.&lt;/p&gt;</comment>
                            <comment id="13782087" author="tabish121" created="Mon, 30 Sep 2013 18:34:31 +0000"  >&lt;p&gt;Applied for now to prevent CI builds from hanging. &lt;/p&gt;</comment>
                            <comment id="13815955" author="kearls" created="Thu, 7 Nov 2013 13:31:08 +0000"  >&lt;p&gt;This is now hanging in JoramJmsTests occasionally, so I will comment it out there too.&lt;/p&gt;</comment>
                            <comment id="14393675" author="tabish121" created="Thu, 2 Apr 2015 23:02:12 +0000"  >&lt;p&gt;This has not been happening with these tests enabled since switching to the new JMS AMQP client from QPid.  &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12660065">AMQ-4654</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12605905" name="AMQ-4375.patch" size="911" author="kearls" created="Mon, 30 Sep 2013 14:52:25 +0000"/>
                            <attachment id="12594401" name="UnifiedSessionTestWithSSL.txt" size="26979" author="kearls" created="Fri, 26 Jul 2013 14:07:28 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>317698</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 33 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ithr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>318039</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310080" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Regression</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10092"><![CDATA[Unit Test Broken]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>