<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:52:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-3576] ProducerBrokerExchange last producer sequenceId initialization needs runtime updates to deal with possible duplicate resends</title>
                <link>https://issues.apache.org/jira/browse/AMQ-3576</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Under load, a  buffered pending send can be replayed along with a failover replay (writeTimeFilter initiated) which can miss the audit b/c it won&apos;t have knowledge of the original send.&lt;br/&gt;
The dispatch decision is based on the current stored state at the time of reconnect with the expectation that the next message will not be duplicated. It seems under some load and tcp buffering conditions this is possible to get duplicate sends of new messages.&lt;/p&gt;
</description>
                <environment>&lt;p&gt;failover:(tcp://host:port?soWriteTimeout=500)?jms.useAsyncSend=true&amp;amp;trackMessages=true&lt;/p&gt;</environment>
        <key id="12529900">AMQ-3576</key>
            <summary>ProducerBrokerExchange last producer sequenceId initialization needs runtime updates to deal with possible duplicate resends</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gtully">Gary Tully</assignee>
                                    <reporter username="gtully">Gary Tully</reporter>
                        <labels>
                    </labels>
                <created>Wed, 2 Nov 2011 17:03:33 +0000</created>
                <updated>Tue, 27 Mar 2012 12:29:56 +0000</updated>
                            <resolved>Thu, 24 Nov 2011 17:05:23 +0000</resolved>
                                    <version>5.5.1</version>
                                    <fixVersion>5.6.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13142549" author="gtully" created="Wed, 2 Nov 2011 21:20:10 +0000"  >&lt;p&gt;Solution is to update the producerbrokerexchange sequence on each successful send so that it is aware of duplicates at any point in the message stream.&lt;/p&gt;</comment>
                            <comment id="13142550" author="gtully" created="Wed, 2 Nov 2011 21:20:40 +0000"  >&lt;p&gt;resolution in &lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;rev=1196804&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;rev=1196804&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13143283" author="gtully" created="Thu, 3 Nov 2011 16:25:52 +0000"  >&lt;p&gt;The network connector case needs some special treatment. In a network connector, a single producer resends messages from multiple original producers so a single audit does not make sense as it will depends on sequence order across producers, which is not probable.&lt;br/&gt;
The solution for network connector producers requires querying the persistence adapter before each send. This will place additional synchronization contention on the store so if duplicates are not a problem it can be disabled. There is a new boolean &lt;tt&gt;auditNetworkProducers&lt;/tt&gt; attribute on a TransportConnector that toggles the behavior. It defaults to &lt;del&gt;true&lt;/del&gt; false.&lt;/p&gt;

&lt;p&gt;Update in: &lt;a href=&quot;http://svn.apache.org/viewvc?rev=1197203&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1197203&amp;amp;view=rev&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13156757" author="gtully" created="Thu, 24 Nov 2011 15:30:03 +0000"  >&lt;p&gt;The default true for auditNetworkProducers needs more consideration. networkConnector audit is problematic for composite destinations and virtual topics and when conduit=false b/c the source broker generates the duplicates, independent of a producer.&lt;br/&gt;
When none of the above features are enabled, a vanilla network, the audit is valuable to catch the case where a reply is lost to a successful send.&lt;/p&gt;</comment>
                            <comment id="13156824" author="gtully" created="Thu, 24 Nov 2011 17:05:23 +0000"  >&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/viewvc?rev=1205930&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1205930&amp;amp;view=rev&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;default value for auditNetworkProducers=false such that networks with virtual topics and/or composite destinations do not regress.&lt;br/&gt;
Relevant test:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;mvn test -Dtest=SimpleNetworkTest,BrowseOverNetworkTest,TwoBrokerNetworkConnectorWildcardStaticallyIncludedDestinationTest,TwoBrokerVirtualDestDinamicallyIncludedDestTest,TwoBrokerQueueClientsReconnectTest&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="12520013">AMQ-3473</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12526165">AMQ-3525</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>215759</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ailr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>59287</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>