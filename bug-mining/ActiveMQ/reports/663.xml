<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:42:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-1380] ActiveIO does not close ControlFile </title>
                <link>https://issues.apache.org/jira/browse/AMQ-1380</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;The following exception is thrown from an ActiveMQ instance that is in Slave mode that causes it to crash.&lt;/p&gt;

&lt;p&gt;java.io.FileNotFoundException: **&lt;b&gt;/&lt;/b&gt;*****&lt;b&gt;/&lt;/b&gt;***&lt;b&gt;/&lt;/b&gt;******/journal/control.dat (Too many open files)&lt;br/&gt;
        at java.io.RandomAccessFile.open(Native Method)&lt;br/&gt;
        at java.io.RandomAccessFile.&amp;lt;init&amp;gt;(RandomAccessFile.java:212)&lt;br/&gt;
        at org.apache.activeio.journal.active.ControlFile.&amp;lt;init&amp;gt;(ControlFile.java:60)&lt;br/&gt;
        at org.apache.activeio.journal.active.LogFileManager.initialize(LogFileManager.java:119)&lt;br/&gt;
        at org.apache.activeio.journal.active.LogFileManager.&amp;lt;init&amp;gt;(LogFileManager.java:102)&lt;br/&gt;
        at org.apache.activeio.journal.active.JournalImpl.&amp;lt;init&amp;gt;(JournalImpl.java:101)&lt;br/&gt;
        at org.apache.activemq.store.DefaultPersistenceAdapterFactory.createJournal(DefaultPersistenceAdapterFactory.java:224)&lt;br/&gt;
        at org.apache.activemq.store.DefaultPersistenceAdapterFactory.getJournal(DefaultPersistenceAdapterFactory.java:132)&lt;br/&gt;
        at org.apache.activemq.store.DefaultPersistenceAdapterFactory.createPersistenceAdapter(DefaultPersistenceAdapterFactory.java:70)&lt;br/&gt;
        at org.apache.activemq.store.PersistenceAdapterFactoryBean.getObject(PersistenceAdapterFactoryBean.java:35)&lt;br/&gt;
        at org.springframework.beans.factory.support.AbstractBeanFactory.getObjectFromFactoryBean(AbstractBeanFactory.java:994)&lt;br/&gt;
        ... 41 more&lt;/p&gt;

&lt;p&gt;The problem is that each time ActiveIO checks to see if control.dat is locked it creates a new java.io.RandomAccessFile.  If the control.dat file is locked, it fails to close the RandomAccessFile.&lt;/p&gt;

&lt;p&gt;This exception always will be thrown from an instance in Shared-File-System Slave mode that continues to check the Journal file (which the Master has locked).  But the rate at which is is thrown depends on the maximum number of files the OS allows to be open.  You can check how many files are open with &apos;ulimit -a&apos;&lt;/p&gt;</description>
                <environment>&lt;p&gt;All&lt;/p&gt;</environment>
        <key id="12483018">AMQ-1380</key>
            <summary>ActiveIO does not close ControlFile </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dejanb">Dejan Bosanac</assignee>
                                    <reporter username="jpkutner">Joe Kutner</reporter>
                        <labels>
                    </labels>
                <created>Wed, 5 Sep 2007 16:15:40 +0000</created>
                <updated>Fri, 24 Jul 2009 08:33:57 +0000</updated>
                            <resolved>Fri, 24 Jul 2009 08:33:57 +0000</resolved>
                                    <version>4.1.1</version>
                                    <fixVersion>5.3.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>7</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="12939038" author="lauvigne" created="Tue, 11 Sep 2007 10:03:06 +0000"  >&lt;p&gt;I&apos;m having the same problem.&lt;/p&gt;

&lt;p&gt;This patch solve it.&lt;/p&gt;

&lt;p&gt;Could you add this issue at 4.1.2 RoadMap. &lt;/p&gt;

&lt;p&gt;Thanks Joe for this patch.&lt;/p&gt;</comment>
                            <comment id="12939304" author="palmsun" created="Mon, 28 Jan 2008 04:20:27 +0000"  >&lt;p&gt;This patch is still not part of ActiveMQ 5.0,  where slave file handle leaks are still an issue. I manually applied this patch and it fixed the problem. Why is this patch not part of 5.0? Running a master/slave (persistence based on journal file-system) using a conf file below, leads to the crash of the slave after a few hours, due to running out of open files. If you monitor the number of open files (lsof | wc -l), you&apos;ll see that the number of open files keeps increasing every 10 seconds. With this patch, this is no-longer a problem. Please include this patch in the release. Here is the conf file that I&apos;ve used for master/slave (the only difference is that the value of the IP address in the  broker name and the  transport connector)&lt;/p&gt;

&lt;p&gt;&amp;lt;beans&lt;br/&gt;
  xmlns=&quot;http://www.springframework.org/schema/beans&quot;&lt;br/&gt;
  xmlns:amq=&quot;http://activemq.org/config/1.0&quot;&lt;br/&gt;
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;br/&gt;
  xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans &lt;a href=&quot;http://www.springframework.org/schema/beans/spring-beans-2.0.xsd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.springframework.org/schema/beans/spring-beans-2.0.xsd&lt;/a&gt;&lt;br/&gt;
  &lt;a href=&quot;http://activemq.org/config/1.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.org/config/1.0&lt;/a&gt; &lt;a href=&quot;http://activemq.apache.org/schema/activemq-core.xsd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.apache.org/schema/activemq-core.xsd&lt;/a&gt;&lt;br/&gt;
  &lt;a href=&quot;http://activemq.apache.org/camel/schema/spring&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.apache.org/camel/schema/spring&lt;/a&gt; &lt;a href=&quot;http://activemq.apache.org/camel/schema/spring/camel-spring.xsd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.apache.org/camel/schema/spring/camel-spring.xsd&lt;/a&gt;&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;  &amp;lt;!-- Allows us to use system properties as variables in this configuration file --&amp;gt;&lt;br/&gt;
  &amp;lt;bean class=&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;  &amp;lt;broker xmlns=&quot;http://activemq.org/config/1.0&quot; brokerName=&quot;10.0.1.200&quot; useJmx=&quot;false&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;!-- The transport connectors ActiveMQ will listen to --&amp;gt;&lt;br/&gt;
    &amp;lt;transportConnectors&amp;gt;&lt;br/&gt;
       &amp;lt;transportConnector name=&quot;openwire&quot; uri=&quot;tcp://10.0.1.200:61616?trace=true&quot;/&amp;gt;&lt;br/&gt;
    &amp;lt;/transportConnectors&amp;gt;&lt;br/&gt;
	&amp;lt;persistenceAdapter&amp;gt;&lt;br/&gt;
	      &amp;lt;journaledJDBC dataDirectory=&quot;/Users/sjavey/amq-broker-data&quot;/&amp;gt;&lt;br/&gt;
	&amp;lt;/persistenceAdapter&amp;gt;&lt;/p&gt;

&lt;p&gt;  &amp;lt;/broker&amp;gt;&lt;/p&gt;

&lt;p&gt;  &amp;lt;!-- An embedded servlet engine for serving up the Admin console --&amp;gt;&lt;br/&gt;
  &amp;lt;jetty xmlns=&quot;http://mortbay.com/schemas/jetty/1.0&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;connectors&amp;gt;&lt;br/&gt;
      &amp;lt;nioConnector port=&quot;8161&quot; /&amp;gt;&lt;br/&gt;
    &amp;lt;/connectors&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;handlers&amp;gt;&lt;br/&gt;
      &amp;lt;webAppContext contextPath=&quot;/admin&quot; resourceBase=&quot;${activemq.base}/webapps/admin&quot; logUrlOnStart=&quot;true&quot; /&amp;gt;&lt;br/&gt;
    &amp;lt;/handlers&amp;gt;&lt;br/&gt;
  &amp;lt;/jetty&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;/beans&amp;gt;&lt;/p&gt;</comment>
                            <comment id="12939002" author="palmsun" created="Mon, 28 Jan 2008 06:04:57 +0000"  >&lt;p&gt;Why the activeio-core in ActiveMQ lib (activeio-core-3.1-SNAPSHOT.jar) is still labeled as SNAPSHOT? is this a bug in the build label? It is odd to have 5.0 as a released version but it still includes a SNAPSHOT jar. &lt;/p&gt;</comment>
                            <comment id="12939469" author="chirino" created="Wed, 9 Apr 2008 13:52:25 +0000"  >&lt;p&gt;Patch applied in rev 646352&lt;/p&gt;</comment>
                            <comment id="12940181" author="vadimos" created="Fri, 12 Sep 2008 00:14:56 +0000"  >&lt;p&gt;It does not look like the patch made it into activeio-core-3.1.0 which is included in 5.1.0&lt;/p&gt;</comment>
                            <comment id="12940445" author="dmiranda" created="Mon, 3 Nov 2008 13:54:27 +0000"  >&lt;p&gt;hello Friends!&lt;/p&gt;

&lt;p&gt;I&apos;d like to know how can I apply that patch? I&apos;ve tried to find a way, but I can&apos;t find out anything. &lt;/p&gt;

&lt;p&gt;can anybody give some help?&lt;/p&gt;

&lt;p&gt;Thank you!&lt;/p&gt;</comment>
                            <comment id="12941788" author="dejanb" created="Fri, 24 Jul 2009 08:33:57 +0000"  >&lt;p&gt;ActiveIO 3.1.2 has just been released with this patch included. It will be included by default in 5.3.0. For earlier versions, download the jar from &lt;a href=&quot;https://repository.apache.org/content/repositories/releases/org/apache/activemq/activeio-core/3.1.2/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/repositories/releases/org/apache/activemq/activeio-core/3.1.2/&lt;/a&gt; and put it in lib/optional folder.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12460809" name="ASF.LICENSE.NOT.GRANTED--patch.txt" size="1010" author="jpkutner" created="Wed, 5 Sep 2007 16:15:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>84544</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0s1c7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161693</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>