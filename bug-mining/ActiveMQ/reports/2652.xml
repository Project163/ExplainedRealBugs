<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:23:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-5994] Broker can&apos;t recover Durable Subscription on index deletion</title>
                <link>https://issues.apache.org/jira/browse/AMQ-5994</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;The broker is unable to recover a durable subscription when replaying the journal to rebuild the index, if the original index was deleted.  The problem is that when the index is recovered, any KahaSubscriptionCommand is ignored so the messages are never recovered because when the messages are replayed the subscriptions don&apos;t exist.&lt;/p&gt;

&lt;p&gt;I modified AMQ4212Test.java to demonstrate this issue and I have attached it.&lt;/p&gt;

&lt;p&gt;It looks like the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-4000&quot; title=&quot;Durable subscription not getting unregistered on networked broker&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-4000&quot;&gt;&lt;del&gt;AMQ-4000&lt;/del&gt;&lt;/a&gt; is what introduces this problem. &lt;/p&gt;

&lt;p&gt;The commit for that issue is is : &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;a=commit;h=0061f6f75538ede8fe3443925e64beb839abfb90&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;a=commit;h=0061f6f75538ede8fe3443925e64beb839abfb90&lt;/a&gt;&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12901886">AMQ-5994</key>
            <summary>Broker can&apos;t recover Durable Subscription on index deletion</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gtully">Gary Tully</assignee>
                                    <reporter username="cshannon">Christopher L. Shannon</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Oct 2015 13:12:00 +0000</created>
                <updated>Wed, 7 Oct 2015 16:53:03 +0000</updated>
                            <resolved>Tue, 6 Oct 2015 11:18:20 +0000</resolved>
                                    <version>5.12.0</version>
                                    <fixVersion>5.12.1</fixVersion>
                    <fixVersion>5.13.0</fixVersion>
                                    <component>Broker</component>
                    <component>KahaDB</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14939800" author="christopher.l.shannon" created="Thu, 1 Oct 2015 13:22:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;It looks like you had made the change for this and I don&apos;t want to back it out as it would cause a regression for &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-4000&quot; title=&quot;Durable subscription not getting unregistered on networked broker&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-4000&quot;&gt;&lt;del&gt;AMQ-4000&lt;/del&gt;&lt;/a&gt;.  However, I&apos;m not sure how else to recover the messages on a complete rebuild of the index if the KahaSubscriptionCommand is skipped at that point.&lt;/p&gt;</comment>
                            <comment id="14939991" author="gtully" created="Thu, 1 Oct 2015 15:42:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cshannon&quot; class=&quot;user-hover&quot; rel=&quot;cshannon&quot;&gt;cshannon&lt;/a&gt; thanks for the heads up. That does look like a problem. I will peek at it in the next day or so and figure out what the correct fix is.&lt;/p&gt;</comment>
                            <comment id="14943259" author="christopher.l.shannon" created="Mon, 5 Oct 2015 11:40:22 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;. I&apos;d like to back port this to 5.12.1 if there is a good solution for it.&lt;/p&gt;</comment>
                            <comment id="14944887" author="jira-bot" created="Tue, 6 Oct 2015 11:17:32 +0000"  >&lt;p&gt;Commit dc06c8dc7540233aad6722afe554c2ea505754e2 in activemq&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=dc06c8d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=dc06c8d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-5994&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-5994&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-4000&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-4000&lt;/a&gt; - proper fix for duplicate sub info from the store on recovery failure from AMQ2149Test. Additional test from Christopher L&lt;/p&gt;</comment>
                            <comment id="14944891" author="gtully" created="Tue, 6 Oct 2015 11:18:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cshannon&quot; class=&quot;user-hover&quot; rel=&quot;cshannon&quot;&gt;cshannon&lt;/a&gt; thanks for the test!&lt;/p&gt;</comment>
                            <comment id="14946738" author="jira-bot" created="Wed, 7 Oct 2015 12:02:58 +0000"  >&lt;p&gt;Commit 8ef31b91e6db5a10cebc79785f075649d8ba0a56 in activemq&apos;s branch refs/heads/activemq-5.12.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gtully&quot; class=&quot;user-hover&quot; rel=&quot;gtully&quot;&gt;gtully&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=8ef31b9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=activemq.git;h=8ef31b9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-5994&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-5994&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-4000&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AMQ-4000&lt;/a&gt; - proper fix for duplicate sub info from the store on recovery failure from AMQ2149Test. Additional test from Christopher L&lt;/p&gt;

&lt;p&gt;(cherry picked from commit dc06c8dc7540233aad6722afe554c2ea505754e2)&lt;/p&gt;</comment>
                            <comment id="14946741" author="christopher.l.shannon" created="Wed, 7 Oct 2015 12:03:33 +0000"  >&lt;p&gt;Thanks Gary, I went ahead and cherry picked the fix to 5.12.x as well.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12764599" name="SubscriptionRecoveryTest.java" size="13909" author="cshannon" created="Thu, 1 Oct 2015 13:12:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 6 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2mhzz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>