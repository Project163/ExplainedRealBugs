<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:59:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-6596] Out Of Memory error reported on ActiveMQ client during openwire unmarshalling</title>
                <link>https://issues.apache.org/jira/browse/AMQ-6596</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;ActiveMQ crashes during a vulnerability scanning using Qualys vulnerability scanner.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2017-02-10 14:30:18,631 [0.1:55345@61616] WARN  Transport                      - Transport Connection to: tcp:&lt;span class=&quot;code-comment&quot;&gt;//127.0.0.1:55345 failed: java.io.IOException: Unexpected error occurred: java.lang.OutOfMemoryError: Java heap space&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This OOM error is caused due to an attempt to initialize a huge byte array of 2131230728 bytes size. The problem still occurs even if we define the maxFrameSize to 100MB. &lt;/p&gt;


&lt;p&gt;It seems that the first comparison with the maxFrameSize is successful (method unmarshal) but in the later evaluation of dataIn.readInt() in method  looseUnmarshalByteSequence, a huge value is evaluated (2131230728 bytes)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; unmarshal(DataInput dis) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
        DataInput dataIn = dis;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!sizePrefixDisabled) {
            &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; size = dis.readInt();
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (size &amp;gt; maxFrameSize) {
                &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; IOExceptionSupport.createFrameSizeException(size, maxFrameSize);
            }
            &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; size = dis.readInt();
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] data = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[size];
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// dis.readFully(data);
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// bytesIn.restart(data);
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// dataIn = bytesIn;
&lt;/span&gt;        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; doUnmarshal(dataIn);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; ByteSequence looseUnmarshalByteSequence(DataInput dataIn) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
        ByteSequence rc = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (dataIn.readBoolean()) {
            &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; size = dataIn.readInt();
            &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] t = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[size];
            dataIn.readFully(t);
            rc = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ByteSequence(t, 0, size);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; rc;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Relevant parts of the thread dump can be found below:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;WARNING : OutOfMemoryError possibly caused by 2131230728 bytes requested &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; object of &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;081A5700 from memory space &lt;span class=&quot;code-quote&quot;&gt;&apos;Flat&apos;&lt;/span&gt; id=080B1898
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; Name
ActiveMQ Transport: tcp:&lt;span class=&quot;code-comment&quot;&gt;///10.4.240.10:55345@61616
&lt;/span&gt;State
&lt;span class=&quot;code-object&quot;&gt;Runnable&lt;/span&gt;
Java Stack
at org/apache/activemq/openwire/v12/BaseDataStreamMarshaller.looseUnmarshalByteSequence(BaseDataStreamMarshaller.java:638) 
at org/apache/activemq/openwire/v12/WireFormatInfoMarshaller.looseUnmarshal(WireFormatInfoMarshaller.java:132) 
at org/apache/activemq/openwire/OpenWireFormat.doUnmarshal(OpenWireFormat.java:367(Compiled Code)) 
at org/apache/activemq/openwire/OpenWireFormat.unmarshal(OpenWireFormat.java:278(Compiled Code)) 
at org/apache/activemq/transport/tcp/TcpTransport.readCommand(TcpTransport.java:240(Compiled Code)) 
at org/apache/activemq/transport/tcp/TcpTransport.doRun(TcpTransport.java:232(Compiled Code)) 
at org/apache/activemq/transport/tcp/TcpTransport.run(TcpTransport.java:215) 
at java/lang/&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:863)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;The definition of the transportConnector without the definition of the maxFrameSize is the following :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &amp;lt;transportConnectors&amp;gt;
            &amp;lt;transportConnector name=&lt;span class=&quot;code-quote&quot;&gt;&quot;openwire&quot;&lt;/span&gt; uri=&lt;span class=&quot;code-quote&quot;&gt;&quot;tcp:&lt;span class=&quot;code-comment&quot;&gt;//0.0.0.0:61616&quot;&lt;/span&gt;/&amp;gt;
&lt;/span&gt;        &amp;lt;/transportConnectors&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;The definition of the transportConnector after the definition of the maxFrameSize  :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; &amp;lt;transportConnectors&amp;gt;
      &amp;lt;transportConnector name=&lt;span class=&quot;code-quote&quot;&gt;&quot;openwire&quot;&lt;/span&gt; uri=&lt;span class=&quot;code-quote&quot;&gt;&quot;tcp:&lt;span class=&quot;code-comment&quot;&gt;//0.0.0.0:61616?wireFormat.maxFrameSize=104857600&quot;&lt;/span&gt;/&amp;gt;
&lt;/span&gt;    &amp;lt;/transportConnectors&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We have reproduced this with versions 5.13.0, 5.13.5 and 5.14.3 but this problem is probably related to other versions too.&lt;/p&gt;
</description>
                <environment>&lt;p&gt;SUSE Linux Enterprise Server 11 (x86_64), VERSION = 11, PATCHLEVEL = 3. Java Runtime: IBM Corporation 1.7.0 &lt;/p&gt;</environment>
        <key id="13042082">AMQ-6596</key>
            <summary>Out Of Memory error reported on ActiveMQ client during openwire unmarshalling</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cshannon">Christopher L. Shannon</assignee>
                                    <reporter username="kpistopoulos">KoPs</reporter>
                        <labels>
                    </labels>
                <created>Fri, 10 Feb 2017 14:48:27 +0000</created>
                <updated>Thu, 27 Feb 2025 23:58:29 +0000</updated>
                            <resolved>Tue, 25 Feb 2025 18:28:12 +0000</resolved>
                                    <version>5.13.0</version>
                    <version>5.13.5</version>
                    <version>5.14.3</version>
                                    <fixVersion>5.17.7</fixVersion>
                    <fixVersion>5.16.8</fixVersion>
                    <fixVersion>6.2.0</fixVersion>
                    <fixVersion>5.19.0</fixVersion>
                    <fixVersion>6.1.6</fixVersion>
                    <fixVersion>5.18.7</fixVersion>
                                    <component>Broker</component>
                    <component>JMS client</component>
                    <component>Transport</component>
                        <due></due>
                            <votes>5</votes>
                                    <watches>11</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="15861360" author="kpistopoulos" created="Fri, 10 Feb 2017 14:50:56 +0000"  >&lt;p&gt;Please find attached the packet that was responsible for this behavior (packet.raw)&lt;/p&gt;</comment>
                            <comment id="16080233" author="ruffp" created="Mon, 10 Jul 2017 12:08:57 +0000"  >&lt;p&gt;We noticed the same behavior by sending arbitrary data to the openwire port in our ActiveMQ 5.10.2.&lt;/p&gt;

&lt;p&gt;Not sure if this is related to the same bug, but executing the following bash script on the same machine:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;#!/bin/bash

&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; [ -t 0 ]; then stty -echo -icanon -icrnl time 0 min 0; fi

count=0
keypress=&apos;&apos;
&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; [ &lt;span class=&quot;code-quote&quot;&gt;&quot;x$keypress&quot;&lt;/span&gt; = &lt;span class=&quot;code-quote&quot;&gt;&quot;x&quot;&lt;/span&gt; ]; &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt;
  let count+=1
  echo -ne $count&lt;span class=&quot;code-quote&quot;&gt;&apos;\r&apos;&lt;/span&gt;
  keypress=&lt;span class=&quot;code-quote&quot;&gt;&quot;`cat -v`&quot;&lt;/span&gt;
  dd &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;=/dev/urandom bs=10000 count=120 &amp;gt; /dev/tcp/localhost/61616
done

&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; [ -t 0 ]; then stty sane; fi

echo &lt;span class=&quot;code-quote&quot;&gt;&quot;You pressed &lt;span class=&quot;code-quote&quot;&gt;&apos;$keypress&apos;&lt;/span&gt; after $count loop iterations&quot;&lt;/span&gt;
exit 0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;makes the OutOfMemoryError happens few times even the data are smaller (try with bs=100 instead).&lt;/p&gt;

&lt;p&gt;By executing this script on the latest ActiveMQ 5.14.5 I get the same results.&lt;/p&gt;

&lt;p&gt;Here&apos;s a extract of the logs:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;INFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55550 failed: java.io.IOException: Unknown data type: -11
INFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55551 failed: java.io.IOException: Frame size of 1611 MB larger than max allowed 100 MB
INFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55553 failed: java.io.IOException: Unknown data type: -46
INFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55552 failed: java.io.IOException: Frame size of 361 MB larger than max allowed 100 MB
INFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55555 failed: java.io.IOException: Frame size of 1271 MB larger than max allowed 100 MB
INFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55554 failed: java.io.UTFDataFormatException: malformed input around byte 0
INFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55557 failed: java.io.IOException: Unexpected error occured: java.lang.OutOfMemoryError: Java heap space
INFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:53624 failed: java.io.IOException: Frame size of 467 MB larger than max allowed 100 MB
INFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55556 failed: java.io.IOException: Frame size of 1382 MB larger than max allowed 100 MB
INFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55548 failed: java.io.EOFException
INFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55543 failed: java.io.IOException: Unknown data type: -110
INFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55539 failed: java.io.IOException: Unknown data type: -62
INFO   | jvm 1    | 2017/07/10 10:27:30 |  WARN | Transport Connection to: tcp://127.0.0.1:55542 failed: java.io.IOException: Unknown data type: -24
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When our vulnerabiliy scanner (I don&apos;t know which one it was) created such requests, our ActiveMQ has blocked unexpectedly.&lt;/p&gt;</comment>
                            <comment id="16080250" author="ruffp" created="Mon, 10 Jul 2017 12:25:24 +0000"  >&lt;p&gt;... and if I &quot;dd&quot; your packet.raw with:&lt;/p&gt;

&lt;p&gt;{{dd if=packet.raw &amp;gt; /dev/tcp/localhost/61616 }}&lt;/p&gt;

&lt;p&gt;I get the OOME everytime (Tested with AMQ 5.10.2).&lt;/p&gt;

&lt;p&gt;I think this is more an issue in OpenWire protocol than specific to ActiveMQ.&lt;/p&gt;</comment>
                            <comment id="16080332" author="christopher.l.shannon" created="Mon, 10 Jul 2017 13:37:59 +0000"  >&lt;p&gt;Try disabling the OpenWire caching and see if that helps.  You can set cacheEnabled to false to disable it as an option on the connection string.&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;http://activemq.apache.org/configuring-wire-formats.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.apache.org/configuring-wire-formats.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16081767" author="kpistopoulos" created="Tue, 11 Jul 2017 06:58:14 +0000"  >&lt;p&gt;I have tried to disable the OpenWire caching but it seems that the result is the same. You can find below the updated definition of the transportConnector:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &amp;lt;transportConnectors&amp;gt; 
      &amp;lt;transportConnector name=&lt;span class=&quot;code-quote&quot;&gt;&quot;openwire&quot;&lt;/span&gt; uri=&lt;span class=&quot;code-quote&quot;&gt;&quot;tcp:&lt;span class=&quot;code-comment&quot;&gt;//0.0.0.0:61616?cacheEnabled=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt; 
&lt;/span&gt;    &amp;lt;/transportConnectors&amp;gt; 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Relevant part of the logs:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2017-07-11 09:41:28,619 [0.1:38182@61616] WARN  Transport                      - Transport Connection to: tcp:&lt;span class=&quot;code-comment&quot;&gt;//127.0.0.1:38182 failed: java.io.IOException: Unexpected error occurred: java.lang.OutOfMemoryError: Java heap space
&lt;/span&gt;2017-07-11 09:41:30,279 [main           ] INFO  BrokerService                  - Apache ActiveMQ 5.13.0 (xxxxxxx, ID:xxxxxxx-45907-1499755256917-0:1) is shutting down
2017-07-11 09:41:30,292 [:&lt;span class=&quot;code-comment&quot;&gt;//xxxxxxx#1-3] ERROR TaskRunnerFactory              - Error in thread &lt;span class=&quot;code-quote&quot;&gt;&apos;ActiveMQ VMTransport: vm://xxxxxxx&apos;&lt;/span&gt;
&lt;/span&gt;org.apache.activemq.broker.BrokerStoppedException: Broker BrokerService[xxxxxxx] is being stopped
        at org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:193)
        at org.apache.activemq.transport.ResponseCorrelator.onCommand(ResponseCorrelator.java:116)
        at org.apache.activemq.transport.MutexTransport.onCommand(MutexTransport.java:50)
        at org.apache.activemq.transport.vm.VMTransport.iterate(VMTransport.java:271)
        at org.apache.activemq.thread.PooledTaskRunner.runTask(PooledTaskRunner.java:133)
        at org.apache.activemq.thread.PooledTaskRunner$1.run(PooledTaskRunner.java:48)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1157)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:627)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:863)
2017-07-11 09:41:30,293 [main           ] WARN  Transport                      - Transport Connection to: vm:&lt;span class=&quot;code-comment&quot;&gt;//xxxxxxx failed: org.apache.activemq.transport.TransportDisposedIOException: peer (vm://xxxxxxx#0) stopped.
&lt;/span&gt;2017-07-11 09:41:30,300 [main           ] INFO  TransportConnector             - Connector vm:&lt;span class=&quot;code-comment&quot;&gt;//xxxxxxx stopped
&lt;/span&gt;2017-07-11 09:41:30,300 [main           ] INFO  DemandForwardingBridgeSupport  - localhost bridge to xxxxxxx stopped
2017-07-11 09:41:30,301 [main           ] INFO  NetworkConnector               - Network Connector DiscoveryNetworkConnector:Frontend1_xxxxxxx_61616:BrokerService[xxxxxxx] stopped
2017-07-11 09:41:30,325 [0.1:38179@61616] WARN  Transport                      - Transport Connection to: tcp:&lt;span class=&quot;code-comment&quot;&gt;//127.0.0.1:38179 failed: java.io.IOException: Unexpected error occurred: org.apache.activemq.broker.BrokerStoppedException: Broker BrokerService[xxxxxxx] is being stopped
&lt;/span&gt;2017-07-11 09:41:31,419 [main           ] INFO  TransportConnector             - Connector openwire stopped
2017-07-11 09:41:31,431 [main           ] INFO  BrokerService                  - Apache ActiveMQ 5.13.0 (xxxxxxx, ID:xxxxxxx-45907-1499755256917-0:1) uptime 34.535 seconds
2017-07-11 09:41:31,432 [main           ] INFO  BrokerService                  - Apache ActiveMQ 5.13.0 (xxxxxxx, ID:xxxxxxx-45907-1499755256917-0:1) is shutdown
2017-07-11 09:41:31,434 [&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-5       ] INFO  LogLog                         - Shutting down logging and log4j subsystem
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16082114" author="christopher.l.shannon" created="Tue, 11 Jul 2017 12:02:03 +0000"  >&lt;p&gt;I think you have to use wireFormat.cacheEnabled&lt;/p&gt;

&lt;p&gt;So it would be:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; &amp;lt;transportConnectors&amp;gt; 
      &amp;lt;transportConnector name=&quot;openwire&quot; uri=&quot;tcp://0.0.0.0:61616?wireFormat.cacheEnabled=false&quot;/&amp;gt; 
    &amp;lt;/transportConnectors&amp;gt; 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This may not fix your issue but it is worth a shot as sometimes when I have seen issues with Openwire marshalling it has been related to the cache and disabling fixed it.&lt;/p&gt;</comment>
                            <comment id="16082164" author="kpistopoulos" created="Tue, 11 Jul 2017 13:01:27 +0000"  >&lt;p&gt;Yes you are right, I forgot to use the  &quot;wireFormat&quot;  prefix . Unfortunately I still receive the same error.&lt;/p&gt;</comment>
                            <comment id="17032287" author="alukard" created="Fri, 7 Feb 2020 10:43:05 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I face same issue and I think problem is quite&#160;obvious.&lt;/p&gt;

&lt;p&gt;To check size we are reading first int from stream but to create buffer we are reading next int.&lt;/p&gt;

&lt;p&gt;So if first int is below 100Mb but second if bigger you will create buffer bigger that your limit and you can get oom.&lt;/p&gt;</comment>
                            <comment id="17501253" author="JIRAUSER286140" created="Fri, 4 Mar 2022 10:41:08 +0000"  >&lt;p&gt;Facing same issue with version 5.16.4.&lt;/p&gt;</comment>
                            <comment id="17930409" author="jira-bot" created="Tue, 25 Feb 2025 18:08:11 +0000"  >&lt;p&gt;Commit 3037ce8b3b6a1efd67d273ad0bb6590c0434fad1 in activemq&apos;s branch refs/heads/main from Christopher L. Shannon&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=3037ce8b3b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=3037ce8b3b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6596&quot; title=&quot;Out Of Memory error reported on ActiveMQ client during openwire unmarshalling&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6596&quot;&gt;&lt;del&gt;AMQ-6596&lt;/del&gt;&lt;/a&gt; - Validate size of buffers during unmarshalling&lt;/p&gt;

&lt;p&gt;Verify that size buffers for arrays and bytesequences will not exceed&lt;br/&gt;
the overall frame size&lt;/p&gt;</comment>
                            <comment id="17930410" author="jira-bot" created="Tue, 25 Feb 2025 18:08:11 +0000"  >&lt;p&gt;Commit fc4372b9f0f72b8b5eed917f0019c5cea45c5d06 in activemq&apos;s branch refs/heads/main from Christopher L. Shannon&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=fc4372b9f0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=fc4372b9f0&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Merge pull request #1399 from cshannon/buffer-validation&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6596&quot; title=&quot;Out Of Memory error reported on ActiveMQ client during openwire unmarshalling&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6596&quot;&gt;&lt;del&gt;AMQ-6596&lt;/del&gt;&lt;/a&gt; - Validate size of buffers during unmarshalling&lt;/p&gt;</comment>
                            <comment id="17930411" author="jira-bot" created="Tue, 25 Feb 2025 18:19:31 +0000"  >&lt;p&gt;Commit 610cc9aca8a2d320f6ac66aa6cdc49dbb8b73471 in activemq&apos;s branch refs/heads/activemq-6.1.x from Christopher L. Shannon&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=610cc9aca8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=610cc9aca8&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6596&quot; title=&quot;Out Of Memory error reported on ActiveMQ client during openwire unmarshalling&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6596&quot;&gt;&lt;del&gt;AMQ-6596&lt;/del&gt;&lt;/a&gt; - Validate size of buffers during unmarshalling&lt;/p&gt;

&lt;p&gt;Verify that size buffers for arrays and bytesequences will not exceed&lt;br/&gt;
the overall frame size&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 3037ce8b3b6a1efd67d273ad0bb6590c0434fad1)&lt;/p&gt;</comment>
                            <comment id="17930412" author="jira-bot" created="Tue, 25 Feb 2025 18:28:04 +0000"  >&lt;p&gt;Commit 31c4d28ccaa5c88a15fc5fc876a4c6d6ddd5b719 in activemq&apos;s branch refs/heads/activemq-5.19.x from Christopher L. Shannon&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=31c4d28cca&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=31c4d28cca&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6596&quot; title=&quot;Out Of Memory error reported on ActiveMQ client during openwire unmarshalling&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6596&quot;&gt;&lt;del&gt;AMQ-6596&lt;/del&gt;&lt;/a&gt; - Validate size of buffers during unmarshalling&lt;/p&gt;

&lt;p&gt;Verify that size buffers for arrays and bytesequences will not exceed&lt;br/&gt;
the overall frame size&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 3037ce8b3b6a1efd67d273ad0bb6590c0434fad1)&lt;/p&gt;</comment>
                            <comment id="17931177" author="jira-bot" created="Thu, 27 Feb 2025 14:10:29 +0000"  >&lt;p&gt;Commit ff6dc101695b83d507be507b380e00c866e76bf6 in activemq&apos;s branch refs/heads/main from Christopher L. Shannon&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=ff6dc10169&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=ff6dc10169&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6596&quot; title=&quot;Out Of Memory error reported on ActiveMQ client during openwire unmarshalling&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6596&quot;&gt;&lt;del&gt;AMQ-6596&lt;/del&gt;&lt;/a&gt; - Add license to test&lt;/p&gt;</comment>
                            <comment id="17931178" author="jira-bot" created="Thu, 27 Feb 2025 14:11:32 +0000"  >&lt;p&gt;Commit 97d7e4c47811d8bcbe0b3d5a2a36a0aeda4aa2d8 in activemq&apos;s branch refs/heads/activemq-6.1.x from Christopher L. Shannon&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=97d7e4c478&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=97d7e4c478&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6596&quot; title=&quot;Out Of Memory error reported on ActiveMQ client during openwire unmarshalling&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6596&quot;&gt;&lt;del&gt;AMQ-6596&lt;/del&gt;&lt;/a&gt; - Add license to test&lt;/p&gt;

&lt;p&gt;(cherry picked from commit ff6dc101695b83d507be507b380e00c866e76bf6)&lt;/p&gt;</comment>
                            <comment id="17931179" author="jira-bot" created="Thu, 27 Feb 2025 14:12:22 +0000"  >&lt;p&gt;Commit 3fd9f41f47bef98f366690633caae93d306b4d69 in activemq&apos;s branch refs/heads/activemq-5.19.x from Christopher L. Shannon&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=3fd9f41f47&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=3fd9f41f47&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6596&quot; title=&quot;Out Of Memory error reported on ActiveMQ client during openwire unmarshalling&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6596&quot;&gt;&lt;del&gt;AMQ-6596&lt;/del&gt;&lt;/a&gt; - Add license to test&lt;/p&gt;

&lt;p&gt;(cherry picked from commit ff6dc101695b83d507be507b380e00c866e76bf6)&lt;/p&gt;</comment>
                            <comment id="17931329" author="jira-bot" created="Thu, 27 Feb 2025 23:23:10 +0000"  >&lt;p&gt;Commit 3b3a3b2023ac811f27e9219adff2010e34c85cd5 in activemq&apos;s branch refs/heads/activemq-5.18.x from Christopher L. Shannon&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=3b3a3b2023&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=3b3a3b2023&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6596&quot; title=&quot;Out Of Memory error reported on ActiveMQ client during openwire unmarshalling&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6596&quot;&gt;&lt;del&gt;AMQ-6596&lt;/del&gt;&lt;/a&gt; - Validate size of buffers during unmarshalling&lt;/p&gt;

&lt;p&gt;Verify that size buffers for arrays and bytesequences will not exceed&lt;br/&gt;
the overall frame size&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 3037ce8b3b6a1efd67d273ad0bb6590c0434fad1)&lt;br/&gt;
(cherry picked from commit 31c4d28ccaa5c88a15fc5fc876a4c6d6ddd5b719)&lt;/p&gt;</comment>
                            <comment id="17931330" author="jira-bot" created="Thu, 27 Feb 2025 23:23:10 +0000"  >&lt;p&gt;Commit 7781d01fc6ddcea6f643e1e8c9c44009ac4f130f in activemq&apos;s branch refs/heads/activemq-5.18.x from Christopher L. Shannon&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=7781d01fc6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=7781d01fc6&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6596&quot; title=&quot;Out Of Memory error reported on ActiveMQ client during openwire unmarshalling&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6596&quot;&gt;&lt;del&gt;AMQ-6596&lt;/del&gt;&lt;/a&gt; - Add license to test&lt;/p&gt;

&lt;p&gt;(cherry picked from commit ff6dc101695b83d507be507b380e00c866e76bf6)&lt;br/&gt;
(cherry picked from commit 3fd9f41f47bef98f366690633caae93d306b4d69)&lt;/p&gt;</comment>
                            <comment id="17931332" author="jira-bot" created="Thu, 27 Feb 2025 23:30:42 +0000"  >&lt;p&gt;Commit 8abfa8f59d3e1b3d255917204e6c73b0d2ec48c8 in activemq&apos;s branch refs/heads/activemq-5.17.x from Christopher L. Shannon&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=8abfa8f59d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=8abfa8f59d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6596&quot; title=&quot;Out Of Memory error reported on ActiveMQ client during openwire unmarshalling&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6596&quot;&gt;&lt;del&gt;AMQ-6596&lt;/del&gt;&lt;/a&gt; - Validate size of buffers during unmarshalling&lt;/p&gt;

&lt;p&gt;Verify that size buffers for arrays and bytesequences will not exceed&lt;br/&gt;
the overall frame size&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 3037ce8b3b6a1efd67d273ad0bb6590c0434fad1)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit ff6dc101695b83d507be507b380e00c866e76bf6)&lt;/p&gt;</comment>
                            <comment id="17931333" author="jira-bot" created="Thu, 27 Feb 2025 23:55:34 +0000"  >&lt;p&gt;Commit b0205f92bae6c227f5623616bfb74a079641e9b2 in activemq&apos;s branch refs/heads/activemq-5.16.x from Christopher L. Shannon&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=activemq.git;h=b0205f92ba&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=activemq.git;h=b0205f92ba&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AMQ-6596&quot; title=&quot;Out Of Memory error reported on ActiveMQ client during openwire unmarshalling&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AMQ-6596&quot;&gt;&lt;del&gt;AMQ-6596&lt;/del&gt;&lt;/a&gt; - Validate size of buffers during unmarshalling&lt;/p&gt;

&lt;p&gt;Verify that size buffers for arrays and bytesequences will not exceed&lt;br/&gt;
the overall frame size&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 3037ce8b3b6a1efd67d273ad0bb6590c0434fad1)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit ff6dc101695b83d507be507b380e00c866e76bf6)&lt;br/&gt;
(cherry picked from commit 8abfa8f59d3e1b3d255917204e6c73b0d2ec48c8)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12852061" name="packet.raw" size="200" author="kpistopoulos" created="Fri, 10 Feb 2017 14:50:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            36 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i39wuf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>