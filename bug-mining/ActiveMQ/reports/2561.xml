<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 06:10:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-5733] kill -9 always results in failure signal</title>
                <link>https://issues.apache.org/jira/browse/AMQ-5733</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;Using &lt;a href=&quot;https://github.com/rgevaert/activemq2deb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/rgevaert/activemq2deb&lt;/a&gt; I am trying to distribute upgrades to our fleet. This results in failure each time.&lt;/p&gt;

&lt;p&gt;Looking into the matter the activemq script tries to stop the broker via JMX. This is not configured, so fails.&lt;/p&gt;

&lt;p&gt;It falls back to issuing &quot;kill -9 &amp;lt;PID&amp;gt;&quot; then immediately exits with code 1. This code 1 causes the packaging script to bail and thus we end up with a mess.&lt;/p&gt;

&lt;p&gt;A possible solution is to return the &quot;kill&quot; command&apos;s own result. This doesn&apos;t necessarily reflect whether &quot;kill&quot; succeeded in terminating the PID however.&lt;/p&gt;

&lt;p&gt;A second possible solution is to detect the presence of &apos;start-stop-daemon&apos; and use this in preference. Narrows down the cases in which it does not work at least.&lt;/p&gt;

&lt;p&gt;I am of the opinion that a script aiming of cross-platform compatibility is probably never going to work completely so detecting and making use of per-system tooling is probably best long term, meantime would returning &quot;kill&apos;s&quot; exit code help?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12822345">AMQ-5733</key>
            <summary>kill -9 always results in failure signal</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10101">Abandoned</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jmkgreen">James Green</reporter>
                        <labels>
                    </labels>
                <created>Mon, 20 Apr 2015 15:12:09 +0000</created>
                <updated>Sun, 13 Mar 2022 14:16:09 +0000</updated>
                            <resolved>Sun, 13 Mar 2022 14:16:09 +0000</resolved>
                                    <version>5.11.1</version>
                                                    <component>Distribution</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14503023" author="jmkgreen" created="Mon, 20 Apr 2015 15:24:10 +0000"  >&lt;p&gt;Also, after using kill we do not erase the PID file. This results in the newly installed package being unable to start as the file already exists.&lt;/p&gt;</comment>
                            <comment id="14504276" author="scoopex" created="Tue, 21 Apr 2015 04:00:55 +0000"  >&lt;p&gt;@James Green: i reviewed your problem and i agree&lt;/p&gt;

&lt;p&gt;My intention was that a termination by &quot;SIGKILL&quot; should be something abnormal because the broker should shutdown in regular way.&lt;br/&gt;
SIGKILL does not provide the possibility to run shutdown logic (shutdown hook)  for activemq - you should really consider to shutdown activemq by jmx.&lt;/p&gt;

&lt;p&gt;Nevertheless according to LSB (&lt;a href=&quot;http://refspecs.linuxbase.org/LSB_3.1.0/LSB-Core-generic/LSB-Core-generic/iniscrptact.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://refspecs.linuxbase.org/LSB_3.1.0/LSB-Core-generic/LSB-Core-generic/iniscrptact.html&lt;/a&gt;) the exit code should be 0 if activemq is really not running after running &quot;/etc/init.d/activemq stop&quot;. &lt;br/&gt;
I changed this and appended it to merge request &lt;a href=&quot;https://github.com/apache/activemq/pull/61&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/activemq/pull/61&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="14504480" author="jmkgreen" created="Tue, 21 Apr 2015 07:13:48 +0000"  >&lt;p&gt;Briefly reading &lt;a href=&quot;http://stackoverflow.com/questions/191215/how-to-stop-java-process-gracefully&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/191215/how-to-stop-java-process-gracefully&lt;/a&gt; and &lt;a href=&quot;https://major.io/2010/03/18/sigterm-vs-sigkill/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://major.io/2010/03/18/sigterm-vs-sigkill/&lt;/a&gt; perhaps it should follow the follow the following strategy:&lt;/p&gt;

&lt;p&gt;1. Attempt to send shutdown via JMX (a lot of people do not enable JMX or have it misconfigured)&lt;br/&gt;
2. Attempt to kill &amp;lt;PID&amp;gt; allowing a JVM shutdown hook to gracefully bring down the process&lt;br/&gt;
3. Terminate forcefully with kill -9 &amp;lt;PID&amp;gt;&lt;/p&gt;

&lt;p&gt;In each case poll for the presence of the PID in the process list, and if it goes ensure the PID file is removed.&lt;/p&gt;
</comment>
                            <comment id="14508523" author="scoopex" created="Thu, 23 Apr 2015 06:13:08 +0000"  >&lt;p&gt;Attempting a shutdown by JMX and and SIGTERM (8) seems to be redundant for me. Both methods seem to do the same thing.&lt;br/&gt;
Probably it might be a option to do a fallback from JMX to SIGTERM if there is no configuration for JMX?&lt;/p&gt;</comment>
                            <comment id="17505802" author="christopher.l.shannon" created="Sun, 13 Mar 2022 14:16:09 +0000"  >&lt;p&gt;closing issues not updated in more than 5 years as abandoned&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12764778">AMQ-5503</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 35 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2dhe7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>