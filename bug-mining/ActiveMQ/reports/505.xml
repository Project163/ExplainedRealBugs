<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:39:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-2033] Deadlock on producerWindow.waitForSpace() in ActiveMQMessageProducer</title>
                <link>https://issues.apache.org/jira/browse/AMQ-2033</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;It seems, that producer throttling with producerWindow enabled doesn&apos;t work at all. I&apos;m attaching unit test for this. After sending about ~80msg producer stops and never resumes sending. &lt;br/&gt;
The problem is that producerWindow is not started ActiveMQMessageProducer. There must be something like this:&lt;br/&gt;
producerWindow.start();&lt;br/&gt;
I&apos;m also attaching patch for this bug&lt;/p&gt;</description>
                <environment></environment>
        <key id="12482736">AMQ-2033</key>
            <summary>Deadlock on producerWindow.waitForSpace() in ActiveMQMessageProducer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gtully">Gary Tully</assignee>
                                    <reporter username="jurna">Danielius Jurna</reporter>
                        <labels>
                    </labels>
                <created>Mon, 15 Dec 2008 08:26:34 +0000</created>
                <updated>Mon, 29 Dec 2008 11:26:26 +0000</updated>
                            <resolved>Mon, 29 Dec 2008 11:26:26 +0000</resolved>
                                    <version>5.2.0</version>
                                    <fixVersion>5.3.0</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12940584" author="gtully" created="Mon, 15 Dec 2008 20:12:30 +0000"  >&lt;p&gt;This looks like a good catch.&lt;br/&gt;
w.r.t the test case you mentioned, do you also have a patch for the ProducerFlowControlTest. The ProducerFlowControlTest.java attachment is the same as the current trunk revision.&lt;/p&gt;</comment>
                            <comment id="12939664" author="jurna" created="Tue, 16 Dec 2008 09:04:05 +0000"  >&lt;p&gt;Sorry, here is the patch for ProducerFlowControlTest&lt;/p&gt;</comment>
                            <comment id="12940562" author="gtully" created="Wed, 17 Dec 2008 12:01:43 +0000"  >&lt;p&gt;patch applied in r727353. Thanks for the fix and the test case,&lt;/p&gt;</comment>
                            <comment id="12940606" author="jurna" created="Tue, 23 Dec 2008 17:26:55 +0000"  >&lt;p&gt;Now with this patch, there is one thread for every producer created. On heavy systems, there are big amount of threads created (hundreds) and waiting, because every producerWindow has it&apos;s own thread executor. I thing they should reuse session thread pool or smth. Should I create new issue for this?&lt;/p&gt;</comment>
                            <comment id="12940615" author="jurna" created="Wed, 24 Dec 2008 06:25:35 +0000"  >&lt;p&gt;Updated&lt;/p&gt;</comment>
                            <comment id="12940624" author="jurna" created="Wed, 24 Dec 2008 06:27:24 +0000"  >&lt;p&gt;Patch wich includes producer window stop&lt;/p&gt;</comment>
                            <comment id="12940616" author="jurna" created="Wed, 24 Dec 2008 06:29:04 +0000"  >&lt;p&gt;Now prducer has thread leak, because it doesn&apos;t close producerWindow on producer close. I&apos;ve attached patch, which closes the producer window (this patch includes both fixes).&lt;/p&gt;</comment>
                            <comment id="12940607" author="gtully" created="Mon, 29 Dec 2008 11:26:26 +0000"  >&lt;p&gt;I added a close to the original commit so the close (same as your second patch) is currently on trunk: see the &lt;a href=&quot;http://svn.apache.org/viewvc/activemq/trunk/activemq-core/src/main/java/org/apache/activemq/ActiveMQMessageProducer.java?p2=%2Factivemq%2Ftrunk%2Factivemq-core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2FActiveMQMessageProducer.java&amp;amp;p1=%2Factivemq%2Ftrunk%2Factivemq-core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2FActiveMQMessageProducer.java&amp;amp;r1=727353&amp;amp;r2=727352&amp;amp;view=diff&amp;amp;pathrev=727353&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;diff&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Re the thread usage, and thread per producer. Please open another issue for that as SystemUsage may need a little refactor to obtain a thread pool or executor reference.&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12461294" name="ProducerFlowControlTest.java" size="10056" author="jurna" created="Mon, 15 Dec 2008 08:28:10 +0000"/>
                            <attachment id="12461269" name="ProducerFlowControlTest.patch" size="2273" author="jurna" created="Tue, 16 Dec 2008 09:02:33 +0000"/>
                            <attachment id="12461241" name="producer.patch" size="850" author="jurna" created="Wed, 24 Dec 2008 06:27:24 +0000"/>
                            <attachment id="12461347" name="producer.patch" size="680" author="jurna" created="Mon, 15 Dec 2008 08:27:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38768</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 48 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0s0c7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161531</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>