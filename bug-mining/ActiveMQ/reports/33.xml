<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:30:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[AMQ-600] Broker will not release a persistant clientId if a network connection is broken then restored at the TCP layer from a remote client</title>
                <link>https://issues.apache.org/jira/browse/AMQ-600</link>
                <project id="12311210" key="AMQ">ActiveMQ Classic</project>
                    <description>&lt;p&gt;During long-term operation, a remote, publish-only client with a TCP socket connection to the JMS broker will occasionally be disconnected at a low level (i.e. below the application level where JMS runs).  When this occurs, the JMS broker throws an exception indicating a broken socket, but does not release the clientID of the client to allow for reconnects.  The following stack traces should demonstrate this failure mode:&lt;/p&gt;

&lt;p&gt; INFO  Service                        - Async error occurred: java.net.SocketException: Connection reset&lt;br/&gt;
java.net.SocketException: Connection reset&lt;br/&gt;
        at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:96)&lt;br/&gt;
        at java.net.SocketOutputStream.write(SocketOutputStream.java:136)&lt;br/&gt;
        at org.apache.activemq.transport.tcp.TcpBufferedOutputStream.flush(TcpBufferedOutputStream.java:108)&lt;br/&gt;
        at java.io.DataOutputStream.flush(DataOutputStream.java:106)&lt;br/&gt;
        at org.apache.activemq.transport.tcp.TcpTransport.oneway(TcpTransport.java:118)&lt;br/&gt;
        at org.apache.activemq.transport.TransportFilter.oneway(TransportFilter.java:90)&lt;br/&gt;
        at org.apache.activemq.transport.WireFormatNegotiator.oneway(WireFormatNegotiator.java:65)&lt;br/&gt;
        at org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:44)&lt;br/&gt;
        at org.apache.activemq.transport.ResponseCorrelator.oneway(ResponseCorrelator.java:54)&lt;br/&gt;
        at org.apache.activemq.broker.TransportConnection.dispatch(TransportConnection.java:212)&lt;br/&gt;
        at org.apache.activemq.broker.AbstractConnection.dispatchSync(AbstractConnection.java:517)&lt;br/&gt;
        at org.apache.activemq.broker.AbstractConnection.dispatchAsync(AbstractConnection.java:535)&lt;br/&gt;
        at org.apache.activemq.broker.region.TopicSubscription.dispatch(TopicSubscription.java:142)&lt;br/&gt;
        at org.apache.activemq.broker.region.TopicSubscription.add(TopicSubscription.java:54)&lt;br/&gt;
        at org.apache.activemq.broker.region.policy.SimpleDispatchPolicy.dispatch(SimpleDispatchPolicy.java:50)&lt;br/&gt;
        at org.apache.activemq.broker.region.Topic.dispatch(Topic.java:365)&lt;br/&gt;
        at org.apache.activemq.broker.region.Topic.send(Topic.java:247)&lt;br/&gt;
        at org.apache.activemq.broker.region.AbstractRegion.send(AbstractRegion.java:195)&lt;br/&gt;
        at org.apache.activemq.broker.region.RegionBroker.send(RegionBroker.java:312)&lt;br/&gt;
        at org.apache.activemq.broker.TransactionBroker.send(TransactionBroker.java:192)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.send(BrokerFilter.java:107)&lt;br/&gt;
        at org.apache.activemq.broker.CompositeDestinationBroker.send(CompositeDestinationBroker.java:97)&lt;br/&gt;
        at org.apache.activemq.broker.MutableBrokerFilter.send(MutableBrokerFilter.java:119)&lt;br/&gt;
        at org.apache.activemq.broker.AbstractConnection.processMessage(AbstractConnection.java:336)&lt;br/&gt;
        at org.apache.activemq.command.ActiveMQMessage.visit(ActiveMQMessage.java:508)&lt;br/&gt;
        at org.apache.activemq.broker.AbstractConnection.service(AbstractConnection.java:189)&lt;br/&gt;
        at org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:60)&lt;br/&gt;
        at org.apache.activemq.transport.ResponseCorrelator.onCommand(ResponseCorrelator.java:82)&lt;br/&gt;
        at org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:68)&lt;br/&gt;
        at org.apache.activemq.transport.WireFormatNegotiator.onCommand(WireFormatNegotiator.java:105)&lt;br/&gt;
        at org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:77)&lt;br/&gt;
        at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:136)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:595)&lt;br/&gt;
ACTIVEMQ_HOME: /opt/activemq&lt;br/&gt;
Loading message broker from: xbean:activemq.xml&lt;br/&gt;
INFO  BrokerService                  - ActiveMQ 4.0-M4 JMS Message Broker (localhost) is starting&lt;br/&gt;
INFO  BrokerService                  - For help or more information please see: &lt;a href=&quot;http://www.logicblaze.com&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.logicblaze.com&lt;/a&gt;&lt;br/&gt;
INFO  JDBCPersistenceAdapter         - Database driver recognized: &lt;span class=&quot;error&quot;&gt;&amp;#91;apache_derby_embedded_jdbc_driver&amp;#93;&lt;/span&gt;&lt;br/&gt;
INFO  JournalPersistenceAdapter      - Journal Recovery Started from: Active Journal: using 5 x 20.0 Megs at: ../activemq-data/journal&lt;br/&gt;
INFO  JournalPersistenceAdapter      - Journal Recovered: 0 message(s) in transactions recovered.&lt;br/&gt;
INFO  TransportServerThreadSupport   - Listening for connections at: tcp://s1:61616&lt;br/&gt;
INFO  TransportConnector             - Accepting connection on: tcp://s1:61616&lt;br/&gt;
WARN  MulticastDiscoveryAgent        - brokerName not set&lt;br/&gt;
INFO  TransportServerThreadSupport   - Listening for connections at: tcp://s1:61617?wireFormat=stomp&lt;br/&gt;
INFO  TransportConnector             - Accepting connection on: tcp://s1:61617?wireFormat=stomp&lt;br/&gt;
INFO  BrokerService                  - ActiveMQ JMS Message Broker (localhost) started&lt;br/&gt;
INFO  NetworkConnector               - Establishing network connection between vm://localhost?network=true and null at failover:tcp://s1:61616&lt;br/&gt;
INFO  VMTransportFactory             - binding to broker: localhost&lt;br/&gt;
INFO  TransportConnector             - Accepting connection on: vm://localhost&lt;br/&gt;
INFO  DemandForwardingBridge         - Starting a network connection between vm://localhost#0 and unconnected has been established.&lt;br/&gt;
INFO  ManagementContext              - JMX consoles can connect to service:jmx:rmi:///jndi/rmi://localhost:1099/jmxrmi&lt;br/&gt;
INFO  DemandForwardingBridge         - Disconnecting loop back connection.&lt;br/&gt;
INFO  Service                        - Sync error occurred: javax.jms.InvalidClientIDException: Broker: localhost - Client: TESTClient already connected&lt;br/&gt;
javax.jms.InvalidClientIDException: Broker: localhost - Client: TESTClient already connected&lt;br/&gt;
        at org.apache.activemq.broker.region.RegionBroker.addConnection(RegionBroker.java:153)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.addConnection(BrokerFilter.java:63)&lt;br/&gt;
        at org.apache.activemq.advisory.AdvisoryBroker.addConnection(AdvisoryBroker.java:66)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.addConnection(BrokerFilter.java:63)&lt;br/&gt;
        at org.apache.activemq.broker.MutableBrokerFilter.addConnection(MutableBrokerFilter.java:75)&lt;br/&gt;
        at org.apache.activemq.broker.AbstractConnection.processAddConnection(AbstractConnection.java:478)&lt;br/&gt;
        at org.apache.activemq.broker.jmx.ManagedTransportConnection.processAddConnection(ManagedTransportConnection.java:82)&lt;br/&gt;
        at org.apache.activemq.command.ConnectionInfo.visit(ConnectionInfo.java:106)&lt;br/&gt;
        at org.apache.activemq.broker.AbstractConnection.service(AbstractConnection.java:189)&lt;br/&gt;
        at org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:60)&lt;br/&gt;
        at org.apache.activemq.transport.ResponseCorrelator.onCommand(ResponseCorrelator.java:82)&lt;br/&gt;
        at org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:68)&lt;br/&gt;
        at org.apache.activemq.transport.WireFormatNegotiator.onCommand(WireFormatNegotiator.java:105)&lt;br/&gt;
        at org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:77)&lt;br/&gt;
        at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:136)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:595)&lt;br/&gt;
INFO  Service                        - Sync error occurred: javax.jms.InvalidClientIDException: Broker: localhost - Client: TESTClient already connected&lt;br/&gt;
javax.jms.InvalidClientIDException: Broker: localhost - Client: TESTClient already connected&lt;br/&gt;
        at org.apache.activemq.broker.region.RegionBroker.addConnection(RegionBroker.java:153)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.addConnection(BrokerFilter.java:63)&lt;br/&gt;
        at org.apache.activemq.advisory.AdvisoryBroker.addConnection(AdvisoryBroker.java:66)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.addConnection(BrokerFilter.java:63)&lt;br/&gt;
        at org.apache.activemq.broker.MutableBrokerFilter.addConnection(MutableBrokerFilter.java:75)&lt;br/&gt;
        at org.apache.activemq.broker.AbstractConnection.processAddConnection(AbstractConnection.java:478)&lt;br/&gt;
        at org.apache.activemq.broker.jmx.ManagedTransportConnection.processAddConnection(ManagedTransportConnection.java:82)&lt;br/&gt;
        at org.apache.activemq.command.ConnectionInfo.visit(ConnectionInfo.java:106)&lt;br/&gt;
        at org.apache.activemq.broker.AbstractConnection.service(AbstractConnection.java:189)&lt;br/&gt;
        at org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:60)&lt;br/&gt;
        at org.apache.activemq.transport.ResponseCorrelator.onCommand(ResponseCorrelator.java:82)&lt;br/&gt;
        at org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:68)&lt;br/&gt;
        at org.apache.activemq.transport.WireFormatNegotiator.onCommand(WireFormatNegotiator.java:105)&lt;br/&gt;
        at org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:77)&lt;br/&gt;
        at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:136)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:595)&lt;br/&gt;
INFO  VMTransportFactory             - Shutting down VM connectors for broker: localhost&lt;br/&gt;
INFO  VMTransportFactory             - Shutting down VM connectors for broker: localhost&lt;br/&gt;
INFO  Service                        - Async error occurred: java.io.EOFException: Cannot write to the stream any more it has already been closed&lt;br/&gt;
java.io.EOFException: Cannot write to the stream any more it has already been closed&lt;br/&gt;
        at org.apache.activemq.transport.tcp.TcpBufferedOutputStream.checkClosed(TcpBufferedOutputStream.java:131)&lt;br/&gt;
        at org.apache.activemq.transport.tcp.TcpBufferedOutputStream.write(TcpBufferedOutputStream.java:69)&lt;br/&gt;
        at java.io.DataOutputStream.writeInt(DataOutputStream.java:180)&lt;br/&gt;
        at org.apache.activemq.openwire.OpenWireFormat.marshal(OpenWireFormat.java:169)&lt;br/&gt;
        at org.apache.activemq.transport.tcp.TcpTransport.oneway(TcpTransport.java:117)&lt;br/&gt;
        at org.apache.activemq.transport.TransportFilter.oneway(TransportFilter.java:90)&lt;br/&gt;
        at org.apache.activemq.transport.WireFormatNegotiator.oneway(WireFormatNegotiator.java:65)&lt;br/&gt;
        at org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:44)&lt;br/&gt;
        at org.apache.activemq.transport.ResponseCorrelator.oneway(ResponseCorrelator.java:54)&lt;br/&gt;
        at org.apache.activemq.broker.TransportConnection.dispatch(TransportConnection.java:212)&lt;br/&gt;
        at org.apache.activemq.broker.AbstractConnection.dispatchSync(AbstractConnection.java:517)&lt;br/&gt;
        at org.apache.activemq.broker.AbstractConnection.dispatchAsync(AbstractConnection.java:535)&lt;br/&gt;
        at org.apache.activemq.broker.region.TopicSubscription.dispatch(TopicSubscription.java:142)&lt;br/&gt;
        at org.apache.activemq.broker.region.TopicSubscription.add(TopicSubscription.java:54)&lt;br/&gt;
        at org.apache.activemq.broker.region.policy.SimpleDispatchPolicy.dispatch(SimpleDispatchPolicy.java:50)&lt;br/&gt;
        at org.apache.activemq.broker.region.Topic.dispatch(Topic.java:365)&lt;br/&gt;
        at org.apache.activemq.broker.region.Topic.send(Topic.java:247)&lt;br/&gt;
        at org.apache.activemq.broker.region.AbstractRegion.send(AbstractRegion.java:195)&lt;br/&gt;
        at org.apache.activemq.broker.region.RegionBroker.send(RegionBroker.java:312)&lt;br/&gt;
        at org.apache.activemq.broker.TransactionBroker.send(TransactionBroker.java:192)&lt;br/&gt;
        at org.apache.activemq.broker.BrokerFilter.send(BrokerFilter.java:107)&lt;br/&gt;
        at org.apache.activemq.broker.CompositeDestinationBroker.send(CompositeDestinationBroker.java:97)&lt;br/&gt;
        at org.apache.activemq.broker.MutableBrokerFilter.send(MutableBrokerFilter.java:119)&lt;br/&gt;
        at org.apache.activemq.broker.AbstractConnection.processMessage(AbstractConnection.java:336)&lt;br/&gt;
        at org.apache.activemq.command.ActiveMQMessage.visit(ActiveMQMessage.java:508)&lt;br/&gt;
        at org.apache.activemq.broker.AbstractConnection.service(AbstractConnection.java:189)&lt;br/&gt;
        at org.apache.activemq.broker.TransportConnection$1.onCommand(TransportConnection.java:60)&lt;br/&gt;
        at org.apache.activemq.transport.ResponseCorrelator.onCommand(ResponseCorrelator.java:82)&lt;br/&gt;
        at org.apache.activemq.transport.TransportFilter.onCommand(TransportFilter.java:68)&lt;br/&gt;
        at org.apache.activemq.transport.WireFormatNegotiator.onCommand(WireFormatNegotiator.java:105)&lt;br/&gt;
        at org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:77)&lt;br/&gt;
        at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:136)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:595)&lt;/p&gt;

&lt;p&gt;Reverting to &quot;anonymous&quot; clients allows the client to create a new connection, but further persistant connections from the initial clientId cannot be made until the broker is restarted.&lt;/p&gt;

&lt;p&gt;Please contact via email:  johng@amdswireless.com for additional information, if needed.&lt;/p&gt;
</description>
                <environment>&lt;p&gt;Linux 2.6.12 (Mandriva), J2SDK 1.5_06, Enterprise-class SMP servers with fast RAID, 2GB RAM, GigE&lt;/p&gt;</environment>
        <key id="12481512">AMQ-600</key>
            <summary>Broker will not release a persistant clientId if a network connection is broken then restored at the TCP layer from a remote client</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jstrachan">James Strachan</assignee>
                                    <reporter username="ab0oo">John Gorkos</reporter>
                        <labels>
                    </labels>
                <created>Wed, 1 Mar 2006 20:03:47 +0000</created>
                <updated>Fri, 17 Mar 2006 13:16:46 +0000</updated>
                            <resolved>Fri, 17 Mar 2006 13:16:46 +0000</resolved>
                                    <version>4.0 M4</version>
                                    <fixVersion>4.0 RC2</fixVersion>
                                    <component>Broker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12937712" author="jstrachan" created="Fri, 17 Mar 2006 13:16:46 +0000"  >&lt;p&gt;This should be now fixed in SVN HEAD - could you confirm using tomorrows SNAPSHOT build that your issues is resolved now please?&lt;/p&gt;

&lt;p&gt;Basically the code was catching IOExceptions and treating them as service exceptions (e.g. security erorrs etc) and trying to send an error response back, rather than just disposing the connection and so freeing up the clientID.&lt;/p&gt;

&lt;p&gt;Let us know if this issue is not fixed and we can reopen this issue.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12481544">AMQ-599</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>49238</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 37 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i17zkn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>254733</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>