diff --git a/ftplet-api/src/main/java/org/apache/ftpserver/ftplet/DefaultFtpReply.java b/ftplet-api/src/main/java/org/apache/ftpserver/ftplet/DefaultFtpReply.java
index b2088758..62cab9cc 100644
--- a/ftplet-api/src/main/java/org/apache/ftpserver/ftplet/DefaultFtpReply.java
+++ b/ftplet-api/src/main/java/org/apache/ftpserver/ftplet/DefaultFtpReply.java
@@ -106,14 +106,23 @@ public class DefaultFtpReply implements FtpReply {
 
         StringBuffer sb = new StringBuffer();
 
+        // remove any carriage returns
+        notNullMessage = notNullMessage.replace("\r", "");
+        
+        // remove trailing line feeds
+        if(notNullMessage.endsWith("\n")) {
+            notNullMessage = notNullMessage.substring(0, notNullMessage.length() - 1);
+        }
+        
+        String[] lines = notNullMessage.split("\n");
+
         // no newline
-        if (notNullMessage.indexOf('\n') == -1) {
+        if (lines.length == 1) {
             sb.append(code);
             sb.append(" ");
             sb.append(notNullMessage);
             sb.append(CRLF);
         } else {
-            String[] lines = notNullMessage.split("\n");
 
             sb.append(code);
             sb.append("-");
diff --git a/ftplet-api/src/test/java/org/apache/ftpserver/ftplet/DefaultFtpReplyTest.java b/ftplet-api/src/test/java/org/apache/ftpserver/ftplet/DefaultFtpReplyTest.java
index 6abd560d..56b5db80 100644
--- a/ftplet-api/src/test/java/org/apache/ftpserver/ftplet/DefaultFtpReplyTest.java
+++ b/ftplet-api/src/test/java/org/apache/ftpserver/ftplet/DefaultFtpReplyTest.java
@@ -36,6 +36,18 @@ public class DefaultFtpReplyTest extends TestCase {
         assertEquals("123 foo bar\r\n", response.toString());
     }
 
+    public void testSingleLineWithTrailingLineFeedToString() {
+        DefaultFtpReply response = new DefaultFtpReply(123, "foo bar\n");
+
+        assertEquals("123 foo bar\r\n", response.toString());
+    }
+
+    public void testCarriageReturnToString() {
+        DefaultFtpReply response = new DefaultFtpReply(123, "foo \rbar\r\n");
+
+        assertEquals("123 foo bar\r\n", response.toString());
+    }
+    
     public void testNullToString() {
         DefaultFtpReply response = new DefaultFtpReply(123, (String) null);
 
