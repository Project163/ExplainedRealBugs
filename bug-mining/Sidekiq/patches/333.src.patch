diff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml
new file mode 100644
index 00000000..be6a594b
--- /dev/null
+++ b/.github/workflows/ci.yml
@@ -0,0 +1,46 @@
+name: CI
+
+on:
+  push:
+    branches: [ "main" ]
+  pull_request:
+    branches: [ "main" ]
+
+permissions:
+  contents: read
+
+jobs:
+  test:
+
+    runs-on: ubuntu-latest
+    name: "${{ matrix.ruby }} / ${{ matrix.database.image }}-${{ matrix.database.version }}"
+
+    strategy:
+      fail-fast: false
+      matrix:
+        ruby: ["ruby-3.2", "ruby-3.3", "ruby-3.4"]
+        database: [
+          { image: "redis", version: "6.2" },
+          { image: "redis", version: "7.2.4" }, # last BSD-licensed version
+          { image: "valkey/valkey", version: "8" },
+          # dragonfly doesn't publish any version tags aside from "latest", seems bad man
+          { image: "docker.dragonflydb.io/dragonflydb/dragonfly", version: "latest" } 
+        ]
+
+    steps:
+    - uses: actions/checkout@v4
+
+    - name: Set up Ruby ${{ matrix.ruby }}
+      uses: ruby/setup-ruby@v1
+      with:
+        bundler-cache: true
+        ruby-version: ${{ matrix.ruby }}
+
+    - name: Start Redis
+      uses: supercharge/redis-github-action@1.8.0
+      with:
+        redis-image: ${{ matrix.database.image }}
+        redis-version: ${{ matrix.database.version }}
+
+    - name: Run tests
+      run: bundle exec rake test
diff --git a/.github/workflows/dragonfly.yml b/.github/workflows/dragonfly.yml
deleted file mode 100644
index 3718eac2..00000000
--- a/.github/workflows/dragonfly.yml
+++ /dev/null
@@ -1,39 +0,0 @@
-name: DragonflyDB CI
-
-on:
-  push:
-    branches: [ main ]
-  pull_request:
-    branches: [ "main" ]
-
-permissions:
-  contents: read
-
-jobs:
-  test:
-
-    name: "Ruby ${{ matrix.ruby }} / Dragonfly ${{ matrix.redis }}"
-    runs-on: ubuntu-latest
-
-    strategy:
-      fail-fast: false
-      matrix:
-        ruby: ["3.2", "3.3", "3.4"]
-        redis: ["latest"]
-
-    steps:
-    - uses: actions/checkout@v4
-    - name: Set up Ruby ${{ matrix.ruby }}
-    # To automatically get bug fixes and new Ruby versions for ruby/setup-ruby,
-    # change this to (see https://github.com/ruby/setup-ruby#versioning):
-      uses: ruby/setup-ruby@v1
-      with:
-        bundler-cache: true # 'bundle install' and cache gems
-        ruby-version: ${{ matrix.ruby }}
-    - name: Set up Redis ${{ matrix.redis }}
-      uses: supercharge/redis-github-action@1.8.0
-      with:
-        redis-version: ${{ matrix.redis }}        
-        redis-image: docker.dragonflydb.io/dragonflydb/dragonfly
-    - name: Run tests
-      run: bundle exec rake
diff --git a/.github/workflows/redis.yml b/.github/workflows/redis.yml
deleted file mode 100644
index 03594f19..00000000
--- a/.github/workflows/redis.yml
+++ /dev/null
@@ -1,40 +0,0 @@
-name: Redis CI
-
-on:
-  push:
-    branches: [ "main" ]
-  pull_request:
-    branches: [ "main" ]
-
-permissions:
-  contents: read
-
-jobs:
-  test:
-
-    runs-on: ubuntu-latest
-    
-    # on-hover of the checkmark, show "Ruby 3 / Redis 6" instead of "(3 / 6)"
-    name: "Ruby ${{ matrix.ruby }} / Redis ${{ matrix.redis }}"
-
-    strategy:
-      fail-fast: false
-      matrix:
-        ruby: ["3.2", "3.3", "3.4"]
-        redis: ["6.2", "7.2"]
-
-    steps:
-    - uses: actions/checkout@v4
-    - name: Set up Ruby ${{ matrix.ruby }}
-    # To automatically get bug fixes and new Ruby versions for ruby/setup-ruby,
-    # change this to (see https://github.com/ruby/setup-ruby#versioning):
-      uses: ruby/setup-ruby@v1
-      with:
-        bundler-cache: true # 'bundle install' and cache gems
-        ruby-version: ${{ matrix.ruby }}
-    - name: Set up Redis ${{ matrix.redis }}
-      uses: supercharge/redis-github-action@1.8.0
-      with:
-        redis-version: ${{ matrix.redis }}        
-    - name: Run tests
-      run: bundle exec rake
diff --git a/test/profiling_test.rb b/test/profiling_test.rb
index 55242a32..2d04e100 100644
--- a/test/profiling_test.rb
+++ b/test/profiling_test.rb
@@ -9,6 +9,7 @@ describe "profiling" do
   before do
     @config = reset!
 
+    Sidekiq::Web.middlewares.clear
     # Ensure we don't touch external systems in our test suite
     Sidekiq::Web::PROFILE_OPTIONS.clear
     Sidekiq::Web::PROFILE_OPTIONS[:view_url] = "https://localhost/public/%s"
@@ -44,7 +45,7 @@ describe "profiling" do
     assert_equal %w[bob-5678 mike-1234], profiles.map(&:key)
     assert_equal %w[5678 1234], profiles.map(&:jid)
 
-    header = "\x1f\x8b".force_encoding("BINARY")
+    header = +"\x1f\x8b".force_encoding("BINARY")
     profiles.each do |pr|
       assert pr.started_at
       assert_operator pr.size, :>, 2
