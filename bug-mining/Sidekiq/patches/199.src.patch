diff --git a/Changes.md b/Changes.md
index c6e9e0dd..b36812d6 100644
--- a/Changes.md
+++ b/Changes.md
@@ -5,6 +5,7 @@
 HEAD
 -----------
 
+- Refactor Worker.set so it can be memoized [#3602]
 - Fix display of Redis URL in web footer, broken in 5.0.3 [#3560]
 
 5.0.4
diff --git a/lib/sidekiq/version.rb b/lib/sidekiq/version.rb
index 6e543599..4323ba0a 100644
--- a/lib/sidekiq/version.rb
+++ b/lib/sidekiq/version.rb
@@ -1,4 +1,4 @@
 # frozen_string_literal: true
 module Sidekiq
-  VERSION = "5.0.4"
+  VERSION = "5.0.5"
 end
diff --git a/lib/sidekiq/worker.rb b/lib/sidekiq/worker.rb
index 91fbd4fc..f1af1329 100644
--- a/lib/sidekiq/worker.rb
+++ b/lib/sidekiq/worker.rb
@@ -41,12 +41,13 @@ module Sidekiq
     #     SomeWorker.set(queue: 'foo').perform_async(....)
     #
     class Setter
-      def initialize(opts)
+      def initialize(klass, opts)
+        @klass = klass
         @opts = opts
       end
 
       def perform_async(*args)
-        @opts['class'.freeze].client_push(@opts.merge!('args'.freeze => args))
+        @klass.client_push(@opts.merge('args'.freeze => args, 'class'.freeze => @klass))
       end
 
       # +interval+ must be a timestamp, numeric or something that acts
@@ -56,10 +57,10 @@ module Sidekiq
         now = Time.now.to_f
         ts = (int < 1_000_000_000 ? now + int : int)
 
-        @opts.merge! 'args'.freeze => args, 'at'.freeze => ts
+        payload = @opts.merge('class'.freeze => @klass, 'args'.freeze => args, 'at'.freeze => ts)
         # Optimization to enqueue something now that is scheduled to go out now or in the past
-        @opts.delete('at'.freeze) if ts <= now
-        @opts['class'.freeze].client_push(@opts)
+        payload.delete('at'.freeze) if ts <= now
+        @klass.client_push(payload)
       end
       alias_method :perform_at, :perform_in
     end
@@ -79,7 +80,7 @@ module Sidekiq
       end
 
       def set(options)
-        Setter.new(options.merge!('class'.freeze => self))
+        Setter.new(self, options)
       end
 
       def perform_async(*args)
diff --git a/test/test_client.rb b/test/test_client.rb
index 92c468f2..1314a2ad 100644
--- a/test/test_client.rb
+++ b/test/test_client.rb
@@ -240,6 +240,19 @@ class TestClient < Sidekiq::Test
       Sidekiq.redis {|c| c.flushdb }
     end
 
+    it 'can be memoized' do
+      q = Sidekiq::Queue.new('bar')
+      assert_equal 0, q.size
+      set = SetWorker.set(queue: :bar, foo: 'qaaz')
+      set.perform_async(1)
+      set.perform_async(1)
+      set.perform_async(1)
+      set.perform_async(1)
+      assert_equal 4, q.size
+      assert_equal 4, q.map{|j| j['jid'] }.uniq.size
+      set.perform_in(10, 1)
+    end
+
     it 'allows option overrides' do
       q = Sidekiq::Queue.new('bar')
       assert_equal 0, q.size
