diff --git a/Changes.md b/Changes.md
index 218e472b..c5a294ae 100644
--- a/Changes.md
+++ b/Changes.md
@@ -2,6 +2,11 @@
 
 [Sidekiq Changes](https://github.com/mperham/sidekiq/blob/master/Changes.md) | [Sidekiq Pro Changes](https://github.com/mperham/sidekiq/blob/master/Pro-Changes.md) | [Sidekiq Enterprise Changes](https://github.com/mperham/sidekiq/blob/master/Ent-Changes.md)
 
+5.2.1
+-----------
+
+- Fix concurrent modification error during heartbeat [#3921]
+
 5.2.0
 -----------
 
diff --git a/lib/sidekiq/launcher.rb b/lib/sidekiq/launcher.rb
index 85fbad62..0adbe9cc 100644
--- a/lib/sidekiq/launcher.rb
+++ b/lib/sidekiq/launcher.rb
@@ -12,7 +12,7 @@ module Sidekiq
     include Util
 
     attr_accessor :manager, :poller, :fetcher
-    
+
     STATS_TTL = 5*365*24*60*60
 
     def initialize(options)
@@ -76,6 +76,7 @@ module Sidekiq
       begin
         fails = Processor::FAILURE.reset
         procd = Processor::PROCESSED.reset
+        curstate = Processor::WORKER_STATE.dup
 
         workers_key = "#{key}:workers"
         nowdate = Time.now.utc.strftime("%Y-%m-%d")
@@ -84,13 +85,13 @@ module Sidekiq
             conn.incrby("stat:processed", procd)
             conn.incrby("stat:processed:#{nowdate}", procd)
             conn.expire("stat:processed:#{nowdate}", STATS_TTL)
-            
+
             conn.incrby("stat:failed", fails)
             conn.incrby("stat:failed:#{nowdate}", fails)
             conn.expire("stat:failed:#{nowdate}", STATS_TTL)
-            
+
             conn.del(workers_key)
-            Processor::WORKER_STATE.each_pair do |tid, hash|
+            curstate.each_pair do |tid, hash|
               conn.hset(workers_key, tid, Sidekiq.dump_json(hash))
             end
             conn.expire(workers_key, 60)
@@ -102,7 +103,7 @@ module Sidekiq
           conn.multi do
             conn.sadd('processes', key)
             conn.exists(key)
-            conn.hmset(key, 'info', to_json, 'busy', Processor::WORKER_STATE.size, 'beat', Time.now.to_f, 'quiet', @done)
+            conn.hmset(key, 'info', to_json, 'busy', curstate.size, 'beat', Time.now.to_f, 'quiet', @done)
             conn.expire(key, 60)
             conn.rpop("#{key}-signals")
           end
diff --git a/lib/sidekiq/version.rb b/lib/sidekiq/version.rb
index 73cddbaa..514ce28c 100644
--- a/lib/sidekiq/version.rb
+++ b/lib/sidekiq/version.rb
@@ -1,4 +1,4 @@
 # frozen_string_literal: true
 module Sidekiq
-  VERSION = "5.2.0"
+  VERSION = "5.2.1"
 end
