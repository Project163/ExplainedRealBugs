{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/3275","repository_url":"https://api.github.com/repos/sidekiq/sidekiq","labels_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/3275/labels{/name}","comments_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/3275/comments","events_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/3275/events","html_url":"https://github.com/sidekiq/sidekiq/issues/3275","id":194935311,"node_id":"MDU6SXNzdWUxOTQ5MzUzMTE=","number":3275,"title":"`uninitialized constant Sidekiq::Rails::Reloader` after upgrading to Rails 5.0.0.1","user":{"login":"31piy","id":3369637,"node_id":"MDQ6VXNlcjMzNjk2Mzc=","avatar_url":"https://avatars.githubusercontent.com/u/3369637?v=4","gravatar_id":"","url":"https://api.github.com/users/31piy","html_url":"https://github.com/31piy","followers_url":"https://api.github.com/users/31piy/followers","following_url":"https://api.github.com/users/31piy/following{/other_user}","gists_url":"https://api.github.com/users/31piy/gists{/gist_id}","starred_url":"https://api.github.com/users/31piy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/31piy/subscriptions","organizations_url":"https://api.github.com/users/31piy/orgs","repos_url":"https://api.github.com/users/31piy/repos","events_url":"https://api.github.com/users/31piy/events{/privacy}","received_events_url":"https://api.github.com/users/31piy/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2016-12-12T10:13:28Z","updated_at":"2017-01-06T23:01:01Z","closed_at":"2016-12-12T17:39:21Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I just upgraded from Rails 4.2.6 to Rails 5.0.0.1. I have the following configuration for Sidekiq UI in `config/routes.rb`:\r\n\r\n```ruby\r\nif Rails.application.queuing_enabled?\r\n  require 'sidekiq/web'\r\n  Sidekiq::Web.set :session_secret, Rails.application.secrets[:secret_key_base]\r\n      \r\n  authenticate :user, ->(u) { u.admin? } do\r\n    mount Sidekiq::Web => '/sidekiq'\r\n  end\r\nend\r\n```\r\nThe value of `Rails.application.queuing_enabled?` will always be `true` in `production` mode, but `false` in `development` and `test`. My local machine runs in `development` mode.\r\n\r\nAfter upgrading, I am facing the below error when I run anything on my local (tried running `rspec`, `rails middleware`, `rails server` etc.):\r\n\r\n```\r\n/home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/sidekiq-4.2.7/lib/sidekiq/rails.rb:73:in `block in <class:Rails>': uninitialized constant Sidekiq::Rails::Reloader (NameError)\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/activesupport-5.0.0.1/lib/active_support/lazy_load_hooks.rb:36:in `execute_hook'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/activesupport-5.0.0.1/lib/active_support/lazy_load_hooks.rb:28:in `block in on_load'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/activesupport-5.0.0.1/lib/active_support/lazy_load_hooks.rb:27:in `each'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/activesupport-5.0.0.1/lib/active_support/lazy_load_hooks.rb:27:in `on_load'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/railtie/configuration.rb:69:in `after_initialize'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/sidekiq-4.2.7/lib/sidekiq/rails.rb:60:in `<class:Rails>'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/sidekiq-4.2.7/lib/sidekiq/rails.rb:34:in `<module:Sidekiq>'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/sidekiq-4.2.7/lib/sidekiq/rails.rb:2:in `<top (required)>'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/sidekiq-4.2.7/lib/sidekiq.rb:237:in `<top (required)>'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/sidekiq-4.2.7/lib/sidekiq/web.rb:4:in `<top (required)>'\r\n\tfrom /home/git/config/routes.rb:69:in `block in <top (required)>'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.0.1/lib/action_dispatch/routing/route_set.rb:389:in `instance_exec'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.0.1/lib/action_dispatch/routing/route_set.rb:389:in `eval_block'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/actionpack-5.0.0.1/lib/action_dispatch/routing/route_set.rb:371:in `draw'\r\n\tfrom /home/git/config/routes.rb:3:in `<top (required)>'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/application/routes_reloader.rb:40:in `block in load_paths'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/application/routes_reloader.rb:40:in `each'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/application/routes_reloader.rb:40:in `load_paths'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/application/routes_reloader.rb:16:in `reload!'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/application/routes_reloader.rb:26:in `block in updater'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/activesupport-5.0.0.1/lib/active_support/file_update_checker.rb:77:in `execute'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/application/routes_reloader.rb:27:in `updater'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/application/routes_reloader.rb:7:in `execute_if_updated'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/application/finisher.rb:119:in `block in <module:Finisher>'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/initializable.rb:30:in `instance_exec'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/initializable.rb:30:in `run'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/initializable.rb:55:in `block in run_initializers'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/2.3.0/tsort.rb:228:in `block in tsort_each'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/2.3.0/tsort.rb:350:in `block (2 levels) in each_strongly_connected_component'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/2.3.0/tsort.rb:431:in `each_strongly_connected_component_from'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/2.3.0/tsort.rb:349:in `block in each_strongly_connected_component'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/2.3.0/tsort.rb:347:in `each'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/2.3.0/tsort.rb:347:in `call'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/2.3.0/tsort.rb:347:in `each_strongly_connected_component'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/2.3.0/tsort.rb:226:in `tsort_each'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/2.3.0/tsort.rb:205:in `tsort_each'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/initializable.rb:54:in `run_initializers'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/application.rb:352:in `initialize!'\r\n\tfrom /home/git/config/environment.rb:5:in `<top (required)>'\r\n\tfrom /home/git/config.ru:3:in `require_relative'\r\n\tfrom /home/git/config.ru:3:in `block in <main>'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rack-2.0.1/lib/rack/builder.rb:55:in `instance_eval'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rack-2.0.1/lib/rack/builder.rb:55:in `initialize'\r\n\tfrom /home/git/config.ru:in `new'\r\n\tfrom /home/git/config.ru:in `<main>'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rack-2.0.1/lib/rack/builder.rb:49:in `eval'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rack-2.0.1/lib/rack/builder.rb:49:in `new_from_string'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rack-2.0.1/lib/rack/builder.rb:40:in `parse_file'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rack-2.0.1/lib/rack/server.rb:318:in `build_app_and_options_from_config'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rack-2.0.1/lib/rack/server.rb:218:in `app'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/commands/server.rb:59:in `app'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/rack-2.0.1/lib/rack/server.rb:353:in `wrapped_app'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/commands/server.rb:124:in `log_to_stdout'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/commands/server.rb:77:in `start'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/commands/commands_tasks.rb:90:in `block in server'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/commands/commands_tasks.rb:85:in `tap'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/commands/commands_tasks.rb:85:in `server'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/commands/commands_tasks.rb:49:in `run_command!'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/railties-5.0.0.1/lib/rails/commands.rb:18:in `<top (required)>'\r\n\tfrom /home/git/bin/rails:9:in `require'\r\n\tfrom /home/git/bin/rails:9:in `<top (required)>'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/spring-2.0.0/lib/spring/client/rails.rb:28:in `load'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/spring-2.0.0/lib/spring/client/rails.rb:28:in `call'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/spring-2.0.0/lib/spring/client/command.rb:7:in `call'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/spring-2.0.0/lib/spring/client.rb:30:in `run'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/spring-2.0.0/bin/spring:49:in `<top (required)>'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/spring-2.0.0/lib/spring/binstub.rb:31:in `load'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/gems/2.3.0/gems/spring-2.0.0/lib/spring/binstub.rb:31:in `<top (required)>'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:68:in `require'\r\n\tfrom /home/piyush/.rbenv/versions/2.3.1/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:68:in `require'\r\n\tfrom /home/git/bin/spring:14:in `<top (required)>'\r\n\tfrom bin/rails:3:in `load'\r\n\tfrom bin/rails:3:in `<main>'\r\n```\r\n\r\nMy `Gemfile.lock` has the following versioning info for Sidekiq.\r\n\r\n    sidekiq (4.2.7)\r\n      concurrent-ruby (~> 1.0)\r\n      connection_pool (~> 2.2, >= 2.2.0)\r\n      rack-protection (>= 1.5.0)\r\n      redis (~> 3.2, >= 3.2.1)\r\n    sidekiq-limit_fetch (3.4.0)\r\n      sidekiq (>= 4)\r\n\r\nI am using `ruby 2.3.1p112 (2016-04-26 revision 54768) [x86_64-linux]`. Raised [this question](http://stackoverflow.com/questions/40862624) on StackOverflow as well, but no luck. Please help!","closed_by":{"login":"mperham","id":2911,"node_id":"MDQ6VXNlcjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/2911?v=4","gravatar_id":"","url":"https://api.github.com/users/mperham","html_url":"https://github.com/mperham","followers_url":"https://api.github.com/users/mperham/followers","following_url":"https://api.github.com/users/mperham/following{/other_user}","gists_url":"https://api.github.com/users/mperham/gists{/gist_id}","starred_url":"https://api.github.com/users/mperham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mperham/subscriptions","organizations_url":"https://api.github.com/users/mperham/orgs","repos_url":"https://api.github.com/users/mperham/repos","events_url":"https://api.github.com/users/mperham/events{/privacy}","received_events_url":"https://api.github.com/users/mperham/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/3275/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/3275/timeline","performed_via_github_app":null,"state_reason":"completed"}