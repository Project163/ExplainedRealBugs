{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/6268","repository_url":"https://api.github.com/repos/sidekiq/sidekiq","labels_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/6268/labels{/name}","comments_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/6268/comments","events_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/6268/events","html_url":"https://github.com/sidekiq/sidekiq/issues/6268","id":2266962972,"node_id":"I_kwDOADDA9M6HHxwc","number":6268,"title":"More strict CSP policy","user":{"login":"Earlopain","id":14981592,"node_id":"MDQ6VXNlcjE0OTgxNTky","avatar_url":"https://avatars.githubusercontent.com/u/14981592?v=4","gravatar_id":"","url":"https://api.github.com/users/Earlopain","html_url":"https://github.com/Earlopain","followers_url":"https://api.github.com/users/Earlopain/followers","following_url":"https://api.github.com/users/Earlopain/following{/other_user}","gists_url":"https://api.github.com/users/Earlopain/gists{/gist_id}","starred_url":"https://api.github.com/users/Earlopain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Earlopain/subscriptions","organizations_url":"https://api.github.com/users/Earlopain/orgs","repos_url":"https://api.github.com/users/Earlopain/repos","events_url":"https://api.github.com/users/Earlopain/events{/privacy}","received_events_url":"https://api.github.com/users/Earlopain/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2024-04-27T10:56:02Z","updated_at":"2024-04-29T16:46:33Z","closed_at":"2024-04-29T16:46:33Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Ruby version: 3.3.1\r\nRails version: 7.1.3.2\r\nSidekiq / Pro / Enterprise version(s): main\r\n\r\nI saw the recent XSS and was a bit surprised since I remember protection against `unsafe-eval` for `script-src` being added in 7.2.0.\r\n\r\nThe current CSP declares `http:` and `https:` for a bunch of directives. I was tempted to open a PR to remove them since the UI just continues to work but there are two problems I see with that:\r\n* Extensions that hook into the webui might cease to function\r\n* Assets may be hosted outside of the main app, on something like S3 (https://github.com/sidekiq/sidekiq/pull/3913#issuecomment-410318634)\r\n\r\nFor the S3 case, I feel like the user should be able to configure the CSP in some way to add their bucket url to the CSP instead of just allowing everything. Similarly for addons which may use a cdn for js/css (though vendoring like here would be prefered I think).\r\n\r\nApart from benefitting sidekiq, extensions would also inherit these better protections.\r\n","closed_by":{"login":"mperham","id":2911,"node_id":"MDQ6VXNlcjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/2911?v=4","gravatar_id":"","url":"https://api.github.com/users/mperham","html_url":"https://github.com/mperham","followers_url":"https://api.github.com/users/mperham/followers","following_url":"https://api.github.com/users/mperham/following{/other_user}","gists_url":"https://api.github.com/users/mperham/gists{/gist_id}","starred_url":"https://api.github.com/users/mperham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mperham/subscriptions","organizations_url":"https://api.github.com/users/mperham/orgs","repos_url":"https://api.github.com/users/mperham/repos","events_url":"https://api.github.com/users/mperham/events{/privacy}","received_events_url":"https://api.github.com/users/mperham/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/6268/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/6268/timeline","performed_via_github_app":null,"state_reason":"completed"}