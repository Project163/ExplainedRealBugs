{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1335","repository_url":"https://api.github.com/repos/sidekiq/sidekiq","labels_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1335/labels{/name}","comments_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1335/comments","events_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1335/events","html_url":"https://github.com/sidekiq/sidekiq/issues/1335","id":22626469,"node_id":"MDU6SXNzdWUyMjYyNjQ2OQ==","number":1335,"title":"When namespace is set in config file, all system calls cause 'closed stream' error","user":{"login":"f3nry","id":405623,"node_id":"MDQ6VXNlcjQwNTYyMw==","avatar_url":"https://avatars.githubusercontent.com/u/405623?v=4","gravatar_id":"","url":"https://api.github.com/users/f3nry","html_url":"https://github.com/f3nry","followers_url":"https://api.github.com/users/f3nry/followers","following_url":"https://api.github.com/users/f3nry/following{/other_user}","gists_url":"https://api.github.com/users/f3nry/gists{/gist_id}","starred_url":"https://api.github.com/users/f3nry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/f3nry/subscriptions","organizations_url":"https://api.github.com/users/f3nry/orgs","repos_url":"https://api.github.com/users/f3nry/repos","events_url":"https://api.github.com/users/f3nry/events{/privacy}","received_events_url":"https://api.github.com/users/f3nry/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2013-11-13T22:09:08Z","updated_at":"2013-11-14T20:42:37Z","closed_at":"2013-11-14T05:33:49Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"This happens because the sidekiq logger has not been initialized yet, and this commit closes STDOUT while actually initializing the logger if the logger has already been initialized: https://github.com/mperham/sidekiq/commit/f0dafa632ab64085c56c6bfb187b2e52f200447b\n\nAn example ruby script that demonstrates this issue is:\n\n``` ruby\nSTDOUT.close\n\n# asplodes here with `system': closed stream (IOError)\nputs system 'uptime'\n```\n\nThis code in the CLI class could log before the log file is setup, thereby initializing the logger to STDOUT, then when the actual logger is initialized the log file, STDOUT is closed: https://github.com/mperham/sidekiq/blob/master/lib/sidekiq/cli.rb#L329\n\nWe were able to fix the issue by removing the namespace from the config file.\n\n~ @hjhart & @letuboy\n","closed_by":{"login":"mperham","id":2911,"node_id":"MDQ6VXNlcjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/2911?v=4","gravatar_id":"","url":"https://api.github.com/users/mperham","html_url":"https://github.com/mperham","followers_url":"https://api.github.com/users/mperham/followers","following_url":"https://api.github.com/users/mperham/following{/other_user}","gists_url":"https://api.github.com/users/mperham/gists{/gist_id}","starred_url":"https://api.github.com/users/mperham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mperham/subscriptions","organizations_url":"https://api.github.com/users/mperham/orgs","repos_url":"https://api.github.com/users/mperham/repos","events_url":"https://api.github.com/users/mperham/events{/privacy}","received_events_url":"https://api.github.com/users/mperham/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1335/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1335/timeline","performed_via_github_app":null,"state_reason":"completed"}