[{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/43125470","html_url":"https://github.com/sidekiq/sidekiq/issues/1705#issuecomment-43125470","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1705","id":43125470,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMTI1NDcw","user":{"login":"mperham","id":2911,"node_id":"MDQ6VXNlcjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/2911?v=4","gravatar_id":"","url":"https://api.github.com/users/mperham","html_url":"https://github.com/mperham","followers_url":"https://api.github.com/users/mperham/followers","following_url":"https://api.github.com/users/mperham/following{/other_user}","gists_url":"https://api.github.com/users/mperham/gists{/gist_id}","starred_url":"https://api.github.com/users/mperham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mperham/subscriptions","organizations_url":"https://api.github.com/users/mperham/orgs","repos_url":"https://api.github.com/users/mperham/repos","events_url":"https://api.github.com/users/mperham/events{/privacy}","received_events_url":"https://api.github.com/users/mperham/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-05-14T19:22:30Z","updated_at":"2014-05-14T19:22:30Z","body":"Do you know what the payload looked like?  It would help if I knew where the bad string was coming from.\n","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/43125470/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mperham","id":2911,"node_id":"MDQ6VXNlcjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/2911?v=4","gravatar_id":"","url":"https://api.github.com/users/mperham","html_url":"https://github.com/mperham","followers_url":"https://api.github.com/users/mperham/followers","following_url":"https://api.github.com/users/mperham/following{/other_user}","gists_url":"https://api.github.com/users/mperham/gists{/gist_id}","starred_url":"https://api.github.com/users/mperham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mperham/subscriptions","organizations_url":"https://api.github.com/users/mperham/orgs","repos_url":"https://api.github.com/users/mperham/repos","events_url":"https://api.github.com/users/mperham/events{/privacy}","received_events_url":"https://api.github.com/users/mperham/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/43126307","html_url":"https://github.com/sidekiq/sidekiq/issues/1705#issuecomment-43126307","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1705","id":43126307,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMTI2MzA3","user":{"login":"avit","id":4278,"node_id":"MDQ6VXNlcjQyNzg=","avatar_url":"https://avatars.githubusercontent.com/u/4278?v=4","gravatar_id":"","url":"https://api.github.com/users/avit","html_url":"https://github.com/avit","followers_url":"https://api.github.com/users/avit/followers","following_url":"https://api.github.com/users/avit/following{/other_user}","gists_url":"https://api.github.com/users/avit/gists{/gist_id}","starred_url":"https://api.github.com/users/avit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/avit/subscriptions","organizations_url":"https://api.github.com/users/avit/orgs","repos_url":"https://api.github.com/users/avit/repos","events_url":"https://api.github.com/users/avit/events{/privacy}","received_events_url":"https://api.github.com/users/avit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-05-14T19:30:09Z","updated_at":"2014-05-14T19:30:35Z","body":"The actual job payload was just an id number. \n\nThe error was raised in our application after looking up a record and then getting a `Mail::Field::ParseError`, on an email with accents in it (e.g. \"Lumière &lt;example@example.com&gt;\").\n\nI'll see if I can reproduce the proper error string for you. That part gets lost when the JSON gem raises its own error instead.\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/43126307/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"avit","id":4278,"node_id":"MDQ6VXNlcjQyNzg=","avatar_url":"https://avatars.githubusercontent.com/u/4278?v=4","gravatar_id":"","url":"https://api.github.com/users/avit","html_url":"https://github.com/avit","followers_url":"https://api.github.com/users/avit/followers","following_url":"https://api.github.com/users/avit/following{/other_user}","gists_url":"https://api.github.com/users/avit/gists{/gist_id}","starred_url":"https://api.github.com/users/avit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/avit/subscriptions","organizations_url":"https://api.github.com/users/avit/orgs","repos_url":"https://api.github.com/users/avit/repos","events_url":"https://api.github.com/users/avit/events{/privacy}","received_events_url":"https://api.github.com/users/avit/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/43127061","html_url":"https://github.com/sidekiq/sidekiq/issues/1705#issuecomment-43127061","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1705","id":43127061,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMTI3MDYx","user":{"login":"mperham","id":2911,"node_id":"MDQ6VXNlcjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/2911?v=4","gravatar_id":"","url":"https://api.github.com/users/mperham","html_url":"https://github.com/mperham","followers_url":"https://api.github.com/users/mperham/followers","following_url":"https://api.github.com/users/mperham/following{/other_user}","gists_url":"https://api.github.com/users/mperham/gists{/gist_id}","starred_url":"https://api.github.com/users/mperham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mperham/subscriptions","organizations_url":"https://api.github.com/users/mperham/orgs","repos_url":"https://api.github.com/users/mperham/repos","events_url":"https://api.github.com/users/mperham/events{/privacy}","received_events_url":"https://api.github.com/users/mperham/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-05-14T19:36:32Z","updated_at":"2014-05-14T19:36:48Z","body":"Ok, so my guess is the error_message field contained the bad input.  If you pulled this data from your database, you can set the proper encoding in config/database.yml:\n\n```\ncommon: &common\n  adapter: mysql2\n  encoding: utf8\n```\n\nAre you running your systems as UTF-8 everywhere?\n","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/43127061/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mperham","id":2911,"node_id":"MDQ6VXNlcjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/2911?v=4","gravatar_id":"","url":"https://api.github.com/users/mperham","html_url":"https://github.com/mperham","followers_url":"https://api.github.com/users/mperham/followers","following_url":"https://api.github.com/users/mperham/following{/other_user}","gists_url":"https://api.github.com/users/mperham/gists{/gist_id}","starred_url":"https://api.github.com/users/mperham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mperham/subscriptions","organizations_url":"https://api.github.com/users/mperham/orgs","repos_url":"https://api.github.com/users/mperham/repos","events_url":"https://api.github.com/users/mperham/events{/privacy}","received_events_url":"https://api.github.com/users/mperham/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/43128567","html_url":"https://github.com/sidekiq/sidekiq/issues/1705#issuecomment-43128567","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1705","id":43128567,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMTI4NTY3","user":{"login":"avit","id":4278,"node_id":"MDQ6VXNlcjQyNzg=","avatar_url":"https://avatars.githubusercontent.com/u/4278?v=4","gravatar_id":"","url":"https://api.github.com/users/avit","html_url":"https://github.com/avit","followers_url":"https://api.github.com/users/avit/followers","following_url":"https://api.github.com/users/avit/following{/other_user}","gists_url":"https://api.github.com/users/avit/gists{/gist_id}","starred_url":"https://api.github.com/users/avit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/avit/subscriptions","organizations_url":"https://api.github.com/users/avit/orgs","repos_url":"https://api.github.com/users/avit/repos","events_url":"https://api.github.com/users/avit/events{/privacy}","received_events_url":"https://api.github.com/users/avit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-05-14T19:48:47Z","updated_at":"2014-05-14T19:48:47Z","body":"Yes, we're already using UTF-8 everywhere. Confirm:\n\n``` ruby\nstr = %{\"é\" <e@example.com>}\nstr.encoding == Encoding::UTF_8  # true\naddr = Mail::Address.new(str)\n```\n\nI'm pretty sure this represents the original exception:\n\n```\nMail::Field::ParseError: Mail::AddressListsParser can not parse |\"é\" <e@example.com>|\nReason was: Expected one of\n, \\, \" at line 1, column 2 (byte 2) after \"\n        from /opt/rbenv/versions/2.1.1/lib/ruby/gems/2.1.0/gems/mail-2.5.4/lib/mail/elements/address_list.rb:29:in `initialize'\n        from /opt/rbenv/versions/2.1.1/lib/ruby/gems/2.1.0/gems/mail-2.5.4/lib/mail/elements/address.rb:181:in `new'\n        from /opt/rbenv/versions/2.1.1/lib/ruby/gems/2.1.0/gems/mail-2.5.4/lib/mail/elements/address.rb:181:in `parse'\n        from /opt/rbenv/versions/2.1.1/lib/ruby/gems/2.1.0/gems/mail-2.5.4/lib/mail/elements/address.rb:32:in `initialize'\n        from (irb):19:in `new'\n        from (irb):19\n        from /opt/rbenv/versions/2.1.1/bin/irb:11:in `<main>'\n```\n\nThe problem is that the Mail gem doesn't handle it. Regardless of the source of the error, Sidekiq should not blow up when trying to report it, consequently failing to put it on the retries queue.\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/43128567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"avit","id":4278,"node_id":"MDQ6VXNlcjQyNzg=","avatar_url":"https://avatars.githubusercontent.com/u/4278?v=4","gravatar_id":"","url":"https://api.github.com/users/avit","html_url":"https://github.com/avit","followers_url":"https://api.github.com/users/avit/followers","following_url":"https://api.github.com/users/avit/following{/other_user}","gists_url":"https://api.github.com/users/avit/gists{/gist_id}","starred_url":"https://api.github.com/users/avit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/avit/subscriptions","organizations_url":"https://api.github.com/users/avit/orgs","repos_url":"https://api.github.com/users/avit/repos","events_url":"https://api.github.com/users/avit/events{/privacy}","received_events_url":"https://api.github.com/users/avit/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/43129562","html_url":"https://github.com/sidekiq/sidekiq/issues/1705#issuecomment-43129562","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1705","id":43129562,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMTI5NTYy","user":{"login":"avit","id":4278,"node_id":"MDQ6VXNlcjQyNzg=","avatar_url":"https://avatars.githubusercontent.com/u/4278?v=4","gravatar_id":"","url":"https://api.github.com/users/avit","html_url":"https://github.com/avit","followers_url":"https://api.github.com/users/avit/followers","following_url":"https://api.github.com/users/avit/following{/other_user}","gists_url":"https://api.github.com/users/avit/gists{/gist_id}","starred_url":"https://api.github.com/users/avit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/avit/subscriptions","organizations_url":"https://api.github.com/users/avit/orgs","repos_url":"https://api.github.com/users/avit/repos","events_url":"https://api.github.com/users/avit/events{/privacy}","received_events_url":"https://api.github.com/users/avit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-05-14T19:57:35Z","updated_at":"2014-05-14T19:57:35Z","body":"I'm still trying to reproduce the original error message to see what actually got passed into `Sidekiq.dump_json`, the above doesn't seem to be the whole picture.\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/43129562/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"avit","id":4278,"node_id":"MDQ6VXNlcjQyNzg=","avatar_url":"https://avatars.githubusercontent.com/u/4278?v=4","gravatar_id":"","url":"https://api.github.com/users/avit","html_url":"https://github.com/avit","followers_url":"https://api.github.com/users/avit/followers","following_url":"https://api.github.com/users/avit/following{/other_user}","gists_url":"https://api.github.com/users/avit/gists{/gist_id}","starred_url":"https://api.github.com/users/avit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/avit/subscriptions","organizations_url":"https://api.github.com/users/avit/orgs","repos_url":"https://api.github.com/users/avit/repos","events_url":"https://api.github.com/users/avit/events{/privacy}","received_events_url":"https://api.github.com/users/avit/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/43129665","html_url":"https://github.com/sidekiq/sidekiq/issues/1705#issuecomment-43129665","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1705","id":43129665,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMTI5NjY1","user":{"login":"mperham","id":2911,"node_id":"MDQ6VXNlcjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/2911?v=4","gravatar_id":"","url":"https://api.github.com/users/mperham","html_url":"https://github.com/mperham","followers_url":"https://api.github.com/users/mperham/followers","following_url":"https://api.github.com/users/mperham/following{/other_user}","gists_url":"https://api.github.com/users/mperham/gists{/gist_id}","starred_url":"https://api.github.com/users/mperham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mperham/subscriptions","organizations_url":"https://api.github.com/users/mperham/orgs","repos_url":"https://api.github.com/users/mperham/repos","events_url":"https://api.github.com/users/mperham/events{/privacy}","received_events_url":"https://api.github.com/users/mperham/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-05-14T19:58:24Z","updated_at":"2014-05-14T19:58:24Z","body":"Is the encoding different on the error message string than the example string you checked?  It's possible the mail gem is converting the encoding to some default like ISO-8852-1 and then raising that converted string.\n","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/43129665/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mperham","id":2911,"node_id":"MDQ6VXNlcjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/2911?v=4","gravatar_id":"","url":"https://api.github.com/users/mperham","html_url":"https://github.com/mperham","followers_url":"https://api.github.com/users/mperham/followers","following_url":"https://api.github.com/users/mperham/following{/other_user}","gists_url":"https://api.github.com/users/mperham/gists{/gist_id}","starred_url":"https://api.github.com/users/mperham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mperham/subscriptions","organizations_url":"https://api.github.com/users/mperham/orgs","repos_url":"https://api.github.com/users/mperham/repos","events_url":"https://api.github.com/users/mperham/events{/privacy}","received_events_url":"https://api.github.com/users/mperham/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/43132062","html_url":"https://github.com/sidekiq/sidekiq/issues/1705#issuecomment-43132062","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1705","id":43132062,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMTMyMDYy","user":{"login":"avit","id":4278,"node_id":"MDQ6VXNlcjQyNzg=","avatar_url":"https://avatars.githubusercontent.com/u/4278?v=4","gravatar_id":"","url":"https://api.github.com/users/avit","html_url":"https://github.com/avit","followers_url":"https://api.github.com/users/avit/followers","following_url":"https://api.github.com/users/avit/following{/other_user}","gists_url":"https://api.github.com/users/avit/gists{/gist_id}","starred_url":"https://api.github.com/users/avit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/avit/subscriptions","organizations_url":"https://api.github.com/users/avit/orgs","repos_url":"https://api.github.com/users/avit/repos","events_url":"https://api.github.com/users/avit/events{/privacy}","received_events_url":"https://api.github.com/users/avit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-05-14T20:19:45Z","updated_at":"2014-05-14T20:19:45Z","body":"Not sure yet. It looks like it's getting an ASCII_8BIT string with non-UTF8 characters... from somewhere. Minimal repro:\n\n``` ruby\nstr = 195.chr\nstr.encoding == Encoding::ASCII_8BIT # true\nSidekiq.dump_json error_message: str\n```\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/43132062/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"avit","id":4278,"node_id":"MDQ6VXNlcjQyNzg=","avatar_url":"https://avatars.githubusercontent.com/u/4278?v=4","gravatar_id":"","url":"https://api.github.com/users/avit","html_url":"https://github.com/avit","followers_url":"https://api.github.com/users/avit/followers","following_url":"https://api.github.com/users/avit/following{/other_user}","gists_url":"https://api.github.com/users/avit/gists{/gist_id}","starred_url":"https://api.github.com/users/avit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/avit/subscriptions","organizations_url":"https://api.github.com/users/avit/orgs","repos_url":"https://api.github.com/users/avit/repos","events_url":"https://api.github.com/users/avit/events{/privacy}","received_events_url":"https://api.github.com/users/avit/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/53509060","html_url":"https://github.com/sidekiq/sidekiq/issues/1705#issuecomment-53509060","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1705","id":53509060,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNTA5MDYw","user":{"login":"maccman","id":2142,"node_id":"MDQ6VXNlcjIxNDI=","avatar_url":"https://avatars.githubusercontent.com/u/2142?v=4","gravatar_id":"","url":"https://api.github.com/users/maccman","html_url":"https://github.com/maccman","followers_url":"https://api.github.com/users/maccman/followers","following_url":"https://api.github.com/users/maccman/following{/other_user}","gists_url":"https://api.github.com/users/maccman/gists{/gist_id}","starred_url":"https://api.github.com/users/maccman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maccman/subscriptions","organizations_url":"https://api.github.com/users/maccman/orgs","repos_url":"https://api.github.com/users/maccman/repos","events_url":"https://api.github.com/users/maccman/events{/privacy}","received_events_url":"https://api.github.com/users/maccman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-08-26T23:42:35Z","updated_at":"2014-08-26T23:42:35Z","body":"Getting this error too :( \n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/53509060/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"maccman","id":2142,"node_id":"MDQ6VXNlcjIxNDI=","avatar_url":"https://avatars.githubusercontent.com/u/2142?v=4","gravatar_id":"","url":"https://api.github.com/users/maccman","html_url":"https://github.com/maccman","followers_url":"https://api.github.com/users/maccman/followers","following_url":"https://api.github.com/users/maccman/following{/other_user}","gists_url":"https://api.github.com/users/maccman/gists{/gist_id}","starred_url":"https://api.github.com/users/maccman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maccman/subscriptions","organizations_url":"https://api.github.com/users/maccman/orgs","repos_url":"https://api.github.com/users/maccman/repos","events_url":"https://api.github.com/users/maccman/events{/privacy}","received_events_url":"https://api.github.com/users/maccman/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/53528675","html_url":"https://github.com/sidekiq/sidekiq/issues/1705#issuecomment-53528675","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1705","id":53528675,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNTI4Njc1","user":{"login":"maccman","id":2142,"node_id":"MDQ6VXNlcjIxNDI=","avatar_url":"https://avatars.githubusercontent.com/u/2142?v=4","gravatar_id":"","url":"https://api.github.com/users/maccman","html_url":"https://github.com/maccman","followers_url":"https://api.github.com/users/maccman/followers","following_url":"https://api.github.com/users/maccman/following{/other_user}","gists_url":"https://api.github.com/users/maccman/gists{/gist_id}","starred_url":"https://api.github.com/users/maccman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maccman/subscriptions","organizations_url":"https://api.github.com/users/maccman/orgs","repos_url":"https://api.github.com/users/maccman/repos","events_url":"https://api.github.com/users/maccman/events{/privacy}","received_events_url":"https://api.github.com/users/maccman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-08-27T05:39:02Z","updated_at":"2014-08-27T05:39:02Z","body":"I narrowed this error down to some non UTF-8 valid strings inside an exception message.\n\nThe exception was a HTTP exception from Nestful which included some binary strings.\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/53528675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"maccman","id":2142,"node_id":"MDQ6VXNlcjIxNDI=","avatar_url":"https://avatars.githubusercontent.com/u/2142?v=4","gravatar_id":"","url":"https://api.github.com/users/maccman","html_url":"https://github.com/maccman","followers_url":"https://api.github.com/users/maccman/followers","following_url":"https://api.github.com/users/maccman/following{/other_user}","gists_url":"https://api.github.com/users/maccman/gists{/gist_id}","starred_url":"https://api.github.com/users/maccman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maccman/subscriptions","organizations_url":"https://api.github.com/users/maccman/orgs","repos_url":"https://api.github.com/users/maccman/repos","events_url":"https://api.github.com/users/maccman/events{/privacy}","received_events_url":"https://api.github.com/users/maccman/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":157961776,"node_id":"MDExOkNsb3NlZEV2ZW50MTU3OTYxNzc2","url":"https://api.github.com/repos/sidekiq/sidekiq/issues/events/157961776","actor":{"login":"mperham","id":2911,"node_id":"MDQ6VXNlcjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/2911?v=4","gravatar_id":"","url":"https://api.github.com/users/mperham","html_url":"https://github.com/mperham","followers_url":"https://api.github.com/users/mperham/followers","following_url":"https://api.github.com/users/mperham/following{/other_user}","gists_url":"https://api.github.com/users/mperham/gists{/gist_id}","starred_url":"https://api.github.com/users/mperham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mperham/subscriptions","organizations_url":"https://api.github.com/users/mperham/orgs","repos_url":"https://api.github.com/users/mperham/repos","events_url":"https://api.github.com/users/mperham/events{/privacy}","received_events_url":"https://api.github.com/users/mperham/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"dffdd22bab341c18749033c36a7e476911d1dca2","commit_url":"https://api.github.com/repos/sidekiq/sidekiq/commits/dffdd22bab341c18749033c36a7e476911d1dca2","created_at":"2014-08-27T16:31:58Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/53601466","html_url":"https://github.com/sidekiq/sidekiq/issues/1705#issuecomment-53601466","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1705","id":53601466,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjAxNDY2","user":{"login":"mperham","id":2911,"node_id":"MDQ6VXNlcjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/2911?v=4","gravatar_id":"","url":"https://api.github.com/users/mperham","html_url":"https://github.com/mperham","followers_url":"https://api.github.com/users/mperham/followers","following_url":"https://api.github.com/users/mperham/following{/other_user}","gists_url":"https://api.github.com/users/mperham/gists{/gist_id}","starred_url":"https://api.github.com/users/mperham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mperham/subscriptions","organizations_url":"https://api.github.com/users/mperham/orgs","repos_url":"https://api.github.com/users/mperham/repos","events_url":"https://api.github.com/users/mperham/events{/privacy}","received_events_url":"https://api.github.com/users/mperham/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-08-27T16:32:53Z","updated_at":"2014-08-27T16:33:07Z","body":"Fix will be in 3.2.3 due early next week.  It requires Ruby 2.1.\n","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/53601466/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mperham","id":2911,"node_id":"MDQ6VXNlcjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/2911?v=4","gravatar_id":"","url":"https://api.github.com/users/mperham","html_url":"https://github.com/mperham","followers_url":"https://api.github.com/users/mperham/followers","following_url":"https://api.github.com/users/mperham/following{/other_user}","gists_url":"https://api.github.com/users/mperham/gists{/gist_id}","starred_url":"https://api.github.com/users/mperham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mperham/subscriptions","organizations_url":"https://api.github.com/users/mperham/orgs","repos_url":"https://api.github.com/users/mperham/repos","events_url":"https://api.github.com/users/mperham/events{/privacy}","received_events_url":"https://api.github.com/users/mperham/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/53601555","html_url":"https://github.com/sidekiq/sidekiq/issues/1705#issuecomment-53601555","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1705","id":53601555,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjAxNTU1","user":{"login":"avit","id":4278,"node_id":"MDQ6VXNlcjQyNzg=","avatar_url":"https://avatars.githubusercontent.com/u/4278?v=4","gravatar_id":"","url":"https://api.github.com/users/avit","html_url":"https://github.com/avit","followers_url":"https://api.github.com/users/avit/followers","following_url":"https://api.github.com/users/avit/following{/other_user}","gists_url":"https://api.github.com/users/avit/gists{/gist_id}","starred_url":"https://api.github.com/users/avit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/avit/subscriptions","organizations_url":"https://api.github.com/users/avit/orgs","repos_url":"https://api.github.com/users/avit/repos","events_url":"https://api.github.com/users/avit/events{/privacy}","received_events_url":"https://api.github.com/users/avit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-08-27T16:33:28Z","updated_at":"2014-08-27T16:33:28Z","body":"Awesome, thanks!\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/53601555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"avit","id":4278,"node_id":"MDQ6VXNlcjQyNzg=","avatar_url":"https://avatars.githubusercontent.com/u/4278?v=4","gravatar_id":"","url":"https://api.github.com/users/avit","html_url":"https://github.com/avit","followers_url":"https://api.github.com/users/avit/followers","following_url":"https://api.github.com/users/avit/following{/other_user}","gists_url":"https://api.github.com/users/avit/gists{/gist_id}","starred_url":"https://api.github.com/users/avit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/avit/subscriptions","organizations_url":"https://api.github.com/users/avit/orgs","repos_url":"https://api.github.com/users/avit/repos","events_url":"https://api.github.com/users/avit/events{/privacy}","received_events_url":"https://api.github.com/users/avit/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/53891220","html_url":"https://github.com/sidekiq/sidekiq/issues/1705#issuecomment-53891220","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1705","id":53891220,"node_id":"MDEyOklzc3VlQ29tbWVudDUzODkxMjIw","user":{"login":"maccman","id":2142,"node_id":"MDQ6VXNlcjIxNDI=","avatar_url":"https://avatars.githubusercontent.com/u/2142?v=4","gravatar_id":"","url":"https://api.github.com/users/maccman","html_url":"https://github.com/maccman","followers_url":"https://api.github.com/users/maccman/followers","following_url":"https://api.github.com/users/maccman/following{/other_user}","gists_url":"https://api.github.com/users/maccman/gists{/gist_id}","starred_url":"https://api.github.com/users/maccman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maccman/subscriptions","organizations_url":"https://api.github.com/users/maccman/orgs","repos_url":"https://api.github.com/users/maccman/repos","events_url":"https://api.github.com/users/maccman/events{/privacy}","received_events_url":"https://api.github.com/users/maccman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2014-08-29T15:28:40Z","updated_at":"2014-08-29T15:28:40Z","body":"Awesome!\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/53891220/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"maccman","id":2142,"node_id":"MDQ6VXNlcjIxNDI=","avatar_url":"https://avatars.githubusercontent.com/u/2142?v=4","gravatar_id":"","url":"https://api.github.com/users/maccman","html_url":"https://github.com/maccman","followers_url":"https://api.github.com/users/maccman/followers","following_url":"https://api.github.com/users/maccman/following{/other_user}","gists_url":"https://api.github.com/users/maccman/gists{/gist_id}","starred_url":"https://api.github.com/users/maccman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maccman/subscriptions","organizations_url":"https://api.github.com/users/maccman/orgs","repos_url":"https://api.github.com/users/maccman/repos","events_url":"https://api.github.com/users/maccman/events{/privacy}","received_events_url":"https://api.github.com/users/maccman/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/493485808","html_url":"https://github.com/sidekiq/sidekiq/issues/1705#issuecomment-493485808","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1705","id":493485808,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MzQ4NTgwOA==","user":{"login":"mingca","id":20705027,"node_id":"MDQ6VXNlcjIwNzA1MDI3","avatar_url":"https://avatars.githubusercontent.com/u/20705027?v=4","gravatar_id":"","url":"https://api.github.com/users/mingca","html_url":"https://github.com/mingca","followers_url":"https://api.github.com/users/mingca/followers","following_url":"https://api.github.com/users/mingca/following{/other_user}","gists_url":"https://api.github.com/users/mingca/gists{/gist_id}","starred_url":"https://api.github.com/users/mingca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mingca/subscriptions","organizations_url":"https://api.github.com/users/mingca/orgs","repos_url":"https://api.github.com/users/mingca/repos","events_url":"https://api.github.com/users/mingca/events{/privacy}","received_events_url":"https://api.github.com/users/mingca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-17T15:00:21Z","updated_at":"2019-05-17T15:02:20Z","body":"Getting this error message again in Sidekiq v5.0.5, sidekiq-pro (4.0.3).\r\n\r\n```        }, \r\n        {\r\n          \"method\": \"dump_json\", \r\n          \"lineno\": 175, \r\n          \"filename\": \"/usr/local/rvm/gems/ruby-2.4.4@railsapp-production/gems/sidekiq-5.0.5/lib/sidekiq.rb\"\r\n        }, \r\n        {\r\n          \"method\": \"generate\", \r\n          \"lineno\": 224, \r\n          \"filename\": \"/usr/local/rvm/gems/ruby-2.4.4@railsapp-production/gems/json-2.1.0/lib/json/common.rb\"\r\n        }, \r\n        {\r\n          \"method\": \"generate\", \r\n          \"lineno\": 224, \r\n          \"filename\": \"/usr/local/rvm/gems/ruby-2.4.4@railsapp-production/gems/json-2.1.0/lib/json/common.rb\"\r\n        }, \r\n        {\r\n          \"method\": \"encode\", \r\n          \"lineno\": 224, \r\n          \"filename\": \"/usr/local/rvm/gems/ruby-2.4.4@railsapp-production/gems/json-2.1.0/lib/json/common.rb\"\r\n        }\r\n      ], \r\n      \"exception\": {\r\n        \"message\": \"\\\"\\\\xE2\\\" from ASCII-8BIT to UTF-8\", \r\n        \"class\": \"Encoding::UndefinedConversionError\"\r\n      }, ```","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/493485808/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mingca","id":20705027,"node_id":"MDQ6VXNlcjIwNzA1MDI3","avatar_url":"https://avatars.githubusercontent.com/u/20705027?v=4","gravatar_id":"","url":"https://api.github.com/users/mingca","html_url":"https://github.com/mingca","followers_url":"https://api.github.com/users/mingca/followers","following_url":"https://api.github.com/users/mingca/following{/other_user}","gists_url":"https://api.github.com/users/mingca/gists{/gist_id}","starred_url":"https://api.github.com/users/mingca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mingca/subscriptions","organizations_url":"https://api.github.com/users/mingca/orgs","repos_url":"https://api.github.com/users/mingca/repos","events_url":"https://api.github.com/users/mingca/events{/privacy}","received_events_url":"https://api.github.com/users/mingca/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/755846489","html_url":"https://github.com/sidekiq/sidekiq/issues/1705#issuecomment-755846489","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/1705","id":755846489,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTg0NjQ4OQ==","user":{"login":"pelargir","id":3756,"node_id":"MDQ6VXNlcjM3NTY=","avatar_url":"https://avatars.githubusercontent.com/u/3756?v=4","gravatar_id":"","url":"https://api.github.com/users/pelargir","html_url":"https://github.com/pelargir","followers_url":"https://api.github.com/users/pelargir/followers","following_url":"https://api.github.com/users/pelargir/following{/other_user}","gists_url":"https://api.github.com/users/pelargir/gists{/gist_id}","starred_url":"https://api.github.com/users/pelargir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pelargir/subscriptions","organizations_url":"https://api.github.com/users/pelargir/orgs","repos_url":"https://api.github.com/users/pelargir/repos","events_url":"https://api.github.com/users/pelargir/events{/privacy}","received_events_url":"https://api.github.com/users/pelargir/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-07T02:41:50Z","updated_at":"2021-01-07T02:41:50Z","body":"I was having a similar problem and traced it back to reading an incoming Stripe webhook request containing a UTF-8 character. I was calling `request.body.read` instead of `request.raw_post` (on an `ActiveDispatch::Request` object). The former assumes ASCII-8BIT (binary) encoding which was causing `JSON.generate` to blow up when trying to serialize the body. The latter correctly uses UTF-8 encoding so the body can be serialized without blowing up. Hope this helps someone. See https://apidock.com/rails/ActionDispatch/Request/raw_post","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/755846489/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pelargir","id":3756,"node_id":"MDQ6VXNlcjM3NTY=","avatar_url":"https://avatars.githubusercontent.com/u/3756?v=4","gravatar_id":"","url":"https://api.github.com/users/pelargir","html_url":"https://github.com/pelargir","followers_url":"https://api.github.com/users/pelargir/followers","following_url":"https://api.github.com/users/pelargir/following{/other_user}","gists_url":"https://api.github.com/users/pelargir/gists{/gist_id}","starred_url":"https://api.github.com/users/pelargir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pelargir/subscriptions","organizations_url":"https://api.github.com/users/pelargir/orgs","repos_url":"https://api.github.com/users/pelargir/repos","events_url":"https://api.github.com/users/pelargir/events{/privacy}","received_events_url":"https://api.github.com/users/pelargir/received_events","type":"User","user_view_type":"public","site_admin":false}}]