[{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/3108598950","html_url":"https://github.com/sidekiq/sidekiq/issues/6768#issuecomment-3108598950","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/6768","id":3108598950,"node_id":"IC_kwDOADDA9M65SXSm","user":{"login":"mperham","id":2911,"node_id":"MDQ6VXNlcjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/2911?v=4","gravatar_id":"","url":"https://api.github.com/users/mperham","html_url":"https://github.com/mperham","followers_url":"https://api.github.com/users/mperham/followers","following_url":"https://api.github.com/users/mperham/following{/other_user}","gists_url":"https://api.github.com/users/mperham/gists{/gist_id}","starred_url":"https://api.github.com/users/mperham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mperham/subscriptions","organizations_url":"https://api.github.com/users/mperham/orgs","repos_url":"https://api.github.com/users/mperham/repos","events_url":"https://api.github.com/users/mperham/events{/privacy}","received_events_url":"https://api.github.com/users/mperham/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-07-23T13:42:58Z","updated_at":"2025-07-23T13:42:58Z","body":"Yeah, it's subtle but there seems to be some sort of race condition here in the JS when reloading the page with live poll. Most of the time when I click Delete, the confirm dialog pops up but occasionally nothing happens.\n\nI'm not much of a JavaScript expert, any JS/front-end experts want to review the live poll and click handler code in [application.js](https://github.com/sidekiq/sidekiq/blob/main/web/assets/javascripts/application.js) and let us know if there is a safer way to reload the page and maintain the event handlers?","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/3108598950/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mperham","id":2911,"node_id":"MDQ6VXNlcjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/2911?v=4","gravatar_id":"","url":"https://api.github.com/users/mperham","html_url":"https://github.com/mperham","followers_url":"https://api.github.com/users/mperham/followers","following_url":"https://api.github.com/users/mperham/following{/other_user}","gists_url":"https://api.github.com/users/mperham/gists{/gist_id}","starred_url":"https://api.github.com/users/mperham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mperham/subscriptions","organizations_url":"https://api.github.com/users/mperham/orgs","repos_url":"https://api.github.com/users/mperham/repos","events_url":"https://api.github.com/users/mperham/events{/privacy}","received_events_url":"https://api.github.com/users/mperham/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/3108686234","html_url":"https://github.com/sidekiq/sidekiq/issues/6768#issuecomment-3108686234","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/6768","id":3108686234,"node_id":"IC_kwDOADDA9M65Ssma","user":{"login":"kichik","id":1156773,"node_id":"MDQ6VXNlcjExNTY3NzM=","avatar_url":"https://avatars.githubusercontent.com/u/1156773?v=4","gravatar_id":"","url":"https://api.github.com/users/kichik","html_url":"https://github.com/kichik","followers_url":"https://api.github.com/users/kichik/followers","following_url":"https://api.github.com/users/kichik/following{/other_user}","gists_url":"https://api.github.com/users/kichik/gists{/gist_id}","starred_url":"https://api.github.com/users/kichik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kichik/subscriptions","organizations_url":"https://api.github.com/users/kichik/orgs","repos_url":"https://api.github.com/users/kichik/repos","events_url":"https://api.github.com/users/kichik/events{/privacy}","received_events_url":"https://api.github.com/users/kichik/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-07-23T13:50:07Z","updated_at":"2025-07-23T13:50:07Z","body":"I am also not much of a JavaScript expert, but maybe a quick fix is to use the event handler to submit the form instead of using it to block it? Then whatever race condition is happening here will result in nothing instead of a deleted queue.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/3108686234/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kichik","id":1156773,"node_id":"MDQ6VXNlcjExNTY3NzM=","avatar_url":"https://avatars.githubusercontent.com/u/1156773?v=4","gravatar_id":"","url":"https://api.github.com/users/kichik","html_url":"https://github.com/kichik","followers_url":"https://api.github.com/users/kichik/followers","following_url":"https://api.github.com/users/kichik/following{/other_user}","gists_url":"https://api.github.com/users/kichik/gists{/gist_id}","starred_url":"https://api.github.com/users/kichik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kichik/subscriptions","organizations_url":"https://api.github.com/users/kichik/orgs","repos_url":"https://api.github.com/users/kichik/repos","events_url":"https://api.github.com/users/kichik/events{/privacy}","received_events_url":"https://api.github.com/users/kichik/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/3108863151","html_url":"https://github.com/sidekiq/sidekiq/issues/6768#issuecomment-3108863151","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/6768","id":3108863151,"node_id":"IC_kwDOADDA9M65TXyv","user":{"login":"KonnorRogers","id":26425882,"node_id":"MDQ6VXNlcjI2NDI1ODgy","avatar_url":"https://avatars.githubusercontent.com/u/26425882?v=4","gravatar_id":"","url":"https://api.github.com/users/KonnorRogers","html_url":"https://github.com/KonnorRogers","followers_url":"https://api.github.com/users/KonnorRogers/followers","following_url":"https://api.github.com/users/KonnorRogers/following{/other_user}","gists_url":"https://api.github.com/users/KonnorRogers/gists{/gist_id}","starred_url":"https://api.github.com/users/KonnorRogers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KonnorRogers/subscriptions","organizations_url":"https://api.github.com/users/KonnorRogers/orgs","repos_url":"https://api.github.com/users/KonnorRogers/repos","events_url":"https://api.github.com/users/KonnorRogers/events{/privacy}","received_events_url":"https://api.github.com/users/KonnorRogers/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-07-23T14:18:45Z","updated_at":"2025-07-23T14:18:45Z","body":"Shooting from the hip here:\n\nhttps://github.com/sidekiq/sidekiq/blob/098dc1bc6a58213d3b658a76768445b84bebb677/web/assets/javascripts/application.js#L166-L168\n\n^ seems like there may be a small gap between when page is replaced and when listeners are added.\n\nInstead of direct binding like you do here:\n\nhttps://github.com/sidekiq/sidekiq/blob/098dc1bc6a58213d3b658a76768445b84bebb677/web/assets/javascripts/application.js#L21C1-L29C1\n\nYou could try using event delegation which will always fire the events instead of needing to replace the page and then attach the listeners. \n\n```js\nfunction handleConfirmDialog (event) {\n  const target = event.target\n   \n  if (target.localName !== \"input\") { return }\n  if (!target.hasAttribute(\"data-confirm\")) { return }\n\n  const confirmMessage = target.getAttribute(\"data-confirm\")\n\n  if (!window.confirm(confirmMessage)) {\n    event.preventDefault()\n    event.stopPropagation()\n  }\n}\n\ndocument.addEventListener(\"click\", handleConfirmDialog)\n```\n\nThe other option is first making a temporary page, inserting the nodes there, binding the listeners, and then replacing the `#page` with the events already added, but thats a little messier.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/3108863151/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"KonnorRogers","id":26425882,"node_id":"MDQ6VXNlcjI2NDI1ODgy","avatar_url":"https://avatars.githubusercontent.com/u/26425882?v=4","gravatar_id":"","url":"https://api.github.com/users/KonnorRogers","html_url":"https://github.com/KonnorRogers","followers_url":"https://api.github.com/users/KonnorRogers/followers","following_url":"https://api.github.com/users/KonnorRogers/following{/other_user}","gists_url":"https://api.github.com/users/KonnorRogers/gists{/gist_id}","starred_url":"https://api.github.com/users/KonnorRogers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KonnorRogers/subscriptions","organizations_url":"https://api.github.com/users/KonnorRogers/orgs","repos_url":"https://api.github.com/users/KonnorRogers/repos","events_url":"https://api.github.com/users/KonnorRogers/events{/privacy}","received_events_url":"https://api.github.com/users/KonnorRogers/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/3110031490","html_url":"https://github.com/sidekiq/sidekiq/issues/6768#issuecomment-3110031490","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/6768","id":3110031490,"node_id":"IC_kwDOADDA9M65X1CC","user":{"login":"pascallaliberte","id":104179,"node_id":"MDQ6VXNlcjEwNDE3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/104179?v=4","gravatar_id":"","url":"https://api.github.com/users/pascallaliberte","html_url":"https://github.com/pascallaliberte","followers_url":"https://api.github.com/users/pascallaliberte/followers","following_url":"https://api.github.com/users/pascallaliberte/following{/other_user}","gists_url":"https://api.github.com/users/pascallaliberte/gists{/gist_id}","starred_url":"https://api.github.com/users/pascallaliberte/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pascallaliberte/subscriptions","organizations_url":"https://api.github.com/users/pascallaliberte/orgs","repos_url":"https://api.github.com/users/pascallaliberte/repos","events_url":"https://api.github.com/users/pascallaliberte/events{/privacy}","received_events_url":"https://api.github.com/users/pascallaliberte/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-07-23T20:21:25Z","updated_at":"2025-07-23T20:21:25Z","body":"+1 for @KonnorRogers event delegation approach.\n\nWrapping `addListeners()` in a `queueMicrotask` might be a quick fix too.\n\n```js\nqueueMicrotask(() => addListeners());\n```","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/3110031490/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"pascallaliberte","id":104179,"node_id":"MDQ6VXNlcjEwNDE3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/104179?v=4","gravatar_id":"","url":"https://api.github.com/users/pascallaliberte","html_url":"https://github.com/pascallaliberte","followers_url":"https://api.github.com/users/pascallaliberte/followers","following_url":"https://api.github.com/users/pascallaliberte/following{/other_user}","gists_url":"https://api.github.com/users/pascallaliberte/gists{/gist_id}","starred_url":"https://api.github.com/users/pascallaliberte/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pascallaliberte/subscriptions","organizations_url":"https://api.github.com/users/pascallaliberte/orgs","repos_url":"https://api.github.com/users/pascallaliberte/repos","events_url":"https://api.github.com/users/pascallaliberte/events{/privacy}","received_events_url":"https://api.github.com/users/pascallaliberte/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":18782043361,"node_id":"MEE_lADOADDA9M7B_avRzwAAAARffzzh","url":"https://api.github.com/repos/sidekiq/sidekiq/issues/events/18782043361","actor":{"login":"KonnorRogers","id":26425882,"node_id":"MDQ6VXNlcjI2NDI1ODgy","avatar_url":"https://avatars.githubusercontent.com/u/26425882?v=4","gravatar_id":"","url":"https://api.github.com/users/KonnorRogers","html_url":"https://github.com/KonnorRogers","followers_url":"https://api.github.com/users/KonnorRogers/followers","following_url":"https://api.github.com/users/KonnorRogers/following{/other_user}","gists_url":"https://api.github.com/users/KonnorRogers/gists{/gist_id}","starred_url":"https://api.github.com/users/KonnorRogers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KonnorRogers/subscriptions","organizations_url":"https://api.github.com/users/KonnorRogers/orgs","repos_url":"https://api.github.com/users/KonnorRogers/repos","events_url":"https://api.github.com/users/KonnorRogers/events{/privacy}","received_events_url":"https://api.github.com/users/KonnorRogers/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2025-07-23T20:21:26Z","performed_via_github_app":null},{"id":18782043388,"node_id":"SE_lADOADDA9M7B_avRzwAAAARffzz8","url":"https://api.github.com/repos/sidekiq/sidekiq/issues/events/18782043388","actor":{"login":"KonnorRogers","id":26425882,"node_id":"MDQ6VXNlcjI2NDI1ODgy","avatar_url":"https://avatars.githubusercontent.com/u/26425882?v=4","gravatar_id":"","url":"https://api.github.com/users/KonnorRogers","html_url":"https://github.com/KonnorRogers","followers_url":"https://api.github.com/users/KonnorRogers/followers","following_url":"https://api.github.com/users/KonnorRogers/following{/other_user}","gists_url":"https://api.github.com/users/KonnorRogers/gists{/gist_id}","starred_url":"https://api.github.com/users/KonnorRogers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KonnorRogers/subscriptions","organizations_url":"https://api.github.com/users/KonnorRogers/orgs","repos_url":"https://api.github.com/users/KonnorRogers/repos","events_url":"https://api.github.com/users/KonnorRogers/events{/privacy}","received_events_url":"https://api.github.com/users/KonnorRogers/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2025-07-23T20:21:26Z","performed_via_github_app":null},{"id":18820107614,"node_id":"CE_lADOADDA9M7B_avRzwAAAARhxA1e","url":"https://api.github.com/repos/sidekiq/sidekiq/issues/events/18820107614","actor":{"login":"mperham","id":2911,"node_id":"MDQ6VXNlcjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/2911?v=4","gravatar_id":"","url":"https://api.github.com/users/mperham","html_url":"https://github.com/mperham","followers_url":"https://api.github.com/users/mperham/followers","following_url":"https://api.github.com/users/mperham/following{/other_user}","gists_url":"https://api.github.com/users/mperham/gists{/gist_id}","starred_url":"https://api.github.com/users/mperham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mperham/subscriptions","organizations_url":"https://api.github.com/users/mperham/orgs","repos_url":"https://api.github.com/users/mperham/repos","events_url":"https://api.github.com/users/mperham/events{/privacy}","received_events_url":"https://api.github.com/users/mperham/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"f01b2c9a771ad31eeb571b4f2de635d22aa0c65a","commit_url":"https://api.github.com/repos/sidekiq/sidekiq/commits/f01b2c9a771ad31eeb571b4f2de635d22aa0c65a","created_at":"2025-07-25T19:17:09Z","state_reason":null,"performed_via_github_app":null},{"id":18821144674,"node_id":"REFE_lADOADDA9M7B_avRzwAAAARh0-Bi","url":"https://api.github.com/repos/sidekiq/sidekiq/issues/events/18821144674","actor":{"login":"pull[bot]","id":39814207,"node_id":"MDM6Qm90Mzk4MTQyMDc=","avatar_url":"https://avatars.githubusercontent.com/in/12910?v=4","gravatar_id":"","url":"https://api.github.com/users/pull%5Bbot%5D","html_url":"https://github.com/apps/pull","followers_url":"https://api.github.com/users/pull%5Bbot%5D/followers","following_url":"https://api.github.com/users/pull%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/pull%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/pull%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pull%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/pull%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/pull%5Bbot%5D/repos","events_url":"https://api.github.com/users/pull%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/pull%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"f01b2c9a771ad31eeb571b4f2de635d22aa0c65a","commit_url":"https://api.github.com/repos/TheDegenerateDev5150/sidekiq/commits/f01b2c9a771ad31eeb571b4f2de635d22aa0c65a","created_at":"2025-07-25T20:31:06Z","performed_via_github_app":null}]