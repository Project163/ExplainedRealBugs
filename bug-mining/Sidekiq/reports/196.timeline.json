[{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/309131547","html_url":"https://github.com/sidekiq/sidekiq/issues/3519#issuecomment-309131547","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/3519","id":309131547,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTEzMTU0Nw==","user":{"login":"mperham","id":2911,"node_id":"MDQ6VXNlcjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/2911?v=4","gravatar_id":"","url":"https://api.github.com/users/mperham","html_url":"https://github.com/mperham","followers_url":"https://api.github.com/users/mperham/followers","following_url":"https://api.github.com/users/mperham/following{/other_user}","gists_url":"https://api.github.com/users/mperham/gists{/gist_id}","starred_url":"https://api.github.com/users/mperham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mperham/subscriptions","organizations_url":"https://api.github.com/users/mperham/orgs","repos_url":"https://api.github.com/users/mperham/repos","events_url":"https://api.github.com/users/mperham/events{/privacy}","received_events_url":"https://api.github.com/users/mperham/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-16T20:53:16Z","updated_at":"2017-06-16T20:53:16Z","body":"`deleted` isn't a counter in this case, it's a flag meaning the batch was successful and will be deleted from Redis shortly.\r\n\r\nThe issue is that once a batch is deleted, it's running state data is also deleted.  This meant the `Status#complete?` method erroneously thought the batch was still incomplete.  That's a bug and will be fixed in the next release.\r\n\r\nYour overall workflow's complete callback was fired early because all jobs had completed and all children had completed.  This is expected behavior.\r\n\r\nhttps://gist.github.com/srpouyet/68b634626d61c4539bf0e6c1de734169#file-sidekiq_test_log-txt-L10\r\n\r\nThe overall workflow's success callback was not fired early because the child batch's success callback added more jobs.  This is expected behavior.","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/309131547/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mperham","id":2911,"node_id":"MDQ6VXNlcjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/2911?v=4","gravatar_id":"","url":"https://api.github.com/users/mperham","html_url":"https://github.com/mperham","followers_url":"https://api.github.com/users/mperham/followers","following_url":"https://api.github.com/users/mperham/following{/other_user}","gists_url":"https://api.github.com/users/mperham/gists{/gist_id}","starred_url":"https://api.github.com/users/mperham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mperham/subscriptions","organizations_url":"https://api.github.com/users/mperham/orgs","repos_url":"https://api.github.com/users/mperham/repos","events_url":"https://api.github.com/users/mperham/events{/privacy}","received_events_url":"https://api.github.com/users/mperham/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/309198204","html_url":"https://github.com/sidekiq/sidekiq/issues/3519#issuecomment-309198204","issue_url":"https://api.github.com/repos/sidekiq/sidekiq/issues/3519","id":309198204,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTE5ODIwNA==","user":{"login":"srpouyet","id":196046,"node_id":"MDQ6VXNlcjE5NjA0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/196046?v=4","gravatar_id":"","url":"https://api.github.com/users/srpouyet","html_url":"https://github.com/srpouyet","followers_url":"https://api.github.com/users/srpouyet/followers","following_url":"https://api.github.com/users/srpouyet/following{/other_user}","gists_url":"https://api.github.com/users/srpouyet/gists{/gist_id}","starred_url":"https://api.github.com/users/srpouyet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srpouyet/subscriptions","organizations_url":"https://api.github.com/users/srpouyet/orgs","repos_url":"https://api.github.com/users/srpouyet/repos","events_url":"https://api.github.com/users/srpouyet/events{/privacy}","received_events_url":"https://api.github.com/users/srpouyet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-06-17T07:01:59Z","updated_at":"2017-06-17T07:01:59Z","body":"Aha, that explains it. As a workaround I'll just check for the `deleted` flag. Thanks for your quick reply and picking it up for the next release. üëç ","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/sidekiq/sidekiq/issues/comments/309198204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"srpouyet","id":196046,"node_id":"MDQ6VXNlcjE5NjA0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/196046?v=4","gravatar_id":"","url":"https://api.github.com/users/srpouyet","html_url":"https://github.com/srpouyet","followers_url":"https://api.github.com/users/srpouyet/followers","following_url":"https://api.github.com/users/srpouyet/following{/other_user}","gists_url":"https://api.github.com/users/srpouyet/gists{/gist_id}","starred_url":"https://api.github.com/users/srpouyet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srpouyet/subscriptions","organizations_url":"https://api.github.com/users/srpouyet/orgs","repos_url":"https://api.github.com/users/srpouyet/repos","events_url":"https://api.github.com/users/srpouyet/events{/privacy}","received_events_url":"https://api.github.com/users/srpouyet/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1133602234,"node_id":"MDExOkNsb3NlZEV2ZW50MTEzMzYwMjIzNA==","url":"https://api.github.com/repos/sidekiq/sidekiq/issues/events/1133602234","actor":{"login":"mperham","id":2911,"node_id":"MDQ6VXNlcjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/2911?v=4","gravatar_id":"","url":"https://api.github.com/users/mperham","html_url":"https://github.com/mperham","followers_url":"https://api.github.com/users/mperham/followers","following_url":"https://api.github.com/users/mperham/following{/other_user}","gists_url":"https://api.github.com/users/mperham/gists{/gist_id}","starred_url":"https://api.github.com/users/mperham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mperham/subscriptions","organizations_url":"https://api.github.com/users/mperham/orgs","repos_url":"https://api.github.com/users/mperham/repos","events_url":"https://api.github.com/users/mperham/events{/privacy}","received_events_url":"https://api.github.com/users/mperham/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"e03adc06987486d3e774587c274f03e571f55940","commit_url":"https://api.github.com/repos/sidekiq/sidekiq/commits/e03adc06987486d3e774587c274f03e571f55940","created_at":"2017-06-21T20:11:09Z","state_reason":null,"performed_via_github_app":null},{"id":13766717727,"node_id":"REFE_lADOADDA9M4OGfuUzwAAAAM0j3Ef","url":"https://api.github.com/repos/sidekiq/sidekiq/issues/events/13766717727","actor":{"login":"AlexSc","id":98665,"node_id":"MDQ6VXNlcjk4NjY1","avatar_url":"https://avatars.githubusercontent.com/u/98665?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexSc","html_url":"https://github.com/AlexSc","followers_url":"https://api.github.com/users/AlexSc/followers","following_url":"https://api.github.com/users/AlexSc/following{/other_user}","gists_url":"https://api.github.com/users/AlexSc/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexSc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexSc/subscriptions","organizations_url":"https://api.github.com/users/AlexSc/orgs","repos_url":"https://api.github.com/users/AlexSc/repos","events_url":"https://api.github.com/users/AlexSc/events{/privacy}","received_events_url":"https://api.github.com/users/AlexSc/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"e03adc06987486d3e774587c274f03e571f55940","commit_url":"https://api.github.com/repos/GoCarrot/sidekiq/commits/e03adc06987486d3e774587c274f03e571f55940","created_at":"2024-08-05T16:13:32Z","performed_via_github_app":null}]