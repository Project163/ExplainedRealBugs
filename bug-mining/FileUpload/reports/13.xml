<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:55:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FILEUPLOAD-160] disk leak if multipart parse error</title>
                <link>https://issues.apache.org/jira/browse/FILEUPLOAD-160</link>
                <project id="12310476" key="FILEUPLOAD">Commons FileUpload</project>
                    <description>&lt;p&gt;FleUploadBase.parseRequest() keeps files on disk if parser error occured. Patch&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;diff -r cf24bc636e09 -r f706d95f56b7 src/java/org/apache/commons/fileupload/FileUploadBase.java
--- a/src/java/org/apache/commons/fileupload/FileUploadBase.java	Wed May 28 22:25:00 2008 +0400
+++ b/src/java/org/apache/commons/fileupload/FileUploadBase.java	Thu May 29 15:40:04 2008 +0400
@@ -345,9 +345,10 @@
      */
     &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; List &lt;span class=&quot;code-comment&quot;&gt;/* FileItem */&lt;/span&gt; parseRequest(RequestContext ctx)
             &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; FileUploadException {
+        List items = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList();
+        &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; successful = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
         &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
             FileItemIterator iter = getItemIterator(ctx);
-            List items = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList();
             FileItemFactory fac = getFileItemFactory();
             &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (fac == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                 &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; NullPointerException(
@@ -358,6 +359,7 @@
                 FileItem fileItem = fac.createItem(item.getFieldName(),
                         item.getContentType(), item.isFormField(),
                         item.getName());
+                items.add(fileItem);
                 &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
                     Streams.copy(item.openStream(), fileItem.getOutputStream(),
                             &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
@@ -372,13 +374,24 @@
                     &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; FileItemHeaders fih = item.getHeaders();
                     ((FileItemHeadersSupport) fileItem).setHeaders(fih);
                 }
-                items.add(fileItem);
             }
+            successful = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
             &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; items;
         } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (FileUploadIOException e) {
             &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; (FileUploadException) e.getCause();
         } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {
             &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileUploadException(e.getMessage(), e);
+        } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
+            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!successful) {
+                &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Iterator iterator = items.iterator(); iterator.hasNext();) {
+                    FileItem fileItem = (FileItem) iterator.next();
+                    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
+                        fileItem.delete();
+                    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Throwable e) {
+                        &lt;span class=&quot;code-comment&quot;&gt;// ignore it
&lt;/span&gt;+                    }
+                }
+            }
         }
     }
 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12397071">FILEUPLOAD-160</key>
            <summary>disk leak if multipart parse error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jochen@apache.org">Jochen Wiedmann</assignee>
                                    <reporter username="yozh">Stepan Koltsov</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 May 2008 11:48:18 +0000</created>
                <updated>Mon, 5 Jun 2017 13:54:44 +0000</updated>
                            <resolved>Sun, 18 Jan 2009 01:40:33 +0000</resolved>
                                                    <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12633823" author="yozh" created="Tue, 23 Sep 2008 17:48:40 +0000"  >&lt;p&gt;Hello!&lt;/p&gt;</comment>
                            <comment id="12664899" author="jochen@apache.org" created="Sun, 18 Jan 2009 01:40:33 +0000"  >&lt;p&gt;Applied, thank you!&lt;/p&gt;</comment>
                            <comment id="16036972" author="chtompki" created="Mon, 5 Jun 2017 13:54:44 +0000"  >&lt;p&gt;1.2.2 Released.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12374366">FILEUPLOAD-141</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>43072</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 23 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0sknj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164823</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>