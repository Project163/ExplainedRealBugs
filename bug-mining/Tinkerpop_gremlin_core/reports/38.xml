<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:11:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TINKERPOP-1869] Profile step and iterate do not play nicely with each other</title>
                <link>https://issues.apache.org/jira/browse/TINKERPOP-1869</link>
                <project id="12316520" key="TINKERPOP">TinkerPop</project>
                    <description>&lt;p&gt;Profile step doesn&apos;t like it if there are any other steps after it. However if someone calls profile().iterate() they will get an error as iterate appends a NoneStep to the end of the traversal.&lt;br/&gt;
Even though this means that the results of the profile would never be returned I think that profile step should allow None step to follow it.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13130554">TINKERPOP-1869</key>
            <summary>Profile step and iterate do not play nicely with each other</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="spmallette">Stephen Mallette</assignee>
                                    <reporter username="bryncooke">Bryn Cooke</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Jan 2018 15:29:26 +0000</created>
                <updated>Wed, 25 Apr 2018 16:05:49 +0000</updated>
                            <resolved>Wed, 25 Apr 2018 16:05:49 +0000</resolved>
                                    <version>3.3.1</version>
                                    <fixVersion>3.4.0</fixVersion>
                    <fixVersion>3.3.3</fixVersion>
                                    <component>process</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16324432" author="rdale" created="Fri, 12 Jan 2018 19:25:35 +0000"  >&lt;p&gt;Is this with remote connections only?&lt;/p&gt;</comment>
                            <comment id="16324444" author="rdale" created="Fri, 12 Jan 2018 19:30:52 +0000"  >&lt;p&gt;I see.  g.V().out(&apos;created&apos;).profile().iterate()&lt;br/&gt;
Works in 3.2.7&lt;br/&gt;
Error in 3.3.1:  When specified, the profile()-Step must be the last step or followed only by the cap()-step and/or requirements step.&lt;/p&gt;</comment>
                            <comment id="16452050" author="githubbot" created="Wed, 25 Apr 2018 10:51:59 +0000"  >&lt;p&gt;GitHub user spmallette opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/857&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/857&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/TINKERPOP-1869&quot; title=&quot;Profile step and iterate do not play nicely with each other&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TINKERPOP-1869&quot;&gt;&lt;del&gt;TINKERPOP-1869&lt;/del&gt;&lt;/a&gt; Allowed iterate() after profile()&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/TINKERPOP-1869&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TINKERPOP-1869&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    The `iterate()` method adds a `NoneStep` that was preventing traversals like `g.V().profile().iterate()`. Not the typical type of traversal you would do, but it seems like it should be allowed for consistency sake.&lt;/p&gt;

&lt;p&gt;    All tests pass with `docker/build.sh -t -i`&lt;/p&gt;

&lt;p&gt;    VOTE +1&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/apache/tinkerpop&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/TINKERPOP-1869&quot; title=&quot;Profile step and iterate do not play nicely with each other&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TINKERPOP-1869&quot;&gt;&lt;del&gt;TINKERPOP-1869&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/857.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/857.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #857&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 374b51a3fcb58ee6a7601b32d80ccd1e7a680f6a&lt;br/&gt;
Author: Stephen Mallette &amp;lt;spmva@...&amp;gt;&lt;br/&gt;
Date:   2018-04-24T23:07:28Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/TINKERPOP-1869&quot; title=&quot;Profile step and iterate do not play nicely with each other&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TINKERPOP-1869&quot;&gt;&lt;del&gt;TINKERPOP-1869&lt;/del&gt;&lt;/a&gt; Allowed iterate() after profile()&lt;/p&gt;

&lt;p&gt;    The iterate() method adds a NoneStep that was preventing traversals like g.V().profile().iterate(). Not the typical type of traversal you would do, but it seems like it should be allowed for consistency sake.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16452184" author="githubbot" created="Wed, 25 Apr 2018 12:39:37 +0000"  >&lt;p&gt;Github user robertdale commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/857&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/857&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    VOTE +1&lt;/p&gt;</comment>
                            <comment id="16452245" author="githubbot" created="Wed, 25 Apr 2018 13:28:58 +0000"  >&lt;p&gt;Github user jorgebay commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/857#discussion_r184057436&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/857#discussion_r184057436&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: gremlin-core/src/main/java/org/apache/tinkerpop/gremlin/process/traversal/strategy/verification/StandardVerificationStrategy.java &amp;#8212;&lt;br/&gt;
    @@ -63,15 +64,17 @@ public void apply(final Traversal.Admin&amp;lt;?, ?&amp;gt; traversal) &lt;/p&gt;
{
                     throw new VerificationException(&quot;The parent of a reducing barrier can not be repeat()-step: &quot; + step, traversal);
             }

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// The ProfileSideEffectStep must be the last step, 2nd last step when accompanied by the cap step,&lt;/li&gt;
	&lt;li&gt;// or 3rd to last when the traversal ends with a RequirementsStep.&lt;br/&gt;
    +        // The ProfileSideEffectStep must be one of the following&lt;br/&gt;
    +        // (1) the last step&lt;br/&gt;
    +        // (2) 2nd last step when accompanied by the cap step or none step (i.e. iterate() to nothing)&lt;br/&gt;
    +        // (3) 3rd to last when the traversal ends with a RequirementsStep.&lt;br/&gt;
             final Step&amp;lt;?, ?&amp;gt; endStep = traversal.asAdmin().getEndStep();&lt;br/&gt;
             if (TraversalHelper.hasStepOfClass(ProfileSideEffectStep.class, traversal) &amp;amp;&amp;amp;&lt;br/&gt;
                     !(endStep instanceof ProfileSideEffectStep ||&lt;br/&gt;
                             (endStep instanceof SideEffectCapStep &amp;amp;&amp;amp; endStep.getPreviousStep() instanceof ProfileSideEffectStep) ||&lt;/li&gt;
	&lt;li&gt;(endStep instanceof RequirementsStep &amp;amp;&amp;amp; (&lt;/li&gt;
	&lt;li&gt;endStep.getPreviousStep() instanceof SideEffectCapStep ||&lt;/li&gt;
	&lt;li&gt;endStep.getPreviousStep() instanceof ProfileSideEffectStep)))) {&lt;br/&gt;
    +                        (endStep instanceof NoneStep &amp;amp;&amp;amp; endStep.getPreviousStep() instanceof SideEffectCapStep &amp;amp;&amp;amp; endStep.getPreviousStep().getPreviousStep() instanceof ProfileSideEffectStep) ||
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    I think we can save some `instanceof` checks if we introduce a method similar to `TraversalHelper.hasStepOfClass(ProfileSideEffectStep.class, traversal)` but instead of returning a boolean, it returns the step instance. Then, from the `ProfileSideEffectStep` instance itself, it&apos;s easier to do the checks.&lt;/p&gt;</comment>
                            <comment id="16452264" author="githubbot" created="Wed, 25 Apr 2018 13:40:02 +0000"  >&lt;p&gt;Github user spmallette commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/857#discussion_r184062120&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/857#discussion_r184062120&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: gremlin-core/src/main/java/org/apache/tinkerpop/gremlin/process/traversal/strategy/verification/StandardVerificationStrategy.java &amp;#8212;&lt;br/&gt;
    @@ -63,15 +64,17 @@ public void apply(final Traversal.Admin&amp;lt;?, ?&amp;gt; traversal) &lt;/p&gt;
{
                     throw new VerificationException(&quot;The parent of a reducing barrier can not be repeat()-step: &quot; + step, traversal);
             }

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// The ProfileSideEffectStep must be the last step, 2nd last step when accompanied by the cap step,&lt;/li&gt;
	&lt;li&gt;// or 3rd to last when the traversal ends with a RequirementsStep.&lt;br/&gt;
    +        // The ProfileSideEffectStep must be one of the following&lt;br/&gt;
    +        // (1) the last step&lt;br/&gt;
    +        // (2) 2nd last step when accompanied by the cap step or none step (i.e. iterate() to nothing)&lt;br/&gt;
    +        // (3) 3rd to last when the traversal ends with a RequirementsStep.&lt;br/&gt;
             final Step&amp;lt;?, ?&amp;gt; endStep = traversal.asAdmin().getEndStep();&lt;br/&gt;
             if (TraversalHelper.hasStepOfClass(ProfileSideEffectStep.class, traversal) &amp;amp;&amp;amp;&lt;br/&gt;
                     !(endStep instanceof ProfileSideEffectStep ||&lt;br/&gt;
                             (endStep instanceof SideEffectCapStep &amp;amp;&amp;amp; endStep.getPreviousStep() instanceof ProfileSideEffectStep) ||&lt;/li&gt;
	&lt;li&gt;(endStep instanceof RequirementsStep &amp;amp;&amp;amp; (&lt;/li&gt;
	&lt;li&gt;endStep.getPreviousStep() instanceof SideEffectCapStep ||&lt;/li&gt;
	&lt;li&gt;endStep.getPreviousStep() instanceof ProfileSideEffectStep)))) {&lt;br/&gt;
    +                        (endStep instanceof NoneStep &amp;amp;&amp;amp; endStep.getPreviousStep() instanceof SideEffectCapStep &amp;amp;&amp;amp; endStep.getPreviousStep().getPreviousStep() instanceof ProfileSideEffectStep) ||
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    yeah - @dkuppitz is thinking about this kind of stuff. i had ideas too, but figured it was something for a different issue. Generally speaking, I think that if we want to do something about the complexity of strategy writing, we really need to carefully analyze the strategies that are out there and find good general functions to add that can be best used across all of them rather than looking at just a bad problem in one and build a function that only fits that case. &lt;/p&gt;</comment>
                            <comment id="16452565" author="githubbot" created="Wed, 25 Apr 2018 16:05:24 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/857&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/857&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 29 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3oux3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>