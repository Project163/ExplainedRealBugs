<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:12:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TINKERPOP-2971] having order() before fold() omits an empty list in GroupStep&apos;s value traversal</title>
                <link>https://issues.apache.org/jira/browse/TINKERPOP-2971</link>
                <project id="12316520" key="TINKERPOP">TinkerPop</project>
                    <description>&lt;p&gt;Using the modern graph,&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
gremlin&amp;gt; g.V().group().by().by(out().fold())
==&amp;gt;[v[1]:[v[3],v[2],v[4]],v[2]:[],v[3]:[],v[4]:[v[5],v[3]],v[5]:[],v[6]:[v[3]]]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;tt&gt;out().fold()&lt;/tt&gt; produces an empty list when there is no solution for &lt;tt&gt;out()&lt;/tt&gt; in a value traversal of GroupStep. However if I put &lt;tt&gt;order()&lt;/tt&gt; those empty lists are gone.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
gremlin&amp;gt; g.V().group().by().by(out().order().fold())
==&amp;gt;[v[1]:[v[2],v[3],v[4]],v[4]:[v[3],v[5]],v[6]:[v[3]]]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I think this is not an expected behavior.&#160;&lt;/p&gt;

&lt;p&gt;I don&apos;t see the similar effect in by() itself&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
gremlin&amp;gt; g.V().as(&lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;).select(&lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;).by(out().fold())
==&amp;gt;[v[3],v[2],v[4]]
==&amp;gt;[]
==&amp;gt;[]
==&amp;gt;[v[5],v[3]]
==&amp;gt;[]
==&amp;gt;[v[3]]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

gremlin&amp;gt; g.V().as(&lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;).select(&lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;).by(out().order().fold())
==&amp;gt;[v[2],v[3],v[4]]
==&amp;gt;[]
==&amp;gt;[]
==&amp;gt;[v[3],v[5]]
==&amp;gt;[]
==&amp;gt;[v[3]]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So likely this is GroupStep specific issue. We need to investigate how this occurs and fix if needed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13544172">TINKERPOP-2971</key>
            <summary>having order() before fold() omits an empty list in GroupStep&apos;s value traversal</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="spmallette">Stephen Mallette</assignee>
                                    <reporter username="redtree1112">Norio Akagi</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Jul 2023 19:09:30 +0000</created>
                <updated>Fri, 28 Mar 2025 15:36:46 +0000</updated>
                            <resolved>Fri, 28 Mar 2025 15:36:46 +0000</resolved>
                                    <version>3.6.4</version>
                                    <fixVersion>4.0.0</fixVersion>
                    <fixVersion>3.8.0</fixVersion>
                                    <component>tinkergraph</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17783409" author="xiazcy" created="Tue, 7 Nov 2023 00:11:57 +0000"  >&lt;p&gt;I dug a bit into this, and these are what I understood is happening. It looks like because group() is a barrier step, it will process the result of the by() based on the barrier involved (which is determined by the first and only first non-local barrier step).&lt;/p&gt;

&lt;p&gt;Before group() puts anything into the result map, it &lt;a href=&quot;https://github.com/apache/tinkerpop/blob/1e9e18d5d80ff3577c4543f24bc05083f71ace57/gremlin-core/src/main/java/org/apache/tinkerpop/gremlin/process/traversal/step/map/GroupStep.java#L132&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;does a check&lt;/a&gt; to see if the barrier produces any results. In by(out().fold()), the barrier is fold(), and the FoldStep will return empty results (i.e. no out vertices) as an empty list [] so that gets passed on into the result map. However in by(out().order().fold()), the barrier step becomes order() . The OrderGlobalStep will not return any empty results, so there is no result to be added into the map and thus is not passed on.&lt;br/&gt;
I.e. no result is returned with order() but fold() will return an empty list:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
gremlin&amp;gt; g.V(2).out()
gremlin&amp;gt; g.V(2).out().order()
gremlin&amp;gt; g.V(2).out().fold()
==&amp;gt;[]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Basically the one barrier is what&#8217;s filtering the traverser from result.&lt;/p&gt;

&lt;p&gt;The select() (or other steps) doesn&#8217;t do that because the result does not rely on any barrier so all results are passed through.&lt;/p&gt;

&lt;p&gt;Based on the &lt;a href=&quot;https://github.com/apache/tinkerpop/blob/1e9e18d5d80ff3577c4543f24bc05083f71ace57/gremlin-core/src/main/java/org/apache/tinkerpop/gremlin/process/traversal/step/Grouping.java#L66&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;current implementation&lt;/a&gt;, I think this is the expected behaviour. However, one potential change is to use the last barrier step in the list, i.e. use FoldStep instead of OrderGlobalStep in this example, but more investigation needs to be done to understand the full implications of such a change on traversal execution.&lt;/p&gt;</comment>
                            <comment id="17784593" author="JIRAUSER291439" created="Thu, 9 Nov 2023 20:01:47 +0000"  >&lt;p&gt;Might be related to OLAP. Try this against SparkGraphComputer and see what happens.&lt;/p&gt;</comment>
                            <comment id="17938378" author="githubbot" created="Tue, 25 Mar 2025 23:20:44 +0000"  >&lt;p&gt;spmallette opened a new pull request, #3076:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/3076&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/3076&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   &lt;a href=&quot;https://issues.apache.org/jira/browse/TINKERPOP-2971&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TINKERPOP-2971&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   Ensured that reducing/supplying barriers that follow collecting barriers get some respect. Basically, `group()` used to do this:&lt;/p&gt;

&lt;p&gt;   ```&lt;br/&gt;
   gremlin&amp;gt; g.V().has(&quot;person&quot;,&quot;name&quot;,P.within(&quot;vadas&quot;,&quot;peter&quot;)).group().by().by(__.out().fold())&lt;br/&gt;
   ==&amp;gt;[v&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;:[],v&lt;span class=&quot;error&quot;&gt;&amp;#91;6&amp;#93;&lt;/span&gt;:[v&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;]]&lt;br/&gt;
   gremlin&amp;gt; g.V().has(&quot;person&quot;,&quot;name&quot;,P.within(&quot;vadas&quot;,&quot;peter&quot;)).group().by().by(__.out().order().fold())&lt;br/&gt;
   ==&amp;gt;[v&lt;span class=&quot;error&quot;&gt;&amp;#91;6&amp;#93;&lt;/span&gt;:[v&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;]]&lt;br/&gt;
   ```&lt;/p&gt;

&lt;p&gt;   after this change, the second traversal has the same result as the first as one would expect. Had to add an entry for gryo. I guess we never had tests that pushed an adjacent vertex into the traverser (if we had I guess we&apos;d have found this bug earlier) and as a result gryo needs to know about it.&lt;/p&gt;

&lt;p&gt;   VOTE +1&lt;/p&gt;

</comment>
                            <comment id="17938384" author="githubbot" created="Tue, 25 Mar 2025 23:54:44 +0000"  >&lt;p&gt;Cole-Greer commented on code in PR #3076:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/3076#discussion_r2013083924&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/3076#discussion_r2013083924&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
gremlin-core/src/main/java/org/apache/tinkerpop/gremlin/structure/util/detached/DetachedFactory.java:&lt;br/&gt;
##########&lt;br/&gt;
@@ -26,6 +27,7 @@&lt;br/&gt;
 import org.apache.tinkerpop.gremlin.structure.Property;&lt;br/&gt;
 import org.apache.tinkerpop.gremlin.structure.Vertex;&lt;br/&gt;
 import org.apache.tinkerpop.gremlin.structure.VertexProperty;&lt;br/&gt;
+import org.apache.tinkerpop.gremlin.structure.util.star.StarGraph;&lt;/p&gt;

&lt;p&gt;Review Comment:&lt;br/&gt;
   Nit: unused?&lt;/p&gt;


</comment>
                            <comment id="17938391" author="githubbot" created="Wed, 26 Mar 2025 00:27:29 +0000"  >&lt;p&gt;Cole-Greer commented on PR #3076:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/3076#issuecomment-2752828542&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/3076#issuecomment-2752828542&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   VOTE +1&lt;/p&gt;

</comment>
                            <comment id="17938756" author="githubbot" created="Wed, 26 Mar 2025 23:23:14 +0000"  >&lt;p&gt;xiazcy commented on PR #3076:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/3076#issuecomment-2755988465&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/3076#issuecomment-2755988465&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   VOTE +1&lt;/p&gt;

</comment>
                            <comment id="17939255" author="githubbot" created="Fri, 28 Mar 2025 15:35:12 +0000"  >&lt;p&gt;spmallette merged PR #3076:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/3076&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/3076&lt;/a&gt;&lt;/p&gt;

</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            32 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1j968:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>