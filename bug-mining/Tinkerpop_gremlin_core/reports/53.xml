<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:11:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TINKERPOP-1992] count has negative time in profile</title>
                <link>https://issues.apache.org/jira/browse/TINKERPOP-1992</link>
                <project id="12316520" key="TINKERPOP">TinkerPop</project>
                    <description>
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;gremlin&amp;gt; g.V().group().by().by(bothE().count()).profile()
==&amp;gt;Traversal Metrics
Step                                                               Count  Traversers       Time (ms)    % Dur
=============================================================================================================
TinkerGraphStep(vertex,[])                                         19172       19172           4.957     5.24
GroupStep(identity,[VertexStep(BOTH,edge), Prof...                     1           1          89.696    94.76
  VertexStep(BOTH,edge)                                            84812       84812          50.723
  CountGlobalStep                                                  19172       19172         -39.649
                                            &amp;gt;TOTAL                     -           -          94.654        -

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13167755">TINKERPOP-1992</key>
            <summary>count has negative time in profile</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="spmallette">Stephen Mallette</assignee>
                                    <reporter username="rdale">Robert Dale</reporter>
                        <labels>
                    </labels>
                <created>Fri, 22 Jun 2018 21:22:08 +0000</created>
                <updated>Thu, 28 Feb 2019 16:36:33 +0000</updated>
                            <resolved>Thu, 28 Feb 2019 16:36:33 +0000</resolved>
                                    <version>3.3.3</version>
                    <version>3.2.9</version>
                                    <fixVersion>3.3.6</fixVersion>
                    <fixVersion>3.4.1</fixVersion>
                                    <component>process</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16520789" author="rdale" created="Fri, 22 Jun 2018 21:24:11 +0000"  >&lt;p&gt;I&apos;ve tried other variants of count() and groupCount(). It seems to be this specific usage only.&lt;/p&gt;</comment>
                            <comment id="16520793" author="rdale" created="Fri, 22 Jun 2018 21:27:14 +0000"  >&lt;p&gt;Tested on TinkerGraph&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Steps to reproduce:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;gremlin&amp;gt; graph = TinkerFactory.createModern()
==&amp;gt;tinkergraph[vertices:6 edges:6]
gremlin&amp;gt; g = graph.traversal()
==&amp;gt;graphtraversalsource[tinkergraph[vertices:6 edges:6], standard]
gremlin&amp;gt; g.V().group().by().by(bothE().count()).profile()
==&amp;gt;Traversal Metrics
Step                                                               Count  Traversers       Time (ms)    % Dur
=============================================================================================================
TinkerGraphStep(vertex,[])                                             6           6           2.660    57.28
GroupStep(identity,[VertexStep(BOTH,edge), Prof...                     1           1           1.984    42.72
  VertexStep(BOTH,edge)                                               12          12           0.557
  CountGlobalStep                                                      6           6          -0.506
                                            &amp;gt;TOTAL                     -           -           4.645        -

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16555871" author="dkuppitz" created="Wed, 25 Jul 2018 15:55:38 +0000"  >&lt;p&gt;It actually happens to any reducing step in &lt;tt&gt;group()&lt;/tt&gt;&apos;s value selector.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
gremlin&amp;gt; g.V().group().by().by(bothE().fold()).profile()
==&amp;gt;Traversal Metrics
Step                                                               Count  Traversers       Time (ms)    % Dur
=============================================================================================================
TinkerGraphStep(vertex,[])                                             6           6           0.053    13.94
GroupStep(identity,[VertexStep(BOTH,edge), Prof...                     1           1           0.329    86.06
  VertexStep(BOTH,edge)                                               12          12           0.084
  FoldStep                                                             6           6          -0.063
                                            &amp;gt;TOTAL                     -           -           0.383        -
gremlin&amp;gt; g.V().group().by().by(bothE().values(&lt;span class=&quot;code-quote&quot;&gt;&apos;weight&apos;&lt;/span&gt;).sum()).profile()
==&amp;gt;Traversal Metrics
Step                                                               Count  Traversers       Time (ms)    % Dur
=============================================================================================================
TinkerGraphStep(vertex,[])                                             6           6           0.058    10.54
GroupStep(identity,[VertexStep(BOTH,edge), Prof...                     1           1           0.492    89.46
  VertexStep(BOTH,edge)                                               12          12           0.104
  PropertiesStep([weight],value)                                      12          12           0.086
  SumGlobalStep                                                        6           6          -0.160
                                            &amp;gt;TOTAL                     -           -           0.550        -
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16555992" author="spmallette" created="Wed, 25 Jul 2018 17:09:44 +0000"  >&lt;p&gt;for some reason, that makes me happier - in my head that might make it easier to isolate?&lt;/p&gt;</comment>
                            <comment id="16560032" author="spmallette" created="Fri, 27 Jul 2018 17:21:36 +0000"  >&lt;p&gt;Identified the problem, but not sure how to fix it - note that in &lt;tt&gt;GroupStep&lt;/tt&gt; we grab the first barrier:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/tinkerpop/blob/9ab5efa6772bb831238f6c9a4e46fc925a45ddaa/gremlin-core/src/main/java/org/apache/tinkerpop/gremlin/process/traversal/step/map/GroupStep.java#L73&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/blob/9ab5efa6772bb831238f6c9a4e46fc925a45ddaa/gremlin-core/src/main/java/org/apache/tinkerpop/gremlin/process/traversal/step/map/GroupStep.java#L73&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;and we iterate that:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/tinkerpop/blob/9ab5efa6772bb831238f6c9a4e46fc925a45ddaa/gremlin-core/src/main/java/org/apache/tinkerpop/gremlin/process/traversal/step/map/GroupStep.java#L89&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/blob/9ab5efa6772bb831238f6c9a4e46fc925a45ddaa/gremlin-core/src/main/java/org/apache/tinkerpop/gremlin/process/traversal/step/map/GroupStep.java#L89&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;and therefore if a &lt;tt&gt;ProfileStep&lt;/tt&gt; is present then we don&apos;t start its timer. as a result, when the traversal timers get normalized you end up with a negative value.&lt;/p&gt;</comment>
                            <comment id="16774419" author="githubbot" created="Thu, 21 Feb 2019 19:02:54 +0000"  >&lt;p&gt;spmallette commented on pull request #1069: &lt;a href=&quot;https://issues.apache.org/jira/browse/TINKERPOP-1992&quot; title=&quot;count has negative time in profile&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TINKERPOP-1992&quot;&gt;&lt;del&gt;TINKERPOP-1992&lt;/del&gt;&lt;/a&gt; count has negative time in profile&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/1069&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/1069&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   &lt;a href=&quot;https://issues.apache.org/jira/browse/TINKERPOP-1992&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TINKERPOP-1992&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   Not sure if this the best way to do this but basically introduced an interface called `ProfilingAware` that makes it so that `ProfileStrategy` can notify that step that &quot;profiling&quot; is happening so that the step has a chance to get its life in order. For this particular problem, that meant that `group()` needed to reset its reducing barrier step (if present) for its value traversal (i.e. second `by()` modulator) so that it could internally start the profile timer (which doesn&apos;t happen otherwise. &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16780610" author="githubbot" created="Thu, 28 Feb 2019 15:08:23 +0000"  >&lt;p&gt;spmallette commented on pull request #1069: &lt;a href=&quot;https://issues.apache.org/jira/browse/TINKERPOP-1992&quot; title=&quot;count has negative time in profile&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TINKERPOP-1992&quot;&gt;&lt;del&gt;TINKERPOP-1992&lt;/del&gt;&lt;/a&gt; count has negative time in profile&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/1069&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/1069&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 37 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3v5i7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>