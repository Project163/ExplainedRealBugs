<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:11:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TINKERPOP-1963] Use of reducing step in choose()</title>
                <link>https://issues.apache.org/jira/browse/TINKERPOP-1963</link>
                <project id="12316520" key="TINKERPOP">TinkerPop</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
gremlin&amp;gt; g.inject(1).choose(is(1), constant(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;), constant(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;))
==&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
gremlin&amp;gt; g.inject(1).choose(is(1), fold(), constant(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;))
==&amp;gt;[1]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But if I put some reducing step in the branch that&apos;s not supposed to be emitted:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
gremlin&amp;gt; g.inject(1).choose(is(1), constant(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;), fold())
==&amp;gt;[]
==&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
gremlin&amp;gt; g.inject(1).choose(is(1), constant(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;), max())
==&amp;gt;NaN
==&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13158278">TINKERPOP-1963</key>
            <summary>Use of reducing step in choose()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="spmallette">Stephen Mallette</assignee>
                                    <reporter username="spmallette">Stephen Mallette</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 May 2018 20:14:02 +0000</created>
                <updated>Thu, 31 May 2018 20:17:00 +0000</updated>
                            <resolved>Thu, 31 May 2018 20:17:00 +0000</resolved>
                                    <version>3.2.9</version>
                                    <fixVersion>3.4.0</fixVersion>
                    <fixVersion>3.3.4</fixVersion>
                    <fixVersion>3.2.10</fixVersion>
                                    <component>process</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16469483" author="spmallette" created="Wed, 9 May 2018 20:55:51 +0000"  >&lt;p&gt;The issue seems related to a step like &lt;tt&gt;fold()&lt;/tt&gt; always&#160;returning an object even when the stream is technically empty as in:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
gremlin&amp;gt; g.inject().fold()
==&amp;gt;[]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The choice to return something or not from the option traversals is determined by &lt;tt&gt;hasNext()&lt;/tt&gt; so that&apos;s why more than one of those options is returned. Considering fixing this by introducing a different method of flow control&lt;/p&gt;</comment>
                            <comment id="16473522" author="githubbot" created="Sun, 13 May 2018 15:20:17 +0000"  >&lt;p&gt;GitHub user spmallette opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/865&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/865&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/TINKERPOP-1963&quot; title=&quot;Use of reducing step in choose()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TINKERPOP-1963&quot;&gt;&lt;del&gt;TINKERPOP-1963&lt;/del&gt;&lt;/a&gt; Fixed branch() problems with reducing steps as options&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/TINKERPOP-1963&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TINKERPOP-1963&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Not sure I fixed this in the best way possible, but I added an `IdentityStep` to the front of each option:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tinkerpop/compare/tp32...TINKERPOP-1963?expand=1#diff-546a91c51e7b731ccea30f0e4aff5d83R68&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/compare/tp32...TINKERPOP-1963?expand=1#diff-546a91c51e7b731ccea30f0e4aff5d83R68&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    and then later checked that step to see if anything had been injected into it to determine if the choice had evaluated to `true` or not (since that was the existing way in which that was done).  I&apos;m open to better approaches to resolving this problem if they can be suggested. Also ready to hear that &quot;this way won&apos;t work because...&quot; In the mean time.....&lt;/p&gt;

&lt;p&gt;    All tests pass with `docker/build.sh -t -n -i`&lt;/p&gt;

&lt;p&gt;    VOTE +1&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/apache/tinkerpop&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/TINKERPOP-1963&quot; title=&quot;Use of reducing step in choose()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TINKERPOP-1963&quot;&gt;&lt;del&gt;TINKERPOP-1963&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/865.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/865.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #865&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 96072c7bc8962bbd15c6263c5e5eed6af8f9dd27&lt;br/&gt;
Author: Stephen Mallette &amp;lt;spmva@...&amp;gt;&lt;br/&gt;
Date:   2018-05-09T21:52:32Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/TINKERPOP-1963&quot; title=&quot;Use of reducing step in choose()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TINKERPOP-1963&quot;&gt;&lt;del&gt;TINKERPOP-1963&lt;/del&gt;&lt;/a&gt; Fixed branch() problems with reducing steps as options&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16495790" author="githubbot" created="Wed, 30 May 2018 22:16:05 +0000"  >&lt;p&gt;Github user dkuppitz commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/865&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/865&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    VOTE: +1&lt;/p&gt;</comment>
                            <comment id="16497064" author="githubbot" created="Thu, 31 May 2018 19:41:52 +0000"  >&lt;p&gt;Github user davebshow commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/865&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/865&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    VOTE +1&lt;/p&gt;</comment>
                            <comment id="16497103" author="githubbot" created="Thu, 31 May 2018 20:16:47 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/865&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/865&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 24 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3tjaf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>