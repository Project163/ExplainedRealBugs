<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:12:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TINKERPOP-3201] Fix tail inside repeat</title>
                <link>https://issues.apache.org/jira/browse/TINKERPOP-3201</link>
                <project id="12316520" key="TINKERPOP">TinkerPop</project>
                    <description>&lt;p&gt;tail() step inside repeat() is not properly resetting per iteration.&lt;/p&gt;

&lt;p&gt;Consider the following queries on the modern graph on 3.7.x&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
gremlin&amp;gt; g.withoutStrategies(RepeatUnrollStrategy).V(1).repeat(__.both().order().tail(2)).times(2)
==&amp;gt;v[4]
==&amp;gt;v[6]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
gremlin&amp;gt; g.V(1).both().order().tail(2).both().order().tail(2)
==&amp;gt;v[5]
==&amp;gt;v[6]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The unrolled version doesn&apos;t match the repeat() version because tail() is recalculated on each call to processNextStart(). The tail() is being calculated too frequently even though there are still output traversers remaining from the previous calculation.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13631566">TINKERPOP-3201</key>
            <summary>Fix tail inside repeat</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="kenhuuu">Ken Hu</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 Oct 2025 22:38:59 +0000</created>
                <updated>Tue, 28 Oct 2025 21:11:38 +0000</updated>
                            <resolved>Tue, 28 Oct 2025 21:11:38 +0000</resolved>
                                    <version>3.8.0</version>
                                    <fixVersion>3.8.0</fixVersion>
                                    <component>process</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="18031327" author="githubbot" created="Tue, 21 Oct 2025 05:38:32 +0000"  >&lt;p&gt;kenhuuu opened a new pull request, #3248:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/3248&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/3248&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   &lt;a href=&quot;https://issues.apache.org/jira/browse/TINKERPOP-3201&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TINKERPOP-3201&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   Still a draft as there is a test that isn&apos;t passing.&lt;/p&gt;

&lt;p&gt;   &amp;lt;!--&lt;br/&gt;
   Thanks for contributing! Reminders:&lt;br/&gt;
   + TARGET the earliest branch where you want the change&lt;br/&gt;
       3.7-dev -&amp;gt; 3.7.5 (non-breaking only)&lt;br/&gt;
       3.8-dev -&amp;gt; 3.8.0&lt;br/&gt;
       master  -&amp;gt; 4.0.0&lt;br/&gt;
   + Committers will MERGE the PR forward to newer versions&lt;br/&gt;
   + ADD entry to the CHANGELOG.asciidoc for the targeted version&lt;br/&gt;
       Do not reference a JIRA number there&lt;br/&gt;
   + ADD JIRA number to title and link in description&lt;br/&gt;
   + PRs requires 3 +1s from committers OR&lt;br/&gt;
                  1 +1 and 7 day wait to merge.&lt;br/&gt;
   + MORE details: &lt;a href=&quot;https://s.apache.org/rtnal&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://s.apache.org/rtnal&lt;/a&gt;&lt;br/&gt;
   --&amp;gt;&lt;/p&gt;

</comment>
                            <comment id="18033366" author="githubbot" created="Tue, 28 Oct 2025 00:03:16 +0000"  >&lt;p&gt;xiazcy commented on PR #3248:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/3248#issuecomment-3453874476&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/3248#issuecomment-3453874476&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   VOTE +1&lt;/p&gt;

</comment>
                            <comment id="18033387" author="githubbot" created="Tue, 28 Oct 2025 00:29:25 +0000"  >&lt;p&gt;Cole-Greer commented on PR #3248:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/3248#issuecomment-3453926401&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/3248#issuecomment-3453926401&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   VOTE +1&lt;/p&gt;

</comment>
                            <comment id="18033388" author="githubbot" created="Tue, 28 Oct 2025 00:38:57 +0000"  >&lt;p&gt;andreachild commented on code in PR #3248:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/3248#discussion_r2467531060&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/3248#discussion_r2467531060&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
gremlin-core/src/main/java/org/apache/tinkerpop/gremlin/process/traversal/step/filter/TailGlobalStep.java:&lt;br/&gt;
##########&lt;br/&gt;
@@ -58,9 +59,13 @@ public Traverser.Admin&amp;lt;S&amp;gt; processNextStart() &lt;/p&gt;
{
             // If we are bypassing this step, let everything through.
             return this.starts.next();
         }
&lt;p&gt; else {&lt;br/&gt;
+            if (this.tail.isEmpty()) &lt;/p&gt;
{
+                consuming = true;
+            }
&lt;p&gt;             // Pull everything available before we start delivering from the tail buffer.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (this.starts.hasNext()) {&lt;br/&gt;
+            if (consuming &amp;amp;&amp;amp; this.starts.hasNext()) {&lt;br/&gt;
                 this.starts.forEachRemaining(this::addTail);&lt;br/&gt;
+                consuming = false;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Review Comment:&lt;br/&gt;
   Can this be replaced with just a check for `tail.isEmpty()`?&lt;br/&gt;
   ```suggestion&lt;br/&gt;
               if (this.tail.isEmpty() &amp;amp;&amp;amp; this.starts.hasNext()) {&lt;br/&gt;
   this.starts.forEachRemaining(this::addTail);&lt;br/&gt;
   ```&lt;/p&gt;


</comment>
                            <comment id="18033389" author="githubbot" created="Tue, 28 Oct 2025 00:39:57 +0000"  >&lt;p&gt;andreachild commented on code in PR #3248:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/3248#discussion_r2467531060&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/3248#discussion_r2467531060&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
gremlin-core/src/main/java/org/apache/tinkerpop/gremlin/process/traversal/step/filter/TailGlobalStep.java:&lt;br/&gt;
##########&lt;br/&gt;
@@ -58,9 +59,13 @@ public Traverser.Admin&amp;lt;S&amp;gt; processNextStart() &lt;/p&gt;
{
             // If we are bypassing this step, let everything through.
             return this.starts.next();
         }
&lt;p&gt; else {&lt;br/&gt;
+            if (this.tail.isEmpty()) &lt;/p&gt;
{
+                consuming = true;
+            }
&lt;p&gt;             // Pull everything available before we start delivering from the tail buffer.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (this.starts.hasNext()) {&lt;br/&gt;
+            if (consuming &amp;amp;&amp;amp; this.starts.hasNext()) {&lt;br/&gt;
                 this.starts.forEachRemaining(this::addTail);&lt;br/&gt;
+                consuming = false;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Review Comment:&lt;br/&gt;
   Can this be replaced with just a check for `tail.isEmpty()`?&lt;br/&gt;
   ```suggestion&lt;br/&gt;
               if (this.tail.isEmpty() &amp;amp;&amp;amp; this.starts.hasNext()) {&lt;br/&gt;
                   this.starts.forEachRemaining(this::addTail);&lt;br/&gt;
   ```&lt;/p&gt;


</comment>
                            <comment id="18033425" author="githubbot" created="Tue, 28 Oct 2025 04:42:50 +0000"  >&lt;p&gt;andreachild commented on PR #3248:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/3248#issuecomment-3454532173&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/3248#issuecomment-3454532173&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   Does this need an upgrade doc?&lt;/p&gt;

</comment>
                            <comment id="18033667" author="githubbot" created="Tue, 28 Oct 2025 19:31:13 +0000"  >&lt;p&gt;kenhuuu commented on PR #3248:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/3248#issuecomment-3458158929&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/3248#issuecomment-3458158929&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   &amp;gt; Does this need an upgrade doc?&lt;/p&gt;

&lt;p&gt;   I don&apos;t think so since it&apos;s a bug fix not a change in semantics.&lt;/p&gt;

</comment>
                            <comment id="18033668" author="githubbot" created="Tue, 28 Oct 2025 19:31:37 +0000"  >&lt;p&gt;kenhuuu commented on code in PR #3248:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/3248#discussion_r2470805938&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/3248#discussion_r2470805938&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;##########&lt;br/&gt;
gremlin-core/src/main/java/org/apache/tinkerpop/gremlin/process/traversal/step/filter/TailGlobalStep.java:&lt;br/&gt;
##########&lt;br/&gt;
@@ -58,9 +59,13 @@ public Traverser.Admin&amp;lt;S&amp;gt; processNextStart() &lt;/p&gt;
{
             // If we are bypassing this step, let everything through.
             return this.starts.next();
         }
&lt;p&gt; else {&lt;br/&gt;
+            if (this.tail.isEmpty()) &lt;/p&gt;
{
+                consuming = true;
+            }
&lt;p&gt;             // Pull everything available before we start delivering from the tail buffer.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (this.starts.hasNext()) {&lt;br/&gt;
+            if (consuming &amp;amp;&amp;amp; this.starts.hasNext()) {&lt;br/&gt;
                 this.starts.forEachRemaining(this::addTail);&lt;br/&gt;
+                consuming = false;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Review Comment:&lt;br/&gt;
   updated&lt;/p&gt;


</comment>
                            <comment id="18033669" author="githubbot" created="Tue, 28 Oct 2025 19:31:59 +0000"  >&lt;p&gt;kenhuuu commented on PR #3248:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/3248#issuecomment-3458161330&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/3248#issuecomment-3458161330&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   VOTE +1&lt;/p&gt;

</comment>
                            <comment id="18033670" author="githubbot" created="Tue, 28 Oct 2025 19:41:48 +0000"  >&lt;p&gt;andreachild commented on PR #3248:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/3248#issuecomment-3458194575&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/3248#issuecomment-3458194575&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   VOTE +1&lt;/p&gt;

</comment>
                            <comment id="18033680" author="githubbot" created="Tue, 28 Oct 2025 21:09:31 +0000"  >&lt;p&gt;kenhuuu merged PR #3248:&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/tinkerpop/pull/3248&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tinkerpop/pull/3248&lt;/a&gt;&lt;/p&gt;

</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 week, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1y5c0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>