<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:45:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[NET-409] FTPClient truncates file (storeFile method)</title>
                <link>https://issues.apache.org/jira/browse/NET-409</link>
                <project id="12310487" key="NET">Commons Net</project>
                    <description>&lt;p&gt;Functionality works fine on commons-net-2.2.  Error occurred after upgrading library to commons-net-3.0 version.  Sending a file from Windows 7 to CentOS/Linux using FTPClient storeFile method results in truncation of files over 2k in size.  Rolling back upgrade to commons-net-2.2 version fixes problem.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows 7/Eclipse 3.6.2&lt;/p&gt;</environment>
        <key id="12507914">NET-409</key>
            <summary>FTPClient truncates file (storeFile method)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jon_e">Jon Ericson</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 May 2011 19:12:41 +0000</created>
                <updated>Sat, 21 Sep 2013 00:56:33 +0000</updated>
                            <resolved>Mon, 23 May 2011 19:55:08 +0000</resolved>
                                    <version>3.0</version>
                                    <fixVersion>3.0.1</fixVersion>
                                    <component>FTP</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13037092" author="sebb@apache.org" created="Fri, 20 May 2011 21:27:37 +0000"  >&lt;p&gt;Works fine for me. You&apos;ll need to provide sample code that fails on 3.0 and works with 2.2.&lt;/p&gt;

&lt;p&gt;Please try using the example code as follows:&lt;/p&gt;

&lt;p&gt;java examples.ftp.FTPClientExample -s &amp;lt;host&amp;gt; &amp;lt;user&amp;gt; &amp;lt;password&amp;gt; &amp;lt;remotefile&amp;gt; &amp;lt;localfile&amp;gt;&lt;/p&gt;
</comment>
                            <comment id="13038109" author="jon_e" created="Mon, 23 May 2011 18:20:38 +0000"  >&lt;p&gt;Per your request, the following sample class demonstrates the issue.  My original description is not entirely accurate; it is not files over 2k in size that is truncated, but instead the file size &quot;rounds down&quot; to the nearest 1k and truncates the rest.&lt;/p&gt;

&lt;p&gt;The &quot;Declaration.txt&quot; file used in this example is the U.S. Declaration of Independence.  It is 7.94KB on my local drive in Windows.  On arriving at the server, it is only 7K, truncating the last few sentences.&lt;/p&gt;

&lt;p&gt;Truncation occurs when the commons-net-3.0.jar is used.  Changing the .jar on the class path to use the commons-net-2.2.jar, the file is transmitted in its entirety.&lt;/p&gt;

&lt;p&gt;###&lt;/p&gt;

&lt;p&gt;package com.jericson.stuff;&lt;/p&gt;

&lt;p&gt;import java.io.BufferedReader;&lt;br/&gt;
import java.io.ByteArrayInputStream;&lt;br/&gt;
import java.io.FileReader;&lt;br/&gt;
import java.io.InputStream;&lt;br/&gt;
import org.apache.commons.net.ftp.FTPClient;&lt;/p&gt;

&lt;p&gt;public class Net_409_Demo {&lt;/p&gt;

&lt;p&gt;  /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;@param args&lt;br/&gt;
   */&lt;br/&gt;
  public static void main(String[] args) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {    String independence = getStringFromFile();    FTPClient ftpClient = new FTPClient();    try {
      ftpClient.connect(&quot;b2b.myserver.com&quot;);
      ftpClient.login(&quot;testuser&quot;, &quot;Testpassword&quot;);
      InputStream stream = new ByteArrayInputStream(
              independence.getBytes(&quot;UTF-8&quot;));
      ftpClient.storeFile(&quot;Independence.txt&quot;, stream);
      ftpClient.quit();
      ftpClient.disconnect();
    } catch (Exception e) {
      e.printStackTrace();
    }&lt;br/&gt;
    System.out.println(&quot;** Complete **&quot;);&lt;br/&gt;
  }&lt;br/&gt;
&lt;br/&gt;
  private static String getStringFromFile() {&lt;br/&gt;
&lt;br/&gt;
    /*&lt;br/&gt;
     * The file &quot;Declaration.txt&quot; begins with &amp;lt;Declaration&amp;gt;, ends with&lt;br/&gt;
     * &amp;lt;/Declaration&amp;gt; and has no line separators in between.&lt;br/&gt;
     */&lt;br/&gt;
    try {
      BufferedReader reader = new BufferedReader(new FileReader(
              &quot;Declaration.txt&quot;));
      StringBuilder stringBuilder = new StringBuilder();
      stringBuilder.append(reader.readLine());
      return stringBuilder.toString();
    } catch (Exception e) {      e.printStackTrace();    }    return null;  }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;}&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;###&lt;/p&gt;

</comment>
                            <comment id="13038171" author="sebb@apache.org" created="Mon, 23 May 2011 19:55:08 +0000"  >&lt;p&gt;That explains why my test worked and yours did not. As it happens, the file I used was a multiple of 2k bytes, so the error was not exposed.&lt;/p&gt;

&lt;p&gt;Code has been fixed now, and will be in the next release.&lt;/p&gt;

&lt;p&gt;Snapshot has been uploaded to &lt;a href=&quot;https://repository.apache.org/content/repositories/snapshots/commons-net/commons-net/3.0.1-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/repositories/snapshots/commons-net/commons-net/3.0.1-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks for reporting the issue.&lt;/p&gt;</comment>
                            <comment id="13769254" author="victorqedu" created="Tue, 17 Sep 2013 06:32:05 +0000"  >&lt;p&gt;This problem is still valid in version 3.3.&lt;br/&gt;
I copy a file of dimension 1.921.303 and at the destination the dimension is 1.921.283.&lt;br/&gt;
This is the code.&lt;br/&gt;
                client = new FTPClient();&lt;br/&gt;
                client.connect(server);&lt;br/&gt;
                int reply = client.getReplyCode();&lt;/p&gt;

&lt;p&gt;                if(!FTPReply.isPositiveCompletion(reply)) &lt;/p&gt;
{
                    client.disconnect();
                    System.err.println(&quot;FTP server refused connection.&quot;);
                    return;
                }
&lt;p&gt; else {&lt;br/&gt;
                    if(client.login(userName, password)) {&lt;br/&gt;
                        System.out.println(&quot;FTP connected&quot;);&lt;br/&gt;
                        System.out.println(&quot;FTP logged in&quot;);&lt;br/&gt;
                        fis = new FileInputStream(srcFileName);&lt;br/&gt;
                        if(!client.storeFile(dstFileName, fis)) &lt;/p&gt;
{
                            String raspuns_text = client.getReplyString();
                            client.logout();
                            return;
                        }
&lt;p&gt;                        System.out.println(&quot;FTP file stored&quot;);&lt;br/&gt;
                        client.logout();&lt;br/&gt;
                        System.out.println(&quot;FTP logged out&quot;);&lt;br/&gt;
                    } else &lt;/p&gt;
{
                        return;
                    }
&lt;p&gt;                }&lt;/p&gt;</comment>
                            <comment id="13773647" author="sebb@apache.org" created="Sat, 21 Sep 2013 00:56:33 +0000"  >&lt;p&gt;Is the file actually truncated, or just shorter?&lt;br/&gt;
The difference is that a truncated file has some bytes missing from the end, whereas a shorter file may have bytes missing anywhere.&lt;/p&gt;

&lt;p&gt;One cause of missing bytes is using ASCII file transfer inappropriately.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12508551">NET-411</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12508786">NET-413</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12510275">NET-417</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>41742</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 9 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0kuvr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>119821</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>