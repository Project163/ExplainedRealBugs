<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:45:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[NET-552] SocketTimeoutException connecting a FTP server via an HTTP Proxy</title>
                <link>https://issues.apache.org/jira/browse/NET-552</link>
                <project id="12310487" key="NET">Commons Net</project>
                    <description>&lt;p&gt;Randomly, we&apos;re experiencing SocketTimoutException when we connect an FTP via an Http Proxy :&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.io.IOException: Timed out waiting for initial connect reply
	at org.apache.commons.net.ftp.FTP._connectAction_(FTP.java:403)
	at org.apache.commons.net.ftp.FTPClient._connectAction_(FTPClient.java:931)
	at org.apache.commons.net.ftp.FTPClient._connectAction_(FTPClient.java:925)
	at org.apache.commons.net.ftp.FTPHTTPClient.connect(FTPHTTPClient.java:144)
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.net.SocketInputStream.socketRead0(Native Method)
	at java.net.SocketInputStream.read(SocketInputStream.java:150)
	at java.net.SocketInputStream.read(SocketInputStream.java:121)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.read(BufferedReader.java:182)
	at org.apache.commons.net.io.CRLFLineReader.readLine(CRLFLineReader.java:58)
	at org.apache.commons.net.ftp.FTP.__getReply(FTP.java:315)
	at org.apache.commons.net.ftp.FTP.__getReply(FTP.java:295)
	at org.apache.commons.net.ftp.FTP._connectAction_(FTP.java:397)
	... 6 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After analysis, I think the problem is that commons-net opens 2 BufferedReader on the same InputStream : first in the FTPHTTPClient.tunnelHandshake method, and the second in FTP._connectAction() method.&lt;br/&gt;
If the first BufferedReader reads all datas in the socket, the second waits until SocketTimeout.&lt;/p&gt;</description>
                <environment>&lt;p&gt;All&lt;/p&gt;</environment>
        <key id="12733436">NET-552</key>
            <summary>SocketTimeoutException connecting a FTP server via an HTTP Proxy</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="qdevriendt">Quentin Devriendt</reporter>
                        <labels>
                            <label>FTP</label>
                            <label>HTTP</label>
                            <label>Proxy</label>
                            <label>SocketTimeout</label>
                    </labels>
                <created>Tue, 12 Aug 2014 09:56:47 +0000</created>
                <updated>Thu, 26 Nov 2015 16:34:46 +0000</updated>
                            <resolved>Thu, 8 Jan 2015 23:44:59 +0000</resolved>
                                    <version>3.3</version>
                                    <fixVersion>3.4</fixVersion>
                                    <component>FTP</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14109165" author="qdevriendt" created="Mon, 25 Aug 2014 14:56:12 +0000"  >&lt;p&gt;I have written a patch that fixing this bug :&lt;br/&gt;
I pass the first java.io.Reader (created in tunnelHandshake method of FTPHTTPClient class) to the method that affects the instance variable Reader &amp;#95;controlInput&amp;#95; to keep datas that has already been read.&lt;/p&gt;</comment>
                            <comment id="14267821" author="sebb@apache.org" created="Wed, 7 Jan 2015 16:25:01 +0000"  >&lt;p&gt;Only just got around to looking at the patch.&lt;/p&gt;

&lt;p&gt;Although it applies cleanly, the code does not compile.&lt;br/&gt;
There appears to be some text missing in the FTPClient part of the patch.&lt;br/&gt;
Is there supposed to be a closing brace between the following?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;._connectAction_(); &lt;span class=&quot;code-comment&quot;&gt;// sets up _input_ and _output_&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void _connectAction_(Reader socketIsReader) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Also, why is the above method public rather than protected?&lt;/p&gt;</comment>
                            <comment id="14269404" author="qdevriendt" created="Thu, 8 Jan 2015 15:00:33 +0000"  >&lt;p&gt;Sorry,&lt;/p&gt;

&lt;p&gt;I certainly made a mistake at patch generation.&lt;br/&gt;
Here&apos;s a new patch (ftp.patch) with my modifications.&lt;br/&gt;
I have also change method visibility (actually, there&apos;s no reason that is public).&lt;/p&gt;</comment>
                            <comment id="14270232" author="sebb@apache.org" created="Thu, 8 Jan 2015 23:44:41 +0000"  >&lt;p&gt;Thanks, that&apos;s much easier to follow.&lt;br/&gt;
I think there was still a minor issue - the patch removed the method &lt;tt&gt;FTPClient#&lt;em&gt;connectAction&lt;/em&gt;()&lt;/tt&gt;.&lt;br/&gt;
This would mean any callers of the original method would not invoke the code now in the method &lt;tt&gt;FTPClient#&lt;em&gt;connectAction&lt;/em&gt;(Reader)&lt;/tt&gt;.&lt;br/&gt;
I&apos;ve restored the method.&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/r1650420&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1650420&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/NET-552&quot; title=&quot;SocketTimeoutException connecting a FTP server via an HTTP Proxy&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NET-552&quot;&gt;&lt;del&gt;NET-552&lt;/del&gt;&lt;/a&gt; SocketTimeoutException connecting a FTP server via an HTTP Proxy&lt;/p&gt;

&lt;p&gt;Modified:&lt;br/&gt;
    commons/proper/net/trunk/src/changes/changes.xml&lt;br/&gt;
    commons/proper/net/trunk/src/main/java/org/apache/commons/net/ftp/FTP.java&lt;br/&gt;
    commons/proper/net/trunk/src/main/java/org/apache/commons/net/ftp/FTPClient.java&lt;br/&gt;
    commons/proper/net/trunk/src/main/java/org/apache/commons/net/ftp/FTPHTTPClient.java&lt;/p&gt;

&lt;p&gt;The code will be in snapshot builds from Jan 08 23:39&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12690858" name="ftp.patch" size="4127" author="qdevriendt" created="Thu, 8 Jan 2015 15:00:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>411464</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 45 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ysef:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>411455</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>