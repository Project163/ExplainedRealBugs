<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:44:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[NET-350] &quot;java.net.SocketException: Broken pipe&quot; when calling &quot;TelnetClient.sendAYT()&quot;</title>
                <link>https://issues.apache.org/jira/browse/NET-350</link>
                <project id="12310487" key="NET">Commons Net</project>
                    <description>&lt;p&gt;I&apos;m trying to write some code to have a reliable way to determine if a telnet connection is still available and not closed on the remote server. Even though I first call TelnetClient.isConnected(), the followed TelnetClient.sendAYT() gives me SocketException. The problem occurs when I provide invalid login credentials on purpose when logging in to the telnet server.&lt;/p&gt;

&lt;p&gt;Code snippet:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isConnected() {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; isConnected(100);
    }

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isConnected(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; timeOut) {
        &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; connected = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;

        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (telnetClient.isConnected()) {
            &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
                connected = telnetClient.sendAYT(timeOut);
            } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException ex) {
                Logger.getLogger(ForceLogin.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;getName()).log(Level.SEVERE, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, ex);
            } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IllegalArgumentException ex) {
                Logger.getLogger(ForceLogin.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;getName()).log(Level.SEVERE, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, ex);
            } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (InterruptedException ex) {
                Logger.getLogger(ForceLogin.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;getName()).log(Level.SEVERE, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, ex);
            }
        }
        
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Still connected? &quot;&lt;/span&gt; + connected);

        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; connected;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;What I do is execute the following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;succesfulLogin = forceLogin.isConnected();

&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (succesfulLogin) {
        succesfulLogin = forceLogin.isConnected(1000);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When I try to fail the telnet login (providing invalid credentials), the first &quot;isConnected()&quot; call sometimes gives me TRUE, sometimes gives me FALSE. When it&apos;s TRUE I want to make sure that we are really still connected using a longer &quot;TelnetClient.sendAYT()&quot; timeout. This is where the exception occurs.&lt;/p&gt;

&lt;p&gt;Resulting exception:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;16-Jan-2011 16:44:04 force.ForceLogin isConnected
SEVERE: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
java.net.SocketException: Broken pipe
        at java.net.SocketOutputStream.socketWrite0(Native Method)
        at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)
        at java.net.SocketOutputStream.write(SocketOutputStream.java:136)
        at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)
        at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123)
        at org.apache.commons.net.telnet.Telnet._sendAYT(Telnet.java:1095)
        at org.apache.commons.net.telnet.TelnetClient.sendAYT(TelnetClient.java:206)
        at force.ForceLogin.isConnected(ForceLogin.java:95)
        at force.ForceLogin.main(ForceLogin.java:160)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;Ubuntu 10.10 (x32)&lt;br/&gt;
Java JDK 1.6.0.22&lt;/p&gt;</environment>
        <key id="12495717">NET-350</key>
            <summary>&quot;java.net.SocketException: Broken pipe&quot; when calling &quot;TelnetClient.sendAYT()&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="forage">Age Bosma</reporter>
                        <labels>
                    </labels>
                <created>Sun, 16 Jan 2011 16:43:34 +0000</created>
                <updated>Sat, 4 Jun 2011 19:26:29 +0000</updated>
                            <resolved>Thu, 10 Mar 2011 02:31:46 +0000</resolved>
                                    <version>2.2</version>
                                    <fixVersion>3.0</fixVersion>
                                    <component>Telnet</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12991407" author="bogdro" created="Mon, 7 Feb 2011 15:11:19 +0000"  >&lt;p&gt;Try my patch - it introduces more tests that check if the Socket is connected. But the only guaranteed way to theck the connection state is to actually use the socket. If reading or writing throws an Exception, we know we&apos;re not connected, and this is exactly what you&apos;re doing. SocketClient can&apos;t perform and read or writes, because it would eat bytes that the cliane was waiting for or perform unspecified actions on the server. You&apos;re checking the right way and you should continue doing it this way. The patch MAY solve something, but on the other hand, it may not. No guarantee. Keep using your method (writing and testing for I/O exceptions).&lt;/p&gt;</comment>
                            <comment id="12991643" author="forage" created="Mon, 7 Feb 2011 21:59:05 +0000"  >&lt;p&gt;Thanks for your reply and patch. This should at least provide a more stable check to some extend.&lt;/p&gt;

&lt;p&gt;While writing and wait for the exception does the trick in the end, I would have preferred a &apos;cleaner&apos; solution, not depending on something to just go wrong after an arbitrary time span. Though I guess there&apos;s not really any other way.&lt;/p&gt;</comment>
                            <comment id="13004948" author="sebb@apache.org" created="Thu, 10 Mar 2011 02:31:46 +0000"  >&lt;p&gt;Thanks for the patch.&lt;/p&gt;

&lt;p&gt;It seemed wrong to change the existing isConnected() method, so the checks were added as a new isAvailable() method.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12470454" name="sockclient-isconn.diff" size="1115" author="bogdro" created="Mon, 7 Feb 2011 15:11:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72050</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 37 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0kuhz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>119759</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>