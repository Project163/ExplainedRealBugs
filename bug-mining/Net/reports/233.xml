<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:45:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[NET-414] Apache Commons TFTP does not reject request replies that originate from a control port.</title>
                <link>https://issues.apache.org/jira/browse/NET-414</link>
                <project id="12310487" key="NET">Commons Net</project>
                    <description>&lt;p&gt;When a TFTP request response arrives that incorrectly specifies its source port as the control port, the request should be rejected with an error code 5 (TFTPErrorPacket.UNKNOWN_TID) and suggested text &quot;INCORRECT SOURCE PORT&quot;. &lt;/p&gt;

&lt;p&gt;This can happen when an incorrectly written TFTP server replies to a request from a control socket instead of building a new socket that attaches to an ephemeral port.&lt;/p&gt;

&lt;p&gt;Note 1: The expected response from a read request is a DATA packet. The expected response from a write request is an ACK packet.&lt;/p&gt;

&lt;p&gt;Note 2: The control port is implementation specific and not always port 69 (as defined by IANA).&lt;/p&gt;</description>
                <environment>&lt;p&gt;Java 1.6 Patch 20&lt;/p&gt;</environment>
        <key id="12509021">NET-414</key>
            <summary>Apache Commons TFTP does not reject request replies that originate from a control port.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="chuckwolber">Chuck Wolber</reporter>
                        <labels>
                    </labels>
                <created>Wed, 1 Jun 2011 20:47:19 +0000</created>
                <updated>Tue, 14 Feb 2017 22:22:36 +0000</updated>
                            <resolved>Thu, 9 Feb 2017 16:11:15 +0000</resolved>
                                    <version>2.2</version>
                    <version>3.0</version>
                                    <fixVersion>3.6</fixVersion>
                                    <component>TFTP</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13183503" author="sebb@apache.org" created="Tue, 10 Jan 2012 19:33:28 +0000"  >&lt;p&gt;I&apos;m not quite clear what code changes are needed here - have you a suggested patch?&lt;/p&gt;</comment>
                            <comment id="13183569" author="chuckwolber" created="Tue, 10 Jan 2012 21:11:40 +0000"  >&lt;p&gt;I have made a vast number of changes to the TFTPClient class we used in our project, thus a proper patch against any Apache Commons released version is no longer possible. However, in rough qualitative form, after the initial try/catch block that surrounds &quot;received = bufferedReceive()&quot; we are using the following code to detect the condition (note that the &quot;port&quot; variable is defined in the method arguments and is not always port 69 as defined in the IANA port reservation).&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;TFTPClient.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;                
                &lt;span class=&quot;code-comment&quot;&gt;// The first time we receive we get the port number and
&lt;/span&gt;                &lt;span class=&quot;code-comment&quot;&gt;// answering host address (&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; hosts with multiple IPs)
&lt;/span&gt;                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (justStarted)
                {
                    justStarted = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
                    hostPort = received.getPort();

                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (hostPort == port)
                    {
                        error = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TFTPErrorPacket(received.getAddress(),
                                received.getPort(), TFTPErrorPacket.UNKNOWN_TID,
                                &lt;span class=&quot;code-quote&quot;&gt;&quot;INCORRECT SOURCE PORT&quot;&lt;/span&gt;);
                        bufferedSend(error);
                        endBufferedOps();
                        &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TFTPTransferErrorException(
                                &lt;span class=&quot;code-quote&quot;&gt;&quot;Incorrect source port in request reply.&quot;&lt;/span&gt;);
                    }

                    data.setPort(hostPort);
                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(!host.equals(received.getAddress()))
                    {
                        host = received.getAddress();
                        data.setAddress(host);
                        sent.setAddress(host);
                    }
                }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And then later we attempt to detect if a packet has been sent by someone other than the host that we initiated the conversation with:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;TFTPClient.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;                
                &lt;span class=&quot;code-comment&quot;&gt;// Comply with RFC 783 indication that an error acknowledgement
&lt;/span&gt;                &lt;span class=&quot;code-comment&quot;&gt;// should be sent to originator &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; unexpected TID or host.
&lt;/span&gt;                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (host.equals(received.getAddress()) &amp;amp;&amp;amp;
                        received.getPort() == hostPort)
                {
                    [...]
                }
                &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
                {
                    &lt;span class=&quot;code-comment&quot;&gt;/* Hmmm, someone &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; is bugging us. Go away please :) */&lt;/span&gt;
                    error = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TFTPErrorPacket(received.getAddress(),
                                                received.getPort(),
                                                TFTPErrorPacket.UNKNOWN_TID,
                                                &lt;span class=&quot;code-quote&quot;&gt;&quot;Unexpected host or port.&quot;&lt;/span&gt;);
                    bufferedSend(error);
                    &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt; _sendPacket;
                }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13183808" author="sebb@apache.org" created="Wed, 11 Jan 2012 02:25:12 +0000"  >&lt;p&gt;OK, we&apos;re getting closer.&lt;/p&gt;

&lt;p&gt;As far as I can tell, the current TFTPClient code already implements the second code block above in both send and receive methods.&lt;/p&gt;

&lt;p&gt;As to the first code block above, only the sendFile method has a justStarted variable - receiveFile seems to use lastBlock == 0 to detect the condition. Both methods already get the port from a parameter.&lt;/p&gt;

&lt;p&gt;I&apos;m wondering if we are looking at the same code base - are you looking at the trunk version, i.e:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://svn.apache.org/repos/asf/commons/proper/net/trunk/src/main/java/org/apache/commons/net/tftp/TFTPClient.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/repos/asf/commons/proper/net/trunk/src/main/java/org/apache/commons/net/tftp/TFTPClient.java&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15859707" author="sebb@apache.org" created="Thu, 9 Feb 2017 16:11:15 +0000"  >&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/viewvc?rev=1782356&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1782356&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/NET-414&quot; title=&quot;Apache Commons TFTP does not reject request replies that originate from a control port.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NET-414&quot;&gt;&lt;del&gt;NET-414&lt;/del&gt;&lt;/a&gt; Apache Commons TFTP does not reject request replies that originate from a control port.&lt;/p&gt;

&lt;p&gt;Modified:&lt;br/&gt;
    commons/proper/net/trunk/src/changes/changes.xml&lt;br/&gt;
    commons/proper/net/trunk/src/main/java/org/apache/commons/net/tftp/TFTPClient.java&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72295</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 40 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1a45r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>267140</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>