<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:45:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[NET-492] FTPClient.printWorkingDirectory() incorrectly parses certain valid PWD command results</title>
                <link>https://issues.apache.org/jira/browse/NET-492</link>
                <project id="12310487" key="NET">Commons Net</project>
                    <description>&lt;p&gt;The new implementation of FTPClient.printWorkingDirectory() which tries to follow RFC959 is invalid and can return unescaped or invalid path in certain circumstances. According to the commentary, the author interpreted the RFC that the output is always constructed in the following way:&lt;/p&gt;

&lt;p&gt;257&amp;lt;space&amp;gt;&quot;&amp;lt;directory-name&amp;gt;&quot;&amp;lt;space&amp;gt;&amp;lt;commentary&amp;gt;&lt;br/&gt;
Where any double quotes within the directory name are doubled.&lt;/p&gt;

&lt;p&gt;First issue: the RFC does not state that the output for PWD looks exactly like this, but that the reply code is the same, as for MKD. Especially, PWD does not return any commentary, and VSFTPD server (which I&apos;m trying to talk to) does not print out the terminating space, but ends up the output on the last double quote. The algorithm uses the following code to detect the end of the quoted path:&lt;/p&gt;

&lt;p&gt;int end = reply.lastIndexOf(&quot;\&quot; &quot;);&lt;/p&gt;

&lt;p&gt;If there is no terminating space, the last double quote cannot be found, and as a result, the method returns the unescaped directory name:&lt;/p&gt;

&lt;p&gt;&quot;/foo&quot;&lt;/p&gt;

&lt;p&gt;instead of&lt;/p&gt;

&lt;p&gt;/foo&lt;/p&gt;

&lt;p&gt;Second issue: the current implementation would not work in case of the following directory:&lt;/p&gt;

&lt;p&gt;/Foo/Bar&quot; /Joe&lt;/p&gt;

&lt;p&gt;PWD command output:&lt;/p&gt;

&lt;p&gt;257 &quot;/Foo/Bar&quot;&quot; /Joe&quot;&lt;/p&gt;

&lt;p&gt;Value returned by printWorkingDirectory():&lt;/p&gt;

&lt;p&gt;/Foo/Bar&quot;&lt;/p&gt;

&lt;p&gt;Note to the administrators: the problem has been found in commons-net 3.2 version, but JIRA claims it is unreleased and does not allow me to choose it.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12623503">NET-492</key>
            <summary>FTPClient.printWorkingDirectory() incorrectly parses certain valid PWD command results</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="t.jedrzejewski">Tomasz Jedrzejewski</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Dec 2012 09:09:16 +0000</created>
                <updated>Wed, 12 Jun 2013 21:09:52 +0000</updated>
                            <resolved>Wed, 23 Jan 2013 00:56:35 +0000</resolved>
                                    <version>3.2</version>
                                    <fixVersion>3.3</fixVersion>
                                    <component>FTP</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13529817" author="sebb@apache.org" created="Wed, 12 Dec 2012 10:50:39 +0000"  >&lt;p&gt;I see what you mean about the RFC now; pity it does not have any examples for PWD responses...&lt;/p&gt;

&lt;p&gt;Looks like the code change was added in the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/NET-442&quot; title=&quot;StringIndexOutOfBoundsException: String index out of range: -1 if server respond with root is current directory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NET-442&quot;&gt;&lt;del&gt;NET-442&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The fix should be simple for conforming servers:&lt;/p&gt;

&lt;p&gt;Strip enclosing quotes and de-duplicate any embedded quotes.&lt;/p&gt;

&lt;p&gt;If the reply is not enclosed in quotes, then it should probably be returned as is.&lt;/p&gt;</comment>
                            <comment id="13529851" author="sebb@apache.org" created="Wed, 12 Dec 2012 11:22:20 +0000"  >&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/viewvc?rev=1420619&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1420619&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/NET-492&quot; title=&quot;FTPClient.printWorkingDirectory() incorrectly parses certain valid PWD command results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NET-492&quot;&gt;&lt;del&gt;NET-492&lt;/del&gt;&lt;/a&gt; FTPClient.printWorkingDirectory() incorrectly parses certain valid PWD command results&lt;/p&gt;

&lt;p&gt;Modified:&lt;br/&gt;
    commons/proper/net/trunk/src/changes/changes.xml&lt;br/&gt;
    commons/proper/net/trunk/src/main/java/org/apache/commons/net/ftp/FTPClient.java&lt;/p&gt;</comment>
                            <comment id="13529859" author="t.jedrzejewski" created="Wed, 12 Dec 2012 11:36:46 +0000"  >&lt;p&gt;You&apos;re right that this RFC lacks examples - I&apos;ve also spent some time trying to figure out, what&apos;s going on &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. I found another FTP server, which on the other hand, prints out a commentary string for PWD:&lt;/p&gt;

&lt;p&gt;PWD&lt;br/&gt;
257 &quot;/&quot; is current directory.&lt;/p&gt;

&lt;p&gt;So it seems that we should consider both cases: when the commentary is present, and when it is not. Test cases:&lt;/p&gt;

&lt;p&gt;257 /path/without/quotes&lt;br/&gt;
257 &quot;/path/with/delimiting/quotes/without/commentary&quot;&lt;br/&gt;
257 &quot;/path/with/quotes&quot;&quot; /inside/but/without/commentary&quot;&lt;br/&gt;
257 &quot;/path/with/quotes&quot;&quot; /inside/string&quot; and with commentary&lt;br/&gt;
257 &quot;/path/with/quotes&quot;&quot; /inside/string&quot; and with commentary that also &quot;contains quotes&quot;&lt;/p&gt;</comment>
                            <comment id="13529860" author="sebb@apache.org" created="Wed, 12 Dec 2012 11:38:52 +0000"  >&lt;p&gt;Unfortunately it seems that several servers do generate comments, for example:&lt;/p&gt;

&lt;p&gt;257 &quot;/&quot; is the current directory&lt;/p&gt;

&lt;p&gt;257 &quot;DDDD:&lt;span class=&quot;error&quot;&gt;&amp;#91;PPPP&amp;#93;&lt;/span&gt;&quot; is current directory.&lt;/p&gt;</comment>
                            <comment id="13529920" author="sebb@apache.org" created="Wed, 12 Dec 2012 12:47:00 +0000"  >&lt;p&gt;Hopefully, this now fixes the issue:&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/viewvc?rev=1420638&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1420638&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/NET-492&quot; title=&quot;FTPClient.printWorkingDirectory() incorrectly parses certain valid PWD command results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NET-492&quot;&gt;&lt;del&gt;NET-492&lt;/del&gt;&lt;/a&gt; FTPClient.printWorkingDirectory() incorrectly parses certain valid PWD command results&lt;/p&gt;

&lt;p&gt;Modified:&lt;br/&gt;
    commons/proper/net/trunk/src/main/java/org/apache/commons/net/ftp/FTPClient.java&lt;/p&gt;

&lt;p&gt;This fix will fail to extract the path correctly if the commentary contains a quote followed by a space.&lt;br/&gt;
Just realised it will also fail to detect a comment followed by trailing quote.&lt;/p&gt;

&lt;p&gt;Looks like one needs to detect the trailing path quote by looking for the first un-doubled quote. Drat.&lt;/p&gt;</comment>
                            <comment id="13529943" author="sebb@apache.org" created="Wed, 12 Dec 2012 13:22:17 +0000"  >&lt;p&gt;Hopefully this is now sufficient!&lt;/p&gt;

&lt;p&gt;Passes all the test cases (plus a couple of invalid ones).&lt;/p&gt;

&lt;p&gt;If you want to try the SNAPSHOT build it should soon be available from the ASF snapshot repo at:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If the jar contains the class FTPClientTest then it includes the fix below.&lt;/p&gt;

&lt;p&gt;Note that SNAPSHOT builds have not undergone any QA and are not formal ASF releases, so use at your own risk!&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/viewvc?rev=1420655&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1420655&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/NET-492&quot; title=&quot;FTPClient.printWorkingDirectory() incorrectly parses certain valid PWD command results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NET-492&quot;&gt;&lt;del&gt;NET-492&lt;/del&gt;&lt;/a&gt; FTPClient.printWorkingDirectory() incorrectly parses certain valid PWD command results&lt;br/&gt;
Rework to look for lone trailing quote&lt;/p&gt;

&lt;p&gt;Added:&lt;br/&gt;
    commons/proper/net/trunk/src/test/java/org/apache/commons/net/ftp/FTPClientTest.java   (with props)&lt;br/&gt;
Modified:&lt;br/&gt;
    commons/proper/net/trunk/src/main/java/org/apache/commons/net/ftp/FTPClient.java&lt;/p&gt;</comment>
                            <comment id="13529948" author="t.jedrzejewski" created="Wed, 12 Dec 2012 13:28:47 +0000"  >&lt;p&gt;I&apos;ll make a test tomorrow with the snapshot to see it, but if it passes all the tests, I think it should work. Hopefully, I can wait for the official 3.3 release, because my home-made workaround is sufficient for me. Thanks for quick response.&lt;/p&gt;</comment>
                            <comment id="13560264" author="sebb@apache.org" created="Wed, 23 Jan 2013 00:56:35 +0000"  >&lt;p&gt;I assume the latest change fixed the problem.&lt;br/&gt;
If not, please re-open with full details.&lt;/p&gt;</comment>
                            <comment id="13658199" author="moberhuber" created="Wed, 15 May 2013 09:41:34 +0000"  >&lt;p&gt;I just also ran into this:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://bugs.eclipse.org/bugs/show_bug.cgi?id=408092&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bugs.eclipse.org/bugs/show_bug.cgi?id=408092&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Let me state that this is &lt;em&gt;not&lt;/em&gt; a minor issue but a severe regression in Commons Net 3.2 , which makes Commons Net 3.2 unusable for us. The effect of this for end users is that some FTP servers just don&apos;t work at all. It looks like at Eclipse we&apos;ll have to stick to the old Commons Net 2.2 release until a fix for this is officially released &amp;#8211; since Commons Net 3.0 and 3.1 had other severe regressions that made them impossible for us to pick up (deadlocks and threading problems).&lt;/p&gt;

&lt;p&gt;Is anybody thinking about releasing Commons Net 3.2.1 or 3.3 ?&lt;/p&gt;</comment>
                            <comment id="13658218" author="sebb@apache.org" created="Wed, 15 May 2013 10:23:07 +0000"  >&lt;p&gt;Are you able to test Eclipse with a SNAPSHOT of the current code?&lt;/p&gt;</comment>
                            <comment id="13658220" author="moberhuber" created="Wed, 15 May 2013 10:25:57 +0000"  >&lt;p&gt;I can test with a snapshot, but I won&apos;t be able to release with a snapshot due to the Eclipse IP Policies.&lt;/p&gt;</comment>
                            <comment id="13658223" author="sebb@apache.org" created="Wed, 15 May 2013 10:33:22 +0000"  >&lt;p&gt;OK, thanks, please let us know how the test goes.&lt;/p&gt;

&lt;p&gt;I did not mean to suggest that Eclipse could release with a snapshot release - we don&apos;t do that either.&lt;br/&gt;
We only provide snapshots for cases such as these where it helps other developers provide feedback.&lt;/p&gt;

&lt;p&gt;As to a release, yes, I guess one is overdue now. We might be able to start one in the next week or so if the testing goes OK.&lt;/p&gt;</comment>
                            <comment id="13659952" author="moberhuber" created="Thu, 16 May 2013 20:44:58 +0000"  >&lt;p&gt;Found snapshot from 17-apr-2013 here: &lt;a href=&quot;http://vmbuild.apache.org/continuum/workingCopy.action?projectId=107&amp;amp;projectName=Commons+Net&amp;amp;userDirectory=target&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://vmbuild.apache.org/continuum/workingCopy.action?projectId=107&amp;amp;projectName=Commons+Net&amp;amp;userDirectory=target&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13660764" author="sebb@apache.org" created="Fri, 17 May 2013 14:47:31 +0000"  >&lt;p&gt;Snapshots are at&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;as per my comment dated 12/Dec/12 13:22&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12631756">NET-502</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>297212</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 27 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14n3b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>235206</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>