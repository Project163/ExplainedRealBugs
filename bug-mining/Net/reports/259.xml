<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:45:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[NET-690] Performance issue when using the FTPClient to retrieve files from z/OS and z/VM</title>
                <link>https://issues.apache.org/jira/browse/NET-690</link>
                <project id="12310487" key="NET">Commons Net</project>
                    <description>&lt;p&gt;Performance issue when using the FTPClient to retrieve files from z/OS and z/VMPerformance issue when using the FTPClient to retrieve files from z/OS and z/VM&lt;br/&gt;
There is a significant performance drop off when using the FTPClient to retrieve files from z/OS and z/VM ( I haven&apos;t tested against other operating systems). If I switch to using the FTPSClient I don&apos;t see the same problem.&lt;/p&gt;


&lt;p&gt;The following is the command output when doing a retrieve of a file from z/OS which is only 2.0KB in size:&lt;/p&gt;

&lt;p&gt;&lt;b&gt;FTPClient:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;2020-10-07 08:30:46.261 SENT&amp;gt;&amp;gt;&amp;gt; RETR&lt;/p&gt;

&lt;p&gt;2020-10-07 08:30:46.291 RECD&amp;lt;&amp;lt;&amp;lt; 125 Sending data set TEST.FTP(PART11B) FIXrecfm 80&lt;/p&gt;

&lt;p&gt;2020-10-07 08:32:46.342 RECD&amp;lt;&amp;lt;&amp;lt; 250 Transfer completed successfully.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;FTPSClient:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;2020-10-07 08:30:45.813 SENT&amp;gt;&amp;gt;&amp;gt; RETR&lt;/p&gt;

&lt;p&gt;2020-10-07 08:30:45.843 RECD&amp;lt;&amp;lt;&amp;lt; 125 Sending data set TEST.FTP(PART11B) FIXrecfm 80&lt;/p&gt;

&lt;p&gt;2020-10-07 08:30:46.014 RECD&amp;lt;&amp;lt;&amp;lt; 250 Transfer completed successfully.&lt;/p&gt;


&lt;p&gt;The first transfer using the FTPClient took 2 minutes, which when switching to using FTPS take less than a second. This has only been an issue since upgrading from commons-net 3.6 to 3.7.1. It seems to consistently take 2 minutes transfer pretty much regardless of the size of the file, so appears to be waiting on something or hitting a timeout of some sort.&#160;&lt;/p&gt;

&lt;p&gt;I have added the code I&apos;m using to establish the FTPClient and connect to the host and to retrieve the file.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;//Establish the FTPClient and connect to the host
&lt;/span&gt;
	&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; FTPClient getFTPClient(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; host, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; userProperty, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; passwordProperty) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; SocketException, IOException {
		FTPClient client = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FTPClient();
		client.addProtocolCommandListener(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;);
		client.connect(host);
		client.login(getProperties().getProperty(userProperty), getProperties().getProperty(passwordProperty));
		client.enterLocalPassiveMode();
		&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; client;
	}

&lt;span class=&quot;code-comment&quot;&gt;//Retrieve file
&lt;/span&gt;
	&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void getFile(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; remoteDir,&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; localDir, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; file, FTPClient client) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException, FileNotFoundException {
		client.changeWorkingDirectory(remoteDir);
		client.setFileType(FTP.BINARY_FILE_TYPE);
      	        BufferedOutputStream bo = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BufferedOutputStream(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;                       FileOutputStream(localDir + file));
		client.retrieveFile(file, bo);
		bo.close();
	}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Java 8, FTP server on z/OS | z/VM&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</environment>
        <key id="13334242">NET-690</key>
            <summary>Performance issue when using the FTPClient to retrieve files from z/OS and z/VM</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="payalmeh">Payal</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 Oct 2020 17:30:59 +0000</created>
                <updated>Tue, 13 Oct 2020 18:09:39 +0000</updated>
                                            <version>3.7.1</version>
                                                    <component>FTP</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17209806" author="garydgregory" created="Wed, 7 Oct 2020 19:34:41 +0000"  >&lt;p&gt;Feel free to provide a PR on GitHub &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17211114" author="payalmeh" created="Fri, 9 Oct 2020 16:01:25 +0000"  >&lt;p&gt;I have submitted pull request: &lt;a href=&quot;https://github.com/apache/commons-net/pull/65&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-net/pull/65&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;There slow down is due to a hang it when attempts to read the transfer response from the control channel following transfer of the data. It looks to me like the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/NET-584&quot; title=&quot;Error when using org.apache.commons.net.ftp.FTPClient setControlKeepAliveTimeout&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NET-584&quot;&gt;&lt;del&gt;NET-584&lt;/del&gt;&lt;/a&gt; may have introduced the problem as prior to that the inputstream and socket were being closed prior to the reply.&lt;/p&gt;


&lt;p&gt;I have seen that it has caused a test failure, however I am unable to get the required dependencies to run that particular test class, and am not at all familiar with the Apache FTP Server. I have tested the change against the z/OS and z/VM FTP servers (using both FTP and FTPS) and don&apos;t see a problem. I&apos;ll leave it with you whether you want to fix in an alternative way&#160;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17211117" author="garydgregory" created="Fri, 9 Oct 2020 16:05:03 +0000"  >&lt;p&gt;Please see my comment on GH.&lt;/p&gt;</comment>
                            <comment id="17211151" author="payalmeh" created="Fri, 9 Oct 2020 16:35:52 +0000"  >&lt;p&gt;Oh, the first pull request I submitted did have a test failure (in&#160;FTPSClientTest.testRetrieveFilePathNameRoot()) plus a formatting failure, so I closed it, updated the formatting and created a new pull request. This time no test failure, even though the code is the same...&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 5 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0jhxk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>