<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:44:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[NET-313] FTP: EPRT fails + EPRT/EPSV issues</title>
                <link>https://issues.apache.org/jira/browse/NET-313</link>
                <project id="12310487" key="NET">Commons Net</project>
                    <description>&lt;p&gt;as implemented in &lt;a href=&quot;https://issues.apache.org/jira/browse/NET-288&quot; title=&quot;FTP should support IPv6&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NET-288&quot;&gt;&lt;del&gt;NET-288&lt;/del&gt;&lt;/a&gt;, the client can work now via IPv6 ... EPSV is not only useful on IPv6 but also when NAT is enabled (see &lt;a href=&quot;http://tools.ietf.org/html/rfc2428&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;RFC 2428&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;what my patch does:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;(re)enable EPSV command on IPv4 too (i dont know why &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rwinston%40eircom.net&quot; class=&quot;user-hover&quot; rel=&quot;rwinston@eircom.net&quot;&gt;rwinston@eircom.net&lt;/a&gt; removed it from the supplied patch in &lt;a href=&quot;https://issues.apache.org/jira/browse/NET-288&quot; title=&quot;FTP should support IPv6&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NET-288&quot;&gt;&lt;del&gt;NET-288&lt;/del&gt;&lt;/a&gt;), also see my comments in patch&lt;/li&gt;
	&lt;li&gt;sending EPRT only if we are over IPv6, cause there is no advantage over PORT on IPv4, it could even have disadvantages (see comments in patch)&lt;/li&gt;
	&lt;li&gt;EPRT was sending the result of getActivePort() to the server, but when there was no activePortRange set, it did send 0 as default which leads to an error on server site:
&lt;blockquote&gt;
&lt;p&gt;Tue Mar 23 17:17:20 2010 &lt;span class=&quot;error&quot;&gt;&amp;#91;pid 10581&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;ftpuser&amp;#93;&lt;/span&gt; FTP command: Client &quot;192.168.11.130&quot;, &quot;EPRT |1|192.168.11.130|0|&quot;&lt;br/&gt;
Tue Mar 23 17:17:20 2010 &lt;span class=&quot;error&quot;&gt;&amp;#91;pid 10581&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;ftpuser&amp;#93;&lt;/span&gt; FTP response: Client &quot;192.168.11.130&quot;, &quot;500 Illegal EPRT command.&quot;&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
	&lt;li&gt;and even calling getActivePort() has no sense here, cause that port is used to be random, but we should send same port  where the ServerSocket is listening on -&amp;gt; server.getLocalPort()&lt;/li&gt;
	&lt;li&gt;getActivePort() checks if __activeMaxPort &amp;gt; __activeMinPort, but when i want to set a range of only one single port (min==max) it would return 0 ... now it will check if equal and return __activeMaxPort&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment>&lt;p&gt;FTP server = vsftpd/Centos 5.4&lt;br/&gt;
FTPClient = commons-net (FTPClient) &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Network = IPv4&lt;/p&gt;</environment>
        <key id="12460219">NET-313</key>
            <summary>FTP: EPRT fails + EPRT/EPSV issues</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="gockelhahn">Felix Bolte</reporter>
                        <labels>
                    </labels>
                <created>Thu, 25 Mar 2010 11:15:00 +0000</created>
                <updated>Sat, 4 Jun 2011 19:25:17 +0000</updated>
                            <resolved>Mon, 12 Jul 2010 16:22:25 +0000</resolved>
                                    <version>2.1</version>
                                    <fixVersion>2.2</fixVersion>
                                    <component>FTP</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12873680" author="mnasato" created="Mon, 31 May 2010 14:43:33 +0000"  >&lt;p&gt;Just stumbled into an issue with v2.1 and nf_conntrack_ftp on Linux where the connection times out and iptables logs something like&lt;/p&gt;

&lt;p&gt;  May 31 14:16:38 foo kernel: &lt;span class=&quot;error&quot;&gt;&amp;#91;35656.336325&amp;#93;&lt;/span&gt; conntrack_ftp: partial EPRT 987422914+27&lt;/p&gt;

&lt;p&gt;I guess this may confirm your EPRT &quot;could even have disadvantages&quot; prediction. Using commons-net v2.0 everything works fine.&lt;/p&gt;

&lt;p&gt;(I also wonder why there are v2.1 jars in the Maven central repository if v2.1 hasn&apos;t been officially released yet, but that&apos;s a different story.)&lt;/p&gt;</comment>
                            <comment id="12885632" author="dgoertzen" created="Tue, 6 Jul 2010 18:42:32 +0000"  >&lt;p&gt;Encountered issue with EPRT incorrectly sending port as &quot;0&quot; instead of the actual port that the ServerSocket is listening on.  This is always going to fail, and normally would fall back to the PORT command. However, in my case the FTP server (FileZilla) is terminating the connection when it encounters the invalid EPRT command rather than returning an error response, so the PORT command never even gets a chance to run.  As mentioned in the description, server.getLocalPort() should be used here, rather than getActivePort().&lt;/p&gt;</comment>
                            <comment id="12887253" author="sebb@apache.org" created="Mon, 12 Jul 2010 00:31:05 +0000"  >&lt;p&gt;I suspect that the reversion to using PASV for IPv4 was to maintain backwards compatibility.&lt;/p&gt;

&lt;p&gt;Would it work for you to make it an option to try EPSV on IPV4?&lt;/p&gt;

&lt;p&gt;That could easily be added when the patch is applied.&lt;/p&gt;

&lt;p&gt;The other parts of the patch look good.&lt;/p&gt;</comment>
                            <comment id="12887357" author="gockelhahn" created="Mon, 12 Jul 2010 12:20:55 +0000"  >&lt;p&gt;hi sebb,&lt;/p&gt;

&lt;p&gt;you are right, as EPRT could have disadvantages on IPv4,&lt;br/&gt;
EPSV could have them too ... default to PASV is ok&lt;/p&gt;

&lt;p&gt;please go ahead ... an option to enable EPSV as default sounds fine to me&lt;/p&gt;</comment>
                            <comment id="12887407" author="sebb@apache.org" created="Mon, 12 Jul 2010 16:22:25 +0000"  >&lt;p&gt;Thanks for the patch and info.&lt;/p&gt;

&lt;p&gt;Applied to SVN in two different commits (see SVN history).&lt;br/&gt;
Added method to enable EPSV over IPv4 as discussed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12439773" name="ftp_nat.patch" size="3691" author="gockelhahn" created="Thu, 25 Mar 2010 11:16:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72081</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 19 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0kv1j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>119847</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>