<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:45:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[NET-465] FTPClient setSendBufferSize and setReceiveBufferSize on data socket</title>
                <link>https://issues.apache.org/jira/browse/NET-465</link>
                <project id="12310487" key="NET">Commons Net</project>
                    <description>&lt;p&gt;When sending large files the need to set the send and receive buffer sizes on the data socket is much more important than the command socket.  Please either give 2 more setters or make the setters set the data socket and leave the command socket alone.&lt;/p&gt;</description>
                <environment>&lt;p&gt;All&lt;/p&gt;</environment>
        <key id="12556266">NET-465</key>
            <summary>FTPClient setSendBufferSize and setReceiveBufferSize on data socket</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jimkerwood">Jim Kerwood</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 May 2012 18:09:54 +0000</created>
                <updated>Fri, 22 Nov 2013 07:32:50 +0000</updated>
                            <resolved>Wed, 17 Apr 2013 19:48:57 +0000</resolved>
                                    <version>3.1</version>
                                    <fixVersion>3.3</fixVersion>
                                    <component>FTP</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="900">0.25h</timeoriginalestimate>
                            <timeestimate seconds="900">0.25h</timeestimate>
                                        <comments>
                            <comment id="13402320" author="bogdro" created="Wed, 27 Jun 2012 16:18:28 +0000"  >&lt;p&gt;The buffer size already was for the data connections, but it was set only on the buffered input and output streams, not on the sockets. The attached file, ftp-bufsize.diff, fixes this. Now if the buffer size is greater than zero, it is used both on the streams and the sockets. If the buffer size is set to 0 or less, the defaults are used (nothing is set on the sockets and the buffered streams use the default size).&lt;/p&gt;</comment>
                            <comment id="13405125" author="bogdro" created="Mon, 2 Jul 2012 16:50:28 +0000"  >&lt;p&gt;I forgot about one possibility - you can create and install your own SocketFactory that creates Sockets with your own buffer size. Look at the DefaultSocketFactory class in Commons-Net. It is very simple and you can make your own class like this and pass it to the setSocketFactory() method. This will work even with older releases of Commons-Net and you don&apos;t have to wait for the next version.&lt;/p&gt;</comment>
                            <comment id="13413332" author="sebb@apache.org" created="Thu, 12 Jul 2012 23:45:18 +0000"  >&lt;p&gt;Thansk for the patch.&lt;/p&gt;

&lt;p&gt;I applied it with some minor simplifications.&lt;br/&gt;
Also it seemed more sensible to set the socket size where the socket is created.&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/viewvc?rev=1361003&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1361003&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/NET-465&quot; title=&quot;FTPClient setSendBufferSize and setReceiveBufferSize on data socket&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NET-465&quot;&gt;&lt;del&gt;NET-465&lt;/del&gt;&lt;/a&gt; FTPClient setSendBufferSize and setReceiveBufferSize on data socket&lt;/p&gt;

&lt;p&gt;Modified:&lt;br/&gt;
    commons/proper/net/trunk/src/changes/changes.xml&lt;br/&gt;
    commons/proper/net/trunk/src/main/java/org/apache/commons/net/ftp/FTPClient.java&lt;/p&gt;</comment>
                            <comment id="13560531" author="chadwilson" created="Wed, 23 Jan 2013 09:58:30 +0000"  >&lt;p&gt;There is some concern this might have caused some rather severe performance issues in some circumstances (including the default configuration) - would one of the submitters/reviewers care to comment on &lt;a href=&quot;https://issues.apache.org/jira/browse/NET-493&quot; title=&quot;FTPClient: Slow data transfer rate if __bufferSize != 0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NET-493&quot;&gt;&lt;del&gt;NET-493&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="13560544" author="tn" created="Wed, 23 Jan 2013 10:36:21 +0000"  >&lt;p&gt;The patch changed the default send/receive buffer size on the socket to 1024 which is pretty low considering the normal default, e.g. on my system&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;sendBuffer: 131072&lt;/li&gt;
	&lt;li&gt;receiveBuffer: 2097152&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I can understand that the slow rates are due to starvation of the higher layers based on constant buffer overruns of the underlying socket (and the involved TCP overhead of throttling the datarate). I think the idea outlined by Bogdan, to supply a custom SocketFactory would be a better solution than actually adjusting the socket buffer size in a similar way than the internal buffer.&lt;/p&gt;

&lt;p&gt;Another quick fix would be to not to adjust the socket buffers by default, only when the user provides another buffer size. Right now, the socket buffers are always adjusted (to the default, if there is no user-supplied value).&lt;/p&gt;</comment>
                            <comment id="13560936" author="sebb@apache.org" created="Wed, 23 Jan 2013 18:46:05 +0000"  >&lt;p&gt;In retrospect it would have been better to provide additional getters/setters for the Socket size, as the requirements are quite different.&lt;/p&gt;

&lt;p&gt;It&apos;s unfortunate that the Javadoc suggests that the buffer size applies to the sockets, whereas it was originally applied to the buffered streams.&lt;/p&gt;

&lt;p&gt;Since the socket size is currently only set when the socket is created, a (messy) work-round with the existing code is to set the desired socket size, create the socket, and then immediately reset the size to a value more suitable for the buffered streams.&lt;/p&gt;</comment>
                            <comment id="13561097" author="sebb@apache.org" created="Wed, 23 Jan 2013 21:24:47 +0000"  >&lt;p&gt;Reworked the original fix:&lt;/p&gt;


&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/viewvc?rev=1437740&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1437740&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/NET-465&quot; title=&quot;FTPClient setSendBufferSize and setReceiveBufferSize on data socket&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NET-465&quot;&gt;&lt;del&gt;NET-465&lt;/del&gt;&lt;/a&gt; FTPClient setSendBufferSize and setReceiveBufferSize on data socket&lt;br/&gt;
Reworked the original fix.&lt;/p&gt;

&lt;p&gt;Modified:&lt;br/&gt;
    commons/proper/net/trunk/src/changes/changes.xml&lt;br/&gt;
    commons/proper/net/trunk/src/main/java/org/apache/commons/net/ftp/FTPClient.java&lt;/p&gt;</comment>
                            <comment id="13561101" author="sebb@apache.org" created="Wed, 23 Jan 2013 21:27:53 +0000"  >&lt;p&gt;The Apache snapshot repo should now contain the latest 3.3-SNAPSHOT code if anyone wants to give it a try.&lt;/p&gt;

&lt;p&gt;Feedback welcome.&lt;/p&gt;</comment>
                            <comment id="13561121" author="tn" created="Wed, 23 Jan 2013 21:43:38 +0000"  >&lt;p&gt;I tested to download a large file (~17MB) with the FTPClientExample (default settings) from a remote server with both the 3.2 and the latest version (trunk):&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;3.2: 2 KB/s&lt;/li&gt;
	&lt;li&gt;trunk: ~700 KB/s&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;so it seems to work fine again.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="13561123" author="sebb@apache.org" created="Wed, 23 Jan 2013 21:48:25 +0000"  >&lt;p&gt;OK, thanks!&lt;/p&gt;

&lt;p&gt;Does anyone want to test whether the new settters for SO_SNDBUF and SO_RCVBUF work OK?&lt;/p&gt;</comment>
                            <comment id="13634357" author="sebb@apache.org" created="Wed, 17 Apr 2013 19:48:57 +0000"  >&lt;p&gt;Assume it&apos;s OK. If not please re-open with details.&lt;/p&gt;</comment>
                            <comment id="13634364" author="tn" created="Wed, 17 Apr 2013 19:58:44 +0000"  >&lt;p&gt;There was a comment from somebody on the user ml with some performance figures.&lt;br/&gt;
The conclusion was that 3.3-SNAPSHOT was still slower than 3.1 although better than 3.2.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12623546">NET-493</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12630506">NET-499</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12680654">NET-519</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12533668" name="ftp-bufsize.diff" size="6068" author="bogdro" created="Wed, 27 Jun 2012 16:18:28 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>259483</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 31 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lpv3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>124841</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>