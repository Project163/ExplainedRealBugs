<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:45:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[NET-422] FTP using HTTP proxy not working</title>
                <link>https://issues.apache.org/jira/browse/NET-422</link>
                <project id="12310487" key="NET">Commons Net</project>
                    <description>&lt;p&gt;I know that FTPHTTPClient is experimental, but - I have discovered 2 bugs in it:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;response from proxy is taken only if username and password are set&lt;/li&gt;
	&lt;li&gt;username and response are not correctly provided to Base64.encode() method&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I will attach a patch with proposed fix, feel free to apply it if you think it&apos;s correct.&lt;/p&gt;

&lt;p&gt;One more note: I&apos;m not expert in this area so sorry if this question is nonsense but - shouldn&apos;t it be possible to connect to the encrypted FTP over HTTP proxy as well? Or am I completely wrong and this can&apos;t be ever possible.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</description>
                <environment>&lt;p&gt;java version &quot;1.6.0_26&quot;&lt;br/&gt;
 Java(TM) SE Runtime Environment (build 1.6.0_26-b03)&lt;br/&gt;
 Java HotSpot(TM) 64-Bit Server VM (build 20.1-b02, mixed mode)&lt;/p&gt;

&lt;p&gt;Linux cattie 2.6.38-10-generic #46-Ubuntu SMP Tue Jun 28 15:07:17 UTC 2011 x86_64 x86_64 x86_64 GNU/Linux&lt;/p&gt;</environment>
        <key id="12520926">NET-422</key>
            <summary>FTP using HTTP proxy not working</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tmysik">Tomas Mysik</reporter>
                        <labels>
                    </labels>
                <created>Wed, 31 Aug 2011 14:17:28 +0000</created>
                <updated>Tue, 20 Nov 2012 16:38:45 +0000</updated>
                            <resolved>Tue, 10 Jan 2012 19:40:25 +0000</resolved>
                                    <version>3.0.1</version>
                                    <fixVersion>3.1</fixVersion>
                                    <component>FTP</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13094560" author="tmysik" created="Wed, 31 Aug 2011 14:19:00 +0000"  >&lt;p&gt;Proposed fix&lt;/p&gt;</comment>
                            <comment id="13114844" author="magnus.johansson" created="Mon, 26 Sep 2011 17:42:07 +0000"  >&lt;p&gt;I ran into this problem in one of my projects and have attached a patch for it to this issue.&lt;/p&gt;

&lt;p&gt;Fix summary:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;em&gt;openDataConnection&lt;/em&gt; now acutely try to establish the connection through the proxy. (The implementation now reuses the parse functions for the &quot;pasv&quot; response from FTPClient so they have been made protected)&lt;/li&gt;
	&lt;li&gt;connect now calls super.&lt;em&gt;connectAction&lt;/em&gt;() to get the member variable initialization right&lt;/li&gt;
	&lt;li&gt;Added the &quot;Host&quot; header to the proxy connect call, its required by some proxies&lt;/li&gt;
	&lt;li&gt;Fixed the user/password if-statement and base64 encoding issues in tunnelHandshake, which was also noted by Tomas in the last comment&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;(Also added some new switches to the examples.ftp.FTPClientExample so that it can be used to test the FTPHTTPClient impl as well)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I have tested the patch against BlueCoat and Squid proxy installations successfully&lt;/p&gt;

&lt;p&gt;Hope the patch can be of some use&lt;/p&gt;

&lt;p&gt;Regards,&lt;br/&gt;
    Magnus&lt;/p&gt;</comment>
                            <comment id="13180267" author="karkre" created="Thu, 5 Jan 2012 10:31:30 +0000"  >&lt;p&gt;We use here an HTTP Proxy without user and password. So actual version is not working in is situation. When comes a new version to get the fix?&lt;/p&gt;</comment>
                            <comment id="13180433" author="sebb@apache.org" created="Thu, 5 Jan 2012 14:40:09 +0000"  >&lt;p&gt;@Magnus: &lt;br/&gt;
I&apos;m not sure about the encoding - why only use UTF-8, and not the controlEncoding?&lt;br/&gt;
Also, if getDataConnectionMode() != PASSIVE_LOCAL_DATA_CONNECTION_MODE, perhaps it would be better to report an error, rather than overriding the mode.&lt;/p&gt;</comment>
                            <comment id="13180501" author="magnus.johansson" created="Thu, 5 Jan 2012 16:20:14 +0000"  >&lt;p&gt;@Sebb:&lt;br/&gt;
I agree, it would be better to use the controlEncoding, the UTF-8 was already there for the base64 encoded auth part (where it makes sense) for the connection string and the rest of the headers it was probably just a copy/paste on my part&lt;/p&gt;

&lt;p&gt;Regarding the getDataConnectionMode() != PASSIVE_LOCAL_DATA_CONNECTION_MODE my idea there was that since the user has choosen to use the FTPHTTPClient and wants to run through a proxy (which only supports passive mode) this would save the user the line of code to change the mode since passive mode is required. But it can return an error instead for sure, it would at also educate the user of the limitations of running through a proxy &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13180749" author="sebb@apache.org" created="Thu, 5 Jan 2012 19:28:51 +0000"  >&lt;p&gt;Does auth require UTF-8? &lt;br/&gt;
Normally HTTP requests expect ISO-8859-1.&lt;/p&gt;</comment>
                            <comment id="13181734" author="sebb@apache.org" created="Sat, 7 Jan 2012 00:50:20 +0000"  >&lt;p&gt;Thanks!&lt;/p&gt;

&lt;p&gt;Magnus&apos; patch applied with minor tweaks: &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;changed FTPClientExample#proxyPort to int (default 80);&lt;/li&gt;
	&lt;li&gt;removed host/port instance variables from FTPHTTPClient as they were not read.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;In case you want to test the fixes, I&apos;ve uploaded a snapshot to:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://repository.apache.org/content/repositories/snapshots/commons-net/commons-net/3.1-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/repositories/snapshots/commons-net/commons-net/3.1-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13501288" author="tmysik" created="Tue, 20 Nov 2012 16:38:45 +0000"  >&lt;p&gt;Could anyone please explain me the following error which happens to us &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;? It happens in NetBeans if one sets proxy for all protocols; if one sets only HTTP proxy, everything works. Feel free to update the NetBeans issue as well, if you want to. Thanks a lot in advance for any comment.&lt;/p&gt;

&lt;p&gt;INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;org.netbeans.modules.php.project.connections.ftp.FtpClient&amp;#93;&lt;/span&gt;: Exception while connecting&lt;br/&gt;
java.net.SocketException: Malformed reply from SOCKS server&lt;br/&gt;
	at java.net.SocksSocketImpl.readSocksReply(SocksSocketImpl.java:128)&lt;br/&gt;
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:459)&lt;br/&gt;
	at java.net.Socket.connect(Socket.java:579)&lt;br/&gt;
	at java.net.Socket.connect(Socket.java:528)&lt;br/&gt;
	at java.net.Socket.&amp;lt;init&amp;gt;(Socket.java:425)&lt;br/&gt;
	at java.net.Socket.&amp;lt;init&amp;gt;(Socket.java:208)&lt;br/&gt;
	at org.apache.commons.net.ftp.FTPHTTPClient.connect(FTPHTTPClient.java:122)&lt;/p&gt;


&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://netbeans.org/bugzilla/show_bug.cgi?id=222481&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://netbeans.org/bugzilla/show_bug.cgi?id=222481&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12419475">NET-267</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12492462" name="FtpHttpClient.patch" size="1111" author="tmysik" created="Wed, 31 Aug 2011 14:19:00 +0000"/>
                            <attachment id="12496513" name="http_proxy_magnus.patch" size="11386" author="magnus.johansson" created="Mon, 26 Sep 2011 17:44:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2258</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0j0on:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>109039</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>