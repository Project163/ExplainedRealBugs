<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:44:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[NET-363] Can&apos;t connect to a server behind firewall in passive mode</title>
                <link>https://issues.apache.org/jira/browse/NET-363</link>
                <project id="12310487" key="NET">Commons Net</project>
                    <description>&lt;p&gt;When the FTP server is behind a firewall, FTPClient can connect, but it cannot transfer data. This is because the FTP server provides it&apos;s own address instead of the firewall address to make the connection. I have confirmed the problem by hacking a copy of FTPClient to set the __passiveHost to the appropriate internet address. With this hack, I can transfer data.&lt;/p&gt;

&lt;p&gt;Perhaps the FTP server could be configured differently to fix the issue. Unfortunately, I do not have access to the server configuration. I do know that the commercial product IpswitchFtp does deal with the issue as this extract from it&apos;s log shows:&lt;br/&gt;
------------&lt;br/&gt;
PASV&lt;br/&gt;
227 Entering Passive Mode (192,168,13,11,195,129)&lt;br/&gt;
connecting data channel to 192.168.13.11:195,129(50049)&lt;br/&gt;
Substituting connection address 159.106.121.79 for private address 192.168.13.11 from PASV&lt;br/&gt;
data channel connected to 159.106.121.79:195,129(50049)&lt;br/&gt;
LIST&lt;br/&gt;
125 List started OK&lt;br/&gt;
transferred 4157 bytes in 0.078 seconds, 425.688 kbps ( 53.211 kBps), transfer succeeded.&lt;br/&gt;
250 List completed successfully.&lt;br/&gt;
QUIT&lt;br/&gt;
----------------------------&lt;br/&gt;
I can take a shot at a fix if you want. I&apos;ll set some timeout, and  if that fails, I&apos;ll use the original address&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows Client with Zos mainframe server behind a firewall.  However I think any client/server will demonstrate the issue as long as the server is behind a firewall.&lt;/p&gt;</environment>
        <key id="12500485">NET-363</key>
            <summary>Can&apos;t connect to a server behind firewall in passive mode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="danieldamon">daniel damon</reporter>
                        <labels>
                    </labels>
                <created>Fri, 4 Mar 2011 23:10:59 +0000</created>
                <updated>Mon, 29 Feb 2016 16:21:04 +0000</updated>
                            <resolved>Sat, 5 Mar 2011 21:22:28 +0000</resolved>
                                    <version>2.2</version>
                                    <fixVersion>3.0</fixVersion>
                                    <component>FTP</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13002888" author="danieldamon" created="Sat, 5 Mar 2011 00:46:20 +0000"  >&lt;p&gt;Here is a diff for changes that I made that work for me:&lt;/p&gt;

&lt;p&gt;28a29&lt;br/&gt;
&amp;gt; import java.net.SocketException;&lt;/p&gt;

&lt;p&gt;285c286&lt;br/&gt;
&amp;lt;     &lt;/p&gt;

&lt;p&gt;&amp;#8212;&lt;br/&gt;
&amp;gt;     private boolean __useRemoteAddress = false;&lt;/p&gt;

&lt;p&gt;592c593,602&lt;br/&gt;
&amp;lt;             socket = &lt;em&gt;socketFactory&lt;/em&gt;.createSocket(__passiveHost, __passivePort);&lt;/p&gt;

&lt;p&gt;&amp;#8212;&lt;br/&gt;
&amp;gt;             //if __passiveHost fails, try the original InetAddress. Server may be behind firewall.&lt;/p&gt;

&lt;p&gt;&amp;gt;             if (__useRemoteAddress) &lt;/p&gt;
{

&amp;gt;               socket = _socketFactory_.createSocket(getRemoteAddress().getHostAddress(), __passivePort);

&amp;gt;             }
&lt;p&gt;else try &lt;/p&gt;
{

&amp;gt;               socket = _socketFactory_.createSocket(__passiveHost, __passivePort);

&amp;gt;             }
&lt;p&gt; catch (SocketException e) &lt;/p&gt;
{

&amp;gt;               socket = _socketFactory_.createSocket(getRemoteAddress().getHostAddress(), __passivePort);

&amp;gt;               __useRemoteAddress=true;

&amp;gt;             }

&lt;p&gt;&amp;gt;             &lt;/p&gt;
</comment>
                            <comment id="13002901" author="sebb@apache.org" created="Sat, 5 Mar 2011 01:23:21 +0000"  >&lt;p&gt;In &lt;a href=&quot;https://issues.apache.org/jira/browse/NET-296&quot; title=&quot;java.net.SocketException: Operation timed out error while entering Passive mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NET-296&quot;&gt;&lt;del&gt;NET-296&lt;/del&gt;&lt;/a&gt; I wrote:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;But can a local address ever be valid if the original address was not local? I suspect not.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;If this is true, then the code that handles the PASV reply can set __passiveHost accordingly, and there would be no need to use the try/catch (or cache the result in __useRemoteHost).&lt;/p&gt;</comment>
                            <comment id="13003039" author="sebb@apache.org" created="Sat, 5 Mar 2011 20:29:26 +0000"  >&lt;p&gt;Note that using EPSV - ie ftpclient.setUseEPSVwithIPv4(true) - may also help, and this is available in v2.2&lt;/p&gt;</comment>
                            <comment id="13003047" author="sebb@apache.org" created="Sat, 5 Mar 2011 21:22:28 +0000"  >&lt;p&gt;Fixed in SVN.&lt;/p&gt;

&lt;p&gt;Please test if you can, and re-open if there are any problems.&lt;/p&gt;</comment>
                            <comment id="13004639" author="dan.damon@doc.state.or.us" created="Wed, 9 Mar 2011 16:39:00 +0000"  >&lt;p&gt;Sorry - I&apos;ve been out with the flu for the past couple of days.&lt;/p&gt;

&lt;p&gt;But I suspect you are right.  I&apos;ll see if I can test your changes.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Dan Damon &lt;/p&gt;
</comment>
                            <comment id="13004682" author="dan.damon@doc.state.or.us" created="Wed, 9 Mar 2011 17:47:15 +0000"  >&lt;p&gt;Yes,  I confirm that your changes work.  I tested it on the original situation where the FTP server is behind a NAT firewall and provides a private address.  I also tested it on another FTP server that is on the same private address as the FTP Client. I assume your patch has special code to handle this situation because it works OK.  The only other place that it might fail would be from one private network to another - different network.  Say, from 192.168.xxx.xxx to 10.xxx.xxx.xxx.  I can imagine a scenario where it might cause a failure, but it seems remote.&lt;/p&gt;</comment>
                            <comment id="13004710" author="sebb@apache.org" created="Wed, 9 Mar 2011 18:33:16 +0000"  >&lt;p&gt;Thanks, that&apos;s very helpful to know.&lt;/p&gt;

&lt;p&gt;The fix is as follows:&lt;/p&gt;

&lt;p&gt;If the PASV reply host is a local address, and the remote host is not local, then use the remote host address instead of the PASV reply.  If both are local addresses, no changes are made. &lt;/p&gt;

&lt;p&gt;I think this can only be a problem if there is some kind of NAT between the two local hosts, in which case I suspect the original connection would have to be made using a non-local address, and then the patch would apply.&lt;/p&gt;

&lt;p&gt;If anyone finds otherwise, please re-open with details!&lt;/p&gt;</comment>
                            <comment id="15172079" author="davenice" created="Mon, 29 Feb 2016 16:21:04 +0000"  >&lt;p&gt;I&apos;ve hit the issue with &quot;site local&quot; connecting to &quot;site local&quot; - opened a new defect because this one&apos;s quite ancient &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/NET-588&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/NET-588&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12437457">NET-296</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72023</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 37 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l0lb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>120746</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>