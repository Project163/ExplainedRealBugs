<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:45:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[NET-501] Race Condition on TelnetClient.disconnect() and TelnetInputStream.run() . java.lang.IllegalStateException: Queue is full! Cannot process another character.</title>
                <link>https://issues.apache.org/jira/browse/NET-501</link>
                <project id="12310487" key="NET">Commons Net</project>
                    <description>&lt;p&gt;I&apos;m getting the following exception while disconnecting a threaded (readerThread=true) TelnetClient connection. &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-160&quot;&lt;/span&gt; java.lang.IllegalStateException: Queue is full! Cannot process another character. 
	at org.apache.commons.net.telnet.TelnetInputStream.__processChar(TelnetInputStream.java:339)
	at org.apache.commons.net.telnet.TelnetInputStream.run(TelnetInputStream.java:647)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:722)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I noticed that when TelnetClient.disconnect() is called the attribute _&lt;em&gt;threaded is set to false while the thread in the TelnetInputStream.run() method could call TelnetInputStream().&lt;/em&gt;_processChar(...) throwing IllegalStateException&lt;/p&gt;


&lt;p&gt;This is a test program to reproduce the issue&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestTelnetClient &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Runnable&lt;/span&gt; {

	/**
	 * @param args
	 */
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
		ArrayList&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;&amp;gt; workers = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;&amp;gt;();
		&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;( &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i=0; i&amp;lt;1000; ++i){
			&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; t = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; ( &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TestTelnetClient() );
			t.start();
			workers.add(t);
		}
		&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; t : workers ) {			
			&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
				t.join();			
			} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (InterruptedException e) {
				e.printStackTrace();
			}
		}			

	}

	@Override
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void run() {
		&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Starting thread...&quot;&lt;/span&gt;);
		TelnetClient tc = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TelnetClient();
&lt;span class=&quot;code-comment&quot;&gt;//		tc.setReaderThread(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
&lt;/span&gt;		&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
			tc.connect(&lt;span class=&quot;code-quote&quot;&gt;&quot;localhost&quot;&lt;/span&gt;, 23);
			tc.setSoTimeout(1000);
			InputStream in = tc.getInputStream();
			&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; ch;
			in.read();
		} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (SocketException e) {
			e.printStackTrace();
		} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {
			e.printStackTrace();
		} &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
			&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Disconnecting...&quot;&lt;/span&gt;);
			&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
				tc.disconnect();
			} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {
				&lt;span class=&quot;code-comment&quot;&gt;// TODO Auto-generated &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; block
&lt;/span&gt;				e.printStackTrace();
			}
		}
		
	}

}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A telnet server (telnetd) is required. I also modified the initial banner ( /etc/issue.net ) with a lot of characters to get a better chance to receive information while calling disconnect.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Ubuntu 12.04 64 bits x86&lt;/p&gt;</environment>
        <key id="12631346">NET-501</key>
            <summary>Race Condition on TelnetClient.disconnect() and TelnetInputStream.run() . java.lang.IllegalStateException: Queue is full! Cannot process another character.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jlastiri">Juli&#225;n Lastiri</reporter>
                        <labels>
                    </labels>
                <created>Thu, 7 Feb 2013 22:07:28 +0000</created>
                <updated>Wed, 12 Jun 2013 21:09:52 +0000</updated>
                            <resolved>Thu, 6 Jun 2013 11:33:38 +0000</resolved>
                                    <version>3.2</version>
                                    <fixVersion>3.3</fixVersion>
                                    <component>Telnet</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13676924" author="sebb@apache.org" created="Thu, 6 Jun 2013 11:33:38 +0000"  >&lt;p&gt;Thanks for the report; fix applied to SVN:&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/r1490241&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1490241&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/NET-501&quot; title=&quot;Race Condition on TelnetClient.disconnect() and TelnetInputStream.run() . java.lang.IllegalStateException: Queue is full! Cannot process another character.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;NET-501&quot;&gt;&lt;del&gt;NET-501&lt;/del&gt;&lt;/a&gt; Race Condition on TelnetClient.disconnect() and TelnetInputStream.run()&lt;/p&gt;

&lt;p&gt;Modified:&lt;br/&gt;
    commons/proper/net/trunk/src/changes/changes.xml&lt;br/&gt;
    commons/proper/net/trunk/src/main/java/org/apache/commons/net/telnet/TelnetInputStream.java&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>311842</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 24 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1htdz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>312188</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>