diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 5cc3ae59..93928cde 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -69,6 +69,9 @@ The <action> type attribute can be add,update,fix,remove.
             Deprecated unusable append methods.
             Added new append method, as well as example IMapImportMbox class to make use of it.
             </action>
+            <action issue="NET-511" dev="ggregory" type="fix" due-to="Kyriacos Elia, Daniel Scott">
+            Exception for new SubnetUtils("0.0.0.0/0").
+            </action>
         </release>
         <release version="3.3" date="2013-06-??" description="
 This is mainly a bug-fix release. See further details below.
diff --git a/src/main/java/org/apache/commons/net/util/SubnetUtils.java b/src/main/java/org/apache/commons/net/util/SubnetUtils.java
index 540874b7..8e0d5806 100644
--- a/src/main/java/org/apache/commons/net/util/SubnetUtils.java
+++ b/src/main/java/org/apache/commons/net/util/SubnetUtils.java
@@ -226,9 +226,12 @@ public class SubnetUtils {
             address = matchAddress(matcher);
 
             /* Create a binary netmask from the number of bits specification /x */
-            int cidrPart = rangeCheck(Integer.parseInt(matcher.group(5)), 1, NBITS);
+            int cidrPart = rangeCheck(Integer.parseInt(matcher.group(5)), 0, NBITS);
+            if (cidrPart == 0 && address != 0) {
+                throw new IllegalArgumentException("Cannot have /0 cidr with non-zero address");
+            }
             for (int j = 0; j < cidrPart; ++j) {
-                netmask |= (1 << 31-j);
+                netmask |= (1 << 31 - j);
             }
 
             /* Calculate base network address */
diff --git a/src/test/java/org/apache/commons/net/SubnetUtilsTest.java b/src/test/java/org/apache/commons/net/SubnetUtilsTest.java
index 0e502e26..0b5fa3ee 100644
--- a/src/test/java/org/apache/commons/net/SubnetUtilsTest.java
+++ b/src/test/java/org/apache/commons/net/SubnetUtilsTest.java
@@ -298,6 +298,10 @@ public class SubnetUtilsTest extends TestCase {
          }
      }
 
+    public void testZeroAddressAndCidr() {
+        new SubnetUtils("0.0.0.0/0");
+    }
+
     public void testZeroNetmaskBits() {
         try {
             new SubnetUtils("192.168.0.1/0");
