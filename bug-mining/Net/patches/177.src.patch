diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index a347e42b..a8b33a41 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -66,6 +66,9 @@ The <action> type attribute can be add,update,fix,remove.
 This release fixes bugs and adds some new functionality (see below).
  It is binary compatible with previous releases.
         ">
+            <action issue="NET-46" dev="sebb" type="fix">
+            retrieveFileStream fails randomly or hangs
+            </action>
             <action issue="NET-485" dev="sebb" type="fix">
             Remove unnecessary Base64 methods.
             </action>
diff --git a/src/main/java/org/apache/commons/net/ftp/FTPClient.java b/src/main/java/org/apache/commons/net/ftp/FTPClient.java
index 7b983756..fd2df13b 100644
--- a/src/main/java/org/apache/commons/net/ftp/FTPClient.java
+++ b/src/main/java/org/apache/commons/net/ftp/FTPClient.java
@@ -773,6 +773,11 @@ implements Configurable
                     server.setSoTimeout(__dataTimeout);
                 }
                 socket = server.accept();
+                
+                // Ensure the timeout is set before any commands are issued on the new socket
+                if (__dataTimeout >= 0) {
+                    socket.setSoTimeout(__dataTimeout);
+                }
             } finally {
                 server.close();
             }
@@ -808,6 +813,15 @@ implements Configurable
             if (__passiveLocalHost != null) {
                 socket.bind(new InetSocketAddress(__passiveLocalHost, 0));
             }
+
+            // For now, let's just use the data timeout value for waiting for
+            // the data connection.  It may be desirable to let this be a
+            // separately configurable value.  In any case, we really want
+            // to allow preventing the accept from blocking indefinitely.
+            if (__dataTimeout >= 0) {
+                socket.setSoTimeout(__dataTimeout);
+            }
+
             socket.connect(new InetSocketAddress(__passiveHost, __passivePort), connectTimeout);
             if ((__restartOffset > 0) && !restart(__restartOffset))
             {
@@ -831,10 +845,6 @@ implements Configurable
                     " is not same as server " + getRemoteAddress().getHostAddress());
         }
 
-        if (__dataTimeout >= 0) {
-            socket.setSoTimeout(__dataTimeout);
-        }
-
         if ( __bufferSize > 0 ) {
             socket.setReceiveBufferSize(__bufferSize);
             socket.setSendBufferSize(__bufferSize);
