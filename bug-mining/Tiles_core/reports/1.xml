<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:09:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[TILES-573] Tiles.xml definitions not reloaded when using expressions</title>
                <link>https://issues.apache.org/jira/browse/TILES-573</link>
                <project id="12311046" key="TILES">Tiles</project>
                    <description>&lt;p&gt;When tiles.xml contains definitions that use expressions (ex: &quot;REGEXP: (.*)&quot;), the definitions are not reloaded when tiles.xml is changed, even if checkRefresh is enabled.&lt;/p&gt;

&lt;p&gt;tiles.xml definitions are properly reloaded when they contain plain strings, but otherwise they are ignored.&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12676981">TILES-573</key>
            <summary>Tiles.xml definitions not reloaded when using expressions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mck">Michael Semb Wever</assignee>
                                    <reporter username="benze">Eric B</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 Nov 2013 01:02:58 +0000</created>
                <updated>Fri, 4 Oct 2019 16:20:09 +0000</updated>
                            <resolved>Wed, 6 Nov 2013 16:27:37 +0000</resolved>
                                    <version>3.0.1</version>
                                    <fixVersion>3.1.x</fixVersion>
                    <fixVersion>3.0.3</fixVersion>
                                    <component>tiles-core</component>
                    <component>tiles-template</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13810928" author="benze" created="Fri, 1 Nov 2013 01:04:55 +0000"  >&lt;p&gt;Sample tiles.xml file whose definitions are not reloaded when the file is modified&lt;/p&gt;</comment>
                            <comment id="13810967" author="benze" created="Fri, 1 Nov 2013 02:11:41 +0000"  >&lt;p&gt;In org.apache.tiles.definition.pattern.AbstractPatternDefinitionResolver&amp;lt;T&amp;gt;.storeDefinitionPatterns() (line 61), localePatternPaths is never reset whenever the locale2definitionMap is cleared in org.apache.tiles.definition.dao.CachingLocaleUrlDefinitionDAO.checkAndloadDefinitions() (lin 172).&lt;/p&gt;

&lt;p&gt;Consequently, everytime tiles re-reads the tiles.xml file, it just appends any Pattern definitions to the localePatternPaths list in AbstractPatternDefinitionResolver.addDefinitionsAsPatternMatchers.&lt;/p&gt;

&lt;p&gt;This ends up with a couple of issues.&lt;br/&gt;
1) when Tiles tries to retrieve the matching pattern, it simply loops through the localePatternPaths ArrayList and returns the first match it finds.  So even if the newer definition was loaded, Tiles still returns the original pattern.&lt;br/&gt;
2) this can lead to a memory leak, since the list is never actually cleared, but constantly adds new entries.  Although this is unlikely to happen, it is still a risk.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure, however, how to clear the entry in locatePatternPaths, as it is a private variable in AbstractPatternDefinitionResolver, with no public methods accessible.  The best I could think of would be to create a method in AbstractPatternDefinitionResolver called clearDefinitions(customizationKey) or something to that effect, and call it from within CachingLocateUrlDefinitionDAO.checkAndloadDefinitions() when locale2definitionMap is cleared.&lt;/p&gt;
</comment>
                            <comment id="13811215" author="michaelsembwever" created="Fri, 1 Nov 2013 12:47:12 +0000"  >&lt;p&gt;Yes it looks like an extra AbstractPatternDefinitionResolver.clearDefinitions(..) method is warranted.&lt;/p&gt;

&lt;p&gt;Eric, are you interested in providing a patch for this? (or a github fork off &lt;a href=&quot;https://github.com/apache/tiles&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tiles&lt;/a&gt; )&lt;/p&gt;</comment>
                            <comment id="13811309" author="benze" created="Fri, 1 Nov 2013 15:01:30 +0000"  >&lt;p&gt;I can try to provide a patch in the coming days.  In the meantime, I patched Tiles 3.0.1 with an AspectJ patch (attached).  An ugly hack, but functional, on the odd chance that anyone needs it before the next Tiles release is made.&lt;/p&gt;

&lt;p&gt;AspectJ must be enabled in the pom.xml for weaving jar dependencies:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;			&amp;lt;plugin&amp;gt;
				&amp;lt;groupId&amp;gt;org.codehaus.mojo&amp;lt;/groupId&amp;gt;
				&amp;lt;artifactId&amp;gt;aspectj-maven-plugin&amp;lt;/artifactId&amp;gt;
				&amp;lt;version&amp;gt;1.2&amp;lt;/version&amp;gt;
				&amp;lt;dependencies&amp;gt;
					&amp;lt;dependency&amp;gt;
						&amp;lt;groupId&amp;gt;org.aspectj&amp;lt;/groupId&amp;gt;
						&amp;lt;artifactId&amp;gt;aspectjrt&amp;lt;/artifactId&amp;gt;
						&amp;lt;version&amp;gt;${aspectj.version}&amp;lt;/version&amp;gt;
					&amp;lt;/dependency&amp;gt;
					&amp;lt;dependency&amp;gt;
						&amp;lt;groupId&amp;gt;org.aspectj&amp;lt;/groupId&amp;gt;
						&amp;lt;artifactId&amp;gt;aspectjtools&amp;lt;/artifactId&amp;gt;
						&amp;lt;version&amp;gt;${aspectj.version}&amp;lt;/version&amp;gt;
					&amp;lt;/dependency&amp;gt;
				&amp;lt;/dependencies&amp;gt;
				&amp;lt;executions&amp;gt;
					&amp;lt;execution&amp;gt;
						&amp;lt;goals&amp;gt;
							&amp;lt;goal&amp;gt;compile&amp;lt;/goal&amp;gt;
							&amp;lt;goal&amp;gt;test-compile&amp;lt;/goal&amp;gt;
						&amp;lt;/goals&amp;gt;
					&amp;lt;/execution&amp;gt;
				&amp;lt;/executions&amp;gt;
				&amp;lt;configuration&amp;gt;
					&amp;lt;outxml&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;lt;/outxml&amp;gt;
					&amp;lt;aspectLibraries&amp;gt;
						&amp;lt;aspectLibrary&amp;gt;
							&amp;lt;groupId&amp;gt;org.springframework&amp;lt;/groupId&amp;gt;
							&amp;lt;artifactId&amp;gt;spring-aspects&amp;lt;/artifactId&amp;gt;
						&amp;lt;/aspectLibrary&amp;gt;
					&amp;lt;/aspectLibraries&amp;gt;
					&amp;lt;weaveDependencies&amp;gt;
						&amp;lt;weaveDependency&amp;gt;
							&amp;lt;groupId&amp;gt;org.apache.tiles&amp;lt;/groupId&amp;gt;
							&amp;lt;artifactId&amp;gt;tiles-core&amp;lt;/artifactId&amp;gt;
						&amp;lt;/weaveDependency&amp;gt;
					&amp;lt;/weaveDependencies&amp;gt;
					&amp;lt;source&amp;gt;${java.version}&amp;lt;/source&amp;gt;
					&amp;lt;target&amp;gt;${java.version}&amp;lt;/target&amp;gt;
				&amp;lt;/configuration&amp;gt;
			&amp;lt;/plugin&amp;gt;

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13811312" author="benze" created="Fri, 1 Nov 2013 15:03:14 +0000"  >&lt;p&gt;AspectJ patch/hack to enable proper tiles.xml reloading when containing patterns/expressions.&lt;/p&gt;</comment>
                            <comment id="13811635" author="benze" created="Fri, 1 Nov 2013 20:40:44 +0000"  >&lt;p&gt;I just created a pull request for the patch I put in.  Although I am not entirely sure how to thoroughly test it.&lt;/p&gt;</comment>
                            <comment id="13812785" author="michaelsembwever" created="Mon, 4 Nov 2013 11:59:22 +0000"  >&lt;p&gt;the pull request can be found at &lt;a href=&quot;https://github.com/apache/tiles/pull/2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tiles/pull/2&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13814821" author="michaelsembwever" created="Wed, 6 Nov 2013 11:52:10 +0000"  >&lt;p&gt;Attached patch from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benze&quot; class=&quot;user-hover&quot; rel=&quot;benze&quot;&gt;benze&lt;/a&gt; from &lt;a href=&quot;https://github.com/apache/tiles/pull/2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/tiles/pull/2&lt;/a&gt;&lt;br/&gt;
&#160;&#160;also adding a unit test.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benze&quot; class=&quot;user-hover&quot; rel=&quot;benze&quot;&gt;benze&lt;/a&gt;, does this patch look good to you? Are we ready to commit it?&lt;/p&gt;</comment>
                            <comment id="13814942" author="benze" created="Wed, 6 Nov 2013 15:02:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt; Looks good to me.  I haven&apos;t analyzed the unit test in depth, but the rest looks good.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12611616" name="ClearDefinitionsPatch.aj" size="1952" author="benze" created="Fri, 1 Nov 2013 15:03:14 +0000"/>
                            <attachment id="12612360" name="TILES-573.patch" size="8385" author="mck" created="Wed, 6 Nov 2013 11:52:10 +0000"/>
                            <attachment id="12611536" name="tiles.xml" size="1056" author="benze" created="Fri, 1 Nov 2013 01:04:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>356357</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 2 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1pfmf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>356645</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>