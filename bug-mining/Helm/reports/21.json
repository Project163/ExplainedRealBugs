{"url":"https://api.github.com/repos/helm/helm/issues/6631","repository_url":"https://api.github.com/repos/helm/helm","labels_url":"https://api.github.com/repos/helm/helm/issues/6631/labels{/name}","comments_url":"https://api.github.com/repos/helm/helm/issues/6631/comments","events_url":"https://api.github.com/repos/helm/helm/issues/6631/events","html_url":"https://github.com/helm/helm/issues/6631","id":505237038,"node_id":"MDU6SXNzdWU1MDUyMzcwMzg=","number":6631,"title":"v3: --kube-context, --kubeconfig and --namespace values are not passed to plugins","user":{"login":"mumoshu","id":22009,"node_id":"MDQ6VXNlcjIyMDA5","avatar_url":"https://avatars.githubusercontent.com/u/22009?v=4","gravatar_id":"","url":"https://api.github.com/users/mumoshu","html_url":"https://github.com/mumoshu","followers_url":"https://api.github.com/users/mumoshu/followers","following_url":"https://api.github.com/users/mumoshu/following{/other_user}","gists_url":"https://api.github.com/users/mumoshu/gists{/gist_id}","starred_url":"https://api.github.com/users/mumoshu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mumoshu/subscriptions","organizations_url":"https://api.github.com/users/mumoshu/orgs","repos_url":"https://api.github.com/users/mumoshu/repos","events_url":"https://api.github.com/users/mumoshu/events{/privacy}","received_events_url":"https://api.github.com/users/mumoshu/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":926755770,"node_id":"MDU6TGFiZWw5MjY3NTU3NzA=","url":"https://api.github.com/repos/helm/helm/labels/v3.x","name":"v3.x","color":"e82969","default":false,"description":"Issues and Pull Requests related to the major version v3"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/helm/helm/milestones/75","html_url":"https://github.com/helm/helm/milestone/75","labels_url":"https://api.github.com/repos/helm/helm/milestones/75/labels","id":4733270,"node_id":"MDk6TWlsZXN0b25lNDczMzI3MA==","number":75,"title":"3.0.0-beta.5","description":"","creator":{"login":"bacongobbler","id":1360539,"node_id":"MDQ6VXNlcjEzNjA1Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1360539?v=4","gravatar_id":"","url":"https://api.github.com/users/bacongobbler","html_url":"https://github.com/bacongobbler","followers_url":"https://api.github.com/users/bacongobbler/followers","following_url":"https://api.github.com/users/bacongobbler/following{/other_user}","gists_url":"https://api.github.com/users/bacongobbler/gists{/gist_id}","starred_url":"https://api.github.com/users/bacongobbler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bacongobbler/subscriptions","organizations_url":"https://api.github.com/users/bacongobbler/orgs","repos_url":"https://api.github.com/users/bacongobbler/repos","events_url":"https://api.github.com/users/bacongobbler/events{/privacy}","received_events_url":"https://api.github.com/users/bacongobbler/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":60,"state":"closed","created_at":"2019-10-08T17:04:48Z","updated_at":"2019-10-22T22:19:29Z","due_on":null,"closed_at":"2019-10-22T22:19:29Z"},"comments":3,"created_at":"2019-10-10T12:27:09Z","updated_at":"2019-10-11T16:05:59Z","closed_at":"2019-10-11T16:05:59Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Problem\r\n\r\nWhile upgrading [helm-diff](https://github.com/databus23/helm-diff/pull/151#issuecomment-537679821) to work with helm v3, we noticed that a few settings that formerly passed via the local proxy to Tiller now need to be passed explicitly to plugins:\r\n\r\n- --kubeconfig\r\n- --kube-context\r\n- --namespace\r\n\r\n// Additional discussion in helm/helm: https://github.com/helm/helm/pull/6508#discussion_r330893957\r\n\r\nThis is due to that some plugin like helm-diff does need to access release objects normally managed by helm.\r\n\r\nMore concretely, as of today when a plugin like helm-diff is invoked via `helmv3 --kubeconfig mykubeconfig --kube-context mycontext --namespace myns diff upgrade myrelease mychart`, the plugin needs all the three settings in order to read the release object for `myrelease`, but there's no way to access those from within the plugin.\r\n\r\n## Proposed solution\r\n\r\nI believe these 3 settings should somehow be propagated to plugins. I'd suggest using envvars as it seems like the primary way to pass contextual settings to plugins today: https://github.com/helm/helm/blob/9bc7934f350233fa72a11d2d29065aa78ab62792/pkg/plugin/plugin.go#L218-L225\r\n\r\n---\r\nOutput of `helm version`: helm 3.0.0-beta.1~4\r\nCloud Provider/Platform (AKS, GKE, Minikube etc.): Any\r\n\r\n","closed_by":{"login":"bacongobbler","id":1360539,"node_id":"MDQ6VXNlcjEzNjA1Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1360539?v=4","gravatar_id":"","url":"https://api.github.com/users/bacongobbler","html_url":"https://github.com/bacongobbler","followers_url":"https://api.github.com/users/bacongobbler/followers","following_url":"https://api.github.com/users/bacongobbler/following{/other_user}","gists_url":"https://api.github.com/users/bacongobbler/gists{/gist_id}","starred_url":"https://api.github.com/users/bacongobbler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bacongobbler/subscriptions","organizations_url":"https://api.github.com/users/bacongobbler/orgs","repos_url":"https://api.github.com/users/bacongobbler/repos","events_url":"https://api.github.com/users/bacongobbler/events{/privacy}","received_events_url":"https://api.github.com/users/bacongobbler/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/helm/helm/issues/6631/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/helm/helm/issues/6631/timeline","performed_via_github_app":null,"state_reason":"completed"}