{"url":"https://api.github.com/repos/helm/helm/issues/10566","repository_url":"https://api.github.com/repos/helm/helm","labels_url":"https://api.github.com/repos/helm/helm/issues/10566/labels{/name}","comments_url":"https://api.github.com/repos/helm/helm/issues/10566/comments","events_url":"https://api.github.com/repos/helm/helm/issues/10566/events","html_url":"https://github.com/helm/helm/issues/10566","id":1105629697,"node_id":"I_kwDOApspmc5B5pIB","number":10566,"title":"helm test command fails  if --filter excludes all test hooks and --logs flag is used","user":{"login":"Noksa","id":36312857,"node_id":"MDQ6VXNlcjM2MzEyODU3","avatar_url":"https://avatars.githubusercontent.com/u/36312857?v=4","gravatar_id":"","url":"https://api.github.com/users/Noksa","html_url":"https://github.com/Noksa","followers_url":"https://api.github.com/users/Noksa/followers","following_url":"https://api.github.com/users/Noksa/following{/other_user}","gists_url":"https://api.github.com/users/Noksa/gists{/gist_id}","starred_url":"https://api.github.com/users/Noksa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Noksa/subscriptions","organizations_url":"https://api.github.com/users/Noksa/orgs","repos_url":"https://api.github.com/users/Noksa/repos","events_url":"https://api.github.com/users/Noksa/events{/privacy}","received_events_url":"https://api.github.com/users/Noksa/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":562692416,"node_id":"MDU6TGFiZWw1NjI2OTI0MTY=","url":"https://api.github.com/repos/helm/helm/labels/in%20progress","name":"in progress","color":"11DD11","default":false,"description":null},{"id":778135666,"node_id":"MDU6TGFiZWw3NzgxMzU2NjY=","url":"https://api.github.com/repos/helm/helm/labels/bug","name":"bug","color":"e11d21","default":true,"description":"Categorizes issue or PR as related to a bug."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2022-01-17T09:52:36Z","updated_at":"2023-08-11T14:47:59Z","closed_at":"2023-08-11T14:47:59Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!-- If you need help or think you have found a bug, please help us with your issue by entering the following information (otherwise you can delete this text): -->\r\n\r\nOutput of `helm version`:\r\n```\r\nversion.BuildInfo{Version:\"v3.7.2\", GitCommit:\"663a896f4a815053445eec4153677ddc24a0a361\", GitTreeState:\"clean\", GoVersion:\"go1.17.3\"}\r\n```\r\nOutput of `kubectl version`:\r\n```\r\n➜  ~ k version\r\nClient Version: version.Info{Major:\"1\", Minor:\"23\", GitVersion:\"v1.23.1\", GitCommit:\"86ec240af8cbd1b60bcc4c03c20da9b98005b92e\", GitTreeState:\"clean\", BuildDate:\"2021-12-16T11:33:37Z\", GoVersion:\"go1.17.5\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"17\", GitVersion:\"v1.17.0\", GitCommit:\"70132b0f130acc0bed193d9ba59dd186f0e634cf\", GitTreeState:\"clean\", BuildDate:\"2019-12-07T21:12:17Z\", GoVersion:\"go1.13.4\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n```\r\nCloud Provider/Platform (AKS, GKE, Minikube etc.): any\r\n\r\n\r\ni have only one hook in a release and I tried to exclude it when `--logs` flag is used.\r\nAs result helm command returns with non-zero code and it causes a pipeline to fail.\r\nLogs:\r\n```\r\n➜  ~ helm test frame-poc -n frame --logs --timeout 10m --filter=\"\\!name=frame-poc-test\"\r\nNAME: frame-poc\r\nLAST DEPLOYED: Mon Jan 17 09:46:35 2022\r\nNAMESPACE: frame\r\nSTATUS: deployed\r\nREVISION: 5\r\n\r\nError: unable to get pod logs for frame-poc-test: pods \"frame-poc-test\" not found\r\n```\r\n\r\nImportant thing here is a pod shouldn't exist before running the command.\r\nMy helm test hook is `Pod` kind.\r\n\r\n","closed_by":{"login":"joejulian","id":952828,"node_id":"MDQ6VXNlcjk1MjgyOA==","avatar_url":"https://avatars.githubusercontent.com/u/952828?v=4","gravatar_id":"","url":"https://api.github.com/users/joejulian","html_url":"https://github.com/joejulian","followers_url":"https://api.github.com/users/joejulian/followers","following_url":"https://api.github.com/users/joejulian/following{/other_user}","gists_url":"https://api.github.com/users/joejulian/gists{/gist_id}","starred_url":"https://api.github.com/users/joejulian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joejulian/subscriptions","organizations_url":"https://api.github.com/users/joejulian/orgs","repos_url":"https://api.github.com/users/joejulian/repos","events_url":"https://api.github.com/users/joejulian/events{/privacy}","received_events_url":"https://api.github.com/users/joejulian/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/helm/helm/issues/10566/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/helm/helm/issues/10566/timeline","performed_via_github_app":null,"state_reason":"completed"}