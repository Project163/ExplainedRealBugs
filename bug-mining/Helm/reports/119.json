{"url":"https://api.github.com/repos/helm/helm/issues/12460","repository_url":"https://api.github.com/repos/helm/helm","labels_url":"https://api.github.com/repos/helm/helm/issues/12460/labels{/name}","comments_url":"https://api.github.com/repos/helm/helm/issues/12460/comments","events_url":"https://api.github.com/repos/helm/helm/issues/12460/events","html_url":"https://github.com/helm/helm/issues/12460","id":1929056687,"node_id":"I_kwDOApspmc5y-xGv","number":12460,"title":"Helm 3.13 is not backward compatible with 3.12","user":{"login":"zevisert","id":11222441,"node_id":"MDQ6VXNlcjExMjIyNDQx","avatar_url":"https://avatars.githubusercontent.com/u/11222441?v=4","gravatar_id":"","url":"https://api.github.com/users/zevisert","html_url":"https://github.com/zevisert","followers_url":"https://api.github.com/users/zevisert/followers","following_url":"https://api.github.com/users/zevisert/following{/other_user}","gists_url":"https://api.github.com/users/zevisert/gists{/gist_id}","starred_url":"https://api.github.com/users/zevisert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zevisert/subscriptions","organizations_url":"https://api.github.com/users/zevisert/orgs","repos_url":"https://api.github.com/users/zevisert/repos","events_url":"https://api.github.com/users/zevisert/events{/privacy}","received_events_url":"https://api.github.com/users/zevisert/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":778135666,"node_id":"MDU6TGFiZWw3NzgxMzU2NjY=","url":"https://api.github.com/repos/helm/helm/labels/bug","name":"bug","color":"e11d21","default":true,"description":"Categorizes issue or PR as related to a bug."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2023-10-05T21:06:25Z","updated_at":"2024-02-03T21:31:05Z","closed_at":"2023-10-12T13:10:25Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!-- If you need help or think you have found a bug, please help us with your issue by entering the following information (otherwise you can delete this text): -->\r\n\r\nOutput of `helm version`: \r\n```\r\nversion.BuildInfo{Version:\"v3.13.0\", GitCommit:\"825e86f6a7a38cef1112bfa606e4127a706749b1\", GitTreeState:\"clean\", GoVersion:\"go1.20.8\"}\r\n```\r\n\r\nOutput of `kubectl version`: \r\n```\r\nClient Version: v1.28.2\r\nKustomize Version: v5.0.4-0.20230601165947-6ce0bf390ce3\r\nServer Version: v1.27.3-gke.100\r\n```\r\n\r\nCloud Provider/Platform (AKS, GKE, Minikube etc.): `Not applicable`\r\n\r\n---\r\n\r\nI have found in a few projects that helm 3.13 is not rendering the same output as 3.12. I've set up a simple minimal reproducible example at https://github.com/zevisert/helm-3-13-rendering-mre\r\n\r\nEither way, here's some console output showing what I'm running into: \r\n\r\n\r\n```console\r\n$ helm version\r\nversion.BuildInfo{Version:\"v3.12.3\", GitCommit:\"3a31588ad33fe3b89af5a2a54ee1d25bfe6eaa5e\", GitTreeState:\"clean\", GoVersion:\"go1.20.7\"}\r\n\r\n$ helm create example\r\nCreating example\r\n\r\n$ rm -r example/charts/ example/templates/*\r\n\r\n$ echo '{{ include \"helmet.app\" . }}' > example/templates/app.yaml\r\n\r\n$ yq e '. += ({\"dependencies\": [{\"name\": \"helmet\", \"version\": \"~0.9.1\", \"repository\": \"https://companyinfo.github.io/helm-charts\", \"import-values\": [\"defaults\"]}]})' < example/Chart.yaml | sponge example/Chart.yaml\r\n\r\n$ helm dependency build example\r\nHang tight while we grab the latest from your chart repositories...\r\n...Successfully got an update from the \"helmet\" chart repository\r\nUpdate Complete. ⎈Happy Helming!⎈\r\nSaving 1 charts\r\nDownloading helmet from repo https://companyinfo.github.io/helm-charts\r\nDeleting outdated charts\r\n\r\n$ helm template example > templated-3.12.yaml\r\n\r\n$ curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3\r\n$ chmod 700 get_helm.sh\r\n$ ./get_helm.sh\r\nHelm v3.13.0 is available. Changing from version v3.12.3.\r\nDownloading https://get.helm.sh/helm-v3.13.0-linux-amd64.tar.gz\r\nVerifying checksum... Done.\r\nPreparing to install helm into /opt/tooling/helm/bin\r\nhelm installed into /opt/tooling/helm/bin/helm\r\n\r\n$ helm version\r\nversion.BuildInfo{Version:\"v3.13.0\", GitCommit:\"825e86f6a7a38cef1112bfa606e4127a706749b1\", GitTreeState:\"clean\", GoVersion:\"go1.20.8\"}\r\n\r\n$ helm dependency build example\r\nHang tight while we grab the latest from your chart repositories...\r\n...Successfully got an update from the \"helmet\" chart repository\r\nUpdate Complete. ⎈Happy Helming!⎈\r\nSaving 1 charts\r\nDownloading helmet from repo https://companyinfo.github.io/helm-charts\r\nDeleting outdated charts\r\n\r\n$ helm template example > templated-3.13.yaml\r\n```\r\n\r\nHere is the side-by-side diff between the two outputs (templated-3.12.yaml vs templated 3.13.yaml)\r\n\r\n```\r\n---                                                             ---\r\n# Source: example/templates/app.yaml                            # Source: example/templates/app.yaml\r\napiVersion: v1                                                  apiVersion: v1\r\nkind: Service                                                   kind: Service\r\nmetadata:                                                       metadata:\r\n  name: release-name-example                                      name: release-name-example\r\n  namespace: \"default\"                                            namespace: \"default\"\r\n  labels:                                                         labels:\r\n    app.kubernetes.io/name: example                                 app.kubernetes.io/name: example\r\n    helm.sh/chart: example-0.1.0                                    helm.sh/chart: example-0.1.0\r\n    app.kubernetes.io/instance: release-name                        app.kubernetes.io/instance: release-name\r\n    app.kubernetes.io/managed-by: Helm                              app.kubernetes.io/managed-by: Helm\r\nspec:                                                           spec:\r\n  type: ClusterIP                                                 type: ClusterIP\r\n  sessionAffinity: None                                           sessionAffinity: None\r\n  ports:                                                          ports:\r\n    - name: http                                                    - name: http\r\n      port: 80                                                        port: 80\r\n      protocol: TCP                                                   protocol: TCP\r\n      targetPort: http                                                targetPort: http\r\n  selector:                                                       selector:\r\n    app.kubernetes.io/name: example                                 app.kubernetes.io/name: example\r\n    app.kubernetes.io/instance: release-name                        app.kubernetes.io/instance: release-name\r\n---                                                           <\r\n# Source: example/templates/app.yaml                          <\r\napiVersion: apps/v1                                           <\r\nkind: Deployment                                              <\r\nmetadata:                                                     <\r\n  name: release-name-example                                  <\r\n  namespace: \"default\"                                        <\r\n  labels:                                                     <\r\n    app.kubernetes.io/name: example                           <\r\n    helm.sh/chart: example-0.1.0                              <\r\n    app.kubernetes.io/instance: release-name                  <\r\n    app.kubernetes.io/managed-by: Helm                        <\r\nspec:                                                         <\r\n  replicas: 1                                                 <\r\n  revisionHistoryLimit: 10                                    <\r\n  selector:                                                   <\r\n    matchLabels:                                              <\r\n      app.kubernetes.io/name: example                         <\r\n      app.kubernetes.io/instance: release-name                <\r\n  strategy:                                                   <\r\n    type: RollingUpdate                                       <\r\n  template:                                                   <\r\n    metadata:                                                 <\r\n      annotations:                                            <\r\n        helm.sh/revision: \"1\"                                 <\r\n      labels:                                                 <\r\n        app.kubernetes.io/name: example                       <\r\n        helm.sh/chart: example-0.1.0                          <\r\n        app.kubernetes.io/instance: release-name              <\r\n        app.kubernetes.io/managed-by: Helm                    <\r\n    spec:                                                     <\r\n      restartPolicy: Always                                   <\r\n      containers:                                             <\r\n        - name: example                                       <\r\n          image: docker.io/hello-world:latest                 <\r\n          imagePullPolicy: Always                             <\r\n          ports:                                              <\r\n            - containerPort: 8080                             <\r\n              name: http                                      <\r\n              protocol: TCP                                   <\r\n          resources:                                          <\r\n            limits: {}                                        <\r\n            requests: {}                                      <\r\n      affinity:                                               <\r\n        podAntiAffinity:                                      <\r\n          preferredDuringSchedulingIgnoredDuringExecution:    <\r\n            - podAffinityTerm:                                <\r\n                labelSelector:                                <\r\n                  matchLabels:                                <\r\n                    app.kubernetes.io/name: example           <\r\n                    app.kubernetes.io/instance: release-name  <\r\n                topologyKey: kubernetes.io/hostname           <\r\n              weight: 1                                       <\r\n      serviceAccountName: default                             <\r\n```\r\n\r\n\r\n\r\n\r\n","closed_by":{"login":"mattfarina","id":62991,"node_id":"MDQ6VXNlcjYyOTkx","avatar_url":"https://avatars.githubusercontent.com/u/62991?v=4","gravatar_id":"","url":"https://api.github.com/users/mattfarina","html_url":"https://github.com/mattfarina","followers_url":"https://api.github.com/users/mattfarina/followers","following_url":"https://api.github.com/users/mattfarina/following{/other_user}","gists_url":"https://api.github.com/users/mattfarina/gists{/gist_id}","starred_url":"https://api.github.com/users/mattfarina/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mattfarina/subscriptions","organizations_url":"https://api.github.com/users/mattfarina/orgs","repos_url":"https://api.github.com/users/mattfarina/repos","events_url":"https://api.github.com/users/mattfarina/events{/privacy}","received_events_url":"https://api.github.com/users/mattfarina/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/helm/helm/issues/12460/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/helm/helm/issues/12460/timeline","performed_via_github_app":null,"state_reason":"completed"}