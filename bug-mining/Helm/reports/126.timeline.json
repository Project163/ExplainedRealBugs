[{"url":"https://api.github.com/repos/helm/helm/issues/comments/842514124","html_url":"https://github.com/helm/helm/issues/9710#issuecomment-842514124","issue_url":"https://api.github.com/repos/helm/helm/issues/9710","id":842514124,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjUxNDEyNA==","user":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T17:47:12Z","updated_at":"2021-05-17T17:47:29Z","body":"Last lines of my debug output:\r\n~~~\r\n[akaris@linux 02925442]$ tail -n 10 test_gitlab_log_fail_with_debug.txt\r\nclient.go:148: [debug] ==> ERROR JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nError: Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\nhelm.go:81: [debug] Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\n+ '[' 1 == 0 ']'\r\n+ RED='\\033[0;31m'\r\n+ NC='\\033[0m'\r\n+ printf '\\033[0;31mFAIL\\033[0m\\n'\r\nFAIL\r\n+ exit 1\r\n\r\n~~~","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/helm/helm/issues/comments/842514124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/helm/helm/issues/comments/842515343","html_url":"https://github.com/helm/helm/issues/9710#issuecomment-842515343","issue_url":"https://api.github.com/repos/helm/helm/issues/9710","id":842515343,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjUxNTM0Mw==","user":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T17:49:10Z","updated_at":"2021-05-17T17:49:10Z","body":"Here's a workaround (including my ugly debug stuff - I'll see if I can find time tomorrow to submit  a fix with that:\r\n~~~\r\n[akaris@linux helm]$ git diff\r\ndiff --git a/pkg/kube/client.go b/pkg/kube/client.go\r\nindex 34079e7a..70c5dee5 100644\r\n--- a/pkg/kube/client.go\r\n+++ b/pkg/kube/client.go\r\n@@ -21,6 +21,8 @@ import (\r\n        \"encoding/json\"\r\n        \"fmt\"\r\n        \"io\"\r\n+       \"math/rand\"\r\n+       \"strconv\"\r\n        \"strings\"\r\n        \"sync\"\r\n        \"time\"\r\n@@ -120,7 +122,40 @@ func (c *Client) IsReachable() error {\r\n // Create creates Kubernetes resources specified in the resource list.\r\n func (c *Client) Create(resources ResourceList) (*Result, error) {\r\n        c.Log(\"creating %d resource(s)\", len(resources))\r\n-       if err := perform(resources, createResource); err != nil {\r\n+\r\n+       createResourceLogger := func(info *resource.Info) error {\r\n+               c.Log(\"Creating resource: {\" +\r\n+                       \"Time UnixNano: \" + fmt.Sprintf(\"%v\", time.Now().UnixNano()) + \", \" +\r\n+                       \"Name: \" + info.Name + \", \" +\r\n+                       \"Namespace: \" + info.Namespace + \", \" +\r\n+                       \"Source: \" + info.Source + \", \" +\r\n+                       \"ResourceVersion: \" + info.ResourceVersion +\r\n+                       \"}\")\r\n+               j, err := json.Marshal(info.Object)\r\n+               if err == nil {\r\n+                       c.Log(\"==> Object: \" + string(j))\r\n+               } else {\r\n+                       c.Log(\"Could not marshal Name \" + info.Name + \" Namespace \" + info.Namespace)\r\n+               }\r\n+               returnErr := createResource(info)\r\n+               if returnErr != nil {\r\n+                       c.Log(\r\n+                               \"FAILED Time UnixNano: \" + fmt.Sprintf(\"%v\", time.Now().UnixNano()) +\r\n+                                       \" Name: \" + info.Name +\r\n+                                       \", Namespace: \" + info.Namespace +\r\n+                                       \", ERROR: \" + returnErr.Error(),\r\n+                       )\r\n+                       errJson, errErr := json.Marshal(returnErr)\r\n+                       if errErr == nil {\r\n+                               c.Log(\"==> ERROR JSON: \" + string(errJson))\r\n+                       } else {\r\n+                               c.Log(\"Could not marshal ERROR\")\r\n+                       }\r\n+               }\r\n+               return returnErr\r\n+       }\r\n+\r\n+       if err := perform(resources, createResourceLogger); err != nil {\r\n                return nil, err\r\n        }\r\n        return &Result{Created: resources}, nil\r\n@@ -367,9 +402,32 @@ func batchPerform(infos ResourceList, fn func(*resource.Info) error, errs chan<-\r\n                        kind = currentKind\r\n                }\r\n                wg.Add(1)\r\n-               go func(i *resource.Info) {\r\n-                       errs <- fn(i)\r\n-                       wg.Done()\r\n+               go func(info *resource.Info) {\r\n+                       // hardcode 3 retries\r\n+                       retries := 3\r\n+                       for counter := 0; counter < retries; counter++ {\r\n+                               // execute function\r\n+                               fnErr := fn(info)\r\n+                               // is this a StatusError?\r\n+                               if e, ok := fnErr.(*apierrors.StatusError); ok {\r\n+                                       // Is this a Conflict (409)? Back off for an increasing amount of time\r\n+                                       if apierrors.IsConflict(e) {\r\n+                                               // is this a conflict and the conflict reason is a resourcequota?\r\n+                                               status := e.Status()\r\n+                                               fmt.Println(\"status.Details.Kind: \" + status.Details.Kind)\r\n+                                               fmt.Println(\"kind: \" + kind)\r\n+                                               if status.Details.Kind == \"resourcequotas\" && kind != \"resourcequotas\" {\r\n+                                                       fmt.Println(\"ISSUE HIT! CONTINUING: \" + strconv.Itoa(counter))\r\n+                                                       time.Sleep(time.Duration(rand.Intn((counter+1)*10)) * 100 * time.Microsecond)\r\n+                                                       continue\r\n+                                               }\r\n+                                       }\r\n+                               }\r\n+                               // if this is not a 409, fall through to here and break out of the loop\r\n+                               errs <- fnErr\r\n+                               wg.Done()\r\n+                               return\r\n+                       }\r\n                }(info)\r\n        }\r\n }\r\n~~~","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/helm/helm/issues/comments/842515343/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4757576963,"node_id":"MDEyOkxhYmVsZWRFdmVudDQ3NTc1NzY5NjM=","url":"https://api.github.com/repos/helm/helm/issues/events/4757576963","actor":{"login":"bacongobbler","id":1360539,"node_id":"MDQ6VXNlcjEzNjA1Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1360539?v=4","gravatar_id":"","url":"https://api.github.com/users/bacongobbler","html_url":"https://github.com/bacongobbler","followers_url":"https://api.github.com/users/bacongobbler/followers","following_url":"https://api.github.com/users/bacongobbler/following{/other_user}","gists_url":"https://api.github.com/users/bacongobbler/gists{/gist_id}","starred_url":"https://api.github.com/users/bacongobbler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bacongobbler/subscriptions","organizations_url":"https://api.github.com/users/bacongobbler/orgs","repos_url":"https://api.github.com/users/bacongobbler/repos","events_url":"https://api.github.com/users/bacongobbler/events{/privacy}","received_events_url":"https://api.github.com/users/bacongobbler/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2021-05-18T00:38:50Z","label":{"name":"bug","color":"e11d21"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/helm/helm/issues/comments/842974567","html_url":"https://github.com/helm/helm/issues/9710#issuecomment-842974567","issue_url":"https://api.github.com/repos/helm/helm/issues/9710","id":842974567,"node_id":"MDEyOklzc3VlQ29tbWVudDg0Mjk3NDU2Nw==","user":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T08:37:17Z","updated_at":"2021-05-18T08:37:17Z","body":"Here's relevant output from a run with the above workaround and debug output. Without the retry, helm would have failed:\r\n~~~\r\n$ cat  test_gitlab.log | grep 'ISSUE HIT' -B10\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"config.toml.erb\":\"# The directory where Gitaly's executables are stored\\nbin_dir = \\\"/usr/local/bin\\\"\\n\\n# listen on a TCP socket. This is insecure (no authentication)\\nlisten_addr = \\\"0.0.0.0:8075\\\"\\n\\n# Directory where internal sockets reside\\ninternal_socket_dir = \\\"/home/git\\\"\\n\\n# If metrics collection is enabled, inform gitaly about that\\nprometheus_listen_addr = \\\"localhost:9236\\\"\\n\\n\\u003c%!@(MISSING)storages = [  \\\"default\\\",  ] %!\\(MISSING)u003e\\n\\n\\u003c%!@(MISSING)index=`echo ${HOSTNAME##*-}`.to_i %!\\(MISSING)u003e\\n\\u003c%!i(MISSING)f @storages.length \\u003e @index %!\\(MISSING)u003e\\n[[storage]]\\nname = \\\"\\u003c%!=(MISSING) @storages[@index] %!\\(MISSING)u003e\\\"\\npath = \\\"/home/git/repositories\\\"\\n\\u003c%!e(MISSING)lse %!\\(MISSING)u003e\\n\\u003c%!r(MISSING)aise Exception, \\\"Storage for node #{@index} is not present in the storageNames array. Did you use kubectl to scale up? You need to solely use helm for this purpose.\\\" %!\\(MISSING)u003e\\n\\u003c%!e(MISSING)nd %!\\(MISSING)u003e\\n\\n[logging]\\nformat = \\\"json\\\"\\ndir = \\\"/var/log/gitaly\\\"\\n\\n[auth]\\ntoken = \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab-secrets/gitaly/gitaly_token').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n\\n[git]\\n\\n[gitaly-ruby]\\n# The directory where gitaly-ruby is installed\\ndir = \\\"/srv/gitaly-ruby\\\"\\nrugged_git_config_search_path = \\\"/usr/local/etc\\\"\\n\\n[gitlab-shell]\\n# The directory where gitlab-shell is installed\\ndir = \\\"/srv/gitlab-shell\\\"\\n\\n[gitlab]\\n# location of shared secret for GitLab Shell / API interaction\\nsecret_file = \\\"/etc/gitlab-secrets/shell/.gitlab_shell_secret\\\"\\n# URL of API\\nurl = \\\"http://gitlab-webservice-default.gitlab.svc:8181/\\\"\\n\\n[gitlab.http-settings]\\n# read_timeout = 300\\n# user = someone\\n# password = somepass\\n# ca_file = /etc/ssl/cert.pem\\n# ca_path = /etc/pki/tls/certs\\nself_signed_cert = false\\n\\n[hooks]\\n# directory containing custom hooks\\ncustom_hooks_dir = \\\"/home/git/custom_hooks\\\"\\n\",\"configure\":\"set -e\\nmkdir -p /init-secrets/gitaly /init-secrets/shell\\ncp -v -r -L /init-config/.gitlab_shell_secret  /init-secrets/shell/.gitlab_shell_secret\\ncp -v -r -L /init-config/gitaly_token  /init-secrets/gitaly/gitaly_token\\n\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"gitaly\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"gitaly-4.11.4\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-gitaly\",\"namespace\":\"gitlab\"}}\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"enable_extensions.sh\":\"[[ -n \\\"${POSTGRES_POSTGRES_PASSWORD_FILE:-}\\\" ]] \\u0026\\u0026 POSTGRES_POSTGRES_PASSWORD=$(cat ${POSTGRES_POSTGRES_PASSWORD_FILE})\\nPGPASSWORD=${POSTGRES_POSTGRES_PASSWORD} psql -d gitlabhq_production -U postgres -c 'CREATE EXTENSION IF NOT EXISTS pg_trgm; CREATE EXTENSION IF NOT EXISTS btree_gist;'\\n\",\"init_revision.sh\":\"if [[ ! -f \\\"$POSTGRESQL_VOLUME_DIR/.gitlab_1_scripts_initialized\\\" ]] ; then\\n  rm -f \\\"$POSTGRESQL_VOLUME_DIR/.user_scripts_initialized\\\"\\n  touch \\\"$POSTGRESQL_VOLUME_DIR/.gitlab_1_scripts_initialized\\\"\\nfi\\n\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"gitlab\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"gitlab-4.11.4\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-postgresql-init-db\",\"namespace\":\"gitlab\"}}\r\nclient.go:127: [debug] Creating resource: {Time UnixNano: 1621278426292761716, Name: gitlab-nginx-ingress-custom-add-headers, Namespace: gitlab, Source: , ResourceVersion: }\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"Referrer-Policy\":\"strict-origin-when-cross-origin\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"nginx-ingress\",\"app.kubernetes.io/component\":\"controller\",\"app.kubernetes.io/managed-by\":\"Helm\",\"app.kubernetes.io/version\":\"0.41.2\",\"chart\":\"nginx-ingress-3.11.1\",\"component\":\"controller\",\"helm.sh/chart\":\"nginx-ingress-3.11.1\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-nginx-ingress-custom-add-headers\",\"namespace\":\"gitlab\"}}\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"config.json\":\"{\\n  \\\"version\\\": \\\"20\\\",\\n  \\\"credential\\\": {\\n    \\\"accessKey\\\": \\\"ACCESS_KEY\\\",\\n    \\\"secretKey\\\": \\\"SECRET_KEY\\\"\\n  },\\n  \\\"region\\\": \\\"us-east-1\\\",\\n  \\\"browser\\\": \\\"on\\\",\\n  \\\"domain\\\": \\\"\\\",\\n  \\\"logger\\\": {\\n    \\\"console\\\": {\\n      \\\"enable\\\": true\\n    },\\n    \\\"file\\\": {\\n      \\\"enable\\\": false,\\n      \\\"fileName\\\": \\\"\\\"\\n    }\\n  },\\n  \\\"notify\\\": {\\n    \\\"amqp\\\": {\\n      \\\"1\\\": {\\n        \\\"enable\\\": false,\\n        \\\"url\\\": \\\"\\\",\\n        \\\"exchange\\\": \\\"\\\",\\n        \\\"routingKey\\\": \\\"\\\",\\n        \\\"exchangeType\\\": \\\"\\\",\\n        \\\"deliveryMode\\\": 0,\\n        \\\"mandatory\\\": false,\\n        \\\"immediate\\\": false,\\n        \\\"durable\\\": false,\\n        \\\"internal\\\": false,\\n        \\\"noWait\\\": false,\\n        \\\"autoDeleted\\\": false\\n      }\\n    },\\n    \\\"nats\\\": {\\n      \\\"1\\\": {\\n        \\\"enable\\\": false,\\n        \\\"address\\\": \\\"\\\",\\n        \\\"subject\\\": \\\"\\\",\\n        \\\"username\\\": \\\"\\\",\\n        \\\"password\\\": \\\"\\\",\\n        \\\"token\\\": \\\"\\\",\\n        \\\"secure\\\": false,\\n        \\\"pingInterval\\\": 0,\\n        \\\"streaming\\\": {\\n          \\\"enable\\\": false,\\n          \\\"clusterID\\\": \\\"\\\",\\n          \\\"clientID\\\": \\\"\\\",\\n          \\\"async\\\": false,\\n          \\\"maxPubAcksInflight\\\": 0\\n        }\\n      }\\n    },\\n    \\\"elasticsearch\\\": {\\n      \\\"1\\\": {\\n        \\\"enable\\\": false,\\n        \\\"format\\\": \\\"namespace\\\",\\n        \\\"url\\\": \\\"\\\",\\n        \\\"index\\\": \\\"\\\"\\n      }\\n    },\\n    \\\"redis\\\": {\\n      \\\"1\\\": {\\n        \\\"enable\\\": false,\\n        \\\"format\\\": \\\"namespace\\\",\\n        \\\"address\\\": \\\"\\\",\\n        \\\"password\\\": \\\"\\\",\\n        \\\"key\\\": \\\"\\\"\\n      }\\n    },\\n    \\\"postgresql\\\": {\\n      \\\"1\\\": {\\n        \\\"enable\\\": false,\\n        \\\"format\\\": \\\"namespace\\\",\\n        \\\"connectionString\\\": \\\"\\\",\\n        \\\"table\\\": \\\"\\\",\\n        \\\"host\\\": \\\"\\\",\\n        \\\"port\\\": \\\"\\\",\\n        \\\"user\\\": \\\"\\\",\\n        \\\"password\\\": \\\"\\\",\\n        \\\"database\\\": \\\"\\\"\\n      }\\n    },\\n    \\\"kafka\\\": {\\n      \\\"1\\\": {\\n        \\\"enable\\\": false,\\n        \\\"brokers\\\": null,\\n        \\\"topic\\\": \\\"\\\"\\n      }\\n    },\\n    \\\"webhook\\\": {\\n      \\\"1\\\": {\\n        \\\"enable\\\": false,\\n        \\\"endpoint\\\": \\\"\\\"\\n      }\\n    },\\n    \\\"mysql\\\": {\\n      \\\"1\\\": {\\n        \\\"enable\\\": false,\\n        \\\"format\\\": \\\"namespace\\\",\\n        \\\"dsnString\\\": \\\"\\\",\\n        \\\"table\\\": \\\"\\\",\\n        \\\"host\\\": \\\"\\\",\\n        \\\"port\\\": \\\"\\\",\\n        \\\"user\\\": \\\"\\\",\\n        \\\"password\\\": \\\"\\\",\\n        \\\"database\\\": \\\"\\\"\\n      }\\n    },\\n    \\\"mqtt\\\": {\\n      \\\"1\\\": {\\n        \\\"enable\\\": false,\\n        \\\"broker\\\": \\\"\\\",\\n        \\\"topic\\\": \\\"\\\",\\n        \\\"qos\\\": 0,\\n        \\\"clientId\\\": \\\"\\\",\\n        \\\"username\\\": \\\"\\\",\\n        \\\"password\\\": \\\"\\\"\\n      }\\n    }\\n  }\\n}\",\"configure\":\"sed -e 's@ACCESS_KEY@'\\\"$(cat /config/accesskey)\\\"'@' -e 's@SECRET_KEY@'\\\"$(cat /config/secretkey)\\\"'@' /config/config.json \\u003e /minio/config.json\",\"initialize\":\"#!/bin/sh\\n# minio/mc container has Busybox Ash, be sure to be POSIX compliant and avoid Bash-isms\\nset -e ; # Have script exit in the event of a failed command.\\n\\n# connectToMinio\\n# Use a check-sleep-check loop to wait for Minio service to be available\\nconnectToMinio() {\\n  set -e ; # fail if we can't read the keys.\\n  ACCESS=$(cat /config/accesskey) ; SECRET=$(cat /config/secretkey) ;\\n  set +e ; # The connections to minio are allowed to fail.\\n  echo \\\"Connecting to Minio server: http://$MINIO_ENDPOINT:$MINIO_PORT\\\" ;\\n  MC_COMMAND=\\\"mc config host add myminio http://$MINIO_ENDPOINT:$MINIO_PORT $ACCESS $SECRET\\\" ;\\n  $MC_COMMAND ;\\n  STATUS=$? ;\\n  until [ $STATUS -eq 0 ] ;\\n  do\\n    sleep 1 ; # 1 second intervals between attempts\\n    $MC_COMMAND ;\\n    STATUS=$? ;\\n  done ;\\n  set -e ; # reset `e` as active\\n  return 0\\n}\\n\\n# checkBucketExists ($bucket)\\n# Check if the bucket exists, by using the exit code of `mc ls`\\ncheckBucketExists() {\\n  BUCKET=$1\\n  CMD=$(/usr/bin/mc ls myminio/$BUCKET \\u003e /dev/null 2\\u003e\\u00261)\\n  return $?\\n}\\n\\n# createBucket ($bucket, $policy, $purge)\\n# Ensure bucket exists, purging if asked to\\ncreateBucket() {\\n  BUCKET=$1\\n  POLICY=$2\\n  PURGE=$3\\n\\n\\n  # Purge the bucket, if set \\u0026 exists\\n  # Since PURGE is user input, check explicitly for `true`\\n  if [ $PURGE = true ]; then\\n    if checkBucketExists $BUCKET ; then\\n      echo \\\"Purging bucket '$BUCKET'.\\\"\\n      set +e ; # don't exit if this fails\\n      /usr/bin/mc rm -r --force myminio/$BUCKET\\n      set -e ; # reset `e` as active\\n    else\\n      echo \\\"Bucket '$BUCKET' does not exist, skipping purge.\\\"\\n    fi\\n  fi\\n\\n  # Create the bucket if it does not exist\\n  if ! checkBucketExists $BUCKET ; then\\n    echo \\\"Creating bucket '$BUCKET'\\\"\\n    /usr/bin/mc mb myminio/$BUCKET\\n  else\\n    echo \\\"Bucket '$BUCKET' already exists.\\\"\\n  fi\\n\\n  # At this point, the bucket should exist, skip checking for existance\\n  # Set policy on the bucket\\n  echo \\\"Setting policy of bucket '$BUCKET' to '$POLICY'.\\\"\\n  /usr/bin/mc policy $POLICY myminio/$BUCKET\\n}\\n\\nconnectToMinio\\ncreateBucket registry none false\\ncreateBucket git-lfs none false\\ncreateBucket runner-cache none false\\ncreateBucket gitlab-uploads none false\\ncreateBucket gitlab-artifacts none false\\ncreateBucket gitlab-backups none false\\ncreateBucket gitlab-packages none false\\ncreateBucket tmp none false\\ncreateBucket gitlab-pseudo none false\\ncreateBucket gitlab-mr-diffs none false\\ncreateBucket gitlab-terraform-state none false\\ncreateBucket gitlab-dependency-proxy none false\\ncreateBucket gitlab-pages none false\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"minio\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"minio-0.4.3\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-minio-config-cm\",\"namespace\":\"gitlab\"}}\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"cable.yml.erb\":\"production:\\n  url: redis://:\\u003c%!=(MISSING) ERB::Util::url_encode(File.read(\\\"/etc/gitlab/redis/redis-password\\\").strip) %!\\(MISSING)u003e@gitlab-redis-master.gitlab.svc:6379\\n  \\n  id:\\n  adapter: redis\\n\",\"configure\":\"set -e\\nconfig_dir=\\\"/init-config\\\"\\nsecret_dir=\\\"/init-secrets\\\"\\n\\nfor secret in gitaly registry rails-secrets ; do\\n  mkdir -p \\\"${secret_dir}/${secret}\\\"\\n  cp -v -r -L \\\"${config_dir}/${secret}/.\\\" \\\"${secret_dir}/${secret}/\\\"\\ndone\\nfor secret in redis minio objectstorage postgres ldap omniauth smtp kas pages oauth-secrets ; do\\n  if [ -e \\\"${config_dir}/${secret}\\\" ]; then\\n    mkdir -p \\\"${secret_dir}/${secret}\\\"\\n    cp -v -r -L \\\"${config_dir}/${secret}/.\\\" \\\"${secret_dir}/${secret}/\\\"\\n  fi\\ndone\\n\",\"database.yml.erb\":\"production:\\n  adapter: postgresql\\n  encoding: unicode\\n  database: gitlabhq_production\\n  username: gitlab\\n  password: \\\"\\u003c%!=(MISSING) File.read(\\\"/etc/gitlab/postgres/psql-password\\\").strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  host: \\\"gitlab-postgresql.gitlab.svc\\\"\\n  port: 5432\\n  connect_timeout: \\n  application_name: \\n  prepared_statements: false\\n  \\n  \\n\",\"gitlab.yml.erb\":\"production: \\u0026base\\n  gitlab:\\n    host: gitlab.example.com\\n    https: true\\n    max_request_duration_seconds: 57\\n    impersonation_enabled: \\n    application_settings_cache_seconds: 60\\n    usage_ping_enabled: true\\n    seat_link_enabled: true\\n    default_can_create_group: true\\n    username_changing_enabled: true\\n    issue_closing_pattern: \\n    default_theme: \\n    default_projects_features:\\n      issues: true\\n      merge_requests: true\\n      wiki: true\\n      snippets: true\\n      builds: true\\n      container_registry: true\\n    webhook_timeout: \\n    trusted_proxies:\\n    time_zone: \\\"UTC\\\"        \\n    email_from: \\\"gitlab@example.com\\\"\\n    email_display_name: \\\"GitLab\\\"\\n    email_reply_to: \\\"noreply@example.com\\\"\\n    email_subject_suffix: \\\"\\\"\\n  \\n  gravatar:\\n    plain_url: \\n    ssl_url: \\n  extra:\\n    \\n    \\n    \\n  artifacts:\\n    enabled: true\\n    object_store:\\n      enabled: true\\n      remote_directory: gitlab-artifacts\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n      connection:\\n        provider: AWS\\n        region: us-east-1\\n        host: minio.example.com\\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\\n        path_style: true\\n        aws_access_key_id: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/accesskey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n        aws_secret_access_key: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/secretkey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  lfs:\\n    enabled: true\\n    object_store:\\n      enabled: true\\n      remote_directory: git-lfs\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n      connection:\\n        provider: AWS\\n        region: us-east-1\\n        host: minio.example.com\\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\\n        path_style: true\\n        aws_access_key_id: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/accesskey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n        aws_secret_access_key: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/secretkey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  uploads:\\n    enabled: true\\n    object_store:\\n      enabled: true\\n      remote_directory: gitlab-uploads\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n      connection:\\n        provider: AWS\\n        region: us-east-1\\n        host: minio.example.com\\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\\n        path_style: true\\n        aws_access_key_id: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/accesskey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n        aws_secret_access_key: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/secretkey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  packages:\\n    enabled: true\\n    object_store:\\n      enabled: true\\n      remote_directory: gitlab-packages\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n      connection:\\n        provider: AWS\\n        region: us-east-1\\n        host: minio.example.com\\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\\n        path_style: true\\n        aws_access_key_id: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/accesskey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n        aws_secret_access_key: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/secretkey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  external_diffs:\\n    enabled: false\\n    when: \\n    object_store:\\n      enabled: false\\n      remote_directory: gitlab-mr-diffs\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n  terraform_state:\\n    enabled: false\\n    object_store:\\n      enabled: false\\n      remote_directory: gitlab-terraform-state\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n  dependency_proxy:\\n    enabled: false\\n    object_store:\\n      enabled: false\\n      remote_directory: gitlab-dependency-proxy\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n  pseudonymizer:\\n    manifest: config/pseudonymizer.yml\\n    upload:\\n      remote_directory: gitlab-pseudo\\n      connection:\\n        provider: AWS\\n        region: us-east-1\\n        aws_access_key_id: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/accesskey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n        aws_secret_access_key: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/secretkey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n        host: minio.example.com\\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\\n        path_style: true\\n  \\n  sentry:\\n    enabled: false\\n    dsn: \\n    clientside_dsn: \\n    environment: \\n  pages:\\n    enabled: false\\n    access_control: false\\n    artifacts_server: true\\n    path: /srv/gitlab/shared/pages\\n    host: pages.example.com\\n    port: 443\\n    https: true\\n    secret_file: /etc/gitlab/pages/secret\\n    external_http: false\\n    external_https: false\\n    object_store:\\n      enabled: true\\n      remote_directory: gitlab-pages\\n      connection:\\n        provider: AWS\\n        region: us-east-1\\n        host: minio.example.com\\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\\n        path_style: true\\n        aws_access_key_id: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/accesskey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n        aws_secret_access_key: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/secretkey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  mattermost:\\n    enabled: false\\n  ## Registry Integration\\n  registry:\\n    enabled: true\\n    host: registry.example.com\\n    api_url: http://gitlab-registry.gitlab.svc:5000\\n    key: /etc/gitlab/registry/gitlab-registry.key\\n    issuer: gitlab-issuer\\n    \\n  gitlab_ci:\\n  ldap:\\n    enabled: false\\n  \\n  omniauth:\\n    enabled: false\\n    sync_profile_from_provider: []\\n    sync_profile_attributes: [\\\"email\\\"]\\n    allow_single_sign_on: [\\\"saml\\\"]\\n    block_auto_created_users: true\\n    auto_link_ldap_user: false\\n    auto_link_saml_user: false\\n    external_providers: []\\n  kerberos:\\n    enabled: false\\n  shared:\\n  gitaly:\\n    client_path: /home/git/gitaly/bin\\n    token: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/gitaly/gitaly_token').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  repositories:\\n    storages: # You must have at least a `default` storage path.\\n      default:\\n        path: /var/opt/gitlab/repo\\n        gitaly_address: tcp://gitlab-gitaly-0.gitlab-gitaly.gitlab.svc:8075\\n      \\n  backup:\\n    path: \\\"tmp/backups\\\"   # Relative paths are relative to Rails.root (default: tmp/backups/)\\n  \\n  gitlab_shell:\\n    path: /home/git/gitlab-shell/\\n    hooks_path: /home/git/gitlab-shell/hooks/\\n    upload_pack: true\\n    receive_pack: true\\n  workhorse:\\n  git:\\n    bin_path: /usr/bin/git\\n  webpack:\\n  monitoring:\\n    ip_whitelist:\\n      - 127.0.0.0/8\\n    sidekiq_exporter:\\n      enabled: true\\n      address: 0.0.0.0\\n      port: 3807\\n  sidekiq:\\n    log_format: default\\n\",\"installation_type\":\"gitlab-helm-chart\\n\",\"resque.yml.erb\":\"production:\\n  url: redis://:\\u003c%!=(MISSING) ERB::Util::url_encode(File.read(\\\"/etc/gitlab/redis/redis-password\\\").strip) %!\\(MISSING)u003e@gitlab-redis-master.gitlab.svc:6379\\n  \\n  id:\\n\",\"smtp_settings.rb\":\"\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"sidekiq\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"sidekiq-4.11.4\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-sidekiq\",\"namespace\":\"gitlab\"}}\r\nclient.go:142: [debug] FAILED Time UnixNano: 1621278426375549545 Name: gitlab-nginx-ingress-controller, Namespace: gitlab, ERROR: Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\nclient.go:150: [debug] ==> ERROR JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nstatus.Details.Kind: resourcequotas\r\nkind: ConfigMap\r\nISSUE HIT! CONTINUING: 0\r\nclient.go:127: [debug] Creating resource: {Time UnixNano: 1621278426376955886, Name: gitlab-nginx-ingress-controller, Namespace: gitlab, Source: , ResourceVersion: }\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"add-headers\":\"gitlab/gitlab-nginx-ingress-custom-add-headers\",\"hsts\":\"false\",\"hsts-include-subdomains\":\"false\",\"server-name-hash-bucket-size\":\"256\",\"server-tokens\":\"false\",\"ssl-ciphers\":\"ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA:ECDHE-RSA-AES128-SHA:AES256-GCM-SHA384:AES128-GCM-SHA256:AES256-SHA256:AES128-SHA256:AES256-SHA:AES128-SHA:!aNULL:!eNULL:!EXPORT:!DES:!MD5:!PSK:!RC4\",\"ssl-protocols\":\"TLSv1.3 TLSv1.2\",\"use-http2\":\"true\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"nginx-ingress\",\"app.kubernetes.io/component\":\"controller\",\"app.kubernetes.io/managed-by\":\"Helm\",\"app.kubernetes.io/version\":\"0.41.2\",\"chart\":\"nginx-ingress-3.11.1\",\"component\":\"controller\",\"helm.sh/chart\":\"nginx-ingress-3.11.1\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-nginx-ingress-controller\",\"namespace\":\"gitlab\"}}\r\nclient.go:142: [debug] FAILED Time UnixNano: 1621278426447231197 Name: gitlab-gitlab-runner, Namespace: gitlab, ERROR: Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\nclient.go:150: [debug] ==> ERROR JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nstatus.Details.Kind: resourcequotas\r\nclient.go:142: [debug] FAILED Time UnixNano: 1621278426447314774 Name: gitlab-webservice-tests, Namespace: gitlab, ERROR: Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\nkind: ConfigMap\r\nISSUE HIT! CONTINUING: 0\r\nclient.go:142: [debug] FAILED Time UnixNano: 1621278426447231075 Name: gitlab-webservice, Namespace: gitlab, ERROR: Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\nclient.go:150: [debug] ==> ERROR JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nstatus.Details.Kind: resourcequotas\r\nkind: ConfigMap\r\nISSUE HIT! CONTINUING: 0\r\nclient.go:150: [debug] ==> ERROR JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nstatus.Details.Kind: resourcequotas\r\nkind: ConfigMap\r\nISSUE HIT! CONTINUING: 0\r\nclient.go:142: [debug] FAILED Time UnixNano: 1621278426447231202 Name: gitlab-nginx-ingress-tcp, Namespace: gitlab, ERROR: Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\nclient.go:150: [debug] ==> ERROR JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nstatus.Details.Kind: resourcequotas\r\nkind: ConfigMap\r\nISSUE HIT! CONTINUING: 0\r\nclient.go:142: [debug] FAILED Time UnixNano: 1621278426447231069 Name: gitlab-gitaly, Namespace: gitlab, ERROR: Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\nclient.go:150: [debug] ==> ERROR JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nstatus.Details.Kind: resourcequotas\r\nkind: ConfigMap\r\nISSUE HIT! CONTINUING: 0\r\nclient.go:127: [debug] Creating resource: {Time UnixNano: 1621278426447539112, Name: gitlab-webservice, Namespace: gitlab, Source: , ResourceVersion: }\r\nclient.go:142: [debug] FAILED Time UnixNano: 1621278426447642563 Name: gitlab-workhorse-config, Namespace: gitlab, ERROR: Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\nclient.go:150: [debug] ==> ERROR JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nstatus.Details.Kind: resourcequotas\r\nclient.go:142: [debug] FAILED Time UnixNano: 1621278426447737148 Name: gitlab-minio-config-cm, Namespace: gitlab, ERROR: Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\nkind: ConfigMap\r\nISSUE HIT! CONTINUING: 0\r\nclient.go:142: [debug] FAILED Time UnixNano: 1621278426447652858 Name: gitlab-postgresql-init-db, Namespace: gitlab, ERROR: Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\nclient.go:150: [debug] ==> ERROR JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nclient.go:127: [debug] Creating resource: {Time UnixNano: 1621278426447703773, Name: gitlab-webservice-tests, Namespace: gitlab, Source: , ResourceVersion: }\r\nstatus.Details.Kind: resourcequotas\r\nkind: ConfigMap\r\nISSUE HIT! CONTINUING: 0\r\nclient.go:150: [debug] ==> ERROR JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nstatus.Details.Kind: resourcequotas\r\nkind: ConfigMap\r\nISSUE HIT! CONTINUING: 0\r\n--\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"create-issuer\":\"#!/bin/bash\\nset -e ;\\n\\nissuer_file=$1\\nnamespace=gitlab\\n\\necho \\\"Creating the certmanager issuer...\\\"\\nset +e ; # The CRD may not exist yet. We need to retry until this passes\\nwhile ! kubectl --namespace=$namespace apply -f ${issuer_file:=issuer.yml}; do\\n  sleep 1;\\ndone ;\\nset -e ; # reset `e` as active\\n\",\"issuer.yml\":\"\\napiVersion: certmanager.k8s.io/v1alpha1\\nkind: Issuer\\nmetadata:\\n  name: gitlab-issuer\\n  namespace: gitlab\\n  labels:\\n    app: certmanager-issuer\\n    chart: certmanager-issuer-0.1.0\\n    release: gitlab\\n    heritage: Helm\\nspec:\\n  acme:\\n    # The ACME server URL\\n    server: \\\"https://acme-v02.api.letsencrypt.org/directory\\\"\\n    # Email address used for ACME registration\\n    email: \\\"me@example.com\\\"\\n    # Name of a secret used to store the ACME account private key\\n    privateKeySecretRef:\\n      name: gitlab-acme-key\\n    # Enable the HTTP-01 challenge provider\\n    solvers:\\n    - selector: {}\\n      http01:\\n        ingress:\\n          class: gitlab-nginx\\n\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"certmanager-issuer\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"certmanager-issuer-0.1.0\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-certmanager-issuer-certmanager\",\"namespace\":\"gitlab\"}}\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"enable_extensions.sh\":\"[[ -n \\\"${POSTGRES_POSTGRES_PASSWORD_FILE:-}\\\" ]] \\u0026\\u0026 POSTGRES_POSTGRES_PASSWORD=$(cat ${POSTGRES_POSTGRES_PASSWORD_FILE})\\nPGPASSWORD=${POSTGRES_POSTGRES_PASSWORD} psql -d gitlabhq_production -U postgres -c 'CREATE EXTENSION IF NOT EXISTS pg_trgm; CREATE EXTENSION IF NOT EXISTS btree_gist;'\\n\",\"init_revision.sh\":\"if [[ ! -f \\\"$POSTGRESQL_VOLUME_DIR/.gitlab_1_scripts_initialized\\\" ]] ; then\\n  rm -f \\\"$POSTGRESQL_VOLUME_DIR/.user_scripts_initialized\\\"\\n  touch \\\"$POSTGRESQL_VOLUME_DIR/.gitlab_1_scripts_initialized\\\"\\nfi\\n\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"gitlab\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"gitlab-4.11.4\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-postgresql-init-db\",\"namespace\":\"gitlab\"}}\r\nclient.go:142: [debug] FAILED Time UnixNano: 1621279559570437131 Name: gitlab-nginx-ingress-controller, Namespace: gitlab, ERROR: Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\nclient.go:142: [debug] FAILED Time UnixNano: 1621279559570438729 Name: gitlab-webservice-tests, Namespace: gitlab, ERROR: Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\nclient.go:142: [debug] FAILED Time UnixNano: 1621279559570466870 Name: gitlab-redis, Namespace: gitlab, ERROR: Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\nclient.go:142: [debug] FAILED Time UnixNano: 1621279559570438428 Name: gitlab-gitlab-exporter, Namespace: gitlab, ERROR: Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\nclient.go:142: [debug] FAILED Time UnixNano: 1621279559570560231 Name: gitlab-nginx-ingress-custom-add-headers, Namespace: gitlab, ERROR: Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\nclient.go:150: [debug] ==> ERROR JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nstatus.Details.Kind: resourcequotas\r\nkind: ConfigMap\r\nISSUE HIT! CONTINUING: 0\r\nclient.go:150: [debug] ==> ERROR JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nclient.go:150: [debug] ==> ERROR JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nstatus.Details.Kind: resourcequotas\r\nkind: ConfigMap\r\nclient.go:150: [debug] ==> ERROR JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nISSUE HIT! CONTINUING: 0\r\nclient.go:150: [debug] ==> ERROR JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nstatus.Details.Kind: resourcequotas\r\nstatus.Details.Kind: resourcequotas\r\nkind: ConfigMap\r\nISSUE HIT! CONTINUING: 0\r\nstatus.Details.Kind: resourcequotas\r\nkind: ConfigMap\r\nISSUE HIT! CONTINUING: 0\r\nkind: ConfigMap\r\nISSUE HIT! CONTINUING: 0\r\n--\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"config.yml.erb\":\"# GitLab user. git by default\\nuser: git\\n\\n# Url to gitlab instance. Used for api calls. Should end with a slash.\\ngitlab_url: \\\"http://gitlab-webservice-default.gitlab.svc:8181/\\\"\\n\\nsecret_file: /etc/gitlab-secrets/shell/.gitlab_shell_secret\\n\\nhttp_settings:\\n  self_signed_cert: false\\n\\n# File used as authorized_keys for gitlab user\\nauth_file: \\\"/home/git/.ssh/authorized_keys\\\"\\n\\n# Log file.\\n# Default is gitlab-shell.log in the root directory.\\nlog_file: \\\"/var/log/gitlab-shell/gitlab-shell.log\\\"\\n\\nlog_format: text\\n\\n# Audit usernames.\\n# Set to true to see real usernames in the logs instead of key ids, which is easier to follow, but\\n# incurs an extra API call on every gitlab-shell command.\\naudit_usernames: false\\n\",\"configure\":\"set -e\\nconfig_dir=\\\"/init-config\\\"\\nsecret_dir=\\\"/init-secrets\\\"\\n\\nfor secret in shell ; do\\n  mkdir -p \\\"${secret_dir}/${secret}\\\"\\n  cp -v -r -L \\\"${config_dir}/${secret}/.\\\" \\\"${secret_dir}/${secret}/\\\"\\ndone\\nfor secret in redis minio objectstorage postgres ldap omniauth smtp kas pages oauth-secrets ; do\\n  if [ -e \\\"${config_dir}/${secret}\\\" ]; then\\n    mkdir -p \\\"${secret_dir}/${secret}\\\"\\n    cp -v -r -L \\\"${config_dir}/${secret}/.\\\" \\\"${secret_dir}/${secret}/\\\"\\n  fi\\ndone\\nmkdir -p /${secret_dir}/ssh\\ncp -v -r -L /${config_dir}/ssh_host_* /${secret_dir}/ssh/\\nchmod 0400 /${secret_dir}/ssh/ssh_host_*\\n\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"gitlab-shell\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"gitlab-shell-4.11.4\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-gitlab-shell\",\"namespace\":\"gitlab\"}}\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"config.yml\":\"version: 0.1\\nlog:\\n  fields:\\n    service: registry\\n  level: info\\nhttp:\\n  debug:\\n    addr: ':5001'\\n    prometheus:\\n      enabled: false\\n      path: /metrics\\n  draintimeout: 0\\n  headers:\\n    X-Content-Type-Options: [nosniff]\\n  addr: :5000\\n  secret: \\\"HTTP_SECRET\\\"\\n  relativeurls: false\\nhealth:\\n  storagedriver:\\n    enabled: false\\n    interval: 10s\\n    threshold: 3\\nauth:\\n  token:\\n    realm: https://gitlab.example.com/jwt/auth\\n    service: container_registry\\n    issuer: \\\"gitlab-issuer\\\"\\n    # This is provided from the initContainer execution, at a known path.\\n    rootcertbundle: /etc/docker/registry/certificate.crt\\n    autoredirect: false\\ncompatibility:\\n  schema1:\\n    enabled: false\\nvalidation:\\n  disabled: true\\n\\nnotifications:\\nreporting:\\nprofiling:\\nstorage:\\n  maintenance:\\n    readonly:\\n      enabled: false\\n  s3:\\n    accesskey: \\\"ACCESS_KEY\\\"\\n    secretkey: \\\"SECRET_KEY\\\"\\n    region: us-east-1\\n    regionendpoint: http://gitlab-minio-svc.gitlab.svc:9000\\n    bucket: registry\\n    secure: true\\n    v4auth: true\\n    rootdirectory: /\\n  cache:\\n    blobdescriptor: 'inmemory'\\n  delete:\\n    enabled: true\\n  redirect:\\n    disable: true\\n\\ngc:\\n  disabled: true\\nmigration:\\n\",\"configure\":\"if [ -e /config/accesskey ] ; then\\n  sed -e 's@ACCESS_KEY@'\\\"$(cat /config/accesskey)\\\"'@' -e 's@SECRET_KEY@'\\\"$(cat /config/secretkey)\\\"'@' /config/config.yml \\u003e /registry/config.yml\\nelse\\n  cp -v -r -L /config/config.yml  /registry/config.yml\\nfi\\n# Place the `http.secret` value from the kubernetes secret\\nsed -i -e 's@HTTP_SECRET@'\\\"$(cat /config/httpSecret)\\\"'@' /registry/config.yml\\n# Populate sensitive registry notification secrets in the config file\\nif [ -d /config/notifications ]; then\\n  for i in /config/notifications/*; do\\n    filename=$(basename $i);\\n    sed -i -e 's@'\\\"${filename}\\\"'@'\\\"$(cat $i)\\\"'@' /registry/config.yml;\\n  done\\nfi\\n# Insert any provided `storage` block from kubernetes secret\\nif [ -d /config/storage ]; then\\n  # Copy contents of storage secret(s)\\n  mkdir -p /registry/storage\\n  cp -v -r -L /config/storage/* /registry/storage/\\n  # Ensure there is a new line in the end\\n  echo '' \\u003e\\u003e /registry/storage/config\\n  # Default `delete.enabled: true` if not present.\\n  ## Note: busybox grep doesn't support multiline, so we chain `egrep`.\\n  if ! $(egrep -A1 '^delete:\\\\s*$' /registry/storage/config | egrep -q '\\\\s{2,4}enabled:') ; then\\n    echo 'delete:' \\u003e\\u003e /registry/storage/config\\n    echo '  enabled: true' \\u003e\\u003e /registry/storage/config\\n  fi\\n  # Indent /registry/storage/config 2 spaces before inserting into config.yml\\n  sed -i 's/^/  /' /registry/storage/config\\n  # Insert into /registry/config.yml after `storage:`\\n  sed -i '/storage:/ r /registry/storage/config' /registry/config.yml\\n  # Remove the now extraneous `config` file\\n  rm /registry/storage/config\\nfi\\n# Set to known path, to used ConfigMap\\ncat /config/certificate.crt \\u003e /registry/certificate.crt\\n# Copy the optional profiling keyfile to the expected location\\nif [ -f /config/profiling-key.json ]; then\\n  cp /config/profiling-key.json /registry/profiling-key.json\\nfi\\n# Insert Database password, if enabled\\nif [ -f /config/database_password ] ; then\\n  sed -i -e 's@DB_PASSWORD_FILE@'\\\"$(cat /config/database_password)\\\"'@' /registry/config.yml\\nfi\\n# Copy the database TLS connection files to the expected location and set permissions\\nif [ -d /config/ssl ]; then\\n  cp -r /config/ssl/ /registry/ssl\\n  chmod 700 /registry/ssl\\n  chmod 600 /registry/ssl/*.pem\\nfi\",\"migrations-config.yml\":\"version: 0.1\\nlog:\\n  fields:\\n    service: registry\\n  level: info\\n\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"registry\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"registry-0.5.0\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-registry\",\"namespace\":\"gitlab\"}}\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"configure\":\"set -e\\nconfig_dir=\\\"/init-config\\\"\\nsecret_dir=\\\"/init-secrets\\\"\\n\\nfor secret in   ; do\\n  mkdir -p \\\"${secret_dir}/${secret}\\\"\\n  cp -v -r -L \\\"${config_dir}/${secret}/.\\\" \\\"${secret_dir}/${secret}/\\\"\\ndone\\nfor secret in redis postgres ; do\\n  if [ -e \\\"${config_dir}/${secret}\\\" ]; then\\n    mkdir -p \\\"${secret_dir}/${secret}\\\"\\n    cp -v -r -L \\\"${config_dir}/${secret}/.\\\" \\\"${secret_dir}/${secret}/\\\"\\n  fi\\ndone\\n\",\"gitlab-exporter.yml.erb\":\"server:\\n  name: webrick\\n  listen_address: 0.0.0.0\\n  listen_port: 9168\\n\\nprobes:\\n  db_common: \\u0026db_common\\n    methods:\\n      - probe_db\\n    opts:\\n      connection_string: dbname=gitlabhq_production user=gitlab host=gitlab-postgresql.gitlab.svc port=5432 password='\\u003c%!=(MISSING) File.read(\\\"/etc/gitlab/postgres/psql-password\\\").strip.gsub(/[\\\\'\\\\\\\\]/) { |esc| '\\\\\\\\' + esc } %!\\(MISSING)u003e'\\n  database:\\n    multiple: true\\n    ci_builds:\\n      class_name: Database::CiBuildsProber\\n      \\u003c\\u003c: *db_common\\n    tuple_stats:\\n      class_name: Database::TuplesProber\\n      \\u003c\\u003c: *db_common\\n    rows_count:\\n      class_name: Database::RowCountProber\\n      \\u003c\\u003c: *db_common\\n  database_bloat:\\n    class_name: Database::BloatProber\\n    \\u003c\\u003c: *db_common\\n\\n  sidekiq: \\u0026sidekiq\\n    methods:\\n      - probe_queues\\n      - probe_workers\\n      - probe_retries\\n      - probe_stats\\n    opts:\\n      redis_url: redis://:\\u003c%!=(MISSING) ERB::Util::url_encode(File.read(\\\"/etc/gitlab/redis/redis-password\\\").strip) %!\\(MISSING)u003e@gitlab-redis-master.gitlab.svc:6379\\n      redis_enable_client: false\\n\\n  ruby: \\u0026ruby\\n    methods:\\n      - probe_gc\\n    opts:\\n      quantiles: false\\n\\n  metrics:\\n    multiple: true\\n    ruby:\\n      \\u003c\\u003c: *ruby\\n    sidekiq:\\n      \\u003c\\u003c: *sidekiq\\n    ci_builds:\\n      class_name: Database::CiBuildsProber\\n      \\u003c\\u003c: *db_common\\n    tuple_stats:\\n      class_name: Database::TuplesProber\\n      \\u003c\\u003c: *db_common\\n    rows_count:\\n      class_name: Database::RowCountProber\\n      \\u003c\\u003c: *db_common\\n\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"gitlab-exporter\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"gitlab-exporter-4.11.4\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-gitlab-exporter\",\"namespace\":\"gitlab\"}}\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"cable.yml.erb\":\"production:\\n  url: redis://:\\u003c%!=(MISSING) ERB::Util::url_encode(File.read(\\\"/etc/gitlab/redis/redis-password\\\").strip) %!\\(MISSING)u003e@gitlab-redis-master.gitlab.svc:6379\\n  \\n  id:\\n  adapter: redis\\n\",\"configure\":\"set -e\\nconfig_dir=\\\"/init-config\\\"\\nsecret_dir=\\\"/init-secrets\\\"\\n\\nfor secret in gitaly registry rails-secrets ; do\\n  mkdir -p \\\"${secret_dir}/${secret}\\\"\\n  cp -v -r -L \\\"${config_dir}/${secret}/.\\\" \\\"${secret_dir}/${secret}/\\\"\\ndone\\nfor secret in redis minio objectstorage postgres ldap omniauth smtp kas pages oauth-secrets ; do\\n  if [ -e \\\"${config_dir}/${secret}\\\" ]; then\\n    mkdir -p \\\"${secret_dir}/${secret}\\\"\\n    cp -v -r -L \\\"${config_dir}/${secret}/.\\\" \\\"${secret_dir}/${secret}/\\\"\\n  fi\\ndone\\n\",\"database.yml.erb\":\"production:\\n  adapter: postgresql\\n  encoding: unicode\\n  database: gitlabhq_production\\n  username: gitlab\\n  password: \\\"\\u003c%!=(MISSING) File.read(\\\"/etc/gitlab/postgres/psql-password\\\").strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  host: \\\"gitlab-postgresql.gitlab.svc\\\"\\n  port: 5432\\n  connect_timeout: \\n  application_name: \\n  prepared_statements: false\\n  \\n  \\n\",\"gitlab.yml.erb\":\"production: \\u0026base\\n  gitlab:\\n    host: gitlab.example.com\\n    https: true\\n    max_request_duration_seconds: 57\\n    impersonation_enabled: \\n    application_settings_cache_seconds: 60\\n    usage_ping_enabled: true\\n    seat_link_enabled: true\\n    default_can_create_group: true\\n    username_changing_enabled: true\\n    issue_closing_pattern: \\n    default_theme: \\n    default_projects_features:\\n      issues: true\\n      merge_requests: true\\n      wiki: true\\n      snippets: true\\n      builds: true\\n      container_registry: true\\n    webhook_timeout: \\n    trusted_proxies:\\n    time_zone: \\\"UTC\\\"        \\n    email_from: \\\"gitlab@example.com\\\"\\n    email_display_name: \\\"GitLab\\\"\\n    email_reply_to: \\\"noreply@example.com\\\"\\n    email_subject_suffix: \\\"\\\"\\n  \\n  gravatar:\\n    plain_url: \\n    ssl_url: \\n  extra:\\n    \\n    \\n    \\n  artifacts:\\n    enabled: true\\n    object_store:\\n      enabled: true\\n      remote_directory: gitlab-artifacts\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n      connection:\\n        provider: AWS\\n        region: us-east-1\\n        host: minio.example.com\\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\\n        path_style: true\\n        aws_access_key_id: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/accesskey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n        aws_secret_access_key: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/secretkey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  lfs:\\n    enabled: true\\n    object_store:\\n      enabled: true\\n      remote_directory: git-lfs\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n      connection:\\n        provider: AWS\\n        region: us-east-1\\n        host: minio.example.com\\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\\n        path_style: true\\n        aws_access_key_id: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/accesskey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n        aws_secret_access_key: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/secretkey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  uploads:\\n    enabled: true\\n    object_store:\\n      enabled: true\\n      remote_directory: gitlab-uploads\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n      connection:\\n        provider: AWS\\n        region: us-east-1\\n        host: minio.example.com\\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\\n        path_style: true\\n        aws_access_key_id: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/accesskey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n        aws_secret_access_key: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/secretkey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  packages:\\n    enabled: true\\n    object_store:\\n      enabled: true\\n      remote_directory: gitlab-packages\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n      connection:\\n        provider: AWS\\n        region: us-east-1\\n        host: minio.example.com\\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\\n        path_style: true\\n        aws_access_key_id: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/accesskey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n        aws_secret_access_key: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/secretkey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  external_diffs:\\n    enabled: false\\n    when: \\n    object_store:\\n      enabled: false\\n      remote_directory: gitlab-mr-diffs\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n  terraform_state:\\n    enabled: false\\n    object_store:\\n      enabled: false\\n      remote_directory: gitlab-terraform-state\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n  dependency_proxy:\\n    enabled: false\\n    object_store:\\n      enabled: false\\n      remote_directory: gitlab-dependency-proxy\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n  pseudonymizer:\\n    manifest: config/pseudonymizer.yml\\n    upload:\\n      remote_directory: gitlab-pseudo\\n      connection:\\n        provider: AWS\\n        region: us-east-1\\n        aws_access_key_id: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/accesskey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n        aws_secret_access_key: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/secretkey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n        host: minio.example.com\\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\\n        path_style: true\\n  \\n  sentry:\\n    enabled: false\\n    dsn: \\n    clientside_dsn: \\n    environment: \\n  pages:\\n    enabled: false\\n    access_control: false\\n    artifacts_server: true\\n    path: /srv/gitlab/shared/pages\\n    host: pages.example.com\\n    port: 443\\n    https: true\\n    secret_file: /etc/gitlab/pages/secret\\n    external_http: false\\n    external_https: false\\n    object_store:\\n      enabled: true\\n      remote_directory: gitlab-pages\\n      connection:\\n        provider: AWS\\n        region: us-east-1\\n        host: minio.example.com\\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\\n        path_style: true\\n        aws_access_key_id: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/accesskey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n        aws_secret_access_key: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/secretkey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  mattermost:\\n    enabled: false\\n  ## Registry Integration\\n  registry:\\n    enabled: true\\n    host: registry.example.com\\n    api_url: http://gitlab-registry.gitlab.svc:5000\\n    key: /etc/gitlab/registry/gitlab-registry.key\\n    issuer: gitlab-issuer\\n    \\n  gitlab_ci:\\n  ldap:\\n    enabled: false\\n  \\n  omniauth:\\n    enabled: false\\n    sync_profile_from_provider: []\\n    sync_profile_attributes: [\\\"email\\\"]\\n    allow_single_sign_on: [\\\"saml\\\"]\\n    block_auto_created_users: true\\n    auto_link_ldap_user: false\\n    auto_link_saml_user: false\\n    external_providers: []\\n  kerberos:\\n    enabled: false\\n  shared:\\n  gitaly:\\n    client_path: /home/git/gitaly/bin\\n    token: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/gitaly/gitaly_token').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  repositories:\\n    storages: # You must have at least a `default` storage path.\\n      default:\\n        path: /var/opt/gitlab/repo\\n        gitaly_address: tcp://gitlab-gitaly-0.gitlab-gitaly.gitlab.svc:8075\\n      \\n  backup:\\n    path: \\\"tmp/backups\\\"   # Relative paths are relative to Rails.root (default: tmp/backups/)\\n  \\n  gitlab_shell:\\n    path: /home/git/gitlab-shell/\\n    hooks_path: /home/git/gitlab-shell/hooks/\\n    upload_pack: true\\n    receive_pack: true\\n  workhorse:\\n  git:\\n    bin_path: /usr/bin/git\\n  webpack:\\n  monitoring:\\n    ip_whitelist:\\n      - 127.0.0.0/8\\n    sidekiq_exporter:\\n      enabled: true\\n      address: 0.0.0.0\\n      port: 3807\\n  sidekiq:\\n    log_format: default\\n\",\"installation_type\":\"gitlab-helm-chart\\n\",\"resque.yml.erb\":\"production:\\n  url: redis://:\\u003c%!=(MISSING) ERB::Util::url_encode(File.read(\\\"/etc/gitlab/redis/redis-password\\\").strip) %!\\(MISSING)u003e@gitlab-redis-master.gitlab.svc:6379\\n  \\n  id:\\n\",\"smtp_settings.rb\":\"\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"sidekiq\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"sidekiq-4.11.4\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-sidekiq\",\"namespace\":\"gitlab\"}}\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"sidekiq_queues.yml.erb\":\"\\u003c%!=(MISSING)\\n   # this works because codebase default content has only `:\\n   sq = YAML.load_file('/srv/gitlab/config/sidekiq_queues.yml')\\n   \\n   sq.to_yaml\\n%!\\(MISSING)u003e\\n\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"sidekiq\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"sidekiq-4.11.4\",\"heritage\":\"Helm\",\"queue_pod_name\":\"all-in-1\",\"release\":\"gitlab\"},\"name\":\"gitlab-sidekiq-all-in-1\",\"namespace\":\"gitlab\"}}\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"enable_extensions.sh\":\"[[ -n \\\"${POSTGRES_POSTGRES_PASSWORD_FILE:-}\\\" ]] \\u0026\\u0026 POSTGRES_POSTGRES_PASSWORD=$(cat ${POSTGRES_POSTGRES_PASSWORD_FILE})\\nPGPASSWORD=${POSTGRES_POSTGRES_PASSWORD} psql -d gitlabhq_production -U postgres -c 'CREATE EXTENSION IF NOT EXISTS pg_trgm; CREATE EXTENSION IF NOT EXISTS btree_gist;'\\n\",\"init_revision.sh\":\"if [[ ! -f \\\"$POSTGRESQL_VOLUME_DIR/.gitlab_1_scripts_initialized\\\" ]] ; then\\n  rm -f \\\"$POSTGRESQL_VOLUME_DIR/.user_scripts_initialized\\\"\\n  touch \\\"$POSTGRESQL_VOLUME_DIR/.gitlab_1_scripts_initialized\\\"\\nfi\\n\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"gitlab\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"gitlab-4.11.4\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-postgresql-init-db\",\"namespace\":\"gitlab\"}}\r\nclient.go:142: [debug] FAILED Time UnixNano: 1621280237224598683 Name: gitlab-gitlab-runner, Namespace: gitlab, ERROR: Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\nclient.go:150: [debug] ==> ERROR JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nstatus.Details.Kind: resourcequotas\r\nkind: ConfigMap\r\nISSUE HIT! CONTINUING: 0\r\n--\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"configure\":\"set -e\\nmkdir -p /init-secrets-workhorse/gitlab-workhorse\\ncp -v -r -L /init-config/gitlab-workhorse/secret /init-secrets-workhorse/gitlab-workhorse/secret\\nmkdir -p /init-secrets-workhorse/redis\\ncp -v -r -L /init-config/redis/redis-password /init-secrets-workhorse/redis/\\nif [ -d /init-config/minio ]; then\\n  mkdir -p /init-secrets-workhorse/minio\\n  cp -v -r -L /init-config/minio/* /init-secrets-workhorse/minio/\\nfi\\n\",\"installation_type\":\"gitlab-helm-chart\\n\",\"workhorse-config.toml.erb\":\"[redis]\\nURL = \\\"redis://gitlab-redis-master.gitlab.svc:6379\\\"\\nPassword = \\\"\\u003c%!=(MISSING) File.read(\\\"/etc/gitlab/redis/redis-password\\\").strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n\\u003c%!\\(MISSING)n  require 'yaml'\\n\\n  supported_providers = %!w(MISSING)(AWS AzureRM)\\n  provider = ''\\n  aws_access_key_id = ''\\n  aws_secret_access_key = ''\\n\\n  azure_storage_account_name = ''\\n  azure_storage_access_key = ''\\n\\n  if File.exists? '/etc/gitlab/minio/accesskey'\\n    provider = 'AWS'\\n    aws_access_key_id = File.read('/etc/gitlab/minio/accesskey').strip.dump[1..-2]\\n    aws_secret_access_key = File.read('/etc/gitlab/minio/secretkey').strip.dump[1..-2]\\n  end\\n\\n  if File.exists? '/etc/gitlab/objectstorage/object_store'\\n    connection = YAML.safe_load(File.read('/etc/gitlab/objectstorage/object_store'))\\n    provider = connection['provider']\\n    if connection.has_key? 'aws_access_key_id'\\n      aws_access_key_id = connection['aws_access_key_id']\\n      aws_secret_access_key = connection['aws_secret_access_key']\\n    elsif connection.has_key? 'azure_storage_account_name'\\n      azure_storage_account_name = connection['azure_storage_account_name']\\n      azure_storage_access_key = connection['azure_storage_access_key']\\n    end\\n  end\\n\\n  if supported_providers.include? provider\\n%!\\(MISSING)u003e\\n[object_storage]\\nprovider = \\\"\\u003c%!=(MISSING) provider %!\\(MISSING)u003e\\\"\\n\\u003c%!i(MISSING)f provider.eql? 'AWS' %!\\(MISSING)u003e\\n# AWS / S3 object storage configuration.\\n[object_storage.s3]\\n# access/secret can be blank!\\naws_access_key_id = \\\"\\u003c%!=(MISSING) aws_access_key_id %!\\(MISSING)u003e\\\"\\naws_secret_access_key = \\\"\\u003c%!=(MISSING) aws_secret_access_key %!\\(MISSING)u003e\\\"\\n\\u003c%!e(MISSING)lsif provider.eql? 'AzureRM' %!\\(MISSING)u003e\\n# Azure Blob storage configuration.\\n[object_storage.azurerm]\\nazure_storage_account_name = \\\"\\u003c%!=(MISSING) azure_storage_account_name %!\\(MISSING)u003e\\\"\\nazure_storage_access_key = \\\"\\u003c%!=(MISSING) azure_storage_access_key %!\\(MISSING)u003e\\\"\\n\\u003c%!\\(MISSING)n    end\\n  end\\n%!\\(MISSING)u003e\\n[image_resizer]\\nmax_scaler_procs = 2\\nmax_filesize = 250000\\n\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"webservice\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"webservice-4.11.4\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-workhorse-config\",\"namespace\":\"gitlab\"}}\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"test_login\":\"set -e\\necho 'Start Test'\\nendpoint=\\\"https://gitlab.example.com\\\"\\ncookie_read=\\\"-c /tmp/test_login.cookie\\\"\\ncookie_readwrite=\\\"$cookie_read -b /tmp/test_login.cookie\\\"\\n\\nsignin_url=\\\"$endpoint/users/sign_in\\\"\\necho \\\"Login to create a session: $signin_url\\\"\\ncsrf=$(curl -L $signin_url --fail -s $cookie_read | grep -Po '\\u003cmeta.*name=\\\"csrf-token\\\".*content=\\\"\\\\K[a-zA-Z0-9\\\\+=\\\\-\\\\/]*')\\ncurl -X POST $signin_url -s $cookie_readwrite -F \\\"authenticity_token=$csrf\\\" -F 'user[login]=root' -F \\\"user[password]=$(cat /initial_root_password)\\\"\\n\\nprofile_url=\\\"$endpoint/profile\\\"\\necho \\\"Confirm session valid: $profile_url\\\"\\nprofile_status=$(curl -L -s -o /tmp/profile_output -w \\\"%!{(MISSING)http_code}\\\" $cookie_readwrite $profile_url)\\n\\nif [ \\\"$profile_status\\\" != \\\"200\\\" ]; then\\n  echo \\\"Error: Session Invalid\\\"\\n  cat /tmp/profile_output\\n  exit 1\\nfi\\n\\necho 'Test Passed'\\nexit 0\\n\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app.kubernetes.io/managed-by\":\"Helm\"},\"name\":\"gitlab-webservice-tests\",\"namespace\":\"gitlab\"}}\r\nclient.go:127: [debug] Creating resource: {Time UnixNano: 1621282442786058234, Name: gitlab-prometheus-server, Namespace: gitlab, Source: , ResourceVersion: }\r\nclient.go:127: [debug] Creating resource: {Time UnixNano: 1621282442786087722, Name: gitlab-minio, Namespace: gitlab, Source: , ResourceVersion: }\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"kind\":\"PersistentVolumeClaim\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"prometheus\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"prometheus-10.0.0\",\"component\":\"server\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-prometheus-server\",\"namespace\":\"gitlab\"},\"spec\":{\"accessModes\":[\"ReadWriteOnce\"],\"resources\":{\"requests\":{\"storage\":\"8Gi\"}}}}\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"kind\":\"PersistentVolumeClaim\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"minio\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"minio-0.4.3\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-minio\",\"namespace\":\"gitlab\"},\"spec\":{\"accessModes\":[\"ReadWriteOnce\"],\"resources\":{\"requests\":{\"storage\":\"10Gi\"}},\"selector\":null}}\r\nclient.go:142: [debug] FAILED Time UnixNano: 1621282442867212173 Name: gitlab-minio, Namespace: gitlab, ERROR: Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\nclient.go:150: [debug] ==> ERROR JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nstatus.Details.Kind: resourcequotas\r\nkind: PersistentVolumeClaim\r\nISSUE HIT! CONTINUING: 0\r\nclient.go:127: [debug] Creating resource: {Time UnixNano: 1621282442868001193, Name: gitlab-minio, Namespace: gitlab, Source: , ResourceVersion: }\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"kind\":\"PersistentVolumeClaim\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"minio\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"minio-0.4.3\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-minio\",\"namespace\":\"gitlab\"},\"spec\":{\"accessModes\":[\"ReadWriteOnce\"],\"resources\":{\"requests\":{\"storage\":\"10Gi\"}},\"selector\":null}}\r\nclient.go:142: [debug] FAILED Time UnixNano: 1621282442906191890 Name: gitlab-prometheus-server, Namespace: gitlab, ERROR: Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\nclient.go:150: [debug] ==> ERROR JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nstatus.Details.Kind: resourcequotas\r\nkind: PersistentVolumeClaim\r\nISSUE HIT! CONTINUING: 0\r\n--\r\nclient.go:127: [debug] Creating resource: {Time UnixNano: 1621285865187220447, Name: gitlab-webservice, Namespace: gitlab, Source: , ResourceVersion: }\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"22\":\"gitlab/gitlab-gitlab-shell:22\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"gitlab-shell\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"gitlab-shell-4.11.4\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-nginx-ingress-tcp\",\"namespace\":\"gitlab\"}}\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"config.json\":\"{\\n  \\\"version\\\": \\\"20\\\",\\n  \\\"credential\\\": {\\n    \\\"accessKey\\\": \\\"ACCESS_KEY\\\",\\n    \\\"secretKey\\\": \\\"SECRET_KEY\\\"\\n  },\\n  \\\"region\\\": \\\"us-east-1\\\",\\n  \\\"browser\\\": \\\"on\\\",\\n  \\\"domain\\\": \\\"\\\",\\n  \\\"logger\\\": {\\n    \\\"console\\\": {\\n      \\\"enable\\\": true\\n    },\\n    \\\"file\\\": {\\n      \\\"enable\\\": false,\\n      \\\"fileName\\\": \\\"\\\"\\n    }\\n  },\\n  \\\"notify\\\": {\\n    \\\"amqp\\\": {\\n      \\\"1\\\": {\\n        \\\"enable\\\": false,\\n        \\\"url\\\": \\\"\\\",\\n        \\\"exchange\\\": \\\"\\\",\\n        \\\"routingKey\\\": \\\"\\\",\\n        \\\"exchangeType\\\": \\\"\\\",\\n        \\\"deliveryMode\\\": 0,\\n        \\\"mandatory\\\": false,\\n        \\\"immediate\\\": false,\\n        \\\"durable\\\": false,\\n        \\\"internal\\\": false,\\n        \\\"noWait\\\": false,\\n        \\\"autoDeleted\\\": false\\n      }\\n    },\\n    \\\"nats\\\": {\\n      \\\"1\\\": {\\n        \\\"enable\\\": false,\\n        \\\"address\\\": \\\"\\\",\\n        \\\"subject\\\": \\\"\\\",\\n        \\\"username\\\": \\\"\\\",\\n        \\\"password\\\": \\\"\\\",\\n        \\\"token\\\": \\\"\\\",\\n        \\\"secure\\\": false,\\n        \\\"pingInterval\\\": 0,\\n        \\\"streaming\\\": {\\n          \\\"enable\\\": false,\\n          \\\"clusterID\\\": \\\"\\\",\\n          \\\"clientID\\\": \\\"\\\",\\n          \\\"async\\\": false,\\n          \\\"maxPubAcksInflight\\\": 0\\n        }\\n      }\\n    },\\n    \\\"elasticsearch\\\": {\\n      \\\"1\\\": {\\n        \\\"enable\\\": false,\\n        \\\"format\\\": \\\"namespace\\\",\\n        \\\"url\\\": \\\"\\\",\\n        \\\"index\\\": \\\"\\\"\\n      }\\n    },\\n    \\\"redis\\\": {\\n      \\\"1\\\": {\\n        \\\"enable\\\": false,\\n        \\\"format\\\": \\\"namespace\\\",\\n        \\\"address\\\": \\\"\\\",\\n        \\\"password\\\": \\\"\\\",\\n        \\\"key\\\": \\\"\\\"\\n      }\\n    },\\n    \\\"postgresql\\\": {\\n      \\\"1\\\": {\\n        \\\"enable\\\": false,\\n        \\\"format\\\": \\\"namespace\\\",\\n        \\\"connectionString\\\": \\\"\\\",\\n        \\\"table\\\": \\\"\\\",\\n        \\\"host\\\": \\\"\\\",\\n        \\\"port\\\": \\\"\\\",\\n        \\\"user\\\": \\\"\\\",\\n        \\\"password\\\": \\\"\\\",\\n        \\\"database\\\": \\\"\\\"\\n      }\\n    },\\n    \\\"kafka\\\": {\\n      \\\"1\\\": {\\n        \\\"enable\\\": false,\\n        \\\"brokers\\\": null,\\n        \\\"topic\\\": \\\"\\\"\\n      }\\n    },\\n    \\\"webhook\\\": {\\n      \\\"1\\\": {\\n        \\\"enable\\\": false,\\n        \\\"endpoint\\\": \\\"\\\"\\n      }\\n    },\\n    \\\"mysql\\\": {\\n      \\\"1\\\": {\\n        \\\"enable\\\": false,\\n        \\\"format\\\": \\\"namespace\\\",\\n        \\\"dsnString\\\": \\\"\\\",\\n        \\\"table\\\": \\\"\\\",\\n        \\\"host\\\": \\\"\\\",\\n        \\\"port\\\": \\\"\\\",\\n        \\\"user\\\": \\\"\\\",\\n        \\\"password\\\": \\\"\\\",\\n        \\\"database\\\": \\\"\\\"\\n      }\\n    },\\n    \\\"mqtt\\\": {\\n      \\\"1\\\": {\\n        \\\"enable\\\": false,\\n        \\\"broker\\\": \\\"\\\",\\n        \\\"topic\\\": \\\"\\\",\\n        \\\"qos\\\": 0,\\n        \\\"clientId\\\": \\\"\\\",\\n        \\\"username\\\": \\\"\\\",\\n        \\\"password\\\": \\\"\\\"\\n      }\\n    }\\n  }\\n}\",\"configure\":\"sed -e 's@ACCESS_KEY@'\\\"$(cat /config/accesskey)\\\"'@' -e 's@SECRET_KEY@'\\\"$(cat /config/secretkey)\\\"'@' /config/config.json \\u003e /minio/config.json\",\"initialize\":\"#!/bin/sh\\n# minio/mc container has Busybox Ash, be sure to be POSIX compliant and avoid Bash-isms\\nset -e ; # Have script exit in the event of a failed command.\\n\\n# connectToMinio\\n# Use a check-sleep-check loop to wait for Minio service to be available\\nconnectToMinio() {\\n  set -e ; # fail if we can't read the keys.\\n  ACCESS=$(cat /config/accesskey) ; SECRET=$(cat /config/secretkey) ;\\n  set +e ; # The connections to minio are allowed to fail.\\n  echo \\\"Connecting to Minio server: http://$MINIO_ENDPOINT:$MINIO_PORT\\\" ;\\n  MC_COMMAND=\\\"mc config host add myminio http://$MINIO_ENDPOINT:$MINIO_PORT $ACCESS $SECRET\\\" ;\\n  $MC_COMMAND ;\\n  STATUS=$? ;\\n  until [ $STATUS -eq 0 ] ;\\n  do\\n    sleep 1 ; # 1 second intervals between attempts\\n    $MC_COMMAND ;\\n    STATUS=$? ;\\n  done ;\\n  set -e ; # reset `e` as active\\n  return 0\\n}\\n\\n# checkBucketExists ($bucket)\\n# Check if the bucket exists, by using the exit code of `mc ls`\\ncheckBucketExists() {\\n  BUCKET=$1\\n  CMD=$(/usr/bin/mc ls myminio/$BUCKET \\u003e /dev/null 2\\u003e\\u00261)\\n  return $?\\n}\\n\\n# createBucket ($bucket, $policy, $purge)\\n# Ensure bucket exists, purging if asked to\\ncreateBucket() {\\n  BUCKET=$1\\n  POLICY=$2\\n  PURGE=$3\\n\\n\\n  # Purge the bucket, if set \\u0026 exists\\n  # Since PURGE is user input, check explicitly for `true`\\n  if [ $PURGE = true ]; then\\n    if checkBucketExists $BUCKET ; then\\n      echo \\\"Purging bucket '$BUCKET'.\\\"\\n      set +e ; # don't exit if this fails\\n      /usr/bin/mc rm -r --force myminio/$BUCKET\\n      set -e ; # reset `e` as active\\n    else\\n      echo \\\"Bucket '$BUCKET' does not exist, skipping purge.\\\"\\n    fi\\n  fi\\n\\n  # Create the bucket if it does not exist\\n  if ! checkBucketExists $BUCKET ; then\\n    echo \\\"Creating bucket '$BUCKET'\\\"\\n    /usr/bin/mc mb myminio/$BUCKET\\n  else\\n    echo \\\"Bucket '$BUCKET' already exists.\\\"\\n  fi\\n\\n  # At this point, the bucket should exist, skip checking for existance\\n  # Set policy on the bucket\\n  echo \\\"Setting policy of bucket '$BUCKET' to '$POLICY'.\\\"\\n  /usr/bin/mc policy $POLICY myminio/$BUCKET\\n}\\n\\nconnectToMinio\\ncreateBucket registry none false\\ncreateBucket git-lfs none false\\ncreateBucket runner-cache none false\\ncreateBucket gitlab-uploads none false\\ncreateBucket gitlab-artifacts none false\\ncreateBucket gitlab-backups none false\\ncreateBucket gitlab-packages none false\\ncreateBucket tmp none false\\ncreateBucket gitlab-pseudo none false\\ncreateBucket gitlab-mr-diffs none false\\ncreateBucket gitlab-terraform-state none false\\ncreateBucket gitlab-dependency-proxy none false\\ncreateBucket gitlab-pages none false\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"minio\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"minio-0.4.3\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-minio-config-cm\",\"namespace\":\"gitlab\"}}\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"add-headers\":\"gitlab/gitlab-nginx-ingress-custom-add-headers\",\"hsts\":\"false\",\"hsts-include-subdomains\":\"false\",\"server-name-hash-bucket-size\":\"256\",\"server-tokens\":\"false\",\"ssl-ciphers\":\"ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA:ECDHE-RSA-AES128-SHA:AES256-GCM-SHA384:AES128-GCM-SHA256:AES256-SHA256:AES128-SHA256:AES256-SHA:AES128-SHA:!aNULL:!eNULL:!EXPORT:!DES:!MD5:!PSK:!RC4\",\"ssl-protocols\":\"TLSv1.3 TLSv1.2\",\"use-http2\":\"true\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"nginx-ingress\",\"app.kubernetes.io/component\":\"controller\",\"app.kubernetes.io/managed-by\":\"Helm\",\"app.kubernetes.io/version\":\"0.41.2\",\"chart\":\"nginx-ingress-3.11.1\",\"component\":\"controller\",\"helm.sh/chart\":\"nginx-ingress-3.11.1\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-nginx-ingress-controller\",\"namespace\":\"gitlab\"}}\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"cable.yml.erb\":\"production:\\n  url: redis://:\\u003c%!=(MISSING) ERB::Util::url_encode(File.read(\\\"/etc/gitlab/redis/redis-password\\\").strip) %!\\(MISSING)u003e@gitlab-redis-master.gitlab.svc:6379\\n  \\n  id:\\n  adapter: redis\\n\",\"configure\":\"set -e\\nconfig_dir=\\\"/init-config\\\"\\nsecret_dir=\\\"/init-secrets\\\"\\n\\nfor secret in shell gitaly registry rails-secrets gitlab-workhorse ; do\\n  mkdir -p \\\"${secret_dir}/${secret}\\\"\\n  cp -v -r -L \\\"${config_dir}/${secret}/.\\\" \\\"${secret_dir}/${secret}/\\\"\\ndone\\nfor secret in redis minio objectstorage postgres ldap omniauth smtp kas pages oauth-secrets ; do\\n  if [ -e \\\"${config_dir}/${secret}\\\" ]; then\\n    mkdir -p \\\"${secret_dir}/${secret}\\\"\\n    cp -v -r -L \\\"${config_dir}/${secret}/.\\\" \\\"${secret_dir}/${secret}/\\\"\\n  fi\\ndone\\n\",\"database.yml.erb\":\"production:\\n  adapter: postgresql\\n  encoding: unicode\\n  database: gitlabhq_production\\n  username: gitlab\\n  password: \\\"\\u003c%!=(MISSING) File.read(\\\"/etc/gitlab/postgres/psql-password\\\").strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  host: \\\"gitlab-postgresql.gitlab.svc\\\"\\n  port: 5432\\n  connect_timeout: \\n  application_name: \\n  prepared_statements: false\\n  \\n  \\n\",\"gitlab.yml.erb\":\"production: \\u0026base\\n  gitlab:\\n    host: gitlab.example.com\\n    https: true\\n    max_request_duration_seconds: 57\\n    impersonation_enabled: \\n    application_settings_cache_seconds: 60\\n    usage_ping_enabled: true\\n    seat_link_enabled: true\\n    default_can_create_group: true\\n    username_changing_enabled: true\\n    issue_closing_pattern: \\n    default_theme: \\n    default_projects_features:\\n      issues: true\\n      merge_requests: true\\n      wiki: true\\n      snippets: true\\n      builds: true\\n      container_registry: true\\n    webhook_timeout: \\n    trusted_proxies:\\n    time_zone: \\\"UTC\\\"        \\n    email_from: \\\"gitlab@example.com\\\"\\n    email_display_name: \\\"GitLab\\\"\\n    email_reply_to: \\\"noreply@example.com\\\"\\n    email_subject_suffix: \\\"\\\"\\n  \\n  gravatar:\\n    plain_url: \\n    ssl_url: \\n  extra:\\n    \\n    \\n    \\n  artifacts:\\n    enabled: true\\n    object_store:\\n      enabled: true\\n      remote_directory: gitlab-artifacts\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n      connection:\\n        provider: AWS\\n        region: us-east-1\\n        host: minio.example.com\\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\\n        path_style: true\\n        aws_access_key_id: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/accesskey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n        aws_secret_access_key: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/secretkey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  lfs:\\n    enabled: true\\n    object_store:\\n      enabled: true\\n      remote_directory: git-lfs\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n      connection:\\n        provider: AWS\\n        region: us-east-1\\n        host: minio.example.com\\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\\n        path_style: true\\n        aws_access_key_id: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/accesskey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n        aws_secret_access_key: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/secretkey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  uploads:\\n    enabled: true\\n    object_store:\\n      enabled: true\\n      remote_directory: gitlab-uploads\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n      connection:\\n        provider: AWS\\n        region: us-east-1\\n        host: minio.example.com\\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\\n        path_style: true\\n        aws_access_key_id: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/accesskey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n        aws_secret_access_key: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/secretkey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  packages:\\n    enabled: true\\n    object_store:\\n      enabled: true\\n      remote_directory: gitlab-packages\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n      connection:\\n        provider: AWS\\n        region: us-east-1\\n        host: minio.example.com\\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\\n        path_style: true\\n        aws_access_key_id: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/accesskey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n        aws_secret_access_key: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/secretkey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  external_diffs:\\n    enabled: false\\n    when: \\n    object_store:\\n      enabled: false\\n      remote_directory: gitlab-mr-diffs\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n  terraform_state:\\n    enabled: false\\n    object_store:\\n      enabled: false\\n      remote_directory: gitlab-terraform-state\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n  dependency_proxy:\\n    enabled: false\\n    object_store:\\n      enabled: false\\n      remote_directory: gitlab-dependency-proxy\\n      direct_upload: true\\n      background_upload: false\\n      proxy_download: true\\n  \\n  sentry:\\n    enabled: false\\n    dsn: \\n    clientside_dsn: \\n    environment: \\n  pages:\\n    enabled: false\\n    access_control: false\\n    artifacts_server: true\\n    path: /srv/gitlab/shared/pages\\n    host: pages.example.com\\n    port: 443\\n    https: true\\n    secret_file: /etc/gitlab/pages/secret\\n    external_http: false\\n    external_https: false\\n    object_store:\\n      enabled: true\\n      remote_directory: gitlab-pages\\n      connection:\\n        provider: AWS\\n        region: us-east-1\\n        host: minio.example.com\\n        endpoint: http://gitlab-minio-svc.gitlab.svc:9000\\n        path_style: true\\n        aws_access_key_id: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/accesskey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n        aws_secret_access_key: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/minio/secretkey').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  mattermost:\\n    enabled: false\\n  gitlab_ci:\\n  ldap:\\n    enabled: false\\n  \\n  omniauth:\\n    enabled: false\\n    sync_profile_from_provider: []\\n    sync_profile_attributes: [\\\"email\\\"]\\n    allow_single_sign_on: [\\\"saml\\\"]\\n    block_auto_created_users: true\\n    auto_link_ldap_user: false\\n    auto_link_saml_user: false\\n    external_providers: []\\n  kerberos:\\n    enabled: false\\n  shared:\\n  gitaly:\\n    client_path: /home/git/gitaly/bin\\n    token: \\\"\\u003c%!=(MISSING) File.read('/etc/gitlab/gitaly/gitaly_token').strip.dump[1..-2] %!\\(MISSING)u003e\\\"\\n  repositories:\\n    storages: # You must have at least a `default` storage path.\\n      default:\\n        path: /var/opt/gitlab/repo\\n        gitaly_address: tcp://gitlab-gitaly-0.gitlab-gitaly.gitlab.svc:8075\\n      \\n  backup:\\n    path: \\\"tmp/backups\\\"   # Relative paths are relative to Rails.root (default: tmp/backups/)\\n  \\n  gitlab_shell:\\n    path: /home/git/gitlab-shell/\\n    hooks_path: /home/git/gitlab-shell/hooks/\\n    upload_pack: true\\n    receive_pack: true\\n    ssh_port: 22\\n    secret_file: /etc/gitlab/shell/.gitlab_shell_secret\\n  workhorse:\\n    secret_file: /etc/gitlab/gitlab-workhorse/secret\\n  git:\\n    bin_path: /usr/bin/git\\n  webpack:\\n  monitoring:\\n    ip_whitelist:\\n      - 0.0.0.0/0\\n    web_exporter:\\n      enabled: false\\n      address: 0.0.0.0\\n      port: 8083\\n    sidekiq_exporter:\\n  shutdown:\\n    blackout_seconds: \\u003c%!=(MISSING) ENV[\\\"SHUTDOWN_BLACKOUT_SECONDS\\\"] %!\\(MISSING)u003e\\n  rack_attack:\\n    git_basic_auth:\\n  ## Registry Integration\\n  registry:\\n    enabled: true\\n    host: registry.example.com\\n    api_url: http://gitlab-registry.gitlab.svc:5000\\n    key: /etc/gitlab/registry/gitlab-registry.key\\n    issuer: gitlab-issuer\\n    \\n  smartcard:\\n    enabled: false\\n    ca_file: '/etc/gitlab/rails-secrets/smartcard-ca.crt'\\n    client_certificate_required_host: smartcard.example.com\\n    client_certificate_required_port: 443\\n    san_extensions: false\\n    required_for_git_access: false\\n\",\"installation_type\":\"gitlab-helm-chart\\n\",\"resque.yml.erb\":\"production:\\n  url: redis://:\\u003c%!=(MISSING) ERB::Util::url_encode(File.read(\\\"/etc/gitlab/redis/redis-password\\\").strip) %!\\(MISSING)u003e@gitlab-redis-master.gitlab.svc:6379\\n  \\n  id:\\n\",\"smtp_settings.rb\":\"\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"webservice\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"webservice-4.11.4\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-webservice\",\"namespace\":\"gitlab\"}}\r\nclient.go:136: [debug] ==> Object: {\"apiVersion\":\"v1\",\"data\":{\"start-master.sh\":\"#!/bin/bash\\nuseradd redis\\nchown -R redis /data\\nif [[ -n $REDIS_PASSWORD_FILE ]]; then\\n  password_aux=`cat ${REDIS_PASSWORD_FILE}`\\n  export REDIS_PASSWORD=$password_aux\\nfi\\nif [[ ! -f /opt/bitnami/redis/etc/master.conf ]];then\\n  cp /opt/bitnami/redis/mounted-etc/master.conf /opt/bitnami/redis/etc/master.conf\\nfi\\nif [[ ! -f /opt/bitnami/redis/etc/redis.conf ]];then\\n  cp /opt/bitnami/redis/mounted-etc/redis.conf /opt/bitnami/redis/etc/redis.conf\\nfi\\nARGS=(\\\"--port\\\" \\\"${REDIS_PORT}\\\")\\nARGS+=(\\\"--requirepass\\\" \\\"${REDIS_PASSWORD}\\\")\\nARGS+=(\\\"--masterauth\\\" \\\"${REDIS_PASSWORD}\\\")\\nARGS+=(\\\"--include\\\" \\\"/opt/bitnami/redis/etc/redis.conf\\\")\\nARGS+=(\\\"--include\\\" \\\"/opt/bitnami/redis/etc/master.conf\\\")\\nexec /run.sh \\\"${ARGS[@]}\\\"\\n\"},\"kind\":\"ConfigMap\",\"metadata\":{\"annotations\":{\"meta.helm.sh/release-name\":\"gitlab\",\"meta.helm.sh/release-namespace\":\"gitlab\"},\"labels\":{\"app\":\"redis\",\"app.kubernetes.io/managed-by\":\"Helm\",\"chart\":\"redis-11.3.4\",\"heritage\":\"Helm\",\"release\":\"gitlab\"},\"name\":\"gitlab-redis-scripts\",\"namespace\":\"gitlab\"}}\r\nclient.go:142: [debug] FAILED Time UnixNano: 1621285865341235453 Name: gitlab-webservice, Namespace: gitlab, ERROR: Operation cannot be fulfilled on resourcequotas \"quota\": the object has been modified; please apply your changes to the latest version and try again\r\nclient.go:150: [debug] ==> ERROR JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nstatus.Details.Kind: resourcequotas\r\nkind: ConfigMap\r\nISSUE HIT! CONTINUING: 0\r\n~~~","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/helm/helm/issues/comments/842974567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/helm/helm/issues/comments/843065306","html_url":"https://github.com/helm/helm/issues/9710#issuecomment-843065306","issue_url":"https://api.github.com/repos/helm/helm/issues/9710","id":843065306,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzA2NTMwNg==","user":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T10:49:27Z","updated_at":"2021-05-18T10:49:27Z","body":"Modified suggestion with debug output:\r\n~~~\r\n[akaris@linux helm]$ git diff | cat\r\ndiff --git a/pkg/kube/client.go b/pkg/kube/client.go\r\nindex 2565d183..cd2b8b37 100644\r\n--- a/pkg/kube/client.go\r\n+++ b/pkg/kube/client.go\r\n@@ -21,6 +21,7 @@ import (\r\n \t\"encoding/json\"\r\n \t\"fmt\"\r\n \t\"io\"\r\n+\t\"math/rand\"\r\n \t\"strings\"\r\n \t\"sync\"\r\n \t\"time\"\r\n@@ -120,7 +121,24 @@ func (c *Client) IsReachable() error {\r\n // Create creates Kubernetes resources specified in the resource list.\r\n func (c *Client) Create(resources ResourceList) (*Result, error) {\r\n \tc.Log(\"creating %d resource(s)\", len(resources))\r\n-\tif err := perform(resources, createResource); err != nil {\r\n+\r\n+\tcreateResourceLogger := func(info *resource.Info) error {\r\n+\t\treturnErr := createResource(info)\r\n+\t\tif returnErr != nil {\r\n+\t\t\terrJson, errErr := json.Marshal(returnErr)\r\n+\t\t\tif errErr == nil {\r\n+\t\t\t\tc.Log(\"Issue creating resource with JSON: \" + string(errJson))\r\n+\t\t\t} else {\r\n+\t\t\t\tc.Log(\"Issue creating resource with \" +\r\n+\t\t\t\t\t\"Name: \" + info.Name + \", \" +\r\n+\t\t\t\t\t\"Namespace: \" + info.Namespace + \", \",\r\n+\t\t\t\t)\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\treturn returnErr\r\n+\t}\r\n+\r\n+\tif err := perform(resources, createResourceLogger); err != nil {\r\n \t\treturn nil, err\r\n \t}\r\n \treturn &Result{Created: resources}, nil\r\n@@ -369,13 +387,58 @@ func batchPerform(infos ResourceList, fn func(*resource.Info) error, errs chan<-\r\n \t\t\tkind = currentKind\r\n \t\t}\r\n \t\twg.Add(1)\r\n-\t\tgo func(i *resource.Info) {\r\n-\t\t\terrs <- fn(i)\r\n+\t\tgo func(info *resource.Info) {\r\n+\t\t\t// try 3 times total\r\n+\t\t\ttries := 3\r\n+\t\t\trand.Seed(time.Now().UTC().UnixNano())\r\n+\r\n+\t\t\tfnErr := fn(info)\r\n+\t\t\tfor counter := 1; counter < tries; counter++ {\r\n+\t\t\t\t// break out if this is not a Resource Quota Conflict of if the resource itself\r\n+\t\t\t\t// is a resourcequota\r\n+\t\t\t\tif fnErr == nil ||\r\n+\t\t\t\t\tkind == \"resourcequotas\" ||\r\n+\t\t\t\t\t!isResourceQuotaConflict(fnErr) {\r\n+\t\t\t\t\tbreak\r\n+\t\t\t\t}\r\n+\r\n+\t\t\t\t// Increasing wait: 10-19ms, 40-59ms\r\n+\t\t\t\twaitTime := time.Duration(counter*counter*10+rand.Intn(counter*10)) * time.Millisecond\r\n+\t\t\t\ttime.Sleep(waitTime)\r\n+\r\n+\t\t\t\t// Print temp message to report that the issue was hit\r\n+\t\t\t\tfmt.Printf(\"ISSUE HIT! CONTINUING: %v, and slept for %v\\n\", counter, waitTime)\r\n+\r\n+\t\t\t\t// rerun fn(info)\r\n+\t\t\t\tfnErr = fn(info)\r\n+\t\t\t}\r\n+\t\t\terrs <- fnErr\r\n \t\t\twg.Done()\r\n \t\t}(info)\r\n \t}\r\n }\r\n \r\n+// Helper function which checks if error e is a ResourceQuota conflict\r\n+//\r\n+// A ResourceQuota conflict is hit when the following 3 conditions are met:\r\n+// a) Is this a StatusError?\r\n+// b) Is this a Conflict?\r\n+// c) Is status.Details.Kind == \"resourcequotas\"\r\n+func isResourceQuotaConflict(e error) bool {\r\n+\t// Is this a StatusError?\r\n+\tif se, ok := e.(*apierrors.StatusError); ok {\r\n+\t\t// Is this a Conflict (409)?\r\n+\t\tif apierrors.IsConflict(se) {\r\n+\t\t\t// Is the conflict reason a resourcequota?\r\n+\t\t\tstatus := se.Status()\r\n+\t\t\tif status.Details.Kind == \"resourcequotas\" {\r\n+\t\t\t\treturn true\r\n+\t\t\t}\r\n+\t\t}\r\n+\t}\r\n+\treturn false\r\n+}\r\n+\r\n func createResource(info *resource.Info) error {\r\n \tobj, err := resource.NewHelper(info.Client, info.Mapping).Create(info.Namespace, true, info.Object)\r\n \tif err != nil {\r\n~~~\r\n\r\nThis will yield:\r\n~~~\r\n[akaris@linux 02925442]$ tail -f test_gitlab.log | grep 'ISSUE HIT' -B2\r\nclient.go:123: [debug] creating 115 resource(s)\r\nclient.go:130: [debug] Issue creating resource with JSON: {\"ErrStatus\":{\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"Operation cannot be fulfilled on resourcequotas \\\"quota\\\": the object has been modified; please apply your changes to the latest version and try again\",\"reason\":\"Conflict\",\"details\":{\"name\":\"quota\",\"kind\":\"resourcequotas\"},\"code\":409}}\r\nISSUE HIT! CONTINUING: 1, and slept for 16ms\r\n~~~","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/helm/helm/issues/comments/843065306/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4759933832,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ3NTk5MzM4MzI=","url":"https://api.github.com/repos/helm/helm/issues/events/4759933832","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"a2d4a442136e2a89ca052fa4c9a17f216ec14697","commit_url":"https://api.github.com/repos/andreaskaris/helm/commits/a2d4a442136e2a89ca052fa4c9a17f216ec14697","created_at":"2021-05-18T11:00:53Z","performed_via_github_app":null},{"id":4760468069,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ3NjA0NjgwNjk=","url":"https://api.github.com/repos/helm/helm/issues/events/4760468069","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"2aa166a0905c0a9b55ed18a124bf07adecddbebb","commit_url":"https://api.github.com/repos/andreaskaris/helm/commits/2aa166a0905c0a9b55ed18a124bf07adecddbebb","created_at":"2021-05-18T12:51:12Z","performed_via_github_app":null},{"id":4760727831,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ3NjA3Mjc4MzE=","url":"https://api.github.com/repos/helm/helm/issues/events/4760727831","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"3fd8bfec4914a0782dfeff60793397430185653a","commit_url":"https://api.github.com/repos/andreaskaris/helm/commits/3fd8bfec4914a0782dfeff60793397430185653a","created_at":"2021-05-18T13:34:46Z","performed_via_github_app":null},{"actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T13:46:18Z","updated_at":"2021-05-18T13:46:18Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/helm/helm/issues/9713","repository_url":"https://api.github.com/repos/helm/helm","labels_url":"https://api.github.com/repos/helm/helm/issues/9713/labels{/name}","comments_url":"https://api.github.com/repos/helm/helm/issues/9713/comments","events_url":"https://api.github.com/repos/helm/helm/issues/9713/events","html_url":"https://github.com/helm/helm/pull/9713","id":894254055,"node_id":"MDExOlB1bGxSZXF1ZXN0NjQ2NjQ1MzIw","number":9713,"title":"fix(helm): Retry Conflict error for createResource, deleteResource","user":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":676353308,"node_id":"MDU6TGFiZWw2NzYzNTMzMDg=","url":"https://api.github.com/repos/helm/helm/labels/size/L","name":"size/L","color":"ee9900","default":false,"description":"Denotes a PR that changes 100-499 lines, ignoring generated files."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/helm/helm/milestones/147","html_url":"https://github.com/helm/helm/milestone/147","labels_url":"https://api.github.com/repos/helm/helm/milestones/147/labels","id":11569470,"node_id":"MI_kwDOApspmc4AsIk-","number":147,"title":"3.17.0","description":"","creator":{"login":"scottrigby","id":407675,"node_id":"MDQ6VXNlcjQwNzY3NQ==","avatar_url":"https://avatars.githubusercontent.com/u/407675?v=4","gravatar_id":"","url":"https://api.github.com/users/scottrigby","html_url":"https://github.com/scottrigby","followers_url":"https://api.github.com/users/scottrigby/followers","following_url":"https://api.github.com/users/scottrigby/following{/other_user}","gists_url":"https://api.github.com/users/scottrigby/gists{/gist_id}","starred_url":"https://api.github.com/users/scottrigby/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scottrigby/subscriptions","organizations_url":"https://api.github.com/users/scottrigby/orgs","repos_url":"https://api.github.com/users/scottrigby/repos","events_url":"https://api.github.com/users/scottrigby/events{/privacy}","received_events_url":"https://api.github.com/users/scottrigby/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":31,"state":"closed","created_at":"2024-09-11T17:59:02Z","updated_at":"2025-11-05T21:06:33Z","due_on":"2025-01-15T08:00:00Z","closed_at":"2025-01-15T23:18:18Z"},"comments":28,"created_at":"2021-05-18T11:00:14Z","updated_at":"2024-10-17T15:36:01Z","closed_at":"2024-10-17T15:36:00Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":43723161,"node_id":"MDEwOlJlcG9zaXRvcnk0MzcyMzE2MQ==","name":"helm","full_name":"helm/helm","private":false,"owner":{"login":"helm","id":15859888,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE1ODU5ODg4","avatar_url":"https://avatars.githubusercontent.com/u/15859888?v=4","gravatar_id":"","url":"https://api.github.com/users/helm","html_url":"https://github.com/helm","followers_url":"https://api.github.com/users/helm/followers","following_url":"https://api.github.com/users/helm/following{/other_user}","gists_url":"https://api.github.com/users/helm/gists{/gist_id}","starred_url":"https://api.github.com/users/helm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/helm/subscriptions","organizations_url":"https://api.github.com/users/helm/orgs","repos_url":"https://api.github.com/users/helm/repos","events_url":"https://api.github.com/users/helm/events{/privacy}","received_events_url":"https://api.github.com/users/helm/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/helm/helm","description":"The Kubernetes Package Manager","fork":false,"url":"https://api.github.com/repos/helm/helm","forks_url":"https://api.github.com/repos/helm/helm/forks","keys_url":"https://api.github.com/repos/helm/helm/keys{/key_id}","collaborators_url":"https://api.github.com/repos/helm/helm/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/helm/helm/teams","hooks_url":"https://api.github.com/repos/helm/helm/hooks","issue_events_url":"https://api.github.com/repos/helm/helm/issues/events{/number}","events_url":"https://api.github.com/repos/helm/helm/events","assignees_url":"https://api.github.com/repos/helm/helm/assignees{/user}","branches_url":"https://api.github.com/repos/helm/helm/branches{/branch}","tags_url":"https://api.github.com/repos/helm/helm/tags","blobs_url":"https://api.github.com/repos/helm/helm/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/helm/helm/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/helm/helm/git/refs{/sha}","trees_url":"https://api.github.com/repos/helm/helm/git/trees{/sha}","statuses_url":"https://api.github.com/repos/helm/helm/statuses/{sha}","languages_url":"https://api.github.com/repos/helm/helm/languages","stargazers_url":"https://api.github.com/repos/helm/helm/stargazers","contributors_url":"https://api.github.com/repos/helm/helm/contributors","subscribers_url":"https://api.github.com/repos/helm/helm/subscribers","subscription_url":"https://api.github.com/repos/helm/helm/subscription","commits_url":"https://api.github.com/repos/helm/helm/commits{/sha}","git_commits_url":"https://api.github.com/repos/helm/helm/git/commits{/sha}","comments_url":"https://api.github.com/repos/helm/helm/comments{/number}","issue_comment_url":"https://api.github.com/repos/helm/helm/issues/comments{/number}","contents_url":"https://api.github.com/repos/helm/helm/contents/{+path}","compare_url":"https://api.github.com/repos/helm/helm/compare/{base}...{head}","merges_url":"https://api.github.com/repos/helm/helm/merges","archive_url":"https://api.github.com/repos/helm/helm/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/helm/helm/downloads","issues_url":"https://api.github.com/repos/helm/helm/issues{/number}","pulls_url":"https://api.github.com/repos/helm/helm/pulls{/number}","milestones_url":"https://api.github.com/repos/helm/helm/milestones{/number}","notifications_url":"https://api.github.com/repos/helm/helm/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/helm/helm/labels{/name}","releases_url":"https://api.github.com/repos/helm/helm/releases{/id}","deployments_url":"https://api.github.com/repos/helm/helm/deployments","created_at":"2015-10-06T01:07:32Z","updated_at":"2025-11-09T19:00:10Z","pushed_at":"2025-11-09T12:57:10Z","git_url":"git://github.com/helm/helm.git","ssh_url":"git@github.com:helm/helm.git","clone_url":"https://github.com/helm/helm.git","svn_url":"https://github.com/helm/helm","homepage":"https://helm.sh","size":25851,"stargazers_count":28930,"watchers_count":28930,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":7393,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":448,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":true,"topics":["chart","charts","cncf","helm","kubernetes"],"visibility":"public","forks":7393,"open_issues":448,"watchers":28930,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/helm/helm/pulls/9713","html_url":"https://github.com/helm/helm/pull/9713","diff_url":"https://github.com/helm/helm/pull/9713.diff","patch_url":"https://github.com/helm/helm/pull/9713.patch","merged_at":"2024-10-17T15:36:00Z"},"body":"kubernetes might at any time throw 409 Conflict Error codes. Clients\r\nare supposed to retry when this happens. As an example, see\r\nkubernetes/issues/67761 where such an issues might happen when the\r\ncluster manipulates a projects's ResourceQuotas.\r\n    \r\nCatch such Conflict Errors on createResource and deleteResource and\r\nretry before giving up. Due to the more complex logic and focus on\r\nkubernetes/issues/67761, this patch purposefully omits possibly\r\nneeded changes to updateResource and instead defers them to another\r\npatch if required in the future.\r\n    \r\nCloses issue #9710\r\n    \r\nSigned-off-by: Andreas Karis <ak.karis@gmail.com>\r\n\r\n<!--  Thanks for sending a pull request!  Here are some tips for you:\r\n1. Make sure to read the Contributing Guide before submitting your PR: https://github.com/helm/helm/blob/main/CONTRIBUTING.md\r\n2. If this PR closes another issue, add 'closes #<issue number>' somewhere in the PR summary. GitHub will automatically close that issue when this PR gets merged. Alternatively, adding 'refs #<issue number>' will not close the issue, but help provide the reviewer more context.-->\r\n\r\n**What this PR does / why we need it**:\r\n\r\n**Special notes for your reviewer**:\r\n\r\n**If applicable**:\r\n- [ ] this PR contains documentation\r\n- [x] this PR contains unit tests\r\n- [ ] this PR has been tested for backwards compatibility\r\n","reactions":{"url":"https://api.github.com/repos/helm/helm/issues/9713/reactions","total_count":12,"+1":11,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"timeline_url":"https://api.github.com/repos/helm/helm/issues/9713/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":4761168388,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ3NjExNjgzODg=","url":"https://api.github.com/repos/helm/helm/issues/events/4761168388","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"dfd6040e2dbd5fcc50f0f72304a9ced4ea03da73","commit_url":"https://api.github.com/repos/andreaskaris/helm/commits/dfd6040e2dbd5fcc50f0f72304a9ced4ea03da73","created_at":"2021-05-18T14:44:16Z","performed_via_github_app":null},{"id":4761172984,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ3NjExNzI5ODQ=","url":"https://api.github.com/repos/helm/helm/issues/events/4761172984","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"a499c9e8c55a30e4e3a238b61d57dc80f2170ad8","commit_url":"https://api.github.com/repos/andreaskaris/helm/commits/a499c9e8c55a30e4e3a238b61d57dc80f2170ad8","created_at":"2021-05-18T14:45:03Z","performed_via_github_app":null},{"id":4761186008,"node_id":"MDE0OkNvbm5lY3RlZEV2ZW50NDc2MTE4NjAwOA==","url":"https://api.github.com/repos/helm/helm/issues/events/4761186008","actor":{"login":"bacongobbler","id":1360539,"node_id":"MDQ6VXNlcjEzNjA1Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1360539?v=4","gravatar_id":"","url":"https://api.github.com/users/bacongobbler","html_url":"https://github.com/bacongobbler","followers_url":"https://api.github.com/users/bacongobbler/followers","following_url":"https://api.github.com/users/bacongobbler/following{/other_user}","gists_url":"https://api.github.com/users/bacongobbler/gists{/gist_id}","starred_url":"https://api.github.com/users/bacongobbler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bacongobbler/subscriptions","organizations_url":"https://api.github.com/users/bacongobbler/orgs","repos_url":"https://api.github.com/users/bacongobbler/repos","events_url":"https://api.github.com/users/bacongobbler/events{/privacy}","received_events_url":"https://api.github.com/users/bacongobbler/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"connected","commit_id":null,"commit_url":null,"created_at":"2021-05-18T14:47:07Z","performed_via_github_app":null},{"id":4761187688,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ3NjExODc2ODg=","url":"https://api.github.com/repos/helm/helm/issues/events/4761187688","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"01c92b56ece4bdd34c6aa1cf4f510f7eca456556","commit_url":"https://api.github.com/repos/andreaskaris/helm/commits/01c92b56ece4bdd34c6aa1cf4f510f7eca456556","created_at":"2021-05-18T14:47:23Z","performed_via_github_app":null},{"id":4761461339,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ3NjE0NjEzMzk=","url":"https://api.github.com/repos/helm/helm/issues/events/4761461339","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"51a36e6ba4d1dbdeaedd519e528ca0aff2f33c4e","commit_url":"https://api.github.com/repos/andreaskaris/helm/commits/51a36e6ba4d1dbdeaedd519e528ca0aff2f33c4e","created_at":"2021-05-18T15:32:16Z","performed_via_github_app":null},{"id":4761542219,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ3NjE1NDIyMTk=","url":"https://api.github.com/repos/helm/helm/issues/events/4761542219","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"8ef9fbf78c0e805c569915fa2a7ac19a9a408d7f","commit_url":"https://api.github.com/repos/andreaskaris/helm/commits/8ef9fbf78c0e805c569915fa2a7ac19a9a408d7f","created_at":"2021-05-18T15:46:32Z","performed_via_github_app":null},{"id":4761674818,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ3NjE2NzQ4MTg=","url":"https://api.github.com/repos/helm/helm/issues/events/4761674818","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"ba3488ecb08356c4a8268818049a80239fffd353","commit_url":"https://api.github.com/repos/andreaskaris/helm/commits/ba3488ecb08356c4a8268818049a80239fffd353","created_at":"2021-05-18T16:10:15Z","performed_via_github_app":null},{"id":4761696255,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ3NjE2OTYyNTU=","url":"https://api.github.com/repos/helm/helm/issues/events/4761696255","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"88e13fdedc47acdaea07bb7519f93329fc48c1d7","commit_url":"https://api.github.com/repos/andreaskaris/helm/commits/88e13fdedc47acdaea07bb7519f93329fc48c1d7","created_at":"2021-05-18T16:13:51Z","performed_via_github_app":null},{"id":4762331268,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ3NjIzMzEyNjg=","url":"https://api.github.com/repos/helm/helm/issues/events/4762331268","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"134ef7bc2a1d4e8d7265aebba9a611cb1e73f9f0","commit_url":"https://api.github.com/repos/andreaskaris/helm/commits/134ef7bc2a1d4e8d7265aebba9a611cb1e73f9f0","created_at":"2021-05-18T18:28:32Z","performed_via_github_app":null},{"id":4765266726,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ3NjUyNjY3MjY=","url":"https://api.github.com/repos/helm/helm/issues/events/4765266726","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"57b758419ae9dbb076d2d7756dff552fa8be9a01","commit_url":"https://api.github.com/repos/andreaskaris/helm/commits/57b758419ae9dbb076d2d7756dff552fa8be9a01","created_at":"2021-05-19T08:59:37Z","performed_via_github_app":null},{"id":4765362652,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ3NjUzNjI2NTI=","url":"https://api.github.com/repos/helm/helm/issues/events/4765362652","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"adc355675afa7121cd8ba7a5c3d16261a0e57a8e","commit_url":"https://api.github.com/repos/andreaskaris/helm/commits/adc355675afa7121cd8ba7a5c3d16261a0e57a8e","created_at":"2021-05-19T09:15:49Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/helm/helm/issues/comments/843985395","html_url":"https://github.com/helm/helm/issues/9710#issuecomment-843985395","issue_url":"https://api.github.com/repos/helm/helm/issues/9710","id":843985395,"node_id":"MDEyOklzc3VlQ29tbWVudDg0Mzk4NTM5NQ==","user":{"login":"sttts","id":730123,"node_id":"MDQ6VXNlcjczMDEyMw==","avatar_url":"https://avatars.githubusercontent.com/u/730123?v=4","gravatar_id":"","url":"https://api.github.com/users/sttts","html_url":"https://github.com/sttts","followers_url":"https://api.github.com/users/sttts/followers","following_url":"https://api.github.com/users/sttts/following{/other_user}","gists_url":"https://api.github.com/users/sttts/gists{/gist_id}","starred_url":"https://api.github.com/users/sttts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sttts/subscriptions","organizations_url":"https://api.github.com/users/sttts/orgs","repos_url":"https://api.github.com/users/sttts/repos","events_url":"https://api.github.com/users/sttts/events{/privacy}","received_events_url":"https://api.github.com/users/sttts/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T10:51:54Z","updated_at":"2021-05-19T10:51:54Z","body":"Conflict errors are normal in Kubernetes and clients **must** cope with them (e.g. by retrying). If they don't, it's their bug.\r\n\r\nThat conflict errors happen due to quota is a little ugly, but purely cosmetical and not the actual problem.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/helm/helm/issues/comments/843985395/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sttts","id":730123,"node_id":"MDQ6VXNlcjczMDEyMw==","avatar_url":"https://avatars.githubusercontent.com/u/730123?v=4","gravatar_id":"","url":"https://api.github.com/users/sttts","html_url":"https://github.com/sttts","followers_url":"https://api.github.com/users/sttts/followers","following_url":"https://api.github.com/users/sttts/following{/other_user}","gists_url":"https://api.github.com/users/sttts/gists{/gist_id}","starred_url":"https://api.github.com/users/sttts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sttts/subscriptions","organizations_url":"https://api.github.com/users/sttts/orgs","repos_url":"https://api.github.com/users/sttts/repos","events_url":"https://api.github.com/users/sttts/events{/privacy}","received_events_url":"https://api.github.com/users/sttts/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/helm/helm/issues/comments/844001730","html_url":"https://github.com/helm/helm/issues/9710#issuecomment-844001730","issue_url":"https://api.github.com/repos/helm/helm/issues/9710","id":844001730,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDAwMTczMA==","user":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T11:14:30Z","updated_at":"2021-05-19T11:14:30Z","body":"@sttts  I just realized that I'm spamming kubernetes 67761 with my commits, I'm sorry about that and I'll change the commit message with the next amend.\r\n\r\n> Conflict errors are normal in Kubernetes and clients must cope with them (e.g. by retrying). If they don't, it's their bug.\r\n\r\nWhile I agree with that, the the conflict error is thrown by kubernetes for the `resourcequota` resource on a namespace. That resource (the `resourcequota`) is not touched by helm (or any other client, for that matter).  \r\n\r\nIMO, the conflict error due to the resourcequota should not be relayed to the client in the first place because the client never touches the quota. It's a purely internal thing to the kubernetes cluster.\r\n\r\nAs far as I understand, conflict errors are normal when a client tries to modify resource A and has an outdated resource version for resource A. However, in this case, the client has the correct resource version for resource A, tries to update resource A, and kubernetes throws a conflict for resource B and tells the client that there's a conflict with resource B. Is that o.k.?\r\n\r\nWhat I see is:\r\n\r\nclient --(modify) --> resource A  ---> server --(modify)--> resource B\r\n                                                                         !! race !!\r\nclient --(modify) --> resource C  --> server  --(modify)--> resource B                          \r\n\r\nSo, the client modifies (or creates in this case) 2 different resources at the same time (A and B). Internally, the cluster modifies resource B and this leads to a race. \r\n\r\nThat's how I explain to myself what's going on. Given that the client only implicitly modifies B via A and C, and given that the cluster (the resource quota controller in this case) is the one that's actually modifying B (the resource quota), I do not get why it's not the cluster's responsibility to deal with and handle the race/Conflict which affects the resourcequota. Instead, this Conflict is relayed to the Client where this should be handled. ","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/helm/helm/issues/comments/844001730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4765997738,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDc2NTk5NzczOA==","url":"https://api.github.com/repos/helm/helm/issues/events/4765997738","actor":{"login":"sttts","id":730123,"node_id":"MDQ6VXNlcjczMDEyMw==","avatar_url":"https://avatars.githubusercontent.com/u/730123?v=4","gravatar_id":"","url":"https://api.github.com/users/sttts","html_url":"https://github.com/sttts","followers_url":"https://api.github.com/users/sttts/followers","following_url":"https://api.github.com/users/sttts/following{/other_user}","gists_url":"https://api.github.com/users/sttts/gists{/gist_id}","starred_url":"https://api.github.com/users/sttts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sttts/subscriptions","organizations_url":"https://api.github.com/users/sttts/orgs","repos_url":"https://api.github.com/users/sttts/repos","events_url":"https://api.github.com/users/sttts/events{/privacy}","received_events_url":"https://api.github.com/users/sttts/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-05-19T11:14:30Z","performed_via_github_app":null},{"id":4765997739,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ3NjU5OTc3Mzk=","url":"https://api.github.com/repos/helm/helm/issues/events/4765997739","actor":{"login":"sttts","id":730123,"node_id":"MDQ6VXNlcjczMDEyMw==","avatar_url":"https://avatars.githubusercontent.com/u/730123?v=4","gravatar_id":"","url":"https://api.github.com/users/sttts","html_url":"https://github.com/sttts","followers_url":"https://api.github.com/users/sttts/followers","following_url":"https://api.github.com/users/sttts/following{/other_user}","gists_url":"https://api.github.com/users/sttts/gists{/gist_id}","starred_url":"https://api.github.com/users/sttts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sttts/subscriptions","organizations_url":"https://api.github.com/users/sttts/orgs","repos_url":"https://api.github.com/users/sttts/repos","events_url":"https://api.github.com/users/sttts/events{/privacy}","received_events_url":"https://api.github.com/users/sttts/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-05-19T11:14:30Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/helm/helm/issues/comments/844016119","html_url":"https://github.com/helm/helm/issues/9710#issuecomment-844016119","issue_url":"https://api.github.com/repos/helm/helm/issues/9710","id":844016119,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDAxNjExOQ==","user":{"login":"sttts","id":730123,"node_id":"MDQ6VXNlcjczMDEyMw==","avatar_url":"https://avatars.githubusercontent.com/u/730123?v=4","gravatar_id":"","url":"https://api.github.com/users/sttts","html_url":"https://github.com/sttts","followers_url":"https://api.github.com/users/sttts/followers","following_url":"https://api.github.com/users/sttts/following{/other_user}","gists_url":"https://api.github.com/users/sttts/gists{/gist_id}","starred_url":"https://api.github.com/users/sttts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sttts/subscriptions","organizations_url":"https://api.github.com/users/sttts/orgs","repos_url":"https://api.github.com/users/sttts/repos","events_url":"https://api.github.com/users/sttts/events{/privacy}","received_events_url":"https://api.github.com/users/sttts/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T11:34:09Z","updated_at":"2021-05-19T11:34:09Z","body":"There are no transactions in Kube. As you say A and B are changed when you want to create A here. Hiding B conflicts sounds right on the first sight, but it is not that trivial. Everything in Kube is using optimistic concurrency, and it is not easy or even possible to have a local retry loop fixing every conflict. This has been discussed in https://github.com/openshift/apiserver-library-go/pull/42 and the solution is not as simple as just retrying the B update (the discussion is about another kind of quota in OpenShift, but it equally applies to ResourceQuota in kube).\r\n\r\nNobody disagrees that hiding a conflict of B would be convenient. But the 409 on create is totally legitimate and the Helm code does not handle it correctly. Hiding the B conflict would hide this bug. Be happy that ResourceQuota showed it in a clear way. There can be plenty of other reasons for conflict on create, including other admission steps leading to 409, including 3rd party admission webhooks.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/helm/helm/issues/comments/844016119/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sttts","id":730123,"node_id":"MDQ6VXNlcjczMDEyMw==","avatar_url":"https://avatars.githubusercontent.com/u/730123?v=4","gravatar_id":"","url":"https://api.github.com/users/sttts","html_url":"https://github.com/sttts","followers_url":"https://api.github.com/users/sttts/followers","following_url":"https://api.github.com/users/sttts/following{/other_user}","gists_url":"https://api.github.com/users/sttts/gists{/gist_id}","starred_url":"https://api.github.com/users/sttts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sttts/subscriptions","organizations_url":"https://api.github.com/users/sttts/orgs","repos_url":"https://api.github.com/users/sttts/repos","events_url":"https://api.github.com/users/sttts/events{/privacy}","received_events_url":"https://api.github.com/users/sttts/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/helm/helm/issues/comments/844048472","html_url":"https://github.com/helm/helm/issues/9710#issuecomment-844048472","issue_url":"https://api.github.com/repos/helm/helm/issues/9710","id":844048472,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDA0ODQ3Mg==","user":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T12:18:13Z","updated_at":"2021-05-19T12:18:13Z","body":"Awesome, thanks for the clarification!","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/helm/helm/issues/comments/844048472/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4768524269,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ3Njg1MjQyNjk=","url":"https://api.github.com/repos/helm/helm/issues/events/4768524269","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"5aa495c5de968bf83580686a408f74118f014a02","commit_url":"https://api.github.com/repos/andreaskaris/helm/commits/5aa495c5de968bf83580686a408f74118f014a02","created_at":"2021-05-19T18:25:46Z","performed_via_github_app":null},{"id":4772309752,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ3NzIzMDk3NTI=","url":"https://api.github.com/repos/helm/helm/issues/events/4772309752","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"a675b420a660a9b9297fdbcf40f724948325f2df","commit_url":"https://api.github.com/repos/andreaskaris/helm/commits/a675b420a660a9b9297fdbcf40f724948325f2df","created_at":"2021-05-20T10:32:16Z","performed_via_github_app":null},{"id":4772367183,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ3NzIzNjcxODM=","url":"https://api.github.com/repos/helm/helm/issues/events/4772367183","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"3a088ea4ed3849bab6795edc380b1f8100119074","commit_url":"https://api.github.com/repos/andreaskaris/helm/commits/3a088ea4ed3849bab6795edc380b1f8100119074","created_at":"2021-05-20T10:42:59Z","performed_via_github_app":null},{"id":4772655249,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ3NzI2NTUyNDk=","url":"https://api.github.com/repos/helm/helm/issues/events/4772655249","actor":{"login":"andreaskaris","id":3291433,"node_id":"MDQ6VXNlcjMyOTE0MzM=","avatar_url":"https://avatars.githubusercontent.com/u/3291433?v=4","gravatar_id":"","url":"https://api.github.com/users/andreaskaris","html_url":"https://github.com/andreaskaris","followers_url":"https://api.github.com/users/andreaskaris/followers","following_url":"https://api.github.com/users/andreaskaris/following{/other_user}","gists_url":"https://api.github.com/users/andreaskaris/gists{/gist_id}","starred_url":"https://api.github.com/users/andreaskaris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreaskaris/subscriptions","organizations_url":"https://api.github.com/users/andreaskaris/orgs","repos_url":"https://api.github.com/users/andreaskaris/repos","events_url":"https://api.github.com/users/andreaskaris/events{/privacy}","received_events_url":"https://api.github.com/users/andreaskaris/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"0c5a509f1d702f71f3a88133c67aaaada1888f94","commit_url":"https://api.github.com/repos/andreaskaris/helm/commits/0c5a509f1d702f71f3a88133c67aaaada1888f94","created_at":"2021-05-20T11:36:12Z","performed_via_github_app":null}]