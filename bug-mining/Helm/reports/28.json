{"url":"https://api.github.com/repos/helm/helm/issues/6974","repository_url":"https://api.github.com/repos/helm/helm","labels_url":"https://api.github.com/repos/helm/helm/issues/6974/labels{/name}","comments_url":"https://api.github.com/repos/helm/helm/issues/6974/comments","events_url":"https://api.github.com/repos/helm/helm/issues/6974/events","html_url":"https://github.com/helm/helm/issues/6974","id":523301301,"node_id":"MDU6SXNzdWU1MjMzMDEzMDE=","number":6974,"title":"Helm v3 packaging apiVersion v1 Charts packages in apiVersion v2 format","user":{"login":"TBBle","id":138397,"node_id":"MDQ6VXNlcjEzODM5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/138397?v=4","gravatar_id":"","url":"https://api.github.com/users/TBBle","html_url":"https://github.com/TBBle","followers_url":"https://api.github.com/users/TBBle/followers","following_url":"https://api.github.com/users/TBBle/following{/other_user}","gists_url":"https://api.github.com/users/TBBle/gists{/gist_id}","starred_url":"https://api.github.com/users/TBBle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TBBle/subscriptions","organizations_url":"https://api.github.com/users/TBBle/orgs","repos_url":"https://api.github.com/users/TBBle/repos","events_url":"https://api.github.com/users/TBBle/events{/privacy}","received_events_url":"https://api.github.com/users/TBBle/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":778135666,"node_id":"MDU6TGFiZWw3NzgxMzU2NjY=","url":"https://api.github.com/repos/helm/helm/labels/bug","name":"bug","color":"e11d21","default":true,"description":"Categorizes issue or PR as related to a bug."},{"id":926755770,"node_id":"MDU6TGFiZWw5MjY3NTU3NzA=","url":"https://api.github.com/repos/helm/helm/labels/v3.x","name":"v3.x","color":"e82969","default":false,"description":"Issues and Pull Requests related to the major version v3"}],"state":"closed","locked":false,"assignee":{"login":"TBBle","id":138397,"node_id":"MDQ6VXNlcjEzODM5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/138397?v=4","gravatar_id":"","url":"https://api.github.com/users/TBBle","html_url":"https://github.com/TBBle","followers_url":"https://api.github.com/users/TBBle/followers","following_url":"https://api.github.com/users/TBBle/following{/other_user}","gists_url":"https://api.github.com/users/TBBle/gists{/gist_id}","starred_url":"https://api.github.com/users/TBBle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TBBle/subscriptions","organizations_url":"https://api.github.com/users/TBBle/orgs","repos_url":"https://api.github.com/users/TBBle/repos","events_url":"https://api.github.com/users/TBBle/events{/privacy}","received_events_url":"https://api.github.com/users/TBBle/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"TBBle","id":138397,"node_id":"MDQ6VXNlcjEzODM5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/138397?v=4","gravatar_id":"","url":"https://api.github.com/users/TBBle","html_url":"https://github.com/TBBle","followers_url":"https://api.github.com/users/TBBle/followers","following_url":"https://api.github.com/users/TBBle/following{/other_user}","gists_url":"https://api.github.com/users/TBBle/gists{/gist_id}","starred_url":"https://api.github.com/users/TBBle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TBBle/subscriptions","organizations_url":"https://api.github.com/users/TBBle/orgs","repos_url":"https://api.github.com/users/TBBle/repos","events_url":"https://api.github.com/users/TBBle/events{/privacy}","received_events_url":"https://api.github.com/users/TBBle/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":2,"created_at":"2019-11-15T07:23:31Z","updated_at":"2019-12-11T17:07:06Z","closed_at":"2019-12-11T17:07:06Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Output of `helm version`:\r\n\r\n> version.BuildInfo{Version:\"v3.0.0\", GitCommit:\"e29ce2a54e96cd02ccfce88bee4f58bb6e2a28b6\", GitTreeState:\"clean\", GoVersion:\"go1.13.4\"}\r\n\r\nOutput of `kubectl version`:\r\n\r\n> Client Version: version.Info{Major:\"1\", Minor:\"14\", GitVersion:\"v1.14.7\", GitCommit:\"8fca2ec50a6133511b771a11559e24191b1aa2b4\", GitTreeState:\"clean\", BuildDate:\"2019-09-18T14:47:22Z\", GoVersion:\"go1.12.9\", Compiler:\"gc\", Platform:\"windows/amd64\"}\r\n> Server Version: version.Info{Major:\"1\", Minor:\"13\", GitVersion:\"v1.13.4\", GitCommit:\"c27b913fddd1a6c480c229191a087698aa92f0b1\", GitTreeState:\"clean\", BuildDate:\"2019-02-28T13:30:26Z\", GoVersion:\"go1.11.5\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n\r\n\r\nCloud Provider/Platform (AKS, GKE, Minikube etc.): Bare-metal K8s deployment\r\n\r\nThis would be a duplicate of #6887, but that's been closed as an intended feature affecting downstream users of the dependency system.\r\n\r\nThe bug *here* is that the Chart's apiVersion is still `v1` after packaging, but it no longer works with tools that support Chart apiVersion v1, such as Helm v2.\r\n\r\nAlong auto-merging of requirements.yaml into Chart.yaml by `helm package`, the Chart apiVersion should have been auto-updated to `v2` so that Helm v2 would have given a hard failure to install with meaningful output.\r\n\r\nMy preference would have been to continue including requirements.yaml when packaging an apiVersion v1 Chart.\r\n\r\nThe problem this introduces for Helm v2 is that aliases in requirements.yaml are no longer visible, so installations that use the same chart multiple times via aliases fails and logs something less-directly useful like\r\n\r\n> Error: release XXX failed: configmaps \"XXX-chartName-config\" already exists","closed_by":{"login":"hickeyma","id":14892004,"node_id":"MDQ6VXNlcjE0ODkyMDA0","avatar_url":"https://avatars.githubusercontent.com/u/14892004?v=4","gravatar_id":"","url":"https://api.github.com/users/hickeyma","html_url":"https://github.com/hickeyma","followers_url":"https://api.github.com/users/hickeyma/followers","following_url":"https://api.github.com/users/hickeyma/following{/other_user}","gists_url":"https://api.github.com/users/hickeyma/gists{/gist_id}","starred_url":"https://api.github.com/users/hickeyma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hickeyma/subscriptions","organizations_url":"https://api.github.com/users/hickeyma/orgs","repos_url":"https://api.github.com/users/hickeyma/repos","events_url":"https://api.github.com/users/hickeyma/events{/privacy}","received_events_url":"https://api.github.com/users/hickeyma/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/helm/helm/issues/6974/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/helm/helm/issues/6974/timeline","performed_via_github_app":null,"state_reason":"completed"}