[{"url":"https://api.github.com/repos/helm/helm/issues/comments/684066712","html_url":"https://github.com/helm/helm/issues/8674#issuecomment-684066712","issue_url":"https://api.github.com/repos/helm/helm/issues/8674","id":684066712,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NDA2NjcxMg==","user":{"login":"seaneagan","id":444270,"node_id":"MDQ6VXNlcjQ0NDI3MA==","avatar_url":"https://avatars.githubusercontent.com/u/444270?v=4","gravatar_id":"","url":"https://api.github.com/users/seaneagan","html_url":"https://github.com/seaneagan","followers_url":"https://api.github.com/users/seaneagan/followers","following_url":"https://api.github.com/users/seaneagan/following{/other_user}","gists_url":"https://api.github.com/users/seaneagan/gists{/gist_id}","starred_url":"https://api.github.com/users/seaneagan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seaneagan/subscriptions","organizations_url":"https://api.github.com/users/seaneagan/orgs","repos_url":"https://api.github.com/users/seaneagan/repos","events_url":"https://api.github.com/users/seaneagan/events{/privacy}","received_events_url":"https://api.github.com/users/seaneagan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-31T22:04:42Z","updated_at":"2020-09-01T14:16:30Z","body":"For reference here are how other libraries handle this:\r\n\r\nkubectl rollout status: https://github.com/kubernetes/kubectl/blob/18e781fa774127786b5a2092ed2dc0351dafdb87/pkg/polymorphichelpers/rollout_status.go#L119-L152\r\nkstatus: https://github.com/kubernetes-sigs/cli-utils/blob/master/pkg/kstatus/status/core.go#L77-L152","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/helm/helm/issues/comments/684066712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"seaneagan","id":444270,"node_id":"MDQ6VXNlcjQ0NDI3MA==","avatar_url":"https://avatars.githubusercontent.com/u/444270?v=4","gravatar_id":"","url":"https://api.github.com/users/seaneagan","html_url":"https://github.com/seaneagan","followers_url":"https://api.github.com/users/seaneagan/followers","following_url":"https://api.github.com/users/seaneagan/following{/other_user}","gists_url":"https://api.github.com/users/seaneagan/gists{/gist_id}","starred_url":"https://api.github.com/users/seaneagan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seaneagan/subscriptions","organizations_url":"https://api.github.com/users/seaneagan/orgs","repos_url":"https://api.github.com/users/seaneagan/repos","events_url":"https://api.github.com/users/seaneagan/events{/privacy}","received_events_url":"https://api.github.com/users/seaneagan/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3715504367,"node_id":"MDEyOkxhYmVsZWRFdmVudDM3MTU1MDQzNjc=","url":"https://api.github.com/repos/helm/helm/issues/events/3715504367","actor":{"login":"bacongobbler","id":1360539,"node_id":"MDQ6VXNlcjEzNjA1Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1360539?v=4","gravatar_id":"","url":"https://api.github.com/users/bacongobbler","html_url":"https://github.com/bacongobbler","followers_url":"https://api.github.com/users/bacongobbler/followers","following_url":"https://api.github.com/users/bacongobbler/following{/other_user}","gists_url":"https://api.github.com/users/bacongobbler/gists{/gist_id}","starred_url":"https://api.github.com/users/bacongobbler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bacongobbler/subscriptions","organizations_url":"https://api.github.com/users/bacongobbler/orgs","repos_url":"https://api.github.com/users/bacongobbler/repos","events_url":"https://api.github.com/users/bacongobbler/events{/privacy}","received_events_url":"https://api.github.com/users/bacongobbler/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-09-01T15:20:56Z","label":{"name":"bug","color":"e11d21"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/helm/helm/issues/comments/684971524","html_url":"https://github.com/helm/helm/issues/8674#issuecomment-684971524","issue_url":"https://api.github.com/repos/helm/helm/issues/8674","id":684971524,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NDk3MTUyNA==","user":{"login":"technosophos","id":89193,"node_id":"MDQ6VXNlcjg5MTkz","avatar_url":"https://avatars.githubusercontent.com/u/89193?v=4","gravatar_id":"","url":"https://api.github.com/users/technosophos","html_url":"https://github.com/technosophos","followers_url":"https://api.github.com/users/technosophos/followers","following_url":"https://api.github.com/users/technosophos/following{/other_user}","gists_url":"https://api.github.com/users/technosophos/gists{/gist_id}","starred_url":"https://api.github.com/users/technosophos/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/technosophos/subscriptions","organizations_url":"https://api.github.com/users/technosophos/orgs","repos_url":"https://api.github.com/users/technosophos/repos","events_url":"https://api.github.com/users/technosophos/events{/privacy}","received_events_url":"https://api.github.com/users/technosophos/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-01T16:14:46Z","updated_at":"2020-09-01T16:15:59Z","body":"What is the Helm command you ran?\r\n\r\nAlso: Please try with the latest version of Helm (3.3.1). While I don't know of any exact fix, we updated some of the Kubernetes libraries, which may have resulted in a relevant change here.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/helm/helm/issues/comments/684971524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"technosophos","id":89193,"node_id":"MDQ6VXNlcjg5MTkz","avatar_url":"https://avatars.githubusercontent.com/u/89193?v=4","gravatar_id":"","url":"https://api.github.com/users/technosophos","html_url":"https://github.com/technosophos","followers_url":"https://api.github.com/users/technosophos/followers","following_url":"https://api.github.com/users/technosophos/following{/other_user}","gists_url":"https://api.github.com/users/technosophos/gists{/gist_id}","starred_url":"https://api.github.com/users/technosophos/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/technosophos/subscriptions","organizations_url":"https://api.github.com/users/technosophos/orgs","repos_url":"https://api.github.com/users/technosophos/repos","events_url":"https://api.github.com/users/technosophos/events{/privacy}","received_events_url":"https://api.github.com/users/technosophos/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/helm/helm/issues/comments/685568353","html_url":"https://github.com/helm/helm/issues/8674#issuecomment-685568353","issue_url":"https://api.github.com/repos/helm/helm/issues/8674","id":685568353,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NTU2ODM1Mw==","user":{"login":"behos","id":1937750,"node_id":"MDQ6VXNlcjE5Mzc3NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1937750?v=4","gravatar_id":"","url":"https://api.github.com/users/behos","html_url":"https://github.com/behos","followers_url":"https://api.github.com/users/behos/followers","following_url":"https://api.github.com/users/behos/following{/other_user}","gists_url":"https://api.github.com/users/behos/gists{/gist_id}","starred_url":"https://api.github.com/users/behos/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/behos/subscriptions","organizations_url":"https://api.github.com/users/behos/orgs","repos_url":"https://api.github.com/users/behos/repos","events_url":"https://api.github.com/users/behos/events{/privacy}","received_events_url":"https://api.github.com/users/behos/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-02T10:22:01Z","updated_at":"2020-09-02T10:22:01Z","body":"We're directly calling `Install.Run`\r\n\r\nhttps://github.com/helm/helm/blob/94438b67221d4af3c9993945a42275be7ffc6baa/pkg/action/install.go#L172\r\n\r\nWe're currently on `v3.0.0-beta.4.0.20200320140559-9dfda5437505` but it seems that the same path is still on master.\r\n\r\nIt's not simple to do an upgrade to test this right now, but I'll keep you posted if you can try out 3.3.1","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/helm/helm/issues/comments/685568353/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"behos","id":1937750,"node_id":"MDQ6VXNlcjE5Mzc3NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1937750?v=4","gravatar_id":"","url":"https://api.github.com/users/behos","html_url":"https://github.com/behos","followers_url":"https://api.github.com/users/behos/followers","following_url":"https://api.github.com/users/behos/following{/other_user}","gists_url":"https://api.github.com/users/behos/gists{/gist_id}","starred_url":"https://api.github.com/users/behos/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/behos/subscriptions","organizations_url":"https://api.github.com/users/behos/orgs","repos_url":"https://api.github.com/users/behos/repos","events_url":"https://api.github.com/users/behos/events{/privacy}","received_events_url":"https://api.github.com/users/behos/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/helm/helm/issues/comments/737580423","html_url":"https://github.com/helm/helm/issues/8674#issuecomment-737580423","issue_url":"https://api.github.com/repos/helm/helm/issues/8674","id":737580423,"node_id":"MDEyOklzc3VlQ29tbWVudDczNzU4MDQyMw==","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2020-12-03T00:32:11Z","updated_at":"2020-12-03T00:32:11Z","body":"This issue has been marked as stale because it has been open for 90 days with no activity. This thread will be automatically closed in 30 days if no further activity occurs.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/helm/helm/issues/comments/737580423/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false}},{"id":4064983936,"node_id":"MDEyOkxhYmVsZWRFdmVudDQwNjQ5ODM5MzY=","url":"https://api.github.com/repos/helm/helm/issues/events/4064983936","actor":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-12-03T00:32:12Z","label":{"name":"Stale","color":"ededed"},"performed_via_github_app":null},{"id":4161360854,"node_id":"MDExOkNsb3NlZEV2ZW50NDE2MTM2MDg1NA==","url":"https://api.github.com/repos/helm/helm/issues/events/4161360854","actor":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-01-02T00:46:52Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/helm/helm/issues/comments/753444249","html_url":"https://github.com/helm/helm/issues/8674#issuecomment-753444249","issue_url":"https://api.github.com/repos/helm/helm/issues/8674","id":753444249,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzQ0NDI0OQ==","user":{"login":"behos","id":1937750,"node_id":"MDQ6VXNlcjE5Mzc3NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1937750?v=4","gravatar_id":"","url":"https://api.github.com/users/behos","html_url":"https://github.com/behos","followers_url":"https://api.github.com/users/behos/followers","following_url":"https://api.github.com/users/behos/following{/other_user}","gists_url":"https://api.github.com/users/behos/gists{/gist_id}","starred_url":"https://api.github.com/users/behos/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/behos/subscriptions","organizations_url":"https://api.github.com/users/behos/orgs","repos_url":"https://api.github.com/users/behos/repos","events_url":"https://api.github.com/users/behos/events{/privacy}","received_events_url":"https://api.github.com/users/behos/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-02T07:45:54Z","updated_at":"2021-01-02T07:45:54Z","body":"I'm not sure there's been a resolution for this.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/helm/helm/issues/comments/753444249/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"behos","id":1937750,"node_id":"MDQ6VXNlcjE5Mzc3NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1937750?v=4","gravatar_id":"","url":"https://api.github.com/users/behos","html_url":"https://github.com/behos","followers_url":"https://api.github.com/users/behos/followers","following_url":"https://api.github.com/users/behos/following{/other_user}","gists_url":"https://api.github.com/users/behos/gists{/gist_id}","starred_url":"https://api.github.com/users/behos/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/behos/subscriptions","organizations_url":"https://api.github.com/users/behos/orgs","repos_url":"https://api.github.com/users/behos/repos","events_url":"https://api.github.com/users/behos/events{/privacy}","received_events_url":"https://api.github.com/users/behos/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/helm/helm/issues/comments/753492270","html_url":"https://github.com/helm/helm/issues/8674#issuecomment-753492270","issue_url":"https://api.github.com/repos/helm/helm/issues/8674","id":753492270,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzQ5MjI3MA==","user":{"login":"bacongobbler","id":1360539,"node_id":"MDQ6VXNlcjEzNjA1Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1360539?v=4","gravatar_id":"","url":"https://api.github.com/users/bacongobbler","html_url":"https://github.com/bacongobbler","followers_url":"https://api.github.com/users/bacongobbler/followers","following_url":"https://api.github.com/users/bacongobbler/following{/other_user}","gists_url":"https://api.github.com/users/bacongobbler/gists{/gist_id}","starred_url":"https://api.github.com/users/bacongobbler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bacongobbler/subscriptions","organizations_url":"https://api.github.com/users/bacongobbler/orgs","repos_url":"https://api.github.com/users/bacongobbler/repos","events_url":"https://api.github.com/users/bacongobbler/events{/privacy}","received_events_url":"https://api.github.com/users/bacongobbler/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-02T16:15:59Z","updated_at":"2021-01-02T16:15:59Z","body":"If you can reproduce the issue with a more recent version of helm 3 then we can reopen and investigate further. We cannot provide support for beta pre-releases of helm 3. That is why we asked if you can reproduce with helm 3.3.1.\r\n\r\nThe most recent release now is helm 3.4.2. I would start there.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/helm/helm/issues/comments/753492270/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bacongobbler","id":1360539,"node_id":"MDQ6VXNlcjEzNjA1Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1360539?v=4","gravatar_id":"","url":"https://api.github.com/users/bacongobbler","html_url":"https://github.com/bacongobbler","followers_url":"https://api.github.com/users/bacongobbler/followers","following_url":"https://api.github.com/users/bacongobbler/following{/other_user}","gists_url":"https://api.github.com/users/bacongobbler/gists{/gist_id}","starred_url":"https://api.github.com/users/bacongobbler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bacongobbler/subscriptions","organizations_url":"https://api.github.com/users/bacongobbler/orgs","repos_url":"https://api.github.com/users/bacongobbler/repos","events_url":"https://api.github.com/users/bacongobbler/events{/privacy}","received_events_url":"https://api.github.com/users/bacongobbler/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/helm/helm/issues/comments/755055043","html_url":"https://github.com/helm/helm/issues/8674#issuecomment-755055043","issue_url":"https://api.github.com/repos/helm/helm/issues/8674","id":755055043,"node_id":"MDEyOklzc3VlQ29tbWVudDc1NTA1NTA0Mw==","user":{"login":"iSignal","id":8207010,"node_id":"MDQ6VXNlcjgyMDcwMTA=","avatar_url":"https://avatars.githubusercontent.com/u/8207010?v=4","gravatar_id":"","url":"https://api.github.com/users/iSignal","html_url":"https://github.com/iSignal","followers_url":"https://api.github.com/users/iSignal/followers","following_url":"https://api.github.com/users/iSignal/following{/other_user}","gists_url":"https://api.github.com/users/iSignal/gists{/gist_id}","starred_url":"https://api.github.com/users/iSignal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iSignal/subscriptions","organizations_url":"https://api.github.com/users/iSignal/orgs","repos_url":"https://api.github.com/users/iSignal/repos","events_url":"https://api.github.com/users/iSignal/events{/privacy}","received_events_url":"https://api.github.com/users/iSignal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-06T03:31:19Z","updated_at":"2021-01-06T03:33:30Z","body":"I can reproduce this issue with helm 3.4.2. I tried this with both minikube (kubernetes 1.20.0, docker driver) and against GKE. I have also been able to reproduce this with previous versions of helm.\r\n\r\nThe steps I used were:\r\n1. \r\n  ``` \r\nkubectl create namespace tmp-2 && helm3 install yb-demo  ~/code/charts/stable/yugabyte/ --set\r\nresource.master.requests.cpu=0.25,resource.master.requests.memory=0.35Gi,resource.tserver.requests.cpu=0.25,resource.tserver.requests.memory=0.35Gi --namespace tmp-2 --wait\r\n# code/charts/stable/yugabyte comes from https://github.com/yugabyte/charts/stable/yugabyte\r\n# this step succeeds\r\n```\r\n2. Add a partition field set to the above chart\r\n  ```\r\n  helm3 upgrade yb-demo  ~/code/charts/stable/yugabyte/ --set partition.master=1,resource.master.requests.cpu=0.25,resource.master.requests.memory=0.35Gi,resource.tserver.requests.cpu=0.25,resource.tserver.requests.memory=0.35Gi --namespace tmp-2 --wait\r\nError: UPGRADE FAILED: timed out waiting for the condition\r\n# this step hangs indefinitely and eventually fails. \r\n# partiton.master defaults to 0 and maps to rollingUpdate.partition https://github.com/yugabyte/charts/blob/57aad61c947cafee4df8ef8d2b15255c0465095a/stable/yugabyte/templates/service.yaml#L162\r\n```\r\nThe status of the stateful set looks as follows:\r\n```\r\nstatus:\r\n  collisionCount: 0\r\n  currentReplicas: 3\r\n  currentRevision: yb-master-5d5844777d\r\n  observedGeneration: 2\r\n  readyReplicas: 3\r\n  replicas: 3\r\n  updateRevision: yb-master-5d5844777d\r\n  updatedReplicas: 3\r\n```","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/helm/helm/issues/comments/755055043/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"iSignal","id":8207010,"node_id":"MDQ6VXNlcjgyMDcwMTA=","avatar_url":"https://avatars.githubusercontent.com/u/8207010?v=4","gravatar_id":"","url":"https://api.github.com/users/iSignal","html_url":"https://github.com/iSignal","followers_url":"https://api.github.com/users/iSignal/followers","following_url":"https://api.github.com/users/iSignal/following{/other_user}","gists_url":"https://api.github.com/users/iSignal/gists{/gist_id}","starred_url":"https://api.github.com/users/iSignal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iSignal/subscriptions","organizations_url":"https://api.github.com/users/iSignal/orgs","repos_url":"https://api.github.com/users/iSignal/repos","events_url":"https://api.github.com/users/iSignal/events{/privacy}","received_events_url":"https://api.github.com/users/iSignal/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4190999305,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQxOTA5OTkzMDU=","url":"https://api.github.com/repos/helm/helm/issues/events/4190999305","actor":{"login":"Arnav15","id":14933889,"node_id":"MDQ6VXNlcjE0OTMzODg5","avatar_url":"https://avatars.githubusercontent.com/u/14933889?v=4","gravatar_id":"","url":"https://api.github.com/users/Arnav15","html_url":"https://github.com/Arnav15","followers_url":"https://api.github.com/users/Arnav15/followers","following_url":"https://api.github.com/users/Arnav15/following{/other_user}","gists_url":"https://api.github.com/users/Arnav15/gists{/gist_id}","starred_url":"https://api.github.com/users/Arnav15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Arnav15/subscriptions","organizations_url":"https://api.github.com/users/Arnav15/orgs","repos_url":"https://api.github.com/users/Arnav15/repos","events_url":"https://api.github.com/users/Arnav15/events{/privacy}","received_events_url":"https://api.github.com/users/Arnav15/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"bad504c10be8334025ee8a2d13033399f107c26b","commit_url":"https://api.github.com/repos/yugabyte/yugabyte-db/commits/bad504c10be8334025ee8a2d13033399f107c26b","created_at":"2021-01-11T14:16:42Z","performed_via_github_app":null},{"id":4191008715,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQxOTEwMDg3MTU=","url":"https://api.github.com/repos/helm/helm/issues/events/4191008715","actor":{"login":"Arnav15","id":14933889,"node_id":"MDQ6VXNlcjE0OTMzODg5","avatar_url":"https://avatars.githubusercontent.com/u/14933889?v=4","gravatar_id":"","url":"https://api.github.com/users/Arnav15","html_url":"https://github.com/Arnav15","followers_url":"https://api.github.com/users/Arnav15/followers","following_url":"https://api.github.com/users/Arnav15/following{/other_user}","gists_url":"https://api.github.com/users/Arnav15/gists{/gist_id}","starred_url":"https://api.github.com/users/Arnav15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Arnav15/subscriptions","organizations_url":"https://api.github.com/users/Arnav15/orgs","repos_url":"https://api.github.com/users/Arnav15/repos","events_url":"https://api.github.com/users/Arnav15/events{/privacy}","received_events_url":"https://api.github.com/users/Arnav15/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"b83336aec1db6b573bfe3fa0485db65e1d9a786e","commit_url":"https://api.github.com/repos/yugabyte/yugabyte-db/commits/b83336aec1db6b573bfe3fa0485db65e1d9a786e","created_at":"2021-01-11T14:18:39Z","performed_via_github_app":null},{"id":4430722954,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ0MzA3MjI5NTQ=","url":"https://api.github.com/repos/helm/helm/issues/events/4430722954","actor":{"login":"polarweasel","id":538384,"node_id":"MDQ6VXNlcjUzODM4NA==","avatar_url":"https://avatars.githubusercontent.com/u/538384?v=4","gravatar_id":"","url":"https://api.github.com/users/polarweasel","html_url":"https://github.com/polarweasel","followers_url":"https://api.github.com/users/polarweasel/followers","following_url":"https://api.github.com/users/polarweasel/following{/other_user}","gists_url":"https://api.github.com/users/polarweasel/gists{/gist_id}","starred_url":"https://api.github.com/users/polarweasel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polarweasel/subscriptions","organizations_url":"https://api.github.com/users/polarweasel/orgs","repos_url":"https://api.github.com/users/polarweasel/repos","events_url":"https://api.github.com/users/polarweasel/events{/privacy}","received_events_url":"https://api.github.com/users/polarweasel/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"0e6d9d3a4d8ccd70f4ee369124af4980872061a1","commit_url":"https://api.github.com/repos/lizayugabyte/yugabyte-db/commits/0e6d9d3a4d8ccd70f4ee369124af4980872061a1","created_at":"2021-03-09T19:12:34Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/helm/helm/issues/comments/808156882","html_url":"https://github.com/helm/helm/issues/8674#issuecomment-808156882","issue_url":"https://api.github.com/repos/helm/helm/issues/8674","id":808156882,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODE1Njg4Mg==","user":{"login":"kopwei","id":944672,"node_id":"MDQ6VXNlcjk0NDY3Mg==","avatar_url":"https://avatars.githubusercontent.com/u/944672?v=4","gravatar_id":"","url":"https://api.github.com/users/kopwei","html_url":"https://github.com/kopwei","followers_url":"https://api.github.com/users/kopwei/followers","following_url":"https://api.github.com/users/kopwei/following{/other_user}","gists_url":"https://api.github.com/users/kopwei/gists{/gist_id}","starred_url":"https://api.github.com/users/kopwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kopwei/subscriptions","organizations_url":"https://api.github.com/users/kopwei/orgs","repos_url":"https://api.github.com/users/kopwei/repos","events_url":"https://api.github.com/users/kopwei/events{/privacy}","received_events_url":"https://api.github.com/users/kopwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T11:53:05Z","updated_at":"2021-03-26T11:53:59Z","body":"I am facing the same issue with \"helm upgrade --wait\" command, where the Statefulset's replica count target can never be archived. The Statefulset's replicaCount is set to 2 but Helm keeps complains about it and timeout eventually in upgrade.\r\n\r\nHelm version: v3.5.3\r\n```bash\r\n$  helm version\r\nversion.BuildInfo{Version:\"v3.5.3\", GitCommit:\"041ce5a2c17a58be0fcd5f5e16fb3e7e95fea622\", GitTreeState:\"dirty\", GoVersion:\"go1.16\"}\r\n```\r\n\r\nError Message:\r\n```log\r\nwait.go:348: [debug] StatefulSet is not ready: isp-flux/flux-stolon-keeper. 2 out of 0 expected pods have been scheduled\r\n```\r\n\r\nStateful status:\r\n```yaml\r\nstatus:\r\n  collisionCount: 0\r\n  currentReplicas: 2\r\n  currentRevision: flux-stolon-keeper-59f7ddfbd6\r\n  observedGeneration: 1\r\n  readyReplicas: 2\r\n  replicas: 2\r\n  updateRevision: flux-stolon-keeper-59f7ddfbd6\r\n  updatedReplicas: 2\r\n ```","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/helm/helm/issues/comments/808156882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kopwei","id":944672,"node_id":"MDQ6VXNlcjk0NDY3Mg==","avatar_url":"https://avatars.githubusercontent.com/u/944672?v=4","gravatar_id":"","url":"https://api.github.com/users/kopwei","html_url":"https://github.com/kopwei","followers_url":"https://api.github.com/users/kopwei/followers","following_url":"https://api.github.com/users/kopwei/following{/other_user}","gists_url":"https://api.github.com/users/kopwei/gists{/gist_id}","starred_url":"https://api.github.com/users/kopwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kopwei/subscriptions","organizations_url":"https://api.github.com/users/kopwei/orgs","repos_url":"https://api.github.com/users/kopwei/repos","events_url":"https://api.github.com/users/kopwei/events{/privacy}","received_events_url":"https://api.github.com/users/kopwei/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/helm/helm/issues/comments/808178778","html_url":"https://github.com/helm/helm/issues/8674#issuecomment-808178778","issue_url":"https://api.github.com/repos/helm/helm/issues/8674","id":808178778,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODE3ODc3OA==","user":{"login":"kopwei","id":944672,"node_id":"MDQ6VXNlcjk0NDY3Mg==","avatar_url":"https://avatars.githubusercontent.com/u/944672?v=4","gravatar_id":"","url":"https://api.github.com/users/kopwei","html_url":"https://github.com/kopwei","followers_url":"https://api.github.com/users/kopwei/followers","following_url":"https://api.github.com/users/kopwei/following{/other_user}","gists_url":"https://api.github.com/users/kopwei/gists{/gist_id}","starred_url":"https://api.github.com/users/kopwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kopwei/subscriptions","organizations_url":"https://api.github.com/users/kopwei/orgs","repos_url":"https://api.github.com/users/kopwei/repos","events_url":"https://api.github.com/users/kopwei/events{/privacy}","received_events_url":"https://api.github.com/users/kopwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T12:30:47Z","updated_at":"2021-03-26T12:30:47Z","body":"This issue occurs when the Statefulset's update strategy is set to \"RollingUpdate\".\r\nThe error occurs at function \"statefulSetReady\" in pkg/kube/wait.go file\r\n During upgrade. the partition is equal to replicas. Thus values of \"expectedReplicas\" is calculated to 0 and can never be equal to Status.UpdatedReplicas. And it will stuck here and ends up in upgrading time out eventually.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/helm/helm/issues/comments/808178778/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kopwei","id":944672,"node_id":"MDQ6VXNlcjk0NDY3Mg==","avatar_url":"https://avatars.githubusercontent.com/u/944672?v=4","gravatar_id":"","url":"https://api.github.com/users/kopwei","html_url":"https://github.com/kopwei","followers_url":"https://api.github.com/users/kopwei/followers","following_url":"https://api.github.com/users/kopwei/following{/other_user}","gists_url":"https://api.github.com/users/kopwei/gists{/gist_id}","starred_url":"https://api.github.com/users/kopwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kopwei/subscriptions","organizations_url":"https://api.github.com/users/kopwei/orgs","repos_url":"https://api.github.com/users/kopwei/repos","events_url":"https://api.github.com/users/kopwei/events{/privacy}","received_events_url":"https://api.github.com/users/kopwei/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":5658525806,"node_id":"REFE_lADOApspmc4pEin0zwAAAAFRRkBu","url":"https://api.github.com/repos/helm/helm/issues/events/5658525806","actor":{"login":"bhavin192","id":5154532,"node_id":"MDQ6VXNlcjUxNTQ1MzI=","avatar_url":"https://avatars.githubusercontent.com/u/5154532?v=4","gravatar_id":"","url":"https://api.github.com/users/bhavin192","html_url":"https://github.com/bhavin192","followers_url":"https://api.github.com/users/bhavin192/followers","following_url":"https://api.github.com/users/bhavin192/following{/other_user}","gists_url":"https://api.github.com/users/bhavin192/gists{/gist_id}","starred_url":"https://api.github.com/users/bhavin192/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhavin192/subscriptions","organizations_url":"https://api.github.com/users/bhavin192/orgs","repos_url":"https://api.github.com/users/bhavin192/repos","events_url":"https://api.github.com/users/bhavin192/events{/privacy}","received_events_url":"https://api.github.com/users/bhavin192/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"2e51acaf840418a57d449177fb3010afc9d18abe","commit_url":"https://api.github.com/repos/bhavin192/helm/commits/2e51acaf840418a57d449177fb3010afc9d18abe","created_at":"2021-11-23T07:55:40Z","performed_via_github_app":null},{"id":5658593806,"node_id":"REFE_lADOApspmc4pEin0zwAAAAFRR0oO","url":"https://api.github.com/repos/helm/helm/issues/events/5658593806","actor":{"login":"bhavin192","id":5154532,"node_id":"MDQ6VXNlcjUxNTQ1MzI=","avatar_url":"https://avatars.githubusercontent.com/u/5154532?v=4","gravatar_id":"","url":"https://api.github.com/users/bhavin192","html_url":"https://github.com/bhavin192","followers_url":"https://api.github.com/users/bhavin192/followers","following_url":"https://api.github.com/users/bhavin192/following{/other_user}","gists_url":"https://api.github.com/users/bhavin192/gists{/gist_id}","starred_url":"https://api.github.com/users/bhavin192/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhavin192/subscriptions","organizations_url":"https://api.github.com/users/bhavin192/orgs","repos_url":"https://api.github.com/users/bhavin192/repos","events_url":"https://api.github.com/users/bhavin192/events{/privacy}","received_events_url":"https://api.github.com/users/bhavin192/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"2a3510f8c213f053c1740241e2413337d39eecc9","commit_url":"https://api.github.com/repos/bhavin192/helm/commits/2a3510f8c213f053c1740241e2413337d39eecc9","created_at":"2021-11-23T08:11:06Z","performed_via_github_app":null},{"actor":{"login":"bhavin192","id":5154532,"node_id":"MDQ6VXNlcjUxNTQ1MzI=","avatar_url":"https://avatars.githubusercontent.com/u/5154532?v=4","gravatar_id":"","url":"https://api.github.com/users/bhavin192","html_url":"https://github.com/bhavin192","followers_url":"https://api.github.com/users/bhavin192/followers","following_url":"https://api.github.com/users/bhavin192/following{/other_user}","gists_url":"https://api.github.com/users/bhavin192/gists{/gist_id}","starred_url":"https://api.github.com/users/bhavin192/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhavin192/subscriptions","organizations_url":"https://api.github.com/users/bhavin192/orgs","repos_url":"https://api.github.com/users/bhavin192/repos","events_url":"https://api.github.com/users/bhavin192/events{/privacy}","received_events_url":"https://api.github.com/users/bhavin192/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-23T08:11:41Z","updated_at":"2021-11-23T08:11:41Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/helm/helm/issues/10387","repository_url":"https://api.github.com/repos/helm/helm","labels_url":"https://api.github.com/repos/helm/helm/issues/10387/labels{/name}","comments_url":"https://api.github.com/repos/helm/helm/issues/10387/comments","events_url":"https://api.github.com/repos/helm/helm/issues/10387/events","html_url":"https://github.com/helm/helm/pull/10387","id":1060941845,"node_id":"PR_kwDOApspmc4u5GsN","number":10387,"title":"fix(pkg/kube): statefulSetReady: handle partition cases correctly","user":{"login":"bhavin192","id":5154532,"node_id":"MDQ6VXNlcjUxNTQ1MzI=","avatar_url":"https://avatars.githubusercontent.com/u/5154532?v=4","gravatar_id":"","url":"https://api.github.com/users/bhavin192","html_url":"https://github.com/bhavin192","followers_url":"https://api.github.com/users/bhavin192/followers","following_url":"https://api.github.com/users/bhavin192/following{/other_user}","gists_url":"https://api.github.com/users/bhavin192/gists{/gist_id}","starred_url":"https://api.github.com/users/bhavin192/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhavin192/subscriptions","organizations_url":"https://api.github.com/users/bhavin192/orgs","repos_url":"https://api.github.com/users/bhavin192/repos","events_url":"https://api.github.com/users/bhavin192/events{/privacy}","received_events_url":"https://api.github.com/users/bhavin192/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":676174034,"node_id":"MDU6TGFiZWw2NzYxNzQwMzQ=","url":"https://api.github.com/repos/helm/helm/labels/size/S","name":"size/S","color":"77bb00","default":false,"description":"Denotes a PR that changes 10-29 lines, ignoring generated files."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/helm/helm/milestones/113","html_url":"https://github.com/helm/helm/milestone/113","labels_url":"https://api.github.com/repos/helm/helm/milestones/113/labels","id":7086562,"node_id":"MI_kwDOApspmc4AbCHi","number":113,"title":"3.8.0","description":"","creator":{"login":"bacongobbler","id":1360539,"node_id":"MDQ6VXNlcjEzNjA1Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1360539?v=4","gravatar_id":"","url":"https://api.github.com/users/bacongobbler","html_url":"https://github.com/bacongobbler","followers_url":"https://api.github.com/users/bacongobbler/followers","following_url":"https://api.github.com/users/bacongobbler/following{/other_user}","gists_url":"https://api.github.com/users/bacongobbler/gists{/gist_id}","starred_url":"https://api.github.com/users/bacongobbler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bacongobbler/subscriptions","organizations_url":"https://api.github.com/users/bacongobbler/orgs","repos_url":"https://api.github.com/users/bacongobbler/repos","events_url":"https://api.github.com/users/bacongobbler/events{/privacy}","received_events_url":"https://api.github.com/users/bacongobbler/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":41,"state":"closed","created_at":"2021-08-24T15:12:35Z","updated_at":"2022-01-25T14:03:38Z","due_on":"2022-01-19T08:00:00Z","closed_at":"2022-01-25T14:03:38Z"},"comments":1,"created_at":"2021-11-23T08:11:41Z","updated_at":"2021-11-26T17:56:12Z","closed_at":"2021-11-26T16:33:46Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":43723161,"node_id":"MDEwOlJlcG9zaXRvcnk0MzcyMzE2MQ==","name":"helm","full_name":"helm/helm","private":false,"owner":{"login":"helm","id":15859888,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE1ODU5ODg4","avatar_url":"https://avatars.githubusercontent.com/u/15859888?v=4","gravatar_id":"","url":"https://api.github.com/users/helm","html_url":"https://github.com/helm","followers_url":"https://api.github.com/users/helm/followers","following_url":"https://api.github.com/users/helm/following{/other_user}","gists_url":"https://api.github.com/users/helm/gists{/gist_id}","starred_url":"https://api.github.com/users/helm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/helm/subscriptions","organizations_url":"https://api.github.com/users/helm/orgs","repos_url":"https://api.github.com/users/helm/repos","events_url":"https://api.github.com/users/helm/events{/privacy}","received_events_url":"https://api.github.com/users/helm/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/helm/helm","description":"The Kubernetes Package Manager","fork":false,"url":"https://api.github.com/repos/helm/helm","forks_url":"https://api.github.com/repos/helm/helm/forks","keys_url":"https://api.github.com/repos/helm/helm/keys{/key_id}","collaborators_url":"https://api.github.com/repos/helm/helm/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/helm/helm/teams","hooks_url":"https://api.github.com/repos/helm/helm/hooks","issue_events_url":"https://api.github.com/repos/helm/helm/issues/events{/number}","events_url":"https://api.github.com/repos/helm/helm/events","assignees_url":"https://api.github.com/repos/helm/helm/assignees{/user}","branches_url":"https://api.github.com/repos/helm/helm/branches{/branch}","tags_url":"https://api.github.com/repos/helm/helm/tags","blobs_url":"https://api.github.com/repos/helm/helm/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/helm/helm/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/helm/helm/git/refs{/sha}","trees_url":"https://api.github.com/repos/helm/helm/git/trees{/sha}","statuses_url":"https://api.github.com/repos/helm/helm/statuses/{sha}","languages_url":"https://api.github.com/repos/helm/helm/languages","stargazers_url":"https://api.github.com/repos/helm/helm/stargazers","contributors_url":"https://api.github.com/repos/helm/helm/contributors","subscribers_url":"https://api.github.com/repos/helm/helm/subscribers","subscription_url":"https://api.github.com/repos/helm/helm/subscription","commits_url":"https://api.github.com/repos/helm/helm/commits{/sha}","git_commits_url":"https://api.github.com/repos/helm/helm/git/commits{/sha}","comments_url":"https://api.github.com/repos/helm/helm/comments{/number}","issue_comment_url":"https://api.github.com/repos/helm/helm/issues/comments{/number}","contents_url":"https://api.github.com/repos/helm/helm/contents/{+path}","compare_url":"https://api.github.com/repos/helm/helm/compare/{base}...{head}","merges_url":"https://api.github.com/repos/helm/helm/merges","archive_url":"https://api.github.com/repos/helm/helm/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/helm/helm/downloads","issues_url":"https://api.github.com/repos/helm/helm/issues{/number}","pulls_url":"https://api.github.com/repos/helm/helm/pulls{/number}","milestones_url":"https://api.github.com/repos/helm/helm/milestones{/number}","notifications_url":"https://api.github.com/repos/helm/helm/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/helm/helm/labels{/name}","releases_url":"https://api.github.com/repos/helm/helm/releases{/id}","deployments_url":"https://api.github.com/repos/helm/helm/deployments","created_at":"2015-10-06T01:07:32Z","updated_at":"2025-11-09T19:00:10Z","pushed_at":"2025-11-09T12:57:10Z","git_url":"git://github.com/helm/helm.git","ssh_url":"git@github.com:helm/helm.git","clone_url":"https://github.com/helm/helm.git","svn_url":"https://github.com/helm/helm","homepage":"https://helm.sh","size":25851,"stargazers_count":28930,"watchers_count":28930,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":7393,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":448,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":true,"topics":["chart","charts","cncf","helm","kubernetes"],"visibility":"public","forks":7393,"open_issues":448,"watchers":28930,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/helm/helm/pulls/10387","html_url":"https://github.com/helm/helm/pull/10387","diff_url":"https://github.com/helm/helm/pull/10387.diff","patch_url":"https://github.com/helm/helm/pull/10387.patch","merged_at":"2021-11-26T16:33:46Z"},"body":"**What this PR does / why we need it**:\r\nThe partition value can be greater than number of replicas, in that case no pods are rolled out. The expectedReplicas becomes a negative number. https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/#partitions\r\n\r\nIn the cases where the update does not change anything in the pod template, the updatedReplicas value from StatefulSet status remains unchanged. Such updates can still set some partition value, and UpdatedReplicas is always greater than expectedReplicas. Basically, the StatefulSet is ready / rolled-out.\r\n\r\nIn both the above scenarios, providing `--wait` flag causes it to timeout waiting indefinitely. Because updatedReplicas can never be negative, or be equal to the expectedReplicas for the second case.\r\n\r\nThis commit handles both the above scenarios by checking if UpdatedReplicas is smaller than expectedReplicas. If it is, then the StatefulSet is not ready yet.\r\n\r\n**Special notes for your reviewer**:\r\nI have done the following manual testing for this change, in all the cases the update succeeds as expected, and the wait flag waits till the pods are rolled-out.\r\n\r\n1. Download and install a chart where partitioning + StatefulSets are used.  \r\n   Partition: 0, Replicas: 3\r\n\r\n   <details>\r\n   <summary>Commands</summary>\r\n   <pre>\r\n   curl -O https://charts.yugabyte.com/yugabyte-2.11.0.tgz\r\n   ~/src/helm/bin/helm install yb ./yugabyte-2.11.0.tgz \\\r\n     --namespace helm-test --create-namespace \\\r\n     --set resource.master.requests.cpu=0.25 \\\r\n     --set resource.master.requests.memory=0.35Gi \\\r\n     --set resource.tserver.requests.cpu=0.25 \\\r\n     --set resource.tserver.requests.memory=0.35Gi \\\r\n     --set storage.ephemeral=true \\\r\n     --wait\r\n   </pre>\r\n   </details>\r\n\r\n2. Do a partitioned update where there is a change in the template.  \r\n   expectedReplicas: 2, updatedReplicas: 2, partition: 1\r\n\r\n   <details>\r\n   <summary>Commands</summary>\r\n   <pre>\r\n   ~/src/helm/bin/helm upgrade yb ./yugabyte-2.11.0.tgz \\\r\n     --namespace helm-test --create-namespace \\\r\n     --set resource.master.requests.cpu=0.25 \\\r\n     --set resource.master.requests.memory=0.35Gi \\\r\n     --set resource.tserver.requests.cpu=0.25 \\\r\n     --set resource.tserver.requests.memory=0.35Gi \\\r\n     --set storage.ephemeral=true \\\r\n     --set gflags.master.default_memory_limit_to_ram_ratio=0.87 \\\r\n     --set partition.master=1 \\\r\n     --wait\r\n   </pre>\r\n   </details>\r\n\r\n3. Complete the partitioned update. (All three replicas are updated)  \r\n   expectedReplicas: 1, updatedReplicas: 1, partition: 0\r\n\r\n   <details>\r\n   <summary>Commands</summary>\r\n   <pre>\r\n   ~/src/helm/bin/helm upgrade yb ./yugabyte-2.11.0.tgz \\\r\n     --namespace helm-test --create-namespace \\\r\n     --set resource.master.requests.cpu=0.25 \\\r\n     --set resource.master.requests.memory=0.35Gi \\\r\n     --set resource.tserver.requests.cpu=0.25 \\\r\n     --set resource.tserver.requests.memory=0.35Gi \\\r\n     --set storage.ephemeral=true \\\r\n     --set gflags.master.default_memory_limit_to_ram_ratio=0.87 \\\r\n     --set partition.master=0 \\\r\n     --wait\r\n   </pre>\r\n   </details>\r\n\r\n4. Do a no-op update with partition value.  \r\n   expectedReplicas: 2, updatedReplicas: 3 (because nothing has changed), partition: 1\r\n\r\n   <details>\r\n   <summary>Commands</summary>\r\n   <pre>\r\n   ~/src/helm/bin/helm upgrade yb ./yugabyte-2.11.0.tgz \\\r\n     --namespace helm-test --create-namespace \\\r\n     --set resource.master.requests.cpu=0.25 \\\r\n     --set resource.master.requests.memory=0.35Gi \\\r\n     --set resource.tserver.requests.cpu=0.25 \\\r\n     --set resource.tserver.requests.memory=0.35Gi \\\r\n     --set storage.ephemeral=true \\\r\n     --set gflags.master.default_memory_limit_to_ram_ratio=0.87 \\\r\n     --set partition.master=1 \\\r\n     --wait\r\n   </pre>\r\n   </details>\r\n\r\n5. Change in the pod template with partition value greater than replicas.  \r\n   expectedReplicas: -2, updatedReplicas: 3 (no pods will change), partition: 5\r\n\r\n   <details>\r\n   <summary>Commands</summary>\r\n   <pre>\r\n   ~/src/helm/bin/helm upgrade yb ./yugabyte-2.11.0.tgz \\\r\n     --namespace helm-test --create-namespace \\\r\n     --set resource.master.requests.cpu=0.25 \\\r\n     --set resource.master.requests.memory=0.35Gi \\\r\n     --set resource.tserver.requests.cpu=0.25 \\\r\n     --set resource.tserver.requests.memory=0.35Gi \\\r\n     --set storage.ephemeral=true \\\r\n     --set gflags.master.default_memory_limit_to_ram_ratio=0.85 \\\r\n     --set partition.master=5 \\\r\n     --wait\r\n   </pre>\r\n   </details>\r\n\r\n**If applicable**:\r\n- [ ] this PR contains documentation\r\n- [x] this PR contains unit tests\r\n- [x] this PR has been tested for backwards compatibility\r\n\r\nBased on the code from kubectl rollout:\r\nhttps://github.com/kubernetes/kubectl/blob/a450ebd59c1e8917df23d37c6f05d8e16c3746aa/pkg/polymorphichelpers/rollout_status.go#L138-L141\r\n\r\nCloses #8674","reactions":{"url":"https://api.github.com/repos/helm/helm/issues/10387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/helm/helm/issues/10387/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":5677853168,"node_id":"REFE_lADOApspmc4pEin0zwAAAAFSbSnw","url":"https://api.github.com/repos/helm/helm/issues/events/5677853168","actor":{"login":"bhavin192","id":5154532,"node_id":"MDQ6VXNlcjUxNTQ1MzI=","avatar_url":"https://avatars.githubusercontent.com/u/5154532?v=4","gravatar_id":"","url":"https://api.github.com/users/bhavin192","html_url":"https://github.com/bhavin192","followers_url":"https://api.github.com/users/bhavin192/followers","following_url":"https://api.github.com/users/bhavin192/following{/other_user}","gists_url":"https://api.github.com/users/bhavin192/gists{/gist_id}","starred_url":"https://api.github.com/users/bhavin192/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhavin192/subscriptions","organizations_url":"https://api.github.com/users/bhavin192/orgs","repos_url":"https://api.github.com/users/bhavin192/repos","events_url":"https://api.github.com/users/bhavin192/events{/privacy}","received_events_url":"https://api.github.com/users/bhavin192/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"c3310bb72496e97237008f5f9fafa52f5d7d69a9","commit_url":"https://api.github.com/repos/bhavin192/helm/commits/c3310bb72496e97237008f5f9fafa52f5d7d69a9","created_at":"2021-11-26T14:01:20Z","performed_via_github_app":null},{"id":8315983500,"node_id":"REFE_lADOApspmc4pEin0zwAAAAHvq9aM","url":"https://api.github.com/repos/helm/helm/issues/events/8315983500","actor":{"login":"zak905","id":6265563,"node_id":"MDQ6VXNlcjYyNjU1NjM=","avatar_url":"https://avatars.githubusercontent.com/u/6265563?v=4","gravatar_id":"","url":"https://api.github.com/users/zak905","html_url":"https://github.com/zak905","followers_url":"https://api.github.com/users/zak905/followers","following_url":"https://api.github.com/users/zak905/following{/other_user}","gists_url":"https://api.github.com/users/zak905/gists{/gist_id}","starred_url":"https://api.github.com/users/zak905/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zak905/subscriptions","organizations_url":"https://api.github.com/users/zak905/orgs","repos_url":"https://api.github.com/users/zak905/repos","events_url":"https://api.github.com/users/zak905/events{/privacy}","received_events_url":"https://api.github.com/users/zak905/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"9f4a8f27692ab7d84a997a17748e51d4e69a0607","commit_url":"https://api.github.com/repos/zak905/helm/commits/9f4a8f27692ab7d84a997a17748e51d4e69a0607","created_at":"2023-01-19T20:38:55Z","performed_via_github_app":null}]