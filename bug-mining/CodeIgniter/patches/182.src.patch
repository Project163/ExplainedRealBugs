diff --git a/tests/codeigniter/libraries/Encrypt_test.php b/tests/codeigniter/libraries/Encrypt_test.php
index 998d806b3..21ac85f03 100644
--- a/tests/codeigniter/libraries/Encrypt_test.php
+++ b/tests/codeigniter/libraries/Encrypt_test.php
@@ -9,6 +9,7 @@ class Encrypt_test extends CI_TestCase {
 
 		$this->ci_set_config('encryption_key', "Encryptin'glike@boss!");
 		$this->msg = 'My secret message';
+		$this->mcrypt = extension_loaded('mcrypt');
 	}
 
 	// --------------------------------------------------------------------
@@ -39,6 +40,12 @@ class Encrypt_test extends CI_TestCase {
 
 	public function test_default_cipher()
 	{
+		if ( ! $this->mcrypt)
+		{
+			$this->markTestSkipped('MCrypt not available');
+			return;
+		}
+
 		$this->assertEquals('rijndael-256', $this->encrypt->get_cipher());
 	}
 
@@ -47,6 +54,12 @@ class Encrypt_test extends CI_TestCase {
 
 	public function test_set_cipher()
 	{
+		if ( ! $this->mcrypt)
+		{
+			$this->markTestSkipped('MCrypt not available');
+			return;
+		}
+
 		$this->encrypt->set_cipher(MCRYPT_BLOWFISH);
 		$this->assertEquals('blowfish', $this->encrypt->get_cipher());
 	}
@@ -55,6 +68,12 @@ class Encrypt_test extends CI_TestCase {
 
 	public function test_default_mode()
 	{
+		if ( ! $this->mcrypt)
+		{
+			$this->markTestSkipped('MCrypt not available');
+			return;
+		}
+
 		$this->assertEquals('cbc', $this->encrypt->get_mode());
 	}
 
@@ -62,6 +81,12 @@ class Encrypt_test extends CI_TestCase {
 
 	public function test_set_mode()
 	{
+		if ( ! $this->mcrypt)
+		{
+			$this->markTestSkipped('MCrypt not available');
+			return;
+		}
+
 		$this->encrypt->set_mode(MCRYPT_MODE_CFB);
 		$this->assertEquals('cfb', $this->encrypt->get_mode());
 	}
