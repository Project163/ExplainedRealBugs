diff --git a/system/libraries/Email.php b/system/libraries/Email.php
index 6e28989cb..f115d9f40 100644
--- a/system/libraries/Email.php
+++ b/system/libraries/Email.php
@@ -1014,7 +1014,7 @@ class CI_Email {
 	 */
 	public function valid_email($email)
 	{
-		if (function_exists('idn_to_ascii') && strpos($email, '@'))
+		if (function_exists('idn_to_ascii') && $atpos = strpos($email, '@'))
 		{
 			$email = self::substr($email, 0, ++$atpos).idn_to_ascii(self::substr($email, $atpos), 0, INTL_IDNA_VARIANT_UTS46);
 		}
@@ -1821,7 +1821,7 @@ class CI_Email {
 	 */
 	protected function _validate_email_for_shell(&$email)
 	{
-		if (function_exists('idn_to_ascii') && strpos($email, '@'))
+		if (function_exists('idn_to_ascii') && $atpos = strpos($email, '@'))
 		{
 			$email = self::substr($email, 0, ++$atpos).idn_to_ascii(self::substr($email, $atpos), 0, INTL_IDNA_VARIANT_UTS46);
 		}
