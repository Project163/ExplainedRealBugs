[{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/168056981","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/4337#issuecomment-168056981","issue_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/4337","id":168056981,"node_id":"MDEyOklzc3VlQ29tbWVudDE2ODA1Njk4MQ==","user":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-12-30T19:05:20Z","updated_at":"2015-12-30T19:05:20Z","body":"Are you reporting this based on just browsing through the _system/database/DB_driver.php_ code? Our PostgreSQL drivers in particular override that method.\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/168056981/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/168412455","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/4337#issuecomment-168412455","issue_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/4337","id":168412455,"node_id":"MDEyOklzc3VlQ29tbWVudDE2ODQxMjQ1NQ==","user":{"login":"bdamian","id":4106995,"node_id":"MDQ6VXNlcjQxMDY5OTU=","avatar_url":"https://avatars.githubusercontent.com/u/4106995?v=4","gravatar_id":"","url":"https://api.github.com/users/bdamian","html_url":"https://github.com/bdamian","followers_url":"https://api.github.com/users/bdamian/followers","following_url":"https://api.github.com/users/bdamian/following{/other_user}","gists_url":"https://api.github.com/users/bdamian/gists{/gist_id}","starred_url":"https://api.github.com/users/bdamian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdamian/subscriptions","organizations_url":"https://api.github.com/users/bdamian/orgs","repos_url":"https://api.github.com/users/bdamian/repos","events_url":"https://api.github.com/users/bdamian/events{/privacy}","received_events_url":"https://api.github.com/users/bdamian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2016-01-02T17:57:27Z","updated_at":"2016-01-02T17:57:27Z","body":"I know that driver overloads this method. It checks if the query is \"write type\" (btw. the regex in postgresql  driver is too complicated, check for `returning` word here is unnecessary).\nThe `query` code assumes that it may be only write or read type. And this causes problem. Such sql is both read and write and the code:\n\n```\nelseif ( ! is_bool($return_object))\n{\n    $return_object = ! $this->is_write_type($sql);\n}\n```\n\ndoesn't work properly. There is assumption **query is write type ⇔ query is not read type**.\nI think there should be similar call – `is_read_type`. We have 3 cases and we can't use bool to handle it.\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/168412455/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bdamian","id":4106995,"node_id":"MDQ6VXNlcjQxMDY5OTU=","avatar_url":"https://avatars.githubusercontent.com/u/4106995?v=4","gravatar_id":"","url":"https://api.github.com/users/bdamian","html_url":"https://github.com/bdamian","followers_url":"https://api.github.com/users/bdamian/followers","following_url":"https://api.github.com/users/bdamian/following{/other_user}","gists_url":"https://api.github.com/users/bdamian/gists{/gist_id}","starred_url":"https://api.github.com/users/bdamian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdamian/subscriptions","organizations_url":"https://api.github.com/users/bdamian/orgs","repos_url":"https://api.github.com/users/bdamian/repos","events_url":"https://api.github.com/users/bdamian/events{/privacy}","received_events_url":"https://api.github.com/users/bdamian/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/168424017","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/4337#issuecomment-168424017","issue_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/4337","id":168424017,"node_id":"MDEyOklzc3VlQ29tbWVudDE2ODQyNDAxNw==","user":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2016-01-02T20:02:53Z","updated_at":"2016-01-02T20:02:53Z","body":"You say it causes a problem and that it doesn't work properly, but you're not saying what that problem is ...\n\nWith that condition, `query()` only cares whether to return a result object or not and since there's a huge amount of \"read type\" queries, it takes a black-list approach instead. The method name may be a misnomer to an extent, but it works.\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/168424017/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/168426900","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/4337#issuecomment-168426900","issue_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/4337","id":168426900,"node_id":"MDEyOklzc3VlQ29tbWVudDE2ODQyNjkwMA==","user":{"login":"bdamian","id":4106995,"node_id":"MDQ6VXNlcjQxMDY5OTU=","avatar_url":"https://avatars.githubusercontent.com/u/4106995?v=4","gravatar_id":"","url":"https://api.github.com/users/bdamian","html_url":"https://github.com/bdamian","followers_url":"https://api.github.com/users/bdamian/followers","following_url":"https://api.github.com/users/bdamian/following{/other_user}","gists_url":"https://api.github.com/users/bdamian/gists{/gist_id}","starred_url":"https://api.github.com/users/bdamian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdamian/subscriptions","organizations_url":"https://api.github.com/users/bdamian/orgs","repos_url":"https://api.github.com/users/bdamian/repos","events_url":"https://api.github.com/users/bdamian/events{/privacy}","received_events_url":"https://api.github.com/users/bdamian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2016-01-02T20:42:33Z","updated_at":"2016-01-02T20:43:22Z","body":"Please read the sentence\n\n> The `query` code assumes that it may be only write or read type.\n\ncarefully. The problem is in the code I pasted. It should be like this:\n\n```\nelseif ( ! is_bool($return_object))\n{\n-    $return_object = ! $this->is_write_type($sql);\n+    $return_object = $this->is_read_type($sql);\n}\n```\n\nThere should be check if `$sql` contains read query, not if is not write query.\n\nIf you want to check if the problem occurs, test the code like this:\n\n```\n$q = 'insert into table1 values (1, 2, 3, 4) returning *;'\n$res = $this->db->query($q);\n$data = $res->result();\n```\n\nusing postgres.\nQuery written above returns data `1 | 2 | 3 | 4`, but in second line you get an error, because `$res` is boolean, not an object. It is caused wrong read type query detection, I mentioned above.\n**query is write type ⇔ query is not read type** sums up problem briefly.\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/168426900/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bdamian","id":4106995,"node_id":"MDQ6VXNlcjQxMDY5OTU=","avatar_url":"https://avatars.githubusercontent.com/u/4106995?v=4","gravatar_id":"","url":"https://api.github.com/users/bdamian","html_url":"https://github.com/bdamian","followers_url":"https://api.github.com/users/bdamian/followers","following_url":"https://api.github.com/users/bdamian/following{/other_user}","gists_url":"https://api.github.com/users/bdamian/gists{/gist_id}","starred_url":"https://api.github.com/users/bdamian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdamian/subscriptions","organizations_url":"https://api.github.com/users/bdamian/orgs","repos_url":"https://api.github.com/users/bdamian/repos","events_url":"https://api.github.com/users/bdamian/events{/privacy}","received_events_url":"https://api.github.com/users/bdamian/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/168429672","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/4337#issuecomment-168429672","issue_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/4337","id":168429672,"node_id":"MDEyOklzc3VlQ29tbWVudDE2ODQyOTY3Mg==","user":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2016-01-02T21:33:18Z","updated_at":"2016-01-02T21:34:10Z","body":"I find it a bit insulting that you're trying to convince me with bold text that \"write type\" doesn't mean \"not read type\" ... I do understand what you're staying.\n\nIf the test code you're giving doesn't work, that means the regular expression you said is too complicated doesn't work. The \"returning\" part in there isn't unnecessary - it exists _precisely_ to work around this issue.\nPerhaps it's not ideal, and that is why I said the method name may be a misnomer in that context, but an `is_read_type()` method wouldn't be any better simply because we can't possibly catch all SQL commands that return data - too many dialects with too many custom additions; bug reports about \"FOO BAR\" not returning a result set would be countless.\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/168429672/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":507017386,"node_id":"MDEyOkxhYmVsZWRFdmVudDUwNzAxNzM4Ng==","url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/events/507017386","actor":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2016-01-06T12:51:42Z","label":{"name":"Bug","color":"eb2420"},"performed_via_github_app":null},{"id":507017403,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDUwNzAxNzQwMw==","url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/events/507017403","actor":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2016-01-06T12:51:43Z","milestone":{"title":"3.0.4"},"performed_via_github_app":null},{"id":507017550,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDUwNzAxNzU1MA==","url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/events/507017550","actor":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"0ca9ae6ca109177eb0e80456b097a9d63412517e","commit_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/commits/0ca9ae6ca109177eb0e80456b097a9d63412517e","created_at":"2016-01-06T12:51:55Z","performed_via_github_app":null},{"id":507017619,"node_id":"MDExOkNsb3NlZEV2ZW50NTA3MDE3NjE5","url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/events/507017619","actor":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2016-01-06T12:52:01Z","state_reason":null,"performed_via_github_app":null}]