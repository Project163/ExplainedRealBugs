{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/4583","repository_url":"https://api.github.com/repos/bcit-ci/CodeIgniter","labels_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/4583/labels{/name}","comments_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/4583/comments","events_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/4583/events","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/4583","id":148823215,"node_id":"MDU6SXNzdWUxNDg4MjMyMTU=","number":4583,"title":"Attachments are not displayed on iOS stock Email client","user":{"login":"rangyal","id":236228,"node_id":"MDQ6VXNlcjIzNjIyOA==","avatar_url":"https://avatars.githubusercontent.com/u/236228?v=4","gravatar_id":"","url":"https://api.github.com/users/rangyal","html_url":"https://github.com/rangyal","followers_url":"https://api.github.com/users/rangyal/followers","following_url":"https://api.github.com/users/rangyal/following{/other_user}","gists_url":"https://api.github.com/users/rangyal/gists{/gist_id}","starred_url":"https://api.github.com/users/rangyal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rangyal/subscriptions","organizations_url":"https://api.github.com/users/rangyal/orgs","repos_url":"https://api.github.com/users/rangyal/repos","events_url":"https://api.github.com/users/rangyal/events{/privacy}","received_events_url":"https://api.github.com/users/rangyal/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":140924,"node_id":"MDU6TGFiZWwxNDA5MjQ=","url":"https://api.github.com/repos/bcit-ci/CodeIgniter/labels/Bug","name":"Bug","color":"eb2420","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/milestones/11","html_url":"https://github.com/bcit-ci/CodeIgniter/milestone/11","labels_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/milestones/11/labels","id":1677677,"node_id":"MDk6TWlsZXN0b25lMTY3NzY3Nw==","number":11,"title":"3.1.0","description":"","creator":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":25,"state":"closed","created_at":"2016-04-01T09:05:49Z","updated_at":"2016-11-03T14:26:52Z","due_on":"2016-07-25T07:00:00Z","closed_at":"2016-07-26T17:54:06Z"},"comments":3,"created_at":"2016-04-16T06:32:56Z","updated_at":"2016-06-06T06:50:50Z","closed_at":"2016-06-06T06:45:42Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### The issue happens in the following scenario\n1. Construct an HTML email\n2. Attach image(s) to the email\n3. Make image(s) attached in the previous step to be shown as the part of the email's body (for example a logo on the top)\n4. Add other attachments, which are not intended to be shown as a part of the email's body. (for example report in pdf format)\n### The Result\n\nInline images are displayed correctly, but attachments added in step#4 are hidden in iOS's email client.\n### The Problem with the current implementation\n\nTo make an attachment to be shown inline in the email body, the following code is needed:\n\n``` php\n$filename = 'images/inline_image.png';\n$this->email->attach($filename);\n$cid = $this->email->attachment_cid($filename);\n// $cid is used in the html\n// as the value of an src attribute of an <image> tag for example\n```\n\nIt goes wrong when `attachment_cid` function is called, because it sets the root multipart to related.\nThe structure of the message will be the following:\n\n```\nmultipart/related\n  inline_image.png\n  report1.pdf\n  report2.pdf\n  ...\n```\n\nAccording to https://tools.ietf.org/html/rfc2387 the `multipart/related` is \n\n> used to indicate that each message part is a component of an aggregate whole. It is for compound objects consisting of several inter-related components - **proper display cannot be achieved by individually displaying the constituent parts**.\n\n (source: https://en.wikipedia.org/wiki/MIME)\n\nAs all of the attachments will be the direct child of `multipart/related`, even the \"normal\" attachments won't be displayed by the stricter email clients (for example iOS's stock email client).\n","closed_by":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/4583/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/4583/timeline","performed_via_github_app":null,"state_reason":"completed"}