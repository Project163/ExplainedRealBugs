[{"id":2564526,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI1NjQ1MjY=","url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/events/2564526","actor":{"login":"bitbucket-import","id":991171,"node_id":"MDQ6VXNlcjk5MTE3MQ==","avatar_url":"https://avatars.githubusercontent.com/u/991171?v=4","gravatar_id":"","url":"https://api.github.com/users/bitbucket-import","html_url":"https://github.com/bitbucket-import","followers_url":"https://api.github.com/users/bitbucket-import/followers","following_url":"https://api.github.com/users/bitbucket-import/following{/other_user}","gists_url":"https://api.github.com/users/bitbucket-import/gists{/gist_id}","starred_url":"https://api.github.com/users/bitbucket-import/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitbucket-import/subscriptions","organizations_url":"https://api.github.com/users/bitbucket-import/orgs","repos_url":"https://api.github.com/users/bitbucket-import/repos","events_url":"https://api.github.com/users/bitbucket-import/events{/privacy}","received_events_url":"https://api.github.com/users/bitbucket-import/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2011-08-19T14:46:09Z","performed_via_github_app":null},{"id":2566165,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI1NjYxNjU=","url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/events/2566165","actor":{"login":"derekjones","id":763613,"node_id":"MDQ6VXNlcjc2MzYxMw==","avatar_url":"https://avatars.githubusercontent.com/u/763613?v=4","gravatar_id":"","url":"https://api.github.com/users/derekjones","html_url":"https://github.com/derekjones","followers_url":"https://api.github.com/users/derekjones/followers","following_url":"https://api.github.com/users/derekjones/following{/other_user}","gists_url":"https://api.github.com/users/derekjones/gists{/gist_id}","starred_url":"https://api.github.com/users/derekjones/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/derekjones/subscriptions","organizations_url":"https://api.github.com/users/derekjones/orgs","repos_url":"https://api.github.com/users/derekjones/repos","events_url":"https://api.github.com/users/derekjones/events{/privacy}","received_events_url":"https://api.github.com/users/derekjones/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"6cf190dcd68432a5bcea91bfc10a38b3f56e7f46","commit_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/commits/6cf190dcd68432a5bcea91bfc10a38b3f56e7f46","created_at":"2011-08-19T15:06:46Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/4221497","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/42#issuecomment-4221497","issue_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/42","id":4221497,"node_id":"MDEyOklzc3VlQ29tbWVudDQyMjE0OTc=","user":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2012-02-28T18:00:53Z","updated_at":"2012-02-28T18:00:53Z","body":"How does that make it wrong?\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/4221497/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":10388950,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDEwMzg4OTUw","url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/events/10388950","actor":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2012-02-28T18:00:53Z","performed_via_github_app":null},{"id":14260198,"node_id":"MDExOkNsb3NlZEV2ZW50MTQyNjAxOTg=","url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/events/14260198","actor":{"login":"philsturgeon","id":67381,"node_id":"MDQ6VXNlcjY3Mzgx","avatar_url":"https://avatars.githubusercontent.com/u/67381?v=4","gravatar_id":"","url":"https://api.github.com/users/philsturgeon","html_url":"https://github.com/philsturgeon","followers_url":"https://api.github.com/users/philsturgeon/followers","following_url":"https://api.github.com/users/philsturgeon/following{/other_user}","gists_url":"https://api.github.com/users/philsturgeon/gists{/gist_id}","starred_url":"https://api.github.com/users/philsturgeon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philsturgeon/subscriptions","organizations_url":"https://api.github.com/users/philsturgeon/orgs","repos_url":"https://api.github.com/users/philsturgeon/repos","events_url":"https://api.github.com/users/philsturgeon/events{/privacy}","received_events_url":"https://api.github.com/users/philsturgeon/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2012-04-26T20:17:50Z","state_reason":null,"performed_via_github_app":null},{"id":14260199,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE0MjYwMTk5","url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/events/14260199","actor":{"login":"philsturgeon","id":67381,"node_id":"MDQ6VXNlcjY3Mzgx","avatar_url":"https://avatars.githubusercontent.com/u/67381?v=4","gravatar_id":"","url":"https://api.github.com/users/philsturgeon","html_url":"https://github.com/philsturgeon","followers_url":"https://api.github.com/users/philsturgeon/followers","following_url":"https://api.github.com/users/philsturgeon/following{/other_user}","gists_url":"https://api.github.com/users/philsturgeon/gists{/gist_id}","starred_url":"https://api.github.com/users/philsturgeon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philsturgeon/subscriptions","organizations_url":"https://api.github.com/users/philsturgeon/orgs","repos_url":"https://api.github.com/users/philsturgeon/repos","events_url":"https://api.github.com/users/philsturgeon/events{/privacy}","received_events_url":"https://api.github.com/users/philsturgeon/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2012-04-26T20:17:50Z","performed_via_github_app":null},{"actor":{"login":"ajslaghu","id":1861790,"node_id":"MDQ6VXNlcjE4NjE3OTA=","avatar_url":"https://avatars.githubusercontent.com/u/1861790?v=4","gravatar_id":"","url":"https://api.github.com/users/ajslaghu","html_url":"https://github.com/ajslaghu","followers_url":"https://api.github.com/users/ajslaghu/followers","following_url":"https://api.github.com/users/ajslaghu/following{/other_user}","gists_url":"https://api.github.com/users/ajslaghu/gists{/gist_id}","starred_url":"https://api.github.com/users/ajslaghu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajslaghu/subscriptions","organizations_url":"https://api.github.com/users/ajslaghu/orgs","repos_url":"https://api.github.com/users/ajslaghu/repos","events_url":"https://api.github.com/users/ajslaghu/events{/privacy}","received_events_url":"https://api.github.com/users/ajslaghu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2013-02-27T10:51:47Z","updated_at":"2013-03-10T10:23:22Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/2278","repository_url":"https://api.github.com/repos/bcit-ci/CodeIgniter","labels_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/2278/labels{/name}","comments_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/2278/comments","events_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/2278/events","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/2278","id":11332089,"node_id":"MDU6SXNzdWUxMTMzMjA4OQ==","number":2278,"title":"Can not load numerical field names from Database","user":{"login":"ajslaghu","id":1861790,"node_id":"MDQ6VXNlcjE4NjE3OTA=","avatar_url":"https://avatars.githubusercontent.com/u/1861790?v=4","gravatar_id":"","url":"https://api.github.com/users/ajslaghu","html_url":"https://github.com/ajslaghu","followers_url":"https://api.github.com/users/ajslaghu/followers","following_url":"https://api.github.com/users/ajslaghu/following{/other_user}","gists_url":"https://api.github.com/users/ajslaghu/gists{/gist_id}","starred_url":"https://api.github.com/users/ajslaghu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajslaghu/subscriptions","organizations_url":"https://api.github.com/users/ajslaghu/orgs","repos_url":"https://api.github.com/users/ajslaghu/repos","events_url":"https://api.github.com/users/ajslaghu/events{/privacy}","received_events_url":"https://api.github.com/users/ajslaghu/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2013-02-24T09:44:20Z","updated_at":"2014-07-14T06:59:44Z","closed_at":"2013-02-27T11:03:26Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":2234102,"node_id":"MDEwOlJlcG9zaXRvcnkyMjM0MTAy","name":"CodeIgniter","full_name":"bcit-ci/CodeIgniter","private":false,"owner":{"login":"bcit-ci","id":8863432,"node_id":"MDEyOk9yZ2FuaXphdGlvbjg4NjM0MzI=","avatar_url":"https://avatars.githubusercontent.com/u/8863432?v=4","gravatar_id":"","url":"https://api.github.com/users/bcit-ci","html_url":"https://github.com/bcit-ci","followers_url":"https://api.github.com/users/bcit-ci/followers","following_url":"https://api.github.com/users/bcit-ci/following{/other_user}","gists_url":"https://api.github.com/users/bcit-ci/gists{/gist_id}","starred_url":"https://api.github.com/users/bcit-ci/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bcit-ci/subscriptions","organizations_url":"https://api.github.com/users/bcit-ci/orgs","repos_url":"https://api.github.com/users/bcit-ci/repos","events_url":"https://api.github.com/users/bcit-ci/events{/privacy}","received_events_url":"https://api.github.com/users/bcit-ci/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/bcit-ci/CodeIgniter","description":"Open Source PHP Framework (originally from EllisLab)","fork":false,"url":"https://api.github.com/repos/bcit-ci/CodeIgniter","forks_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/forks","keys_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/keys{/key_id}","collaborators_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/teams","hooks_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/hooks","issue_events_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/events{/number}","events_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/events","assignees_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/assignees{/user}","branches_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/branches{/branch}","tags_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/tags","blobs_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/git/refs{/sha}","trees_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/git/trees{/sha}","statuses_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/statuses/{sha}","languages_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/languages","stargazers_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/stargazers","contributors_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/contributors","subscribers_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/subscribers","subscription_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/subscription","commits_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/commits{/sha}","git_commits_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/git/commits{/sha}","comments_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/comments{/number}","issue_comment_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments{/number}","contents_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/contents/{+path}","compare_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/compare/{base}...{head}","merges_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/merges","archive_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/downloads","issues_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues{/number}","pulls_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/pulls{/number}","milestones_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/milestones{/number}","notifications_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/labels{/name}","releases_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/releases{/id}","deployments_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/deployments","created_at":"2011-08-19T13:34:00Z","updated_at":"2025-11-10T12:47:16Z","pushed_at":"2024-07-15T07:39:54Z","git_url":"git://github.com/bcit-ci/CodeIgniter.git","ssh_url":"git@github.com:bcit-ci/CodeIgniter.git","clone_url":"https://github.com/bcit-ci/CodeIgniter.git","svn_url":"https://github.com/bcit-ci/CodeIgniter","homepage":"https://codeigniter.com/","size":54780,"stargazers_count":18235,"watchers_count":18235,"language":"PHP","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":7636,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":105,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["php","php-framework","php7","php8"],"visibility":"public","forks":7636,"open_issues":105,"watchers":18235,"default_branch":"develop","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"I have piece of code that pulls weekyears as columnnames from the database.\n\nHowever, using numerical values does not give those colums back in the results. Perpending the numerical value with a letter , does return the correct results.\n\nNot working code:\n\nSELECT `Merk`, `201302` AS 201302, `201303` AS 201303, `201304` AS 201304, `201305` AS 201305, `201302` + `201303` + `201304` + `201305` AS som FROM (`stats_nebuys_eek_merk`) WHERE `201302` + `201303` + `201304` + `201305` > 100 ORDER BY `201302` + `201303` + `201304` + `201305` DESC LIMIT 15\n\nWorking:\nSELECT `Merk`, `201302` AS W201302, `201303` AS W201303, `201304` AS W201304, `201305` AS W201305, `201302` + `201303` + `201304` + `201305` AS som FROM (`stats_newbuys_week_merk`) WHERE `201302` + `201303` + `201304` + `201305` > 100 ORDER BY `201302` + `201303` + `201304` + `201305` DESC LIMIT 15\n\nI use $this->db->query($sql); for inserting those queries.\n","reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/2278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/2278/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"id":84163020,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDg0MTYzMDIw","url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/events/84163020","actor":{"login":"sviande","id":1902504,"node_id":"MDQ6VXNlcjE5MDI1MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/1902504?v=4","gravatar_id":"","url":"https://api.github.com/users/sviande","html_url":"https://github.com/sviande","followers_url":"https://api.github.com/users/sviande/followers","following_url":"https://api.github.com/users/sviande/following{/other_user}","gists_url":"https://api.github.com/users/sviande/gists{/gist_id}","starred_url":"https://api.github.com/users/sviande/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sviande/subscriptions","organizations_url":"https://api.github.com/users/sviande/orgs","repos_url":"https://api.github.com/users/sviande/repos","events_url":"https://api.github.com/users/sviande/events{/privacy}","received_events_url":"https://api.github.com/users/sviande/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"9f59f99affa4571264fcb340c5790be03bf06a84","commit_url":"https://api.github.com/repos/sviande/CodeIgniter/commits/9f59f99affa4571264fcb340c5790be03bf06a84","created_at":"2014-01-03T18:51:19Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/178818379","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/42#issuecomment-178818379","issue_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/42","id":178818379,"node_id":"MDEyOklzc3VlQ29tbWVudDE3ODgxODM3OQ==","user":{"login":"bgeisel1","id":5971213,"node_id":"MDQ6VXNlcjU5NzEyMTM=","avatar_url":"https://avatars.githubusercontent.com/u/5971213?v=4","gravatar_id":"","url":"https://api.github.com/users/bgeisel1","html_url":"https://github.com/bgeisel1","followers_url":"https://api.github.com/users/bgeisel1/followers","following_url":"https://api.github.com/users/bgeisel1/following{/other_user}","gists_url":"https://api.github.com/users/bgeisel1/gists{/gist_id}","starred_url":"https://api.github.com/users/bgeisel1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bgeisel1/subscriptions","organizations_url":"https://api.github.com/users/bgeisel1/orgs","repos_url":"https://api.github.com/users/bgeisel1/repos","events_url":"https://api.github.com/users/bgeisel1/events{/privacy}","received_events_url":"https://api.github.com/users/bgeisel1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2016-02-02T21:04:48Z","updated_at":"2016-02-02T21:04:48Z","body":"We just ran into the same issue as bitbucket-import. The reason this is \"wrong\" is two-fold:\n1. Calling insert_batch() invalidates the last_insert_id, which is unexpected by anyone who didn't read the insert_batch() code. \n2. Calling insert_batch() does not maintain isolation integrity of systems that implement an isolation solution for multiple insert (such that all inserts are guaranteed to be all-or-nothing and sequential without a race condition from an external writer).\n\nIn the case of MySQL at least, last_insert_id is guaranteed to point to the first item inserted in an autoincrement table. That guarantee is lost if you're using Codeigniter's insert_batch. What's worse, is if you need the value of the first insert there is now no safe way to obtain that information, it is lost forever.\n\nI didn't notice any reason in the comments for choosing 100 for the limit. Perhaps it is a limit of one of the particular database systems, but if that's the case, it seems best to impose the limit in the driver for that specific database. My bug-fix recommendation would be to remove the limit altogether and send the entire insert query, or at least to document in the function why there is an imposed limit and how said limit was chosen. The MySQL limit seems to be constrained only by the maximum packet size which defaults to 16M.\n\nHow to fix outside of Codeigniter:\nIn case this issue isn't fixed and you're reading this on the Internet, the fix I would recommend would be to implement your own form of batch insert that does not use an arbitrary limit based on the average number of fingers possessed by humans. ;-) Or, you could re-write the insert_batch function to be wrapped in a transaction (so you know no other inserts asynchronously get added) that saves the last_insert_id from the first insert and returns it upon successful completion of the transaction. That solution is less clean, however, as you might have other code expecting a true/false answer or relying on last_insert_id, which would still be corrupted.\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/178818379/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bgeisel1","id":5971213,"node_id":"MDQ6VXNlcjU5NzEyMTM=","avatar_url":"https://avatars.githubusercontent.com/u/5971213?v=4","gravatar_id":"","url":"https://api.github.com/users/bgeisel1","html_url":"https://github.com/bgeisel1","followers_url":"https://api.github.com/users/bgeisel1/followers","following_url":"https://api.github.com/users/bgeisel1/following{/other_user}","gists_url":"https://api.github.com/users/bgeisel1/gists{/gist_id}","starred_url":"https://api.github.com/users/bgeisel1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bgeisel1/subscriptions","organizations_url":"https://api.github.com/users/bgeisel1/orgs","repos_url":"https://api.github.com/users/bgeisel1/repos","events_url":"https://api.github.com/users/bgeisel1/events{/privacy}","received_events_url":"https://api.github.com/users/bgeisel1/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/179202280","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/42#issuecomment-179202280","issue_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/42","id":179202280,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTIwMjI4MA==","user":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2016-02-03T12:39:52Z","updated_at":"2016-02-03T12:39:52Z","body":"> Calling insert_batch() invalidates the last_insert_id\n\nWhat do you mean by \"invalidate\" exactly?\n\n> In the case of MySQL at least, last_insert_id is guaranteed to point to the first item inserted in an autoincrement table\n\nThe first one? Am I missing something here? Isn't it supposed to be the last one?\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/179202280/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/179319389","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/42#issuecomment-179319389","issue_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/42","id":179319389,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTMxOTM4OQ==","user":{"login":"mwhitneysdsu","id":1537529,"node_id":"MDQ6VXNlcjE1Mzc1Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/1537529?v=4","gravatar_id":"","url":"https://api.github.com/users/mwhitneysdsu","html_url":"https://github.com/mwhitneysdsu","followers_url":"https://api.github.com/users/mwhitneysdsu/followers","following_url":"https://api.github.com/users/mwhitneysdsu/following{/other_user}","gists_url":"https://api.github.com/users/mwhitneysdsu/gists{/gist_id}","starred_url":"https://api.github.com/users/mwhitneysdsu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mwhitneysdsu/subscriptions","organizations_url":"https://api.github.com/users/mwhitneysdsu/orgs","repos_url":"https://api.github.com/users/mwhitneysdsu/repos","events_url":"https://api.github.com/users/mwhitneysdsu/events{/privacy}","received_events_url":"https://api.github.com/users/mwhitneysdsu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2016-02-03T16:17:02Z","updated_at":"2016-02-03T16:17:02Z","body":"http://dev.mysql.com/doc/refman/5.7/en/information-functions.html#function_last-insert-id\n\nApparently, MySQL's `last_insert_id()` function returns the first ID inserted by a batch insert. CodeIgniter doesn't use that function directly, but I'm not sure whether MySQLi's `insert_id` uses the function (or mimics its behavior). Either way, if you do a batch insert of more than 100 rows, CI's `insert_id()` function is probably not going to give you a useful value (though I wouldn't expect the behavior of MySQL's `last_insert_id()` function if I wasn't reading the MySQL manual).\n\nOne of the reasons for splitting up a batch insert is that MySQLi (and probably other PHP database extensions) has a limit on the size of the query ( http://dev.mysql.com/doc/refman/5.7/en/packet-too-large.html ).\n\nWhile 100 is arbitrary, it apparently works for most common uses of `insert_batch()`, and anything non-arbitrary would have to be a platform-specific implementation, as you would have to determine the actual limit for the platform, then divide the insert into the appropriate size (which, at least for MySQLi, would break the batch down into a number of inserts based on the amount of data inserted into each row, which would be unnecessary 99.9% of the time).\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/179319389/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mwhitneysdsu","id":1537529,"node_id":"MDQ6VXNlcjE1Mzc1Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/1537529?v=4","gravatar_id":"","url":"https://api.github.com/users/mwhitneysdsu","html_url":"https://github.com/mwhitneysdsu","followers_url":"https://api.github.com/users/mwhitneysdsu/followers","following_url":"https://api.github.com/users/mwhitneysdsu/following{/other_user}","gists_url":"https://api.github.com/users/mwhitneysdsu/gists{/gist_id}","starred_url":"https://api.github.com/users/mwhitneysdsu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mwhitneysdsu/subscriptions","organizations_url":"https://api.github.com/users/mwhitneysdsu/orgs","repos_url":"https://api.github.com/users/mwhitneysdsu/repos","events_url":"https://api.github.com/users/mwhitneysdsu/events{/privacy}","received_events_url":"https://api.github.com/users/mwhitneysdsu/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/179349455","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/42#issuecomment-179349455","issue_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/42","id":179349455,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTM0OTQ1NQ==","user":{"login":"aczerepinski","id":11300677,"node_id":"MDQ6VXNlcjExMzAwNjc3","avatar_url":"https://avatars.githubusercontent.com/u/11300677?v=4","gravatar_id":"","url":"https://api.github.com/users/aczerepinski","html_url":"https://github.com/aczerepinski","followers_url":"https://api.github.com/users/aczerepinski/followers","following_url":"https://api.github.com/users/aczerepinski/following{/other_user}","gists_url":"https://api.github.com/users/aczerepinski/gists{/gist_id}","starred_url":"https://api.github.com/users/aczerepinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aczerepinski/subscriptions","organizations_url":"https://api.github.com/users/aczerepinski/orgs","repos_url":"https://api.github.com/users/aczerepinski/repos","events_url":"https://api.github.com/users/aczerepinski/events{/privacy}","received_events_url":"https://api.github.com/users/aczerepinski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2016-02-03T17:06:30Z","updated_at":"2016-02-03T17:06:30Z","body":"At the very least, adding a \"note\" to the insert_batch public documentation would be worthwhile. Given that insert_batch and insert_id are both part of the public API, inserting >100 rows and retrieving the insert_id should either be supported, or marked as a known limitation. If keeping current behavior and updating documentation is the desired path, I'm happy to submit a pull request for the docs.\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/179349455/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"aczerepinski","id":11300677,"node_id":"MDQ6VXNlcjExMzAwNjc3","avatar_url":"https://avatars.githubusercontent.com/u/11300677?v=4","gravatar_id":"","url":"https://api.github.com/users/aczerepinski","html_url":"https://github.com/aczerepinski","followers_url":"https://api.github.com/users/aczerepinski/followers","following_url":"https://api.github.com/users/aczerepinski/following{/other_user}","gists_url":"https://api.github.com/users/aczerepinski/gists{/gist_id}","starred_url":"https://api.github.com/users/aczerepinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aczerepinski/subscriptions","organizations_url":"https://api.github.com/users/aczerepinski/orgs","repos_url":"https://api.github.com/users/aczerepinski/repos","events_url":"https://api.github.com/users/aczerepinski/events{/privacy}","received_events_url":"https://api.github.com/users/aczerepinski/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/179431632","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/42#issuecomment-179431632","issue_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/42","id":179431632,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTQzMTYzMg==","user":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2016-02-03T19:57:52Z","updated_at":"2016-02-03T19:57:52Z","body":"I've got another idea about an eventual solution, but I still don't quite see the problem and am waiting for an answer to my first question for @bgeisel1.\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/179431632/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":538107991,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NTM4MTA3OTkx","url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/events/538107991","actor":{"login":"bgeisel1","id":5971213,"node_id":"MDQ6VXNlcjU5NzEyMTM=","avatar_url":"https://avatars.githubusercontent.com/u/5971213?v=4","gravatar_id":"","url":"https://api.github.com/users/bgeisel1","html_url":"https://github.com/bgeisel1","followers_url":"https://api.github.com/users/bgeisel1/followers","following_url":"https://api.github.com/users/bgeisel1/following{/other_user}","gists_url":"https://api.github.com/users/bgeisel1/gists{/gist_id}","starred_url":"https://api.github.com/users/bgeisel1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bgeisel1/subscriptions","organizations_url":"https://api.github.com/users/bgeisel1/orgs","repos_url":"https://api.github.com/users/bgeisel1/repos","events_url":"https://api.github.com/users/bgeisel1/events{/privacy}","received_events_url":"https://api.github.com/users/bgeisel1/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2016-02-03T19:57:52Z","performed_via_github_app":null},{"id":538107992,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDUzODEwNzk5Mg==","url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/events/538107992","actor":{"login":"bgeisel1","id":5971213,"node_id":"MDQ6VXNlcjU5NzEyMTM=","avatar_url":"https://avatars.githubusercontent.com/u/5971213?v=4","gravatar_id":"","url":"https://api.github.com/users/bgeisel1","html_url":"https://github.com/bgeisel1","followers_url":"https://api.github.com/users/bgeisel1/followers","following_url":"https://api.github.com/users/bgeisel1/following{/other_user}","gists_url":"https://api.github.com/users/bgeisel1/gists{/gist_id}","starred_url":"https://api.github.com/users/bgeisel1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bgeisel1/subscriptions","organizations_url":"https://api.github.com/users/bgeisel1/orgs","repos_url":"https://api.github.com/users/bgeisel1/repos","events_url":"https://api.github.com/users/bgeisel1/events{/privacy}","received_events_url":"https://api.github.com/users/bgeisel1/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2016-02-03T19:57:52Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/179438977","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/42#issuecomment-179438977","issue_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/42","id":179438977,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTQzODk3Nw==","user":{"login":"bgeisel1","id":5971213,"node_id":"MDQ6VXNlcjU5NzEyMTM=","avatar_url":"https://avatars.githubusercontent.com/u/5971213?v=4","gravatar_id":"","url":"https://api.github.com/users/bgeisel1","html_url":"https://github.com/bgeisel1","followers_url":"https://api.github.com/users/bgeisel1/followers","following_url":"https://api.github.com/users/bgeisel1/following{/other_user}","gists_url":"https://api.github.com/users/bgeisel1/gists{/gist_id}","starred_url":"https://api.github.com/users/bgeisel1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bgeisel1/subscriptions","organizations_url":"https://api.github.com/users/bgeisel1/orgs","repos_url":"https://api.github.com/users/bgeisel1/repos","events_url":"https://api.github.com/users/bgeisel1/events{/privacy}","received_events_url":"https://api.github.com/users/bgeisel1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2016-02-03T20:14:57Z","updated_at":"2016-02-03T20:14:57Z","body":"Hi Andrey & Mat, thanks for the quick response.\n\nDetails and examples below, but the main issue is this: insert_batch **silently** changes the API to a database. One of the quintessential aspects of a database is atomicity. From [wikipedia](https://en.wikipedia.org/wiki/Atomicity_%28database_systems%29):\n\n> In database systems, atomicity (or atomicness; from Greek a-tomos, undividable) is one of the ACID transaction properties. An atomic transaction is a series of database operations such that either all occur, or nothing occurs. The series of operations cannot be divided apart and executed partially from each other, which makes the series of operations \"indivisible\", hence the name.\n\nIn Codeigniter, the implementation of insert_batch defies the very definition of \"atomicity\" and \"indivisible\" for all of the databases behind it. The fact that MySQL has a limit means that at some point it will return an error, which the user code can handle. However, insert_batch makes the operation non-atomic which may result in errors the user cannot handle (i.e. non-deterministic change to last_insert_id). Sorry, I was probably unclear when I said \"invalidates\", but that's what I meant. It silently (no errors, etc.) changes the behavior of the underlying DB and I can no longer accurately obtain the IDs returned by the insert.\n\nBecause atomicity is broken, not only is last_insert_id broken, but what happens if one of the chunks in the middle fails? Now I have 1 set of IDs inserted and another set (or sets) that failed with no way to correlate what worked and what didn't. It's why the ACID principle is so important to databases.\n\nAs it was reported earlier, I suspect that other users are running into it. We didn't notice until data started getting corrupted in the asynchronous case (see below). It would be very easy to use this and never know that inserts > 100 could be corrupting your data (i.e. because you expect last_insert_id to be deterministic).\n\nOk, the examples and answer to @narfbg 's other question:\n\n> The first one? Am I missing something here? Isn't it supposed to be the last one?\n\nNo, as per the [MySQL documentation](http://dev.mysql.com/doc/refman/5.6/en/information-functions.html#function_last-insert-id), last_insert_id is always the FIRST entry in multiple inserts.\n\n> Important\n> If you insert multiple rows using a single INSERT statement, LAST_INSERT_ID() returns the value generated for the first inserted row only. The reason for this is to make it possible to reproduce easily the same INSERT statement against some other server.\n\nFor an example, let's say I'm inserting 500 entries. The first entry is inserted as id 2000. I do a MySQL multiple insert (not using insert_batch, but just a raw query). Calling last_insert_id will return 2000 since it was the first entry. I inserted 500 entries, so I now know my IDs are 2000 to 2499 (or of course if we hit a limit somewhere it will fail, and I will know because I received an error).\n\nWhen I use insert_batch, two things go wrong here. In the non-threaded (simpler) case, I insert the same 500 entries in a table whose next ID will be 2000. After this call, however, last_insert_id won't return 2000 as we would expect, it will return 2400. Same as before, my IDs are 2000 to 2499, but now last_insert_id points somewhere in the middle. Not what the user is expecting.\n\nIn the threaded case, I can't even determine what my IDs are. For example, say insert_batch does its first batch, IDs 2000 through 2099. Then _insert_batch returns and our loop is about to call it again with the next batch. Right at that moment another thread writes 5 entries into the database. Now my second set is going to be 2104 through 2203 and information is lost (the list of IDs is now non-deterministic). My ids are now 2000-2099, 2104-2203, and so forth. By breaking my atomic query into a non-atomic query it has broken the ACID transaction property of such a database.\n\nI hope that makes more sense. Please let me know if my examples are confusing or if I've brought up other questions.\n\nThanks!\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/179438977/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bgeisel1","id":5971213,"node_id":"MDQ6VXNlcjU5NzEyMTM=","avatar_url":"https://avatars.githubusercontent.com/u/5971213?v=4","gravatar_id":"","url":"https://api.github.com/users/bgeisel1","html_url":"https://github.com/bgeisel1","followers_url":"https://api.github.com/users/bgeisel1/followers","following_url":"https://api.github.com/users/bgeisel1/following{/other_user}","gists_url":"https://api.github.com/users/bgeisel1/gists{/gist_id}","starred_url":"https://api.github.com/users/bgeisel1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bgeisel1/subscriptions","organizations_url":"https://api.github.com/users/bgeisel1/orgs","repos_url":"https://api.github.com/users/bgeisel1/repos","events_url":"https://api.github.com/users/bgeisel1/events{/privacy}","received_events_url":"https://api.github.com/users/bgeisel1/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":538130668,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NTM4MTMwNjY4","url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/events/538130668","actor":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2016-02-03T20:14:58Z","performed_via_github_app":null},{"id":538130669,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDUzODEzMDY2OQ==","url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/events/538130669","actor":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2016-02-03T20:14:58Z","performed_via_github_app":null},{"id":539176387,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDUzOTE3NjM4Nw==","url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/events/539176387","actor":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"105a48bbfc97be5902dbe80f90f8936fe174c9cf","commit_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/commits/105a48bbfc97be5902dbe80f90f8936fe174c9cf","created_at":"2016-02-04T13:45:20Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/179848147","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/42#issuecomment-179848147","issue_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/42","id":179848147,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTg0ODE0Nw==","user":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2016-02-04T13:47:41Z","updated_at":"2016-02-04T13:47:41Z","body":"To be honest, most of what you said is kind of irrelevant (and further confusing), but I believe I've got what you mean. :)\n\nDoes that last commit resolve the problem?\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/179848147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/179872241","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/42#issuecomment-179872241","issue_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/42","id":179872241,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTg3MjI0MQ==","user":{"login":"aczerepinski","id":11300677,"node_id":"MDQ6VXNlcjExMzAwNjc3","avatar_url":"https://avatars.githubusercontent.com/u/11300677?v=4","gravatar_id":"","url":"https://api.github.com/users/aczerepinski","html_url":"https://github.com/aczerepinski","followers_url":"https://api.github.com/users/aczerepinski/followers","following_url":"https://api.github.com/users/aczerepinski/following{/other_user}","gists_url":"https://api.github.com/users/aczerepinski/gists{/gist_id}","starred_url":"https://api.github.com/users/aczerepinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aczerepinski/subscriptions","organizations_url":"https://api.github.com/users/aczerepinski/orgs","repos_url":"https://api.github.com/users/aczerepinski/repos","events_url":"https://api.github.com/users/aczerepinski/events{/privacy}","received_events_url":"https://api.github.com/users/aczerepinski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2016-02-04T14:32:14Z","updated_at":"2016-02-04T14:32:14Z","body":"That commit is definitely an improvement, since it would be possible to pass `count($set)` in as `$batch_size` and bypass the batching mechanism. If you were to call `insert_batch` that way, I think you would re-gain access to `insert_id` afterward.\n\nI don't like that the current batch implementation can silently fail to insert some of the batches, such as experienced by this user:\nhttp://stackoverflow.com/questions/18015852/codeigniters-insert-batch-with-thousands-of-inserts-has-missing-records\n\nI would suggest wrapping the batch inserts in a transaction, but not all databases support that. Any ideas on how to prevent some of the inserts from silently failing?\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/179872241/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"aczerepinski","id":11300677,"node_id":"MDQ6VXNlcjExMzAwNjc3","avatar_url":"https://avatars.githubusercontent.com/u/11300677?v=4","gravatar_id":"","url":"https://api.github.com/users/aczerepinski","html_url":"https://github.com/aczerepinski","followers_url":"https://api.github.com/users/aczerepinski/followers","following_url":"https://api.github.com/users/aczerepinski/following{/other_user}","gists_url":"https://api.github.com/users/aczerepinski/gists{/gist_id}","starred_url":"https://api.github.com/users/aczerepinski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aczerepinski/subscriptions","organizations_url":"https://api.github.com/users/aczerepinski/orgs","repos_url":"https://api.github.com/users/aczerepinski/repos","events_url":"https://api.github.com/users/aczerepinski/events{/privacy}","received_events_url":"https://api.github.com/users/aczerepinski/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/179876882","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/42#issuecomment-179876882","issue_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/42","id":179876882,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTg3Njg4Mg==","user":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2016-02-04T14:44:13Z","updated_at":"2016-02-04T14:44:13Z","body":"That's not possible if you don't utilize the new parameter, not in a way that would work on all databases.\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/179876882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/185855199","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/42#issuecomment-185855199","issue_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/42","id":185855199,"node_id":"MDEyOklzc3VlQ29tbWVudDE4NTg1NTE5OQ==","user":{"login":"bgeisel1","id":5971213,"node_id":"MDQ6VXNlcjU5NzEyMTM=","avatar_url":"https://avatars.githubusercontent.com/u/5971213?v=4","gravatar_id":"","url":"https://api.github.com/users/bgeisel1","html_url":"https://github.com/bgeisel1","followers_url":"https://api.github.com/users/bgeisel1/followers","following_url":"https://api.github.com/users/bgeisel1/following{/other_user}","gists_url":"https://api.github.com/users/bgeisel1/gists{/gist_id}","starred_url":"https://api.github.com/users/bgeisel1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bgeisel1/subscriptions","organizations_url":"https://api.github.com/users/bgeisel1/orgs","repos_url":"https://api.github.com/users/bgeisel1/repos","events_url":"https://api.github.com/users/bgeisel1/events{/privacy}","received_events_url":"https://api.github.com/users/bgeisel1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2016-02-18T18:47:18Z","updated_at":"2016-02-18T18:47:18Z","body":"> That's not possible if you don't utilize the new parameter, not in a way that would work on all databases.\n\nThat's really the reason it's such a bad idea to break a database query into chunks -- it will not work on all databases. It will **seem** to work until using it in a large production environment. Then it will silently corrupt data.\n\nBreaking the query into chunks is bad. In some very valid use cases, it corrupts data.\nNot breaking the query into chunks is good. It models the way databases work and doesn't corrupt data.\n\nMy recommendation would be to default insert_batch to **not** break the query into chunks. It was a mistake to chunk it in the first place. There is no good reason to continue chunking and many good reasons to discontinue chunking. Just remove the for loop that is doing the array_slice.\n\nIt used to corrupt data and no one noticed is not a good reason to go on doing so.\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/185855199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bgeisel1","id":5971213,"node_id":"MDQ6VXNlcjU5NzEyMTM=","avatar_url":"https://avatars.githubusercontent.com/u/5971213?v=4","gravatar_id":"","url":"https://api.github.com/users/bgeisel1","html_url":"https://github.com/bgeisel1","followers_url":"https://api.github.com/users/bgeisel1/followers","following_url":"https://api.github.com/users/bgeisel1/following{/other_user}","gists_url":"https://api.github.com/users/bgeisel1/gists{/gist_id}","starred_url":"https://api.github.com/users/bgeisel1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bgeisel1/subscriptions","organizations_url":"https://api.github.com/users/bgeisel1/orgs","repos_url":"https://api.github.com/users/bgeisel1/repos","events_url":"https://api.github.com/users/bgeisel1/events{/privacy}","received_events_url":"https://api.github.com/users/bgeisel1/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/186418390","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/42#issuecomment-186418390","issue_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/42","id":186418390,"node_id":"MDEyOklzc3VlQ29tbWVudDE4NjQxODM5MA==","user":{"login":"mwhitneysdsu","id":1537529,"node_id":"MDQ6VXNlcjE1Mzc1Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/1537529?v=4","gravatar_id":"","url":"https://api.github.com/users/mwhitneysdsu","html_url":"https://github.com/mwhitneysdsu","followers_url":"https://api.github.com/users/mwhitneysdsu/followers","following_url":"https://api.github.com/users/mwhitneysdsu/following{/other_user}","gists_url":"https://api.github.com/users/mwhitneysdsu/gists{/gist_id}","starred_url":"https://api.github.com/users/mwhitneysdsu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mwhitneysdsu/subscriptions","organizations_url":"https://api.github.com/users/mwhitneysdsu/orgs","repos_url":"https://api.github.com/users/mwhitneysdsu/repos","events_url":"https://api.github.com/users/mwhitneysdsu/events{/privacy}","received_events_url":"https://api.github.com/users/mwhitneysdsu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2016-02-19T21:39:38Z","updated_at":"2016-02-19T21:39:38Z","body":"While it would probably be a good idea to not break the query up, it would also be a good idea to:\n- run the batch in a transaction (which you can do without any modification to the query builder code)\n- compare the result of `$this->db->affected_rows()` to the number of rows you wanted to insert\n- don't rely on the result of `$this->db->insert_id()` matching the behavior you described\n\nThe last is just because it won't match your description for all database platforms. In some cases, the method is simply not supported; in at least one case, the method will return the last ID inserted, rather than the first. (I expected it to return the last ID inserted, which is why I linked the documentation earlier to support your description of the behavior under MySQL.)\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/comments/186418390/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mwhitneysdsu","id":1537529,"node_id":"MDQ6VXNlcjE1Mzc1Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/1537529?v=4","gravatar_id":"","url":"https://api.github.com/users/mwhitneysdsu","html_url":"https://github.com/mwhitneysdsu","followers_url":"https://api.github.com/users/mwhitneysdsu/followers","following_url":"https://api.github.com/users/mwhitneysdsu/following{/other_user}","gists_url":"https://api.github.com/users/mwhitneysdsu/gists{/gist_id}","starred_url":"https://api.github.com/users/mwhitneysdsu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mwhitneysdsu/subscriptions","organizations_url":"https://api.github.com/users/mwhitneysdsu/orgs","repos_url":"https://api.github.com/users/mwhitneysdsu/repos","events_url":"https://api.github.com/users/mwhitneysdsu/events{/privacy}","received_events_url":"https://api.github.com/users/mwhitneysdsu/received_events","type":"User","user_view_type":"public","site_admin":false}}]