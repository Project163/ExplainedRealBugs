{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/4539","repository_url":"https://api.github.com/repos/bcit-ci/CodeIgniter","labels_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/4539/labels{/name}","comments_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/4539/comments","events_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/4539/events","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/4539","id":141216616,"node_id":"MDU6SXNzdWUxNDEyMTY2MTY=","number":4539,"title":"Migration show an error, but applied","user":{"login":"shlangus","id":6114091,"node_id":"MDQ6VXNlcjYxMTQwOTE=","avatar_url":"https://avatars.githubusercontent.com/u/6114091?v=4","gravatar_id":"","url":"https://api.github.com/users/shlangus","html_url":"https://github.com/shlangus","followers_url":"https://api.github.com/users/shlangus/followers","following_url":"https://api.github.com/users/shlangus/following{/other_user}","gists_url":"https://api.github.com/users/shlangus/gists{/gist_id}","starred_url":"https://api.github.com/users/shlangus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shlangus/subscriptions","organizations_url":"https://api.github.com/users/shlangus/orgs","repos_url":"https://api.github.com/users/shlangus/repos","events_url":"https://api.github.com/users/shlangus/events{/privacy}","received_events_url":"https://api.github.com/users/shlangus/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":140924,"node_id":"MDU6TGFiZWwxNDA5MjQ=","url":"https://api.github.com/repos/bcit-ci/CodeIgniter/labels/Bug","name":"Bug","color":"eb2420","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/milestones/10","html_url":"https://github.com/bcit-ci/CodeIgniter/milestone/10","labels_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/milestones/10/labels","id":1639708,"node_id":"MDk6TWlsZXN0b25lMTYzOTcwOA==","number":10,"title":"3.0.6","description":"","creator":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":8,"state":"closed","created_at":"2016-03-11T20:35:49Z","updated_at":"2016-04-01T09:05:21Z","due_on":null,"closed_at":"2016-04-01T09:05:21Z"},"comments":11,"created_at":"2016-03-16T09:29:15Z","updated_at":"2016-03-16T19:13:56Z","closed_at":"2016-03-16T16:56:31Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"For an “up” migration:\nIf you have any migration files with mismatched file's and class's names, migration will show an error \"The migration class \"Migration_Class_name\" could not be found\", but even so will apply, if the broken file's version greater than target version (i.e. we actually don't need to touch the broken file for migrate up to the target).\nIf you try to migrate through several versions than the broken file can interrupt migration process with error, but all \"good\" files will work well, so migration version will increase but still be lower than target. \nFurthermore, if you try to go back to the last migration's version (I think it's very likely in case you got error), the migration will also show error, and won't make any changes. It's happens because migration files are checked in inverse order, so the broken file is interrupting a migration process before any \"good\" files can be applied. \nThe reason in [that condition](https://github.com/bcit-ci/CodeIgniter/blob/develop/system/libraries/Migration.php#L251) checks all files even if they actually won't been applied.  \nFor a \"down\" migration the situation are mirrored.\n\nLet me show an example. I will use sequential migrations for simplifying.\nLet we have 4 migration file — 001-004, where file 003 is broken: it have name “003_Migrate_Create_users_table”, but consist class “Migrate_Broken_users_table”.\nSo, current version is 1, and I want to migrate to version 2. I'm change version in the config file, and then I'm call migration->current(), which show an error, but applied.\nNow, I want to come back to the previous version. I set version to 1, and run migration->current().I get an error, and no changes were applied — I still have version 2.\nIf I'll try to migrate from version 1 to 4, I’ll get an error too, and actually I'll been migrated to version 2.\n","closed_by":{"login":"shlangus","id":6114091,"node_id":"MDQ6VXNlcjYxMTQwOTE=","avatar_url":"https://avatars.githubusercontent.com/u/6114091?v=4","gravatar_id":"","url":"https://api.github.com/users/shlangus","html_url":"https://github.com/shlangus","followers_url":"https://api.github.com/users/shlangus/followers","following_url":"https://api.github.com/users/shlangus/following{/other_user}","gists_url":"https://api.github.com/users/shlangus/gists{/gist_id}","starred_url":"https://api.github.com/users/shlangus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shlangus/subscriptions","organizations_url":"https://api.github.com/users/shlangus/orgs","repos_url":"https://api.github.com/users/shlangus/repos","events_url":"https://api.github.com/users/shlangus/events{/privacy}","received_events_url":"https://api.github.com/users/shlangus/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/4539/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/4539/timeline","performed_via_github_app":null,"state_reason":"completed"}