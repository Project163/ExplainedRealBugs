{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/2667","repository_url":"https://api.github.com/repos/bcit-ci/CodeIgniter","labels_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/2667/labels{/name}","comments_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/2667/comments","events_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/2667/events","html_url":"https://github.com/bcit-ci/CodeIgniter/issues/2667","id":20282073,"node_id":"MDU6SXNzdWUyMDI4MjA3Mw==","number":2667,"title":"CodeIgniter Bypass","user":{"login":"soaj1664","id":763359,"node_id":"MDQ6VXNlcjc2MzM1OQ==","avatar_url":"https://avatars.githubusercontent.com/u/763359?v=4","gravatar_id":"","url":"https://api.github.com/users/soaj1664","html_url":"https://github.com/soaj1664","followers_url":"https://api.github.com/users/soaj1664/followers","following_url":"https://api.github.com/users/soaj1664/following{/other_user}","gists_url":"https://api.github.com/users/soaj1664/gists{/gist_id}","starred_url":"https://api.github.com/users/soaj1664/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/soaj1664/subscriptions","organizations_url":"https://api.github.com/users/soaj1664/orgs","repos_url":"https://api.github.com/users/soaj1664/repos","events_url":"https://api.github.com/users/soaj1664/events{/privacy}","received_events_url":"https://api.github.com/users/soaj1664/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":87,"created_at":"2013-09-30T18:37:48Z","updated_at":"2015-01-22T17:57:10Z","closed_at":"2015-01-22T17:57:10Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Hi Guys!\n\nI had a chance to test CodeIgniter against XSS attack. I have found few things that might be interested for you guys:\n\nI have created a test-bed here: http://xssplayground.net23.net/clean10.html\n\nThe area is protected by CodeIgniter but for testing purpose OUTPUT reflects in Standard HTML, Script, Attribute and URL context. In the following manner, in my test-bed output reflects in different context.\n\nOutput reflects here (Standard HTML Context): `<?php echo cleanCode($_POST['name']); ?> <br><br>`\n\nOutput reflects in attribute context `<div class='<?php echo cleanCode($_POST['name']);?>'>I am an attribute context</div> <br><br>`\n\nOutput reflects in URL context `<a href='<?php echo cleanCode($_POST['name']);?>'>I am URL context</a> <br><br>`\n\nOutput reflects in script context `<script> var a = '<?php echo cleanCode($_POST['name']);?>'; </script>`\n\nThe following injection will BYPASS CodeIgniter in \"attribute\" and \"URL\" context:\n\n'; onmouseover=confirm(location);//\n\nOR\n\n'; onmouseover=confirm(cookie);//\n\nIn CodeIgniter's black-list you guys are checking against \"document.cookie\" and \"window.location\". The same purpose can be achieved by using cookie and location word! In above cases, if I inject \n\n'; onmouseover=alert(window.location);//\n\nI got the following output which stops XSS:\n\nAttribute context: `<div class='\\'; onmouseover=alert&#40;[removed]&#41;;//'>`\nURL context: `<a href='\\'; onmouseover=alert&#40;[removed]&#41;;//'>`\n\nAlso in Chrome, the following injection bypassed URL context only:\n\nj&NewLine;a&NewLine;vas&NewLine;cript:confirm(1);\n\nIf I simply inject javascript:alert(1) then CodeIgniter works perfectly and removed javascript but in the above manner, injection works.\n\nLet me know, if I missed something :)\n\nRegards\n\n@soaj1664ashar\n","closed_by":{"login":"narfbg","id":1058011,"node_id":"MDQ6VXNlcjEwNTgwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/1058011?v=4","gravatar_id":"","url":"https://api.github.com/users/narfbg","html_url":"https://github.com/narfbg","followers_url":"https://api.github.com/users/narfbg/followers","following_url":"https://api.github.com/users/narfbg/following{/other_user}","gists_url":"https://api.github.com/users/narfbg/gists{/gist_id}","starred_url":"https://api.github.com/users/narfbg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/narfbg/subscriptions","organizations_url":"https://api.github.com/users/narfbg/orgs","repos_url":"https://api.github.com/users/narfbg/repos","events_url":"https://api.github.com/users/narfbg/events{/privacy}","received_events_url":"https://api.github.com/users/narfbg/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/2667/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bcit-ci/CodeIgniter/issues/2667/timeline","performed_via_github_app":null,"state_reason":"completed"}