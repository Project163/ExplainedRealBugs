diff --git a/src/java/org/apache/commons/math/random/CorrelatedRandomVectorGenerator.java b/src/java/org/apache/commons/math/random/CorrelatedRandomVectorGenerator.java
index 06de22249..fd7a925d9 100644
--- a/src/java/org/apache/commons/math/random/CorrelatedRandomVectorGenerator.java
+++ b/src/java/org/apache/commons/math/random/CorrelatedRandomVectorGenerator.java
@@ -253,7 +253,7 @@ implements RandomVectorGenerator {
         // build the root matrix
         root = new RealMatrixImpl(order, rank);
         for (int i = 0; i < order; ++i) {
-            System.arraycopy(b[i], 0, root.getDataRef()[swap[i]], 0, rank);
+            System.arraycopy(b[i], 0, root.getDataRef()[index[i]], 0, rank);
         }
 
     }
diff --git a/src/site/xdoc/changes.xml b/src/site/xdoc/changes.xml
index f937a0e44..b626d7d0e 100644
--- a/src/site/xdoc/changes.xml
+++ b/src/site/xdoc/changes.xml
@@ -39,6 +39,10 @@ The <action> type attribute can be add,update,fix,remove.
   </properties>
   <body>
     <release version="2.0" date="TBD" description="TBD">
+      <action dev="luc" type="fix" issue="MATH-226" due-to="Stuart Siegel">
+        Fixed an error in CorrelatedRandomVectorGenerator leading to a component of
+        the generated vector being constant.
+      </action>
       <action dev="luc" type="fix" issue="MATH-223" due-to="John Mulcahy">
         Greatly improved QR-decomposition speed using transposed matrices internally.
       </action>
diff --git a/src/test/org/apache/commons/math/random/CorrelatedRandomVectorGeneratorTest.java b/src/test/org/apache/commons/math/random/CorrelatedRandomVectorGeneratorTest.java
index 4d5cd8d2b..b2f40dbf0 100644
--- a/src/test/org/apache/commons/math/random/CorrelatedRandomVectorGeneratorTest.java
+++ b/src/test/org/apache/commons/math/random/CorrelatedRandomVectorGeneratorTest.java
@@ -39,6 +39,29 @@ extends TestCase {
         assertEquals(3, generator.getRank());
     }
 
+    public void testMath226()
+        throws DimensionMismatchException, NotPositiveDefiniteMatrixException {
+        double[] mean = { 1, 1, 10, 1 };
+        double[][] cov = {
+                { 1, 3, 2, 6 },
+                { 3, 13, 16, 2 },
+                { 2, 16, 38, -1 },
+                { 6, 2, -1, 197 }
+        };
+        RealMatrix covRM = new RealMatrixImpl(cov, false);
+        JDKRandomGenerator jg = new JDKRandomGenerator();
+        jg.setSeed(5322145245211l);
+        NormalizedRandomGenerator rg = new GaussianRandomGenerator(jg);
+        CorrelatedRandomVectorGenerator sg =
+            new CorrelatedRandomVectorGenerator(mean, covRM, 0.00001, rg);
+
+        for (int i = 0; i < 10; i++) {
+            double[] generated = sg.nextVector();
+            assertTrue(Math.abs(generated[0] - 1) > 0.1);
+        }
+
+    }
+
     public void testRootMatrix() {
         RealMatrix b = generator.getRootMatrix();
         RealMatrix bbt = b.multiply(b.transpose());
