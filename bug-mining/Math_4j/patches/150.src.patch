diff --git a/src/main/java/org/apache/commons/math/analysis/BinaryFunction.java b/src/main/java/org/apache/commons/math/analysis/BinaryFunction.java
index 79cb8140a..3511f5695 100644
--- a/src/main/java/org/apache/commons/math/analysis/BinaryFunction.java
+++ b/src/main/java/org/apache/commons/math/analysis/BinaryFunction.java
@@ -27,62 +27,45 @@ import org.apache.commons.math.util.FastMath;
  *
  * @since 2.1
  * @version $Revision$ $Date$
+ * @deprecated in 2.2 (to be removed in 3.0). Please use the function classes
+ * in the {@link org.apache.commons.math.analysis.function} package and the
+ * methods in {@link FunctionUtils}.
  */
+@Deprecated
 public abstract class BinaryFunction implements BivariateRealFunction {
+    public static BinaryFunction make(final BivariateRealFunction f) {
+        return new BinaryFunction() {
+            /** {@inheritDoc} */
+            @Override
+                public double value(double x, double y) {
+                return f.value(x, y);
+            }
+        };
+    }
 
     /** The + operator method wrapped as a {@link BinaryFunction}. */
-    public static final BinaryFunction ADD = new BinaryFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double x, double y) {
-            return x + y;
-        }
-    };
+    public static final BinaryFunction ADD =
+        make(new org.apache.commons.math.analysis.function.Add());
 
     /** The - operator method wrapped as a {@link BinaryFunction}. */
-    public static final BinaryFunction SUBTRACT = new BinaryFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double x, double y) {
-            return x - y;
-        }
-    };
+    public static final BinaryFunction SUBTRACT =
+        make(new org.apache.commons.math.analysis.function.Subtract());
 
     /** The * operator method wrapped as a {@link BinaryFunction}. */
-    public static final BinaryFunction MULTIPLY = new BinaryFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double x, double y) {
-            return x * y;
-        }
-    };
+    public static final BinaryFunction MULTIPLY =
+        make(new org.apache.commons.math.analysis.function.Multiply());
 
     /** The / operator method wrapped as a {@link BinaryFunction}. */
-    public static final BinaryFunction DIVIDE = new BinaryFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double x, double y) {
-            return x / y;
-        }
-    };
+    public static final BinaryFunction DIVIDE =
+        make(new org.apache.commons.math.analysis.function.Divide());
 
     /** The {@code FastMath.pow} method wrapped as a {@link BinaryFunction}. */
-    public static final BinaryFunction POW = new BinaryFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double x, double y) {
-            return FastMath.pow(x, y);
-        }
-    };
+    public static final BinaryFunction POW =
+        make(new org.apache.commons.math.analysis.function.Pow());
 
     /** The {@code FastMath.atan2} method wrapped as a {@link BinaryFunction}. */
-    public static final BinaryFunction ATAN2 = new BinaryFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double x, double y) {
-            return FastMath.atan2(x, y);
-        }
-    };
+    public static final BinaryFunction ATAN2 =
+        make(new org.apache.commons.math.analysis.function.Atan2());
 
     /** {@inheritDoc} */
     public abstract double value(double x, double y) throws MathUserException;
@@ -92,13 +75,7 @@ public abstract class BinaryFunction implements BivariateRealFunction {
      * @return a function such that {@code f.value(y) == value(fixedX, y)}
      */
     public ComposableFunction fix1stArgument(final double fixedX) {
-        return new ComposableFunction() {
-            @Override
-            /** {@inheritDoc} */
-            public double value(double x) throws MathUserException {
-                return BinaryFunction.this.value(fixedX, x);
-            }
-        };
+        return ComposableFunction.make(FunctionUtils.fix1stArgument(this, fixedX));
     }
 
     /** Get a composable function by fixing the second argument of the instance.
@@ -106,13 +83,6 @@ public abstract class BinaryFunction implements BivariateRealFunction {
      * @return a function such that {@code f.value(x) == value(x, fixedY)}
      */
     public ComposableFunction fix2ndArgument(final double fixedY) {
-        return new ComposableFunction() {
-            @Override
-            /** {@inheritDoc} */
-            public double value(double x) throws MathUserException {
-                return BinaryFunction.this.value(x, fixedY);
-            }
-        };
+        return ComposableFunction.make(FunctionUtils.fix2ndArgument(this, fixedY));
     }
-
 }
diff --git a/src/main/java/org/apache/commons/math/analysis/ComposableFunction.java b/src/main/java/org/apache/commons/math/analysis/ComposableFunction.java
index aead0050e..99e631dac 100644
--- a/src/main/java/org/apache/commons/math/analysis/ComposableFunction.java
+++ b/src/main/java/org/apache/commons/math/analysis/ComposableFunction.java
@@ -26,152 +26,85 @@ import org.apache.commons.math.util.FastMath;
  *
  * @since 2.1
  * @version $Revision$ $Date$
+ * @deprecated in 2.2 (to be removed in 3.0). Please use the function classes
+ * in the {@link org.apache.commons.math.analysis.function} package and the
+ * methods in {@link FunctionUtils}.
  */
+@Deprecated
 public abstract class ComposableFunction implements UnivariateRealFunction {
+    public static ComposableFunction make(final UnivariateRealFunction f) {
+        return new ComposableFunction() {
+            /** {@inheritDoc} */
+            @Override
+            public double value(double x) {
+                return f.value(x);
+            }
+        };
+    }
 
     /** The constant function always returning 0. */
-    public static final ComposableFunction ZERO = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return 0;
-        }
-    };
-
+    public static final ComposableFunction ZERO =
+        make(new org.apache.commons.math.analysis.function.Constant(0));
+    
     /** The constant function always returning 1. */
-    public static final ComposableFunction ONE = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return 1;
-        }
-    };
+    public static final ComposableFunction ONE = 
+        make(new org.apache.commons.math.analysis.function.Constant(1));
 
     /** The identity function. */
-    public static final ComposableFunction IDENTITY = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return d;
-        }
-    };
+    public static final ComposableFunction IDENTITY =
+        make(new org.apache.commons.math.analysis.function.Identity());
 
     /** The {@code FastMath.abs} method wrapped as a {@link ComposableFunction}. */
-    public static final ComposableFunction ABS = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return FastMath.abs(d);
-        }
-    };
+    public static final ComposableFunction ABS =
+        make(new org.apache.commons.math.analysis.function.Abs());
 
     /** The - operator wrapped as a {@link ComposableFunction}. */
-    public static final ComposableFunction NEGATE = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return -d;
-        }
-    };
+    public static final ComposableFunction NEGATE = 
+        make(new org.apache.commons.math.analysis.function.Minus());
 
     /** The invert operator wrapped as a {@link ComposableFunction}. */
-    public static final ComposableFunction INVERT = new ComposableFunction () {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d){
-            return 1/d;
-        }
-    };
+    public static final ComposableFunction INVERT =
+        make(new org.apache.commons.math.analysis.function.Inverse());
 
     /** The {@code FastMath.sin} method wrapped as a {@link ComposableFunction}. */
-    public static final ComposableFunction SIN = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return FastMath.sin(d);
-        }
-    };
+    public static final ComposableFunction SIN =
+        make(new org.apache.commons.math.analysis.function.Sin());
 
     /** The {@code FastMath.sqrt} method wrapped as a {@link ComposableFunction}. */
-    public static final ComposableFunction SQRT = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return FastMath.sqrt(d);
-        }
-    };
+    public static final ComposableFunction SQRT =
+        make(new org.apache.commons.math.analysis.function.Sqrt());
 
     /** The {@code FastMath.sinh} method wrapped as a {@link ComposableFunction}. */
-    public static final ComposableFunction SINH = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return FastMath.sinh(d);
-        }
-    };
+    public static final ComposableFunction SINH =
+        make(new org.apache.commons.math.analysis.function.Sinh());
 
     /** The {@code FastMath.exp} method wrapped as a {@link ComposableFunction}. */
-    public static final ComposableFunction EXP = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return FastMath.exp(d);
-        }
-    };
+    public static final ComposableFunction EXP =
+        make(new org.apache.commons.math.analysis.function.Exp());
 
     /** The {@code FastMath.expm1} method wrapped as a {@link ComposableFunction}. */
-    public static final ComposableFunction EXPM1 = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return FastMath.expm1(d);
-        }
-    };
+    public static final ComposableFunction EXPM1 =
+        make(new org.apache.commons.math.analysis.function.Expm1());
 
     /** The {@code FastMath.asin} method wrapped as a {@link ComposableFunction}. */
-    public static final ComposableFunction ASIN = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return FastMath.asin(d);
-        }
-    };
+    public static final ComposableFunction ASIN =
+        make(new org.apache.commons.math.analysis.function.Asin());
 
     /** The {@code FastMath.atan} method wrapped as a {@link ComposableFunction}. */
-    public static final ComposableFunction ATAN = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return FastMath.atan(d);
-        }
-    };
+    public static final ComposableFunction ATAN =
+        make(new org.apache.commons.math.analysis.function.Atan());
 
     /** The {@code FastMath.tan} method wrapped as a {@link ComposableFunction}. */
-    public static final ComposableFunction TAN = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return FastMath.tan(d);
-        }
-    };
+    public static final ComposableFunction TAN =
+        make(new org.apache.commons.math.analysis.function.Tan());
 
     /** The {@code FastMath.tanh} method wrapped as a {@link ComposableFunction}. */
-    public static final ComposableFunction TANH = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return FastMath.tanh(d);
-        }
-    };
+    public static final ComposableFunction TANH =
+        make(new org.apache.commons.math.analysis.function.Tanh());
 
     /** The {@code FastMath.cbrt} method wrapped as a {@link ComposableFunction}. */
-    public static final ComposableFunction CBRT = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return FastMath.cbrt(d);
-        }
-    };
+    public static final ComposableFunction CBRT =
+        make(new org.apache.commons.math.analysis.function.Cbrt());
 
     /** The {@code FastMath.ceil} method wrapped as a {@link ComposableFunction}. */
     public static final ComposableFunction CEIL = new ComposableFunction() {
@@ -192,57 +125,28 @@ public abstract class ComposableFunction implements UnivariateRealFunction {
     };
 
     /** The {@code FastMath.log} method wrapped as a {@link ComposableFunction}. */
-    public static final ComposableFunction LOG = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return FastMath.log(d);
-        }
-    };
+    public static final ComposableFunction LOG =
+        make(new org.apache.commons.math.analysis.function.Log());
 
     /** The {@code FastMath.log10} method wrapped as a {@link ComposableFunction}. */
-    public static final ComposableFunction LOG10 = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return FastMath.log10(d);
-        }
-    };
+    public static final ComposableFunction LOG10 =
+        make(new org.apache.commons.math.analysis.function.Log10());
 
     /** The {@code FastMath.log1p} method wrapped as a {@link ComposableFunction}. */
-    public static final ComposableFunction LOG1P = new ComposableFunction () {
-        @Override
-        public double value(double d){
-            return FastMath.log1p(d);
-        }
-    };
+    public static final ComposableFunction LOG1P =
+        make(new org.apache.commons.math.analysis.function.Log1p());
 
     /** The {@code FastMath.cos} method wrapped as a {@link ComposableFunction}. */
-    public static final ComposableFunction COS = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return FastMath.cos(d);
-        }
-    };
+    public static final ComposableFunction COS =
+        make(new org.apache.commons.math.analysis.function.Cos());
 
     /** The {@code FastMath.abs} method wrapped as a {@link ComposableFunction}. */
-    public static final ComposableFunction ACOS = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return FastMath.acos(d);
-        }
-    };
+    public static final ComposableFunction ACOS =
+        make(new org.apache.commons.math.analysis.function.Acos());
 
     /** The {@code FastMath.cosh} method wrapped as a {@link ComposableFunction}. */
-    public static final ComposableFunction COSH = new ComposableFunction() {
-        /** {@inheritDoc} */
-        @Override
-        public double value(double d) {
-            return FastMath.cosh(d);
-        }
-    };
+    public static final ComposableFunction COSH =
+        make(new org.apache.commons.math.analysis.function.Cosh());
 
     /** The {@code FastMath.rint} method wrapped as a {@link ComposableFunction}. */
     public static final ComposableFunction RINT = new ComposableFunction() {
diff --git a/src/main/java/org/apache/commons/math/analysis/FunctionUtils.java b/src/main/java/org/apache/commons/math/analysis/FunctionUtils.java
new file mode 100644
index 000000000..f0d2e881c
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/FunctionUtils.java
@@ -0,0 +1,170 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis;
+
+import org.apache.commons.math.analysis.function.Identity;
+
+/**
+ * Utilities for manipulating function objects.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class FunctionUtils {
+    /**
+     * Compose functions.
+     *
+     * @param f List of functions.
+     * @return the composed function.
+     */
+    public static UnivariateRealFunction compose(final UnivariateRealFunction ... f) {
+        return new UnivariateRealFunction() {
+            /** {@inheritDoc} */
+            public double value(double x) {
+                double r = x;
+                for (int i = f.length - 1; i >= 0; i--) {
+                    r = f[i].value(r);
+                }
+                return r;
+            }
+        };
+    }
+
+    /**
+     * Add functions.
+     *
+     * @param f List of functions.
+     * @return a function that computes the addition of the functions.
+     */
+    public static UnivariateRealFunction add(final UnivariateRealFunction ... f) {
+        return new UnivariateRealFunction() {
+            /** {@inheritDoc} */
+            public double value(double x) {
+                double r = f[0].value(x);
+                for (int i = 1; i < f.length; i++) {
+                    r += f[i].value(x);
+                }
+                return r;
+            }
+        };
+    }
+
+    /**
+     * Multiply functions.
+     *
+     * @param f List of functions.
+     * @return a function that computes the multiplication of the functions.
+     */
+    public static UnivariateRealFunction multiply(final UnivariateRealFunction ... f) {
+        return new UnivariateRealFunction() {
+            /** {@inheritDoc} */
+            public double value(double x) {
+                double r = f[0].value(x);
+                for (int i = 1; i < f.length; i++) {
+                    r *= f[i].value(x);
+                }
+                return r;
+            }
+        };
+    }
+
+    /**
+     * Combine functions.
+     *
+     * @param combiner Combiner function.
+     * @param f Function.
+     * @param g Function.
+     * @return the composed function.
+     */
+    public static UnivariateRealFunction combine(final BivariateRealFunction combiner,
+                                                 final UnivariateRealFunction f,
+                                                 final UnivariateRealFunction g) {
+        return new UnivariateRealFunction() {
+            /** {@inheritDoc} */
+            public double value(double x) {
+                return combiner.value(f.value(x), g.value(x));
+            }
+        };
+    }
+
+    /**
+     * Generate a collector function.
+     *
+     * @param combiner Combiner function.
+     * @param f Function.
+     * @param initialValue Initial value.
+     * @return a collector function.
+     */
+    public static MultivariateRealFunction collector(final BivariateRealFunction combiner,
+                                                     final UnivariateRealFunction f,
+                                                     final double initialValue) {
+        return new MultivariateRealFunction() {
+            /** {@inheritDoc} */
+            public double value(double[] point) {
+                double result = combiner.value(initialValue, f.value(point[0]));
+                for (int i = 1; i < point.length; i++) {
+                    result = combiner.value(result, f.value(point[i]));
+                }
+                return result;
+            }
+        };
+    }
+
+    /**
+     * Generate a collector function.
+     *
+     * @param combiner Combiner function.
+     * @param initialValue Initial value.
+     * @return a collector function.
+     */
+    public static MultivariateRealFunction collector(final BivariateRealFunction combiner,
+                                                     final double initialValue) {
+        return collector(combiner, new Identity(), initialValue);
+    }
+
+    /**
+     * Create a unary function by fixing the first argument of a binary function.
+     *
+     * @param f Binary function.
+     * @param fixed Value to which the first argument of {@code f} is set.
+     */
+    public static UnivariateRealFunction fix1stArgument(final BivariateRealFunction f,
+                                                        final double fixed) {
+        return new UnivariateRealFunction() {
+            /** {@inheritDoc} */
+            public double value(double x) {
+                return f.value(fixed, x);
+            }
+        };
+    }
+    /**
+     * Create a unary function by fixing the second argument of a binary function.
+     *
+     * @param f Binary function.
+     * @param fixed Value to which the second argument of {@code f} is set.
+     */
+    public static UnivariateRealFunction fix2ndArgument(final BivariateRealFunction f,
+                                                        final double fixed) {
+        return new UnivariateRealFunction() {
+            /** {@inheritDoc} */
+            public double value(double x) {
+                return f.value(x, fixed);
+            }
+        };
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Abs.java b/src/main/java/org/apache/commons/math/analysis/function/Abs.java
new file mode 100644
index 000000000..41743f9a7
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Abs.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Absolute value function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Abs implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.abs(x);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Acos.java b/src/main/java/org/apache/commons/math/analysis/function/Acos.java
new file mode 100644
index 000000000..4a5681bdb
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Acos.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Arc-cosine function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Acos implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.acos(x);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Acosh.java b/src/main/java/org/apache/commons/math/analysis/function/Acosh.java
new file mode 100644
index 000000000..84b1b1c78
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Acosh.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Hyperbolic arc-cosine function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Acosh implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.acosh(x);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Add.java b/src/main/java/org/apache/commons/math/analysis/function/Add.java
new file mode 100644
index 000000000..37cfc86aa
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Add.java
@@ -0,0 +1,33 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.BivariateRealFunction;
+
+/**
+ * Add the two operands.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Add implements BivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x, double y) {
+        return x + y;
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Asin.java b/src/main/java/org/apache/commons/math/analysis/function/Asin.java
new file mode 100644
index 000000000..b0aa43751
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Asin.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Arc-sine function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Asin implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.asin(x);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Asinh.java b/src/main/java/org/apache/commons/math/analysis/function/Asinh.java
new file mode 100644
index 000000000..c3b9d9da9
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Asinh.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Hyperbolic arc-sine function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Asinh implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.asinh(x);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Atan.java b/src/main/java/org/apache/commons/math/analysis/function/Atan.java
new file mode 100644
index 000000000..5b8411117
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Atan.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Arc-tangent function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Atan implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.atan(x);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Atan2.java b/src/main/java/org/apache/commons/math/analysis/function/Atan2.java
new file mode 100644
index 000000000..33b173d1e
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Atan2.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.BivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Arc-tangent function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Atan2 implements BivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x, double y) {
+        return FastMath.atan2(x, y);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Atanh.java b/src/main/java/org/apache/commons/math/analysis/function/Atanh.java
new file mode 100644
index 000000000..92f20ebec
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Atanh.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Hyperbolic arc-tangent function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Atanh implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.atanh(x);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Cbrt.java b/src/main/java/org/apache/commons/math/analysis/function/Cbrt.java
new file mode 100644
index 000000000..42c7924ea
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Cbrt.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Cubic-root function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Cbrt implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.cbrt(x);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Constant.java b/src/main/java/org/apache/commons/math/analysis/function/Constant.java
new file mode 100644
index 000000000..10f5b7f74
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Constant.java
@@ -0,0 +1,43 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+
+/**
+ * Constant function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Constant implements UnivariateRealFunction {
+    /** Constant. */
+    private final double c;
+
+    /**
+     * @param c Constant.
+     */
+    public Constant(double c) {
+        this.c = c;
+    }
+
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return c;
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Cos.java b/src/main/java/org/apache/commons/math/analysis/function/Cos.java
new file mode 100644
index 000000000..be26a761e
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Cos.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Cosine function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Cos implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.cos(x);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Cosh.java b/src/main/java/org/apache/commons/math/analysis/function/Cosh.java
new file mode 100644
index 000000000..c17f52f62
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Cosh.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Hyperbolic cosine function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Cosh implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.cosh(x);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Divide.java b/src/main/java/org/apache/commons/math/analysis/function/Divide.java
new file mode 100644
index 000000000..52aae1ac5
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Divide.java
@@ -0,0 +1,33 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.BivariateRealFunction;
+
+/**
+ * Divide the first operand by the second.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Divide implements BivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x, double y) {
+        return x / y;
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Exp.java b/src/main/java/org/apache/commons/math/analysis/function/Exp.java
new file mode 100644
index 000000000..40b73ee48
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Exp.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Exponential function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Exp implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.exp(x);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Expm1.java b/src/main/java/org/apache/commons/math/analysis/function/Expm1.java
new file mode 100644
index 000000000..de72c5006
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Expm1.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * <code>e<sup>x</sup>-1</code> function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Expm1 implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.expm1(x);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Identity.java b/src/main/java/org/apache/commons/math/analysis/function/Identity.java
new file mode 100644
index 000000000..119c9f356
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Identity.java
@@ -0,0 +1,33 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+
+/**
+ * Identity function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Identity implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return x;
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Inverse.java b/src/main/java/org/apache/commons/math/analysis/function/Inverse.java
new file mode 100644
index 000000000..2a5c91d3a
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Inverse.java
@@ -0,0 +1,33 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+
+/**
+ * Inverse function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Inverse implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return 1 / x;
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Log.java b/src/main/java/org/apache/commons/math/analysis/function/Log.java
new file mode 100644
index 000000000..c906d99e9
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Log.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Natural logarithm function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Log implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.log(x);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Log10.java b/src/main/java/org/apache/commons/math/analysis/function/Log10.java
new file mode 100644
index 000000000..50cbd0986
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Log10.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Base 10 logarithm function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Log10 implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.log10(x);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Log1p.java b/src/main/java/org/apache/commons/math/analysis/function/Log1p.java
new file mode 100644
index 000000000..0fda78dec
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Log1p.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * <code>log(1 + p)</code> function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Log1p implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.log1p(x);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Max.java b/src/main/java/org/apache/commons/math/analysis/function/Max.java
new file mode 100644
index 000000000..d211aec63
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Max.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.BivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Maximum function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Max implements BivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x, double y) {
+        return FastMath.max(x, y);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Min.java b/src/main/java/org/apache/commons/math/analysis/function/Min.java
new file mode 100644
index 000000000..35851afb3
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Min.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.BivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Minimum function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Min implements BivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x, double y) {
+        return FastMath.min(x, y);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Minus.java b/src/main/java/org/apache/commons/math/analysis/function/Minus.java
new file mode 100644
index 000000000..68ee6a287
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Minus.java
@@ -0,0 +1,33 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+
+/**
+ * Minus function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Minus implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return -x;
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Multiply.java b/src/main/java/org/apache/commons/math/analysis/function/Multiply.java
new file mode 100644
index 000000000..e300f7f16
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Multiply.java
@@ -0,0 +1,33 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.BivariateRealFunction;
+
+/**
+ * Multiply the two operands.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Multiply implements BivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x, double y) {
+        return x * y;
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Pow.java b/src/main/java/org/apache/commons/math/analysis/function/Pow.java
new file mode 100644
index 000000000..7882e017d
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Pow.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.BivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Power function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Pow implements BivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x, double y) {
+        return FastMath.pow(x, y);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Power.java b/src/main/java/org/apache/commons/math/analysis/function/Power.java
new file mode 100644
index 000000000..2d8eb35e7
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Power.java
@@ -0,0 +1,44 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Power function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Power implements UnivariateRealFunction {
+    /** Power. */
+    private final double p;
+
+    /**
+     * @param p Power.
+     */
+    public Power(double p) {
+        this.p = p;
+    }
+
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.pow(x, p);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Sin.java b/src/main/java/org/apache/commons/math/analysis/function/Sin.java
new file mode 100644
index 000000000..7c5ad2ab3
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Sin.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Sine function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Sin implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.sin(x);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Sinc.java b/src/main/java/org/apache/commons/math/analysis/function/Sinc.java
new file mode 100644
index 000000000..8eef63d3e
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Sinc.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Sinc function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Sinc implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.abs(x) < 1e-9 ? 1 : FastMath.sin(x) / x;
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Sinh.java b/src/main/java/org/apache/commons/math/analysis/function/Sinh.java
new file mode 100644
index 000000000..76441a9ea
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Sinh.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Hyperbolic sine function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Sinh implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.sinh(x);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Sqrt.java b/src/main/java/org/apache/commons/math/analysis/function/Sqrt.java
new file mode 100644
index 000000000..a0011c31d
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Sqrt.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Square-root function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Sqrt implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.sqrt(x);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Subtract.java b/src/main/java/org/apache/commons/math/analysis/function/Subtract.java
new file mode 100644
index 000000000..ed2b71d8c
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Subtract.java
@@ -0,0 +1,33 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.BivariateRealFunction;
+
+/**
+ * Subtract the second operand from the first.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Subtract implements BivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x, double y) {
+        return x - y;
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Tan.java b/src/main/java/org/apache/commons/math/analysis/function/Tan.java
new file mode 100644
index 000000000..2a3a87c82
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Tan.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Tangent function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Tan implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.tan(x);
+    }
+}
diff --git a/src/main/java/org/apache/commons/math/analysis/function/Tanh.java b/src/main/java/org/apache/commons/math/analysis/function/Tanh.java
new file mode 100644
index 000000000..dab4f55bd
--- /dev/null
+++ b/src/main/java/org/apache/commons/math/analysis/function/Tanh.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis.function;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.util.FastMath;
+
+/**
+ * Hyperbolic tangent function.
+ *
+ * @version $Revision$ $Date$
+ * @since 3.0
+ */
+public class Tanh implements UnivariateRealFunction {
+    /** {@inheritDoc} */
+    public double value(double x) {
+        return FastMath.tanh(x);
+    }
+}
diff --git a/src/test/java/org/apache/commons/math/analysis/ComposableFunctionTest.java b/src/test/java/org/apache/commons/math/analysis/ComposableFunctionTest.java
index 9e4ac94bf..e46cc5bd5 100644
--- a/src/test/java/org/apache/commons/math/analysis/ComposableFunctionTest.java
+++ b/src/test/java/org/apache/commons/math/analysis/ComposableFunctionTest.java
@@ -21,6 +21,10 @@ import org.apache.commons.math.util.FastMath;
 import org.junit.Assert;
 import org.junit.Test;
 
+/**
+ * @deprecated To be removed when the class {@link ComposableFunction} is removed.
+ */
+@Deprecated
 public class ComposableFunctionTest {
 
     @Test
diff --git a/src/test/java/org/apache/commons/math/analysis/FunctionUtilsTest.java b/src/test/java/org/apache/commons/math/analysis/FunctionUtilsTest.java
new file mode 100644
index 000000000..7c020de2f
--- /dev/null
+++ b/src/test/java/org/apache/commons/math/analysis/FunctionUtilsTest.java
@@ -0,0 +1,148 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.commons.math.analysis;
+
+import org.apache.commons.math.analysis.UnivariateRealFunction;
+import org.apache.commons.math.analysis.function.Identity;
+import org.apache.commons.math.analysis.function.Constant;
+import org.apache.commons.math.analysis.function.Minus;
+import org.apache.commons.math.analysis.function.Inverse;
+import org.apache.commons.math.analysis.function.Power;
+import org.apache.commons.math.analysis.function.Sin;
+import org.apache.commons.math.analysis.function.Sinc;
+import org.apache.commons.math.analysis.BivariateRealFunction;
+import org.apache.commons.math.analysis.function.Add;
+import org.apache.commons.math.analysis.function.Multiply;
+import org.apache.commons.math.analysis.function.Divide;
+import org.apache.commons.math.analysis.function.Min;
+import org.apache.commons.math.analysis.function.Max;
+import org.apache.commons.math.analysis.function.Pow;
+import org.apache.commons.math.analysis.MultivariateRealFunction;
+
+import org.junit.Assert;
+import org.junit.Test;
+
+/**
+ * Test for {@link FunctionUtils}.
+ */
+public class FunctionUtilsTest {
+    private final double EPS = Math.ulp(1d);
+
+    @Test
+    public void testCompose() {
+        UnivariateRealFunction id = new Identity();
+        Assert.assertEquals(3, FunctionUtils.compose(id, id, id).value(3), EPS);
+
+        UnivariateRealFunction c = new Constant(4);
+        Assert.assertEquals(4, FunctionUtils.compose(id, c).value(3), EPS);
+        Assert.assertEquals(4, FunctionUtils.compose(c, id).value(3), EPS);
+
+        UnivariateRealFunction m = new Minus();
+        Assert.assertEquals(-3, FunctionUtils.compose(m).value(3), EPS);
+        Assert.assertEquals(3, FunctionUtils.compose(m, m).value(3), EPS);
+
+        UnivariateRealFunction inv = new Inverse();
+        Assert.assertEquals(-0.25, FunctionUtils.compose(inv, m, c, id).value(3), EPS);
+
+        UnivariateRealFunction pow = new Power(2);
+        Assert.assertEquals(81, FunctionUtils.compose(pow, pow).value(3), EPS);
+    }
+
+    @Test
+    public void testAdd() {
+        UnivariateRealFunction id = new Identity();
+        UnivariateRealFunction c = new Constant(4);
+        UnivariateRealFunction m = new Minus();
+        UnivariateRealFunction inv = new Inverse();
+
+        Assert.assertEquals(4.5, FunctionUtils.add(inv, m, c, id).value(2), EPS);
+        Assert.assertEquals(4 + 2, FunctionUtils.add(c, id).value(2), EPS);
+        Assert.assertEquals(4 - 2, FunctionUtils.add(c, FunctionUtils.compose(m, id)).value(2), EPS);
+    }
+
+    @Test
+    public void testMultiply() {
+        UnivariateRealFunction c = new Constant(4);
+        Assert.assertEquals(16, FunctionUtils.multiply(c, c).value(12345), EPS);
+
+        UnivariateRealFunction inv = new Inverse();
+        UnivariateRealFunction pow = new Power(2);
+        Assert.assertEquals(1, FunctionUtils.multiply(FunctionUtils.compose(inv, pow), pow).value(3.5), EPS);
+    }
+
+    @Test
+    public void testCombine() {
+        BivariateRealFunction bi = new Add();
+        UnivariateRealFunction id = new Identity();
+        UnivariateRealFunction m = new Minus();
+        UnivariateRealFunction c = FunctionUtils.combine(bi, id, m);
+        Assert.assertEquals(0, c.value(2.3456), EPS);
+
+        bi = new Multiply();
+        UnivariateRealFunction inv = new Inverse();
+        c = FunctionUtils.combine(bi, id, inv);
+        Assert.assertEquals(1, c.value(2.3456), EPS);
+    }
+
+    @Test
+    public void testCollector() {
+        BivariateRealFunction bi = new Add();
+        MultivariateRealFunction coll = FunctionUtils.collector(bi, 0);
+        Assert.assertEquals(10, coll.value(new double[] {1, 2, 3, 4}), EPS);
+
+        bi = new Multiply();
+        coll = FunctionUtils.collector(bi, 1);
+        Assert.assertEquals(24, coll.value(new double[] {1, 2, 3, 4}), EPS);
+
+        bi = new Max();
+        coll = FunctionUtils.collector(bi, Double.NEGATIVE_INFINITY);
+        Assert.assertEquals(10, coll.value(new double[] {1, -2, 7.5, 10, -24, 9.99}), 0);
+
+        bi = new Min();
+        coll = FunctionUtils.collector(bi, Double.POSITIVE_INFINITY);
+        Assert.assertEquals(-24, coll.value(new double[] {1, -2, 7.5, 10, -24, 9.99}), 0);
+    }
+
+    @Test
+    public void testSinc() {
+        BivariateRealFunction div = new Divide();
+        UnivariateRealFunction sin = new Sin();
+        UnivariateRealFunction id = new Identity();
+        UnivariateRealFunction sinc1 = FunctionUtils.combine(div, sin, id);
+        UnivariateRealFunction sinc2 = new Sinc();
+
+        for (int i = 0; i < 10; i++) {
+            double x = Math.random();
+            Assert.assertEquals(sinc1.value(x), sinc2.value(x), EPS);
+        }
+    }
+
+    @Test
+    public void testFixingArguments() {
+        UnivariateRealFunction scaler = FunctionUtils.fix1stArgument(new Multiply(), 10);
+        Assert.assertEquals(1.23456, scaler.value(0.123456), EPS);
+
+        UnivariateRealFunction pow1 = new Power(2);
+        UnivariateRealFunction pow2 = FunctionUtils.fix2ndArgument(new Pow(), 2);
+
+        for (int i = 0; i < 10; i++) {
+            double x = Math.random() * 10;
+            Assert.assertEquals(pow1.value(x), pow2.value(x), 0);
+        }
+    }
+}
