<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:25:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MATH-153] RandomDataImpl nextInt(int, int) nextLong(long, long)</title>
                <link>https://issues.apache.org/jira/browse/MATH-153</link>
                <project id="12310485" key="MATH">Commons Math</project>
                    <description>&lt;p&gt;RandomDataImpl.nextInt(Integer.MIN_VALUE, Integer.MAX_VALUE) suffers from overflow errors.&lt;/p&gt;

&lt;p&gt;change&lt;br/&gt;
return lower + (int) (rand.nextDouble() * (upper - lower + 1));&lt;br/&gt;
to&lt;br/&gt;
return (int) (lower + (long) (rand.nextDouble()*((long) upper - lower + 1)));&lt;/p&gt;

&lt;p&gt;additional checks must be made for the nextlong(long, long) method.&lt;br/&gt;
At first I thought about using MathUtils.subAndCheck(long, long) but there is only an int version avalible, and the problem is that subAndCheck internaly uses long values to check for overflow just as my previous channge proposes.  The only thing I can think of is using a BigInteger to check for the number of bits required to express the difference.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12346925">MATH-153</key>
            <summary>RandomDataImpl nextInt(int, int) nextLong(long, long)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="remi_arntzen">Remi Arntzen</reporter>
                        <labels>
                    </labels>
                <created>Mon, 31 Jul 2006 03:48:24 +0000</created>
                <updated>Mon, 23 Jul 2012 23:24:43 +0000</updated>
                            <resolved>Thu, 5 Apr 2007 15:20:45 +0000</resolved>
                                    <version>1.1</version>
                                    <fixVersion>1.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12424472" author="remi_arntzen" created="Mon, 31 Jul 2006 04:16:02 +0000"  >&lt;p&gt;once Math-154 (MathUtils addAndCheck and subAndCheck for long values)&lt;br/&gt;
is commited nextLong(long, long) could become&lt;/p&gt;

&lt;p&gt;public long nextLong(long lower, long upper) {&lt;br/&gt;
    if (lower &amp;gt;= upper) &lt;/p&gt;
{
        throw new IllegalArgumentException(
                &quot;upper bound must be &amp;gt; lower bound&quot;);
    }
&lt;p&gt;    RandomGenerator rand = getRan();&lt;br/&gt;
    boolean overFlow = false;&lt;br/&gt;
    try &lt;/p&gt;
{
        MathUtils.subAndCheck(upper, lower);
    }
&lt;p&gt; catch (ArithmeticException thrown) &lt;/p&gt;
{
        overFlow = true;
    }

&lt;p&gt;    long returnValue;&lt;/p&gt;

&lt;p&gt;    if (upper - lower == Long.MAX_VALUE) &lt;/p&gt;
{
        //upper - lower + 1 = Long.MAX_VALUE + 1 = *overflow error*;
        overFlow = true;
    }

&lt;p&gt;    if (!overFlow) &lt;/p&gt;
{
        returnValue = lower + (long) (rand.nextDouble() * (upper -
                                                           lower + 1)
                                                          );
    }
&lt;p&gt; else {&lt;br/&gt;
        returnValue = rand.nextLong();&lt;br/&gt;
        while (returnValue &amp;gt; upper || returnValue &amp;lt; lower) &lt;/p&gt;
{
            returnValue = rand.nextLong();
        }
&lt;p&gt;    }&lt;br/&gt;
    return returnValue;&lt;br/&gt;
}&lt;/p&gt;</comment>
                            <comment id="12426064" author="psteitz" created="Sun, 6 Aug 2006 15:01:15 +0000"  >&lt;p&gt;Agree this is a bug and should be fixed.   Thanks for reporting this issue.&lt;/p&gt;

&lt;p&gt;Using the added method in &lt;a href=&quot;https://issues.apache.org/jira/browse/MATH-154&quot; title=&quot;MathUtils addAndCheck and subAndCheck for long values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MATH-154&quot;&gt;&lt;del&gt;MATH-154&lt;/del&gt;&lt;/a&gt; to detect overflow in the long case is good.&lt;/p&gt;

&lt;p&gt;There should be a way to avoid the while loop at the end of the long impl.&lt;/p&gt;

&lt;p&gt;We also need test cases to close this.&lt;/p&gt;</comment>
                            <comment id="12426210" author="brentworden" created="Mon, 7 Aug 2006 13:19:58 +0000"  >&lt;p&gt;I think we can avoid the overflow conditions simply by distributing the multiplication of the random value.  With this, the method body would become:&lt;/p&gt;

&lt;p&gt;double r = rand.nextDouble();&lt;br/&gt;
return (int)((r * upper) + ((1.0 - r) * lower) + r);&lt;/p&gt;</comment>
                            <comment id="12487006" author="brentworden" created="Thu, 5 Apr 2007 15:20:45 +0000"  >&lt;p&gt;SVN 525842: Corrected nextInt and nextLong to handle wide value ranges.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12338445" name="Test.diff" size="2747" author="remi_arntzen" created="Wed, 9 Aug 2006 05:58:12 +0000"/>
                            <attachment id="12338418" name="diff.txt" size="948" author="remi_arntzen" created="Tue, 8 Aug 2006 21:47:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34179</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 34 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0rw73:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160860</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>