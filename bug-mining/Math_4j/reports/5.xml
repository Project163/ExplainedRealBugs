<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:25:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MATH-163] The evaluate method and the getResult method of class Variance give different results</title>
                <link>https://issues.apache.org/jira/browse/MATH-163</link>
                <project id="12310485" key="MATH">Commons Math</project>
                    <description>&lt;p&gt;Consider the following test code:&lt;/p&gt;

&lt;p&gt;  // construct an array of input values, containing infinity  &lt;br/&gt;
  double[] values = new double[] &lt;/p&gt;
{1.0, 2.0, Double.POSITIVE_INFINITY}
&lt;p&gt;;&lt;br/&gt;
  // find the variance using Variance.evaluate(double[])&lt;br/&gt;
  Variance var1 = new Variance();&lt;br/&gt;
  double value1 = var1.evaluate(values);&lt;br/&gt;
  // find the variance using Variance.getResult()&lt;br/&gt;
  Variance var2 = new Variance();&lt;br/&gt;
  var2.incrementAll(values);&lt;br/&gt;
  double value2 = var2.getResult();&lt;br/&gt;
  // print out the results&lt;br/&gt;
  System.out.println(value1);&lt;br/&gt;
  System.out.println(value2);&lt;/p&gt;

&lt;p&gt;This code prints out:&lt;/p&gt;

&lt;p&gt;NaN&lt;br/&gt;
Infinity&lt;/p&gt;

&lt;p&gt;So, we get two different variances, depending on the method we use. &lt;br/&gt;
(The same is true when we use Double.NEGATIVE_INFINITY as input value instead of Double.POSITIVE_INFINITY.)&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12366130">MATH-163</key>
            <summary>The evaluate method and the getResult method of class Variance give different results</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="nsmeets">Nele Smeets</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Mar 2007 14:25:04 +0000</created>
                <updated>Thu, 23 Apr 2009 02:26:15 +0000</updated>
                            <resolved>Mon, 11 Jun 2007 04:47:32 +0000</resolved>
                                    <version>1.1</version>
                                    <fixVersion>1.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12485214" author="rwinston@eircom.net" created="Thu, 29 Mar 2007 15:18:50 +0000"  >&lt;p&gt;I guess the correct answer is Inf - although I can see that some other packages return NaN. For instance in R:&lt;/p&gt;

&lt;p&gt;&amp;gt; x=c(1.0,2.0,Inf)&lt;br/&gt;
&amp;gt; var&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; NaN&lt;/p&gt;</comment>
                            <comment id="12485920" author="psteitz" created="Sun, 1 Apr 2007 20:20:44 +0000"  >&lt;p&gt;Thanks for reporting this.  I agree with Rory that the spirit of IEEE754 (which says examine limit as x -&amp;gt; INF when evaluating expressions involving INF) implies the result of this computation should be positive infinity in this particular case, as the getResult() method gives.  For reasons described below, it may be difficult, however, to correctly handle all INF cases without impacting performance, so I am leaning toward WONTFIX at this point; though open to suggestions / patches.&lt;/p&gt;

&lt;p&gt;The reason that the results of the two methods are different is they use different computing formulas.  The getResult method is meant to be used when the data is not persisted - i.e., after repeatedly calling increment, supplying values in a stream (and updating sums), but not storing the whole set of values.  It therefore uses a &quot;one pass&quot; algorithm (&quot;West&apos;s algorithm&quot;, referenced in javadoc) to compute the variance.  The evaluate method exploits the fact that it has the full array of values supplied and uses a two-pass method (&quot;corrected two-pass algorithm&quot; from Chan, Golub, Levesque, Algorithms for Computing the Sample Variance, American Statistician, August 1983).  These methods may give different results in some examples, with the second more accurate.  The javadoc should be improved to make this clearer and to recommend that evaluate  should be preferred over incrementAll-getResult when the full array of values is available.  That I will do.&lt;/p&gt;</comment>
                            <comment id="12503274" author="psteitz" created="Mon, 11 Jun 2007 04:47:32 +0000"  >&lt;p&gt;Javadoc clarification has been made. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34199</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 24 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0rw4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160850</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>