<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:27:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MATH-540] AbstractIntegerDistribution.inverseCumulativeProbability(...) Bug</title>
                <link>https://issues.apache.org/jira/browse/MATH-540</link>
                <project id="12310485" key="MATH">Commons Math</project>
                    <description>&lt;p&gt;The AbstractIntegerDistribution.inverseCumulativeProbability(...) function attempts to decrement the lower bound of discrete distributions to values that go below the lower bound.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12500531">MATH-540</key>
            <summary>AbstractIntegerDistribution.inverseCumulativeProbability(...) Bug</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ole">Ole Solberg</reporter>
                        <labels>
                    </labels>
                <created>Sun, 6 Mar 2011 00:43:45 +0000</created>
                <updated>Sat, 24 Mar 2012 16:16:36 +0000</updated>
                            <resolved>Sun, 12 Jun 2011 05:58:50 +0000</resolved>
                                    <version>2.1</version>
                                    <fixVersion>3.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13003097" author="psteitz" created="Sun, 6 Mar 2011 05:32:11 +0000"  >&lt;p&gt;I don&apos;t think this is a bug.  Per the javadoc, the contract for inverse cum is&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;/**
 * For a random variable {@code X} whose values are distributed according
 * to &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; distribution, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; method returns the largest {@code x}, such
 * that {@code P(X &amp;lt; x) &amp;lt; p}.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This implies that if the first non-zero mass point has probability greater than p, the right value to return is one less than that value, which is whet the method will do.  Your example distribution throws NPE when trying to compute probabilities outside of its domain of support. &lt;/p&gt;</comment>
                            <comment id="13003103" author="ole" created="Sun, 6 Mar 2011 05:58:44 +0000"  >&lt;p&gt;I&apos;m looking at it like this.  I have very simple distribution like the one provided (Four sided dice).  I&apos;m trying to write a simulation that draws values of x for a a set of uniform 0-1 probabilities.  So I&apos;m expecting:&lt;/p&gt;

&lt;p&gt;0 When p is less than or equal to 0.25&lt;br/&gt;
1 When p is greater than 0.25 but less than or equal to 0.50&lt;br/&gt;
2 When p is greater than 0.50 but less than or equal to 0.75&lt;br/&gt;
3 When p is greater than 0.75 but less than or equal to 1.0&lt;/p&gt;

&lt;p&gt;So for the line &lt;/p&gt;

&lt;p&gt;int neverSucceeds = d.inverseCumulativeProbability(0.0001);&lt;/p&gt;

&lt;p&gt;I&apos;m really expecting 0 to be returned.&lt;/p&gt;

&lt;p&gt;Make sense?&lt;/p&gt;</comment>
                            <comment id="13003107" author="psteitz" created="Sun, 6 Mar 2011 06:39:30 +0000"  >&lt;p&gt;I see now that there actually does appear to be an error in the javadoc.  The implementation really returns the largest x such that p(X &amp;lt;= x) &amp;lt;= p.  In the discrete case, &amp;lt;= matters and I think both inequalities in the javadoc should be changed.&lt;/p&gt;

&lt;p&gt;In your example, if the probability distribution vanishes outside 0, 1, 2, 3 and puts .25 mass on each of these values, the inverse cumulative probability function evaluated at .0001 should be -1, as this is the largest value such that &lt;br/&gt;
p(X &amp;lt;= x) &amp;lt;= .0001.&lt;/p&gt;

&lt;p&gt;If you fix your distribution so that both probability and cumulativeProbability return correct values (rather than throwing NPEs) outside of the mass values, you should get -1 returned.&lt;/p&gt;</comment>
                            <comment id="13003178" author="psteitz" created="Sun, 6 Mar 2011 15:16:09 +0000"  >&lt;p&gt;Reading your last comment a little more carefully, it looks like what you are trying to do is implement sampling.  IIUC, something like what you are suggesting should work - you just have an off-by-one problem vis-s-vis the contract of inverse cumulative probabilities as we define them.  I would be +1 for adding direct support for sampling from discrete distributions, but we should open a separate ticket for that.&lt;/p&gt;</comment>
                            <comment id="13003191" author="ole" created="Sun, 6 Mar 2011 17:36:01 +0000"  >&lt;p&gt;OK - I&apos;ll close this one and open a separate ticket.&lt;/p&gt;</comment>
                            <comment id="13003215" author="psteitz" created="Sun, 6 Mar 2011 22:05:34 +0000"  >&lt;p&gt;There is a javadoc bug that needs to be fixed here&lt;/p&gt;</comment>
                            <comment id="13003254" author="ole" created="Mon, 7 Mar 2011 03:41:05 +0000"  >&lt;p&gt;Ooops - Thanks.  &lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;...inverse cumulative probability function evaluated at .0001 should be -1, as this is the largest value such that &lt;br/&gt;
p(X &amp;lt;= x) &amp;lt;= .0001.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It seems to me that users would be better served if it returned 0 and that it is also correct to do so.&lt;/p&gt;

&lt;p&gt;In the definition we say &quot;For a random variables X whose values are distributed according to this distribution...&quot;.&lt;/p&gt;

&lt;p&gt;Suppose the distribution was for a six sided dice.  One could assert that the distribution is only defined for the values 1,2,3,4,5,6.  In this case the inverseCumulativeDistribution returns 0, but that does not have any meaning.  So now developers are forced to define the meaning of 0 for a six sided dice implementation.  &lt;/p&gt;

&lt;p&gt;In Grad school we were taught the the inverse cumulative distribution is for sampling.  So for a six sided dice uniform probabilities less than 1/6 would return 1, less than 2/6 would return 2, etc.&lt;/p&gt;

&lt;p&gt;With the current implementation for values less than 1/6 we get 0 which is meaningless, and the only time we get 6 is when the uniform probability argument is 1.&lt;/p&gt;

&lt;p&gt;So if someone mistakenly tries to use the inverseCumulativeProbability function for sampling the results are going to be wacked.  What is the use case for the inverseCumulativeProbability the way it is right now?&lt;/p&gt;</comment>
                            <comment id="13003369" author="psteitz" created="Mon, 7 Mar 2011 14:39:20 +0000"  >&lt;p&gt;You have a choice in defining the inverse cum whether to define it the way we have or to use and inf rather than a sup.  We can implement sampling using the current impl.  We just need to take into account the way the inverse cum is defined in AbstractIntegerDistribution.  &lt;/p&gt;</comment>
                            <comment id="13003414" author="ole" created="Mon, 7 Mar 2011 16:10:34 +0000"  >&lt;p&gt;OK - I think it&apos;s starting to make more sense to me now.  So when implementing sampling we just add one to the value returned by inverseCumulativeDistribution, unless the uniform probability argument is 1?&lt;/p&gt;</comment>
                            <comment id="13003468" author="psteitz" created="Mon, 7 Mar 2011 17:53:41 +0000"  >&lt;p&gt;I am sorry.  I forgot that we had in fact already implemented this in version 2.2. See AbstractIntegerDistribution#sample.  The base class implementation delegates to RandomDataImpl#nextInversionDeviate (adding one per the last comment).&lt;/p&gt;</comment>
                            <comment id="13003578" author="psteitz" created="Mon, 7 Mar 2011 20:38:50 +0000"  >&lt;p&gt;Sorry for the noise. I closed the wrong ticket.  Still need to fix the javadoc to match behavior and user guide.&lt;/p&gt;</comment>
                            <comment id="13048250" author="psteitz" created="Sun, 12 Jun 2011 05:58:50 +0000"  >&lt;p&gt;Javadoc fixed in trunk r1134866&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12472763" name="DummyDiscreteDistribution.java" size="2325" author="ole" created="Sun, 6 Mar 2011 00:45:04 +0000"/>
                            <attachment id="12472764" name="DummyDiscreteDistributionTest.java" size="603" author="ole" created="Sun, 6 Mar 2011 00:45:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>71391</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 23 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0rtvr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160485</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>