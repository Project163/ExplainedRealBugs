<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:26:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[MATH-475] MathUtils.equals(double, double, double) does not agree with Javadoc</title>
                <link>https://issues.apache.org/jira/browse/MATH-475</link>
                <project id="12310485" key="MATH">Commons Math</project>
                    <description>&lt;p&gt;MathUtils.equals(double, double, double) does not agree with its Javadoc.&lt;/p&gt;

&lt;p&gt;The Javadoc says:&lt;/p&gt;

&lt;p&gt;&quot;Returns true if both arguments are equal or within the range of allowed error (inclusive).&quot;&lt;/p&gt;

&lt;p&gt;However the following test fails:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; top=1.7976931348623184E16;
&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; pen=1.7976931348623182E16;
&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; diff=&lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.abs(top-pen);
assertTrue(MathUtils.equals(top, pen, 1.0)); &lt;span class=&quot;code-comment&quot;&gt;// OK - implies the difference is &amp;lt;= 1.0
&lt;/span&gt;assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;expected &amp;lt; 1.0, but was: &quot;&lt;/span&gt;+diff,diff &amp;lt;= 1.0); &lt;span class=&quot;code-comment&quot;&gt;// reports: expected &amp;lt; 1.0, but was: 2.0&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This discrepancy is because the equals(double, double, double) method also checks to see if the numbers are within one ULP of each other.&lt;/p&gt;

&lt;p&gt;Either the Javadoc needs to be corrected, or the code needs to be corrected to drop the ULP comparison.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12495619">MATH-475</key>
            <summary>MathUtils.equals(double, double, double) does not agree with Javadoc</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sebb">Sebb</reporter>
                        <labels>
                    </labels>
                <created>Fri, 14 Jan 2011 19:51:45 +0000</created>
                <updated>Wed, 23 Mar 2011 20:32:08 +0000</updated>
                            <resolved>Mon, 17 Jan 2011 13:08:25 +0000</resolved>
                                                    <fixVersion>3.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12982004" author="erans" created="Sat, 15 Jan 2011 01:53:08 +0000"  >&lt;blockquote&gt;
&lt;p&gt;assertTrue(MathUtils.equals(top, pen, 1.0)); // OK - implies the difference is &amp;lt;= 1.0&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The comment seems reasonable but I&apos;m not sure that it must be correct when dealing with floating point numbers.&lt;/p&gt;

&lt;p&gt;If we change the definition of &lt;tt&gt;equals(a, b, eps)&lt;/tt&gt; to&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  min(a, b) + abs(eps) &amp;gt;= max(a, b)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;then&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  equals(top, pen, 1.0)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;will return &lt;tt&gt;true&lt;/tt&gt;, because&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; pen + 1.0 = top
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;although&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; pen - top == 2.0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However,&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  equals(top, pen, 0.98)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;will return &lt;tt&gt;false&lt;/tt&gt; because&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  pen + 0.98 == pen
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;IIUC, the issue is: What is the meaning of &lt;tt&gt;equals(a, b, eps)&lt;/tt&gt; when &lt;tt&gt;eps &amp;lt; ulp(max(a, b))&lt;/tt&gt; ?&lt;br/&gt;
Because in that case, I think that the call is equivalent to the strict equality test: &lt;tt&gt;a == b&lt;/tt&gt;, I&apos;d say that the call to &quot;equals&quot; is also meaningless.&lt;/p&gt;

&lt;p&gt;The current implementation short-circuits the problem by assuming that two floating point numbers &lt;tt&gt;a&lt;/tt&gt; and &lt;tt&gt;b&lt;/tt&gt; separated by 1 ulp are equally likely representations of any real number within the interval &lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;a, b&amp;#93;&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="12982118" author="psteitz" created="Sat, 15 Jan 2011 16:13:31 +0000"  >&lt;p&gt;Very interesting example.  How do you come up with this stuff, Sebb?  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I tend to agree with Gilles&apos; view that if if a and b are not distinguishable as doubles, we don&apos;t really have any confidence in the value of abs(a - b), so the short-circuit in the current code is better.  I would say just update the javadoc to make say something like&lt;/p&gt;

&lt;p&gt;&quot;Returns true if the values are indistinguishable as doubles or the difference between them is within the range of allowed error (inclusive).&quot;&lt;/p&gt;</comment>
                            <comment id="12982613" author="sebb@apache.org" created="Mon, 17 Jan 2011 12:14:23 +0000"  >&lt;p&gt;The consensus seems to be to update the Javadoc as follows:&lt;/p&gt;

&lt;p&gt;&quot;Returns true if there is no double value strictly between the arguments or the difference between them is within the range of allowed error (inclusive).&quot;&lt;/p&gt;

&lt;p&gt;I am happy with that.&lt;/p&gt;</comment>
                            <comment id="12982624" author="erans" created="Mon, 17 Jan 2011 13:08:25 +0000"  >&lt;p&gt;Javadoc clarified in revision 1059909.&lt;/p&gt;</comment>
                            <comment id="13010395" author="luc" created="Wed, 23 Mar 2011 20:32:08 +0000"  >&lt;p&gt;Closing issue as it was included in version 2.2, which has been released&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>150601</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 35 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ru9z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160549</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>