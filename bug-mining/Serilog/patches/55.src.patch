diff --git a/Build.ps1 b/Build.ps1
index 1f3a3d71..7c5a85f6 100644
--- a/Build.ps1
+++ b/Build.ps1
@@ -1,16 +1,25 @@
+echo "build: Build started"
+
 Push-Location $PSScriptRoot
 
-if(Test-Path .\artifacts) { Remove-Item .\artifacts -Force -Recurse }
+if(Test-Path .\artifacts) {
+	echo "build: Cleaning .\artifacts"
+	Remove-Item .\artifacts -Force -Recurse
+}
 
 & dotnet restore --no-cache
 
 $branch = @{ $true = $env:APPVEYOR_REPO_BRANCH; $false = $(git symbolic-ref --short -q HEAD) }[$env:APPVEYOR_REPO_BRANCH -ne $NULL];
 $revision = @{ $true = "{0:00000}" -f [convert]::ToInt32("0" + $env:APPVEYOR_BUILD_NUMBER, 10); $false = "local" }[$env:APPVEYOR_BUILD_NUMBER -ne $NULL];
-$suffix = @{ $true = ""; $false = "$branch-$revision"}[$branch -eq "master" -and $revision -ne "local"]
+$suffix = @{ $true = ""; $false = "$($branch.Substring(0, [math]::Min(10,$branch.Length)))-$revision"}[$branch -eq "master" -and $revision -ne "local"]
+
+echo "build: Version suffix is $suffix"
 
 foreach ($src in ls src/*) {
     Push-Location $src
 
+	echo "build: Packaging project in $src"
+
     & dotnet pack -c Release -o ..\..\artifacts --version-suffix=$suffix
     if($LASTEXITCODE -ne 0) { exit 1 }    
 
@@ -20,6 +29,8 @@ foreach ($src in ls src/*) {
 foreach ($test in ls test/*.PerformanceTests) {
     Push-Location $test
 
+	echo "build: Building performance test project in $test"
+
     & dotnet build -c Release
     if($LASTEXITCODE -ne 0) { exit 2 }
 
@@ -29,6 +40,8 @@ foreach ($test in ls test/*.PerformanceTests) {
 foreach ($test in ls test/*.Tests) {
     Push-Location $test
 
+	echo "build: Testing project in $test"
+
     & dotnet test -c Release
     if($LASTEXITCODE -ne 0) { exit 3 }
 
diff --git a/src/Serilog/Settings/KeyValuePairs/KeyValuePairSettings.cs b/src/Serilog/Settings/KeyValuePairs/KeyValuePairSettings.cs
index 5a09a693..3c7c1217 100644
--- a/src/Serilog/Settings/KeyValuePairs/KeyValuePairSettings.cs
+++ b/src/Serilog/Settings/KeyValuePairs/KeyValuePairSettings.cs
@@ -121,11 +121,7 @@ namespace Serilog.Settings.KeyValuePairs
         {
             foreach (var directiveInfo in directives)
             {
-                var target = configurationMethods
-                    .Where(m => m.Name == directiveInfo.Key &&
-                        m.GetParameters().Skip(1).All(p => p.HasDefaultValue || directiveInfo.Any(s => s.Argument == p.Name)))
-                    .OrderByDescending(m => m.GetParameters().Length)
-                    .FirstOrDefault();
+                var target = SelectConfigurationMethod(configurationMethods, directiveInfo.Key, directiveInfo);
 
                 if (target != null)
                 {
@@ -141,6 +137,15 @@ namespace Serilog.Settings.KeyValuePairs
             }
         }
 
+        internal static MethodInfo SelectConfigurationMethod(IEnumerable<MethodInfo> candidateMethods, string name, IEnumerable<MethodArgumentValue> suppliedArgumentValues)
+        {
+            return candidateMethods
+                .Where(m => m.Name == name &&
+                            m.GetParameters().Skip(1).All(p => p.HasDefaultValue || suppliedArgumentValues.Any(s => s.Argument == p.Name)))
+                .OrderByDescending(m => m.GetParameters().Count(p => suppliedArgumentValues.Any(s => s.Argument == p.Name)))
+                .FirstOrDefault();
+        }
+
         internal static IEnumerable<Assembly> LoadConfigurationAssemblies(Dictionary<string, string> directives)
         {
             var configurationAssemblies = new List<Assembly> { typeof(ILogger).GetTypeInfo().Assembly };
@@ -244,7 +249,7 @@ namespace Serilog.Settings.KeyValuePairs
                 .ToList();
         }
 
-        private class MethodArgumentValue
+        internal class MethodArgumentValue
         {
             public string Method { get; set; }
             public string Argument { get; set; }
diff --git a/test/Serilog.Tests/Settings/KeyValuePairSettingsTests.cs b/test/Serilog.Tests/Settings/KeyValuePairSettingsTests.cs
index 12d5d6ea..c5ffcdda 100644
--- a/test/Serilog.Tests/Settings/KeyValuePairSettingsTests.cs
+++ b/test/Serilog.Tests/Settings/KeyValuePairSettingsTests.cs
@@ -102,5 +102,34 @@ namespace Serilog.Tests.AppSettings.Tests
             var result = (object)KeyValuePairSettings.ConvertToType("Serilog.Formatting.Json.JsonFormatter", typeof(ITextFormatter));
             Assert.IsType<JsonFormatter>(result);
         }
+
+        [Fact]
+        public void CallableMethodsAreSelected()
+        {
+            var options = typeof(DummyLoggerConfigurationExtensions).GetTypeInfo().DeclaredMethods.ToList();
+            Assert.Equal(2, options.Count(mi => mi.Name == "DummyRollingFile"));
+            var suppliedArguments = new[]
+            {
+                new KeyValuePairSettings.MethodArgumentValue { Method = "DummyRollingFile", Argument = "pathFormat", Value = "C:\\" },
+            };
+
+            var selected = KeyValuePairSettings.SelectConfigurationMethod(options, "DummyRollingFile", suppliedArguments);
+            Assert.Equal(typeof(string), selected.GetParameters()[1].ParameterType);
+        }
+
+        [Fact]
+        public void MethodsAreSelectedBasedOnCountOfMatchedArguments()
+        {
+            var options = typeof(DummyLoggerConfigurationExtensions).GetTypeInfo().DeclaredMethods.ToList();
+            Assert.Equal(2, options.Count(mi => mi.Name == "DummyRollingFile"));
+            var suppliedArguments = new[]
+            {
+                new KeyValuePairSettings.MethodArgumentValue { Method = "DummyRollingFile", Argument = "pathFormat", Value = "C:\\" },
+                new KeyValuePairSettings.MethodArgumentValue { Method = "DummyRollingFile", Argument = "formatter", Value = "SomeFormatter, SomeAssembly" }
+            };
+
+            var selected = KeyValuePairSettings.SelectConfigurationMethod(options, "DummyRollingFile", suppliedArguments);
+            Assert.Equal(typeof(ITextFormatter), selected.GetParameters()[1].ParameterType);
+        }
     }
 }
\ No newline at end of file
diff --git a/test/TestDummies/DummyLoggerConfigurationExtensions.cs b/test/TestDummies/DummyLoggerConfigurationExtensions.cs
index 5728773a..f9f07a7d 100644
--- a/test/TestDummies/DummyLoggerConfigurationExtensions.cs
+++ b/test/TestDummies/DummyLoggerConfigurationExtensions.cs
@@ -1,4 +1,7 @@
-﻿using Serilog;
+﻿using System;
+using Serilog;
+using Serilog.Events;
+using Serilog.Formatting;
 using Serilog.Configuration;
 
 namespace TestDummies
@@ -9,5 +12,24 @@ namespace TestDummies
         {
             return enrich.With(new DummyThreadIdEnricher());
         }
+
+        public static LoggerConfiguration DummyRollingFile(
+            LoggerSinkConfiguration loggerSinkConfiguration,
+            string pathFormat,
+            LogEventLevel restrictedToMinimumLevel = LevelAlias.Minimum,
+            string outputTemplate = null,
+            IFormatProvider formatProvider = null)
+        {
+            return null;
+        }
+
+        public static LoggerConfiguration DummyRollingFile(
+            LoggerSinkConfiguration loggerSinkConfiguration,
+            ITextFormatter formatter,
+            string pathFormat,
+            LogEventLevel restrictedToMinimumLevel = LevelAlias.Minimum)
+        {
+            return null;
+        }
     }
 }
\ No newline at end of file
