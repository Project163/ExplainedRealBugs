{"url":"https://api.github.com/repos/serilog/serilog/issues/2010","repository_url":"https://api.github.com/repos/serilog/serilog","labels_url":"https://api.github.com/repos/serilog/serilog/issues/2010/labels{/name}","comments_url":"https://api.github.com/repos/serilog/serilog/issues/2010/comments","events_url":"https://api.github.com/repos/serilog/serilog/issues/2010/events","html_url":"https://github.com/serilog/serilog/issues/2010","id":2122184033,"node_id":"I_kwDOAH0Zb85-ffVh","number":2010,"title":"Add `LogEvent.UnstableAssembleFromParts()`","user":{"login":"nblumhardt","id":342712,"node_id":"MDQ6VXNlcjM0MjcxMg==","avatar_url":"https://avatars.githubusercontent.com/u/342712?v=4","gravatar_id":"","url":"https://api.github.com/users/nblumhardt","html_url":"https://github.com/nblumhardt","followers_url":"https://api.github.com/users/nblumhardt/followers","following_url":"https://api.github.com/users/nblumhardt/following{/other_user}","gists_url":"https://api.github.com/users/nblumhardt/gists{/gist_id}","starred_url":"https://api.github.com/users/nblumhardt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nblumhardt/subscriptions","organizations_url":"https://api.github.com/users/nblumhardt/orgs","repos_url":"https://api.github.com/users/nblumhardt/repos","events_url":"https://api.github.com/users/nblumhardt/events{/privacy}","received_events_url":"https://api.github.com/users/nblumhardt/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":28408959,"node_id":"MDU6TGFiZWwyODQwODk1OQ==","url":"https://api.github.com/repos/serilog/serilog/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2024-02-07T04:52:41Z","updated_at":"2024-03-11T23:18:34Z","closed_at":"2024-03-11T23:18:34Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Is your feature request related to a problem? Please describe.**\r\n\r\nLibraries that interop with Serilog frequently need to construct `LogEvent` instances from pre-created parts, such as `MessageTemplate`s, timestamps, and lists of properties.\r\n\r\nFor example, we have one in _Serilog.Extensions.Logging_:\r\n\r\nhttps://github.com/serilog/serilog-extensions-logging/blob/dev/src/Serilog.Extensions.Logging/Extensions/Logging/SerilogLogger.cs#L165\r\n\r\nAnd in _SerilogTracing_ a very similar scenario occurs:\r\n\r\nhttps://github.com/serilog-tracing/serilog-tracing/blob/dev/src/SerilogTracing/Interop/ActivityConvert.cs#L83\r\n\r\nThis has a significant performance cost because the public `LogEvent` constructors require allocations for the inbound `LogEventProperty` instances, an allocation for the internal dictionary, and copying/population to occur.\r\n\r\n**Describe the solution you'd like**\r\n\r\n```csharp\r\nvar evt = LogEvent.UnstableAssembleFromParts(timestamp, ...);\r\n```\r\n\r\nThis method, in particular, would directly accept a `Dictionary<string, LogEventPropertyValue> properties`, and this would be directly used to set the `_properties` field.\r\n\r\nSince this would be for use only in some fairly sophisticated use cases, I think we could avoid having to enumerate the dictionary by requiring pre-validation of property names (just `!string.IsNullOrEmpty()` by the caller.\r\n\r\nThe name includes `Unstable` because it's expected that the signature will change as the internal structure of `LogEvent` changes, and callers would need to be updated appropriately.\r\n\r\n**Describe alternatives you've considered**\r\n\r\nVarious weaker versions, such as accepting enumerators of `KeyValuePair<string, LogEventPropertyValue>`, which end up with only marginally better safety and substantially worse performance.\r\n\r\n**Additional context**\r\n\r\nMight be worth considering this a 4.0 addition, so it's clear which version callers requiring this should depend on.","closed_by":{"login":"nblumhardt","id":342712,"node_id":"MDQ6VXNlcjM0MjcxMg==","avatar_url":"https://avatars.githubusercontent.com/u/342712?v=4","gravatar_id":"","url":"https://api.github.com/users/nblumhardt","html_url":"https://github.com/nblumhardt","followers_url":"https://api.github.com/users/nblumhardt/followers","following_url":"https://api.github.com/users/nblumhardt/following{/other_user}","gists_url":"https://api.github.com/users/nblumhardt/gists{/gist_id}","starred_url":"https://api.github.com/users/nblumhardt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nblumhardt/subscriptions","organizations_url":"https://api.github.com/users/nblumhardt/orgs","repos_url":"https://api.github.com/users/nblumhardt/repos","events_url":"https://api.github.com/users/nblumhardt/events{/privacy}","received_events_url":"https://api.github.com/users/nblumhardt/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/serilog/serilog/issues/2010/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/serilog/serilog/issues/2010/timeline","performed_via_github_app":null,"state_reason":"completed"}