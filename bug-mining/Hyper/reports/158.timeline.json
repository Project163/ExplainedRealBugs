[{"id":1611356581,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTYxMTM1NjU4MQ==","url":"https://api.github.com/repos/hyperium/hyper/issues/events/1611356581","actor":{"login":"scottlamb","id":8949524,"node_id":"MDQ6VXNlcjg5NDk1MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8949524?v=4","gravatar_id":"","url":"https://api.github.com/users/scottlamb","html_url":"https://github.com/scottlamb","followers_url":"https://api.github.com/users/scottlamb/followers","following_url":"https://api.github.com/users/scottlamb/following{/other_user}","gists_url":"https://api.github.com/users/scottlamb/gists{/gist_id}","starred_url":"https://api.github.com/users/scottlamb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scottlamb/subscriptions","organizations_url":"https://api.github.com/users/scottlamb/orgs","repos_url":"https://api.github.com/users/scottlamb/repos","events_url":"https://api.github.com/users/scottlamb/events{/privacy}","received_events_url":"https://api.github.com/users/scottlamb/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2018-05-05T17:24:53Z","performed_via_github_app":null},{"id":1611356582,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE2MTEzNTY1ODI=","url":"https://api.github.com/repos/hyperium/hyper/issues/events/1611356582","actor":{"login":"scottlamb","id":8949524,"node_id":"MDQ6VXNlcjg5NDk1MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8949524?v=4","gravatar_id":"","url":"https://api.github.com/users/scottlamb","html_url":"https://github.com/scottlamb","followers_url":"https://api.github.com/users/scottlamb/followers","following_url":"https://api.github.com/users/scottlamb/following{/other_user}","gists_url":"https://api.github.com/users/scottlamb/gists{/gist_id}","starred_url":"https://api.github.com/users/scottlamb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scottlamb/subscriptions","organizations_url":"https://api.github.com/users/scottlamb/orgs","repos_url":"https://api.github.com/users/scottlamb/repos","events_url":"https://api.github.com/users/scottlamb/events{/privacy}","received_events_url":"https://api.github.com/users/scottlamb/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2018-05-05T17:24:53Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/386832356","html_url":"https://github.com/hyperium/hyper/issues/1508#issuecomment-386832356","issue_url":"https://api.github.com/repos/hyperium/hyper/issues/1508","id":386832356,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NjgzMjM1Ng==","user":{"login":"seanmonstar","id":51479,"node_id":"MDQ6VXNlcjUxNDc5","avatar_url":"https://avatars.githubusercontent.com/u/51479?v=4","gravatar_id":"","url":"https://api.github.com/users/seanmonstar","html_url":"https://github.com/seanmonstar","followers_url":"https://api.github.com/users/seanmonstar/followers","following_url":"https://api.github.com/users/seanmonstar/following{/other_user}","gists_url":"https://api.github.com/users/seanmonstar/gists{/gist_id}","starred_url":"https://api.github.com/users/seanmonstar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seanmonstar/subscriptions","organizations_url":"https://api.github.com/users/seanmonstar/orgs","repos_url":"https://api.github.com/users/seanmonstar/repos","events_url":"https://api.github.com/users/seanmonstar/events{/privacy}","received_events_url":"https://api.github.com/users/seanmonstar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-05T20:23:13Z","updated_at":"2018-05-05T20:23:13Z","body":"cc @carllerche","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/386832356/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"seanmonstar","id":51479,"node_id":"MDQ6VXNlcjUxNDc5","avatar_url":"https://avatars.githubusercontent.com/u/51479?v=4","gravatar_id":"","url":"https://api.github.com/users/seanmonstar","html_url":"https://github.com/seanmonstar","followers_url":"https://api.github.com/users/seanmonstar/followers","following_url":"https://api.github.com/users/seanmonstar/following{/other_user}","gists_url":"https://api.github.com/users/seanmonstar/gists{/gist_id}","starred_url":"https://api.github.com/users/seanmonstar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seanmonstar/subscriptions","organizations_url":"https://api.github.com/users/seanmonstar/orgs","repos_url":"https://api.github.com/users/seanmonstar/repos","events_url":"https://api.github.com/users/seanmonstar/events{/privacy}","received_events_url":"https://api.github.com/users/seanmonstar/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1611420143,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTYxMTQyMDE0Mw==","url":"https://api.github.com/repos/hyperium/hyper/issues/events/1611420143","actor":{"login":"carllerche","id":6180,"node_id":"MDQ6VXNlcjYxODA=","avatar_url":"https://avatars.githubusercontent.com/u/6180?v=4","gravatar_id":"","url":"https://api.github.com/users/carllerche","html_url":"https://github.com/carllerche","followers_url":"https://api.github.com/users/carllerche/followers","following_url":"https://api.github.com/users/carllerche/following{/other_user}","gists_url":"https://api.github.com/users/carllerche/gists{/gist_id}","starred_url":"https://api.github.com/users/carllerche/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/carllerche/subscriptions","organizations_url":"https://api.github.com/users/carllerche/orgs","repos_url":"https://api.github.com/users/carllerche/repos","events_url":"https://api.github.com/users/carllerche/events{/privacy}","received_events_url":"https://api.github.com/users/carllerche/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2018-05-05T20:23:13Z","performed_via_github_app":null},{"id":1611420144,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE2MTE0MjAxNDQ=","url":"https://api.github.com/repos/hyperium/hyper/issues/events/1611420144","actor":{"login":"carllerche","id":6180,"node_id":"MDQ6VXNlcjYxODA=","avatar_url":"https://avatars.githubusercontent.com/u/6180?v=4","gravatar_id":"","url":"https://api.github.com/users/carllerche","html_url":"https://github.com/carllerche","followers_url":"https://api.github.com/users/carllerche/followers","following_url":"https://api.github.com/users/carllerche/following{/other_user}","gists_url":"https://api.github.com/users/carllerche/gists{/gist_id}","starred_url":"https://api.github.com/users/carllerche/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/carllerche/subscriptions","organizations_url":"https://api.github.com/users/carllerche/orgs","repos_url":"https://api.github.com/users/carllerche/repos","events_url":"https://api.github.com/users/carllerche/events{/privacy}","received_events_url":"https://api.github.com/users/carllerche/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2018-05-05T20:23:13Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/386841915","html_url":"https://github.com/hyperium/hyper/issues/1508#issuecomment-386841915","issue_url":"https://api.github.com/repos/hyperium/hyper/issues/1508","id":386841915,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Njg0MTkxNQ==","user":{"login":"carllerche","id":6180,"node_id":"MDQ6VXNlcjYxODA=","avatar_url":"https://avatars.githubusercontent.com/u/6180?v=4","gravatar_id":"","url":"https://api.github.com/users/carllerche","html_url":"https://github.com/carllerche","followers_url":"https://api.github.com/users/carllerche/followers","following_url":"https://api.github.com/users/carllerche/following{/other_user}","gists_url":"https://api.github.com/users/carllerche/gists{/gist_id}","starred_url":"https://api.github.com/users/carllerche/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/carllerche/subscriptions","organizations_url":"https://api.github.com/users/carllerche/orgs","repos_url":"https://api.github.com/users/carllerche/repos","events_url":"https://api.github.com/users/carllerche/events{/privacy}","received_events_url":"https://api.github.com/users/carllerche/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-05T23:23:27Z","updated_at":"2018-05-05T23:23:27Z","body":"The `Buf` trait is kind of like a more specialized `Iterator<Item = u8>`. `IntoBuf` is like `IntoIterator`. You can approximate the answer to \"when should I use `Buf` or `IntoBuf`\" by thinking about `Iterator` and `IntoIterator`.\r\n\r\nRoughly speaking, structs should **usually** be generic over `Buf`. This is assuming that the struct impl only needs to iterate the `Buf` one time (since `Buf` has no `seek`).\r\n\r\n\"Leaf\" APIs should take `IntoBuf` for convenience. This allows passing in `&my_vec` and what not. The leaf apis would immediately convert from `IntoBuf` -> `Buf`.\r\n\r\nIf one needs to iterate a buffer *multiple* types, then taking `IntoBuf` is necessary. However, `IntoBuf` takes `self` by ownership, so the strategy is to bound with `where for<'a> &'a T: IntoBuf`. This allows calling `my_t.into_buf()` multiple times (and iterate the type multiple times).\r\n\r\nI hope this helps.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/386841915/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"carllerche","id":6180,"node_id":"MDQ6VXNlcjYxODA=","avatar_url":"https://avatars.githubusercontent.com/u/6180?v=4","gravatar_id":"","url":"https://api.github.com/users/carllerche","html_url":"https://github.com/carllerche","followers_url":"https://api.github.com/users/carllerche/followers","following_url":"https://api.github.com/users/carllerche/following{/other_user}","gists_url":"https://api.github.com/users/carllerche/gists{/gist_id}","starred_url":"https://api.github.com/users/carllerche/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/carllerche/subscriptions","organizations_url":"https://api.github.com/users/carllerche/orgs","repos_url":"https://api.github.com/users/carllerche/repos","events_url":"https://api.github.com/users/carllerche/events{/privacy}","received_events_url":"https://api.github.com/users/carllerche/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/386924515","html_url":"https://github.com/hyperium/hyper/issues/1508#issuecomment-386924515","issue_url":"https://api.github.com/repos/hyperium/hyper/issues/1508","id":386924515,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NjkyNDUxNQ==","user":{"login":"seanmonstar","id":51479,"node_id":"MDQ6VXNlcjUxNDc5","avatar_url":"https://avatars.githubusercontent.com/u/51479?v=4","gravatar_id":"","url":"https://api.github.com/users/seanmonstar","html_url":"https://github.com/seanmonstar","followers_url":"https://api.github.com/users/seanmonstar/followers","following_url":"https://api.github.com/users/seanmonstar/following{/other_user}","gists_url":"https://api.github.com/users/seanmonstar/gists{/gist_id}","starred_url":"https://api.github.com/users/seanmonstar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seanmonstar/subscriptions","organizations_url":"https://api.github.com/users/seanmonstar/orgs","repos_url":"https://api.github.com/users/seanmonstar/repos","events_url":"https://api.github.com/users/seanmonstar/events{/privacy}","received_events_url":"https://api.github.com/users/seanmonstar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-06T23:20:51Z","updated_at":"2018-05-06T23:20:51Z","body":"Also cc @sfackler, I believe I've noticed you have a custom body implementation.\r\n\r\nSome additional pros of requiring `Buf` is that a custom `Buf` is able to know when partial writes happen, and react, because of the `advance` function. Some examples of what things could do are: update some other flow control mechanism, free some resources, record more exact write stats, or recognize when an error occurs and know how much of a buffer had successfully been written in a drop check.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/386924515/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"seanmonstar","id":51479,"node_id":"MDQ6VXNlcjUxNDc5","avatar_url":"https://avatars.githubusercontent.com/u/51479?v=4","gravatar_id":"","url":"https://api.github.com/users/seanmonstar","html_url":"https://github.com/seanmonstar","followers_url":"https://api.github.com/users/seanmonstar/followers","following_url":"https://api.github.com/users/seanmonstar/following{/other_user}","gists_url":"https://api.github.com/users/seanmonstar/gists{/gist_id}","starred_url":"https://api.github.com/users/seanmonstar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seanmonstar/subscriptions","organizations_url":"https://api.github.com/users/seanmonstar/orgs","repos_url":"https://api.github.com/users/seanmonstar/repos","events_url":"https://api.github.com/users/seanmonstar/events{/privacy}","received_events_url":"https://api.github.com/users/seanmonstar/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1611933292,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTYxMTkzMzI5Mg==","url":"https://api.github.com/repos/hyperium/hyper/issues/events/1611933292","actor":{"login":"sfackler","id":1455697,"node_id":"MDQ6VXNlcjE0NTU2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1455697?v=4","gravatar_id":"","url":"https://api.github.com/users/sfackler","html_url":"https://github.com/sfackler","followers_url":"https://api.github.com/users/sfackler/followers","following_url":"https://api.github.com/users/sfackler/following{/other_user}","gists_url":"https://api.github.com/users/sfackler/gists{/gist_id}","starred_url":"https://api.github.com/users/sfackler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfackler/subscriptions","organizations_url":"https://api.github.com/users/sfackler/orgs","repos_url":"https://api.github.com/users/sfackler/repos","events_url":"https://api.github.com/users/sfackler/events{/privacy}","received_events_url":"https://api.github.com/users/sfackler/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2018-05-06T23:20:52Z","performed_via_github_app":null},{"id":1611933294,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE2MTE5MzMyOTQ=","url":"https://api.github.com/repos/hyperium/hyper/issues/events/1611933294","actor":{"login":"sfackler","id":1455697,"node_id":"MDQ6VXNlcjE0NTU2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1455697?v=4","gravatar_id":"","url":"https://api.github.com/users/sfackler","html_url":"https://github.com/sfackler","followers_url":"https://api.github.com/users/sfackler/followers","following_url":"https://api.github.com/users/sfackler/following{/other_user}","gists_url":"https://api.github.com/users/sfackler/gists{/gist_id}","starred_url":"https://api.github.com/users/sfackler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfackler/subscriptions","organizations_url":"https://api.github.com/users/sfackler/orgs","repos_url":"https://api.github.com/users/sfackler/repos","events_url":"https://api.github.com/users/sfackler/events{/privacy}","received_events_url":"https://api.github.com/users/sfackler/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2018-05-06T23:20:52Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/386967674","html_url":"https://github.com/hyperium/hyper/issues/1508#issuecomment-386967674","issue_url":"https://api.github.com/repos/hyperium/hyper/issues/1508","id":386967674,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Njk2NzY3NA==","user":{"login":"sfackler","id":1455697,"node_id":"MDQ6VXNlcjE0NTU2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1455697?v=4","gravatar_id":"","url":"https://api.github.com/users/sfackler","html_url":"https://github.com/sfackler","followers_url":"https://api.github.com/users/sfackler/followers","following_url":"https://api.github.com/users/sfackler/following{/other_user}","gists_url":"https://api.github.com/users/sfackler/gists{/gist_id}","starred_url":"https://api.github.com/users/sfackler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfackler/subscriptions","organizations_url":"https://api.github.com/users/sfackler/orgs","repos_url":"https://api.github.com/users/sfackler/repos","events_url":"https://api.github.com/users/sfackler/events{/privacy}","received_events_url":"https://api.github.com/users/sfackler/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-07T06:15:23Z","updated_at":"2018-05-07T06:15:23Z","body":"I already use `Bytes` for my body implementation, so this'll be fine for me!","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/386967674/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"sfackler","id":1455697,"node_id":"MDQ6VXNlcjE0NTU2OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1455697?v=4","gravatar_id":"","url":"https://api.github.com/users/sfackler","html_url":"https://github.com/sfackler","followers_url":"https://api.github.com/users/sfackler/followers","following_url":"https://api.github.com/users/sfackler/following{/other_user}","gists_url":"https://api.github.com/users/sfackler/gists{/gist_id}","starred_url":"https://api.github.com/users/sfackler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfackler/subscriptions","organizations_url":"https://api.github.com/users/sfackler/orgs","repos_url":"https://api.github.com/users/sfackler/repos","events_url":"https://api.github.com/users/sfackler/events{/privacy}","received_events_url":"https://api.github.com/users/sfackler/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1613413622,"node_id":"MDEyOkxhYmVsZWRFdmVudDE2MTM0MTM2MjI=","url":"https://api.github.com/repos/hyperium/hyper/issues/events/1613413622","actor":{"login":"seanmonstar","id":51479,"node_id":"MDQ6VXNlcjUxNDc5","avatar_url":"https://avatars.githubusercontent.com/u/51479?v=4","gravatar_id":"","url":"https://api.github.com/users/seanmonstar","html_url":"https://github.com/seanmonstar","followers_url":"https://api.github.com/users/seanmonstar/followers","following_url":"https://api.github.com/users/seanmonstar/following{/other_user}","gists_url":"https://api.github.com/users/seanmonstar/gists{/gist_id}","starred_url":"https://api.github.com/users/seanmonstar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seanmonstar/subscriptions","organizations_url":"https://api.github.com/users/seanmonstar/orgs","repos_url":"https://api.github.com/users/seanmonstar/repos","events_url":"https://api.github.com/users/seanmonstar/events{/privacy}","received_events_url":"https://api.github.com/users/seanmonstar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2018-05-07T17:08:04Z","label":{"name":"A-body","color":"fbca04"},"performed_via_github_app":null},{"id":1613413804,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDE2MTM0MTM4MDQ=","url":"https://api.github.com/repos/hyperium/hyper/issues/events/1613413804","actor":{"login":"seanmonstar","id":51479,"node_id":"MDQ6VXNlcjUxNDc5","avatar_url":"https://avatars.githubusercontent.com/u/51479?v=4","gravatar_id":"","url":"https://api.github.com/users/seanmonstar","html_url":"https://github.com/seanmonstar","followers_url":"https://api.github.com/users/seanmonstar/followers","following_url":"https://api.github.com/users/seanmonstar/following{/other_user}","gists_url":"https://api.github.com/users/seanmonstar/gists{/gist_id}","starred_url":"https://api.github.com/users/seanmonstar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seanmonstar/subscriptions","organizations_url":"https://api.github.com/users/seanmonstar/orgs","repos_url":"https://api.github.com/users/seanmonstar/repos","events_url":"https://api.github.com/users/seanmonstar/events{/privacy}","received_events_url":"https://api.github.com/users/seanmonstar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2018-05-07T17:08:08Z","milestone":{"title":"0.12"},"performed_via_github_app":null},{"id":1613414743,"node_id":"MDExOkNsb3NlZEV2ZW50MTYxMzQxNDc0Mw==","url":"https://api.github.com/repos/hyperium/hyper/issues/events/1613414743","actor":{"login":"seanmonstar","id":51479,"node_id":"MDQ6VXNlcjUxNDc5","avatar_url":"https://avatars.githubusercontent.com/u/51479?v=4","gravatar_id":"","url":"https://api.github.com/users/seanmonstar","html_url":"https://github.com/seanmonstar","followers_url":"https://api.github.com/users/seanmonstar/followers","following_url":"https://api.github.com/users/seanmonstar/following{/other_user}","gists_url":"https://api.github.com/users/seanmonstar/gists{/gist_id}","starred_url":"https://api.github.com/users/seanmonstar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seanmonstar/subscriptions","organizations_url":"https://api.github.com/users/seanmonstar/orgs","repos_url":"https://api.github.com/users/seanmonstar/repos","events_url":"https://api.github.com/users/seanmonstar/events{/privacy}","received_events_url":"https://api.github.com/users/seanmonstar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"a3be110a55571a1ee9a31b2335d7aec27c04e96a","commit_url":"https://api.github.com/repos/hyperium/hyper/commits/a3be110a55571a1ee9a31b2335d7aec27c04e96a","created_at":"2018-05-07T17:08:38Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/388830546","html_url":"https://github.com/hyperium/hyper/issues/1508#issuecomment-388830546","issue_url":"https://api.github.com/repos/hyperium/hyper/issues/1508","id":388830546,"node_id":"MDEyOklzc3VlQ29tbWVudDM4ODgzMDU0Ng==","user":{"login":"scottlamb","id":8949524,"node_id":"MDQ6VXNlcjg5NDk1MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8949524?v=4","gravatar_id":"","url":"https://api.github.com/users/scottlamb","html_url":"https://github.com/scottlamb","followers_url":"https://api.github.com/users/scottlamb/followers","following_url":"https://api.github.com/users/scottlamb/following{/other_user}","gists_url":"https://api.github.com/users/scottlamb/gists{/gist_id}","starred_url":"https://api.github.com/users/scottlamb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scottlamb/subscriptions","organizations_url":"https://api.github.com/users/scottlamb/orgs","repos_url":"https://api.github.com/users/scottlamb/repos","events_url":"https://api.github.com/users/scottlamb/events{/privacy}","received_events_url":"https://api.github.com/users/scottlamb/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-14T14:10:06Z","updated_at":"2018-05-14T14:10:06Z","body":"Thanks for ccing me, and sorry I'm a little late to the party.\r\n\r\nI'm a little confused about the desired benefits. From the first comment, it sounds to me like you're confident that the pre-existing `writev` optimization you mentioned is working well in all the same situations, but you're afraid application writers might not know this. Is that accurate?\r\n\r\n   * If so, it seems like a shame to complicate the interface. Could documentation changes accomplish the same result? (I'd also think anyone who really cares about that will probably end up looking more closely anyway with a profiling tool / strace / etc. to see if whatever they're doing is actually working.)\r\n   * If not, what's the gap you're concerned about? I suppose maybe that there's a race between the application adding a bunch of chunks from another thread and hyper consuming them; if hyper is too fast, less gets combined?\r\n\r\nfwiw, I mentioned [on reddit](https://www.reddit.com/r/rust/comments/8gkcte/new_tokio_release_with_filesystem_support/dyf9lrx/) the idea of a different chunk bound than `AsRef<[u8]>`, but I had a different set of benefits in mind. Maybe `bytes::Buf` is a step toward those as well, but if so the next step isn't obvious to me:\r\n\r\n   * selectively wrapping `blocking` around the dereferences (which is something I'd love to do). Does `Buf` help with this? It's not obvious to me how, but maybe there's some other work here I'm unaware of in tokio/bytes/etc. I guess it might be possible to do this with `Buf` (or even the existing `AsRef<[u8]>`) if `blocking` were split into `start_blocking` and `end_blocking` (the former could be called in `bytes`/`bytes_vec`, and the latter on `drop`), but maybe there's too error-prone an interface because it adds the potential of the calls being unbalanced.\r\n   * perhaps using `sendfile` instead of accessing the bytes at all, when writing directly to a socket (`http` or some fancy Linux thing that tells the kernel to do the outbound encryption.) (This isn't something I personally have any plans now to use, but iirc someone else was asking about it a while back.) Would `bytes::Buf` get some hook for this? (I'm not actually sure how it'd work anyway with the support for `writev` merging across chunks; I guess if you already have a non-empty `IoVec` might merge this chunk into, you'd need some way of deciding not do to that so you can later call `sendfile` instead. So a couple new methods, one to say if it wants sendfile, another to actually use sendfile.)","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/388830546/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"scottlamb","id":8949524,"node_id":"MDQ6VXNlcjg5NDk1MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8949524?v=4","gravatar_id":"","url":"https://api.github.com/users/scottlamb","html_url":"https://github.com/scottlamb","followers_url":"https://api.github.com/users/scottlamb/followers","following_url":"https://api.github.com/users/scottlamb/following{/other_user}","gists_url":"https://api.github.com/users/scottlamb/gists{/gist_id}","starred_url":"https://api.github.com/users/scottlamb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scottlamb/subscriptions","organizations_url":"https://api.github.com/users/scottlamb/orgs","repos_url":"https://api.github.com/users/scottlamb/repos","events_url":"https://api.github.com/users/scottlamb/events{/privacy}","received_events_url":"https://api.github.com/users/scottlamb/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/388900887","html_url":"https://github.com/hyperium/hyper/issues/1508#issuecomment-388900887","issue_url":"https://api.github.com/repos/hyperium/hyper/issues/1508","id":388900887,"node_id":"MDEyOklzc3VlQ29tbWVudDM4ODkwMDg4Nw==","user":{"login":"seanmonstar","id":51479,"node_id":"MDQ6VXNlcjUxNDc5","avatar_url":"https://avatars.githubusercontent.com/u/51479?v=4","gravatar_id":"","url":"https://api.github.com/users/seanmonstar","html_url":"https://github.com/seanmonstar","followers_url":"https://api.github.com/users/seanmonstar/followers","following_url":"https://api.github.com/users/seanmonstar/following{/other_user}","gists_url":"https://api.github.com/users/seanmonstar/gists{/gist_id}","starred_url":"https://api.github.com/users/seanmonstar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seanmonstar/subscriptions","organizations_url":"https://api.github.com/users/seanmonstar/orgs","repos_url":"https://api.github.com/users/seanmonstar/repos","events_url":"https://api.github.com/users/seanmonstar/events{/privacy}","received_events_url":"https://api.github.com/users/seanmonstar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-14T17:37:29Z","updated_at":"2018-05-14T17:37:29Z","body":"> confident that the pre-existing writev optimization you mentioned is working well in all the same situations\r\n\r\nSo, sort of. Say you have 2 large chunks available immediately. You can make them available in `Payload::poll_data`, and hyper will receive them and push them into basically a `VecDeque` of buffers to write, and then `poll_data` says `NotReady` (or `Ready(None)`), hyper will prepare a flush of its queue, using `writev`. So, for users that weren't really trying, hyper will already reduce the amount of copies done.\r\n\r\nBut, maybe you have a whole bunch of slices ready immediately. You *could* push them all individually onto `poll_data`, and just benefit from the internal `VecDeque`, but maybe you could gain a little bit of performance if it were just a single `Buf` (and thus, only a single `poll_data` call), and have some optimized way of accessing all the slices over hyper's generic `VecDeque`.\r\n\r\n> wrapping `blocking` around the dereferences\r\n\r\nhyper doesn't actually dereference the slice, it passes it directly to `AsyncWrite::write`/`AsyncWrite::write_buf`. So, for a `TcpStream`, the dereference would happen in the kernel. If your application anticipates needing to block then, you could provide an `AsyncRead + AsyncWrite` that wraps its write calls in `blocking`, and hyper is none-the-wiser.\r\n\r\n> perhaps using `sendfile` instead of accessing the bytes at all\r\n\r\nI think this would something about `Payload`, not the individual chunks, right? ... Or, perhaps not, if you needed to send multiple files, or only regions of certain files? I've been thinking about this on and off, and I think it could be done best with specialization. If it is for each `Data` chunk, then you could have a `FileRegion` trait implemented on your `Data` chunk, and `AsyncWrite::write_buf` can specialize on that trait, like how `Vec::extend` does.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/388900887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"seanmonstar","id":51479,"node_id":"MDQ6VXNlcjUxNDc5","avatar_url":"https://avatars.githubusercontent.com/u/51479?v=4","gravatar_id":"","url":"https://api.github.com/users/seanmonstar","html_url":"https://github.com/seanmonstar","followers_url":"https://api.github.com/users/seanmonstar/followers","following_url":"https://api.github.com/users/seanmonstar/following{/other_user}","gists_url":"https://api.github.com/users/seanmonstar/gists{/gist_id}","starred_url":"https://api.github.com/users/seanmonstar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seanmonstar/subscriptions","organizations_url":"https://api.github.com/users/seanmonstar/orgs","repos_url":"https://api.github.com/users/seanmonstar/repos","events_url":"https://api.github.com/users/seanmonstar/events{/privacy}","received_events_url":"https://api.github.com/users/seanmonstar/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/389047155","html_url":"https://github.com/hyperium/hyper/issues/1508#issuecomment-389047155","issue_url":"https://api.github.com/repos/hyperium/hyper/issues/1508","id":389047155,"node_id":"MDEyOklzc3VlQ29tbWVudDM4OTA0NzE1NQ==","user":{"login":"scottlamb","id":8949524,"node_id":"MDQ6VXNlcjg5NDk1MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8949524?v=4","gravatar_id":"","url":"https://api.github.com/users/scottlamb","html_url":"https://github.com/scottlamb","followers_url":"https://api.github.com/users/scottlamb/followers","following_url":"https://api.github.com/users/scottlamb/following{/other_user}","gists_url":"https://api.github.com/users/scottlamb/gists{/gist_id}","starred_url":"https://api.github.com/users/scottlamb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scottlamb/subscriptions","organizations_url":"https://api.github.com/users/scottlamb/orgs","repos_url":"https://api.github.com/users/scottlamb/repos","events_url":"https://api.github.com/users/scottlamb/events{/privacy}","received_events_url":"https://api.github.com/users/scottlamb/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-15T05:28:23Z","updated_at":"2018-05-15T05:28:23Z","body":"> maybe you could gain a little bit of performance if it were just a single Buf (and thus, only a single poll_data call), and have some optimized way of accessing all the slices over hyper's generic VecDeque.\r\n\r\nInteresting, thanks. It's not clear to me at first glance that a `poll_data` call or the `VecDeque` operations would be expensive, but I'm sure you've thought about this more than I have.\r\n\r\n>> wrapping blocking around the dereferences\r\n\r\nSorry, I was oversimplifying by partitioning the world into \"my application\" vs \"hyper\" without thinking about the details of how hyper interacts with tokio and such. But hyper is the thing my application is sending the chunks to. If I want to provide an `AsyncWrite` implementation on the other side that selectively uses blocking, how can I pass to it (through hyper) whether this chunk is one that needs `blocking` or not?\r\n\r\n>> I think this would something about Payload, not the individual chunks, right? ... Or, perhaps not, if you needed to send multiple files, or only regions of certain files?\r\n\r\nThere definitely exist applications that do both those things. For example, my [moonfire-nvr](https://github.com/scottlamb/moonfire-nvr) composes arbitrary-length `.mp4` entities from metadata it assembles on-the-fly and from parts of one or more on-disk files.\r\n\r\n> I've been thinking about this on and off, and I think it could be done best with specialization.\r\n\r\nInteresting. I'll have to study how that works. Maybe it's also the answer for my question above about `blocking`. Too bad specialization's still unstable, though.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/389047155/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"scottlamb","id":8949524,"node_id":"MDQ6VXNlcjg5NDk1MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8949524?v=4","gravatar_id":"","url":"https://api.github.com/users/scottlamb","html_url":"https://github.com/scottlamb","followers_url":"https://api.github.com/users/scottlamb/followers","following_url":"https://api.github.com/users/scottlamb/following{/other_user}","gists_url":"https://api.github.com/users/scottlamb/gists{/gist_id}","starred_url":"https://api.github.com/users/scottlamb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scottlamb/subscriptions","organizations_url":"https://api.github.com/users/scottlamb/orgs","repos_url":"https://api.github.com/users/scottlamb/repos","events_url":"https://api.github.com/users/scottlamb/events{/privacy}","received_events_url":"https://api.github.com/users/scottlamb/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"seanmonstar","id":51479,"node_id":"MDQ6VXNlcjUxNDc5","avatar_url":"https://avatars.githubusercontent.com/u/51479?v=4","gravatar_id":"","url":"https://api.github.com/users/seanmonstar","html_url":"https://github.com/seanmonstar","followers_url":"https://api.github.com/users/seanmonstar/followers","following_url":"https://api.github.com/users/seanmonstar/following{/other_user}","gists_url":"https://api.github.com/users/seanmonstar/gists{/gist_id}","starred_url":"https://api.github.com/users/seanmonstar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seanmonstar/subscriptions","organizations_url":"https://api.github.com/users/seanmonstar/orgs","repos_url":"https://api.github.com/users/seanmonstar/repos","events_url":"https://api.github.com/users/seanmonstar/events{/privacy}","received_events_url":"https://api.github.com/users/seanmonstar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-09-14T20:31:21Z","updated_at":"2018-09-14T20:31:21Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/carllerche/tower-web/issues/111","repository_url":"https://api.github.com/repos/carllerche/tower-web","labels_url":"https://api.github.com/repos/carllerche/tower-web/issues/111/labels{/name}","comments_url":"https://api.github.com/repos/carllerche/tower-web/issues/111/comments","events_url":"https://api.github.com/repos/carllerche/tower-web/issues/111/events","html_url":"https://github.com/carllerche/tower-web/issues/111","id":360436748,"node_id":"MDU6SXNzdWUzNjA0MzY3NDg=","number":111,"title":"Could `BufStream` be flattened?","user":{"login":"aturon","id":709807,"node_id":"MDQ6VXNlcjcwOTgwNw==","avatar_url":"https://avatars.githubusercontent.com/u/709807?v=4","gravatar_id":"","url":"https://api.github.com/users/aturon","html_url":"https://github.com/aturon","followers_url":"https://api.github.com/users/aturon/followers","following_url":"https://api.github.com/users/aturon/following{/other_user}","gists_url":"https://api.github.com/users/aturon/gists{/gist_id}","starred_url":"https://api.github.com/users/aturon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aturon/subscriptions","organizations_url":"https://api.github.com/users/aturon/orgs","repos_url":"https://api.github.com/users/aturon/repos","events_url":"https://api.github.com/users/aturon/events{/privacy}","received_events_url":"https://api.github.com/users/aturon/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2018-09-14T20:03:22Z","updated_at":"2018-09-14T21:23:13Z","closed_at":"2018-09-14T21:23:13Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":124959629,"node_id":"MDEwOlJlcG9zaXRvcnkxMjQ5NTk2Mjk=","name":"tower-web","full_name":"carllerche/tower-web","private":false,"owner":{"login":"carllerche","id":6180,"node_id":"MDQ6VXNlcjYxODA=","avatar_url":"https://avatars.githubusercontent.com/u/6180?v=4","gravatar_id":"","url":"https://api.github.com/users/carllerche","html_url":"https://github.com/carllerche","followers_url":"https://api.github.com/users/carllerche/followers","following_url":"https://api.github.com/users/carllerche/following{/other_user}","gists_url":"https://api.github.com/users/carllerche/gists{/gist_id}","starred_url":"https://api.github.com/users/carllerche/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/carllerche/subscriptions","organizations_url":"https://api.github.com/users/carllerche/orgs","repos_url":"https://api.github.com/users/carllerche/repos","events_url":"https://api.github.com/users/carllerche/events{/privacy}","received_events_url":"https://api.github.com/users/carllerche/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/carllerche/tower-web","description":"A fast, boilerplate free, web framework for Rust","fork":false,"url":"https://api.github.com/repos/carllerche/tower-web","forks_url":"https://api.github.com/repos/carllerche/tower-web/forks","keys_url":"https://api.github.com/repos/carllerche/tower-web/keys{/key_id}","collaborators_url":"https://api.github.com/repos/carllerche/tower-web/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/carllerche/tower-web/teams","hooks_url":"https://api.github.com/repos/carllerche/tower-web/hooks","issue_events_url":"https://api.github.com/repos/carllerche/tower-web/issues/events{/number}","events_url":"https://api.github.com/repos/carllerche/tower-web/events","assignees_url":"https://api.github.com/repos/carllerche/tower-web/assignees{/user}","branches_url":"https://api.github.com/repos/carllerche/tower-web/branches{/branch}","tags_url":"https://api.github.com/repos/carllerche/tower-web/tags","blobs_url":"https://api.github.com/repos/carllerche/tower-web/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/carllerche/tower-web/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/carllerche/tower-web/git/refs{/sha}","trees_url":"https://api.github.com/repos/carllerche/tower-web/git/trees{/sha}","statuses_url":"https://api.github.com/repos/carllerche/tower-web/statuses/{sha}","languages_url":"https://api.github.com/repos/carllerche/tower-web/languages","stargazers_url":"https://api.github.com/repos/carllerche/tower-web/stargazers","contributors_url":"https://api.github.com/repos/carllerche/tower-web/contributors","subscribers_url":"https://api.github.com/repos/carllerche/tower-web/subscribers","subscription_url":"https://api.github.com/repos/carllerche/tower-web/subscription","commits_url":"https://api.github.com/repos/carllerche/tower-web/commits{/sha}","git_commits_url":"https://api.github.com/repos/carllerche/tower-web/git/commits{/sha}","comments_url":"https://api.github.com/repos/carllerche/tower-web/comments{/number}","issue_comment_url":"https://api.github.com/repos/carllerche/tower-web/issues/comments{/number}","contents_url":"https://api.github.com/repos/carllerche/tower-web/contents/{+path}","compare_url":"https://api.github.com/repos/carllerche/tower-web/compare/{base}...{head}","merges_url":"https://api.github.com/repos/carllerche/tower-web/merges","archive_url":"https://api.github.com/repos/carllerche/tower-web/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/carllerche/tower-web/downloads","issues_url":"https://api.github.com/repos/carllerche/tower-web/issues{/number}","pulls_url":"https://api.github.com/repos/carllerche/tower-web/pulls{/number}","milestones_url":"https://api.github.com/repos/carllerche/tower-web/milestones{/number}","notifications_url":"https://api.github.com/repos/carllerche/tower-web/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/carllerche/tower-web/labels{/name}","releases_url":"https://api.github.com/repos/carllerche/tower-web/releases{/id}","deployments_url":"https://api.github.com/repos/carllerche/tower-web/deployments","created_at":"2018-03-12T22:31:22Z","updated_at":"2025-10-24T10:15:48Z","pushed_at":"2019-12-06T22:03:32Z","git_url":"git://github.com/carllerche/tower-web.git","ssh_url":"git@github.com:carllerche/tower-web.git","clone_url":"https://github.com/carllerche/tower-web.git","svn_url":"https://github.com/carllerche/tower-web","homepage":"","size":620,"stargazers_count":981,"watchers_count":981,"language":"Rust","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":53,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":84,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":53,"open_issues":84,"watchers":981,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"As currently defined, `BufStream` produces a stream of `Buf` values, which in turn may contain *multiple* `[u8]` slices. I was curious what the tradeoffs were around, instead, having `BufStream` yield `AsRef<[u8]>` directly, thus \"flattening\" these two layers. I'm *pretty sure* there are straightforward ways to translate in either direction, but I may be missing something.","reactions":{"url":"https://api.github.com/repos/carllerche/tower-web/issues/111/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/carllerche/tower-web/issues/111/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"id":12498528161,"node_id":"REFE_lADOAWaYQc4TGtkozwAAAALo-Geh","url":"https://api.github.com/repos/hyperium/hyper/issues/events/12498528161","actor":{"login":"hjr3","id":33318,"node_id":"MDQ6VXNlcjMzMzE4","avatar_url":"https://avatars.githubusercontent.com/u/33318?v=4","gravatar_id":"","url":"https://api.github.com/users/hjr3","html_url":"https://github.com/hjr3","followers_url":"https://api.github.com/users/hjr3/followers","following_url":"https://api.github.com/users/hjr3/following{/other_user}","gists_url":"https://api.github.com/users/hjr3/gists{/gist_id}","starred_url":"https://api.github.com/users/hjr3/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hjr3/subscriptions","organizations_url":"https://api.github.com/users/hjr3/orgs","repos_url":"https://api.github.com/users/hjr3/repos","events_url":"https://api.github.com/users/hjr3/events{/privacy}","received_events_url":"https://api.github.com/users/hjr3/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"a3be110a55571a1ee9a31b2335d7aec27c04e96a","commit_url":"https://api.github.com/repos/hjr3/hyper/commits/a3be110a55571a1ee9a31b2335d7aec27c04e96a","created_at":"2024-04-17T00:15:42Z","performed_via_github_app":null}]