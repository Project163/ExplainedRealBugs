{"url":"https://api.github.com/repos/hyperium/hyper/issues/2826","repository_url":"https://api.github.com/repos/hyperium/hyper","labels_url":"https://api.github.com/repos/hyperium/hyper/issues/2826/labels{/name}","comments_url":"https://api.github.com/repos/hyperium/hyper/issues/2826/comments","events_url":"https://api.github.com/repos/hyperium/hyper/issues/2826/events","html_url":"https://github.com/hyperium/hyper/issues/2826","id":1226704106,"node_id":"I_kwDOAWaYQc5JHgTq","number":2826,"title":"Allow specifying the HTTP/2 SETTINGS_MAX_HEADER_LIST_SIZE","user":{"login":"qinyushun","id":84489880,"node_id":"MDQ6VXNlcjg0NDg5ODgw","avatar_url":"https://avatars.githubusercontent.com/u/84489880?v=4","gravatar_id":"","url":"https://api.github.com/users/qinyushun","html_url":"https://github.com/qinyushun","followers_url":"https://api.github.com/users/qinyushun/followers","following_url":"https://api.github.com/users/qinyushun/following{/other_user}","gists_url":"https://api.github.com/users/qinyushun/gists{/gist_id}","starred_url":"https://api.github.com/users/qinyushun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qinyushun/subscriptions","organizations_url":"https://api.github.com/users/qinyushun/orgs","repos_url":"https://api.github.com/users/qinyushun/repos","events_url":"https://api.github.com/users/qinyushun/events{/privacy}","received_events_url":"https://api.github.com/users/qinyushun/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":128399797,"node_id":"MDU6TGFiZWwxMjgzOTk3OTc=","url":"https://api.github.com/repos/hyperium/hyper/labels/A-server","name":"A-server","color":"fbca04","default":false,"description":"Area: server."},{"id":154002675,"node_id":"MDU6TGFiZWwxNTQwMDI2NzU=","url":"https://api.github.com/repos/hyperium/hyper/labels/E-easy","name":"E-easy","color":"0e8a16","default":false,"description":"Effort: easy. A task that would be a great starting point for a new contributor."},{"id":694496598,"node_id":"MDU6TGFiZWw2OTQ0OTY1OTg=","url":"https://api.github.com/repos/hyperium/hyper/labels/C-feature","name":"C-feature","color":"f9d0c4","default":false,"description":"Category: feature. This is adding a new feature."},{"id":956796120,"node_id":"MDU6TGFiZWw5NTY3OTYxMjA=","url":"https://api.github.com/repos/hyperium/hyper/labels/A-http2","name":"A-http2","color":"fbca04","default":false,"description":"Area: HTTP/2 specific."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2022-05-05T13:51:14Z","updated_at":"2023-02-23T10:33:46Z","closed_at":"2022-05-18T23:52:02Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Version**\r\n0.14.12\r\n\r\n**Description**\r\nHyper does not open the customization of the max_header_list_size method in the H2 third-party software.\r\nThe H2 interface is as follows:\r\n``` rust\r\n/// Sets the max size of received header frames.\r\n    ///\r\n    /// This advisory setting informs a peer of the maximum size of header list\r\n    /// that the sender is prepared to accept, in octets. The value is based on\r\n    /// the uncompressed size of header fields, including the length of the name\r\n    /// and value in octets plus an overhead of 32 octets for each header field.\r\n    ///\r\n    /// This setting is also used to limit the maximum amount of data that is\r\n    /// buffered to decode HEADERS frames.\r\n    ///\r\n    /// # Examples\r\n    ///\r\n    /// ```\r\n    /// # use tokio::io::{AsyncRead, AsyncWrite};\r\n    /// # use h2::server::*;\r\n    /// #\r\n    /// # fn doc<T: AsyncRead + AsyncWrite + Unpin>(my_io: T)\r\n    /// # -> Handshake<T>\r\n    /// # {\r\n    /// // `server_fut` is a future representing the completion of the HTTP/2.0\r\n    /// // handshake.\r\n    /// let server_fut = Builder::new()\r\n    ///     .max_header_list_size(16 * 1024)\r\n    ///     .handshake(my_io);\r\n    /// # server_fut\r\n    /// # }\r\n    /// #\r\n    /// # pub fn main() {}\r\n    /// ```\r\n    pub fn max_header_list_size(&mut self, max: u32) -> &mut Self {\r\n        self.settings.set_max_header_list_size(Some(max));\r\n        self\r\n    }\r\n```\r\nThe default value of max_header_list_size in h2 is 16m.\r\nAs a result, HTTP2 attacks may occur when Hyper is used.\r\n\r\nAttack scenario: Hyper is used as the server and continues to send continuance frames without ending. The data of each continuance frame is 10 KB. Each thread sends 1023 continuance frames, that is, about 10 MB. Multiple threads are started to send continuance frames. As a result, the memory of the service is exploded.\r\n\r\n","closed_by":{"login":"seanmonstar","id":51479,"node_id":"MDQ6VXNlcjUxNDc5","avatar_url":"https://avatars.githubusercontent.com/u/51479?v=4","gravatar_id":"","url":"https://api.github.com/users/seanmonstar","html_url":"https://github.com/seanmonstar","followers_url":"https://api.github.com/users/seanmonstar/followers","following_url":"https://api.github.com/users/seanmonstar/following{/other_user}","gists_url":"https://api.github.com/users/seanmonstar/gists{/gist_id}","starred_url":"https://api.github.com/users/seanmonstar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seanmonstar/subscriptions","organizations_url":"https://api.github.com/users/seanmonstar/orgs","repos_url":"https://api.github.com/users/seanmonstar/repos","events_url":"https://api.github.com/users/seanmonstar/events{/privacy}","received_events_url":"https://api.github.com/users/seanmonstar/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/hyperium/hyper/issues/2826/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/hyperium/hyper/issues/2826/timeline","performed_via_github_app":null,"state_reason":"completed"}