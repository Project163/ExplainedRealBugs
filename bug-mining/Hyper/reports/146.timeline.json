[{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/364689566","html_url":"https://github.com/hyperium/hyper/issues/1439#issuecomment-364689566","issue_url":"https://api.github.com/repos/hyperium/hyper/issues/1439","id":364689566,"node_id":"MDEyOklzc3VlQ29tbWVudDM2NDY4OTU2Ng==","user":{"login":"idubrov","id":434788,"node_id":"MDQ6VXNlcjQzNDc4OA==","avatar_url":"https://avatars.githubusercontent.com/u/434788?v=4","gravatar_id":"","url":"https://api.github.com/users/idubrov","html_url":"https://github.com/idubrov","followers_url":"https://api.github.com/users/idubrov/followers","following_url":"https://api.github.com/users/idubrov/following{/other_user}","gists_url":"https://api.github.com/users/idubrov/gists{/gist_id}","starred_url":"https://api.github.com/users/idubrov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/idubrov/subscriptions","organizations_url":"https://api.github.com/users/idubrov/orgs","repos_url":"https://api.github.com/users/idubrov/repos","events_url":"https://api.github.com/users/idubrov/events{/privacy}","received_events_url":"https://api.github.com/users/idubrov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-10T20:31:13Z","updated_at":"2018-02-11T04:45:45Z","body":"Ok, this seems to be the test case to reproduce this behavior:\r\n\r\n```rust\r\n#[test]\r\nfn client_keep_alive_connreset() {\r\n    use std::sync::mpsc;\r\n    extern crate pretty_env_logger;\r\n    let _ = pretty_env_logger::try_init();\r\n    \r\n    let server = TcpListener::bind(\"127.0.0.1:0\").unwrap();\r\n    let addr = server.local_addr().unwrap();\r\n    let mut core = Core::new().unwrap();\r\n    \r\n    // This one seems to hang forever\r\n    let client = client(&core.handle());\r\n    // This one works as expected (fails, because second connection is not handled by the server)\r\n    //let client = Client::configure()\r\n    //  .keep_alive(false)\r\n    //  .build(&core.handle());\r\n    \r\n    let (tx1, rx1) = oneshot::channel();\r\n    let (tx2, rx2) = mpsc::channel();\r\n    thread::spawn(move || {\r\n        let mut sock = server.accept().unwrap().0;\r\n        //sock.set_read_timeout(Some(Duration::from_secs(5))).unwrap();\r\n        //sock.set_write_timeout(Some(Duration::from_secs(5))).unwrap();\r\n        let mut buf = [0; 4096];\r\n        sock.read(&mut buf).expect(\"read 1\");\r\n        sock.write_all(b\"HTTP/1.1 200 OK\\r\\nContent-Length: 0\\r\\n\\r\\n\").expect(\"write 1\");\r\n        \r\n        // Wait for client to indicate it is done processing the first request\r\n        // This is what seem to trigger the race condition -- without it client notices\r\n        // connection is closed while processing the first request.\r\n        rx2.recv();\r\n        let _r = sock.shutdown(std::net::Shutdown::Both);\r\n        \r\n        // Let client know it can try to reuse the connection\r\n        let _ = tx1.send(());\r\n\r\n        println!(\"we are ready to receive the second connection\");\r\n        let mut _sock = server.accept().unwrap().0;\r\n        println!(\"accepted second connection\");\r\n    });\r\n\r\n    \r\n    let res = client.get(format!(\"http://{}/a\", addr).parse().unwrap());\r\n    core.run(res).unwrap();\r\n    \r\n    tx2.send(());\r\n\r\n    let rx = rx1.map_err(|_| hyper::Error::Io(io::Error::new(io::ErrorKind::Other, \"thread panicked\")));\r\n    core.run(rx).unwrap();\r\n\r\n    println!(\"connecting for the second time -- hangs\");\r\n    let res = client.get(format!(\"http://{}/b\", addr).parse().unwrap());   \r\n    core.run(res).unwrap();\r\n}\r\n```\r\n\r\nP.S. Seems like Hyper tries to re-use pooled connection that was closed on the remote. For some reason, write to the socket on the client side succeeds (doesn't return EPIPE), so Hyper hangs forever (if it was reported, though, I would expect getting \"pooled connection was not ready, this is a hyper bug\"). I don't quite understand why \"event Readable | Hup\" event received earlier does not trigger connection to be evicted from the pool.\r\n\r\nP.P.S. I think, there are two issues here:\r\n\r\n1. Connections are not checked when taken from the pool, so closed connections are reused.\r\n2. When connection is reused, it is not in the same exact state as the new one. It looks to me that important difference is the \"read_blocked\" flag set to \"true\" on reused connection, since it blocks connection from doing \"empty\" read when it is idle. Hacking the code to reset this flags does make the client to fail when it tries to reuse \"bad\" connection (which is not good, but better than simply waiting forever).","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/364689566/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"idubrov","id":434788,"node_id":"MDQ6VXNlcjQzNDc4OA==","avatar_url":"https://avatars.githubusercontent.com/u/434788?v=4","gravatar_id":"","url":"https://api.github.com/users/idubrov","html_url":"https://github.com/idubrov","followers_url":"https://api.github.com/users/idubrov/followers","following_url":"https://api.github.com/users/idubrov/following{/other_user}","gists_url":"https://api.github.com/users/idubrov/gists{/gist_id}","starred_url":"https://api.github.com/users/idubrov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/idubrov/subscriptions","organizations_url":"https://api.github.com/users/idubrov/orgs","repos_url":"https://api.github.com/users/idubrov/repos","events_url":"https://api.github.com/users/idubrov/events{/privacy}","received_events_url":"https://api.github.com/users/idubrov/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1468238480,"node_id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50MTQ2ODIzODQ4MA==","url":"https://api.github.com/repos/hyperium/hyper/issues/events/1468238480","actor":{"login":"idubrov","id":434788,"node_id":"MDQ6VXNlcjQzNDc4OA==","avatar_url":"https://avatars.githubusercontent.com/u/434788?v=4","gravatar_id":"","url":"https://api.github.com/users/idubrov","html_url":"https://github.com/idubrov","followers_url":"https://api.github.com/users/idubrov/followers","following_url":"https://api.github.com/users/idubrov/following{/other_user}","gists_url":"https://api.github.com/users/idubrov/gists{/gist_id}","starred_url":"https://api.github.com/users/idubrov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/idubrov/subscriptions","organizations_url":"https://api.github.com/users/idubrov/orgs","repos_url":"https://api.github.com/users/idubrov/repos","events_url":"https://api.github.com/users/idubrov/events{/privacy}","received_events_url":"https://api.github.com/users/idubrov/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2018-02-11T01:02:31Z","rename":{"from":"Connection stuck when \"keep alive\" is set used","to":"Connection stuck when \"keep alive\" is used"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/365044741","html_url":"https://github.com/hyperium/hyper/issues/1439#issuecomment-365044741","issue_url":"https://api.github.com/repos/hyperium/hyper/issues/1439","id":365044741,"node_id":"MDEyOklzc3VlQ29tbWVudDM2NTA0NDc0MQ==","user":{"login":"seanmonstar","id":51479,"node_id":"MDQ6VXNlcjUxNDc5","avatar_url":"https://avatars.githubusercontent.com/u/51479?v=4","gravatar_id":"","url":"https://api.github.com/users/seanmonstar","html_url":"https://github.com/seanmonstar","followers_url":"https://api.github.com/users/seanmonstar/followers","following_url":"https://api.github.com/users/seanmonstar/following{/other_user}","gists_url":"https://api.github.com/users/seanmonstar/gists{/gist_id}","starred_url":"https://api.github.com/users/seanmonstar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seanmonstar/subscriptions","organizations_url":"https://api.github.com/users/seanmonstar/orgs","repos_url":"https://api.github.com/users/seanmonstar/repos","events_url":"https://api.github.com/users/seanmonstar/events{/privacy}","received_events_url":"https://api.github.com/users/seanmonstar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-12T20:03:18Z","updated_at":"2018-02-12T20:03:18Z","body":"Hey @idubrov, thanks so much for the detailed report, and a test case!\r\n\r\n> For some reason, write to the socket on the client side succeeds (doesn't return EPIPE)\r\n\r\nThe first write can sometimes succeed, since it's just being put in the sndbuf, and then the kernel can try to send in on the wire. Networking is fun!\r\n\r\nLet's see what we can do to fix this:\r\n\r\n1. They sort of are. If the `proto::h1::Conn` gets closed while idle, the handle in the pool should notice that it's been closed (seeing `status() == Disabled`). Are you suggesting that when taking the handle from the pool, the connection should have `read()` called on it again?\r\n2. It does seem like regardless of better detection for 1, it's all around better to error than to hang forever, and so this should probably be done.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/365044741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"seanmonstar","id":51479,"node_id":"MDQ6VXNlcjUxNDc5","avatar_url":"https://avatars.githubusercontent.com/u/51479?v=4","gravatar_id":"","url":"https://api.github.com/users/seanmonstar","html_url":"https://github.com/seanmonstar","followers_url":"https://api.github.com/users/seanmonstar/followers","following_url":"https://api.github.com/users/seanmonstar/following{/other_user}","gists_url":"https://api.github.com/users/seanmonstar/gists{/gist_id}","starred_url":"https://api.github.com/users/seanmonstar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seanmonstar/subscriptions","organizations_url":"https://api.github.com/users/seanmonstar/orgs","repos_url":"https://api.github.com/users/seanmonstar/repos","events_url":"https://api.github.com/users/seanmonstar/events{/privacy}","received_events_url":"https://api.github.com/users/seanmonstar/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1470258094,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTQ3MDI1ODA5NA==","url":"https://api.github.com/repos/hyperium/hyper/issues/events/1470258094","actor":{"login":"idubrov","id":434788,"node_id":"MDQ6VXNlcjQzNDc4OA==","avatar_url":"https://avatars.githubusercontent.com/u/434788?v=4","gravatar_id":"","url":"https://api.github.com/users/idubrov","html_url":"https://github.com/idubrov","followers_url":"https://api.github.com/users/idubrov/followers","following_url":"https://api.github.com/users/idubrov/following{/other_user}","gists_url":"https://api.github.com/users/idubrov/gists{/gist_id}","starred_url":"https://api.github.com/users/idubrov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/idubrov/subscriptions","organizations_url":"https://api.github.com/users/idubrov/orgs","repos_url":"https://api.github.com/users/idubrov/repos","events_url":"https://api.github.com/users/idubrov/events{/privacy}","received_events_url":"https://api.github.com/users/idubrov/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2018-02-12T20:03:18Z","performed_via_github_app":null},{"id":1470258095,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE0NzAyNTgwOTU=","url":"https://api.github.com/repos/hyperium/hyper/issues/events/1470258095","actor":{"login":"idubrov","id":434788,"node_id":"MDQ6VXNlcjQzNDc4OA==","avatar_url":"https://avatars.githubusercontent.com/u/434788?v=4","gravatar_id":"","url":"https://api.github.com/users/idubrov","html_url":"https://github.com/idubrov","followers_url":"https://api.github.com/users/idubrov/followers","following_url":"https://api.github.com/users/idubrov/following{/other_user}","gists_url":"https://api.github.com/users/idubrov/gists{/gist_id}","starred_url":"https://api.github.com/users/idubrov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/idubrov/subscriptions","organizations_url":"https://api.github.com/users/idubrov/orgs","repos_url":"https://api.github.com/users/idubrov/repos","events_url":"https://api.github.com/users/idubrov/events{/privacy}","received_events_url":"https://api.github.com/users/idubrov/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2018-02-12T20:03:18Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/365051360","html_url":"https://github.com/hyperium/hyper/issues/1439#issuecomment-365051360","issue_url":"https://api.github.com/repos/hyperium/hyper/issues/1439","id":365051360,"node_id":"MDEyOklzc3VlQ29tbWVudDM2NTA1MTM2MA==","user":{"login":"idubrov","id":434788,"node_id":"MDQ6VXNlcjQzNDc4OA==","avatar_url":"https://avatars.githubusercontent.com/u/434788?v=4","gravatar_id":"","url":"https://api.github.com/users/idubrov","html_url":"https://github.com/idubrov","followers_url":"https://api.github.com/users/idubrov/followers","following_url":"https://api.github.com/users/idubrov/following{/other_user}","gists_url":"https://api.github.com/users/idubrov/gists{/gist_id}","starred_url":"https://api.github.com/users/idubrov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/idubrov/subscriptions","organizations_url":"https://api.github.com/users/idubrov/orgs","repos_url":"https://api.github.com/users/idubrov/repos","events_url":"https://api.github.com/users/idubrov/events{/privacy}","received_events_url":"https://api.github.com/users/idubrov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-12T20:27:31Z","updated_at":"2018-02-12T20:27:31Z","body":">Are you suggesting that when taking the handle from the pool, the connection should have read() called on it again?\r\n\r\nYes, that's what I think. It looks to me that new connection does read as the first thing (\"try_empty_read\") whereas reused one does not.\r\n\r\nOn a related note, shouldn't the pool itself have a future associated with it to do the bookkeeping of the connections? Otherwise, closed connections will sit in the pool until they are reused?","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/365051360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"idubrov","id":434788,"node_id":"MDQ6VXNlcjQzNDc4OA==","avatar_url":"https://avatars.githubusercontent.com/u/434788?v=4","gravatar_id":"","url":"https://api.github.com/users/idubrov","html_url":"https://github.com/idubrov","followers_url":"https://api.github.com/users/idubrov/followers","following_url":"https://api.github.com/users/idubrov/following{/other_user}","gists_url":"https://api.github.com/users/idubrov/gists{/gist_id}","starred_url":"https://api.github.com/users/idubrov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/idubrov/subscriptions","organizations_url":"https://api.github.com/users/idubrov/orgs","repos_url":"https://api.github.com/users/idubrov/repos","events_url":"https://api.github.com/users/idubrov/events{/privacy}","received_events_url":"https://api.github.com/users/idubrov/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1470777963,"node_id":"MDExOkNsb3NlZEV2ZW50MTQ3MDc3Nzk2Mw==","url":"https://api.github.com/repos/hyperium/hyper/issues/events/1470777963","actor":{"login":"seanmonstar","id":51479,"node_id":"MDQ6VXNlcjUxNDc5","avatar_url":"https://avatars.githubusercontent.com/u/51479?v=4","gravatar_id":"","url":"https://api.github.com/users/seanmonstar","html_url":"https://github.com/seanmonstar","followers_url":"https://api.github.com/users/seanmonstar/followers","following_url":"https://api.github.com/users/seanmonstar/following{/other_user}","gists_url":"https://api.github.com/users/seanmonstar/gists{/gist_id}","starred_url":"https://api.github.com/users/seanmonstar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seanmonstar/subscriptions","organizations_url":"https://api.github.com/users/seanmonstar/orgs","repos_url":"https://api.github.com/users/seanmonstar/repos","events_url":"https://api.github.com/users/seanmonstar/events{/privacy}","received_events_url":"https://api.github.com/users/seanmonstar/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"dc619a8fa01616b260ef32a35b35963460987206","commit_url":"https://api.github.com/repos/hyperium/hyper/commits/dc619a8fa01616b260ef32a35b35963460987206","created_at":"2018-02-13T02:16:50Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/365131887","html_url":"https://github.com/hyperium/hyper/issues/1439#issuecomment-365131887","issue_url":"https://api.github.com/repos/hyperium/hyper/issues/1439","id":365131887,"node_id":"MDEyOklzc3VlQ29tbWVudDM2NTEzMTg4Nw==","user":{"login":"seanmonstar","id":51479,"node_id":"MDQ6VXNlcjUxNDc5","avatar_url":"https://avatars.githubusercontent.com/u/51479?v=4","gravatar_id":"","url":"https://api.github.com/users/seanmonstar","html_url":"https://github.com/seanmonstar","followers_url":"https://api.github.com/users/seanmonstar/followers","following_url":"https://api.github.com/users/seanmonstar/following{/other_user}","gists_url":"https://api.github.com/users/seanmonstar/gists{/gist_id}","starred_url":"https://api.github.com/users/seanmonstar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seanmonstar/subscriptions","organizations_url":"https://api.github.com/users/seanmonstar/orgs","repos_url":"https://api.github.com/users/seanmonstar/repos","events_url":"https://api.github.com/users/seanmonstar/events{/privacy}","received_events_url":"https://api.github.com/users/seanmonstar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-13T02:32:27Z","updated_at":"2018-02-13T02:32:27Z","body":"There should be a fix for this on master, including your test case passing!\r\n\r\n> On a related note, shouldn't the pool itself have a future associated with it to do the bookkeeping of the connections?\r\n\r\nMost likely. However, it not existing doesn't mean closed sockets will be kept around. Those will be dropped and closed. It's just a sender handle in the pool. Still, it'd be better to periodically clean those up...","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/hyperium/hyper/issues/comments/365131887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"seanmonstar","id":51479,"node_id":"MDQ6VXNlcjUxNDc5","avatar_url":"https://avatars.githubusercontent.com/u/51479?v=4","gravatar_id":"","url":"https://api.github.com/users/seanmonstar","html_url":"https://github.com/seanmonstar","followers_url":"https://api.github.com/users/seanmonstar/followers","following_url":"https://api.github.com/users/seanmonstar/following{/other_user}","gists_url":"https://api.github.com/users/seanmonstar/gists{/gist_id}","starred_url":"https://api.github.com/users/seanmonstar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seanmonstar/subscriptions","organizations_url":"https://api.github.com/users/seanmonstar/orgs","repos_url":"https://api.github.com/users/seanmonstar/repos","events_url":"https://api.github.com/users/seanmonstar/events{/privacy}","received_events_url":"https://api.github.com/users/seanmonstar/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"webern","id":6260372,"node_id":"MDQ6VXNlcjYyNjAzNzI=","avatar_url":"https://avatars.githubusercontent.com/u/6260372?v=4","gravatar_id":"","url":"https://api.github.com/users/webern","html_url":"https://github.com/webern","followers_url":"https://api.github.com/users/webern/followers","following_url":"https://api.github.com/users/webern/following{/other_user}","gists_url":"https://api.github.com/users/webern/gists{/gist_id}","starred_url":"https://api.github.com/users/webern/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/webern/subscriptions","organizations_url":"https://api.github.com/users/webern/orgs","repos_url":"https://api.github.com/users/webern/repos","events_url":"https://api.github.com/users/webern/events{/privacy}","received_events_url":"https://api.github.com/users/webern/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-10T17:18:59Z","updated_at":"2020-02-10T17:18:59Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/webern/tough/issues/1","repository_url":"https://api.github.com/repos/webern/tough","labels_url":"https://api.github.com/repos/webern/tough/issues/1/labels{/name}","comments_url":"https://api.github.com/repos/webern/tough/issues/1/comments","events_url":"https://api.github.com/repos/webern/tough/issues/1/events","html_url":"https://github.com/webern/tough/pull/1","id":562690186,"node_id":"MDExOlB1bGxSZXF1ZXN0MzczMjQxMjE3","number":1,"title":"reqwest 0.10.1","user":{"login":"webern","id":6260372,"node_id":"MDQ6VXNlcjYyNjAzNzI=","avatar_url":"https://avatars.githubusercontent.com/u/6260372?v=4","gravatar_id":"","url":"https://api.github.com/users/webern","html_url":"https://github.com/webern","followers_url":"https://api.github.com/users/webern/followers","following_url":"https://api.github.com/users/webern/following{/other_user}","gists_url":"https://api.github.com/users/webern/gists{/gist_id}","starred_url":"https://api.github.com/users/webern/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/webern/subscriptions","organizations_url":"https://api.github.com/users/webern/orgs","repos_url":"https://api.github.com/users/webern/repos","events_url":"https://api.github.com/users/webern/events{/privacy}","received_events_url":"https://api.github.com/users/webern/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-02-10T16:48:47Z","updated_at":"2020-12-24T00:53:59Z","closed_at":"2020-02-10T18:29:23Z","author_association":"OWNER","active_lock_reason":null,"draft":false,"repository":{"id":237078447,"node_id":"MDEwOlJlcG9zaXRvcnkyMzcwNzg0NDc=","name":"tough","full_name":"webern/tough","private":false,"owner":{"login":"webern","id":6260372,"node_id":"MDQ6VXNlcjYyNjAzNzI=","avatar_url":"https://avatars.githubusercontent.com/u/6260372?v=4","gravatar_id":"","url":"https://api.github.com/users/webern","html_url":"https://github.com/webern","followers_url":"https://api.github.com/users/webern/followers","following_url":"https://api.github.com/users/webern/following{/other_user}","gists_url":"https://api.github.com/users/webern/gists{/gist_id}","starred_url":"https://api.github.com/users/webern/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/webern/subscriptions","organizations_url":"https://api.github.com/users/webern/orgs","repos_url":"https://api.github.com/users/webern/repos","events_url":"https://api.github.com/users/webern/events{/privacy}","received_events_url":"https://api.github.com/users/webern/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/webern/tough","description":"Rust libraries and tools for using and generating TUF repositories","fork":true,"url":"https://api.github.com/repos/webern/tough","forks_url":"https://api.github.com/repos/webern/tough/forks","keys_url":"https://api.github.com/repos/webern/tough/keys{/key_id}","collaborators_url":"https://api.github.com/repos/webern/tough/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/webern/tough/teams","hooks_url":"https://api.github.com/repos/webern/tough/hooks","issue_events_url":"https://api.github.com/repos/webern/tough/issues/events{/number}","events_url":"https://api.github.com/repos/webern/tough/events","assignees_url":"https://api.github.com/repos/webern/tough/assignees{/user}","branches_url":"https://api.github.com/repos/webern/tough/branches{/branch}","tags_url":"https://api.github.com/repos/webern/tough/tags","blobs_url":"https://api.github.com/repos/webern/tough/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/webern/tough/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/webern/tough/git/refs{/sha}","trees_url":"https://api.github.com/repos/webern/tough/git/trees{/sha}","statuses_url":"https://api.github.com/repos/webern/tough/statuses/{sha}","languages_url":"https://api.github.com/repos/webern/tough/languages","stargazers_url":"https://api.github.com/repos/webern/tough/stargazers","contributors_url":"https://api.github.com/repos/webern/tough/contributors","subscribers_url":"https://api.github.com/repos/webern/tough/subscribers","subscription_url":"https://api.github.com/repos/webern/tough/subscription","commits_url":"https://api.github.com/repos/webern/tough/commits{/sha}","git_commits_url":"https://api.github.com/repos/webern/tough/git/commits{/sha}","comments_url":"https://api.github.com/repos/webern/tough/comments{/number}","issue_comment_url":"https://api.github.com/repos/webern/tough/issues/comments{/number}","contents_url":"https://api.github.com/repos/webern/tough/contents/{+path}","compare_url":"https://api.github.com/repos/webern/tough/compare/{base}...{head}","merges_url":"https://api.github.com/repos/webern/tough/merges","archive_url":"https://api.github.com/repos/webern/tough/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/webern/tough/downloads","issues_url":"https://api.github.com/repos/webern/tough/issues{/number}","pulls_url":"https://api.github.com/repos/webern/tough/pulls{/number}","milestones_url":"https://api.github.com/repos/webern/tough/milestones{/number}","notifications_url":"https://api.github.com/repos/webern/tough/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/webern/tough/labels{/name}","releases_url":"https://api.github.com/repos/webern/tough/releases{/id}","deployments_url":"https://api.github.com/repos/webern/tough/deployments","created_at":"2020-01-29T20:44:01Z","updated_at":"2023-03-08T16:23:18Z","pushed_at":"2024-03-15T23:12:38Z","git_url":"git://github.com/webern/tough.git","ssh_url":"git@github.com:webern/tough.git","clone_url":"https://github.com/webern/tough.git","svn_url":"https://github.com/webern/tough","homepage":"","size":2256,"stargazers_count":1,"watchers_count":1,"language":"Rust","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":5,"license":null,"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":5,"watchers":1,"default_branch":"develop","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/webern/tough/pulls/1","html_url":"https://github.com/webern/tough/pull/1","diff_url":"https://github.com/webern/tough/pull/1.diff","patch_url":"https://github.com/webern/tough/pull/1.patch","merged_at":"2020-02-10T18:29:23Z"},"body":"In another project we experienced failures using http 1.1 over TLS. This was tracked to `hyper` where we believe we had a slightly different manifestation of this issue [hyper 1439](https://github.com/hyperium/hyper/issues/1439) (in our case a closed connection was being used leading to a \"Failed to fetch\" error).\r\n\r\nThe `hyper` was fixed in `v0.13` which is obtained by bumping `reqwest` from `0.9` to `0.10`.\r\n\r\nIn `reqwest` 0.10 the non-async api is relegated to the `reqwest::blocking` module. This is breaking for customers of `tough` since `pub type HttpTransport = reqwest::Client;` becomes `pub type HttpTransport = reqwest::blocking::Client;`. However the code changes required to accommodate this are as simple as adding `::blocking::` to the path wherever the compiler complains.\r\n\r\nThis change was tested in an update program that uses `tough` and was found to fix the issue.","reactions":{"url":"https://api.github.com/repos/webern/tough/issues/1/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/webern/tough/issues/1/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"webern","id":6260372,"node_id":"MDQ6VXNlcjYyNjAzNzI=","avatar_url":"https://avatars.githubusercontent.com/u/6260372?v=4","gravatar_id":"","url":"https://api.github.com/users/webern","html_url":"https://github.com/webern","followers_url":"https://api.github.com/users/webern/followers","following_url":"https://api.github.com/users/webern/following{/other_user}","gists_url":"https://api.github.com/users/webern/gists{/gist_id}","starred_url":"https://api.github.com/users/webern/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/webern/subscriptions","organizations_url":"https://api.github.com/users/webern/orgs","repos_url":"https://api.github.com/users/webern/repos","events_url":"https://api.github.com/users/webern/events{/privacy}","received_events_url":"https://api.github.com/users/webern/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-10T17:35:59Z","updated_at":"2020-02-10T17:35:59Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/awslabs/tough/issues/55","repository_url":"https://api.github.com/repos/awslabs/tough","labels_url":"https://api.github.com/repos/awslabs/tough/issues/55/labels{/name}","comments_url":"https://api.github.com/repos/awslabs/tough/issues/55/comments","events_url":"https://api.github.com/repos/awslabs/tough/issues/55/events","html_url":"https://github.com/awslabs/tough/pull/55","id":562717691,"node_id":"MDExOlB1bGxSZXF1ZXN0MzczMjYzNjA3","number":55,"title":"bump reqwest version to 0.10.1","user":{"login":"webern","id":6260372,"node_id":"MDQ6VXNlcjYyNjAzNzI=","avatar_url":"https://avatars.githubusercontent.com/u/6260372?v=4","gravatar_id":"","url":"https://api.github.com/users/webern","html_url":"https://github.com/webern","followers_url":"https://api.github.com/users/webern/followers","following_url":"https://api.github.com/users/webern/following{/other_user}","gists_url":"https://api.github.com/users/webern/gists{/gist_id}","starred_url":"https://api.github.com/users/webern/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/webern/subscriptions","organizations_url":"https://api.github.com/users/webern/orgs","repos_url":"https://api.github.com/users/webern/repos","events_url":"https://api.github.com/users/webern/events{/privacy}","received_events_url":"https://api.github.com/users/webern/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-02-10T17:35:58Z","updated_at":"2020-12-24T00:53:59Z","closed_at":"2020-02-10T17:55:08Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":217150169,"node_id":"MDEwOlJlcG9zaXRvcnkyMTcxNTAxNjk=","name":"tough","full_name":"awslabs/tough","private":false,"owner":{"login":"awslabs","id":3299148,"node_id":"MDEyOk9yZ2FuaXphdGlvbjMyOTkxNDg=","avatar_url":"https://avatars.githubusercontent.com/u/3299148?v=4","gravatar_id":"","url":"https://api.github.com/users/awslabs","html_url":"https://github.com/awslabs","followers_url":"https://api.github.com/users/awslabs/followers","following_url":"https://api.github.com/users/awslabs/following{/other_user}","gists_url":"https://api.github.com/users/awslabs/gists{/gist_id}","starred_url":"https://api.github.com/users/awslabs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awslabs/subscriptions","organizations_url":"https://api.github.com/users/awslabs/orgs","repos_url":"https://api.github.com/users/awslabs/repos","events_url":"https://api.github.com/users/awslabs/events{/privacy}","received_events_url":"https://api.github.com/users/awslabs/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/awslabs/tough","description":"Rust libraries and tools for using and generating TUF repositories","fork":false,"url":"https://api.github.com/repos/awslabs/tough","forks_url":"https://api.github.com/repos/awslabs/tough/forks","keys_url":"https://api.github.com/repos/awslabs/tough/keys{/key_id}","collaborators_url":"https://api.github.com/repos/awslabs/tough/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/awslabs/tough/teams","hooks_url":"https://api.github.com/repos/awslabs/tough/hooks","issue_events_url":"https://api.github.com/repos/awslabs/tough/issues/events{/number}","events_url":"https://api.github.com/repos/awslabs/tough/events","assignees_url":"https://api.github.com/repos/awslabs/tough/assignees{/user}","branches_url":"https://api.github.com/repos/awslabs/tough/branches{/branch}","tags_url":"https://api.github.com/repos/awslabs/tough/tags","blobs_url":"https://api.github.com/repos/awslabs/tough/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/awslabs/tough/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/awslabs/tough/git/refs{/sha}","trees_url":"https://api.github.com/repos/awslabs/tough/git/trees{/sha}","statuses_url":"https://api.github.com/repos/awslabs/tough/statuses/{sha}","languages_url":"https://api.github.com/repos/awslabs/tough/languages","stargazers_url":"https://api.github.com/repos/awslabs/tough/stargazers","contributors_url":"https://api.github.com/repos/awslabs/tough/contributors","subscribers_url":"https://api.github.com/repos/awslabs/tough/subscribers","subscription_url":"https://api.github.com/repos/awslabs/tough/subscription","commits_url":"https://api.github.com/repos/awslabs/tough/commits{/sha}","git_commits_url":"https://api.github.com/repos/awslabs/tough/git/commits{/sha}","comments_url":"https://api.github.com/repos/awslabs/tough/comments{/number}","issue_comment_url":"https://api.github.com/repos/awslabs/tough/issues/comments{/number}","contents_url":"https://api.github.com/repos/awslabs/tough/contents/{+path}","compare_url":"https://api.github.com/repos/awslabs/tough/compare/{base}...{head}","merges_url":"https://api.github.com/repos/awslabs/tough/merges","archive_url":"https://api.github.com/repos/awslabs/tough/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/awslabs/tough/downloads","issues_url":"https://api.github.com/repos/awslabs/tough/issues{/number}","pulls_url":"https://api.github.com/repos/awslabs/tough/pulls{/number}","milestones_url":"https://api.github.com/repos/awslabs/tough/milestones{/number}","notifications_url":"https://api.github.com/repos/awslabs/tough/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/awslabs/tough/labels{/name}","releases_url":"https://api.github.com/repos/awslabs/tough/releases{/id}","deployments_url":"https://api.github.com/repos/awslabs/tough/deployments","created_at":"2019-10-23T20:44:14Z","updated_at":"2025-10-08T08:56:15Z","pushed_at":"2025-10-30T14:13:47Z","git_url":"git://github.com/awslabs/tough.git","ssh_url":"git@github.com:awslabs/tough.git","clone_url":"https://github.com/awslabs/tough.git","svn_url":"https://github.com/awslabs/tough","homepage":"","size":2487,"stargazers_count":215,"watchers_count":215,"language":"Rust","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":64,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":63,"license":null,"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":64,"open_issues":63,"watchers":215,"default_branch":"develop","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/awslabs/tough/pulls/55","html_url":"https://github.com/awslabs/tough/pull/55","diff_url":"https://github.com/awslabs/tough/pull/55.diff","patch_url":"https://github.com/awslabs/tough/pull/55.patch","merged_at":"2020-02-10T17:55:08Z"},"body":"*Issue #, if available:*\r\n\r\nN/A\r\n\r\n*Description of changes:*\r\n\r\nIn another project we experienced failures using http 1.1 over TLS. This was tracked to `hyper` where we believe we had a slightly different manifestation of this issue [hyper 1439](https://github.com/hyperium/hyper/issues/1439) (in our case a closed connection was being used leading to a \"Failed to fetch\" error).\r\n\r\nThe `hyper` was fixed in `v0.13` which is obtained by bumping `reqwest` from `0.9` to `0.10`.\r\n\r\nIn `reqwest` 0.10 the non-async api is relegated to the `reqwest::blocking` module. This is breaking for customers of `tough` since `pub type HttpTransport = reqwest::Client;` becomes `pub type HttpTransport = reqwest::blocking::Client;`. However the code changes required to accommodate this are as simple as adding `::blocking::` to the path wherever the compiler complains.\r\n\r\nThis change was tested in an update program that uses `tough` and was found to fix the issue.\r\n\r\nBy submitting this pull request, I confirm that you can use, modify, copy, and redistribute this contribution, under the terms of your choice.\r\n","reactions":{"url":"https://api.github.com/repos/awslabs/tough/issues/55/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/awslabs/tough/issues/55/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":12498527958,"node_id":"REFE_lADOAWaYQc4RpfzMzwAAAALo-GbW","url":"https://api.github.com/repos/hyperium/hyper/issues/events/12498527958","actor":{"login":"hjr3","id":33318,"node_id":"MDQ6VXNlcjMzMzE4","avatar_url":"https://avatars.githubusercontent.com/u/33318?v=4","gravatar_id":"","url":"https://api.github.com/users/hjr3","html_url":"https://github.com/hjr3","followers_url":"https://api.github.com/users/hjr3/followers","following_url":"https://api.github.com/users/hjr3/following{/other_user}","gists_url":"https://api.github.com/users/hjr3/gists{/gist_id}","starred_url":"https://api.github.com/users/hjr3/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hjr3/subscriptions","organizations_url":"https://api.github.com/users/hjr3/orgs","repos_url":"https://api.github.com/users/hjr3/repos","events_url":"https://api.github.com/users/hjr3/events{/privacy}","received_events_url":"https://api.github.com/users/hjr3/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"dc619a8fa01616b260ef32a35b35963460987206","commit_url":"https://api.github.com/repos/hjr3/hyper/commits/dc619a8fa01616b260ef32a35b35963460987206","created_at":"2024-04-17T00:15:40Z","performed_via_github_app":null}]