diff --git a/src/proto/h1/io.rs b/src/proto/h1/io.rs
index 7cfaaaa0..b58c2fea 100644
--- a/src/proto/h1/io.rs
+++ b/src/proto/h1/io.rs
@@ -790,6 +790,7 @@ mod tests {
 
     #[test]
     #[should_panic]
+    #[cfg(debug_assertions)] // needs to trigger a debug_assert
     fn write_buf_requires_non_empty_bufs() {
         let mock = Mock::new().build();
         let mut buffered = Buffered::<_, Cursor<Vec<u8>>>::new(mock);
