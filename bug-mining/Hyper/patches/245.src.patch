diff --git a/src/server/mod.rs b/src/server/mod.rs
index fac33e06..a66cc0fc 100644
--- a/src/server/mod.rs
+++ b/src/server/mod.rs
@@ -61,6 +61,10 @@ cfg_feature! {
     pub mod conn;
     mod server;
     mod shutdown;
-    #[cfg(feature = "tcp")]
-    mod tcp;
+
+    cfg_feature! {
+        #![feature = "tcp"]
+
+        mod tcp;
+    }
 }
