diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/Call/FunctionCallAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/Call/FunctionCallAnalyzer.php
index 0c20f16e2..74d8bf458 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/Call/FunctionCallAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/Call/FunctionCallAnalyzer.php
@@ -852,7 +852,10 @@ class FunctionCallAnalyzer extends CallAnalyzer
             foreach ($changed_var_ids as $var_id => $_) {
                 $first_appearance = $statements_analyzer->getFirstAppearance($var_id);
 
-                if ($first_appearance && $context->vars_in_scope[$var_id]->hasMixed()) {
+                if ($first_appearance
+                    && isset($context->vars_in_scope[$var_id])
+                    && $context->vars_in_scope[$var_id]->hasMixed()
+                ) {
                     if (!$context->collect_initializations
                         && !$context->collect_mutations
                         && $statements_analyzer->getFilePath() === $statements_analyzer->getRootFilePath()
diff --git a/tests/TypeReconciliation/IssetTest.php b/tests/TypeReconciliation/IssetTest.php
index e73c3f382..0a8be3f0c 100644
--- a/tests/TypeReconciliation/IssetTest.php
+++ b/tests/TypeReconciliation/IssetTest.php
@@ -953,6 +953,19 @@ class IssetTest extends \Psalm\Tests\TestCase
                         }
                     }'
             ],
+            'assertOnPossiblyDefined' => [
+                '<?php
+                    function crashes(): void {
+                        if (rand(0,1)) {
+                            $dt = new \DateTime;
+                        }
+                        /**
+                         * @psalm-suppress PossiblyUndefinedVariable
+                         * @psalm-suppress MixedArgument
+                         */
+                        assert($dt);
+                    }'
+            ],
         ];
     }
 
