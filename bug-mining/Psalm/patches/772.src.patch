diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/EncapsulatedStringAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/EncapsulatedStringAnalyzer.php
index 1facfadab..52c7d616d 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/EncapsulatedStringAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/EncapsulatedStringAnalyzer.php
@@ -4,6 +4,7 @@ namespace Psalm\Internal\Analyzer\Statements\Expression;
 use PhpParser;
 use Psalm\Internal\Analyzer\Statements\ExpressionAnalyzer;
 use Psalm\Internal\Analyzer\StatementsAnalyzer;
+use Psalm\CodeLocation;
 use Psalm\Context;
 use Psalm\Type;
 
@@ -14,17 +15,40 @@ class EncapsulatedStringAnalyzer
         PhpParser\Node\Scalar\Encapsed $stmt,
         Context $context
     ) : bool {
+        $codebase = $statements_analyzer->getCodebase();
+
+        $stmt_type = Type::getString();
+
         foreach ($stmt->parts as $part) {
             if (ExpressionAnalyzer::analyze($statements_analyzer, $part, $context) === false) {
                 return false;
             }
 
-            if ($statements_analyzer->node_data->getType($part)) {
+            $part_type = $statements_analyzer->node_data->getType($part);
+
+            if ($part_type) {
                 CastAnalyzer::castStringAttempt($statements_analyzer, $context, $part);
+
+                if ($codebase->taint
+                    && $codebase->config->trackTaintsInPath($statements_analyzer->getFilePath())
+                ) {
+                    $var_location = new CodeLocation($statements_analyzer, $part);
+
+                    $new_parent_node = \Psalm\Internal\Taint\TaintNode::getForAssignment('concat', $var_location);
+                    $codebase->taint->addTaintNode($new_parent_node);
+
+                    $stmt_type->parent_nodes[] = $new_parent_node;
+
+                    if ($part_type->parent_nodes) {
+                        foreach ($part_type->parent_nodes as $parent_node) {
+                            $codebase->taint->addPath($parent_node, $new_parent_node, 'concat');
+                        }
+                    }
+                }
             }
         }
 
-        $statements_analyzer->node_data->setType($stmt, Type::getString());
+        $statements_analyzer->node_data->setType($stmt, $stmt_type);
 
         return true;
     }
diff --git a/tests/TaintTest.php b/tests/TaintTest.php
index 370fda5d0..4440c35a9 100644
--- a/tests/TaintTest.php
+++ b/tests/TaintTest.php
@@ -1839,4 +1839,21 @@ class TaintTest extends TestCase
 
         $this->analyzeFile('somefile.php', new Context());
     }
+
+    public function testEncapsulatedString() : void
+    {
+        $this->expectException(\Psalm\Exception\CodeException::class);
+        $this->expectExceptionMessage('TaintedInput');
+
+        $this->project_analyzer->trackTaintedInputs();
+
+        $this->addFile(
+            'somefile.php',
+            '<?php
+                $unsafe = $_GET[\'unsafe\'];
+                echo "$unsafe";'
+        );
+
+        $this->analyzeFile('somefile.php', new Context());
+    }
 }
