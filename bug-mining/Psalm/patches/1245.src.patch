diff --git a/src/Psalm/Config.php b/src/Psalm/Config.php
index ff01b3a65..be518e0da 100644
--- a/src/Psalm/Config.php
+++ b/src/Psalm/Config.php
@@ -602,24 +602,24 @@ class Config
      * Where key - extension name (without ext- prefix), value - whether to load extensionâ€™s stub.
      *
      * @psalm-readonly-allow-private-mutation
-     * @var array<string, bool>
+     * @var array<string, bool|null>
      */
     public $php_extensions = [
-        "apcu" => false,
-        "decimal" => false,
-        "dom" => false,
-        "ds" => false,
-        "ffi" => false,
-        "geos" => false,
-        "gmp" => false,
-        "mongodb" => false,
-        "mysqli" => false,
-        "pdo" => false,
-        "random" => false,
-        "redis" => false,
-        "simplexml" => false,
-        "soap" => false,
-        "xdebug" => false,
+        "apcu" => null,
+        "decimal" => null,
+        "dom" => null,
+        "ds" => null,
+        "ffi" => null,
+        "geos" => null,
+        "gmp" => null,
+        "mongodb" => null,
+        "mysqli" => null,
+        "pdo" => null,
+        "random" => null,
+        "redis" => null,
+        "simplexml" => null,
+        "soap" => null,
+        "xdebug" => null,
     ];
 
     /**
@@ -2240,7 +2240,8 @@ class Config
         foreach ($extensions_to_load_stubs_using_deprecated_way as $ext_name) {
             $ext_stub_path = $ext_stubs_dir . DIRECTORY_SEPARATOR . "$ext_name.phpstub";
             $is_stub_already_loaded = in_array($ext_stub_path, $this->internal_stubs, true);
-            if (! $is_stub_already_loaded && extension_loaded($ext_name)) {
+            $is_ext_explicitly_disabled = ($this->php_extensions[$ext_name] ?? null) === false;
+            if (! $is_stub_already_loaded && ! $is_ext_explicitly_disabled && extension_loaded($ext_name)) {
                 $this->internal_stubs[] = $ext_stub_path;
                 $this->config_warnings[] = "Psalm 6 will not automatically load stubs for ext-$ext_name."
                     . " You should explicitly enable or disable this ext in composer.json or Psalm config.";
diff --git a/tests/Config/ConfigTest.php b/tests/Config/ConfigTest.php
index 75457a839..973cfea51 100644
--- a/tests/Config/ConfigTest.php
+++ b/tests/Config/ConfigTest.php
@@ -1610,4 +1610,63 @@ class ConfigTest extends TestCase
 
         $this->assertFalse($config->reportIssueInFile('MixedAssignment', realpath('src/Psalm/Type.php')));
     }
+
+    /**
+     * @requires extension apcu
+     * @deprecated Remove in Psalm 6.
+     */
+    public function testConfigWarnsAboutDeprecatedWayToLoadStubsButLoadsTheStub(): void
+    {
+        $config_xml = Config::loadFromXML(
+            (string)getcwd(),
+            '<?xml version="1.0"?>
+                <psalm>
+                    <projectFiles>
+                        <directory name="src" />
+                    </projectFiles>
+                </psalm>',
+        );
+        $this->project_analyzer = $this->getProjectAnalyzerWithConfig($config_xml);
+        $codebase = $this->project_analyzer->getCodebase();
+        $config = $this->project_analyzer->getConfig();
+
+        $config->visitStubFiles($codebase);
+
+        $this->assertContains(realpath('stubs/extensions/apcu.phpstub'), $config->internal_stubs);
+        $this->assertContains(
+            'Psalm 6 will not automatically load stubs for ext-apcu. You should explicitly enable or disable this ext in composer.json or Psalm config.',
+            $config->config_warnings,
+        );
+    }
+
+    /**
+     * @requires extension apcu
+     * @deprecated Remove deprecation warning part in Psalm 6.
+     */
+    public function testConfigWithDisableExtensionsDoesNotLoadExtensionStubsAndHidesDeprecationWarning(): void
+    {
+        $config_xml = Config::loadFromXML(
+            (string)getcwd(),
+            '<?xml version="1.0"?>
+                <psalm>
+                    <projectFiles>
+                        <directory name="src" />
+                    </projectFiles>
+                    <disableExtensions>
+                        <extension name="apcu"/>
+                    </disableExtensions>
+                </psalm>',
+        );
+        $this->project_analyzer = $this->getProjectAnalyzerWithConfig($config_xml);
+        $codebase = $this->project_analyzer->getCodebase();
+        $config = $this->project_analyzer->getConfig();
+
+        $config->visitStubFiles($codebase);
+
+        $this->assertNotContains(realpath('stubs/extensions/apcu.phpstub'), $config->internal_stubs);
+        $this->assertNotContains(
+            'Psalm 6 will not automatically load stubs for ext-apcu. You should explicitly enable or disable this ext in composer.json or Psalm config.',
+            $config->internal_stubs,
+        );
+    }
 }
