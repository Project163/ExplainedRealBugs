diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/AssertionFinder.php b/src/Psalm/Internal/Analyzer/Statements/Expression/AssertionFinder.php
index b2e6e4885..f9198bc08 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/AssertionFinder.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/AssertionFinder.php
@@ -1724,6 +1724,14 @@ class AssertionFinder
             if ($first_var_name) {
                 $if_types[$first_var_name] = [[$prefix . 'callable-string']];
             }
+        } elseif ($expr->name instanceof PhpParser\Node\Name
+            && strtolower($expr->name->parts[0]) === 'method_exists'
+            && isset($expr->args[1])
+            && $expr->args[1]->value instanceof PhpParser\Node\Scalar\String_
+        ) {
+            if ($first_var_name) {
+                $if_types[$first_var_name] = [[$prefix . 'hasmethod-' . $expr->args[1]->value->value]];
+            }
         } elseif (self::hasInArrayCheck($expr)) {
             if ($first_var_name && isset($expr->args[1]->value->inferredType)) {
                 foreach ($expr->args[1]->value->inferredType->getTypes() as $atomic_type) {
diff --git a/src/Psalm/Internal/Analyzer/TypeAnalyzer.php b/src/Psalm/Internal/Analyzer/TypeAnalyzer.php
index 74f23b384..377637933 100644
--- a/src/Psalm/Internal/Analyzer/TypeAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/TypeAnalyzer.php
@@ -1299,6 +1299,17 @@ class TypeAnalyzer
             }
         }
 
+        if (($container_type_part instanceof TString || $container_type_part instanceof TScalar)
+            && $input_type_part instanceof TObjectWithProperties
+            && isset($input_type_part->methods['__toString'])
+        ) {
+            if ($atomic_comparison_result) {
+                $atomic_comparison_result->to_string_cast = true;
+            }
+
+            return true;
+        }
+
         if ($container_type_part instanceof Type\Atomic\TFn && $input_type_part instanceof TCallable) {
             if ($atomic_comparison_result) {
                 $atomic_comparison_result->type_coerced = true;
diff --git a/src/Psalm/Internal/Type/AssertionReconciler.php b/src/Psalm/Internal/Type/AssertionReconciler.php
index d68f25d68..d81db128a 100644
--- a/src/Psalm/Internal/Type/AssertionReconciler.php
+++ b/src/Psalm/Internal/Type/AssertionReconciler.php
@@ -344,6 +344,18 @@ class AssertionReconciler extends \Psalm\Type\Reconciler
             );
         }
 
+        if (substr($assertion, 0, 10) === 'hasmethod-') {
+            return self::reconcileHasMethod(
+                $codebase,
+                substr($assertion, 10),
+                $existing_var_type,
+                $key,
+                $code_location,
+                $suppressed_issues,
+                $failed_reconciliation
+            );
+        }
+
         if (($assertion === 'int' || $assertion === 'float')
             && $existing_var_type->from_calculation
             && $existing_var_type->hasInt()
@@ -782,6 +794,65 @@ class AssertionReconciler extends \Psalm\Type\Reconciler
         return $existing_var_type;
     }
 
+    /**
+     * @param   string[]  $suppressed_issues
+     * @param   0|1|2    $failed_reconciliation
+     */
+    private static function reconcileHasMethod(
+        Codebase $codebase,
+        string $method_id,
+        Union $existing_var_type,
+        ?string $key,
+        ?CodeLocation $code_location,
+        array $suppressed_issues,
+        int &$failed_reconciliation
+    ) : Union {
+        $old_var_type_string = $existing_var_type->getId();
+        $existing_var_atomic_types = $existing_var_type->getTypes();
+
+        $object_types = [];
+        $did_remove_type = false;
+
+        foreach ($existing_var_atomic_types as $type) {
+            if ($type instanceof TNamedObject
+                && $codebase->classOrInterfaceExists($type->value)
+                && $codebase->methodExists($type->value . '::__toString')
+            ) {
+                $object_types[] = $type;
+            } elseif ($type instanceof TObject || $type instanceof TMixed) {
+                $object_types[] = new Atomic\TObjectWithProperties([], ['__toString' => true]);
+                $did_remove_type = true;
+            } elseif ($type instanceof TTemplateParam) {
+                $object_types[] = $type;
+                $did_remove_type = true;
+            } else {
+                $did_remove_type = true;
+            }
+        }
+
+        if (!$object_types || !$did_remove_type) {
+            if ($key && $code_location) {
+                self::triggerIssueForImpossible(
+                    $existing_var_type,
+                    $old_var_type_string,
+                    $key,
+                    'object',
+                    !$did_remove_type,
+                    $code_location,
+                    $suppressed_issues
+                );
+            }
+        }
+
+        if ($object_types) {
+            return new Type\Union($object_types);
+        }
+
+        $failed_reconciliation = 2;
+
+        return Type::getMixed();
+    }
+
     /**
      * @param   string[]  $suppressed_issues
      * @param   0|1|2    $failed_reconciliation
diff --git a/src/Psalm/Type/Atomic/TObjectWithProperties.php b/src/Psalm/Type/Atomic/TObjectWithProperties.php
index 083d16c11..124c1d727 100644
--- a/src/Psalm/Type/Atomic/TObjectWithProperties.php
+++ b/src/Psalm/Type/Atomic/TObjectWithProperties.php
@@ -17,14 +17,21 @@ class TObjectWithProperties extends TObject
      */
     public $properties;
 
+    /**
+     * @var array<string, bool>
+     */
+    public $methods;
+
     /**
      * Constructs a new instance of a generic type
      *
      * @param array<string|int, Union> $properties
+     * @param array<string, bool> $methods
      */
-    public function __construct(array $properties)
+    public function __construct(array $properties, array $methods = [])
     {
         $this->properties = $properties;
+        $this->methods = $methods;
     }
 
     public function __toString()
@@ -35,24 +42,37 @@ class TObjectWithProperties extends TObject
             $extra_types = '&' . implode('&', $this->extra_types);
         }
 
-        return 'object{' .
-                implode(
-                    ', ',
-                    array_map(
-                        /**
-                         * @param  string|int $name
-                         * @param  Union $type
-                         *
-                         * @return string
-                         */
-                        function ($name, Union $type) {
-                            return $name . ($type->possibly_undefined ? '?' : '') . ':' . $type;
-                        },
-                        array_keys($this->properties),
-                        $this->properties
-                    )
-                ) .
-                '}' . $extra_types;
+        $properties_string = implode(
+            ', ',
+            array_map(
+                /**
+                 * @param  string|int $name
+                 * @param  Union $type
+                 *
+                 * @return string
+                 */
+                function ($name, Union $type) {
+                    return $name . ($type->possibly_undefined ? '?' : '') . ':' . $type;
+                },
+                array_keys($this->properties),
+                $this->properties
+            )
+        );
+
+        $methods_string = implode(
+            ', ',
+            array_map(
+                function (string $name) {
+                    return $name . '()';
+                },
+                array_keys($this->methods)
+            )
+        );
+
+        return 'object{'
+            . $properties_string . ($methods_string && $properties_string ? ', ' : '')
+            . $methods_string
+            . '}' . $extra_types;
     }
 
     public function getId()
@@ -63,24 +83,37 @@ class TObjectWithProperties extends TObject
             $extra_types = '&' . implode('&', $this->extra_types);
         }
 
-        return 'object{' .
-                implode(
-                    ', ',
-                    array_map(
-                        /**
-                         * @param  string|int $name
-                         * @param  Union $type
-                         *
-                         * @return string
-                         */
-                        function ($name, Union $type) {
-                            return $name . ($type->possibly_undefined ? '?' : '') . ':' . $type->getId();
-                        },
-                        array_keys($this->properties),
-                        $this->properties
-                    )
-                ) .
-                '}' . $extra_types;
+        $properties_string = implode(
+            ', ',
+            array_map(
+                /**
+                 * @param  string|int $name
+                 * @param  Union $type
+                 *
+                 * @return string
+                 */
+                function ($name, Union $type) {
+                    return $name . ($type->possibly_undefined ? '?' : '') . ':' . $type->getId();
+                },
+                array_keys($this->properties),
+                $this->properties
+            )
+        );
+
+        $methods_string = implode(
+            ', ',
+            array_map(
+                function (string $name) {
+                    return $name . '()';
+                },
+                array_keys($this->methods)
+            )
+        );
+
+        return 'object{'
+            . $properties_string . ($methods_string && $properties_string ? ', ' : '')
+            . $methods_string
+            . '}' . $extra_types;
     }
 
     /**
@@ -185,6 +218,10 @@ class TObjectWithProperties extends TObject
             return false;
         }
 
+        if ($this->methods !== $other_type->methods) {
+            return false;
+        }
+
         foreach ($this->properties as $property_name => $property_type) {
             if (!isset($other_type->properties[$property_name])) {
                 return false;
diff --git a/tests/ToStringTest.php b/tests/ToStringTest.php
index 22581a72a..ba78e34dd 100644
--- a/tests/ToStringTest.php
+++ b/tests/ToStringTest.php
@@ -90,6 +90,16 @@ class ToStringTest extends TestCase
                         echo (string) $i;
                     }',
             ],
+            'allowToStringAfterMethodExistsCheck' => [
+                '<?php
+                    function getString(object $value) : ?string {
+                        if (method_exists($value, "__toString")) {
+                            return (string) $value;
+                        }
+
+                        return null;
+                    }'
+            ],
         ];
     }
 
@@ -265,6 +275,17 @@ class ToStringTest extends TestCase
                     }',
                 'error_message' => 'PossiblyInvalidOperand',
             ],
+            'allowToStringAfterMethodExistsCheckWithTypo' => [
+                '<?php
+                    function getString(object $value) : ?string {
+                        if (method_exists($value, "__toStrong")) {
+                            return (string) $value;
+                        }
+
+                        return null;
+                    }',
+                'error_message' => 'InvalidCast',
+            ],
         ];
     }
 }
