diff --git a/src/Psalm/Internal/Analyzer/Statements/Block/ForeachAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Block/ForeachAnalyzer.php
index 943b2a26a..24bf31133 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Block/ForeachAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Block/ForeachAnalyzer.php
@@ -10,6 +10,7 @@ use Psalm\Internal\Analyzer\Statements\Expression\AssignmentAnalyzer;
 use Psalm\Internal\Analyzer\Statements\ExpressionAnalyzer;
 use Psalm\Internal\Analyzer\Statements\Expression\ExpressionIdentifier;
 use Psalm\Internal\Analyzer\Statements\Expression\Fetch\VariableFetchAnalyzer;
+use Psalm\Internal\Analyzer\Statements\Expression\Fetch\ArrayFetchAnalyzer;
 use Psalm\Internal\Analyzer\StatementsAnalyzer;
 use Psalm\Internal\Analyzer\TypeAnalyzer;
 use Psalm\Internal\FileManipulation\FileManipulationBuffer;
@@ -461,11 +462,19 @@ class ForeachAnalyzer
                 }
 
                 if (!$value_type) {
-                    $value_type = $iterator_atomic_type->type_params[1];
+                    $value_type = clone $iterator_atomic_type->type_params[1];
                 } else {
                     $value_type = Type::combineUnionTypes($value_type, $iterator_atomic_type->type_params[1]);
                 }
 
+                ArrayFetchAnalyzer::taintArrayFetch(
+                    $statements_analyzer,
+                    $stmt->expr,
+                    null,
+                    $value_type,
+                    Type::getMixed()
+                );
+
                 $key_type_part = $iterator_atomic_type->type_params[0];
 
                 if (!$key_type) {
@@ -474,6 +483,14 @@ class ForeachAnalyzer
                     $key_type = Type::combineUnionTypes($key_type, $key_type_part);
                 }
 
+                ArrayFetchAnalyzer::taintArrayFetch(
+                    $statements_analyzer,
+                    $stmt->expr,
+                    null,
+                    $key_type,
+                    Type::getMixed()
+                );
+
                 $has_valid_iterator = true;
                 continue;
             }
@@ -492,6 +509,14 @@ class ForeachAnalyzer
             ) {
                 $has_valid_iterator = true;
                 $value_type = Type::getMixed();
+
+                ArrayFetchAnalyzer::taintArrayFetch(
+                    $statements_analyzer,
+                    $stmt->expr,
+                    null,
+                    $value_type,
+                    Type::getMixed()
+                );
             } elseif ($iterator_atomic_type instanceof Type\Atomic\TIterable) {
                 if ($iterator_atomic_type->extra_types) {
                     $iterator_atomic_type_copy = clone $iterator_atomic_type;
diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/Fetch/ArrayFetchAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/Fetch/ArrayFetchAnalyzer.php
index 8ed9170f1..d53789837 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/Fetch/ArrayFetchAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/Fetch/ArrayFetchAnalyzer.php
@@ -127,7 +127,7 @@ class ArrayFetchAnalyzer
 
             self::taintArrayFetch(
                 $statements_analyzer,
-                $stmt,
+                $stmt->var,
                 $keyed_array_var_id,
                 $stmt_type,
                 $used_key_type
@@ -296,7 +296,7 @@ class ArrayFetchAnalyzer
 
         self::taintArrayFetch(
             $statements_analyzer,
-            $stmt,
+            $stmt->var,
             $keyed_array_var_id,
             $stmt_type,
             $used_key_type
@@ -305,9 +305,9 @@ class ArrayFetchAnalyzer
         return true;
     }
 
-    private static function taintArrayFetch(
+    public static function taintArrayFetch(
         StatementsAnalyzer $statements_analyzer,
-        PhpParser\Node\Expr\ArrayDimFetch $stmt,
+        PhpParser\Node\Expr $var,
         ?string $keyed_array_var_id,
         Type\Union $stmt_type,
         Type\Union $offset_type
@@ -315,10 +315,10 @@ class ArrayFetchAnalyzer
         $codebase = $statements_analyzer->getCodebase();
 
         if ($codebase->taint
-            && ($stmt_var_type = $statements_analyzer->node_data->getType($stmt->var))
+            && ($stmt_var_type = $statements_analyzer->node_data->getType($var))
             && $stmt_var_type->parent_nodes
         ) {
-            $var_location = new CodeLocation($statements_analyzer->getSource(), $stmt->var);
+            $var_location = new CodeLocation($statements_analyzer->getSource(), $var);
 
             $new_parent_node = \Psalm\Internal\Taint\TaintNode::getForAssignment(
                 $keyed_array_var_id ?: 'array-fetch',
diff --git a/tests/TaintTest.php b/tests/TaintTest.php
index b725b9421..d899d980b 100644
--- a/tests/TaintTest.php
+++ b/tests/TaintTest.php
@@ -1230,6 +1230,15 @@ class TaintTest extends TestCase
                     test(...$_GET["other"]);',
                 'error_message' => 'TaintedInput',
             ],
+            'foreachArg' => [
+                '<?php
+                    $a = $_GET["bad"];
+
+                    foreach ($a as $arg) {
+                        echo $arg;
+                    }',
+                'error_message' => 'TaintedInput',
+            ],
         ];
     }
 }
