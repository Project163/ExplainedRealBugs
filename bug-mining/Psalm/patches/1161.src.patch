diff --git a/src/Psalm/Type/Atomic/GenericTrait.php b/src/Psalm/Type/Atomic/GenericTrait.php
index 26334a072..345fe453a 100644
--- a/src/Psalm/Type/Atomic/GenericTrait.php
+++ b/src/Psalm/Type/Atomic/GenericTrait.php
@@ -14,6 +14,7 @@ use function array_map;
 use function array_values;
 use function count;
 use function implode;
+use function strpos;
 use function substr;
 
 trait GenericTrait
@@ -102,6 +103,10 @@ trait GenericTrait
             return $value_type_string . '[]';
         }
 
+        $intersection_pos = strpos($base_value, '&');
+        if ($intersection_pos !== false) {
+            $base_value = substr($base_value, 0, $intersection_pos);
+        }
         $type_params = $this->type_params;
 
         //no need for special format if the key is not determined
diff --git a/src/Psalm/Type/Atomic/TGenericObject.php b/src/Psalm/Type/Atomic/TGenericObject.php
index 56d1881f0..ede08182b 100644
--- a/src/Psalm/Type/Atomic/TGenericObject.php
+++ b/src/Psalm/Type/Atomic/TGenericObject.php
@@ -6,6 +6,7 @@ use Psalm\Type\Atomic;
 use function array_merge;
 use function count;
 use function implode;
+use function strrpos;
 use function substr;
 
 /**
@@ -69,7 +70,16 @@ class TGenericObject extends TNamedObject
         int $php_major_version,
         int $php_minor_version
     ): ?string {
-        return $this->toNamespacedString($namespace, $aliased_classes, $this_class, true);
+        $result = $this->toNamespacedString($namespace, $aliased_classes, $this_class, true);
+        $intersection = strrpos($result, '&');
+        if ($intersection === false || (
+                ($php_major_version === 8 && $php_minor_version >= 1) ||
+                ($php_major_version >= 9)
+            )
+        ) {
+            return $result;
+        }
+        return substr($result, $intersection+1);
     }
 
     public function equals(Atomic $other_type, bool $ensure_source_equality): bool
diff --git a/tests/FileManipulation/ReturnTypeManipulationTest.php b/tests/FileManipulation/ReturnTypeManipulationTest.php
index 78ecee046..bd07c3dd4 100644
--- a/tests/FileManipulation/ReturnTypeManipulationTest.php
+++ b/tests/FileManipulation/ReturnTypeManipulationTest.php
@@ -872,6 +872,94 @@ class ReturnTypeManipulationTest extends FileManipulationTestCase
                 false,
                 true,
             ],
+            'Intersection80' => [
+                '<?php
+                    /**
+                     * @template T
+                     */
+                    class container1 {}
+                    /**
+                     * @template TT
+                     * @extends container1<TT>
+                     */
+                    class container2 extends container1 {}
+                    
+                    function ret() {
+                        /** @var container1<int>&container2<int> $a */
+                        $a = new container1;
+                        return $a;
+                    }
+                ',
+                '<?php
+                    /**
+                     * @template T
+                     */
+                    class container1 {}
+                    /**
+                     * @template TT
+                     * @extends container1<TT>
+                     */
+                    class container2 extends container1 {}
+                    
+                    /**
+                     * @return container1&container2
+                     *
+                     * @psalm-return container1<int>&container2<int>
+                     */
+                    function ret(): container2 {
+                        /** @var container1<int>&container2<int> $a */
+                        $a = new container1;
+                        return $a;
+                    }
+                ',
+                '8.0',
+                ['MissingReturnType'],
+                false,
+                true,
+            ],
+            'Intersection81' => [
+                '<?php
+                    /**
+                     * @template T
+                     */
+                    class container1 {}
+                    /**
+                     * @template TT
+                     * @extends container1<TT>
+                     */
+                    class container2 extends container1 {}
+                    
+                    function ret() {
+                        /** @var container1<int>&container2<int> $a */
+                        $a = new container1;
+                        return $a;
+                    }
+                ',
+                '<?php
+                    /**
+                     * @template T
+                     */
+                    class container1 {}
+                    /**
+                     * @template TT
+                     * @extends container1<TT>
+                     */
+                    class container2 extends container1 {}
+                    
+                    /**
+                     * @psalm-return container1<int>&container2<int>
+                     */
+                    function ret(): container1&container2 {
+                        /** @var container1<int>&container2<int> $a */
+                        $a = new container1;
+                        return $a;
+                    }
+                ',
+                '8.1',
+                ['MissingReturnType'],
+                false,
+                true,
+            ]
         ];
     }
 }
