diff --git a/src/Psalm/Internal/Analyzer/FunctionLikeAnalyzer.php b/src/Psalm/Internal/Analyzer/FunctionLikeAnalyzer.php
index 21e8c62ca..77817207a 100644
--- a/src/Psalm/Internal/Analyzer/FunctionLikeAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/FunctionLikeAnalyzer.php
@@ -183,6 +183,10 @@ abstract class FunctionLikeAnalyzer extends SourceAnalyzer implements Statements
                     && !$storage->mutation_free_inferred
                 ) {
                     $context->vars_in_scope['$this']->external_mutation_free = true;
+
+                    if ($storage->mutation_free) {
+                        $context->vars_in_scope['$this']->mutation_free = true;
+                    }
                 }
 
                 $context->vars_possibly_in_scope['$this'] = true;
diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/Assignment/PropertyAssignmentAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/Assignment/PropertyAssignmentAnalyzer.php
index df03cb1a5..4e5f8d280 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/Assignment/PropertyAssignmentAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/Assignment/PropertyAssignmentAnalyzer.php
@@ -623,13 +623,18 @@ class PropertyAssignmentAnalyzer
                             true
                         );
 
+                        $property_pure_compatible = isset($stmt->var->inferredType)
+                            && $stmt->var->inferredType->external_mutation_free
+                            && !$stmt->var->inferredType->mutation_free;
+
                         if ($appearing_property_class
                             && !($context->self
                                 && ($appearing_property_class === $context->self
                                     || $codebase->classExtends($context->self, $appearing_property_class))
                                 && (!$context->calling_method_id
                                     || \strpos($context->calling_method_id, '::__construct')
-                                    || \strpos($context->calling_method_id, '::unserialize'))
+                                    || \strpos($context->calling_method_id, '::unserialize')
+                                    || $property_pure_compatible)
                             )
                         ) {
                             if (IssueBuffer::accepts(
diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php
index f58f26928..1c24cc581 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php
@@ -793,7 +793,13 @@ class AssignmentAnalyzer
             $statements_analyzer
         );
 
-        if ($array_var_id && $context->mutation_free && strpos($array_var_id, '->')) {
+        if ($array_var_id
+            && $context->mutation_free
+            && $stmt->var instanceof PhpParser\Node\Expr\PropertyFetch
+            && isset($stmt->var->var->inferredType)
+            && (!$stmt->var->var->inferredType->external_mutation_free
+                || $stmt->var->var->inferredType->mutation_free)
+        ) {
             if (IssueBuffer::accepts(
                 new ImpurePropertyAssignment(
                     'Cannot assign to a property from a mutation-free context',
diff --git a/src/Psalm/Internal/Analyzer/Statements/ExpressionAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/ExpressionAnalyzer.php
index 849b5ad59..5cfbcdaa7 100644
--- a/src/Psalm/Internal/Analyzer/Statements/ExpressionAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/ExpressionAnalyzer.php
@@ -1847,7 +1847,9 @@ class ExpressionAnalyzer
             $stmt->inferredType = $stmt->expr->inferredType;
 
             if ($immutable_cloned) {
+                $stmt->inferredType = clone $stmt->inferredType;
                 $stmt->inferredType->external_mutation_free = true;
+                $stmt->inferredType->mutation_free = false;
             }
         }
     }
diff --git a/src/Psalm/Type/Union.php b/src/Psalm/Type/Union.php
index 1e201677c..c578a71b5 100644
--- a/src/Psalm/Type/Union.php
+++ b/src/Psalm/Type/Union.php
@@ -159,6 +159,11 @@ class Union
      */
     public $external_mutation_free = false;
 
+    /**
+     * @var bool
+     */
+    public $mutation_free = false;
+
     /** @var null|string */
     private $id;
 
diff --git a/tests/ImmutableAnnotationTest.php b/tests/ImmutableAnnotationTest.php
index c9522cd8e..00c7e7621 100644
--- a/tests/ImmutableAnnotationTest.php
+++ b/tests/ImmutableAnnotationTest.php
@@ -127,28 +127,6 @@ class ImmutableAnnotationTest extends TestCase
 
                         public function withBar(string $bar): self {
                             $new = new Foo("hello");
-                            /** @psalm-suppress InaccessibleProperty */
-                            $new->bar = $bar;
-
-                            return $new;
-                        }
-                    }'
-            ],
-            'allowClone' => [
-                '<?php
-                    /**
-                     * @psalm-immutable
-                     */
-                    class Foo {
-                        protected string $bar;
-
-                        public function __construct(string $bar) {
-                            $this->bar = $bar;
-                        }
-
-                        public function withBar(string $bar): self {
-                            $new = clone $this;
-                            /** @psalm-suppress InaccessibleProperty */
                             $new->bar = $bar;
 
                             return $new;
@@ -236,6 +214,44 @@ class ImmutableAnnotationTest extends TestCase
                     /** @method string getA() */
                     class B extends A {}',
             ],
+            'immutableClassWithCloneAndPropertyChange' => [
+                '<?php
+                    /**
+                     * @psalm-immutable
+                     */
+                    class Foo {
+                        protected string $bar;
+
+                        public function __construct(string $bar) {
+                            $this->bar = $bar;
+                        }
+
+                        public function withBar(string $bar): self {
+                            $new = clone $this;
+                            $new->bar = $bar;
+                            return $new;
+                        }
+                    }',
+            ],
+            'immutableClassWithCloneAndPropertyAppend' => [
+                '<?php
+                    /**
+                     * @psalm-immutable
+                     */
+                    class Foo {
+                        protected string $bar;
+
+                        public function __construct(string $bar) {
+                            $this->bar = $bar;
+                        }
+
+                        public function withBar(string $bar): self {
+                            $new = clone $this;
+                            $new->bar .= $bar;
+                            return $new;
+                        }
+                    }',
+            ],
         ];
     }
 
