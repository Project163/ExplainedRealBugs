diff --git a/src/Psalm/Internal/Type/AssertionReconciler.php b/src/Psalm/Internal/Type/AssertionReconciler.php
index 6dbda1af7..f89a9b7ed 100644
--- a/src/Psalm/Internal/Type/AssertionReconciler.php
+++ b/src/Psalm/Internal/Type/AssertionReconciler.php
@@ -2067,7 +2067,6 @@ class AssertionReconciler extends \Psalm\Type\Reconciler
         $did_remove_type = $existing_var_type->hasDefinitelyNumericType(false)
             || $existing_var_type->hasType('iterable');
 
-
         if ($existing_var_type->hasMixed()) {
             if ($existing_var_type->isMixed()
                 && $existing_var_atomic_types['mixed'] instanceof Type\Atomic\TNonEmptyMixed
@@ -2334,7 +2333,9 @@ class AssertionReconciler extends \Psalm\Type\Reconciler
             }
         }
 
-        if (!$did_remove_type || empty($existing_var_type->getAtomicTypes())) {
+        if ((!$did_remove_type || empty($existing_var_type->getAtomicTypes()))
+            && ($assertion !== 'empty' || !$existing_var_type->possibly_undefined)
+        ) {
             if ($key && $code_location) {
                 self::triggerIssueForImpossible(
                     $existing_var_type,
@@ -2354,7 +2355,9 @@ class AssertionReconciler extends \Psalm\Type\Reconciler
 
         $failed_reconciliation = 2;
 
-        return Type::getMixed();
+        return $assertion === 'empty' && $existing_var_type->possibly_undefined
+            ? Type::getEmpty()
+            : Type::getMixed();
     }
 
     /**
diff --git a/tests/TypeReconciliation/EmptyTest.php b/tests/TypeReconciliation/EmptyTest.php
index d7de112e1..7fc618f52 100644
--- a/tests/TypeReconciliation/EmptyTest.php
+++ b/tests/TypeReconciliation/EmptyTest.php
@@ -365,6 +365,15 @@ class EmptyTest extends \Psalm\Tests\TestCase
                         return true;
                     }'
             ],
+            'possiblyUndefinedArrayOffset' => [
+                '<?php
+                    $d = [];
+                    if (!rand(0,1)) {
+                        $d[0] = "a";
+                    }
+
+                    if (empty($d[0])) {}'
+            ],
         ];
     }
 
