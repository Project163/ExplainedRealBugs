diff --git a/src/Psalm/Context.php b/src/Psalm/Context.php
index a620ee2ae..82a9bebbd 100644
--- a/src/Psalm/Context.php
+++ b/src/Psalm/Context.php
@@ -273,11 +273,6 @@ class Context
      */
     public $calling_method_id;
 
-    /**
-     * @var bool
-     */
-    public $infer_types = false;
-
     /**
      * @var bool
      */
@@ -407,41 +402,6 @@ class Context
         return $redefined_vars;
     }
 
-    /**
-     * @return void
-     */
-    public function inferType(
-        string $var_name,
-        FunctionLikeStorage $function_storage,
-        Type\Union $original_type,
-        Type\Union $inferred_type,
-        Codebase $codebase
-    ) {
-        if ($original_type->getId() !== $inferred_type->getId()
-            && !isset($this->assigned_var_ids['$' . $var_name])
-            && array_key_exists($var_name, $function_storage->param_types)
-            && !$function_storage->param_types[$var_name]
-        ) {
-            if (isset($this->possible_param_types[$var_name])) {
-                if (\Psalm\Internal\Analyzer\TypeAnalyzer::isContainedBy(
-                    $codebase,
-                    $inferred_type,
-                    $this->possible_param_types[$var_name]
-                )) {
-                    $this->possible_param_types[$var_name] = clone $inferred_type;
-                } else {
-                    $this->possible_param_types[$var_name] = Type::combineUnionTypes(
-                        $this->possible_param_types[$var_name],
-                        $inferred_type
-                    );
-                }
-            } else {
-                $this->possible_param_types[$var_name] = clone $inferred_type;
-                $this->vars_in_scope['$' . $var_name] = clone $inferred_type;
-            }
-        }
-    }
-
     /**
      * @param  Context $original_context
      * @param  Context $new_context
diff --git a/src/Psalm/Internal/Analyzer/ClassAnalyzer.php b/src/Psalm/Internal/Analyzer/ClassAnalyzer.php
index 30b95f492..13a55650a 100644
--- a/src/Psalm/Internal/Analyzer/ClassAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/ClassAnalyzer.php
@@ -1393,7 +1393,6 @@ class ClassAnalyzer extends ClassLikeAnalyzer
 
         $method_context = clone $class_context;
         $method_context->collect_exceptions = $config->check_for_throws_docblock;
-        $method_context->infer_types = $codebase->infer_types_from_usage;
 
         $method_analyzer->analyze(
             $method_context,
diff --git a/src/Psalm/Internal/Analyzer/ClassLikeAnalyzer.php b/src/Psalm/Internal/Analyzer/ClassLikeAnalyzer.php
index febee501a..4af507793 100644
--- a/src/Psalm/Internal/Analyzer/ClassLikeAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/ClassLikeAnalyzer.php
@@ -172,6 +172,19 @@ abstract class ClassLikeAnalyzer extends SourceAnalyzer implements StatementsSou
         }
     }
 
+    public function getFunctionLikeAnalyzer(string $method_name) : FunctionLikeAnalyzer
+    {
+        foreach ($this->class->stmts as $stmt) {
+            if ($stmt instanceof PhpParser\Node\Stmt\ClassMethod &&
+                strtolower($stmt->name->name) === strtolower($method_name)
+            ) {
+                return new MethodAnalyzer($stmt, $this);
+            }
+        }
+
+        throw new \UnexpectedValueException('Should return a function analyzer');
+    }
+
     /**
      * @param  string           $fq_class_name
      * @param  array<string>    $suppressed_issues
diff --git a/src/Psalm/Internal/Analyzer/FileAnalyzer.php b/src/Psalm/Internal/Analyzer/FileAnalyzer.php
index c97b56ca0..a6a99f362 100644
--- a/src/Psalm/Internal/Analyzer/FileAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/FileAnalyzer.php
@@ -340,6 +340,19 @@ class FileAnalyzer extends SourceAnalyzer implements StatementsSource
         }
     }
 
+    public function getFunctionLikeAnalyzer(string $method_id) : FunctionLikeAnalyzer
+    {
+        list($fq_class_name, $method_name) = explode('::', $method_id);
+
+        if (!isset($this->class_analyzers_to_analyze[strtolower($fq_class_name)])) {
+            throw new \UnexpectedValueException('Should not happen');
+        }
+
+        $class_analyzer_to_examine = $this->class_analyzers_to_analyze[strtolower($fq_class_name)];
+
+        return $class_analyzer_to_examine->getFunctionLikeAnalyzer($method_name);
+    }
+
     /**
      * @return null|string
      */
diff --git a/src/Psalm/Internal/Analyzer/FunctionLikeAnalyzer.php b/src/Psalm/Internal/Analyzer/FunctionLikeAnalyzer.php
index 9579e7ff3..de31774a1 100644
--- a/src/Psalm/Internal/Analyzer/FunctionLikeAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/FunctionLikeAnalyzer.php
@@ -66,11 +66,6 @@ abstract class FunctionLikeAnalyzer extends SourceAnalyzer implements Statements
      */
     protected $return_vars_in_scope = [];
 
-    /**
-     * @var array<string, Type\Union>
-     */
-    protected $possible_param_types = [];
-
     /**
      * @var ?array<string, bool>
      */
@@ -660,24 +655,6 @@ abstract class FunctionLikeAnalyzer extends SourceAnalyzer implements Statements
                 && $function_param->location
                 && !isset($implemented_docblock_param_types[$offset])
             ) {
-                if ($codebase->alter_code
-                    && isset($project_analyzer->getIssuesToFix()['MissingParamType'])
-                ) {
-                    $possible_type = $this->possible_param_types[$function_param->name] ?? null;
-
-                    if (!$possible_type || $possible_type->hasMixed() || $possible_type->isNull()) {
-                        continue;
-                    }
-
-                    self::addOrUpdateParamType(
-                        $project_analyzer,
-                        $function_param->name,
-                        $possible_type
-                    );
-
-                    continue;
-                }
-
                 if ($this->function instanceof Closure) {
                     IssueBuffer::accepts(
                         new MissingClosureParamType(
@@ -959,7 +936,7 @@ abstract class FunctionLikeAnalyzer extends SourceAnalyzer implements Statements
      *
      * @return void
      */
-    private function addOrUpdateParamType(
+    public function addOrUpdateParamType(
         ProjectAnalyzer $project_analyzer,
         $param_name,
         Type\Union $inferred_return_type,
@@ -1035,54 +1012,40 @@ abstract class FunctionLikeAnalyzer extends SourceAnalyzer implements Statements
         Codebase $codebase,
         PhpParser\Node $stmt = null
     ) {
-        if ($context->infer_types) {
-            foreach ($context->possible_param_types as $var_id => $type) {
-                if (isset($this->possible_param_types[$var_id])) {
-                    $this->possible_param_types[$var_id] = Type::combineUnionTypes(
-                        $this->possible_param_types[$var_id],
-                        $type,
-                        $codebase
-                    );
-                } else {
-                    $this->possible_param_types[$var_id] = clone $type;
-                }
-            }
-        } else {
-            $storage = $this->getFunctionLikeStorage($statements_analyzer);
+        $storage = $this->getFunctionLikeStorage($statements_analyzer);
 
-            foreach ($storage->params as $i => $param) {
-                if ($param->by_ref && isset($context->vars_in_scope['$' . $param->name]) && !$param->is_variadic) {
-                    $actual_type = $context->vars_in_scope['$' . $param->name];
-                    $param_out_type = $param->type;
+        foreach ($storage->params as $i => $param) {
+            if ($param->by_ref && isset($context->vars_in_scope['$' . $param->name]) && !$param->is_variadic) {
+                $actual_type = $context->vars_in_scope['$' . $param->name];
+                $param_out_type = $param->type;
 
-                    if (isset($storage->param_out_types[$i])) {
-                        $param_out_type = $storage->param_out_types[$i];
-                    }
+                if (isset($storage->param_out_types[$i])) {
+                    $param_out_type = $storage->param_out_types[$i];
+                }
 
-                    if ($param_out_type && !$actual_type->hasMixed() && $param->location) {
-                        if (!TypeAnalyzer::isContainedBy(
-                            $codebase,
-                            $actual_type,
-                            $param_out_type,
-                            $actual_type->ignore_nullable_issues,
-                            $actual_type->ignore_falsable_issues
-                        )
-                        ) {
-                            if (IssueBuffer::accepts(
-                                new ReferenceConstraintViolation(
-                                    'Variable ' . '$' . $param->name . ' is limited to values of type '
-                                        . $param_out_type->getId()
-                                        . ' because it is passed by reference, '
-                                        . $actual_type->getId() . ' type found. Use @param-out to specify '
-                                        . 'a different output type',
-                                    $stmt
-                                        ? new CodeLocation($this, $stmt)
-                                        : $param->location
-                                ),
-                                $statements_analyzer->getSuppressedIssues()
-                            )) {
-                                // fall through
-                            }
+                if ($param_out_type && !$actual_type->hasMixed() && $param->location) {
+                    if (!TypeAnalyzer::isContainedBy(
+                        $codebase,
+                        $actual_type,
+                        $param_out_type,
+                        $actual_type->ignore_nullable_issues,
+                        $actual_type->ignore_falsable_issues
+                    )
+                    ) {
+                        if (IssueBuffer::accepts(
+                            new ReferenceConstraintViolation(
+                                'Variable ' . '$' . $param->name . ' is limited to values of type '
+                                    . $param_out_type->getId()
+                                    . ' because it is passed by reference, '
+                                    . $actual_type->getId() . ' type found. Use @param-out to specify '
+                                    . 'a different output type',
+                                $stmt
+                                    ? new CodeLocation($this, $stmt)
+                                    : $param->location
+                            ),
+                            $statements_analyzer->getSuppressedIssues()
+                        )) {
+                            // fall through
                         }
                     }
                 }
diff --git a/src/Psalm/Internal/Analyzer/ProjectAnalyzer.php b/src/Psalm/Internal/Analyzer/ProjectAnalyzer.php
index 93bf70112..8566a1e8c 100644
--- a/src/Psalm/Internal/Analyzer/ProjectAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/ProjectAnalyzer.php
@@ -953,6 +953,28 @@ class ProjectAnalyzer
         $file_analyzer->interface_analyzers_to_analyze = [];
     }
 
+    public function getFunctionLikeAnalyzer(string $method_id, string $file_path) : FunctionLikeAnalyzer
+    {
+        $file_analyzer = new FileAnalyzer(
+            $this,
+            $file_path,
+            $this->config->shortenFileName($file_path)
+        );
+
+        $stmts = $this->codebase->getStatementsForFile(
+            $file_analyzer->getFilePath()
+        );
+
+        $file_analyzer->populateCheckers($stmts);
+
+        $function_analyzer = $file_analyzer->getFunctionLikeAnalyzer($method_id);
+
+        $file_analyzer->class_analyzers_to_analyze = [];
+        $file_analyzer->interface_analyzers_to_analyze = [];
+
+        return $function_analyzer;
+    }
+
     /**
      * Adapted from https://gist.github.com/divinity76/01ef9ca99c111565a72d3a8a6e42f7fb
      * returns number of cpu cores
diff --git a/src/Psalm/Internal/Analyzer/Statements/Block/IfAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Block/IfAnalyzer.php
index 8827349d6..844fc56c5 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Block/IfAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Block/IfAnalyzer.php
@@ -283,26 +283,6 @@ class IfAnalyzer
                         ) : null
                 );
 
-            if ($if_context->infer_types) {
-                $source_analyzer = $statements_analyzer->getSource();
-
-                if ($source_analyzer instanceof FunctionLikeAnalyzer) {
-                    $function_storage = $source_analyzer->getFunctionLikeStorage($statements_analyzer);
-
-                    foreach ($reconcilable_if_types as $var_id => $_) {
-                        if (isset($if_context->vars_in_scope[$var_id])) {
-                            $if_context->inferType(
-                                substr($var_id, 1),
-                                $function_storage,
-                                $if_context->vars_in_scope[$var_id],
-                                $if_vars_in_scope_reconciled[$var_id],
-                                $statements_analyzer->getCodebase()
-                            );
-                        }
-                    }
-                }
-            }
-
             $if_context->vars_in_scope = $if_vars_in_scope_reconciled;
 
             foreach ($reconcilable_if_types as $var_id => $_) {
@@ -680,10 +660,6 @@ class IfAnalyzer
                     );
                 }
             }
-
-            if ($if_context->infer_types) {
-                $if_scope->possible_param_types = $if_context->possible_param_types;
-            }
         } else {
             if (!$has_break_statement) {
                 $if_scope->reasonable_clauses = [];
@@ -1204,29 +1180,6 @@ class IfAnalyzer
             $if_scope->reasonable_clauses = [];
         }
 
-        if ($elseif_context->infer_types) {
-            $elseif_possible_param_types = $elseif_context->possible_param_types;
-
-            if ($if_scope->possible_param_types) {
-                $vars_to_remove = [];
-
-                foreach ($if_scope->possible_param_types as $var => $type) {
-                    if (isset($elseif_possible_param_types[$var])) {
-                        $if_scope->possible_param_types[$var] = Type::combineUnionTypes(
-                            $elseif_possible_param_types[$var],
-                            $type
-                        );
-                    } else {
-                        $vars_to_remove[] = $var;
-                    }
-                }
-
-                foreach ($vars_to_remove as $var) {
-                    unset($if_scope->possible_param_types[$var]);
-                }
-            }
-        }
-
         if ($negated_elseif_types) {
             if ($has_leaving_statements) {
                 $changed_var_ids = [];
@@ -1623,29 +1576,6 @@ class IfAnalyzer
         if ($outer_context->collect_exceptions) {
             $outer_context->mergeExceptions($else_context);
         }
-
-        if ($else_context->infer_types) {
-            $else_possible_param_types = $else_context->possible_param_types;
-
-            if ($if_scope->possible_param_types) {
-                $vars_to_remove = [];
-
-                foreach ($if_scope->possible_param_types as $var => $type) {
-                    if (isset($else_possible_param_types[$var])) {
-                        $if_scope->possible_param_types[$var] = Type::combineUnionTypes(
-                            $else_possible_param_types[$var],
-                            $type
-                        );
-                    } else {
-                        $vars_to_remove[] = $var;
-                    }
-                }
-
-                foreach ($vars_to_remove as $var) {
-                    unset($if_scope->possible_param_types[$var]);
-                }
-            }
-        }
     }
 
     /**
diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/BinaryOpAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/BinaryOpAnalyzer.php
index c9a30eb03..41ac3f621 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/BinaryOpAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/BinaryOpAnalyzer.php
@@ -541,42 +541,6 @@ class BinaryOpAnalyzer
             ) {
                 $stmt->inferredType = Type::getBool();
             } elseif ($stmt instanceof PhpParser\Node\Expr\BinaryOp\Div) {
-                if ($context->infer_types
-                    && isset($stmt->left->inferredType)
-                    && isset($stmt->right->inferredType)
-                    && ($stmt->left->inferredType->isMixed() || $stmt->right->inferredType->isMixed())
-                ) {
-                    $source_analyzer = $statements_analyzer->getSource();
-
-                    if ($source_analyzer instanceof FunctionLikeAnalyzer) {
-                        $function_storage = $source_analyzer->getFunctionLikeStorage($statements_analyzer);
-
-                        if ($stmt->left instanceof PhpParser\Node\Expr\Variable
-                            && is_string($stmt->left->name)
-                        ) {
-                            $context->inferType(
-                                $stmt->left->name,
-                                $function_storage,
-                                $stmt->left->inferredType,
-                                new Type\Union([new TInt, new TFloat]),
-                                $codebase
-                            );
-                        }
-
-                        if ($stmt->right instanceof PhpParser\Node\Expr\Variable
-                            && is_string($stmt->right->name)
-                        ) {
-                            $context->inferType(
-                                $stmt->right->name,
-                                $function_storage,
-                                $stmt->right->inferredType,
-                                new Type\Union([new TInt, new TFloat]),
-                                $codebase
-                            );
-                        }
-                    }
-                }
-
                 self::analyzeNonDivArithmeticOp(
                     $statements_analyzer,
                     $stmt->left,
@@ -663,49 +627,6 @@ class BinaryOpAnalyzer
         $right_type = isset($right->inferredType) ? $right->inferredType : null;
         $config = Config::getInstance();
 
-        if ($codebase
-            && $statements_source
-            && $context
-            && $context->infer_types
-            && $left_type
-            && $right_type
-            && ($left_type->isVanillaMixed() || $right_type->isVanillaMixed())
-            && ($left_type->hasDefinitelyNumericType() || $right_type->hasDefinitelyNumericType())
-        ) {
-            $source_analyzer = $statements_source->getSource();
-            if ($source_analyzer instanceof FunctionLikeAnalyzer
-                && $statements_source instanceof StatementsAnalyzer
-            ) {
-                $function_storage = $source_analyzer->getFunctionLikeStorage($statements_source);
-
-                if ($left instanceof PhpParser\Node\Expr\Variable
-                    && is_string($left->name)
-                    && isset($left->inferredType)
-                ) {
-                    $context->inferType(
-                        $left->name,
-                        $function_storage,
-                        $left->inferredType,
-                        new Type\Union([new TInt, new TFloat]),
-                        $codebase
-                    );
-                }
-
-                if ($right instanceof PhpParser\Node\Expr\Variable
-                    && is_string($right->name)
-                    && isset($right->inferredType)
-                ) {
-                    $context->inferType(
-                        $right->name,
-                        $function_storage,
-                        $right->inferredType,
-                        new Type\Union([new TInt, new TFloat]),
-                        $codebase
-                    );
-                }
-            }
-        }
-
         if ($left_type && $right_type) {
             if ($left_type->isNull()) {
                 if ($statements_source && IssueBuffer::accepts(
@@ -1248,44 +1169,6 @@ class BinaryOpAnalyzer
         $right_type = isset($right->inferredType) ? $right->inferredType : null;
         $config = Config::getInstance();
 
-        if ($context->infer_types
-            && $left_type
-            && $right_type
-            && ($left_type->isMixed() || $right_type->isMixed())
-        ) {
-            $source_analyzer = $statements_analyzer->getSource();
-
-            if ($source_analyzer instanceof FunctionLikeAnalyzer) {
-                $function_storage = $source_analyzer->getFunctionLikeStorage($statements_analyzer);
-
-                if ($left instanceof PhpParser\Node\Expr\Variable
-                    && is_string($left->name)
-                    && isset($left->inferredType)
-                ) {
-                    $context->inferType(
-                        $left->name,
-                        $function_storage,
-                        $left->inferredType,
-                        new Type\Union([new Type\Atomic\TString, new Type\Atomic\TInt]),
-                        $codebase
-                    );
-                }
-
-                if ($right instanceof PhpParser\Node\Expr\Variable
-                    && is_string($right->name)
-                    && isset($right->inferredType)
-                ) {
-                    $context->inferType(
-                        $right->name,
-                        $function_storage,
-                        $right->inferredType,
-                        new Type\Union([new Type\Atomic\TString, new Type\Atomic\TInt]),
-                        $codebase
-                    );
-                }
-            }
-        }
-
         if ($left_type && $right_type) {
             $result_type = Type::getString();
 
diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/CallAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/CallAnalyzer.php
index c7ab8e208..9c97381ae 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/CallAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/CallAnalyzer.php
@@ -1526,158 +1526,168 @@ class CallAnalyzer
         array &$generic_params = null,
         array $template_types = null
     ) {
-        if ($function_param && $function_param->type) {
+        if (!$function_param) {
+            return;
+        }
+
+        if (!$function_param->type) {
+            if (!$codebase->infer_types_from_usage) {
+                return;
+            }
+
+            $param_type = Type::getMixed();
+        } else {
             $param_type = clone $function_param->type;
+        }
 
-            if ($existing_generic_params) {
-                $empty_generic_params = [];
+        if ($existing_generic_params) {
+            $empty_generic_params = [];
 
-                $param_type->replaceTemplateTypesWithStandins(
-                    $existing_generic_params,
-                    $empty_generic_params,
-                    $codebase,
-                    $arg->value->inferredType
-                );
+            $param_type->replaceTemplateTypesWithStandins(
+                $existing_generic_params,
+                $empty_generic_params,
+                $codebase,
+                $arg->value->inferredType
+            );
 
-                $arg_type->replaceTemplateTypesWithStandins(
-                    $existing_generic_params,
-                    $empty_generic_params,
-                    $codebase,
-                    $arg->value->inferredType
-                );
-            }
+            $arg_type->replaceTemplateTypesWithStandins(
+                $existing_generic_params,
+                $empty_generic_params,
+                $codebase,
+                $arg->value->inferredType
+            );
+        }
 
-            if ($template_types) {
-                if ($generic_params === null) {
-                    $generic_params = [];
-                }
+        if ($template_types) {
+            if ($generic_params === null) {
+                $generic_params = [];
+            }
 
-                $arg_type_param = $arg_type;
+            $arg_type_param = $arg_type;
 
-                if ($arg->unpack) {
-                    if ($arg_type->hasArray()) {
-                        /** @var Type\Atomic\TArray|Type\Atomic\ObjectLike */
-                        $array_atomic_type = $arg_type->getTypes()['array'];
-                        if ($array_atomic_type instanceof Type\Atomic\ObjectLike) {
-                            $array_atomic_type = $array_atomic_type->getGenericArrayType();
-                        }
-                        $arg_type_param = $array_atomic_type->type_params[1];
-                    } else {
-                        $arg_type_param = Type::getMixed();
+            if ($arg->unpack) {
+                if ($arg_type->hasArray()) {
+                    /** @var Type\Atomic\TArray|Type\Atomic\ObjectLike */
+                    $array_atomic_type = $arg_type->getTypes()['array'];
+                    if ($array_atomic_type instanceof Type\Atomic\ObjectLike) {
+                        $array_atomic_type = $array_atomic_type->getGenericArrayType();
                     }
+                    $arg_type_param = $array_atomic_type->type_params[1];
+                } else {
+                    $arg_type_param = Type::getMixed();
                 }
-
-                $param_type->replaceTemplateTypesWithStandins(
-                    $template_types,
-                    $generic_params,
-                    $codebase,
-                    $arg_type_param
-                );
             }
 
-            if (!$context->check_variables) {
-                return;
-            }
+            $param_type->replaceTemplateTypesWithStandins(
+                $template_types,
+                $generic_params,
+                $codebase,
+                $arg_type_param
+            );
+        }
 
-            $parent_class = null;
+        if (!$context->check_variables) {
+            return;
+        }
 
-            if ($self_fq_class_name) {
-                $classlike_storage = $codebase->classlike_storage_provider->get($self_fq_class_name);
-                $parent_class = $classlike_storage->parent_class;
-            }
+        $parent_class = null;
 
-            $fleshed_out_type = ExpressionAnalyzer::fleshOutType(
+        if ($self_fq_class_name) {
+            $classlike_storage = $codebase->classlike_storage_provider->get($self_fq_class_name);
+            $parent_class = $classlike_storage->parent_class;
+        }
+
+        $fleshed_out_type = ExpressionAnalyzer::fleshOutType(
+            $codebase,
+            $param_type,
+            $self_fq_class_name,
+            $static_fq_class_name,
+            $parent_class
+        );
+
+        $fleshed_out_signature_type = $function_param->signature_type
+            ? ExpressionAnalyzer::fleshOutType(
                 $codebase,
-                $param_type,
+                $function_param->signature_type,
                 $self_fq_class_name,
                 $static_fq_class_name,
                 $parent_class
-            );
-
-            $fleshed_out_signature_type = $function_param->signature_type
-                ? ExpressionAnalyzer::fleshOutType(
-                    $codebase,
-                    $function_param->signature_type,
-                    $self_fq_class_name,
-                    $static_fq_class_name,
-                    $parent_class
-                )
-                : null;
-
-            if ($arg->unpack) {
-                if ($arg_type->hasMixed()) {
-                    if (!$context->collect_initializations
-                        && !$context->collect_mutations
-                        && $statements_analyzer->getFilePath() === $statements_analyzer->getRootFilePath()
-                        && (!(($parent_source = $statements_analyzer->getSource())
-                                instanceof \Psalm\Internal\Analyzer\FunctionLikeAnalyzer)
-                            || !$parent_source->getSource() instanceof \Psalm\Internal\Analyzer\TraitAnalyzer)
-                    ) {
-                        $codebase->analyzer->incrementMixedCount($statements_analyzer->getFilePath());
-                    }
+            )
+            : null;
 
-                    if (IssueBuffer::accepts(
-                        new MixedArgument(
-                            'Argument ' . ($argument_offset + 1) . ' of ' . $cased_method_id
-                                . ' cannot be mixed, expecting array',
-                            new CodeLocation($statements_analyzer->getSource(), $arg->value),
-                            $cased_method_id
-                        ),
-                        $statements_analyzer->getSuppressedIssues()
-                    )) {
-                        // fall through
-                    }
+        if ($arg->unpack) {
+            if ($arg_type->hasMixed()) {
+                if (!$context->collect_initializations
+                    && !$context->collect_mutations
+                    && $statements_analyzer->getFilePath() === $statements_analyzer->getRootFilePath()
+                    && (!(($parent_source = $statements_analyzer->getSource())
+                            instanceof \Psalm\Internal\Analyzer\FunctionLikeAnalyzer)
+                        || !$parent_source->getSource() instanceof \Psalm\Internal\Analyzer\TraitAnalyzer)
+                ) {
+                    $codebase->analyzer->incrementMixedCount($statements_analyzer->getFilePath());
+                }
 
-                    return;
+                if (IssueBuffer::accepts(
+                    new MixedArgument(
+                        'Argument ' . ($argument_offset + 1) . ' of ' . $cased_method_id
+                            . ' cannot be mixed, expecting array',
+                        new CodeLocation($statements_analyzer->getSource(), $arg->value),
+                        $cased_method_id
+                    ),
+                    $statements_analyzer->getSuppressedIssues()
+                )) {
+                    // fall through
                 }
 
-                if ($arg_type->hasArray()) {
-                    /** @var Type\Atomic\TArray|Type\Atomic\ObjectLike */
-                    $array_atomic_type = $arg_type->getTypes()['array'];
+                return;
+            }
 
-                    if ($array_atomic_type instanceof Type\Atomic\ObjectLike) {
-                        $array_atomic_type = $array_atomic_type->getGenericArrayType();
-                    }
+            if ($arg_type->hasArray()) {
+                /** @var Type\Atomic\TArray|Type\Atomic\ObjectLike */
+                $array_atomic_type = $arg_type->getTypes()['array'];
 
-                    $arg_type = $array_atomic_type->type_params[1];
-                } else {
-                    foreach ($arg_type->getTypes() as $atomic_type) {
-                        if (!$atomic_type->isIterable($codebase)) {
-                            if (IssueBuffer::accepts(
-                                new InvalidArgument(
-                                    'Argument ' . ($argument_offset + 1) . ' of ' . $cased_method_id
-                                        . ' expects array, ' . $atomic_type->getId() . ' provided',
-                                    new CodeLocation($statements_analyzer->getSource(), $arg->value),
-                                    $cased_method_id
-                                ),
-                                $statements_analyzer->getSuppressedIssues()
-                            )) {
-                                return false;
-                            }
+                if ($array_atomic_type instanceof Type\Atomic\ObjectLike) {
+                    $array_atomic_type = $array_atomic_type->getGenericArrayType();
+                }
+
+                $arg_type = $array_atomic_type->type_params[1];
+            } else {
+                foreach ($arg_type->getTypes() as $atomic_type) {
+                    if (!$atomic_type->isIterable($codebase)) {
+                        if (IssueBuffer::accepts(
+                            new InvalidArgument(
+                                'Argument ' . ($argument_offset + 1) . ' of ' . $cased_method_id
+                                    . ' expects array, ' . $atomic_type->getId() . ' provided',
+                                new CodeLocation($statements_analyzer->getSource(), $arg->value),
+                                $cased_method_id
+                            ),
+                            $statements_analyzer->getSuppressedIssues()
+                        )) {
+                            return false;
                         }
                     }
-
-                    return;
                 }
-            }
 
-            if (self::checkFunctionArgumentType(
-                $statements_analyzer,
-                $arg_type,
-                $fleshed_out_type,
-                $fleshed_out_signature_type,
-                $cased_method_id,
-                $argument_offset,
-                new CodeLocation($statements_analyzer->getSource(), $arg->value),
-                $arg->value,
-                $context,
-                $function_param->by_ref,
-                $function_param->is_variadic,
-                $arg->unpack
-            ) === false) {
-                return false;
+                return;
             }
         }
+
+        if (self::checkFunctionArgumentType(
+            $statements_analyzer,
+            $arg_type,
+            $fleshed_out_type,
+            $fleshed_out_signature_type,
+            $cased_method_id,
+            $argument_offset,
+            new CodeLocation($statements_analyzer->getSource(), $arg->value),
+            $arg->value,
+            $context,
+            $function_param->by_ref,
+            $function_param->is_variadic,
+            $arg->unpack
+        ) === false) {
+            return false;
+        }
     }
 
     /**
@@ -2192,7 +2202,7 @@ class CallAnalyzer
         Type\Union $param_type,
         ?Type\Union $signature_param_type,
         $cased_method_id,
-        $argument_offset,
+        int $argument_offset,
         CodeLocation $code_location,
         PhpParser\Node\Expr $input_expr,
         Context $context,
@@ -2200,32 +2210,33 @@ class CallAnalyzer
         bool $variadic = false,
         bool $unpack = false
     ) {
-        if ($param_type->hasMixed()) {
-            return null;
-        }
-
         $codebase = $statements_analyzer->getCodebase();
 
-        $method_identifier = $cased_method_id ? ' of ' . $cased_method_id : '';
-
-        if ($context->infer_types && isset($input_expr->inferredType)) {
-            $source_analyzer = $statements_analyzer->getSource();
-
-            if ($source_analyzer instanceof FunctionLikeAnalyzer
-                && $input_expr instanceof PhpParser\Node\Expr\Variable
-                && is_string($input_expr->name)
-                && isset($input_expr->inferredType)
+        if ($param_type->hasMixed()) {
+            if ($codebase->infer_types_from_usage
+                && !$input_type->hasMixed()
+                && !$param_type->from_docblock
+                && $cased_method_id
+                && strpos($cased_method_id, '::')
+                && !strpos($cased_method_id, '__')
             ) {
-                $context->inferType(
-                    $input_expr->name,
-                    $source_analyzer->getFunctionLikeStorage($statements_analyzer),
-                    $input_expr->inferredType,
-                    $param_type,
-                    $codebase
-                );
+                $method_storage = $codebase->methods->getStorage($cased_method_id);
+
+                if (!isset($method_storage->possible_param_types[$argument_offset])) {
+                    $method_storage->possible_param_types[$argument_offset] = clone $input_type;
+                } else {
+                    $method_storage->possible_param_types[$argument_offset] = Type::combineUnionTypes(
+                        $method_storage->possible_param_types[$argument_offset],
+                        clone $input_type
+                    );
+                }
             }
+
+            return null;
         }
 
+        $method_identifier = $cased_method_id ? ' of ' . $cased_method_id : '';
+
         if ($input_type->hasMixed()) {
             if (!$context->collect_initializations
                 && !$context->collect_mutations
diff --git a/src/Psalm/Internal/Analyzer/Statements/ExpressionAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/ExpressionAnalyzer.php
index 85f5e0802..284feee79 100644
--- a/src/Psalm/Internal/Analyzer/Statements/ExpressionAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/ExpressionAnalyzer.php
@@ -1548,16 +1548,6 @@ class ExpressionAnalyzer
         PhpParser\Node\Scalar\Encapsed $stmt,
         Context $context
     ) {
-        $function_storage = null;
-
-        if ($context->infer_types) {
-            $source_analyzer = $statements_analyzer->getSource();
-
-            if ($source_analyzer instanceof FunctionLikeAnalyzer) {
-                $function_storage = $source_analyzer->getFunctionLikeStorage($statements_analyzer);
-            }
-        }
-
         /** @var PhpParser\Node\Expr $part */
         foreach ($stmt->parts as $part) {
             if (self::analyze($statements_analyzer, $part, $context) === false) {
@@ -1567,20 +1557,6 @@ class ExpressionAnalyzer
             if (isset($part->inferredType)) {
                 self::castStringAttempt($statements_analyzer, $part);
             }
-
-            if ($function_storage
-                && $part instanceof PhpParser\Node\Expr\Variable
-                && is_string($part->name)
-                && isset($part->inferredType)
-            ) {
-                $context->inferType(
-                    $part->name,
-                    $function_storage,
-                    $part->inferredType,
-                    new Type\Union([new Type\Atomic\TString, new Type\Atomic\TInt, new Type\Atomic\TFloat]),
-                    $statements_analyzer->getCodebase()
-                );
-            }
         }
 
         $stmt->inferredType = Type::getString();
diff --git a/src/Psalm/Internal/Analyzer/StatementsAnalyzer.php b/src/Psalm/Internal/Analyzer/StatementsAnalyzer.php
index 1d4a22f8c..c190fd4a0 100644
--- a/src/Psalm/Internal/Analyzer/StatementsAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/StatementsAnalyzer.php
@@ -511,7 +511,6 @@ class StatementsAnalyzer extends SourceAnalyzer implements StatementsSource
                     $function_id = strtolower($stmt->name->name);
                     $function_context = new Context($context->self);
                     $config = Config::getInstance();
-                    $function_context->infer_types = $codebase->infer_types_from_usage;
                     $function_context->collect_references = $codebase->collect_references;
                     $function_context->collect_exceptions = $config->check_for_throws_docblock;
                     $this->function_analyzers[$function_id]->analyze($function_context, $context);
diff --git a/src/Psalm/Internal/Codebase/ClassLikes.php b/src/Psalm/Internal/Codebase/ClassLikes.php
index 073f52aa9..2a976a541 100644
--- a/src/Psalm/Internal/Codebase/ClassLikes.php
+++ b/src/Psalm/Internal/Codebase/ClassLikes.php
@@ -927,6 +927,36 @@ class ClassLikes
                     }
                 }
             } else {
+                if ($codebase->alter_code
+                    && isset($project_analyzer->getIssuesToFix()['MissingParamType'])
+                ) {
+                    if ($method_storage->possible_param_types && $method_storage->location) {
+                        foreach ($method_storage->possible_param_types as $offset => $possible_type) {
+                            if (!isset($method_storage->params[$offset])) {
+                                continue;
+                            }
+
+                            $param_name = $method_storage->params[$offset]->name;
+
+                            if ($possible_type->hasMixed() || $possible_type->isNull()) {
+                                continue;
+                            }
+
+                            $function_analyzer = $project_analyzer->getFunctionLikeAnalyzer(
+                                $method_id,
+                                $method_storage->location->file_path
+                            );
+
+                            $function_analyzer->addOrUpdateParamType(
+                                $project_analyzer,
+                                $param_name,
+                                $possible_type,
+                                true
+                            );
+                        }
+                    }
+                }
+
                 foreach ($method_storage->unused_params as $offset => $code_location) {
                     $has_parent_references = false;
 
diff --git a/src/Psalm/Storage/FunctionLikeStorage.php b/src/Psalm/Storage/FunctionLikeStorage.php
index dd8448e3c..799619504 100644
--- a/src/Psalm/Storage/FunctionLikeStorage.php
+++ b/src/Psalm/Storage/FunctionLikeStorage.php
@@ -169,6 +169,11 @@ class FunctionLikeStorage
      */
     public $unused_docblock_params;
 
+    /**
+     * @var array<int, Type\Union>|null
+     */
+    public $possible_param_types;
+
     public function __toString()
     {
         $symbol_text = 'function ' . $this->cased_name . '(' . implode(
diff --git a/tests/FileManipulation/ParamTypeManipulationTest.php b/tests/FileManipulation/ParamTypeManipulationTest.php
index 1e9b8d7e6..c0c33e72d 100644
--- a/tests/FileManipulation/ParamTypeManipulationTest.php
+++ b/tests/FileManipulation/ParamTypeManipulationTest.php
@@ -67,271 +67,37 @@ class ParamTypeManipulationTest extends FileManipulationTest
             ],
             'noStringParamType' => [
                 '<?php
-                    function fooFoo($a): void {
-                        echo substr($a, 4, 2);
-                    }',
-                '<?php
-                    /**
-                     * @param string $a
-                     */
-                    function fooFoo($a): void {
-                        echo substr($a, 4, 2);
-                    }',
-                '7.1',
-                ['MissingParamType'],
-                true,
-            ],
-            'stringParamTypeAndConcatNoop' => [
-                '<?php
-                    function fooFoo(string $a): void {
-                        echo $a . "foo";
-                    }',
-                '<?php
-                    function fooFoo(string $a): void {
-                        echo $a . "foo";
-                    }',
-                '7.1',
-                ['MissingParamType'],
-                true,
-            ],
-            'noParamTypeButConcat' => [
-                '<?php
-                    function fooFoo($a): void {
-                        echo $a . "foo";
-                    }',
-                '<?php
-                    /**
-                     * @param string|int $a
-                     */
-                    function fooFoo($a): void {
-                        echo $a . "foo";
-                    }',
-                '7.1',
-                ['MissingParamType'],
-                true,
-            ],
-            'noParamTypeButConcatAndStringUsage' => [
-                '<?php
-                    function takesString(string $s) : void {}
-
-                    function fooFoo($a): void {
-                        echo $a . "foo";
-                        echo takesString($a);
-                    }',
-                '<?php
-                    function takesString(string $s) : void {}
-
-                    /**
-                     * @param string $a
-                     */
-                    function fooFoo($a): void {
-                        echo $a . "foo";
-                        echo takesString($a);
-                    }',
-                '7.1',
-                ['MissingParamType'],
-                true,
-            ],
-            'noParamTypeButConcatAndStringUsageReversed' => [
-                '<?php
-                    function takesString(string $s) : void {}
-
-                    function fooFoo($a): void {
-                        echo takesString($a);
-                        echo $a . "foo";
-                    }',
-                '<?php
-                    function takesString(string $s) : void {}
-
-                    /**
-                     * @param string $a
-                     */
-                    function fooFoo($a): void {
-                        echo takesString($a);
-                        echo $a . "foo";
-                    }',
-                '7.1',
-                ['MissingParamType'],
-                true,
-            ],
-            'noParamTypeButAddition' => [
-                '<?php
-                    function fooFoo($a): void {
-                        echo $a + 5;
-                    }',
-                '<?php
-                    /**
-                     * @param int|float $a
-                     */
-                    function fooFoo($a): void {
-                        echo $a + 5;
-                    }',
-                '7.1',
-                ['MissingParamType'],
-                true,
-            ],
-            'noParamTypeButAdditionAndDefault' => [
-                '<?php
-                    function fooFoo($a = 5): void {
-                        takesInt($a);
+                    class C {
+                        public function fooFoo($a): void {}
                     }
 
-                    function takesInt(int $i) {}',
+                    (new C)->fooFoo("hello");',
                 '<?php
-                    /**
-                     * @param int $a
-                     */
-                    function fooFoo($a = 5): void {
-                        takesInt($a);
+                    class C {
+                        /**
+                         * @param string $a
+                         */
+                        public function fooFoo($a): void {}
                     }
 
-                    function takesInt(int $i) {}',
+                    (new C)->fooFoo("hello");',
                 '7.1',
                 ['MissingParamType'],
                 true,
             ],
-            'noParamTypeButIntUseAndNullCheck' => [
+            'stringParamTypeNoOp' => [
                 '<?php
-                    function fooFoo($a): void {
-                        if ($a === null) {
-                            return;
-                        }
-                        takesInt($a);
+                    class C {
+                        public function fooFoo(string $a): void {}
                     }
 
-                    function takesInt(int $i) {}',
+                    (new C)->fooFoo("hello");',
                 '<?php
-                    /**
-                     * @param null|int $a
-                     */
-                    function fooFoo($a): void {
-                        if ($a === null) {
-                            return;
-                        }
-                        takesInt($a);
+                    class C {
+                        public function fooFoo(string $a): void {}
                     }
 
-                    function takesInt(int $i) {}',
-                '7.1',
-                ['MissingParamType'],
-                true,
-            ],
-            'noParamTypeButDivision' => [
-                '<?php
-                    function fooFoo($a): void {
-                        echo $a / 5;
-                    }',
-                '<?php
-                    /**
-                     * @param int|float $a
-                     */
-                    function fooFoo($a): void {
-                        echo $a / 5;
-                    }',
-                '7.1',
-                ['MissingParamType'],
-                true,
-            ],
-            'noParamTypeButTemplatedString' => [
-                '<?php
-                    function fooFoo($a): void {
-                        echo "$a";
-                    }',
-                '<?php
-                    /**
-                     * @param string|int|float $a
-                     */
-                    function fooFoo($a): void {
-                        echo "$a";
-                    }',
-                '7.1',
-                ['MissingParamType'],
-                true,
-            ],
-            'noParamTypeButTemplatedStringAntStringUsage' => [
-                '<?php
-                    function fooFoo($a): void {
-                        echo "$a";
-                        echo substr($a, 4, 2);
-                    }',
-                '<?php
-                    /**
-                     * @param string $a
-                     */
-                    function fooFoo($a): void {
-                        echo "$a";
-                        echo substr($a, 4, 2);
-                    }',
-                '7.1',
-                ['MissingParamType'],
-                true,
-            ],
-            'noStringIntParamType' => [
-                '<?php
-                    function fooFoo($a): void {
-                        if (is_string($a)) {
-                            echo substr($a, 4, 2);
-                        } else {
-                            echo substr("hello", $a, 2);
-                        }
-                    }',
-                '<?php
-                    /**
-                     * @param int|string $a
-                     */
-                    function fooFoo($a): void {
-                        if (is_string($a)) {
-                            echo substr($a, 4, 2);
-                        } else {
-                            echo substr("hello", $a, 2);
-                        }
-                    }',
-                '7.1',
-                ['MissingParamType'],
-                true,
-            ],
-            'alreadyHasCheck' => [
-                '<?php
-                    function takesString(string $s): void {}
-
-                    function shouldTakeString($s): void {
-                        if (is_string($s)) {
-                            takesString($s);
-                        }
-                    }',
-                '<?php
-                    function takesString(string $s): void {}
-
-                    function shouldTakeString($s): void {
-                        if (is_string($s)) {
-                            takesString($s);
-                        }
-                    }',
-                '7.1',
-                ['MissingParamType'],
-                true,
-            ],
-            'isSetBeforeInferrence' => [
-                '<?php
-                    function takesString(string $s): void {}
-
-                    /** @return mixed */
-                    function returnsMixed() {}
-
-                    function shouldTakeString($s): void {
-                        $s = returnsMixed();
-                        takesString($s);
-                    }',
-                '<?php
-                    function takesString(string $s): void {}
-
-                    /** @return mixed */
-                    function returnsMixed() {}
-
-                    function shouldTakeString($s): void {
-                        $s = returnsMixed();
-                        takesString($s);
-                    }',
+                    (new C)->fooFoo("hello");',
                 '7.1',
                 ['MissingParamType'],
                 true,
