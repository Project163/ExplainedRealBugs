diff --git a/src/Psalm/Internal/Analyzer/Statements/Block/IfElse/ElseIfAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Block/IfElse/ElseIfAnalyzer.php
index 50adf99f5..ae5f6ebb0 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Block/IfElse/ElseIfAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Block/IfElse/ElseIfAnalyzer.php
@@ -366,12 +366,14 @@ class ElseIfAnalyzer
                 $implied_outer_context = clone $elseif_context;
                 $implied_outer_context->vars_in_scope = $leaving_vars_reconciled;
 
+                $updated_vars = [];
+
                 $outer_context->update(
                     $elseif_context,
                     $implied_outer_context,
                     false,
                     array_keys($negated_elseif_types),
-                    $if_scope->updated_vars
+                    $updated_vars
                 );
             }
         }
diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/Call/Method/MethodCallPurityAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/Call/Method/MethodCallPurityAnalyzer.php
index 961a21923..5cd5f853f 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/Call/Method/MethodCallPurityAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/Call/Method/MethodCallPurityAnalyzer.php
@@ -154,12 +154,15 @@ class MethodCallPurityAnalyzer
                 if ($this_property_didnt_exist) {
                     $context->vars_in_scope[$mutation_var_id] = Type::getMixed();
                 } else {
-                    $context->vars_in_scope[$mutation_var_id] = AssignmentAnalyzer::getExpandedPropertyType(
+                    $new_type = AssignmentAnalyzer::getExpandedPropertyType(
                         $codebase,
                         $class_storage->name,
                         $name,
                         $class_storage
                     ) ?: Type::getMixed();
+
+                    $context->vars_in_scope[$mutation_var_id] = $new_type;
+                    $context->possibly_assigned_var_ids[$mutation_var_id] = true;
                 }
             }
         }
diff --git a/src/Psalm/Internal/PhpVisitor/AssignmentMapVisitor.php b/src/Psalm/Internal/PhpVisitor/AssignmentMapVisitor.php
index a1221bdbd..5dfbb56ff 100644
--- a/src/Psalm/Internal/PhpVisitor/AssignmentMapVisitor.php
+++ b/src/Psalm/Internal/PhpVisitor/AssignmentMapVisitor.php
@@ -72,7 +72,10 @@ class AssignmentMapVisitor extends PhpParser\NodeVisitorAbstract
             return PhpParser\NodeTraverser::DONT_TRAVERSE_CHILDREN;
         }
 
-        if ($node instanceof PhpParser\Node\Expr\FuncCall) {
+        if ($node instanceof PhpParser\Node\Expr\FuncCall
+            || $node instanceof PhpParser\Node\Expr\MethodCall
+            || $node instanceof PhpParser\Node\Expr\StaticCall
+        ) {
             foreach ($node->args as $arg) {
                 $arg_var_id = ExpressionIdentifier::getRootVarId($arg->value, $this->this_class_name);
 
@@ -80,6 +83,12 @@ class AssignmentMapVisitor extends PhpParser\NodeVisitorAbstract
                     $this->assignment_map[$arg_var_id][$arg_var_id] = true;
                 }
             }
+
+            if ($node instanceof PhpParser\Node\Expr\MethodCall) {
+                $var_id = ExpressionIdentifier::getRootVarId($node->var, $this->this_class_name);
+
+                $this->assignment_map[$var_id]['isset'] = true;
+            }
         } elseif ($node instanceof PhpParser\Node\Stmt\Unset_) {
             foreach ($node->vars as $arg) {
                 $arg_var_id = ExpressionIdentifier::getRootVarId($arg, $this->this_class_name);
diff --git a/tests/Loop/WhileTest.php b/tests/Loop/WhileTest.php
index ba15a9a15..a60999486 100644
--- a/tests/Loop/WhileTest.php
+++ b/tests/Loop/WhileTest.php
@@ -660,6 +660,54 @@ class WhileTest extends \Psalm\Tests\TestCase
                         return [];
                     }'
             ],
+            'propertyTypeUpdatedInBranch' => [
+                '<?php
+                    class A
+                    {
+                        public ?int $foo = null;
+
+                        public function setFoo(): void
+                        {
+                            $this->foo = 5;
+                        }
+                    }
+
+                    function bar(A $a): void {
+                        $a->foo = null;
+
+                        while (rand(0, 1)) {
+                            if (rand(0, 1)) {
+                                $a->setFoo();
+                            } elseif ($a->foo !== null) {}
+                        }
+                    }'
+            ],
+            'propertyTypeUpdatedInBranchWithBreak' => [
+                '<?php
+                    class A
+                    {
+                        public ?int $foo = null;
+
+                        public function setFoo(): void
+                        {
+                            $this->foo = 5;
+                        }
+                    }
+
+                    function bar(A $a): void {
+                        $a->foo = null;
+
+                        while (rand(0, 1)) {
+                            if (rand(0, 1)) {
+                                $a->setFoo();
+                            } elseif ($a->foo !== null) {
+                                break;
+                            }
+                        }
+
+                        if ($a->foo !== null) {}
+                    }'
+            ],
         ];
     }
 
