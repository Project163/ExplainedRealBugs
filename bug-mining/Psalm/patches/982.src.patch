diff --git a/src/Psalm/Type/Atomic.php b/src/Psalm/Type/Atomic.php
index b09620fdc..35d3f8764 100644
--- a/src/Psalm/Type/Atomic.php
+++ b/src/Psalm/Type/Atomic.php
@@ -90,7 +90,7 @@ abstract class Atomic implements TypeNode
     /**
      * @param  array{int,int}|null   $php_version
      * @param  array<string, array<string, array{Union}>> $template_type_map
-     * @param  array<string, TypeAlias> $type_aliases
+     * @param  array<string, TypeAlias\LinkableTypeAlias> $type_aliases
      */
     public static function create(
         string $value,
@@ -277,7 +277,7 @@ abstract class Atomic implements TypeNode
                 return new TTypeAlias($type_alias->declaring_fq_classlike_name, $type_alias->alias_name);
             }
 
-            throw new \UnexpectedValueException('This should never happen');
+            throw new \Psalm\Exception\TypeParseTreeException('Invalid type alias ' . $value . ' provided');
         }
 
         return new TNamedObject($value);
diff --git a/tests/TypeAnnotationTest.php b/tests/TypeAnnotationTest.php
index 3ae85cd90..aa9aedac0 100644
--- a/tests/TypeAnnotationTest.php
+++ b/tests/TypeAnnotationTest.php
@@ -521,6 +521,18 @@ class TypeAnnotationTest extends TestCase
                     }',
                 'error_message' => 'PossiblyUndefinedArrayOffset',
             ],
+            'noCrashWithSelfReferencingType' => [
+                '<?php
+                    /**
+                     * @psalm-type SomeType = array{
+                     *     parent?: SomeType,
+                     *     foo?: int,
+                     * }
+                     * @psalm-param SomeType $input
+                     */
+                    function test(array $input):void {}',
+                'error_message' => 'InvalidDocblock',
+            ],
         ];
     }
 }
