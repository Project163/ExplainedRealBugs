diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/CallAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/CallAnalyzer.php
index 7db59ce95..46ff5821b 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/CallAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/CallAnalyzer.php
@@ -1455,7 +1455,7 @@ class CallAnalyzer
                         $generic_params = [];
                     }
 
-                    $original_by_ref_type = $by_ref_type;
+                    $original_by_ref_type = clone $by_ref_type;
 
                     $by_ref_type = clone $by_ref_type;
 
diff --git a/tests/Template/TemplateTest.php b/tests/Template/TemplateTest.php
index 6616b373d..f6405e6c6 100644
--- a/tests/Template/TemplateTest.php
+++ b/tests/Template/TemplateTest.php
@@ -2538,6 +2538,40 @@ class TemplateTest extends TestCase
                     '$a' => 'C&I<C>'
                 ]
             ],
+            'dontModifyByRefTemplatedArray' => [
+                '<?php
+                    class A {}
+                    class B {}
+
+                    /**
+                     * @template T of object
+                     * @param class-string<T> $className
+                     * @param array<T> $map
+                     * @param-out array<T> $map
+                     * @param int $id
+                     * @return T
+                     */
+                    function get(string $className, array &$map, int $id) {
+                        if(!array_key_exists($id, $map)) {
+                            $map[$id] = new $className();
+                        }
+                        return $map[$id];
+                    }
+
+                    /**
+                     * @param array<A> $mapA
+                     */
+                    function getA(int $id, array $mapA): A {
+                        return get(A::class, $mapA, $id);
+                    }
+
+                    /**
+                     * @param array<B> $mapB
+                     */
+                    function getB(int $id, array $mapB): B {
+                        return get(B::class, $mapB, $id);
+                    }'
+            ],
         ];
     }
 
