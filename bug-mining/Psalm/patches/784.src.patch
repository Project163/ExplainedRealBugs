diff --git a/src/Psalm/Internal/Type/ParseTreeCreator.php b/src/Psalm/Internal/Type/ParseTreeCreator.php
index 356ca0fa0..f7d84a70f 100644
--- a/src/Psalm/Internal/Type/ParseTreeCreator.php
+++ b/src/Psalm/Internal/Type/ParseTreeCreator.php
@@ -563,6 +563,10 @@ class ParseTreeCreator
             } else {
                 $new_parent = !$this->current_leaf instanceof ParseTree\Root ? $this->current_leaf : null;
 
+                if (!$next_token) {
+                    throw new TypeParseTreeException('Unexpected token ?');
+                }
+
                 $new_leaf = new ParseTree\NullableTree(
                     $new_parent
                 );
diff --git a/src/Psalm/Internal/Type/TypeParser.php b/src/Psalm/Internal/Type/TypeParser.php
index 5f9c8d876..aebd8f663 100644
--- a/src/Psalm/Internal/Type/TypeParser.php
+++ b/src/Psalm/Internal/Type/TypeParser.php
@@ -342,6 +342,10 @@ class TypeParser
 
             foreach ($parse_tree->children as $child_tree) {
                 if ($child_tree instanceof ParseTree\NullableTree) {
+                    if (!isset($child_tree->children[0])) {
+                        throw new TypeParseTreeException('Invalid ? character');
+                    }
+
                     $atomic_type = self::getTypeFromTree(
                         $child_tree->children[0],
                         $codebase,
diff --git a/tests/TypeParseTest.php b/tests/TypeParseTest.php
index 34a8aed0d..a0cb815ff 100644
--- a/tests/TypeParseTest.php
+++ b/tests/TypeParseTest.php
@@ -100,6 +100,24 @@ class TypeParseTest extends TestCase
         $this->assertSame('int|null|string', (string) Type::parseString('?string|?int'));
     }
 
+    /**
+     * @return void
+     */
+    public function testBadNullableCharacterInUnion()
+    {
+        $this->expectException(\Psalm\Exception\TypeParseTreeException::class);
+        Type::parseString('int|array|?');
+    }
+
+    /**
+     * @return void
+     */
+    public function testBadNullableCharacterInUnionWithFollowing()
+    {
+        $this->expectException(\Psalm\Exception\TypeParseTreeException::class);
+        Type::parseString('int|array|?|bool');
+    }
+
     /**
      * @return void
      */
