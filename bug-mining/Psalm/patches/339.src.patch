diff --git a/src/Psalm/Internal/Analyzer/FunctionLike/ReturnTypeAnalyzer.php b/src/Psalm/Internal/Analyzer/FunctionLike/ReturnTypeAnalyzer.php
index 54171151c..9dfd88172 100644
--- a/src/Psalm/Internal/Analyzer/FunctionLike/ReturnTypeAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/FunctionLike/ReturnTypeAnalyzer.php
@@ -731,6 +731,15 @@ class ReturnTypeAnalyzer
             $parent_class
         );
 
+        if ($fleshed_out_return_type->check(
+            $function_like_analyzer,
+            $storage->return_type_location,
+            $storage->suppressed_issues,
+            []
+        ) === false) {
+            return false;
+        }
+
         if ($classlike_storage && $context->self && $function->name) {
             $class_template_params = MethodCallAnalyzer::getClassTemplateParams(
                 $codebase,
diff --git a/src/Psalm/Type/Atomic/GenericTrait.php b/src/Psalm/Type/Atomic/GenericTrait.php
index c7eb04cc9..3a367ce9f 100644
--- a/src/Psalm/Type/Atomic/GenericTrait.php
+++ b/src/Psalm/Type/Atomic/GenericTrait.php
@@ -260,6 +260,7 @@ trait GenericTrait
             }
 
             $expected_type_params = $class_storage->template_types ?: [];
+            $expected_param_covariants = $class_storage->template_covariants;
         } else {
             $expected_type_params = [
                 'TKey' => [
@@ -305,7 +306,9 @@ trait GenericTrait
                 $suppressed_issues,
                 $phantom_classes,
                 $inferred,
-                $prevent_template_covariance
+                $source instanceof \Psalm\Internal\Analyzer\MethodAnalyzer
+                    && $source->getMethodName() !== '__construct'
+                    && empty($expected_param_covariants[$i])
             ) === false) {
                 return false;
             }
diff --git a/src/Psalm/Type/Atomic/TTemplateParam.php b/src/Psalm/Type/Atomic/TTemplateParam.php
index 4e711f001..c186b8305 100644
--- a/src/Psalm/Type/Atomic/TTemplateParam.php
+++ b/src/Psalm/Type/Atomic/TTemplateParam.php
@@ -7,6 +7,7 @@ use Psalm\CodeLocation;
 use Psalm\StatementsSource;
 use Psalm\Type;
 use Psalm\Type\Union;
+use Psalm\Storage\MethodStorage;
 
 class TTemplateParam extends \Psalm\Type\Atomic
 {
@@ -169,16 +170,20 @@ class TTemplateParam extends \Psalm\Type\Atomic
                 && isset($class_storage->template_covariants[$template_offset])
                 && $class_storage->template_covariants[$template_offset]
             ) {
-                if ($source instanceof \Psalm\Internal\Analyzer\FunctionLikeAnalyzer
-                    && $source->getFunctionLikeStorage()->mutation_free
+                $method_storage = $source instanceof \Psalm\Internal\Analyzer\MethodAnalyzer
+                    ? $source->getFunctionLikeStorage()
+                    : null;
+
+                if ($method_storage instanceof MethodStorage
+                    && $method_storage->mutation_free
+                    && !$method_storage->mutation_free_inferred
                 ) {
                     // do nothing
                 } else {
                     if (\Psalm\IssueBuffer::accepts(
                         new \Psalm\Issue\InvalidTemplateParam(
                             'Template param ' . $this->param_name . ' of '
-                                . $this->defining_class . ' is marked covariant and cannot be used'
-                                . ' as input to a function',
+                                . $this->defining_class . ' is marked covariant and cannot be used here',
                             $code_location
                         ),
                         $source->getSuppressedIssues()
diff --git a/tests/Template/ClassTemplateCovarianceTest.php b/tests/Template/ClassTemplateCovarianceTest.php
index ffa03fbd9..7c356bcee 100644
--- a/tests/Template/ClassTemplateCovarianceTest.php
+++ b/tests/Template/ClassTemplateCovarianceTest.php
@@ -82,7 +82,7 @@ class ClassTemplateCovarianceTest extends TestCase
                     /** @param Foo<array{foo: string}> $_ */
                     function expectsShape($_): void {}',
             ],
-            'allowPassingToCovariantCollection' => [
+            'allowPassingToCovariantCollectionWithoutExtends' => [
                 '<?php
                     abstract class Animal {
                         abstract public function getSound() : string;
@@ -454,6 +454,49 @@ class ClassTemplateCovarianceTest extends TestCase
                     sendFoo($gen);',
                 'error_message' => 'InvalidArgument',
             ],
+            'preventCovariantParamMappingToInvariant' => [
+                '<?php
+                    /** @template T */
+                    class InvariantReference
+                    {
+                        /** @var T */
+                        private $value;
+
+                        /** @param T $value */
+                        public function __construct($value)
+                        {
+                            $this->value = $value;
+                        }
+
+                        /** @return T */
+                        public function get()
+                        {
+                            return $this->value;
+                        }
+                    }
+
+                    /**
+                     * @template-covariant T
+                     */
+                    class C
+                    {
+                        /** @var InvariantReference<T> */
+                        private InvariantReference $reference;
+
+                        /** @param InvariantReference<T> $reference */
+                        public function __construct(InvariantReference $reference)
+                        {
+                            $this->reference = $reference;
+                        }
+
+                        /** @return InvariantReference<T> */
+                        public function getReference() : InvariantReference
+                        {
+                            return $this->reference;
+                        }
+                    }',
+                'error_message' => 'InvalidTemplateParam'
+            ],
         ];
     }
 }
diff --git a/tests/Template/ClassTemplateTest.php b/tests/Template/ClassTemplateTest.php
index 59698fbdb..047482fb2 100644
--- a/tests/Template/ClassTemplateTest.php
+++ b/tests/Template/ClassTemplateTest.php
@@ -382,17 +382,17 @@ class ClassTemplateTest extends TestCase
                     class FooFacade
                     {
                         /**
-                         * @template T
+                         * @template T as object
                          * @param  T $item
                          */
-                        public function add($item): void
+                        public function add(object $item): void
                         {
                             $foo = $this->ensureFoo([$item]);
                             $foo->add($item);
                         }
 
                         /**
-                         * @template T
+                         * @template T as object
                          * @param  array<mixed,T> $items
                          * @return Foo<T>
                          */
