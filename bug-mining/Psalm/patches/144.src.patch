diff --git a/src/Psalm/Internal/Visitor/ReflectorVisitor.php b/src/Psalm/Internal/Visitor/ReflectorVisitor.php
index dccc1c2fb..fdbccd5a1 100644
--- a/src/Psalm/Internal/Visitor/ReflectorVisitor.php
+++ b/src/Psalm/Internal/Visitor/ReflectorVisitor.php
@@ -848,7 +848,7 @@ class ReflectorVisitor extends PhpParser\NodeVisitorAbstract implements PhpParse
             }
         }
 
-        if ($function_id === 'class_alias') {
+        if ($function_id === 'class_alias' && !$this->skip_if_descendants) {
             $first_arg = $node->args[0]->value ?? null;
             $second_arg = $node->args[1]->value ?? null;
 
diff --git a/tests/ClassTest.php b/tests/ClassTest.php
index 98ed5c80c..97c64174e 100644
--- a/tests/ClassTest.php
+++ b/tests/ClassTest.php
@@ -416,6 +416,19 @@ class ClassTest extends TestCase
                         }
                     }'
             ],
+            'classAliasOnNonexistantClass' => [
+                '<?php
+                    if (!class_exists(\PHPUnit\Framework\TestCase::class)) {
+                        /** @psalm-suppress UndefinedClass */
+                        class_alias(\PHPUnit_Framework_TestCase::class, \PHPUnit\Framework\TestCase::class);
+                    }
+
+                    class T extends \PHPUnit\Framework\TestCase {
+
+                    }',
+                [],
+                ['PropertyNotSetInConstructor']
+            ],
         ];
     }
 
diff --git a/tests/fixtures/stubs/class_alias.php b/tests/fixtures/stubs/class_alias.php
index 565cd9d11..f2112e8e3 100644
--- a/tests/fixtures/stubs/class_alias.php
+++ b/tests/fixtures/stubs/class_alias.php
@@ -34,3 +34,4 @@ foreach ($arr as list($orig, $alias)) {
     // Psalm cannot reason about this in the loading step
     class_alias($orig, $alias);
 }
+
diff --git a/tests/fixtures/stubs/polyfill.php b/tests/fixtures/stubs/polyfill.php
index 3bcd8ffcf..c55f66d78 100644
--- a/tests/fixtures/stubs/polyfill.php
+++ b/tests/fixtures/stubs/polyfill.php
@@ -22,3 +22,4 @@ if (!function_exists('new_random_bytes')) {
         return 5;
     }
 }
+
