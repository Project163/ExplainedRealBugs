diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/Call/FunctionCallAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/Call/FunctionCallAnalyzer.php
index edb5aaa88..5928b77e9 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/Call/FunctionCallAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/Call/FunctionCallAnalyzer.php
@@ -619,7 +619,7 @@ class FunctionCallAnalyzer extends \Psalm\Internal\Analyzer\Statements\Expressio
                 || $codebase->find_unused_variables
                 || !$config->remember_property_assignments_after_call)
         ) {
-            $must_use = false;
+            $must_use = true;
 
             $callmap_function_pure = $function_id && $in_call_map
                 ? $codebase->functions->isCallMapFunctionPure($codebase, $function_id, $stmt->args, $must_use)
@@ -645,7 +645,7 @@ class FunctionCallAnalyzer extends \Psalm\Internal\Analyzer\Statements\Expressio
                     $context->removeAllObjectVars();
                 }
             } elseif ($function_id
-                && (($function_storage && $function_storage->pure)
+                && (($function_storage && $function_storage->pure && $must_use)
                     || ($callmap_function_pure === true && $must_use))
                 && $codebase->find_unused_variables
                 && !$context->inside_conditional
diff --git a/src/Psalm/Internal/Analyzer/Statements/ExpressionAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/ExpressionAnalyzer.php
index 2fede0cbc..800767581 100644
--- a/src/Psalm/Internal/Analyzer/Statements/ExpressionAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/ExpressionAnalyzer.php
@@ -436,6 +436,9 @@ class ExpressionAnalyzer
 
             $use_context = new Context($context->self);
             $use_context->collect_references = $codebase->collect_references;
+            $use_context->mutation_free = $context->mutation_free;
+            $use_context->external_mutation_free = $context->external_mutation_free;
+            $use_context->pure = $context->pure;
 
             if (!$statements_analyzer->isStatic()) {
                 if ($context->collect_mutations &&
diff --git a/src/Psalm/Internal/Analyzer/TypeAnalyzer.php b/src/Psalm/Internal/Analyzer/TypeAnalyzer.php
index 377637933..25cbb84e8 100644
--- a/src/Psalm/Internal/Analyzer/TypeAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/TypeAnalyzer.php
@@ -1543,7 +1543,8 @@ class TypeAnalyzer
                 return new TCallable(
                     'callable',
                     $function_storage->params,
-                    $function_storage->return_type
+                    $function_storage->return_type,
+                    $function_storage->pure
                 );
             } catch (\Exception $e) {
                 if (CallMap::inCallMap($input_type_part->value)) {
@@ -1561,11 +1562,22 @@ class TypeAnalyzer
                         }
                     }
 
-                    return \Psalm\Internal\Codebase\CallMap::getCallableFromCallMapById(
+                    $matching_callable = \Psalm\Internal\Codebase\CallMap::getCallableFromCallMapById(
                         $codebase,
                         $input_type_part->value,
                         $args
                     );
+
+                    $must_use = false;
+
+                    $matching_callable->is_pure = $codebase->functions->isCallMapFunctionPure(
+                        $codebase,
+                        $input_type_part->value,
+                        null,
+                        $must_use
+                    );
+
+                    return $matching_callable;
                 }
             }
         } elseif ($input_type_part instanceof ObjectLike) {
diff --git a/src/Psalm/Internal/Codebase/Functions.php b/src/Psalm/Internal/Codebase/Functions.php
index 4042e35a4..fba8160cf 100644
--- a/src/Psalm/Internal/Codebase/Functions.php
+++ b/src/Psalm/Internal/Codebase/Functions.php
@@ -262,13 +262,13 @@ class Functions
     }
 
     /**
-     * @param array<int, \PhpParser\Node\Arg> $args
+     * @param ?array<int, \PhpParser\Node\Arg> $args
      */
     public function isCallMapFunctionPure(
         Codebase $codebase,
         string $function_id,
-        array $args,
-        bool &$must_use
+        ?array $args,
+        bool &$must_use = true
     ) : bool {
         $impure_functions = [
             // file io
@@ -358,10 +358,10 @@ class Functions
         $function_callable = \Psalm\Internal\Codebase\CallMap::getCallableFromCallMapById(
             $codebase,
             $function_id,
-            $args
+            $args ?: []
         );
 
-        if (!$function_callable->params || !$args) {
+        if (!$function_callable->params || ($args !== null && \count($args) === 0)) {
             return false;
         }
 
@@ -369,7 +369,16 @@ class Functions
 
         foreach ($function_callable->params as $i => $param) {
             if ($param->type && $param->type->hasCallableType() && isset($args[$i])) {
-                return false;
+                foreach ($param->type->getTypes() as $possible_callable) {
+                    $possible_callable = \Psalm\Internal\Analyzer\TypeAnalyzer::getCallableFromAtomic(
+                        $codebase,
+                        $possible_callable
+                    );
+
+                    if ($possible_callable && !$possible_callable->is_pure) {
+                        return false;
+                    }
+                }
             }
 
             if ($param->by_ref && isset($args[$i])) {
diff --git a/src/Psalm/Type/Atomic/CallableTrait.php b/src/Psalm/Type/Atomic/CallableTrait.php
index f11bd12e2..3ced17661 100644
--- a/src/Psalm/Type/Atomic/CallableTrait.php
+++ b/src/Psalm/Type/Atomic/CallableTrait.php
@@ -24,6 +24,11 @@ trait CallableTrait
      */
     public $return_type;
 
+    /**
+     * @var bool
+     */
+    public $is_pure;
+
     /**
      * Constructs a new instance of a generic type
      *
@@ -31,11 +36,16 @@ trait CallableTrait
      * @param array<int, FunctionLikeParameter> $params
      * @param Union                             $return_type
      */
-    public function __construct($value = 'callable', array $params = null, Union $return_type = null)
-    {
+    public function __construct(
+        $value = 'callable',
+        array $params = null,
+        Union $return_type = null,
+        bool $is_pure = false
+    ) {
         $this->value = $value;
         $this->params = $params;
         $this->return_type = $return_type;
+        $this->is_pure = $is_pure;
     }
 
     public function __clone()
diff --git a/src/psalm-language-server.php b/src/psalm-language-server.php
index 09f2395f3..cb2e015f4 100644
--- a/src/psalm-language-server.php
+++ b/src/psalm-language-server.php
@@ -38,6 +38,7 @@ if ($psalm_proxy !== false) {
     unset($args[$psalm_proxy]);
 }
 
+/** @psalm-suppress UnusedFunctionCall */
 array_map(
     /**
      * @param string $arg
diff --git a/src/psalm-refactor.php b/src/psalm-refactor.php
index ecd2b3868..680f33b41 100644
--- a/src/psalm-refactor.php
+++ b/src/psalm-refactor.php
@@ -27,6 +27,7 @@ $valid_long_options = [
 // get options from command line
 $options = getopt(implode('', $valid_short_options), $valid_long_options);
 
+/** @psalm-suppress UnusedFunctionCall */
 array_map(
     /**
      * @param string $arg
diff --git a/src/psalm.php b/src/psalm.php
index 30513891b..61ccbd1dc 100644
--- a/src/psalm.php
+++ b/src/psalm.php
@@ -89,6 +89,7 @@ if (isset($options['refactor'])) {
     exit;
 }
 
+/** @psalm-suppress UnusedFunctionCall */
 array_map(
     /**
      * @param string $arg
diff --git a/src/psalter.php b/src/psalter.php
index 3158e0a70..9c9ec9412 100644
--- a/src/psalter.php
+++ b/src/psalter.php
@@ -29,6 +29,7 @@ $valid_long_options = [
 // get options from command line
 $options = getopt(implode('', $valid_short_options), $valid_long_options);
 
+/** @psalm-suppress UnusedFunctionCall */
 array_map(
     /**
      * @param string $arg
diff --git a/tests/ImmutableAnnotationTest.php b/tests/ImmutableAnnotationTest.php
index 89449750f..c0fc4492c 100644
--- a/tests/ImmutableAnnotationTest.php
+++ b/tests/ImmutableAnnotationTest.php
@@ -155,6 +155,44 @@ class ImmutableAnnotationTest extends TestCase
                         }
                     }'
             ],
+            'allowArrayMapCallable' => [
+                '<?php
+                    /**
+                     * @psalm-immutable
+                     */
+                    class Address
+                    {
+                        private $line1;
+                        private $line2;
+                        private $city;
+
+                        public function __construct(
+                            string $line1,
+                            ?string $line2,
+                            string $city
+                        ) {
+                            $this->line1 = $line1;
+                            $this->line2 = $line2;
+                            $this->city = $city;
+                        }
+
+                        public function __toString()
+                        {
+                            $parts = [
+                                $this->line1,
+                                $this->line2 ?? "",
+                                $this->city,
+                            ];
+
+                            // Remove empty parts
+                            $parts = \array_map("trim", $parts);
+                            $parts = \array_filter($parts, "strlen");
+                            $parts = \array_map(function(string $s) { return $s;}, $parts);
+
+                            return \implode(", ", $parts);
+                        }
+                    }'
+            ],
         ];
     }
 
diff --git a/tests/PureAnnotationTest.php b/tests/PureAnnotationTest.php
index 1ddd050c8..e5f8d8a7a 100644
--- a/tests/PureAnnotationTest.php
+++ b/tests/PureAnnotationTest.php
@@ -145,6 +145,16 @@ class PureAnnotationTest extends TestCase
                         return $dateTime;
                     }'
             ],
+            'allowArrayMapClosure' => [
+                '<?php
+                    /**
+                     * @psalm-pure
+                     * @param string[] $arr
+                     */
+                    function foo(array $arr) : array {
+                        return \array_map(function(string $s) { return $s;}, $arr);
+                    }'
+            ],
         ];
     }
 
@@ -276,6 +286,17 @@ class PureAnnotationTest extends TestCase
                     }',
                 'error_message' => 'ImpureStaticVariable',
             ],
+            'preventImpureArrayMapClosure' => [
+                '<?php
+                    /**
+                     * @psalm-pure
+                     * @param string[] $arr
+                     */
+                    function foo(array $arr) : array {
+                        return \array_map(function(string $s) { return $s . rand(0, 1);}, $arr);
+                    }',
+                'error_message' => 'ImpureFunctionCall',
+            ],
         ];
     }
 }
diff --git a/tests/UnusedCodeTest.php b/tests/UnusedCodeTest.php
index ff0b8077d..c20fbd6ad 100644
--- a/tests/UnusedCodeTest.php
+++ b/tests/UnusedCodeTest.php
@@ -606,6 +606,14 @@ class UnusedCodeTest extends TestCase
                         return $c;
                     }',
             ],
+            'usedUsort' => [
+                '<?php
+                    /** @param string[] $arr */
+                    function foo(array $arr) : array {
+                        usort($arr, "strnatcasecmp");
+                        return $arr;
+                    }'
+            ],
         ];
     }
 
