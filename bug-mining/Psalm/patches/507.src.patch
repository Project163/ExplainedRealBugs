diff --git a/src/Psalm/Internal/Type/AssertionReconciler.php b/src/Psalm/Internal/Type/AssertionReconciler.php
index 5aa54370e..946f1b0d0 100644
--- a/src/Psalm/Internal/Type/AssertionReconciler.php
+++ b/src/Psalm/Internal/Type/AssertionReconciler.php
@@ -155,6 +155,7 @@ class AssertionReconciler extends \Psalm\Type\Reconciler
                 $is_strict_equality,
                 $is_loose_equality,
                 $existing_var_type,
+                $template_type_map,
                 $old_var_type_string,
                 $key,
                 $code_location,
diff --git a/src/Psalm/Internal/Type/NegatedAssertionReconciler.php b/src/Psalm/Internal/Type/NegatedAssertionReconciler.php
index 49a50514f..a41a325ca 100644
--- a/src/Psalm/Internal/Type/NegatedAssertionReconciler.php
+++ b/src/Psalm/Internal/Type/NegatedAssertionReconciler.php
@@ -47,6 +47,7 @@ class NegatedAssertionReconciler extends Reconciler
      * @param  string     $assertion
      * @param  bool       $is_strict_equality
      * @param  bool       $is_loose_equality
+     * @param   array<string, array<string, array{Type\Union}>> $template_type_map
      * @param  string     $old_var_type_string
      * @param  string|null $key
      * @param  CodeLocation|null $code_location
@@ -61,6 +62,7 @@ class NegatedAssertionReconciler extends Reconciler
         $is_strict_equality,
         $is_loose_equality,
         Type\Union $existing_var_type,
+        array $template_type_map,
         $old_var_type_string,
         $key,
         $code_location,
@@ -359,7 +361,7 @@ class NegatedAssertionReconciler extends Reconciler
             && ($key !== '$this'
                 || !($statements_analyzer->getSource()->getSource() instanceof TraitAnalyzer))
         ) {
-            $assertion = Type::parseString($assertion);
+            $assertion = Type::parseString($assertion, null, $template_type_map);
 
             if ($key
                 && $code_location
diff --git a/src/Psalm/Type/Atomic/TTemplateParamClass.php b/src/Psalm/Type/Atomic/TTemplateParamClass.php
index 2cc57861a..a11e57036 100644
--- a/src/Psalm/Type/Atomic/TTemplateParamClass.php
+++ b/src/Psalm/Type/Atomic/TTemplateParamClass.php
@@ -59,6 +59,14 @@ class TTemplateParamClass extends TClassString
         return 'class-string<' . $this->param_name . ':' . $this->defining_class . ' as ' . $this->as . '>';
     }
 
+    /**
+     * @return string
+     */
+    public function getAssertionString()
+    {
+        return 'class-string<' . $this->param_name . '>';
+    }
+
     /**
      * @param  string|null   $namespace
      * @param  array<string> $aliased_classes
diff --git a/tests/Template/ClassTemplateTest.php b/tests/Template/ClassTemplateTest.php
index 5606dfd73..fc27e3721 100644
--- a/tests/Template/ClassTemplateTest.php
+++ b/tests/Template/ClassTemplateTest.php
@@ -618,7 +618,6 @@ class ClassTemplateTest extends TestCase
                          */
                         public function bar(Foo $object) : void
                         {
-                            /** @psalm-suppress RedundantConditionGivenDocblockType */
                             if ($this->getType() !== get_class($object)) {
                                 return;
                             }
diff --git a/tests/Template/FunctionClassStringTemplateTest.php b/tests/Template/FunctionClassStringTemplateTest.php
index c802ac352..6d9502fd3 100644
--- a/tests/Template/FunctionClassStringTemplateTest.php
+++ b/tests/Template/FunctionClassStringTemplateTest.php
@@ -637,6 +637,18 @@ class FunctionClassStringTemplateTest extends TestCase
                     '$b_or_c' => 'B|C',
                 ]
             ],
+            'allowComparisonWithoutCrash' => [
+                '<?php
+                    /**
+                     * @template T as object
+                     *
+                     * @param T::class $e
+                     * @param T::class $expected
+                     */
+                    function bar(string $e, string $expected) : void {
+                        if ($e !== $expected) {}
+                    }',
+            ],
         ];
     }
 
