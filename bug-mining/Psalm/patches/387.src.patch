diff --git a/src/Psalm/Internal/Codebase/Populator.php b/src/Psalm/Internal/Codebase/Populator.php
index 91bdeb7f3..6127b3737 100644
--- a/src/Psalm/Internal/Codebase/Populator.php
+++ b/src/Psalm/Internal/Codebase/Populator.php
@@ -274,17 +274,14 @@ class Populator
                         = $declaring_class_storages[$declaring_class]
                         = $this->classlike_storage_provider->get($declaring_class);
 
-                    if (!isset($declaring_class_storage->overridden_method_ids[$method_name])) {
-                        throw new \UnexpectedValueException('Declaring storage should have ids');
-                    }
-
                     if ($candidate_overridden_ids === null) {
-                        $candidate_overridden_ids = $declaring_class_storage->overridden_method_ids[$method_name]
-                            + [$declaring_method_id => $declaring_method_id];
+                        $candidate_overridden_ids
+                            = ($declaring_class_storage->overridden_method_ids[$method_name] ?? [])
+                                + [$declaring_method_id => $declaring_method_id];
                     } else {
                         $candidate_overridden_ids = \array_intersect_key(
                             $candidate_overridden_ids,
-                            $declaring_class_storage->overridden_method_ids[$method_name]
+                            ($declaring_class_storage->overridden_method_ids[$method_name] ?? [])
                                 + [$declaring_method_id => $declaring_method_id]
                         );
                     }
diff --git a/tests/TraitTest.php b/tests/TraitTest.php
index 9d719cef3..5999300c0 100644
--- a/tests/TraitTest.php
+++ b/tests/TraitTest.php
@@ -895,6 +895,31 @@ class TraitTest extends TestCase
                         use Feature;
                     }',
             ],
+            'renameMethodNoCrash' => [
+                '<?php
+
+                    trait HelloTrait {
+                        protected function sayHello() : string {
+                            return "Hello";
+                        }
+                    }
+
+                    class Person {
+                        use HelloTrait {
+                            sayHello as orginalSayHello;
+                        }
+
+                        protected function sayHello() : string {
+                            return $this->orginalSayHello();
+                        }
+                    }
+
+                    class BrokenPerson extends Person {
+                        protected function orginalSayHello() : string {
+                            return "bad";
+                        }
+                    }',
+            ],
         ];
     }
 
