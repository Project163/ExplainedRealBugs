diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/Assignment/ArrayAssignmentAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/Assignment/ArrayAssignmentAnalyzer.php
index ff27f603f..88e8cf87a 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/Assignment/ArrayAssignmentAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/Assignment/ArrayAssignmentAnalyzer.php
@@ -185,7 +185,8 @@ class ArrayAssignmentAnalyzer
                 }
 
                 if ($child_stmt->dim instanceof PhpParser\Node\Scalar\String_
-                    || ($child_stmt->dim instanceof PhpParser\Node\Expr\ConstFetch
+                    || (($child_stmt->dim instanceof PhpParser\Node\Expr\ConstFetch
+                            || $child_stmt->dim instanceof PhpParser\Node\Expr\ClassConstFetch)
                        && $child_stmt_dim_type->isSingleStringLiteral())
                 ) {
                     if ($child_stmt->dim instanceof PhpParser\Node\Scalar\String_) {
@@ -199,7 +200,8 @@ class ArrayAssignmentAnalyzer
                     }
                     $var_id_additions[] = '[\'' . $value . '\']';
                 } elseif ($child_stmt->dim instanceof PhpParser\Node\Scalar\LNumber
-                    || ($child_stmt->dim instanceof PhpParser\Node\Expr\ConstFetch
+                    || (($child_stmt->dim instanceof PhpParser\Node\Expr\ConstFetch
+                            || $child_stmt->dim instanceof PhpParser\Node\Expr\ClassConstFetch)
                         && $child_stmt_dim_type->isSingleIntLiteral())
                 ) {
                     if ($child_stmt->dim instanceof PhpParser\Node\Scalar\LNumber) {
diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/Fetch/ArrayFetchAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/Fetch/ArrayFetchAnalyzer.php
index af013aa0f..b2d88a789 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/Fetch/ArrayFetchAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/Fetch/ArrayFetchAnalyzer.php
@@ -82,16 +82,16 @@ class ArrayFetchAnalyzer
             $statements_analyzer
         );
 
+        if ($stmt->dim && ExpressionAnalyzer::analyze($statements_analyzer, $stmt->dim, $context) === false) {
+            return false;
+        }
+
         $keyed_array_var_id = ExpressionAnalyzer::getArrayVarId(
             $stmt,
             $statements_analyzer->getFQCLN(),
             $statements_analyzer
         );
 
-        if ($stmt->dim && ExpressionAnalyzer::analyze($statements_analyzer, $stmt->dim, $context) === false) {
-            return false;
-        }
-
         $dim_var_id = null;
         $new_offset_type = null;
 
diff --git a/tests/TypeReconciliation/IssetTest.php b/tests/TypeReconciliation/IssetTest.php
index 1fda2b2ec..8a71938f6 100644
--- a/tests/TypeReconciliation/IssetTest.php
+++ b/tests/TypeReconciliation/IssetTest.php
@@ -916,6 +916,34 @@ class IssetTest extends \Psalm\Tests\TestCase
                         }
                     }',
             ],
+            'issetOnClassConstantOffset' => [
+                '<?php
+
+                    final class StudyJwtPayload {
+                        public const STUDY_ID = "studid";
+
+                        public static function fromClaims(array $claims): string
+                        {
+                            if (!isset($claims["usrid"])) {
+                                throw new \InvalidArgumentException();
+                            }
+
+                            if (!\is_string($claims["usrid"])) {
+                                throw new \InvalidArgumentException();
+                            }
+
+                            if (!isset($claims[self::STUDY_ID])) {
+                                throw new \InvalidArgumentException();
+                            }
+
+                            if (!\is_string($claims[self::STUDY_ID])) {
+                                throw new \InvalidArgumentException();
+                            }
+
+                            return $claims[self::STUDY_ID];
+                        }
+                    }'
+            ],
         ];
     }
 
