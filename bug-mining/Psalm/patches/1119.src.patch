diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php
index 3544f5d80..a91030bf7 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php
@@ -158,6 +158,10 @@ class AssignmentAnalyzer
                     $comment_type_location,
                     $not_ignored_docblock_var_ids
                 );
+
+                if ($var_id === $var_comment->var_id && $assign_value_type && $comment_type) {
+                    $comment_type->by_ref = $assign_value_type->by_ref;
+                }
             }
         }
 
diff --git a/tests/UnusedVariableTest.php b/tests/UnusedVariableTest.php
index 7b92d6a2c..9fcdb59e4 100644
--- a/tests/UnusedVariableTest.php
+++ b/tests/UnusedVariableTest.php
@@ -2377,6 +2377,16 @@ class UnusedVariableTest extends TestCase
                         return $sortA;
                     }'
             ],
+            'varDocblockVariableIsUsedByRef' => [
+                '<?php
+                    function foo(array $arr) : string {
+                        /** @var string $val */
+                        foreach ($arr as &$val) {
+                            $val = urlencode($val);
+                        }
+                        return implode("/", $arr);
+                    }'
+            ],
         ];
     }
 
