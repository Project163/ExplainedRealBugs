diff --git a/src/Psalm/Type/Atomic/GenericTrait.php b/src/Psalm/Type/Atomic/GenericTrait.php
index 937fb569f..b5304eac0 100644
--- a/src/Psalm/Type/Atomic/GenericTrait.php
+++ b/src/Psalm/Type/Atomic/GenericTrait.php
@@ -175,13 +175,25 @@ trait GenericTrait
             $input_type = new Atomic\TArray([Type::getInt(), $input_type->type_param]);
         }
 
+        $input_object_type_params = [];
+
+        if ($input_type instanceof Atomic\TGenericObject
+            && ($this instanceof Atomic\TGenericObject || $this instanceof Atomic\TIterable)
+            && $codebase
+        ) {
+            $input_object_type_params = UnionTemplateHandler::getMappedGenericTypeParams(
+                $codebase,
+                $input_type,
+                $this
+            );
+        }
+
         $atomic = clone $this;
 
         foreach ($atomic->type_params as $offset => $type_param) {
             $input_type_param = null;
 
-            if (($input_type instanceof Atomic\TGenericObject
-                    || $input_type instanceof Atomic\TIterable
+            if (($input_type instanceof Atomic\TIterable
                     || $input_type instanceof Atomic\TArray)
                 &&
                     isset($input_type->type_params[$offset])
@@ -195,6 +207,10 @@ trait GenericTrait
                 } else {
                     throw new \UnexpectedValueException('Not expecting offset of ' . $offset);
                 }
+            } elseif ($input_type instanceof Atomic\TNamedObject
+                && isset($input_object_type_params[$offset])
+            ) {
+                $input_type_param = $input_object_type_params[$offset];
             }
 
             /** @psalm-suppress PropertyTypeCoercion */
diff --git a/tests/Template/ClassTemplateExtendsTest.php b/tests/Template/ClassTemplateExtendsTest.php
index a4049b7c2..d70d2624c 100644
--- a/tests/Template/ClassTemplateExtendsTest.php
+++ b/tests/Template/ClassTemplateExtendsTest.php
@@ -4031,6 +4031,54 @@ class ClassTemplateExtendsTest extends TestCase
                         return $cheese->getTypes();
                     }'
             ],
+            'unwrapExtendedTypeWhileInferring' => [
+                '<?php
+                    /** @template T1 */
+                    interface I {}
+
+                    /** @template T2 */
+                    interface J {}
+
+                    /**
+                     * @template T3
+                     * @template-implements I<J<T3>>
+                     */
+                    final class IC implements I {
+                        /** @var T3 */
+                        public $var;
+
+                        /** @param T3 $var */
+                        public function __construct($var) {
+                            $this->var = $var;
+                        }
+                    }
+
+                    /** @template T4 */
+                    final class Container
+                    {
+                        /** @var I<T4> $var */
+                        public I $var;
+
+                        /** @param I<T4> $var */
+                        public function __construct(I $var) {
+                            $this->var = $var;
+                        }
+                    }
+
+                    final class Obj {}
+
+                    final class B {
+                        /** @return Container<J<int>> */
+                        public function foo(int $i): Container
+                        {
+                            $ic = new IC($i);
+
+                            $container = new Container($ic);
+
+                            return $container;
+                        }
+                    }'
+            ],
         ];
     }
 
