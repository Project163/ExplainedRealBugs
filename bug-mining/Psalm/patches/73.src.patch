diff --git a/src/Psalm/Internal/Analyzer/ClassAnalyzer.php b/src/Psalm/Internal/Analyzer/ClassAnalyzer.php
index 71c49f777..d3055907e 100644
--- a/src/Psalm/Internal/Analyzer/ClassAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/ClassAnalyzer.php
@@ -587,7 +587,8 @@ class ClassAnalyzer extends ClassLikeAnalyzer
                     $codebase,
                     $property_type,
                     $this->fq_class_name,
-                    $this->fq_class_name
+                    $this->fq_class_name,
+                    $this->parent_fq_class_name
                 )
                 : $property_type;
 
@@ -637,7 +638,8 @@ class ClassAnalyzer extends ClassLikeAnalyzer
                     $codebase,
                     $property_type,
                     $this->fq_class_name,
-                    $this->fq_class_name
+                    $this->fq_class_name,
+                    $this->parent_fq_class_name
                 )
                 : $property_type;
 
diff --git a/src/Psalm/Internal/Analyzer/FileAnalyzer.php b/src/Psalm/Internal/Analyzer/FileAnalyzer.php
index a872b4e68..c97b56ca0 100644
--- a/src/Psalm/Internal/Analyzer/FileAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/FileAnalyzer.php
@@ -522,6 +522,14 @@ class FileAnalyzer extends SourceAnalyzer implements StatementsSource
         return null;
     }
 
+    /**
+     * @return null|string
+     */
+    public function getParentFQCLN()
+    {
+        return null;
+    }
+
     /**
      * @return null|string
      */
diff --git a/src/Psalm/Internal/Analyzer/FunctionLike/ReturnTypeAnalyzer.php b/src/Psalm/Internal/Analyzer/FunctionLike/ReturnTypeAnalyzer.php
index ce5f26029..6be0d2f37 100644
--- a/src/Psalm/Internal/Analyzer/FunctionLike/ReturnTypeAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/FunctionLike/ReturnTypeAnalyzer.php
@@ -214,7 +214,8 @@ class ReturnTypeAnalyzer
                 $codebase,
                 $inferred_return_type,
                 $source->getFQCLN(),
-                $source->getFQCLN()
+                $source->getFQCLN(),
+                $source->getParentFQCLN()
             )
         );
 
@@ -325,12 +326,20 @@ class ReturnTypeAnalyzer
 
         $self_fq_class_name = $fq_class_name ?: $source->getFQCLN();
 
+        $parent_class = null;
+
+        if ($self_fq_class_name) {
+            $classlike_storage = $codebase->classlike_storage_provider->get($self_fq_class_name);
+            $parent_class = $classlike_storage->parent_class;
+        }
+
         // passing it through fleshOutTypes eradicates errant $ vars
         $declared_return_type = ExpressionAnalyzer::fleshOutType(
             $codebase,
             $return_type,
             $self_fq_class_name,
-            $self_fq_class_name
+            $self_fq_class_name,
+            $parent_class
         );
 
         if (!$inferred_return_type_parts && !$inferred_yield_types) {
@@ -620,12 +629,20 @@ class ReturnTypeAnalyzer
             return;
         }
 
+        $parent_class = null;
+
+        if ($context->self) {
+            $classlike_storage = $codebase->classlike_storage_provider->get($context->self);
+            $parent_class = $classlike_storage->parent_class;
+        }
+
         if (!$storage->signature_return_type || $storage->signature_return_type === $storage->return_type) {
             $fleshed_out_return_type = ExpressionAnalyzer::fleshOutType(
                 $codebase,
                 $storage->return_type,
                 $context->self,
-                $context->self
+                $context->self,
+                $parent_class
             );
 
             $fleshed_out_return_type->check(
@@ -643,7 +660,8 @@ class ReturnTypeAnalyzer
             $codebase,
             $storage->signature_return_type,
             $context->self,
-            $context->self
+            $context->self,
+            $parent_class
         );
 
         if ($fleshed_out_signature_type->check(
@@ -664,7 +682,8 @@ class ReturnTypeAnalyzer
             $codebase,
             $storage->return_type,
             $context->self,
-            $context->self
+            $context->self,
+            $parent_class
         );
 
         if (!TypeAnalyzer::isContainedBy(
diff --git a/src/Psalm/Internal/Analyzer/FunctionLikeAnalyzer.php b/src/Psalm/Internal/Analyzer/FunctionLikeAnalyzer.php
index 8d4c5a4f4..9579e7ff3 100644
--- a/src/Psalm/Internal/Analyzer/FunctionLikeAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/FunctionLikeAnalyzer.php
@@ -267,7 +267,8 @@ abstract class FunctionLikeAnalyzer extends SourceAnalyzer implements Statements
                     $codebase,
                     $storage->return_type,
                     $context->self,
-                    $context->self
+                    $context->self,
+                    $this->getParentFQCLN()
                 );
             } else {
                 $closure_return_type = Type::getMixed();
@@ -385,7 +386,8 @@ abstract class FunctionLikeAnalyzer extends SourceAnalyzer implements Statements
                     $codebase,
                     $signature_type,
                     $context->self,
-                    $context->self
+                    $context->self,
+                    $this->getParentFQCLN()
                 );
             }
 
@@ -406,7 +408,8 @@ abstract class FunctionLikeAnalyzer extends SourceAnalyzer implements Statements
                     $codebase,
                     $param_type,
                     $context->self,
-                    $context->self
+                    $context->self,
+                    $this->getParentFQCLN()
                 );
 
                 if ($function_param->type_location) {
@@ -430,7 +433,8 @@ abstract class FunctionLikeAnalyzer extends SourceAnalyzer implements Statements
                         $codebase,
                         $param_type,
                         $context->self,
-                        $context->self
+                        $context->self,
+                        $this->getParentFQCLN()
                     );
                 } else {
                     $param_type = Type::getMixed();
@@ -1425,7 +1429,8 @@ abstract class FunctionLikeAnalyzer extends SourceAnalyzer implements Statements
             $this->codebase,
             $storage_return_type,
             $this->getFQCLN(),
-            $this->getFQCLN()
+            $this->getFQCLN(),
+            $this->getParentFQCLN()
         );
 
         return $this->local_return_type;
diff --git a/src/Psalm/Internal/Analyzer/MethodAnalyzer.php b/src/Psalm/Internal/Analyzer/MethodAnalyzer.php
index 1594bf886..fa8832182 100644
--- a/src/Psalm/Internal/Analyzer/MethodAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/MethodAnalyzer.php
@@ -565,7 +565,8 @@ class MethodAnalyzer extends FunctionLikeAnalyzer
                 $codebase,
                 $guide_method_storage->signature_return_type,
                 $guide_classlike_storage->name,
-                $guide_classlike_storage->name
+                $guide_classlike_storage->name,
+                $guide_classlike_storage->parent_class
             );
 
             $implementer_signature_return_type = $implementer_method_storage->signature_return_type
@@ -573,7 +574,8 @@ class MethodAnalyzer extends FunctionLikeAnalyzer
                     $codebase,
                     $implementer_method_storage->signature_return_type,
                     $implementer_classlike_storage->name,
-                    $implementer_classlike_storage->name
+                    $implementer_classlike_storage->name,
+                    $implementer_classlike_storage->parent_class
                 ) : null;
 
             if (!TypeAnalyzer::isContainedByInPhp($implementer_signature_return_type, $guide_signature_return_type)) {
@@ -618,14 +620,16 @@ class MethodAnalyzer extends FunctionLikeAnalyzer
                 $codebase,
                 $implementer_method_storage->return_type,
                 $implementer_classlike_storage->name,
-                $implementer_called_class_name
+                $implementer_called_class_name,
+                $implementer_classlike_storage->parent_class
             );
 
             $guide_method_storage_return_type = ExpressionAnalyzer::fleshOutType(
                 $codebase,
                 $guide_method_storage->return_type,
                 $guide_classlike_storage->name,
-                $guide_classlike_storage->name
+                $guide_classlike_storage->name,
+                $guide_classlike_storage->parent_class
             );
 
             $guide_class_name_lc = strtolower($guide_classlike_storage->name);
@@ -812,7 +816,8 @@ class MethodAnalyzer extends FunctionLikeAnalyzer
                         $codebase,
                         $guide_param->signature_type,
                         $guide_classlike_storage->name,
-                        $guide_classlike_storage->name
+                        $guide_classlike_storage->name,
+                        $guide_classlike_storage->parent_class
                     )
                     : null;
 
@@ -820,7 +825,8 @@ class MethodAnalyzer extends FunctionLikeAnalyzer
                     $codebase,
                     $implementer_param->signature_type,
                     $implementer_classlike_storage->name,
-                    $implementer_classlike_storage->name
+                    $implementer_classlike_storage->name,
+                    $implementer_classlike_storage->parent_class,
                 );
 
                 if (!TypeAnalyzer::isContainedByInPhp(
@@ -868,14 +874,16 @@ class MethodAnalyzer extends FunctionLikeAnalyzer
                     $codebase,
                     $implementer_param->type,
                     $implementer_classlike_storage->name,
-                    $implementer_called_class_name
+                    $implementer_called_class_name,
+                    $implementer_classlike_storage->parent_class,
                 );
 
                 $guide_method_storage_param_type = ExpressionAnalyzer::fleshOutType(
                     $codebase,
                     $guide_param->type,
                     $guide_classlike_storage->name,
-                    $guide_classlike_storage->name
+                    $guide_classlike_storage->name,
+                    $guide_classlike_storage->parent_class,
                 );
 
                 $guide_class_name_lc = strtolower($guide_classlike_storage->name);
diff --git a/src/Psalm/Internal/Analyzer/Statements/Block/ForeachAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Block/ForeachAnalyzer.php
index de012b85c..1c70ad3bb 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Block/ForeachAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Block/ForeachAnalyzer.php
@@ -106,7 +106,8 @@ class ForeachAnalyzer
                 $codebase,
                 $var_comment->type,
                 $context->self,
-                $context->self
+                $context->self,
+                $statements_analyzer->getParentFQCLN()
             );
 
             if (isset($context->vars_in_scope[$var_comment->var_id])
@@ -221,7 +222,8 @@ class ForeachAnalyzer
                 $codebase,
                 $var_comment->type,
                 $context->self,
-                $context->self
+                $context->self,
+                $statements_analyzer->getParentFQCLN()
             );
 
             $foreach_context->vars_in_scope[$var_comment->var_id] = $comment_type;
diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/Assignment/PropertyAssignmentAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/Assignment/PropertyAssignmentAnalyzer.php
index 68ffa35b1..9e714c8cc 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/Assignment/PropertyAssignmentAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/Assignment/PropertyAssignmentAnalyzer.php
@@ -589,7 +589,8 @@ class PropertyAssignmentAnalyzer
                         $codebase,
                         $class_property_type,
                         $fq_class_name,
-                        $lhs_type_part
+                        $lhs_type_part,
+                        $class_storage->parent_class
                     );
 
                     if (!$class_property_type->hasMixed() && $assignment_value_type->hasMixed()) {
@@ -969,7 +970,8 @@ class PropertyAssignmentAnalyzer
             $codebase,
             $class_property_type,
             $fq_class_name,
-            $fq_class_name
+            $fq_class_name,
+            $class_storage->parent_class
         );
 
         $type_match_found = TypeAnalyzer::isContainedBy(
diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php
index e5db55662..44dfc385b 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php
@@ -112,7 +112,8 @@ class AssignmentAnalyzer
                         $codebase,
                         $var_comment->type,
                         $context->self,
-                        $context->self
+                        $context->self,
+                        $statements_analyzer->getParentFQCLN()
                     );
 
                     $var_comment_type->setFromDocblock();
@@ -496,7 +497,8 @@ class AssignmentAnalyzer
                                     $codebase,
                                     $var_comment->type,
                                     $context->self,
-                                    $context->self
+                                    $context->self,
+                                    $statements_analyzer->getParentFQCLN()
                                 );
 
                                 $var_comment_type->setFromDocblock();
diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/Call/MethodCallAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/Call/MethodCallAnalyzer.php
index 8fffa2c68..368886122 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/Call/MethodCallAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/Call/MethodCallAnalyzer.php
@@ -710,7 +710,8 @@ class MethodCallAnalyzer extends \Psalm\Internal\Analyzer\Statements\Expression\
                             $codebase,
                             $return_type_candidate,
                             $fq_class_name,
-                            $fq_class_name
+                            $fq_class_name,
+                            $class_storage->parent_class
                         );
 
                         if ($all_intersection_return_type) {
@@ -1022,7 +1023,8 @@ class MethodCallAnalyzer extends \Psalm\Internal\Analyzer\Statements\Expression\
                         $codebase,
                         $return_type_candidate,
                         $fq_class_name,
-                        $lhs_type_part
+                        $lhs_type_part,
+                        $class_storage->parent_class
                     );
                 } else {
                     $name_code_location = new CodeLocation($source, $stmt->name);
@@ -1092,7 +1094,8 @@ class MethodCallAnalyzer extends \Psalm\Internal\Analyzer\Statements\Expression\
                             $codebase,
                             $return_type_candidate,
                             $self_fq_class_name,
-                            $lhs_type_part
+                            $lhs_type_part,
+                            $class_storage->parent_class
                         );
 
                         $return_type_location = $codebase->methods->getMethodReturnTypeLocation(
@@ -1496,7 +1499,8 @@ class MethodCallAnalyzer extends \Psalm\Internal\Analyzer\Statements\Expression\
                         $codebase,
                         $class_storage->pseudo_property_set_types['$' . $prop_name],
                         $fq_class_name,
-                        new Type\Atomic\TNamedObject($fq_class_name)
+                        new Type\Atomic\TNamedObject($fq_class_name),
+                        $class_storage->parent_class
                     );
 
                     $type_match_found = TypeAnalyzer::isContainedBy(
diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/Call/StaticCallAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/Call/StaticCallAnalyzer.php
index 98774049e..84a67922b 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/Call/StaticCallAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/Call/StaticCallAnalyzer.php
@@ -409,7 +409,8 @@ class StaticCallAnalyzer extends \Psalm\Internal\Analyzer\Statements\Expression\
                                     $codebase,
                                     $return_type_candidate,
                                     $fq_class_name,
-                                    $fq_class_name
+                                    $fq_class_name,
+                                    $class_storage->parent_class
                                 );
 
                                 if (!isset($stmt->inferredType)) {
@@ -762,7 +763,8 @@ class StaticCallAnalyzer extends \Psalm\Internal\Analyzer\Statements\Expression\
                             $codebase,
                             $return_type_candidate,
                             $self_fq_class_name,
-                            $fq_class_name
+                            $fq_class_name,
+                            $class_storage->parent_class
                         );
 
                         $return_type_location = $codebase->methods->getMethodReturnTypeLocation(
diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/CallAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/CallAnalyzer.php
index 46ff5821b..3e5cf2f36 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/CallAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/CallAnalyzer.php
@@ -1579,11 +1579,19 @@ class CallAnalyzer
                 return;
             }
 
+            $parent_class = null;
+
+            if ($self_fq_class_name) {
+                $classlike_storage = $codebase->classlike_storage_provider->get($self_fq_class_name);
+                $parent_class = $classlike_storage->parent_class;
+            }
+
             $fleshed_out_type = ExpressionAnalyzer::fleshOutType(
                 $codebase,
                 $param_type,
                 $self_fq_class_name,
-                $static_fq_class_name
+                $static_fq_class_name,
+                $parent_class
             );
 
             $fleshed_out_signature_type = $function_param->signature_type
@@ -1591,7 +1599,8 @@ class CallAnalyzer
                     $codebase,
                     $function_param->signature_type,
                     $self_fq_class_name,
-                    $static_fq_class_name
+                    $static_fq_class_name,
+                    $parent_class
                 )
                 : null;
 
diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/Fetch/PropertyFetchAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/Fetch/PropertyFetchAnalyzer.php
index bbe252c4f..1986c4ec7 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/Fetch/PropertyFetchAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/Fetch/PropertyFetchAnalyzer.php
@@ -695,7 +695,8 @@ class PropertyFetchAnalyzer
                     $codebase,
                     clone $class_property_type,
                     $declaring_property_class,
-                    $declaring_property_class
+                    $declaring_property_class,
+                    $declaring_class_storage->parent_class
                 );
 
                 if ($lhs_type_part instanceof TGenericObject) {
@@ -988,7 +989,8 @@ class PropertyFetchAnalyzer
                     $codebase,
                     clone $property->type,
                     $declaring_property_class,
-                    $declaring_property_class
+                    $declaring_property_class,
+                    $class_storage->parent_class
                 );
             } else {
                 $context->vars_in_scope[$var_id] = Type::getMixed();
diff --git a/src/Psalm/Internal/Analyzer/Statements/ExpressionAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/ExpressionAnalyzer.php
index ccc8738e4..4bd206e12 100644
--- a/src/Psalm/Internal/Analyzer/Statements/ExpressionAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/ExpressionAnalyzer.php
@@ -986,8 +986,9 @@ class ExpressionAnalyzer
     public static function fleshOutType(
         Codebase $codebase,
         Type\Union $return_type,
-        $self_class = null,
-        $static_class_type = null
+        ?string $self_class,
+        $static_class_type,
+        ?string $parent_class
     ) {
         $return_type = clone $return_type;
 
@@ -998,7 +999,8 @@ class ExpressionAnalyzer
                 $codebase,
                 $return_type_part,
                 $self_class,
-                $static_class_type
+                $static_class_type,
+                $parent_class
             );
         }
 
@@ -1025,8 +1027,9 @@ class ExpressionAnalyzer
     private static function fleshOutAtomicType(
         Codebase $codebase,
         Type\Atomic &$return_type,
-        $self_class,
-        $static_class_type = null
+        ?string $self_class,
+        $static_class_type,
+        ?string $parent_class
     ) {
         if ($return_type instanceof TNamedObject
             || $return_type instanceof TTemplateParam
@@ -1039,7 +1042,8 @@ class ExpressionAnalyzer
                         $codebase,
                         $extra_type,
                         $self_class,
-                        $static_class_type
+                        $static_class_type,
+                        $parent_class
                     );
 
                     if ($extra_type instanceof TNamedObject && $extra_type->extra_types) {
@@ -1080,13 +1084,13 @@ class ExpressionAnalyzer
 
                     $return_type->value = $self_class;
                 } elseif ($return_type_lc === 'parent') {
-                    if (!$self_class) {
+                    if (!$parent_class) {
                         throw new \UnexpectedValueException(
-                            'Cannot handle ' . $return_type->value . ' when $self_class is empty'
+                            'Cannot handle ' . $return_type->value . ' when $parent_class is empty'
                         );
                     }
 
-                    $return_type->value = $self_class;
+                    $return_type->value = $parent_class;
                 } else {
                     $return_type->value = $codebase->classlikes->getUnAliasedName($return_type->value);
                 }
@@ -1128,7 +1132,8 @@ class ExpressionAnalyzer
                     $codebase,
                     $type_param,
                     $self_class,
-                    $static_class_type
+                    $static_class_type,
+                    $parent_class
                 );
             }
         } elseif ($return_type instanceof Type\Atomic\ObjectLike) {
@@ -1137,7 +1142,8 @@ class ExpressionAnalyzer
                     $codebase,
                     $property_type,
                     $self_class,
-                    $static_class_type
+                    $static_class_type,
+                    $parent_class
                 );
             }
         }
@@ -1150,7 +1156,8 @@ class ExpressionAnalyzer
                             $codebase,
                             $param->type,
                             $self_class,
-                            $static_class_type
+                            $static_class_type,
+                            $parent_class
                         );
                     }
                 }
@@ -1160,7 +1167,8 @@ class ExpressionAnalyzer
                     $codebase,
                     $return_type->return_type,
                     $self_class,
-                    $static_class_type
+                    $static_class_type,
+                    $parent_class
                 );
             }
         }
@@ -1335,7 +1343,8 @@ class ExpressionAnalyzer
                     $codebase,
                     $var_comment->type,
                     $context->self,
-                    $context->self ? new Type\Atomic\TNamedObject($context->self) : null
+                    $context->self ? new Type\Atomic\TNamedObject($context->self) : null,
+                    $statements_analyzer->getParentFQCLN()
                 );
 
                 if (!$var_comment->var_id) {
diff --git a/src/Psalm/Internal/Analyzer/Statements/ReturnAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/ReturnAnalyzer.php
index a1886f6f6..ae8c04665 100644
--- a/src/Psalm/Internal/Analyzer/Statements/ReturnAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/ReturnAnalyzer.php
@@ -70,7 +70,8 @@ class ReturnAnalyzer
                     $codebase,
                     $var_comment->type,
                     $context->self,
-                    $context->self
+                    $context->self,
+                    $statements_analyzer->getParentFQCLN()
                 );
 
                 if (!$var_comment->var_id) {
@@ -133,7 +134,8 @@ class ReturnAnalyzer
                         $codebase,
                         $stmt->inferredType,
                         $source->getFQCLN(),
-                        $source->getFQCLN()
+                        $source->getFQCLN(),
+                        $source->getParentFQCLN()
                     );
 
                     $local_return_type = $source->getLocalReturnType($storage->return_type);
diff --git a/src/Psalm/Internal/Analyzer/StatementsAnalyzer.php b/src/Psalm/Internal/Analyzer/StatementsAnalyzer.php
index 4626a19e3..ae3af6f25 100644
--- a/src/Psalm/Internal/Analyzer/StatementsAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/StatementsAnalyzer.php
@@ -662,7 +662,9 @@ class StatementsAnalyzer extends SourceAnalyzer implements StatementsSource
                         $comment_type = ExpressionAnalyzer::fleshOutType(
                             $codebase,
                             $var_comment->type,
-                            $context->self
+                            $context->self,
+                            $context->self,
+                            $this->getParentFQCLN()
                         );
 
                         $context->vars_in_scope[$var_comment->var_id] = $comment_type;
@@ -937,7 +939,8 @@ class StatementsAnalyzer extends SourceAnalyzer implements StatementsSource
                             $codebase,
                             $var_comment->type,
                             $context->self,
-                            $context->self
+                            $context->self,
+                            $this->getParentFQCLN()
                         );
 
                         $var_comment_type->setFromDocblock();
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayMapReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayMapReturnTypeProvider.php
index 9fe08f6bf..4f9df150f 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayMapReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayMapReturnTypeProvider.php
@@ -181,7 +181,8 @@ class ArrayMapReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTyp
                                     $codebase,
                                     $return_type,
                                     $self_class,
-                                    $self_class
+                                    $self_class,
+                                    $statements_source->getParentFQCLN()
                                 );
 
                                 if ($mapping_return_type) {
diff --git a/src/Psalm/Internal/Visitor/ReflectorVisitor.php b/src/Psalm/Internal/Visitor/ReflectorVisitor.php
index bde0e9b02..e0c60ceb6 100644
--- a/src/Psalm/Internal/Visitor/ReflectorVisitor.php
+++ b/src/Psalm/Internal/Visitor/ReflectorVisitor.php
@@ -823,6 +823,7 @@ class ReflectorVisitor extends PhpParser\NodeVisitorAbstract implements PhpParse
                     $this->scan_deep
                 );
                 $parent_fqcln_lc = strtolower($parent_fqcln);
+                $storage->parent_class = $parent_fqcln;
                 $storage->parent_classes[$parent_fqcln_lc] = $parent_fqcln;
                 $this->file_storage->required_classes[strtolower($parent_fqcln)] = $parent_fqcln;
             }
diff --git a/src/Psalm/Storage/ClassLikeStorage.php b/src/Psalm/Storage/ClassLikeStorage.php
index 91a9e0336..0f089cfe2 100644
--- a/src/Psalm/Storage/ClassLikeStorage.php
+++ b/src/Psalm/Storage/ClassLikeStorage.php
@@ -145,6 +145,13 @@ class ClassLikeStorage
      */
     public $parent_interfaces = [];
 
+    /**
+     * There can only be one direct parent class
+     *
+     * @var ?string
+     */
+    public $parent_class;
+
     /**
      * Parent classes
      *
diff --git a/src/Psalm/Type/Atomic.php b/src/Psalm/Type/Atomic.php
index 7f8b383df..02f8155dc 100644
--- a/src/Psalm/Type/Atomic.php
+++ b/src/Psalm/Type/Atomic.php
@@ -558,7 +558,8 @@ abstract class Atomic
                         $codebase,
                         $type_param,
                         $source->getFQCLN(),
-                        $source->getFQCLN()
+                        $source->getFQCLN(),
+                        $source->getParentFQCLN()
                     );
 
                     if (!TypeAnalyzer::isContainedBy($codebase, $type_param, $expected_type_param)) {
diff --git a/tests/MethodSignatureTest.php b/tests/MethodSignatureTest.php
index efd4ef101..e7d243c84 100644
--- a/tests/MethodSignatureTest.php
+++ b/tests/MethodSignatureTest.php
@@ -536,6 +536,41 @@ class MethodSignatureTest extends TestCase
                     '$a' => 'string',
                 ]
             ],
+            'parentIsKnown' => [
+                '<?php
+                    class A {
+                        public function returnSelf() : self {
+                            return $this;
+                        }
+                    }
+
+                    class B extends A {
+                        public function returnSelf() : parent {
+                            return parent::returnSelf();
+                        }
+
+                    }',
+            ],
+            'returnStaticParent' => [
+                '<?php
+                    class A {
+                        /**
+                         * @return static
+                         */
+                        public static function foo() {
+                            return new static();
+                        }
+                    }
+
+                    class B extends A {
+                        /**
+                         * @return static
+                         */
+                        public static function foo() {
+                            return parent::foo();
+                        }
+                    }',
+            ],
         ];
     }
 
