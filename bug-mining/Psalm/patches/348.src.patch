diff --git a/src/Psalm/Internal/Analyzer/Statements/Block/IfAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Block/IfAnalyzer.php
index da49a6020..71d59d770 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Block/IfAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Block/IfAnalyzer.php
@@ -110,6 +110,10 @@ class IfAnalyzer
             $codebase
         );
 
+        if (count($if_clauses) > 200) {
+            $if_clauses = [];
+        }
+
         $if_clauses = array_values(
             array_map(
                 /**
diff --git a/tests/AssertTest.php b/tests/AssertTest.php
index 151ee2558..91d4aa14e 100644
--- a/tests/AssertTest.php
+++ b/tests/AssertTest.php
@@ -453,6 +453,33 @@ class AssertTest extends TestCase
                         return $decoded;
                     }'
             ],
+            'avoidOOM' => [
+                '<?php
+                    function gameOver(
+                        int $b0,
+                        int $b1,
+                        int $b2,
+                        int $b3,
+                        int $b4,
+                        int $b5,
+                        int $b6,
+                        int $b7,
+                        int $b8
+                    ): bool {
+                        if (($b0 === 1 && $b4 === 1 && $b8 === 1)
+                            || ($b0 === 1 && $b1 === 1 && $b2 === 1)
+                            || ($b0 === 1 && $b3 === 1 && $b6 === 1)
+                            || ($b1 === 1 && $b4 === 1 && $b7 === 1)
+                            || ($b2 === 1 && $b5 === 1 && $b8 === 1)
+                            || ($b2 === 1 && $b4 === 1 && $b6 === 1)
+                            || ($b3 === 1 && $b4 === 1 && $b5 === 1)
+                            || ($b6 === 1 && $b7 === 1 && $b8 === 1)
+                        ) {
+                            return true;
+                        }
+                        return false;
+                    }'
+            ],
         ];
     }
 }
