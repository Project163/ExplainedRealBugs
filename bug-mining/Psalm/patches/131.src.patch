diff --git a/src/Psalm/Internal/Analyzer/TypeAnalyzer.php b/src/Psalm/Internal/Analyzer/TypeAnalyzer.php
index 4b2820509..54f487e95 100644
--- a/src/Psalm/Internal/Analyzer/TypeAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/TypeAnalyzer.php
@@ -735,7 +735,9 @@ class TypeAnalyzer
                     $to_string_cast,
                     $type_coerced_from_scalar
                 )) {
-                    return true;
+                    if ($allow_interface_equality || !$input_type_part instanceof TNamedObject) {
+                        return true;
+                    }
                 }
             }
 
diff --git a/src/Psalm/Type/Union.php b/src/Psalm/Type/Union.php
index 4116f8f29..b34d07c52 100644
--- a/src/Psalm/Type/Union.php
+++ b/src/Psalm/Type/Union.php
@@ -1009,6 +1009,12 @@ class Union
                                             = clone $key_type;
                                     }
                                 }
+
+                                if ($replacement_atomic_type instanceof Type\Atomic\TTemplateParam) {
+                                    foreach ($replacement_atomic_type->as->getTypes() as $nested_type_atomic) {
+                                        $this->types[$nested_type_atomic->getKey()] = clone $nested_type_atomic;
+                                    }
+                                }
                                 // @codingStandardsIgnoreEnd
 
                                 if (!$replacements_found) {
diff --git a/tests/Template/TemplateExtendsTest.php b/tests/Template/TemplateExtendsTest.php
index c8d1e8e68..54fe98f51 100644
--- a/tests/Template/TemplateExtendsTest.php
+++ b/tests/Template/TemplateExtendsTest.php
@@ -776,6 +776,50 @@ class TemplateExtendsTest extends TestCase
                         }
                     }',
             ],
+            'extendWithExplicitOverriddenTemplatedSignature' => [
+                '<?php
+                    class Obj {}
+
+                    /**
+                     * @template T1
+                     */
+                    class BaseContainer {
+                        /** @var T1 */
+                        private $t1;
+
+                        /** @param T1 $t1 */
+                        public function __construct($t1) {
+                            $this->t1 = $t1;
+                        }
+
+                        /**
+                         * @return T1
+                         */
+                        public function getValue()
+                        {
+                            return $this->t1;
+                        }
+                    }
+
+                    /**
+                     * @template T2 as Obj
+                     * @template-extends BaseContainer<T2>
+                     */
+                    class Container extends BaseContainer {
+                        /** @param T2 $t2 */
+                        public function __construct($t2) {
+                            parent::__construct($t2);
+                        }
+
+                        /**
+                         * @return T2
+                         */
+                        public function getValue()
+                        {
+                            return parent::getValue();
+                        }
+                    }',
+            ],
             'iterateOverExtendedArrayObjectThisClassIterationWithExplicitGetIterator' => [
                 '<?php
                     class O {}
@@ -805,9 +849,7 @@ class TemplateExtendsTest extends TestCase
                         /**
                          * @return \ArrayIterator<int, T>
                          */
-                        public function getIterator()
-                        {
-                            /** @var ArrayIterator<int, O> */
+                        public function getIterator() {
                             return parent::getIterator();
                         }
                     }
@@ -1117,6 +1159,50 @@ class TemplateExtendsTest extends TestCase
                         }
                     }',
             ],
+            'templateExtendsOnceWithSpecificStaticCall' => [
+                '<?php
+                    /** @template T */
+                    class Container {
+                        /** @var T */
+                        private $t;
+
+                        /** @param T $t */
+                        private function __construct($t) {
+                            $this->t = $t;
+                        }
+
+                        /**
+                         * @param T $t
+                         * @return static<T>
+                         */
+                        public static function getContainer($t) {
+                            return new static($t);
+                        }
+
+                        /**
+                         * @return T
+                         */
+                        public function getValue()
+                        {
+                            return $this->t;
+                        }
+                    }
+
+                    /**
+                     * @template T1 as A
+                     * @template-extends Container<T1>
+                     */
+                    class AContainer extends Container {}
+
+                    class A {
+                        function foo() : void {}
+                    }
+
+                    $b = AContainer::getContainer(new A());',
+                [
+                    '$b' => 'AContainer<A>',
+                ],
+            ],
             'templateExtendsDifferentNameWithStaticCall' => [
                 '<?php
                     /** @template T */
diff --git a/tests/Template/TemplateTest.php b/tests/Template/TemplateTest.php
index e03e5f635..1af096968 100644
--- a/tests/Template/TemplateTest.php
+++ b/tests/Template/TemplateTest.php
@@ -1012,7 +1012,6 @@ class TemplateTest extends TestCase
                         /**
                          * @template T as Foo
                          * @param class-string<T> $class
-                         * @template-typeof T $class
                          * @return T|null
                          */
                         public function loader(string $class) {
@@ -3446,6 +3445,17 @@ class TemplateTest extends TestCase
                     }',
                 'error_message' => 'InvalidReturnStatement'
             ],
+            'preventTemplateTypeAsBeingUsedInsideFunction' => [
+                '<?php
+                    /**
+                     * @template T of DateTime
+                     * @param callable(T) $callable
+                     */
+                    function foo(callable $callable) : void {
+                        $callable(new \DateTime());
+                    }',
+                'error_message' => 'InvalidArgument'
+            ],
             'preventWrongTemplateBeingPassed' => [
                 '<?php
                     /**
@@ -3461,6 +3471,19 @@ class TemplateTest extends TestCase
                     }',
                 'error_message' => 'InvalidArgument'
             ],
+            'preventTemplateTypeReturnMoreGeneral' => [
+                '<?php
+                    /**
+                     * @template T of DateTimeInterface
+                     * @param T $x
+                     * @return T
+                     */
+                    function foo($x)
+                    {
+                        return new \DateTime();
+                    }',
+                'error_message' => 'InvalidReturnStatement'
+            ],
         ];
     }
 }
