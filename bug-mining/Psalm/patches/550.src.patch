diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/Fetch/PropertyFetchAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/Fetch/PropertyFetchAnalyzer.php
index 0f0c35d78..a7d23235f 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/Fetch/PropertyFetchAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/Fetch/PropertyFetchAnalyzer.php
@@ -827,32 +827,21 @@ class PropertyFetchAnalyzer
 
                         foreach ($reversed_class_template_types as $i => $type_name) {
                             if (isset($lhs_type_part->type_params[$provided_type_param_count - 1 - $i])) {
-                                $class_template_params[$type_name] =
-                                    (string)$lhs_type_part->type_params[$provided_type_param_count - 1 - $i];
+                                $class_template_params[$type_name][$declaring_class_storage->name] = [
+                                    $lhs_type_part->type_params[$provided_type_param_count - 1 - $i],
+                                    0
+                                ];
                             } else {
-                                $class_template_params[$type_name] = 'mixed';
+                                $class_template_params[$type_name][$declaring_class_storage->name] = [
+                                    Type::getMixed(),
+                                    0
+                                ];
                             }
                         }
 
-                        $type_tokens = Type::tokenize((string)$class_property_type);
-
-                        $new_type_tokens = [];
-
-                        foreach ($type_tokens as $type_token_map) {
-                            if (isset($class_template_params[$type_token_map[0]])) {
-                                $tokened = Type::tokenize($class_template_params[$type_token_map[0]]);
-                                foreach ($tokened as $new_t) {
-                                    $new_type_tokens[] = [$new_t[0], $type_token_map[1]];
-                                }
-                            } else {
-                                $new_type_tokens[] = $type_token_map;
-                            }
-                        }
-
-                        $class_property_type = Type::parseTokens(
-                            $new_type_tokens,
-                            null,
-                            $statements_analyzer->getTemplateTypeMap() ?: []
+                        $class_property_type->replaceTemplateTypesWithArgTypes(
+                            $class_template_params,
+                            $codebase
                         );
                     }
                 }
diff --git a/tests/Template/ClassTemplateTest.php b/tests/Template/ClassTemplateTest.php
index 5a127680e..f948b329a 100644
--- a/tests/Template/ClassTemplateTest.php
+++ b/tests/Template/ClassTemplateTest.php
@@ -2471,7 +2471,7 @@ class ClassTemplateTest extends TestCase
                     '$packages' => 'Collection<A>'
                 ]
             ],
-            'assertOnTemplatedProperty' => [
+            'assertSameOnTemplatedProperty' => [
                 '<?php
                     /** @template E as object */
                     final class Box
@@ -2496,6 +2496,23 @@ class ClassTemplateTest extends TestCase
                         }
                     }'
             ],
+            'assertNotNullOnTemplatedProperty' => [
+                '<?php
+                    /**
+                     * @template T of object
+                     */
+                    final class A {
+                        /**
+                         * @psalm-var ?callable(T): bool
+                         */
+                        public $filter;
+                    }
+
+                    /** @psalm-var A<A> */
+                    $a = new A();
+
+                    if (null !== $a->filter) {}'
+            ],
         ];
     }
 
