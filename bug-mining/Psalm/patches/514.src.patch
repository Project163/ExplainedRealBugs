diff --git a/src/Psalm/Internal/FileManipulation/FunctionDocblockManipulator.php b/src/Psalm/Internal/FileManipulation/FunctionDocblockManipulator.php
index 19b566d47..579133b53 100644
--- a/src/Psalm/Internal/FileManipulation/FunctionDocblockManipulator.php
+++ b/src/Psalm/Internal/FileManipulation/FunctionDocblockManipulator.php
@@ -131,7 +131,7 @@ class FunctionDocblockManipulator
             if ($param->var instanceof PhpParser\Node\Expr\Variable
                 && \is_string($param->var->name)
             ) {
-                $this->param_offsets[$param->var->name] = (int) $param->var->getAttribute('startFilePos');
+                $this->param_offsets[$param->var->name] = (int) $param->getAttribute('startFilePos');
 
                 if ($param->type) {
                     $this->param_typehint_offsets[$param->var->name] = [
diff --git a/tests/FileManipulation/ParamTypeManipulationTest.php b/tests/FileManipulation/ParamTypeManipulationTest.php
index 111bf71f2..f727f8d84 100644
--- a/tests/FileManipulation/ParamTypeManipulationTest.php
+++ b/tests/FileManipulation/ParamTypeManipulationTest.php
@@ -211,6 +211,29 @@ class ParamTypeManipulationTest extends FileManipulationTest
                 ['MissingParamType'],
                 true,
             ],
+            'addMissingByRefParamType' => [
+                '<?php
+                    class C {
+                        public function foo(&$bar) : void {
+                            $bar .= " me";
+                        }
+                    }
+
+                    $a = "hello";
+                    (new C)->foo($a);',
+                '<?php
+                    class C {
+                        public function foo(string &$bar) : void {
+                            $bar .= " me";
+                        }
+                    }
+
+                    $a = "hello";
+                    (new C)->foo($a);',
+                '7.1',
+                ['MissingParamType'],
+                true,
+            ],
         ];
     }
 }
