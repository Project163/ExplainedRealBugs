diff --git a/src/Psalm/Internal/Codebase/Scanner.php b/src/Psalm/Internal/Codebase/Scanner.php
index ba1ee0cf1..406818fb9 100644
--- a/src/Psalm/Internal/Codebase/Scanner.php
+++ b/src/Psalm/Internal/Codebase/Scanner.php
@@ -632,9 +632,7 @@ class Scanner
 
             if ($this->codebase->register_autoload_files) {
                 foreach ($file_storage->functions as $function_storage) {
-                    if ($this->codebase->register_stub_files
-                        || $this->codebase->functions->hasStubbedFunction($function_storage->cased_name)
-                    ) {
+                    if (!$this->codebase->functions->hasStubbedFunction($function_storage->cased_name)) {
                         $this->codebase->functions->addGlobalFunction($function_storage->cased_name, $function_storage);
                     }
                 }
