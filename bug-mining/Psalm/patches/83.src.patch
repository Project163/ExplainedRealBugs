diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/CallAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/CallAnalyzer.php
index 3e5cf2f36..c7ab8e208 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/CallAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/CallAnalyzer.php
@@ -2347,6 +2347,7 @@ class CallAnalyzer
             && !$input_type->hasArray()
             && !$param_type->from_docblock
             && $cased_method_id !== 'echo'
+            && $cased_method_id !== 'sprintf'
         ) {
             $scalar_type_match_found = false;
 
diff --git a/src/Psalm/Internal/Analyzer/TypeAnalyzer.php b/src/Psalm/Internal/Analyzer/TypeAnalyzer.php
index 03421738d..ea886ea6c 100644
--- a/src/Psalm/Internal/Analyzer/TypeAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/TypeAnalyzer.php
@@ -97,6 +97,12 @@ class TypeAnalyzer
             $scalar_type_match_found = false;
             $all_to_string_cast = true;
 
+            $all_type_coerced = null;
+            $all_type_coerced_from_mixed = null;
+
+            $some_type_coerced = false;
+            $some_type_coerced_from_mixed = false;
+
             if ($input_type_part instanceof TArrayKey
                 && ($container_type->hasInt() && $container_type->hasString())
             ) {
@@ -119,6 +125,8 @@ class TypeAnalyzer
                 }
 
                 $atomic_to_string_cast = false;
+                $atomic_type_coerced = false;
+                $atomic_type_coerced_from_mixed = false;
 
                 $is_atomic_contained_by = self::isAtomicContainedBy(
                     $codebase,
@@ -127,8 +135,8 @@ class TypeAnalyzer
                     $allow_interface_equality,
                     true,
                     $scalar_type_match_found,
-                    $type_coerced,
-                    $type_coerced_from_mixed,
+                    $atomic_type_coerced,
+                    $atomic_type_coerced_from_mixed,
                     $atomic_to_string_cast,
                     $type_coerced_from_scalar
                 );
@@ -142,12 +150,35 @@ class TypeAnalyzer
                     $is_atomic_contained_by = true;
                 }
 
+                if ($atomic_type_coerced) {
+                    $some_type_coerced = true;
+                }
+
+                if ($atomic_type_coerced_from_mixed) {
+                    $some_type_coerced_from_mixed = true;
+                }
+
+                if ($atomic_type_coerced !== true || $all_type_coerced === false) {
+                    $all_type_coerced = false;
+                } else {
+                    $all_type_coerced = true;
+                }
+
+                if ($atomic_type_coerced_from_mixed !== true || $all_type_coerced_from_mixed === false) {
+                    $all_type_coerced_from_mixed = false;
+                } else {
+                    $all_type_coerced_from_mixed = true;
+                }
+
                 if ($is_atomic_contained_by) {
                     $type_match_found = true;
-                }
 
-                if ($atomic_to_string_cast !== true && $type_match_found) {
-                    $all_to_string_cast = false;
+                    if ($atomic_to_string_cast !== true) {
+                        $all_to_string_cast = false;
+                    }
+
+                    $all_type_coerced_from_mixed = false;
+                    $all_type_coerced = false;
                 }
             }
 
@@ -158,7 +189,23 @@ class TypeAnalyzer
                 $to_string_cast = true;
             }
 
+            if ($all_type_coerced) {
+                $type_coerced = true;
+            }
+
+            if ($all_type_coerced_from_mixed) {
+                $type_coerced_from_mixed = true;
+            }
+
             if (!$type_match_found) {
+                if ($some_type_coerced) {
+                    $type_coerced = true;
+                }
+
+                if ($some_type_coerced_from_mixed) {
+                    $type_coerced_from_mixed = true;
+                }
+
                 if (!$scalar_type_match_found) {
                     $has_scalar_match = false;
                 }
diff --git a/tests/InterfaceTest.php b/tests/InterfaceTest.php
index 1b9db6fba..6b77704f4 100644
--- a/tests/InterfaceTest.php
+++ b/tests/InterfaceTest.php
@@ -604,6 +604,20 @@ class InterfaceTest extends TestCase
                         return $i->foo();
                     }',
             ],
+            'noTypeCoercionWhenIntersectionMatches' => [
+                '<?php
+                    interface I1 {}
+                    interface I2 {}
+                    class A implements I1 {}
+
+                    /** @param A|I2 $i */
+                    function foo($i) : void {}
+
+                    /** @param I1&I2 $i */
+                    function bar($i) : void {
+                        foo($i);
+                    }'
+            ],
         ];
     }
 
diff --git a/tests/Loop/ForeachTest.php b/tests/Loop/ForeachTest.php
index 8a6dfac77..3ae0a4561 100644
--- a/tests/Loop/ForeachTest.php
+++ b/tests/Loop/ForeachTest.php
@@ -683,7 +683,7 @@ class ForeachTest extends \Psalm\Tests\TestCase
                     'MixedAssignment', 'UndefinedThisPropertyAssignment',
                 ],
             ],
-            'SKIPPED-intersectionIterator' => [
+            'intersectionIterator' => [
                 '<?php
                     /**
                      * @param \Traversable<int, int>&\Countable $object
diff --git a/tests/ToStringTest.php b/tests/ToStringTest.php
index 4b99de1e7..22581a72a 100644
--- a/tests/ToStringTest.php
+++ b/tests/ToStringTest.php
@@ -138,6 +138,19 @@ class ToStringTest extends TestCase
                     fooFoo(new A());',
                 'error_message' => 'InvalidArgument',
             ],
+            'implicitCastWithStrictTypesToEchoOrSprintf' => [
+                '<?php declare(strict_types=1);
+                    class A {
+                        public function __toString(): string
+                        {
+                            return "hello";
+                        }
+                    }
+
+                    echo(new A());
+                    sprintf("hello *", new A());',
+                'error_message' => 'ImplicitToStringCast',
+            ],
             'implicitCast' => [
                 '<?php
                     class A {
@@ -151,6 +164,20 @@ class ToStringTest extends TestCase
                     fooFoo(new A());',
                 'error_message' => 'ImplicitToStringCast',
             ],
+            'implicitCastToUnion' => [
+                '<?php
+                    class A {
+                        public function __toString(): string
+                        {
+                            return "hello";
+                        }
+                    }
+
+                    /** @param string|int $b */
+                    function fooFoo($b): void {}
+                    fooFoo(new A());',
+                'error_message' => 'ImplicitToStringCast',
+            ],
             'implicitCastFromInterface' => [
                 '<?php
                     interface I {
diff --git a/tests/fixtures/DummyProject/psalm.xml b/tests/fixtures/DummyProject/psalm.xml
new file mode 100644
index 000000000..ba8191451
--- /dev/null
+++ b/tests/fixtures/DummyProject/psalm.xml
@@ -0,0 +1,12 @@
+<?xml version="1.0"?>
+<psalm
+    totallyTyped="true"
+    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+    xmlns="https://getpsalm.org/schema/config"
+    xsi:schemaLocation="https://getpsalm.org/schema/config vendor/vimeo/psalm/config.xsd"
+>
+    <projectFiles>
+        <file name="Bar.php" />
+        <file name="Bat.php" />
+    </projectFiles>
+</psalm>
