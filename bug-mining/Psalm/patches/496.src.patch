diff --git a/src/Psalm/Internal/Type/UnionTemplateHandler.php b/src/Psalm/Internal/Type/UnionTemplateHandler.php
index 9f53e7416..6f595001c 100644
--- a/src/Psalm/Internal/Type/UnionTemplateHandler.php
+++ b/src/Psalm/Internal/Type/UnionTemplateHandler.php
@@ -607,4 +607,40 @@ class UnionTemplateHandler
 
         return $atomic_types;
     }
+
+    /**
+     * @param  array<string, array<string, array{Union, 1?:int}>>  $template_types
+     *
+     * @return array{Union, 1?:int}|null
+     */
+    public static function getRootTemplateType(
+        array $template_types,
+        string $param_name,
+        string $defining_class,
+        array $visited_classes = []
+    ) : ?array {
+        if (isset($template_types[$param_name][$defining_class])) {
+            $mapped_type = $template_types[$param_name][$defining_class][0];
+
+            $mapped_type_atomic_types = array_values($mapped_type->getAtomicTypes());
+
+            if (count($mapped_type_atomic_types) > 1
+                || !$mapped_type_atomic_types[0] instanceof Atomic\TTemplateParam
+                || isset($visited_classes[$defining_class])
+            ) {
+                return $template_types[$param_name][$defining_class];
+            }
+
+            $first_template = $mapped_type_atomic_types[0];
+
+            return self::getRootTemplateType(
+                $template_types,
+                $first_template->param_name,
+                $first_template->defining_class,
+                $visited_classes + [$defining_class => true]
+            ) ?? $template_types[$param_name][$defining_class];
+        }
+
+        return null;
+    }
 }
diff --git a/src/Psalm/Type/Union.php b/src/Psalm/Type/Union.php
index 3f6302f96..ec70b129f 100644
--- a/src/Psalm/Type/Union.php
+++ b/src/Psalm/Type/Union.php
@@ -1113,8 +1113,14 @@ class Union
             if ($atomic_type instanceof Type\Atomic\TTemplateParam) {
                 $template_type = null;
 
-                if (isset($template_types[$atomic_type->param_name][$atomic_type->defining_class])) {
-                    $template_type = $template_types[$atomic_type->param_name][$atomic_type->defining_class][0];
+                $traversed_type = \Psalm\Internal\Type\UnionTemplateHandler::getRootTemplateType(
+                    $template_types,
+                    $atomic_type->param_name,
+                    $atomic_type->defining_class
+                );
+
+                if ($traversed_type) {
+                    $template_type = $traversed_type[0];
 
                     if (!$atomic_type->as->isMixed() && $template_type->isMixed()) {
                         $template_type = clone $atomic_type->as;
diff --git a/tests/Template/ClassTemplateExtendsTest.php b/tests/Template/ClassTemplateExtendsTest.php
index b33c34add..a98f4e7f1 100644
--- a/tests/Template/ClassTemplateExtendsTest.php
+++ b/tests/Template/ClassTemplateExtendsTest.php
@@ -2957,6 +2957,45 @@ class ClassTemplateExtendsTest extends TestCase
                         }
                     }'
             ],
+            'extendsInheritingReturnType' => [
+                '<?php
+                    /**
+                     * @template T1
+                     */
+                    class Container {
+                        /**
+                         * @return T1
+                         * @psalm-suppress InvalidReturnStatement
+                         * @psalm-suppress InvalidReturnType
+                         */
+                        public function get(int $key) { return new stdClass(); }
+                    }
+
+                    /**
+                     * @template T2
+                     * @inherits Container<T2>
+                     */
+                    class ContainerSubclass extends Container {
+                        /**
+                         * @psalm-suppress InvalidReturnType
+                         */
+                        public function get(int $key) {}
+                    }
+
+                    class MyTestContainerUsage {
+                        /** @var ContainerSubclass<stdClass> */
+                        private $container;
+
+                        /** @param ContainerSubclass<stdClass> $container */
+                        public function __construct(ContainerSubclass $container) {
+                            $this->container = $container;
+                        }
+
+                        public function modify() : void {
+                            $this->container->get(1)->foo = 2;
+                        }
+                    }'
+            ],
         ];
     }
 
