diff --git a/src/Psalm/Config.php b/src/Psalm/Config.php
index 44772cfff..d68096899 100644
--- a/src/Psalm/Config.php
+++ b/src/Psalm/Config.php
@@ -1674,7 +1674,14 @@ class Config
             throw new \UnexpectedValueException('Cannot locate core generic classes');
         }
 
-        $core_generic_files = [$generic_stubs_path, $generic_classes_path];
+        // note: don't realpath $generic_classes_path, or phar version will fail
+        $immutable_classes_path = __DIR__ . '/Internal/Stubs/CoreImmutableClasses.phpstub';
+
+        if (!file_exists($immutable_classes_path)) {
+            throw new \UnexpectedValueException('Cannot locate core immutable classes');
+        }
+
+        $core_generic_files = [$generic_stubs_path, $generic_classes_path, $immutable_classes_path];
 
         if (\extension_loaded('ds')) {
             $ext_ds_path = __DIR__ . '/Internal/Stubs/ext-ds.php';
diff --git a/src/Psalm/Internal/Analyzer/MethodAnalyzer.php b/src/Psalm/Internal/Analyzer/MethodAnalyzer.php
index c842b1f8d..a28ea4d21 100644
--- a/src/Psalm/Internal/Analyzer/MethodAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/MethodAnalyzer.php
@@ -678,6 +678,7 @@ class MethodAnalyzer extends FunctionLikeAnalyzer
         if ($guide_method_storage->external_mutation_free
             && !$implementer_method_storage->external_mutation_free
             && !$guide_method_storage->mutation_free_inferred
+            && $prevent_method_signature_mismatch
         ) {
             if (IssueBuffer::accepts(
                 new MissingImmutableAnnotation(
diff --git a/src/Psalm/Internal/Stubs/CoreGenericClasses.phpstub b/src/Psalm/Internal/Stubs/CoreGenericClasses.phpstub
index 3484b4972..73a6052a2 100644
--- a/src/Psalm/Internal/Stubs/CoreGenericClasses.phpstub
+++ b/src/Psalm/Internal/Stubs/CoreGenericClasses.phpstub
@@ -1486,19 +1486,3 @@ final class WeakReference
     /** @return ?T */
     public function get(): ?object;
 }
-
-/**
- * @psalm-immutable
- */
-class DateTimeImmutable implements DateTimeInterface
-{
-    public function __construct(string $time = "now", DateTimeZone $tz = null) {}
-}
-
-/**
- * @psalm-immutable
- */
-class DateTimeZone
-{
-    public function __construct(string $tz) {}
-}
diff --git a/src/Psalm/Internal/Stubs/CoreImmutableClasses.phpstub b/src/Psalm/Internal/Stubs/CoreImmutableClasses.phpstub
new file mode 100644
index 000000000..800685155
--- /dev/null
+++ b/src/Psalm/Internal/Stubs/CoreImmutableClasses.phpstub
@@ -0,0 +1,59 @@
+<?php
+
+/**
+ * @psalm-immutable
+ */
+class DateTimeImmutable implements DateTimeInterface
+{
+    public function __construct(string $time = "now", DateTimeZone $tz = null) {}
+}
+
+/**
+ * @psalm-immutable
+ */
+class DateTimeZone
+{
+    public function __construct(string $tz) {}
+}
+
+interface Throwable
+{
+    /**
+     * @psalm-mutation-free
+     */
+    public final function getMessage() : string {}
+}
+
+class Exception implements Throwable
+{
+    /**
+     * @psalm-external-mutation-free
+     * @param string $message
+     * @param int $code
+     * @param Throwable $previous
+     */
+    public function __construct($message = "", $code = 0, Throwable $previous = null) { }
+
+    /**
+     * @psalm-mutation-free
+     */
+    public final function getMessage() : string {}
+
+    /**
+     * @psalm-mutation-free
+     * @return int|string
+     */
+    public final function getCode(){}
+
+    /**
+     * @psalm-mutation-free
+     * @return string
+     */
+    public final function getFile(){}
+
+    /**
+     * @psalm-mutation-free
+     * @return int
+     */
+    public final function getLine(){}
+}
diff --git a/tests/PureAnnotationTest.php b/tests/PureAnnotationTest.php
index 7f60bf113..9c9d57887 100644
--- a/tests/PureAnnotationTest.php
+++ b/tests/PureAnnotationTest.php
@@ -199,6 +199,17 @@ class PureAnnotationTest extends TestCase
                         return $s;
                     }',
             ],
+            'exceptionGetMessage' => [
+                '<?php
+                    /**
+                     * @psalm-pure
+                     */
+                    function getMessage(Throwable $e): string {
+                        return $e->getMessage();
+                    }
+
+                    echo getMessage(new Exception("test"));'
+            ],
         ];
     }
 
