diff --git a/src/Psalm/Internal/Analyzer/MethodComparator.php b/src/Psalm/Internal/Analyzer/MethodComparator.php
index c38cb1df3..fde424d82 100644
--- a/src/Psalm/Internal/Analyzer/MethodComparator.php
+++ b/src/Psalm/Internal/Analyzer/MethodComparator.php
@@ -398,17 +398,16 @@ class MethodComparator
                 && $implementer_param->location
                 && $guide_method_storage->cased_name
                 && substr($guide_method_storage->cased_name, 0, 2) !== '__'
+                && $config->isInProjectDirs(
+                    $implementer_param->location->file_path
+                )
             ) {
                 if ($config->allow_named_arg_calls
                     || ($guide_classlike_storage->location
                         && !$config->isInProjectDirs($guide_classlike_storage->location->file_path)
                     )
                 ) {
-                    if ($codebase->alter_code
-                        && $config->isInProjectDirs(
-                            $implementer_param->location->file_path
-                        )
-                    ) {
+                    if ($codebase->alter_code) {
                         $project_analyzer = \Psalm\Internal\Analyzer\ProjectAnalyzer::getInstance();
 
                         if ($stmt && isset($project_analyzer->getIssuesToFix()['ParamNameMismatch'])) {
@@ -435,11 +434,7 @@ class MethodComparator
                                     . $implementer_param->name . ', expecting $'
                                     . $guide_param->name . ' as defined by '
                                     . $cased_guide_method_id,
-                                $config->isInProjectDirs(
-                                    $implementer_param->location->file_path
-                                )
-                                ? $implementer_param->location
-                                : $code_location
+                                $implementer_param->location
                             )
                         )) {
                             // fall through
diff --git a/tests/Traits/InvalidCodeAnalysisTestTrait.php b/tests/Traits/InvalidCodeAnalysisTestTrait.php
index 229caa147..8ec9b421a 100644
--- a/tests/Traits/InvalidCodeAnalysisTestTrait.php
+++ b/tests/Traits/InvalidCodeAnalysisTestTrait.php
@@ -67,6 +67,8 @@ trait InvalidCodeAnalysisTestTrait
 
         $this->project_analyzer->setPhpVersion($php_version);
 
+        $file_path = self::$src_dir_path . 'somefile.php';
+
         $error_message = preg_replace('/ src[\/\\\\]somefile\.php/', ' src/somefile.php', $error_message);
 
         $this->expectException(\Psalm\Exception\CodeException::class);
@@ -77,8 +79,6 @@ trait InvalidCodeAnalysisTestTrait
             $this->expectExceptionMessageRegExp('/\b' . preg_quote($error_message, '/') . '\b/');
         }
 
-        $file_path = 'src/somefile.php';
-
         $this->addFile($file_path, $code);
         $this->analyzeFile($file_path, new Context());
     }
