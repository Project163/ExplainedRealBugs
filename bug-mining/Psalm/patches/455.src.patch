diff --git a/src/Psalm/Internal/Analyzer/FunctionLikeAnalyzer.php b/src/Psalm/Internal/Analyzer/FunctionLikeAnalyzer.php
index ec27d435d..c0e4e9e5c 100644
--- a/src/Psalm/Internal/Analyzer/FunctionLikeAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/FunctionLikeAnalyzer.php
@@ -981,6 +981,10 @@ abstract class FunctionLikeAnalyzer extends SourceAnalyzer
                 ];
             }
 
+            if ($function_param->by_ref) {
+                $context->vars_in_scope['$' . $function_param->name]->by_ref = true;
+            }
+
             $parser_param = $this->function->getParams()[$offset];
 
             if (!$function_param->type_location || !$function_param->location) {
diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php
index 81377371f..18f649109 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php
@@ -15,6 +15,7 @@ use Psalm\Exception\DocblockParseException;
 use Psalm\Exception\IncorrectDocblockException;
 use Psalm\Internal\FileManipulation\FileManipulationBuffer;
 use Psalm\Issue\AssignmentToVoid;
+use Psalm\Issue\ImpureByReferenceAssignment;
 use Psalm\Issue\ImpurePropertyAssignment;
 use Psalm\Issue\InvalidArrayOffset;
 use Psalm\Issue\InvalidDocblock;
@@ -280,6 +281,17 @@ class AssignmentAnalyzer
 
         if ($array_var_id && isset($context->vars_in_scope[$array_var_id])) {
             if ($context->vars_in_scope[$array_var_id]->by_ref) {
+                if ($context->mutation_free) {
+                    if (IssueBuffer::accepts(
+                        new ImpureByReferenceAssignment(
+                            'Variable ' . $array_var_id . ' cannot be assigned to as it is passed by reference',
+                            new CodeLocation($statements_analyzer->getSource(), $assign_var)
+                        )
+                    )) {
+                        // fall through
+                    }
+                }
+
                 $assign_value_type->by_ref = true;
             }
 
diff --git a/src/Psalm/Issue/ImpureByReferenceAssignment.php b/src/Psalm/Issue/ImpureByReferenceAssignment.php
new file mode 100644
index 000000000..71fff9756
--- /dev/null
+++ b/src/Psalm/Issue/ImpureByReferenceAssignment.php
@@ -0,0 +1,6 @@
+<?php
+namespace Psalm\Issue;
+
+class ImpureByReferenceAssignment extends CodeIssue
+{
+}
diff --git a/tests/PureAnnotationTest.php b/tests/PureAnnotationTest.php
index 9b82879a0..5e3518e23 100644
--- a/tests/PureAnnotationTest.php
+++ b/tests/PureAnnotationTest.php
@@ -342,6 +342,17 @@ class PureAnnotationTest extends TestCase
                     }',
                 'error_message' => 'ImpureFunctionCall',
             ],
+            'impureByRef' => [
+                '<?php
+                    /**
+                     * @psalm-pure
+                     */
+                    function foo(string &$a): string {
+                        $a = "B";
+                        return $a;
+                    }',
+                'error_message' => 'ImpureByReferenceAssignment'
+            ],
         ];
     }
 }
