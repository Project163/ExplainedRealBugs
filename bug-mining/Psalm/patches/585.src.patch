diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayFilterReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayFilterReturnTypeProvider.php
index a5867471c..4c471c722 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayFilterReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayFilterReturnTypeProvider.php
@@ -203,7 +203,7 @@ class ArrayFilterReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturn
                                 $changed_var_ids,
                                 ['$inner_type' => true],
                                 $statements_source,
-                                [],
+                                $statements_source->getTemplateTypeMap(),
                                 false,
                                 new CodeLocation($statements_source, $stmt)
                             );
diff --git a/tests/Template/FunctionClassStringTemplateTest.php b/tests/Template/FunctionClassStringTemplateTest.php
index 6d9502fd3..3ca1fddf6 100644
--- a/tests/Template/FunctionClassStringTemplateTest.php
+++ b/tests/Template/FunctionClassStringTemplateTest.php
@@ -649,6 +649,26 @@ class FunctionClassStringTemplateTest extends TestCase
                         if ($e !== $expected) {}
                     }',
             ],
+            'refineByArrayFilterIntersection' => [
+                '<?php
+                    /**
+                     * @template T
+                     * @param array<Bar> $bars
+                     * @psalm-param class-string<T> $class
+                     * @return array<T&Bar>
+                     */
+                    function getBarsThatAreInstancesOf(array $bars, string $class): array
+                    {
+                        return \array_filter(
+                            $bars,
+                            function (Bar $bar) use ($class): bool {
+                                return $bar instanceof $class;
+                            }
+                        );
+                    }
+
+                    interface Bar {}'
+            ],
         ];
     }
 
