diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php
index 4dc51aaa5..1af668253 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/AssignmentAnalyzer.php
@@ -333,7 +333,9 @@ class AssignmentAnalyzer
             return false;
         }
 
-        if (isset($context->protected_var_ids[$var_id])) {
+        if (isset($context->protected_var_ids[$var_id])
+            && $assign_value_type->hasLiteralInt()
+        ) {
             if (IssueBuffer::accepts(
                 new LoopInvalidation(
                     'Variable ' . $var_id . ' has already been assigned in a for/foreach loop',
diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/BinaryOp/NonDivArithmeticOpAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/BinaryOp/NonDivArithmeticOpAnalyzer.php
index 66ed5ef59..990a36381 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/BinaryOp/NonDivArithmeticOpAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/BinaryOp/NonDivArithmeticOpAnalyzer.php
@@ -56,6 +56,12 @@ class NonDivArithmeticOpAnalyzer
         $right_type = $nodes->getType($right);
         $config = Config::getInstance();
 
+        if ($left_type && $left_type->isEmpty()) {
+            $left_type = $right_type;
+        } elseif ($right_type && $right_type->isEmpty()) {
+            $right_type = $left_type;
+        }
+
         if ($left_type && $right_type) {
             if ($left_type->isNull()) {
                 if ($statements_source && IssueBuffer::accepts(
diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/IncDecExpressionAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/IncDecExpressionAnalyzer.php
index 894a4de57..18e810290 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/IncDecExpressionAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/IncDecExpressionAnalyzer.php
@@ -36,7 +36,15 @@ class IncDecExpressionAnalyzer
             $context->inside_assignment = false;
         }
 
-        if ($stmt_var_type = $statements_analyzer->node_data->getType($stmt->var)) {
+        $stmt_var_type = $statements_analyzer->node_data->getType($stmt->var);
+
+        if ($stmt instanceof PostInc || $stmt instanceof PostDec) {
+            $statements_analyzer->node_data->setType($stmt, $stmt_var_type ?: Type::getMixed());
+        }
+
+        if (($stmt_var_type = $statements_analyzer->node_data->getType($stmt->var))
+            && $stmt_var_type->hasString()
+        ) {
             $return_type = null;
 
             $fake_right_expr = new PhpParser\Node\Scalar\LNumber(1, $stmt->getAttributes());
@@ -55,30 +63,9 @@ class IncDecExpressionAnalyzer
             $stmt_type = clone $stmt_var_type;
 
             $statements_analyzer->node_data->setType($stmt, $stmt_type);
-            $stmt_type->from_calculation = true;
-
-            foreach ($stmt_type->getAtomicTypes() as $atomic_type) {
-                if ($atomic_type instanceof Type\Atomic\TLiteralInt) {
-                    $stmt_type->addType(new Type\Atomic\TInt);
-                } elseif ($atomic_type instanceof Type\Atomic\TLiteralFloat) {
-                    $stmt_type->addType(new Type\Atomic\TFloat);
-                }
-            }
 
             $var_id = ExpressionIdentifier::getArrayVarId($stmt->var, null);
 
-            if ($var_id && $context->mutation_free && strpos($var_id, '->')) {
-                if (IssueBuffer::accepts(
-                    new ImpurePropertyAssignment(
-                        'Cannot assign to a property from a mutation-free context',
-                        new CodeLocation($statements_analyzer, $stmt->var)
-                    ),
-                    $statements_analyzer->getSuppressedIssues()
-                )) {
-                    // fall through
-                }
-            }
-
             $codebase = $statements_analyzer->getCodebase();
 
             if ($var_id && isset($context->vars_in_scope[$var_id])) {
@@ -108,7 +95,40 @@ class IncDecExpressionAnalyzer
                 );
             }
         } else {
-            $statements_analyzer->node_data->setType($stmt, Type::getMixed());
+            $fake_right_expr = new PhpParser\Node\Scalar\LNumber(1, $stmt->getAttributes());
+
+            $operation = $stmt instanceof PostInc || $stmt instanceof PreInc
+                ? new PhpParser\Node\Expr\BinaryOp\Plus(
+                    $stmt->var,
+                    $fake_right_expr
+                )
+                : new PhpParser\Node\Expr\BinaryOp\Minus(
+                    $stmt->var,
+                    $fake_right_expr
+                );
+
+            $fake_assignment = new PhpParser\Node\Expr\Assign(
+                $stmt->var,
+                $operation,
+                $stmt->getAttributes()
+            );
+
+            $old_node_data = $statements_analyzer->node_data;
+
+            $statements_analyzer->node_data = clone $statements_analyzer->node_data;
+
+            if (ExpressionAnalyzer::analyze($statements_analyzer, $fake_assignment, $context) === false) {
+                return false;
+            }
+
+            if ($stmt instanceof PreInc || $stmt instanceof PreDec) {
+                $old_node_data->setType(
+                    $stmt,
+                    $statements_analyzer->node_data->getType($operation) ?: Type::getMixed()
+                );
+            }
+
+            $statements_analyzer->node_data = $old_node_data;
         }
 
         return true;
diff --git a/src/Psalm/Internal/Diff/FileDiffer.php b/src/Psalm/Internal/Diff/FileDiffer.php
index 1ae7e75fb..9236e76dd 100644
--- a/src/Psalm/Internal/Diff/FileDiffer.php
+++ b/src/Psalm/Internal/Diff/FileDiffer.php
@@ -298,7 +298,6 @@ class FileDiffer
                 }
             }
 
-            /** @psalm-suppress LoopInvalidation */
             $i = $k - 1;
         }
 
diff --git a/tests/Loop/WhileTest.php b/tests/Loop/WhileTest.php
index 15783f294..841bf605e 100644
--- a/tests/Loop/WhileTest.php
+++ b/tests/Loop/WhileTest.php
@@ -231,7 +231,19 @@ class WhileTest extends \Psalm\Tests\TestCase
                         }
                     }',
             ],
-            'additionSubtractionOps' => [
+            'additionSubtractionAssignment' => [
+                '<?php
+                    $a = 0;
+
+                    while (rand(0, 1)) {
+                        if (rand(0, 1)) {
+                            $a = $a + 1;
+                        } elseif ($a) {
+                            $a = $a - 1;
+                        }
+                    }'
+            ],
+            'additionSubtractionInc' => [
                 '<?php
                     $a = 0;
 
diff --git a/tests/TypeReconciliation/ValueTest.php b/tests/TypeReconciliation/ValueTest.php
index 451b5c33f..41d442f03 100644
--- a/tests/TypeReconciliation/ValueTest.php
+++ b/tests/TypeReconciliation/ValueTest.php
@@ -724,6 +724,14 @@ class ValueTest extends TestCase
                     $f = rand(0, 1) ? -1 : 1;
                     if ($f > 0) {}'
             ],
+            'assignOpThenCheck' => [
+                '<?php
+                    $data = ["e" => 0];
+                    if (rand(0, 1)) {
+                        $data["e"]++;
+                    }
+                    if ($data["e"] > 0) {}'
+            ],
         ];
     }
 
