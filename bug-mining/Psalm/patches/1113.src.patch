diff --git a/config.xsd b/config.xsd
index ffd2f0178..88c3d3d12 100644
--- a/config.xsd
+++ b/config.xsd
@@ -435,6 +435,7 @@
             <xs:element name="UnrecognizedStatement" type="IssueHandlerType" minOccurs="0" />
             <xs:element name="UnresolvableInclude" type="IssueHandlerType" minOccurs="0" />
             <xs:element name="UnsafeInstantiation" type="IssueHandlerType" minOccurs="0" />
+            <xs:element name="UnsafeGenericInstantiation" type="IssueHandlerType" minOccurs="0" />
             <xs:element name="UnusedClass" type="ClassIssueHandlerType" minOccurs="0" />
             <xs:element name="UnusedClosureParam" type="IssueHandlerType" minOccurs="0" />
             <xs:element name="UnusedConstructor" type="MethodIssueHandlerType" minOccurs="0" />
diff --git a/docs/annotating_code/supported_annotations.md b/docs/annotating_code/supported_annotations.md
index c1781c48d..c82cf6f36 100644
--- a/docs/annotating_code/supported_annotations.md
+++ b/docs/annotating_code/supported_annotations.md
@@ -51,6 +51,14 @@ function bat(): string {
 
 There are a number of custom tags that determine how Psalm treats your code.
 
+### `@psalm-consistent-constructor`
+
+See [UnsafeInstantiation](../running_psalm/issues/UnsafeInstantiation.md)
+
+### `@psalm-consistent-templates`
+
+See [UnsafeGenericInstantiation](../running_psalm/issues/UnsafeGenericInstantiation.md)
+
 ### `@param-out`, `@psalm-param-out`
 
 This is used to specify that a by-ref type is different from the one that entered. In the function below the first param can be null, but once the function has executed the by-ref value is not null.
diff --git a/docs/running_psalm/issues/UnsafeGenericInstantiation.md b/docs/running_psalm/issues/UnsafeGenericInstantiation.md
new file mode 100644
index 000000000..ddd08e71d
--- /dev/null
+++ b/docs/running_psalm/issues/UnsafeGenericInstantiation.md
@@ -0,0 +1,157 @@
+# UnsafeGenericInstantiation
+
+Emitted when an attempt is made to instantiate a class using `new static` without a constructor that's final:
+
+```php
+<?php
+
+/**
+ * @template T
+ * @psalm-consistent-constructor
+ */
+class Container {
+    /**
+     * @var T
+     */
+    public $t;
+
+    /**
+     * @param T $t
+     */
+    public function __construct($t) {
+        $this->t = $t;
+    }
+
+    /**
+     * @template U
+     * @param U $u
+     * @return static<U>
+     */
+    public function getInstance($u) : static
+    {
+        return new static($u);
+    }
+}
+```
+
+
+## Whatâ€™s wrong here?
+
+The problem comes when extending the class:
+
+```php
+<?php
+
+/**
+ * @template T
+ * @psalm-consistent-constructor
+ */
+class Container {
+    /**
+     * @var T
+     */
+    public $t;
+
+    /**
+     * @param T $t
+     */
+    public function __construct($t) {
+        $this->t = $t;
+    }
+
+    /**
+     * @template U
+     * @param U $u
+     * @return static<U>
+     */
+    public function getInstance($u) : static
+    {
+        return new static($u);
+    }
+}
+
+/**
+ * @extends Container<string>
+ */
+class StringContainer extends Container {}
+
+$c = StringContainer::getInstance(new stdClass());
+// creates StringContainer<stdClass>, clearly invalid
+```
+
+## How to fix
+
+Either use `new self` instead of `new static`:
+
+```php
+<?php
+
+/**
+ * @template T
+ * @psalm-consistent-constructor
+ */
+class Container {
+    /**
+     * @var T
+     */
+    public $t;
+
+    /**
+     * @param T $t
+     */
+    public function __construct($t) {
+        $this->t = $t;
+    }
+
+    /**
+     * @template U
+     * @param U $u
+     * @return self<U>
+     */
+    public function getInstance($u) : self
+    {
+        return new self($u);
+    }
+}
+```
+
+Or you can add a `@psalm-consistent-templates` annotation which ensures that any child class has the same generic params:
+
+```php
+<?php
+
+/**
+ * @template T
+ * @psalm-consistent-constructor
+ * @psalm-consistent-templates
+ */
+class Container {
+    /**
+     * @var T
+     */
+    public $t;
+
+    /**
+     * @param T $t
+     */
+    public function __construct($t) {
+        $this->t = $t;
+    }
+
+    /**
+     * @template U
+     * @param U $u
+     * @return static<U>
+     */
+    public function getInstance($u) : static
+    {
+        return new static($u);
+    }
+}
+
+/**
+ * @template T
+ * @psalm-extends Container<T>
+ */
+class LazyLoadingContainer extends Container {}
+```
diff --git a/docs/running_psalm/issues/UnsafeInstantiation.md b/docs/running_psalm/issues/UnsafeInstantiation.md
index e4c81cc99..4d05a8840 100644
--- a/docs/running_psalm/issues/UnsafeInstantiation.md
+++ b/docs/running_psalm/issues/UnsafeInstantiation.md
@@ -1,6 +1,6 @@
 # UnsafeInstantiation
 
-Emitted when an attempt is made to instantiate a class without a constructor that's final:
+Emitted when an attempt is made to instantiate a class using `new static` or similar without a constructor that's final:
 
 ```php
 <?php
diff --git a/src/Psalm/DocComment.php b/src/Psalm/DocComment.php
index 29831e09c..9ed2efbcd 100644
--- a/src/Psalm/DocComment.php
+++ b/src/Psalm/DocComment.php
@@ -35,7 +35,8 @@ class DocComment
         'allow-private-mutation', 'readonly-allow-private-mutation',
         'yield', 'trace', 'import-type', 'flow', 'taint-specialize', 'taint-escape',
         'taint-unescape', 'self-out', 'consistent-constructor', 'stub-override',
-        'require-extends', 'require-implements', 'param-out', 'ignore-var'
+        'require-extends', 'require-implements', 'param-out', 'ignore-var',
+        'consistent-templates',
     ];
 
     /**
diff --git a/src/Psalm/Internal/Analyzer/ClassAnalyzer.php b/src/Psalm/Internal/Analyzer/ClassAnalyzer.php
index 1e5683fb1..5b56838dc 100644
--- a/src/Psalm/Internal/Analyzer/ClassAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/ClassAnalyzer.php
@@ -544,8 +544,6 @@ class ClassAnalyzer extends ClassLikeAnalyzer
                     $fq_trait_name_lc = strtolower($fq_trait_name);
 
                     if (isset($storage->template_type_uses_count[$fq_trait_name_lc])) {
-                        $expected_param_count = $storage->template_type_uses_count[$fq_trait_name_lc];
-
                         $this->checkTemplateParams(
                             $codebase,
                             $storage,
@@ -554,7 +552,7 @@ class ClassAnalyzer extends ClassLikeAnalyzer
                                 $this,
                                 $trait
                             ),
-                            $expected_param_count
+                            $storage->template_type_uses_count[$fq_trait_name_lc]
                         );
                     }
 
@@ -1972,28 +1970,28 @@ class ClassAnalyzer extends ClassLikeAnalyzer
         ClassLikeStorage $storage,
         ClassLikeStorage $parent_storage,
         CodeLocation $code_location,
-        int $expected_param_count
+        int $given_param_count
     ): void {
-        $template_type_count = $parent_storage->template_types === null
+        $expected_param_count = $parent_storage->template_types === null
             ? 0
             : count($parent_storage->template_types);
 
-        if ($template_type_count > $expected_param_count) {
+        if ($expected_param_count > $given_param_count) {
             if (IssueBuffer::accepts(
                 new MissingTemplateParam(
-                    $storage->name . ' has missing template params, expecting '
-                        . $template_type_count,
+                    $storage->name . ' has missing template params when extending ' . $parent_storage->name
+                        . ' , expecting ' . $expected_param_count,
                     $code_location
                 ),
                 $storage->suppressed_issues + $this->getSuppressedIssues()
             )) {
                 // fall through
             }
-        } elseif ($template_type_count < $expected_param_count) {
+        } elseif ($expected_param_count < $given_param_count) {
             if (IssueBuffer::accepts(
                 new TooManyTemplateParams(
-                    $storage->name . ' has too many template params, expecting '
-                        . $template_type_count,
+                    $storage->name . ' has too many template params when extending ' . $parent_storage->name
+                        . ' , expecting ' . $expected_param_count,
                     $code_location
                 ),
                 $storage->suppressed_issues + $this->getSuppressedIssues()
@@ -2002,82 +2000,150 @@ class ClassAnalyzer extends ClassLikeAnalyzer
             }
         }
 
+        $storage_param_count = ($storage->template_types ? count($storage->template_types) : 0);
+
+        if ($parent_storage->enforce_template_inheritance
+            && $expected_param_count !== $storage_param_count
+        ) {
+            if ($expected_param_count > $storage_param_count) {
+                if (IssueBuffer::accepts(
+                    new MissingTemplateParam(
+                        $storage->name . ' requires the same number of template params as ' . $parent_storage->name
+                            . ' but saw ' . $storage_param_count,
+                        $code_location
+                    ),
+                    $storage->suppressed_issues + $this->getSuppressedIssues()
+                )) {
+                    // fall through
+                }
+            } else {
+                if (IssueBuffer::accepts(
+                    new TooManyTemplateParams(
+                        $storage->name . ' requires the same number of template params as ' . $parent_storage->name
+                            . ' but saw ' . $storage_param_count,
+                        $code_location
+                    ),
+                    $storage->suppressed_issues + $this->getSuppressedIssues()
+                )) {
+                    // fall through
+                }
+            }
+        }
+
         if ($parent_storage->template_types && $storage->template_extended_params) {
             $i = 0;
 
             $previous_extended = [];
 
             foreach ($parent_storage->template_types as $template_name => $type_map) {
-                foreach ($type_map as $declaring_class => $template_type) {
-                    if (isset($storage->template_extended_params[$parent_storage->name][$template_name])) {
-                        $extended_type = $storage->template_extended_params[$parent_storage->name][$template_name];
+                // declares the variables
+                foreach ($type_map as $declaring_class => $template_type) {}
 
-                        if (isset($parent_storage->template_covariants[$i])
-                            && !$parent_storage->template_covariants[$i]
-                        ) {
-                            foreach ($extended_type->getAtomicTypes() as $t) {
-                                if ($t instanceof Type\Atomic\TTemplateParam
-                                    && $storage->template_types
-                                    && $storage->template_covariants
-                                    && ($local_offset
-                                        = array_search($t->param_name, array_keys($storage->template_types)))
-                                        !== false
-                                    && !empty($storage->template_covariants[$local_offset])
-                                ) {
-                                    if (IssueBuffer::accepts(
-                                        new InvalidTemplateParam(
-                                            'Cannot extend an invariant template param ' . $template_name
-                                                . ' into a covariant context',
-                                            $code_location
-                                        ),
-                                        $storage->suppressed_issues + $this->getSuppressedIssues()
-                                    )) {
-                                        // fall through
-                                    }
+                if (isset($storage->template_extended_params[$parent_storage->name][$template_name])) {
+                    $extended_type = $storage->template_extended_params[$parent_storage->name][$template_name];
+
+                    if (isset($parent_storage->template_covariants[$i])
+                        && !$parent_storage->template_covariants[$i]
+                    ) {
+                        foreach ($extended_type->getAtomicTypes() as $t) {
+                            if ($t instanceof Type\Atomic\TTemplateParam
+                                && $storage->template_types
+                                && $storage->template_covariants
+                                && ($local_offset
+                                    = array_search($t->param_name, array_keys($storage->template_types)))
+                                    !== false
+                                && !empty($storage->template_covariants[$local_offset])
+                            ) {
+                                if (IssueBuffer::accepts(
+                                    new InvalidTemplateParam(
+                                        'Cannot extend an invariant template param ' . $template_name
+                                            . ' into a covariant context',
+                                        $code_location
+                                    ),
+                                    $storage->suppressed_issues + $this->getSuppressedIssues()
+                                )) {
+                                    // fall through
                                 }
                             }
                         }
+                    }
 
-                        if (!$template_type->isMixed()) {
-                            $template_type_copy = clone $template_type;
-
-                            $template_result = new \Psalm\Internal\Type\TemplateResult(
-                                $previous_extended ?: [],
-                                []
-                            );
-
-                            $template_type_copy = TemplateStandinTypeReplacer::replace(
-                                $template_type_copy,
-                                $template_result,
-                                $codebase,
-                                null,
-                                $extended_type,
-                                null,
-                                null
-                            );
-
-                            if (!UnionTypeComparator::isContainedBy($codebase, $extended_type, $template_type_copy)) {
+                    if ($parent_storage->enforce_template_inheritance) {
+                        foreach ($extended_type->getAtomicTypes() as $t) {
+                            if (!$t instanceof Type\Atomic\TTemplateParam
+                                || !isset($storage->template_types[$t->param_name])
+                            ) {
                                 if (IssueBuffer::accepts(
                                     new InvalidTemplateParam(
-                                        'Extended template param ' . $template_name
-                                            . ' expects type ' . $template_type_copy->getId()
-                                            . ', type ' . $extended_type->getId() . ' given',
+                                        'Cannot extend a strictly-enforced parent template param '
+                                            . $template_name
+                                            . ' with a non-template type',
                                         $code_location
                                     ),
                                     $storage->suppressed_issues + $this->getSuppressedIssues()
                                 )) {
                                     // fall through
                                 }
-                            } else {
-                                $previous_extended[$template_name] = [
-                                    $declaring_class => $extended_type
-                                ];
+                            } elseif ($storage->template_types[$t->param_name][$storage->name]->getId()
+                                !== $template_type->getId()
+                            ) {
+                                if (IssueBuffer::accepts(
+                                    new InvalidTemplateParam(
+                                        'Cannot extend a strictly-enforced parent template param '
+                                            . $template_name
+                                            . ' with constraint ' . $template_type->getId()
+                                            . ' with a child template param ' . $t->param_name
+                                            . ' with different constraint '
+                                            . $storage->template_types[$t->param_name][$storage->name]->getId(),
+                                        $code_location
+                                    ),
+                                    $storage->suppressed_issues + $this->getSuppressedIssues()
+                                )) {
+                                    // fall through
+                                }
+                            }
+                        }
+                    }
+
+                    if (!$template_type->isMixed()) {
+                        $template_type_copy = clone $template_type;
+
+                        $template_result = new \Psalm\Internal\Type\TemplateResult(
+                            $previous_extended ?: [],
+                            []
+                        );
+
+                        $template_type_copy = TemplateStandinTypeReplacer::replace(
+                            $template_type_copy,
+                            $template_result,
+                            $codebase,
+                            null,
+                            $extended_type,
+                            null,
+                            null
+                        );
+
+                        if (!UnionTypeComparator::isContainedBy($codebase, $extended_type, $template_type_copy)) {
+                            if (IssueBuffer::accepts(
+                                new InvalidTemplateParam(
+                                    'Extended template param ' . $template_name
+                                        . ' expects type ' . $template_type_copy->getId()
+                                        . ', type ' . $extended_type->getId() . ' given',
+                                    $code_location
+                                ),
+                                $storage->suppressed_issues + $this->getSuppressedIssues()
+                            )) {
+                                // fall through
                             }
                         } else {
                             $previous_extended[$template_name] = [
                                 $declaring_class => $extended_type
                             ];
                         }
+                    } else {
+                        $previous_extended[$template_name] = [
+                            $declaring_class => $extended_type
+                        ];
                     }
                 }
 
@@ -2175,14 +2241,12 @@ class ClassAnalyzer extends ClassLikeAnalyzer
             }
 
             if (isset($storage->template_type_implements_count[$fq_interface_name_lc])) {
-                $expected_param_count = $storage->template_type_implements_count[$fq_interface_name_lc];
-
                 $this->checkTemplateParams(
                     $codebase,
                     $storage,
                     $interface_storage,
                     $code_location,
-                    $expected_param_count
+                    $storage->template_type_implements_count[$fq_interface_name_lc]
                 );
             }
         }
@@ -2505,20 +2569,20 @@ class ClassAnalyzer extends ClassLikeAnalyzer
                 );
             }
 
-            $code_location = new CodeLocation(
-                $this,
-                $class->name ?: $class,
-                $class_context ? $class_context->include_location : null,
-                true
-            );
+            if ($storage->template_extended_count !== null || $parent_class_storage->enforce_template_inheritance) {
+                $code_location = new CodeLocation(
+                    $this,
+                    $class->name ?: $class,
+                    $class_context ? $class_context->include_location : null,
+                    true
+                );
 
-            if ($storage->template_extended_count !== null) {
                 $this->checkTemplateParams(
                     $codebase,
                     $storage,
                     $parent_class_storage,
                     $code_location,
-                    $storage->template_extended_count
+                    $storage->template_extended_count ?? 0
                 );
             }
         } catch (\InvalidArgumentException $e) {
diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/Call/NewAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/Call/NewAnalyzer.php
index 4471a6ab9..1ac49fc59 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/Call/NewAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/Call/NewAnalyzer.php
@@ -20,6 +20,7 @@ use Psalm\Issue\InvalidStringClass;
 use Psalm\Issue\MixedMethodCall;
 use Psalm\Issue\TooManyArguments;
 use Psalm\Issue\UnsafeInstantiation;
+use Psalm\Issue\UnsafeGenericInstantiation;
 use Psalm\Issue\UndefinedClass;
 use Psalm\IssueBuffer;
 use Psalm\Type;
@@ -245,16 +246,42 @@ class NewAnalyzer extends \Psalm\Internal\Analyzer\Statements\Expression\CallAna
     ): void {
         $storage = $codebase->classlike_storage_provider->get($fq_class_name);
 
-        if ($from_static && !$storage->preserve_constructor_signature) {
-            if (IssueBuffer::accepts(
-                new UnsafeInstantiation(
-                    'Cannot safely instantiate class ' . $fq_class_name . ' with "new static" as'
-                    . ' its constructor might change in child classes',
-                    new CodeLocation($statements_analyzer->getSource(), $stmt)
-                ),
-                $statements_analyzer->getSuppressedIssues()
-            )) {
-                // fall through
+        if ($from_static) {
+            if (!$storage->preserve_constructor_signature) {
+                if (IssueBuffer::accepts(
+                    new UnsafeInstantiation(
+                        'Cannot safely instantiate class ' . $fq_class_name . ' with "new static" as'
+                        . ' its constructor might change in child classes',
+                        new CodeLocation($statements_analyzer->getSource(), $stmt)
+                    ),
+                    $statements_analyzer->getSuppressedIssues()
+                )) {
+                    // fall through
+                }
+            } elseif ($storage->template_types
+                && !$storage->enforce_template_inheritance
+            ) {
+                $source = $statements_analyzer->getSource();
+
+                if ($statements_analyzer->getSource() instanceof \Psalm\Internal\Analyzer\FunctionLikeAnalyzer) {
+                    $function_storage = $source->getFunctionLikeStorage($statements_analyzer);
+
+                    if ($function_storage->return_type
+                        && preg_match('/\bstatic\b/', $function_storage->return_type->getId())
+                    ) {
+                        if (IssueBuffer::accepts(
+                            new UnsafeGenericInstantiation(
+                                'Cannot safely instantiate generic class ' . $fq_class_name
+                                    . ' with "new static" as'
+                                    . ' its generic parameters may be constrained in child classes.',
+                                new CodeLocation($statements_analyzer->getSource(), $stmt)
+                            ),
+                            $statements_analyzer->getSuppressedIssues()
+                        )) {
+                            // fall through
+                        }
+                    }
+                }
             }
         }
 
diff --git a/src/Psalm/Internal/PhpVisitor/Reflector/ClassLikeDocblockParser.php b/src/Psalm/Internal/PhpVisitor/Reflector/ClassLikeDocblockParser.php
index 468c2fa70..b1429fcd5 100644
--- a/src/Psalm/Internal/PhpVisitor/Reflector/ClassLikeDocblockParser.php
+++ b/src/Psalm/Internal/PhpVisitor/Reflector/ClassLikeDocblockParser.php
@@ -164,6 +164,10 @@ class ClassLikeDocblockParser
             $info->consistent_constructor = true;
         }
 
+        if (isset($parsed_docblock->tags['psalm-consistent-templates'])) {
+            $info->consistent_templates = true;
+        }
+
         if (isset($parsed_docblock->tags['psalm-internal'])) {
             $psalm_internal = reset($parsed_docblock->tags['psalm-internal']);
             if ($psalm_internal) {
diff --git a/src/Psalm/Internal/PhpVisitor/Reflector/ClassLikeNodeScanner.php b/src/Psalm/Internal/PhpVisitor/Reflector/ClassLikeNodeScanner.php
index 318a16331..eefdd97df 100644
--- a/src/Psalm/Internal/PhpVisitor/Reflector/ClassLikeNodeScanner.php
+++ b/src/Psalm/Internal/PhpVisitor/Reflector/ClassLikeNodeScanner.php
@@ -562,6 +562,8 @@ class ClassLikeNodeScanner
                 }
             }
 
+            $storage->enforce_template_inheritance = $docblock_info->consistent_templates;
+
             foreach ($docblock_info->mixins as $key => $mixin) {
                 $mixin_type = TypeParser::parseTokens(
                     TypeTokenizer::getFullyQualifiedTokens(
diff --git a/src/Psalm/Internal/Scanner/ClassLikeDocblockComment.php b/src/Psalm/Internal/Scanner/ClassLikeDocblockComment.php
index 2b81d60af..8621d555b 100644
--- a/src/Psalm/Internal/Scanner/ClassLikeDocblockComment.php
+++ b/src/Psalm/Internal/Scanner/ClassLikeDocblockComment.php
@@ -125,6 +125,11 @@ class ClassLikeDocblockComment
      */
     public $consistent_constructor = false;
 
+    /**
+     * @var bool
+     */
+    public $consistent_templates = false;
+
     /** @var bool */
     public $stub_override = false;
 
diff --git a/src/Psalm/Issue/UnsafeGenericInstantiation.php b/src/Psalm/Issue/UnsafeGenericInstantiation.php
new file mode 100644
index 000000000..2651f33b3
--- /dev/null
+++ b/src/Psalm/Issue/UnsafeGenericInstantiation.php
@@ -0,0 +1,8 @@
+<?php
+namespace Psalm\Issue;
+
+class UnsafeGenericInstantiation extends CodeIssue
+{
+    public const ERROR_LEVEL = 2;
+    public const SHORTCODE = 269;
+}
diff --git a/src/Psalm/Storage/ClassLikeStorage.php b/src/Psalm/Storage/ClassLikeStorage.php
index 23cbb0b2c..44aa22d56 100644
--- a/src/Psalm/Storage/ClassLikeStorage.php
+++ b/src/Psalm/Storage/ClassLikeStorage.php
@@ -407,6 +407,11 @@ class ClassLikeStorage
      */
     public $preserve_constructor_signature = false;
 
+    /**
+     * @var bool
+     */
+    public $enforce_template_inheritance = false;
+
     /**
      * @var null|string
      */
diff --git a/tests/Template/ClassTemplateExtendsTest.php b/tests/Template/ClassTemplateExtendsTest.php
index 5d69ae6a2..497a46c96 100644
--- a/tests/Template/ClassTemplateExtendsTest.php
+++ b/tests/Template/ClassTemplateExtendsTest.php
@@ -1071,6 +1071,7 @@ class ClassTemplateExtendsTest extends TestCase
                     /**
                      * @template T
                      * @psalm-consistent-constructor
+                     * @psalm-consistent-templates
                      */
                     class Container {
                         /** @var T */
@@ -1100,7 +1101,7 @@ class ClassTemplateExtendsTest extends TestCase
                     }
 
                     /**
-                     * @template T1 as A
+                     * @template T1
                      * @template-extends Container<T1>
                      */
                     class AContainer extends Container {}
@@ -1119,6 +1120,7 @@ class ClassTemplateExtendsTest extends TestCase
                     /**
                      * @template T
                      * @psalm-consistent-constructor
+                     * @psalm-consistent-templates
                      */
                     class Container {
                         /** @var T */
@@ -1148,13 +1150,13 @@ class ClassTemplateExtendsTest extends TestCase
                     }
 
                     /**
-                     * @template T1 as object
+                     * @template T1
                      * @template-extends Container<T1>
                      */
                     class ObjectContainer extends Container {}
 
                     /**
-                     * @template T2 as A
+                     * @template T2
                      * @template-extends ObjectContainer<T2>
                      */
                     class AContainer extends ObjectContainer {}
@@ -1173,6 +1175,7 @@ class ClassTemplateExtendsTest extends TestCase
                     /**
                      * @template T
                      * @psalm-consistent-constructor
+                     * @psalm-consistent-templates
                      */
                     class Container {
                         /** @var T */
@@ -1202,13 +1205,13 @@ class ClassTemplateExtendsTest extends TestCase
                     }
 
                     /**
-                     * @template T as object
+                     * @template T
                      * @template-extends Container<T>
                      */
                     class ObjectContainer extends Container {}
 
                     /**
-                     * @template T as A
+                     * @template T
                      * @template-extends ObjectContainer<T>
                      */
                     class AContainer extends ObjectContainer {}
@@ -1490,6 +1493,7 @@ class ClassTemplateExtendsTest extends TestCase
                      * @template TKey of array-key
                      * @template-implements Collection<TKey, T>
                      * @psalm-consistent-constructor
+                     * @psalm-consistent-templates
                      */
                     class ArrayCollection implements Collection
                     {
@@ -1540,6 +1544,7 @@ class ClassTemplateExtendsTest extends TestCase
                      * @template TKey of array-key
                      * @template-implements Collection<TKey>
                      * @psalm-consistent-constructor
+                     * @psalm-consistent-templates
                      */
                     class ArrayCollection implements Collection
                     {
@@ -2237,6 +2242,7 @@ class ClassTemplateExtendsTest extends TestCase
                      * @template TKey as array-key
                      * @template TValue
                      * @psalm-consistent-constructor
+                     * @psalm-consistent-templates
                      */
                     class Collection
                     {
@@ -5475,6 +5481,234 @@ class ClassTemplateExtendsTest extends TestCase
                     }',
                 'error_message' => 'ArgumentTypeCoercion'
             ],
+            'templateExtendsSameNameWithStaticCallUnsafeTemplatedExtended' => [
+                '<?php
+                    /**
+                     * @template T
+                     * @psalm-consistent-constructor
+                     * @psalm-consistent-templates
+                     */
+                    class Container {
+                        /** @var T */
+                        private $t;
+
+                        /** @param T $t */
+                        private function __construct($t) {
+                            $this->t = $t;
+                        }
+
+                        /**
+                         * @template U
+                         * @param U $t
+                         * @return static<U>
+                         */
+                        public static function getContainer($t) {
+                            return new static($t);
+                        }
+
+                        /**
+                         * @return T
+                         */
+                        public function getValue()
+                        {
+                            return $this->t;
+                        }
+                    }
+
+                    /**
+                     * @template T as object
+                     * @template-extends Container<T>
+                     */
+                    class ObjectContainer extends Container {}',
+                'error_message' => 'InvalidTemplateParam'
+            ],
+            'templateExtendsSameNameWithStaticCallUnsafeMissingExtendedParam' => [
+                '<?php
+                    /**
+                     * @template T
+                     * @psalm-consistent-constructor
+                     * @psalm-consistent-templates
+                     */
+                    class Container {
+                        /** @var T */
+                        private $t;
+
+                        /** @param T $t */
+                        private function __construct($t) {
+                            $this->t = $t;
+                        }
+
+                        /**
+                         * @template U
+                         * @param U $t
+                         * @return static<U>
+                         */
+                        public static function getContainer($t) {
+                            return new static($t);
+                        }
+
+                        /**
+                         * @return T
+                         */
+                        public function getValue()
+                        {
+                            return $this->t;
+                        }
+                    }
+
+                    /**
+                     * @template-extends Container<object>
+                     */
+                    class ObjectContainer extends Container {}',
+                'error_message' => 'MissingTemplateParam'
+            ],
+            'templateExtendsSameNameWithStaticCallNoExtendsParams' => [
+                '<?php
+                    /**
+                     * @template T
+                     * @psalm-consistent-constructor
+                     * @psalm-consistent-templates
+                     */
+                    class Container {
+                        /** @var T */
+                        private $t;
+
+                        /** @param T $t */
+                        private function __construct($t) {
+                            $this->t = $t;
+                        }
+
+                        /**
+                         * @template U
+                         * @param U $t
+                         * @return static<U>
+                         */
+                        public static function getContainer($t) {
+                            return new static($t);
+                        }
+
+                        /**
+                         * @return T
+                         */
+                        public function getValue()
+                        {
+                            return $this->t;
+                        }
+                    }
+
+                    class ObjectContainer extends Container {}',
+                'error_message' => 'MissingTemplateParam'
+            ],
+            'templateExtendsSameNameWithStaticCallUnsafeTooManyTemplatedExtended' => [
+                '<?php
+                    /**
+                     * @template T
+                     * @psalm-consistent-constructor
+                     * @psalm-consistent-templates
+                     */
+                    class Container {
+                        /** @var T */
+                        private $t;
+
+                        /** @param T $t */
+                        private function __construct($t) {
+                            $this->t = $t;
+                        }
+
+                        /**
+                         * @template U
+                         * @param U $t
+                         * @return static<U>
+                         */
+                        public static function getContainer($t) {
+                            return new static($t);
+                        }
+
+                        /**
+                         * @return T
+                         */
+                        public function getValue()
+                        {
+                            return $this->t;
+                        }
+                    }
+
+                    /**
+                     * @template T1
+                     * @template T2
+                     * @template-extends Container<T1>
+                     */
+                    class ObjectContainer extends Container {}',
+                'error_message' => 'TooManyTemplateParams'
+            ],
+            'templateExtendsSameNameWithStaticCallUnsafeInstantiationParameterised' => [
+                '<?php
+                    /**
+                     * @template T
+                     * @psalm-consistent-constructor
+                     */
+                    class Container {
+                        /** @var T */
+                        private $t;
+
+                        /** @param T $t */
+                        private function __construct($t) {
+                            $this->t = $t;
+                        }
+
+                        /**
+                         * @template U
+                         * @param U $t
+                         * @return static<U>
+                         */
+                        public static function getContainer($t) {
+                            return new static($t);
+                        }
+
+                        /**
+                         * @return T
+                         */
+                        public function getValue()
+                        {
+                            return $this->t;
+                        }
+                    }',
+                'error_message' => 'UnsafeGenericInstantiation'
+            ],
+            'templateExtendsSameNameWithStaticCallUnsafeInstantiationNoParameters' => [
+                '<?php
+                    /**
+                     * @template T
+                     * @psalm-consistent-constructor
+                     */
+                    class Container {
+                        /** @var T */
+                        private $t;
+
+                        /** @param T $t */
+                        private function __construct($t) {
+                            $this->t = $t;
+                        }
+
+                        /**
+                         * @template U
+                         * @param U $t
+                         * @return static
+                         */
+                        public static function getContainer($t) {
+                            return new static($t);
+                        }
+
+                        /**
+                         * @return T
+                         */
+                        public function getValue()
+                        {
+                            return $this->t;
+                        }
+                    }',
+                'error_message' => 'UnsafeGenericInstantiation'
+            ],
         ];
     }
 }
diff --git a/tests/Template/ClassTemplateTest.php b/tests/Template/ClassTemplateTest.php
index 5111cdcdb..a1e8a4c09 100644
--- a/tests/Template/ClassTemplateTest.php
+++ b/tests/Template/ClassTemplateTest.php
@@ -398,6 +398,7 @@ class ClassTemplateTest extends TestCase
                      * @template TKey as array-key
                      * @template TValue
                      * @psalm-consistent-constructor
+                     * @psalm-consistent-templates
                      */
                     class ArrayCollection {
                         /** @var array<TKey,TValue> */
@@ -1943,6 +1944,7 @@ class ClassTemplateTest extends TestCase
                     /**
                      * @template T
                      * @psalm-consistent-constructor
+                     * @psalm-consistent-templates
                      */
                     class Foo {
                         /** @var T */
@@ -2272,6 +2274,7 @@ class ClassTemplateTest extends TestCase
                     /**
                      * @template T
                      * @psalm-consistent-constructor
+                     * @psalm-consistent-templates
                      */
                     class ArrayCollection {
                         /** @var list<T> */
@@ -2297,7 +2300,13 @@ class ClassTemplateTest extends TestCase
                     /** @param ArrayCollection<int> $ints */
                     function takesInts(ArrayCollection $ints) :void {}
 
-                    takesInts((new ArrayCollection([ "a", "bc" ]))->map("strlen"));'
+                    takesInts((new ArrayCollection([ "a", "bc" ]))->map("strlen"));
+
+                    /**
+                     * @template T
+                     * @extends ArrayCollection<T>
+                     */
+                    class LazyArrayCollection extends ArrayCollection {}'
             ],
             'weakReferenceIsTyped' => [
                 '<?php
@@ -3146,6 +3155,7 @@ class ClassTemplateTest extends TestCase
                      * @psalm-template TKey of array-key
                      * @psalm-template T
                      * @psalm-consistent-constructor
+                     * @psalm-consistent-templates
                      */
                     class ArrayCollection
                     {
@@ -3283,6 +3293,7 @@ class ClassTemplateTest extends TestCase
                 '<?php
                     /**
                      * @template T
+                     * @psalm-consistent-templates
                      */
                     abstract class A {
                         /**
diff --git a/tests/Template/ConditionalReturnTypeTest.php b/tests/Template/ConditionalReturnTypeTest.php
index 4e04fea30..7e085c9cd 100644
--- a/tests/Template/ConditionalReturnTypeTest.php
+++ b/tests/Template/ConditionalReturnTypeTest.php
@@ -571,6 +571,7 @@ class ConditionalReturnTypeTest extends TestCase
                      * @template E
                      * @implements AInterface<E>
                      * @psalm-consistent-constructor
+                     * @psalm-consistent-templates
                      */
                     class BClass implements AInterface {
                         protected string $type;
