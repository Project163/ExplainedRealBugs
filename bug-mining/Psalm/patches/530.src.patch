diff --git a/src/Psalm/Internal/Analyzer/Statements/Expression/Call/FunctionCallAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Expression/Call/FunctionCallAnalyzer.php
index 813188d93..ffbb59e10 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Expression/Call/FunctionCallAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Expression/Call/FunctionCallAnalyzer.php
@@ -573,6 +573,14 @@ class FunctionCallAnalyzer extends \Psalm\Internal\Analyzer\Statements\Expressio
                                     );
                                 }
 
+                                $return_type = ExpressionAnalyzer::fleshOutType(
+                                    $codebase,
+                                    $return_type,
+                                    null,
+                                    null,
+                                    null
+                                );
+
                                 $return_type_location = $function_storage->return_type_location;
 
                                 if ($config->after_function_checks) {
diff --git a/tests/TypeReconciliation/ValueTest.php b/tests/TypeReconciliation/ValueTest.php
index 579a15d8b..a37174ab8 100644
--- a/tests/TypeReconciliation/ValueTest.php
+++ b/tests/TypeReconciliation/ValueTest.php
@@ -660,6 +660,29 @@ class ValueTest extends TestCase
 
                     consumeNumeric("12.34");'
             ],
+            'resolveScalarClassConstant' => [
+                '<?php
+                    class PaymentFailure {
+                        const NO_CLIENT = "no_client";
+                        const NO_CARD = "no_card";
+                    }
+
+                    /**
+                     * @return PaymentFailure::NO_CARD|PaymentFailure::NO_CLIENT
+                     */
+                    function something() {
+                        if (rand(0, 1)) {
+                            return PaymentFailure::NO_CARD;
+                        }
+
+                        return PaymentFailure::NO_CLIENT;
+                    }
+
+                    function blah(): void {
+                        $test = something();
+                        if ($test === PaymentFailure::NO_CLIENT) {}
+                    }'
+            ],
         ];
     }
 
