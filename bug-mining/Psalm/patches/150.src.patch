diff --git a/composer.json b/composer.json
index 8ac370f96..73c76ca51 100644
--- a/composer.json
+++ b/composer.json
@@ -52,7 +52,8 @@
         "psalm/plugin-phpunit": "^0.6",
         "phpmyadmin/sql-parser": "^5.0",
         "symfony/process": "^4.3",
-        "slevomat/coding-standard": "^5.0"
+        "slevomat/coding-standard": "^5.0",
+        "friendsofphp/php-cs-fixer": "^2.15"
     },
     "suggest": {
         "ext-igbinary": "^2.0.5"
diff --git a/src/Psalm/CodeLocation.php b/src/Psalm/CodeLocation.php
index b6fa350c8..bdf5f1745 100644
--- a/src/Psalm/CodeLocation.php
+++ b/src/Psalm/CodeLocation.php
@@ -1,22 +1,22 @@
 <?php
 namespace Psalm;
 
+use function explode;
+use function max;
+use function min;
 use PhpParser;
+use function preg_match;
+use const PREG_OFFSET_CAPTURE;
+use function preg_quote;
+use function preg_replace;
 use Psalm\Internal\Analyzer\CommentAnalyzer;
+use function str_replace;
 use function strlen;
 use function strpos;
-use function explode;
-use function substr;
-use function trim;
-use function preg_replace;
-use function str_replace;
-use function preg_quote;
-use function preg_match;
-use const PREG_OFFSET_CAPTURE;
 use function strrpos;
-use function min;
-use function max;
+use function substr;
 use function substr_count;
+use function trim;
 
 class CodeLocation
 {
diff --git a/src/Psalm/CodeLocation/DocblockTypeLocation.php b/src/Psalm/CodeLocation/DocblockTypeLocation.php
index 85812c55c..6ed0dff7e 100644
--- a/src/Psalm/CodeLocation/DocblockTypeLocation.php
+++ b/src/Psalm/CodeLocation/DocblockTypeLocation.php
@@ -1,8 +1,6 @@
 <?php
 namespace Psalm\CodeLocation;
 
-use PhpParser;
-
 class DocblockTypeLocation extends \Psalm\CodeLocation
 {
     /** @var int */
diff --git a/src/Psalm/CodeLocation/ParseErrorLocation.php b/src/Psalm/CodeLocation/ParseErrorLocation.php
index cdcda177b..e1d2506ac 100644
--- a/src/Psalm/CodeLocation/ParseErrorLocation.php
+++ b/src/Psalm/CodeLocation/ParseErrorLocation.php
@@ -2,8 +2,8 @@
 namespace Psalm\CodeLocation;
 
 use PhpParser;
-use function substr_count;
 use function substr;
+use function substr_count;
 
 class ParseErrorLocation extends \Psalm\CodeLocation
 {
diff --git a/src/Psalm/CodeLocation/Raw.php b/src/Psalm/CodeLocation/Raw.php
index f03ed06ac..0a8eaa312 100644
--- a/src/Psalm/CodeLocation/Raw.php
+++ b/src/Psalm/CodeLocation/Raw.php
@@ -1,9 +1,8 @@
 <?php
 namespace Psalm\CodeLocation;
 
-use PhpParser;
-use function substr_count;
 use function substr;
+use function substr_count;
 
 class Raw extends \Psalm\CodeLocation
 {
diff --git a/src/Psalm/Codebase.php b/src/Psalm/Codebase.php
index 88d04fb8c..deb0cf038 100644
--- a/src/Psalm/Codebase.php
+++ b/src/Psalm/Codebase.php
@@ -1,10 +1,23 @@
 <?php
 namespace Psalm;
 
-use LanguageServerProtocol\{Position, Range, Command};
+use function array_combine;
+use function array_merge;
+use function count;
+use function error_log;
+use function explode;
+use function in_array;
+use function krsort;
+use function ksort;
+use LanguageServerProtocol\Command;
+use LanguageServerProtocol\Position;
+use LanguageServerProtocol\Range;
+use const PHP_MAJOR_VERSION;
+use const PHP_MINOR_VERSION;
 use PhpParser;
-use Psalm\Internal\Analyzer\Statements\Block\ForeachAnalyzer;
+use function preg_match;
 use Psalm\Internal\Analyzer\ProjectAnalyzer;
+use Psalm\Internal\Analyzer\Statements\Block\ForeachAnalyzer;
 use Psalm\Internal\Analyzer\TypeAnalyzer;
 use Psalm\Internal\Provider\ClassLikeStorageProvider;
 use Psalm\Internal\Provider\FileProvider;
@@ -17,24 +30,12 @@ use Psalm\Progress\VoidProgress;
 use Psalm\Storage\ClassLikeStorage;
 use Psalm\Storage\FileStorage;
 use Psalm\Storage\FunctionLikeStorage;
-use const PHP_MAJOR_VERSION;
-use const PHP_MINOR_VERSION;
-use function in_array;
-use function array_combine;
+use function strlen;
 use function strpos;
+use function strrpos;
 use function strtolower;
-use function explode;
-use function array_merge;
 use function substr;
-use function error_log;
-use function ksort;
-use function krsort;
-use function preg_match;
-use function strlen;
-use function count;
-use function array_shift;
 use function substr_count;
-use function strrpos;
 
 class Codebase
 {
@@ -378,7 +379,7 @@ class Codebase
         }
 
         foreach ($referenced_files as $referenced_file_path) {
-            if (in_array($referenced_file_path, $diff_files)) {
+            if (in_array($referenced_file_path, $diff_files, true)) {
                 continue;
             }
 
@@ -593,6 +594,7 @@ class Codebase
     public function findReferencesToProperty(string $property_id)
     {
         list($fq_class_name, $property_name) = explode('::', $property_id);
+
         return $this->file_reference_provider->getClassPropertyLocations(
             strtolower($fq_class_name) . '::' . $property_name
         );
@@ -709,9 +711,10 @@ class Codebase
      * @param  string       $fq_class_name
      * @param  string       $possible_parent
      *
-     * @return bool
      * @throws \Psalm\Exception\UnpopulatedClasslikeException when called on unpopulated class
      * @throws \InvalidArgumentException when class does not exist
+     *
+     * @return bool
      */
     public function classExtends($fq_class_name, $possible_parent)
     {
@@ -1004,6 +1007,7 @@ class Codebase
             return '<?php ' . ($storage->abstract ? 'abstract ' : '') . 'class ' . $storage->name;
         } catch (\Exception $e) {
             error_log($e->getMessage());
+
             return null;
         }
     }
@@ -1077,6 +1081,7 @@ class Codebase
             return $storage->location;
         } catch (\UnexpectedValueException $e) {
             error_log($e->getMessage());
+
             return null;
         } catch (\InvalidArgumentException $e) {
             return null;
@@ -1150,7 +1155,7 @@ class Codebase
 
         $offset = $position->toOffset($file_contents);
 
-        list(,, $argument_map) = $this->analyzer->getMapsForFile($file_path);
+        list(, , $argument_map) = $this->analyzer->getMapsForFile($file_path);
 
         $reference = null;
         $argument_number = null;
diff --git a/src/Psalm/Config.php b/src/Psalm/Config.php
index ca907f7a8..c69f653cb 100644
--- a/src/Psalm/Config.php
+++ b/src/Psalm/Config.php
@@ -1,70 +1,69 @@
 <?php
 namespace Psalm;
 
+use function array_merge;
+use function array_pop;
+use function array_unique;
+use function class_exists;
 use Composer\Autoload\ClassLoader;
+use function count;
+use const DIRECTORY_SEPARATOR;
+use function dirname;
+use const E_USER_ERROR;
+use function explode;
+use function file_exists;
+use function file_get_contents;
+use function filetype;
+use function get_class;
+use function get_defined_constants;
+use function get_defined_functions;
+use function in_array;
+use function intval;
+use function is_dir;
+use function json_decode;
+use function libxml_clear_errors;
+use const LIBXML_ERR_ERROR;
+use const LIBXML_ERR_FATAL;
+use function libxml_get_errors;
+use function libxml_use_internal_errors;
+use function mkdir;
+use const PHP_EOL;
+use function phpversion;
+use function preg_match;
+use function preg_quote;
+use function preg_replace;
+use Psalm\Config\IssueHandler;
+use Psalm\Config\ProjectFileFilter;
+use Psalm\Exception\ConfigException;
 use Psalm\Internal\Analyzer\ClassLikeAnalyzer;
+use Psalm\Internal\Analyzer\FileAnalyzer;
 use Psalm\Internal\Analyzer\ProjectAnalyzer;
+use Psalm\Internal\Scanner\FileScanner;
+use Psalm\Issue\ArgumentIssue;
 use Psalm\Issue\ClassIssue;
 use Psalm\Issue\CodeIssue;
 use Psalm\Issue\FunctionIssue;
 use Psalm\Issue\MethodIssue;
-use Psalm\Issue\ArgumentIssue;
 use Psalm\Issue\PropertyIssue;
-use Psalm\Config\IssueHandler;
-use Psalm\Config\ProjectFileFilter;
-use Psalm\Exception\ConfigException;
-use Psalm\Internal\Analyzer\FileAnalyzer;
-use Psalm\Internal\Scanner\FileScanner;
 use Psalm\Plugin\Hook;
-use Psalm\PluginRegistrationSocket;
 use Psalm\Progress\Progress;
 use Psalm\Progress\VoidProgress;
-use SimpleXMLElement;
-use const PHP_EOL;
 use function realpath;
-use function is_dir;
-use function dirname;
-use const DIRECTORY_SEPARATOR;
-use function file_exists;
-use function file_get_contents;
-use function sha1;
-use function libxml_use_internal_errors;
-use function libxml_get_errors;
-use const LIBXML_ERR_FATAL;
-use const LIBXML_ERR_ERROR;
-use function libxml_clear_errors;
-use function sys_get_temp_dir;
-use function mkdir;
-use function trigger_error;
-use const E_USER_ERROR;
-use function phpversion;
-use function version_compare;
-use function intval;
-use function strtolower;
-use function preg_replace;
-use function class_exists;
-use function count;
 use function reset;
-use function preg_quote;
-use function in_array;
-use function explode;
-use function get_class;
-use function array_pop;
+use function rmdir;
+use function scandir;
+use function sha1;
+use SimpleXMLElement;
 use function strpos;
-use function preg_match;
-use function array_merge;
-use function get_defined_constants;
-use function get_defined_functions;
-use function json_decode;
-use function array_unique;
-use function strtr;
 use function strrpos;
+use function strtolower;
+use function strtr;
 use function substr;
 use function substr_count;
-use function scandir;
-use function filetype;
+use function sys_get_temp_dir;
+use function trigger_error;
 use function unlink;
-use function rmdir;
+use function version_compare;
 
 class Config
 {
@@ -402,12 +401,14 @@ class Config
 
     /**
      * Static methods to be called after codebase has been populated
+     *
      * @var class-string<Hook\AfterCodebasePopulatedInterface>[]
      */
     public $after_codebase_populated = [];
 
     /**
      * Static methods to be called after codebase has been populated
+     *
      * @var class-string<Hook\AfterAnalysisInterface>[]
      */
     public $after_analysis = [];
@@ -479,7 +480,7 @@ class Config
 
         if (!$config_path) {
             if ($output_format === \Psalm\Report::TYPE_CONSOLE) {
-                echo 'Could not locate a config XML file in path '. $path
+                echo 'Could not locate a config XML file in path ' . $path
                     . '. Have you run \'psalm --init\' ?' . PHP_EOL;
                 exit(1);
             }
@@ -493,6 +494,7 @@ class Config
      * Searches up a folder hierarchy for the most immediate config.
      *
      * @throws ConfigException
+     *
      * @return ?string
      */
     public static function locateConfigFile(string $path)
@@ -516,6 +518,7 @@ class Config
 
             $dir_path = dirname($dir_path);
         } while (dirname($dir_path) !== $dir_path);
+
         return null;
     }
 
@@ -1049,7 +1052,8 @@ class Config
 
                 /**
                  * @psalm-suppress InvalidStringClass
-                 * @var Plugin\PluginEntryPointInterface $plugin_object
+                 *
+                 * @var Plugin\PluginEntryPointInterface
                  */
                 $plugin_object = new $plugin_class_name;
                 $plugin_object($socket, $plugin_config);
@@ -1271,6 +1275,7 @@ class Config
 
     /**
      * @param  string $issue_type
+     *
      * @return string|null
      */
     private static function getParentIssueType($issue_type)
diff --git a/src/Psalm/Config/Creator.php b/src/Psalm/Config/Creator.php
index 57750563f..d56ca5fb4 100644
--- a/src/Psalm/Config/Creator.php
+++ b/src/Psalm/Config/Creator.php
@@ -1,25 +1,24 @@
 <?php
 namespace Psalm\Config;
 
-use Psalm\Exception\ConfigCreationException;
-use Psalm\Internal\Provider;
-use function is_dir;
+use function array_merge;
+use function array_shift;
+use function array_unique;
+use function count;
 use const DIRECTORY_SEPARATOR;
+use function dirname;
+use function explode;
 use function file_exists;
-use function json_decode;
 use function file_get_contents;
-use function is_array;
-use function dirname;
-use function str_replace;
+use function glob;
 use function implode;
-use function array_merge;
+use function is_array;
+use function is_dir;
+use function json_decode;
 use function preg_replace;
-use function array_unique;
+use Psalm\Exception\ConfigCreationException;
 use function sort;
-use function glob;
-use function explode;
-use function array_shift;
-use function count;
+use function str_replace;
 
 class Creator
 {
diff --git a/src/Psalm/Config/ErrorLevelFileFilter.php b/src/Psalm/Config/ErrorLevelFileFilter.php
index ef0d1d4e9..83686bfcf 100644
--- a/src/Psalm/Config/ErrorLevelFileFilter.php
+++ b/src/Psalm/Config/ErrorLevelFileFilter.php
@@ -1,8 +1,8 @@
 <?php
 namespace Psalm\Config;
 
-use SimpleXMLElement;
 use function in_array;
+use SimpleXMLElement;
 
 class ErrorLevelFileFilter extends FileFilter
 {
diff --git a/src/Psalm/Config/FileFilter.php b/src/Psalm/Config/FileFilter.php
index 8c88a4843..10b1ca07f 100644
--- a/src/Psalm/Config/FileFilter.php
+++ b/src/Psalm/Config/FileFilter.php
@@ -1,27 +1,27 @@
 <?php
 namespace Psalm\Config;
 
-use SimpleXMLElement;
-use Psalm\Exception\ConfigException;
-use function is_bool;
-use function strtolower;
-use const DIRECTORY_SEPARATOR;
-use function strpos;
-use function array_map;
 use function array_filter;
+use function array_map;
+use const DIRECTORY_SEPARATOR;
+use const E_WARNING;
+use function explode;
 use function glob;
-use function realpath;
+use function in_array;
+use function is_bool;
 use function is_dir;
-use function readlink;
-use function stripos;
-use function str_replace;
 use function preg_match;
-use function set_error_handler;
-use const E_WARNING;
-use function restore_error_handler;
 use function preg_replace;
-use function in_array;
-use function explode;
+use Psalm\Exception\ConfigException;
+use function readlink;
+use function realpath;
+use function restore_error_handler;
+use function set_error_handler;
+use SimpleXMLElement;
+use function str_replace;
+use function stripos;
+use function strpos;
+use function strtolower;
 
 class FileFilter
 {
@@ -335,8 +335,9 @@ class FileFilter
             },
             E_WARNING
         );
-        $is_regexp = preg_match($string, "") !== false;
+        $is_regexp = preg_match($string, '') !== false;
         restore_error_handler();
+
         return $is_regexp;
     }
 
@@ -425,7 +426,7 @@ class FileFilter
             }
         }
 
-        return in_array(strtolower($fq_classlike_name), $this->fq_classlike_names);
+        return in_array(strtolower($fq_classlike_name), $this->fq_classlike_names, true);
     }
 
     /**
@@ -459,7 +460,7 @@ class FileFilter
             return false;
         }
 
-        return in_array($method_id, $this->method_ids);
+        return in_array($method_id, $this->method_ids, true);
     }
 
     /**
@@ -469,7 +470,7 @@ class FileFilter
      */
     public function allowsProperty($property_id)
     {
-        return in_array(strtolower($property_id), $this->property_ids);
+        return in_array(strtolower($property_id), $this->property_ids, true);
     }
 
     /**
diff --git a/src/Psalm/Config/IssueHandler.php b/src/Psalm/Config/IssueHandler.php
index 3f79baa29..48f4e644d 100644
--- a/src/Psalm/Config/IssueHandler.php
+++ b/src/Psalm/Config/IssueHandler.php
@@ -1,14 +1,14 @@
 <?php
 namespace Psalm\Config;
 
-use SimpleXMLElement;
-use function in_array;
-use function strtolower;
 use function array_filter;
 use function array_map;
-use function substr;
-use function scandir;
 use function dirname;
+use function in_array;
+use function scandir;
+use SimpleXMLElement;
+use function strtolower;
+use function substr;
 
 class IssueHandler
 {
diff --git a/src/Psalm/Config/ProjectFileFilter.php b/src/Psalm/Config/ProjectFileFilter.php
index b8174277e..84a78436e 100644
--- a/src/Psalm/Config/ProjectFileFilter.php
+++ b/src/Psalm/Config/ProjectFileFilter.php
@@ -2,8 +2,8 @@
 namespace Psalm\Config;
 
 use SimpleXMLElement;
-use function strpos;
 use function stripos;
+use function strpos;
 
 class ProjectFileFilter extends FileFilter
 {
diff --git a/src/Psalm/Context.php b/src/Psalm/Context.php
index 3269ac327..6b2f6d094 100644
--- a/src/Psalm/Context.php
+++ b/src/Psalm/Context.php
@@ -1,23 +1,21 @@
 <?php
 namespace Psalm;
 
-use Psalm\Config;
+use function array_filter;
+use function array_keys;
+use function count;
+use function in_array;
+use function json_encode;
+use function preg_match;
+use function preg_quote;
+use function preg_replace;
 use Psalm\Internal\Analyzer\StatementsAnalyzer;
 use Psalm\Internal\Clause;
 use Psalm\Storage\FunctionLikeStorage;
 use Psalm\Type\Reconciler;
-use Psalm\Type;
 use Psalm\Type\Union;
-use function in_array;
-use function count;
-use function array_filter;
-use function preg_quote;
-use function preg_match;
 use function strpos;
-use function array_keys;
 use function strtolower;
-use function preg_replace;
-use function json_encode;
 
 class Context
 {
@@ -735,6 +733,7 @@ class Context
         foreach ($this->vars_in_scope as $k => $v) {
             $summary[$k] = $v->getId();
         }
+
         return json_encode($summary);
     }
 
diff --git a/src/Psalm/DocComment.php b/src/Psalm/DocComment.php
index b478f8e8d..2f251fffd 100644
--- a/src/Psalm/DocComment.php
+++ b/src/Psalm/DocComment.php
@@ -1,25 +1,24 @@
 <?php
-
 namespace Psalm;
 
-use Psalm\Exception\DocblockParseException;
-use function trim;
-use function preg_replace;
+use function array_filter;
 use function explode;
-use function preg_match;
-use function rtrim;
-use function str_replace;
 use function implode;
+use function in_array;
+use function min;
+use function preg_match;
 use function preg_match_all;
+use const PREG_OFFSET_CAPTURE;
+use function preg_replace;
 use const PREG_SET_ORDER;
-use function array_filter;
-use function strlen;
-use function min;
+use Psalm\Exception\DocblockParseException;
+use function rtrim;
 use function str_repeat;
-use function substr;
-use function in_array;
-use const PREG_OFFSET_CAPTURE;
+use function str_replace;
+use function strlen;
 use function strpos;
+use function substr;
+use function trim;
 
 class DocComment
 {
@@ -151,7 +150,8 @@ class DocComment
                         'override-method-visibility', 'seal-properties', 'seal-methods',
                         'generator-return', 'ignore-falsable-return', 'variadic',
                         'ignore-variable-method', 'ignore-variable-property', 'internal',
-                    ]
+                    ],
+                    true
                 )) {
                     throw new DocblockParseException('Unrecognised annotation @psalm-' . $special_key);
                 }
@@ -271,7 +271,8 @@ class DocComment
                         'override-method-visibility', 'seal-properties', 'seal-methods',
                         'generator-return', 'ignore-falsable-return', 'variadic',
                         'ignore-variable-method', 'ignore-variable-property', 'internal',
-                    ]
+                    ],
+                    true
                 )) {
                     throw new DocblockParseException('Unrecognised annotation @psalm-' . $special_key);
                 }
diff --git a/src/Psalm/ErrorBaseline.php b/src/Psalm/ErrorBaseline.php
index 5df373545..5ee11ae54 100644
--- a/src/Psalm/ErrorBaseline.php
+++ b/src/Psalm/ErrorBaseline.php
@@ -1,29 +1,30 @@
 <?php
 namespace Psalm;
 
-use Psalm\Internal\Provider\FileProvider;
-use RuntimeException;
-use function array_reduce;
-use const LIBXML_NOBLANKS;
-use function str_replace;
-use function min;
-use function array_intersect;
 use function array_filter;
-use function strpos;
-use function ksort;
+use function array_intersect;
+use function array_map;
 use function array_merge;
+use function array_reduce;
+use function explode;
 use function get_loaded_extensions;
-use function usort;
 use function implode;
+use function ksort;
+use const LIBXML_NOBLANKS;
+use function min;
+use const PHP_VERSION;
 use function phpversion;
-use function array_map;
 use function preg_replace_callback;
-use function explode;
+use Psalm\Internal\Provider\FileProvider;
+use function str_replace;
+use function strpos;
+use function usort;
 
 class ErrorBaseline
 {
     /**
      * @param array<string,array<string,array{o:int, s:array<int, string>}>> $existingIssues
+     *
      * @return int
      */
     public static function countTotalIssues(array $existingIssues)
@@ -60,8 +61,10 @@ class ErrorBaseline
     /**
      * @param FileProvider $fileProvider
      * @param string $baselineFile
-     * @return array<string,array<string,array{o:int, s:array<int, string>}>>
+     *
      * @throws Exception\ConfigException
+     *
+     * @return array<string,array<string,array{o:int, s:array<int, string>}>>
      */
     public static function read(FileProvider $fileProvider, string $baselineFile): array
     {
@@ -118,8 +121,10 @@ class ErrorBaseline
      * @param FileProvider $fileProvider
      * @param string $baselineFile
      * @param array<array{file_name: string, type: string, severity: string, selected_text: string}> $issues
-     * @return array<string,array<string,array{o:int, s:array<int, string>}>>
+     *
      * @throws Exception\ConfigException
+     *
+     * @return array<string,array<string,array{o:int, s:array<int, string>}>>
      */
     public static function update(FileProvider $fileProvider, string $baselineFile, array $issues)
     {
@@ -160,6 +165,7 @@ class ErrorBaseline
 
     /**
      * @param array<array{file_name: string, type: string, severity: string, selected_text: string}> $issues
+     *
      * @return array<string,array<string,array{o:int, s:array<int, string>}>>
      */
     private static function countIssueTypesByFile(array $issues): array
@@ -169,6 +175,7 @@ class ErrorBaseline
             /**
              * @param array<string,array<string,array{o:int, s:array<int, string>}>> $carry
              * @param array{type: string, file_name: string, severity: string, selected_text: string} $issue
+             *
              * @return array<string,array<string,array{o:int, s:array<int, string>}>>
              */
             function (array $carry, array $issue): array {
@@ -188,7 +195,7 @@ class ErrorBaseline
                     $carry[$fileName][$issueType] = ['o' => 0, 's' => []];
                 }
 
-                $carry[$fileName][$issueType]['o']++;
+                ++$carry[$fileName][$issueType]['o'];
 
                 if (!strpos($issue['selected_text'], "\n")) {
                     $carry[$fileName][$issueType]['s'][] = $issue['selected_text'];
@@ -213,6 +220,7 @@ class ErrorBaseline
      * @param FileProvider $fileProvider
      * @param string $baselineFile
      * @param array<string,array<string,array{o:int, s:array<int, string>}>> $groupedIssues
+     *
      * @return void
      */
     private static function writeToFile(
@@ -230,7 +238,7 @@ class ErrorBaseline
 
         $filesNode->setAttribute('php-version', implode(';' . "\n\t", array_merge(
             [
-                ('php:' . phpversion()),
+                ('php:' . PHP_VERSION),
             ],
             array_map(
                 function (string $extension) : string {
diff --git a/src/Psalm/FileBasedPluginAdapter.php b/src/Psalm/FileBasedPluginAdapter.php
index 6b42a2e14..934a6229d 100644
--- a/src/Psalm/FileBasedPluginAdapter.php
+++ b/src/Psalm/FileBasedPluginAdapter.php
@@ -3,8 +3,8 @@ namespace Psalm;
 
 use Psalm\Internal\Analyzer\ClassLikeAnalyzer;
 use Psalm\Internal\Scanner\FileScanner;
-use SimpleXMLElement;
 use function reset;
+use SimpleXMLElement;
 
 class FileBasedPluginAdapter implements Plugin\PluginEntryPointInterface
 {
@@ -30,8 +30,10 @@ class FileBasedPluginAdapter implements Plugin\PluginEntryPointInterface
 
     /**
      * @psalm-suppress PossiblyUnusedParam
+     *
      * @param  Plugin\RegistrationInterface $registration
      * @param  SimpleXMLElement|null        $config
+     *
      * @return  void
      */
     public function __invoke(Plugin\RegistrationInterface $registration, SimpleXMLElement $config = null)
diff --git a/src/Psalm/FileManipulation.php b/src/Psalm/FileManipulation.php
index aedf25e32..ff8990fe4 100644
--- a/src/Psalm/FileManipulation.php
+++ b/src/Psalm/FileManipulation.php
@@ -2,8 +2,8 @@
 namespace Psalm;
 
 use function sha1;
-use function strrpos;
 use function strlen;
+use function strrpos;
 use function substr;
 use function trim;
 
diff --git a/src/Psalm/Internal/Clause.php b/src/Psalm/Internal/Clause.php
index db35296d5..efef880ca 100644
--- a/src/Psalm/Internal/Clause.php
+++ b/src/Psalm/Internal/Clause.php
@@ -1,18 +1,17 @@
 <?php
 namespace Psalm\Internal;
 
-use function count;
 use function array_diff;
-use function ksort;
-use function sort;
+use function array_keys;
+use function array_map;
+use function array_values;
+use function count;
+use function implode;
 use function json_encode;
-use function rand;
+use function ksort;
 use function md5;
+use function sort;
 use function spl_object_hash;
-use function implode;
-use function array_map;
-use function array_keys;
-use function array_values;
 
 /**
  * @internal
@@ -110,7 +109,7 @@ class Clause
 
         $possibility_string = json_encode($this->possibilities);
         if (!$possibility_string) {
-            return (string)rand(0, 10000000);
+            return (string) \mt_rand(0, 10000000);
         }
 
         return md5($possibility_string) .
diff --git a/src/Psalm/Internal/Codebase/Analyzer.php b/src/Psalm/Internal/Codebase/Analyzer.php
index 147aab7e7..1364f4d83 100644
--- a/src/Psalm/Internal/Codebase/Analyzer.php
+++ b/src/Psalm/Internal/Codebase/Analyzer.php
@@ -1,28 +1,28 @@
 <?php
 namespace Psalm\Internal\Codebase;
 
+use function array_filter;
+use function array_intersect_key;
+use function array_merge;
+use function array_merge_recursive;
+use function count;
+use function explode;
+use function number_format;
+use function pathinfo;
 use PhpParser;
-use Psalm\Internal\Analyzer\FileAnalyzer;
-use Psalm\Internal\Analyzer\ProjectAnalyzer;
+use function preg_replace;
 use Psalm\Config;
 use Psalm\FileManipulation;
+use Psalm\Internal\Analyzer\FileAnalyzer;
+use Psalm\Internal\Analyzer\ProjectAnalyzer;
 use Psalm\Internal\FileManipulation\FileManipulationBuffer;
 use Psalm\Internal\FileManipulation\FunctionDocblockManipulator;
-use Psalm\IssueBuffer;
 use Psalm\Internal\Provider\FileProvider;
 use Psalm\Internal\Provider\FileStorageProvider;
+use Psalm\IssueBuffer;
 use Psalm\Progress\Progress;
-use function pathinfo;
-use function count;
-use function array_merge;
-use function array_filter;
-use function preg_replace;
-use function substr;
 use function strpos;
-use function explode;
-use function array_merge_recursive;
-use function array_intersect_key;
-use function number_format;
+use function substr;
 use function usort;
 
 /**
@@ -330,18 +330,14 @@ class Analyzer
 
                     $this->progress->debug('Gathering data for forked process' . "\n");
 
+                    // @codingStandardsIgnoreStart
                     return [
                         'issues' => IssueBuffer::getIssuesData(),
-                        'file_references_to_classes'
-                            => $file_reference_provider->getAllFileReferencesToClasses(),
-                        'file_references_to_class_members'
-                            => $file_reference_provider->getAllFileReferencesToClassMembers(),
-                        'method_references_to_class_members'
-                            => $file_reference_provider->getAllMethodReferencesToClassMembers(),
-                        'file_references_to_missing_class_members'
-                            => $file_reference_provider->getAllFileReferencesToMissingClassMembers(),
-                        'method_references_to_missing_class_members'
-                            => $file_reference_provider->getAllMethodReferencesToMissingClassMembers(),
+                        'file_references_to_classes' => $file_reference_provider->getAllFileReferencesToClasses(),
+                        'file_references_to_class_members' => $file_reference_provider->getAllFileReferencesToClassMembers(),
+                        'method_references_to_class_members' => $file_reference_provider->getAllMethodReferencesToClassMembers(),
+                        'file_references_to_missing_class_members' => $file_reference_provider->getAllFileReferencesToMissingClassMembers(),
+                        'method_references_to_missing_class_members' => $file_reference_provider->getAllMethodReferencesToMissingClassMembers(),
                         'method_param_uses' => $file_reference_provider->getAllMethodParamUses(),
                         'mixed_member_names' => $analyzer->getMixedMemberNames(),
                         'file_manipulations' => FileManipulationBuffer::getAll(),
@@ -353,6 +349,7 @@ class Analyzer
                         'class_property_locations' => $file_reference_provider->getAllClassPropertyLocations(),
                         'possible_method_param_types' => $analyzer->getPossibleMethodParamTypes(),
                     ];
+                    // @codingStandardsIgnoreEnd
                 },
                 $task_done_closure
             );
@@ -611,12 +608,14 @@ class Analyzer
                     );
                 }
 
-                unset($method_references_to_class_members[$member_id]);
-                unset($file_references_to_class_members[$member_id]);
-                unset($method_references_to_missing_class_members[$member_id]);
-                unset($file_references_to_missing_class_members[$member_id]);
-                unset($references_to_mixed_member_names[$member_id]);
-                unset($method_param_uses[$member_id]);
+                unset(
+                    $method_references_to_class_members[$member_id],
+                    $file_references_to_class_members[$member_id],
+                    $method_references_to_missing_class_members[$member_id],
+                    $file_references_to_missing_class_members[$member_id],
+                    $references_to_mixed_member_names[$member_id],
+                    $method_param_uses[$member_id]
+                );
 
                 $member_stub = preg_replace('/::.*$/', '::*', $member_id);
 
@@ -699,49 +698,49 @@ class Analyzer
         $method_references_to_class_members = array_filter(
             $method_references_to_class_members,
             function (array $a) : bool {
-                return !!$a;
+                return (bool)$a;
             }
         );
 
         $method_references_to_missing_class_members = array_filter(
             $method_references_to_missing_class_members,
             function (array $a) : bool {
-                return !!$a;
+                return (bool)$a;
             }
         );
 
         $file_references_to_class_members = array_filter(
             $file_references_to_class_members,
             function (array $a) : bool {
-                return !!$a;
+                return (bool)$a;
             }
         );
 
         $file_references_to_missing_class_members = array_filter(
             $file_references_to_missing_class_members,
             function (array $a) : bool {
-                return !!$a;
+                return (bool)$a;
             }
         );
 
         $references_to_mixed_member_names = array_filter(
             $references_to_mixed_member_names,
             function (array $a) : bool {
-                return !!$a;
+                return (bool)$a;
             }
         );
 
         $file_references_to_classes = array_filter(
             $file_references_to_classes,
             function (array $a) : bool {
-                return !!$a;
+                return (bool)$a;
             }
         );
 
         $method_param_uses = array_filter(
             $method_param_uses,
             function (array $a) : bool {
-                return !!$a;
+                return (bool)$a;
             }
         );
 
@@ -776,6 +775,7 @@ class Analyzer
 
     /**
      * @param array<string, array<int, array{int, int, int, int}>> $diff_map
+     *
      * @return void
      */
     public function shiftFileOffsets(array $diff_map)
@@ -849,7 +849,7 @@ class Analyzer
                         unset($reference_map[$reference_from]);
                         $reference_map[$reference_from += $file_offset] = [
                             $reference_to += $file_offset,
-                            $tag
+                            $tag,
                         ];
                     }
                 }
@@ -876,13 +876,12 @@ class Analyzer
                     continue;
                 }
 
-
                 foreach ($file_diff_map as list($from, $to, $file_offset)) {
                     if ($type_from >= $from && $type_from <= $to) {
                         unset($type_map[$type_from]);
                         $type_map[$type_from += $file_offset] = [
                             $type_to += $file_offset,
-                            $tag
+                            $tag,
                         ];
                     }
                 }
@@ -909,7 +908,6 @@ class Analyzer
                     continue;
                 }
 
-
                 foreach ($file_diff_map as list($from, $to, $file_offset)) {
                     if ($argument_from >= $from && $argument_from <= $to) {
                         unset($argument_map[$argument_from]);
@@ -947,6 +945,7 @@ class Analyzer
 
     /**
      * @param array<string, array<string, bool>> $names
+     *
      * @return void
      * @psalm-suppress MixedPropertyTypeCoercion
      */
@@ -1041,7 +1040,7 @@ class Analyzer
     ) {
         $this->type_map[$file_path][(int)$node->getAttribute('startFilePos')] = [
             ($parent_node ? (int)$parent_node->getAttribute('endFilePos') : (int)$node->getAttribute('endFilePos')) + 1,
-            $node_type
+            $node_type,
         ];
     }
 
@@ -1055,7 +1054,7 @@ class Analyzer
         $this->argument_map[$file_path][$start_position] = [
             $end_position,
             $reference,
-            $argument_number
+            $argument_number,
         ];
     }
 
@@ -1066,7 +1065,7 @@ class Analyzer
     {
         $this->reference_map[$file_path][(int)$node->getAttribute('startFilePos')] = [
             (int)$node->getAttribute('endFilePos') + 1,
-            $reference
+            $reference,
         ];
     }
 
@@ -1077,7 +1076,7 @@ class Analyzer
     {
         $this->reference_map[$file_path][$start] = [
             $end,
-            $reference
+            $reference,
         ];
     }
 
diff --git a/src/Psalm/Internal/Codebase/CallMap.php b/src/Psalm/Internal/Codebase/CallMap.php
index a334944fa..a4a1ca178 100644
--- a/src/Psalm/Internal/Codebase/CallMap.php
+++ b/src/Psalm/Internal/Codebase/CallMap.php
@@ -1,17 +1,17 @@
 <?php
 namespace Psalm\Internal\Codebase;
 
+use function array_shift;
+use function assert;
+use function count;
 use PhpParser;
 use Psalm\Codebase;
 use Psalm\Internal\Analyzer\ProjectAnalyzer;
 use Psalm\Internal\Analyzer\TypeAnalyzer;
+use Psalm\Storage\FunctionLikeParameter;
 use Psalm\Type;
 use Psalm\Type\Atomic\TCallable;
-use Psalm\Storage\FunctionLikeParameter;
-use function count;
-use function assert;
 use function strtolower;
-use function array_shift;
 use function substr;
 
 /**
@@ -291,7 +291,7 @@ class CallMap
         }
 
         if ($analyzer_minor_version < self::PHP_MINOR_VERSION) {
-            for ($i = self::PHP_MINOR_VERSION; $i > $analyzer_minor_version; $i--) {
+            for ($i = self::PHP_MINOR_VERSION; $i > $analyzer_minor_version; --$i) {
                 /**
                  * @var array{
                  *     old: array<string, array<int|string, string>>,
diff --git a/src/Psalm/Internal/Codebase/ClassLikes.php b/src/Psalm/Internal/Codebase/ClassLikes.php
index d5481d6ac..3b664dc0c 100644
--- a/src/Psalm/Internal/Codebase/ClassLikes.php
+++ b/src/Psalm/Internal/Codebase/ClassLikes.php
@@ -1,13 +1,25 @@
 <?php
 namespace Psalm\Internal\Codebase;
 
+use function array_merge;
+use function array_pop;
+use function end;
+use function explode;
+use function get_declared_classes;
+use function get_declared_interfaces;
+use function implode;
+use const PHP_EOL;
 use PhpParser;
+use function preg_match;
+use function preg_replace;
 use Psalm\Aliases;
-use Psalm\Exception\UnpopulatedClasslikeException;
-use Psalm\Internal\Analyzer\ClassLikeAnalyzer;
 use Psalm\CodeLocation;
 use Psalm\Config;
+use Psalm\Exception\UnpopulatedClasslikeException;
+use Psalm\Internal\Analyzer\ClassLikeAnalyzer;
 use Psalm\Internal\FileManipulation\FileManipulationBuffer;
+use Psalm\Internal\Provider\ClassLikeStorageProvider;
+use Psalm\Internal\Provider\FileReferenceProvider;
 use Psalm\Issue\PossiblyUnusedMethod;
 use Psalm\Issue\PossiblyUnusedParam;
 use Psalm\Issue\PossiblyUnusedProperty;
@@ -15,27 +27,15 @@ use Psalm\Issue\UnusedClass;
 use Psalm\Issue\UnusedMethod;
 use Psalm\Issue\UnusedProperty;
 use Psalm\IssueBuffer;
-use Psalm\Internal\Provider\ClassLikeStorageProvider;
-use Psalm\Internal\Provider\FileReferenceProvider;
 use Psalm\Progress\Progress;
 use Psalm\Progress\VoidProgress;
 use Psalm\Storage\ClassLikeStorage;
 use Psalm\Type;
 use ReflectionProperty;
-use function get_declared_classes;
-use function preg_replace;
+use function strlen;
+use function strrpos;
 use function strtolower;
-use function get_declared_interfaces;
 use function substr;
-use function preg_match;
-use const PHP_EOL;
-use function explode;
-use function strrpos;
-use function strlen;
-use function array_pop;
-use function implode;
-use function end;
-use function array_merge;
 
 /**
  * @internal
@@ -465,9 +465,10 @@ class ClassLikes
      * @param  string       $fq_class_name
      * @param  string       $possible_parent
      *
-     * @return bool
      * @throws UnpopulatedClasslikeException when called on unpopulated class
      * @throws \InvalidArgumentException when class does not exist
+     *
+     * @return bool
      */
     public function classExtends($fq_class_name, $possible_parent, bool $from_api = false)
     {
@@ -798,7 +799,7 @@ class ClassLikes
                             $old_method_name_bounds[0],
                             $old_method_name_bounds[1],
                             $destination_name
-                        )
+                        ),
                     ]
                 );
 
@@ -809,7 +810,7 @@ class ClassLikes
                 if (!$insert_pos) {
                     $insert_pos = strlen($selection) - 1;
                 } else {
-                    $insert_pos++;
+                    ++$insert_pos;
                 }
 
                 $code_migrations[] = new \Psalm\Internal\FileManipulation\CodeMigration(
@@ -899,7 +900,7 @@ class ClassLikes
                             $old_property_name_bounds[0],
                             $old_property_name_bounds[1],
                             '$' . $destination_name
-                        )
+                        ),
                     ]
                 );
 
@@ -910,7 +911,7 @@ class ClassLikes
                 if (!$insert_pos) {
                     $insert_pos = strlen($selection) - 1;
                 } else {
-                    $insert_pos++;
+                    ++$insert_pos;
                 }
 
                 $code_migrations[] = new \Psalm\Internal\FileManipulation\CodeMigration(
@@ -972,7 +973,7 @@ class ClassLikes
                             $old_const_name_bounds[0],
                             $old_const_name_bounds[1],
                             $destination_name
-                        )
+                        ),
                     ]
                 );
 
@@ -983,7 +984,7 @@ class ClassLikes
                 if (!$insert_pos) {
                     $insert_pos = strlen($selection) - 1;
                 } else {
-                    $insert_pos++;
+                    ++$insert_pos;
                 }
 
                 $code_migrations[] = new \Psalm\Internal\FileManipulation\CodeMigration(
@@ -1869,7 +1870,7 @@ class ClassLikes
      */
     public function addThreadData(array $thread_data)
     {
-        list (
+        list(
             $existing_classlikes_lc,
             $existing_classes_lc,
             $existing_traits_lc,
@@ -1878,8 +1879,7 @@ class ClassLikes
             $existing_interfaces,
             $existing_classes,
             $trait_nodes,
-            $trait_aliases,
-        ) = $thread_data;
+            $trait_aliases) = $thread_data;
 
         $this->existing_classlikes_lc = array_merge($existing_classlikes_lc, $this->existing_classlikes_lc);
         $this->existing_classes_lc = array_merge($existing_classes_lc, $this->existing_classes_lc);
diff --git a/src/Psalm/Internal/Codebase/Functions.php b/src/Psalm/Internal/Codebase/Functions.php
index a7df8d9b2..b01d55c3f 100644
--- a/src/Psalm/Internal/Codebase/Functions.php
+++ b/src/Psalm/Internal/Codebase/Functions.php
@@ -1,22 +1,20 @@
 <?php
 namespace Psalm\Internal\Codebase;
 
+use function array_shift;
+use function explode;
+use function implode;
 use Psalm\Codebase;
 use Psalm\Internal\Analyzer\StatementsAnalyzer;
-use Psalm\Internal\Provider\{
-    FileStorageProvider,
-    FunctionReturnTypeProvider,
-    FunctionExistenceProvider,
-    FunctionParamsProvider
-};
+use Psalm\Internal\Provider\FileStorageProvider;
+use Psalm\Internal\Provider\FunctionExistenceProvider;
+use Psalm\Internal\Provider\FunctionParamsProvider;
+use Psalm\Internal\Provider\FunctionReturnTypeProvider;
 use Psalm\StatementsSource;
 use Psalm\Storage\FunctionLikeStorage;
+use function strpos;
 use function strtolower;
 use function substr;
-use function strpos;
-use function explode;
-use function array_shift;
-use function implode;
 
 /**
  * @internal
diff --git a/src/Psalm/Internal/Codebase/Methods.php b/src/Psalm/Internal/Codebase/Methods.php
index 4305a51fb..a263288cd 100644
--- a/src/Psalm/Internal/Codebase/Methods.php
+++ b/src/Psalm/Internal/Codebase/Methods.php
@@ -1,31 +1,28 @@
 <?php
 namespace Psalm\Internal\Codebase;
 
+use function array_pop;
+use function assert;
+use function count;
+use function explode;
 use PhpParser;
+use function preg_replace;
 use Psalm\Codebase;
 use Psalm\CodeLocation;
 use Psalm\Context;
-use Psalm\Internal\Analyzer\FunctionLikeAnalyzer;
-use Psalm\Internal\Provider\{
-    ClassLikeStorageProvider,
-    FileReferenceProvider,
-    MethodReturnTypeProvider,
-    MethodExistenceProvider,
-    MethodParamsProvider,
-    MethodVisibilityProvider
-};
+use Psalm\Internal\Provider\ClassLikeStorageProvider;
+use Psalm\Internal\Provider\FileReferenceProvider;
+use Psalm\Internal\Provider\MethodExistenceProvider;
+use Psalm\Internal\Provider\MethodParamsProvider;
+use Psalm\Internal\Provider\MethodReturnTypeProvider;
+use Psalm\Internal\Provider\MethodVisibilityProvider;
 use Psalm\StatementsSource;
 use Psalm\Storage\ClassLikeStorage;
 use Psalm\Storage\FunctionLikeParameter;
 use Psalm\Storage\MethodStorage;
 use Psalm\Type;
-use function preg_replace;
-use function explode;
-use function strtolower;
-use function array_pop;
-use function count;
-use function assert;
 use function reset;
+use function strtolower;
 
 /**
  * @internal
diff --git a/src/Psalm/Internal/Codebase/Populator.php b/src/Psalm/Internal/Codebase/Populator.php
index d7cc4ca28..adb690db3 100644
--- a/src/Psalm/Internal/Codebase/Populator.php
+++ b/src/Psalm/Internal/Codebase/Populator.php
@@ -1,26 +1,26 @@
 <?php
 namespace Psalm\Internal\Codebase;
 
+use function array_keys;
+use function array_merge;
+use function count;
+use function explode;
+use function is_int;
+use Psalm\Config;
 use Psalm\Internal\Analyzer\ClassLikeAnalyzer;
 use Psalm\Internal\Analyzer\TypeAnalyzer;
-use Psalm\Config;
-use Psalm\Issue\CircularReference;
-use Psalm\IssueBuffer;
 use Psalm\Internal\Provider\ClassLikeStorageProvider;
 use Psalm\Internal\Provider\FileReferenceProvider;
 use Psalm\Internal\Provider\FileStorageProvider;
+use Psalm\Issue\CircularReference;
+use Psalm\IssueBuffer;
 use Psalm\Progress\Progress;
 use Psalm\Storage\ClassLikeStorage;
 use Psalm\Storage\FileStorage;
 use Psalm\Type;
-use function strtolower;
-use function strpos;
-use function explode;
-use function count;
-use function array_keys;
-use function is_int;
-use function array_merge;
 use function reset;
+use function strpos;
+use function strtolower;
 
 /**
  * @internal
diff --git a/src/Psalm/Internal/Codebase/Properties.php b/src/Psalm/Internal/Codebase/Properties.php
index e8e97947e..bb4f9a9f9 100644
--- a/src/Psalm/Internal/Codebase/Properties.php
+++ b/src/Psalm/Internal/Codebase/Properties.php
@@ -1,19 +1,17 @@
 <?php
 namespace Psalm\Internal\Codebase;
 
+use function explode;
+use function preg_replace;
 use Psalm\CodeLocation;
 use Psalm\Context;
-use Psalm\Internal\Provider\{
-    ClassLikeStorageProvider,
-    FileReferenceProvider,
-    PropertyExistenceProvider,
-    PropertyTypeProvider,
-    PropertyVisibilityProvider
-};
+use Psalm\Internal\Provider\ClassLikeStorageProvider;
+use Psalm\Internal\Provider\FileReferenceProvider;
+use Psalm\Internal\Provider\PropertyExistenceProvider;
+use Psalm\Internal\Provider\PropertyTypeProvider;
+use Psalm\Internal\Provider\PropertyVisibilityProvider;
 use Psalm\StatementsSource;
 use Psalm\Type;
-use function preg_replace;
-use function explode;
 use function strtolower;
 
 /**
@@ -200,6 +198,7 @@ class Properties
 
     /**
      * @param  string $property_id
+     *
      * @return  \Psalm\Storage\PropertyStorage
      */
     public function getStorage($property_id)
@@ -225,6 +224,7 @@ class Properties
 
     /**
      * @param  string $property_id
+     *
      * @return  ?Type\Union
      */
     public function getPropertyType(
diff --git a/src/Psalm/Internal/Codebase/Reflection.php b/src/Psalm/Internal/Codebase/Reflection.php
index 936043f4e..7475f3796 100644
--- a/src/Psalm/Internal/Codebase/Reflection.php
+++ b/src/Psalm/Internal/Codebase/Reflection.php
@@ -1,9 +1,9 @@
 <?php
 namespace Psalm\Internal\Codebase;
 
-use Psalm\Internal\Analyzer\ClassLikeAnalyzer;
-use Psalm\Internal\Analyzer\FunctionLikeAnalyzer;
+use function array_merge;
 use Psalm\Codebase;
+use Psalm\Internal\Analyzer\ClassLikeAnalyzer;
 use Psalm\Internal\Provider\ClassLikeStorageProvider;
 use Psalm\Storage\FunctionLikeParameter;
 use Psalm\Storage\FunctionLikeStorage;
@@ -11,7 +11,6 @@ use Psalm\Storage\MethodStorage;
 use Psalm\Storage\PropertyStorage;
 use Psalm\Type;
 use function strtolower;
-use function array_merge;
 
 /**
  * @internal
diff --git a/src/Psalm/Internal/Codebase/Scanner.php b/src/Psalm/Internal/Codebase/Scanner.php
index 74c52ef3f..34a2993db 100644
--- a/src/Psalm/Internal/Codebase/Scanner.php
+++ b/src/Psalm/Internal/Codebase/Scanner.php
@@ -1,6 +1,17 @@
 <?php
 namespace Psalm\Internal\Codebase;
 
+use function array_filter;
+use function array_merge;
+use function array_pop;
+use function ceil;
+use function count;
+use const DIRECTORY_SEPARATOR;
+use function error_reporting;
+use function explode;
+use function file_exists;
+use function min;
+use const PHP_EOL;
 use Psalm\Codebase;
 use Psalm\Config;
 use Psalm\Internal\Provider\FileProvider;
@@ -8,20 +19,9 @@ use Psalm\Internal\Provider\FileReferenceProvider;
 use Psalm\Internal\Provider\FileStorageProvider;
 use Psalm\Internal\Scanner\FileScanner;
 use Psalm\Progress\Progress;
-use function substr;
-use function strtolower;
-use function array_filter;
-use function count;
-use function ceil;
-use function min;
-use const PHP_EOL;
-use function explode;
-use const DIRECTORY_SEPARATOR;
-use function array_pop;
-use function file_exists;
 use function realpath;
-use function error_reporting;
-use function array_merge;
+use function strtolower;
+use function substr;
 
 /**
  * @psalm-type  IssueData = array{
@@ -238,12 +238,15 @@ class Scanner
 
     /**
      * @param  string $fq_classlike_name_lc
+     *
      * @return void
      */
     public function removeClassLike($fq_classlike_name_lc)
     {
-        unset($this->classlike_files[$fq_classlike_name_lc]);
-        unset($this->deep_scanned_classlike_files[$fq_classlike_name_lc]);
+        unset(
+            $this->classlike_files[$fq_classlike_name_lc],
+            $this->deep_scanned_classlike_files[$fq_classlike_name_lc]
+        );
     }
 
     /**
@@ -345,6 +348,7 @@ class Scanner
                 $this->convertClassesToFilePaths($classlikes);
             }
         }
+
         return $has_changes;
     }
 
@@ -422,7 +426,7 @@ class Scanner
                 $scanner_worker,
                 /**
                  * @return PoolData
-                */
+                 */
                 function () {
                     $this->progress->debug('Collecting data from forked scanner process' . PHP_EOL);
 
@@ -794,7 +798,7 @@ class Scanner
             $this->classlike_files,
             $this->deep_scanned_classlike_files,
             $this->scanned_files,
-            $this->reflected_classlikes_lc
+            $this->reflected_classlikes_lc,
         ];
     }
 
diff --git a/src/Psalm/Internal/Diff/AstDiffer.php b/src/Psalm/Internal/Diff/AstDiffer.php
index cb0d04dc3..867e6529e 100644
--- a/src/Psalm/Internal/Diff/AstDiffer.php
+++ b/src/Psalm/Internal/Diff/AstDiffer.php
@@ -1,9 +1,9 @@
-<?php declare(strict_types=1);
-
+<?php
+declare(strict_types=1);
 namespace Psalm\Internal\Diff;
 
-use PhpParser;
 use function array_reverse;
+use PhpParser;
 
 /**
  * Borrows from https://github.com/nikic/PHP-Parser/blob/master/lib/PhpParser/Internal/Differ.php
@@ -21,6 +21,7 @@ class AstDiffer
      * @param  \Closure(PhpParser\Node\Stmt, PhpParser\Node\Stmt, string, string, bool=) : bool $is_equal
      * @param  array<int, PhpParser\Node\Stmt> $a
      * @param  array<int, PhpParser\Node\Stmt> $b
+     *
      * @return array{0:array<int, array<int, int>>, 1: int, 2: int, 3: array<int, bool>}
      */
     protected static function calculateTrace(
@@ -36,13 +37,13 @@ class AstDiffer
         $v = [1 => 0];
         $bc = [];
         $trace = [];
-        for ($d = 0; $d <= $max; $d++) {
+        for ($d = 0; $d <= $max; ++$d) {
             $trace[] = $v;
             for ($k = -$d; $k <= $d; $k += 2) {
-                if ($k === -$d || ($k !== $d && $v[$k-1] < $v[$k+1])) {
-                    $x = $v[$k+1];
+                if ($k === -$d || ($k !== $d && $v[$k - 1] < $v[$k + 1])) {
+                    $x = $v[$k + 1];
                 } else {
-                    $x = $v[$k-1] + 1;
+                    $x = $v[$k - 1] + 1;
                 }
 
                 $y = $x - $k;
@@ -52,8 +53,8 @@ class AstDiffer
                 while ($x < $n && $y < $m && ($is_equal)($a[$x], $b[$y], $a_code, $b_code, $body_change)) {
                     /** @var bool */
                     $bc[$x] = $body_change;
-                    $x++;
-                    $y++;
+                    ++$x;
+                    ++$y;
 
                     $body_change = false;
                 }
@@ -74,16 +75,17 @@ class AstDiffer
      * @param array<int, PhpParser\Node\Stmt> $a
      * @param array<int, PhpParser\Node\Stmt> $b
      * @param array<int, bool> $bc
+     *
      * @return DiffElem[]
      */
     protected static function extractDiff(array $trace, $x, $y, array $a, array $b, array $bc) : array
     {
         $result = [];
-        for ($d = \count($trace) - 1; $d >= 0; $d--) {
+        for ($d = \count($trace) - 1; $d >= 0; --$d) {
             $v = $trace[$d];
             $k = $x - $y;
 
-            if ($k === -$d || ($k !== $d && $v[$k-1] < $v[$k+1])) {
+            if ($k === -$d || ($k !== $d && $v[$k - 1] < $v[$k + 1])) {
                 $prevK = $k + 1;
             } else {
                 $prevK = $k - 1;
@@ -94,12 +96,12 @@ class AstDiffer
 
             while ($x > $prevX && $y > $prevY) {
                 $result[] = new DiffElem(
-                    $bc[$x-1] ? DiffElem::TYPE_KEEP_SIGNATURE : DiffElem::TYPE_KEEP,
-                    $a[$x-1],
-                    $b[$y-1]
+                    $bc[$x - 1] ? DiffElem::TYPE_KEEP_SIGNATURE : DiffElem::TYPE_KEEP,
+                    $a[$x - 1],
+                    $b[$y - 1]
                 );
-                $x--;
-                $y--;
+                --$x;
+                --$y;
             }
 
             if ($d === 0) {
@@ -107,15 +109,16 @@ class AstDiffer
             }
 
             while ($x > $prevX) {
-                $result[] = new DiffElem(DiffElem::TYPE_REMOVE, $a[$x-1], null);
-                $x--;
+                $result[] = new DiffElem(DiffElem::TYPE_REMOVE, $a[$x - 1], null);
+                --$x;
             }
 
             while ($y > $prevY) {
-                $result[] = new DiffElem(DiffElem::TYPE_ADD, null, $b[$y-1]);
-                $y--;
+                $result[] = new DiffElem(DiffElem::TYPE_ADD, null, $b[$y - 1]);
+                --$y;
             }
         }
+
         return array_reverse($result);
     }
 }
diff --git a/src/Psalm/Internal/Diff/ClassStatementsDiffer.php b/src/Psalm/Internal/Diff/ClassStatementsDiffer.php
index c2d0a86d4..ab3da70fb 100644
--- a/src/Psalm/Internal/Diff/ClassStatementsDiffer.php
+++ b/src/Psalm/Internal/Diff/ClassStatementsDiffer.php
@@ -1,14 +1,13 @@
 <?php
-
 namespace Psalm\Internal\Diff;
 
-use PhpParser;
+use function count;
 use function get_class;
-use function substr;
-use function trim;
+use PhpParser;
 use function strpos;
-use function count;
 use function strtolower;
+use function substr;
+use function trim;
 
 /**
  * @internal
@@ -232,7 +231,7 @@ class ClassStatementsDiffer extends AstDiffer
                     }
                 }
             }
-        };
+        }
 
         return [$keep, $keep_signature, $add_or_delete, $diff_map];
     }
diff --git a/src/Psalm/Internal/Diff/DiffElem.php b/src/Psalm/Internal/Diff/DiffElem.php
index 2403cc458..7b607c627 100644
--- a/src/Psalm/Internal/Diff/DiffElem.php
+++ b/src/Psalm/Internal/Diff/DiffElem.php
@@ -1,5 +1,5 @@
-<?php declare(strict_types=1);
-
+<?php
+declare(strict_types=1);
 namespace Psalm\Internal\Diff;
 
 /**
diff --git a/src/Psalm/Internal/Diff/FileDiffer.php b/src/Psalm/Internal/Diff/FileDiffer.php
index 9ae5455c4..f7af5855b 100644
--- a/src/Psalm/Internal/Diff/FileDiffer.php
+++ b/src/Psalm/Internal/Diff/FileDiffer.php
@@ -1,11 +1,11 @@
-<?php declare(strict_types=1);
-
+<?php
+declare(strict_types=1);
 namespace Psalm\Internal\Diff;
 
 use function array_reverse;
 use function explode;
-use function strlen;
 use function min;
+use function strlen;
 use function substr;
 
 /**
@@ -23,6 +23,7 @@ class FileDiffer
     /**
      * @param  array<int, string>    $a
      * @param  array<int, string>    $b
+     *
      * @return array{0:array<int, array<int, int>>, 1: int, 2: int}
      */
     private static function calculateTrace(
@@ -34,20 +35,20 @@ class FileDiffer
         $max = $n + $m;
         $v = [1 => 0];
         $trace = [];
-        for ($d = 0; $d <= $max; $d++) {
+        for ($d = 0; $d <= $max; ++$d) {
             $trace[] = $v;
             for ($k = -$d; $k <= $d; $k += 2) {
-                if ($k === -$d || ($k !== $d && $v[$k-1] < $v[$k+1])) {
-                    $x = $v[$k+1];
+                if ($k === -$d || ($k !== $d && $v[$k - 1] < $v[$k + 1])) {
+                    $x = $v[$k + 1];
                 } else {
-                    $x = $v[$k-1] + 1;
+                    $x = $v[$k - 1] + 1;
                 }
 
                 $y = $x - $k;
 
                 while ($x < $n && $y < $m && $a[$x] === $b[$y]) {
-                    $x++;
-                    $y++;
+                    ++$x;
+                    ++$y;
                 }
 
                 $v[$k] = $x;
@@ -69,11 +70,11 @@ class FileDiffer
     private static function extractDiff(array $trace, int $x, int $y, array $a, array $b) : array
     {
         $result = [];
-        for ($d = \count($trace) - 1; $d >= 0; $d--) {
+        for ($d = \count($trace) - 1; $d >= 0; --$d) {
             $v = $trace[$d];
             $k = $x - $y;
 
-            if ($k === -$d || ($k !== $d && $v[$k-1] < $v[$k+1])) {
+            if ($k === -$d || ($k !== $d && $v[$k - 1] < $v[$k + 1])) {
                 $prevK = $k + 1;
             } else {
                 $prevK = $k - 1;
@@ -85,11 +86,11 @@ class FileDiffer
             while ($x > $prevX && $y > $prevY) {
                 $result[] = new DiffElem(
                     DiffElem::TYPE_KEEP,
-                    $a[$x-1],
-                    $b[$y-1]
+                    $a[$x - 1],
+                    $b[$y - 1]
                 );
-                $x--;
-                $y--;
+                --$x;
+                --$y;
             }
 
             if ($d === 0) {
@@ -97,15 +98,16 @@ class FileDiffer
             }
 
             while ($x > $prevX) {
-                $result[] = new DiffElem(DiffElem::TYPE_REMOVE, $a[$x-1], null);
-                $x--;
+                $result[] = new DiffElem(DiffElem::TYPE_REMOVE, $a[$x - 1], null);
+                --$x;
             }
 
             while ($y > $prevY) {
-                $result[] = new DiffElem(DiffElem::TYPE_ADD, null, $b[$y-1]);
-                $y--;
+                $result[] = new DiffElem(DiffElem::TYPE_ADD, null, $b[$y - 1]);
+                --$y;
             }
         }
+
         return array_reverse($result);
     }
 
@@ -146,17 +148,17 @@ class FileDiffer
 
                 $text_length = strlen($diff_text);
 
-                $line_diff--;
+                --$line_diff;
 
                 if ($last_change === null) {
-                    $i++;
+                    ++$i;
                     $last_change = [
                         $a_offset,
                         $a_offset + $text_length,
                         $b_offset,
                         $b_offset,
                         $line_diff,
-                        ''
+                        '',
                     ];
                     $changes[$i - 1] = $last_change;
                 } else {
@@ -172,17 +174,17 @@ class FileDiffer
 
                 $text_length = strlen($diff_text);
 
-                $line_diff++;
+                ++$line_diff;
 
                 if ($last_change === null) {
-                    $i++;
+                    ++$i;
                     $last_change = [
                         $a_offset,
                         $a_offset,
                         $b_offset,
                         $b_offset + $text_length,
                         $line_diff,
-                        $diff_text
+                        $diff_text,
                     ];
                     $changes[$i - 1] = $last_change;
                 } else {
@@ -206,28 +208,28 @@ class FileDiffer
 
                 $max_same_count = min($old_text_length, $new_text_length);
 
-                for ($j = 0; $j < $max_same_count; $j++) {
+                for ($j = 0; $j < $max_same_count; ++$j) {
                     if ($old_diff_text[$j] !== $new_diff_text[$j]) {
                         break;
                     }
 
-                    $a_offset++;
-                    $b_offset++;
-                    $old_text_length--;
-                    $new_text_length--;
+                    ++$a_offset;
+                    ++$b_offset;
+                    --$old_text_length;
+                    --$new_text_length;
                 }
 
                 $new_diff_text = substr($new_diff_text, $j);
 
                 if ($last_change === null || $j) {
-                    $i++;
+                    ++$i;
                     $last_change = [
                         $a_offset,
                         $a_offset + $old_text_length,
                         $b_offset,
                         $b_offset + $new_text_length,
                         $line_diff,
-                        $new_diff_text
+                        $new_diff_text,
                     ];
                     $changes[$i - 1] = $last_change;
                 } else {
@@ -257,13 +259,14 @@ class FileDiffer
      * Coalesce equal-length sequences of remove+add into a replace operation.
      *
      * @param DiffElem[] $diff
+     *
      * @return DiffElem[]
      */
     private static function coalesceReplacements(array $diff)
     {
         $newDiff = [];
         $c = \count($diff);
-        for ($i = 0; $i < $c; $i++) {
+        for ($i = 0; $i < $c; ++$i) {
             $diffType = $diff[$i]->type;
             if ($diffType !== DiffElem::TYPE_REMOVE) {
                 $newDiff[] = $diff[$i];
@@ -272,17 +275,17 @@ class FileDiffer
 
             $j = $i;
             while ($j < $c && $diff[$j]->type === DiffElem::TYPE_REMOVE) {
-                $j++;
+                ++$j;
             }
 
             $k = $j;
             while ($k < $c && $diff[$k]->type === DiffElem::TYPE_ADD) {
-                $k++;
+                ++$k;
             }
 
             if ($j - $i === $k - $j) {
                 $len = $j - $i;
-                for ($n = 0; $n < $len; $n++) {
+                for ($n = 0; $n < $len; ++$n) {
                     $newDiff[] = new DiffElem(
                         DiffElem::TYPE_REPLACE,
                         $diff[$i + $n]->old,
@@ -290,7 +293,7 @@ class FileDiffer
                     );
                 }
             } else {
-                for (; $i < $k; $i++) {
+                for (; $i < $k; ++$i) {
                     $newDiff[] = $diff[$i];
                 }
             }
@@ -298,6 +301,7 @@ class FileDiffer
             /** @psalm-suppress LoopInvalidation */
             $i = $k - 1;
         }
+
         return $newDiff;
     }
 }
diff --git a/src/Psalm/Internal/Diff/FileStatementsDiffer.php b/src/Psalm/Internal/Diff/FileStatementsDiffer.php
index 3d9289c31..eb033336a 100644
--- a/src/Psalm/Internal/Diff/FileStatementsDiffer.php
+++ b/src/Psalm/Internal/Diff/FileStatementsDiffer.php
@@ -1,12 +1,11 @@
 <?php
-
 namespace Psalm\Internal\Diff;
 
-use PhpParser;
-use function get_class;
-use function substr;
 use function array_merge;
 use function end;
+use function get_class;
+use PhpParser;
+use function substr;
 
 /**
  * @internal
diff --git a/src/Psalm/Internal/Diff/NamespaceStatementsDiffer.php b/src/Psalm/Internal/Diff/NamespaceStatementsDiffer.php
index cf8e4efbd..0133e4d13 100644
--- a/src/Psalm/Internal/Diff/NamespaceStatementsDiffer.php
+++ b/src/Psalm/Internal/Diff/NamespaceStatementsDiffer.php
@@ -1,12 +1,11 @@
 <?php
-
 namespace Psalm\Internal\Diff;
 
-use PhpParser;
-use function get_class;
-use function substr;
 use function array_merge;
 use function end;
+use function get_class;
+use PhpParser;
+use function substr;
 
 /**
  * @internal
diff --git a/src/Psalm/Internal/ExecutionEnvironment/BuildInfoCollector.php b/src/Psalm/Internal/ExecutionEnvironment/BuildInfoCollector.php
index af5c05b9f..4844cdd15 100644
--- a/src/Psalm/Internal/ExecutionEnvironment/BuildInfoCollector.php
+++ b/src/Psalm/Internal/ExecutionEnvironment/BuildInfoCollector.php
@@ -1,5 +1,4 @@
 <?php
-
 namespace Psalm\Internal\ExecutionEnvironment;
 
 use function explode;
diff --git a/src/Psalm/Internal/ExecutionEnvironment/GitInfoCollector.php b/src/Psalm/Internal/ExecutionEnvironment/GitInfoCollector.php
index 8918c897b..a4806c04c 100644
--- a/src/Psalm/Internal/ExecutionEnvironment/GitInfoCollector.php
+++ b/src/Psalm/Internal/ExecutionEnvironment/GitInfoCollector.php
@@ -1,17 +1,16 @@
 <?php
-
 namespace Psalm\Internal\ExecutionEnvironment;
 
+use function array_keys;
+use function array_unique;
+use function count;
+use function explode;
 use Psalm\SourceControl\Git\CommitInfo;
 use Psalm\SourceControl\Git\GitInfo;
 use Psalm\SourceControl\Git\RemoteInfo;
-use function strpos;
-use function explode;
-use function count;
-use function array_keys;
 use function range;
+use function strpos;
 use function trim;
-use function array_unique;
 
 /**
  * Git repository info collector.
@@ -76,7 +75,7 @@ class GitInfoCollector
      */
     protected function collectCommit() : CommitInfo
     {
-        $commitResult = $this->executor->execute("git log -1 --pretty=format:%H%n%aN%n%ae%n%cN%n%ce%n%s%n%at");
+        $commitResult = $this->executor->execute('git log -1 --pretty=format:%H%n%aN%n%ae%n%cN%n%ce%n%s%n%at');
 
         if (count($commitResult) !== 7 || array_keys($commitResult) !== range(0, 6)) {
             throw new \RuntimeException();
diff --git a/src/Psalm/Internal/ExecutionEnvironment/SystemCommandExecutor.php b/src/Psalm/Internal/ExecutionEnvironment/SystemCommandExecutor.php
index bec0c9f0d..799ea97be 100644
--- a/src/Psalm/Internal/ExecutionEnvironment/SystemCommandExecutor.php
+++ b/src/Psalm/Internal/ExecutionEnvironment/SystemCommandExecutor.php
@@ -1,5 +1,4 @@
 <?php
-
 namespace Psalm\Internal\ExecutionEnvironment;
 
 use function exec;
diff --git a/src/Psalm/Internal/FileManipulation/CodeMigration.php b/src/Psalm/Internal/FileManipulation/CodeMigration.php
index 206892697..0ea4db263 100644
--- a/src/Psalm/Internal/FileManipulation/CodeMigration.php
+++ b/src/Psalm/Internal/FileManipulation/CodeMigration.php
@@ -1,5 +1,4 @@
 <?php
-
 namespace Psalm\Internal\FileManipulation;
 
 class CodeMigration
diff --git a/src/Psalm/Internal/FileManipulation/FileManipulationBuffer.php b/src/Psalm/Internal/FileManipulation/FileManipulationBuffer.php
index 02a89a0bd..7293a15d2 100644
--- a/src/Psalm/Internal/FileManipulation/FileManipulationBuffer.php
+++ b/src/Psalm/Internal/FileManipulation/FileManipulationBuffer.php
@@ -1,11 +1,10 @@
 <?php
 namespace Psalm\Internal\FileManipulation;
 
+use function array_merge;
 use Psalm\FileManipulation;
 use Psalm\Internal\Provider\FileProvider;
-use function array_merge;
 use function strlen;
-use const PHP_EOL;
 use function substr;
 
 /**
@@ -104,7 +103,7 @@ class FileManipulationBuffer
                     $bounds[0],
                     $bounds[1],
                     $replacement_text
-                )
+                ),
             ]
         );
     }
diff --git a/src/Psalm/Internal/FileManipulation/FunctionDocblockManipulator.php b/src/Psalm/Internal/FileManipulation/FunctionDocblockManipulator.php
index c51410687..4397cb1d5 100644
--- a/src/Psalm/Internal/FileManipulation/FunctionDocblockManipulator.php
+++ b/src/Psalm/Internal/FileManipulation/FunctionDocblockManipulator.php
@@ -1,24 +1,24 @@
 <?php
 namespace Psalm\Internal\FileManipulation;
 
-use Psalm\FileManipulation;
+use function count;
 
+use function ltrim;
 use PhpParser\Node\Expr\Closure;
 use PhpParser\Node\FunctionLike;
 use PhpParser\Node\Stmt\ClassMethod;
 use PhpParser\Node\Stmt\Function_;
+use function preg_match;
 use Psalm\DocComment;
+use Psalm\FileManipulation;
 use Psalm\Internal\Analyzer\CommentAnalyzer;
 use Psalm\Internal\Analyzer\ProjectAnalyzer;
-use function count;
-use function strpos;
-use function substr;
+use function str_replace;
 use function str_split;
-use function preg_match;
-use function strrpos;
 use function strlen;
-use function str_replace;
-use function ltrim;
+use function strpos;
+use function strrpos;
+use function substr;
 
 /**
  * @internal
@@ -324,7 +324,7 @@ class FunctionDocblockManipulator
         if ($this->new_phpdoc_return_type) {
             $parsed_docblock['specials']['return'] = [
                 $this->new_phpdoc_return_type
-                    . ($this->return_type_description ? (' ' . $this->return_type_description) : '')
+                    . ($this->return_type_description ? (' ' . $this->return_type_description) : ''),
             ];
         }
 
diff --git a/src/Psalm/Internal/Fork/Pool.php b/src/Psalm/Internal/Fork/Pool.php
index 29cc17b76..299f8a833 100644
--- a/src/Psalm/Internal/Fork/Pool.php
+++ b/src/Psalm/Internal/Fork/Pool.php
@@ -1,47 +1,47 @@
 <?php
 namespace Psalm\Internal\Fork;
 
+use function array_fill_keys;
+use function array_keys;
+use function array_pop;
+use function array_values;
+use function base64_decode;
+use function base64_encode;
 use function count;
+use function error_log;
+use function explode;
 use function extension_loaded;
-use const PHP_EOL;
+use function fclose;
+use function feof;
+use function fread;
+use function fwrite;
+use function gettype;
 use function ini_get;
-use function version_compare;
-use const PHP_VERSION;
-use function stream_socket_pair;
-use const STREAM_PF_UNIX;
-use const STREAM_SOCK_STREAM;
-use const STREAM_IPPROTO_IP;
-use function error_log;
+use function intval;
 use function pcntl_fork;
-use function posix_strerror;
+use function pcntl_waitpid;
+use function pcntl_wexitstatus;
+use function pcntl_wifsignaled;
+use function pcntl_wtermsig;
+use const PHP_EOL;
+use const PHP_VERSION;
 use function posix_get_last_error;
-use function array_values;
-use function base64_encode;
+use function posix_kill;
+use function posix_strerror;
 use function serialize;
-use function strlen;
-use function fwrite;
-use function substr;
-use function usleep;
-use function fclose;
-use function stream_set_blocking;
-use function intval;
-use function array_fill_keys;
-use function array_keys;
+use const SIGALRM;
+use const STREAM_IPPROTO_IP;
+use const STREAM_PF_UNIX;
 use function stream_select;
-use function fread;
+use function stream_set_blocking;
+use const STREAM_SOCK_STREAM;
+use function stream_socket_pair;
+use function strlen;
 use function strpos;
-use function explode;
-use function array_pop;
+use function substr;
 use function unserialize;
-use function base64_decode;
-use function gettype;
-use function feof;
-use function posix_kill;
-use const SIGALRM;
-use function pcntl_waitpid;
-use function pcntl_wifsignaled;
-use function pcntl_wexitstatus;
-use function pcntl_wtermsig;
+use function usleep;
+use function version_compare;
 
 /**
  * Adapted with relatively few changes from
@@ -108,10 +108,9 @@ class Pool
         );
 
         if (!extension_loaded('pcntl')) {
-            echo(
+            echo
                 'The pcntl extension must be loaded in order for Psalm to be able to use multiple processes.'
-                . PHP_EOL
-            );
+                . PHP_EOL;
             exit(1);
         }
 
@@ -319,7 +318,7 @@ class Pool
                     $content[intval($file)] = array_pop($serialized_messages);
 
                     foreach ($serialized_messages as $serialized_message) {
-                        $message = unserialize(base64_decode($serialized_message));
+                        $message = unserialize(base64_decode($serialized_message, true));
 
                         if ($message instanceof ForkProcessDoneMessage) {
                             $terminationMessages[] = $message->data;
diff --git a/src/Psalm/Internal/Fork/PsalmRestarter.php b/src/Psalm/Internal/Fork/PsalmRestarter.php
index 22232e85e..a337f3202 100644
--- a/src/Psalm/Internal/Fork/PsalmRestarter.php
+++ b/src/Psalm/Internal/Fork/PsalmRestarter.php
@@ -1,13 +1,12 @@
 <?php
-
 namespace Psalm\Internal\Fork;
 
 use function array_filter;
 use function extension_loaded;
-use function implode;
 use function file_get_contents;
-use function preg_replace;
 use function file_put_contents;
+use function implode;
+use function preg_replace;
 
 /**
  * @internal
@@ -36,6 +35,8 @@ class PsalmRestarter extends \Composer\XdebugHandler\XdebugHandler
 
     /**
      * @psalm-suppress UnusedMethod
+     *
+     * @param mixed $loaded
      */
     protected function requiresRestart($loaded)
     {
@@ -56,6 +57,9 @@ class PsalmRestarter extends \Composer\XdebugHandler\XdebugHandler
 
     /**
      * @psalm-suppress UnusedMethod
+     *
+     * @param mixed $command
+     *
      * @return void
      */
     protected function restart($command)
diff --git a/src/Psalm/Internal/LanguageServer/Client/TextDocument.php b/src/Psalm/Internal/LanguageServer/Client/TextDocument.php
index 690b0ecdd..4d34a1480 100644
--- a/src/Psalm/Internal/LanguageServer/Client/TextDocument.php
+++ b/src/Psalm/Internal/LanguageServer/Client/TextDocument.php
@@ -1,13 +1,14 @@
 <?php
 declare(strict_types = 1);
-
 namespace Psalm\Internal\LanguageServer\Client;
 
-use Psalm\Internal\LanguageServer\ClientHandler;
-use LanguageServerProtocol\{Diagnostic, TextDocumentItem, TextDocumentIdentifier};
+use function Amp\call;
 use Amp\Promise;
 use JsonMapper;
-use function Amp\call;
+use LanguageServerProtocol\Diagnostic;
+use LanguageServerProtocol\TextDocumentIdentifier;
+use LanguageServerProtocol\TextDocumentItem;
+use Psalm\Internal\LanguageServer\ClientHandler;
 
 /**
  * Provides method handlers for all textDocument/* methods
@@ -35,13 +36,14 @@ class TextDocument
      *
      * @param string $uri
      * @param Diagnostic[] $diagnostics
+     *
      * @return Promise <void>
      */
     public function publishDiagnostics(string $uri, array $diagnostics): Promise
     {
         return $this->handler->notify('textDocument/publishDiagnostics', [
             'uri' => $uri,
-            'diagnostics' => $diagnostics
+            'diagnostics' => $diagnostics,
         ]);
     }
 
@@ -50,6 +52,7 @@ class TextDocument
      * to request the current content of a text document identified by the URI
      *
      * @param TextDocumentIdentifier $textDocument The document to get the content for
+     *
      * @return Promise<TextDocumentItem> The document's current content
      */
     public function xcontent(TextDocumentIdentifier $textDocument): Promise
diff --git a/src/Psalm/Internal/LanguageServer/ClientHandler.php b/src/Psalm/Internal/LanguageServer/ClientHandler.php
index 86ea17e65..98fc27ddd 100644
--- a/src/Psalm/Internal/LanguageServer/ClientHandler.php
+++ b/src/Psalm/Internal/LanguageServer/ClientHandler.php
@@ -1,12 +1,11 @@
 <?php
 declare(strict_types = 1);
-
 namespace Psalm\Internal\LanguageServer;
 
 use AdvancedJsonRpc;
+use function Amp\call;
 use Amp\Deferred;
 use Amp\Promise;
-use function Amp\call;
 use function error_log;
 
 /**
@@ -41,6 +40,7 @@ class ClientHandler
      *
      * @param string $method The method to call
      * @param array|object $params The method parameters
+     *
      * @return Promise<mixed> Resolved with the result of the request or rejected with an error
      */
     public function request(string $method, $params): Promise
@@ -84,6 +84,7 @@ class ClientHandler
                         }
                     };
                 $this->protocolReader->on('message', $listener);
+
                 return $deferred->promise();
             }
         );
@@ -94,6 +95,7 @@ class ClientHandler
      *
      * @param string $method The method to call
      * @param array|object $params The method parameters
+     *
      * @return Promise <null> Will be resolved as soon as the notification has been sent
      */
     public function notify(string $method, $params): Promise
diff --git a/src/Psalm/Internal/LanguageServer/EmitterInterface.php b/src/Psalm/Internal/LanguageServer/EmitterInterface.php
index 33a308581..4b14254b6 100644
--- a/src/Psalm/Internal/LanguageServer/EmitterInterface.php
+++ b/src/Psalm/Internal/LanguageServer/EmitterInterface.php
@@ -1,5 +1,5 @@
-<?php declare (strict_types=1);
-
+<?php
+declare(strict_types=1);
 namespace Psalm\Internal\LanguageServer;
 
 /**
@@ -14,7 +14,6 @@ namespace Psalm\Internal\LanguageServer;
  */
 interface EmitterInterface
 {
-
     /**
      * Subscribe to an event.
      *
diff --git a/src/Psalm/Internal/LanguageServer/EmitterTrait.php b/src/Psalm/Internal/LanguageServer/EmitterTrait.php
index fbde669c4..541aec403 100644
--- a/src/Psalm/Internal/LanguageServer/EmitterTrait.php
+++ b/src/Psalm/Internal/LanguageServer/EmitterTrait.php
@@ -1,5 +1,5 @@
-<?php declare (strict_types=1);
-
+<?php
+declare(strict_types=1);
 namespace Psalm\Internal\LanguageServer;
 
 use const SORT_NUMERIC;
@@ -37,7 +37,7 @@ trait EmitterTrait
             $this->listeners[$eventName] = [
                 true,  // If there's only one item, it's sorted
                 [$priority],
-                [$callBack]
+                [$callBack],
             ];
         } else {
             $this->listeners[$eventName][0] = false; // marked as unsorted
@@ -87,7 +87,7 @@ trait EmitterTrait
             $counter = \count($listeners);
 
             foreach ($listeners as $listener) {
-                $counter--;
+                --$counter;
                 /** @psalm-suppress MixedAssignment */
                 $result = \call_user_func_array($listener, $arguments);
                 if ($result === false) {
@@ -145,11 +145,12 @@ trait EmitterTrait
         }
         foreach ($this->listeners[$eventName][2] as $index => $check) {
             if ($check === $listener) {
-                unset($this->listeners[$eventName][1][$index]);
-                unset($this->listeners[$eventName][2][$index]);
+                unset($this->listeners[$eventName][1][$index], $this->listeners[$eventName][2][$index]);
+
                 return true;
             }
         }
+
         return false;
     }
 }
diff --git a/src/Psalm/Internal/LanguageServer/IdGenerator.php b/src/Psalm/Internal/LanguageServer/IdGenerator.php
index 763499f47..2847872cf 100644
--- a/src/Psalm/Internal/LanguageServer/IdGenerator.php
+++ b/src/Psalm/Internal/LanguageServer/IdGenerator.php
@@ -1,6 +1,5 @@
 <?php
 declare(strict_types = 1);
-
 namespace Psalm\Internal\LanguageServer;
 
 /**
diff --git a/src/Psalm/Internal/LanguageServer/LanguageClient.php b/src/Psalm/Internal/LanguageServer/LanguageClient.php
index d91bed0d8..b1d7b99a3 100644
--- a/src/Psalm/Internal/LanguageServer/LanguageClient.php
+++ b/src/Psalm/Internal/LanguageServer/LanguageClient.php
@@ -1,6 +1,5 @@
 <?php
 declare(strict_types = 1);
-
 namespace Psalm\Internal\LanguageServer;
 
 use JsonMapper;
diff --git a/src/Psalm/Internal/LanguageServer/LanguageServer.php b/src/Psalm/Internal/LanguageServer/LanguageServer.php
index 5b9d77266..d0c40912a 100644
--- a/src/Psalm/Internal/LanguageServer/LanguageServer.php
+++ b/src/Psalm/Internal/LanguageServer/LanguageServer.php
@@ -1,43 +1,42 @@
 <?php
 declare(strict_types = 1);
-
 namespace Psalm\Internal\LanguageServer;
 
-use Psalm\Internal\Analyzer\ProjectAnalyzer;
-use LanguageServerProtocol\{
-    ServerCapabilities,
-    ClientCapabilities,
-    TextDocumentSyncKind,
-    TextDocumentSyncOptions,
-    InitializeResult,
-    CompletionOptions,
-    SignatureHelpOptions
-};
-use Psalm\Internal\LanguageServer\Server\TextDocument;
-use LanguageServerProtocol\{Range, Position, Diagnostic, DiagnosticSeverity};
 use AdvancedJsonRpc;
-use Amp\Promise;
-use Symfony\Component\VarExporter\VarExporter;
-use Throwable;
-use function Amp\call;
 use function Amp\asyncCoroutine;
-use function array_keys;
+use function Amp\call;
+use Amp\Promise;
 use function array_combine;
-use function array_values;
 use function array_filter;
+use function array_keys;
 use function array_map;
-use function max;
-use function trim;
-use function str_replace;
-use function explode;
 use function array_shift;
-use function substr;
-use function rawurlencode;
 use function array_unshift;
+use function array_values;
+use function explode;
 use function implode;
+use LanguageServerProtocol\ClientCapabilities;
+use LanguageServerProtocol\CompletionOptions;
+use LanguageServerProtocol\Diagnostic;
+use LanguageServerProtocol\DiagnosticSeverity;
+use LanguageServerProtocol\InitializeResult;
+use LanguageServerProtocol\Position;
+use LanguageServerProtocol\Range;
+use LanguageServerProtocol\ServerCapabilities;
+use LanguageServerProtocol\SignatureHelpOptions;
+use LanguageServerProtocol\TextDocumentSyncKind;
+use LanguageServerProtocol\TextDocumentSyncOptions;
+use function max;
 use function parse_url;
-use function urldecode;
+use Psalm\Internal\Analyzer\ProjectAnalyzer;
+use Psalm\Internal\LanguageServer\Server\TextDocument;
+use function rawurlencode;
+use function str_replace;
 use function strpos;
+use function substr;
+use Throwable;
+use function trim;
+use function urldecode;
 
 /**
  * @internal
@@ -261,6 +260,7 @@ class LanguageServer extends AdvancedJsonRpc\Dispatcher
 
     /**
      * @psalm-suppress PossiblyUnusedMethod
+     *
      * @return void
      */
     public function initialized()
@@ -316,6 +316,7 @@ class LanguageServer extends AdvancedJsonRpc\Dispatcher
 
     /**
      * @param array<string, string> $uris
+     *
      * @return void
      */
     public function emitIssues(array $uris)
@@ -411,6 +412,7 @@ class LanguageServer extends AdvancedJsonRpc\Dispatcher
      * Transforms an absolute file path into a URI as used by the language server protocol.
      *
      * @param string $filepath
+     *
      * @return string
      */
     public static function pathToUri(string $filepath): string
@@ -425,6 +427,7 @@ class LanguageServer extends AdvancedJsonRpc\Dispatcher
         $parts = array_map('rawurlencode', $parts);
         array_unshift($parts, $first);
         $filepath = implode('/', $parts);
+
         return 'file:///' . $filepath;
     }
 
@@ -432,6 +435,7 @@ class LanguageServer extends AdvancedJsonRpc\Dispatcher
      * Transforms URI into file path
      *
      * @param string $uri
+     *
      * @return string
      */
     public static function uriToPath(string $uri)
@@ -447,6 +451,7 @@ class LanguageServer extends AdvancedJsonRpc\Dispatcher
             }
             $filepath = str_replace('/', '\\', $filepath);
         }
+
         return $filepath;
     }
 }
diff --git a/src/Psalm/Internal/LanguageServer/Message.php b/src/Psalm/Internal/LanguageServer/Message.php
index e5ec0707d..514bb536b 100644
--- a/src/Psalm/Internal/LanguageServer/Message.php
+++ b/src/Psalm/Internal/LanguageServer/Message.php
@@ -1,11 +1,10 @@
 <?php
 declare(strict_types = 1);
-
 namespace Psalm\Internal\LanguageServer;
 
 use AdvancedJsonRpc\Message as MessageBody;
-use function explode;
 use function array_pop;
+use function explode;
 use function strlen;
 
 /**
@@ -27,6 +26,7 @@ class Message
      * Parses a message
      *
      * @param string $msg
+     *
      * @return Message
      * @psalm-suppress UnusedMethod
      */
@@ -41,6 +41,7 @@ class Message
                 $obj->headers[$pair[0]] = $pair[1];
             }
         }
+
         return $obj;
     }
 
@@ -66,6 +67,7 @@ class Message
         foreach ($this->headers as $name => $value) {
             $headers .= "$name: $value\r\n";
         }
+
         return $headers . "\r\n" . $body;
     }
 }
diff --git a/src/Psalm/Internal/LanguageServer/ProtocolReader.php b/src/Psalm/Internal/LanguageServer/ProtocolReader.php
index 47249be2d..3f64c40ec 100644
--- a/src/Psalm/Internal/LanguageServer/ProtocolReader.php
+++ b/src/Psalm/Internal/LanguageServer/ProtocolReader.php
@@ -1,6 +1,5 @@
 <?php
 declare(strict_types = 1);
-
 namespace Psalm\Internal\LanguageServer;
 
 /**
@@ -11,5 +10,4 @@ namespace Psalm\Internal\LanguageServer;
  */
 interface ProtocolReader extends EmitterInterface
 {
-
 }
diff --git a/src/Psalm/Internal/LanguageServer/ProtocolStreamReader.php b/src/Psalm/Internal/LanguageServer/ProtocolStreamReader.php
index 82ee4b3c0..062d923f3 100644
--- a/src/Psalm/Internal/LanguageServer/ProtocolStreamReader.php
+++ b/src/Psalm/Internal/LanguageServer/ProtocolStreamReader.php
@@ -1,16 +1,15 @@
 <?php
 declare(strict_types = 1);
-
 namespace Psalm\Internal\LanguageServer;
 
 use AdvancedJsonRpc\Message as MessageBody;
+use function Amp\asyncCall;
 use Amp\ByteStream\ResourceInputStream;
 use Exception;
-use function Amp\asyncCall;
-use function substr;
 use function explode;
-use function trim;
 use function strlen;
+use function substr;
+use function trim;
 
 /**
  * Source: https://github.com/felixfbecker/php-language-server/tree/master/src/ProtocolStreamReader.php
@@ -25,6 +24,7 @@ class ProtocolStreamReader implements ProtocolReader
     /**
      * This is checked by ProtocolStreamReader so that it will stop reading from streams in the forked process.
      * There could be buffered bytes in stdin/over TCP, those would be processed by TCP if it were not for this check.
+     *
      * @var bool
      */
     private $is_accepting_new_requests = true;
@@ -98,6 +98,7 @@ class ProtocolStreamReader implements ProtocolReader
                         if (!$this->is_accepting_new_requests) {
                             // If we fork, don't read any bytes in the input buffer from the worker process.
                             $this->emitClose();
+
                             return $emitted_messages;
                         }
                         // MessageBody::parse can throw an Error, maybe log an error?
@@ -107,12 +108,13 @@ class ProtocolStreamReader implements ProtocolReader
                             $msg = null;
                         }
                         if ($msg) {
-                            $emitted_messages++;
+                            ++$emitted_messages;
                             $this->emit('message', [$msg]);
                             /** @psalm-suppress DocblockTypeContradiction */
                             if (!$this->is_accepting_new_requests) {
                                 // If we fork, don't read any bytes in the input buffer from the worker process.
                                 $this->emitClose();
+
                                 return $emitted_messages;
                             }
                         }
@@ -123,6 +125,7 @@ class ProtocolStreamReader implements ProtocolReader
                     break;
             }
         }
+
         return $emitted_messages;
     }
 
diff --git a/src/Psalm/Internal/LanguageServer/ProtocolStreamWriter.php b/src/Psalm/Internal/LanguageServer/ProtocolStreamWriter.php
index 453f480c9..a59f62fa5 100644
--- a/src/Psalm/Internal/LanguageServer/ProtocolStreamWriter.php
+++ b/src/Psalm/Internal/LanguageServer/ProtocolStreamWriter.php
@@ -1,6 +1,5 @@
 <?php
 declare(strict_types = 1);
-
 namespace Psalm\Internal\LanguageServer;
 
 use Amp\ByteStream\ResourceOutputStream;
diff --git a/src/Psalm/Internal/LanguageServer/ProtocolWriter.php b/src/Psalm/Internal/LanguageServer/ProtocolWriter.php
index 1a4b1e724..0f04d28dd 100644
--- a/src/Psalm/Internal/LanguageServer/ProtocolWriter.php
+++ b/src/Psalm/Internal/LanguageServer/ProtocolWriter.php
@@ -1,9 +1,7 @@
 <?php
 declare(strict_types = 1);
-
 namespace Psalm\Internal\LanguageServer;
 
-use Psalm\Internal\LanguageServer\Message;
 use Amp\Promise;
 
 interface ProtocolWriter
@@ -12,6 +10,7 @@ interface ProtocolWriter
      * Sends a Message to the client
      *
      * @param Message $msg
+     *
      * @return Promise Resolved when the message has been fully written out to the output stream
      */
     public function write(Message $msg): Promise;
diff --git a/src/Psalm/Internal/LanguageServer/Server/TextDocument.php b/src/Psalm/Internal/LanguageServer/Server/TextDocument.php
index dbc5661da..5a79e72c2 100644
--- a/src/Psalm/Internal/LanguageServer/Server/TextDocument.php
+++ b/src/Psalm/Internal/LanguageServer/Server/TextDocument.php
@@ -1,44 +1,26 @@
 <?php
 declare(strict_types = 1);
-
 namespace Psalm\Internal\LanguageServer\Server;
 
-use Psalm\Internal\LanguageServer\{
-    LanguageServer,
-    LanguageClient,
-    PhpDocumentLoader,
-    PhpDocument,
-    DefinitionResolver,
-    CompletionProvider
-};
-use LanguageServerProtocol\{
-    CompletionList,
-    SymbolLocationInformation,
-    SymbolDescriptor,
-    TextDocumentItem,
-    TextDocumentIdentifier,
-    VersionedTextDocumentIdentifier,
-    Position,
-    Range,
-    FormattingOptions,
-    TextEdit,
-    Location,
-    SymbolInformation,
-    ReferenceContext,
-    Hover,
-    MarkedString,
-    SymbolKind,
-    CompletionItem,
-    CompletionItemKind
-};
-use Psalm\Codebase;
 use Amp\Promise;
 use Amp\Success;
-use function error_log;
 use function count;
-use function substr_count;
+use function error_log;
+use LanguageServerProtocol\CompletionItem;
+use LanguageServerProtocol\CompletionList;
+use LanguageServerProtocol\Hover;
+use LanguageServerProtocol\Location;
+use LanguageServerProtocol\MarkedString;
+use LanguageServerProtocol\Position;
+use LanguageServerProtocol\Range;
+use LanguageServerProtocol\TextDocumentIdentifier;
+use LanguageServerProtocol\TextDocumentItem;
+use LanguageServerProtocol\VersionedTextDocumentIdentifier;
+use Psalm\Codebase;
+use Psalm\Internal\LanguageServer\LanguageServer;
 use function strlen;
 use function strpos;
+use function substr_count;
 
 /**
  * Provides method handlers for all textDocument/* methods
@@ -73,7 +55,8 @@ class TextDocument
      * document's truth is now managed by the client and the server must not try to read the document's truth using the
      * document's uri.
      *
-     * @param \LanguageServerProtocol\TextDocumentItem $textDocument The document that was opened.
+     * @param \LanguageServerProtocol\TextDocumentItem $textDocument the document that was opened
+     *
      * @return void
      */
     public function didOpen(TextDocumentItem $textDocument)
@@ -82,6 +65,7 @@ class TextDocument
 
         if (!$this->codebase->config->isInProjectDirs($file_path)) {
             error_log($file_path . ' is not in project');
+
             return;
         }
 
@@ -113,6 +97,7 @@ class TextDocument
      *
      * @param \LanguageServerProtocol\VersionedTextDocumentIdentifier $textDocument
      * @param \LanguageServerProtocol\TextDocumentContentChangeEvent[] $contentChanges
+     *
      * @return void
      */
     public function didChange(VersionedTextDocumentIdentifier $textDocument, array $contentChanges)
@@ -149,6 +134,7 @@ class TextDocument
      * truth now exists on disk).
      *
      * @param \LanguageServerProtocol\TextDocumentIdentifier $textDocument The document that was closed
+     *
      * @return void
      */
     public function didClose(TextDocumentIdentifier $textDocument)
@@ -159,7 +145,6 @@ class TextDocument
         $this->server->client->textDocument->publishDiagnostics($textDocument->uri, []);
     }
 
-
     /**
      * The goto definition request is sent from the client to the server to resolve the definition location of a symbol
      * at a given text document position.
@@ -177,6 +162,7 @@ class TextDocument
         } catch (\Psalm\Exception\UnanalyzedFileException $e) {
             $this->codebase->file_provider->openFile($file_path);
             $this->server->queueFileAnalysis($file_path, $textDocument->uri);
+
             return new Success(new Hover([]));
         }
 
@@ -220,6 +206,7 @@ class TextDocument
         } catch (\Psalm\Exception\UnanalyzedFileException $e) {
             $this->codebase->file_provider->openFile($file_path);
             $this->server->queueFileAnalysis($file_path, $textDocument->uri);
+
             return new Success(new Hover([]));
         }
 
@@ -262,6 +249,7 @@ class TextDocument
 
         if (!$completion_data) {
             error_log('completion not found at ' . $position->line . ':' . $position->character);
+
             return new Success([]);
         }
 
@@ -309,7 +297,7 @@ class TextDocument
             $parameters[] = new \LanguageServerProtocol\ParameterInformation([
                 strlen($signature_label),
                 strlen($signature_label) + strlen($parameter_label),
-            ]) ;
+            ]);
             $signature_label .= $parameter_label;
 
             if ($i < (count($params) - 1)) {
diff --git a/src/Psalm/Internal/PluginManager/Command/DisableCommand.php b/src/Psalm/Internal/PluginManager/Command/DisableCommand.php
index f374ddb5d..4dc9e8ed3 100644
--- a/src/Psalm/Internal/PluginManager/Command/DisableCommand.php
+++ b/src/Psalm/Internal/PluginManager/Command/DisableCommand.php
@@ -1,17 +1,17 @@
 <?php
 namespace Psalm\Internal\PluginManager\Command;
 
+use function assert;
+use const DIRECTORY_SEPARATOR;
+use function getcwd;
+use InvalidArgumentException;
+use function is_string;
 use Psalm\Internal\PluginManager\PluginListFactory;
 use Symfony\Component\Console\Command\Command;
 use Symfony\Component\Console\Input\InputArgument;
 use Symfony\Component\Console\Input\InputInterface;
 use Symfony\Component\Console\Output\OutputInterface;
-use InvalidArgumentException;
 use Symfony\Component\Console\Style\SymfonyStyle;
-use function getcwd;
-use const DIRECTORY_SEPARATOR;
-use function is_string;
-use function assert;
 
 /**
  * @internal
@@ -29,6 +29,7 @@ class DisableCommand extends Command
 
     /**
      * @psalm-suppress UnusedMethod
+     *
      * @return void
      */
     protected function configure()
@@ -47,6 +48,7 @@ class DisableCommand extends Command
 
     /**
      * @psalm-suppress UnusedMethod
+     *
      * @return null|int
      */
     protected function execute(InputInterface $i, OutputInterface $o)
@@ -71,11 +73,13 @@ class DisableCommand extends Command
             $plugin_class = $plugin_list->resolvePluginClass($plugin_name);
         } catch (InvalidArgumentException $e) {
             $io->error('Unknown plugin class ' . $plugin_name);
+
             return 2;
         }
 
         if (!$plugin_list->isEnabled($plugin_class)) {
             $io->note('Plugin already disabled');
+
             return 3;
         }
 
diff --git a/src/Psalm/Internal/PluginManager/Command/EnableCommand.php b/src/Psalm/Internal/PluginManager/Command/EnableCommand.php
index 8f0cbddd2..c9e259276 100644
--- a/src/Psalm/Internal/PluginManager/Command/EnableCommand.php
+++ b/src/Psalm/Internal/PluginManager/Command/EnableCommand.php
@@ -1,17 +1,17 @@
 <?php
 namespace Psalm\Internal\PluginManager\Command;
 
+use function assert;
+use const DIRECTORY_SEPARATOR;
+use function getcwd;
+use InvalidArgumentException;
+use function is_string;
 use Psalm\Internal\PluginManager\PluginListFactory;
 use Symfony\Component\Console\Command\Command;
 use Symfony\Component\Console\Input\InputArgument;
 use Symfony\Component\Console\Input\InputInterface;
 use Symfony\Component\Console\Output\OutputInterface;
-use InvalidArgumentException;
 use Symfony\Component\Console\Style\SymfonyStyle;
-use function getcwd;
-use const DIRECTORY_SEPARATOR;
-use function is_string;
-use function assert;
 
 /**
  * @internal
@@ -29,6 +29,7 @@ class EnableCommand extends Command
 
     /**
      * @psalm-suppress UnusedMethod
+     *
      * @return void
      */
     protected function configure()
@@ -47,6 +48,7 @@ class EnableCommand extends Command
 
     /**
      * @psalm-suppress UnusedMethod
+     *
      * @return null|int
      */
     protected function execute(InputInterface $i, OutputInterface $o)
@@ -71,11 +73,13 @@ class EnableCommand extends Command
             $plugin_class = $plugin_list->resolvePluginClass($plugin_name);
         } catch (InvalidArgumentException $e) {
             $io->error('Unknown plugin class ' . $plugin_name);
+
             return 2;
         }
 
         if ($plugin_list->isEnabled($plugin_class)) {
             $io->note('Plugin already enabled');
+
             return 3;
         }
 
diff --git a/src/Psalm/Internal/PluginManager/Command/ShowCommand.php b/src/Psalm/Internal/PluginManager/Command/ShowCommand.php
index 7c7bc922b..f0399d3eb 100644
--- a/src/Psalm/Internal/PluginManager/Command/ShowCommand.php
+++ b/src/Psalm/Internal/PluginManager/Command/ShowCommand.php
@@ -1,18 +1,18 @@
 <?php
 namespace Psalm\Internal\PluginManager\Command;
 
+use function array_keys;
+use function array_map;
+use function array_values;
+use function count;
+use const DIRECTORY_SEPARATOR;
+use function getcwd;
+use function is_string;
 use Psalm\Internal\PluginManager\PluginListFactory;
 use Symfony\Component\Console\Command\Command;
 use Symfony\Component\Console\Input\InputInterface;
 use Symfony\Component\Console\Output\OutputInterface;
 use Symfony\Component\Console\Style\SymfonyStyle;
-use function getcwd;
-use const DIRECTORY_SEPARATOR;
-use function is_string;
-use function count;
-use function array_map;
-use function array_keys;
-use function array_values;
 
 /**
  * @internal
@@ -64,8 +64,7 @@ class ShowCommand extends Command
             /** @param null|string $package */
             function (string $class, $package): array {
                 return [$package, $class];
-            }
-        ;
+            };
 
         $io->section('Enabled');
         if (count($enabled)) {
diff --git a/src/Psalm/Internal/PluginManager/ComposerLock.php b/src/Psalm/Internal/PluginManager/ComposerLock.php
index c6a2e756a..81bf8a44f 100644
--- a/src/Psalm/Internal/PluginManager/ComposerLock.php
+++ b/src/Psalm/Internal/PluginManager/ComposerLock.php
@@ -1,14 +1,14 @@
 <?php
 namespace Psalm\Internal\PluginManager;
 
-use RuntimeException;
+use function array_merge;
+use function file_get_contents;
 use function is_array;
 use function is_string;
 use function json_decode;
-use function file_get_contents;
 use function json_last_error;
 use function json_last_error_msg;
-use function array_merge;
+use RuntimeException;
 
 class ComposerLock
 {
@@ -21,7 +21,6 @@ class ComposerLock
         $this->file_names = $file_names;
     }
 
-
     /**
      * @param mixed $package
      * @psalm-assert-if-true array $package
@@ -49,6 +48,7 @@ class ComposerLock
         foreach ($pluginPackages as $package) {
             $ret[$package['name']] = $package['extra']['psalm']['pluginClass'];
         }
+
         return $ret;
     }
 
@@ -82,6 +82,7 @@ class ComposerLock
                 $ret[] = $package;
             }
         }
+
         return $ret;
     }
 
@@ -90,20 +91,21 @@ class ComposerLock
         $packages = [];
         foreach ($this->file_names as $file_name) {
             $composer_lock_contents = $this->read($file_name);
-            if (!isset($composer_lock_contents["packages"]) || !is_array($composer_lock_contents["packages"])) {
+            if (!isset($composer_lock_contents['packages']) || !is_array($composer_lock_contents['packages'])) {
                 throw new RuntimeException('packages section is missing or not an array');
             }
-            if (!isset($composer_lock_contents["packages-dev"]) || !is_array($composer_lock_contents["packages-dev"])) {
+            if (!isset($composer_lock_contents['packages-dev']) || !is_array($composer_lock_contents['packages-dev'])) {
                 throw new RuntimeException('packages-dev section is missing or not an array');
             }
             $packages = array_merge(
                 $packages,
                 array_merge(
-                    $composer_lock_contents["packages"],
-                    $composer_lock_contents["packages-dev"]
+                    $composer_lock_contents['packages'],
+                    $composer_lock_contents['packages-dev']
                 )
             );
         }
+
         return $packages;
     }
 }
diff --git a/src/Psalm/Internal/PluginManager/ConfigFile.php b/src/Psalm/Internal/PluginManager/ConfigFile.php
index 002437a13..d9049a82d 100644
--- a/src/Psalm/Internal/PluginManager/ConfigFile.php
+++ b/src/Psalm/Internal/PluginManager/ConfigFile.php
@@ -1,13 +1,13 @@
 <?php
 namespace Psalm\Internal\PluginManager;
 
-use Psalm\Config;
 use DomDocument;
-use RuntimeException;
 use function file_get_contents;
+use function file_put_contents;
+use Psalm\Config;
+use RuntimeException;
 use function strpos;
 use function substr;
-use function file_put_contents;
 
 class ConfigFile
 {
@@ -122,6 +122,7 @@ class ConfigFile
         }
 
         $doc->loadXML($file_contents);
+
         return $doc;
     }
 
diff --git a/src/Psalm/Internal/PluginManager/PluginList.php b/src/Psalm/Internal/PluginManager/PluginList.php
index 12f5dfd20..b18420882 100644
--- a/src/Psalm/Internal/PluginManager/PluginList.php
+++ b/src/Psalm/Internal/PluginManager/PluginList.php
@@ -3,9 +3,9 @@ namespace Psalm\Internal\PluginManager;
 
 use function array_diff_key;
 use function array_flip;
-use function strpos;
-use function array_search;
 use function array_key_exists;
+use function array_search;
+use function strpos;
 
 class PluginList
 {
@@ -15,10 +15,10 @@ class PluginList
     /** @var ComposerLock */
     private $composer_lock;
 
-    /** @var ?array<string,string> [pluginClass => packageName]*/
+    /** @var ?array<string,string> [pluginClass => packageName] */
     private $all_plugins = null;
 
-    /** @var ?array<string,?string> [pluginClass => ?packageName]*/
+    /** @var ?array<string,?string> [pluginClass => ?packageName] */
     private $enabled_plugins = null;
 
     public function __construct(ConfigFile $config_file, ComposerLock $composer_lock)
@@ -27,7 +27,6 @@ class PluginList
         $this->composer_lock = $composer_lock;
     }
 
-
     /**
      * @return array<string,?string> [pluginClass => ?packageName, ...]
      */
@@ -40,6 +39,7 @@ class PluginList
                 $this->enabled_plugins[$plugin_class] = $this->findPluginPackage($plugin_class);
             }
         }
+
         return $this->enabled_plugins;
     }
 
@@ -59,6 +59,7 @@ class PluginList
         if (null === $this->all_plugins) {
             $this->all_plugins = array_flip($this->composer_lock->getPlugins());
         }
+
         return $this->all_plugins;
     }
 
@@ -85,6 +86,7 @@ class PluginList
     {
         // pluginClass => ?pluginPackage
         $plugin_classes = $this->getAll();
+
         return $plugin_classes[$class] ?? null;
     }
 
diff --git a/src/Psalm/Internal/PluginManager/PluginListFactory.php b/src/Psalm/Internal/PluginManager/PluginListFactory.php
index 07ad575af..ff3bee15b 100644
--- a/src/Psalm/Internal/PluginManager/PluginListFactory.php
+++ b/src/Psalm/Internal/PluginManager/PluginListFactory.php
@@ -1,11 +1,11 @@
 <?php
 namespace Psalm\Internal\PluginManager;
 
-use function rtrim;
-use const DIRECTORY_SEPARATOR;
 use function array_filter;
-use function urlencode;
+use const DIRECTORY_SEPARATOR;
 use function json_encode;
+use function rtrim;
+use function urlencode;
 
 class PluginListFactory
 {
@@ -56,8 +56,8 @@ class PluginListFactory
 
         if (empty($composer_lock_filenames)) {
             $stub_composer_lock = (object)[
-                "packages" => [],
-                "packages-dev" => [],
+                'packages' => [],
+                'packages-dev' => [],
             ];
             $composer_lock_filenames[] = 'data:application/json,' . urlencode(json_encode($stub_composer_lock));
         }
diff --git a/src/Psalm/Internal/Provider/ClassLikeStorageCacheProvider.php b/src/Psalm/Internal/Provider/ClassLikeStorageCacheProvider.php
index 297ee21c3..409103e88 100644
--- a/src/Psalm/Internal/Provider/ClassLikeStorageCacheProvider.php
+++ b/src/Psalm/Internal/Provider/ClassLikeStorageCacheProvider.php
@@ -1,25 +1,25 @@
 <?php
 namespace Psalm\Internal\Provider;
 
-use Psalm\Config;
-use Psalm\Storage\ClassLikeStorage;
-use function dirname;
-use const DIRECTORY_SEPARATOR;
 use function array_merge;
+use const DIRECTORY_SEPARATOR;
+use function dirname;
 use function file_exists;
-use function filemtime;
-use function strtolower;
+use function file_get_contents;
 use function file_put_contents;
-use function igbinary_serialize;
-use function serialize;
+use function filemtime;
 use function get_class;
-use function unlink;
-use function sha1;
+use function igbinary_serialize;
 use function igbinary_unserialize;
-use function file_get_contents;
-use function unserialize;
 use function is_dir;
 use function mkdir;
+use Psalm\Config;
+use Psalm\Storage\ClassLikeStorage;
+use function serialize;
+use function sha1;
+use function strtolower;
+use function unlink;
+use function unserialize;
 
 /**
  * @internal
diff --git a/src/Psalm/Internal/Provider/ClassLikeStorageProvider.php b/src/Psalm/Internal/Provider/ClassLikeStorageProvider.php
index 0d19fb26e..558f521b2 100644
--- a/src/Psalm/Internal/Provider/ClassLikeStorageProvider.php
+++ b/src/Psalm/Internal/Provider/ClassLikeStorageProvider.php
@@ -1,9 +1,9 @@
 <?php
 namespace Psalm\Internal\Provider;
 
+use function array_merge;
 use Psalm\Storage\ClassLikeStorage;
 use function strtolower;
-use function array_merge;
 
 /**
  * @internal
@@ -35,8 +35,9 @@ class ClassLikeStorageProvider
     /**
      * @param  string $fq_classlike_name
      *
-     * @return ClassLikeStorage
      * @throws \InvalidArgumentException when class does not exist
+     *
+     * @return ClassLikeStorage
      */
     public function get($fq_classlike_name)
     {
@@ -82,8 +83,8 @@ class ClassLikeStorageProvider
 
         $cached_value = $this->cache->getLatestFromCache($fq_classlike_name_lc, $file_path, $file_contents);
 
-        self::$storage[$fq_classlike_name_lc] =  $cached_value;
-        self::$new_storage[$fq_classlike_name_lc] =  $cached_value;
+        self::$storage[$fq_classlike_name_lc] = $cached_value;
+        self::$new_storage[$fq_classlike_name_lc] = $cached_value;
 
         return $cached_value;
     }
@@ -106,6 +107,7 @@ class ClassLikeStorageProvider
 
     /**
      * @param array<string, ClassLikeStorage> $more
+     *
      * @return void
      */
     public function addMore(array $more)
diff --git a/src/Psalm/Internal/Provider/FileProvider.php b/src/Psalm/Internal/Provider/FileProvider.php
index 467deff9e..c1b4a3cf9 100644
--- a/src/Psalm/Internal/Provider/FileProvider.php
+++ b/src/Psalm/Internal/Provider/FileProvider.php
@@ -1,12 +1,12 @@
 <?php
 namespace Psalm\Internal\Provider;
 
-use function strtolower;
+use function file_exists;
 use function file_get_contents;
 use function file_put_contents;
 use function filemtime;
-use function file_exists;
 use function in_array;
+use function strtolower;
 
 class FileProvider
 {
@@ -117,8 +117,7 @@ class FileProvider
      */
     public function closeFile(string $file_path)
     {
-        unset($this->temp_files[strtolower($file_path)]);
-        unset($this->open_files[strtolower($file_path)]);
+        unset($this->temp_files[strtolower($file_path)], $this->open_files[strtolower($file_path)]);
     }
 
     /**
diff --git a/src/Psalm/Internal/Provider/FileReferenceCacheProvider.php b/src/Psalm/Internal/Provider/FileReferenceCacheProvider.php
index e63dd78d7..fef8fca4b 100644
--- a/src/Psalm/Internal/Provider/FileReferenceCacheProvider.php
+++ b/src/Psalm/Internal/Provider/FileReferenceCacheProvider.php
@@ -1,15 +1,15 @@
 <?php
 namespace Psalm\Internal\Provider;
 
-use Psalm\Config;
 use const DIRECTORY_SEPARATOR;
-use function is_readable;
-use function unserialize;
+use function file_exists;
 use function file_get_contents;
-use function is_array;
 use function file_put_contents;
+use function is_array;
+use function is_readable;
+use Psalm\Config;
 use function serialize;
-use function file_exists;
+use function unserialize;
 
 /**
  * @psalm-type  IssueData = array{
@@ -496,6 +496,7 @@ class FileReferenceCacheProvider
 
     /**
      * @param array<string, array<string, int>> $analyzed_methods
+     *
      * @return void
      */
     public function setAnalyzedMethodCache(array $analyzed_methods)
@@ -545,6 +546,7 @@ class FileReferenceCacheProvider
              *  >
              */
             $file_maps_cache = unserialize(file_get_contents($file_maps_cache_location));
+
             return $file_maps_cache;
         }
 
@@ -560,6 +562,7 @@ class FileReferenceCacheProvider
      *          2: array<int, array{0: int, 1: string, 2: int}>
      *      }
      *  > $file_maps
+     *
      * @return void
      */
     public function setFileMapCache(array $file_maps)
@@ -591,6 +594,7 @@ class FileReferenceCacheProvider
         ) {
             /** @var array<string, array{int, int}> */
             $type_coverage_cache = unserialize(file_get_contents($type_coverage_cache_location));
+
             return $type_coverage_cache;
         }
 
@@ -599,6 +603,7 @@ class FileReferenceCacheProvider
 
     /**
      * @param array<string, array{int, int}> $mixed_counts
+     *
      * @return void
      */
     public function setTypeCoverage(array $mixed_counts)
@@ -629,6 +634,7 @@ class FileReferenceCacheProvider
         ) {
             /** @var string */
             $file_maps_cache = unserialize(file_get_contents($config_hash_cache_location));
+
             return $file_maps_cache;
         }
 
diff --git a/src/Psalm/Internal/Provider/FileReferenceProvider.php b/src/Psalm/Internal/Provider/FileReferenceProvider.php
index abe04c0e0..f6a8ecfaa 100644
--- a/src/Psalm/Internal/Provider/FileReferenceProvider.php
+++ b/src/Psalm/Internal/Provider/FileReferenceProvider.php
@@ -1,15 +1,15 @@
 <?php
 namespace Psalm\Internal\Provider;
 
-use Psalm\Internal\Analyzer\ClassLikeAnalyzer;
-use Psalm\Codebase;
-use Psalm\CodeLocation;
 use function array_filter;
 use function array_keys;
-use function file_exists;
-use function array_merge_recursive;
 use function array_merge;
+use function array_merge_recursive;
 use function array_unique;
+use function file_exists;
+use Psalm\Codebase;
+use Psalm\CodeLocation;
+use Psalm\Internal\Analyzer\ClassLikeAnalyzer;
 
 /**
  * @psalm-type  IssueData = array{
@@ -411,6 +411,7 @@ class FileReferenceProvider
 
     /**
      * @param bool $force_reload
+     *
      * @return bool
      * @psalm-suppress MixedAssignment
      * @psalm-suppress MixedTypeCoercion
@@ -891,6 +892,7 @@ class FileReferenceProvider
 
     /**
      * @param string $file_path
+     *
      * @return void
      */
     public function clearExistingIssuesForFile($file_path)
@@ -901,6 +903,7 @@ class FileReferenceProvider
     /**
      * @param string $file_path
      * @param IssueData $issue
+     *
      * @return void
      */
     public function clearExistingFileMapsForFile($file_path)
@@ -910,6 +913,7 @@ class FileReferenceProvider
 
     /**
      * @param string $file_path
+     *
      * @return void
      */
     public function addIssue($file_path, array $issue)
@@ -928,6 +932,7 @@ class FileReferenceProvider
 
     /**
      * @param array<string, array<string, int>> $analyzed_methods
+     *
      * @return  void
      */
     public function setAnalyzedMethods(array $analyzed_methods)
@@ -960,6 +965,7 @@ class FileReferenceProvider
 
     /**
      * @param array<string, array{int, int}> $mixed_counts
+     *
      * @return  void
      */
     public function setTypeCoverage(array $mixed_counts)
diff --git a/src/Psalm/Internal/Provider/FileStorageCacheProvider.php b/src/Psalm/Internal/Provider/FileStorageCacheProvider.php
index 7c117702e..8c372ffd6 100644
--- a/src/Psalm/Internal/Provider/FileStorageCacheProvider.php
+++ b/src/Psalm/Internal/Provider/FileStorageCacheProvider.php
@@ -1,25 +1,25 @@
 <?php
 namespace Psalm\Internal\Provider;
 
-use Psalm\Config;
-use Psalm\Storage\FileStorage;
-use function dirname;
-use const DIRECTORY_SEPARATOR;
 use function array_merge;
+use const DIRECTORY_SEPARATOR;
+use function dirname;
 use function file_exists;
-use function filemtime;
-use function strtolower;
+use function file_get_contents;
 use function file_put_contents;
-use function igbinary_serialize;
-use function serialize;
+use function filemtime;
 use function get_class;
-use function unlink;
-use function sha1;
+use function igbinary_serialize;
 use function igbinary_unserialize;
-use function file_get_contents;
-use function unserialize;
 use function is_dir;
 use function mkdir;
+use Psalm\Config;
+use Psalm\Storage\FileStorage;
+use function serialize;
+use function sha1;
+use function strtolower;
+use function unlink;
+use function unserialize;
 
 /**
  * @internal
diff --git a/src/Psalm/Internal/Provider/FileStorageProvider.php b/src/Psalm/Internal/Provider/FileStorageProvider.php
index 0b1a6b570..b2bccd0ba 100644
--- a/src/Psalm/Internal/Provider/FileStorageProvider.php
+++ b/src/Psalm/Internal/Provider/FileStorageProvider.php
@@ -1,9 +1,9 @@
 <?php
 namespace Psalm\Internal\Provider;
 
+use function array_merge;
 use Psalm\Storage\FileStorage;
 use function strtolower;
-use function array_merge;
 
 /**
  * @internal
@@ -114,6 +114,7 @@ class FileStorageProvider
 
     /**
      * @param array<string, FileStorage> $more
+     *
      * @return void
      */
     public function addMore(array $more)
diff --git a/src/Psalm/Internal/Provider/FunctionExistenceProvider.php b/src/Psalm/Internal/Provider/FunctionExistenceProvider.php
index d62b10cfc..d63f6fb47 100644
--- a/src/Psalm/Internal/Provider/FunctionExistenceProvider.php
+++ b/src/Psalm/Internal/Provider/FunctionExistenceProvider.php
@@ -1,13 +1,12 @@
 <?php
-
 namespace Psalm\Internal\Provider;
 
+use const PHP_VERSION;
 use PhpParser;
+use Psalm\Plugin\Hook\FunctionExistenceProviderInterface;
 use Psalm\StatementsSource;
-use \Psalm\Plugin\Hook\FunctionExistenceProviderInterface;
-use function version_compare;
-use const PHP_VERSION;
 use function strtolower;
+use function version_compare;
 
 class FunctionExistenceProvider
 {
@@ -30,6 +29,7 @@ class FunctionExistenceProvider
     /**
      * @param  class-string<FunctionExistenceProviderInterface> $class
      * @psalm-suppress PossiblyUnusedParam
+     *
      * @return void
      */
     public function registerClass(string $class)
@@ -37,6 +37,7 @@ class FunctionExistenceProvider
         if (version_compare(PHP_VERSION, '7.1.0') >= 0) {
             /**
              * @psalm-suppress UndefinedMethod
+             *
              * @var \Closure
              */
             $callable = \Closure::fromCallable([$class, 'doesFunctionExist']);
@@ -75,6 +76,7 @@ class FunctionExistenceProvider
 
     /**
      * @param  array<PhpParser\Node\Arg>  $call_args
+     *
      * @return ?bool
      */
     public function doesFunctionExist(
diff --git a/src/Psalm/Internal/Provider/FunctionParamsProvider.php b/src/Psalm/Internal/Provider/FunctionParamsProvider.php
index 672809748..5ed12b1e8 100644
--- a/src/Psalm/Internal/Provider/FunctionParamsProvider.php
+++ b/src/Psalm/Internal/Provider/FunctionParamsProvider.php
@@ -1,15 +1,14 @@
 <?php
-
 namespace Psalm\Internal\Provider;
 
+use const PHP_VERSION;
 use PhpParser;
-use Psalm\Context;
 use Psalm\CodeLocation;
-use Psalm\StatementsSource;
+use Psalm\Context;
 use Psalm\Plugin\Hook\FunctionParamsProviderInterface;
-use function version_compare;
-use const PHP_VERSION;
+use Psalm\StatementsSource;
 use function strtolower;
+use function version_compare;
 
 class FunctionParamsProvider
 {
@@ -35,6 +34,7 @@ class FunctionParamsProvider
     /**
      * @param  class-string<FunctionParamsProviderInterface> $class
      * @psalm-suppress PossiblyUnusedParam
+     *
      * @return void
      */
     public function registerClass(string $class)
@@ -42,6 +42,7 @@ class FunctionParamsProvider
         if (version_compare(PHP_VERSION, '7.1.0') >= 0) {
             /**
              * @psalm-suppress UndefinedMethod
+             *
              * @var \Closure
              */
             $callable = \Closure::fromCallable([$class, 'getFunctionParams']);
@@ -82,6 +83,7 @@ class FunctionParamsProvider
 
     /**
      * @param array<PhpParser\Node\Arg>  $call_args
+     *
      * @return  ?array<int, \Psalm\Storage\FunctionLikeParameter>
      */
     public function getFunctionParams(
diff --git a/src/Psalm/Internal/Provider/FunctionReturnTypeProvider.php b/src/Psalm/Internal/Provider/FunctionReturnTypeProvider.php
index 6e7451300..15d2cc969 100644
--- a/src/Psalm/Internal/Provider/FunctionReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/FunctionReturnTypeProvider.php
@@ -1,16 +1,15 @@
 <?php
-
 namespace Psalm\Internal\Provider;
 
+use const PHP_VERSION;
 use PhpParser;
-use Psalm\Context;
 use Psalm\CodeLocation;
-use Psalm\Type;
+use Psalm\Context;
+use Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface;
 use Psalm\StatementsSource;
-use \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface;
-use function version_compare;
-use const PHP_VERSION;
+use Psalm\Type;
 use function strtolower;
+use function version_compare;
 
 class FunctionReturnTypeProvider
 {
@@ -57,6 +56,7 @@ class FunctionReturnTypeProvider
     /**
      * @param  class-string<FunctionReturnTypeProviderInterface> $class
      * @psalm-suppress PossiblyUnusedParam
+     *
      * @return void
      */
     public function registerClass(string $class)
@@ -64,6 +64,7 @@ class FunctionReturnTypeProvider
         if (version_compare(PHP_VERSION, '7.1.0') >= 0) {
             /**
              * @psalm-suppress UndefinedMethod
+             *
              * @var \Closure
              */
             $callable = \Closure::fromCallable([$class, 'getFunctionReturnType']);
@@ -105,6 +106,7 @@ class FunctionReturnTypeProvider
 
     /**
      * @param  array<PhpParser\Node\Arg>  $call_args
+     *
      * @return ?Type\Union
      */
     public function getReturnType(
diff --git a/src/Psalm/Internal/Provider/MethodExistenceProvider.php b/src/Psalm/Internal/Provider/MethodExistenceProvider.php
index 2d982cc65..5442f52f2 100644
--- a/src/Psalm/Internal/Provider/MethodExistenceProvider.php
+++ b/src/Psalm/Internal/Provider/MethodExistenceProvider.php
@@ -1,14 +1,13 @@
 <?php
-
 namespace Psalm\Internal\Provider;
 
+use const PHP_VERSION;
 use PhpParser;
 use Psalm\CodeLocation;
-use Psalm\StatementsSource;
 use Psalm\Plugin\Hook\MethodExistenceProviderInterface;
-use function version_compare;
-use const PHP_VERSION;
+use Psalm\StatementsSource;
 use function strtolower;
+use function version_compare;
 
 class MethodExistenceProvider
 {
@@ -33,6 +32,7 @@ class MethodExistenceProvider
     /**
      * @param  class-string<MethodExistenceProviderInterface> $class
      * @psalm-suppress PossiblyUnusedParam
+     *
      * @return void
      */
     public function registerClass(string $class)
@@ -40,6 +40,7 @@ class MethodExistenceProvider
         if (version_compare(PHP_VERSION, '7.1.0') >= 0) {
             /**
              * @psalm-suppress UndefinedMethod
+             *
              * @var \Closure
              */
             $callable = \Closure::fromCallable([$class, 'doesMethodExist']);
@@ -80,6 +81,7 @@ class MethodExistenceProvider
 
     /**
      * @param  array<PhpParser\Node\Arg>  $call_args
+     *
      * @return ?bool
      */
     public function doesMethodExist(
diff --git a/src/Psalm/Internal/Provider/MethodParamsProvider.php b/src/Psalm/Internal/Provider/MethodParamsProvider.php
index 6c643aa17..b8ce7dbc1 100644
--- a/src/Psalm/Internal/Provider/MethodParamsProvider.php
+++ b/src/Psalm/Internal/Provider/MethodParamsProvider.php
@@ -1,15 +1,14 @@
 <?php
-
 namespace Psalm\Internal\Provider;
 
+use const PHP_VERSION;
 use PhpParser;
-use Psalm\Context;
 use Psalm\CodeLocation;
-use Psalm\StatementsSource;
+use Psalm\Context;
 use Psalm\Plugin\Hook\MethodParamsProviderInterface;
-use function version_compare;
-use const PHP_VERSION;
+use Psalm\StatementsSource;
 use function strtolower;
+use function version_compare;
 
 class MethodParamsProvider
 {
@@ -38,6 +37,7 @@ class MethodParamsProvider
     /**
      * @param  class-string<MethodParamsProviderInterface> $class
      * @psalm-suppress PossiblyUnusedParam
+     *
      * @return void
      */
     public function registerClass(string $class)
@@ -45,6 +45,7 @@ class MethodParamsProvider
         if (version_compare(PHP_VERSION, '7.1.0') >= 0) {
             /**
              * @psalm-suppress UndefinedMethod
+             *
              * @var \Closure
              */
             $callable = \Closure::fromCallable([$class, 'getMethodParams']);
@@ -86,6 +87,7 @@ class MethodParamsProvider
 
     /**
      * @param ?array<PhpParser\Node\Arg>  $call_args
+     *
      * @return  ?array<int, \Psalm\Storage\FunctionLikeParameter>
      */
     public function getMethodParams(
diff --git a/src/Psalm/Internal/Provider/MethodReturnTypeProvider.php b/src/Psalm/Internal/Provider/MethodReturnTypeProvider.php
index cf1ea9319..94b6cb11a 100644
--- a/src/Psalm/Internal/Provider/MethodReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/MethodReturnTypeProvider.php
@@ -1,16 +1,15 @@
 <?php
-
 namespace Psalm\Internal\Provider;
 
+use const PHP_VERSION;
 use PhpParser;
-use Psalm\Context;
 use Psalm\CodeLocation;
-use Psalm\Type;
-use Psalm\StatementsSource;
+use Psalm\Context;
 use Psalm\Plugin\Hook\MethodReturnTypeProviderInterface;
-use function version_compare;
-use const PHP_VERSION;
+use Psalm\StatementsSource;
+use Psalm\Type;
 use function strtolower;
+use function version_compare;
 
 class MethodReturnTypeProvider
 {
@@ -43,6 +42,7 @@ class MethodReturnTypeProvider
     /**
      * @param  class-string<MethodReturnTypeProviderInterface> $class
      * @psalm-suppress PossiblyUnusedParam
+     *
      * @return void
      */
     public function registerClass(string $class)
@@ -50,6 +50,7 @@ class MethodReturnTypeProvider
         if (version_compare(PHP_VERSION, '7.1.0') >= 0) {
             /**
              * @psalm-suppress UndefinedMethod
+             *
              * @var \Closure
              */
             $callable = \Closure::fromCallable([$class, 'getMethodReturnType']);
@@ -95,6 +96,7 @@ class MethodReturnTypeProvider
     /**
      * @param array<PhpParser\Node\Arg>  $call_args
      * @param  ?array<Type\Union> $template_type_parameters
+     *
      * @return  ?Type\Union
      */
     public function getReturnType(
diff --git a/src/Psalm/Internal/Provider/MethodVisibilityProvider.php b/src/Psalm/Internal/Provider/MethodVisibilityProvider.php
index 86222316b..37c2d5857 100644
--- a/src/Psalm/Internal/Provider/MethodVisibilityProvider.php
+++ b/src/Psalm/Internal/Provider/MethodVisibilityProvider.php
@@ -1,15 +1,14 @@
 <?php
-
 namespace Psalm\Internal\Provider;
 
+use const PHP_VERSION;
 use PhpParser;
-use Psalm\Context;
 use Psalm\CodeLocation;
-use Psalm\StatementsSource;
+use Psalm\Context;
 use Psalm\Plugin\Hook\MethodVisibilityProviderInterface;
-use function version_compare;
-use const PHP_VERSION;
+use Psalm\StatementsSource;
 use function strtolower;
+use function version_compare;
 
 class MethodVisibilityProvider
 {
@@ -35,6 +34,7 @@ class MethodVisibilityProvider
     /**
      * @param  class-string<MethodVisibilityProviderInterface> $class
      * @psalm-suppress PossiblyUnusedParam
+     *
      * @return void
      */
     public function registerClass(string $class)
@@ -42,6 +42,7 @@ class MethodVisibilityProvider
         if (version_compare(PHP_VERSION, '7.1.0') >= 0) {
             /**
              * @psalm-suppress UndefinedMethod
+             *
              * @var \Closure
              */
             $callable = \Closure::fromCallable([$class, 'isMethodVisible']);
@@ -83,6 +84,7 @@ class MethodVisibilityProvider
 
     /**
      * @param  array<PhpParser\Node\Arg>  $call_args
+     *
      * @return ?bool
      */
     public function isMethodVisible(
diff --git a/src/Psalm/Internal/Provider/ParserCacheProvider.php b/src/Psalm/Internal/Provider/ParserCacheProvider.php
index 958c74ab7..26b657fca 100644
--- a/src/Psalm/Internal/Provider/ParserCacheProvider.php
+++ b/src/Psalm/Internal/Provider/ParserCacheProvider.php
@@ -1,30 +1,30 @@
 <?php
 namespace Psalm\Internal\Provider;
 
-use PhpParser;
-use Psalm\Config;
 use const DIRECTORY_SEPARATOR;
-use function is_readable;
+use function error_log;
+use function file_exists;
+use function file_get_contents;
+use function file_put_contents;
 use function filemtime;
+use function gettype;
+use function igbinary_serialize;
 use function igbinary_unserialize;
-use function file_get_contents;
-use function unserialize;
-use function error_log;
-use function json_decode;
 use function is_array;
-use function gettype;
-use function touch;
 use function is_dir;
-use function mkdir;
-use function file_put_contents;
-use function igbinary_serialize;
-use function serialize;
+use function is_readable;
+use function is_writable;
+use function json_decode;
 use function json_encode;
-use function file_exists;
+use function md5;
+use function mkdir;
+use PhpParser;
+use Psalm\Config;
 use function scandir;
-use function is_writable;
+use function serialize;
+use function touch;
 use function unlink;
-use function md5;
+use function unserialize;
 
 /**
  * @internal
@@ -184,6 +184,7 @@ class ParserCacheProvider
                 if (!$hashes_encoded) {
                     error_log('Unexpected value when loading from file content hashes');
                     $this->existing_file_content_hashes = [];
+
                     return [];
                 }
 
@@ -193,6 +194,7 @@ class ParserCacheProvider
                 if (!is_array($hashes_decoded)) {
                     error_log('Unexpected value ' . gettype($hashes_decoded));
                     $this->existing_file_content_hashes = [];
+
                     return [];
                 }
 
@@ -259,6 +261,7 @@ class ParserCacheProvider
 
     /**
      * @param array<string, string> $file_content_hashes
+     *
      * @return void
      */
     public function addNewFileContentHashes(array $file_content_hashes)
diff --git a/src/Psalm/Internal/Provider/PropertyExistenceProvider.php b/src/Psalm/Internal/Provider/PropertyExistenceProvider.php
index 1e4cb946d..8a54c78eb 100644
--- a/src/Psalm/Internal/Provider/PropertyExistenceProvider.php
+++ b/src/Psalm/Internal/Provider/PropertyExistenceProvider.php
@@ -1,15 +1,14 @@
 <?php
-
 namespace Psalm\Internal\Provider;
 
+use const PHP_VERSION;
 use PhpParser;
-use Psalm\Context;
 use Psalm\CodeLocation;
-use Psalm\StatementsSource;
+use Psalm\Context;
 use Psalm\Plugin\Hook\PropertyExistenceProviderInterface;
-use function version_compare;
-use const PHP_VERSION;
+use Psalm\StatementsSource;
 use function strtolower;
+use function version_compare;
 
 class PropertyExistenceProvider
 {
@@ -36,6 +35,7 @@ class PropertyExistenceProvider
     /**
      * @param  class-string<PropertyExistenceProviderInterface> $class
      * @psalm-suppress PossiblyUnusedParam
+     *
      * @return void
      */
     public function registerClass(string $class)
@@ -43,6 +43,7 @@ class PropertyExistenceProvider
         if (version_compare(PHP_VERSION, '7.1.0') >= 0) {
             /**
              * @psalm-suppress UndefinedMethod
+             *
              * @var \Closure
              */
             $callable = \Closure::fromCallable([$class, 'doesPropertyExist']);
@@ -84,6 +85,7 @@ class PropertyExistenceProvider
 
     /**
      * @param  array<PhpParser\Node\Arg>  $call_args
+     *
      * @return ?bool
      */
     public function doesPropertyExist(
diff --git a/src/Psalm/Internal/Provider/PropertyTypeProvider.php b/src/Psalm/Internal/Provider/PropertyTypeProvider.php
index 90c2fa1c1..3113126b8 100644
--- a/src/Psalm/Internal/Provider/PropertyTypeProvider.php
+++ b/src/Psalm/Internal/Provider/PropertyTypeProvider.php
@@ -1,15 +1,14 @@
 <?php
-
 namespace Psalm\Internal\Provider;
 
+use const PHP_VERSION;
 use PhpParser;
 use Psalm\Context;
-use Psalm\Type;
-use Psalm\StatementsSource;
 use Psalm\Plugin\Hook\PropertyTypeProviderInterface;
-use function version_compare;
-use const PHP_VERSION;
+use Psalm\StatementsSource;
+use Psalm\Type;
 use function strtolower;
+use function version_compare;
 
 class PropertyTypeProvider
 {
@@ -35,6 +34,7 @@ class PropertyTypeProvider
     /**
      * @param  class-string<PropertyTypeProviderInterface> $class
      * @psalm-suppress PossiblyUnusedParam
+     *
      * @return void
      */
     public function registerClass(string $class)
@@ -42,6 +42,7 @@ class PropertyTypeProvider
         if (version_compare(PHP_VERSION, '7.1.0') >= 0) {
             /**
              * @psalm-suppress UndefinedMethod
+             *
              * @var \Closure
              */
             $callable = \Closure::fromCallable([$class, 'getPropertyType']);
@@ -83,6 +84,7 @@ class PropertyTypeProvider
 
     /**
      * @param  array<PhpParser\Node\Arg>  $call_args
+     *
      * @return ?Type\Union
      */
     public function getPropertyType(
diff --git a/src/Psalm/Internal/Provider/PropertyVisibilityProvider.php b/src/Psalm/Internal/Provider/PropertyVisibilityProvider.php
index 270175d0e..9066688b1 100644
--- a/src/Psalm/Internal/Provider/PropertyVisibilityProvider.php
+++ b/src/Psalm/Internal/Provider/PropertyVisibilityProvider.php
@@ -1,15 +1,14 @@
 <?php
-
 namespace Psalm\Internal\Provider;
 
+use const PHP_VERSION;
 use PhpParser;
-use Psalm\Context;
 use Psalm\CodeLocation;
-use Psalm\StatementsSource;
+use Psalm\Context;
 use Psalm\Plugin\Hook\PropertyVisibilityProviderInterface;
-use function version_compare;
-use const PHP_VERSION;
+use Psalm\StatementsSource;
 use function strtolower;
+use function version_compare;
 
 class PropertyVisibilityProvider
 {
@@ -36,6 +35,7 @@ class PropertyVisibilityProvider
     /**
      * @param  class-string<PropertyVisibilityProviderInterface> $class
      * @psalm-suppress PossiblyUnusedParam
+     *
      * @return void
      */
     public function registerClass(string $class)
@@ -43,6 +43,7 @@ class PropertyVisibilityProvider
         if (version_compare(PHP_VERSION, '7.1.0') >= 0) {
             /**
              * @psalm-suppress UndefinedMethod
+             *
              * @var \Closure
              */
             $callable = \Closure::fromCallable([$class, 'isPropertyVisible']);
@@ -85,6 +86,7 @@ class PropertyVisibilityProvider
 
     /**
      * @param  array<PhpParser\Node\Arg>  $call_args
+     *
      * @return ?bool
      */
     public function isPropertyVisible(
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayColumnReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayColumnReturnTypeProvider.php
index 3bcf507e3..3b09195f9 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayColumnReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayColumnReturnTypeProvider.php
@@ -1,14 +1,13 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
+use function assert;
 use PhpParser;
 use Psalm\CodeLocation;
 use Psalm\Context;
-use Psalm\Type;
-use Psalm\StatementsSource;
 use Psalm\Internal\Codebase\CallMap;
-use function assert;
+use Psalm\StatementsSource;
+use Psalm\Type;
 
 class ArrayColumnReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
 {
@@ -51,7 +50,7 @@ class ArrayColumnReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturn
         $value_column_name = null;
         // calculate value column name
         if (isset($call_args[1]->value->inferredType)) {
-            $value_column_name_arg= $call_args[1]->value->inferredType;
+            $value_column_name_arg = $call_args[1]->value->inferredType;
             if ($value_column_name_arg->isSingleIntLiteral()) {
                 $value_column_name = $value_column_name_arg->getSingleIntLiteral()->value;
             } elseif ($value_column_name_arg->isSingleStringLiteral()) {
@@ -89,8 +88,8 @@ class ArrayColumnReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturn
             return new Type\Union([
                 new Type\Atomic\TArray([
                     $result_key_type,
-                    $result_element_type
-                ])
+                    $result_element_type,
+                ]),
             ]);
         }
 
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayFilterReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayFilterReturnTypeProvider.php
index 8f1e96924..10d0c6375 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayFilterReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayFilterReturnTypeProvider.php
@@ -1,21 +1,20 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
+use function array_map;
+use function assert;
+use function count;
+use function is_string;
 use PhpParser;
 use Psalm\CodeLocation;
 use Psalm\Context;
+use Psalm\Internal\Analyzer\Statements\Expression\AssertionFinder;
 use Psalm\Internal\Codebase\CallMap;
-use Psalm\IssueBuffer;
 use Psalm\Issue\InvalidReturnType;
+use Psalm\IssueBuffer;
 use Psalm\StatementsSource;
-use Psalm\Internal\Analyzer\Statements\Expression\AssertionFinder;
 use Psalm\Type;
 use Psalm\Type\Reconciler;
-use function array_map;
-use function count;
-use function is_string;
-use function assert;
 
 class ArrayFilterReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
 {
@@ -98,7 +97,7 @@ class ArrayFilterReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturn
                                             $callable->params
                                         )
                                     )
-                                )
+                                ),
                             ],
                         ]);
 
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayMapReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayMapReturnTypeProvider.php
index 2ef6f7d38..86cb4b475 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayMapReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayMapReturnTypeProvider.php
@@ -1,21 +1,20 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
+use function array_map;
+use function count;
+use function explode;
+use function in_array;
 use PhpParser;
 use Psalm\CodeLocation;
 use Psalm\Context;
-use Psalm\StatementsSource;
 use Psalm\Internal\Analyzer\Statements\Expression\CallAnalyzer;
 use Psalm\Internal\Analyzer\Statements\ExpressionAnalyzer;
 use Psalm\Internal\Codebase\CallMap;
+use Psalm\StatementsSource;
 use Psalm\Type;
-use function count;
-use function array_map;
-use function strtolower;
-use function explode;
 use function strpos;
-use function in_array;
+use function strtolower;
 
 class ArrayMapReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
 {
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayMergeReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayMergeReturnTypeProvider.php
index 072eca632..a5ccf60fc 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayMergeReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayMergeReturnTypeProvider.php
@@ -1,15 +1,14 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
+use function array_merge;
+use function array_values;
 use PhpParser;
-use Psalm\Context;
 use Psalm\CodeLocation;
-use Psalm\Type;
+use Psalm\Context;
 use Psalm\Internal\Type\TypeCombination;
 use Psalm\StatementsSource;
-use function array_merge;
-use function array_values;
+use Psalm\Type;
 
 class ArrayMergeReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
 {
@@ -78,7 +77,7 @@ class ArrayMergeReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnT
                             ) {
                                 $unpacked_type_part = new Type\Atomic\TArray([
                                     Type::getArrayKey(),
-                                    Type::getMixed(true)
+                                    Type::getMixed(true),
                                 ]);
                             } else {
                                 return Type::getArray();
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayPointerAdjustmentReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayPointerAdjustmentReturnTypeProvider.php
index 16efca520..d56467109 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayPointerAdjustmentReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayPointerAdjustmentReturnTypeProvider.php
@@ -1,12 +1,11 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
 use PhpParser;
 use Psalm\CodeLocation;
 use Psalm\Context;
-use Psalm\Type;
 use Psalm\StatementsSource;
+use Psalm\Type;
 
 class ArrayPointerAdjustmentReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
 {
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayPopReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayPopReturnTypeProvider.php
index 979592f5f..fcfa36647 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayPopReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayPopReturnTypeProvider.php
@@ -1,12 +1,11 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
 use PhpParser;
 use Psalm\CodeLocation;
 use Psalm\Context;
-use Psalm\Type;
 use Psalm\StatementsSource;
+use Psalm\Type;
 
 class ArrayPopReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
 {
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayRandReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayRandReturnTypeProvider.php
index 778fa3858..b040755ef 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayRandReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayRandReturnTypeProvider.php
@@ -1,12 +1,11 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
 use PhpParser;
 use Psalm\CodeLocation;
 use Psalm\Context;
-use Psalm\Type;
 use Psalm\StatementsSource;
+use Psalm\Type;
 
 class ArrayRandReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
 {
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayReduceReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayReduceReturnTypeProvider.php
index 268c8b713..be6c5ae0b 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayReduceReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayReduceReturnTypeProvider.php
@@ -1,22 +1,21 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
+use function count;
+use function explode;
+use function in_array;
 use PhpParser;
 use Psalm\CodeLocation;
 use Psalm\Context;
-use Psalm\Type;
-use Psalm\StatementsSource;
 use Psalm\Internal\Analyzer\Statements\Expression\CallAnalyzer;
 use Psalm\Internal\Analyzer\TypeAnalyzer;
 use Psalm\Internal\Codebase\CallMap;
-use Psalm\IssueBuffer;
 use Psalm\Issue\InvalidArgument;
-use function count;
-use function strtolower;
-use function explode;
+use Psalm\IssueBuffer;
+use Psalm\StatementsSource;
+use Psalm\Type;
 use function strpos;
-use function in_array;
+use function strtolower;
 
 class ArrayReduceReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
 {
@@ -113,18 +112,21 @@ class ArrayReduceReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturn
                 $item_param = $closure_atomic_type->params[1];
 
                 if ($carry_param->type
-                    && (!TypeAnalyzer::isContainedBy(
-                        $codebase,
-                        $initial_type,
-                        $carry_param->type
-                    ) || (!$reduce_return_type->hasMixed()
-                            && !TypeAnalyzer::isContainedBy(
-                                $codebase,
-                                $reduce_return_type,
-                                $carry_param->type
+                    && (
+                        !TypeAnalyzer::isContainedBy(
+                            $codebase,
+                            $initial_type,
+                            $carry_param->type
+                        )
+                        || (
+                            !$reduce_return_type->hasMixed()
+                                && !TypeAnalyzer::isContainedBy(
+                                    $codebase,
+                                    $reduce_return_type,
+                                    $carry_param->type
+                                )
                             )
                         )
-                    )
                 ) {
                     if (IssueBuffer::accepts(
                         new InvalidArgument(
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayReverseReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayReverseReturnTypeProvider.php
index cf2c00820..8ce9ed8a7 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayReverseReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArrayReverseReturnTypeProvider.php
@@ -1,12 +1,11 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
 use PhpParser;
 use Psalm\CodeLocation;
 use Psalm\Context;
-use Psalm\Type;
 use Psalm\StatementsSource;
+use Psalm\Type;
 
 class ArrayReverseReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
 {
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArraySliceReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArraySliceReturnTypeProvider.php
index 4247d79e9..15566fe55 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/ArraySliceReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/ArraySliceReturnTypeProvider.php
@@ -1,12 +1,11 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
 use PhpParser;
 use Psalm\CodeLocation;
 use Psalm\Context;
-use Psalm\Type;
 use Psalm\StatementsSource;
+use Psalm\Type;
 use function strtolower;
 
 class ArraySliceReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/DomNodeAppendChild.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/DomNodeAppendChild.php
index fdd29b0e7..fcc6a13e4 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/DomNodeAppendChild.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/DomNodeAppendChild.php
@@ -1,5 +1,4 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
 use PhpParser;
@@ -17,6 +16,7 @@ class DomNodeAppendChild implements \Psalm\Plugin\Hook\MethodReturnTypeProviderI
 
     /**
      * @param  array<PhpParser\Node\Arg>    $call_args
+     *
      * @return ?Type\Union
      */
     public static function getMethodReturnType(
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/FilterVarReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/FilterVarReturnTypeProvider.php
index d96659969..410027165 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/FilterVarReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/FilterVarReturnTypeProvider.php
@@ -1,12 +1,11 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
 use PhpParser;
 use Psalm\CodeLocation;
 use Psalm\Context;
-use Psalm\Type;
 use Psalm\StatementsSource;
+use Psalm\Type;
 
 class FilterVarReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
 {
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/FirstArgStringReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/FirstArgStringReturnTypeProvider.php
index 8fb208e9b..62126bfdd 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/FirstArgStringReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/FirstArgStringReturnTypeProvider.php
@@ -1,12 +1,11 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
 use PhpParser;
-use Psalm\Context;
 use Psalm\CodeLocation;
-use Psalm\Type;
+use Psalm\Context;
 use Psalm\StatementsSource;
+use Psalm\Type;
 
 class FirstArgStringReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
 {
@@ -14,7 +13,7 @@ class FirstArgStringReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionRet
     {
         return [
             'crypt',
-            'date'
+            'date',
         ];
     }
 
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/GetClassMethodsReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/GetClassMethodsReturnTypeProvider.php
index 975b81acc..33aec8807 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/GetClassMethodsReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/GetClassMethodsReturnTypeProvider.php
@@ -1,19 +1,18 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
 use PhpParser;
-use Psalm\Context;
 use Psalm\CodeLocation;
-use Psalm\Type;
+use Psalm\Context;
 use Psalm\StatementsSource;
+use Psalm\Type;
 
 class GetClassMethodsReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
 {
     public static function getFunctionIds() : array
     {
         return [
-            'get_class_methods'
+            'get_class_methods',
         ];
     }
 
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/GetObjectVarsReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/GetObjectVarsReturnTypeProvider.php
index eeb1d612b..7d67369c6 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/GetObjectVarsReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/GetObjectVarsReturnTypeProvider.php
@@ -1,19 +1,18 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
 use PhpParser;
-use Psalm\Context;
 use Psalm\CodeLocation;
-use Psalm\Type;
+use Psalm\Context;
 use Psalm\StatementsSource;
+use Psalm\Type;
 
 class GetObjectVarsReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
 {
     public static function getFunctionIds() : array
     {
         return [
-            'get_object_vars'
+            'get_object_vars',
         ];
     }
 
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/IteratorToArrayReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/IteratorToArrayReturnTypeProvider.php
index 7dbea4ccd..2271b5bc6 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/IteratorToArrayReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/IteratorToArrayReturnTypeProvider.php
@@ -1,23 +1,22 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
+use function assert;
 use PhpParser;
-use Psalm\Context;
 use Psalm\CodeLocation;
-use Psalm\Type;
-use Psalm\StatementsSource;
+use Psalm\Context;
 use Psalm\Internal\Analyzer\Statements\Block\ForeachAnalyzer;
 use Psalm\Internal\Analyzer\TypeAnalyzer;
 use Psalm\Internal\Codebase\CallMap;
-use function assert;
+use Psalm\StatementsSource;
+use Psalm\Type;
 
 class IteratorToArrayReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
 {
     public static function getFunctionIds() : array
     {
         return [
-            'iterator_to_array'
+            'iterator_to_array',
         ];
     }
 
@@ -72,8 +71,8 @@ class IteratorToArrayReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionRe
                                     && ((string) $call_args[1]->value->inferredType === 'true')))
                             ? $key_type
                             : Type::getArrayKey(),
-                        $value_type
-                    ])
+                        $value_type,
+                    ]),
                 ]);
             }
         }
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/MktimeReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/MktimeReturnTypeProvider.php
index 74f7d0b62..34d68f81b 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/MktimeReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/MktimeReturnTypeProvider.php
@@ -1,19 +1,18 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
 use PhpParser;
-use Psalm\Context;
 use Psalm\CodeLocation;
-use Psalm\Type;
+use Psalm\Context;
 use Psalm\StatementsSource;
+use Psalm\Type;
 
 class MktimeReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
 {
     public static function getFunctionIds() : array
     {
         return [
-            'mktime'
+            'mktime',
         ];
     }
 
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/ParseUrlReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/ParseUrlReturnTypeProvider.php
index 238c4c48d..fc105992a 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/ParseUrlReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/ParseUrlReturnTypeProvider.php
@@ -1,22 +1,21 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
-use PhpParser;
-use Psalm\CodeLocation;
-use Psalm\Context;
-use Psalm\Type;
-use Psalm\StatementsSource;
-use Psalm\Internal\Analyzer\TypeAnalyzer;
 use function count;
-use const PHP_URL_SCHEME;
-use const PHP_URL_USER;
-use const PHP_URL_PASS;
+use const PHP_URL_FRAGMENT;
 use const PHP_URL_HOST;
+use const PHP_URL_PASS;
 use const PHP_URL_PATH;
-use const PHP_URL_QUERY;
-use const PHP_URL_FRAGMENT;
 use const PHP_URL_PORT;
+use const PHP_URL_QUERY;
+use const PHP_URL_SCHEME;
+use const PHP_URL_USER;
+use PhpParser;
+use Psalm\CodeLocation;
+use Psalm\Context;
+use Psalm\Internal\Analyzer\TypeAnalyzer;
+use Psalm\StatementsSource;
+use Psalm\Type;
 
 class ParseUrlReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
 {
@@ -53,7 +52,7 @@ class ParseUrlReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTyp
                     ]);
 
                     $acceptable_int_component_type = new Type\Union([
-                        new Type\Atomic\TLiteralInt(PHP_URL_PORT)
+                        new Type\Atomic\TLiteralInt(PHP_URL_PORT),
                     ]);
 
                     if (TypeAnalyzer::isContainedBy(
@@ -63,7 +62,7 @@ class ParseUrlReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTyp
                     )) {
                         $nullable_string = new Type\Union([
                             new Type\Atomic\TString,
-                            new Type\Atomic\TNull
+                            new Type\Atomic\TNull,
                         ]);
 
                         $codebase = $statements_source->getCodebase();
@@ -82,7 +81,7 @@ class ParseUrlReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTyp
                     )) {
                         $nullable_int = new Type\Union([
                             new Type\Atomic\TInt,
-                            new Type\Atomic\TNull
+                            new Type\Atomic\TNull,
                         ]);
 
                         $codebase = $statements_source->getCodebase();
@@ -99,7 +98,7 @@ class ParseUrlReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTyp
             $nullable_string_or_int = new Type\Union([
                 new Type\Atomic\TString,
                 new Type\Atomic\TInt,
-                new Type\Atomic\TNull
+                new Type\Atomic\TNull,
             ]);
 
             $codebase = $statements_source->getCodebase();
@@ -124,7 +123,7 @@ class ParseUrlReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTyp
 
         $nullable_string_or_int = new Type\Union([
             new Type\Atomic\TArray([$component_key_type, Type::getMixed()]),
-            new Type\Atomic\TFalse
+            new Type\Atomic\TFalse,
         ]);
 
         $codebase = $statements_source->getCodebase();
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/PdoStatementSetFetchMode.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/PdoStatementSetFetchMode.php
index 52939bc00..84e8e0e53 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/PdoStatementSetFetchMode.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/PdoStatementSetFetchMode.php
@@ -1,5 +1,4 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
 use PhpParser;
@@ -17,6 +16,7 @@ class PdoStatementSetFetchMode implements \Psalm\Plugin\Hook\MethodParamsProvide
 
     /**
      * @param  array<PhpParser\Node\Arg>    $call_args
+     *
      * @return ?array<int, \Psalm\Storage\FunctionLikeParameter>
      */
     public static function getMethodParams(
@@ -51,7 +51,7 @@ class PdoStatementSetFetchMode implements \Psalm\Plugin\Hook\MethodParamsProvide
                         null,
                         null,
                         false
-                    )
+                    ),
                 ];
 
                 $value = $call_args[0]->value->inferredType->getSingleIntLiteral()->value;
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/RangeReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/RangeReturnTypeProvider.php
index 7e312e695..5af652ed4 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/RangeReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/RangeReturnTypeProvider.php
@@ -1,12 +1,11 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
 use PhpParser;
-use Psalm\Context;
 use Psalm\CodeLocation;
-use Psalm\Type;
+use Psalm\Context;
 use Psalm\StatementsSource;
+use Psalm\Type;
 
 class RangeReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
 {
@@ -69,13 +68,13 @@ class RangeReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypePr
         if ($all_numbers) {
             return new Type\Union([new Type\Atomic\TArray([
                 Type::getInt(),
-                new Type\Union([new Type\Atomic\TInt, new Type\Atomic\TFloat])
+                new Type\Union([new Type\Atomic\TInt, new Type\Atomic\TFloat]),
             ])]);
         }
 
         return new Type\Union([new Type\Atomic\TArray([
             Type::getInt(),
-            new Type\Union([new Type\Atomic\TInt, new Type\Atomic\TFloat, new Type\Atomic\TString])
+            new Type\Union([new Type\Atomic\TInt, new Type\Atomic\TFloat, new Type\Atomic\TString]),
         ])]);
     }
 }
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/SimpleXmlElementAsXml.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/SimpleXmlElementAsXml.php
index e90102a7b..b7ad77531 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/SimpleXmlElementAsXml.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/SimpleXmlElementAsXml.php
@@ -1,13 +1,12 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
+use function count;
 use PhpParser;
 use Psalm\CodeLocation;
 use Psalm\Context;
 use Psalm\StatementsSource;
 use Psalm\Type;
-use function count;
 
 class SimpleXmlElementAsXml implements \Psalm\Plugin\Hook\MethodReturnTypeProviderInterface
 {
@@ -18,6 +17,7 @@ class SimpleXmlElementAsXml implements \Psalm\Plugin\Hook\MethodReturnTypeProvid
 
     /**
      * @param  array<PhpParser\Node\Arg>    $call_args
+     *
      * @return ?Type\Union
      */
     public static function getMethodReturnType(
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/StrReplaceReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/StrReplaceReturnTypeProvider.php
index f990aaed2..1837a969e 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/StrReplaceReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/StrReplaceReturnTypeProvider.php
@@ -1,13 +1,12 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
+use function in_array;
 use PhpParser;
-use Psalm\Context;
 use Psalm\CodeLocation;
-use Psalm\Type;
+use Psalm\Context;
 use Psalm\StatementsSource;
-use function in_array;
+use Psalm\Type;
 
 class StrReplaceReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
 {
@@ -18,7 +17,7 @@ class StrReplaceReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnT
             'str_ireplace',
             'substr_replace',
             'preg_replace',
-            'preg_replace_callback'
+            'preg_replace_callback',
         ];
     }
 
diff --git a/src/Psalm/Internal/Provider/ReturnTypeProvider/VersionCompareReturnTypeProvider.php b/src/Psalm/Internal/Provider/ReturnTypeProvider/VersionCompareReturnTypeProvider.php
index 42d43cabf..d1ddce989 100644
--- a/src/Psalm/Internal/Provider/ReturnTypeProvider/VersionCompareReturnTypeProvider.php
+++ b/src/Psalm/Internal/Provider/ReturnTypeProvider/VersionCompareReturnTypeProvider.php
@@ -1,14 +1,13 @@
 <?php
-
 namespace Psalm\Internal\Provider\ReturnTypeProvider;
 
+use function count;
 use PhpParser;
-use Psalm\Context;
 use Psalm\CodeLocation;
-use Psalm\Type;
-use Psalm\StatementsSource;
+use Psalm\Context;
 use Psalm\Internal\Analyzer\TypeAnalyzer;
-use function count;
+use Psalm\StatementsSource;
+use Psalm\Type;
 
 class VersionCompareReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionReturnTypeProviderInterface
 {
@@ -63,14 +62,14 @@ class VersionCompareReturnTypeProvider implements \Psalm\Plugin\Hook\FunctionRet
 
             return new Type\Union([
                 new Type\Atomic\TBool,
-                new Type\Atomic\TNull
+                new Type\Atomic\TNull,
             ]);
         }
 
         return new Type\Union([
             new Type\Atomic\TLiteralInt(-1),
             new Type\Atomic\TLiteralInt(0),
-            new Type\Atomic\TLiteralInt(1)
+            new Type\Atomic\TLiteralInt(1),
         ]);
     }
 }
diff --git a/src/Psalm/Internal/Provider/StatementsProvider.php b/src/Psalm/Internal/Provider/StatementsProvider.php
index f55d4e967..55eee6c3c 100644
--- a/src/Psalm/Internal/Provider/StatementsProvider.php
+++ b/src/Psalm/Internal/Provider/StatementsProvider.php
@@ -1,20 +1,19 @@
 <?php
 namespace Psalm\Internal\Provider;
 
+use function abs;
+use function array_flip;
+use function array_intersect_key;
+use function array_map;
+use function array_merge;
+use function count;
+use function filemtime;
+use function md5;
 use PhpParser;
 use Psalm\Progress\Progress;
-use Psalm\Progress\DefaultProgress;
 use Psalm\Progress\VoidProgress;
-use function filemtime;
-use function md5;
-use function abs;
 use function strlen;
-use function count;
-use function array_map;
-use function array_flip;
 use function substr;
-use function array_intersect_key;
-use function array_merge;
 
 /**
  * @internal
@@ -181,6 +180,7 @@ class StatementsProvider
                 $unchanged_members = array_map(
                     /**
                      * @param int $_
+                     *
                      * @return bool
                      */
                     function ($_) {
@@ -192,6 +192,7 @@ class StatementsProvider
                 $unchanged_signature_members = array_map(
                     /**
                      * @param int $_
+                     *
                      * @return bool
                      */
                     function ($_) {
@@ -216,6 +217,7 @@ class StatementsProvider
                 $changed_members = array_map(
                     /**
                      * @param int $_
+                     *
                      * @return bool
                      */
                     function ($_) {
@@ -283,6 +285,7 @@ class StatementsProvider
 
     /**
      * @param array<string, array<string, bool>> $more_changed_members
+     *
      * @return void
      */
     public function addChangedMembers(array $more_changed_members)
@@ -300,6 +303,7 @@ class StatementsProvider
 
     /**
      * @param array<string, array<string, bool>> $more_unchanged_members
+     *
      * @return void
      */
     public function addUnchangedSignatureMembers(array $more_unchanged_members)
@@ -309,6 +313,7 @@ class StatementsProvider
 
     /**
      * @param string $file_path
+     *
      * @return void
      */
     public function setUnchangedFile($file_path)
@@ -328,6 +333,7 @@ class StatementsProvider
 
     /**
      * @param array<string, array<int, array{0: int, 1: int, 2: int, 3: int}>> $diff_map
+     *
      * @return void
      */
     public function addDiffMap(array $diff_map)
@@ -366,7 +372,7 @@ class StatementsProvider
         ];
 
         if (!self::$lexer) {
-            self::$lexer = new PhpParser\Lexer([ 'usedAttributes' => $attributes ]);
+            self::$lexer = new PhpParser\Lexer(['usedAttributes' => $attributes]);
         }
 
         if (!self::$parser) {
diff --git a/src/Psalm/Internal/Scope/SwitchScope.php b/src/Psalm/Internal/Scope/SwitchScope.php
index 12a1e68ea..94b7f5061 100644
--- a/src/Psalm/Internal/Scope/SwitchScope.php
+++ b/src/Psalm/Internal/Scope/SwitchScope.php
@@ -2,8 +2,8 @@
 namespace Psalm\Internal\Scope;
 
 use PhpParser;
-use Psalm\Internal\Clause;
 use Psalm\CodeLocation;
+use Psalm\Internal\Clause;
 use Psalm\Type;
 
 /**
diff --git a/src/Psalm/Internal/Stubs/Amp.php b/src/Psalm/Internal/Stubs/Amp.php
index 1674bca91..906ddac6d 100644
--- a/src/Psalm/Internal/Stubs/Amp.php
+++ b/src/Psalm/Internal/Stubs/Amp.php
@@ -1,31 +1,39 @@
 <?php
-
 namespace Amp;
 
 /**
  * @template TReturn
+ *
  * @param callable():\Generator<mixed, mixed, mixed, TReturn> $gen
+ *
  * @return callable():Promise<TReturn>
  */
-function coroutine(callable $gen) : callable {}
+function coroutine(callable $gen) : callable
+{
+}
 
 /**
  * @template TReturn
+ *
  * @param callable():(\Generator<mixed, mixed, mixed, TReturn>|TReturn) $gen
+ *
  * @return Promise<TReturn>
  */
-function call(callable $gen) : Promise {}
-
+function call(callable $gen) : Promise
+{
+}
 
 /**
  * @template TReturn
  */
-interface Promise {
+interface Promise
+{
     /**
      * @param callable(?\Throwable, ?TReturn):void $onResolved
+     *
      * @return void
      */
-    function onResolve(callable $onResolved);
+    public function onResolve(callable $onResolved);
 }
 
 /**
@@ -33,14 +41,21 @@ interface Promise {
  *
  * @template-implements Promise<TReturn>
  */
-class Success implements Promise {
+class Success implements Promise
+{
     /**
      * @param TReturn|null $value
      */
-    public function __construct($value = null) {}
+    public function __construct($value = null)
+    {
+    }
+
     /**
      * @param callable(?Throwable, ?TReturn):void $onResolved
+     *
      * @return void
      */
-    function onResolve(callable $onResolved) {}
+    public function onResolve(callable $onResolved)
+    {
+    }
 }
diff --git a/src/Psalm/Internal/Stubs/CoreGenericFunctions.php b/src/Psalm/Internal/Stubs/CoreGenericFunctions.php
index 68fc5a987..a35daa9e6 100644
--- a/src/Psalm/Internal/Stubs/CoreGenericFunctions.php
+++ b/src/Psalm/Internal/Stubs/CoreGenericFunctions.php
@@ -5,17 +5,23 @@
  * @param array<T, mixed> $arr
  * @param mixed           $search_value
  * @param bool            $strict
+ *
  * @return array<int, T>
  */
-function array_keys(array $arr, $search_value = null, bool $strict = false) {}
+function array_keys(array $arr, $search_value = null, bool $strict = false)
+{
+}
 
 /**
  * @psalm-template T
  *
  * @param array<mixed, T> $arr
+ *
  * @return array<int, T>
  */
-function array_values(array $arr) {}
+function array_values(array $arr)
+{
+}
 
 /**
  * @psalm-template TKey as array-key
@@ -23,9 +29,12 @@ function array_values(array $arr) {}
  *
  * @param array<TKey, TValue> $arr
  * @param int $sort_flags
+ *
  * @return array<TKey, TValue>
  */
-function array_unique(array $arr, int $sort_flags = 0) {}
+function array_unique(array $arr, int $sort_flags = 0)
+{
+}
 
 /**
  * @psalm-template TKey as array-key
@@ -35,9 +44,12 @@ function array_unique(array $arr, int $sort_flags = 0) {}
  * @param array $arr2
  * @param array|null $arr3
  * @param array|null $arr4
+ *
  * @return array<TKey, TValue>
  */
-function array_intersect(array $arr, array $arr2, array $arr3 = null, array $arr4 = null) {}
+function array_intersect(array $arr, array $arr2, array $arr3 = null, array $arr4 = null)
+{
+}
 
 /**
  * @psalm-template TKey as array-key
@@ -47,9 +59,12 @@ function array_intersect(array $arr, array $arr2, array $arr3 = null, array $arr
  * @param array $arr2
  * @param array|null $arr3
  * @param array|null $arr4
+ *
  * @return array<TKey, TValue>
  */
-function array_intersect_key(array $arr, array $arr2, array $arr3 = null, array $arr4 = null) {}
+function array_intersect_key(array $arr, array $arr2, array $arr3 = null, array $arr4 = null)
+{
+}
 
 /**
  * @psalm-template TKey as array-key
@@ -57,10 +72,13 @@ function array_intersect_key(array $arr, array $arr2, array $arr3 = null, array
  *
  * @param array<mixed, TKey> $arr
  * @param array<mixed, TValue> $arr2
+ *
  * @return array<TKey, TValue>|false
  * @psalm-ignore-falsable-return
  */
-function array_combine(array $arr, array $arr2) {}
+function array_combine(array $arr, array $arr2)
+{
+}
 
 /**
  * @psalm-template TKey as array-key
@@ -70,9 +88,12 @@ function array_combine(array $arr, array $arr2) {}
  * @param array $arr2
  * @param array|null $arr3
  * @param array|null $arr4
+ *
  * @return array<TKey, TValue>
  */
-function array_diff(array $arr, array $arr2, array $arr3 = null, array $arr4 = null) {}
+function array_diff(array $arr, array $arr2, array $arr3 = null, array $arr4 = null)
+{
+}
 
 /**
  * @psalm-template TKey as array-key
@@ -82,35 +103,47 @@ function array_diff(array $arr, array $arr2, array $arr3 = null, array $arr4 = n
  * @param array $arr2
  * @param array|null $arr3
  * @param array|null $arr4
+ *
  * @return array<TKey, TValue>
  */
-function array_diff_key(array $arr, array $arr2, array $arr3 = null, array $arr4 = null) {}
+function array_diff_key(array $arr, array $arr2, array $arr3 = null, array $arr4 = null)
+{
+}
 
 /**
  * @psalm-template TKey as array-key
  * @psalm-template TValue
  *
  * @param array<TKey, TValue> $arr
+ *
  * @return array<TValue, TKey>
  */
-function array_flip(array $arr) {}
+function array_flip(array $arr)
+{
+}
 
 /**
  * @psalm-template TKey as array-key
  *
  * @param array<TKey, mixed> $arr
+ *
  * @return TKey|null
  * @psalm-ignore-nullable-return
  */
-function key($arr) {}
+function key($arr)
+{
+}
 
 /**
  * @psalm-template TValue
  *
  * @param TValue $value
+ *
  * @return array<int, TValue>
  */
-function array_fill( int $start_index, int $num, $value) : array {}
+function array_fill(int $start_index, int $num, $value) : array
+{
+}
 
 /**
  * @psalm-template T
@@ -118,25 +151,34 @@ function array_fill( int $start_index, int $num, $value) : array {}
  * @param mixed           $needle
  * @param array<T, mixed> $haystack
  * @param bool            $strict
+ *
  * @return T|false
  */
-function array_search($needle, array $haystack, bool $strict = false) {}
+function array_search($needle, array $haystack, bool $strict = false)
+{
+}
 
 /**
  * @template T
+ *
  * @param array<mixed,T> $arr
  * @param callable(T,T):int $callback
  * @param-out array<int,T> $arr
  */
-function usort(array &$arr, callable $callback): bool {}
+function usort(array &$arr, callable $callback): bool
+{
+}
 
 /**
  * @psalm-template T
  *
  * @param array<string, T> $arr
+ *
  * @return array<string, T>
  */
-function array_change_key_case(array $arr, int $case = CASE_LOWER) {}
+function array_change_key_case(array $arr, int $case = CASE_LOWER)
+{
+}
 
 /**
  * @psalm-template T
@@ -145,15 +187,21 @@ function array_change_key_case(array $arr, int $case = CASE_LOWER) {}
  *
  * @return array<int, array<array-key, T>>
  */
-function array_chunk(array $arr, int $size, bool $preserve_keys = false) {}
+function array_chunk(array $arr, int $size, bool $preserve_keys = false)
+{
+}
 
 /**
  * @psalm-template TKey as array-key
+ *
  * @param TKey $key
  * @param array<TKey, mixed> $search
+ *
  * @return bool
  */
-function array_key_exists($key, array $search) : bool { }
+function array_key_exists($key, array $search) : bool
+{
+}
 
 /**
  * @psalm-template TKey as array-key
@@ -161,6 +209,9 @@ function array_key_exists($key, array $search) : bool { }
  *
  * @param array<TKey, TValue> $arr
  * @param array<TKey, TValue> ...$arr2
+ *
  * @return array<TKey, TValue>
  */
-function array_merge_recursive(array $arr, array ...$arr2) {}
+function array_merge_recursive(array $arr, array ...$arr2)
+{
+}
diff --git a/src/Psalm/Internal/Traverser/CustomTraverser.php b/src/Psalm/Internal/Traverser/CustomTraverser.php
index 7037b59f8..c189106ae 100644
--- a/src/Psalm/Internal/Traverser/CustomTraverser.php
+++ b/src/Psalm/Internal/Traverser/CustomTraverser.php
@@ -1,12 +1,12 @@
-<?php declare(strict_types=1);
-
+<?php
+declare(strict_types=1);
 namespace Psalm\Internal\Traverser;
 
-use PhpParser\Node;
-use PhpParser\NodeTraverserInterface;
-use function gettype;
 use function array_pop;
 use function array_splice;
+use function gettype;
+use PhpParser\Node;
+use PhpParser\NodeTraverserInterface;
 
 /**
  * @internal
@@ -21,14 +21,14 @@ class CustomTraverser extends \PhpParser\NodeTraverser implements NodeTraverserI
     /**
      * Recursively traverse a node.
      *
-     * @param Node $node Node to traverse.
+     * @param Node $node node to traverse
      *
      * @return Node Result of traversal (may be original node or new one)
      */
     protected function traverseNode(Node $node) : Node
     {
         foreach ($node->getSubNodeNames() as $name) {
-            $subNode =& $node->$name;
+            $subNode = &$node->$name;
 
             if (\is_array($subNode)) {
                 $subNode = $this->traverseArray($subNode);
diff --git a/src/Psalm/Internal/Type/ParseTree.php b/src/Psalm/Internal/Type/ParseTree.php
index ee5243667..326b9b6f4 100644
--- a/src/Psalm/Internal/Type/ParseTree.php
+++ b/src/Psalm/Internal/Type/ParseTree.php
@@ -1,13 +1,13 @@
 <?php
 namespace Psalm\Internal\Type;
 
-use Psalm\Exception\TypeParseTreeException;
-use function count;
 use function array_pop;
+use function count;
 use function in_array;
-use function strtolower;
 use function preg_match;
+use Psalm\Exception\TypeParseTreeException;
 use function strlen;
+use function strtolower;
 
 /**
  * @internal
@@ -480,7 +480,7 @@ class ParseTree
                             break;
 
                         case '(':
-                            if (in_array(strtolower($type_token[0]), ['closure', 'callable', '\closure'])) {
+                            if (in_array(strtolower($type_token[0]), ['closure', 'callable', '\closure'], true)) {
                                 $new_leaf = new ParseTree\CallableTree(
                                     $type_token[0],
                                     $new_parent
diff --git a/src/Psalm/Internal/Type/ParseTree/MethodParamTree.php b/src/Psalm/Internal/Type/ParseTree/MethodParamTree.php
index 8f4c95a4d..6b7c41e56 100644
--- a/src/Psalm/Internal/Type/ParseTree/MethodParamTree.php
+++ b/src/Psalm/Internal/Type/ParseTree/MethodParamTree.php
@@ -30,7 +30,6 @@ class MethodParamTree extends \Psalm\Internal\Type\ParseTree
      * @param string $name
      * @param bool $byref
      * @param bool $variadic
-     *
      * @param \Psalm\Internal\Type\ParseTree|null $parent
      */
     public function __construct($name, $byref, $variadic, \Psalm\Internal\Type\ParseTree $parent = null)
diff --git a/src/Psalm/Internal/Type/TypeCombination.php b/src/Psalm/Internal/Type/TypeCombination.php
index bef957947..0ab978cf4 100644
--- a/src/Psalm/Internal/Type/TypeCombination.php
+++ b/src/Psalm/Internal/Type/TypeCombination.php
@@ -1,6 +1,16 @@
 <?php
 namespace Psalm\Internal\Type;
 
+use function array_filter;
+use function array_intersect_key;
+use function array_keys;
+use function array_merge;
+use function array_values;
+use function count;
+use function get_class;
+use function in_array;
+use function is_int;
+use function max;
 use Psalm\Codebase;
 use Psalm\Type;
 use Psalm\Type\Atomic;
@@ -18,9 +28,9 @@ use Psalm\Type\Atomic\TFloat;
 use Psalm\Type\Atomic\TGenericObject;
 use Psalm\Type\Atomic\TInt;
 use Psalm\Type\Atomic\TIterable;
+use Psalm\Type\Atomic\TLiteralClassString;
 use Psalm\Type\Atomic\TLiteralFloat;
 use Psalm\Type\Atomic\TLiteralInt;
-use Psalm\Type\Atomic\TLiteralClassString;
 use Psalm\Type\Atomic\TLiteralString;
 use Psalm\Type\Atomic\TMixed;
 use Psalm\Type\Atomic\TNamedObject;
@@ -33,20 +43,9 @@ use Psalm\Type\Atomic\TString;
 use Psalm\Type\Atomic\TTemplateParam;
 use Psalm\Type\Atomic\TTraitString;
 use Psalm\Type\Atomic\TTrue;
-use Psalm\Internal\Type\TypeCombination;
 use Psalm\Type\Union;
-use function in_array;
-use function count;
-use function array_filter;
-use function is_int;
-use function array_values;
-use function array_keys;
-use function substr;
 use function strpos;
-use function array_merge;
-use function get_class;
-use function max;
-use function array_intersect_key;
+use function substr;
 
 /**
  * @internal
@@ -230,7 +229,8 @@ class TypeCombination
         if ($combination->array_type_params
             && (isset($combination->named_object_types['Traversable'])
                 || isset($combination->builtin_type_params['Traversable']))
-            && (($codebase && !$codebase->config->allow_phpstorm_generics)
+            && (
+                ($codebase && !$codebase->config->allow_phpstorm_generics)
                 || isset($combination->builtin_type_params['Traversable'])
                 || (isset($combination->named_object_types['Traversable'])
                     && $combination->named_object_types['Traversable']->from_docblock)
@@ -633,7 +633,7 @@ class TypeCombination
                 } else {
                     $param_count = max(count($combination->closure_params), count($type->params));
 
-                    for ($i = 0, $l = $param_count; $i < $l; $i++) {
+                    for ($i = 0, $l = $param_count; $i < $l; ++$i) {
                         $input_param = $type->params[$i] ?? null;
 
                         if (isset($combination->closure_params[$i])) {
@@ -666,7 +666,7 @@ class TypeCombination
                         false,
                         false,
                         true
-                    )
+                    ),
                 ];
             }
         }
@@ -780,11 +780,13 @@ class TypeCombination
             if ($type instanceof TObject) {
                 $combination->named_object_types = null;
                 $combination->value_types[$type_key] = $type;
+
                 return null;
             }
 
             if ($type instanceof TIterable) {
                 $combination->value_types[$type_key] = $type;
+
                 return null;
             }
 
@@ -806,6 +808,7 @@ class TypeCombination
                 if (!$codebase->classlikes->classOrInterfaceExists($type_key)) {
                     // write this to the main list
                     $combination->value_types[$type_key] = $type;
+
                     return null;
                 }
 
diff --git a/src/Psalm/Internal/Visitor/CloningVisitor.php b/src/Psalm/Internal/Visitor/CloningVisitor.php
index 5b80e6d8f..0a63a5af6 100644
--- a/src/Psalm/Internal/Visitor/CloningVisitor.php
+++ b/src/Psalm/Internal/Visitor/CloningVisitor.php
@@ -1,10 +1,10 @@
-<?php declare(strict_types=1);
-
+<?php
+declare(strict_types=1);
 namespace Psalm\Internal\Visitor;
 
+use function array_map;
 use PhpParser\Node;
 use PhpParser\NodeVisitorAbstract;
-use function array_map;
 
 /**
  * Visitor cloning all nodes and linking to the original nodes using an attribute.
@@ -30,6 +30,7 @@ class CloningVisitor extends NodeVisitorAbstract
                 )
             );
         }
+
         return $node;
     }
 }
diff --git a/src/Psalm/Internal/Visitor/PartialParserVisitor.php b/src/Psalm/Internal/Visitor/PartialParserVisitor.php
index 2b37df23d..0b3b33eee 100644
--- a/src/Psalm/Internal/Visitor/PartialParserVisitor.php
+++ b/src/Psalm/Internal/Visitor/PartialParserVisitor.php
@@ -1,15 +1,15 @@
 <?php
 namespace Psalm\Internal\Visitor;
 
-use PhpParser;
-use function strlen;
 use function count;
-use function substr_count;
-use function substr;
+use PhpParser;
 use function preg_replace;
 use function reset;
-use function strrpos;
+use function strlen;
 use function strpos;
+use function strrpos;
+use function substr;
+use function substr_count;
 
 /**
  * Given a list of file diffs, this scans an AST to find the sections it can replace, and parses
@@ -117,6 +117,7 @@ class PartialParserVisitor extends PhpParser\NodeVisitorAbstract implements PhpP
                             // we have a diff that goes outside the bounds that we care about
                             if ($a_e2 > $stmt_end_pos) {
                                 $this->must_rescan = true;
+
                                 return PhpParser\NodeTraverser::STOP_TRAVERSAL;
                             }
 
@@ -135,7 +136,7 @@ class PartialParserVisitor extends PhpParser\NodeVisitorAbstract implements PhpP
                             }
 
                             if ($a_s2 >= $stmt_start_pos && $a_e2 <= $stmt_end_pos) {
-                                $this->non_method_changes--;
+                                --$this->non_method_changes;
                             }
                         }
 
@@ -152,12 +153,13 @@ class PartialParserVisitor extends PhpParser\NodeVisitorAbstract implements PhpP
 
                         if (!$method_contents) {
                             $this->must_rescan = true;
+
                             return PhpParser\NodeTraverser::STOP_TRAVERSAL;
                         }
 
                         $error_handler = new \PhpParser\ErrorHandler\Collecting();
 
-                        $fake_class = "<?php class _ {" . $method_contents . "}";
+                        $fake_class = '<?php class _ {' . $method_contents . '}';
 
                         /** @var array<PhpParser\Node\Stmt> */
                         $replacement_stmts = $this->parser->parse(
@@ -176,6 +178,7 @@ class PartialParserVisitor extends PhpParser\NodeVisitorAbstract implements PhpP
                                 && count($replacement_stmts[0]->stmts) !== 1
                             ) {
                                 $this->must_rescan = true;
+
                                 return PhpParser\NodeTraverser::STOP_TRAVERSAL;
                             }
 
@@ -198,6 +201,7 @@ class PartialParserVisitor extends PhpParser\NodeVisitorAbstract implements PhpP
                                 || count($replacement_stmts[0]->stmts) > 1
                             ) {
                                 $this->must_rescan = true;
+
                                 return PhpParser\NodeTraverser::STOP_TRAVERSAL;
                             }
                         }
@@ -220,12 +224,9 @@ class PartialParserVisitor extends PhpParser\NodeVisitorAbstract implements PhpP
                                     $error = new PhpParser\Error(
                                         $error->getRawMessage(),
                                         [
-                                            'startFilePos' =>
-                                                $stmt_start_pos + $error_attrs['startFilePos'] - 15,
-                                            'endFilePos' =>
-                                                $stmt_start_pos + $error_attrs['endFilePos'] - 15,
-                                            'startLine' =>
-                                                $error->getStartLine() + $current_line + $line_offset
+                                            'startFilePos' => $stmt_start_pos + $error_attrs['startFilePos'] - 15,
+                                            'endFilePos' => $stmt_start_pos + $error_attrs['endFilePos'] - 15,
+                                            'startLine' => $error->getStartLine() + $current_line + $line_offset,
                                         ]
                                     );
                                 }
@@ -242,6 +243,7 @@ class PartialParserVisitor extends PhpParser\NodeVisitorAbstract implements PhpP
                     }
 
                     $this->must_rescan = true;
+
                     return PhpParser\NodeTraverser::STOP_TRAVERSAL;
                 }
 
@@ -272,6 +274,7 @@ class PartialParserVisitor extends PhpParser\NodeVisitorAbstract implements PhpP
             }
 
             $this->must_rescan = true;
+
             return PhpParser\NodeTraverser::STOP_TRAVERSAL;
         }
 
@@ -319,8 +322,6 @@ class PartialParserVisitor extends PhpParser\NodeVisitorAbstract implements PhpP
             return $node;
         }
 
-
-
         return null;
     }
 
@@ -337,9 +338,9 @@ class PartialParserVisitor extends PhpParser\NodeVisitorAbstract implements PhpP
 
         foreach ($tokens as $token) {
             if ($token === '{') {
-                $brace_count++;
+                ++$brace_count;
             } elseif ($token === '}') {
-                $brace_count--;
+                --$brace_count;
             }
         }
 
diff --git a/src/Psalm/Internal/Visitor/ReflectorVisitor.php b/src/Psalm/Internal/Visitor/ReflectorVisitor.php
index fdbccd5a1..93ddd716a 100644
--- a/src/Psalm/Internal/Visitor/ReflectorVisitor.php
+++ b/src/Psalm/Internal/Visitor/ReflectorVisitor.php
@@ -1,18 +1,27 @@
 <?php
 namespace Psalm\Internal\Visitor;
 
+use function array_filter;
+use function array_key_exists;
+use function array_merge;
+use function array_pop;
+use function assert;
+use function class_exists;
+use function count;
+use const DIRECTORY_SEPARATOR;
+use function dirname;
+use function end;
+use function explode;
+use function function_exists;
+use function implode;
+use function in_array;
+use function interface_exists;
+use function is_string;
 use PhpParser;
+use function preg_match;
+use function preg_replace;
 use Psalm\Aliases;
-use Psalm\Internal\Analyzer\ClassAnalyzer;
-use Psalm\Internal\Analyzer\ClassLikeAnalyzer;
-use Psalm\Internal\Analyzer\CommentAnalyzer;
-use Psalm\Internal\Analyzer\Statements\Expression\CallAnalyzer;
-use Psalm\Internal\Analyzer\Statements\Expression\IncludeAnalyzer;
-use Psalm\Internal\Analyzer\StatementsAnalyzer;
 use Psalm\Codebase;
-use Psalm\Internal\Codebase\CallMap;
-use Psalm\Internal\Codebase\PropertyMap;
-use Psalm\Internal\Scanner\PhpStormMetaScanner;
 use Psalm\CodeLocation;
 use Psalm\Config;
 use Psalm\DocComment;
@@ -21,15 +30,23 @@ use Psalm\Exception\FileIncludeException;
 use Psalm\Exception\IncorrectDocblockException;
 use Psalm\Exception\TypeParseTreeException;
 use Psalm\FileSource;
+use Psalm\Internal\Analyzer\ClassAnalyzer;
+use Psalm\Internal\Analyzer\ClassLikeAnalyzer;
+use Psalm\Internal\Analyzer\CommentAnalyzer;
+use Psalm\Internal\Analyzer\Statements\Expression\CallAnalyzer;
+use Psalm\Internal\Analyzer\Statements\Expression\IncludeAnalyzer;
+use Psalm\Internal\Analyzer\StatementsAnalyzer;
+use Psalm\Internal\Codebase\CallMap;
+use Psalm\Internal\Codebase\PropertyMap;
+use Psalm\Internal\Scanner\FileScanner;
+use Psalm\Internal\Scanner\PhpStormMetaScanner;
 use Psalm\Issue\DuplicateClass;
 use Psalm\Issue\DuplicateFunction;
 use Psalm\Issue\DuplicateMethod;
 use Psalm\Issue\DuplicateParam;
 use Psalm\Issue\InvalidDocblock;
-use Psalm\Issue\MisplacedRequiredParam;
 use Psalm\Issue\MissingDocblockType;
 use Psalm\IssueBuffer;
-use Psalm\Internal\Scanner\FileScanner;
 use Psalm\Storage\ClassLikeStorage;
 use Psalm\Storage\FileStorage;
 use Psalm\Storage\FunctionLikeParameter;
@@ -37,28 +54,10 @@ use Psalm\Storage\FunctionLikeStorage;
 use Psalm\Storage\MethodStorage;
 use Psalm\Storage\PropertyStorage;
 use Psalm\Type;
-use function implode;
-use function strtolower;
-use function in_array;
-use function end;
-use function is_string;
-use function count;
-use function array_merge;
-use function trim;
-use function preg_replace;
-use function array_pop;
-use function function_exists;
-use function class_exists;
-use function interface_exists;
-use function assert;
 use function strpos;
-use function explode;
-use function array_key_exists;
+use function strtolower;
 use function substr;
-use function array_filter;
-use function preg_match;
-use function dirname;
-use const DIRECTORY_SEPARATOR;
+use function trim;
 
 /**
  * @internal
@@ -483,7 +482,8 @@ class ReflectorVisitor extends PhpParser\NodeVisitorAbstract implements PhpParse
                 if ($node->cond instanceof PhpParser\Node\Expr\BooleanNot) {
                     if ($node->cond->expr instanceof PhpParser\Node\Expr\FuncCall
                         && $node->cond->expr->name instanceof PhpParser\Node\Name
-                        && ($node->cond->expr->name->parts === ['function_exists']
+                        && (
+                            $node->cond->expr->name->parts === ['function_exists']
                             || $node->cond->expr->name->parts === ['class_exists']
                             || $node->cond->expr->name->parts === ['interface_exists']
                         )
@@ -492,7 +492,8 @@ class ReflectorVisitor extends PhpParser\NodeVisitorAbstract implements PhpParse
                     }
                 } elseif ($node->cond instanceof PhpParser\Node\Expr\FuncCall
                     && $node->cond->name instanceof PhpParser\Node\Name
-                    && ($node->cond->name->parts === ['function_exists']
+                    && (
+                        $node->cond->name->parts === ['function_exists']
                         || $node->cond->name->parts === ['class_exists']
                         || $node->cond->name->parts === ['interface_exists']
                     )
@@ -1096,7 +1097,7 @@ class ReflectorVisitor extends PhpParser\NodeVisitorAbstract implements PhpParse
                                 }
 
                                 $storage->template_types[$template_name] = [
-                                    $fq_classlike_name => [$template_type]
+                                    $fq_classlike_name => [$template_type],
                                 ];
                             } else {
                                 if (IssueBuffer::accepts(
@@ -1226,6 +1227,7 @@ class ReflectorVisitor extends PhpParser\NodeVisitorAbstract implements PhpParse
             }
 
             $storage->has_docblock_issues = true;
+
             return;
         }
 
@@ -1312,6 +1314,7 @@ class ReflectorVisitor extends PhpParser\NodeVisitorAbstract implements PhpParse
             }
 
             $storage->has_docblock_issues = true;
+
             return;
         }
 
@@ -1396,6 +1399,7 @@ class ReflectorVisitor extends PhpParser\NodeVisitorAbstract implements PhpParse
             }
 
             $storage->has_docblock_issues = true;
+
             return;
         }
 
@@ -1889,7 +1893,7 @@ class ReflectorVisitor extends PhpParser\NodeVisitorAbstract implements PhpParse
                         continue;
                     }
 
-                    $param_index = \array_search($param_name, \array_keys($storage->param_types));
+                    $param_index = \array_search($param_name, \array_keys($storage->param_types), true);
 
                     if (!isset($storage->params[$param_index]->type)) {
                         continue;
@@ -1902,8 +1906,8 @@ class ReflectorVisitor extends PhpParser\NodeVisitorAbstract implements PhpParse
                             ? new Type\Union([
                                 new Type\Atomic\TArray([
                                     Type::getInt(),
-                                    $param_type
-                                ])
+                                    $param_type,
+                                ]),
                             ])
                             : $param_type;
                 } else {
@@ -2064,7 +2068,7 @@ class ReflectorVisitor extends PhpParser\NodeVisitorAbstract implements PhpParse
                     $storage->has_docblock_issues = true;
                 } else {
                     $storage->template_types[$template_name] = [
-                        '' => [$template_type]
+                        '' => [$template_type],
                     ];
 
                     $storage->template_covariants[$i] = $template_map[3];
@@ -2264,7 +2268,7 @@ class ReflectorVisitor extends PhpParser\NodeVisitorAbstract implements PhpParse
                                     : 'object',
                                 $template_atomic_type,
                                 $template_class
-                            )
+                            ),
                         ]);
 
                         if ($param_type_nullable) {
@@ -3106,8 +3110,6 @@ class ReflectorVisitor extends PhpParser\NodeVisitorAbstract implements PhpParse
                 return;
             }
         }
-
-        return;
     }
 
     /**
diff --git a/src/Psalm/Internal/Visitor/SimpleNameResolver.php b/src/Psalm/Internal/Visitor/SimpleNameResolver.php
index 09ec55a1e..ed8388887 100644
--- a/src/Psalm/Internal/Visitor/SimpleNameResolver.php
+++ b/src/Psalm/Internal/Visitor/SimpleNameResolver.php
@@ -1,7 +1,6 @@
 <?php
 
 // based on PhpParser's builtin one
-
 namespace Psalm\Internal\Visitor;
 
 use PhpParser;
@@ -43,7 +42,7 @@ class SimpleNameResolver extends NodeVisitorAbstract
     public function __construct(ErrorHandler $errorHandler, array $offset_map = null)
     {
         if ($offset_map) {
-            foreach ($offset_map as list(,, $b_s, $b_e)) {
+            foreach ($offset_map as list(, , $b_s, $b_e)) {
                 if ($this->start_change === null) {
                     $this->start_change = $b_s;
                 }
@@ -55,12 +54,15 @@ class SimpleNameResolver extends NodeVisitorAbstract
         $this->nameContext = new NameContext($errorHandler);
     }
 
-    public function beforeTraverse(array $nodes) {
+    public function beforeTraverse(array $nodes)
+    {
         $this->nameContext->startNamespace();
+
         return null;
     }
 
-    public function enterNode(Node $node) {
+    public function enterNode(Node $node)
+    {
         if ($node instanceof Stmt\Namespace_) {
             $this->nameContext->startNamespace($node->name);
         } elseif ($node instanceof Stmt\Use_) {
@@ -138,9 +140,11 @@ class SimpleNameResolver extends NodeVisitorAbstract
 
     /**
      * @param int $type
+     *
      * @return void
      */
-    private function addAlias(Stmt\UseUse $use, $type, Name $prefix = null) {
+    private function addAlias(Stmt\UseUse $use, $type, Name $prefix = null)
+    {
         // Add prefix for group uses
         /** @var Name $name */
         $name = $prefix ? Name::concat($prefix, $use->name) : $use->name;
@@ -148,15 +152,20 @@ class SimpleNameResolver extends NodeVisitorAbstract
         $type |= $use->type;
 
         $this->nameContext->addAlias(
-            $name, (string) $use->getAlias(), $type, $use->getAttributes()
+            $name,
+            (string) $use->getAlias(),
+            $type,
+            $use->getAttributes()
         );
     }
 
     /**
      * @param Stmt\Function_|Stmt\ClassMethod|Expr\Closure $node
+     *
      * @return void
      */
-    private function resolveSignature($node) {
+    private function resolveSignature($node)
+    {
         foreach ($node->params as $param) {
             $param->type = $this->resolveType($param->type);
         }
@@ -165,21 +174,25 @@ class SimpleNameResolver extends NodeVisitorAbstract
 
     /**
      * @param  PhpParser\Node|string|null $node
+     *
      * @return null|PhpParser\Node\Identifier|PhpParser\Node\Name|PhpParser\Node\NullableType
      * @psalm-suppress MoreSpecificReturnType
      * @psalm-suppress LessSpecificReturnStatement
      * @psalm-suppress InvalidReturnType
      * @psalm-suppress InvalidReturnStatement
      */
-    private function resolveType($node) {
+    private function resolveType($node)
+    {
         if ($node instanceof Node\NullableType) {
             /** @psalm-suppress PossiblyInvalidPropertyAssignmentValue */
             $node->type = $this->resolveType($node->type);
+
             return $node;
         }
         if ($node instanceof Name) {
             return $this->resolveClassName($node);
         }
+
         return $node;
     }
 
@@ -191,18 +204,21 @@ class SimpleNameResolver extends NodeVisitorAbstract
      *
      * @return Name Resolved name, or original name with attribute
      */
-    protected function resolveName(Name $name, $type) {
+    protected function resolveName(Name $name, $type)
+    {
         $resolvedName = $this->nameContext->getResolvedName($name, $type);
         if (null !== $resolvedName) {
             $name->setAttribute('resolvedName', $resolvedName->toString());
         }
+
         return $name;
     }
 
     /**
      * @return Name
      */
-    protected function resolveClassName(Name $name) {
+    protected function resolveClassName(Name $name)
+    {
         return $this->resolveName($name, Stmt\Use_::TYPE_NORMAL);
     }
 }
diff --git a/src/Psalm/IssueBuffer.php b/src/Psalm/IssueBuffer.php
index eef1d8df6..3a97d81df 100644
--- a/src/Psalm/IssueBuffer.php
+++ b/src/Psalm/IssueBuffer.php
@@ -1,9 +1,18 @@
 <?php
 namespace Psalm;
 
+use function array_pop;
+use function array_search;
+use function array_splice;
+use function count;
+use function explode;
+use function file_put_contents;
+use function get_class;
+use function memory_get_peak_usage;
+use function microtime;
+use function number_format;
 use Psalm\Internal\Analyzer\ProjectAnalyzer;
 use Psalm\Issue\CodeIssue;
-use Psalm\Report;
 use Psalm\Report\CheckstyleReport;
 use Psalm\Report\CompactReport;
 use Psalm\Report\ConsoleReport;
@@ -14,20 +23,10 @@ use Psalm\Report\PylintReport;
 use Psalm\Report\SonarqubeReport;
 use Psalm\Report\TextReport;
 use Psalm\Report\XmlReport;
-use function explode;
-use function get_class;
-use function array_pop;
-use function usort;
-use function str_replace;
-use function count;
-use function array_search;
-use function array_splice;
-use function file_put_contents;
-use function str_repeat;
-use function number_format;
-use function microtime;
-use function memory_get_peak_usage;
 use function sha1;
+use function str_repeat;
+use function str_replace;
+use function usort;
 
 class IssueBuffer
 {
@@ -236,8 +235,7 @@ class IssueBuffer
         if (self::$issues_data) {
             usort(
                 self::$issues_data,
-                /** @return int */
-                function (array $d1, array $d2) {
+                function (array $d1, array $d2) : int {
                     if ($d1['file_path'] === $d2['file_path']) {
                         if ($d1['line_from'] === $d2['line_from']) {
                             if ($d1['column_from'] === $d2['column_from']) {
@@ -263,7 +261,11 @@ class IssueBuffer
 
                     if (isset($issue_baseline[$file][$type]) && $issue_baseline[$file][$type]['o'] > 0) {
                         if ($issue_baseline[$file][$type]['o'] === count($issue_baseline[$file][$type]['s'])) {
-                            $position = array_search($issue_data['selected_text'], $issue_baseline[$file][$type]['s']);
+                            $position = array_search(
+                                $issue_data['selected_text'],
+                                $issue_baseline[$file][$type]['s'],
+                                true
+                            );
 
                             if ($position !== false) {
                                 $issue_data['severity'] = Config::REPORT_INFO;
@@ -335,7 +337,7 @@ class IssueBuffer
             echo str_repeat('-', 30) . "\n";
 
             if ($error_count) {
-                echo ($project_analyzer->stdout_report_options->use_color
+                echo($project_analyzer->stdout_report_options->use_color
                     ? "\e[0;31m" . $error_count . " errors\e[0m"
                     : $error_count . ' errors'
                 ) . ' found' . "\n";
@@ -486,6 +488,7 @@ class IssueBuffer
         $current_data = self::$issues_data;
         self::$issues_data = [];
         self::$emitted = [];
+
         return $current_data;
     }
 
diff --git a/src/Psalm/Plugin/Hook/AfterAnalysisInterface.php b/src/Psalm/Plugin/Hook/AfterAnalysisInterface.php
index 93b23c018..34d54c89d 100644
--- a/src/Psalm/Plugin/Hook/AfterAnalysisInterface.php
+++ b/src/Psalm/Plugin/Hook/AfterAnalysisInterface.php
@@ -8,6 +8,7 @@ interface AfterAnalysisInterface
 {
     /**
      * Called after analysis is complete
+     *
      * @param array<int, array{severity: string, line_from: int, line_to: int, type: string, message: string,
      * file_name: string, file_path: string, snippet: string, from: int, to: int,
      * snippet_from: int, snippet_to: int, column_from: int, column_to: int, selected_text: string}> $issues
diff --git a/src/Psalm/Plugin/Hook/AfterClassLikeExistenceCheckInterface.php b/src/Psalm/Plugin/Hook/AfterClassLikeExistenceCheckInterface.php
index fc199ba7b..3a34b441c 100644
--- a/src/Psalm/Plugin/Hook/AfterClassLikeExistenceCheckInterface.php
+++ b/src/Psalm/Plugin/Hook/AfterClassLikeExistenceCheckInterface.php
@@ -1,8 +1,8 @@
 <?php
 namespace Psalm\Plugin\Hook;
 
-use Psalm\CodeLocation;
 use Psalm\Codebase;
+use Psalm\CodeLocation;
 use Psalm\FileManipulation;
 use Psalm\StatementsSource;
 
diff --git a/src/Psalm/Plugin/Hook/AfterCodebasePopulatedInterface.php b/src/Psalm/Plugin/Hook/AfterCodebasePopulatedInterface.php
index d66d1a603..475835f03 100644
--- a/src/Psalm/Plugin/Hook/AfterCodebasePopulatedInterface.php
+++ b/src/Psalm/Plugin/Hook/AfterCodebasePopulatedInterface.php
@@ -7,6 +7,7 @@ interface AfterCodebasePopulatedInterface
 {
     /**
      * Called after codebase has been populated
+     *
      * @return void
      */
     public static function afterCodebasePopulated(Codebase $codebase);
diff --git a/src/Psalm/Plugin/Hook/FunctionExistenceProviderInterface.php b/src/Psalm/Plugin/Hook/FunctionExistenceProviderInterface.php
index bea38283f..523744cac 100644
--- a/src/Psalm/Plugin/Hook/FunctionExistenceProviderInterface.php
+++ b/src/Psalm/Plugin/Hook/FunctionExistenceProviderInterface.php
@@ -1,5 +1,4 @@
 <?php
-
 namespace Psalm\Plugin\Hook;
 
 use PhpParser;
@@ -14,6 +13,7 @@ interface FunctionExistenceProviderInterface
 
     /**
      * @param  array<PhpParser\Node\Arg>    $call_args
+     *
      * @return ?bool
      */
     public static function doesFunctionExist(
diff --git a/src/Psalm/Plugin/Hook/FunctionParamsProviderInterface.php b/src/Psalm/Plugin/Hook/FunctionParamsProviderInterface.php
index a3ccca012..14e79c268 100644
--- a/src/Psalm/Plugin/Hook/FunctionParamsProviderInterface.php
+++ b/src/Psalm/Plugin/Hook/FunctionParamsProviderInterface.php
@@ -1,5 +1,4 @@
 <?php
-
 namespace Psalm\Plugin\Hook;
 
 use PhpParser;
@@ -16,6 +15,7 @@ interface FunctionParamsProviderInterface
 
     /**
      * @param  array<PhpParser\Node\Arg>    $call_args
+     *
      * @return ?array<\Psalm\Storage\FunctionLikeParameter>
      */
     public static function getFunctionParams(
diff --git a/src/Psalm/Plugin/Hook/FunctionReturnTypeProviderInterface.php b/src/Psalm/Plugin/Hook/FunctionReturnTypeProviderInterface.php
index 00f0e2368..97fede166 100644
--- a/src/Psalm/Plugin/Hook/FunctionReturnTypeProviderInterface.php
+++ b/src/Psalm/Plugin/Hook/FunctionReturnTypeProviderInterface.php
@@ -1,12 +1,11 @@
 <?php
-
 namespace Psalm\Plugin\Hook;
 
 use PhpParser;
 use Psalm\CodeLocation;
 use Psalm\Context;
-use Psalm\Type;
 use Psalm\StatementsSource;
+use Psalm\Type;
 
 interface FunctionReturnTypeProviderInterface
 {
@@ -17,6 +16,7 @@ interface FunctionReturnTypeProviderInterface
 
     /**
      * @param  array<PhpParser\Node\Arg>    $call_args
+     *
      * @return ?Type\Union
      */
     public static function getFunctionReturnType(
diff --git a/src/Psalm/Plugin/Hook/MethodExistenceProviderInterface.php b/src/Psalm/Plugin/Hook/MethodExistenceProviderInterface.php
index e3a68900e..d4d826936 100644
--- a/src/Psalm/Plugin/Hook/MethodExistenceProviderInterface.php
+++ b/src/Psalm/Plugin/Hook/MethodExistenceProviderInterface.php
@@ -1,5 +1,4 @@
 <?php
-
 namespace Psalm\Plugin\Hook;
 
 use Psalm\CodeLocation;
diff --git a/src/Psalm/Plugin/Hook/MethodParamsProviderInterface.php b/src/Psalm/Plugin/Hook/MethodParamsProviderInterface.php
index 4fb7126c3..a20899461 100644
--- a/src/Psalm/Plugin/Hook/MethodParamsProviderInterface.php
+++ b/src/Psalm/Plugin/Hook/MethodParamsProviderInterface.php
@@ -1,5 +1,4 @@
 <?php
-
 namespace Psalm\Plugin\Hook;
 
 use PhpParser;
@@ -16,6 +15,7 @@ interface MethodParamsProviderInterface
 
     /**
      * @param  array<PhpParser\Node\Arg>    $call_args
+     *
      * @return ?array<int, \Psalm\Storage\FunctionLikeParameter>
      */
     public static function getMethodParams(
diff --git a/src/Psalm/Plugin/Hook/MethodReturnTypeProviderInterface.php b/src/Psalm/Plugin/Hook/MethodReturnTypeProviderInterface.php
index 9aaf06604..16b41c42f 100644
--- a/src/Psalm/Plugin/Hook/MethodReturnTypeProviderInterface.php
+++ b/src/Psalm/Plugin/Hook/MethodReturnTypeProviderInterface.php
@@ -1,12 +1,11 @@
 <?php
-
 namespace Psalm\Plugin\Hook;
 
 use PhpParser;
 use Psalm\CodeLocation;
 use Psalm\Context;
-use Psalm\Type;
 use Psalm\StatementsSource;
+use Psalm\Type;
 
 interface MethodReturnTypeProviderInterface
 {
@@ -18,6 +17,7 @@ interface MethodReturnTypeProviderInterface
     /**
      * @param  array<PhpParser\Node\Arg>    $call_args
      * @param  ?array<Type\Union> $template_type_parameters
+     *
      * @return ?Type\Union
      */
     public static function getMethodReturnType(
diff --git a/src/Psalm/Plugin/Hook/MethodVisibilityProviderInterface.php b/src/Psalm/Plugin/Hook/MethodVisibilityProviderInterface.php
index efbbf32bd..db99f7972 100644
--- a/src/Psalm/Plugin/Hook/MethodVisibilityProviderInterface.php
+++ b/src/Psalm/Plugin/Hook/MethodVisibilityProviderInterface.php
@@ -1,5 +1,4 @@
 <?php
-
 namespace Psalm\Plugin\Hook;
 
 use Psalm\CodeLocation;
diff --git a/src/Psalm/Plugin/Hook/PropertyExistenceProviderInterface.php b/src/Psalm/Plugin/Hook/PropertyExistenceProviderInterface.php
index f863feaf6..edea5aa10 100644
--- a/src/Psalm/Plugin/Hook/PropertyExistenceProviderInterface.php
+++ b/src/Psalm/Plugin/Hook/PropertyExistenceProviderInterface.php
@@ -1,5 +1,4 @@
 <?php
-
 namespace Psalm\Plugin\Hook;
 
 use Psalm\CodeLocation;
diff --git a/src/Psalm/Plugin/Hook/PropertyTypeProviderInterface.php b/src/Psalm/Plugin/Hook/PropertyTypeProviderInterface.php
index 47c137b71..23edfc957 100644
--- a/src/Psalm/Plugin/Hook/PropertyTypeProviderInterface.php
+++ b/src/Psalm/Plugin/Hook/PropertyTypeProviderInterface.php
@@ -1,11 +1,10 @@
 <?php
-
 namespace Psalm\Plugin\Hook;
 
 use PhpParser;
 use Psalm\Context;
-use Psalm\Type;
 use Psalm\StatementsSource;
+use Psalm\Type;
 
 interface PropertyTypeProviderInterface
 {
@@ -16,6 +15,7 @@ interface PropertyTypeProviderInterface
 
     /**
      * @param  array<PhpParser\Node\Arg>    $call_args
+     *
      * @return ?Type\Union
      */
     public static function getPropertyType(
diff --git a/src/Psalm/Plugin/Hook/PropertyVisibilityProviderInterface.php b/src/Psalm/Plugin/Hook/PropertyVisibilityProviderInterface.php
index 69bfd979f..0957695f2 100644
--- a/src/Psalm/Plugin/Hook/PropertyVisibilityProviderInterface.php
+++ b/src/Psalm/Plugin/Hook/PropertyVisibilityProviderInterface.php
@@ -1,5 +1,4 @@
 <?php
-
 namespace Psalm\Plugin\Hook;
 
 use Psalm\CodeLocation;
diff --git a/src/Psalm/Plugin/Hook/StringInterpreterInterface.php b/src/Psalm/Plugin/Hook/StringInterpreterInterface.php
index 2c41e6187..39394c217 100644
--- a/src/Psalm/Plugin/Hook/StringInterpreterInterface.php
+++ b/src/Psalm/Plugin/Hook/StringInterpreterInterface.php
@@ -8,6 +8,7 @@ interface StringInterpreterInterface
     /**
      * Called after a statement has been checked
      */
-    public static function getTypeFromValue(string $value
+    public static function getTypeFromValue(
+        string $value
     ) : ?Type\Atomic\TLiteralString;
 }
diff --git a/src/Psalm/Plugin/PluginEntryPointInterface.php b/src/Psalm/Plugin/PluginEntryPointInterface.php
index 04f823fb7..fe9f05a2a 100644
--- a/src/Psalm/Plugin/PluginEntryPointInterface.php
+++ b/src/Psalm/Plugin/PluginEntryPointInterface.php
@@ -2,7 +2,6 @@
 namespace Psalm\Plugin;
 
 use SimpleXMLElement;
-use Psalm\Plugin\RegistrationInterface;
 
 interface PluginEntryPointInterface
 {
diff --git a/src/Psalm/Plugin/Shepherd.php b/src/Psalm/Plugin/Shepherd.php
index 4cb001417..2bd0f632b 100644
--- a/src/Psalm/Plugin/Shepherd.php
+++ b/src/Psalm/Plugin/Shepherd.php
@@ -1,33 +1,34 @@
 <?php
 namespace Psalm\Plugin;
 
-use Psalm\Codebase;
-use Psalm\SourceControl\SourceControlInfo;
-use function function_exists;
-use function fwrite;
-use const STDERR;
-use const PHP_EOL;
 use function array_filter;
-use function json_encode;
-use function parse_url;
-use const PHP_URL_SCHEME;
+use function curl_close;
+use function curl_exec;
+use function curl_getinfo;
 use function curl_init;
 use function curl_setopt;
-use const CURLOPT_RETURNTRANSFER;
 use const CURLINFO_HEADER_OUT;
+use const CURLOPT_HTTPHEADER;
 use const CURLOPT_POST;
 use const CURLOPT_POSTFIELDS;
-use const CURLOPT_HTTPHEADER;
+use const CURLOPT_RETURNTRANSFER;
+use function function_exists;
+use function fwrite;
+use function json_encode;
+use function parse_url;
+use const PHP_EOL;
+use const PHP_URL_SCHEME;
+use Psalm\Codebase;
+use Psalm\SourceControl\SourceControlInfo;
+use const STDERR;
 use function strlen;
-use function curl_exec;
-use function curl_getinfo;
 use function var_export;
-use function curl_close;
 
 class Shepherd implements \Psalm\Plugin\Hook\AfterAnalysisInterface
 {
     /**
      * Called after analysis is complete
+     *
      * @param array<int, array{severity: string, line_from: int, line_to: int, type: string, message: string,
      * file_name: string, file_path: string, snippet: string, from: int, to: int,
      * snippet_from: int, snippet_to: int, column_from: int, column_to: int, selected_text: string}> $issues
@@ -42,6 +43,7 @@ class Shepherd implements \Psalm\Plugin\Hook\AfterAnalysisInterface
     ) {
         if (!function_exists('curl_init')) {
             fwrite(STDERR, 'No curl found, cannot send data to ' . $codebase->config->shepherd_host . PHP_EOL);
+
             return;
         }
 
@@ -55,7 +57,7 @@ class Shepherd implements \Psalm\Plugin\Hook\AfterAnalysisInterface
                         return $i['severity'] === 'error';
                     }
                 ),
-                'coverage' => $codebase->analyzer->getTotalTypeCoverage($codebase)
+                'coverage' => $codebase->analyzer->getTotalTypeCoverage($codebase),
             ];
 
             $payload = json_encode($data);
@@ -79,7 +81,7 @@ class Shepherd implements \Psalm\Plugin\Hook\AfterAnalysisInterface
                 CURLOPT_HTTPHEADER,
                 [
                     'Content-Type: application/json',
-                    'Content-Length: ' . strlen($payload)
+                    'Content-Length: ' . strlen($payload),
                 ]
             );
 
diff --git a/src/Psalm/Progress/DebugProgress.php b/src/Psalm/Progress/DebugProgress.php
index 0f6d913f4..515cd6202 100644
--- a/src/Psalm/Progress/DebugProgress.php
+++ b/src/Psalm/Progress/DebugProgress.php
@@ -1,8 +1,8 @@
 <?php
 namespace Psalm\Progress;
 
-use function error_reporting;
 use const E_ALL;
+use function error_reporting;
 
 class DebugProgress extends Progress
 {
diff --git a/src/Psalm/Progress/DefaultProgress.php b/src/Psalm/Progress/DefaultProgress.php
index 9b299a513..1d8c1b32b 100644
--- a/src/Psalm/Progress/DefaultProgress.php
+++ b/src/Psalm/Progress/DefaultProgress.php
@@ -52,6 +52,7 @@ class DefaultProgress extends LongProgress
      * https://github.com/phan/phan/blob/d61a624b1384ea220f39927d53fd656a65a75fac/src/Phan/CLI.php
      * Renders a unicode progress bar that goes from light (left) to dark (right)
      * The length in the console is the positive integer $length
+     *
      * @see https://en.wikipedia.org/wiki/Block_Elements
      */
     private static function renderInnerProgressBar(int $length, float $p) : string
@@ -62,13 +63,14 @@ class DefaultProgress extends LongProgress
 
         if (!self::doesTerminalSupportUtf8()) {
             // Show a progress bar of "XXXX>------" in Windows when utf-8 is unsupported.
-            $progress_bar = str_repeat("X", $current);
+            $progress_bar = str_repeat('X', $current);
             $delta = $current_float - $current;
             if ($delta > 0.5) {
-                $progress_bar .= ">" . str_repeat("-", $rest - 1);
+                $progress_bar .= '>' . str_repeat('-', $rest - 1);
             } else {
-                $progress_bar .= str_repeat("-", $rest);
+                $progress_bar .= str_repeat('-', $rest);
             }
+
             return $progress_bar;
         }
 
diff --git a/src/Psalm/Progress/LongProgress.php b/src/Psalm/Progress/LongProgress.php
index 5fb2deea6..6e75310b1 100644
--- a/src/Psalm/Progress/LongProgress.php
+++ b/src/Psalm/Progress/LongProgress.php
@@ -2,10 +2,10 @@
 namespace Psalm\Progress;
 
 use const PHP_EOL;
-use function strlen;
 use function round;
 use function sprintf;
 use function str_repeat;
+use function strlen;
 
 class LongProgress extends Progress
 {
@@ -88,6 +88,7 @@ class LongProgress extends Progress
 
         $leadingSpaces = 1 + strlen((string) $this->number_of_tasks) - strlen((string) $this->progress);
         $percentage = round($this->progress / $this->number_of_tasks * 100);
+
         return sprintf(
             '%s%s / %s (%s%%)',
             str_repeat(' ', $leadingSpaces),
diff --git a/src/Psalm/Progress/Progress.php b/src/Psalm/Progress/Progress.php
index dc724eab7..fc4e06c99 100644
--- a/src/Psalm/Progress/Progress.php
+++ b/src/Psalm/Progress/Progress.php
@@ -1,11 +1,11 @@
 <?php
 namespace Psalm\Progress;
 
-use function error_reporting;
 use const E_ERROR;
+use function error_reporting;
 use function fwrite;
-use const STDERR;
 use const PHP_OS;
+use const STDERR;
 
 abstract class Progress
 {
diff --git a/src/Psalm/Report/CheckstyleReport.php b/src/Psalm/Report/CheckstyleReport.php
index d7496c6f5..31744a6d5 100644
--- a/src/Psalm/Report/CheckstyleReport.php
+++ b/src/Psalm/Report/CheckstyleReport.php
@@ -1,15 +1,14 @@
 <?php
 namespace Psalm\Report;
 
-use LSS\Array2XML;
+use function htmlspecialchars;
 use Psalm\Report;
 use function sprintf;
-use function htmlspecialchars;
 
 class CheckstyleReport extends Report
 {
     /**
-     * {{@inheritdoc}}
+     * {@inheritdoc}
      */
     public function create(): string
     {
diff --git a/src/Psalm/Report/CompactReport.php b/src/Psalm/Report/CompactReport.php
index 30d7cdd2b..5a04ed43f 100644
--- a/src/Psalm/Report/CompactReport.php
+++ b/src/Psalm/Report/CompactReport.php
@@ -1,22 +1,22 @@
 <?php
 namespace Psalm\Report;
 
+use function count;
+use function implode;
+use function is_null;
 use Psalm\Config;
 use Psalm\Report;
+use function str_split;
+use function strlen;
+use function strtoupper;
 use Symfony\Component\Console\Helper\Table;
 use Symfony\Component\Console\Output\BufferedOutput;
-use function is_null;
-use const PHP_EOL;
-use function strtoupper;
-use function strlen;
-use function implode;
-use function str_split;
-use function count;
 
 class CompactReport extends Report
 {
     /**
-     * {{@inheritdoc}}
+     * {@inheritdoc}
+     *
      * @psalm-suppress PossiblyNullReference
      */
     public function create(): string
@@ -66,7 +66,7 @@ class CompactReport extends Report
                 $severity,
                 $issue_data['line_from'],
                 $issue_data['type'],
-                $message
+                $message,
             ]);
 
             $current_file = $issue_data['file_name'];
diff --git a/src/Psalm/Report/ConsoleReport.php b/src/Psalm/Report/ConsoleReport.php
index 927439c68..a347d668c 100644
--- a/src/Psalm/Report/ConsoleReport.php
+++ b/src/Psalm/Report/ConsoleReport.php
@@ -8,7 +8,7 @@ use function substr;
 class ConsoleReport extends Report
 {
     /**
-     * {{@inheritdoc}}
+     * {@inheritdoc}
      */
     public function create(): string
     {
diff --git a/src/Psalm/Report/EmacsReport.php b/src/Psalm/Report/EmacsReport.php
index bd64df86e..88cfdd67c 100644
--- a/src/Psalm/Report/EmacsReport.php
+++ b/src/Psalm/Report/EmacsReport.php
@@ -8,7 +8,7 @@ use function sprintf;
 class EmacsReport extends Report
 {
     /**
-     * {{@inheritdoc}}
+     * {@inheritdoc}
      */
     public function create(): string
     {
diff --git a/src/Psalm/Report/JsonReport.php b/src/Psalm/Report/JsonReport.php
index 812ebe58b..aa3afc5ac 100644
--- a/src/Psalm/Report/JsonReport.php
+++ b/src/Psalm/Report/JsonReport.php
@@ -1,13 +1,13 @@
 <?php
 namespace Psalm\Report;
 
-use Psalm\Report;
 use function json_encode;
+use Psalm\Report;
 
 class JsonReport extends Report
 {
     /**
-     * {{@inheritdoc}}
+     * {@inheritdoc}
      */
     public function create(): string
     {
diff --git a/src/Psalm/Report/JsonSummaryReport.php b/src/Psalm/Report/JsonSummaryReport.php
index c300e02b8..4537b14e9 100644
--- a/src/Psalm/Report/JsonSummaryReport.php
+++ b/src/Psalm/Report/JsonSummaryReport.php
@@ -1,13 +1,13 @@
 <?php
 namespace Psalm\Report;
 
-use Psalm\Report;
 use function json_encode;
+use Psalm\Report;
 
 class JsonSummaryReport extends Report
 {
     /**
-     * {{@inheritdoc}}
+     * {@inheritdoc}
      */
     public function create(): string
     {
@@ -20,13 +20,13 @@ class JsonSummaryReport extends Report
                 $type_counts[$type] = 0;
             }
 
-            $type_counts[$type]++;
+            ++$type_counts[$type];
         }
 
         return json_encode([
             'issue_counts' => $type_counts,
             'mixed_expression_count' => $this->mixed_expression_count,
-            'total_expression_count' => $this->total_expression_count
+            'total_expression_count' => $this->total_expression_count,
         ]) . "\n";
     }
 }
diff --git a/src/Psalm/Report/PylintReport.php b/src/Psalm/Report/PylintReport.php
index c41ec80ed..0f21b74ee 100644
--- a/src/Psalm/Report/PylintReport.php
+++ b/src/Psalm/Report/PylintReport.php
@@ -8,7 +8,7 @@ use function sprintf;
 class PylintReport extends Report
 {
     /**
-     * {{@inheritdoc}}
+     * {@inheritdoc}
      */
     public function create(): string
     {
diff --git a/src/Psalm/Report/SonarqubeReport.php b/src/Psalm/Report/SonarqubeReport.php
index b4797d87d..cde074c7e 100644
--- a/src/Psalm/Report/SonarqubeReport.php
+++ b/src/Psalm/Report/SonarqubeReport.php
@@ -1,10 +1,10 @@
 <?php
 namespace Psalm\Report;
 
+use function json_encode;
+use function max;
 use Psalm\Config;
 use Psalm\Report;
-use function max;
-use function json_encode;
 
 /**
  * JSON report format suitable for import into SonarQube or SonarCloud as
@@ -15,7 +15,7 @@ use function json_encode;
 class SonarqubeReport extends Report
 {
     /**
-     * {{@inheritdoc}}
+     * {@inheritdoc}
      */
     public function create(): string
     {
diff --git a/src/Psalm/Report/TextReport.php b/src/Psalm/Report/TextReport.php
index 366b3a5dd..4badab071 100644
--- a/src/Psalm/Report/TextReport.php
+++ b/src/Psalm/Report/TextReport.php
@@ -8,7 +8,7 @@ use function sprintf;
 class TextReport extends Report
 {
     /**
-     * {{@inheritdoc}}
+     * {@inheritdoc}
      */
     public function create(): string
     {
diff --git a/src/Psalm/Report/XmlReport.php b/src/Psalm/Report/XmlReport.php
index f667a1a11..9d91a2727 100644
--- a/src/Psalm/Report/XmlReport.php
+++ b/src/Psalm/Report/XmlReport.php
@@ -7,7 +7,7 @@ use Psalm\Report;
 class XmlReport extends Report
 {
     /**
-     * {{@inheritdoc}}
+     * {@inheritdoc}
      */
     public function create(): string
     {
diff --git a/src/Psalm/SourceControl/Git/CommitInfo.php b/src/Psalm/SourceControl/Git/CommitInfo.php
index 2217e3952..d69b08746 100644
--- a/src/Psalm/SourceControl/Git/CommitInfo.php
+++ b/src/Psalm/SourceControl/Git/CommitInfo.php
@@ -1,5 +1,4 @@
 <?php
-
 namespace Psalm\SourceControl\Git;
 
 /**
@@ -85,6 +84,7 @@ class CommitInfo
 
     /**
      * Return commit ID.
+     *
      * @return ?string
      */
     public function getId()
@@ -126,6 +126,7 @@ class CommitInfo
 
     /**
      * Return author email.
+     *
      * @return null|string
      */
     public function getAuthorEmail()
@@ -145,6 +146,7 @@ class CommitInfo
 
     /**
      * Return committer name.
+     *
      * @return null|string
      */
     public function getCommitterName()
@@ -164,6 +166,7 @@ class CommitInfo
 
     /**
      * Return committer email.
+     *
      * @return null|string
      */
     public function getCommitterEmail()
@@ -183,6 +186,7 @@ class CommitInfo
 
     /**
      * Return commit message.
+     *
      * @return null|string
      */
     public function getMessage()
@@ -202,6 +206,7 @@ class CommitInfo
 
     /**
      * Return commit date.
+     *
      * @return null|int
      */
     public function getDate()
diff --git a/src/Psalm/SourceControl/Git/GitInfo.php b/src/Psalm/SourceControl/Git/GitInfo.php
index c91e4d153..5f53360f5 100644
--- a/src/Psalm/SourceControl/Git/GitInfo.php
+++ b/src/Psalm/SourceControl/Git/GitInfo.php
@@ -1,5 +1,4 @@
 <?php
-
 namespace Psalm\SourceControl\Git;
 
 use Psalm\SourceControl\SourceControlInfo;
diff --git a/src/Psalm/SourceControl/Git/RemoteInfo.php b/src/Psalm/SourceControl/Git/RemoteInfo.php
index 1f9a5ec83..11ba7c028 100644
--- a/src/Psalm/SourceControl/Git/RemoteInfo.php
+++ b/src/Psalm/SourceControl/Git/RemoteInfo.php
@@ -1,5 +1,4 @@
 <?php
-
 namespace Psalm\SourceControl\Git;
 
 /**
diff --git a/src/Psalm/SourceControl/SourceControlInfo.php b/src/Psalm/SourceControl/SourceControlInfo.php
index 65699d193..ed60dc87d 100644
--- a/src/Psalm/SourceControl/SourceControlInfo.php
+++ b/src/Psalm/SourceControl/SourceControlInfo.php
@@ -1,5 +1,4 @@
 <?php
-
 namespace Psalm\SourceControl;
 
 abstract class SourceControlInfo
diff --git a/src/Psalm/Storage/FunctionLikeStorage.php b/src/Psalm/Storage/FunctionLikeStorage.php
index 85de2e5ea..2df06b19d 100644
--- a/src/Psalm/Storage/FunctionLikeStorage.php
+++ b/src/Psalm/Storage/FunctionLikeStorage.php
@@ -1,12 +1,11 @@
 <?php
 namespace Psalm\Storage;
 
+use function array_map;
+use function implode;
 use Psalm\CodeLocation;
-use Psalm\Type;
 use Psalm\Internal\Analyzer\ClassLikeAnalyzer;
-use const PHP_EOL;
-use function implode;
-use function array_map;
+use Psalm\Type;
 
 class FunctionLikeStorage
 {
diff --git a/src/Psalm/Storage/MethodStorage.php b/src/Psalm/Storage/MethodStorage.php
index 73d060911..28572e62b 100644
--- a/src/Psalm/Storage/MethodStorage.php
+++ b/src/Psalm/Storage/MethodStorage.php
@@ -1,8 +1,6 @@
 <?php
 namespace Psalm\Storage;
 
-use Psalm\CodeLocation;
-
 class MethodStorage extends FunctionLikeStorage
 {
     /**
diff --git a/src/Psalm/Storage/PropertyStorage.php b/src/Psalm/Storage/PropertyStorage.php
index 629ae621a..0a56611be 100644
--- a/src/Psalm/Storage/PropertyStorage.php
+++ b/src/Psalm/Storage/PropertyStorage.php
@@ -2,8 +2,8 @@
 namespace Psalm\Storage;
 
 use Psalm\CodeLocation;
-use Psalm\Type;
 use Psalm\Internal\Analyzer\ClassLikeAnalyzer;
+use Psalm\Type;
 
 class PropertyStorage
 {
diff --git a/src/Psalm/Type.php b/src/Psalm/Type.php
index cec61f786..cf4769bdb 100644
--- a/src/Psalm/Type.php
+++ b/src/Psalm/Type.php
@@ -1,7 +1,27 @@
 <?php
 namespace Psalm;
 
+use function array_keys;
+use function array_map;
+use function array_merge;
+use function array_pop;
+use function array_push;
+use function array_shift;
+use function array_splice;
+use function array_unshift;
+use function array_values;
+use function count;
+use function explode;
+use function get_class;
+use function implode;
+use function in_array;
+use function is_numeric;
+use function preg_match;
+use function preg_quote;
+use function preg_replace;
 use Psalm\Exception\TypeParseTreeException;
+use Psalm\Internal\Type\ParseTree;
+use Psalm\Internal\Type\TypeCombination;
 use Psalm\Storage\FunctionLikeParameter;
 use Psalm\Type\Atomic;
 use Psalm\Type\Atomic\ObjectLike;
@@ -14,7 +34,6 @@ use Psalm\Type\Atomic\TEmpty;
 use Psalm\Type\Atomic\TFalse;
 use Psalm\Type\Atomic\TFloat;
 use Psalm\Type\Atomic\TGenericObject;
-use Psalm\Type\Atomic\TTemplateParam;
 use Psalm\Type\Atomic\TInt;
 use Psalm\Type\Atomic\TIterable;
 use Psalm\Type\Atomic\TLiteralClassString;
@@ -30,35 +49,16 @@ use Psalm\Type\Atomic\TObjectWithProperties;
 use Psalm\Type\Atomic\TResource;
 use Psalm\Type\Atomic\TSingleLetter;
 use Psalm\Type\Atomic\TString;
+use Psalm\Type\Atomic\TTemplateParam;
 use Psalm\Type\Atomic\TTrue;
 use Psalm\Type\Atomic\TVoid;
-use Psalm\Internal\Type\ParseTree;
-use Psalm\Internal\Type\TypeCombination;
 use Psalm\Type\Union;
-use function count;
-use function preg_match;
+use function str_split;
+use function stripos;
 use function strlen;
-use function strtolower;
-use function array_map;
-use function array_unshift;
-use function array_keys;
-use function array_values;
-use function get_class;
-use function array_shift;
 use function strpos;
-use function preg_replace;
-use function in_array;
+use function strtolower;
 use function substr;
-use function explode;
-use function str_split;
-use function is_numeric;
-use function array_push;
-use function array_splice;
-use function implode;
-use function stripos;
-use function preg_quote;
-use function array_pop;
-use function array_merge;
 
 abstract class Type
 {
@@ -256,7 +256,7 @@ abstract class Type
                     array_unshift($generic_params, new Union([new TMixed]));
                 }
 
-                for ($i = 0, $l = 4 - count($generic_params); $i < $l; $i++) {
+                for ($i = 0, $l = 4 - count($generic_params); $i < $l; ++$i) {
                     $generic_params[] = new Union([new TMixed]);
                 }
             }
@@ -282,6 +282,7 @@ abstract class Type
 
                 if (isset($template_type_map[$class_name])) {
                     $first_class = array_keys($template_type_map[$class_name])[0];
+
                     return self::getGenericParamClass(
                         $class_name,
                         $template_type_map[$class_name][$first_class][0],
@@ -575,13 +576,14 @@ abstract class Type
 
             if ($non_nullable_type instanceof Union) {
                 $non_nullable_type->addType(new TNull);
+
                 return $non_nullable_type;
             }
 
             if ($non_nullable_type instanceof Atomic) {
                 return TypeCombination::combineTypes([
                     new TNull,
-                    $non_nullable_type
+                    $non_nullable_type,
                 ]);
             }
 
@@ -724,6 +726,7 @@ abstract class Type
                 );
 
                 $as->substitute(new Union([$t]), new Union([$traversable]));
+
                 return new Atomic\TTemplateParamClass(
                     $param_name,
                     $traversable->value,
@@ -858,7 +861,7 @@ abstract class Type
 
                     $was_char = true;
 
-                    $i++;
+                    ++$i;
 
                     continue;
                 }
@@ -928,13 +931,13 @@ abstract class Type
     ) {
         $type_tokens = self::tokenize($string_type);
 
-        for ($i = 0, $l = count($type_tokens); $i < $l; $i++) {
+        for ($i = 0, $l = count($type_tokens); $i < $l; ++$i) {
             $string_type_token = $type_tokens[$i];
 
             if (in_array(
                 $string_type_token[0],
                 [
-                    '<', '>', '|', '?', ',', '{', '}', ':', '::', '[', ']', '(', ')', '&', '=', '...'
+                    '<', '>', '|', '?', ',', '{', '}', ':', '::', '[', ']', '(', ')', '&', '=', '...',
                 ],
                 true
             )) {
@@ -1187,7 +1190,7 @@ abstract class Type
                 $extends === 'object'
                     ? null
                     : new TNamedObject($extends)
-            )
+            ),
         ]);
     }
 
diff --git a/src/Psalm/Type/Algebra.php b/src/Psalm/Type/Algebra.php
index 725bad6a1..dd118431c 100644
--- a/src/Psalm/Type/Algebra.php
+++ b/src/Psalm/Type/Algebra.php
@@ -1,25 +1,25 @@
 <?php
 namespace Psalm\Type;
 
+use function array_filter;
+use function array_keys;
+use function array_map;
+use function array_merge;
+use function array_pop;
+use function array_shift;
+use function array_unique;
+use function array_values;
+use function count;
+use function in_array;
 use PhpParser;
 use Psalm\Codebase;
 use Psalm\Exception\ComplicatedExpressionException;
+use Psalm\FileSource;
 use Psalm\Internal\Analyzer\Statements\Expression\AssertionFinder;
 use Psalm\Internal\Clause;
-use Psalm\FileSource;
-use function array_map;
-use function count;
-use function substr;
-use function array_merge;
 use function strlen;
-use function array_unique;
-use function array_values;
-use function array_keys;
-use function array_pop;
-use function in_array;
-use function array_filter;
-use function array_shift;
 use function strpos;
+use function substr;
 
 class Algebra
 {
@@ -521,7 +521,7 @@ class Algebra
 
                     $new_clauses[] = $new_clause;
 
-                    $complexity++;
+                    ++$complexity;
                 }
             }
         }
@@ -643,6 +643,7 @@ class Algebra
         }
 
         $negated = self::simplifyCNF(self::groupImpossibilities($clauses, $complexity));
+
         return $negated;
     }
 
diff --git a/src/Psalm/Type/Atomic.php b/src/Psalm/Type/Atomic.php
index 7cb230611..951d22df8 100644
--- a/src/Psalm/Type/Atomic.php
+++ b/src/Psalm/Type/Atomic.php
@@ -1,11 +1,18 @@
 <?php
 namespace Psalm\Type;
 
-use Psalm\Internal\Analyzer\Statements\ExpressionAnalyzer;
-use Psalm\Internal\Analyzer\ClassLikeAnalyzer;
-use Psalm\Internal\Analyzer\TypeAnalyzer;
+use function array_filter;
+use function array_keys;
+use function array_search;
+use function array_values;
+use function count;
+use function get_class;
+use function is_numeric;
 use Psalm\Codebase;
 use Psalm\CodeLocation;
+use Psalm\Internal\Analyzer\ClassLikeAnalyzer;
+use Psalm\Internal\Analyzer\Statements\ExpressionAnalyzer;
+use Psalm\Internal\Analyzer\TypeAnalyzer;
 use Psalm\Issue\InvalidTemplateParam;
 use Psalm\Issue\MissingTemplateParam;
 use Psalm\Issue\ReservedWord;
@@ -21,17 +28,16 @@ use Psalm\Type\Atomic\TArrayKey;
 use Psalm\Type\Atomic\TBool;
 use Psalm\Type\Atomic\TCallable;
 use Psalm\Type\Atomic\TCallableArray;
-use Psalm\Type\Atomic\TCallableObjectLikeArray;
 use Psalm\Type\Atomic\TCallableObject;
+use Psalm\Type\Atomic\TCallableObjectLikeArray;
 use Psalm\Type\Atomic\TCallableString;
 use Psalm\Type\Atomic\TClassString;
 use Psalm\Type\Atomic\TEmpty;
 use Psalm\Type\Atomic\TFalse;
 use Psalm\Type\Atomic\TFloat;
-use Psalm\Type\Atomic\TTemplateParam;
 use Psalm\Type\Atomic\THtmlEscapedString;
-use Psalm\Type\Atomic\TIterable;
 use Psalm\Type\Atomic\TInt;
+use Psalm\Type\Atomic\TIterable;
 use Psalm\Type\Atomic\TLiteralClassString;
 use Psalm\Type\Atomic\TMixed;
 use Psalm\Type\Atomic\TNamedObject;
@@ -45,20 +51,14 @@ use Psalm\Type\Atomic\TResource;
 use Psalm\Type\Atomic\TScalar;
 use Psalm\Type\Atomic\TScalarClassConstant;
 use Psalm\Type\Atomic\TString;
+use Psalm\Type\Atomic\TTemplateParam;
 use Psalm\Type\Atomic\TTraitString;
 use Psalm\Type\Atomic\TTrue;
 use Psalm\Type\Atomic\TVoid;
+use function reset;
 use function strpos;
-use function substr;
-use function is_numeric;
-use function array_keys;
 use function strtolower;
-use function array_filter;
-use function array_search;
-use function count;
-use function array_values;
-use function reset;
-use function get_class;
+use function substr;
 
 abstract class Atomic
 {
@@ -291,7 +291,8 @@ abstract class Atomic
     public function hasTraversableInterface(Codebase $codebase)
     {
         return $this instanceof TNamedObject
-            && (strtolower($this->value) === 'traversable'
+            && (
+                strtolower($this->value) === 'traversable'
                 || ($codebase->classOrInterfaceExists($this->value)
                     && ($codebase->classExtendsOrImplements(
                         $this->value,
@@ -300,7 +301,8 @@ abstract class Atomic
                         $this->value,
                         'Traversable'
                     )))
-                || ($this->extra_types
+                || (
+                    $this->extra_types
                     && array_filter(
                         $this->extra_types,
                         function (Atomic $a) use ($codebase) : bool {
@@ -317,7 +319,8 @@ abstract class Atomic
     public function hasCountableInterface(Codebase $codebase)
     {
         return $this instanceof TNamedObject
-            && (strtolower($this->value) === 'countable'
+            && (
+                strtolower($this->value) === 'countable'
                 || ($codebase->classOrInterfaceExists($this->value)
                     && ($codebase->classExtendsOrImplements(
                         $this->value,
@@ -326,7 +329,8 @@ abstract class Atomic
                         $this->value,
                         'Countable'
                     )))
-                || ($this->extra_types
+                || (
+                    $this->extra_types
                     && array_filter(
                         $this->extra_types,
                         function (Atomic $a) use ($codebase) : bool {
@@ -479,7 +483,7 @@ abstract class Atomic
                 $class_storage = $codebase->classlike_storage_provider->get($this->defining_class);
 
                 $template_offset = $class_storage->template_types
-                    ? array_search($this->param_name, array_keys($class_storage->template_types))
+                    ? array_search($this->param_name, array_keys($class_storage->template_types), true)
                     : false;
 
                 if ($template_offset !== false
@@ -603,11 +607,11 @@ abstract class Atomic
             } else {
                 $expected_type_params = [
                     'TKey' => [
-                        '' =>  [Type::getMixed(), null],
+                        '' => [Type::getMixed(), null],
                     ],
                     'TValue' => [
-                        '' =>  [Type::getMixed(), null],
-                    ]
+                        '' => [Type::getMixed(), null],
+                    ],
                 ];
             }
 
diff --git a/src/Psalm/Type/Atomic/CallableTrait.php b/src/Psalm/Type/Atomic/CallableTrait.php
index 6e18dd510..19d7a1158 100644
--- a/src/Psalm/Type/Atomic/CallableTrait.php
+++ b/src/Psalm/Type/Atomic/CallableTrait.php
@@ -1,14 +1,14 @@
 <?php
 namespace Psalm\Type\Atomic;
 
+use function array_map;
+use function count;
+use function implode;
 use Psalm\Codebase;
 use Psalm\Storage\FunctionLikeParameter;
 use Psalm\Type;
 use Psalm\Type\Atomic;
 use Psalm\Type\Union;
-use function implode;
-use function array_map;
-use function count;
 
 trait CallableTrait
 {
diff --git a/src/Psalm/Type/Atomic/GenericTrait.php b/src/Psalm/Type/Atomic/GenericTrait.php
index fc2c276c7..754d028bb 100644
--- a/src/Psalm/Type/Atomic/GenericTrait.php
+++ b/src/Psalm/Type/Atomic/GenericTrait.php
@@ -1,13 +1,13 @@
 <?php
 namespace Psalm\Type\Atomic;
 
+use function array_map;
+use function implode;
 use Psalm\Codebase;
 use Psalm\Type;
 use Psalm\Type\Atomic;
 use Psalm\Type\Union;
-use function implode;
 use function substr;
-use function array_map;
 
 trait GenericTrait
 {
diff --git a/src/Psalm/Type/Atomic/GetClassT.php b/src/Psalm/Type/Atomic/GetClassT.php
index ea3a2e547..30208596c 100644
--- a/src/Psalm/Type/Atomic/GetClassT.php
+++ b/src/Psalm/Type/Atomic/GetClassT.php
@@ -1,8 +1,8 @@
 <?php
 namespace Psalm\Type\Atomic;
 
-use Psalm\Type\Union;
 use function array_values;
+use Psalm\Type\Union;
 
 /**
  * Represents a string whose value is a fully-qualified class found by get_class($var)
diff --git a/src/Psalm/Type/Atomic/HasClassString.php b/src/Psalm/Type/Atomic/HasClassString.php
index f353bca65..0dcef48f9 100644
--- a/src/Psalm/Type/Atomic/HasClassString.php
+++ b/src/Psalm/Type/Atomic/HasClassString.php
@@ -1,5 +1,4 @@
 <?php
-
 namespace Psalm\Type\Atomic;
 
 interface HasClassString
diff --git a/src/Psalm/Type/Atomic/HasIntersectionTrait.php b/src/Psalm/Type/Atomic/HasIntersectionTrait.php
index 7c8ee9343..6f594a8da 100644
--- a/src/Psalm/Type/Atomic/HasIntersectionTrait.php
+++ b/src/Psalm/Type/Atomic/HasIntersectionTrait.php
@@ -1,11 +1,11 @@
 <?php
 namespace Psalm\Type\Atomic;
 
+use function array_map;
+use function implode;
+use Psalm\Codebase;
 use Psalm\Type;
 use Psalm\Type\Atomic;
-use Psalm\Codebase;
-use function implode;
-use function array_map;
 
 trait HasIntersectionTrait
 {
@@ -32,6 +32,7 @@ trait HasIntersectionTrait
             array_map(
                 /**
                  * @param TNamedObject|TTemplateParam|TIterable|TObjectWithProperties $extra_type
+                 *
                  * @return string
                  */
                 function (Atomic $extra_type) use (
diff --git a/src/Psalm/Type/Atomic/ObjectLike.php b/src/Psalm/Type/Atomic/ObjectLike.php
index af659aeee..027d81f65 100644
--- a/src/Psalm/Type/Atomic/ObjectLike.php
+++ b/src/Psalm/Type/Atomic/ObjectLike.php
@@ -1,17 +1,17 @@
 <?php
 namespace Psalm\Type\Atomic;
 
+use function array_keys;
+use function array_map;
+use function count;
+use function get_class;
+use function implode;
+use function is_int;
 use Psalm\Codebase;
+use Psalm\Internal\Type\TypeCombination;
 use Psalm\Type;
 use Psalm\Type\Atomic;
-use Psalm\Internal\Type\TypeCombination;
 use Psalm\Type\Union;
-use function implode;
-use function array_map;
-use function array_keys;
-use function is_int;
-use function count;
-use function get_class;
 
 /**
  * Represents an array where we know its key values
diff --git a/src/Psalm/Type/Atomic/TArray.php b/src/Psalm/Type/Atomic/TArray.php
index dfb1195b9..032a3a490 100644
--- a/src/Psalm/Type/Atomic/TArray.php
+++ b/src/Psalm/Type/Atomic/TArray.php
@@ -1,9 +1,9 @@
 <?php
 namespace Psalm\Type\Atomic;
 
-use Psalm\Type\Atomic;
-use function get_class;
 use function count;
+use function get_class;
+use Psalm\Type\Atomic;
 
 /**
  * Represents an array with generic type parameters.
diff --git a/src/Psalm/Type/Atomic/TClassString.php b/src/Psalm/Type/Atomic/TClassString.php
index e8b471fd4..af55643c7 100644
--- a/src/Psalm/Type/Atomic/TClassString.php
+++ b/src/Psalm/Type/Atomic/TClassString.php
@@ -1,9 +1,9 @@
 <?php
 namespace Psalm\Type\Atomic;
 
-use function stripos;
-use function preg_replace;
 use function preg_quote;
+use function preg_replace;
+use function stripos;
 use function strtolower;
 
 class TClassString extends TString implements HasClassString
@@ -24,7 +24,7 @@ class TClassString extends TString implements HasClassString
         $this->as_type = $as_type;
     }
 
-     /**
+    /**
      * @return string
      */
     public function getKey()
diff --git a/src/Psalm/Type/Atomic/TGenericObject.php b/src/Psalm/Type/Atomic/TGenericObject.php
index 076e0e941..bf835351c 100644
--- a/src/Psalm/Type/Atomic/TGenericObject.php
+++ b/src/Psalm/Type/Atomic/TGenericObject.php
@@ -1,10 +1,10 @@
 <?php
 namespace Psalm\Type\Atomic;
 
+use function count;
+use function implode;
 use Psalm\Type\Atomic;
 use function substr;
-use function implode;
-use function count;
 
 class TGenericObject extends TNamedObject
 {
diff --git a/src/Psalm/Type/Atomic/TIterable.php b/src/Psalm/Type/Atomic/TIterable.php
index 12c06cfa9..718f42fee 100644
--- a/src/Psalm/Type/Atomic/TIterable.php
+++ b/src/Psalm/Type/Atomic/TIterable.php
@@ -1,10 +1,10 @@
 <?php
 namespace Psalm\Type\Atomic;
 
-use Psalm\Type\Atomic;
+use function count;
 use function implode;
+use Psalm\Type\Atomic;
 use function substr;
-use function count;
 
 class TIterable extends Atomic
 {
diff --git a/src/Psalm/Type/Atomic/TKeyOfClassConstant.php b/src/Psalm/Type/Atomic/TKeyOfClassConstant.php
index 101bcd659..008e7fd15 100644
--- a/src/Psalm/Type/Atomic/TKeyOfClassConstant.php
+++ b/src/Psalm/Type/Atomic/TKeyOfClassConstant.php
@@ -1,9 +1,9 @@
 <?php
 namespace Psalm\Type\Atomic;
 
-use function stripos;
-use function preg_replace;
 use function preg_quote;
+use function preg_replace;
+use function stripos;
 use function strtolower;
 
 class TKeyOfClassConstant extends Scalar
diff --git a/src/Psalm/Type/Atomic/TLiteralClassString.php b/src/Psalm/Type/Atomic/TLiteralClassString.php
index 9d1679571..dc929b9bc 100644
--- a/src/Psalm/Type/Atomic/TLiteralClassString.php
+++ b/src/Psalm/Type/Atomic/TLiteralClassString.php
@@ -1,9 +1,9 @@
 <?php
 namespace Psalm\Type\Atomic;
 
-use function stripos;
-use function preg_replace;
 use function preg_quote;
+use function preg_replace;
+use function stripos;
 use function strtolower;
 
 class TLiteralClassString extends TLiteralString
diff --git a/src/Psalm/Type/Atomic/TLiteralString.php b/src/Psalm/Type/Atomic/TLiteralString.php
index 1f062f4b0..62ab705b1 100644
--- a/src/Psalm/Type/Atomic/TLiteralString.php
+++ b/src/Psalm/Type/Atomic/TLiteralString.php
@@ -43,6 +43,7 @@ class TLiteralString extends TString
         if (strlen($this->value) > 80) {
             return 'string(' . substr($no_newline_value, 0, 80) . '...' . ')';
         }
+
         return 'string(' . $no_newline_value . ')';
     }
 
diff --git a/src/Psalm/Type/Atomic/TNamedObject.php b/src/Psalm/Type/Atomic/TNamedObject.php
index aeef651ba..965874be0 100644
--- a/src/Psalm/Type/Atomic/TNamedObject.php
+++ b/src/Psalm/Type/Atomic/TNamedObject.php
@@ -1,12 +1,11 @@
 <?php
 namespace Psalm\Type\Atomic;
 
+use function implode;
 use Psalm\Codebase;
 use Psalm\Type;
 use Psalm\Type\Atomic;
-use Psalm\Type\Union;
 use function substr;
-use function implode;
 
 class TNamedObject extends Atomic
 {
diff --git a/src/Psalm/Type/Atomic/TObjectWithProperties.php b/src/Psalm/Type/Atomic/TObjectWithProperties.php
index 5b7100102..083d16c11 100644
--- a/src/Psalm/Type/Atomic/TObjectWithProperties.php
+++ b/src/Psalm/Type/Atomic/TObjectWithProperties.php
@@ -1,12 +1,12 @@
 <?php
 namespace Psalm\Type\Atomic;
 
-use Psalm\Type\Union;
-use Psalm\Type\Atomic;
-use function implode;
-use function array_map;
 use function array_keys;
+use function array_map;
 use function count;
+use function implode;
+use Psalm\Type\Atomic;
+use Psalm\Type\Union;
 
 class TObjectWithProperties extends TObject
 {
diff --git a/src/Psalm/Type/Atomic/TTemplateParam.php b/src/Psalm/Type/Atomic/TTemplateParam.php
index f97803244..582ffa7a7 100644
--- a/src/Psalm/Type/Atomic/TTemplateParam.php
+++ b/src/Psalm/Type/Atomic/TTemplateParam.php
@@ -1,10 +1,10 @@
 <?php
 namespace Psalm\Type\Atomic;
 
+use function implode;
 use Psalm\Codebase;
 use Psalm\Type;
 use Psalm\Type\Union;
-use function implode;
 
 class TTemplateParam extends \Psalm\Type\Atomic
 {
@@ -63,7 +63,7 @@ class TTemplateParam extends \Psalm\Type\Atomic
     public function getId()
     {
         if ($this->extra_types) {
-            return '(' . $this->param_name. ' as ' . $this->as->getId()
+            return '(' . $this->param_name . ' as ' . $this->as->getId()
                 . ')&' . implode('&', $this->extra_types);
         }
 
diff --git a/src/Psalm/Type/Reconciler.php b/src/Psalm/Type/Reconciler.php
index a93d4670d..520c3e008 100644
--- a/src/Psalm/Type/Reconciler.php
+++ b/src/Psalm/Type/Reconciler.php
@@ -1,11 +1,21 @@
 <?php
 namespace Psalm\Type;
 
+use function array_filter;
+use function array_map;
+use function array_pop;
+use function array_shift;
+use function count;
+use function explode;
+use function get_class;
+use function implode;
+use function is_string;
+use function ksort;
+use Psalm\Codebase;
+use Psalm\CodeLocation;
 use Psalm\Internal\Analyzer\StatementsAnalyzer;
 use Psalm\Internal\Analyzer\TraitAnalyzer;
 use Psalm\Internal\Analyzer\TypeAnalyzer;
-use Psalm\Codebase;
-use Psalm\CodeLocation;
 use Psalm\Issue\DocblockTypeContradiction;
 use Psalm\Issue\ParadoxicalCondition;
 use Psalm\Issue\PsalmInternalError;
@@ -26,7 +36,6 @@ use Psalm\Type\Atomic\TCallableObjectLikeArray;
 use Psalm\Type\Atomic\TClassString;
 use Psalm\Type\Atomic\TEmpty;
 use Psalm\Type\Atomic\TFalse;
-use Psalm\Type\Atomic\TTemplateParam;
 use Psalm\Type\Atomic\TInt;
 use Psalm\Type\Atomic\TMixed;
 use Psalm\Type\Atomic\TNamedObject;
@@ -37,22 +46,13 @@ use Psalm\Type\Atomic\TObject;
 use Psalm\Type\Atomic\TResource;
 use Psalm\Type\Atomic\TScalar;
 use Psalm\Type\Atomic\TString;
+use Psalm\Type\Atomic\TTemplateParam;
 use Psalm\Type\Atomic\TTrue;
+use function str_replace;
+use function str_split;
 use function strpos;
-use function array_shift;
-use function ksort;
-use function substr;
-use function implode;
-use function array_map;
-use function is_string;
-use function array_filter;
-use function get_class;
-use function count;
 use function strtolower;
-use function array_pop;
-use function str_split;
-use function explode;
-use function str_replace;
+use function substr;
 
 class Reconciler
 {
@@ -790,7 +790,7 @@ class Reconciler
             if ($existing_var_type->hasMixed()) {
                 return new Type\Union([
                     new Type\Atomic\TArray([Type::getArrayKey(), Type::getMixed()]),
-                    new Type\Atomic\TNamedObject('Countable')
+                    new Type\Atomic\TNamedObject('Countable'),
                 ]);
             }
 
@@ -1016,16 +1016,16 @@ class Reconciler
                 $existing_var_type->addType(
                     new TCallableObjectLikeArray([
                         new Type\Union([new TObject, new TString]),
-                        Type::getString()
+                        Type::getString(),
                     ])
                 );
             } else {
                 $array_combination = \Psalm\Internal\Type\TypeCombination::combineTypes([
                     new TCallableObjectLikeArray([
                         new Type\Union([new TObject, new TString]),
-                        Type::getString()
+                        Type::getString(),
                     ]),
-                    $existing_var_atomic_types['array']
+                    $existing_var_atomic_types['array'],
                 ]);
 
                 $existing_var_type->addType(
@@ -1106,7 +1106,7 @@ class Reconciler
 
             if ($existing_var_type->hasMixed()) {
                 $type = new Type\Union([
-                    new Type\Atomic\TNamedObject($new_var_type)
+                    new Type\Atomic\TNamedObject($new_var_type),
                 ]);
 
                 if ($allow_string_comparison) {
@@ -1156,14 +1156,16 @@ class Reconciler
 
                     $new_type = Type::getClassString($new_var_type);
 
-                    if (($new_type_has_interface_string
+                    if ((
+                        $new_type_has_interface_string
                             && !TypeAnalyzer::isContainedBy(
                                 $codebase,
                                 $existing_var_type,
                                 $new_type
                             )
                         )
-                        || ($old_type_has_interface_string
+                        || (
+                            $old_type_has_interface_string
                             && !TypeAnalyzer::isContainedBy(
                                 $codebase,
                                 $new_type,
@@ -1212,7 +1214,7 @@ class Reconciler
 
                         if (count($acceptable_atomic_types) === 1) {
                             return new Type\Union([
-                                new TClassString('object', $acceptable_atomic_types[0])
+                                new TClassString('object', $acceptable_atomic_types[0]),
                             ]);
                         }
                     }
@@ -1275,14 +1277,16 @@ class Reconciler
         $new_type_part = Atomic::create($new_var_type, null, $template_type_map);
 
         if ($new_type_part instanceof TNamedObject
-            && (($new_type_has_interface
+            && ((
+                $new_type_has_interface
                     && !TypeAnalyzer::isContainedBy(
                         $codebase,
                         $existing_var_type,
                         $new_type
                     )
                 )
-                || ($old_type_has_interface
+                || (
+                    $old_type_has_interface
                     && !TypeAnalyzer::isContainedBy(
                         $codebase,
                         $new_type,
@@ -2721,7 +2725,7 @@ class Reconciler
                     if ($base_atomic_type instanceof Type\Atomic\TArray) {
                         $base_atomic_type = new Type\Atomic\ObjectLike(
                             [
-                                $array_key_offset => clone $result_type
+                                $array_key_offset => clone $result_type,
                             ],
                             null
                         );
@@ -2793,7 +2797,7 @@ class Reconciler
                 case ']':
                     $parts_offset++;
                     $parts[$parts_offset] = $char;
-                    $parts_offset++;
+                    ++$parts_offset;
                     continue 2;
 
                 case '\'':
@@ -2810,13 +2814,14 @@ class Reconciler
                     if ($i < $char_count - 1 && $chars[$i + 1] === '>') {
                         ++$i;
 
-                        $parts_offset++;
+                        ++$parts_offset;
                         $parts[$parts_offset] = '->';
-                        $parts_offset++;
+                        ++$parts_offset;
                         continue 2;
                     }
                     // fall through
 
+                    // no break
                 default:
                     if (!isset($parts[$parts_offset])) {
                         $parts[$parts_offset] = '';
diff --git a/src/Psalm/Type/Union.php b/src/Psalm/Type/Union.php
index 139caba7e..5fac2833e 100644
--- a/src/Psalm/Type/Union.php
+++ b/src/Psalm/Type/Union.php
@@ -1,33 +1,33 @@
 <?php
 namespace Psalm\Type;
 
+use function array_filter;
+use function array_merge;
+use function array_shift;
+use function array_values;
+use function count;
+use function get_class;
+use function is_string;
 use Psalm\Codebase;
 use Psalm\CodeLocation;
-use Psalm\StatementsSource;
 use Psalm\Internal\Analyzer\TypeAnalyzer;
+use Psalm\Internal\Type\TypeCombination;
+use Psalm\StatementsSource;
 use Psalm\Storage\FileStorage;
 use Psalm\Type;
 use Psalm\Type\Atomic\TFloat;
+use Psalm\Type\Atomic\TGenericObject;
 use Psalm\Type\Atomic\TInt;
 use Psalm\Type\Atomic\TIterable;
 use Psalm\Type\Atomic\TLiteralFloat;
 use Psalm\Type\Atomic\TLiteralInt;
 use Psalm\Type\Atomic\TLiteralString;
-use Psalm\Type\Atomic\TGenericObject;
 use Psalm\Type\Atomic\TNamedObject;
 use Psalm\Type\Atomic\TString;
 use Psalm\Type\Atomic\TTemplateParam;
-use Psalm\Internal\Type\TypeCombination;
-use function substr;
-use function array_values;
-use function strpos;
-use function count;
-use function array_filter;
-use function get_class;
 use function reset;
-use function is_string;
-use function array_shift;
-use function array_merge;
+use function strpos;
+use function substr;
 
 class Union
 {
@@ -106,6 +106,7 @@ class Union
 
     /**
      * Whether or not this union had a template, since replaced
+     *
      * @var bool
      */
     public $had_template = false;
@@ -196,26 +197,22 @@ class Union
             $this->literal_float_types[$type->getKey()] = $type;
         } elseif ($type instanceof TString && $this->literal_string_types) {
             foreach ($this->literal_string_types as $key => $_) {
-                unset($this->literal_string_types[$key]);
-                unset($this->types[$key]);
+                unset($this->literal_string_types[$key], $this->types[$key]);
             }
             if (!$type instanceof Type\Atomic\TClassString
                 || !$type->as_type
             ) {
                 foreach ($this->typed_class_strings as $key => $_) {
-                    unset($this->typed_class_strings[$key]);
-                    unset($this->types[$key]);
+                    unset($this->typed_class_strings[$key], $this->types[$key]);
                 }
             }
         } elseif ($type instanceof TInt && $this->literal_int_types) {
             foreach ($this->literal_int_types as $key => $_) {
-                unset($this->literal_int_types[$key]);
-                unset($this->types[$key]);
+                unset($this->literal_int_types[$key], $this->types[$key]);
             }
         } elseif ($type instanceof TFloat && $this->literal_float_types) {
             foreach ($this->literal_float_types as $key => $_) {
-                unset($this->literal_float_types[$key]);
-                unset($this->types[$key]);
+                unset($this->literal_float_types[$key], $this->types[$key]);
             }
         }
 
@@ -503,9 +500,11 @@ class Union
             unset($this->types[$type_string]);
 
             if (strpos($type_string, '(')) {
-                unset($this->literal_string_types[$type_string]);
-                unset($this->literal_int_types[$type_string]);
-                unset($this->literal_float_types[$type_string]);
+                unset(
+                    $this->literal_string_types[$type_string],
+                    $this->literal_int_types[$type_string],
+                    $this->literal_float_types[$type_string]
+                );
             }
 
             $this->id = null;
@@ -528,8 +527,7 @@ class Union
                 $this->typed_class_strings = [];
             }
 
-            unset($this->types['class-string']);
-            unset($this->types['trait-string']);
+            unset($this->types['class-string'], $this->types['trait-string']);
         } elseif ($type_string === 'int' && $this->literal_int_types) {
             foreach ($this->literal_int_types as $literal_key => $_) {
                 unset($this->types[$literal_key]);
@@ -1050,7 +1048,8 @@ class Union
                         $this->had_template = true;
 
                         if ($input_type
-                            && ($atomic_type->as->isMixed()
+                            && (
+                                $atomic_type->as->isMixed()
                                 || !$codebase
                                 || TypeAnalyzer::isContainedBy(
                                     $codebase,
@@ -1085,7 +1084,7 @@ class Union
 
                             $generic_params[$key][$atomic_type->defining_class ?: ''] = [
                                 $generic_param,
-                                $depth
+                                $depth,
                             ];
                         }
                     } elseif ($add_upper_bound && $input_type) {
@@ -1150,12 +1149,12 @@ class Union
 
                             $generic_params[$atomic_type->param_name][$atomic_type->defining_class ?: ''] = [
                                 $generic_param,
-                                $depth
+                                $depth,
                             ];
                         } elseif ($was_single) {
                             $generic_params[$atomic_type->param_name][$atomic_type->defining_class ?: ''] = [
                                 Type::getMixed(),
-                                $depth
+                                $depth,
                             ];
                         }
                     }
@@ -1393,10 +1392,8 @@ class Union
                                         if (isset($param_map[$key])
                                             && isset($template_types[(string) $param_map[$key]][$template_class])
                                         ) {
-                                            $template_type = clone $template_types
-                                                [(string) $param_map[$key]]
-                                                [$template_class]
-                                                [0];
+                                            $template_type
+                                                = clone $template_types[(string) $param_map[$key]][$template_class][0];
                                         }
                                     }
                                 }
@@ -1453,7 +1450,6 @@ class Union
                     $offset_template_type
                         = $template_types[$atomic_type->offset_param_name][''][0];
 
-
                     if ($array_template_type->isSingle()
                         && $offset_template_type->isSingle()
                         && !$array_template_type->isMixed()
@@ -1606,13 +1602,14 @@ class Union
     }
 
     /**
-     * @return TLiteralString the only string literal represented by this union type
      * @throws \InvalidArgumentException if isSingleStringLiteral is false
+     *
+     * @return TLiteralString the only string literal represented by this union type
      */
     public function getSingleStringLiteral()
     {
         if (count($this->types) !== 1 || count($this->literal_string_types) !== 1) {
-            throw new \InvalidArgumentException("Not a string literal");
+            throw new \InvalidArgumentException('Not a string literal');
         }
 
         return reset($this->literal_string_types);
@@ -1647,13 +1644,14 @@ class Union
     }
 
     /**
-     * @return TLiteralInt the only int literal represented by this union type
      * @throws \InvalidArgumentException if isSingleIntLiteral is false
+     *
+     * @return TLiteralInt the only int literal represented by this union type
      */
     public function getSingleIntLiteral()
     {
         if (count($this->types) !== 1 || count($this->literal_int_types) !== 1) {
-            throw new \InvalidArgumentException("Not an int literal");
+            throw new \InvalidArgumentException('Not an int literal');
         }
 
         return reset($this->literal_int_types);
@@ -1713,9 +1711,8 @@ class Union
 
         if (!$all_good) {
             return false;
-        } else {
-            $this->checked = true;
         }
+        $this->checked = true;
     }
 
     /**
diff --git a/src/command_functions.php b/src/command_functions.php
index 2582341a5..a6588071b 100644
--- a/src/command_functions.php
+++ b/src/command_functions.php
@@ -75,6 +75,7 @@ function requireAutoloaders($current_dir, $has_explicit_root, $vendor_dir)
         /**
          * @psalm-suppress UnresolvableInclude
          * @psalm-suppress MixedAssignment
+         *
          * @var mixed
          */
         $autoloader = require_once $file;
diff --git a/src/psalm-language-server.php b/src/psalm-language-server.php
index d761dccaf..f218d6707 100644
--- a/src/psalm-language-server.php
+++ b/src/psalm-language-server.php
@@ -1,8 +1,8 @@
 <?php
 require_once('command_functions.php');
 
-use Psalm\Internal\Analyzer\ProjectAnalyzer;
 use Psalm\Config;
+use Psalm\Internal\Analyzer\ProjectAnalyzer;
 
 gc_disable();
 
@@ -32,7 +32,7 @@ $valid_long_options = [
 
 $args = array_slice($argv, 1);
 
-$psalm_proxy = array_search('--language-server', $args);
+$psalm_proxy = array_search('--language-server', $args, true);
 
 if ($psalm_proxy !== false) {
     unset($args[$psalm_proxy]);
@@ -48,14 +48,14 @@ array_map(
         if (substr($arg, 0, 2) === '--' && $arg !== '--') {
             $arg_name = preg_replace('/=.*$/', '', substr($arg, 2));
 
-            if (!in_array($arg_name, $valid_long_options)
-                && !in_array($arg_name . ':', $valid_long_options)
-                && !in_array($arg_name . '::', $valid_long_options)
+            if (!in_array($arg_name, $valid_long_options, true)
+                && !in_array($arg_name . ':', $valid_long_options, true)
+                && !in_array($arg_name . '::', $valid_long_options, true)
             ) {
                 fwrite(
                     STDERR,
                     'Unrecognised argument "--' . $arg_name . '"' . PHP_EOL
-                    . 'Type --help to see a list of supported arguments'. PHP_EOL
+                    . 'Type --help to see a list of supported arguments' . PHP_EOL
                 );
                 error_log('Bad argument');
                 exit(1);
@@ -63,11 +63,13 @@ array_map(
         } elseif (substr($arg, 0, 2) === '-' && $arg !== '-' && $arg !== '--') {
             $arg_name = preg_replace('/=.*$/', '', substr($arg, 1));
 
-            if (!in_array($arg_name, $valid_short_options) && !in_array($arg_name . ':', $valid_short_options)) {
+            if (!in_array($arg_name, $valid_short_options, true)
+                && !in_array($arg_name . ':', $valid_short_options, true)
+            ) {
                 fwrite(
                     STDERR,
                     'Unrecognised argument "-' . $arg_name . '"' . PHP_EOL
-                    . 'Type --help to see a list of supported arguments'. PHP_EOL
+                    . 'Type --help to see a list of supported arguments' . PHP_EOL
                 );
                 error_log('Bad argument');
                 exit(1);
diff --git a/src/psalm_plugin.php b/src/psalm_plugin.php
index 62545bb7e..fb49412b3 100644
--- a/src/psalm_plugin.php
+++ b/src/psalm_plugin.php
@@ -1,18 +1,17 @@
 <?php
 require_once __DIR__ . '/command_functions.php';
+use PackageVersions\Versions;
 use Psalm\Internal\PluginManager\Command\DisableCommand;
 use Psalm\Internal\PluginManager\Command\EnableCommand;
 use Psalm\Internal\PluginManager\Command\ShowCommand;
 use Psalm\Internal\PluginManager\PluginListFactory;
 use Symfony\Component\Console\Application;
 use Symfony\Component\Console\Input\InputOption;
-use PackageVersions\Versions;
 
 $current_dir = (string)getcwd() . DIRECTORY_SEPARATOR;
 $vendor_dir = getVendorDir($current_dir);
 requireAutoloaders($current_dir, false, $vendor_dir);
 
-
 $app = new Application('psalm-plugin', Versions::getVersion('vimeo/psalm'));
 
 $psalm_root = dirname(__DIR__) . DIRECTORY_SEPARATOR;
diff --git a/tests/AnnotationTest.php b/tests/AnnotationTest.php
index 867d8b774..2e29e3d51 100644
--- a/tests/AnnotationTest.php
+++ b/tests/AnnotationTest.php
@@ -1,9 +1,9 @@
 <?php
 namespace Psalm\Tests;
 
+use const DIRECTORY_SEPARATOR;
 use Psalm\Config;
 use Psalm\Context;
-use const DIRECTORY_SEPARATOR;
 
 class AnnotationTest extends TestCase
 {
@@ -991,7 +991,7 @@ class AnnotationTest extends TestCase
                     $b = (new Bar)->doFoo();',
                 [
                     '$b' => 'array<array-key, int>',
-                ]
+                ],
             ],
             'noExceptionOnIntersection' => [
                 '<?php
@@ -1013,7 +1013,7 @@ class AnnotationTest extends TestCase
                     function f(A $a) : void {
                         $a->foo();
                         $a->bar();
-                    }'
+                    }',
             ],
             'allowClosingComma' => [
                 '<?php
@@ -1037,7 +1037,7 @@ class AnnotationTest extends TestCase
                      *    baz:string,
                      * } $foo
                      */
-                    $foo = ["foo" => "", "bar" => "", "baz" => ""];'
+                    $foo = ["foo" => "", "bar" => "", "baz" => ""];',
             ],
             'inheritedSelfAnnotation' => [
                 '<?php
@@ -1591,7 +1591,7 @@ class AnnotationTest extends TestCase
                      * @param    *   $reference
                      */
                     function f($reference) {}',
-                'error_message' => 'MissingDocblockType'
+                'error_message' => 'MissingDocblockType',
             ],
         ];
     }
diff --git a/tests/ArrayAccessTest.php b/tests/ArrayAccessTest.php
index 9c90557c0..c076ce7bb 100644
--- a/tests/ArrayAccessTest.php
+++ b/tests/ArrayAccessTest.php
@@ -437,7 +437,7 @@ class ArrayAccessTest extends TestCase
                     $array = new C([]);
                     $array["key"] = [];
                     /** @psalm-suppress PossiblyInvalidArrayAssignment */
-                    $array["key"][] = "testing";'
+                    $array["key"][] = "testing";',
             ],
             'singleLetterOffset' => [
                 '<?php
@@ -460,7 +460,7 @@ class ArrayAccessTest extends TestCase
                         }
                     }',
                 [],
-                ['MixedReturnStatement', 'MixedInferredReturnType']
+                ['MixedReturnStatement', 'MixedInferredReturnType'],
             ],
             'assertSelfClassConstantOffsetsInFunction' => [
                 '<?php
@@ -481,7 +481,7 @@ class ArrayAccessTest extends TestCase
                         }
                     }',
                 [],
-                ['MixedReturnStatement', 'MixedInferredReturnType']
+                ['MixedReturnStatement', 'MixedInferredReturnType'],
             ],
             'assertNamedClassConstantOffsetsInFunction' => [
                 '<?php
@@ -502,7 +502,7 @@ class ArrayAccessTest extends TestCase
                         return C::ARR[$key]["foo"];
                     }',
                 [],
-                ['MixedReturnStatement', 'MixedInferredReturnType']
+                ['MixedReturnStatement', 'MixedInferredReturnType'],
             ],
             'arrayAccessAfterByRefArrayOffsetAssignment' => [
                 '<?php
diff --git a/tests/AssertTest.php b/tests/AssertTest.php
index 2a5b38092..3ef15a8c1 100644
--- a/tests/AssertTest.php
+++ b/tests/AssertTest.php
@@ -403,7 +403,7 @@ class AssertTest extends TestCase
                     $f->bat();',
                 [
                     '$f' => 'Foo',
-                ]
+                ],
             ],
             'dontBleedBadAssertVarIntoContext' => [
                 '<?php
diff --git a/tests/BadFormatTest.php b/tests/BadFormatTest.php
index 0e455182b..e2c6a4577 100644
--- a/tests/BadFormatTest.php
+++ b/tests/BadFormatTest.php
@@ -6,7 +6,6 @@ use Psalm\Context;
 class BadFormatTest extends TestCase
 {
     /**
-     *
      * @return void
      */
     public function testMissingSemicolon()
@@ -31,7 +30,6 @@ class BadFormatTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testClassMethodWithNoStmts()
@@ -50,7 +48,6 @@ class BadFormatTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testInterfaceWithProperties()
@@ -69,7 +66,6 @@ class BadFormatTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testTypingReturnType()
@@ -92,7 +88,6 @@ class BadFormatTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testOverriddenUse()
diff --git a/tests/CallableTest.php b/tests/CallableTest.php
index a7f95bbf8..d64f582ee 100644
--- a/tests/CallableTest.php
+++ b/tests/CallableTest.php
@@ -894,7 +894,7 @@ class CallableTest extends TestCase
                         function () : B {
                             return new B();
                         }
-                    );'
+                    );',
             ],
             'allowCallableWithWiderParam' => [
                 '<?php
@@ -911,7 +911,7 @@ class CallableTest extends TestCase
                         function (A $a) : A {
                             return $a;
                         }
-                    );'
+                    );',
             ],
             'allowCallableWithOptionalArg' => [
                 '<?php
@@ -925,7 +925,7 @@ class CallableTest extends TestCase
                         function (int $x = 5) : int {
                             return $x;
                         }
-                    );'
+                    );',
             ],
         ];
     }
@@ -1430,7 +1430,7 @@ class CallableTest extends TestCase
                         return $x;
                       }
                     );',
-                'error_message' => 'InvalidArgument'
+                'error_message' => 'InvalidArgument',
             ],
         ];
     }
diff --git a/tests/ClassStringTest.php b/tests/ClassStringTest.php
index ce231084f..69c8fec47 100644
--- a/tests/ClassStringTest.php
+++ b/tests/ClassStringTest.php
@@ -10,7 +10,6 @@ class ClassStringTest extends TestCase
     use Traits\ValidCodeAnalysisTestTrait;
 
     /**
-     *
      * @return void
      */
     public function testDontAllowStringStandInForNewClass()
@@ -33,7 +32,6 @@ class ClassStringTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testDontAllowStringStandInForStaticMethodCall()
@@ -578,7 +576,7 @@ class ClassStringTest extends TestCase
                                 \Doesnt\Really::something();
                             }
                         }
-                    }'
+                    }',
             ],
             'allowClassExistsCheckOnString' => [
                 '<?php
@@ -589,7 +587,7 @@ class ClassStringTest extends TestCase
                                 \Doesnt\Really::something();
                             }
                         }
-                    }'
+                    }',
             ],
             'allowComparisonToStaticClassString' => [
                 '<?php
@@ -601,7 +599,7 @@ class ClassStringTest extends TestCase
                         }
                     }
 
-                    class B extends A {}'
+                    class B extends A {}',
             ],
             'noCrashWhenClassExists' => [
                 '<?php
@@ -609,7 +607,7 @@ class ClassStringTest extends TestCase
 
                     if (class_exists(A::class)) {
                         new \RuntimeException();
-                    }'
+                    }',
             ],
 
             'noCrashWhenClassExistsNegated' => [
@@ -618,7 +616,7 @@ class ClassStringTest extends TestCase
 
                     if (!class_exists(A::class)) {
                         new \RuntimeException();
-                    }'
+                    }',
             ],
         ];
     }
diff --git a/tests/ClassTest.php b/tests/ClassTest.php
index 97c64174e..d3edca79a 100644
--- a/tests/ClassTest.php
+++ b/tests/ClassTest.php
@@ -391,7 +391,7 @@ class ClassTest extends TestCase
                 '<?php
                     function foo(string $s) : void {
                         if (class_exists($s) || interface_exists($s)) {}
-                    }'
+                    }',
             ],
             'classExistsWithFalseArg' => [
                 '<?php
@@ -405,7 +405,7 @@ class ClassTest extends TestCase
                         }
 
                         return $class;
-                    }'
+                    }',
             ],
             'classExistsWithFalseArgInside' => [
                 '<?php
@@ -414,7 +414,7 @@ class ClassTest extends TestCase
                             /** @psalm-suppress MixedMethodCall */
                             new $s();
                         }
-                    }'
+                    }',
             ],
             'classAliasOnNonexistantClass' => [
                 '<?php
@@ -427,7 +427,7 @@ class ClassTest extends TestCase
 
                     }',
                 [],
-                ['PropertyNotSetInConstructor']
+                ['PropertyNotSetInConstructor'],
             ],
         ];
     }
diff --git a/tests/CodebaseTest.php b/tests/CodebaseTest.php
index a7da5c0a3..554d9891b 100644
--- a/tests/CodebaseTest.php
+++ b/tests/CodebaseTest.php
@@ -1,6 +1,8 @@
 <?php
 namespace Psalm\Tests;
 
+use function array_values;
+use function get_class;
 use PhpParser\Node\Stmt\ClassLike;
 use Psalm\Codebase;
 use Psalm\Context;
@@ -11,8 +13,6 @@ use Psalm\PluginRegistrationSocket;
 use Psalm\Storage\ClassLikeStorage;
 use Psalm\Tests\Internal\Provider\ClassLikeStorageInstanceCacheProvider;
 use Psalm\Type;
-use function array_values;
-use function get_class;
 
 class CodebaseTest extends TestCase
 {
diff --git a/tests/ComposerLockTest.php b/tests/ComposerLockTest.php
index 633e10661..c7c925062 100644
--- a/tests/ComposerLockTest.php
+++ b/tests/ComposerLockTest.php
@@ -1,8 +1,8 @@
 <?php
 namespace Psalm\Tests;
 
-use Psalm\Internal\PluginManager\ComposerLock;
 use function json_encode;
+use Psalm\Internal\PluginManager\ComposerLock;
 
 /** @group PluginManager */
 class ComposerLockTest extends TestCase
@@ -38,7 +38,7 @@ class ComposerLockTest extends TestCase
     {
         $lock = new ComposerLock([$this->jsonFile((object)[
             'packages' => [
-                (object)$this->pluginEntry('vendor/package', 'Vendor\Package\PluginClass')
+                (object)$this->pluginEntry('vendor/package', 'Vendor\Package\PluginClass'),
             ],
             'packages-dev' => [],
         ])]);
@@ -57,7 +57,7 @@ class ComposerLockTest extends TestCase
         $lock = new ComposerLock([$this->jsonFile((object)[
             'packages' => [],
             'packages-dev' => [
-                (object) $this->pluginEntry('vendor/package', 'Vendor\Package\PluginClass')
+                (object) $this->pluginEntry('vendor/package', 'Vendor\Package\PluginClass'),
             ],
         ])]);
 
@@ -142,23 +142,23 @@ class ComposerLockTest extends TestCase
         $lock = new ComposerLock([
             $this->jsonFile([
                 'packages' => [
-                    (object) $this->pluginEntry('vendor/packageA', 'Vendor\PackageA\PluginClass')
+                    (object) $this->pluginEntry('vendor/packageA', 'Vendor\PackageA\PluginClass'),
                 ],
                 'packages-dev' => [
-                    (object) $this->pluginEntry('vendor/packageB', 'Vendor\PackageB\PluginClass')
+                    (object) $this->pluginEntry('vendor/packageB', 'Vendor\PackageB\PluginClass'),
                 ],
             ]),
             $this->jsonFile([
                 'packages' => [
-                    (object) $this->pluginEntry('vendor/packageC', 'Vendor\PackageC\PluginClass')
+                    (object) $this->pluginEntry('vendor/packageC', 'Vendor\PackageC\PluginClass'),
                 ],
                 'packages-dev' => [
-                    (object) $this->pluginEntry('vendor/packageD', 'Vendor\PackageD\PluginClass')
+                    (object) $this->pluginEntry('vendor/packageD', 'Vendor\PackageD\PluginClass'),
                 ],
             ]),
         ]);
 
-        $this->assertEquals(
+        $this->assertSame(
             [
                 'vendor/packageA' => 'Vendor\PackageA\PluginClass',
                 'vendor/packageB' => 'Vendor\PackageB\PluginClass',
diff --git a/tests/Config/ConfigFileTest.php b/tests/Config/ConfigFileTest.php
index c0b95eec3..b1611a033 100644
--- a/tests/Config/ConfigFileTest.php
+++ b/tests/Config/ConfigFileTest.php
@@ -1,16 +1,16 @@
 <?php
 namespace Psalm\Tests\Config;
 
+use function file_get_contents;
+use function file_put_contents;
+use function getcwd;
+use const PHP_EOL;
 use Psalm\Config;
 use Psalm\Internal\PluginManager\ConfigFile;
-use function tempnam;
 use function sys_get_temp_dir;
-use function unlink;
-use function file_put_contents;
+use function tempnam;
 use function trim;
-use function getcwd;
-use const PHP_EOL;
-use function file_get_contents;
+use function unlink;
 
 /** @group PluginManager */
 class ConfigFileTest extends \Psalm\Tests\TestCase
diff --git a/tests/Config/ConfigTest.php b/tests/Config/ConfigTest.php
index d345036c1..8de9329aa 100644
--- a/tests/Config/ConfigTest.php
+++ b/tests/Config/ConfigTest.php
@@ -1,24 +1,24 @@
 <?php
 namespace Psalm\Tests\Config;
 
+use function array_map;
+use function define;
+use function defined;
+use const DIRECTORY_SEPARATOR;
+use function dirname;
+use function error_get_last;
+use function getcwd;
+use function implode;
+use function is_array;
+use function preg_match;
 use Psalm\Config;
 use Psalm\Context;
 use Psalm\Internal\Analyzer\FileAnalyzer;
 use Psalm\Tests\Internal\Provider;
 use Psalm\Tests\TestConfig;
-use function defined;
-use function define;
-use function getcwd;
 use function realpath;
-use function dirname;
-use function unlink;
-use function error_get_last;
-use function is_array;
 use function symlink;
-use function preg_match;
-use function implode;
-use function array_map;
-use const DIRECTORY_SEPARATOR;
+use function unlink;
 
 class ConfigTest extends \Psalm\Tests\TestCase
 {
@@ -496,8 +496,7 @@ class ConfigTest extends \Psalm\Tests\TestCase
             )
         );
 
-        $this->assertSame(
-            null,
+        $this->assertNull(
             $config->getReportingLevelForClass(
                 'UndefinedClass',
                 'Psalm\Bodger'
@@ -528,16 +527,14 @@ class ConfigTest extends \Psalm\Tests\TestCase
             )
         );
 
-        $this->assertSame(
-            null,
+        $this->assertNull(
             $config->getReportingLevelForProperty(
                 'UndefinedMethod',
                 'Psalm\Bodger::$find3'
             )
         );
 
-        $this->assertSame(
-            null,
+        $this->assertNull(
             $config->getReportingLevelForProperty(
                 'UndefinedMethod',
                 'Psalm\Bodger::$find4'
@@ -599,7 +596,6 @@ class ConfigTest extends \Psalm\Tests\TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testImpossibleIssue()
@@ -624,7 +620,6 @@ class ConfigTest extends \Psalm\Tests\TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testRequireVoidReturnTypeExists()
@@ -862,7 +857,6 @@ class ConfigTest extends \Psalm\Tests\TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testForbiddenEchoFunctionViaFunctions()
@@ -893,7 +887,6 @@ class ConfigTest extends \Psalm\Tests\TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testForbiddenEchoFunctionViaFlag()
@@ -945,7 +938,6 @@ class ConfigTest extends \Psalm\Tests\TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testForbiddenVarExportFunction()
@@ -977,7 +969,6 @@ class ConfigTest extends \Psalm\Tests\TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testValidThrowInvalidCatch()
@@ -1029,7 +1020,6 @@ class ConfigTest extends \Psalm\Tests\TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testInvalidThrowValidCatch()
@@ -1351,7 +1341,7 @@ class ConfigTest extends \Psalm\Tests\TestCase
                 dirname(__DIR__, 2)
                     . DIRECTORY_SEPARATOR . 'vendor' . DIRECTORY_SEPARATOR . 'composer' . DIRECTORY_SEPARATOR
                     . '..' . DIRECTORY_SEPARATOR . '..' . DIRECTORY_SEPARATOR
-                    . 'src' . DIRECTORY_SEPARATOR . 'Psalm'
+                    . 'src' . DIRECTORY_SEPARATOR . 'Psalm',
             ]
         );
 
@@ -1361,7 +1351,7 @@ class ConfigTest extends \Psalm\Tests\TestCase
                 dirname(__DIR__, 2)
                     . DIRECTORY_SEPARATOR . 'vendor' . DIRECTORY_SEPARATOR . 'composer' . DIRECTORY_SEPARATOR
                     . '..' . DIRECTORY_SEPARATOR . '..' . DIRECTORY_SEPARATOR
-                    . 'tests'
+                    . 'tests',
             ]
         );
 
@@ -1369,12 +1359,12 @@ class ConfigTest extends \Psalm\Tests\TestCase
 
         $this->assertSame(
             dirname(__DIR__, 2) . DIRECTORY_SEPARATOR . 'src' . DIRECTORY_SEPARATOR . 'Psalm' . DIRECTORY_SEPARATOR . 'Foo.php',
-            $config->getPotentialComposerFilePathForClassLike("Psalm\\Foo")
+            $config->getPotentialComposerFilePathForClassLike('Psalm\\Foo')
         );
 
         $this->assertSame(
             dirname(__DIR__, 2) . DIRECTORY_SEPARATOR . 'tests' . DIRECTORY_SEPARATOR . 'Foo.php',
-            $config->getPotentialComposerFilePathForClassLike("Psalm\\Tests\\Foo")
+            $config->getPotentialComposerFilePathForClassLike('Psalm\\Tests\\Foo')
         );
     }
 }
diff --git a/tests/Config/CreatorTest.php b/tests/Config/CreatorTest.php
index d9712c5f6..5a73a4929 100644
--- a/tests/Config/CreatorTest.php
+++ b/tests/Config/CreatorTest.php
@@ -1,9 +1,9 @@
 <?php
 namespace Psalm\Tests\Config;
 
-use Psalm\Config\Creator;
-use function dirname;
 use const DIRECTORY_SEPARATOR;
+use function dirname;
+use Psalm\Config\Creator;
 
 class CreatorTest extends \Psalm\Tests\TestCase
 {
diff --git a/tests/Config/Plugin/Hook/StringProvider/TSqlSelectString.php b/tests/Config/Plugin/Hook/StringProvider/TSqlSelectString.php
index 3523cd072..fa6ebdc3d 100644
--- a/tests/Config/Plugin/Hook/StringProvider/TSqlSelectString.php
+++ b/tests/Config/Plugin/Hook/StringProvider/TSqlSelectString.php
@@ -1,5 +1,4 @@
 <?php
-
 namespace Psalm\Test\Config\Plugin\Hook\StringProvider;
 
 class TSqlSelectString extends \Psalm\Type\Atomic\TLiteralString
@@ -11,6 +10,7 @@ class TSqlSelectString extends \Psalm\Type\Atomic\TLiteralString
     {
         return 'sql-select-string';
     }
+
     /**
      * @return string
      */
@@ -18,6 +18,7 @@ class TSqlSelectString extends \Psalm\Type\Atomic\TLiteralString
     {
         return 'sql-select-string(' . $this->value . ')';
     }
+
     /**
      * @return bool
      */
diff --git a/tests/Config/PluginTest.php b/tests/Config/PluginTest.php
index 305a1db77..304f10b39 100644
--- a/tests/Config/PluginTest.php
+++ b/tests/Config/PluginTest.php
@@ -1,22 +1,21 @@
 <?php
 namespace Psalm\Tests\Config;
 
+use function define;
+use function defined;
+use const DIRECTORY_SEPARATOR;
+use function dirname;
+use function get_class;
+use function getcwd;
+use function microtime;
 use Psalm\Codebase;
 use Psalm\Config;
 use Psalm\Context;
 use Psalm\Internal\Analyzer\FileAnalyzer;
-use Psalm\Internal\Analyzer\ProjectAnalyzer;
 use Psalm\Plugin\Hook\AfterCodebasePopulatedInterface;
 use Psalm\PluginRegistrationSocket;
 use Psalm\Tests\Internal\Provider;
 use Psalm\Tests\TestConfig;
-use function defined;
-use function define;
-use function dirname;
-use const DIRECTORY_SEPARATOR;
-use function getcwd;
-use function get_class;
-use function microtime;
 use function sprintf;
 
 class PluginTest extends \Psalm\Tests\TestCase
@@ -70,7 +69,6 @@ class PluginTest extends \Psalm\Tests\TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testStringAnalyzerPlugin()
@@ -106,7 +104,6 @@ class PluginTest extends \Psalm\Tests\TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testStringAnalyzerPluginWithClassConstant()
@@ -146,7 +143,6 @@ class PluginTest extends \Psalm\Tests\TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testStringAnalyzerPluginWithClassConstantConcat()
@@ -218,7 +214,6 @@ class PluginTest extends \Psalm\Tests\TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testEchoAnalyzerPluginWithUnescapedConcatenatedString()
@@ -258,7 +253,6 @@ class PluginTest extends \Psalm\Tests\TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testEchoAnalyzerPluginWithUnescapedString()
@@ -347,7 +341,6 @@ class PluginTest extends \Psalm\Tests\TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testFloatCheckerPlugin()
@@ -669,7 +662,6 @@ class PluginTest extends \Psalm\Tests\TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testPropertyProviderHooksInvalidAssignment()
@@ -712,7 +704,6 @@ class PluginTest extends \Psalm\Tests\TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testMethodProviderHooksInvalidArg()
@@ -755,7 +746,6 @@ class PluginTest extends \Psalm\Tests\TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testFunctionProviderHooksInvalidArg()
@@ -842,7 +832,7 @@ class PluginTest extends \Psalm\Tests\TestCase
                             <plugin filename="%s/examples/plugins/StringChecker.php" />
                         </plugins>
                     </psalm>',
-                    __DIR__.'/../..'
+                    __DIR__ . '/../..'
                 )
             )
         );
@@ -868,7 +858,7 @@ class PluginTest extends \Psalm\Tests\TestCase
                             <plugin filename="%s/does-not-exist/plugins/StringChecker.php" />
                         </plugins>
                     </psalm>',
-                    __DIR__.'/..'
+                    __DIR__ . '/..'
                 )
             )
         );
diff --git a/tests/DeprecatedAnnotationTest.php b/tests/DeprecatedAnnotationTest.php
index 1122ce7fe..c03da9635 100644
--- a/tests/DeprecatedAnnotationTest.php
+++ b/tests/DeprecatedAnnotationTest.php
@@ -134,7 +134,7 @@ class DeprecatedAnnotationTest extends TestCase
 
                     echo Foo::class;',
                 'error_message' => 'DeprecatedClass',
-            ]
+            ],
         ];
     }
 }
diff --git a/tests/DocumentationTest.php b/tests/DocumentationTest.php
index f76ca781c..db21027db 100644
--- a/tests/DocumentationTest.php
+++ b/tests/DocumentationTest.php
@@ -1,23 +1,23 @@
 <?php
 namespace Psalm\Tests;
 
+use function array_keys;
+use function count;
+use const DIRECTORY_SEPARATOR;
+use function dirname;
+use function explode;
+use function file_exists;
+use function file_get_contents;
+use function implode;
+use function preg_quote;
 use Psalm\Config;
 use Psalm\Context;
 use Psalm\Internal\Analyzer\FileAnalyzer;
 use Psalm\Tests\Internal\Provider;
-use function dirname;
-use const DIRECTORY_SEPARATOR;
-use function file_exists;
-use function file_get_contents;
-use function explode;
-use function count;
-use function substr;
-use function trim;
 use function sort;
-use function array_keys;
-use function implode;
 use function strpos;
-use function preg_quote;
+use function substr;
+use function trim;
 
 class DocumentationTest extends TestCase
 {
diff --git a/tests/EndToEnd/PsalmEndToEndTest.php b/tests/EndToEnd/PsalmEndToEndTest.php
index 7f6d8d724..976b7f8af 100644
--- a/tests/EndToEnd/PsalmEndToEndTest.php
+++ b/tests/EndToEnd/PsalmEndToEndTest.php
@@ -1,24 +1,22 @@
 <?php
-
-
 namespace Psalm\Tests\EndToEnd;
 
-use PHPUnit\Framework\TestCase;
+use function array_merge;
 
-use Symfony\Component\Process\Process;
-use function tempnam;
-use function sys_get_temp_dir;
-use function unlink;
-use function mkdir;
+use function closedir;
+use function copy;
 use function getcwd;
+use function is_dir;
 use function is_string;
-use function copy;
-use function array_merge;
+use function mkdir;
 use function opendir;
+use PHPUnit\Framework\TestCase;
 use function readdir;
-use function is_dir;
-use function closedir;
 use function rmdir;
+use Symfony\Component\Process\Process;
+use function sys_get_temp_dir;
+use function tempnam;
+use function unlink;
 
 /**
  * Tests some of the most important use cases of the psalm and psalter commands, by launching a new
@@ -44,7 +42,7 @@ class PsalmEndToEndTest extends TestCase
         mkdir(self::$tmpDir);
 
         $getcwd = getcwd();
-        if (! is_string($getcwd)) {
+        if (!is_string($getcwd)) {
             throw new \Exception('Couldn\'t get working directory');
         }
 
@@ -115,13 +113,14 @@ class PsalmEndToEndTest extends TestCase
 
     /**
      * @param array<string> $args
+     *
      * @return array{STDOUT: string, STDERR: string, CODE: int|null}
      */
     private function runPsalm(array $args, bool $shouldFail = false): array
     {
         $process = new Process(array_merge([$this->psalm], $args), self::$tmpDir);
 
-        if (! $shouldFail) {
+        if (!$shouldFail) {
             $process->mustRun();
         } else {
             $process->run();
@@ -131,7 +130,7 @@ class PsalmEndToEndTest extends TestCase
         return [
             'STDOUT' => $process->getOutput(),
             'STDERR' => $process->getErrorOutput(),
-            'CODE' => $process->getExitCode()
+            'CODE' => $process->getExitCode(),
         ];
     }
 
@@ -141,8 +140,8 @@ class PsalmEndToEndTest extends TestCase
     private static function recursiveRemoveDirectory(string $src): void
     {
         $dir = opendir($src);
-        while (false !== ( $file = readdir($dir))) {
-            if (( $file != '.' ) && ( $file != '..' )) {
+        while (false !== ($file = readdir($dir))) {
+            if (($file != '.') && ($file != '..')) {
                 $full = $src . '/' . $file;
                 if (is_dir($full)) {
                     self::recursiveRemoveDirectory($full);
diff --git a/tests/ErrorBaselineTest.php b/tests/ErrorBaselineTest.php
index 5ef542501..656439971 100644
--- a/tests/ErrorBaselineTest.php
+++ b/tests/ErrorBaselineTest.php
@@ -1,12 +1,12 @@
 <?php
 namespace Psalm\Tests;
 
+use const LIBXML_NOBLANKS;
 use Prophecy\Argument;
 use Prophecy\Prophecy\ObjectProphecy;
 use Psalm\ErrorBaseline;
 use Psalm\Exception\ConfigException;
 use Psalm\Internal\Provider\FileProvider;
-use const LIBXML_NOBLANKS;
 
 class ErrorBaselineTest extends TestCase
 {
diff --git a/tests/FileDiffTest.php b/tests/FileDiffTest.php
index e5c3eb0e7..46bb64323 100644
--- a/tests/FileDiffTest.php
+++ b/tests/FileDiffTest.php
@@ -1,11 +1,11 @@
 <?php
 namespace Psalm\Tests;
 
-use PhpParser;
-use function strpos;
-use function count;
 use function array_map;
+use function count;
 use function get_class;
+use PhpParser;
+use function strpos;
 use function var_export;
 
 class FileDiffTest extends TestCase
diff --git a/tests/FileManipulation/ClassConstantMoveTest.php b/tests/FileManipulation/ClassConstantMoveTest.php
index da125d571..8966faefd 100644
--- a/tests/FileManipulation/ClassConstantMoveTest.php
+++ b/tests/FileManipulation/ClassConstantMoveTest.php
@@ -115,7 +115,7 @@ class ClassConstantMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Ns\A::FOO' => 'Ns\B::FOO_BAR',
-                ]
+                ],
             ],
             'renameSimpleClassConstant' => [
                 '<?php
@@ -150,7 +150,7 @@ class ClassConstantMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Ns\A::FOO' => 'Ns\A::FOO_BAR',
-                ]
+                ],
             ],
         ];
     }
diff --git a/tests/FileManipulation/ClassMoveTest.php b/tests/FileManipulation/ClassMoveTest.php
index ca6dfb87b..8cad4e57f 100644
--- a/tests/FileManipulation/ClassMoveTest.php
+++ b/tests/FileManipulation/ClassMoveTest.php
@@ -133,7 +133,7 @@ class ClassMoveTest extends \Psalm\Tests\TestCase
                     if ($i instanceof B) {}',
                 [
                     'Ns\A' => 'Ns\B',
-                ]
+                ],
             ],
             'renameEmptyClassWithSpacesInDocblock' => [
                 '<?php
@@ -166,7 +166,7 @@ class ClassMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Ns\A' => 'Ns\B',
-                ]
+                ],
             ],
             'renameClassWithInstanceMethod' => [
                 '<?php
@@ -199,7 +199,7 @@ class ClassMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Ns\A' => 'Ns\B',
-                ]
+                ],
             ],
             'renameClassWithStaticMethod' => [
                 '<?php
@@ -236,7 +236,7 @@ class ClassMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Ns\A' => 'Ns\B',
-                ]
+                ],
             ],
             'renameClassWithInstanceProperty' => [
                 '<?php
@@ -269,7 +269,7 @@ class ClassMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Ns\A' => 'Ns\B',
-                ]
+                ],
             ],
             'renameClassWithStaticProperty' => [
                 '<?php
@@ -298,7 +298,7 @@ class ClassMoveTest extends \Psalm\Tests\TestCase
                     B::$one = "two";',
                 [
                     'Ns\A' => 'Ns\B',
-                ]
+                ],
             ],
             'moveClassIntoNamespace' => [
                 '<?php
@@ -367,7 +367,7 @@ class ClassMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'A' => 'Foo\Bar\Baz\B',
-                ]
+                ],
             ],
             'moveClassDeeperIntoNamespaceAdjustUseWithoutAlias' => [
                 '<?php
@@ -420,7 +420,7 @@ class ClassMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Bar\Bat' => 'Bar\Baz\Bahh',
-                ]
+                ],
             ],
             'moveClassesIntoNamespace' => [
                 '<?php
@@ -498,7 +498,7 @@ class ClassMoveTest extends \Psalm\Tests\TestCase
                 [
                     'Foo\A' => 'Bar\Baz\A',
                     'Foo\B' => 'Bar\Baz\B',
-                ]
+                ],
             ],
             'moveClassDeeperIntoNamespaceAdjustUseWithAlias' => [
                 '<?php
@@ -551,7 +551,7 @@ class ClassMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Bar\Bat' => 'Bar\Baz\Bahh',
-                ]
+                ],
             ],
             'moveClassDeeperIntoNamespaceDontAdjustGroupUse' => [
                 '<?php
@@ -580,7 +580,7 @@ class ClassMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Bar\Bat' => 'Bar\Baz\Bahh',
-                ]
+                ],
             ],
         ];
     }
diff --git a/tests/FileManipulation/MethodMoveTest.php b/tests/FileManipulation/MethodMoveTest.php
index d81b9f380..cf3a214ea 100644
--- a/tests/FileManipulation/MethodMoveTest.php
+++ b/tests/FileManipulation/MethodMoveTest.php
@@ -129,7 +129,7 @@ class MethodMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Ns\A::Foo' => 'Ns\B::Fe',
-                ]
+                ],
             ],
             'moveSimpleStaticMethodWithConstant' => [
                 '<?php
@@ -164,7 +164,7 @@ class MethodMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Ns\A::Foo' => 'Ns\B::Fe',
-                ]
+                ],
             ],
             'moveSimpleStaticMethodWithProperty' => [
                 '<?php
@@ -207,7 +207,7 @@ class MethodMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Ns\A::Foo' => 'Ns\B::Fe',
-                ]
+                ],
             ],
             'moveStaticMethodIntoNamespaceWithExistingUse' => [
                 '<?php
@@ -258,7 +258,7 @@ class MethodMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'A::Foo' => 'Ns\A\B::Fedcba',
-                ]
+                ],
             ],
             'moveEmptyStaticMethodOnly' => [
                 '<?php
@@ -367,7 +367,7 @@ class MethodMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Ns\A::Foo' => 'Ns\B::Fedbca',
-                ]
+                ],
             ],
             'moveTwoStaticMethods' => [
                 '<?php
@@ -448,7 +448,7 @@ class MethodMoveTest extends \Psalm\Tests\TestCase
                 [
                     'Ns\A::Foo' => 'Ns\B::Fedbca',
                     'Ns\A::Bar' => 'Ns\B::Blacksheep',
-                ]
+                ],
             ],
             'moveInstanceMethodIntoSubclassOnly' => [
                 '<?php
@@ -526,7 +526,7 @@ class MethodMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Ns\A::Foo' => 'Ns\AChild::Fedbca',
-                ]
+                ],
             ],
             'moveStaticMethodAndReferencesFromAbove' => [
                 '<?php
@@ -571,7 +571,7 @@ class MethodMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Ns\A::Foo' => 'Ns\B::Fe',
-                ]
+                ],
             ],
             'moveStaticMethodAndReferencesFromBelow' => [
                 '<?php
@@ -665,7 +665,7 @@ class MethodMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Ns1\A::Foo' => 'Ns2\Ns3\B::Fe',
-                ]
+                ],
             ],
             'moveStaticMethodAndReferencesAcrossNamespacesWithExistingUse' => [
                 '<?php
@@ -718,7 +718,7 @@ class MethodMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Ns1\A::Foo' => 'Ns2\Ns3\B::Fedcba',
-                ]
+                ],
             ],
             'renameInstanceMethod' => [
                 '<?php
diff --git a/tests/FileManipulation/NamespaceMoveTest.php b/tests/FileManipulation/NamespaceMoveTest.php
index d1dfad81d..b9ea48d33 100644
--- a/tests/FileManipulation/NamespaceMoveTest.php
+++ b/tests/FileManipulation/NamespaceMoveTest.php
@@ -155,7 +155,7 @@ class NamespaceMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Foo\*' => 'Bar\Baz\*',
-                ]
+                ],
             ],
         ];
     }
diff --git a/tests/FileManipulation/ParamTypeManipulationTest.php b/tests/FileManipulation/ParamTypeManipulationTest.php
index cc37bc866..c6386fa1d 100644
--- a/tests/FileManipulation/ParamTypeManipulationTest.php
+++ b/tests/FileManipulation/ParamTypeManipulationTest.php
@@ -1,10 +1,6 @@
 <?php
 namespace Psalm\Tests\FileManipulation;
 
-use Psalm\Context;
-use Psalm\Internal\Analyzer\FileAnalyzer;
-use Psalm\Tests\Internal\Provider;
-
 class ParamTypeManipulationTest extends FileManipulationTest
 {
     /**
diff --git a/tests/FileManipulation/PropertyMoveTest.php b/tests/FileManipulation/PropertyMoveTest.php
index 3f5ca2a10..b4e187219 100644
--- a/tests/FileManipulation/PropertyMoveTest.php
+++ b/tests/FileManipulation/PropertyMoveTest.php
@@ -115,7 +115,7 @@ class PropertyMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Ns\A::$foo' => 'Ns\B::$fooBar',
-                ]
+                ],
             ],
             'renameInstanceProperty' => [
                 '<?php
@@ -144,7 +144,7 @@ class PropertyMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Ns\A::$foo' => 'Ns\A::$fooBar',
-                ]
+                ],
             ],
             'renameStaticProperty' => [
                 '<?php
@@ -173,7 +173,7 @@ class PropertyMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Ns\A::$foo' => 'Ns\A::$fooBar',
-                ]
+                ],
             ],
             'moveStaticProperty' => [
                 '<?php
@@ -212,7 +212,7 @@ class PropertyMoveTest extends \Psalm\Tests\TestCase
                     }',
                 [
                     'Ns\A::$foo' => 'Ns\B::$fooBar',
-                ]
+                ],
             ],
         ];
     }
diff --git a/tests/FileManipulation/ReturnTypeManipulationTest.php b/tests/FileManipulation/ReturnTypeManipulationTest.php
index addbaeaa4..ab6344e6e 100644
--- a/tests/FileManipulation/ReturnTypeManipulationTest.php
+++ b/tests/FileManipulation/ReturnTypeManipulationTest.php
@@ -1,10 +1,6 @@
 <?php
 namespace Psalm\Tests\FileManipulation;
 
-use Psalm\Context;
-use Psalm\Internal\Analyzer\FileAnalyzer;
-use Psalm\Tests\Internal\Provider;
-
 class ReturnTypeManipulationTest extends FileManipulationTest
 {
     /**
@@ -1292,7 +1288,7 @@ class ReturnTypeManipulationTest extends FileManipulationTest
                 '7.3',
                 ['InvalidReturnType'],
                 false,
-                false
+                false,
             ],
             'dontReplaceValidReturnTypeAllowBackwardsIncompatibility' => [
                 '<?php
@@ -1318,7 +1314,7 @@ class ReturnTypeManipulationTest extends FileManipulationTest
                 '7.3',
                 ['InvalidReturnType'],
                 false,
-                true
+                true,
             ],
         ];
     }
diff --git a/tests/FileManipulation/UndefinedVariableManipulationTest.php b/tests/FileManipulation/UndefinedVariableManipulationTest.php
index 2513e0538..1f9c0850f 100644
--- a/tests/FileManipulation/UndefinedVariableManipulationTest.php
+++ b/tests/FileManipulation/UndefinedVariableManipulationTest.php
@@ -1,9 +1,6 @@
 <?php
 namespace Psalm\Tests\FileManipulation;
 
-use Psalm\Context;
-use Psalm\Internal\Analyzer\FileAnalyzer;
-use Psalm\Tests\Internal\Provider;
 use const PHP_VERSION;
 
 class UndefinedVariableManipulationTest extends FileManipulationTest
diff --git a/tests/FileManipulation/UnusedCodeManipulationTest.php b/tests/FileManipulation/UnusedCodeManipulationTest.php
index 585348382..94eb32d35 100644
--- a/tests/FileManipulation/UnusedCodeManipulationTest.php
+++ b/tests/FileManipulation/UnusedCodeManipulationTest.php
@@ -1,10 +1,6 @@
 <?php
 namespace Psalm\Tests\FileManipulation;
 
-use Psalm\Context;
-use Psalm\Internal\Analyzer\FileAnalyzer;
-use Psalm\Tests\Internal\Provider;
-
 class UnusedCodeManipulationTest extends FileManipulationTest
 {
     /**
diff --git a/tests/FileReferenceTest.php b/tests/FileReferenceTest.php
index 984420af9..685396520 100644
--- a/tests/FileReferenceTest.php
+++ b/tests/FileReferenceTest.php
@@ -1,11 +1,11 @@
 <?php
 namespace Psalm\Tests;
 
+use function count;
 use Psalm\Context;
 use Psalm\Internal\Analyzer\FileAnalyzer;
 use Psalm\Tests\Internal\Provider;
 use function strpos;
-use function count;
 
 class FileReferenceTest extends TestCase
 {
@@ -282,7 +282,7 @@ class FileReferenceTest extends TestCase
                 ],
                 [],
                 [],
-                []
+                [],
             ],
             'constantRefs' => [
                 '<?php
@@ -313,7 +313,7 @@ class FileReferenceTest extends TestCase
                 [],
                 [],
                 [],
-                []
+                [],
             ],
             'staticPropertyRefs' => [
                 '<?php
@@ -347,7 +347,7 @@ class FileReferenceTest extends TestCase
                 ],
                 [],
                 [],
-                []
+                [],
             ],
             'instancePropertyRefs' => [
                 '<?php
@@ -387,7 +387,7 @@ class FileReferenceTest extends TestCase
                     ],
                 ],
                 [],
-                []
+                [],
             ],
             'traitAbstractRefs' => [
                 '<?php
@@ -415,7 +415,7 @@ class FileReferenceTest extends TestCase
                 [],
                 [],
                 [],
-                []
+                [],
             ],
         ];
     }
diff --git a/tests/FileUpdates/AnalyzedMethodTest.php b/tests/FileUpdates/AnalyzedMethodTest.php
index 177105ba2..5e28de039 100644
--- a/tests/FileUpdates/AnalyzedMethodTest.php
+++ b/tests/FileUpdates/AnalyzedMethodTest.php
@@ -1,15 +1,15 @@
 <?php
 namespace Psalm\Tests\FileUpdates;
 
+use function array_keys;
+use const DIRECTORY_SEPARATOR;
+use function getcwd;
 use Psalm\Internal\Analyzer\FileAnalyzer;
 use Psalm\Internal\Analyzer\ProjectAnalyzer;
 use Psalm\Internal\Provider\Providers;
 use Psalm\Tests\Internal\Provider;
 use Psalm\Tests\TestConfig;
 use function strpos;
-use function array_keys;
-use function getcwd;
-use const DIRECTORY_SEPARATOR;
 
 class AnalyzedMethodTest extends \Psalm\Tests\TestCase
 {
diff --git a/tests/FileUpdates/CachedStorageTest.php b/tests/FileUpdates/CachedStorageTest.php
index f561cacb4..e0861268d 100644
--- a/tests/FileUpdates/CachedStorageTest.php
+++ b/tests/FileUpdates/CachedStorageTest.php
@@ -1,15 +1,15 @@
 <?php
 namespace Psalm\Tests\FileUpdates;
 
+use function array_keys;
+use const DIRECTORY_SEPARATOR;
+use function getcwd;
 use Psalm\Internal\Analyzer\FileAnalyzer;
 use Psalm\Internal\Analyzer\ProjectAnalyzer;
 use Psalm\Internal\Provider\Providers;
 use Psalm\Tests\Internal\Provider;
 use Psalm\Tests\TestConfig;
 use function strpos;
-use function getcwd;
-use const DIRECTORY_SEPARATOR;
-use function array_keys;
 
 class CachedStorageTest extends \Psalm\Tests\TestCase
 {
diff --git a/tests/FileUpdates/ErrorAfterUpdateTest.php b/tests/FileUpdates/ErrorAfterUpdateTest.php
index 73b01f66d..39740b24e 100644
--- a/tests/FileUpdates/ErrorAfterUpdateTest.php
+++ b/tests/FileUpdates/ErrorAfterUpdateTest.php
@@ -1,16 +1,16 @@
 <?php
 namespace Psalm\Tests\FileUpdates;
 
+use function array_keys;
+use function array_pop;
+use const DIRECTORY_SEPARATOR;
+use function getcwd;
+use function preg_quote;
 use Psalm\Internal\Analyzer\FileAnalyzer;
 use Psalm\Internal\Analyzer\ProjectAnalyzer;
 use Psalm\Internal\Provider\Providers;
 use Psalm\Tests\Internal\Provider;
 use Psalm\Tests\TestConfig;
-use function array_pop;
-use function array_keys;
-use function preg_quote;
-use function getcwd;
-use const DIRECTORY_SEPARATOR;
 
 class ErrorAfterUpdateTest extends \Psalm\Tests\TestCase
 {
diff --git a/tests/FileUpdates/ErrorFixTest.php b/tests/FileUpdates/ErrorFixTest.php
index 446f4a46c..6a9cb499d 100644
--- a/tests/FileUpdates/ErrorFixTest.php
+++ b/tests/FileUpdates/ErrorFixTest.php
@@ -1,15 +1,15 @@
 <?php
 namespace Psalm\Tests\FileUpdates;
 
+use function array_keys;
+use function count;
+use const DIRECTORY_SEPARATOR;
+use function getcwd;
 use Psalm\Internal\Analyzer\FileAnalyzer;
 use Psalm\Internal\Analyzer\ProjectAnalyzer;
 use Psalm\Internal\Provider\Providers;
 use Psalm\Tests\Internal\Provider;
 use Psalm\Tests\TestConfig;
-use function count;
-use function array_keys;
-use function getcwd;
-use const DIRECTORY_SEPARATOR;
 
 class ErrorFixTest extends \Psalm\Tests\TestCase
 {
@@ -66,7 +66,7 @@ class ErrorFixTest extends \Psalm\Tests\TestCase
             $config->setCustomErrorLevel($error_type, $error_level);
         }
 
-        for ($i = 0; $i < count($files); $i++) {
+        for ($i = 0; $i < count($files); ++$i) {
             $batch = $files[$i];
 
             foreach ($batch as $file_path => $contents) {
diff --git a/tests/FileUpdates/TemporaryUpdateTest.php b/tests/FileUpdates/TemporaryUpdateTest.php
index 9ea71bad5..b26558494 100644
--- a/tests/FileUpdates/TemporaryUpdateTest.php
+++ b/tests/FileUpdates/TemporaryUpdateTest.php
@@ -1,18 +1,18 @@
 <?php
 namespace Psalm\Tests\FileUpdates;
 
+use function array_keys;
+use function array_map;
+use function array_shift;
+use function count;
+use const DIRECTORY_SEPARATOR;
+use function end;
+use function getcwd;
 use Psalm\Internal\Analyzer\FileAnalyzer;
 use Psalm\Internal\Analyzer\ProjectAnalyzer;
 use Psalm\Internal\Provider\Providers;
 use Psalm\Tests\Internal\Provider;
 use Psalm\Tests\TestConfig;
-use function array_shift;
-use function array_map;
-use function array_keys;
-use function end;
-use function count;
-use function getcwd;
-use const DIRECTORY_SEPARATOR;
 
 class TemporaryUpdateTest extends \Psalm\Tests\TestCase
 {
diff --git a/tests/FunctionCallTest.php b/tests/FunctionCallTest.php
index a5e8545fe..898bd98e4 100644
--- a/tests/FunctionCallTest.php
+++ b/tests/FunctionCallTest.php
@@ -1590,7 +1590,7 @@ class FunctionCallTest extends TestCase
                     '$a' => 'int|false',
                     '$b' => 'int|false',
                     '$c' => 'int',
-                ]
+                ],
             ],
             'PHP73-hrtime' => [
                 '<?php
@@ -1690,7 +1690,7 @@ class FunctionCallTest extends TestCase
             'countableSimpleXmlElement' => [
                 '<?php
                     $xml = new SimpleXMLElement("<?xml version=\"1.0\"?><a><b></b><b></b></a>");
-                    echo count($xml);'
+                    echo count($xml);',
             ],
             'refineWithTraitExists' => [
                 '<?php
@@ -1698,7 +1698,7 @@ class FunctionCallTest extends TestCase
                         if (trait_exists($s)) {
                             new ReflectionClass($s);
                         }
-                    }'
+                    }',
             ],
             'refineWithClassExistsOrTraitExists' => [
                 '<?php
@@ -1718,7 +1718,7 @@ class FunctionCallTest extends TestCase
                         if (class_exists($s) || interface_exists($s) || trait_exists($s)) {
                             new ReflectionClass($s);
                         }
-                    }'
+                    }',
             ],
             'minSingleArg' => [
                 '<?php
@@ -1740,7 +1740,7 @@ class FunctionCallTest extends TestCase
             'versionCompareAsCallable' => [
                 '<?php
                     $a = ["1.0", "2.0"];
-                    uksort($a, "version_compare");'
+                    uksort($a, "version_compare");',
             ],
             'coerceToObjectAfterBeingCalled' => [
                 '<?php
@@ -1758,7 +1758,7 @@ class FunctionCallTest extends TestCase
                         /** @psalm-suppress MixedArgument */
                         takesFoo($f);
                         $f->bar();
-                    }'
+                    }',
             ],
             'functionExists' => [
                 '<?php
@@ -1766,7 +1766,7 @@ class FunctionCallTest extends TestCase
                         function in_array($a, $b) {
                             return true;
                         }
-                    }'
+                    }',
             ],
             'pregReplaceCallback' => [
                 '<?php
@@ -2318,13 +2318,13 @@ class FunctionCallTest extends TestCase
                         takesString($s);
                         takesInt($s);
                     }',
-                'error_message' => 'InvalidScalarArgument'
+                'error_message' => 'InvalidScalarArgument',
             ],
             'tooFewArgsAccurateCount' => [
                 '<?php
                     preg_match(\'/adsf/\');',
-                'error_message' => 'TooFewArguments - src' . DIRECTORY_SEPARATOR . 'somefile.php:2:21 - Too few arguments for method preg_match - expecting 2 but saw 1'
-            ]
+                'error_message' => 'TooFewArguments - src' . DIRECTORY_SEPARATOR . 'somefile.php:2:21 - Too few arguments for method preg_match - expecting 2 but saw 1',
+            ],
         ];
     }
 }
diff --git a/tests/IncludeTest.php b/tests/IncludeTest.php
index 9af3d7ee5..7d459a55d 100644
--- a/tests/IncludeTest.php
+++ b/tests/IncludeTest.php
@@ -1,11 +1,11 @@
 <?php
 namespace Psalm\Tests;
 
+use const DIRECTORY_SEPARATOR;
+use function getcwd;
+use function preg_quote;
 use Psalm\Internal\Analyzer\FileAnalyzer;
 use function strpos;
-use function preg_quote;
-use function getcwd;
-use const DIRECTORY_SEPARATOR;
 
 class IncludeTest extends TestCase
 {
diff --git a/tests/InterfaceTest.php b/tests/InterfaceTest.php
index 8c5744adc..6573c200a 100644
--- a/tests/InterfaceTest.php
+++ b/tests/InterfaceTest.php
@@ -551,7 +551,7 @@ class InterfaceTest extends TestCase
 
                     function bar(IFoo $i) : void {
                         $i::doFoo();
-                    }'
+                    }',
             ],
             'inheritSystemInterface' => [
                 '<?php
@@ -559,7 +559,7 @@ class InterfaceTest extends TestCase
 
                     function f(I $c): void {
                         $c->current();
-                    }'
+                    }',
             ],
             'intersectMixedTypes' => [
                 '<?php
@@ -616,7 +616,7 @@ class InterfaceTest extends TestCase
                     /** @param I1&I2 $i */
                     function bar($i) : void {
                         foo($i);
-                    }'
+                    }',
             ],
             'intersectIterators' => [
                 '<?php
@@ -637,7 +637,7 @@ class InterfaceTest extends TestCase
                             takesA($c);
                             takesB($c);
                         }
-                    }'
+                    }',
             ],
         ];
     }
diff --git a/tests/Internal/Provider/FakeFileProvider.php b/tests/Internal/Provider/FakeFileProvider.php
index 6331f471d..130ed3759 100644
--- a/tests/Internal/Provider/FakeFileProvider.php
+++ b/tests/Internal/Provider/FakeFileProvider.php
@@ -1,9 +1,9 @@
 <?php
 namespace Psalm\Tests\Internal\Provider;
 
-use function strtolower;
 use function microtime;
 use function strpos;
+use function strtolower;
 
 class FakeFileProvider extends \Psalm\Internal\Provider\FileProvider
 {
diff --git a/tests/Internal/Provider/ParserInstanceCacheProvider.php b/tests/Internal/Provider/ParserInstanceCacheProvider.php
index a697e0ff4..7a9f7bd2a 100644
--- a/tests/Internal/Provider/ParserInstanceCacheProvider.php
+++ b/tests/Internal/Provider/ParserInstanceCacheProvider.php
@@ -1,8 +1,8 @@
 <?php
 namespace Psalm\Tests\Internal\Provider;
 
-use PhpParser;
 use function microtime;
+use PhpParser;
 
 class ParserInstanceCacheProvider extends \Psalm\Internal\Provider\ParserCacheProvider
 {
diff --git a/tests/InternalAnnotationTest.php b/tests/InternalAnnotationTest.php
index 828838ee1..248d12f56 100644
--- a/tests/InternalAnnotationTest.php
+++ b/tests/InternalAnnotationTest.php
@@ -191,7 +191,7 @@ class InternalAnnotationTest extends TestCase
                                 echo (new \A\Foo)->foo;
                             }
                         }
-                    }'
+                    }',
             ],
         ];
     }
diff --git a/tests/IssueSuppressionTest.php b/tests/IssueSuppressionTest.php
index 2662eb8a0..c158c256c 100644
--- a/tests/IssueSuppressionTest.php
+++ b/tests/IssueSuppressionTest.php
@@ -89,7 +89,7 @@ class IssueSuppressionTest extends TestCase
                          * here
                          */
                         strlen("a", "b");
-                    }'
+                    }',
             ],
             'suppressUndefinedFunction' => [
                 '<?php
diff --git a/tests/LanguageServer/CompletionTest.php b/tests/LanguageServer/CompletionTest.php
index 746016586..c6832e650 100644
--- a/tests/LanguageServer/CompletionTest.php
+++ b/tests/LanguageServer/CompletionTest.php
@@ -276,7 +276,7 @@ class CompletionTest extends \Psalm\Tests\TestCase
         $codebase->scanFiles();
         $this->analyzeFile('somefile.php', new Context());
 
-        $this->assertSame(null, $codebase->getCompletionDataAtPosition('somefile.php', new Position(16, 41)));
+        $this->assertNull($codebase->getCompletionDataAtPosition('somefile.php', new Position(16, 41)));
     }
 
     /**
@@ -657,8 +657,8 @@ class CompletionTest extends \Psalm\Tests\TestCase
 
         $this->assertCount(2, $completion_items);
 
-        $this->assertEquals('bar($0)', $completion_items[0]->insertText);
-        $this->assertEquals('baz()', $completion_items[1]->insertText);
+        $this->assertSame('bar($0)', $completion_items[0]->insertText);
+        $this->assertSame('baz()', $completion_items[1]->insertText);
     }
 
     /**
@@ -714,7 +714,7 @@ class CompletionTest extends \Psalm\Tests\TestCase
             [
                 '*Ex',
                 'symbol',
-                110
+                110,
             ],
             $completion_data
         );
@@ -769,7 +769,7 @@ class CompletionTest extends \Psalm\Tests\TestCase
             [
                 '*A',
                 'symbol',
-                215
+                215,
             ],
             $completion_data
         );
@@ -821,7 +821,7 @@ class CompletionTest extends \Psalm\Tests\TestCase
             [
                 '*A',
                 'symbol',
-                231
+                231,
             ],
             $completion_data
         );
diff --git a/tests/Loop/DoTest.php b/tests/Loop/DoTest.php
index 116c54a8c..85672abec 100644
--- a/tests/Loop/DoTest.php
+++ b/tests/Loop/DoTest.php
@@ -1,8 +1,8 @@
 <?php
 namespace Psalm\Tests\Loop;
 
-use Psalm\Tests\Traits;
 use const DIRECTORY_SEPARATOR;
+use Psalm\Tests\Traits;
 
 class DoTest extends \Psalm\Tests\TestCase
 {
diff --git a/tests/Loop/ForTest.php b/tests/Loop/ForTest.php
index 32d4ab81f..8a5397f3f 100644
--- a/tests/Loop/ForTest.php
+++ b/tests/Loop/ForTest.php
@@ -1,8 +1,8 @@
 <?php
 namespace Psalm\Tests\Loop;
 
-use Psalm\Tests\Traits;
 use const DIRECTORY_SEPARATOR;
+use Psalm\Tests\Traits;
 
 class ForTest extends \Psalm\Tests\TestCase
 {
diff --git a/tests/Loop/ForeachTest.php b/tests/Loop/ForeachTest.php
index 04cf83483..8432fb1f6 100644
--- a/tests/Loop/ForeachTest.php
+++ b/tests/Loop/ForeachTest.php
@@ -1,8 +1,8 @@
 <?php
 namespace Psalm\Tests\Loop;
 
-use Psalm\Tests\Traits;
 use const DIRECTORY_SEPARATOR;
+use Psalm\Tests\Traits;
 
 class ForeachTest extends \Psalm\Tests\TestCase
 {
diff --git a/tests/MagicMethodAnnotationTest.php b/tests/MagicMethodAnnotationTest.php
index 211286b85..de73e06c7 100644
--- a/tests/MagicMethodAnnotationTest.php
+++ b/tests/MagicMethodAnnotationTest.php
@@ -1,9 +1,9 @@
 <?php
 namespace Psalm\Tests;
 
+use const DIRECTORY_SEPARATOR;
 use Psalm\Config;
 use Psalm\Context;
-use const DIRECTORY_SEPARATOR;
 
 class MagicMethodAnnotationTest extends TestCase
 {
@@ -45,7 +45,6 @@ class MagicMethodAnnotationTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testAnnotationWithoutCallConfig()
@@ -412,7 +411,7 @@ class MagicMethodAnnotationTest extends TestCase
                         };
                     }
 
-                    echo makeConcrete()->sayHello();'
+                    echo makeConcrete()->sayHello();',
             ],
             'inheritInterfacePseudoMethodsFromParent' => [
                 '<?php
@@ -443,7 +442,7 @@ class MagicMethodAnnotationTest extends TestCase
                     test(concreteEm()->getClassMetadata());
 
                     test2(em()->getOtherMetadata());
-                    test2(concreteEm()->getOtherMetadata());'
+                    test2(concreteEm()->getOtherMetadata());',
             ],
         ];
     }
diff --git a/tests/MethodCallTest.php b/tests/MethodCallTest.php
index 2ab08e21d..ad7ea3ece 100644
--- a/tests/MethodCallTest.php
+++ b/tests/MethodCallTest.php
@@ -329,7 +329,7 @@ class MethodCallTest extends TestCase
                     $stmt->setFetchMode(PDO::FETCH_CLASS, A::class);
                     $stmt->execute();
                     /** @psalm-suppress MixedAssignment */
-                    $a = $stmt->fetch();'
+                    $a = $stmt->fetch();',
             ],
             'datePeriodConstructor' => [
                 '<?php
@@ -339,7 +339,7 @@ class MethodCallTest extends TestCase
                             DateInterval::createFromDateString("1 month"),
                             $d2
                         );
-                    }'
+                    }',
             ],
         ];
     }
diff --git a/tests/MethodSignatureTest.php b/tests/MethodSignatureTest.php
index fb099c5fa..0803b3d1f 100644
--- a/tests/MethodSignatureTest.php
+++ b/tests/MethodSignatureTest.php
@@ -1,9 +1,9 @@
 <?php
 namespace Psalm\Tests;
 
-use Psalm\Context;
 use function class_exists;
 use const DIRECTORY_SEPARATOR;
+use Psalm\Context;
 
 class MethodSignatureTest extends TestCase
 {
@@ -536,7 +536,7 @@ class MethodSignatureTest extends TestCase
                     $a = (new Bar)->getTargets();',
                 [
                     '$a' => 'string',
-                ]
+                ],
             ],
             'parentIsKnown' => [
                 '<?php
@@ -975,7 +975,7 @@ class MethodSignatureTest extends TestCase
                         public function f($f): void {}
                     }',
                 'error_message' => 'MethodSignatureMismatch',
-                ['MoreSpecificImplementedParamType']
+                ['MoreSpecificImplementedParamType'],
             ],
             'preventOneOfUnionMoreSpecific' => [
                 '<?php
diff --git a/tests/Php56Test.php b/tests/Php56Test.php
index 30666d2f4..ce1c4a5bf 100644
--- a/tests/Php56Test.php
+++ b/tests/Php56Test.php
@@ -247,7 +247,7 @@ class Php56Test extends TestCase
                     $arr = [1, 2, 3, 4];
                     foo(...$arr);',
                 'assertions' => [
-                    '$arr' => 'array<int, int>'
+                    '$arr' => 'array<int, int>',
                 ],
             ],
             'iterableSplat' => [
diff --git a/tests/ProjectCheckerTest.php b/tests/ProjectCheckerTest.php
index 95cd1d43a..6e2d7d326 100644
--- a/tests/ProjectCheckerTest.php
+++ b/tests/ProjectCheckerTest.php
@@ -1,22 +1,21 @@
 <?php
 namespace Psalm\Tests;
 
+use function define;
+use function defined;
+use const DIRECTORY_SEPARATOR;
+use function get_class;
+use function getcwd;
+use function microtime;
+use function ob_end_clean;
+use function ob_get_clean;
+use function ob_start;
 use Psalm\Codebase;
 use Psalm\Config;
 use Psalm\Internal\Analyzer\FileAnalyzer;
-use Psalm\Internal\Analyzer\ProjectAnalyzer;
 use Psalm\Plugin\Hook\AfterCodebasePopulatedInterface;
 use Psalm\Tests\Internal\Provider;
 use Psalm\Tests\Progress\EchoProgress;
-use function defined;
-use function define;
-use function getcwd;
-use function ob_start;
-use function ob_get_clean;
-use function get_class;
-use function ob_end_clean;
-use function microtime;
-use const DIRECTORY_SEPARATOR;
 
 class ProjectCheckerTest extends TestCase
 {
diff --git a/tests/PropertyTypeTest.php b/tests/PropertyTypeTest.php
index 8576280e3..f994b80be 100644
--- a/tests/PropertyTypeTest.php
+++ b/tests/PropertyTypeTest.php
@@ -1,9 +1,9 @@
 <?php
 namespace Psalm\Tests;
 
+use const DIRECTORY_SEPARATOR;
 use Psalm\Config;
 use Psalm\Context;
-use const DIRECTORY_SEPARATOR;
 
 class PropertyTypeTest extends TestCase
 {
@@ -11,7 +11,6 @@ class PropertyTypeTest extends TestCase
     use Traits\ValidCodeAnalysisTestTrait;
 
     /**
-     *
      * @return void
      */
     public function testForgetPropertyAssignments()
@@ -1546,7 +1545,7 @@ class PropertyTypeTest extends TestCase
                         public static function getInstance(): self { return new static; }
                     }
 
-                    class Concrete extends Base {}'
+                    class Concrete extends Base {}',
             ],
             'preventCrashWhenCallingInternalMethodInPropertyInitialisationChecks' => [
                 '<?php
@@ -1588,7 +1587,7 @@ class PropertyTypeTest extends TestCase
                             parent::__construct($foo);
                             $this->foo->something();
                         }
-                    }'
+                    }',
             ],
             'inferPropertyTypesForSimpleConstructors' => [
                 '<?php
@@ -1649,7 +1648,7 @@ class PropertyTypeTest extends TestCase
                           function (LogicException $e): void {},
                         ];
                       }
-                    }'
+                    }',
             ],
             'inferSpreadParamType' => [
                 '<?php
@@ -1660,7 +1659,7 @@ class PropertyTypeTest extends TestCase
                         public function __construct(Tag ...$tags) {
                             $this->tags = $tags;
                         }
-                    }'
+                    }',
             ],
         ];
     }
@@ -2007,7 +2006,7 @@ class PropertyTypeTest extends TestCase
 
                         public function __construct() { }
                     }',
-                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:4'
+                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:4',
             ],
             'noConstructor' => [
                 '<?php
@@ -2057,7 +2056,7 @@ class PropertyTypeTest extends TestCase
                     class B extends A {
                         public function __construct() {}
                     }',
-                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:11'
+                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:11',
             ],
             'notSetInAllBranchesOfIf' => [
                 '<?php
@@ -2071,7 +2070,7 @@ class PropertyTypeTest extends TestCase
                             }
                         }
                     }',
-                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:4'
+                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:4',
             ],
             'propertySetInProtectedMethod' => [
                 '<?php
@@ -2091,7 +2090,7 @@ class PropertyTypeTest extends TestCase
                     class B extends A {
                         protected function foo() : void {}
                     }',
-                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:15'
+                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:15',
             ],
             'definedInTraitNotSetInEmptyConstructor' => [
                 '<?php
@@ -2105,7 +2104,7 @@ class PropertyTypeTest extends TestCase
                         public function __construct() {
                         }
                     }',
-                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:6'
+                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:6',
             ],
             'propertySetInPrivateMethodWithIf' => [
                 '<?php
@@ -2123,7 +2122,7 @@ class PropertyTypeTest extends TestCase
                             $this->a = 5;
                         }
                     }',
-                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:4'
+                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:4',
             ],
             'privatePropertySameNameNotSetInConstructor' => [
                 '<?php
@@ -2140,7 +2139,7 @@ class PropertyTypeTest extends TestCase
                         /** @var string */
                         private $b;
                     }',
-                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:13'
+                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:13',
             ],
             'privateMethodCalledInParentConstructor' => [
                 '<?php
@@ -2165,7 +2164,7 @@ class PropertyTypeTest extends TestCase
 
                         private function privateMethod() : void {}
                     }',
-                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:2'
+                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:2',
             ],
             'privatePropertySetInParentConstructorReversedOrder' => [
                 '<?php
@@ -2219,7 +2218,7 @@ class PropertyTypeTest extends TestCase
                     class B extends A {
                         public function __construct() {}
                     }',
-                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:7'
+                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:7',
             ],
             'badAssignmentToUndefinedVars' => [
                 '<?php
@@ -2270,7 +2269,7 @@ class PropertyTypeTest extends TestCase
                             }
                         }
                     }',
-                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:4'
+                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:4',
             ],
             'invalidPropertyDefault' => [
                 '<?php
@@ -2451,7 +2450,7 @@ class PropertyTypeTest extends TestCase
 
                         public function __call(string $var, array $args) {}
                     }',
-                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:4'
+                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:4',
             ],
             'reportGoodLocationForPropertyError' => [
                 '<?php
@@ -2473,7 +2472,7 @@ class PropertyTypeTest extends TestCase
                             // nothing happens here
                         }
                     }',
-                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:15'
+                'error_message' => 'PropertyNotSetInConstructor - src' . DIRECTORY_SEPARATOR . 'somefile.php:15',
             ],
             'noCrashWhenUnsettingPropertyWithoutDefaultInConstructor' => [
                 '<?php
@@ -2485,7 +2484,7 @@ class PropertyTypeTest extends TestCase
                             unset($this->foo);
                         }
                     }',
-                'error_message' => 'PropertyNotSetInConstructor'
+                'error_message' => 'PropertyNotSetInConstructor',
             ],
             'parentSetsWiderTypeInConstructor' => [
                 '<?php
@@ -2511,14 +2510,14 @@ class PropertyTypeTest extends TestCase
                             $this->foo->something();
                         }
                     }',
-                'error_message' => 'UndefinedInterfaceMethod'
+                'error_message' => 'UndefinedInterfaceMethod',
             ],
             'nullableTypedPropertyNoConstructor' => [
                 '<?php
                     class A {
                         private ?bool $foo;
                     }',
-                'error_message' => 'MissingConstructor'
+                'error_message' => 'MissingConstructor',
             ],
             'nullableTypedPropertyEmptyConstructor' => [
                 '<?php
@@ -2527,7 +2526,7 @@ class PropertyTypeTest extends TestCase
 
                         public function __construct() {}
                     }',
-                'error_message' => 'PropertyNotSetInConstructor'
+                'error_message' => 'PropertyNotSetInConstructor',
             ],
             'nullableTypedPropertyUseBeforeInitialised' => [
                 '<?php
@@ -2538,7 +2537,7 @@ class PropertyTypeTest extends TestCase
                             echo $this->foo;
                         }
                     }',
-                'error_message' => 'UninitializedProperty'
+                'error_message' => 'UninitializedProperty',
             ],
             'nullableTypedPropertyNoConstructorWithDocblock' => [
                 '<?php
@@ -2546,7 +2545,7 @@ class PropertyTypeTest extends TestCase
                         /** @var ?bool */
                         private ?bool $foo;
                     }',
-                'error_message' => 'MissingConstructor'
+                'error_message' => 'MissingConstructor',
             ],
             'nullableTypedPropertyEmptyConstructorWithDocblock' => [
                 '<?php
@@ -2556,7 +2555,7 @@ class PropertyTypeTest extends TestCase
 
                         public function __construct() {}
                     }',
-                'error_message' => 'PropertyNotSetInConstructor'
+                'error_message' => 'PropertyNotSetInConstructor',
             ],
             'nullableTypedPropertyUseBeforeInitialisedWithDocblock' => [
                 '<?php
@@ -2568,7 +2567,7 @@ class PropertyTypeTest extends TestCase
                             echo $this->foo;
                         }
                     }',
-                'error_message' => 'UninitializedProperty'
+                'error_message' => 'UninitializedProperty',
             ],
         ];
     }
diff --git a/tests/PsalmInternalAnnotationTest.php b/tests/PsalmInternalAnnotationTest.php
index 5c41df559..74a8d9035 100644
--- a/tests/PsalmInternalAnnotationTest.php
+++ b/tests/PsalmInternalAnnotationTest.php
@@ -1,5 +1,4 @@
 <?php
-
 namespace Psalm\Tests;
 
 class PsalmInternalAnnotationTest extends TestCase
diff --git a/tests/PsalmPluginTest.php b/tests/PsalmPluginTest.php
index 560dc7a8a..7f196723d 100644
--- a/tests/PsalmPluginTest.php
+++ b/tests/PsalmPluginTest.php
@@ -1,6 +1,7 @@
 <?php
 namespace Psalm\Tests;
 
+use function preg_quote;
 use Prophecy\Argument;
 use Prophecy\Prophecy\ObjectProphecy;
 use Psalm\Internal\PluginManager\Command\DisableCommand;
@@ -11,7 +12,6 @@ use Psalm\Internal\PluginManager\PluginListFactory;
 use Symfony\Component\Console\Application;
 use Symfony\Component\Console\Input\InputOption;
 use Symfony\Component\Console\Tester\CommandTester;
-use function preg_quote;
 
 /** @group PluginManager */
 class PsalmPluginTest extends TestCase
diff --git a/tests/RedundantConditionTest.php b/tests/RedundantConditionTest.php
index cf4c96e4d..6a3303938 100644
--- a/tests/RedundantConditionTest.php
+++ b/tests/RedundantConditionTest.php
@@ -599,7 +599,7 @@ class RedundantConditionTest extends TestCase
                         } else {
                             return $s;
                         }
-                    }'
+                    }',
             ],
             'updateArrayAfterUnset' => [
                 '<?php
@@ -610,7 +610,7 @@ class RedundantConditionTest extends TestCase
                         $dict = ["a" => 1];
                         unset($dict[$s]);
                         if (count($dict)) {}
-                    }'
+                    }',
             ],
             'updateArrayAfterUnsetInLoop' => [
                 '<?php
@@ -625,7 +625,7 @@ class RedundantConditionTest extends TestCase
                         }
 
                         if (count($dict)) {}
-                    }'
+                    }',
             ],
         ];
     }
diff --git a/tests/ReportOutputTest.php b/tests/ReportOutputTest.php
index ef05d4384..18d23d433 100644
--- a/tests/ReportOutputTest.php
+++ b/tests/ReportOutputTest.php
@@ -1,17 +1,16 @@
 <?php
 namespace Psalm\Tests;
 
+use function file_get_contents;
+use function json_decode;
+use function ob_end_clean;
+use function ob_start;
 use Psalm\Context;
 use Psalm\Internal\Analyzer\FileAnalyzer;
 use Psalm\Internal\Analyzer\ProjectAnalyzer;
 use Psalm\IssueBuffer;
-use Psalm\Tests\Internal\Provider;
 use Psalm\Report;
-use function json_decode;
-use const PHP_EOL;
-use function ob_start;
-use function ob_end_clean;
-use function file_get_contents;
+use Psalm\Tests\Internal\Provider;
 use function unlink;
 
 class ReportOutputTest extends TestCase
@@ -58,7 +57,6 @@ class ReportOutputTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testReportFormatException()
@@ -72,7 +70,7 @@ class ReportOutputTest extends TestCase
 
     public function analyzeFileForReport() : void
     {
-         $file_contents = '<?php
+        $file_contents = '<?php
 function psalmCanVerify(int $your_code): ?string {
   return $as_you . "type";
 }
diff --git a/tests/ReturnTypeTest.php b/tests/ReturnTypeTest.php
index 3fd0ce519..677a1448c 100644
--- a/tests/ReturnTypeTest.php
+++ b/tests/ReturnTypeTest.php
@@ -608,7 +608,7 @@ class ReturnTypeTest extends TestCase
                     /** @return scalar */
                     function g() {
                         return true;
-                    }'
+                    }',
             ],
             'allowThrowAndExitToOverrideReturnType' => [
                 '<?php
diff --git a/tests/StubTest.php b/tests/StubTest.php
index cd9bae38f..550e9337c 100644
--- a/tests/StubTest.php
+++ b/tests/StubTest.php
@@ -1,14 +1,14 @@
 <?php
 namespace Psalm\Tests;
 
+use function define;
+use function defined;
+use function dirname;
+use function getcwd;
 use Psalm\Config;
 use Psalm\Context;
 use Psalm\Internal\Analyzer\FileAnalyzer;
 use Psalm\Tests\Internal\Provider;
-use function defined;
-use function define;
-use function dirname;
-use function getcwd;
 
 class StubTest extends TestCase
 {
@@ -350,7 +350,6 @@ class StubTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testStubVariadicFunctionWrongArgType()
@@ -385,7 +384,6 @@ class StubTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testUserVariadicWithFalseVariadic()
@@ -578,7 +576,6 @@ class StubTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testNoStubFunction()
@@ -884,7 +881,6 @@ class StubTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testStubFileWithPartialClassDefinitionGeneralReturnType()
diff --git a/tests/Template/ClassTemplateExtendsTest.php b/tests/Template/ClassTemplateExtendsTest.php
index 85e4436dd..f8546a26a 100644
--- a/tests/Template/ClassTemplateExtendsTest.php
+++ b/tests/Template/ClassTemplateExtendsTest.php
@@ -1,9 +1,9 @@
 <?php
 namespace Psalm\Tests\Template;
 
+use const DIRECTORY_SEPARATOR;
 use Psalm\Tests\TestCase;
 use Psalm\Tests\Traits;
-use const DIRECTORY_SEPARATOR;
 
 class ClassTemplateExtendsTest extends TestCase
 {
@@ -1748,7 +1748,7 @@ class ClassTemplateExtendsTest extends TestCase
                         }
                     }
 
-                    ord((new Child())->example("str"));'
+                    ord((new Child())->example("str"));',
             ],
             'allowTraitExtendAndImplementWithExplicitParamType' => [
                 '<?php
@@ -1886,7 +1886,7 @@ class ClassTemplateExtendsTest extends TestCase
                      */
                     function takesDogList(Collection $list) : void {
                         getSounds($list); // this probably should not be an error
-                    }'
+                    }',
             ],
             'keyOfClassTemplateExtended' => [
                 '<?php
@@ -1943,7 +1943,7 @@ class ClassTemplateExtendsTest extends TestCase
                 [
                     '$a' => 'int',
                     '$b' => 'string',
-                ]
+                ],
             ],
             'templateExtendsWithNewlineAfter' => [
                 '<?php
@@ -1959,7 +1959,7 @@ class ClassTemplateExtendsTest extends TestCase
                      *
                      * @internal
                      */
-                    class Bar extends Foo {}'
+                    class Bar extends Foo {}',
             ],
             'implementsArrayReturnTypeWithTemplate' => [
                 '<?php
@@ -2010,7 +2010,7 @@ class ClassTemplateExtendsTest extends TestCase
                         public static function getIdProperty() : string {
                             return "id";
                         }
-                    }'
+                    }',
             ],
             'interfaceParentExtends' => [
                 '<?php
@@ -2029,7 +2029,7 @@ class ClassTemplateExtendsTest extends TestCase
                         }
                     }
 
-                    echo (new F())->getValue();'
+                    echo (new F())->getValue();',
             ],
             'classParentExtends' => [
                 '<?php
@@ -2048,7 +2048,7 @@ class ClassTemplateExtendsTest extends TestCase
                         }
                     }
 
-                    echo (new F())->getValue();'
+                    echo (new F())->getValue();',
             ],
             'lessSpecificNonGenericReturnType' => [
                 '<?php
@@ -2211,7 +2211,7 @@ class ClassTemplateExtendsTest extends TestCase
                         public function getIterator() {
                             return parent::getIterator();
                         }
-                    }'
+                    }',
             ],
             'templatedInterfaceGetIteratorIteration' => [
                 '<?php
@@ -2267,9 +2267,9 @@ class ClassTemplateExtendsTest extends TestCase
                      */
                     class Bar implements Foo {
                         use FooTrait;
-                    }'
+                    }',
 
-            ]
+            ],
         ];
     }
 
@@ -3029,7 +3029,7 @@ class ClassTemplateExtendsTest extends TestCase
                     function bar(Child $c) : void {
                         ord($c->example("boris"));
                     }',
-                'error_message' => 'MixedArgument - src/somefile.php:31:29 - Argument 1 of ord cannot be mixed, expecting string'
+                'error_message' => 'MixedArgument - src/somefile.php:31:29 - Argument 1 of ord cannot be mixed, expecting string',
             ],
             'preventExtendingWithCovariance' => [
                 '<?php
@@ -3049,7 +3049,7 @@ class ClassTemplateExtendsTest extends TestCase
                      * @extends InvariantFoo<T>
                      */
                     class CovariantFoo extends InvariantFoo {}',
-                'error_message' => 'InvalidTemplateParam'
+                'error_message' => 'InvalidTemplateParam',
             ],
             'preventWiderParentType' => [
                 '<?php
@@ -3079,7 +3079,7 @@ class ClassTemplateExtendsTest extends TestCase
                             return "a";
                         }
                     }',
-                'error_message' => 'ArgumentTypeCoercion'
+                'error_message' => 'ArgumentTypeCoercion',
             ],
         ];
     }
diff --git a/tests/Template/ClassTemplateTest.php b/tests/Template/ClassTemplateTest.php
index cce1383f3..ca0f683d7 100644
--- a/tests/Template/ClassTemplateTest.php
+++ b/tests/Template/ClassTemplateTest.php
@@ -1,9 +1,9 @@
 <?php
 namespace Psalm\Tests\Template;
 
+use const DIRECTORY_SEPARATOR;
 use Psalm\Tests\TestCase;
 use Psalm\Tests\Traits;
-use const DIRECTORY_SEPARATOR;
 
 class ClassTemplateTest extends TestCase
 {
@@ -1183,7 +1183,7 @@ class ClassTemplateTest extends TestCase
                             if (!$t) {}
                             if ($t) {}
                          }
-                    }'
+                    }',
             ],
             'allowTemplateParamsToCoerceToMinimumTypes' => [
                 '<?php
@@ -1356,8 +1356,8 @@ class ClassTemplateTest extends TestCase
 
                     $a = $p->a;',
                 [
-                    '$a' => 'string'
-                ]
+                    '$a' => 'string',
+                ],
             ],
             'templateAsArray' => [
                 '<?php
@@ -1419,7 +1419,7 @@ class ClassTemplateTest extends TestCase
                         public function __set(string $property, $value) {
                             $this->data[$property] = $value;
                         }
-                    }'
+                    }',
             ],
             'keyOfClassTemplateReturningIndexedAccess' => [
                 '<?php
@@ -1449,7 +1449,7 @@ class ClassTemplateTest extends TestCase
                         public function __get(string $property) {
                             return $this->data[$property];
                         }
-                    }'
+                    }',
             ],
             'SKIPPED-templatedInterfaceIntersectionFirst' => [
                 '<?php
@@ -1475,7 +1475,7 @@ class ClassTemplateTest extends TestCase
                     $a = makeConcrete()->foo();',
                 [
                     '$a' => 'C',
-                ]
+                ],
             ],
             'templatedInterfaceIntersectionSecond' => [
                 '<?php
@@ -1501,7 +1501,7 @@ class ClassTemplateTest extends TestCase
                     $a = makeConcrete()->foo();',
                 [
                     '$a' => 'C',
-                ]
+                ],
             ],
             'returnTemplateIntersectionGenericObjectAndTemplate' => [
                 '<?php
@@ -1531,8 +1531,8 @@ class ClassTemplateTest extends TestCase
 
                     $a = makeConcrete(C::class);',
                 [
-                    '$a' => 'C&I<C>'
-                ]
+                    '$a' => 'C&I<C>',
+                ],
             ],
             'keyOfArrayGet' => [
                 '<?php
@@ -1586,9 +1586,9 @@ class ClassTemplateTest extends TestCase
                          * @return key-of<DATA>
                          */
                         abstract public function getRandomKey() : string;
-                    }'
+                    }',
             ],
-            'allowBoolTemplateCoercion' =>  [
+            'allowBoolTemplateCoercion' => [
                 '<?php
                     /** @template T */
                     class TestPromise {
diff --git a/tests/Template/FunctionClassStringTemplateTest.php b/tests/Template/FunctionClassStringTemplateTest.php
index b932dc1e5..81879e708 100644
--- a/tests/Template/FunctionClassStringTemplateTest.php
+++ b/tests/Template/FunctionClassStringTemplateTest.php
@@ -242,7 +242,7 @@ class FunctionClassStringTemplateTest extends TestCase
                     $y = filter($x, B::class);',
                 [
                     '$y' => 'array<array-key, A&B>',
-                ]
+                ],
             ],
             'unionTOrClassStringTPassedClassString' => [
                 '<?php
@@ -265,7 +265,7 @@ class FunctionClassStringTemplateTest extends TestCase
                         }
                     }
 
-                    getObject(C::class)->sayHello();'
+                    getObject(C::class)->sayHello();',
             ],
             'unionTOrClassStringTPassedObject' => [
                 '<?php
@@ -288,7 +288,7 @@ class FunctionClassStringTemplateTest extends TestCase
                         }
                     }
 
-                    getObject(new C())->sayHello();'
+                    getObject(new C())->sayHello();',
             ],
             'dontModifyByRefTemplatedArray' => [
                 '<?php
@@ -322,7 +322,7 @@ class FunctionClassStringTemplateTest extends TestCase
                      */
                     function getB(int $id, array $mapB): B {
                         return get(B::class, $mapB, $id);
-                    }'
+                    }',
             ],
             'unionClassStringTWithTReturnsObjectWhenCoerced' => [
                 '<?php
@@ -342,7 +342,7 @@ class FunctionClassStringTemplateTest extends TestCase
                     function foo(string $s) : object {
                         /** @psalm-suppress ArgumentTypeCoercion */
                         return bar($s);
-                    }'
+                    }',
             ],
 
             'allowTemplatedIntersectionFirst' => [
@@ -381,7 +381,7 @@ class FunctionClassStringTemplateTest extends TestCase
                         mock($className)->checkExpectations();
                     }
 
-                    mock(A::class)->foo();'
+                    mock(A::class)->foo();',
             ],
             'allowTemplatedIntersectionFirstTemplatedMock' => [
                 '<?php
@@ -419,7 +419,7 @@ class FunctionClassStringTemplateTest extends TestCase
                         mock($className)->checkExpectations();
                     }
 
-                    mock(A::class)->foo();'
+                    mock(A::class)->foo();',
             ],
             'allowTemplatedIntersectionSecond' => [
                 '<?php
@@ -464,7 +464,7 @@ class FunctionClassStringTemplateTest extends TestCase
                         mock($className)->checkExpectations();
                     }
 
-                    mock(A::class)->foo();'
+                    mock(A::class)->foo();',
             ],
             'returnClassString' => [
                 '<?php
@@ -532,7 +532,7 @@ class FunctionClassStringTemplateTest extends TestCase
                             }
                             throw new RuntimeException();
                         }
-                    }'
+                    }',
             ],
         ];
     }
@@ -584,7 +584,7 @@ class FunctionClassStringTemplateTest extends TestCase
                             return 3;
                         }
                     }',
-                'error_message' => 'InvalidReturnStatement'
+                'error_message' => 'InvalidReturnStatement',
             ],
             'forbidLossOfInformationWhenCoercing' => [
                 '<?php
diff --git a/tests/Template/FunctionTemplateTest.php b/tests/Template/FunctionTemplateTest.php
index e5453b39e..6e5c6d8b1 100644
--- a/tests/Template/FunctionTemplateTest.php
+++ b/tests/Template/FunctionTemplateTest.php
@@ -644,7 +644,7 @@ class FunctionTemplateTest extends TestCase
                 [
                     '$b' => 'string',
                     '$c' => 'int',
-                ]
+                ],
             ],
             'dontGeneraliseBoundParamWithWiderCallable' => [
                 '<?php
@@ -666,7 +666,7 @@ class FunctionTemplateTest extends TestCase
                     $c = makeConcrete(new C(), function (?C $c) : void {});',
                 [
                     '$c' => 'C',
-                ]
+                ],
             ],
             'allowTemplateTypeBeingUsedInsideFunction' => [
                 '<?php
@@ -1039,7 +1039,7 @@ class FunctionTemplateTest extends TestCase
                     function foo(callable $callable) : void {
                         $callable(new \DateTime());
                     }',
-                'error_message' => 'InvalidArgument'
+                'error_message' => 'InvalidArgument',
             ],
             'preventWrongTemplateBeingPassed' => [
                 '<?php
@@ -1054,7 +1054,7 @@ class FunctionTemplateTest extends TestCase
                     {
                         return $parameter($value);
                     }',
-                'error_message' => 'InvalidArgument'
+                'error_message' => 'InvalidArgument',
             ],
             'preventTemplateTypeReturnMoreGeneral' => [
                 '<?php
@@ -1067,7 +1067,7 @@ class FunctionTemplateTest extends TestCase
                     {
                         return new \DateTime();
                     }',
-                'error_message' => 'InvalidReturnStatement'
+                'error_message' => 'InvalidReturnStatement',
             ],
             'preventReturningString' => [
                 '<?php
@@ -1079,7 +1079,7 @@ class FunctionTemplateTest extends TestCase
                     function mirror($t) {
                         return "string";
                     }',
-                'error_message' => 'InvalidReturnStatement'
+                'error_message' => 'InvalidReturnStatement',
             ],
             'unTemplatedVarOnReturn' => [
                 '<?php
@@ -1100,7 +1100,7 @@ class FunctionTemplateTest extends TestCase
 
                         return new B();
                     }',
-                'error_message' => 'InvalidReturnStatement'
+                'error_message' => 'InvalidReturnStatement',
             ],
         ];
     }
diff --git a/tests/TestCase.php b/tests/TestCase.php
index 20917f431..102f9415d 100644
--- a/tests/TestCase.php
+++ b/tests/TestCase.php
@@ -1,17 +1,17 @@
 <?php
 namespace Psalm\Tests;
 
+use function define;
+use function defined;
+use const DIRECTORY_SEPARATOR;
+use function getcwd;
+use function ini_set;
 use PHPUnit\Framework\TestCase as BaseTestCase;
 use Psalm\Internal\Analyzer\FileAnalyzer;
 use Psalm\Internal\Analyzer\ProjectAnalyzer;
 use Psalm\Internal\Provider\Providers;
 use Psalm\Tests\Internal\Provider;
 use RuntimeException;
-use function ini_set;
-use function defined;
-use function define;
-use function getcwd;
-use const DIRECTORY_SEPARATOR;
 
 class TestCase extends BaseTestCase
 {
diff --git a/tests/TestConfig.php b/tests/TestConfig.php
index 9b86aa689..69c398d09 100644
--- a/tests/TestConfig.php
+++ b/tests/TestConfig.php
@@ -1,9 +1,9 @@
 <?php
 namespace Psalm\Tests;
 
-use Psalm\Config;
-use function getcwd;
 use const DIRECTORY_SEPARATOR;
+use function getcwd;
+use Psalm\Config;
 
 class TestConfig extends Config
 {
diff --git a/tests/ThrowsAnnotationTest.php b/tests/ThrowsAnnotationTest.php
index 71dfe8395..6297aefb2 100644
--- a/tests/ThrowsAnnotationTest.php
+++ b/tests/ThrowsAnnotationTest.php
@@ -7,7 +7,6 @@ use Psalm\Context;
 class ThrowsAnnotationTest extends TestCase
 {
     /**
-     *
      * @return void
      */
     public function testUndocumentedThrow()
@@ -149,7 +148,6 @@ class ThrowsAnnotationTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testUndocumentedThrowInFunctionCall()
@@ -308,7 +306,6 @@ class ThrowsAnnotationTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testUncaughtThrowInFunctionCall()
@@ -351,7 +348,6 @@ class ThrowsAnnotationTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testEmptyThrows()
diff --git a/tests/TraitTest.php b/tests/TraitTest.php
index f02afd099..a03227587 100644
--- a/tests/TraitTest.php
+++ b/tests/TraitTest.php
@@ -867,7 +867,7 @@ class TraitTest extends TestCase
 
                     class C {
                         use T;
-                    }'
+                    }',
             ],
         ];
     }
diff --git a/tests/Traits/InvalidCodeAnalysisTestTrait.php b/tests/Traits/InvalidCodeAnalysisTestTrait.php
index d57d66f75..4c34b0c49 100644
--- a/tests/Traits/InvalidCodeAnalysisTestTrait.php
+++ b/tests/Traits/InvalidCodeAnalysisTestTrait.php
@@ -1,14 +1,14 @@
 <?php
 namespace Psalm\Tests\Traits;
 
+use function is_int;
+use const PHP_VERSION;
+use function preg_quote;
+use function preg_replace;
 use Psalm\Config;
 use Psalm\Context;
 use function strpos;
 use function version_compare;
-use const PHP_VERSION;
-use function is_int;
-use function preg_replace;
-use function preg_quote;
 
 trait InvalidCodeAnalysisTestTrait
 {
diff --git a/tests/Traits/ValidCodeAnalysisTestTrait.php b/tests/Traits/ValidCodeAnalysisTestTrait.php
index f4e6b73d9..034a90ab7 100644
--- a/tests/Traits/ValidCodeAnalysisTestTrait.php
+++ b/tests/Traits/ValidCodeAnalysisTestTrait.php
@@ -1,14 +1,14 @@
 <?php
 namespace Psalm\Tests\Traits;
 
+use function is_int;
+use const PHP_VERSION;
 use Psalm\Config;
 use Psalm\Context;
-use function strpos;
-use function version_compare;
-use const PHP_VERSION;
-use function is_int;
 use function strlen;
+use function strpos;
 use function substr;
+use function version_compare;
 
 trait ValidCodeAnalysisTestTrait
 {
diff --git a/tests/TryCatchTest.php b/tests/TryCatchTest.php
index 45d6f9cd3..674a97805 100644
--- a/tests/TryCatchTest.php
+++ b/tests/TryCatchTest.php
@@ -1,9 +1,6 @@
 <?php
 namespace Psalm\Tests;
 
-use Psalm\Config;
-use Psalm\Context;
-
 class TryCatchTest extends TestCase
 {
     use Traits\ValidCodeAnalysisTestTrait;
@@ -219,7 +216,7 @@ class TryCatchTest extends TestCase
                     } catch (Exception $e) {
                         example();
                     }
-                    ord($str);'
+                    ord($str);',
             ],
         ];
     }
diff --git a/tests/TypeAlgebraTest.php b/tests/TypeAlgebraTest.php
index 9ca568050..3cbeacdb4 100644
--- a/tests/TypeAlgebraTest.php
+++ b/tests/TypeAlgebraTest.php
@@ -916,7 +916,7 @@ class TypeAlgebraTest extends TestCase
                         }
 
                         echo sprintf("padding-top:%s%%;", 100 * ($height/$width));
-                    }'
+                    }',
             ],
             'invertLogic' => [
                 '<?php
@@ -929,7 +929,7 @@ class TypeAlgebraTest extends TestCase
                         }
 
                         return $a;
-                    }'
+                    }',
             ],
         ];
     }
diff --git a/tests/TypeCombinationTest.php b/tests/TypeCombinationTest.php
index e7dd0ef78..365df9746 100644
--- a/tests/TypeCombinationTest.php
+++ b/tests/TypeCombinationTest.php
@@ -1,9 +1,9 @@
 <?php
 namespace Psalm\Tests;
 
+use function array_values;
 use Psalm\Internal\Type\TypeCombination;
 use Psalm\Type;
-use function array_values;
 
 class TypeCombinationTest extends TestCase
 {
diff --git a/tests/TypeParseTest.php b/tests/TypeParseTest.php
index 57c726a4a..0d60f53ef 100644
--- a/tests/TypeParseTest.php
+++ b/tests/TypeParseTest.php
@@ -1,10 +1,10 @@
 <?php
 namespace Psalm\Tests;
 
-use Psalm\Type;
 use function function_exists;
-use function stripos;
 use function print_r;
+use Psalm\Type;
+use function stripos;
 
 class TypeParseTest extends TestCase
 {
@@ -305,7 +305,6 @@ class TypeParseTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testInvalidType()
@@ -315,7 +314,6 @@ class TypeParseTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testBracketedUnionAndIntersection()
@@ -526,7 +524,6 @@ class TypeParseTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testCallableWithBadVariadic()
@@ -536,7 +533,6 @@ class TypeParseTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testCallableWithTrailingColon()
@@ -546,7 +542,6 @@ class TypeParseTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testCallableWithAnotherBadVariadic()
@@ -556,7 +551,6 @@ class TypeParseTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testCallableWithVariadicAndDefault()
@@ -566,7 +560,6 @@ class TypeParseTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testBadVariadic()
@@ -576,7 +569,6 @@ class TypeParseTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testBadFullStop()
@@ -586,7 +578,6 @@ class TypeParseTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testBadSemicolon()
@@ -596,7 +587,6 @@ class TypeParseTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testBadGenericString()
@@ -606,7 +596,6 @@ class TypeParseTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testBadAmpersand()
@@ -616,7 +605,6 @@ class TypeParseTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testBadColon()
@@ -626,7 +614,6 @@ class TypeParseTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testBadBrackets()
@@ -636,7 +623,6 @@ class TypeParseTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testMoreBadBrackets()
@@ -646,7 +632,6 @@ class TypeParseTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testGeneratorWithWBadBrackets()
@@ -656,7 +641,6 @@ class TypeParseTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testBadEquals()
@@ -666,7 +650,6 @@ class TypeParseTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testBadBar()
@@ -676,7 +659,6 @@ class TypeParseTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testBadColonDash()
@@ -686,7 +668,6 @@ class TypeParseTest extends TestCase
     }
 
     /**
-     *
      * @return void
      */
     public function testDoubleBar()
@@ -784,7 +765,7 @@ class TypeParseTest extends TestCase
                 null,
                 [
                     'T' => ['' => [Type::getArray()]],
-                    'K' => ['' => [new Type\Union([new Type\Atomic\TTemplateKeyOf('T', null)])]]
+                    'K' => ['' => [new Type\Union([new Type\Atomic\TTemplateKeyOf('T', null)])]],
                 ]
             )
         );
@@ -940,7 +921,6 @@ class TypeParseTest extends TestCase
             }
         }
 
-
         $reflectionFunc = new \ReflectionFunction('Psalm\Tests\someFunction');
         $reflectionParams = $reflectionFunc->getParameters();
 
diff --git a/tests/TypeReconciliationTest.php b/tests/TypeReconciliationTest.php
index dc6c63402..0d75422b2 100644
--- a/tests/TypeReconciliationTest.php
+++ b/tests/TypeReconciliationTest.php
@@ -1,6 +1,7 @@
 <?php
 namespace Psalm\Tests;
 
+use function is_array;
 use Psalm\Context;
 use Psalm\Internal\Analyzer\FileAnalyzer;
 use Psalm\Internal\Analyzer\StatementsAnalyzer;
@@ -9,7 +10,6 @@ use Psalm\Internal\Clause;
 use Psalm\Type;
 use Psalm\Type\Algebra;
 use Psalm\Type\Reconciler;
-use function is_array;
 
 class TypeReconciliationTest extends TestCase
 {
@@ -1308,7 +1308,7 @@ class TypeReconciliationTest extends TestCase
                         }
 
                         echo sprintf("padding-top:%s%%;", 100 * ($height/$width));
-                    }'
+                    }',
             ],
             'notEmptyCheckOnMixedInTernary' => [
                 '<?php
@@ -1376,7 +1376,7 @@ class TypeReconciliationTest extends TestCase
                         } else {
                             throw new \InvalidArgumentException("Bad");
                         }
-                    }'
+                    }',
             ],
             'noLeakyClassType' => [
                 '<?php
@@ -1393,7 +1393,7 @@ class TypeReconciliationTest extends TestCase
                         public function iffer() : bool {
                             return $this->foo || $this->bar;
                         }
-                    }'
+                    }',
             ],
             'noLeakyForeachType' => [
                 '<?php
@@ -1425,7 +1425,7 @@ class TypeReconciliationTest extends TestCase
                         }
                     }',
                 [],
-                ['MixedAssignment']
+                ['MixedAssignment'],
             ],
             'nonEmptyThing' => [
                 '<?php
@@ -1442,7 +1442,7 @@ class TypeReconciliationTest extends TestCase
                         }
                     }',
                 [],
-                ['MixedArgument', 'MixedArrayAccess', 'MixedAssignment', 'MixedArrayOffset']
+                ['MixedArgument', 'MixedArrayAccess', 'MixedAssignment', 'MixedArrayOffset'],
             ],
             'allowNonEmptyArrayComparison' => [
                 '<?php
@@ -1452,7 +1452,7 @@ class TypeReconciliationTest extends TestCase
                      */
                     function foo(array $a, array $b) : void {
                         if ($a === $b) {}
-                    }'
+                    }',
             ],
         ];
     }
diff --git a/tests/UnusedCodeTest.php b/tests/UnusedCodeTest.php
index a54a14afd..cc4bcecab 100644
--- a/tests/UnusedCodeTest.php
+++ b/tests/UnusedCodeTest.php
@@ -385,7 +385,7 @@ class UnusedCodeTest extends TestCase
                     protected $foo = 2;
                 }
 
-                (new D)->bar();'
+                (new D)->bar();',
             ],
             'usedClassAfterExtensionLoaded' => [
                 '<?php
@@ -422,7 +422,7 @@ class UnusedCodeTest extends TestCase
                         }
                     }
 
-                    (new C)->addType(null);'
+                    (new C)->addType(null);',
             ],
             'usedMethodAfterClassExists' => [
                 '<?php
@@ -432,7 +432,7 @@ class UnusedCodeTest extends TestCase
 
                     if (class_exists(A::class)) {
                         A::bar();
-                    }'
+                    }',
             ],
         ];
     }
diff --git a/tests/UnusedVariableTest.php b/tests/UnusedVariableTest.php
index d8eabb3f7..e318078ce 100644
--- a/tests/UnusedVariableTest.php
+++ b/tests/UnusedVariableTest.php
@@ -1,12 +1,12 @@
 <?php
 namespace Psalm\Tests;
 
+use function preg_quote;
 use Psalm\Config;
 use Psalm\Context;
 use Psalm\Internal\Analyzer\FileAnalyzer;
 use Psalm\Tests\Internal\Provider;
 use function strpos;
-use function preg_quote;
 
 class UnusedVariableTest extends TestCase
 {
@@ -965,7 +965,7 @@ class UnusedVariableTest extends TestCase
                         if ($var !== "") {
                             echo $var;
                         }
-                    }'
+                    }',
             ],
             'useTryAssignedVariableInFinallyWhenCatchExits' => [
                 '<?php
@@ -1000,7 +1000,7 @@ class UnusedVariableTest extends TestCase
                             echo get_class($a);
                             $a = A::getA();
                         }
-                    }'
+                    }',
             ],
         ];
     }
diff --git a/tests/ValueTest.php b/tests/ValueTest.php
index 4fe41f05e..191036ff2 100644
--- a/tests/ValueTest.php
+++ b/tests/ValueTest.php
@@ -610,7 +610,7 @@ class ValueTest extends TestCase
 
                     A::foo(1);
                     A::foo(2);
-                    A::foo(3);'
+                    A::foo(3);',
             ],
             'valueOf' => [
                 '<?php
@@ -629,7 +629,7 @@ class ValueTest extends TestCase
 
                     A::bar("a");
                     A::bar("b");
-                    A::bar("c");'
+                    A::bar("c");',
             ],
             'valueOfDefault' => [
                 '<?php
@@ -837,7 +837,7 @@ class ValueTest extends TestCase
                     }
 
                     A::foo(4);',
-                'error_message' => 'InvalidArgument'
+                'error_message' => 'InvalidArgument',
             ],
             'valueOfBadValue' => [
                 '<?php
@@ -855,13 +855,13 @@ class ValueTest extends TestCase
                     }
 
                     A::bar("d");',
-                'error_message' => 'InvalidArgument'
+                'error_message' => 'InvalidArgument',
             ],
             'casedComparison' => [
                 '<?php
                     if ("C" === "c") {}',
                 'error_message' => 'TypeDoesNotContainType',
-            ]
+            ],
         ];
     }
 }
diff --git a/tests/fixtures/DummyProjectWithErrors/src/FileWithErrors.php b/tests/fixtures/DummyProjectWithErrors/src/FileWithErrors.php
index 7d909056c..5470fc7dc 100644
--- a/tests/fixtures/DummyProjectWithErrors/src/FileWithErrors.php
+++ b/tests/fixtures/DummyProjectWithErrors/src/FileWithErrors.php
@@ -1,6 +1,7 @@
 <?php
 namespace Acme\SampleProject;
 
-function foo(string $s): int {
-    return "bar";
+function foo(string $s): int
+{
+    return 'bar';
 }
diff --git a/tests/fixtures/config_discovery/files_in_lib/lib/Baz.php b/tests/fixtures/config_discovery/files_in_lib/lib/Baz.php
index 86621d478..3cd06c600 100644
--- a/tests/fixtures/config_discovery/files_in_lib/lib/Baz.php
+++ b/tests/fixtures/config_discovery/files_in_lib/lib/Baz.php
@@ -1,5 +1,6 @@
 <?php
-
 namespace Foo\Bar;
 
-class Baz {}
+class Baz
+{
+}
diff --git a/tests/fixtures/performance/diff_parse_large_file.php b/tests/fixtures/performance/diff_parse_large_file.php
index 252f51ea7..172e48f05 100644
--- a/tests/fixtures/performance/diff_parse_large_file.php
+++ b/tests/fixtures/performance/diff_parse_large_file.php
@@ -44,4 +44,3 @@ Psalm\Internal\Provider\StatementsProvider::parseStatements($b);
 $diff_2 = microtime(true) - $time;
 
 echo 'Full parsing: ' . number_format($diff_2, 4) . "\n";
-
diff --git a/tests/fixtures/stubs/class_alias.php b/tests/fixtures/stubs/class_alias.php
index f2112e8e3..565cd9d11 100644
--- a/tests/fixtures/stubs/class_alias.php
+++ b/tests/fixtures/stubs/class_alias.php
@@ -34,4 +34,3 @@ foreach ($arr as list($orig, $alias)) {
     // Psalm cannot reason about this in the loading step
     class_alias($orig, $alias);
 }
-
diff --git a/tests/fixtures/stubs/conditional_interface.php b/tests/fixtures/stubs/conditional_interface.php
index 95e2a4bc0..1eaf1fd66 100644
--- a/tests/fixtures/stubs/conditional_interface.php
+++ b/tests/fixtures/stubs/conditional_interface.php
@@ -1,49 +1,80 @@
 <?php
 if (interface_exists(Foo::class)) {
-    interface I1 extends Foo {}
+    interface I1 extends Foo
+    {
+    }
 } else {
-    interface I1 {}
+    interface I1
+    {
+    }
 }
 
 if (!interface_exists(Foo::class)) {
-    interface I2 {}
+    interface I2
+    {
+    }
 } else {
-    interface I2 extends Foo {}
+    interface I2 extends Foo
+    {
+    }
 }
 
 if (interface_exists('Bar')) {
-    interface I3 extends Bar {}
+    interface I3 extends Bar
+    {
+    }
 } else {
-    interface I3 {}
+    interface I3
+    {
+    }
 }
 
 if (!interface_exists('Bar')) {
-    interface I4 {}
+    interface I4
+    {
+    }
 } else {
-    interface I4 extends Bar {}
+    interface I4 extends Bar
+    {
+    }
 }
 
 if (interface_exists('Throwable')) {
-    interface I5 extends Throwable {}
+    interface I5 extends Throwable
+    {
+    }
 } else {
-    interface I5 {}
+    interface I5
+    {
+    }
 }
 
 if (!interface_exists('Throwable')) {
-    interface I6 {}
+    interface I6
+    {
+    }
 } else {
-    interface I6 extends Throwable {}
+    interface I6 extends Throwable
+    {
+    }
 }
 
 if (interface_exists(Throwable::class)) {
-    interface I7 extends Throwable {}
+    interface I7 extends Throwable
+    {
+    }
 } else {
-    interface I7 {}
+    interface I7
+    {
+    }
 }
 
 if (!interface_exists(Throwable::class)) {
-    interface I8 {}
+    interface I8
+    {
+    }
 } else {
-    interface I8 extends Throwable {}
+    interface I8 extends Throwable
+    {
+    }
 }
-
diff --git a/tests/fixtures/stubs/polyfill.php b/tests/fixtures/stubs/polyfill.php
index c55f66d78..3bcd8ffcf 100644
--- a/tests/fixtures/stubs/polyfill.php
+++ b/tests/fixtures/stubs/polyfill.php
@@ -22,4 +22,3 @@ if (!function_exists('new_random_bytes')) {
         return 5;
     }
 }
-
