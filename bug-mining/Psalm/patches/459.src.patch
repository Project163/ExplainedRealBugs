diff --git a/src/Psalm/Internal/Analyzer/Statements/Block/ForeachAnalyzer.php b/src/Psalm/Internal/Analyzer/Statements/Block/ForeachAnalyzer.php
index bde17b0e4..0d502a041 100644
--- a/src/Psalm/Internal/Analyzer/Statements/Block/ForeachAnalyzer.php
+++ b/src/Psalm/Internal/Analyzer/Statements/Block/ForeachAnalyzer.php
@@ -299,11 +299,7 @@ class ForeachAnalyzer
 
         $loop_scope = new LoopScope($foreach_context, $context);
 
-        $protected_var_ids = $context->protected_var_ids;
-        if ($var_id) {
-            $protected_var_ids[$var_id] = true;
-        }
-        $loop_scope->protected_var_ids = $protected_var_ids;
+        $loop_scope->protected_var_ids = $context->protected_var_ids;
 
         LoopAnalyzer::analyze($statements_analyzer, $stmt->stmts, [], [], $loop_scope, $inner_loop_context);
 
diff --git a/tests/Loop/ForeachTest.php b/tests/Loop/ForeachTest.php
index c068972f7..9767af788 100644
--- a/tests/Loop/ForeachTest.php
+++ b/tests/Loop/ForeachTest.php
@@ -978,6 +978,13 @@ class ForeachTest extends \Psalm\Tests\TestCase
                         foreach ($arr as $a) {}
                     }'
             ],
+            'foreachLoopInvalidation' => [
+                '<?php
+                    $list = [1, 2, 3];
+                    foreach ($list as $i) {
+                      $list = [4, 5, 6];
+                    }',
+            ],
         ];
     }
 
@@ -1108,14 +1115,6 @@ class ForeachTest extends \Psalm\Tests\TestCase
                     }',
                 'error_message' => 'RedundantCondition',
             ],
-            'foreachLoopInvalidation' => [
-                '<?php
-                    $list = [1, 2, 3];
-                    foreach ($list as $i) {
-                      $list = [4, 5, 6];
-                    }',
-                'error_message' => 'LoopInvalidation',
-            ],
             'possiblyUndefinedVariableInForeachDueToBreakBefore' => [
                 '<?php
                     foreach ([1, 2, 3, 4] as $b) {
