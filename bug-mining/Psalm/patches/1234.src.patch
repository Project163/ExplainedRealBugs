diff --git a/src/Psalm/Internal/Diff/FileDiffer.php b/src/Psalm/Internal/Diff/FileDiffer.php
index e9c06c02a..668c6456b 100644
--- a/src/Psalm/Internal/Diff/FileDiffer.php
+++ b/src/Psalm/Internal/Diff/FileDiffer.php
@@ -77,8 +77,6 @@ class FileDiffer
     {
         $result = [];
         for ($d = count($trace) - 1; $d >= 0; --$d) {
-            // Todo: fix integer ranges in fors
-            /** @var int<0, max> $d */
             $v = $trace[$d];
             $k = $x - $y;
 
diff --git a/src/Psalm/Internal/Type/Comparator/ArrayTypeComparator.php b/src/Psalm/Internal/Type/Comparator/ArrayTypeComparator.php
index 7fac7954f..6977e4658 100644
--- a/src/Psalm/Internal/Type/Comparator/ArrayTypeComparator.php
+++ b/src/Psalm/Internal/Type/Comparator/ArrayTypeComparator.php
@@ -123,10 +123,6 @@ class ArrayTypeComparator
         }
 
         foreach ($input_type_part->type_params as $i => $input_param) {
-            if ($i > 1) {
-                break;
-            }
-
             $container_param = $container_type_part->type_params[$i];
 
             if ($i === 0
diff --git a/src/Psalm/Internal/Type/SimpleAssertionReconciler.php b/src/Psalm/Internal/Type/SimpleAssertionReconciler.php
index af7e1051d..926e76e4a 100644
--- a/src/Psalm/Internal/Type/SimpleAssertionReconciler.php
+++ b/src/Psalm/Internal/Type/SimpleAssertionReconciler.php
@@ -1962,10 +1962,6 @@ class SimpleAssertionReconciler extends Reconciler
         }
 
         foreach ($existing_var_type->getAtomicTypes() as $atomic_type) {
-            if ($inside_loop) {
-                continue;
-            }
-
             if ($atomic_type instanceof TIntRange) {
                 if ($atomic_type->contains($assertion_value)) {
                     // if the range contains the assertion, the range must be adapted
@@ -2075,10 +2071,6 @@ class SimpleAssertionReconciler extends Reconciler
         }
 
         foreach ($existing_var_type->getAtomicTypes() as $atomic_type) {
-            if ($inside_loop) {
-                continue;
-            }
-
             if ($atomic_type instanceof TIntRange) {
                 if ($atomic_type->contains($assertion_value)) {
                     // if the range contains the assertion, the range must be adapted
diff --git a/src/Psalm/Internal/Type/SimpleNegatedAssertionReconciler.php b/src/Psalm/Internal/Type/SimpleNegatedAssertionReconciler.php
index 5ae0b004b..cfb5827ed 100644
--- a/src/Psalm/Internal/Type/SimpleNegatedAssertionReconciler.php
+++ b/src/Psalm/Internal/Type/SimpleNegatedAssertionReconciler.php
@@ -1840,10 +1840,6 @@ class SimpleNegatedAssertionReconciler extends Reconciler
         }
 
         foreach ($existing_var_type->getAtomicTypes() as $atomic_type) {
-            if ($inside_loop) {
-                continue;
-            }
-
             if ($atomic_type instanceof TIntRange) {
                 if ($atomic_type->contains($assertion_value)) {
                     // if the range contains the assertion, the range must be adapted
@@ -1951,10 +1947,6 @@ class SimpleNegatedAssertionReconciler extends Reconciler
         }
 
         foreach ($existing_var_type->getAtomicTypes() as $atomic_type) {
-            if ($inside_loop) {
-                continue;
-            }
-
             if ($atomic_type instanceof TIntRange) {
                 if ($atomic_type->contains($assertion_value)) {
                     // if the range contains the assertion, the range must be adapted
diff --git a/tests/IntRangeTest.php b/tests/IntRangeTest.php
index 8a189c285..f4d8aefc2 100644
--- a/tests/IntRangeTest.php
+++ b/tests/IntRangeTest.php
@@ -443,9 +443,8 @@ class IntRangeTest extends TestCase
                     '$remainder===' => 'int<min, 1>',
                 ],
             ],
-            'SKIPPED-IntRangeRestrictWhenUntouched' => [
+            'IntRangeRestrictWhenUntouched' => [
                 'code' => '<?php
-                    //skipped, int range in loops not supported yet
                     foreach ([1, 2, 3] as $i) {
                         if ($i > 1) {
                             takesInt($i);
@@ -457,26 +456,48 @@ class IntRangeTest extends TestCase
                         return;
                     }',
             ],
-            'SKIPPED-wrongLoopAssertion' => [
+            'intRangeExpandedByLoop' => [
+                'code' => '<?php
+                    for ($i = 0; $i < 10; $i++) {
+                        takesInt($i);
+                    }
+                    for (; $i < 20; $i++) {
+                        takesInt($i);
+                    }
+
+                    /** @psalm-param int<0, 20> $i */
+                    function takesInt(int $i): void{
+                        return;
+                    }',
+            ],
+            'statementsInLoopPreserveNonNegativeIntRange' => [
+                'code' => '<?php
+                    $sum = 0;
+                    foreach ([-6, 0, 2] as $i) {
+                        if ($i > 0) {
+                            $sum += $i;
+                        }
+                    }
+                    takesNonNegativeInt($sum);
+
+                    /** @psalm-param int<0, max> $i */
+                    function takesNonNegativeInt(int $i): void{
+                        return;
+                    }',
+            ],
+            'wrongLoopAssertion' => [
                 'code' => '<?php
-                    //skipped, int range in loops not supported yet
                     function a(): array {
                         $type_tokens = getArray();
 
                         for ($i = 0, $l = rand(0,100); $i < $l; ++$i) {
-
-                            /** @psalm-trace $i */;
                             if ($i > 0 && rand(0,1)) {
                                 continue;
                             }
-                            /** @psalm-trace $i  */;
-
 
                             $type_tokens[$i] = "";
 
-                            /** @psalm-trace $type_tokens */;
-
-                            if($i > 1){
+                            if ($i > 1) {
                                 $type_tokens[$i - 2];
                             }
                         }
@@ -484,7 +505,6 @@ class IntRangeTest extends TestCase
                         return [];
                     }
 
-
                     /** @return array<int, string> */
                     function getArray(): array {
                         return [];
