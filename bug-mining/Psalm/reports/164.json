{"url":"https://api.github.com/repos/vimeo/psalm/issues/1925","repository_url":"https://api.github.com/repos/vimeo/psalm","labels_url":"https://api.github.com/repos/vimeo/psalm/issues/1925/labels{/name}","comments_url":"https://api.github.com/repos/vimeo/psalm/issues/1925/comments","events_url":"https://api.github.com/repos/vimeo/psalm/issues/1925/events","html_url":"https://github.com/vimeo/psalm/issues/1925","id":465881234,"node_id":"MDU6SXNzdWU0NjU4ODEyMzQ=","number":1925,"title":"LogicException scanning wordpress-importer on bedrock","user":{"login":"omivore","id":5184643,"node_id":"MDQ6VXNlcjUxODQ2NDM=","avatar_url":"https://avatars.githubusercontent.com/u/5184643?v=4","gravatar_id":"","url":"https://api.github.com/users/omivore","html_url":"https://github.com/omivore","followers_url":"https://api.github.com/users/omivore/followers","following_url":"https://api.github.com/users/omivore/following{/other_user}","gists_url":"https://api.github.com/users/omivore/gists{/gist_id}","starred_url":"https://api.github.com/users/omivore/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omivore/subscriptions","organizations_url":"https://api.github.com/users/omivore/orgs","repos_url":"https://api.github.com/users/omivore/repos","events_url":"https://api.github.com/users/omivore/events{/privacy}","received_events_url":"https://api.github.com/users/omivore/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-07-09T16:38:59Z","updated_at":"2019-07-10T23:01:33Z","closed_at":"2019-07-10T22:59:07Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"When running Psalm on the WordPress-Importer plugin, Psalm crashes with a LogicException. Based on the error, it looks like it's actually a PhpParser error, but I don't know enough to be sure and at least wanted to file a bug here before going there.\r\nTo reproduce:\r\n1. New directory\r\n2. Copy in the `wordpress-importer` folder that you get from the Download link at the [plugin site](https://wordpress.org/plugins/wordpress-importer/#developers)\r\n2. `composer init -n; composer require --dev vimeo/psalm; composer install`\r\n3. `./vendor/bin/psalm --init`\r\n4. Edit `psalm.xml` to have `projectFiles` like so\r\n```\r\n    <projectFiles>\r\n        <directory name=\"wordpress-importer\" />\r\n        <ignoreFiles>\r\n            <directory name=\"vendor\" />\r\n        </ignoreFiles>\r\n    </projectFiles>\r\n```\r\n5. Run `./vendor/bin/psalm` and witness a crash that spits this out with a `--debug-by-line`:\r\n```\r\nRegistering autoloaded files\r\nUsing composer to locate file for Symfony\\Polyfill\\Ctype\\Ctype\r\nUsing composer to locate file for Amp\\Promise\r\nUsing reflection to get metadata for Generator\r\nUsing reflection to get metadata for Throwable\r\nUsing composer to locate file for Amp\\Failure\r\nUsing composer to locate file for Amp\\Coroutine\r\nUsing reflection to locate file for React\\Promise\\PromiseInterface\r\nUsing composer to locate file for Amp\\Success\r\nUsing composer to locate file for Amp\\Loop\r\nUsing reflection to get metadata for Error\r\nUsing composer to locate file for Amp\\Deferred\r\nUsing composer to locate file for Amp\\TimeoutException\r\nUsing reflection to get metadata for Countable\r\nUsing reflection to get metadata for SimpleXMLElement\r\nUsing reflection to locate file for ResourceBundle\r\nUsing composer to locate file for Amp\\MultiReasonException\r\nUsing composer to locate file for Amp\\Iterator\r\nUsing reflection to get metadata for Traversable\r\nUsing composer to locate file for Amp\\Producer\r\nUsing composer to locate file for Amp\\Delayed\r\nUsing composer to locate file for Amp\\Emitter\r\nUsing reflection to get metadata for TypeError\r\nUsing composer to locate file for Symfony\\Polyfill\\Mbstring\\Mbstring\r\nUsing composer to locate file for Symfony\\Polyfill\\Php73\\Php73\r\nUsing composer to locate file for Amp\\ByteStream\\InputStream\r\nUsing composer to locate file for Amp\\ByteStream\\OutputStream\r\nUsing composer to locate file for Amp\\ByteStream\\ResourceInputStream\r\nUsing composer to locate file for Amp\\ByteStream\\ResourceOutputStream\r\nUsing composer to locate file for Webmozart\\PathUtil\\Path\r\nUsing reflection to get metadata for Exception\r\nUsing composer to locate file for Amp\\Internal\\Placeholder\r\nUsing composer to locate file for Amp\\Loop\\Driver\r\nUsing composer to locate file for Amp\\Loop\\DriverFactory\r\nUsing composer to locate file for Amp\\CallableMaker\r\nUsing composer to locate file for Amp\\Internal\\Producer\r\nUsing reflection to get metadata for SplQueue\r\nScanning /Users/jason/Fresh/psalm-integration/importer-debug/vendor/amphp/amp/lib/Internal/Placeholder.php\r\nScanning /Users/jason/Fresh/psalm-integration/importer-debug/vendor/amphp/amp/lib/CallableMaker.php\r\nScanning /Users/jason/Fresh/psalm-integration/importer-debug/vendor/amphp/amp/lib/Internal/Producer.php\r\nUsing composer to locate file for Amp\\Internal\\ResolutionQueue\r\nUsing composer to locate file for Amp\\Loop\\Watcher\r\nUsing reflection to get metadata for ReflectionClass\r\nUsing reflection to get metadata for ReflectionMethod\r\nUsing reflection to get metadata for ReflectionProperty\r\nUsing reflection to get metadata for ReflectionClassConstant\r\nUsing reflection to get metadata for ReflectionExtension\r\nUsing reflection to get metadata for ReflectionParameter\r\nUsing reflection to get metadata for ReflectionType\r\nUsing reflection to get metadata for Closure\r\nUsing composer to locate file for Amp\\Struct\r\nScanning /Users/jason/Fresh/psalm-integration/importer-debug/vendor/amphp/amp/lib/Struct.php\r\nUsing reflection to get metadata for ReflectionFunction\r\nUsing reflection to get metadata for ReflectionFunctionAbstract\r\nFinished registering autoloaded files\r\nVisiting autoload files took 0.065s\r\nScanning files...\r\nParsing /Users/jason/Fresh/psalm-integration/importer-debug/wordpress-importer/wordpress-importer.php\r\nDeep scanning /Users/jason/Fresh/psalm-integration/importer-debug/wordpress-importer/wordpress-importer.php\r\nPHP Fatal error:  Uncaught LogicException: $this->fq_classlike_names should not be null in /Users/jason/Fresh/psalm-integration/importer-debug/vendor/vimeo/psalm/src/Psalm/Internal/Visitor/ReflectorVisitor.php:1548\r\nStack trace:\r\n#0 /Users/jason/Fresh/psalm-integration/importer-debug/vendor/vimeo/psalm/src/Psalm/Internal/Visitor/ReflectorVisitor.php(321): Psalm\\Internal\\Visitor\\ReflectorVisitor->registerFunctionLike(Object(PhpParser\\Node\\Stmt\\ClassMethod))\r\n#1 /Users/jason/Fresh/psalm-integration/importer-debug/vendor/nikic/php-parser/lib/PhpParser/NodeTraverser.php(200): Psalm\\Internal\\Visitor\\ReflectorVisitor->enterNode(Object(PhpParser\\Node\\Stmt\\ClassMethod))\r\n#2 /Users/jason/Fresh/psalm-integration/importer-debug/vendor/nikic/php-parser/lib/PhpParser/NodeTraverser.php(114): PhpParser\\NodeTraverser->traverseArray(Array)\r\n#3 /Users/jason/Fresh/psalm-integration/importer-debug/vendor/nikic/php-parser/lib/PhpParser/NodeTraverser.php(223): PhpParser\\NodeTraverser->traverseNode(Object(PhpParser\\Node\\Stmt\\Class_))\r\n#4 /Users/jason/Fres in /Users/jason/Fresh/psalm-integration/importer-debug/vendor/vimeo/psalm/src/Psalm/Internal/Visitor/ReflectorVisitor.php on line 1548\r\n```","closed_by":{"login":"muglug","id":2292638,"node_id":"MDQ6VXNlcjIyOTI2Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2292638?v=4","gravatar_id":"","url":"https://api.github.com/users/muglug","html_url":"https://github.com/muglug","followers_url":"https://api.github.com/users/muglug/followers","following_url":"https://api.github.com/users/muglug/following{/other_user}","gists_url":"https://api.github.com/users/muglug/gists{/gist_id}","starred_url":"https://api.github.com/users/muglug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muglug/subscriptions","organizations_url":"https://api.github.com/users/muglug/orgs","repos_url":"https://api.github.com/users/muglug/repos","events_url":"https://api.github.com/users/muglug/events{/privacy}","received_events_url":"https://api.github.com/users/muglug/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/1925/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vimeo/psalm/issues/1925/timeline","performed_via_github_app":null,"state_reason":"completed"}