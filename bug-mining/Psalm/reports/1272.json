{"url":"https://api.github.com/repos/vimeo/psalm/issues/10446","repository_url":"https://api.github.com/repos/vimeo/psalm","labels_url":"https://api.github.com/repos/vimeo/psalm/issues/10446/labels{/name}","comments_url":"https://api.github.com/repos/vimeo/psalm/issues/10446/comments","events_url":"https://api.github.com/repos/vimeo/psalm/issues/10446/events","html_url":"https://github.com/vimeo/psalm/issues/10446","id":2022664260,"node_id":"I_kwDOBG8K9854j2hE","number":10446,"title":"Adding `composer.lock` in VCS ?","user":{"login":"drupol","id":252042,"node_id":"MDQ6VXNlcjI1MjA0Mg==","avatar_url":"https://avatars.githubusercontent.com/u/252042?v=4","gravatar_id":"","url":"https://api.github.com/users/drupol","html_url":"https://github.com/drupol","followers_url":"https://api.github.com/users/drupol/followers","following_url":"https://api.github.com/users/drupol/following{/other_user}","gists_url":"https://api.github.com/users/drupol/gists{/gist_id}","starred_url":"https://api.github.com/users/drupol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drupol/subscriptions","organizations_url":"https://api.github.com/users/drupol/orgs","repos_url":"https://api.github.com/users/drupol/repos","events_url":"https://api.github.com/users/drupol/events{/privacy}","received_events_url":"https://api.github.com/users/drupol/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2023-12-03T18:47:31Z","updated_at":"2025-02-20T09:26:40Z","closed_at":"2025-02-20T09:26:40Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Hi there,\r\n\r\nI'm writing to suggest an enhancement for the `vimeo/psalm` project to improve its integration and ensure long-term reliability, particularly for package managers like apt, rpm, yum, nix, etc etc.\r\n\r\nThe primary goal here is to enable reproducibility of the exact build of the PHAR released, down to the last bit. This is crucial, especially when distributing it as a binary for reasons of reliability and security.\r\n\r\nTo achieve this, I propose adding a `composer.lock` file to the `vimeo/psalm` repository. This file will ensure that `psalm` is reproducible on any system, regardless of environmental differences, by locking down specific versions of dependencies. Its absence currently hinders the ability to precisely replicate the builds you provide in your GitHub releases, introducing potential variability.\r\n\r\nFor example, in Nix, we have to provide our own `composer.lock` for each update, as seen here: https://github.com/NixOS/nixpkgs/pull/271920\r\n\r\nFor reference, here are some projects that have recognized the value of versioning the `composer.lock` file:\r\n\r\n- https://github.com/sebastianbergmann/phpunit/pull/5576\r\n- https://github.com/bobthecow/psysh/issues/767\r\n- https://github.com/phpro/grumphp/issues/1095\r\n- https://github.com/NixOS/nixpkgs/pull/255253\r\n- https://github.com/phpstan/phpstan-src/blob/1.11.x/composer.lock\r\n\r\nIf there are concerns about including the `composer.lock` file in the main repository, could it be an option to add it to the release artifacts on GitHub instead? This compromise would still greatly benefit reproducibility and consistency in dependency management.\r\n\r\nThank you for considering this enhancement. I look forward to your response.\r\n","closed_by":{"login":"danog","id":7339644,"node_id":"MDQ6VXNlcjczMzk2NDQ=","avatar_url":"https://avatars.githubusercontent.com/u/7339644?v=4","gravatar_id":"","url":"https://api.github.com/users/danog","html_url":"https://github.com/danog","followers_url":"https://api.github.com/users/danog/followers","following_url":"https://api.github.com/users/danog/following{/other_user}","gists_url":"https://api.github.com/users/danog/gists{/gist_id}","starred_url":"https://api.github.com/users/danog/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danog/subscriptions","organizations_url":"https://api.github.com/users/danog/orgs","repos_url":"https://api.github.com/users/danog/repos","events_url":"https://api.github.com/users/danog/events{/privacy}","received_events_url":"https://api.github.com/users/danog/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/10446/reactions","total_count":5,"+1":5,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vimeo/psalm/issues/10446/timeline","performed_via_github_app":null,"state_reason":"completed"}