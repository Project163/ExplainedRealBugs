{"url":"https://api.github.com/repos/vimeo/psalm/issues/4264","repository_url":"https://api.github.com/repos/vimeo/psalm","labels_url":"https://api.github.com/repos/vimeo/psalm/issues/4264/labels{/name}","comments_url":"https://api.github.com/repos/vimeo/psalm/issues/4264/comments","events_url":"https://api.github.com/repos/vimeo/psalm/issues/4264/events","html_url":"https://github.com/vimeo/psalm/issues/4264","id":712479377,"node_id":"MDU6SXNzdWU3MTI0NzkzNzc=","number":4264,"title":"Definitions after a conditional duplicate definition aren't parsed","user":{"login":"gnarlyquack","id":412354,"node_id":"MDQ6VXNlcjQxMjM1NA==","avatar_url":"https://avatars.githubusercontent.com/u/412354?v=4","gravatar_id":"","url":"https://api.github.com/users/gnarlyquack","html_url":"https://github.com/gnarlyquack","followers_url":"https://api.github.com/users/gnarlyquack/followers","following_url":"https://api.github.com/users/gnarlyquack/following{/other_user}","gists_url":"https://api.github.com/users/gnarlyquack/gists{/gist_id}","starred_url":"https://api.github.com/users/gnarlyquack/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gnarlyquack/subscriptions","organizations_url":"https://api.github.com/users/gnarlyquack/orgs","repos_url":"https://api.github.com/users/gnarlyquack/repos","events_url":"https://api.github.com/users/gnarlyquack/events{/privacy}","received_events_url":"https://api.github.com/users/gnarlyquack/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":486061586,"node_id":"MDU6TGFiZWw0ODYwNjE1ODY=","url":"https://api.github.com/repos/vimeo/psalm/labels/bug","name":"bug","color":"ee0701","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-10-01T04:56:19Z","updated_at":"2020-10-01T19:20:49Z","closed_at":"2020-10-01T19:20:49Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"This causes Psalm to crash (\"could not get storage class for X\") when those definitions are then referenced in other files.\r\n\r\nThis can't be reproduced on psalm.dev as multiple files are needed to trigger the error. Here's a minimal reproduction:\r\n```php\r\n<?php\r\n// one.php\r\n\r\nif (true) {\r\n    class One {}\r\n}\r\nelse {\r\n    class One {}\r\n}\r\n\r\nclass Two {}\r\n```\r\n\r\n```php\r\n<?php\r\n// two.php\r\n\r\nnew Two();\r\n```\r\nIn `composer.json`:\r\n```json\r\n{\r\n    \"autoload\": {\r\n        \"files\": [\"one.php\", \"two.php\"]\r\n    }\r\n}\r\n```\r\n\r\nI get that [Psalm doesn't like the conditional duplicate class definition](https://psalm.dev/docs/running_psalm/issues/DuplicateClass/) of `One`, but it doesn't seem like that should prevent subsequent definitions from being parsed.","closed_by":{"login":"muglug","id":2292638,"node_id":"MDQ6VXNlcjIyOTI2Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2292638?v=4","gravatar_id":"","url":"https://api.github.com/users/muglug","html_url":"https://github.com/muglug","followers_url":"https://api.github.com/users/muglug/followers","following_url":"https://api.github.com/users/muglug/following{/other_user}","gists_url":"https://api.github.com/users/muglug/gists{/gist_id}","starred_url":"https://api.github.com/users/muglug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muglug/subscriptions","organizations_url":"https://api.github.com/users/muglug/orgs","repos_url":"https://api.github.com/users/muglug/repos","events_url":"https://api.github.com/users/muglug/events{/privacy}","received_events_url":"https://api.github.com/users/muglug/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/4264/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vimeo/psalm/issues/4264/timeline","performed_via_github_app":null,"state_reason":"completed"}