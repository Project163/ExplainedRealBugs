{"url":"https://api.github.com/repos/vimeo/psalm/issues/3654","repository_url":"https://api.github.com/repos/vimeo/psalm","labels_url":"https://api.github.com/repos/vimeo/psalm/issues/3654/labels{/name}","comments_url":"https://api.github.com/repos/vimeo/psalm/issues/3654/comments","events_url":"https://api.github.com/repos/vimeo/psalm/issues/3654/events","html_url":"https://github.com/vimeo/psalm/issues/3654","id":644115865,"node_id":"MDU6SXNzdWU2NDQxMTU4NjU=","number":3654,"title":"Taint detection does not work for global functions in a namespace due to id not including namespace","user":{"login":"TysonAndre","id":1904430,"node_id":"MDQ6VXNlcjE5MDQ0MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1904430?v=4","gravatar_id":"","url":"https://api.github.com/users/TysonAndre","html_url":"https://github.com/TysonAndre","followers_url":"https://api.github.com/users/TysonAndre/followers","following_url":"https://api.github.com/users/TysonAndre/following{/other_user}","gists_url":"https://api.github.com/users/TysonAndre/gists{/gist_id}","starred_url":"https://api.github.com/users/TysonAndre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TysonAndre/subscriptions","organizations_url":"https://api.github.com/users/TysonAndre/orgs","repos_url":"https://api.github.com/users/TysonAndre/repos","events_url":"https://api.github.com/users/TysonAndre/events{/privacy}","received_events_url":"https://api.github.com/users/TysonAndre/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":486061586,"node_id":"MDU6TGFiZWw0ODYwNjE1ODY=","url":"https://api.github.com/repos/vimeo/psalm/labels/bug","name":"bug","color":"ee0701","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-06-23T20:15:22Z","updated_at":"2020-06-23T20:53:17Z","closed_at":"2020-06-23T20:53:17Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I see that the graph that was built has an edge with a from_id of `identity#1`, but elsewhere, there's an edge to `ns\\identity#1` with a prefix of `ns\\`\r\n\r\nIt also looks like there might be potential problems normalizing the case of namespace (should be consistently lowercased or uppercased to properly uniquely track?), but the lack of the prefix seems to be the main problem.\r\n\r\nUsing https://github.com/TysonAndre/psalm/compare/taint-debug?targetBranch=master to print debugging info about sources/edges\r\n\r\nExpected: Should emit TaintedInput\r\nObserved: Does not\r\n\r\n```php\r\n<?php\r\n\r\nnamespace ns {\r\n\r\nfunction identity($s) {\r\n    return $s;\r\n}\r\n\r\necho namespace\\identity($_GET['userinput']);\r\n\r\n}\r\n/*\r\n\r\nSources:\r\n$_GET:src/namespaced_taint.php:89\r\nEdges:\r\nFrom identity#1  -- this is the $from_id\r\n-> ns\\identity\r\nFrom $_GET:src/namespaced_taint.php:89\r\n-> $_GET['userinput']-src/namespaced_taint.php:89-93\r\nFrom call to NS\\identity-src/namespaced_taint.php:89-106\r\n-> ns\\identity#1   -- this is the $to_id\r\nFrom $_GET['userinput']-src/namespaced_taint.php:89-93\r\n-> call to NS\\identity-src/namespaced_taint.php:89-106\r\nFrom call to echo-src/namespaced_taint.php:70-107\r\n-> echo#1-src/namespaced_taint.php:65\r\nFrom ns\\identity\r\n-> call to echo-src/namespaced_taint.php:70-107\r\nSinks:\r\necho#1-src/namespaced_taint.php:65\r\n */\r\n```","closed_by":{"login":"muglug","id":2292638,"node_id":"MDQ6VXNlcjIyOTI2Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2292638?v=4","gravatar_id":"","url":"https://api.github.com/users/muglug","html_url":"https://github.com/muglug","followers_url":"https://api.github.com/users/muglug/followers","following_url":"https://api.github.com/users/muglug/following{/other_user}","gists_url":"https://api.github.com/users/muglug/gists{/gist_id}","starred_url":"https://api.github.com/users/muglug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muglug/subscriptions","organizations_url":"https://api.github.com/users/muglug/orgs","repos_url":"https://api.github.com/users/muglug/repos","events_url":"https://api.github.com/users/muglug/events{/privacy}","received_events_url":"https://api.github.com/users/muglug/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/3654/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vimeo/psalm/issues/3654/timeline","performed_via_github_app":null,"state_reason":"completed"}