[{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/574590458","html_url":"https://github.com/vimeo/psalm/issues/2626#issuecomment-574590458","issue_url":"https://api.github.com/repos/vimeo/psalm/issues/2626","id":574590458,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NDU5MDQ1OA==","user":{"login":"psalm-github-bot[bot]","id":58627613,"node_id":"MDM6Qm90NTg2Mjc2MTM=","avatar_url":"https://avatars.githubusercontent.com/in/48546?v=4","gravatar_id":"","url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D","html_url":"https://github.com/apps/psalm-github-bot","followers_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/followers","following_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/repos","events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2020-01-15T10:12:56Z","updated_at":"2020-01-15T10:12:56Z","body":"I found these snippets:\n<details>\n<summary>https://psalm.dev/r/5439dec258</summary>\n\n```php\n<?php\n$fp = tmpfile();\n\nif ($fp && is_resource($fp)) { // has just opened but not *likely* to be redundant\n  echo 'foo', \"\\n\";\n} else {\n  echo 'bar', \"\\n\";\n}\n\necho var_export([$fp, is_resource($fp), !! $fp], true);\n\nfclose($fp);\n\nif ($fp && is_resource($fp)) { // not a resource but not falsey, should not error in object context\n  echo 'baz', \"\\n\";\n} else {\n  echo 'bat', \"\\n\";\n}\n\necho var_export([$fp, is_resource($fp), !! $fp], true);\n```\n\n```\nPsalm output (using commit 389af1b):\n\nERROR: RedundantCondition - 4:12 - Found a redundant condition when evaluating $fp and trying to reconcile type 'resource' to resource\n\nERROR: RedundantCondition - 4:5 - Found a redundant condition when evaluating $fp and trying to reconcile type 'resource' to resource\n\nERROR: RedundantCondition - 14:12 - Found a redundant condition when evaluating $fp and trying to reconcile type 'resource' to resource\n\nERROR: RedundantCondition - 14:5 - Found a redundant condition when evaluating $fp and trying to reconcile type 'resource' to resource\n```\n</details>\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/574590458/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"psalm-github-bot[bot]","id":58627613,"node_id":"MDM6Qm90NTg2Mjc2MTM=","avatar_url":"https://avatars.githubusercontent.com/in/48546?v=4","gravatar_id":"","url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D","html_url":"https://github.com/apps/psalm-github-bot","followers_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/followers","following_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/repos","events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false}},{"id":2950462587,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI5NTA0NjI1ODc=","url":"https://api.github.com/repos/vimeo/psalm/issues/events/2950462587","actor":{"login":"bapcltd-marv","id":46891309,"node_id":"MDQ6VXNlcjQ2ODkxMzA5","avatar_url":"https://avatars.githubusercontent.com/u/46891309?v=4","gravatar_id":"","url":"https://api.github.com/users/bapcltd-marv","html_url":"https://github.com/bapcltd-marv","followers_url":"https://api.github.com/users/bapcltd-marv/followers","following_url":"https://api.github.com/users/bapcltd-marv/following{/other_user}","gists_url":"https://api.github.com/users/bapcltd-marv/gists{/gist_id}","starred_url":"https://api.github.com/users/bapcltd-marv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bapcltd-marv/subscriptions","organizations_url":"https://api.github.com/users/bapcltd-marv/orgs","repos_url":"https://api.github.com/users/bapcltd-marv/repos","events_url":"https://api.github.com/users/bapcltd-marv/events{/privacy}","received_events_url":"https://api.github.com/users/bapcltd-marv/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"ed3e8f1712e54957ec54da290cc2a72f18ec7673","commit_url":"https://api.github.com/repos/bapcltd/php-imap/commits/ed3e8f1712e54957ec54da290cc2a72f18ec7673","created_at":"2020-01-15T11:30:12Z","performed_via_github_app":null},{"id":2950485070,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI5NTA0ODUwNzA=","url":"https://api.github.com/repos/vimeo/psalm/issues/events/2950485070","actor":{"login":"bapcltd-marv","id":46891309,"node_id":"MDQ6VXNlcjQ2ODkxMzA5","avatar_url":"https://avatars.githubusercontent.com/u/46891309?v=4","gravatar_id":"","url":"https://api.github.com/users/bapcltd-marv","html_url":"https://github.com/bapcltd-marv","followers_url":"https://api.github.com/users/bapcltd-marv/followers","following_url":"https://api.github.com/users/bapcltd-marv/following{/other_user}","gists_url":"https://api.github.com/users/bapcltd-marv/gists{/gist_id}","starred_url":"https://api.github.com/users/bapcltd-marv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bapcltd-marv/subscriptions","organizations_url":"https://api.github.com/users/bapcltd-marv/orgs","repos_url":"https://api.github.com/users/bapcltd-marv/repos","events_url":"https://api.github.com/users/bapcltd-marv/events{/privacy}","received_events_url":"https://api.github.com/users/bapcltd-marv/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"b55c424ef479a6364960f8adf88439a7df40f171","commit_url":"https://api.github.com/repos/bapcltd/php-imap/commits/b55c424ef479a6364960f8adf88439a7df40f171","created_at":"2020-01-15T11:38:50Z","performed_via_github_app":null},{"id":2950517402,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI5NTA1MTc0MDI=","url":"https://api.github.com/repos/vimeo/psalm/issues/events/2950517402","actor":{"login":"bapcltd-marv","id":46891309,"node_id":"MDQ6VXNlcjQ2ODkxMzA5","avatar_url":"https://avatars.githubusercontent.com/u/46891309?v=4","gravatar_id":"","url":"https://api.github.com/users/bapcltd-marv","html_url":"https://github.com/bapcltd-marv","followers_url":"https://api.github.com/users/bapcltd-marv/followers","following_url":"https://api.github.com/users/bapcltd-marv/following{/other_user}","gists_url":"https://api.github.com/users/bapcltd-marv/gists{/gist_id}","starred_url":"https://api.github.com/users/bapcltd-marv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bapcltd-marv/subscriptions","organizations_url":"https://api.github.com/users/bapcltd-marv/orgs","repos_url":"https://api.github.com/users/bapcltd-marv/repos","events_url":"https://api.github.com/users/bapcltd-marv/events{/privacy}","received_events_url":"https://api.github.com/users/bapcltd-marv/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"f385f8210a54a032ef3f546ddb13e73c785192d2","commit_url":"https://api.github.com/repos/bapcltd/php-imap/commits/f385f8210a54a032ef3f546ddb13e73c785192d2","created_at":"2020-01-15T11:50:46Z","performed_via_github_app":null},{"id":2950537978,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI5NTA1Mzc5Nzg=","url":"https://api.github.com/repos/vimeo/psalm/issues/events/2950537978","actor":{"login":"bapcltd-marv","id":46891309,"node_id":"MDQ6VXNlcjQ2ODkxMzA5","avatar_url":"https://avatars.githubusercontent.com/u/46891309?v=4","gravatar_id":"","url":"https://api.github.com/users/bapcltd-marv","html_url":"https://github.com/bapcltd-marv","followers_url":"https://api.github.com/users/bapcltd-marv/followers","following_url":"https://api.github.com/users/bapcltd-marv/following{/other_user}","gists_url":"https://api.github.com/users/bapcltd-marv/gists{/gist_id}","starred_url":"https://api.github.com/users/bapcltd-marv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bapcltd-marv/subscriptions","organizations_url":"https://api.github.com/users/bapcltd-marv/orgs","repos_url":"https://api.github.com/users/bapcltd-marv/repos","events_url":"https://api.github.com/users/bapcltd-marv/events{/privacy}","received_events_url":"https://api.github.com/users/bapcltd-marv/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"731fcc0d08c83db79e570c742a1b72061721c4a4","commit_url":"https://api.github.com/repos/bapcltd/php-imap/commits/731fcc0d08c83db79e570c742a1b72061721c4a4","created_at":"2020-01-15T11:58:28Z","performed_via_github_app":null},{"id":2950555675,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI5NTA1NTU2NzU=","url":"https://api.github.com/repos/vimeo/psalm/issues/events/2950555675","actor":{"login":"bapcltd-marv","id":46891309,"node_id":"MDQ6VXNlcjQ2ODkxMzA5","avatar_url":"https://avatars.githubusercontent.com/u/46891309?v=4","gravatar_id":"","url":"https://api.github.com/users/bapcltd-marv","html_url":"https://github.com/bapcltd-marv","followers_url":"https://api.github.com/users/bapcltd-marv/followers","following_url":"https://api.github.com/users/bapcltd-marv/following{/other_user}","gists_url":"https://api.github.com/users/bapcltd-marv/gists{/gist_id}","starred_url":"https://api.github.com/users/bapcltd-marv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bapcltd-marv/subscriptions","organizations_url":"https://api.github.com/users/bapcltd-marv/orgs","repos_url":"https://api.github.com/users/bapcltd-marv/repos","events_url":"https://api.github.com/users/bapcltd-marv/events{/privacy}","received_events_url":"https://api.github.com/users/bapcltd-marv/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"bdb7cecb96f54e174dc416160f61abaeef0d1d76","commit_url":"https://api.github.com/repos/bapcltd/php-imap/commits/bdb7cecb96f54e174dc416160f61abaeef0d1d76","created_at":"2020-01-15T12:05:01Z","performed_via_github_app":null},{"id":2950570908,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI5NTA1NzA5MDg=","url":"https://api.github.com/repos/vimeo/psalm/issues/events/2950570908","actor":{"login":"bapcltd-marv","id":46891309,"node_id":"MDQ6VXNlcjQ2ODkxMzA5","avatar_url":"https://avatars.githubusercontent.com/u/46891309?v=4","gravatar_id":"","url":"https://api.github.com/users/bapcltd-marv","html_url":"https://github.com/bapcltd-marv","followers_url":"https://api.github.com/users/bapcltd-marv/followers","following_url":"https://api.github.com/users/bapcltd-marv/following{/other_user}","gists_url":"https://api.github.com/users/bapcltd-marv/gists{/gist_id}","starred_url":"https://api.github.com/users/bapcltd-marv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bapcltd-marv/subscriptions","organizations_url":"https://api.github.com/users/bapcltd-marv/orgs","repos_url":"https://api.github.com/users/bapcltd-marv/repos","events_url":"https://api.github.com/users/bapcltd-marv/events{/privacy}","received_events_url":"https://api.github.com/users/bapcltd-marv/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"a819d61c9ddfcaca0b35b91a7fc51f0fc57b5124","commit_url":"https://api.github.com/repos/bapcltd/php-imap/commits/a819d61c9ddfcaca0b35b91a7fc51f0fc57b5124","created_at":"2020-01-15T12:10:46Z","performed_via_github_app":null},{"id":2950590628,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI5NTA1OTA2Mjg=","url":"https://api.github.com/repos/vimeo/psalm/issues/events/2950590628","actor":{"login":"bapcltd-marv","id":46891309,"node_id":"MDQ6VXNlcjQ2ODkxMzA5","avatar_url":"https://avatars.githubusercontent.com/u/46891309?v=4","gravatar_id":"","url":"https://api.github.com/users/bapcltd-marv","html_url":"https://github.com/bapcltd-marv","followers_url":"https://api.github.com/users/bapcltd-marv/followers","following_url":"https://api.github.com/users/bapcltd-marv/following{/other_user}","gists_url":"https://api.github.com/users/bapcltd-marv/gists{/gist_id}","starred_url":"https://api.github.com/users/bapcltd-marv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bapcltd-marv/subscriptions","organizations_url":"https://api.github.com/users/bapcltd-marv/orgs","repos_url":"https://api.github.com/users/bapcltd-marv/repos","events_url":"https://api.github.com/users/bapcltd-marv/events{/privacy}","received_events_url":"https://api.github.com/users/bapcltd-marv/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"b01369f6d0ff6079027d9fc416161c4be77944f4","commit_url":"https://api.github.com/repos/bapcltd/php-imap/commits/b01369f6d0ff6079027d9fc416161c4be77944f4","created_at":"2020-01-15T12:18:10Z","performed_via_github_app":null},{"id":2950602952,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI5NTA2MDI5NTI=","url":"https://api.github.com/repos/vimeo/psalm/issues/events/2950602952","actor":{"login":"bapcltd-marv","id":46891309,"node_id":"MDQ6VXNlcjQ2ODkxMzA5","avatar_url":"https://avatars.githubusercontent.com/u/46891309?v=4","gravatar_id":"","url":"https://api.github.com/users/bapcltd-marv","html_url":"https://github.com/bapcltd-marv","followers_url":"https://api.github.com/users/bapcltd-marv/followers","following_url":"https://api.github.com/users/bapcltd-marv/following{/other_user}","gists_url":"https://api.github.com/users/bapcltd-marv/gists{/gist_id}","starred_url":"https://api.github.com/users/bapcltd-marv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bapcltd-marv/subscriptions","organizations_url":"https://api.github.com/users/bapcltd-marv/orgs","repos_url":"https://api.github.com/users/bapcltd-marv/repos","events_url":"https://api.github.com/users/bapcltd-marv/events{/privacy}","received_events_url":"https://api.github.com/users/bapcltd-marv/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"658822a2bf4cf20882cd0017d65752d5070f9a65","commit_url":"https://api.github.com/repos/bapcltd/php-imap/commits/658822a2bf4cf20882cd0017d65752d5070f9a65","created_at":"2020-01-15T12:22:48Z","performed_via_github_app":null},{"id":2950782914,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI5NTA3ODI5MTQ=","url":"https://api.github.com/repos/vimeo/psalm/issues/events/2950782914","actor":{"login":"bapcltd-marv","id":46891309,"node_id":"MDQ6VXNlcjQ2ODkxMzA5","avatar_url":"https://avatars.githubusercontent.com/u/46891309?v=4","gravatar_id":"","url":"https://api.github.com/users/bapcltd-marv","html_url":"https://github.com/bapcltd-marv","followers_url":"https://api.github.com/users/bapcltd-marv/followers","following_url":"https://api.github.com/users/bapcltd-marv/following{/other_user}","gists_url":"https://api.github.com/users/bapcltd-marv/gists{/gist_id}","starred_url":"https://api.github.com/users/bapcltd-marv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bapcltd-marv/subscriptions","organizations_url":"https://api.github.com/users/bapcltd-marv/orgs","repos_url":"https://api.github.com/users/bapcltd-marv/repos","events_url":"https://api.github.com/users/bapcltd-marv/events{/privacy}","received_events_url":"https://api.github.com/users/bapcltd-marv/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"559da89a11446e12f838d8f18f6c479cf2b80c4e","commit_url":"https://api.github.com/repos/bapcltd/php-imap/commits/559da89a11446e12f838d8f18f6c479cf2b80c4e","created_at":"2020-01-15T13:25:34Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/574659702","html_url":"https://github.com/vimeo/psalm/issues/2626#issuecomment-574659702","issue_url":"https://api.github.com/repos/vimeo/psalm/issues/2626","id":574659702,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NDY1OTcwMg==","user":{"login":"weirdan","id":57403,"node_id":"MDQ6VXNlcjU3NDAz","avatar_url":"https://avatars.githubusercontent.com/u/57403?v=4","gravatar_id":"","url":"https://api.github.com/users/weirdan","html_url":"https://github.com/weirdan","followers_url":"https://api.github.com/users/weirdan/followers","following_url":"https://api.github.com/users/weirdan/following{/other_user}","gists_url":"https://api.github.com/users/weirdan/gists{/gist_id}","starred_url":"https://api.github.com/users/weirdan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weirdan/subscriptions","organizations_url":"https://api.github.com/users/weirdan/orgs","repos_url":"https://api.github.com/users/weirdan/repos","events_url":"https://api.github.com/users/weirdan/events{/privacy}","received_events_url":"https://api.github.com/users/weirdan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-15T13:29:21Z","updated_at":"2020-01-15T13:29:21Z","body":"Related: #2266 ","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/574659702/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"weirdan","id":57403,"node_id":"MDQ6VXNlcjU3NDAz","avatar_url":"https://avatars.githubusercontent.com/u/57403?v=4","gravatar_id":"","url":"https://api.github.com/users/weirdan","html_url":"https://github.com/weirdan","followers_url":"https://api.github.com/users/weirdan/followers","following_url":"https://api.github.com/users/weirdan/following{/other_user}","gists_url":"https://api.github.com/users/weirdan/gists{/gist_id}","starred_url":"https://api.github.com/users/weirdan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weirdan/subscriptions","organizations_url":"https://api.github.com/users/weirdan/orgs","repos_url":"https://api.github.com/users/weirdan/repos","events_url":"https://api.github.com/users/weirdan/events{/privacy}","received_events_url":"https://api.github.com/users/weirdan/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/574665269","html_url":"https://github.com/vimeo/psalm/issues/2626#issuecomment-574665269","issue_url":"https://api.github.com/repos/vimeo/psalm/issues/2626","id":574665269,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NDY2NTI2OQ==","user":{"login":"SignpostMarv","id":304403,"node_id":"MDQ6VXNlcjMwNDQwMw==","avatar_url":"https://avatars.githubusercontent.com/u/304403?v=4","gravatar_id":"","url":"https://api.github.com/users/SignpostMarv","html_url":"https://github.com/SignpostMarv","followers_url":"https://api.github.com/users/SignpostMarv/followers","following_url":"https://api.github.com/users/SignpostMarv/following{/other_user}","gists_url":"https://api.github.com/users/SignpostMarv/gists{/gist_id}","starred_url":"https://api.github.com/users/SignpostMarv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SignpostMarv/subscriptions","organizations_url":"https://api.github.com/users/SignpostMarv/orgs","repos_url":"https://api.github.com/users/SignpostMarv/repos","events_url":"https://api.github.com/users/SignpostMarv/events{/privacy}","received_events_url":"https://api.github.com/users/SignpostMarv/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-15T13:43:41Z","updated_at":"2020-01-15T13:43:41Z","body":"suggestion: `open-resource` pseudo-type, `true` branch of `is_resource()` condition nudges variable/parameter from `resource` to `open-resource` ?","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/574665269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"SignpostMarv","id":304403,"node_id":"MDQ6VXNlcjMwNDQwMw==","avatar_url":"https://avatars.githubusercontent.com/u/304403?v=4","gravatar_id":"","url":"https://api.github.com/users/SignpostMarv","html_url":"https://github.com/SignpostMarv","followers_url":"https://api.github.com/users/SignpostMarv/followers","following_url":"https://api.github.com/users/SignpostMarv/following{/other_user}","gists_url":"https://api.github.com/users/SignpostMarv/gists{/gist_id}","starred_url":"https://api.github.com/users/SignpostMarv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SignpostMarv/subscriptions","organizations_url":"https://api.github.com/users/SignpostMarv/orgs","repos_url":"https://api.github.com/users/SignpostMarv/repos","events_url":"https://api.github.com/users/SignpostMarv/events{/privacy}","received_events_url":"https://api.github.com/users/SignpostMarv/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/574735752","html_url":"https://github.com/vimeo/psalm/issues/2626#issuecomment-574735752","issue_url":"https://api.github.com/repos/vimeo/psalm/issues/2626","id":574735752,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NDczNTc1Mg==","user":{"login":"TysonAndre","id":1904430,"node_id":"MDQ6VXNlcjE5MDQ0MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1904430?v=4","gravatar_id":"","url":"https://api.github.com/users/TysonAndre","html_url":"https://github.com/TysonAndre","followers_url":"https://api.github.com/users/TysonAndre/followers","following_url":"https://api.github.com/users/TysonAndre/following{/other_user}","gists_url":"https://api.github.com/users/TysonAndre/gists{/gist_id}","starred_url":"https://api.github.com/users/TysonAndre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TysonAndre/subscriptions","organizations_url":"https://api.github.com/users/TysonAndre/orgs","repos_url":"https://api.github.com/users/TysonAndre/repos","events_url":"https://api.github.com/users/TysonAndre/events{/privacy}","received_events_url":"https://api.github.com/users/TysonAndre/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-15T16:20:15Z","updated_at":"2020-01-15T16:20:15Z","body":"And fopen()'s signatures (etc.) could be changed to return open-resource.\r\nAnother possibility: Emit a different issue type or none at all for is_resource() \r\n\r\nThis wouldn't solve the original issue, but changing the input argument to closed-resource via plugin or otherwise for native functions such as fclose(), curl_close(), etc and warning about passing closed-resource would detect some bugs.\r\n\r\nHowever, using resources directly is probably uncommon outside of composer libraries such as http clients.\r\n\r\nAnalyzing $this->file_handle across methods might also be error-prone","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/574735752/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"TysonAndre","id":1904430,"node_id":"MDQ6VXNlcjE5MDQ0MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1904430?v=4","gravatar_id":"","url":"https://api.github.com/users/TysonAndre","html_url":"https://github.com/TysonAndre","followers_url":"https://api.github.com/users/TysonAndre/followers","following_url":"https://api.github.com/users/TysonAndre/following{/other_user}","gists_url":"https://api.github.com/users/TysonAndre/gists{/gist_id}","starred_url":"https://api.github.com/users/TysonAndre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TysonAndre/subscriptions","organizations_url":"https://api.github.com/users/TysonAndre/orgs","repos_url":"https://api.github.com/users/TysonAndre/repos","events_url":"https://api.github.com/users/TysonAndre/events{/privacy}","received_events_url":"https://api.github.com/users/TysonAndre/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2951930436,"node_id":"MDEyOkxhYmVsZWRFdmVudDI5NTE5MzA0MzY=","url":"https://api.github.com/repos/vimeo/psalm/issues/events/2951930436","actor":{"login":"muglug","id":2292638,"node_id":"MDQ6VXNlcjIyOTI2Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2292638?v=4","gravatar_id":"","url":"https://api.github.com/users/muglug","html_url":"https://github.com/muglug","followers_url":"https://api.github.com/users/muglug/followers","following_url":"https://api.github.com/users/muglug/following{/other_user}","gists_url":"https://api.github.com/users/muglug/gists{/gist_id}","starred_url":"https://api.github.com/users/muglug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muglug/subscriptions","organizations_url":"https://api.github.com/users/muglug/orgs","repos_url":"https://api.github.com/users/muglug/repos","events_url":"https://api.github.com/users/muglug/events{/privacy}","received_events_url":"https://api.github.com/users/muglug/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-01-15T18:52:48Z","label":{"name":"bug","color":"ee0701"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/575292924","html_url":"https://github.com/vimeo/psalm/issues/2626#issuecomment-575292924","issue_url":"https://api.github.com/repos/vimeo/psalm/issues/2626","id":575292924,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTI5MjkyNA==","user":{"login":"SignpostMarv","id":304403,"node_id":"MDQ6VXNlcjMwNDQwMw==","avatar_url":"https://avatars.githubusercontent.com/u/304403?v=4","gravatar_id":"","url":"https://api.github.com/users/SignpostMarv","html_url":"https://github.com/SignpostMarv","followers_url":"https://api.github.com/users/SignpostMarv/followers","following_url":"https://api.github.com/users/SignpostMarv/following{/other_user}","gists_url":"https://api.github.com/users/SignpostMarv/gists{/gist_id}","starred_url":"https://api.github.com/users/SignpostMarv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SignpostMarv/subscriptions","organizations_url":"https://api.github.com/users/SignpostMarv/orgs","repos_url":"https://api.github.com/users/SignpostMarv/repos","events_url":"https://api.github.com/users/SignpostMarv/events{/privacy}","received_events_url":"https://api.github.com/users/SignpostMarv/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-16T18:53:42Z","updated_at":"2020-01-16T18:53:42Z","body":"currently tinkering with this, but the param change doesn't seem to stick so I'm guessing it's not the right place to make the change?\r\n\r\n```diff\r\ndiff --git a/src/Psalm/Internal/Analyzer/FunctionAnalyzer.php b/src/Psalm/Internal/Analyzer/FunctionAnalyzer.php\r\nindex 9a86bc7a..b2e5e002 100644\r\n--- a/src/Psalm/Internal/Analyzer/FunctionAnalyzer.php\r\n+++ b/src/Psalm/Internal/Analyzer/FunctionAnalyzer.php\r\n@@ -325,6 +325,49 @@ class FunctionAnalyzer extends FunctionLikeAnalyzer\r\n                     // Really this should only work on instances we've created with new Foo(),\r\n                     // but that requires more work\r\n                     break;\r\n+                case 'is_resource':\r\n+                    if (isset($call_args[0])) {\r\n+                        $first_arg_type = $statements_analyzer->node_data->getType($call_args[0]->value);\r\n+\r\n+                        if ($first_arg_type) {\r\n+                            $is_already_closed = $codebase->isTypeContainedByType(\r\n+                                $first_arg_type,\r\n+                                new Type\\Union([new Type\\Atomic\\TResourceClosed])\r\n+                            );\r\n+\r\n+                            if ($is_already_closed) {\r\n+                                return Type::getFalse();\r\n+                            }\r\n+                        }\r\n+                    }\r\n+                    break;\r\n+                case 'fclose':\r\n+                    if (isset($call_args[0])) {\r\n+                        $first_arg_type = $statements_analyzer->node_data->getType($call_args[0]->value);\r\n+\r\n+                        if ($first_arg_type) {\r\n+                            $is_already_closed = $codebase->isTypeContainedByType(\r\n+                                $first_arg_type,\r\n+                                new Type\\Union([new Type\\Atomic\\TResourceClosed, new Type\\Atomic\\TFalse])\r\n+                            );\r\n+\r\n+                            if ($is_already_closed) {\r\n+                                return Type::getFalse();\r\n+                            }\r\n+\r\n+                            $is_expected_type = $codebase->isTypeContainedByType(\r\n+                                $first_arg_type,\r\n+                                new Type\\Union([new Type\\Atomic\\TResource])\r\n+                            );\r\n+\r\n+                            if ($is_expected_type) {\r\n+                                $first_arg_type = $statements_analyzer->node_data->setType($call_args[0]->value, Type::getClosedResource());\r\n+\r\n+                                return Type::getBool();\r\n+                            }\r\n+                        }\r\n+                    }\r\n+                    break;\r\n             }\r\n         }\r\n\r\n```\r\n\r\ntesting against:\r\n\r\n```php\r\n<?php\r\n$fp = tmpfile();\r\n\r\nfclose($fp); // should set $fp to new Union([new TResourceClosed])\r\n\r\nif (fclose($fp)) { // expected to be a redundant condition\r\n    echo 'foo';\r\n} else {\r\n    echo 'bar';\r\n}\r\n\r\nif (is_resource($fp)) { // expected to be a redundant condition\r\n    echo 'foo';\r\n} else {\r\n    echo 'bar';\r\n}\r\n\r\n```","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/575292924/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"SignpostMarv","id":304403,"node_id":"MDQ6VXNlcjMwNDQwMw==","avatar_url":"https://avatars.githubusercontent.com/u/304403?v=4","gravatar_id":"","url":"https://api.github.com/users/SignpostMarv","html_url":"https://github.com/SignpostMarv","followers_url":"https://api.github.com/users/SignpostMarv/followers","following_url":"https://api.github.com/users/SignpostMarv/following{/other_user}","gists_url":"https://api.github.com/users/SignpostMarv/gists{/gist_id}","starred_url":"https://api.github.com/users/SignpostMarv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SignpostMarv/subscriptions","organizations_url":"https://api.github.com/users/SignpostMarv/orgs","repos_url":"https://api.github.com/users/SignpostMarv/repos","events_url":"https://api.github.com/users/SignpostMarv/events{/privacy}","received_events_url":"https://api.github.com/users/SignpostMarv/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2958830726,"node_id":"MDExOkNsb3NlZEV2ZW50Mjk1ODgzMDcyNg==","url":"https://api.github.com/repos/vimeo/psalm/issues/events/2958830726","actor":{"login":"muglug","id":2292638,"node_id":"MDQ6VXNlcjIyOTI2Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2292638?v=4","gravatar_id":"","url":"https://api.github.com/users/muglug","html_url":"https://github.com/muglug","followers_url":"https://api.github.com/users/muglug/followers","following_url":"https://api.github.com/users/muglug/following{/other_user}","gists_url":"https://api.github.com/users/muglug/gists{/gist_id}","starred_url":"https://api.github.com/users/muglug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muglug/subscriptions","organizations_url":"https://api.github.com/users/muglug/orgs","repos_url":"https://api.github.com/users/muglug/repos","events_url":"https://api.github.com/users/muglug/events{/privacy}","received_events_url":"https://api.github.com/users/muglug/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"7f093ca8ede10720a74631efe7921694b17d9fb3","commit_url":"https://api.github.com/repos/vimeo/psalm/commits/7f093ca8ede10720a74631efe7921694b17d9fb3","created_at":"2020-01-17T16:55:22Z","state_reason":null,"performed_via_github_app":null},{"id":12924977922,"node_id":"REFE_lADOBG8K984gybNEzwAAAAMCY4MC","url":"https://api.github.com/repos/vimeo/psalm/issues/events/12924977922","actor":{"login":"markovlatkovic","id":170489575,"node_id":"U_kgDOCil25w","avatar_url":"https://avatars.githubusercontent.com/u/170489575?v=4","gravatar_id":"","url":"https://api.github.com/users/markovlatkovic","html_url":"https://github.com/markovlatkovic","followers_url":"https://api.github.com/users/markovlatkovic/followers","following_url":"https://api.github.com/users/markovlatkovic/following{/other_user}","gists_url":"https://api.github.com/users/markovlatkovic/gists{/gist_id}","starred_url":"https://api.github.com/users/markovlatkovic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markovlatkovic/subscriptions","organizations_url":"https://api.github.com/users/markovlatkovic/orgs","repos_url":"https://api.github.com/users/markovlatkovic/repos","events_url":"https://api.github.com/users/markovlatkovic/events{/privacy}","received_events_url":"https://api.github.com/users/markovlatkovic/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"89be9f2c24af955ccd487fc7e1b782fd72ad3bb6","commit_url":"https://api.github.com/repos/markovlatkovic/php-imap/commits/89be9f2c24af955ccd487fc7e1b782fd72ad3bb6","created_at":"2024-05-24T13:16:58Z","performed_via_github_app":null},{"id":17992306827,"node_id":"REFE_lADOBG8K984gybNEzwAAAAQwbNCL","url":"https://api.github.com/repos/vimeo/psalm/issues/events/17992306827","actor":{"login":"Patrici97","id":203193406,"node_id":"U_kgDODBx8Pg","avatar_url":"https://avatars.githubusercontent.com/u/203193406?v=4","gravatar_id":"","url":"https://api.github.com/users/Patrici97","html_url":"https://github.com/Patrici97","followers_url":"https://api.github.com/users/Patrici97/followers","following_url":"https://api.github.com/users/Patrici97/following{/other_user}","gists_url":"https://api.github.com/users/Patrici97/gists{/gist_id}","starred_url":"https://api.github.com/users/Patrici97/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Patrici97/subscriptions","organizations_url":"https://api.github.com/users/Patrici97/orgs","repos_url":"https://api.github.com/users/Patrici97/repos","events_url":"https://api.github.com/users/Patrici97/events{/privacy}","received_events_url":"https://api.github.com/users/Patrici97/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"daad7e900e00f9cdbb1b41ba3029ede5580184d5","commit_url":"https://api.github.com/repos/Patrici97/php-imap/commits/daad7e900e00f9cdbb1b41ba3029ede5580184d5","created_at":"2025-06-05T03:00:51Z","performed_via_github_app":null}]