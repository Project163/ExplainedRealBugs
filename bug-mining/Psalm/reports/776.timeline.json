[{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/649056522","html_url":"https://github.com/vimeo/psalm/issues/3668#issuecomment-649056522","issue_url":"https://api.github.com/repos/vimeo/psalm/issues/3668","id":649056522,"node_id":"MDEyOklzc3VlQ29tbWVudDY0OTA1NjUyMg==","user":{"login":"psalm-github-bot[bot]","id":58627613,"node_id":"MDM6Qm90NTg2Mjc2MTM=","avatar_url":"https://avatars.githubusercontent.com/in/48546?v=4","gravatar_id":"","url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D","html_url":"https://github.com/apps/psalm-github-bot","followers_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/followers","following_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/repos","events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2020-06-24T20:35:04Z","updated_at":"2020-06-24T20:35:04Z","body":"I found these snippets:\n<details>\n<summary>https://psalm.dev/r/22857fa662</summary>\n\n```php\n<?php // --taint-analysis\n\n// Adding an (at)property string $taint would make psalm properly warn about this.\nclass Magic {\n    private $_params = [];\n    public function __set(string $a, $value) {\n        $this->_params[$a] = $value;\n    }\n    public function __get(string $a) {\n        return $this->_params[$a];\n    }\n}\n$m = new Magic();\n$m->taint = $_GET['input'];\necho $m->taint;\n// There is no edge from Magic::$taint to echo. There's an edge from magic::__get to echo, though\n```\n\n```\nPsalm output (using commit de85e7c):\n\nNo issues!\n```\n</details>\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/649056522/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"psalm-github-bot[bot]","id":58627613,"node_id":"MDM6Qm90NTg2Mjc2MTM=","avatar_url":"https://avatars.githubusercontent.com/in/48546?v=4","gravatar_id":"","url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D","html_url":"https://github.com/apps/psalm-github-bot","followers_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/followers","following_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/repos","events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false}},{"id":3479450410,"node_id":"MDEyOkxhYmVsZWRFdmVudDM0Nzk0NTA0MTA=","url":"https://api.github.com/repos/vimeo/psalm/issues/events/3479450410","actor":{"login":"muglug","id":2292638,"node_id":"MDQ6VXNlcjIyOTI2Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2292638?v=4","gravatar_id":"","url":"https://api.github.com/users/muglug","html_url":"https://github.com/muglug","followers_url":"https://api.github.com/users/muglug/followers","following_url":"https://api.github.com/users/muglug/following{/other_user}","gists_url":"https://api.github.com/users/muglug/gists{/gist_id}","starred_url":"https://api.github.com/users/muglug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muglug/subscriptions","organizations_url":"https://api.github.com/users/muglug/orgs","repos_url":"https://api.github.com/users/muglug/repos","events_url":"https://api.github.com/users/muglug/events{/privacy}","received_events_url":"https://api.github.com/users/muglug/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-06-24T21:24:31Z","label":{"name":"bug","color":"ee0701"},"performed_via_github_app":null},{"id":3480281634,"node_id":"MDExOkNsb3NlZEV2ZW50MzQ4MDI4MTYzNA==","url":"https://api.github.com/repos/vimeo/psalm/issues/events/3480281634","actor":{"login":"muglug","id":2292638,"node_id":"MDQ6VXNlcjIyOTI2Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2292638?v=4","gravatar_id":"","url":"https://api.github.com/users/muglug","html_url":"https://github.com/muglug","followers_url":"https://api.github.com/users/muglug/followers","following_url":"https://api.github.com/users/muglug/following{/other_user}","gists_url":"https://api.github.com/users/muglug/gists{/gist_id}","starred_url":"https://api.github.com/users/muglug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muglug/subscriptions","organizations_url":"https://api.github.com/users/muglug/orgs","repos_url":"https://api.github.com/users/muglug/repos","events_url":"https://api.github.com/users/muglug/events{/privacy}","received_events_url":"https://api.github.com/users/muglug/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"b84cf74754b5cda977689e49967077047a50dd1f","commit_url":"https://api.github.com/repos/vimeo/psalm/commits/b84cf74754b5cda977689e49967077047a50dd1f","created_at":"2020-06-25T04:24:42Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/676594990","html_url":"https://github.com/vimeo/psalm/issues/3668#issuecomment-676594990","issue_url":"https://api.github.com/repos/vimeo/psalm/issues/3668","id":676594990,"node_id":"MDEyOklzc3VlQ29tbWVudDY3NjU5NDk5MA==","user":{"login":"TysonAndre","id":1904430,"node_id":"MDQ6VXNlcjE5MDQ0MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1904430?v=4","gravatar_id":"","url":"https://api.github.com/users/TysonAndre","html_url":"https://github.com/TysonAndre","followers_url":"https://api.github.com/users/TysonAndre/followers","following_url":"https://api.github.com/users/TysonAndre/following{/other_user}","gists_url":"https://api.github.com/users/TysonAndre/gists{/gist_id}","starred_url":"https://api.github.com/users/TysonAndre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TysonAndre/subscriptions","organizations_url":"https://api.github.com/users/TysonAndre/orgs","repos_url":"https://api.github.com/users/TysonAndre/repos","events_url":"https://api.github.com/users/TysonAndre/events{/privacy}","received_events_url":"https://api.github.com/users/TysonAndre/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-19T18:41:27Z","updated_at":"2020-08-19T18:41:27Z","body":"> Expected: If a property with name `foo` is set to an unsafe value, then psalm should warn about reads from `foo` being tainted, but not properties with other names such as `other`, whether or not there is an `@property` tag\r\n\r\n```\r\nERROR: TaintedInput - src/dynamic.php:15:10 - Detected tainted html (see https://psalm.dev/205)\r\n  $_GET\r\n    <no known location>\r\n\r\n  $_GET['unsafe'] - src/dynamic.php:14:13\r\n    $a->x = $_GET['unsafe'];\r\n\r\n  call to X::__set - src/dynamic.php:14:13\r\n    $a->x = $_GET['unsafe'];\r\n\r\n  X::__set#2 - src/dynamic.php:9:41\r\n    public function __set(string $name, $value): void {\r\n\r\n  $this->params[$name] - src/dynamic.php:10:9\r\n        $this->params[$name] = $value;\r\n\r\n  X::$params - src/dynamic.php:10:9\r\n        $this->params[$name] = $value;\r\n\r\n  X::$params\r\n    <no known location>\r\n\r\n  X::$params - src/dynamic.php:7:23\r\n        return $this->params[$name];\r\n\r\n  $this->params[$name] - src/dynamic.php:7:16\r\n        return $this->params[$name];\r\n\r\n  X::__get - src/dynamic.php:6:21\r\n    public function __get(string $name) {\r\n\r\n  call to echo - src/dynamic.php:15:10\r\n    echo $b->y;\r\n\r\n```\r\n\r\n```php\r\n<?php\r\nclass X {\r\n    private $params = [];\r\n\r\n    /** @return mixed */\r\n    public function __get(string $name) {\r\n        return $this->params[$name];\r\n    }\r\n    public function __set(string $name, $value): void {\r\n        $this->params[$name] = $value;\r\n    }\r\n}\r\nfunction test(X $a, X $b) {\r\n    $a->x = $_GET['unsafe'];\r\n    echo $b->y;\r\n}\r\n```\r\n\r\nI'd been hoping for a way to track taintedness of individual magic properties, even with an annotation or a stub class - here, it seems like $this->params is marked as tainted, so tainting a single property marks other properties as tainted.\r\n\r\nWould automatically creating entries for dynamic properties be possible through a plugin/config setting/annotation at runtime before the taintedness is added? Would that conflict with psalm's threading(multiprocessing) support?","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/676594990/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"TysonAndre","id":1904430,"node_id":"MDQ6VXNlcjE5MDQ0MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1904430?v=4","gravatar_id":"","url":"https://api.github.com/users/TysonAndre","html_url":"https://github.com/TysonAndre","followers_url":"https://api.github.com/users/TysonAndre/followers","following_url":"https://api.github.com/users/TysonAndre/following{/other_user}","gists_url":"https://api.github.com/users/TysonAndre/gists{/gist_id}","starred_url":"https://api.github.com/users/TysonAndre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TysonAndre/subscriptions","organizations_url":"https://api.github.com/users/TysonAndre/orgs","repos_url":"https://api.github.com/users/TysonAndre/repos","events_url":"https://api.github.com/users/TysonAndre/events{/privacy}","received_events_url":"https://api.github.com/users/TysonAndre/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/676598520","html_url":"https://github.com/vimeo/psalm/issues/3668#issuecomment-676598520","issue_url":"https://api.github.com/repos/vimeo/psalm/issues/3668","id":676598520,"node_id":"MDEyOklzc3VlQ29tbWVudDY3NjU5ODUyMA==","user":{"login":"TysonAndre","id":1904430,"node_id":"MDQ6VXNlcjE5MDQ0MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1904430?v=4","gravatar_id":"","url":"https://api.github.com/users/TysonAndre","html_url":"https://github.com/TysonAndre","followers_url":"https://api.github.com/users/TysonAndre/followers","following_url":"https://api.github.com/users/TysonAndre/following{/other_user}","gists_url":"https://api.github.com/users/TysonAndre/gists{/gist_id}","starred_url":"https://api.github.com/users/TysonAndre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TysonAndre/subscriptions","organizations_url":"https://api.github.com/users/TysonAndre/orgs","repos_url":"https://api.github.com/users/TysonAndre/repos","events_url":"https://api.github.com/users/TysonAndre/events{/privacy}","received_events_url":"https://api.github.com/users/TysonAndre/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-19T18:49:05Z","updated_at":"2020-08-19T18:49:05Z","body":"```\r\n- `PropertyExistenceProviderInterface` - can be used to override Psalm's builtin property existence checks for one or more classes.\r\n```\r\n\r\nThat might be what I want","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/676598520/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"TysonAndre","id":1904430,"node_id":"MDQ6VXNlcjE5MDQ0MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1904430?v=4","gravatar_id":"","url":"https://api.github.com/users/TysonAndre","html_url":"https://github.com/TysonAndre","followers_url":"https://api.github.com/users/TysonAndre/followers","following_url":"https://api.github.com/users/TysonAndre/following{/other_user}","gists_url":"https://api.github.com/users/TysonAndre/gists{/gist_id}","starred_url":"https://api.github.com/users/TysonAndre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TysonAndre/subscriptions","organizations_url":"https://api.github.com/users/TysonAndre/orgs","repos_url":"https://api.github.com/users/TysonAndre/repos","events_url":"https://api.github.com/users/TysonAndre/events{/privacy}","received_events_url":"https://api.github.com/users/TysonAndre/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/676606185","html_url":"https://github.com/vimeo/psalm/issues/3668#issuecomment-676606185","issue_url":"https://api.github.com/repos/vimeo/psalm/issues/3668","id":676606185,"node_id":"MDEyOklzc3VlQ29tbWVudDY3NjYwNjE4NQ==","user":{"login":"TysonAndre","id":1904430,"node_id":"MDQ6VXNlcjE5MDQ0MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1904430?v=4","gravatar_id":"","url":"https://api.github.com/users/TysonAndre","html_url":"https://github.com/TysonAndre","followers_url":"https://api.github.com/users/TysonAndre/followers","following_url":"https://api.github.com/users/TysonAndre/following{/other_user}","gists_url":"https://api.github.com/users/TysonAndre/gists{/gist_id}","starred_url":"https://api.github.com/users/TysonAndre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TysonAndre/subscriptions","organizations_url":"https://api.github.com/users/TysonAndre/orgs","repos_url":"https://api.github.com/users/TysonAndre/repos","events_url":"https://api.github.com/users/TysonAndre/events{/privacy}","received_events_url":"https://api.github.com/users/TysonAndre/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-19T19:05:18Z","updated_at":"2020-08-19T19:05:18Z","body":"It's possible to do this in a plugin, basing it on tests/Config/Plugin/Hook/FooPropertyProvider.php, if the __get and __set are deliberately no-op stubs in a stub class\r\n\r\n\r\n```php\r\n    /**\r\n     * @return ?bool\r\n     * @override\r\n     */\r\n    public static function doesPropertyExist(\r\n        string $fq_classlike_name,\r\n        string $property_name,\r\n        bool $read_mode,\r\n        StatementsSource $source = null,\r\n        Context $context = null,\r\n        CodeLocation $code_location = null\r\n    ) {\r\n        // Pretending all magic properties exist and are declared so that individual property names taintedness will be checked separately.\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @return ?bool\r\n     * @override\r\n     */\r\n    public static function isPropertyVisible(\r\n        StatementsSource $source,\r\n        string $fq_classlike_name,\r\n        string $property_name,\r\n        bool $read_mode,\r\n        Context $context = null,\r\n        CodeLocation $code_location = null\r\n    ) {\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @return ?Type\\Union\r\n     * @override\r\n     */\r\n    public static function getPropertyType(\r\n        string $fq_classlike_name,\r\n        string $property_name,\r\n        bool $read_mode,\r\n        StatementsSource $source = null,\r\n        Context $context = null\r\n    ) {\r\n        return Type::getMixed();\r\n    }\r\n\r\n```","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/676606185/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"TysonAndre","id":1904430,"node_id":"MDQ6VXNlcjE5MDQ0MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1904430?v=4","gravatar_id":"","url":"https://api.github.com/users/TysonAndre","html_url":"https://github.com/TysonAndre","followers_url":"https://api.github.com/users/TysonAndre/followers","following_url":"https://api.github.com/users/TysonAndre/following{/other_user}","gists_url":"https://api.github.com/users/TysonAndre/gists{/gist_id}","starred_url":"https://api.github.com/users/TysonAndre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TysonAndre/subscriptions","organizations_url":"https://api.github.com/users/TysonAndre/orgs","repos_url":"https://api.github.com/users/TysonAndre/repos","events_url":"https://api.github.com/users/TysonAndre/events{/privacy}","received_events_url":"https://api.github.com/users/TysonAndre/received_events","type":"User","user_view_type":"public","site_admin":false}}]