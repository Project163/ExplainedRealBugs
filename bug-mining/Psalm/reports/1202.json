{"url":"https://api.github.com/repos/vimeo/psalm/issues/8141","repository_url":"https://api.github.com/repos/vimeo/psalm","labels_url":"https://api.github.com/repos/vimeo/psalm/issues/8141/labels{/name}","comments_url":"https://api.github.com/repos/vimeo/psalm/issues/8141/comments","events_url":"https://api.github.com/repos/vimeo/psalm/issues/8141/events","html_url":"https://github.com/vimeo/psalm/issues/8141","id":1279863743,"node_id":"I_kwDOBG8K985MSSu_","number":8141,"title":"Bug : Uncaught RuntimeException: PHP Error: Undefined offset: 0 on clean code","user":{"login":"mazerti","id":97521738,"node_id":"U_kgDOBdAQSg","avatar_url":"https://avatars.githubusercontent.com/u/97521738?v=4","gravatar_id":"","url":"https://api.github.com/users/mazerti","html_url":"https://github.com/mazerti","followers_url":"https://api.github.com/users/mazerti/followers","following_url":"https://api.github.com/users/mazerti/following{/other_user}","gists_url":"https://api.github.com/users/mazerti/gists{/gist_id}","starred_url":"https://api.github.com/users/mazerti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mazerti/subscriptions","organizations_url":"https://api.github.com/users/mazerti/orgs","repos_url":"https://api.github.com/users/mazerti/repos","events_url":"https://api.github.com/users/mazerti/events{/privacy}","received_events_url":"https://api.github.com/users/mazerti/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":486061586,"node_id":"MDU6TGFiZWw0ODYwNjE1ODY=","url":"https://api.github.com/repos/vimeo/psalm/labels/bug","name":"bug","color":"ee0701","default":true,"description":null},{"id":3081263289,"node_id":"MDU6TGFiZWwzMDgxMjYzMjg5","url":"https://api.github.com/repos/vimeo/psalm/labels/causes%20crash","name":"causes crash","color":"A80503","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"AndrolGenhald","id":7794502,"node_id":"MDQ6VXNlcjc3OTQ1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7794502?v=4","gravatar_id":"","url":"https://api.github.com/users/AndrolGenhald","html_url":"https://github.com/AndrolGenhald","followers_url":"https://api.github.com/users/AndrolGenhald/followers","following_url":"https://api.github.com/users/AndrolGenhald/following{/other_user}","gists_url":"https://api.github.com/users/AndrolGenhald/gists{/gist_id}","starred_url":"https://api.github.com/users/AndrolGenhald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndrolGenhald/subscriptions","organizations_url":"https://api.github.com/users/AndrolGenhald/orgs","repos_url":"https://api.github.com/users/AndrolGenhald/repos","events_url":"https://api.github.com/users/AndrolGenhald/events{/privacy}","received_events_url":"https://api.github.com/users/AndrolGenhald/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"AndrolGenhald","id":7794502,"node_id":"MDQ6VXNlcjc3OTQ1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7794502?v=4","gravatar_id":"","url":"https://api.github.com/users/AndrolGenhald","html_url":"https://github.com/AndrolGenhald","followers_url":"https://api.github.com/users/AndrolGenhald/followers","following_url":"https://api.github.com/users/AndrolGenhald/following{/other_user}","gists_url":"https://api.github.com/users/AndrolGenhald/gists{/gist_id}","starred_url":"https://api.github.com/users/AndrolGenhald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndrolGenhald/subscriptions","organizations_url":"https://api.github.com/users/AndrolGenhald/orgs","repos_url":"https://api.github.com/users/AndrolGenhald/repos","events_url":"https://api.github.com/users/AndrolGenhald/events{/privacy}","received_events_url":"https://api.github.com/users/AndrolGenhald/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":4,"created_at":"2022-06-22T09:41:38Z","updated_at":"2022-06-27T07:35:31Z","closed_at":"2022-06-26T11:47:56Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I found this which looks like a bug on windows : when I run `vendor\\bin\\psalm --init` on a blank project with only psalm installed (latest version) an the following code I get an Error :\r\n\r\nCode :\r\n```\r\n<?php\r\n/**\r\n * Allow the setup page to load and perform its checks (including the check about the required extensions)\r\n */\r\nif (!class_exists('DOMDocument'))\r\n{\r\n\t/**\r\n\t * Class DOMDocument\r\n\t */\r\n\tclass DOMDocument {\r\n\t\tfunction __construct(){throw new Exception('The dom extension is not enabled');}\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n * Allow the setup page to load and perform its checks (including the check about the required extensions)\r\n */\r\nif (!class_exists('DOMElement'))\r\n{\r\n\t/**\r\n\t * Class DOMElement\r\n\t */\r\n\tclass DOMElement {\r\n\t\tfunction __construct(){throw new Exception('The dom extension is not enabled');}\r\n\t}\r\n}\r\n```\r\n\r\nError :\r\n```\r\nC:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test>vendor\\bin\\psalm --init\r\nCalculating best config level based on project files\r\nTarget PHP version: 7.4 (inferred from current PHP version)\r\nScanning files...\r\nAnalyzing files...\r\n\r\nUncaught RuntimeException: PHP Error: Undefined offset: 0 in C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\vimeo\\psalm\\src\\Psalm\\Internal\\Analyzer\\FunctionLikeAnalyzer.php:1274 in C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\vimeo\\psalm\\src\\Psalm\\Internal\\ErrorHandler.php:66\r\nStack trace:\r\n#0 C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\vimeo\\psalm\\src\\Psalm\\Internal\\Analyzer\\FunctionLikeAnalyzer.php(1274): Psalm\\Internal\\ErrorHandler::Psalm\\Internal\\{closure}(8, 'Undefined offse...', 'C:\\\\Users\\\\Titoua...', 1274, Array)\r\n#1 C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\vimeo\\psalm\\src\\Psalm\\Internal\\Analyzer\\FunctionLikeAnalyzer.php(358): Psalm\\Internal\\Analyzer\\FunctionLikeAnalyzer->processParams(Object(Psalm\\Internal\\Analyzer\\StatementsAnalyzer), Object(Psalm\\Storage\\MethodStorage), 'DOMElement::__c...', Array, Array, Object(Psalm\\Context), false)\r\n#2 C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\vimeo\\psalm\\src\\Psalm\\Internal\\Analyzer\\ClassAnalyzer.php(1787): Psalm\\Internal\\Analyzer\\FunctionLikeAnalyzer->analyze(Object(Psalm\\Context), Object(Psalm\\Internal\\Provider\\NodeDataProvider), NULL)\r\n#3 C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\vimeo\\psalm\\src\\Psalm\\Internal\\Analyzer\\ClassAnalyzer.php(424): Psalm\\Internal\\Analyzer\\ClassAnalyzer->analyzeClassMethod(Object(PhpParser\\Node\\Stmt\\ClassMethod), Object(Psalm\\Storage\\ClassLikeStorage), Object(Psalm\\Internal\\Analyzer\\ClassAnalyzer), Object(Psalm\\Context), NULL)\r\n#4 C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\vimeo\\psalm\\src\\Psalm\\Internal\\Analyzer\\StatementsAnalyzer.php(591): Psalm\\Internal\\Analyzer\\ClassAnalyzer->analyze(Object(Psalm\\Context), NULL)\r\n#5 C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\vimeo\\psalm\\src\\Psalm\\Internal\\Analyzer\\StatementsAnalyzer.php(206): Psalm\\Internal\\Analyzer\\StatementsAnalyzer::analyzeStatement(Object(Psalm\\Internal\\Analyzer\\StatementsAnalyzer), Object(PhpParser\\Node\\Stmt\\Class_), Object(Psalm\\Context), NULL)\r\n#6 C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\vimeo\\psalm\\src\\Psalm\\Internal\\Analyzer\\Statements\\Block\\IfElse\\IfAnalyzer.php(68): Psalm\\Internal\\Analyzer\\StatementsAnalyzer->analyze(Array, Object(Psalm\\Context))\r\n#7 C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\vimeo\\psalm\\src\\Psalm\\Internal\\Analyzer\\Statements\\Block\\IfElseAnalyzer.php(365): Psalm\\Internal\\Analyzer\\Statements\\Block\\IfElse\\IfAnalyzer::analyze(Object(Psalm\\Internal\\Analyzer\\StatementsAnalyzer), Object(PhpParser\\Node\\Stmt\\If_), Object(Psalm\\Internal\\Scope\\IfScope), Object(Psalm\\Internal\\Scope\\IfConditionalScope), Object(Psalm\\Context), Object(Psalm\\Context), Object(Psalm\\Context), Array)\r\n#8 C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\vimeo\\psalm\\src\\Psalm\\Internal\\Analyzer\\StatementsAnalyzer.php(517): Psalm\\Internal\\Analyzer\\Statements\\Block\\IfElseAnalyzer::analyze(Object(Psalm\\Internal\\Analyzer\\StatementsAnalyzer), Object(PhpParser\\Node\\Stmt\\If_), Object(Psalm\\Context))\r\n#9 C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\vimeo\\psalm\\src\\Psalm\\Internal\\Analyzer\\StatementsAnalyzer.php(206): Psalm\\Internal\\Analyzer\\StatementsAnalyzer::analyzeStatement(Object(Psalm\\Internal\\Analyzer\\StatementsAnalyzer), Object(PhpParser\\Node\\Stmt\\If_), Object(Psalm\\Context), NULL)\r\n#10 C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\vimeo\\psalm\\src\\Psalm\\Internal\\Analyzer\\FileAnalyzer.php(205): Psalm\\Internal\\Analyzer\\StatementsAnalyzer->analyze(Array, Object(Psalm\\Context), NULL, true)\r\n#11 C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\vimeo\\psalm\\src\\Psalm\\Internal\\Codebase\\Analyzer.php(362): Psalm\\Internal\\Analyzer\\FileAnalyzer->analyze()\r\n#12 C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\vimeo\\psalm\\src\\Psalm\\Internal\\Codebase\\Analyzer.php(619): Psalm\\Internal\\Codebase\\Analyzer->Psalm\\Internal\\Codebase\\{closure}(0, 'C:\\\\Users\\\\Titoua...')\r\n#13 C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\vimeo\\psalm\\src\\Psalm\\Internal\\Codebase\\Analyzer.php(291): Psalm\\Internal\\Codebase\\Analyzer->doAnalysis(Object(Psalm\\Internal\\Analyzer\\ProjectAnalyzer), 1)\r\n#14 C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\vimeo\\psalm\\src\\Psalm\\Internal\\Analyzer\\ProjectAnalyzer.php(685): Psalm\\Internal\\Codebase\\Analyzer->analyzeFiles(Object(Psalm\\Internal\\Analyzer\\ProjectAnalyzer), 1, false, true)\r\n#15 C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\vimeo\\psalm\\src\\Psalm\\Internal\\Cli\\Psalm.php(373): Psalm\\Internal\\Analyzer\\ProjectAnalyzer->check('C:\\\\Users\\\\Titoua...', true)\r\n#16 C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\vimeo\\psalm\\psalm(6): Psalm\\Internal\\Cli\\Psalm::run(Array)\r\n#17 C:\\Users\\mazerti\\Documents\\static_analysis\\Psalm\\test\\vendor\\bin\\psalm(112): include('C:\\\\Users\\\\Titoua...')\r\n#18 {main}\r\n(Psalm 4.23.0@f1fe6ff483bf325c803df9f510d09a03fd796f88 crashed due to an uncaught Throwable)\r\n```\r\n\r\nNote : The same appear when I run psalm after having manually added a config file. Surprisingly enough, I get no Issue on the website : https://psalm.dev/r/c7e6b8bdcd","closed_by":{"login":"orklah","id":9605520,"node_id":"MDQ6VXNlcjk2MDU1MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9605520?v=4","gravatar_id":"","url":"https://api.github.com/users/orklah","html_url":"https://github.com/orklah","followers_url":"https://api.github.com/users/orklah/followers","following_url":"https://api.github.com/users/orklah/following{/other_user}","gists_url":"https://api.github.com/users/orklah/gists{/gist_id}","starred_url":"https://api.github.com/users/orklah/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/orklah/subscriptions","organizations_url":"https://api.github.com/users/orklah/orgs","repos_url":"https://api.github.com/users/orklah/repos","events_url":"https://api.github.com/users/orklah/events{/privacy}","received_events_url":"https://api.github.com/users/orklah/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/8141/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vimeo/psalm/issues/8141/timeline","performed_via_github_app":null,"state_reason":"completed"}