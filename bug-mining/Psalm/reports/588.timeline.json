[{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/604713075","html_url":"https://github.com/vimeo/psalm/issues/3027#issuecomment-604713075","issue_url":"https://api.github.com/repos/vimeo/psalm/issues/3027","id":604713075,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNDcxMzA3NQ==","user":{"login":"psalm-github-bot[bot]","id":58627613,"node_id":"MDM6Qm90NTg2Mjc2MTM=","avatar_url":"https://avatars.githubusercontent.com/in/48546?v=4","gravatar_id":"","url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D","html_url":"https://github.com/apps/psalm-github-bot","followers_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/followers","following_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/repos","events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2020-03-26T22:09:26Z","updated_at":"2020-03-26T22:09:26Z","body":"I found these snippets:\n<details>\n<summary>https://psalm.dev/r/33c0431227</summary>\n\n```php\n<?php\n\n\n/**\n * @template I as array-key\n * @template K as array-key\n * @template V\n */\nclass Converter\n{\n    /**\n     * @var Generator<I,array<K,V>,mixed,void>\n     */\n    protected $records;\n\n    /**\n     * @param Generator<I,array<K,V>,mixed,void> $records\n     */\n    public function __construct(Generator $records)\n    {\n        $this->records = $records;\n    }\n}\n\n/**\n * @template I as array-key\n * @template T\n */\nclass Collector\n{\n    /**\n     * @var Generator<I,T,mixed,void>\n     */\n    protected $records;\n    \n    /**\n     * @param Generator<I,T,mixed,void> $records\n     */\n    public function __construct(Generator $records)\n    {\n        $this->records = $records;\n    }\n}\n\n/**\n * @template I as array-key\n * @template K as array-key\n * @template V\n *\n * @extends Collector<I,array<K, V>>\n */\nclass Selector extends Collector\n{\n    /**\n     * @param Generator<I,array<K,V>,mixed,void> $records\n     */\n    public function __construct(Generator $records)\n    {\n        parent::__construct($records);\n    }\n    \n    /**\n     * @return Converter<I,K,V>\n     */\n    public function f()\n    {\n        return new Converter($this->records);\n    }\n}\n\n/**\n * @template I as array-key\n * @template K as array-key\n * @template V\n */\nclass Selector2\n{\n    /**\n     * @var Generator<I,array<K,V>,mixed,void>\n     */\n    private $records;\n    \n    /**\n     * @param Generator<I,array<K,V>,mixed,void> $records\n     */\n    public function __construct(Generator $records)\n    {\n        $this->records = $records;\n    }\n    \n    /**\n     * @return Converter<I,K,V>\n     */\n    public function f()\n    {\n        return new Converter($this->records);\n    }\n}\n```\n\n```\nPsalm output (using commit 7543253):\n\nERROR: InvalidReturnStatement - 67:16 - The inferred type 'Converter<array-key, K:Selector as array-key, V:Selector as mixed>' does not match the declared return type 'Converter<I:Selector as array-key, K:Selector as array-key, V:Selector as mixed>' for Selector::f\n```\n</details>\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/604713075/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"psalm-github-bot[bot]","id":58627613,"node_id":"MDM6Qm90NTg2Mjc2MTM=","avatar_url":"https://avatars.githubusercontent.com/in/48546?v=4","gravatar_id":"","url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D","html_url":"https://github.com/apps/psalm-github-bot","followers_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/followers","following_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/repos","events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false}},{"id":3174198737,"node_id":"MDEyOkxhYmVsZWRFdmVudDMxNzQxOTg3Mzc=","url":"https://api.github.com/repos/vimeo/psalm/issues/events/3174198737","actor":{"login":"muglug","id":2292638,"node_id":"MDQ6VXNlcjIyOTI2Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2292638?v=4","gravatar_id":"","url":"https://api.github.com/users/muglug","html_url":"https://github.com/muglug","followers_url":"https://api.github.com/users/muglug/followers","following_url":"https://api.github.com/users/muglug/following{/other_user}","gists_url":"https://api.github.com/users/muglug/gists{/gist_id}","starred_url":"https://api.github.com/users/muglug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muglug/subscriptions","organizations_url":"https://api.github.com/users/muglug/orgs","repos_url":"https://api.github.com/users/muglug/repos","events_url":"https://api.github.com/users/muglug/events{/privacy}","received_events_url":"https://api.github.com/users/muglug/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-03-27T21:48:24Z","label":{"name":"bug","color":"ee0701"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/605329385","html_url":"https://github.com/vimeo/psalm/issues/3027#issuecomment-605329385","issue_url":"https://api.github.com/repos/vimeo/psalm/issues/3027","id":605329385,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNTMyOTM4NQ==","user":{"login":"muglug","id":2292638,"node_id":"MDQ6VXNlcjIyOTI2Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2292638?v=4","gravatar_id":"","url":"https://api.github.com/users/muglug","html_url":"https://github.com/muglug","followers_url":"https://api.github.com/users/muglug/followers","following_url":"https://api.github.com/users/muglug/following{/other_user}","gists_url":"https://api.github.com/users/muglug/gists{/gist_id}","starred_url":"https://api.github.com/users/muglug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muglug/subscriptions","organizations_url":"https://api.github.com/users/muglug/orgs","repos_url":"https://api.github.com/users/muglug/repos","events_url":"https://api.github.com/users/muglug/events{/privacy}","received_events_url":"https://api.github.com/users/muglug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-03-27T21:48:32Z","updated_at":"2020-03-27T22:13:12Z","body":"Simplified to\r\n\r\n```php\r\n/**\r\n * @template I as array-key\r\n */\r\nclass Foo {\r\n    /** @var I */\r\n    protected $collection;\r\n    \r\n    /** @param I $collection */\r\n    public function __construct($collection) {\r\n        $this->collection = $collection;\r\n    }\r\n}\r\n\r\n/**\r\n * @template I2 as array-key\r\n *\r\n * @extends Foo<I2>\r\n */\r\nclass FooChild extends Foo\r\n{\r\n    /** @return I2 */\r\n    public function getCollection() {\r\n        return $this->collection;\r\n    }\r\n}\r\n```","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/605329385/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"muglug","id":2292638,"node_id":"MDQ6VXNlcjIyOTI2Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2292638?v=4","gravatar_id":"","url":"https://api.github.com/users/muglug","html_url":"https://github.com/muglug","followers_url":"https://api.github.com/users/muglug/followers","following_url":"https://api.github.com/users/muglug/following{/other_user}","gists_url":"https://api.github.com/users/muglug/gists{/gist_id}","starred_url":"https://api.github.com/users/muglug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muglug/subscriptions","organizations_url":"https://api.github.com/users/muglug/orgs","repos_url":"https://api.github.com/users/muglug/repos","events_url":"https://api.github.com/users/muglug/events{/privacy}","received_events_url":"https://api.github.com/users/muglug/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3174290750,"node_id":"MDExOkNsb3NlZEV2ZW50MzE3NDI5MDc1MA==","url":"https://api.github.com/repos/vimeo/psalm/issues/events/3174290750","actor":{"login":"muglug","id":2292638,"node_id":"MDQ6VXNlcjIyOTI2Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2292638?v=4","gravatar_id":"","url":"https://api.github.com/users/muglug","html_url":"https://github.com/muglug","followers_url":"https://api.github.com/users/muglug/followers","following_url":"https://api.github.com/users/muglug/following{/other_user}","gists_url":"https://api.github.com/users/muglug/gists{/gist_id}","starred_url":"https://api.github.com/users/muglug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muglug/subscriptions","organizations_url":"https://api.github.com/users/muglug/orgs","repos_url":"https://api.github.com/users/muglug/repos","events_url":"https://api.github.com/users/muglug/events{/privacy}","received_events_url":"https://api.github.com/users/muglug/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"056f4aaac6ed8006a561ebb9f973f4a910e4a7d4","commit_url":"https://api.github.com/repos/vimeo/psalm/commits/056f4aaac6ed8006a561ebb9f973f4a910e4a7d4","created_at":"2020-03-27T22:31:57Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/605363508","html_url":"https://github.com/vimeo/psalm/issues/3027#issuecomment-605363508","issue_url":"https://api.github.com/repos/vimeo/psalm/issues/3027","id":605363508,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNTM2MzUwOA==","user":{"login":"vasily-kartashov","id":875698,"node_id":"MDQ6VXNlcjg3NTY5OA==","avatar_url":"https://avatars.githubusercontent.com/u/875698?v=4","gravatar_id":"","url":"https://api.github.com/users/vasily-kartashov","html_url":"https://github.com/vasily-kartashov","followers_url":"https://api.github.com/users/vasily-kartashov/followers","following_url":"https://api.github.com/users/vasily-kartashov/following{/other_user}","gists_url":"https://api.github.com/users/vasily-kartashov/gists{/gist_id}","starred_url":"https://api.github.com/users/vasily-kartashov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vasily-kartashov/subscriptions","organizations_url":"https://api.github.com/users/vasily-kartashov/orgs","repos_url":"https://api.github.com/users/vasily-kartashov/repos","events_url":"https://api.github.com/users/vasily-kartashov/events{/privacy}","received_events_url":"https://api.github.com/users/vasily-kartashov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-03-28T00:08:28Z","updated_at":"2020-03-28T00:08:28Z","body":"Thank you!","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/605363508/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"vasily-kartashov","id":875698,"node_id":"MDQ6VXNlcjg3NTY5OA==","avatar_url":"https://avatars.githubusercontent.com/u/875698?v=4","gravatar_id":"","url":"https://api.github.com/users/vasily-kartashov","html_url":"https://github.com/vasily-kartashov","followers_url":"https://api.github.com/users/vasily-kartashov/followers","following_url":"https://api.github.com/users/vasily-kartashov/following{/other_user}","gists_url":"https://api.github.com/users/vasily-kartashov/gists{/gist_id}","starred_url":"https://api.github.com/users/vasily-kartashov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vasily-kartashov/subscriptions","organizations_url":"https://api.github.com/users/vasily-kartashov/orgs","repos_url":"https://api.github.com/users/vasily-kartashov/repos","events_url":"https://api.github.com/users/vasily-kartashov/events{/privacy}","received_events_url":"https://api.github.com/users/vasily-kartashov/received_events","type":"User","user_view_type":"public","site_admin":false}}]