{"url":"https://api.github.com/repos/vimeo/psalm/issues/8457","repository_url":"https://api.github.com/repos/vimeo/psalm","labels_url":"https://api.github.com/repos/vimeo/psalm/issues/8457/labels{/name}","comments_url":"https://api.github.com/repos/vimeo/psalm/issues/8457/comments","events_url":"https://api.github.com/repos/vimeo/psalm/issues/8457/events","html_url":"https://github.com/vimeo/psalm/issues/8457","id":1361221798,"node_id":"I_kwDOBG8K985RIpim","number":8457,"title":"InvalidReturnType are reported for stubs","user":{"login":"kkmuffme","id":11071985,"node_id":"MDQ6VXNlcjExMDcxOTg1","avatar_url":"https://avatars.githubusercontent.com/u/11071985?v=4","gravatar_id":"","url":"https://api.github.com/users/kkmuffme","html_url":"https://github.com/kkmuffme","followers_url":"https://api.github.com/users/kkmuffme/followers","following_url":"https://api.github.com/users/kkmuffme/following{/other_user}","gists_url":"https://api.github.com/users/kkmuffme/gists{/gist_id}","starred_url":"https://api.github.com/users/kkmuffme/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kkmuffme/subscriptions","organizations_url":"https://api.github.com/users/kkmuffme/orgs","repos_url":"https://api.github.com/users/kkmuffme/repos","events_url":"https://api.github.com/users/kkmuffme/events{/privacy}","received_events_url":"https://api.github.com/users/kkmuffme/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":486061588,"node_id":"MDU6TGFiZWw0ODYwNjE1ODg=","url":"https://api.github.com/repos/vimeo/psalm/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2022-09-04T18:34:27Z","updated_at":"2022-09-22T18:17:19Z","closed_at":"2022-09-22T18:17:19Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I have a project where a function exists both in the stubs AND in the code to analyze (basically: overwriting a function/method, but also for cases where psalm is unable to infer/load files due to how paths are loaded)\r\n\r\nIn my file I have this (just a mock example):\r\nhttps://psalm.dev/r/e7f20deb65\r\n\r\nProblem:\r\nas this function exists in my stubs too, Psalm now reports this error for the stubs file - which gets suppressed (since errors in stubs file paths are suppressed by psalm by default)\r\nTherefore this error never shows up.\r\n\r\nWhy this is a problem?\r\nPsalm always takes the phpdoc from the stubs as truth (this is fine/good). It then uses the code (not stubs) to check if the code matches the phpdoc.\r\nIn this case however, it would make much more sense to report the error not for the stubs but for the file where it checks the code in.\r\n\r\nI remember I had a similar issue a long time ago, when I got started with psalm, so I think this is not an isolated issue with InvalidReturnType\r\n\r\nEDIT: this affects all (but only) PHPDoc issues for functions. While most of them get reported for both the stubs + the file the issue is in, InvalidReturnType and MissingParamType get only reported for the stubs.\r\nBut e.g. InvalidDocblock is reported for both (stubs and the file)\r\n","closed_by":{"login":"orklah","id":9605520,"node_id":"MDQ6VXNlcjk2MDU1MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9605520?v=4","gravatar_id":"","url":"https://api.github.com/users/orklah","html_url":"https://github.com/orklah","followers_url":"https://api.github.com/users/orklah/followers","following_url":"https://api.github.com/users/orklah/following{/other_user}","gists_url":"https://api.github.com/users/orklah/gists{/gist_id}","starred_url":"https://api.github.com/users/orklah/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/orklah/subscriptions","organizations_url":"https://api.github.com/users/orklah/orgs","repos_url":"https://api.github.com/users/orklah/repos","events_url":"https://api.github.com/users/orklah/events{/privacy}","received_events_url":"https://api.github.com/users/orklah/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/8457/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vimeo/psalm/issues/8457/timeline","performed_via_github_app":null,"state_reason":"completed"}