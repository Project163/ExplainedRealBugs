{"url":"https://api.github.com/repos/vimeo/psalm/issues/3365","repository_url":"https://api.github.com/repos/vimeo/psalm","labels_url":"https://api.github.com/repos/vimeo/psalm/issues/3365/labels{/name}","comments_url":"https://api.github.com/repos/vimeo/psalm/issues/3365/comments","events_url":"https://api.github.com/repos/vimeo/psalm/issues/3365/events","html_url":"https://github.com/vimeo/psalm/issues/3365","id":618643835,"node_id":"MDU6SXNzdWU2MTg2NDM4MzU=","number":3365,"title":"cannot implicitly use if to make sure a string is actually a non-empty-string","user":{"login":"still-dreaming-1","id":354296,"node_id":"MDQ6VXNlcjM1NDI5Ng==","avatar_url":"https://avatars.githubusercontent.com/u/354296?v=4","gravatar_id":"","url":"https://api.github.com/users/still-dreaming-1","html_url":"https://github.com/still-dreaming-1","followers_url":"https://api.github.com/users/still-dreaming-1/followers","following_url":"https://api.github.com/users/still-dreaming-1/following{/other_user}","gists_url":"https://api.github.com/users/still-dreaming-1/gists{/gist_id}","starred_url":"https://api.github.com/users/still-dreaming-1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/still-dreaming-1/subscriptions","organizations_url":"https://api.github.com/users/still-dreaming-1/orgs","repos_url":"https://api.github.com/users/still-dreaming-1/repos","events_url":"https://api.github.com/users/still-dreaming-1/events{/privacy}","received_events_url":"https://api.github.com/users/still-dreaming-1/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2020-05-15T02:01:13Z","updated_at":"2020-05-15T02:29:24Z","closed_at":"2020-05-15T02:09:43Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I recently discovered that Psalm has the non-empty-string and non-empty-array types. It is so great that Psalm has these! Most type systems are missing these, which is terrible, because conceptually an empty string doesn't make any sense, because conceptually an empty string is not actually a string, it is conceptually the same as null. I mean if you have a string that is empty, what is it a string of? It is not  a string of characters or bytes, it is just nothing. You could make a similar argument about an empty array. Therefore, in my opinion, using arrays or strings instead of non-empty-array or non-empty-string is a code smell. Let's say a function returns a string. You can't tell from the function signature what the API/contract of that function really is. Can it return an empty string or not? You have no idea without examining further. You could clarify this with a docblock by specifying the return type as either `non-empty-string` or as `null|non-empty-string` depending on which one represents the contract of that method. Then if it needs to return an empty string, it would return null instead, since empty strings make no sense. This has the added benefit of making you deal with that case, where it returns null, because then Psalm will probably catch when you are misusing null. Even if it didn't the fact that the function explicitly says it could return null makes the programmer more likely to think about and handle that case. This style of programming gets the programmer to deal with the edge cases in a readable and practical way, via the types. I call this type oriented programming or TOP.\r\n\r\nAnyway, that is just my way of thanking you for this, and my way of letting you know why I am planning to start using both non-empty-string and non-empty-array extensively.\r\n\r\nThe issue I'm reporting is in regards to the non-empty-string, checking `if ($something === '')` does not help Psalm understand if $something is an empty string or not. Here is an [example](https://psalm.dev/r/e71974d387). As a point of comparison, you could check `if ($something === null)` , and this does help Psalm understand if $something is null or not.","closed_by":{"login":"muglug","id":2292638,"node_id":"MDQ6VXNlcjIyOTI2Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2292638?v=4","gravatar_id":"","url":"https://api.github.com/users/muglug","html_url":"https://github.com/muglug","followers_url":"https://api.github.com/users/muglug/followers","following_url":"https://api.github.com/users/muglug/following{/other_user}","gists_url":"https://api.github.com/users/muglug/gists{/gist_id}","starred_url":"https://api.github.com/users/muglug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muglug/subscriptions","organizations_url":"https://api.github.com/users/muglug/orgs","repos_url":"https://api.github.com/users/muglug/repos","events_url":"https://api.github.com/users/muglug/events{/privacy}","received_events_url":"https://api.github.com/users/muglug/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/3365/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vimeo/psalm/issues/3365/timeline","performed_via_github_app":null,"state_reason":"completed"}