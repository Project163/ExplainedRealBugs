[{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/1138422929","html_url":"https://github.com/vimeo/psalm/issues/8018#issuecomment-1138422929","issue_url":"https://api.github.com/repos/vimeo/psalm/issues/8018","id":1138422929,"node_id":"IC_kwDOBG8K985D2vSR","user":{"login":"psalm-github-bot[bot]","id":58627613,"node_id":"MDM6Qm90NTg2Mjc2MTM=","avatar_url":"https://avatars.githubusercontent.com/in/48546?v=4","gravatar_id":"","url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D","html_url":"https://github.com/apps/psalm-github-bot","followers_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/followers","following_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/repos","events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T11:15:50Z","updated_at":"2022-05-26T11:18:11Z","body":"I found these snippets:\n<details>\n<summary>https://psalm.dev/r/f81173405a</summary>\n\n```php\n<?php\n/**\n* @psalm-type Test = string\n*/\nclass Foo\n{\n    /** @var array<string, Test> */\n\tprivate array $stuff = [];\n    \n    /**\n    * @param non-empty-list<string> $param\n    * @return Test\n    */\n    public function foo(array $param)\n    {\n        $arr = &$this->stuff[$param[0]];\t// This seems to cause Psalm to blackout.\n        \n        /** @var Test */\n        $x = $arr;\n        \n        // This trace doesn't work, and $x's type appears to be mixed at this point.\n        /** @psalm-trace $x */\n        return $x;\n    }\n}\n```\n\n```\nPsalm output (using commit b46fb14):\n\nINFO: MixedInferredReturnType - 12:15 - Could not verify return type 'string' for Foo::foo\n```\n</details>\n\n<details>\n<summary>https://psalm.dev/r/718c05c153</summary>\n\n```php\n<?php\n/**\n* @psalm-type Test = string\n*/\nclass Foo\n{\n    /** @var array<string, Test> */\n\tprivate array $stuff = [];\n    \n    /**\n    * @return Test\n    */\n    public function foo(string $param)\n    {\n        $arr = &$this->stuff[$param];\t// This seems to cause Psalm to blackout.\n        \n        /** @var Test */\n        $x = $arr;\n        \n        // This trace doesn't work, and $x's type appears to be mixed at this point.\n        /** @psalm-trace $x */\n        return $x;\n    }\n}\n```\n\n```\nPsalm output (using commit b46fb14):\n\nERROR: UnnecessaryVarAnnotation - 17:18 - The @var string annotation for $x is unnecessary\n\nINFO: Trace - 22:9 - $x: string\n```\n</details>\n\n<details>\n<summary>https://psalm.dev/r/6ebda981ae</summary>\n\n```php\n<?php\n/**\n* @psalm-type Test = string\n*/\nclass Foo\n{\n    /** @var array<string, Test> */\n\tprivate array $stuff = [];\n    \n    /**\n    * @param non-empty-list<string> $param\n    * @return Test\n    */\n    public function foo(array $param)\n    {\n        $arr = $this->stuff[$param[0]];\t// This seems to cause Psalm to blackout.\n        \n        /** @var Test */\n        $x = $arr;\n        \n        // This trace doesn't work, and $x's type appears to be mixed at this point.\n        /** @psalm-trace $x */\n        return $x;\n    }\n}\n```\n\n```\nPsalm output (using commit b46fb14):\n\nERROR: UnnecessaryVarAnnotation - 18:18 - The @var string annotation for $x is unnecessary\n\nINFO: Trace - 23:9 - $x: string\n```\n</details>\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/1138422929/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"psalm-github-bot[bot]","id":58627613,"node_id":"MDM6Qm90NTg2Mjc2MTM=","avatar_url":"https://avatars.githubusercontent.com/in/48546?v=4","gravatar_id":"","url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D","html_url":"https://github.com/apps/psalm-github-bot","followers_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/followers","following_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/repos","events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/1138686834","html_url":"https://github.com/vimeo/psalm/issues/8018#issuecomment-1138686834","issue_url":"https://api.github.com/repos/vimeo/psalm/issues/8018","id":1138686834,"node_id":"IC_kwDOBG8K985D3vty","user":{"login":"AndrolGenhald","id":7794502,"node_id":"MDQ6VXNlcjc3OTQ1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7794502?v=4","gravatar_id":"","url":"https://api.github.com/users/AndrolGenhald","html_url":"https://github.com/AndrolGenhald","followers_url":"https://api.github.com/users/AndrolGenhald/followers","following_url":"https://api.github.com/users/AndrolGenhald/following{/other_user}","gists_url":"https://api.github.com/users/AndrolGenhald/gists{/gist_id}","starred_url":"https://api.github.com/users/AndrolGenhald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndrolGenhald/subscriptions","organizations_url":"https://api.github.com/users/AndrolGenhald/orgs","repos_url":"https://api.github.com/users/AndrolGenhald/repos","events_url":"https://api.github.com/users/AndrolGenhald/events{/privacy}","received_events_url":"https://api.github.com/users/AndrolGenhald/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T15:14:17Z","updated_at":"2022-05-26T15:14:17Z","body":"Oh joy, references! References are only somewhat supported. This issue is probably my fault because I actually made references work in most cases instead of being ignored, but that caused a lot of edge cases that were previously fine to be broken.\r\n\r\nFYI that code is actually [not sound](https://3v4l.org/f63nj) (maybe your actual code is though), PHP references are [really weird](https://github.com/vimeo/psalm/pull/7339/files#r781662565) and imo should be avoided except for trivial cases, but otoh this does look like it should be a trivial case since the reference only exists locally and isn't used in an array or object. It's undoubtedly a bug that everything after that reference is just ignored.","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/1138686834/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"AndrolGenhald","id":7794502,"node_id":"MDQ6VXNlcjc3OTQ1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7794502?v=4","gravatar_id":"","url":"https://api.github.com/users/AndrolGenhald","html_url":"https://github.com/AndrolGenhald","followers_url":"https://api.github.com/users/AndrolGenhald/followers","following_url":"https://api.github.com/users/AndrolGenhald/following{/other_user}","gists_url":"https://api.github.com/users/AndrolGenhald/gists{/gist_id}","starred_url":"https://api.github.com/users/AndrolGenhald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndrolGenhald/subscriptions","organizations_url":"https://api.github.com/users/AndrolGenhald/orgs","repos_url":"https://api.github.com/users/AndrolGenhald/repos","events_url":"https://api.github.com/users/AndrolGenhald/events{/privacy}","received_events_url":"https://api.github.com/users/AndrolGenhald/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":6686423783,"node_id":"AE_lADOBG8K985KeOYOzwAAAAGOirrn","url":"https://api.github.com/repos/vimeo/psalm/issues/events/6686423783","actor":{"login":"AndrolGenhald","id":7794502,"node_id":"MDQ6VXNlcjc3OTQ1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7794502?v=4","gravatar_id":"","url":"https://api.github.com/users/AndrolGenhald","html_url":"https://github.com/AndrolGenhald","followers_url":"https://api.github.com/users/AndrolGenhald/followers","following_url":"https://api.github.com/users/AndrolGenhald/following{/other_user}","gists_url":"https://api.github.com/users/AndrolGenhald/gists{/gist_id}","starred_url":"https://api.github.com/users/AndrolGenhald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndrolGenhald/subscriptions","organizations_url":"https://api.github.com/users/AndrolGenhald/orgs","repos_url":"https://api.github.com/users/AndrolGenhald/repos","events_url":"https://api.github.com/users/AndrolGenhald/events{/privacy}","received_events_url":"https://api.github.com/users/AndrolGenhald/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2022-05-26T15:14:21Z","assignee":{"login":"AndrolGenhald","id":7794502,"node_id":"MDQ6VXNlcjc3OTQ1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7794502?v=4","gravatar_id":"","url":"https://api.github.com/users/AndrolGenhald","html_url":"https://github.com/AndrolGenhald","followers_url":"https://api.github.com/users/AndrolGenhald/followers","following_url":"https://api.github.com/users/AndrolGenhald/following{/other_user}","gists_url":"https://api.github.com/users/AndrolGenhald/gists{/gist_id}","starred_url":"https://api.github.com/users/AndrolGenhald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndrolGenhald/subscriptions","organizations_url":"https://api.github.com/users/AndrolGenhald/orgs","repos_url":"https://api.github.com/users/AndrolGenhald/repos","events_url":"https://api.github.com/users/AndrolGenhald/events{/privacy}","received_events_url":"https://api.github.com/users/AndrolGenhald/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"id":6686424587,"node_id":"LE_lADOBG8K985KeOYOzwAAAAGOir4L","url":"https://api.github.com/repos/vimeo/psalm/issues/events/6686424587","actor":{"login":"AndrolGenhald","id":7794502,"node_id":"MDQ6VXNlcjc3OTQ1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7794502?v=4","gravatar_id":"","url":"https://api.github.com/users/AndrolGenhald","html_url":"https://github.com/AndrolGenhald","followers_url":"https://api.github.com/users/AndrolGenhald/followers","following_url":"https://api.github.com/users/AndrolGenhald/following{/other_user}","gists_url":"https://api.github.com/users/AndrolGenhald/gists{/gist_id}","starred_url":"https://api.github.com/users/AndrolGenhald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndrolGenhald/subscriptions","organizations_url":"https://api.github.com/users/AndrolGenhald/orgs","repos_url":"https://api.github.com/users/AndrolGenhald/repos","events_url":"https://api.github.com/users/AndrolGenhald/events{/privacy}","received_events_url":"https://api.github.com/users/AndrolGenhald/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-05-26T15:14:29Z","label":{"name":"bug","color":"ee0701"},"performed_via_github_app":null},{"id":6686424594,"node_id":"LE_lADOBG8K985KeOYOzwAAAAGOir4S","url":"https://api.github.com/repos/vimeo/psalm/issues/events/6686424594","actor":{"login":"AndrolGenhald","id":7794502,"node_id":"MDQ6VXNlcjc3OTQ1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7794502?v=4","gravatar_id":"","url":"https://api.github.com/users/AndrolGenhald","html_url":"https://github.com/AndrolGenhald","followers_url":"https://api.github.com/users/AndrolGenhald/followers","following_url":"https://api.github.com/users/AndrolGenhald/following{/other_user}","gists_url":"https://api.github.com/users/AndrolGenhald/gists{/gist_id}","starred_url":"https://api.github.com/users/AndrolGenhald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndrolGenhald/subscriptions","organizations_url":"https://api.github.com/users/AndrolGenhald/orgs","repos_url":"https://api.github.com/users/AndrolGenhald/repos","events_url":"https://api.github.com/users/AndrolGenhald/events{/privacy}","received_events_url":"https://api.github.com/users/AndrolGenhald/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-05-26T15:14:29Z","label":{"name":"references","color":"6DD1B1"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/1138768446","html_url":"https://github.com/vimeo/psalm/issues/8018#issuecomment-1138768446","issue_url":"https://api.github.com/repos/vimeo/psalm/issues/8018","id":1138768446,"node_id":"IC_kwDOBG8K985D4Do-","user":{"login":"rzvc","id":7192924,"node_id":"MDQ6VXNlcjcxOTI5MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/7192924?v=4","gravatar_id":"","url":"https://api.github.com/users/rzvc","html_url":"https://github.com/rzvc","followers_url":"https://api.github.com/users/rzvc/followers","following_url":"https://api.github.com/users/rzvc/following{/other_user}","gists_url":"https://api.github.com/users/rzvc/gists{/gist_id}","starred_url":"https://api.github.com/users/rzvc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rzvc/subscriptions","organizations_url":"https://api.github.com/users/rzvc/orgs","repos_url":"https://api.github.com/users/rzvc/repos","events_url":"https://api.github.com/users/rzvc/events{/privacy}","received_events_url":"https://api.github.com/users/rzvc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T16:41:10Z","updated_at":"2022-05-26T16:41:10Z","body":"> FYI that code is actually [not sound](https://3v4l.org/f63nj) (maybe your actual code is though)\r\n\r\nYup, I just came up with that example to show the issue.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/1138768446/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rzvc","id":7192924,"node_id":"MDQ6VXNlcjcxOTI5MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/7192924?v=4","gravatar_id":"","url":"https://api.github.com/users/rzvc","html_url":"https://github.com/rzvc","followers_url":"https://api.github.com/users/rzvc/followers","following_url":"https://api.github.com/users/rzvc/following{/other_user}","gists_url":"https://api.github.com/users/rzvc/gists{/gist_id}","starred_url":"https://api.github.com/users/rzvc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rzvc/subscriptions","organizations_url":"https://api.github.com/users/rzvc/orgs","repos_url":"https://api.github.com/users/rzvc/repos","events_url":"https://api.github.com/users/rzvc/events{/privacy}","received_events_url":"https://api.github.com/users/rzvc/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/1138811077","html_url":"https://github.com/vimeo/psalm/issues/8018#issuecomment-1138811077","issue_url":"https://api.github.com/repos/vimeo/psalm/issues/8018","id":1138811077,"node_id":"IC_kwDOBG8K985D4ODF","user":{"login":"AndrolGenhald","id":7794502,"node_id":"MDQ6VXNlcjc3OTQ1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7794502?v=4","gravatar_id":"","url":"https://api.github.com/users/AndrolGenhald","html_url":"https://github.com/AndrolGenhald","followers_url":"https://api.github.com/users/AndrolGenhald/followers","following_url":"https://api.github.com/users/AndrolGenhald/following{/other_user}","gists_url":"https://api.github.com/users/AndrolGenhald/gists{/gist_id}","starred_url":"https://api.github.com/users/AndrolGenhald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndrolGenhald/subscriptions","organizations_url":"https://api.github.com/users/AndrolGenhald/orgs","repos_url":"https://api.github.com/users/AndrolGenhald/repos","events_url":"https://api.github.com/users/AndrolGenhald/events{/privacy}","received_events_url":"https://api.github.com/users/AndrolGenhald/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T17:10:06Z","updated_at":"2022-05-26T17:10:06Z","body":"Haven't looked at the code, but I'm guessing the reason [this](https://psalm.dev/r/ed1a4b5cdd) works but your original example doesn't has something to do with the fact that Psalm [tracks](https://psalm.dev/r/b636ed9fe4) array offset types for `array-key` variables, but it [doesn't track](https://psalm.dev/r/d4c6d40dab) array offset types when the offset is itself coming from an array.\r\n\r\nI'm guessing the solution to this (if we actually want to fix it) is to make it so the rest of the analysis continues without bothering to account for the reference. Maybe we should have some sort of `UnsupportedReferenceUsage` issue for that case so we don't have people complaining that Psalm isn't working correctly? At least that would be better than the current confusing behavior.","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/1138811077/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"AndrolGenhald","id":7794502,"node_id":"MDQ6VXNlcjc3OTQ1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7794502?v=4","gravatar_id":"","url":"https://api.github.com/users/AndrolGenhald","html_url":"https://github.com/AndrolGenhald","followers_url":"https://api.github.com/users/AndrolGenhald/followers","following_url":"https://api.github.com/users/AndrolGenhald/following{/other_user}","gists_url":"https://api.github.com/users/AndrolGenhald/gists{/gist_id}","starred_url":"https://api.github.com/users/AndrolGenhald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndrolGenhald/subscriptions","organizations_url":"https://api.github.com/users/AndrolGenhald/orgs","repos_url":"https://api.github.com/users/AndrolGenhald/repos","events_url":"https://api.github.com/users/AndrolGenhald/events{/privacy}","received_events_url":"https://api.github.com/users/AndrolGenhald/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/1138811118","html_url":"https://github.com/vimeo/psalm/issues/8018#issuecomment-1138811118","issue_url":"https://api.github.com/repos/vimeo/psalm/issues/8018","id":1138811118,"node_id":"IC_kwDOBG8K985D4ODu","user":{"login":"psalm-github-bot[bot]","id":58627613,"node_id":"MDM6Qm90NTg2Mjc2MTM=","avatar_url":"https://avatars.githubusercontent.com/in/48546?v=4","gravatar_id":"","url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D","html_url":"https://github.com/apps/psalm-github-bot","followers_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/followers","following_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/repos","events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T17:10:09Z","updated_at":"2022-05-26T17:10:09Z","body":"I found these snippets:\n<details>\n<summary>https://psalm.dev/r/ed1a4b5cdd</summary>\n\n```php\n<?php\n/**\n* @psalm-type Test = string\n*/\nclass Foo\n{\n    /** @var array<string, Test> */\n\tprivate array $stuff = [];\n    \n    /**\n    * @param non-empty-list<string> $param\n    * @return Test\n    */\n    public function foo(array $param)\n    {\n        $tmp = $param[0];\n        $arr = &$this->stuff[$tmp];\n        \n        /** @var Test */\n        $x = $arr;\n        \n        // This trace doesn't work, and $x's type appears to be mixed at this point.\n        /** @psalm-trace $x */\n        return $x;\n    }\n}\n```\n\n```\nPsalm output (using commit b46fb14):\n\nERROR: UnnecessaryVarAnnotation - 19:18 - The @var string annotation for $x is unnecessary\n\nINFO: Trace - 24:9 - $x: string\n```\n</details>\n\n<details>\n<summary>https://psalm.dev/r/b636ed9fe4</summary>\n\n```php\n<?php\n\n/** @var array<string, string> */\n$arr = [];\n\n/** @var string */\n$foo = \"foo\";\n\n$arr[$foo] = \"bar\";\n/** @psalm-trace $arr, $arr[$foo] */;\n```\n\n```\nPsalm output (using commit b46fb14):\n\nINFO: Trace - 10:37 - $arr: non-empty-array<string, string>\n\nINFO: Trace - 10:37 - $arr[$foo]: 'bar'\n```\n</details>\n\n<details>\n<summary>https://psalm.dev/r/d4c6d40dab</summary>\n\n```php\n<?php\n\n/** @var array<string, string> */\n$arr = [];\n\n/** @var non-empty-list<string> */\n$foo = [\"foo\"];\n\n$arr[$foo[0]] = \"bar\";\n/** @psalm-trace $arr, $arr[$foo[0]] */;\n$bar = $arr[$foo[0]];\n/** @psalm-trace $bar */;\n```\n\n```\nPsalm output (using commit b46fb14):\n\nINFO: Trace - 10:40 - $arr: non-empty-array<string, string>\n\nERROR: UndefinedTrace - 10:40 - Attempt to trace undefined variable $arr[$foo[0]]\n\nINFO: Trace - 12:25 - $bar: string\n```\n</details>\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/1138811118/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"psalm-github-bot[bot]","id":58627613,"node_id":"MDM6Qm90NTg2Mjc2MTM=","avatar_url":"https://avatars.githubusercontent.com/in/48546?v=4","gravatar_id":"","url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D","html_url":"https://github.com/apps/psalm-github-bot","followers_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/followers","following_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/repos","events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/psalm-github-bot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/1138993990","html_url":"https://github.com/vimeo/psalm/issues/8018#issuecomment-1138993990","issue_url":"https://api.github.com/repos/vimeo/psalm/issues/8018","id":1138993990,"node_id":"IC_kwDOBG8K985D46tG","user":{"login":"AndrolGenhald","id":7794502,"node_id":"MDQ6VXNlcjc3OTQ1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7794502?v=4","gravatar_id":"","url":"https://api.github.com/users/AndrolGenhald","html_url":"https://github.com/AndrolGenhald","followers_url":"https://api.github.com/users/AndrolGenhald/followers","following_url":"https://api.github.com/users/AndrolGenhald/following{/other_user}","gists_url":"https://api.github.com/users/AndrolGenhald/gists{/gist_id}","starred_url":"https://api.github.com/users/AndrolGenhald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndrolGenhald/subscriptions","organizations_url":"https://api.github.com/users/AndrolGenhald/orgs","repos_url":"https://api.github.com/users/AndrolGenhald/repos","events_url":"https://api.github.com/users/AndrolGenhald/events{/privacy}","received_events_url":"https://api.github.com/users/AndrolGenhald/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T20:25:16Z","updated_at":"2022-05-26T20:25:16Z","body":"Actually, any reference to an array is dangerous due to that PHP bug: https://3v4l.org/vaCAp\r\n\r\nI think I'll add a warning about that as well.","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/1138993990/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"AndrolGenhald","id":7794502,"node_id":"MDQ6VXNlcjc3OTQ1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7794502?v=4","gravatar_id":"","url":"https://api.github.com/users/AndrolGenhald","html_url":"https://github.com/AndrolGenhald","followers_url":"https://api.github.com/users/AndrolGenhald/followers","following_url":"https://api.github.com/users/AndrolGenhald/following{/other_user}","gists_url":"https://api.github.com/users/AndrolGenhald/gists{/gist_id}","starred_url":"https://api.github.com/users/AndrolGenhald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndrolGenhald/subscriptions","organizations_url":"https://api.github.com/users/AndrolGenhald/orgs","repos_url":"https://api.github.com/users/AndrolGenhald/repos","events_url":"https://api.github.com/users/AndrolGenhald/events{/privacy}","received_events_url":"https://api.github.com/users/AndrolGenhald/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/1139026439","html_url":"https://github.com/vimeo/psalm/issues/8018#issuecomment-1139026439","issue_url":"https://api.github.com/repos/vimeo/psalm/issues/8018","id":1139026439,"node_id":"IC_kwDOBG8K985D5CoH","user":{"login":"rzvc","id":7192924,"node_id":"MDQ6VXNlcjcxOTI5MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/7192924?v=4","gravatar_id":"","url":"https://api.github.com/users/rzvc","html_url":"https://github.com/rzvc","followers_url":"https://api.github.com/users/rzvc/followers","following_url":"https://api.github.com/users/rzvc/following{/other_user}","gists_url":"https://api.github.com/users/rzvc/gists{/gist_id}","starred_url":"https://api.github.com/users/rzvc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rzvc/subscriptions","organizations_url":"https://api.github.com/users/rzvc/orgs","repos_url":"https://api.github.com/users/rzvc/repos","events_url":"https://api.github.com/users/rzvc/events{/privacy}","received_events_url":"https://api.github.com/users/rzvc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T20:47:46Z","updated_at":"2022-05-26T20:47:46Z","body":"I wouldn't mind a warning with an explanation. I came up with the same solution, of copying the value at that index in a local variable.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/comments/1139026439/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rzvc","id":7192924,"node_id":"MDQ6VXNlcjcxOTI5MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/7192924?v=4","gravatar_id":"","url":"https://api.github.com/users/rzvc","html_url":"https://github.com/rzvc","followers_url":"https://api.github.com/users/rzvc/followers","following_url":"https://api.github.com/users/rzvc/following{/other_user}","gists_url":"https://api.github.com/users/rzvc/gists{/gist_id}","starred_url":"https://api.github.com/users/rzvc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rzvc/subscriptions","organizations_url":"https://api.github.com/users/rzvc/orgs","repos_url":"https://api.github.com/users/rzvc/repos","events_url":"https://api.github.com/users/rzvc/events{/privacy}","received_events_url":"https://api.github.com/users/rzvc/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":6689133476,"node_id":"REFE_lADOBG8K985KeOYOzwAAAAGOtBOk","url":"https://api.github.com/repos/vimeo/psalm/issues/events/6689133476","actor":{"login":"AndrolGenhald","id":7794502,"node_id":"MDQ6VXNlcjc3OTQ1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7794502?v=4","gravatar_id":"","url":"https://api.github.com/users/AndrolGenhald","html_url":"https://github.com/AndrolGenhald","followers_url":"https://api.github.com/users/AndrolGenhald/followers","following_url":"https://api.github.com/users/AndrolGenhald/following{/other_user}","gists_url":"https://api.github.com/users/AndrolGenhald/gists{/gist_id}","starred_url":"https://api.github.com/users/AndrolGenhald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndrolGenhald/subscriptions","organizations_url":"https://api.github.com/users/AndrolGenhald/orgs","repos_url":"https://api.github.com/users/AndrolGenhald/repos","events_url":"https://api.github.com/users/AndrolGenhald/events{/privacy}","received_events_url":"https://api.github.com/users/AndrolGenhald/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"31b4dceaf43136de0f5d753660e291dd0919a219","commit_url":"https://api.github.com/repos/AndrolGenhald/psalm/commits/31b4dceaf43136de0f5d753660e291dd0919a219","created_at":"2022-05-26T23:31:47Z","performed_via_github_app":null},{"id":6693986124,"node_id":"REFE_lADOBG8K985KeOYOzwAAAAGO_h9M","url":"https://api.github.com/repos/vimeo/psalm/issues/events/6693986124","actor":{"login":"orklah","id":9605520,"node_id":"MDQ6VXNlcjk2MDU1MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9605520?v=4","gravatar_id":"","url":"https://api.github.com/users/orklah","html_url":"https://github.com/orklah","followers_url":"https://api.github.com/users/orklah/followers","following_url":"https://api.github.com/users/orklah/following{/other_user}","gists_url":"https://api.github.com/users/orklah/gists{/gist_id}","starred_url":"https://api.github.com/users/orklah/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/orklah/subscriptions","organizations_url":"https://api.github.com/users/orklah/orgs","repos_url":"https://api.github.com/users/orklah/repos","events_url":"https://api.github.com/users/orklah/events{/privacy}","received_events_url":"https://api.github.com/users/orklah/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"ec9a9994f5b00095e60b425e8d565690cd2969ec","commit_url":"https://api.github.com/repos/vimeo/psalm/commits/ec9a9994f5b00095e60b425e8d565690cd2969ec","created_at":"2022-05-27T17:09:06Z","performed_via_github_app":null},{"id":6693997819,"node_id":"CE_lADOBG8K985KeOYOzwAAAAGO_kz7","url":"https://api.github.com/repos/vimeo/psalm/issues/events/6693997819","actor":{"login":"AndrolGenhald","id":7794502,"node_id":"MDQ6VXNlcjc3OTQ1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/7794502?v=4","gravatar_id":"","url":"https://api.github.com/users/AndrolGenhald","html_url":"https://github.com/AndrolGenhald","followers_url":"https://api.github.com/users/AndrolGenhald/followers","following_url":"https://api.github.com/users/AndrolGenhald/following{/other_user}","gists_url":"https://api.github.com/users/AndrolGenhald/gists{/gist_id}","starred_url":"https://api.github.com/users/AndrolGenhald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndrolGenhald/subscriptions","organizations_url":"https://api.github.com/users/AndrolGenhald/orgs","repos_url":"https://api.github.com/users/AndrolGenhald/repos","events_url":"https://api.github.com/users/AndrolGenhald/events{/privacy}","received_events_url":"https://api.github.com/users/AndrolGenhald/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-05-27T17:10:25Z","state_reason":null,"performed_via_github_app":null}]