{"url":"https://api.github.com/repos/vimeo/psalm/issues/3292","repository_url":"https://api.github.com/repos/vimeo/psalm","labels_url":"https://api.github.com/repos/vimeo/psalm/issues/3292/labels{/name}","comments_url":"https://api.github.com/repos/vimeo/psalm/issues/3292/comments","events_url":"https://api.github.com/repos/vimeo/psalm/issues/3292/events","html_url":"https://github.com/vimeo/psalm/issues/3292","id":611352951,"node_id":"MDU6SXNzdWU2MTEzNTI5NTE=","number":3292,"title":"IssueBuffer::finish() is not called when Psalm detects no issues","user":{"login":"weirdan","id":57403,"node_id":"MDQ6VXNlcjU3NDAz","avatar_url":"https://avatars.githubusercontent.com/u/57403?v=4","gravatar_id":"","url":"https://api.github.com/users/weirdan","html_url":"https://github.com/weirdan","followers_url":"https://api.github.com/users/weirdan/followers","following_url":"https://api.github.com/users/weirdan/following{/other_user}","gists_url":"https://api.github.com/users/weirdan/gists{/gist_id}","starred_url":"https://api.github.com/users/weirdan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weirdan/subscriptions","organizations_url":"https://api.github.com/users/weirdan/orgs","repos_url":"https://api.github.com/users/weirdan/repos","events_url":"https://api.github.com/users/weirdan/events{/privacy}","received_events_url":"https://api.github.com/users/weirdan/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-05-03T07:27:58Z","updated_at":"2020-05-03T12:44:21Z","closed_at":"2020-05-03T12:44:21Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"_Originally posted by @weirdan in https://github.com/psalm/psalm-plugin-phpunit/issues/68#issuecomment-623067968_\r\n\r\n> Turns out it's not a problem with the plugin. On the contrary, plugin is doing its job pretty well, and eliminates all issues. Psalm only calls `getOutput()` [[1]][call] if there are some issues to report [[2]][condition]. So that's a problem with Psalm that went long unnoticed (after all, there's very few projects that Psalm finds no issues in).\r\n\r\nSome output formats require something to be output even when there's no issues to report. E.g. checkstyle format requires XML preamble and an empty root element.\r\n\r\nTo reproduce:\r\n* initialize an empty project:\r\n  * `mkdir emptyproject && cd emptyproject`\r\n  * `composer init`\r\n  * `composer install --no-plugins`\r\n  * `psalm --init`\r\n* Run psalm with checkstyle output format\r\n  * `psalm --output-format=checkstyle 2>/dev/null`\r\n\r\n**Expected**: valid xml output, with preamble and `<checkstyle>` element\r\n**Actual**: no output is produced\r\n\r\n[call]: https://github.com/vimeo/psalm/blob/d99fbc0d4d64c6efcdd075560567eb9a5679391b/src/Psalm/IssueBuffer.php#L498 \"getOutput() call\"\r\n[condition]: https://github.com/vimeo/psalm/blob/d99fbc0d4d64c6efcdd075560567eb9a5679391b/src/Psalm/IssueBuffer.php#L436 \"condition\"\r\n\r\n","closed_by":{"login":"muglug","id":2292638,"node_id":"MDQ6VXNlcjIyOTI2Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2292638?v=4","gravatar_id":"","url":"https://api.github.com/users/muglug","html_url":"https://github.com/muglug","followers_url":"https://api.github.com/users/muglug/followers","following_url":"https://api.github.com/users/muglug/following{/other_user}","gists_url":"https://api.github.com/users/muglug/gists{/gist_id}","starred_url":"https://api.github.com/users/muglug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muglug/subscriptions","organizations_url":"https://api.github.com/users/muglug/orgs","repos_url":"https://api.github.com/users/muglug/repos","events_url":"https://api.github.com/users/muglug/events{/privacy}","received_events_url":"https://api.github.com/users/muglug/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/3292/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vimeo/psalm/issues/3292/timeline","performed_via_github_app":null,"state_reason":"completed"}