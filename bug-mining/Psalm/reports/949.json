{"url":"https://api.github.com/repos/vimeo/psalm/issues/4509","repository_url":"https://api.github.com/repos/vimeo/psalm","labels_url":"https://api.github.com/repos/vimeo/psalm/issues/4509/labels{/name}","comments_url":"https://api.github.com/repos/vimeo/psalm/issues/4509/comments","events_url":"https://api.github.com/repos/vimeo/psalm/issues/4509/events","html_url":"https://github.com/vimeo/psalm/issues/4509","id":738419775,"node_id":"MDU6SXNzdWU3Mzg0MTk3NzU=","number":4509,"title":"Constants incorrectly being replaced with literals causing RedundantCondition","user":{"login":"jnvsor","id":5260644,"node_id":"MDQ6VXNlcjUyNjA2NDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5260644?v=4","gravatar_id":"","url":"https://api.github.com/users/jnvsor","html_url":"https://github.com/jnvsor","followers_url":"https://api.github.com/users/jnvsor/followers","following_url":"https://api.github.com/users/jnvsor/following{/other_user}","gists_url":"https://api.github.com/users/jnvsor/gists{/gist_id}","starred_url":"https://api.github.com/users/jnvsor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jnvsor/subscriptions","organizations_url":"https://api.github.com/users/jnvsor/orgs","repos_url":"https://api.github.com/users/jnvsor/repos","events_url":"https://api.github.com/users/jnvsor/events{/privacy}","received_events_url":"https://api.github.com/users/jnvsor/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":486061586,"node_id":"MDU6TGFiZWw0ODYwNjE1ODY=","url":"https://api.github.com/repos/vimeo/psalm/labels/bug","name":"bug","color":"ee0701","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2020-11-08T08:37:50Z","updated_at":"2025-04-13T16:14:18Z","closed_at":"2025-04-13T16:14:17Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I'm seeing this issue crop up in constants used feature flags. With something like this:\r\n\r\n```php\r\n\\define('KINT_PHP70', (\\version_compare(PHP_VERSION, '7.0') >= 0));\r\n\r\nif (KINT_PHP70) {\r\n    echo \"Hello world\";\r\n}\r\n```\r\n\r\nI get a `RedundantCondition - if (true) is redundant`\r\n\r\nThe annoying thing is I can't reproduce this in the sandbox. I thought this might be because of the constants being set in a file that is loaded through composer's file autoloading, but a smaller test case didn't prove that.\r\n\r\nI've pushed the codebase that causes this to https://github.com/jnvsor/kint/tree/psalm-bug - psalm can be run with `composer analyze` (or `psalm --show-info=false`)\r\n\r\nPlease ignore the other outstanding errors, I've reported them as psalm bugs already","closed_by":{"login":"jnvsor","id":5260644,"node_id":"MDQ6VXNlcjUyNjA2NDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5260644?v=4","gravatar_id":"","url":"https://api.github.com/users/jnvsor","html_url":"https://github.com/jnvsor","followers_url":"https://api.github.com/users/jnvsor/followers","following_url":"https://api.github.com/users/jnvsor/following{/other_user}","gists_url":"https://api.github.com/users/jnvsor/gists{/gist_id}","starred_url":"https://api.github.com/users/jnvsor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jnvsor/subscriptions","organizations_url":"https://api.github.com/users/jnvsor/orgs","repos_url":"https://api.github.com/users/jnvsor/repos","events_url":"https://api.github.com/users/jnvsor/events{/privacy}","received_events_url":"https://api.github.com/users/jnvsor/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/4509/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vimeo/psalm/issues/4509/timeline","performed_via_github_app":null,"state_reason":"completed"}