{"url":"https://api.github.com/repos/vimeo/psalm/issues/2623","repository_url":"https://api.github.com/repos/vimeo/psalm","labels_url":"https://api.github.com/repos/vimeo/psalm/issues/2623/labels{/name}","comments_url":"https://api.github.com/repos/vimeo/psalm/issues/2623/comments","events_url":"https://api.github.com/repos/vimeo/psalm/issues/2623/events","html_url":"https://github.com/vimeo/psalm/issues/2623","id":549998284,"node_id":"MDU6SXNzdWU1NDk5OTgyODQ=","number":2623,"title":"UnpopulatedClasslikeException after 3.7.1 update","user":{"login":"2e3s","id":4003445,"node_id":"MDQ6VXNlcjQwMDM0NDU=","avatar_url":"https://avatars.githubusercontent.com/u/4003445?v=4","gravatar_id":"","url":"https://api.github.com/users/2e3s","html_url":"https://github.com/2e3s","followers_url":"https://api.github.com/users/2e3s/followers","following_url":"https://api.github.com/users/2e3s/following{/other_user}","gists_url":"https://api.github.com/users/2e3s/gists{/gist_id}","starred_url":"https://api.github.com/users/2e3s/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/2e3s/subscriptions","organizations_url":"https://api.github.com/users/2e3s/orgs","repos_url":"https://api.github.com/users/2e3s/repos","events_url":"https://api.github.com/users/2e3s/events{/privacy}","received_events_url":"https://api.github.com/users/2e3s/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2020-01-15T06:47:11Z","updated_at":"2020-01-16T00:45:24Z","closed_at":"2020-01-15T16:27:04Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"After updating from 3.7.0 to 3.7.1 I get an error `PHP Fatal error:  Uncaught Psalm\\Exception\\UnpopulatedClasslikeException: Cannot check inheritance - 'Enterprise\\Customers\\TransactionHandler' has not been populated yet. You may need to defer this check to a later phase`\r\nI run it like `./psalm ../code  --threads=1 --no-cache --find-dead-code=always --show-info=false` (it works with a populated cache).\r\nIt might start to appear here https://github.com/vimeo/psalm/commit/d5f4c24ee0796357f410eed54697f9e814c553d1 because since this I'm getting the error (found this commit quickly by a binary search).\r\nUnfortunately, I cannot reproduce it otherwise than on a huge private codebase.\r\nThe problem exists on master as well. I will show a stacktrace on it since it's more useful\r\n```\r\nScanning files...\r\nUncaught Psalm\\Exception\\UnpopulatedClasslikeException: Cannot check inheritance - 'Enteprise\\Customers\\TransactionHandler' has not been populated yet. You may need to defer this check to a later phase. in psalm/src/Psalm/Internal/Codebase/ClassLikes.php:499\r\nStack trace:\r\n#0 psalm/src/Psalm/Codebase.php(736): Psalm\\Internal\\Codebase\\ClassLikes->classExtends('Enteprise\\\\Custome...', 'Enteprise\\\\Custome...', true)\r\n#1 psalm/src/Psalm/Internal/Type/TypeCombination.php(1013): Psalm\\Codebase->classExtends('Enteprise\\\\Custome...', 'Enteprise\\\\Custome...')\r\n#2 psalm/src/Psalm/Internal/Type/TypeCombination.php(196): Psalm\\Internal\\Type\\TypeCombination::scrapeTypeProperties(Object(Psalm\\Type\\Atomic\\TNamedObject), Object(Psalm\\Internal\\Type\\TypeCombination), Object(Psalm\\Codebase), false, true, 500)\r\n#3 psalm/src/Psalm/Internal/Type/TypeCombination.php(522): Psalm\\Internal\\Type\\TypeCombination::combineTypes(Array, Object(Psalm\\Codebase))\r\n#4 psalm/src/Psalm/Type.php(1564): Psalm\\Internal\\Type\\TypeCombination::combineTypes(Array, Object(Psalm\\Codebase), false, true, 30)\r\n#5 psalm/src/Psalm/Internal/Analyzer/StatementsAnalyzer.php(1922): Psalm\\Type::combineUnionTypes(Object(Psalm\\Type\\Union), Object(Psalm\\Type\\Union), Object(Psalm\\Codebase), false, true, 30)\r\n#6 psalm/src/Psalm/Internal/Visitor/ReflectorVisitor.php(3356): Psalm\\Internal\\Analyzer\\StatementsAnalyzer::getSimpleType(Object(Psalm\\Codebase), Object(Psalm\\Internal\\Provider\\NodeDataProvider), Object(PhpParser\\Node\\Expr\\Array_), Object(Psalm\\Aliases), NULL, Array, 'Enteprise\\\\Custome...')\r\n#7 psalm/src/Psalm/Internal/Visitor/ReflectorVisitor.php(1307): Psalm\\Internal\\Visitor\\ReflectorVisitor->visitClassConstDeclaration(Object(PhpParser\\Node\\Stmt\\ClassConst), Object(Psalm\\Storage\\ClassLikeStorage), 'Enteprise\\\\Custome...')\r\n#8 psalm/src/Psalm/Internal/Visitor/ReflectorVisitor.php(280): Psalm\\Internal\\Visitor\\ReflectorVisitor->registerClassLike(Object(PhpParser\\Node\\Stmt\\Class_))\r\n#9 psalm/vendor/nikic/php-parser/lib/PhpParser/NodeTraverser.php(200): Psalm\\Internal\\Visitor\\ReflectorVisitor->enterNode(Object(PhpParser\\Node\\Stmt\\Class_))\r\n#10 psalm/vendor/nikic/php-parser/lib/PhpParser/NodeTraverser.php(114): PhpParser\\NodeTraverser->traverseArray(Array)\r\n#11 psalm/vendor/nikic/php-parser/lib/PhpParser/NodeTraverser.php(223): PhpParser\\NodeTraverser->traverseNode(Object(PhpParser\\Node\\Stmt\\Namespace_))\r\n#12 psalm/vendor/nikic/php-parser/lib/PhpParser/NodeTraverser.php(91): PhpParser\\NodeTraverser->traverseArray(Array)\r\n#13 psalm/src/Psalm/Internal/Scanner/FileScanner.php(96): PhpParser\\NodeTraverser->traverse(Array)\r\n#14 psalm/src/Psalm/Internal/Codebase/Scanner.php(606): Psalm\\Internal\\Scanner\\FileScanner->scan(Object(Psalm\\Codebase), Object(Psalm\\Storage\\FileStorage), false, Object(Psalm\\Progress\\DefaultProgress))\r\n#15 psalm/src/Psalm/Internal/Codebase/Scanner.php(389): Psalm\\Internal\\Codebase\\Scanner->scanFile('/home/user/Phps...', Array, true)\r\n#16 psalm/src/Psalm/Internal/Codebase/Scanner.php(497): Psalm\\Internal\\Codebase\\Scanner->Psalm\\Internal\\Codebase\\{closure}(1492, '/home/user/Phps...')\r\n#17 psalm/src/Psalm/Internal/Codebase/Scanner.php(347): Psalm\\Internal\\Codebase\\Scanner->scanFilePaths(1)\r\n#18 psalm/src/Psalm/Codebase.php(474): Psalm\\Internal\\Codebase\\Scanner->scanFiles(Object(Psalm\\Internal\\Codebase\\ClassLikes), 1)\r\n#19 psalm/src/Psalm/Internal/Analyzer/ProjectAnalyzer.php(1057): Psalm\\Codebase->scanFiles(1)\r\n#20 psalm/src/psalm.php(555): Psalm\\Internal\\Analyzer\\ProjectAnalyzer->checkPaths(Array)\r\n#21 psalm/psalm(2): require_once('/home/user/Phps...')\r\n#22 {main}\r\n(Psalm 3.x-dev@389af1bfc739bfdff3f9e3dc7bd6499aee51a831 crashed due to an uncaught Throwable)\r\n```","closed_by":{"login":"muglug","id":2292638,"node_id":"MDQ6VXNlcjIyOTI2Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2292638?v=4","gravatar_id":"","url":"https://api.github.com/users/muglug","html_url":"https://github.com/muglug","followers_url":"https://api.github.com/users/muglug/followers","following_url":"https://api.github.com/users/muglug/following{/other_user}","gists_url":"https://api.github.com/users/muglug/gists{/gist_id}","starred_url":"https://api.github.com/users/muglug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muglug/subscriptions","organizations_url":"https://api.github.com/users/muglug/orgs","repos_url":"https://api.github.com/users/muglug/repos","events_url":"https://api.github.com/users/muglug/events{/privacy}","received_events_url":"https://api.github.com/users/muglug/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/2623/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vimeo/psalm/issues/2623/timeline","performed_via_github_app":null,"state_reason":"completed"}