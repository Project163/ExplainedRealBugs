{"url":"https://api.github.com/repos/vimeo/psalm/issues/3571","repository_url":"https://api.github.com/repos/vimeo/psalm","labels_url":"https://api.github.com/repos/vimeo/psalm/issues/3571/labels{/name}","comments_url":"https://api.github.com/repos/vimeo/psalm/issues/3571/comments","events_url":"https://api.github.com/repos/vimeo/psalm/issues/3571/events","html_url":"https://github.com/vimeo/psalm/issues/3571","id":637640301,"node_id":"MDU6SXNzdWU2Mzc2NDAzMDE=","number":3571,"title":"InvalidArugment for `set_error_handler` when using `[$this, 'method']` construct","user":{"login":"theseer","id":111333,"node_id":"MDQ6VXNlcjExMTMzMw==","avatar_url":"https://avatars.githubusercontent.com/u/111333?v=4","gravatar_id":"","url":"https://api.github.com/users/theseer","html_url":"https://github.com/theseer","followers_url":"https://api.github.com/users/theseer/followers","following_url":"https://api.github.com/users/theseer/following{/other_user}","gists_url":"https://api.github.com/users/theseer/gists{/gist_id}","starred_url":"https://api.github.com/users/theseer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/theseer/subscriptions","organizations_url":"https://api.github.com/users/theseer/orgs","repos_url":"https://api.github.com/users/theseer/repos","events_url":"https://api.github.com/users/theseer/events{/privacy}","received_events_url":"https://api.github.com/users/theseer/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":486061586,"node_id":"MDU6TGFiZWw0ODYwNjE1ODY=","url":"https://api.github.com/repos/vimeo/psalm/labels/bug","name":"bug","color":"ee0701","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":16,"created_at":"2020-06-12T10:06:34Z","updated_at":"2020-06-12T21:43:33Z","closed_at":"2020-06-12T18:26:38Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"One way to specify an error handler is to pass in an array with two elements, an object or classname and a methodname:\r\n\r\n```php\r\n    // ...\r\n\r\n    private function registerLocalErrorHandler(): void {\r\n        $this->originalHandler = \\set_error_handler(\r\n            [$this, 'localErrorHandler']\r\n        );\r\n    }\r\n\r\n    public function localErrorHandler(int $errno, string $errstr): void {\r\n        throw new PharInstallerException($errstr, $errno);\r\n    }\r\n\r\n    // ...\r\n\r\n```\r\n\r\nWhen running psalm, it complains:\r\n\r\n```\r\nERROR: InvalidArgument - src/services/phar/PharInstaller.php:102:13 - Argument 1 of set_error_handler expects callable(int, string, string=, int=, array<array-key, mixed>=):bool|null, array{PharIo\\Phive\\PharInstaller&static, string(localErrorHandler)} provided (see https://psalm.dev/004)\r\n            [$this, 'localErrorHandler']\r\n```\r\n\r\nThe error is either wrong because this construct is perfectly valid or, in case psalm looks at the actual signature of the referenced method, confusingly wrong as the signature doesn't match but is technically compatible.","closed_by":{"login":"muglug","id":2292638,"node_id":"MDQ6VXNlcjIyOTI2Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2292638?v=4","gravatar_id":"","url":"https://api.github.com/users/muglug","html_url":"https://github.com/muglug","followers_url":"https://api.github.com/users/muglug/followers","following_url":"https://api.github.com/users/muglug/following{/other_user}","gists_url":"https://api.github.com/users/muglug/gists{/gist_id}","starred_url":"https://api.github.com/users/muglug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muglug/subscriptions","organizations_url":"https://api.github.com/users/muglug/orgs","repos_url":"https://api.github.com/users/muglug/repos","events_url":"https://api.github.com/users/muglug/events{/privacy}","received_events_url":"https://api.github.com/users/muglug/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/3571/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vimeo/psalm/issues/3571/timeline","performed_via_github_app":null,"state_reason":"completed"}