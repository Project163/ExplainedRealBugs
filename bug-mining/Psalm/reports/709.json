{"url":"https://api.github.com/repos/vimeo/psalm/issues/3427","repository_url":"https://api.github.com/repos/vimeo/psalm","labels_url":"https://api.github.com/repos/vimeo/psalm/issues/3427/labels{/name}","comments_url":"https://api.github.com/repos/vimeo/psalm/issues/3427/comments","events_url":"https://api.github.com/repos/vimeo/psalm/issues/3427/events","html_url":"https://github.com/vimeo/psalm/issues/3427","id":623206772,"node_id":"MDU6SXNzdWU2MjMyMDY3NzI=","number":3427,"title":"Pure functions return values","user":{"login":"dbalabka","id":1269372,"node_id":"MDQ6VXNlcjEyNjkzNzI=","avatar_url":"https://avatars.githubusercontent.com/u/1269372?v=4","gravatar_id":"","url":"https://api.github.com/users/dbalabka","html_url":"https://github.com/dbalabka","followers_url":"https://api.github.com/users/dbalabka/followers","following_url":"https://api.github.com/users/dbalabka/following{/other_user}","gists_url":"https://api.github.com/users/dbalabka/gists{/gist_id}","starred_url":"https://api.github.com/users/dbalabka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dbalabka/subscriptions","organizations_url":"https://api.github.com/users/dbalabka/orgs","repos_url":"https://api.github.com/users/dbalabka/repos","events_url":"https://api.github.com/users/dbalabka/events{/privacy}","received_events_url":"https://api.github.com/users/dbalabka/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2020-05-22T13:30:20Z","updated_at":"2020-05-23T21:03:37Z","closed_at":"2020-05-22T19:54:54Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Is it possible to memorize the returned type of pure functions and use it in the following analysis: https://psalm.dev/r/30ee2f996a ?\r\n\r\nLet's have the following pure function with nullable return type:\r\n```php\r\n<?php\r\n /**\r\n * @psalm-pure\r\n */\r\nfunction getNullableInt(bool $return): ?int;\r\n```\r\nalso we have following function that accepts only not nullable `int` type:\r\n```php\r\n<?php\r\nfunction printInt(int $int): void;\r\n```\r\n\r\nI assume that the following code should not throw an error:\r\n```php\r\n<?php\r\nif (getNullableInt(true)) {\r\n    printInt(getNullableInt(true));\r\n}\r\n```\r\n```\r\nERROR: PossiblyNullArgument - 30:14 - Argument 1 of printInt cannot be null, possibly null value provided\r\n```\r\n\r\nI understand that most of such cases should be handled with additional variable, but not all our code is ideal and sometimes it contains the naive implementation. IMO Psalm should be more flexible and not report such cases, by forcing the developer to change the code.\r\n```php\r\n// right way\r\n$int = getNullableInt(true);\r\nif ($int) {\r\n    printInt($int);\r\n}\r\n```\r\n","closed_by":{"login":"muglug","id":2292638,"node_id":"MDQ6VXNlcjIyOTI2Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/2292638?v=4","gravatar_id":"","url":"https://api.github.com/users/muglug","html_url":"https://github.com/muglug","followers_url":"https://api.github.com/users/muglug/followers","following_url":"https://api.github.com/users/muglug/following{/other_user}","gists_url":"https://api.github.com/users/muglug/gists{/gist_id}","starred_url":"https://api.github.com/users/muglug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muglug/subscriptions","organizations_url":"https://api.github.com/users/muglug/orgs","repos_url":"https://api.github.com/users/muglug/repos","events_url":"https://api.github.com/users/muglug/events{/privacy}","received_events_url":"https://api.github.com/users/muglug/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/vimeo/psalm/issues/3427/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/vimeo/psalm/issues/3427/timeline","performed_via_github_app":null,"state_reason":"completed"}