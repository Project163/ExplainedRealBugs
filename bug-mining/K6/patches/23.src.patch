diff --git a/lib/engine.go b/lib/engine.go
index f58584a30..38d66208f 100644
--- a/lib/engine.go
+++ b/lib/engine.go
@@ -115,6 +115,8 @@ type Engine struct {
 	vuStop    chan interface{}
 	vuPause   chan interface{}
 
+	nextVUID int64
+
 	// Atomic counters.
 	numIterations int64
 	numErrors     int64
@@ -246,6 +248,7 @@ func (e *Engine) Run(ctx context.Context) error {
 	e.atStage = 0
 	e.atStageSince = 0
 	e.atStageStartVUs = e.vus
+	e.nextVUID = 0
 	e.numIterations = 0
 	e.numErrors = 0
 	e.lock.Unlock()
@@ -342,6 +345,15 @@ func (e *Engine) SetVUs(v int64) error {
 			panic(errors.New("fatal miscalculation: attempted to re-schedule active VU"))
 		}
 
+		id := atomic.AddInt64(&e.nextVUID, 1)
+
+		// nil runners are used for testing.
+		if vu.VU != nil {
+			if err := vu.VU.Reconfigure(id); err != nil {
+				return err
+			}
+		}
+
 		ctx, cancel := context.WithCancel(e.subctx)
 		vu.Cancel = cancel
 
diff --git a/lib/engine_test.go b/lib/engine_test.go
index 21be9250c..84aad8242 100644
--- a/lib/engine_test.go
+++ b/lib/engine_test.go
@@ -427,6 +427,7 @@ func TestEngineSetPaused(t *testing.T) {
 }
 
 func TestEngineSetVUsMax(t *testing.T) {
+
 	t.Run("not set", func(t *testing.T) {
 		e, err, _ := newTestEngine(nil, Options{})
 		assert.NoError(t, err)
@@ -479,6 +480,14 @@ func TestEngineSetVUsMax(t *testing.T) {
 }
 
 func TestEngineSetVUs(t *testing.T) {
+	assertVUIDSequence := func(t *testing.T, e *Engine, ids []int64) {
+		actualIDs := make([]int64, len(ids))
+		for i := range ids {
+			actualIDs[i] = e.vuEntries[i].VU.(*RunnerFuncVU).ID
+		}
+		assert.Equal(t, ids, actualIDs)
+	}
+
 	t.Run("not set", func(t *testing.T) {
 		e, err, _ := newTestEngine(nil, Options{})
 		assert.NoError(t, err)
@@ -486,34 +495,39 @@ func TestEngineSetVUs(t *testing.T) {
 		assert.Equal(t, int64(0), e.GetVUs())
 	})
 	t.Run("set", func(t *testing.T) {
-		e, err, _ := newTestEngine(nil, Options{VUsMax: null.IntFrom(15)})
+		e, err, _ := newTestEngine(RunnerFunc(nil), Options{VUsMax: null.IntFrom(15)})
 		assert.NoError(t, err)
 		assert.NoError(t, e.SetVUs(10))
 		assert.Equal(t, int64(10), e.GetVUs())
 		assertActiveVUs(t, e, 10, 5)
+		assertVUIDSequence(t, e, []int64{1, 2, 3, 4, 5, 6, 7, 8, 9, 10})
 
 		t.Run("negative", func(t *testing.T) {
 			assert.EqualError(t, e.SetVUs(-1), "vus can't be negative")
 			assert.Equal(t, int64(10), e.GetVUs())
 			assertActiveVUs(t, e, 10, 5)
+			assertVUIDSequence(t, e, []int64{1, 2, 3, 4, 5, 6, 7, 8, 9, 10})
 		})
 
 		t.Run("too high", func(t *testing.T) {
 			assert.EqualError(t, e.SetVUs(20), "more vus than allocated requested")
 			assert.Equal(t, int64(10), e.GetVUs())
 			assertActiveVUs(t, e, 10, 5)
+			assertVUIDSequence(t, e, []int64{1, 2, 3, 4, 5, 6, 7, 8, 9, 10})
 		})
 
 		t.Run("lower", func(t *testing.T) {
 			assert.NoError(t, e.SetVUs(5))
 			assert.Equal(t, int64(5), e.GetVUs())
 			assertActiveVUs(t, e, 5, 10)
+			assertVUIDSequence(t, e, []int64{1, 2, 3, 4, 5})
 		})
 
 		t.Run("higher", func(t *testing.T) {
 			assert.NoError(t, e.SetVUs(15))
 			assert.Equal(t, int64(15), e.GetVUs())
 			assertActiveVUs(t, e, 15, 0)
+			assertVUIDSequence(t, e, []int64{1, 2, 3, 4, 5, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20})
 		})
 	})
 }
@@ -531,7 +545,7 @@ func TestEngine_runVUOnceKeepsCounters(t *testing.T) {
 		e.runVUOnce(context.Background(), &vuEntry{
 			VU: RunnerFunc(func(ctx context.Context) ([]stats.Sample, error) {
 				return nil, nil
-			}),
+			}).VU(),
 		})
 		assert.Equal(t, int64(1), e.numIterations)
 		assert.Equal(t, int64(0), e.numErrors)
@@ -544,7 +558,7 @@ func TestEngine_runVUOnceKeepsCounters(t *testing.T) {
 		e.runVUOnce(context.Background(), &vuEntry{
 			VU: RunnerFunc(func(ctx context.Context) ([]stats.Sample, error) {
 				return nil, errors.New("this is an error")
-			}),
+			}).VU(),
 		})
 		assert.Equal(t, int64(1), e.numIterations)
 		assert.Equal(t, int64(1), e.numErrors)
@@ -557,7 +571,7 @@ func TestEngine_runVUOnceKeepsCounters(t *testing.T) {
 			e.runVUOnce(context.Background(), &vuEntry{
 				VU: RunnerFunc(func(ctx context.Context) ([]stats.Sample, error) {
 					return nil, testErrorWithString("this is an error")
-				}),
+				}).VU(),
 			})
 			assert.Equal(t, int64(1), e.numIterations)
 			assert.Equal(t, int64(1), e.numErrors)
@@ -578,7 +592,7 @@ func TestEngine_runVUOnceKeepsCounters(t *testing.T) {
 			e.runVUOnce(ctx, &vuEntry{
 				VU: RunnerFunc(func(ctx context.Context) ([]stats.Sample, error) {
 					return nil, nil
-				}),
+				}).VU(),
 			})
 			assert.Equal(t, int64(0), e.numIterations)
 			assert.Equal(t, int64(0), e.numErrors)
@@ -590,7 +604,7 @@ func TestEngine_runVUOnceKeepsCounters(t *testing.T) {
 			e.runVUOnce(ctx, &vuEntry{
 				VU: RunnerFunc(func(ctx context.Context) ([]stats.Sample, error) {
 					return nil, errors.New("this is an error")
-				}),
+				}).VU(),
 			})
 			assert.Equal(t, int64(0), e.numIterations)
 			assert.Equal(t, int64(0), e.numErrors)
@@ -603,7 +617,7 @@ func TestEngine_runVUOnceKeepsCounters(t *testing.T) {
 				e.runVUOnce(ctx, &vuEntry{
 					VU: RunnerFunc(func(ctx context.Context) ([]stats.Sample, error) {
 						return nil, testErrorWithString("this is an error")
-					}),
+					}).VU(),
 				})
 				assert.Equal(t, int64(0), e.numIterations)
 				assert.Equal(t, int64(0), e.numErrors)
diff --git a/lib/runner.go b/lib/runner.go
index e11245387..bd96b35bb 100644
--- a/lib/runner.go
+++ b/lib/runner.go
@@ -54,16 +54,20 @@ type VU interface {
 	Reconfigure(id int64) error
 }
 
-// RunnerFunc adapts a function to be used as both a runner and a VU. NewVU() returns copies of
-// the function itself. Mainly useful for testing.
+// RunnerFunc adapts a function to be used as both a runner and a VU.
+// Mainly useful for testing.
 type RunnerFunc func(ctx context.Context) ([]stats.Sample, error)
 
+func (fn RunnerFunc) VU() *RunnerFuncVU {
+	return &RunnerFuncVU{Fn: fn}
+}
+
 func (fn RunnerFunc) NewVU() (VU, error) {
-	return fn, nil
+	return fn.VU(), nil
 }
 
 func (fn RunnerFunc) GetDefaultGroup() *Group {
-	return nil
+	return &Group{}
 }
 
 func (fn RunnerFunc) GetOptions() Options {
@@ -73,10 +77,19 @@ func (fn RunnerFunc) GetOptions() Options {
 func (fn RunnerFunc) ApplyOptions(opts Options) {
 }
 
-func (fn RunnerFunc) RunOnce(ctx context.Context) ([]stats.Sample, error) {
-	return fn(ctx)
+type RunnerFuncVU struct {
+	Fn RunnerFunc
+	ID int64
+}
+
+func (fn RunnerFuncVU) RunOnce(ctx context.Context) ([]stats.Sample, error) {
+	if fn.Fn == nil {
+		return []stats.Sample{}, nil
+	}
+	return fn.Fn(ctx)
 }
 
-func (fn RunnerFunc) Reconfigure(id int64) error {
+func (fn *RunnerFuncVU) Reconfigure(id int64) error {
+	fn.ID = id
 	return nil
 }
