diff --git a/lib/engine.go b/lib/engine.go
index f58584a30..f5b97ecbd 100644
--- a/lib/engine.go
+++ b/lib/engine.go
@@ -233,11 +233,13 @@ func (e *Engine) Run(ctx context.Context) error {
 
 		// Process any leftover samples.
 		e.processSamples(e.collect()...)
-		collectorcancel()
-		<-collectorch
 
 		// Emit final metrics.
 		e.emitMetrics()
+
+		// Shut down collector
+		collectorcancel()
+		<-collectorch
 	}()
 
 	// Set tracking to defaults.
