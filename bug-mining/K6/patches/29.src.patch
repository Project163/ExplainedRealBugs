diff --git a/lib/engine.go b/lib/engine.go
index 0e10620e9..7a00ee83f 100644
--- a/lib/engine.go
+++ b/lib/engine.go
@@ -189,13 +189,13 @@ func NewEngine(r Runner, o Options) (*Engine, error) {
 }
 
 func (e *Engine) Run(ctx context.Context) error {
-	collectorctx, collectorcancel := context.WithCancel(ctx)
+	collectorctx, collectorcancel := context.WithCancel(context.Background())
 	collectorch := make(chan interface{})
 	if e.Collector != nil {
-		go func(ctx context.Context) {
-			e.Collector.Run(ctx)
+		go func() {
+			e.Collector.Run(collectorctx)
 			close(collectorch)
-		}(collectorctx)
+		}()
 	} else {
 		close(collectorch)
 	}
@@ -236,15 +236,15 @@ func (e *Engine) Run(ctx context.Context) error {
 		e.clearSubcontext()
 		e.subwg.Wait()
 
+		// Emit final metrics.
+		e.emitMetrics()
+
 		// Process any leftover samples.
 		e.processSamples(e.collect()...)
 
 		// Process final thresholds.
 		e.processThresholds()
 
-		// Emit final metrics.
-		e.emitMetrics()
-
 		// Shut down collector
 		collectorcancel()
 		<-collectorch
diff --git a/lib/engine_test.go b/lib/engine_test.go
index e0850d3e8..8a8e65d5c 100644
--- a/lib/engine_test.go
+++ b/lib/engine_test.go
@@ -853,10 +853,15 @@ func TestEngineCollector(t *testing.T) {
 	assert.False(t, e.IsRunning(), "engine still running")
 	assert.False(t, c.IsRunning(), "collector still running")
 
-	// Allow 10% of samples to get lost; NOT OPTIMAL, but I can't figure out why they get lost.
-	numSamples := len(e.Metrics[testMetric].(*stats.TrendSink).Values)
-	assert.True(t, numSamples > 0, "no samples")
-	assert.True(t, numSamples > len(c.Samples)-(len(c.Samples)/10), "more than 10%% of samples omitted")
+	cSamples := []stats.Sample{}
+	for _, sample := range c.Samples {
+		if sample.Metric == testMetric {
+			cSamples = append(cSamples, sample)
+		}
+	}
+	numCollectorSamples := len(cSamples)
+	numEngineSamples := len(e.Metrics[testMetric].(*stats.TrendSink).Values)
+	assert.Equal(t, numEngineSamples, numCollectorSamples)
 }
 
 func TestEngine_processSamples(t *testing.T) {
