{"url":"https://api.github.com/repos/grafana/k6/issues/3065","repository_url":"https://api.github.com/repos/grafana/k6","labels_url":"https://api.github.com/repos/grafana/k6/issues/3065/labels{/name}","comments_url":"https://api.github.com/repos/grafana/k6/issues/3065/comments","events_url":"https://api.github.com/repos/grafana/k6/issues/3065/events","html_url":"https://github.com/grafana/k6/issues/3065","id":1705619363,"node_id":"I_kwDOAz4Wr85lqa-j","number":3065,"title":"Restrict metric names to what is supported by Prometheus","user":{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2651509800,"node_id":"MDU6TGFiZWwyNjUxNTA5ODAw","url":"https://api.github.com/repos/grafana/k6/labels/breaking%20change","name":"breaking change","color":"D93F0B","default":false,"description":"for PRs that need to be mentioned in the breaking changes section of the release notes"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/grafana/k6/milestones/35","html_url":"https://github.com/grafana/k6/milestone/35","labels_url":"https://api.github.com/repos/grafana/k6/milestones/35/labels","id":9398578,"node_id":"MI_kwDOAz4Wr84Aj2ky","number":35,"title":"v0.48.0","description":"","creator":{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":69,"state":"closed","created_at":"2023-05-15T08:12:46Z","updated_at":"2023-12-06T12:05:39Z","due_on":"2023-12-06T08:00:00Z","closed_at":"2023-12-06T12:05:39Z"},"comments":6,"created_at":"2023-05-11T11:20:59Z","updated_at":"2023-11-16T09:20:06Z","closed_at":"2023-11-16T09:20:06Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### What?\r\n\r\nk6 currently supports very liberal metric names \r\nhttps://github.com/grafana/k6/blob/master/metrics/registry.go#L29\r\nprometheus does not https://prometheus.io/docs/concepts/data_model/#metric-names-and-labels\r\n\r\nOpen telemetry also has way more restricted list as well https://opentelemetry.io/docs/specification/otel/metrics/api/#instrument-name-syntax\r\n\r\n### Proposed solution:\r\n\r\nLimit to `[a-zA-Z_][a-zA-Z0-9_]*` which is Prometheus without `:` which have special meaning. We can always expand them again later.\r\n\r\nIn order to have as little disturbance as possible we will have some release (3) with warning, and then we will make this into an error.\r\n\r\n### Caveats:\r\n\r\nDepending on community feedback we might pivot more in one or another direction.","closed_by":{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/grafana/k6/issues/3065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/grafana/k6/issues/3065/timeline","performed_via_github_app":null,"state_reason":"completed"}