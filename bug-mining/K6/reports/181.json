{"url":"https://api.github.com/repos/grafana/k6/issues/2194","repository_url":"https://api.github.com/repos/grafana/k6","labels_url":"https://api.github.com/repos/grafana/k6/issues/2194/labels{/name}","comments_url":"https://api.github.com/repos/grafana/k6/issues/2194/comments","events_url":"https://api.github.com/repos/grafana/k6/issues/2194/events","html_url":"https://github.com/grafana/k6/issues/2194","id":1032696400,"node_id":"I_kwDOAz4Wr849jbJQ","number":2194,"title":"[Bug]: Custom (sub)metrics with shared prefix are not sorted correctly in summary","user":{"login":"knittl","id":2149217,"node_id":"MDQ6VXNlcjIxNDkyMTc=","avatar_url":"https://avatars.githubusercontent.com/u/2149217?v=4","gravatar_id":"","url":"https://api.github.com/users/knittl","html_url":"https://github.com/knittl","followers_url":"https://api.github.com/users/knittl/followers","following_url":"https://api.github.com/users/knittl/following{/other_user}","gists_url":"https://api.github.com/users/knittl/gists{/gist_id}","starred_url":"https://api.github.com/users/knittl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/knittl/subscriptions","organizations_url":"https://api.github.com/users/knittl/orgs","repos_url":"https://api.github.com/users/knittl/repos","events_url":"https://api.github.com/users/knittl/events{/privacy}","received_events_url":"https://api.github.com/users/knittl/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":345191758,"node_id":"MDU6TGFiZWwzNDUxOTE3NTg=","url":"https://api.github.com/repos/grafana/k6/labels/bug","name":"bug","color":"b60205","default":true,"description":""},{"id":874927263,"node_id":"MDU6TGFiZWw4NzQ5MjcyNjM=","url":"https://api.github.com/repos/grafana/k6/labels/high%20prio","name":"high prio","color":"D93F0B","default":false,"description":""},{"id":1079362808,"node_id":"MDU6TGFiZWwxMDc5MzYyODA4","url":"https://api.github.com/repos/grafana/k6/labels/hacktoberfest","name":"hacktoberfest","color":"562c3f","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/grafana/k6/milestones/18","html_url":"https://github.com/grafana/k6/milestone/18","labels_url":"https://api.github.com/repos/grafana/k6/milestones/18/labels","id":7085998,"node_id":"MI_kwDOAz4Wr84AbB-u","number":18,"title":"v0.35.0","description":"","creator":{"login":"na--","id":3336773,"node_id":"MDQ6VXNlcjMzMzY3NzM=","avatar_url":"https://avatars.githubusercontent.com/u/3336773?v=4","gravatar_id":"","url":"https://api.github.com/users/na--","html_url":"https://github.com/na--","followers_url":"https://api.github.com/users/na--/followers","following_url":"https://api.github.com/users/na--/following{/other_user}","gists_url":"https://api.github.com/users/na--/gists{/gist_id}","starred_url":"https://api.github.com/users/na--/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/na--/subscriptions","organizations_url":"https://api.github.com/users/na--/orgs","repos_url":"https://api.github.com/users/na--/repos","events_url":"https://api.github.com/users/na--/events{/privacy}","received_events_url":"https://api.github.com/users/na--/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":65,"state":"closed","created_at":"2021-08-24T11:42:09Z","updated_at":"2021-11-17T10:48:09Z","due_on":"2021-11-15T08:00:00Z","closed_at":"2021-11-17T10:48:09Z"},"comments":3,"created_at":"2021-10-21T16:29:25Z","updated_at":"2021-10-29T11:40:34Z","closed_at":"2021-10-29T11:40:34Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### k6 version\n\n0.34.1\n\n### OS\n\nDocker (on Linux)\n\n### Docker version and image\n\nloadimpact/k6:0.34.1\n\n### Expected Behaviour\n\nSubmetrics are shown below the associated main metric in the text summary, e.g.\r\n\r\n```\r\n     prefix...............: 1   414.40196/s\r\n       { sub:one }........: 1   414.40196/s\r\n     prefix_suffix........: 1   414.40196/s\r\n       { sub:two }........: 1   414.40196/s\r\n```\n\n### Actual Behaviour\n\nAll main metrics are shown and then all submetrics follow, making it impossible to know which submetric is associated with which main metric, e.g.\r\n\r\n```\r\n     prefix...............: 1   414.40196/s\r\n     prefix_suffix........: 1   414.40196/s\r\n       { sub:two }........: 1   414.40196/s\r\n       { sub:one }........: 1   414.40196/s\r\n```\n\n### Steps to Reproduce the Problem\n\nThe following simple script reproduces the problem:\r\n\r\n```js\r\nimport { Counter } from 'k6/metrics';\r\n\r\nexport const counter1 = new Counter('prefix');\r\nexport const counter2 = new Counter('prefix_suffix');\r\n\r\nexport const options = {\r\n\tthresholds: {\r\n\t\t'prefix{sub:one}': [],\r\n\t\t'prefix_suffix{sub:two}': [],\r\n\t},\r\n};\r\n\r\nexport default function() {\r\n\tcounter1.add(1, { sub: 'one' })\r\n\tcounter2.add(1, { sub: 'two' })\r\n}\r\n```","closed_by":{"login":"na--","id":3336773,"node_id":"MDQ6VXNlcjMzMzY3NzM=","avatar_url":"https://avatars.githubusercontent.com/u/3336773?v=4","gravatar_id":"","url":"https://api.github.com/users/na--","html_url":"https://github.com/na--","followers_url":"https://api.github.com/users/na--/followers","following_url":"https://api.github.com/users/na--/following{/other_user}","gists_url":"https://api.github.com/users/na--/gists{/gist_id}","starred_url":"https://api.github.com/users/na--/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/na--/subscriptions","organizations_url":"https://api.github.com/users/na--/orgs","repos_url":"https://api.github.com/users/na--/repos","events_url":"https://api.github.com/users/na--/events{/privacy}","received_events_url":"https://api.github.com/users/na--/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/grafana/k6/issues/2194/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/grafana/k6/issues/2194/timeline","performed_via_github_app":null,"state_reason":"completed"}