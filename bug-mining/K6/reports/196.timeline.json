[{"id":4113616534,"node_id":"MDEyOkxhYmVsZWRFdmVudDQxMTM2MTY1MzQ=","url":"https://api.github.com/repos/grafana/k6/issues/events/4113616534","actor":{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-12-15T09:42:38Z","label":{"name":"bug","color":"b60205"},"performed_via_github_app":null},{"id":4113616536,"node_id":"MDEyOkxhYmVsZWRFdmVudDQxMTM2MTY1MzY=","url":"https://api.github.com/repos/grafana/k6/issues/events/4113616536","actor":{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-12-15T09:42:38Z","label":{"name":"evaluation needed","color":"eda27d"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/grafana/k6/issues/comments/753810362","html_url":"https://github.com/grafana/k6/issues/1771#issuecomment-753810362","issue_url":"https://api.github.com/repos/grafana/k6/issues/1771","id":753810362,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzgxMDM2Mg==","user":{"login":"na--","id":3336773,"node_id":"MDQ6VXNlcjMzMzY3NzM=","avatar_url":"https://avatars.githubusercontent.com/u/3336773?v=4","gravatar_id":"","url":"https://api.github.com/users/na--","html_url":"https://github.com/na--","followers_url":"https://api.github.com/users/na--/followers","following_url":"https://api.github.com/users/na--/following{/other_user}","gists_url":"https://api.github.com/users/na--/gists{/gist_id}","starred_url":"https://api.github.com/users/na--/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/na--/subscriptions","organizations_url":"https://api.github.com/users/na--/orgs","repos_url":"https://api.github.com/users/na--/repos","events_url":"https://api.github.com/users/na--/events{/privacy}","received_events_url":"https://api.github.com/users/na--/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T07:35:30Z","updated_at":"2021-01-04T07:35:30Z","body":"Can you share some more details - `open()` doesn't throw an exception, but instead truncates the result? ","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/grafana/k6/issues/comments/753810362/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"na--","id":3336773,"node_id":"MDQ6VXNlcjMzMzY3NzM=","avatar_url":"https://avatars.githubusercontent.com/u/3336773?v=4","gravatar_id":"","url":"https://api.github.com/users/na--","html_url":"https://github.com/na--","followers_url":"https://api.github.com/users/na--/followers","following_url":"https://api.github.com/users/na--/following{/other_user}","gists_url":"https://api.github.com/users/na--/gists{/gist_id}","starred_url":"https://api.github.com/users/na--/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/na--/subscriptions","organizations_url":"https://api.github.com/users/na--/orgs","repos_url":"https://api.github.com/users/na--/repos","events_url":"https://api.github.com/users/na--/events{/privacy}","received_events_url":"https://api.github.com/users/na--/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/grafana/k6/issues/comments/753835011","html_url":"https://github.com/grafana/k6/issues/1771#issuecomment-753835011","issue_url":"https://api.github.com/repos/grafana/k6/issues/1771","id":753835011,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MzgzNTAxMQ==","user":{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-04T08:29:17Z","updated_at":"2021-01-04T08:29:17Z","body":"Yes it truncates it which made JSON.parse fail in my particular case which then threw an exception. It seemed like some kind of a race in the aferoFS, but I decided against looking into it too deeply at the time in favor of actually finishing some stuff before the holidays :) ","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/grafana/k6/issues/comments/753835011/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/grafana/k6/issues/comments/763864426","html_url":"https://github.com/grafana/k6/issues/1771#issuecomment-763864426","issue_url":"https://api.github.com/repos/grafana/k6/issues/1771","id":763864426,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzg2NDQyNg==","user":{"login":"marnikvde","id":6323838,"node_id":"MDQ6VXNlcjYzMjM4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/6323838?v=4","gravatar_id":"","url":"https://api.github.com/users/marnikvde","html_url":"https://github.com/marnikvde","followers_url":"https://api.github.com/users/marnikvde/followers","following_url":"https://api.github.com/users/marnikvde/following{/other_user}","gists_url":"https://api.github.com/users/marnikvde/gists{/gist_id}","starred_url":"https://api.github.com/users/marnikvde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marnikvde/subscriptions","organizations_url":"https://api.github.com/users/marnikvde/orgs","repos_url":"https://api.github.com/users/marnikvde/repos","events_url":"https://api.github.com/users/marnikvde/events{/privacy}","received_events_url":"https://api.github.com/users/marnikvde/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T19:01:57Z","updated_at":"2021-01-20T19:09:17Z","body":"I have seen this as well on 0.29.0, running on Ubuntu WSL on Windows 10. I made a wrapper around open() that always prints the length of the string it read from the file, and every now and then, the size is 0. I've been trying to reproduce for hours, but I can't seem to find it.\r\n\r\nThis is what my wrapper looks like:\r\n```javascript\r\nfunction TextFileToString(filename) {\r\n  console.log(`Running TextFileToString() for file ${filename} by using K6's open() method for vu ${__VU}`);\r\n  const fileContents = open(filename);\r\n  const script = __ENV.scriptFilename ? __ENV.scriptFilename : \"<unknown>\";\r\n  console.log(`script ${script} reads ${fileContents.length} chars from ${filename} for vu ${__VU}`);\r\n  return fileContents;\r\n}\r\n```\r\nI do a JSON.parse() on the result of that wrapper, and that fails of course on an empty string. This is what I have seen multiple times:\r\n```\r\ntime=\"2021-01-20T17:15:32+01:00\" level=info msg=\"script foo.js reads 0 chars from foo.json for vu 5\" source=console\r\ntime=\"2021-01-20T17:15:32+01:00\" level=info msg=\"script foo.js reads 99092 chars from foo.json for vu 8\" source=console\r\ntime=\"2021-01-20T17:15:32+01:00\" level=info msg=\"script foo.js reads 99092 chars from foo.json for vu 1\" source=console\r\ntime=\"2021-01-20T17:15:32+01:00\" level=info msg=\"script foo.js reads 99090 chars from foo.json for vu 7\" source=console\r\ntime=\"2021-01-20T17:15:32+01:00\" level=error msg=\"Engine error\" hint=\"error while initializing VU #5: 'SyntaxError: EOF at loadClients (file:///home/marnik/bar.js:68:197(181))'\"\r\n```\r\nSo VU 5 seems to haven open() returning an empty string, while the other VU's are reading it just fine.\r\n\r\nThis is my code that I'm using to try and reproduce (so far, no success), which is basicly an example from k6.io with even less complexity:\r\n```javascript\r\nimport http from 'k6/http';\r\nimport { sleep, check } from 'k6';\r\nimport { Counter } from 'k6/metrics';\r\n\r\nconst filename = 'foo.json';\r\nconst data = open(filename);\r\n\r\nif (data.length != 99090) {\r\n  console.error(`VU ${__VU} read a length of ${data.length} for ${filename}`);\r\n  throw new Error(\"findme\");\r\n}\r\n\r\nexport const requests = new Counter('http_reqs');\r\n\r\nexport const options = {\r\n  stages: [\r\n    { target: 1, duration: '5s' },\r\n  ],\r\n  thresholds: {\r\n    requests: ['count < 100'],\r\n  },\r\n};\r\n\r\nexport default function () {\r\n  const res = http.get('http://test.k6.io');\r\n\r\n  sleep(1);\r\n  \r\n  const checkRes = check(res, {\r\n    'status is 200': (r) => r.status === 200,\r\n    'response body': (r) => r.body.indexOf('Feel free to browse') !== -1,\r\n  });\r\n}\r\n```\r\nAnd I'm trying to reproduce it like this:\r\n```bash\r\nwhile true; do timeout 2s k6 run --paused issue-open-test.js --vus 10 >> test.log 2>&1; done\r\n```\r\nBut so far I have not cought the exception. I'm using --paused because the error happens in the init phase.\r\n\r\nAny hints on how to reproduce?","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/grafana/k6/issues/comments/763864426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"marnikvde","id":6323838,"node_id":"MDQ6VXNlcjYzMjM4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/6323838?v=4","gravatar_id":"","url":"https://api.github.com/users/marnikvde","html_url":"https://github.com/marnikvde","followers_url":"https://api.github.com/users/marnikvde/followers","following_url":"https://api.github.com/users/marnikvde/following{/other_user}","gists_url":"https://api.github.com/users/marnikvde/gists{/gist_id}","starred_url":"https://api.github.com/users/marnikvde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marnikvde/subscriptions","organizations_url":"https://api.github.com/users/marnikvde/orgs","repos_url":"https://api.github.com/users/marnikvde/repos","events_url":"https://api.github.com/users/marnikvde/events{/privacy}","received_events_url":"https://api.github.com/users/marnikvde/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/grafana/k6/issues/comments/763945536","html_url":"https://github.com/grafana/k6/issues/1771#issuecomment-763945536","issue_url":"https://api.github.com/repos/grafana/k6/issues/1771","id":763945536,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzk0NTUzNg==","user":{"login":"marnikvde","id":6323838,"node_id":"MDQ6VXNlcjYzMjM4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/6323838?v=4","gravatar_id":"","url":"https://api.github.com/users/marnikvde","html_url":"https://github.com/marnikvde","followers_url":"https://api.github.com/users/marnikvde/followers","following_url":"https://api.github.com/users/marnikvde/following{/other_user}","gists_url":"https://api.github.com/users/marnikvde/gists{/gist_id}","starred_url":"https://api.github.com/users/marnikvde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marnikvde/subscriptions","organizations_url":"https://api.github.com/users/marnikvde/orgs","repos_url":"https://api.github.com/users/marnikvde/repos","events_url":"https://api.github.com/users/marnikvde/events{/privacy}","received_events_url":"https://api.github.com/users/marnikvde/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T21:04:43Z","updated_at":"2021-01-20T21:04:43Z","body":"Another interesting find (that is not documented): I implemented a retry for open() with an exponential backoff, so if open() returns a 0-length string, I print a warning and retry a few times untill I reach maxRetries or maxRetryTime. I can't reproduce the 0-length string on a non-empty file, so I created an empty file, started the script, waited for the warning, and within the +-10 retries in 1 minute, filled the file with valid JSON and saved it. My retry implementation never recovered, so I can only conclude that open() doesn't take file system changes into account. Could it be that k6 works on some kind of snapshot of the filesystem, and ignores changes after it has started? Or maybe there is some caching on open(), so that I can never make it recover by retrying?","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/grafana/k6/issues/comments/763945536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"marnikvde","id":6323838,"node_id":"MDQ6VXNlcjYzMjM4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/6323838?v=4","gravatar_id":"","url":"https://api.github.com/users/marnikvde","html_url":"https://github.com/marnikvde","followers_url":"https://api.github.com/users/marnikvde/followers","following_url":"https://api.github.com/users/marnikvde/following{/other_user}","gists_url":"https://api.github.com/users/marnikvde/gists{/gist_id}","starred_url":"https://api.github.com/users/marnikvde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marnikvde/subscriptions","organizations_url":"https://api.github.com/users/marnikvde/orgs","repos_url":"https://api.github.com/users/marnikvde/repos","events_url":"https://api.github.com/users/marnikvde/events{/privacy}","received_events_url":"https://api.github.com/users/marnikvde/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/grafana/k6/issues/comments/763978931","html_url":"https://github.com/grafana/k6/issues/1771#issuecomment-763978931","issue_url":"https://api.github.com/repos/grafana/k6/issues/1771","id":763978931,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzk3ODkzMQ==","user":{"login":"marnikvde","id":6323838,"node_id":"MDQ6VXNlcjYzMjM4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/6323838?v=4","gravatar_id":"","url":"https://api.github.com/users/marnikvde","html_url":"https://github.com/marnikvde","followers_url":"https://api.github.com/users/marnikvde/followers","following_url":"https://api.github.com/users/marnikvde/following{/other_user}","gists_url":"https://api.github.com/users/marnikvde/gists{/gist_id}","starred_url":"https://api.github.com/users/marnikvde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marnikvde/subscriptions","organizations_url":"https://api.github.com/users/marnikvde/orgs","repos_url":"https://api.github.com/users/marnikvde/repos","events_url":"https://api.github.com/users/marnikvde/events{/privacy}","received_events_url":"https://api.github.com/users/marnikvde/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T22:03:31Z","updated_at":"2021-01-20T22:03:31Z","body":"It looks like my retry is working, so I'm suspecting it's indeed a k6 issue. This is the redacted output of my script:\r\n```\r\n          /\\      |‾‾| /‾‾/   /‾‾/   \r\n     /\\  /  \\     |  |/  /   /  /    \r\n    /  \\/    \\    |     (   /   ‾‾\\  \r\n   /          \\   |  |\\  \\ |  (‾)  | \r\n  / __________ \\  |__| \\__\\ \\_____/ .io\r\n\r\ntime=\"2021-01-20T22:08:22+01:00\" level=info msg=\"script script_example.js reads 95992 chars from file1.json for vu 0\" source=console\r\ntime=\"2021-01-20T22:08:22+01:00\" level=info msg=\"script script_example.js reads 83259 chars from file2.json for vu 0\" source=console\r\ntime=\"2021-01-20T22:08:22+01:00\" level=info msg=\"script script_example.js reads 50558 chars from file3.json for vu 0\" source=console\r\ntime=\"2021-01-20T22:08:22+01:00\" level=info msg=\"script script_example.js reads 37538 chars from file4.json for vu 0\" source=console\r\ntime=\"2021-01-20T22:08:22+01:00\" level=info msg=\"script script_example.js reads 16447 chars from file5.json for vu 0\" source=console\r\ntime=\"2021-01-20T22:08:22+01:00\" level=info msg=\"script script_example.js reads 2529 chars from file6.json for vu 0\" source=console\r\n  execution: local\r\n     script: script_example.js\r\n     output: -\r\n\r\n  scenarios: (100.00%) 10 scenarios, 10 max VUs, 5m30s max duration (incl. graceful stop):\r\n           * BT101: 1 iterations shared among 1 VUs (maxDuration: 5m0s, exec: BT101, gracefulStop: 30s)\r\n           * BT102: 1 iterations shared among 1 VUs (maxDuration: 5m0s, exec: BT102, gracefulStop: 30s)\r\n           * BT111: 1 iterations shared among 1 VUs (maxDuration: 5m0s, exec: BT111, gracefulStop: 30s)\r\n           * BT113: 1 iterations shared among 1 VUs (maxDuration: 5m0s, exec: BT113, gracefulStop: 30s)\r\n           * BT115: 1 iterations shared among 1 VUs (maxDuration: 5m0s, exec: BT115, gracefulStop: 30s)\r\n           * BT116: 1 iterations shared among 1 VUs (maxDuration: 5m0s, exec: BT116, gracefulStop: 30s)\r\n           * BT118: 1 iterations shared among 1 VUs (maxDuration: 5m0s, exec: BT118, gracefulStop: 30s)\r\n           * BT119: 1 iterations shared among 1 VUs (maxDuration: 5m0s, exec: BT119, gracefulStop: 30s)\r\n           * BT120: 1 iterations shared among 1 VUs (maxDuration: 5m0s, exec: BT120, gracefulStop: 30s)\r\n           * BT121: 1 iterations shared among 1 VUs (maxDuration: 5m0s, exec: BT121, gracefulStop: 30s)\r\n\r\ntime=\"2021-01-20T22:08:22+01:00\" level=info msg=\"script script_example.js reads 95992 chars from file7.json for vu 3\" source=console\r\ntime=\"2021-01-20T22:08:22+01:00\" level=info msg=\"script script_example.js reads 95992 chars from file8.json for vu 4\" source=console\r\ntime=\"2021-01-20T22:08:22+01:00\" level=info msg=\"script script_example.js reads 95992 chars from file9.json for vu 1\" source=console\r\ntime=\"2021-01-20T22:08:22+01:00\" level=info msg=\"script script_example.js reads 95992 chars from file10.json for vu 7\" source=console\r\ntime=\"2021-01-20T22:08:22+01:00\" level=info msg=\"script script_example.js reads 95992 chars from file11.json for vu 8\" source=console\r\ntime=\"2021-01-20T22:08:22+01:00\" level=info msg=\"script script_example.js reads 95992 chars from file12.json for vu 2\" source=console\r\ntime=\"2021-01-20T22:08:22+01:00\" level=info msg=\"script script_example.js reads 83684 chars from file13.json for vu 3\" source=console\r\ntime=\"2021-01-20T22:08:22+01:00\" level=info msg=\"script script_example.js reads 84520 chars from file14.json for vu 1\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 83844 chars from file15.json for vu 7\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 83684 chars from file13.json for vu 4\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 84482 chars from file16.json for vu 2\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 95992 chars from file17.json for vu 6\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 95992 chars from file18.json for vu 5\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 82909 chars from file19.json for vu 6\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 83844 chars from file15.json for vu 5\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 50526 chars from file20.json for vu 7\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 50315 chars from file21.json for vu 3\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 50524 chars from file22.json for vu 1\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 50315 chars from file21.json for vu 4\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 50277 chars from file23.json for vu 2\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 85171 chars from file24.json for vu 8\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=warning msg=\"(Re)try 1 read a string length of 0 from file file25.json, we suspect this is a bug in k6, let's try again after sleeping for 0.1s\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 38174 chars from file25.json for vu 7\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 38052 chars from file26.json for vu 1\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 50817 chars from file27.json for vu 6\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 37528 chars from file28.json for vu 4\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 38174 chars from file25.json for vu 2\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 16447 chars from file5.json for vu 7\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 16447 chars from file5.json for vu 1\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 37670 chars from file29.json for vu 6\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 2529 chars from file6.json for vu 7\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 2529 chars from file6.json for vu 1\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 16447 chars from file5.json for vu 4\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 16447 chars from file5.json for vu 2\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 2529 chars from file6.json for vu 4\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 2529 chars from file6.json for vu 2\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 16447 chars from file5.json for vu 6\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 2529 chars from file6.json for vu 6\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 50558 chars from file3.json for vu 8\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 50232 chars from file270.json for vu 5\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 37575 chars from file30.json for vu 8\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 16447 chars from file5.json for vu 8\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 38277 chars from file31.json for vu 5\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 2529 chars from file6.json for vu 8\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 16447 chars from file5.json for vu 5\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 2529 chars from file6.json for vu 5\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 95992 chars from file32.json for vu 10\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 95992 chars from file33.json for vu 9\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 85076 chars from file34.json for vu 9\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 84520 chars from file14.json for vu 10\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 50771 chars from file35.json for vu 9\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 50498 chars from file36.json for vu 10\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 37575 chars from file30.json for vu 9\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 38052 chars from file26.json for vu 10\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 16447 chars from file5.json for vu 9\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 16447 chars from file5.json for vu 10\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 2529 chars from file6.json for vu 9\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 2529 chars from file6.json for vu 10\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 38174 chars from file25.json for vu 3\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 16447 chars from file5.json for vu 3\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 2529 chars from file6.json for vu 3\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 95992 chars from file37.json for vu 0\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 85171 chars from file24.json for vu 0\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 50817 chars from file27.json for vu 0\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 37888 chars from file38.json for vu 0\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 16447 chars from file5.json for vu 0\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 2529 chars from file6.json for vu 0\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Request:\\nGET <redacted>\" source=http-debug\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Request:\\nGET <redacted>\" source=http-debug\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Request:\\nGET <redacted>\" source=http-debug\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Request:\\nGET <redacted>\" source=http-debug\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Request:\\nGET <redacted>\" source=http-debug\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Request:\\nGET <redacted>\" source=http-debug\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Request:\\nGET <redacted>\" source=http-debug\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Request:\\nGET <redacted>\" source=http-debug\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Request:\\nGET <redacted>\" source=http-debug\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Request:\\nGET <redacted>\" source=http-debug\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Response:\\nHTTP/1.1 200 <redacted>\" source=http-debug\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Response:\\nHTTP/1.1 200 <redacted>\" source=http-debug\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Response:\\nHTTP/1.1 200 <redacted>\" source=http-debug\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Response:\\nHTTP/1.1 200 <redacted>\" source=http-debug\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Response:\\nHTTP/1.1 200 <redacted>\" source=http-debug\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Response:\\nHTTP/1.1 200 <redacted>\" source=http-debug\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Response:\\nHTTP/1.1 200 <redacted>\" source=http-debug\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Response:\\nHTTP/1.1 200 <redacted>\" source=http-debug\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Response:\\nHTTP/1.1 200 <redacted>\" source=http-debug\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"Response:\\nHTTP/1.1 200 <redacted>\" source=http-debug\r\n\r\nrunning (0m00.8s), 00/10 VUs, 10 complete and 0 interrupted iterations\r\nBT101 ✓ [ 100% ] 1 VUs  0m00.2s/5m0s  1/1 shared iters\r\nBT102 ✓ [ 100% ] 1 VUs  0m00.2s/5m0s  1/1 shared iters\r\nBT111 ✓ [ 100% ] 1 VUs  0m00.2s/5m0s  1/1 shared iters\r\nBT113 ✓ [ 100% ] 1 VUs  0m00.8s/5m0s  1/1 shared iters\r\nBT115 ✓ [ 100% ] 1 VUs  0m00.3s/5m0s  1/1 shared iters\r\nBT116 ✓ [ 100% ] 1 VUs  0m00.4s/5m0s  1/1 shared iters\r\nBT118 ✓ [ 100% ] 1 VUs  0m00.2s/5m0s  1/1 shared iters\r\nBT119 ✓ [ 100% ] 1 VUs  0m00.3s/5m0s  1/1 shared iters\r\nBT120 ✓ [ 100% ] 1 VUs  0m00.2s/5m0s  1/1 shared iters\r\nBT121 ✓ [ 100% ] 1 VUs  0m00.2s/5m0s  1/1 shared iters\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 95992 chars from file39.json for vu 0\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 84482 chars from file16.json for vu 0\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 50315 chars from file21.json for vu 0\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 38174 chars from file25.json for vu 0\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 16447 chars from file5.json for vu 0\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 2529 chars from file6.json for vu 0\" source=console\r\n\r\nrunning (0m00.9s), 00/10 VUs, 10 complete and 0 interrupted iterations\r\nBT101 ✓ [ 100% ] 1 VUs  0m00.2s/5m0s  1/1 shared iters\r\nBT102 ✓ [ 100% ] 1 VUs  0m00.2s/5m0s  1/1 shared iters\r\nBT111 ✓ [ 100% ] 1 VUs  0m00.2s/5m0s  1/1 shared iters\r\nBT113 ✓ [ 100% ] 1 VUs  0m00.8s/5m0s  1/1 shared iters\r\nBT115 ✓ [ 100% ] 1 VUs  0m00.3s/5m0s  1/1 shared iters\r\nBT116 ✓ [ 100% ] 1 VUs  0m00.4s/5m0s  1/1 shared iters\r\nBT118 ✓ [ 100% ] 1 VUs  0m00.2s/5m0s  1/1 shared iters\r\nBT119 ✓ [ 100% ] 1 VUs  0m00.3s/5m0s  1/1 shared iters\r\nBT120 ✓ [ 100% ] 1 VUs  0m00.2s/5m0s  1/1 shared iters\r\nBT121 ✓ [ 100% ] 1 VUs  0m00.2s/5m0s  1/1 shared iters\r\n\r\n    BT101 <redacted>..........: 1     1.136029/s\r\n    BT101 <redacted>..........: avg=211.287871 min=211.287871 med=211.287871 max=211.287871 p(90)=211.287871 p(95)=211.287871\r\n    BT102 <redacted>..........: 1     1.136029/s\r\n    BT102 <redacted>..........: avg=202.931066 min=202.931066 med=202.931066 max=202.931066 p(90)=202.931066 p(95)=202.931066\r\n    BT111 <redacted>..........: 1     1.136029/s\r\n    BT111 <redacted>..........: avg=227.336049 min=227.336049 med=227.336049 max=227.336049 p(90)=227.336049 p(95)=227.336049\r\n    BT113 <redacted>..........: 1     1.136029/s\r\n    BT113 <redacted>..........: avg=781.374261 min=781.374261 med=781.374261 max=781.374261 p(90)=781.374261 p(95)=781.374261\r\n    BT115 <redacted>..........: 1     1.136029/s\r\n    BT115 <redacted>..........: avg=327.251633 min=327.251633 med=327.251633 max=327.251633 p(90)=327.251633 p(95)=327.251633\r\n    BT116 <redacted>..........: 1     1.136029/s\r\n    BT116 <redacted>..........: avg=439.282352 min=439.282352 med=439.282352 max=439.282352 p(90)=439.282352 p(95)=439.282352\r\n    BT118 <redacted>..........: 1     1.136029/s\r\n    BT118 <redacted>..........: avg=234.718007 min=234.718007 med=234.718007 max=234.718007 p(90)=234.718007 p(95)=234.718007\r\n    BT119 <redacted>..........: 1     1.136029/s\r\n    BT119 <redacted>..........: avg=249.78494  min=249.78494  med=249.78494  max=249.78494  p(90)=249.78494  p(95)=249.78494 \r\n    BT120 <redacted>..........: 1     1.136029/s\r\n    BT120 <redacted>..........: avg=183.542755 min=183.542755 med=183.542755 max=183.542755 p(90)=183.542755 p(95)=183.542755\r\n    BT121 <redacted>..........: 1     1.136029/s\r\n    BT121 <redacted>..........: avg=225.698378 min=225.698378 med=225.698378 max=225.698378 p(90)=225.698378 p(95)=225.698378\r\n    data_received.............: 95 kB 108 kB/s\r\n    data_sent.................: 17 kB 20 kB/s\r\n    http_req_blocked..........: avg=7.43ms     min=5.76ms     med=7.92ms     max=8.1ms      p(90)=8.07ms     p(95)=8.09ms    \r\n    http_req_connecting.......: avg=410.45µs   min=229.68µs   med=395.25µs   max=658.79µs   p(90)=533.33µs   p(95)=596.06µs  \r\n    http_req_duration.........: avg=308.32ms   min=183.54ms   med=231.02ms   max=781.37ms   p(90)=473.49ms   p(95)=627.43ms  \r\n    http_req_receiving........: avg=373.86µs   min=176.08µs   med=293.52µs   max=1.14ms     p(90)=506.81µs   p(95)=824.5µs   \r\n    http_req_sending..........: avg=54.1µs     min=24.89µs    med=53.84µs    max=97.05µs    p(90)=74.98µs    p(95)=86.02µs   \r\n    http_req_tls_handshaking..: avg=6.44ms     min=5.33ms     med=6.4ms      max=7.77ms     p(90)=7.21ms     p(95)=7.49ms    \r\n    http_req_waiting..........: avg=307.89ms   min=183.06ms   med=230.75ms   max=780.91ms   p(90)=472.38ms   p(95)=626.64ms  \r\n    http_reqs.................: 10    11.360294/s\r\n    iteration_duration........: avg=317.38ms   min=193.43ms   med=239.33ms   max=790.14ms   p(90)=482.5ms    p(95)=636.32ms  \r\n    iterations................: 10    11.360294/s\r\n```\r\nThe interesting part is what happened when reading `file25.json`, which is this (in order of log appearance):\r\n```\r\ntime=\"2021-01-20T22:08:23+01:00\" level=warning msg=\"(Re)try 1 read a string length of 0 from file file25.json, we suspect this is a bug in k6, let's try again after sleeping for 0.1s\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 38174 chars from file25.json for vu 7\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 38174 chars from file25.json for vu 2\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 38174 chars from file25.json for vu 3\" source=console\r\ntime=\"2021-01-20T22:08:23+01:00\" level=info msg=\"script script_example.js reads 38174 chars from file25.json for vu 0\" source=console\r\n```\r\nThe script chooses random files to read, so not all VU's read the same files. What I see here is that an open() of file25.json returned a 0-length string, but a retry \"fixed\" it. I'll check if I can add better logging to see in which VU these things are happening.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/grafana/k6/issues/comments/763978931/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"marnikvde","id":6323838,"node_id":"MDQ6VXNlcjYzMjM4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/6323838?v=4","gravatar_id":"","url":"https://api.github.com/users/marnikvde","html_url":"https://github.com/marnikvde","followers_url":"https://api.github.com/users/marnikvde/followers","following_url":"https://api.github.com/users/marnikvde/following{/other_user}","gists_url":"https://api.github.com/users/marnikvde/gists{/gist_id}","starred_url":"https://api.github.com/users/marnikvde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marnikvde/subscriptions","organizations_url":"https://api.github.com/users/marnikvde/orgs","repos_url":"https://api.github.com/users/marnikvde/repos","events_url":"https://api.github.com/users/marnikvde/events{/privacy}","received_events_url":"https://api.github.com/users/marnikvde/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/grafana/k6/issues/comments/763988674","html_url":"https://github.com/grafana/k6/issues/1771#issuecomment-763988674","issue_url":"https://api.github.com/repos/grafana/k6/issues/1771","id":763988674,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzk4ODY3NA==","user":{"login":"marnikvde","id":6323838,"node_id":"MDQ6VXNlcjYzMjM4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/6323838?v=4","gravatar_id":"","url":"https://api.github.com/users/marnikvde","html_url":"https://github.com/marnikvde","followers_url":"https://api.github.com/users/marnikvde/followers","following_url":"https://api.github.com/users/marnikvde/following{/other_user}","gists_url":"https://api.github.com/users/marnikvde/gists{/gist_id}","starred_url":"https://api.github.com/users/marnikvde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marnikvde/subscriptions","organizations_url":"https://api.github.com/users/marnikvde/orgs","repos_url":"https://api.github.com/users/marnikvde/repos","events_url":"https://api.github.com/users/marnikvde/events{/privacy}","received_events_url":"https://api.github.com/users/marnikvde/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T22:20:29Z","updated_at":"2021-01-20T22:24:13Z","body":"Better logging says this:\r\n```\r\ntime=\"2021-01-20T23:11:10+01:00\" level=info msg=\"VU 7: Running TextFileToString() for file file1.json by using K6's open() method\" source=console\r\ntime=\"2021-01-20T23:11:10+01:00\" level=info msg=\"VU 3: Running TextFileToString() for file file1.json by using K6's open() method\" source=console\r\ntime=\"2021-01-20T23:11:10+01:00\" level=warning msg=\"VU 3: (Re)try 1 on file file1.json got a string length of 0, we suspect this is a bug in k6, let's try again after sleeping for 0.1s\" source=console\r\ntime=\"2021-01-20T23:11:10+01:00\" level=info msg=\"VU 7: script script1.js reads 50524 chars from file1.json (tries: 1)\" source=console\r\ntime=\"2021-01-20T23:11:10+01:00\" level=info msg=\"VU 3: script script1.js reads 50524 chars from file1.json (tries: 2)\" source=console\r\ntime=\"2021-01-20T23:11:10+01:00\" level=info msg=\"VU 10: Running TextFileToString() for file file1.json by using K6's open() method\" source=console\r\ntime=\"2021-01-20T23:11:10+01:00\" level=info msg=\"VU 10: script script1.js reads 50524 chars from file1.json (tries: 1)\" source=console\r\n```\r\nSo there are 3 VU's trying to read the same file:\r\n- VU 7 and 10 need 1 try to read 50524 characters from the file\r\n- VU 3 needs 2 tries, the first `open()` returns a 0-length string, the second try (after a 0.1s `sleep()`) works just fine\r\n\r\nAssuming that the order of the log lines has meaning (?), could it be that VU 7 has not returned from `open()` yet when VU 3 tries an `open()` on the same file (that is locked by VU 7)? And that when VU 3 retries, it DOES work because VU 7 has completed the `open()` and has released the file?","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/grafana/k6/issues/comments/763988674/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"marnikvde","id":6323838,"node_id":"MDQ6VXNlcjYzMjM4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/6323838?v=4","gravatar_id":"","url":"https://api.github.com/users/marnikvde","html_url":"https://github.com/marnikvde","followers_url":"https://api.github.com/users/marnikvde/followers","following_url":"https://api.github.com/users/marnikvde/following{/other_user}","gists_url":"https://api.github.com/users/marnikvde/gists{/gist_id}","starred_url":"https://api.github.com/users/marnikvde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marnikvde/subscriptions","organizations_url":"https://api.github.com/users/marnikvde/orgs","repos_url":"https://api.github.com/users/marnikvde/repos","events_url":"https://api.github.com/users/marnikvde/events{/privacy}","received_events_url":"https://api.github.com/users/marnikvde/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/grafana/k6/issues/comments/764594381","html_url":"https://github.com/grafana/k6/issues/1771#issuecomment-764594381","issue_url":"https://api.github.com/repos/grafana/k6/issues/1771","id":764594381,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDU5NDM4MQ==","user":{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T11:57:50Z","updated_at":"2021-01-21T11:57:50Z","body":"Hi @marnikvde ,\r\n\r\nFrom my experiments, there is only a problem if I haven't opened the file when the `__VU == 0` which is the first run that is done more or less specifically so we can find out what files will be needed. If you can reproduce this without such logic, please post a minimal example, so I can try to reproduce it, as I've understood the code you've posted does not reproduce it?!? \r\n\r\n>Could it be that k6 works on some kind of snapshot of the filesystem, and ignores changes after it has started? Or maybe there is some caching on open(), so that I can never make it recover by retrying?\r\n\r\nYes, k6 does cache opened/loaded files.\r\n\r\nI would argue that consecutive VUs should not be able to open ones that weren't open in the 0-th VU. We have had problems with that for cloud users who have some logic that only loads files in some cases or randomly(as you've tried), in their case as we create the archive(tar) we only include the files loaded by the running as `__VU==0` and then that archive is being executed on a separate machine(s). And as the idea of `k6 archive` (and `k6 cloud`) are to make it possible for a script to be executed with no(or with a minimal amount of) changes on another machine(s), I would argue that it is best if we just make it so only `__VU==0` has access to the fs. This will also be required for the future distributed execution, and will likely be needed for anyone who is doing now using the execution segments.\r\n\r\nThe issue most definitely is because we open and save(cache) to a shared resource (both a [map string to afero.fs](https://github.com/loadimpact/k6/blob/229c3c3ca0bbf8ffe2b1c1ec93c6a10404416d5d/js/initcontext.go#L63) and an [afero.Fs implementation](https://github.com/loadimpact/k6/blob/229c3c3ca0bbf8ffe2b1c1ec93c6a10404416d5d/lib/fsext/cacheonread.go#L37) itself(which has an additional problem and we should probably move to [io/fs](https://tip.golang.org/pkg/io/fs/) when it gets stabilized). So there are possible race conditions for both the map and the afero.Fs (we are hitting the second one with this issue).  Adding locking will not make the `k6 archive/cloud` experience closer to `k6 run` and will also ... add locking to opening and loading files which will likely not be noticeable in most cases(we don't let people open files in the scripts themselves so this is only during init time), but is still probably something we don't want.\r\n\r\nFor the record this has probably been the case forever, as even before [my last refactoring](https://github.com/loadimpact/k6/pull/1059) practically everything I said above was the same, I just moved it around. I was under the (obviously) wrong impression that just nobody will even be able to load a file that wasn't loaded in `__VU==0`, which ... while \"true\" when running from archive (although it can still try, but will get an error/panic) is not true when just running the script. \r\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/grafana/k6/issues/comments/764594381/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4233059917,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDIzMzA1OTkxNw==","url":"https://api.github.com/repos/grafana/k6/issues/events/4233059917","actor":{"login":"marnikvde","id":6323838,"node_id":"MDQ6VXNlcjYzMjM4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/6323838?v=4","gravatar_id":"","url":"https://api.github.com/users/marnikvde","html_url":"https://github.com/marnikvde","followers_url":"https://api.github.com/users/marnikvde/followers","following_url":"https://api.github.com/users/marnikvde/following{/other_user}","gists_url":"https://api.github.com/users/marnikvde/gists{/gist_id}","starred_url":"https://api.github.com/users/marnikvde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marnikvde/subscriptions","organizations_url":"https://api.github.com/users/marnikvde/orgs","repos_url":"https://api.github.com/users/marnikvde/repos","events_url":"https://api.github.com/users/marnikvde/events{/privacy}","received_events_url":"https://api.github.com/users/marnikvde/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-01-21T11:57:50Z","performed_via_github_app":null},{"id":4233059920,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQyMzMwNTk5MjA=","url":"https://api.github.com/repos/grafana/k6/issues/events/4233059920","actor":{"login":"marnikvde","id":6323838,"node_id":"MDQ6VXNlcjYzMjM4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/6323838?v=4","gravatar_id":"","url":"https://api.github.com/users/marnikvde","html_url":"https://github.com/marnikvde","followers_url":"https://api.github.com/users/marnikvde/followers","following_url":"https://api.github.com/users/marnikvde/following{/other_user}","gists_url":"https://api.github.com/users/marnikvde/gists{/gist_id}","starred_url":"https://api.github.com/users/marnikvde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marnikvde/subscriptions","organizations_url":"https://api.github.com/users/marnikvde/orgs","repos_url":"https://api.github.com/users/marnikvde/repos","events_url":"https://api.github.com/users/marnikvde/events{/privacy}","received_events_url":"https://api.github.com/users/marnikvde/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-01-21T11:57:50Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/grafana/k6/issues/comments/764658818","html_url":"https://github.com/grafana/k6/issues/1771#issuecomment-764658818","issue_url":"https://api.github.com/repos/grafana/k6/issues/1771","id":764658818,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDY1ODgxOA==","user":{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T13:55:37Z","updated_at":"2021-01-21T13:55:37Z","body":"More specifically my proposal to fix this is:\r\n1. Run `__VU==0`, the one that runs first(we should have a term for this) as it is run now.\r\n2. remove the afero.OsFs from https://github.com/loadimpact/k6/blob/master/loader/filesystems.go#L37 for __VU!=0 (and for setup and teardown obviously) \r\n3. figure out how to return a very nice error that tells users not that the file \"couldn't be found\" but that it wasn't `open()`ed in the initialiazing VU + some link to the documentation about what that means and why it is forbidden and how to fix it.\r\n4. Optional: figure out how to return \"couldn't be found\" if the initializing VU did try to open it, but it wasn't found, but still handled, as that seems like a possible use case where someone will do something dependant on if a file is present. This might already work, I am not certain how MemMapFs works in this case   ","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/grafana/k6/issues/comments/764658818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/grafana/k6/issues/comments/764849775","html_url":"https://github.com/grafana/k6/issues/1771#issuecomment-764849775","issue_url":"https://api.github.com/repos/grafana/k6/issues/1771","id":764849775,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDg0OTc3NQ==","user":{"login":"marnikvde","id":6323838,"node_id":"MDQ6VXNlcjYzMjM4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/6323838?v=4","gravatar_id":"","url":"https://api.github.com/users/marnikvde","html_url":"https://github.com/marnikvde","followers_url":"https://api.github.com/users/marnikvde/followers","following_url":"https://api.github.com/users/marnikvde/following{/other_user}","gists_url":"https://api.github.com/users/marnikvde/gists{/gist_id}","starred_url":"https://api.github.com/users/marnikvde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marnikvde/subscriptions","organizations_url":"https://api.github.com/users/marnikvde/orgs","repos_url":"https://api.github.com/users/marnikvde/repos","events_url":"https://api.github.com/users/marnikvde/events{/privacy}","received_events_url":"https://api.github.com/users/marnikvde/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T18:30:12Z","updated_at":"2021-01-21T18:30:12Z","body":"Thanks for that extensive comment, that's a lot of (new) information! :)\r\n\r\nI can't seem to make a simple example to catch this race condition, I have tried small and big files, lots and few samples, a few VU's and thousands of VU's, to no avail :/\r\n\r\nI understand why (by design) you only want files known to `VU=0` to be used by other VU's, but the reason we implemented it like this was resource usage. When increasing the amount of VU's, we saw that loading \"big\" JSON files quickly gave us OOM exceptions. These big files typically contain random data, so our workaround for this is that just before running the tests, we split `big.json` into 10 chunks/samples like `big-sample1.json` to `big-sample10.json`. In the init code, we pick 1 out of the 10 sample files, which drastically decreases the resources we need per VU, and each VU just gets a random subset, which is 10% of `big.json`. For other files, we have even split them in 100 smaller files.\r\n\r\nOur current workaround is to retry a few times (with exponential backoff) if the string length of `open()` is 0, which seems to work on the first retry after 0.1s, but I understand it goes against some design goals if we want to run this in the cloud.\r\n\r\nWe have not looked into 0.30.0 yet, but it seems to include the feature to share data between VU's, which might be suited to load `big.json`, making our sampling-strategy useless. We'll have to play around to see how it affects resource usage (mostly RAM was the issue I think).\r\n\r\nI think your proposal makes sense, documenting this looks like the first step. Maybe start by documenting some of this in the `open()` docs, that loading different files per VU is not supported/recommended.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/grafana/k6/issues/comments/764849775/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"marnikvde","id":6323838,"node_id":"MDQ6VXNlcjYzMjM4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/6323838?v=4","gravatar_id":"","url":"https://api.github.com/users/marnikvde","html_url":"https://github.com/marnikvde","followers_url":"https://api.github.com/users/marnikvde/followers","following_url":"https://api.github.com/users/marnikvde/following{/other_user}","gists_url":"https://api.github.com/users/marnikvde/gists{/gist_id}","starred_url":"https://api.github.com/users/marnikvde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marnikvde/subscriptions","organizations_url":"https://api.github.com/users/marnikvde/orgs","repos_url":"https://api.github.com/users/marnikvde/repos","events_url":"https://api.github.com/users/marnikvde/events{/privacy}","received_events_url":"https://api.github.com/users/marnikvde/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/grafana/k6/issues/comments/764853723","html_url":"https://github.com/grafana/k6/issues/1771#issuecomment-764853723","issue_url":"https://api.github.com/repos/grafana/k6/issues/1771","id":764853723,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDg1MzcyMw==","user":{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T18:37:36Z","updated_at":"2021-01-21T18:37:36Z","body":"Hi @marnikvde,\r\n\r\nSo you are basically doing the csv(it works with other types) example from https://k6.io/docs/examples/data-parameterization#handling-bigger-data-files ?  As shown there you can still load them in `__VU==0`, although I guess the comment should also add that way it won't break randomly. \r\n\r\nYes the SharedArray (documentation pending ... by me :sob: ) practically removes the need for those hacks so I will recommend using it ;) \r\n\r\n> I think your proposal makes sense, documenting this looks like the first step. Maybe start by documenting some of this in the open() docs, that loading different files per VU is not supported/recommended.\r\n\r\nThis depends on the other k6 developers actually agreeing that we will do what I proposed and that this is ... the \"correct\" behavior :). Obviously, we can just fix it for `k6 run` locally, but I am against it given the arguments I've listed above.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/grafana/k6/issues/comments/764853723/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4235036425,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDIzNTAzNjQyNQ==","url":"https://api.github.com/repos/grafana/k6/issues/events/4235036425","actor":{"login":"marnikvde","id":6323838,"node_id":"MDQ6VXNlcjYzMjM4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/6323838?v=4","gravatar_id":"","url":"https://api.github.com/users/marnikvde","html_url":"https://github.com/marnikvde","followers_url":"https://api.github.com/users/marnikvde/followers","following_url":"https://api.github.com/users/marnikvde/following{/other_user}","gists_url":"https://api.github.com/users/marnikvde/gists{/gist_id}","starred_url":"https://api.github.com/users/marnikvde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marnikvde/subscriptions","organizations_url":"https://api.github.com/users/marnikvde/orgs","repos_url":"https://api.github.com/users/marnikvde/repos","events_url":"https://api.github.com/users/marnikvde/events{/privacy}","received_events_url":"https://api.github.com/users/marnikvde/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-01-21T18:37:37Z","performed_via_github_app":null},{"id":4235036428,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQyMzUwMzY0Mjg=","url":"https://api.github.com/repos/grafana/k6/issues/events/4235036428","actor":{"login":"marnikvde","id":6323838,"node_id":"MDQ6VXNlcjYzMjM4Mzg=","avatar_url":"https://avatars.githubusercontent.com/u/6323838?v=4","gravatar_id":"","url":"https://api.github.com/users/marnikvde","html_url":"https://github.com/marnikvde","followers_url":"https://api.github.com/users/marnikvde/followers","following_url":"https://api.github.com/users/marnikvde/following{/other_user}","gists_url":"https://api.github.com/users/marnikvde/gists{/gist_id}","starred_url":"https://api.github.com/users/marnikvde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marnikvde/subscriptions","organizations_url":"https://api.github.com/users/marnikvde/orgs","repos_url":"https://api.github.com/users/marnikvde/repos","events_url":"https://api.github.com/users/marnikvde/events{/privacy}","received_events_url":"https://api.github.com/users/marnikvde/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-01-21T18:37:37Z","performed_via_github_app":null},{"actor":{"login":"na--","id":3336773,"node_id":"MDQ6VXNlcjMzMzY3NzM=","avatar_url":"https://avatars.githubusercontent.com/u/3336773?v=4","gravatar_id":"","url":"https://api.github.com/users/na--","html_url":"https://github.com/na--","followers_url":"https://api.github.com/users/na--/followers","following_url":"https://api.github.com/users/na--/following{/other_user}","gists_url":"https://api.github.com/users/na--/gists{/gist_id}","starred_url":"https://api.github.com/users/na--/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/na--/subscriptions","organizations_url":"https://api.github.com/users/na--/orgs","repos_url":"https://api.github.com/users/na--/repos","events_url":"https://api.github.com/users/na--/events{/privacy}","received_events_url":"https://api.github.com/users/na--/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-28T12:18:22Z","updated_at":"2021-03-28T12:18:22Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/grafana/k6/issues/1931","repository_url":"https://api.github.com/repos/grafana/k6","labels_url":"https://api.github.com/repos/grafana/k6/issues/1931/labels{/name}","comments_url":"https://api.github.com/repos/grafana/k6/issues/1931/comments","events_url":"https://api.github.com/repos/grafana/k6/issues/1931/events","html_url":"https://github.com/grafana/k6/issues/1931","id":842726503,"node_id":"MDU6SXNzdWU4NDI3MjY1MDM=","number":1931,"title":"Shared-memory read-only files","user":{"login":"na--","id":3336773,"node_id":"MDQ6VXNlcjMzMzY3NzM=","avatar_url":"https://avatars.githubusercontent.com/u/3336773?v=4","gravatar_id":"","url":"https://api.github.com/users/na--","html_url":"https://github.com/na--","followers_url":"https://api.github.com/users/na--/followers","following_url":"https://api.github.com/users/na--/following{/other_user}","gists_url":"https://api.github.com/users/na--/gists{/gist_id}","starred_url":"https://api.github.com/users/na--/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/na--/subscriptions","organizations_url":"https://api.github.com/users/na--/orgs","repos_url":"https://api.github.com/users/na--/repos","events_url":"https://api.github.com/users/na--/events{/privacy}","received_events_url":"https://api.github.com/users/na--/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":345191760,"node_id":"MDU6TGFiZWwzNDUxOTE3NjA=","url":"https://api.github.com/repos/grafana/k6/labels/enhancement","name":"enhancement","color":"5319E7","default":true,"description":""},{"id":869282130,"node_id":"MDU6TGFiZWw4NjkyODIxMzA=","url":"https://api.github.com/repos/grafana/k6/labels/feature","name":"feature","color":"5319E7","default":false,"description":""},{"id":1079102926,"node_id":"MDU6TGFiZWwxMDc5MTAyOTI2","url":"https://api.github.com/repos/grafana/k6/labels/evaluation%20needed","name":"evaluation needed","color":"006B75","default":false,"description":"proposal needs to be validated or tested before fully implementing it in k6"}],"state":"open","locked":false,"assignee":{"login":"oleiade","id":690867,"node_id":"MDQ6VXNlcjY5MDg2Nw==","avatar_url":"https://avatars.githubusercontent.com/u/690867?v=4","gravatar_id":"","url":"https://api.github.com/users/oleiade","html_url":"https://github.com/oleiade","followers_url":"https://api.github.com/users/oleiade/followers","following_url":"https://api.github.com/users/oleiade/following{/other_user}","gists_url":"https://api.github.com/users/oleiade/gists{/gist_id}","starred_url":"https://api.github.com/users/oleiade/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oleiade/subscriptions","organizations_url":"https://api.github.com/users/oleiade/orgs","repos_url":"https://api.github.com/users/oleiade/repos","events_url":"https://api.github.com/users/oleiade/events{/privacy}","received_events_url":"https://api.github.com/users/oleiade/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"oleiade","id":690867,"node_id":"MDQ6VXNlcjY5MDg2Nw==","avatar_url":"https://avatars.githubusercontent.com/u/690867?v=4","gravatar_id":"","url":"https://api.github.com/users/oleiade","html_url":"https://github.com/oleiade","followers_url":"https://api.github.com/users/oleiade/followers","following_url":"https://api.github.com/users/oleiade/following{/other_user}","gists_url":"https://api.github.com/users/oleiade/gists{/gist_id}","starred_url":"https://api.github.com/users/oleiade/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oleiade/subscriptions","organizations_url":"https://api.github.com/users/oleiade/orgs","repos_url":"https://api.github.com/users/oleiade/repos","events_url":"https://api.github.com/users/oleiade/events{/privacy}","received_events_url":"https://api.github.com/users/oleiade/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":6,"created_at":"2021-03-28T12:18:22Z","updated_at":"2023-09-27T14:10:12Z","closed_at":null,"author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":54400687,"node_id":"MDEwOlJlcG9zaXRvcnk1NDQwMDY4Nw==","name":"k6","full_name":"grafana/k6","private":false,"owner":{"login":"grafana","id":7195757,"node_id":"MDEyOk9yZ2FuaXphdGlvbjcxOTU3NTc=","avatar_url":"https://avatars.githubusercontent.com/u/7195757?v=4","gravatar_id":"","url":"https://api.github.com/users/grafana","html_url":"https://github.com/grafana","followers_url":"https://api.github.com/users/grafana/followers","following_url":"https://api.github.com/users/grafana/following{/other_user}","gists_url":"https://api.github.com/users/grafana/gists{/gist_id}","starred_url":"https://api.github.com/users/grafana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/grafana/subscriptions","organizations_url":"https://api.github.com/users/grafana/orgs","repos_url":"https://api.github.com/users/grafana/repos","events_url":"https://api.github.com/users/grafana/events{/privacy}","received_events_url":"https://api.github.com/users/grafana/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/grafana/k6","description":"A modern load testing tool, using Go and JavaScript","fork":false,"url":"https://api.github.com/repos/grafana/k6","forks_url":"https://api.github.com/repos/grafana/k6/forks","keys_url":"https://api.github.com/repos/grafana/k6/keys{/key_id}","collaborators_url":"https://api.github.com/repos/grafana/k6/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/grafana/k6/teams","hooks_url":"https://api.github.com/repos/grafana/k6/hooks","issue_events_url":"https://api.github.com/repos/grafana/k6/issues/events{/number}","events_url":"https://api.github.com/repos/grafana/k6/events","assignees_url":"https://api.github.com/repos/grafana/k6/assignees{/user}","branches_url":"https://api.github.com/repos/grafana/k6/branches{/branch}","tags_url":"https://api.github.com/repos/grafana/k6/tags","blobs_url":"https://api.github.com/repos/grafana/k6/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/grafana/k6/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/grafana/k6/git/refs{/sha}","trees_url":"https://api.github.com/repos/grafana/k6/git/trees{/sha}","statuses_url":"https://api.github.com/repos/grafana/k6/statuses/{sha}","languages_url":"https://api.github.com/repos/grafana/k6/languages","stargazers_url":"https://api.github.com/repos/grafana/k6/stargazers","contributors_url":"https://api.github.com/repos/grafana/k6/contributors","subscribers_url":"https://api.github.com/repos/grafana/k6/subscribers","subscription_url":"https://api.github.com/repos/grafana/k6/subscription","commits_url":"https://api.github.com/repos/grafana/k6/commits{/sha}","git_commits_url":"https://api.github.com/repos/grafana/k6/git/commits{/sha}","comments_url":"https://api.github.com/repos/grafana/k6/comments{/number}","issue_comment_url":"https://api.github.com/repos/grafana/k6/issues/comments{/number}","contents_url":"https://api.github.com/repos/grafana/k6/contents/{+path}","compare_url":"https://api.github.com/repos/grafana/k6/compare/{base}...{head}","merges_url":"https://api.github.com/repos/grafana/k6/merges","archive_url":"https://api.github.com/repos/grafana/k6/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/grafana/k6/downloads","issues_url":"https://api.github.com/repos/grafana/k6/issues{/number}","pulls_url":"https://api.github.com/repos/grafana/k6/pulls{/number}","milestones_url":"https://api.github.com/repos/grafana/k6/milestones{/number}","notifications_url":"https://api.github.com/repos/grafana/k6/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/grafana/k6/labels{/name}","releases_url":"https://api.github.com/repos/grafana/k6/releases{/id}","deployments_url":"https://api.github.com/repos/grafana/k6/deployments","created_at":"2016-03-21T15:30:24Z","updated_at":"2025-11-09T22:33:24Z","pushed_at":"2025-11-09T15:40:01Z","git_url":"git://github.com/grafana/k6.git","ssh_url":"git@github.com:grafana/k6.git","clone_url":"https://github.com/grafana/k6.git","svn_url":"https://github.com/grafana/k6","homepage":"https://grafana.com/oss/k6/","size":68631,"stargazers_count":29152,"watchers_count":29152,"language":"Go","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1447,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":760,"license":{"key":"agpl-3.0","name":"GNU Affero General Public License v3.0","spdx_id":"AGPL-3.0","url":"https://api.github.com/licenses/agpl-3.0","node_id":"MDc6TGljZW5zZTE="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["es6","go","golang","hacktoberfest","javascript","k6","load-generator","load-testing","performance"],"visibility":"public","forks":1447,"open_issues":760,"watchers":29152,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"Prompted by https://community.k6.io/t/ways-to-transfer-files-in-tests/1552\r\n\r\nAfter https://github.com/k6io/k6/pull/1841, can we add an optional argument (e.g. `r`) to [`open()`](https://k6.io/docs/javascript-api/init-context/open-filepath-mode) that would allow us to have only a single copy in memory. Like a [`SharedArray`](https://k6.io/docs/javascript-api/k6-data/sharedarray), but for `string`/`ArrayBuffer` data?\r\n\r\nAnd unlike `SharedArray()`, we probably don't even need to have a `name`, we can use the absolute path to the file as the cross-VU sharing key.\r\n\r\nThis would solve the pain point of being able to load test services that expect large file uploads, which are currently impossible with more than a few VUs, even with `SharedArray`.\r\n\r\nAs a bonus, this `sync.Once`-like behavior will also fix https://github.com/k6io/k6/issues/1771, right?\r\n ","reactions":{"url":"https://api.github.com/repos/grafana/k6/issues/1931/reactions","total_count":4,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/grafana/k6/issues/1931/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-11-29T12:31:18Z","updated_at":"2021-11-29T12:31:18Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/grafana/k6/issues/2266","repository_url":"https://api.github.com/repos/grafana/k6","labels_url":"https://api.github.com/repos/grafana/k6/issues/2266/labels{/name}","comments_url":"https://api.github.com/repos/grafana/k6/issues/2266/comments","events_url":"https://api.github.com/repos/grafana/k6/issues/2266/events","html_url":"https://github.com/grafana/k6/issues/2266","id":1065745771,"node_id":"I_kwDOAz4Wr84_hf1r","number":2266,"title":"Math.random() randomizing filename to be opened within init context causes uploads to get corrupted","user":{"login":"vderelle","id":1045877,"node_id":"MDQ6VXNlcjEwNDU4Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/1045877?v=4","gravatar_id":"","url":"https://api.github.com/users/vderelle","html_url":"https://github.com/vderelle","followers_url":"https://api.github.com/users/vderelle/followers","following_url":"https://api.github.com/users/vderelle/following{/other_user}","gists_url":"https://api.github.com/users/vderelle/gists{/gist_id}","starred_url":"https://api.github.com/users/vderelle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vderelle/subscriptions","organizations_url":"https://api.github.com/users/vderelle/orgs","repos_url":"https://api.github.com/users/vderelle/repos","events_url":"https://api.github.com/users/vderelle/events{/privacy}","received_events_url":"https://api.github.com/users/vderelle/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1079102926,"node_id":"MDU6TGFiZWwxMDc5MTAyOTI2","url":"https://api.github.com/repos/grafana/k6/labels/evaluation%20needed","name":"evaluation needed","color":"006B75","default":false,"description":"proposal needs to be validated or tested before fully implementing it in k6"},{"id":2954585249,"node_id":"MDU6TGFiZWwyOTU0NTg1MjQ5","url":"https://api.github.com/repos/grafana/k6/labels/awaiting%20user","name":"awaiting user","color":"D93F0B","default":false,"description":"waiting for user to respond"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2021-11-29T08:28:33Z","updated_at":"2021-12-02T08:07:30Z","closed_at":"2021-12-02T08:07:30Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":54400687,"node_id":"MDEwOlJlcG9zaXRvcnk1NDQwMDY4Nw==","name":"k6","full_name":"grafana/k6","private":false,"owner":{"login":"grafana","id":7195757,"node_id":"MDEyOk9yZ2FuaXphdGlvbjcxOTU3NTc=","avatar_url":"https://avatars.githubusercontent.com/u/7195757?v=4","gravatar_id":"","url":"https://api.github.com/users/grafana","html_url":"https://github.com/grafana","followers_url":"https://api.github.com/users/grafana/followers","following_url":"https://api.github.com/users/grafana/following{/other_user}","gists_url":"https://api.github.com/users/grafana/gists{/gist_id}","starred_url":"https://api.github.com/users/grafana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/grafana/subscriptions","organizations_url":"https://api.github.com/users/grafana/orgs","repos_url":"https://api.github.com/users/grafana/repos","events_url":"https://api.github.com/users/grafana/events{/privacy}","received_events_url":"https://api.github.com/users/grafana/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/grafana/k6","description":"A modern load testing tool, using Go and JavaScript","fork":false,"url":"https://api.github.com/repos/grafana/k6","forks_url":"https://api.github.com/repos/grafana/k6/forks","keys_url":"https://api.github.com/repos/grafana/k6/keys{/key_id}","collaborators_url":"https://api.github.com/repos/grafana/k6/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/grafana/k6/teams","hooks_url":"https://api.github.com/repos/grafana/k6/hooks","issue_events_url":"https://api.github.com/repos/grafana/k6/issues/events{/number}","events_url":"https://api.github.com/repos/grafana/k6/events","assignees_url":"https://api.github.com/repos/grafana/k6/assignees{/user}","branches_url":"https://api.github.com/repos/grafana/k6/branches{/branch}","tags_url":"https://api.github.com/repos/grafana/k6/tags","blobs_url":"https://api.github.com/repos/grafana/k6/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/grafana/k6/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/grafana/k6/git/refs{/sha}","trees_url":"https://api.github.com/repos/grafana/k6/git/trees{/sha}","statuses_url":"https://api.github.com/repos/grafana/k6/statuses/{sha}","languages_url":"https://api.github.com/repos/grafana/k6/languages","stargazers_url":"https://api.github.com/repos/grafana/k6/stargazers","contributors_url":"https://api.github.com/repos/grafana/k6/contributors","subscribers_url":"https://api.github.com/repos/grafana/k6/subscribers","subscription_url":"https://api.github.com/repos/grafana/k6/subscription","commits_url":"https://api.github.com/repos/grafana/k6/commits{/sha}","git_commits_url":"https://api.github.com/repos/grafana/k6/git/commits{/sha}","comments_url":"https://api.github.com/repos/grafana/k6/comments{/number}","issue_comment_url":"https://api.github.com/repos/grafana/k6/issues/comments{/number}","contents_url":"https://api.github.com/repos/grafana/k6/contents/{+path}","compare_url":"https://api.github.com/repos/grafana/k6/compare/{base}...{head}","merges_url":"https://api.github.com/repos/grafana/k6/merges","archive_url":"https://api.github.com/repos/grafana/k6/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/grafana/k6/downloads","issues_url":"https://api.github.com/repos/grafana/k6/issues{/number}","pulls_url":"https://api.github.com/repos/grafana/k6/pulls{/number}","milestones_url":"https://api.github.com/repos/grafana/k6/milestones{/number}","notifications_url":"https://api.github.com/repos/grafana/k6/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/grafana/k6/labels{/name}","releases_url":"https://api.github.com/repos/grafana/k6/releases{/id}","deployments_url":"https://api.github.com/repos/grafana/k6/deployments","created_at":"2016-03-21T15:30:24Z","updated_at":"2025-11-09T22:33:24Z","pushed_at":"2025-11-09T15:40:01Z","git_url":"git://github.com/grafana/k6.git","ssh_url":"git@github.com:grafana/k6.git","clone_url":"https://github.com/grafana/k6.git","svn_url":"https://github.com/grafana/k6","homepage":"https://grafana.com/oss/k6/","size":68631,"stargazers_count":29152,"watchers_count":29152,"language":"Go","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1447,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":760,"license":{"key":"agpl-3.0","name":"GNU Affero General Public License v3.0","spdx_id":"AGPL-3.0","url":"https://api.github.com/licenses/agpl-3.0","node_id":"MDc6TGljZW5zZTE="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["es6","go","golang","hacktoberfest","javascript","k6","load-generator","load-testing","performance"],"visibility":"public","forks":1447,"open_issues":760,"watchers":29152,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"Hi,\r\n\r\nI've come across a bug/unexpected behavior whereby using Math.random() to randomly open() a file inside the init/global context causes the HTTP PUT requests to interrupt each other when multiple VUs land on the same random file. This behavior does not occur if not using Math.random(), i.e. having multiple VUs upload the same file, which is what you would expect. It's baffling as to why the introduction of Math.random() would cause this.\r\n\r\nFails:\r\n```\r\nconst filename = Math.floor((Math.random() * 10) + 1)\r\nconst imageFile = open(`pic/png/${filename.png}`, \"b\")\r\n```\r\n\r\nWorks:\r\n```\r\nconst filename = 6;\r\nconst imageFile = open(`pic/png/${filename.png}`, \"b\")\r\n```\r\n\r\nWorks:\r\n```\r\nconst imageFile = open(`pic/png/${__VU}.png`, \"b\");\r\n```\r\n^ currently using this last approach to have some variability, although not true randomness, across the various VUs in terms of the file that they upload. \r\n\r\nThe HTTP PUT operation within the load test script uploads to S3. It consistently fails with corrupted file uploads if Math.random() lands on the same number and thus pics the same file to open across multiple VUs.\r\n\r\nThe web service we are load testing accepts pictures with different characteristics from our users. To have a more accurate representation of behavior under load it's better to add some entropy and randomize which PNGs get uploaded.\r\n\r\n\r\nThank you for your help.\r\n","reactions":{"url":"https://api.github.com/repos/grafana/k6/issues/2266/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/grafana/k6/issues/2266/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"id":5776277477,"node_id":"AE_lADOAz4Wr84tvWuozwAAAAFYSv_l","url":"https://api.github.com/repos/grafana/k6/issues/events/5776277477","actor":{"login":"na--","id":3336773,"node_id":"MDQ6VXNlcjMzMzY3NzM=","avatar_url":"https://avatars.githubusercontent.com/u/3336773?v=4","gravatar_id":"","url":"https://api.github.com/users/na--","html_url":"https://github.com/na--","followers_url":"https://api.github.com/users/na--/followers","following_url":"https://api.github.com/users/na--/following{/other_user}","gists_url":"https://api.github.com/users/na--/gists{/gist_id}","starred_url":"https://api.github.com/users/na--/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/na--/subscriptions","organizations_url":"https://api.github.com/users/na--/orgs","repos_url":"https://api.github.com/users/na--/repos","events_url":"https://api.github.com/users/na--/events{/privacy}","received_events_url":"https://api.github.com/users/na--/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2021-12-16T07:13:04Z","assignee":{"login":"olegbespalov","id":5425600,"node_id":"MDQ6VXNlcjU0MjU2MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5425600?v=4","gravatar_id":"","url":"https://api.github.com/users/olegbespalov","html_url":"https://github.com/olegbespalov","followers_url":"https://api.github.com/users/olegbespalov/followers","following_url":"https://api.github.com/users/olegbespalov/following{/other_user}","gists_url":"https://api.github.com/users/olegbespalov/gists{/gist_id}","starred_url":"https://api.github.com/users/olegbespalov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/olegbespalov/subscriptions","organizations_url":"https://api.github.com/users/olegbespalov/orgs","repos_url":"https://api.github.com/users/olegbespalov/repos","events_url":"https://api.github.com/users/olegbespalov/events{/privacy}","received_events_url":"https://api.github.com/users/olegbespalov/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"id":5840888596,"node_id":"REFE_lADOAz4Wr84tvWuozwAAAAFcJOMU","url":"https://api.github.com/repos/grafana/k6/issues/events/5840888596","actor":{"login":"olegbespalov","id":5425600,"node_id":"MDQ6VXNlcjU0MjU2MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5425600?v=4","gravatar_id":"","url":"https://api.github.com/users/olegbespalov","html_url":"https://github.com/olegbespalov","followers_url":"https://api.github.com/users/olegbespalov/followers","following_url":"https://api.github.com/users/olegbespalov/following{/other_user}","gists_url":"https://api.github.com/users/olegbespalov/gists{/gist_id}","starred_url":"https://api.github.com/users/olegbespalov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/olegbespalov/subscriptions","organizations_url":"https://api.github.com/users/olegbespalov/orgs","repos_url":"https://api.github.com/users/olegbespalov/repos","events_url":"https://api.github.com/users/olegbespalov/events{/privacy}","received_events_url":"https://api.github.com/users/olegbespalov/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"55550518a893b7da4b71243bd0697941e8c15fc3","commit_url":"https://api.github.com/repos/grafana/k6/commits/55550518a893b7da4b71243bd0697941e8c15fc3","created_at":"2022-01-04T14:50:33Z","performed_via_github_app":null},{"actor":{"login":"olegbespalov","id":5425600,"node_id":"MDQ6VXNlcjU0MjU2MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5425600?v=4","gravatar_id":"","url":"https://api.github.com/users/olegbespalov","html_url":"https://github.com/olegbespalov","followers_url":"https://api.github.com/users/olegbespalov/followers","following_url":"https://api.github.com/users/olegbespalov/following{/other_user}","gists_url":"https://api.github.com/users/olegbespalov/gists{/gist_id}","starred_url":"https://api.github.com/users/olegbespalov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/olegbespalov/subscriptions","organizations_url":"https://api.github.com/users/olegbespalov/orgs","repos_url":"https://api.github.com/users/olegbespalov/repos","events_url":"https://api.github.com/users/olegbespalov/events{/privacy}","received_events_url":"https://api.github.com/users/olegbespalov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T14:52:17Z","updated_at":"2022-01-04T14:52:17Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/grafana/k6/issues/2314","repository_url":"https://api.github.com/repos/grafana/k6","labels_url":"https://api.github.com/repos/grafana/k6/issues/2314/labels{/name}","comments_url":"https://api.github.com/repos/grafana/k6/issues/2314/comments","events_url":"https://api.github.com/repos/grafana/k6/issues/2314/events","html_url":"https://github.com/grafana/k6/pull/2314","id":1093432572,"node_id":"PR_kwDOAz4Wr84wg4I4","number":2314,"title":"fix: Implementing a limitation for the open()","user":{"login":"olegbespalov","id":5425600,"node_id":"MDQ6VXNlcjU0MjU2MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5425600?v=4","gravatar_id":"","url":"https://api.github.com/users/olegbespalov","html_url":"https://github.com/olegbespalov","followers_url":"https://api.github.com/users/olegbespalov/followers","following_url":"https://api.github.com/users/olegbespalov/following{/other_user}","gists_url":"https://api.github.com/users/olegbespalov/gists{/gist_id}","starred_url":"https://api.github.com/users/olegbespalov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/olegbespalov/subscriptions","organizations_url":"https://api.github.com/users/olegbespalov/orgs","repos_url":"https://api.github.com/users/olegbespalov/repos","events_url":"https://api.github.com/users/olegbespalov/events{/privacy}","received_events_url":"https://api.github.com/users/olegbespalov/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2651509800,"node_id":"MDU6TGFiZWwyNjUxNTA5ODAw","url":"https://api.github.com/repos/grafana/k6/labels/breaking%20change","name":"breaking change","color":"D93F0B","default":false,"description":"for PRs that need to be mentioned in the breaking changes section of the release notes"},{"id":2743341216,"node_id":"MDU6TGFiZWwyNzQzMzQxMjE2","url":"https://api.github.com/repos/grafana/k6/labels/documentation-needed","name":"documentation-needed","color":"1AE598","default":false,"description":"A PR which will need a separate PR for documentation"}],"state":"closed","locked":false,"assignee":{"login":"olegbespalov","id":5425600,"node_id":"MDQ6VXNlcjU0MjU2MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5425600?v=4","gravatar_id":"","url":"https://api.github.com/users/olegbespalov","html_url":"https://github.com/olegbespalov","followers_url":"https://api.github.com/users/olegbespalov/followers","following_url":"https://api.github.com/users/olegbespalov/following{/other_user}","gists_url":"https://api.github.com/users/olegbespalov/gists{/gist_id}","starred_url":"https://api.github.com/users/olegbespalov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/olegbespalov/subscriptions","organizations_url":"https://api.github.com/users/olegbespalov/orgs","repos_url":"https://api.github.com/users/olegbespalov/repos","events_url":"https://api.github.com/users/olegbespalov/events{/privacy}","received_events_url":"https://api.github.com/users/olegbespalov/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"olegbespalov","id":5425600,"node_id":"MDQ6VXNlcjU0MjU2MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5425600?v=4","gravatar_id":"","url":"https://api.github.com/users/olegbespalov","html_url":"https://github.com/olegbespalov","followers_url":"https://api.github.com/users/olegbespalov/followers","following_url":"https://api.github.com/users/olegbespalov/following{/other_user}","gists_url":"https://api.github.com/users/olegbespalov/gists{/gist_id}","starred_url":"https://api.github.com/users/olegbespalov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/olegbespalov/subscriptions","organizations_url":"https://api.github.com/users/olegbespalov/orgs","repos_url":"https://api.github.com/users/olegbespalov/repos","events_url":"https://api.github.com/users/olegbespalov/events{/privacy}","received_events_url":"https://api.github.com/users/olegbespalov/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/grafana/k6/milestones/20","html_url":"https://github.com/grafana/k6/milestone/20","labels_url":"https://api.github.com/repos/grafana/k6/milestones/20/labels","id":7285001,"node_id":"MI_kwDOAz4Wr84AbykJ","number":20,"title":"v0.36.0","description":"","creator":{"login":"na--","id":3336773,"node_id":"MDQ6VXNlcjMzMzY3NzM=","avatar_url":"https://avatars.githubusercontent.com/u/3336773?v=4","gravatar_id":"","url":"https://api.github.com/users/na--","html_url":"https://github.com/na--","followers_url":"https://api.github.com/users/na--/followers","following_url":"https://api.github.com/users/na--/following{/other_user}","gists_url":"https://api.github.com/users/na--/gists{/gist_id}","starred_url":"https://api.github.com/users/na--/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/na--/subscriptions","organizations_url":"https://api.github.com/users/na--/orgs","repos_url":"https://api.github.com/users/na--/repos","events_url":"https://api.github.com/users/na--/events{/privacy}","received_events_url":"https://api.github.com/users/na--/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":35,"state":"closed","created_at":"2021-10-25T07:35:48Z","updated_at":"2022-01-24T11:15:23Z","due_on":"2022-02-07T08:00:00Z","closed_at":"2022-01-24T11:15:23Z"},"comments":1,"created_at":"2022-01-04T14:52:17Z","updated_at":"2022-01-12T11:03:55Z","closed_at":"2022-01-12T10:27:50Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":54400687,"node_id":"MDEwOlJlcG9zaXRvcnk1NDQwMDY4Nw==","name":"k6","full_name":"grafana/k6","private":false,"owner":{"login":"grafana","id":7195757,"node_id":"MDEyOk9yZ2FuaXphdGlvbjcxOTU3NTc=","avatar_url":"https://avatars.githubusercontent.com/u/7195757?v=4","gravatar_id":"","url":"https://api.github.com/users/grafana","html_url":"https://github.com/grafana","followers_url":"https://api.github.com/users/grafana/followers","following_url":"https://api.github.com/users/grafana/following{/other_user}","gists_url":"https://api.github.com/users/grafana/gists{/gist_id}","starred_url":"https://api.github.com/users/grafana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/grafana/subscriptions","organizations_url":"https://api.github.com/users/grafana/orgs","repos_url":"https://api.github.com/users/grafana/repos","events_url":"https://api.github.com/users/grafana/events{/privacy}","received_events_url":"https://api.github.com/users/grafana/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/grafana/k6","description":"A modern load testing tool, using Go and JavaScript","fork":false,"url":"https://api.github.com/repos/grafana/k6","forks_url":"https://api.github.com/repos/grafana/k6/forks","keys_url":"https://api.github.com/repos/grafana/k6/keys{/key_id}","collaborators_url":"https://api.github.com/repos/grafana/k6/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/grafana/k6/teams","hooks_url":"https://api.github.com/repos/grafana/k6/hooks","issue_events_url":"https://api.github.com/repos/grafana/k6/issues/events{/number}","events_url":"https://api.github.com/repos/grafana/k6/events","assignees_url":"https://api.github.com/repos/grafana/k6/assignees{/user}","branches_url":"https://api.github.com/repos/grafana/k6/branches{/branch}","tags_url":"https://api.github.com/repos/grafana/k6/tags","blobs_url":"https://api.github.com/repos/grafana/k6/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/grafana/k6/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/grafana/k6/git/refs{/sha}","trees_url":"https://api.github.com/repos/grafana/k6/git/trees{/sha}","statuses_url":"https://api.github.com/repos/grafana/k6/statuses/{sha}","languages_url":"https://api.github.com/repos/grafana/k6/languages","stargazers_url":"https://api.github.com/repos/grafana/k6/stargazers","contributors_url":"https://api.github.com/repos/grafana/k6/contributors","subscribers_url":"https://api.github.com/repos/grafana/k6/subscribers","subscription_url":"https://api.github.com/repos/grafana/k6/subscription","commits_url":"https://api.github.com/repos/grafana/k6/commits{/sha}","git_commits_url":"https://api.github.com/repos/grafana/k6/git/commits{/sha}","comments_url":"https://api.github.com/repos/grafana/k6/comments{/number}","issue_comment_url":"https://api.github.com/repos/grafana/k6/issues/comments{/number}","contents_url":"https://api.github.com/repos/grafana/k6/contents/{+path}","compare_url":"https://api.github.com/repos/grafana/k6/compare/{base}...{head}","merges_url":"https://api.github.com/repos/grafana/k6/merges","archive_url":"https://api.github.com/repos/grafana/k6/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/grafana/k6/downloads","issues_url":"https://api.github.com/repos/grafana/k6/issues{/number}","pulls_url":"https://api.github.com/repos/grafana/k6/pulls{/number}","milestones_url":"https://api.github.com/repos/grafana/k6/milestones{/number}","notifications_url":"https://api.github.com/repos/grafana/k6/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/grafana/k6/labels{/name}","releases_url":"https://api.github.com/repos/grafana/k6/releases{/id}","deployments_url":"https://api.github.com/repos/grafana/k6/deployments","created_at":"2016-03-21T15:30:24Z","updated_at":"2025-11-09T22:33:24Z","pushed_at":"2025-11-09T15:40:01Z","git_url":"git://github.com/grafana/k6.git","ssh_url":"git@github.com:grafana/k6.git","clone_url":"https://github.com/grafana/k6.git","svn_url":"https://github.com/grafana/k6","homepage":"https://grafana.com/oss/k6/","size":68631,"stargazers_count":29152,"watchers_count":29152,"language":"Go","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1447,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":760,"license":{"key":"agpl-3.0","name":"GNU Affero General Public License v3.0","spdx_id":"AGPL-3.0","url":"https://api.github.com/licenses/agpl-3.0","node_id":"MDc6TGljZW5zZTE="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["es6","go","golang","hacktoberfest","javascript","k6","load-generator","load-testing","performance"],"visibility":"public","forks":1447,"open_issues":760,"watchers":29152,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/grafana/k6/pulls/2314","html_url":"https://github.com/grafana/k6/pull/2314","diff_url":"https://github.com/grafana/k6/pull/2314.diff","patch_url":"https://github.com/grafana/k6/pull/2314.patch","merged_at":"2022-01-12T10:27:49Z"},"body":"Implementing a limitation for the open() that limits opening files\r\nby the list of the files that were opened during the initialization\r\nstep (__VU == 0).\r\n\r\nFor example, a code like:\r\n\r\n```js\r\nif (__VU >0) {\r\n   JSON.parse(open(\"./arr.json\"));\r\n}\r\n```\r\n\r\nShould return an error.\r\n\r\nCloses #1771\r\n","reactions":{"url":"https://api.github.com/repos/grafana/k6/issues/2314/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/grafana/k6/issues/2314/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":5872272848,"node_id":"REFE_lADOAz4Wr84tvWuozwAAAAFeA8XQ","url":"https://api.github.com/repos/grafana/k6/issues/events/5872272848","actor":{"login":"olegbespalov","id":5425600,"node_id":"MDQ6VXNlcjU0MjU2MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5425600?v=4","gravatar_id":"","url":"https://api.github.com/users/olegbespalov","html_url":"https://github.com/olegbespalov","followers_url":"https://api.github.com/users/olegbespalov/followers","following_url":"https://api.github.com/users/olegbespalov/following{/other_user}","gists_url":"https://api.github.com/users/olegbespalov/gists{/gist_id}","starred_url":"https://api.github.com/users/olegbespalov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/olegbespalov/subscriptions","organizations_url":"https://api.github.com/users/olegbespalov/orgs","repos_url":"https://api.github.com/users/olegbespalov/repos","events_url":"https://api.github.com/users/olegbespalov/events{/privacy}","received_events_url":"https://api.github.com/users/olegbespalov/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"2c4ae558df5bff4392f914e1af41df452446214e","commit_url":"https://api.github.com/repos/grafana/k6/commits/2c4ae558df5bff4392f914e1af41df452446214e","created_at":"2022-01-11T11:02:43Z","performed_via_github_app":null},{"id":5875014313,"node_id":"REFE_lADOAz4Wr84tvWuozwAAAAFeLZqp","url":"https://api.github.com/repos/grafana/k6/issues/events/5875014313","actor":{"login":"olegbespalov","id":5425600,"node_id":"MDQ6VXNlcjU0MjU2MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5425600?v=4","gravatar_id":"","url":"https://api.github.com/users/olegbespalov","html_url":"https://github.com/olegbespalov","followers_url":"https://api.github.com/users/olegbespalov/followers","following_url":"https://api.github.com/users/olegbespalov/following{/other_user}","gists_url":"https://api.github.com/users/olegbespalov/gists{/gist_id}","starred_url":"https://api.github.com/users/olegbespalov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/olegbespalov/subscriptions","organizations_url":"https://api.github.com/users/olegbespalov/orgs","repos_url":"https://api.github.com/users/olegbespalov/repos","events_url":"https://api.github.com/users/olegbespalov/events{/privacy}","received_events_url":"https://api.github.com/users/olegbespalov/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"9799eca3277160199d765aa2bda330d1791fbb22","commit_url":"https://api.github.com/repos/grafana/k6/commits/9799eca3277160199d765aa2bda330d1791fbb22","created_at":"2022-01-11T17:03:49Z","performed_via_github_app":null},{"id":5879280399,"node_id":"CE_lADOAz4Wr84tvWuozwAAAAFebrMP","url":"https://api.github.com/repos/grafana/k6/issues/events/5879280399","actor":{"login":"olegbespalov","id":5425600,"node_id":"MDQ6VXNlcjU0MjU2MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5425600?v=4","gravatar_id":"","url":"https://api.github.com/users/olegbespalov","html_url":"https://github.com/olegbespalov","followers_url":"https://api.github.com/users/olegbespalov/followers","following_url":"https://api.github.com/users/olegbespalov/following{/other_user}","gists_url":"https://api.github.com/users/olegbespalov/gists{/gist_id}","starred_url":"https://api.github.com/users/olegbespalov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/olegbespalov/subscriptions","organizations_url":"https://api.github.com/users/olegbespalov/orgs","repos_url":"https://api.github.com/users/olegbespalov/repos","events_url":"https://api.github.com/users/olegbespalov/events{/privacy}","received_events_url":"https://api.github.com/users/olegbespalov/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-01-12T10:27:49Z","state_reason":null,"performed_via_github_app":null},{"id":5879280717,"node_id":"REFE_lADOAz4Wr84tvWuozwAAAAFebrRN","url":"https://api.github.com/repos/grafana/k6/issues/events/5879280717","actor":{"login":"olegbespalov","id":5425600,"node_id":"MDQ6VXNlcjU0MjU2MDA=","avatar_url":"https://avatars.githubusercontent.com/u/5425600?v=4","gravatar_id":"","url":"https://api.github.com/users/olegbespalov","html_url":"https://github.com/olegbespalov","followers_url":"https://api.github.com/users/olegbespalov/followers","following_url":"https://api.github.com/users/olegbespalov/following{/other_user}","gists_url":"https://api.github.com/users/olegbespalov/gists{/gist_id}","starred_url":"https://api.github.com/users/olegbespalov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/olegbespalov/subscriptions","organizations_url":"https://api.github.com/users/olegbespalov/orgs","repos_url":"https://api.github.com/users/olegbespalov/repos","events_url":"https://api.github.com/users/olegbespalov/events{/privacy}","received_events_url":"https://api.github.com/users/olegbespalov/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"57ec74135494d38cd569b38b79342fe820d5dab8","commit_url":"https://api.github.com/repos/grafana/k6/commits/57ec74135494d38cd569b38b79342fe820d5dab8","created_at":"2022-01-12T10:27:52Z","performed_via_github_app":null},{"actor":{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-10T15:25:57Z","updated_at":"2023-10-10T15:25:57Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/grafana/k6/issues/3358","repository_url":"https://api.github.com/repos/grafana/k6","labels_url":"https://api.github.com/repos/grafana/k6/issues/3358/labels{/name}","comments_url":"https://api.github.com/repos/grafana/k6/issues/3358/comments","events_url":"https://api.github.com/repos/grafana/k6/issues/3358/events","html_url":"https://github.com/grafana/k6/pull/3358","id":1917746746,"node_id":"PR_kwDOAz4Wr85bdOXq","number":3358,"title":"Add a design document proposal to support open in VU context","user":{"login":"oleiade","id":690867,"node_id":"MDQ6VXNlcjY5MDg2Nw==","avatar_url":"https://avatars.githubusercontent.com/u/690867?v=4","gravatar_id":"","url":"https://api.github.com/users/oleiade","html_url":"https://github.com/oleiade","followers_url":"https://api.github.com/users/oleiade/followers","following_url":"https://api.github.com/users/oleiade/following{/other_user}","gists_url":"https://api.github.com/users/oleiade/gists{/gist_id}","starred_url":"https://api.github.com/users/oleiade/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oleiade/subscriptions","organizations_url":"https://api.github.com/users/oleiade/orgs","repos_url":"https://api.github.com/users/oleiade/repos","events_url":"https://api.github.com/users/oleiade/events{/privacy}","received_events_url":"https://api.github.com/users/oleiade/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":759076521,"node_id":"MDU6TGFiZWw3NTkwNzY1MjE=","url":"https://api.github.com/repos/grafana/k6/labels/docs","name":"docs","color":"1AE598","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2023-09-28T15:05:14Z","updated_at":"2025-08-04T08:00:37Z","closed_at":"2024-11-06T10:40:34Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":54400687,"node_id":"MDEwOlJlcG9zaXRvcnk1NDQwMDY4Nw==","name":"k6","full_name":"grafana/k6","private":false,"owner":{"login":"grafana","id":7195757,"node_id":"MDEyOk9yZ2FuaXphdGlvbjcxOTU3NTc=","avatar_url":"https://avatars.githubusercontent.com/u/7195757?v=4","gravatar_id":"","url":"https://api.github.com/users/grafana","html_url":"https://github.com/grafana","followers_url":"https://api.github.com/users/grafana/followers","following_url":"https://api.github.com/users/grafana/following{/other_user}","gists_url":"https://api.github.com/users/grafana/gists{/gist_id}","starred_url":"https://api.github.com/users/grafana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/grafana/subscriptions","organizations_url":"https://api.github.com/users/grafana/orgs","repos_url":"https://api.github.com/users/grafana/repos","events_url":"https://api.github.com/users/grafana/events{/privacy}","received_events_url":"https://api.github.com/users/grafana/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/grafana/k6","description":"A modern load testing tool, using Go and JavaScript","fork":false,"url":"https://api.github.com/repos/grafana/k6","forks_url":"https://api.github.com/repos/grafana/k6/forks","keys_url":"https://api.github.com/repos/grafana/k6/keys{/key_id}","collaborators_url":"https://api.github.com/repos/grafana/k6/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/grafana/k6/teams","hooks_url":"https://api.github.com/repos/grafana/k6/hooks","issue_events_url":"https://api.github.com/repos/grafana/k6/issues/events{/number}","events_url":"https://api.github.com/repos/grafana/k6/events","assignees_url":"https://api.github.com/repos/grafana/k6/assignees{/user}","branches_url":"https://api.github.com/repos/grafana/k6/branches{/branch}","tags_url":"https://api.github.com/repos/grafana/k6/tags","blobs_url":"https://api.github.com/repos/grafana/k6/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/grafana/k6/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/grafana/k6/git/refs{/sha}","trees_url":"https://api.github.com/repos/grafana/k6/git/trees{/sha}","statuses_url":"https://api.github.com/repos/grafana/k6/statuses/{sha}","languages_url":"https://api.github.com/repos/grafana/k6/languages","stargazers_url":"https://api.github.com/repos/grafana/k6/stargazers","contributors_url":"https://api.github.com/repos/grafana/k6/contributors","subscribers_url":"https://api.github.com/repos/grafana/k6/subscribers","subscription_url":"https://api.github.com/repos/grafana/k6/subscription","commits_url":"https://api.github.com/repos/grafana/k6/commits{/sha}","git_commits_url":"https://api.github.com/repos/grafana/k6/git/commits{/sha}","comments_url":"https://api.github.com/repos/grafana/k6/comments{/number}","issue_comment_url":"https://api.github.com/repos/grafana/k6/issues/comments{/number}","contents_url":"https://api.github.com/repos/grafana/k6/contents/{+path}","compare_url":"https://api.github.com/repos/grafana/k6/compare/{base}...{head}","merges_url":"https://api.github.com/repos/grafana/k6/merges","archive_url":"https://api.github.com/repos/grafana/k6/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/grafana/k6/downloads","issues_url":"https://api.github.com/repos/grafana/k6/issues{/number}","pulls_url":"https://api.github.com/repos/grafana/k6/pulls{/number}","milestones_url":"https://api.github.com/repos/grafana/k6/milestones{/number}","notifications_url":"https://api.github.com/repos/grafana/k6/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/grafana/k6/labels{/name}","releases_url":"https://api.github.com/repos/grafana/k6/releases{/id}","deployments_url":"https://api.github.com/repos/grafana/k6/deployments","created_at":"2016-03-21T15:30:24Z","updated_at":"2025-11-09T22:33:24Z","pushed_at":"2025-11-09T15:40:01Z","git_url":"git://github.com/grafana/k6.git","ssh_url":"git@github.com:grafana/k6.git","clone_url":"https://github.com/grafana/k6.git","svn_url":"https://github.com/grafana/k6","homepage":"https://grafana.com/oss/k6/","size":68631,"stargazers_count":29152,"watchers_count":29152,"language":"Go","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1447,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":760,"license":{"key":"agpl-3.0","name":"GNU Affero General Public License v3.0","spdx_id":"AGPL-3.0","url":"https://api.github.com/licenses/agpl-3.0","node_id":"MDc6TGljZW5zZTE="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["es6","go","golang","hacktoberfest","javascript","k6","load-generator","load-testing","performance"],"visibility":"public","forks":1447,"open_issues":760,"watchers":29152,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/grafana/k6/pulls/3358","html_url":"https://github.com/grafana/k6/pull/3358","diff_url":"https://github.com/grafana/k6/pull/3358.diff","patch_url":"https://github.com/grafana/k6/pull/3358.patch","merged_at":null},"body":"This draft aims to address [#3020](https://github.com/grafana/k6/issues/3020), focusing on enabling k6 scripts to access files directly from the VU stage, not just the init stage.\r\n\r\nWhile the primary focus is on file access, I've currently left out considerations regarding `require` from [#3020](https://github.com/grafana/k6/issues/3020). If require should be part of this discussion, based on similar requirements or challenges, I'm more than open to updating the proposal to encompass it.\r\n\r\nIf you've got alternative solutions or insights, please contribute with a separate commit.\r\n\r\nI'm eager to hear your thoughts and feedback in the comments below. Thanks for taking the time to review! 🙇🏻","reactions":{"url":"https://api.github.com/repos/grafana/k6/issues/3358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/grafana/k6/issues/3358/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"}]