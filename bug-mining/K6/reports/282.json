{"url":"https://api.github.com/repos/grafana/k6/issues/5127","repository_url":"https://api.github.com/repos/grafana/k6","labels_url":"https://api.github.com/repos/grafana/k6/issues/5127/labels{/name}","comments_url":"https://api.github.com/repos/grafana/k6/issues/5127/comments","events_url":"https://api.github.com/repos/grafana/k6/issues/5127/events","html_url":"https://github.com/grafana/k6/issues/5127","id":3380118192,"node_id":"I_kwDOAz4Wr87JeIKw","number":5127,"title":"Syntax errors with binary provisioning enabled cause k6 to exit with 255 instead of 107","user":{"login":"nadiamoe","id":969721,"node_id":"MDQ6VXNlcjk2OTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/969721?v=4","gravatar_id":"","url":"https://api.github.com/users/nadiamoe","html_url":"https://github.com/nadiamoe","followers_url":"https://api.github.com/users/nadiamoe/followers","following_url":"https://api.github.com/users/nadiamoe/following{/other_user}","gists_url":"https://api.github.com/users/nadiamoe/gists{/gist_id}","starred_url":"https://api.github.com/users/nadiamoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nadiamoe/subscriptions","organizations_url":"https://api.github.com/users/nadiamoe/orgs","repos_url":"https://api.github.com/users/nadiamoe/repos","events_url":"https://api.github.com/users/nadiamoe/events{/privacy}","received_events_url":"https://api.github.com/users/nadiamoe/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":345191758,"node_id":"MDU6TGFiZWwzNDUxOTE3NTg=","url":"https://api.github.com/repos/grafana/k6/labels/bug","name":"bug","color":"b60205","default":true,"description":""},{"id":5881916984,"node_id":"LA_kwDOAz4Wr88AAAABXpbuOA","url":"https://api.github.com/repos/grafana/k6/labels/triage","name":"triage","color":"2ee8ff","default":false,"description":""},{"id":9257968976,"node_id":"LA_kwDOAz4Wr88AAAACJ9FlUA","url":"https://api.github.com/repos/grafana/k6/labels/area:%20Auto%20Extension%20Resolution","name":"area: Auto Extension Resolution","color":"88b5c4","default":false,"description":"Previously known as binary provisioning."}],"state":"closed","locked":false,"assignee":{"login":"oleiade","id":690867,"node_id":"MDQ6VXNlcjY5MDg2Nw==","avatar_url":"https://avatars.githubusercontent.com/u/690867?v=4","gravatar_id":"","url":"https://api.github.com/users/oleiade","html_url":"https://github.com/oleiade","followers_url":"https://api.github.com/users/oleiade/followers","following_url":"https://api.github.com/users/oleiade/following{/other_user}","gists_url":"https://api.github.com/users/oleiade/gists{/gist_id}","starred_url":"https://api.github.com/users/oleiade/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oleiade/subscriptions","organizations_url":"https://api.github.com/users/oleiade/orgs","repos_url":"https://api.github.com/users/oleiade/repos","events_url":"https://api.github.com/users/oleiade/events{/privacy}","received_events_url":"https://api.github.com/users/oleiade/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"oleiade","id":690867,"node_id":"MDQ6VXNlcjY5MDg2Nw==","avatar_url":"https://avatars.githubusercontent.com/u/690867?v=4","gravatar_id":"","url":"https://api.github.com/users/oleiade","html_url":"https://github.com/oleiade","followers_url":"https://api.github.com/users/oleiade/followers","following_url":"https://api.github.com/users/oleiade/following{/other_user}","gists_url":"https://api.github.com/users/oleiade/gists{/gist_id}","starred_url":"https://api.github.com/users/oleiade/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oleiade/subscriptions","organizations_url":"https://api.github.com/users/oleiade/orgs","repos_url":"https://api.github.com/users/oleiade/repos","events_url":"https://api.github.com/users/oleiade/events{/privacy}","received_events_url":"https://api.github.com/users/oleiade/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":1,"created_at":"2025-09-03T14:34:53Z","updated_at":"2025-10-28T09:25:01Z","closed_at":"2025-10-28T09:25:01Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Brief summary\n\nk6 used to exit with code 107 when presented with a script that contains a syntax error, such as https://github.com/grafana/sm-k6-runner/blob/949c68681e504287471cb728185d74c1b0e61fce/internal/integration/integration_test.go#L601-L604. Now it does not, and it exits with 255 instead.\n\nExit codes above 128 are usually reserved to the process terminating very abnormally due to unhandled signals.\n\n\n### k6 version\n\nk6 v1.2.3 (commit/e4a5a88f7c, go1.24.6, linux/amd64)\n\n### OS\n\nArch linux (btw)\n\n### Docker version and image (if applicable)\n\n_No response_\n\n### Steps to reproduce the problem\n\n`k6 run` the following script:\n\n```js\nexport default function () {\n  console.log(\"Hi there, I'm a log line!\");\n  if {\n}\n```\n\n### Expected behaviour\n\n```\nnadia@Nadiarch 󱃾 curry-admin@Curry\n16:33:14 ~ $> clippaste | K6_AUTO_EXTENSION_RESOLUTION=false k6 run - --verbose\nDEBU[0000] Logger format: TEXT\nDEBU[0000] k6 version: v1.2.3 (commit/e4a5a88f7c, go1.24.6, linux/amd64)\nDEBU[0000] Automatic extension resolution is disabled.\n\n         /\\      Grafana   /‾‾/\n    /\\  /  \\     |\\  __   /  /\n   /  \\/    \\    | |/ /  /   ‾‾\\\n  /          \\   |   (  |  (‾)  |\n / __________ \\  |_|\\_\\  \\_____/\n\nDEBU[0000] Resolving and reading test '-'...\nDEBU[0000] '-' resolved to 'file:///-' and successfully loaded 81 bytes!\nDEBU[0000] Gathering k6 runtime options...\nDEBU[0000] Initializing k6 runner for '-' (file:///-)...\nDEBU[0000] Detecting test type for...                    test_path=\"file:///-\"\nDEBU[0000] Trying to load as a JS test...                test_path=\"file:///-\"\nDEBU[0000] Everything has finished, exiting k6 with an error!  error=\"could not initialize '-': could not load JS test 'file:///-': GoError: file:///-: Line 3:6 Unexpected token { (and 4 more errors)\\n\"\nERRO[0000] GoError: file:///-: Line 3:6 Unexpected token { (and 4 more errors)  hint=\"script exception\"\n\nnadia@Nadiarch 󱃾 curry-admin@Curry\n16:33:14 ~ $> echo $?\n107\n```\n\n### Actual behaviour\n\n```\nnadia@Nadiarch 󱃾 curry-admin@Curry\n16:32:36 ~ $> clippaste | k6 run - --verbose\nDEBU[0000] Logger format: TEXT\nDEBU[0000] k6 version: v1.2.3 (commit/e4a5a88f7c, go1.24.6, linux/amd64)\nDEBU[0000] Automatic extension resolution is enabled.\nDEBU[0000] Launcher is resolving and reading the test's script  source=sourceRootPath\nERRO[0000] Automatic extension resolution is enabled but it failed to analyze the dependencies. Please, make sure to report this issue by opening a bug report.  error=\"-:3:5 Expected \\\"(\\\" but found \\\"{\\\"\"\nERRO[0000] -:3:5 Expected \"(\" but found \"{\"\n\nnadia@Nadiarch 󱃾 curry-admin@Curry\n16:32:39 ~ $> echo $?\n255\n```","closed_by":{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/grafana/k6/issues/5127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/grafana/k6/issues/5127/timeline","performed_via_github_app":null,"state_reason":"completed"}