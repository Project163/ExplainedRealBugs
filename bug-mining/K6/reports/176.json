{"url":"https://api.github.com/repos/grafana/k6/issues/1713","repository_url":"https://api.github.com/repos/grafana/k6","labels_url":"https://api.github.com/repos/grafana/k6/issues/1713/labels{/name}","comments_url":"https://api.github.com/repos/grafana/k6/issues/1713/comments","events_url":"https://api.github.com/repos/grafana/k6/issues/1713/events","html_url":"https://github.com/grafana/k6/issues/1713","id":738243757,"node_id":"MDU6SXNzdWU3MzgyNDM3NTc=","number":1713,"title":"samples html_form_post.js fails","user":{"login":"stevenebutler","id":16790181,"node_id":"MDQ6VXNlcjE2NzkwMTgx","avatar_url":"https://avatars.githubusercontent.com/u/16790181?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenebutler","html_url":"https://github.com/stevenebutler","followers_url":"https://api.github.com/users/stevenebutler/followers","following_url":"https://api.github.com/users/stevenebutler/following{/other_user}","gists_url":"https://api.github.com/users/stevenebutler/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenebutler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenebutler/subscriptions","organizations_url":"https://api.github.com/users/stevenebutler/orgs","repos_url":"https://api.github.com/users/stevenebutler/repos","events_url":"https://api.github.com/users/stevenebutler/events{/privacy}","received_events_url":"https://api.github.com/users/stevenebutler/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":345191758,"node_id":"MDU6TGFiZWwzNDUxOTE3NTg=","url":"https://api.github.com/repos/grafana/k6/labels/bug","name":"bug","color":"b60205","default":true,"description":""},{"id":774850989,"node_id":"MDU6TGFiZWw3NzQ4NTA5ODk=","url":"https://api.github.com/repos/grafana/k6/labels/good%20first%20issue","name":"good first issue","color":"bfd4f2","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/grafana/k6/milestones/16","html_url":"https://github.com/grafana/k6/milestone/16","labels_url":"https://api.github.com/repos/grafana/k6/milestones/16/labels","id":6555532,"node_id":"MDk6TWlsZXN0b25lNjU1NTUzMg==","number":16,"title":"v0.33.0","description":"","creator":{"login":"na--","id":3336773,"node_id":"MDQ6VXNlcjMzMzY3NzM=","avatar_url":"https://avatars.githubusercontent.com/u/3336773?v=4","gravatar_id":"","url":"https://api.github.com/users/na--","html_url":"https://github.com/na--","followers_url":"https://api.github.com/users/na--/followers","following_url":"https://api.github.com/users/na--/following{/other_user}","gists_url":"https://api.github.com/users/na--/gists{/gist_id}","starred_url":"https://api.github.com/users/na--/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/na--/subscriptions","organizations_url":"https://api.github.com/users/na--/orgs","repos_url":"https://api.github.com/users/na--/repos","events_url":"https://api.github.com/users/na--/events{/privacy}","received_events_url":"https://api.github.com/users/na--/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":36,"state":"closed","created_at":"2021-03-17T07:56:14Z","updated_at":"2021-07-01T07:31:57Z","due_on":"2021-06-29T07:00:00Z","closed_at":"2021-07-01T07:31:57Z"},"comments":2,"created_at":"2020-11-07T13:34:10Z","updated_at":"2021-06-15T15:40:03Z","closed_at":"2021-06-15T15:40:03Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"\r\nK6 http.post method isn't correctly encoding a list of values assigned to a key in an object.\r\n\r\n```javascript\r\nconst form_data = {\r\n    comment: \"Hello world!\",\r\n    topping: [\r\n        'onion',\r\n        'bacon',\r\n        'cheese'\r\n    ]\r\n};\r\n```\r\nThe simplest way to see this is to run the sample at \r\nhttps://github.com/loadimpact/k6/blob/master/samples/html_form_post.js and note that it fails.\r\n\r\nThe list of toppings should be passed as multiple values for the same key, but it is instead having the values stringified and passed as one value.\r\n\r\nWith this issue, it's difficult to pass multiple select check boxes with the same name or multi-selections in a select.\r\n\r\n\r\n\r\n## Environment\r\n- k6 version: k6 v0.28.0 (2020-09-24T14:33:59+0000/v0.28.0-0-gdee9c4ce, go1.14.9, linux/amd64)\r\n- OS and version: Both windows 10 and Linux K6\r\n- Docker version and image, if applicable:\r\n\r\n\r\n## Expected Behavior\r\n\r\nThe topping values should be encoded as\r\ntopping=onion&topping=bacon&topping=cheese\r\nand the sample should pass all checks.\r\n\r\n## Actual Behavior\r\n\r\nTest case fails because the topping values are encoded as (and URI encoded)\r\ntopping=[onion bacon cheese]\r\n\r\n\r\n## Steps to Reproduce the Problem\r\n<!--- Provide the exact commands, environment variables and relevant script(s) to reproduce this bug. -->\r\n\r\n1. Copy sample from https://github.com/loadimpact/k6/blob/master/samples/html_form_post.js locally or clone the git repository\r\n2. k6 run samples/html_form_post.js\r\n3. Observe test failure outcome\r\n","closed_by":{"login":"imiric","id":1009277,"node_id":"MDQ6VXNlcjEwMDkyNzc=","avatar_url":"https://avatars.githubusercontent.com/u/1009277?v=4","gravatar_id":"","url":"https://api.github.com/users/imiric","html_url":"https://github.com/imiric","followers_url":"https://api.github.com/users/imiric/followers","following_url":"https://api.github.com/users/imiric/following{/other_user}","gists_url":"https://api.github.com/users/imiric/gists{/gist_id}","starred_url":"https://api.github.com/users/imiric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imiric/subscriptions","organizations_url":"https://api.github.com/users/imiric/orgs","repos_url":"https://api.github.com/users/imiric/repos","events_url":"https://api.github.com/users/imiric/events{/privacy}","received_events_url":"https://api.github.com/users/imiric/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/grafana/k6/issues/1713/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/grafana/k6/issues/1713/timeline","performed_via_github_app":null,"state_reason":"completed"}