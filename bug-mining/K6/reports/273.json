{"url":"https://api.github.com/repos/grafana/k6/issues/4139","repository_url":"https://api.github.com/repos/grafana/k6","labels_url":"https://api.github.com/repos/grafana/k6/issues/4139/labels{/name}","comments_url":"https://api.github.com/repos/grafana/k6/issues/4139/comments","events_url":"https://api.github.com/repos/grafana/k6/issues/4139/events","html_url":"https://github.com/grafana/k6/issues/4139","id":2750719868,"node_id":"I_kwDOAz4Wr86j9Kd8","number":4139,"title":"Secrets Source extensions","user":{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":0,"created_at":"2024-12-19T15:37:53Z","updated_at":"2025-03-11T09:20:06Z","closed_at":"2025-03-11T09:20:06Z","author_association":"CONTRIBUTOR","type":{"id":24554734,"node_id":"IT_kwDOAG3Mbc4Bdqzu","name":"Feature","description":"Features are smaller than epics and bigger than tasks. They represent a piece of the whole functionality, but may require more than one task to be completed.","color":"green","created_at":"2024-12-04T15:44:26Z","updated_at":"2024-12-04T15:44:26Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## What?\n\nImplement a way to get secrets from extensible sources and hide them in logs.\n\nThis is implementation proposal for https://github.com/grafana/k6/issues/3207 \n\n### Public API\n\n#### Configuration\n\nnew cli flag `--secret-source` to add a secret source to k6. \n\nWhich takes a secret source name, and identifier and additional configuration.\n`--secret-source=sourcename=identifier,option1=value1,option2=value2`\n\n### JS API\n\n(the exist import is under consideration)\n\n```javascript\nimport secrets from \"k6/secrets\";  \n  \nexport default async () => {  \n    const my_secret = await secrets.get(\"my_secret\"); // get from 1 secret source if only 1, exception if more than 1 secret source or if no secret sources\n    console.log(my_secret);  \n}\n```\n\n```javascript\nimport secrets from \"k6/secrets\";  \n  \nexport default async () => {  \n    const my_secret = await secrets.source(\"identifier\").get(\"my_secret\"); // get secret from a source with the provided identifier\n    console.log(my_secret);\n}\n```\n\nNo other functionality is currently planned.\n\n### Go implementation details\n\nPluggable similar to output and js extensions. With minimal configuration.\n\nCentralized log sanitization - k6 will see each secret passing and will start sanitizing logs for those values it has seen. This does mean that secret sources have less responsibilities and it is less likely for bugs.\n\n#### Built in sources:\n##### File based on\nThis is mostly for ease of use for development, but it just reads a text file with key=value pairs\n\n##### REST API based on\nFor now very simple one with a url + headers, potentially with templating for the *key* of the secret requests. Potentially other options later\n","closed_by":{"login":"mstoykov","id":312246,"node_id":"MDQ6VXNlcjMxMjI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/312246?v=4","gravatar_id":"","url":"https://api.github.com/users/mstoykov","html_url":"https://github.com/mstoykov","followers_url":"https://api.github.com/users/mstoykov/followers","following_url":"https://api.github.com/users/mstoykov/following{/other_user}","gists_url":"https://api.github.com/users/mstoykov/gists{/gist_id}","starred_url":"https://api.github.com/users/mstoykov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mstoykov/subscriptions","organizations_url":"https://api.github.com/users/mstoykov/orgs","repos_url":"https://api.github.com/users/mstoykov/repos","events_url":"https://api.github.com/users/mstoykov/events{/privacy}","received_events_url":"https://api.github.com/users/mstoykov/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/grafana/k6/issues/4139/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"timeline_url":"https://api.github.com/repos/grafana/k6/issues/4139/timeline","performed_via_github_app":null,"state_reason":"completed"}