{"url":"https://api.github.com/repos/goreleaser/goreleaser/issues/5436","repository_url":"https://api.github.com/repos/goreleaser/goreleaser","labels_url":"https://api.github.com/repos/goreleaser/goreleaser/issues/5436/labels{/name}","comments_url":"https://api.github.com/repos/goreleaser/goreleaser/issues/5436/comments","events_url":"https://api.github.com/repos/goreleaser/goreleaser/issues/5436/events","html_url":"https://github.com/goreleaser/goreleaser/issues/5436","id":2781308330,"node_id":"I_kwDOBJgEXs6lx2Wq","number":5436,"title":"Add archive format instead of overriding it","user":{"login":"klaernie","id":5636383,"node_id":"MDQ6VXNlcjU2MzYzODM=","avatar_url":"https://avatars.githubusercontent.com/u/5636383?v=4","gravatar_id":"","url":"https://api.github.com/users/klaernie","html_url":"https://github.com/klaernie","followers_url":"https://api.github.com/users/klaernie/followers","following_url":"https://api.github.com/users/klaernie/following{/other_user}","gists_url":"https://api.github.com/users/klaernie/gists{/gist_id}","starred_url":"https://api.github.com/users/klaernie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/klaernie/subscriptions","organizations_url":"https://api.github.com/users/klaernie/orgs","repos_url":"https://api.github.com/users/klaernie/repos","events_url":"https://api.github.com/users/klaernie/events{/privacy}","received_events_url":"https://api.github.com/users/klaernie/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":504976499,"node_id":"MDU6TGFiZWw1MDQ5NzY0OTk=","url":"https://api.github.com/repos/goreleaser/goreleaser/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":"New feature or request"}],"state":"closed","locked":false,"assignee":{"login":"caarlos0","id":245435,"node_id":"MDQ6VXNlcjI0NTQzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/245435?v=4","gravatar_id":"","url":"https://api.github.com/users/caarlos0","html_url":"https://github.com/caarlos0","followers_url":"https://api.github.com/users/caarlos0/followers","following_url":"https://api.github.com/users/caarlos0/following{/other_user}","gists_url":"https://api.github.com/users/caarlos0/gists{/gist_id}","starred_url":"https://api.github.com/users/caarlos0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/caarlos0/subscriptions","organizations_url":"https://api.github.com/users/caarlos0/orgs","repos_url":"https://api.github.com/users/caarlos0/repos","events_url":"https://api.github.com/users/caarlos0/events{/privacy}","received_events_url":"https://api.github.com/users/caarlos0/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"caarlos0","id":245435,"node_id":"MDQ6VXNlcjI0NTQzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/245435?v=4","gravatar_id":"","url":"https://api.github.com/users/caarlos0","html_url":"https://github.com/caarlos0","followers_url":"https://api.github.com/users/caarlos0/followers","following_url":"https://api.github.com/users/caarlos0/following{/other_user}","gists_url":"https://api.github.com/users/caarlos0/gists{/gist_id}","starred_url":"https://api.github.com/users/caarlos0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/caarlos0/subscriptions","organizations_url":"https://api.github.com/users/caarlos0/orgs","repos_url":"https://api.github.com/users/caarlos0/repos","events_url":"https://api.github.com/users/caarlos0/events{/privacy}","received_events_url":"https://api.github.com/users/caarlos0/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":5,"created_at":"2025-01-10T22:24:02Z","updated_at":"2025-01-19T20:35:57Z","closed_at":"2025-01-19T20:35:57Z","author_association":"NONE","type":{"id":5584135,"node_id":"IT_kwDOAXjZGM4AVTUH","name":"Feature","description":"A request, idea, or new functionality","color":"blue","created_at":"2024-01-30T07:57:26Z","updated_at":"2024-10-08T12:12:30Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Is your feature request related to a problem? Please describe.\r\n\r\nIn [editorconfig-checker](https://github.com/editorconfig-checker/editorconfig-checker) we recently started using goreleaser. \r\n\r\nOne of the historic manual release process caveats is that we used to only provide .tar.gz archives, but later got asked to provide .zip archives for our windows users, since this obscure distribution has (or at least had at the time) no native support for .tar.gz. Using our previous manual process it was fairly easy to just create another compression step to build an additional archive with zip. This meant, that for the last couple releases we provided .tar.gz archives for all platforms, including windows, plus an additional archive with the windows build as a zip. \r\n\r\nIn the process of migrating to goreleaser I opted for the well documented pattern of building an archive defaulting to .tar.gz and overriding the format for `goos: windows`. This of course means, that we no longer generate a .tar.gz for windows. Unfortunately we have integrations into multiple language infrastructures to run our (Javascript, PHP, Python, GitHub Actions) which all will need adjusting. Since I missed this during the first release using goreleaser, our users rightfully complained that the integrations no longer work, since they expected a .tar.gz under windows, which was not present in our releases.\r\n\r\nSo IÂ resorted to duplicating the archive definition in order to provide both archives types.\r\nBut with this we now also have releases in zip format for all non-windows platforms, which use disk space and make the already extensive list of archives more cumbersome for users not knowing exactly what they are looking for.\r\n\r\n### Describe the solution you'd like\r\n\r\nIdeally I'd like specify for a `format_override` that the override should be generated in addition, not as a replacement. This way one would only need one instance under `archive:` , adding `format_overrides:` for each additional format needed.\r\n\r\nExample how a  config doing this could look like (the last line is the example):\r\n```yaml\r\narchives:\r\n  - id: archive-ec\r\n    builds:\r\n      - ec-compat\r\n    format: tar.gz\r\n    name_template: >-\r\n      ec-{{- .Os }}-{{ .Arch }}{{- if .Arm }}v{{ .Arm }}{{ end }}\r\n    format_overrides:\r\n      - goos: windows\r\n        format: zip\r\n        add_format: true\r\n```\r\n\r\nIf that approach is not suitable, I think an option to restrict archives to specific platforms would be nice option too.\r\n\r\n### Describe alternatives you've considered\r\n\r\nI have not seen an option to restrict archives to a singular platform.\r\nI did consider to add an additional build restricted to the windows platform we would like a zip file for, duplicating the build but reducing the build matrix to the GOOS and GOARCH needed in the zip, then duplicating the archive for only this build, and excluding it from the nfpms and docker steps.\r\n\r\n### Search\r\n\r\n- [X] I did search for other open and closed issues before opening this\r\n\r\n### Supporter\r\n\r\n- [ ] I am a [sponsor](https://github.com/sponsors/caarlos0/) or a [Pro](https://goreleaser.com/pro) customer\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow this project's Code of Conduct\r\n\r\n### Additional context\r\n\r\nOur .goreleaser.yaml: https://github.com/editorconfig-checker/editorconfig-checker/blob/main/.goreleaser.yaml\r\nAs probably valuable information for reading it: we are currently gearing up to replace the binary name we distribute from `ec` to `editorconfig-checker` in our next major release. So we are currently building the binary twice, once with each name, and are building archives for both names using a different name template.","closed_by":{"login":"caarlos0","id":245435,"node_id":"MDQ6VXNlcjI0NTQzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/245435?v=4","gravatar_id":"","url":"https://api.github.com/users/caarlos0","html_url":"https://github.com/caarlos0","followers_url":"https://api.github.com/users/caarlos0/followers","following_url":"https://api.github.com/users/caarlos0/following{/other_user}","gists_url":"https://api.github.com/users/caarlos0/gists{/gist_id}","starred_url":"https://api.github.com/users/caarlos0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/caarlos0/subscriptions","organizations_url":"https://api.github.com/users/caarlos0/orgs","repos_url":"https://api.github.com/users/caarlos0/repos","events_url":"https://api.github.com/users/caarlos0/events{/privacy}","received_events_url":"https://api.github.com/users/caarlos0/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/goreleaser/goreleaser/issues/5436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/goreleaser/goreleaser/issues/5436/timeline","performed_via_github_app":null,"state_reason":"completed"}