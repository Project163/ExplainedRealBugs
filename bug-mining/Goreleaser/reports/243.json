{"url":"https://api.github.com/repos/goreleaser/goreleaser/issues/3945","repository_url":"https://api.github.com/repos/goreleaser/goreleaser","labels_url":"https://api.github.com/repos/goreleaser/goreleaser/issues/3945/labels{/name}","comments_url":"https://api.github.com/repos/goreleaser/goreleaser/issues/3945/comments","events_url":"https://api.github.com/repos/goreleaser/goreleaser/issues/3945/events","html_url":"https://github.com/goreleaser/goreleaser/issues/3945","id":1671530988,"node_id":"I_kwDOBJgEXs5joYns","number":3945,"title":"goreleaser 1.17.x broken in WSL with Docker Desktop installed","user":{"login":"hhromic","id":5802993,"node_id":"MDQ6VXNlcjU4MDI5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/5802993?v=4","gravatar_id":"","url":"https://api.github.com/users/hhromic","html_url":"https://github.com/hhromic","followers_url":"https://api.github.com/users/hhromic/followers","following_url":"https://api.github.com/users/hhromic/following{/other_user}","gists_url":"https://api.github.com/users/hhromic/gists{/gist_id}","starred_url":"https://api.github.com/users/hhromic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hhromic/subscriptions","organizations_url":"https://api.github.com/users/hhromic/orgs","repos_url":"https://api.github.com/users/hhromic/repos","events_url":"https://api.github.com/users/hhromic/events{/privacy}","received_events_url":"https://api.github.com/users/hhromic/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"caarlos0","id":245435,"node_id":"MDQ6VXNlcjI0NTQzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/245435?v=4","gravatar_id":"","url":"https://api.github.com/users/caarlos0","html_url":"https://github.com/caarlos0","followers_url":"https://api.github.com/users/caarlos0/followers","following_url":"https://api.github.com/users/caarlos0/following{/other_user}","gists_url":"https://api.github.com/users/caarlos0/gists{/gist_id}","starred_url":"https://api.github.com/users/caarlos0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/caarlos0/subscriptions","organizations_url":"https://api.github.com/users/caarlos0/orgs","repos_url":"https://api.github.com/users/caarlos0/repos","events_url":"https://api.github.com/users/caarlos0/events{/privacy}","received_events_url":"https://api.github.com/users/caarlos0/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"caarlos0","id":245435,"node_id":"MDQ6VXNlcjI0NTQzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/245435?v=4","gravatar_id":"","url":"https://api.github.com/users/caarlos0","html_url":"https://github.com/caarlos0","followers_url":"https://api.github.com/users/caarlos0/followers","following_url":"https://api.github.com/users/caarlos0/following{/other_user}","gists_url":"https://api.github.com/users/caarlos0/gists{/gist_id}","starred_url":"https://api.github.com/users/caarlos0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/caarlos0/subscriptions","organizations_url":"https://api.github.com/users/caarlos0/orgs","repos_url":"https://api.github.com/users/caarlos0/repos","events_url":"https://api.github.com/users/caarlos0/events{/privacy}","received_events_url":"https://api.github.com/users/caarlos0/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":5,"created_at":"2023-04-17T16:08:15Z","updated_at":"2023-07-20T10:09:23Z","closed_at":"2023-04-18T00:10:11Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### What happened?\n\nSince `1.17.0`, goreleaser does not work anymore under Windows Subsystem for Linux (WSL) with Docker Desktop installed.\r\nThe reason is this recent PR in goreleaser:\r\n* #3901\r\n\r\nWhich introduced the [automaxprocs](https://github.com/uber-go/automaxprocs) library into goreleaser, which does not currently work under WSL + Docker Desktop:\r\n* https://github.com/uber-go/automaxprocs/issues/65\r\n\r\nGoreleaser refuses to run because it cannot set GOMAXPROCS. See below in the reproduction case.\r\n\r\nThe problem should be solved in the automaxprocs library, but in the meantime goreleaser is unusable since 1.17.0 out of the box.\r\n\r\nA workaround is to provide an explicit GOMAXPROCS value as an environment variable. For example:\r\n```\r\n$ GOMAXPROCS=0 ./goreleaser  --version\r\ngoreleaser version 1.17.0\r\ncommit: ffefd6c4ae257d2e9aeccb5786ba66401cc1bd78\r\nbuilt at: 2023-04-10T11:56:39Z\r\nbuilt by: goreleaser\r\ngoos: linux\r\ngoarch: amd64\r\nmodule version: v1.17.0, checksum: h1:CcA7EOcljdYhpEY2MUI1je6swCTCAlubxZk1VCbPKBY=\r\n\r\nhttps://goreleaser.com\r\n```\n\n### How can we reproduce this?\n\nTo reproduce, just run this into a WSL session (with Docker Desktop also installed in the machine):\r\n```\r\n$ mkdir tmp\r\n$ cd tmp\r\n$ curl -sSL https://github.com/goreleaser/goreleaser/releases/download/v1.17.0/goreleaser_Linux_x86_64.tar.gz | tar zxvf -\r\n$ ./goreleaser --version\r\n  тип failed to set GOMAXPROCS                         error=invalid format for MountPoint: \"991 77 0:252 / /Docker/host rw,noatime - 9p drvfs rw,dirsync,aname=drvfs;path=C:\\\\Program Files\\\\Docker\\\\Docker\\\\resources;symlinkroot=/mnt/,mmap,access=client,msize=262144,trans=virtio\"\r\n```\r\n\n\n### goreleaser version\n\n```bash\ngoreleaser version 1.17.0\r\ncommit: ffefd6c4ae257d2e9aeccb5786ba66401cc1bd78\r\nbuilt at: 2023-04-10T11:56:39Z\r\nbuilt by: goreleaser\r\ngoos: linux\r\ngoarch: amd64\r\nmodule version: v1.17.0, checksum: h1:CcA7EOcljdYhpEY2MUI1je6swCTCAlubxZk1VCbPKBY=\r\n\r\nhttps://goreleaser.com\n```\n\n\n### GoReleaser Check\n\n- [X] goreleaser check shows no errors\n\n### Search\n\n- [X] I did search for other open and closed issues before opening this.\n\n### Code of Conduct\n\n- [X] I agree to follow this project's Code of Conduct\n\n### Additional context\n\n_No response_","closed_by":{"login":"caarlos0","id":245435,"node_id":"MDQ6VXNlcjI0NTQzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/245435?v=4","gravatar_id":"","url":"https://api.github.com/users/caarlos0","html_url":"https://github.com/caarlos0","followers_url":"https://api.github.com/users/caarlos0/followers","following_url":"https://api.github.com/users/caarlos0/following{/other_user}","gists_url":"https://api.github.com/users/caarlos0/gists{/gist_id}","starred_url":"https://api.github.com/users/caarlos0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/caarlos0/subscriptions","organizations_url":"https://api.github.com/users/caarlos0/orgs","repos_url":"https://api.github.com/users/caarlos0/repos","events_url":"https://api.github.com/users/caarlos0/events{/privacy}","received_events_url":"https://api.github.com/users/caarlos0/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/goreleaser/goreleaser/issues/3945/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/goreleaser/goreleaser/issues/3945/timeline","performed_via_github_app":null,"state_reason":"completed"}