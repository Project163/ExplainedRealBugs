diff --git a/release-notes/CREDITS b/release-notes/CREDITS
index cc5a52a..1ecffc2 100644
--- a/release-notes/CREDITS
+++ b/release-notes/CREDITS
@@ -21,3 +21,7 @@ David Moles (dmolesUC3@github)
 Mike Conley (conleym@github)
  * Reported #35: Carriage return (\r) dropped by `XMLStreamWriter` implementation
   (1.1.0)
+
+Michiel Borkent (borkdude@github)
+ * Reported #47: NPE when trying to parse document with DTD declaration
+  (1.2.1)
diff --git a/release-notes/VERSION b/release-notes/VERSION
index 03aeefb..0a2a36f 100644
--- a/release-notes/VERSION
+++ b/release-notes/VERSION
@@ -4,9 +4,11 @@ Project: aalto-xml
 = Releases
 ------------------------------------------------------------------------
 
-1.2.1 (not yet released)
+1.2.1 (31-May-2019)
 
-- Update `stax2-api` dependency to 4.2.0 (for JDK9 module info)
+#47: NPE when trying to parse document with DTD declaration
+ (reported by Michiel B)
+- Update `stax2-api` dependency to 4.2 (for JDK9 module info)
 
 1.2.0 (12-Mar-2019)
 
diff --git a/src/main/java/com/fasterxml/aalto/in/Utf8Scanner.java b/src/main/java/com/fasterxml/aalto/in/Utf8Scanner.java
index 501719e..28080c6 100644
--- a/src/main/java/com/fasterxml/aalto/in/Utf8Scanner.java
+++ b/src/main/java/com/fasterxml/aalto/in/Utf8Scanner.java
@@ -696,14 +696,14 @@ public final class Utf8Scanner
                 throwUnexpectedChar(c, " in public identifier");
             }
 
-            // White space? Needs to be coalecsed
+            // White space? Needs to be coalesced
             if (c <= INT_SPACE) {
                 addSpace = true;
                 continue;
             }
             if (addSpace) {
                 if (outPtr >= outputBuffer.length) {
-                    outputBuffer = _textBuilder.finishCurrentSegment();
+                    _nameBuffer = outputBuffer = DataUtil.growArrayBy(outputBuffer, outputBuffer.length);
                     outPtr = 0;
                 }
                 outputBuffer[outPtr++] = ' ';
diff --git a/src/test/java/stream/TestDTDSkimming.java b/src/test/java/stream/TestDTDSkimming.java
index cc3abb6..cc86bb7 100644
--- a/src/test/java/stream/TestDTDSkimming.java
+++ b/src/test/java/stream/TestDTDSkimming.java
@@ -24,7 +24,31 @@ public class TestDTDSkimming extends base.BaseTestCase
         _doTestInvalidDup("UTF-8", false);
         _doTestInvalidDup("UTF-8", true);
     }
-    
+
+    // [aalto-xml#47]
+    public void testDtdIssue47() throws Exception
+    {
+        final String DOC = "<?xml version=\"1.0\" encoding=\"US-ASCII\"?>\n" + 
+                "<!DOCTYPE issue-xml PUBLIC \"-//Atypon//DTD Atypon JATS Journal Archiving and Interchange Issue XML\" \"Atypon-Issue-Xml.dtd\">\n" + 
+                "<issue-xml>\n" + 
+                "</issue-xml>";
+        XMLStreamReader2 sr = createReader(DOC, "UTF-8");
+        assertTokenType(START_DOCUMENT, sr.getEventType());
+        int t = sr.next();
+        assertTokenType(DTD, t);
+        assertEquals("issue-xml", sr.getPrefixedName());
+        assertEquals("", sr.getText());
+        assertTokenType(START_ELEMENT, sr.next());
+        assertEquals("issue-xml", sr.getLocalName());
+        assertTokenType(CHARACTERS, sr.next());
+        assertEquals("\n", sr.getText());
+        assertTokenType(END_ELEMENT, sr.next());
+        assertEquals("issue-xml", sr.getLocalName());
+        assertTokenType(END_DOCUMENT, sr.next());
+        sr.close();
+
+    }
+
     /*
     /**********************************************************************
     /* Helper methods
