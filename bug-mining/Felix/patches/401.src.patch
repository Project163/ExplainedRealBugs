diff --git a/framework/src/main/java/org/apache/felix/framework/searchpolicy/ModuleImpl.java b/framework/src/main/java/org/apache/felix/framework/searchpolicy/ModuleImpl.java
index 19171dc207..16827e6162 100644
--- a/framework/src/main/java/org/apache/felix/framework/searchpolicy/ModuleImpl.java
+++ b/framework/src/main/java/org/apache/felix/framework/searchpolicy/ModuleImpl.java
@@ -27,6 +27,8 @@ import java.lang.reflect.Proxy;
 import java.net.MalformedURLException;
 import java.net.URL;
 import java.net.URLStreamHandler;
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.security.ProtectionDomain;
 import java.security.SecureClassLoader;
 import java.util.ArrayList;
@@ -1173,8 +1175,21 @@ public class ModuleImpl implements IModule
     {
         if (m_classLoader == null)
         {
-// TODO: REFACTOR - SecureAction fix needed.
-              m_classLoader = new ModuleClassLoader();
+            if (System.getSecurityManager() != null)
+            {
+                m_classLoader = (ModuleClassLoader)
+                    AccessController.doPrivileged(new PrivilegedAction() {
+                        public Object run()
+                        {
+                            return new ModuleClassLoader();
+                        }
+                    });
+            }
+            else
+            {
+                m_classLoader = new ModuleClassLoader();
+            }
+// TODO: SECURITY - Would be nice if this could use SecureAction again.
 //            m_classLoader = m_secureAction.createModuleClassLoader(
 //                this, m_protectionDomain);
         }
