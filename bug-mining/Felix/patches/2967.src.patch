diff --git a/osgi-r7/framework/src/main/java/org/apache/felix/framework/ServiceRegistrationImpl.java b/osgi-r7/framework/src/main/java/org/apache/felix/framework/ServiceRegistrationImpl.java
index 9dd5a2a373..9169900039 100644
--- a/osgi-r7/framework/src/main/java/org/apache/felix/framework/ServiceRegistrationImpl.java
+++ b/osgi-r7/framework/src/main/java/org/apache/felix/framework/ServiceRegistrationImpl.java
@@ -287,7 +287,7 @@ class ServiceRegistrationImpl implements ServiceRegistration
                     ungetFactoryUnchecked(relBundle, svcObj);
                 }
             }
-            catch (Exception ex)
+            catch (Throwable ex)
             {
                 m_registry.getLogger().log(
                     m_bundle,
diff --git a/osgi-r7/framework/src/main/java/org/apache/felix/framework/ServiceRegistry.java b/osgi-r7/framework/src/main/java/org/apache/felix/framework/ServiceRegistry.java
index cf5c3a248e..0b086eae9d 100644
--- a/osgi-r7/framework/src/main/java/org/apache/felix/framework/ServiceRegistry.java
+++ b/osgi-r7/framework/src/main/java/org/apache/felix/framework/ServiceRegistry.java
@@ -376,6 +376,20 @@ public class ServiceRegistry
                         if (holder != usage.m_svcHolderRef.get())
                             holder = null;
                     }
+                    if (svcObj != null && isPrototype)
+                    {
+                        UsageCount existingUsage = obtainUsageCount(bundle, ref, svcObj, null);
+                        if (existingUsage != null && existingUsage != usage)
+                        {
+                            flushUsageCount(bundle, ref, usage);
+                            usage = existingUsage;
+                            incrementToPositiveValue(usage.m_count);
+                            if ( isServiceObjects )
+                            {
+                                incrementToPositiveValue(usage.m_serviceObjectsCount);
+                            }
+                        }
+                    }
                 }
             }
         }
@@ -477,8 +491,7 @@ public class ServiceRegistry
                                 try
                                 {
                                     // Remove reference from usages array.
-                                    ((ServiceRegistrationImpl.ServiceReferenceImpl) ref)
-                                        .getRegistration().ungetService(bundle, svc);
+                                    reg.ungetService(bundle, svc);
                                 }
                                 finally 
                                 {
