diff --git a/webconsole-plugins/upnp/src/main/java/org/apache/felix/webconsole/plugins/upnp/internal/Base64.java b/webconsole-plugins/upnp/src/main/java/org/apache/felix/webconsole/plugins/upnp/internal/Base64.java
index 1cca824ab0..4d6e80c3a2 100644
--- a/webconsole-plugins/upnp/src/main/java/org/apache/felix/webconsole/plugins/upnp/internal/Base64.java
+++ b/webconsole-plugins/upnp/src/main/java/org/apache/felix/webconsole/plugins/upnp/internal/Base64.java
@@ -342,7 +342,7 @@ public class Base64 {
         this.decodeSize = this.encodeSize - 1;
         if (containsBase64Byte(lineSeparator)) {
             String sep = newStringUtf8(lineSeparator);
-            throw new IllegalArgumentException("lineSeperator must not contain base64 characters: [" + sep + "]");
+            throw new IllegalArgumentException("lineSeperator must not contain base64 characters: [" + sep + "]"); //$NON-NLS-1$ //$NON-NLS-2$
         }
         this.encodeTable = urlSafe ? URL_SAFE_ENCODE_TABLE : STANDARD_ENCODE_TABLE;
     }
@@ -720,7 +720,7 @@ public class Base64 {
         } else if (pObject instanceof String) {
             return decode((String) pObject);
         } else {
-            throw new IllegalArgumentException("Parameter supplied to Base64 decode is not a byte[] or a String");
+            throw new IllegalArgumentException("Parameter supplied to Base64 decode is not a byte[] or a String"); //$NON-NLS-1$
         }
     }
 
@@ -821,9 +821,9 @@ public class Base64 {
 
         long len = getEncodeLength(binaryData, MIME_CHUNK_SIZE, CHUNK_SEPARATOR);
         if (len > maxResultSize) {
-            throw new IllegalArgumentException("Input array too big, the output array would be bigger (" +
+            throw new IllegalArgumentException("Input array too big, the output array would be bigger (" + //$NON-NLS-1$
                 len +
-                ") than the specified maxium size of " +
+                ") than the specified maxium size of " + //$NON-NLS-1$
                 maxResultSize);
         }
 
@@ -914,7 +914,7 @@ public class Base64 {
      */
     public Object encode(Object pObject) throws IllegalArgumentException {
         if (!(pObject instanceof byte[])) {
-            throw new IllegalArgumentException("Parameter supplied to Base64 encode is not a byte[]");
+            throw new IllegalArgumentException("Parameter supplied to Base64 encode is not a byte[]"); //$NON-NLS-1$
         }
         return encode((byte[]) pObject);
     }
@@ -1017,7 +1017,7 @@ public class Base64 {
      */
     public static byte[] encodeInteger(BigInteger bigInt) {
         if (bigInt == null) {
-            throw new NullPointerException("encodeInteger called with null parameter");
+            throw new NullPointerException("encodeInteger called with null parameter"); //$NON-NLS-1$
         }
         return encodeBase64(toIntegerBytes(bigInt), false);
     }
@@ -1070,9 +1070,10 @@ public class Base64 {
             return null;
         }
         try {
-            return new String(bytes, "UTF-8");
+            return new String(bytes, "UTF-8"); //$NON-NLS-1$
         } catch (UnsupportedEncodingException e) {
-            throw new IllegalStateException("UTF-8", e);
+            // cannot use 'new Exception(message, throwable)' because it's not supported by pre-java5
+            throw new IllegalStateException(e.toString());
         }
     }
 
@@ -1081,9 +1082,9 @@ public class Base64 {
             return null;
         }
         try {
-            return string.getBytes("UTF-8");
+            return string.getBytes("UTF-8"); //$NON-NLS-1$
         } catch (UnsupportedEncodingException e) {
-            throw new IllegalStateException("UTF-8", e);
+            throw new IllegalStateException(e.toString());
         }
     }
 
diff --git a/webconsole-plugins/upnp/src/main/java/org/apache/felix/webconsole/plugins/upnp/internal/ControlServlet.java b/webconsole-plugins/upnp/src/main/java/org/apache/felix/webconsole/plugins/upnp/internal/ControlServlet.java
index 9699dc9523..531b67b856 100644
--- a/webconsole-plugins/upnp/src/main/java/org/apache/felix/webconsole/plugins/upnp/internal/ControlServlet.java
+++ b/webconsole-plugins/upnp/src/main/java/org/apache/felix/webconsole/plugins/upnp/internal/ControlServlet.java
@@ -21,12 +21,14 @@ import java.io.InputStream;
 import java.io.OutputStream;
 import java.lang.reflect.Constructor;
 import java.text.SimpleDateFormat;
+import java.util.Collections;
 import java.util.Date;
 import java.util.Dictionary;
 import java.util.Enumeration;
 import java.util.HashMap;
 import java.util.Hashtable;
 import java.util.Iterator;
+import java.util.Map;
 
 import javax.servlet.ServletException;
 import javax.servlet.http.HttpServlet;
@@ -60,7 +62,10 @@ public final class ControlServlet extends HttpServlet
 
     private final HashMap/*<String,UPnPDevice>*/ devices = new HashMap(10);
     private final HashMap/*<String,UPnPIcon>*/ icons = new HashMap(10);
-    private final HashMap/*<String,SessionObject>*/ sessions = new HashMap(10);
+    // holds lock for the devices & icons cache above
+    private final Object cacheLock = new Object();
+
+    private final Map/*<String,SessionObject>*/ sessions = Collections.synchronizedMap(new HashMap(10)); 
 
     private final ServiceTracker tracker;
     private final BundleContext bc;
@@ -377,14 +382,21 @@ public final class ControlServlet extends HttpServlet
 
     private final UPnPIcon getIcon(final String udn)
     {
-        fillCache();
-        return (UPnPIcon) icons.get(udn);
+        synchronized (cacheLock)
+        {
+          fillCache();
+          return (UPnPIcon) icons.get(udn);
+        }
     }
 
     private final UPnPDevice getDevice(String udn)
     {
-        fillCache();
-        final UPnPDevice device = (UPnPDevice) devices.get(udn);
+        final UPnPDevice device;
+        synchronized (cacheLock)
+        {
+          fillCache();
+          device = (UPnPDevice) devices.get(udn);
+        }
         if (null == device)
         {
             throw new IllegalArgumentException("Device '" + udn + "' not found!");
@@ -426,12 +438,18 @@ public final class ControlServlet extends HttpServlet
      */
     void close()
     {
-        icons.clear();
-        for (Iterator i = sessions.values().iterator(); i.hasNext();)
+        synchronized (cacheLock)
         {
-            ((SessionObject) i.next()).unsubscribe();
+          icons.clear();
+        }
+        synchronized (sessions) 
+        {
+          for (Iterator i = sessions.values().iterator(); i.hasNext();)
+          {
+              ((SessionObject) i.next()).unsubscribe();
+          }
+          sessions.clear();
         }
-        sessions.clear();
     }
 
     /* ---------- BEGIN SERVICE TRACKER */
@@ -442,8 +460,11 @@ public final class ControlServlet extends HttpServlet
     final void removedService(ServiceReference ref)
     {
         final Object udn = ref.getProperty(UPnPDevice.UDN);
-        icons.remove(udn);
-        devices.remove(udn);
+        synchronized (cacheLock)
+        {
+          icons.remove(udn);
+          devices.remove(udn);
+        }
     }
 
 }
