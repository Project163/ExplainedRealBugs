diff --git a/resolver/src/main/java/org/apache/felix/resolver/Candidates.java b/resolver/src/main/java/org/apache/felix/resolver/Candidates.java
index d22ffc4137..61fa97b9e2 100644
--- a/resolver/src/main/java/org/apache/felix/resolver/Candidates.java
+++ b/resolver/src/main/java/org/apache/felix/resolver/Candidates.java
@@ -476,13 +476,26 @@ class Candidates
                                     break;
                             }
                         }
+                        if (candidates.isEmpty())
+                        {
+                            if (Util.isOptional(dependent))
+                            {
+                                clearCandidates(dependent);
+                            }
+                            else
+                            {
+                                String msg = "Unable to resolve " + dependent.getResource()
+                                        + ": missing requirement " + dependent;
+                                throw new ResolutionException(msg, null, Collections.singleton(dependent));
+                            }
+                        }
                     }
                 }
             }
         }
     }
 
-    private boolean isSubstituted(Capability substitutableCap, Map<Capability, Integer> substituteStatuses) throws ResolutionException
+    private boolean isSubstituted(Capability substitutableCap, Map<Capability, Integer> substituteStatuses)
     {
         Integer substituteState = substituteStatuses.get(substitutableCap);
         if (substituteState == null)
