diff --git a/converter/schematizer/src/main/java/org/apache/felix/schematizer/impl/Activator.java b/converter/schematizer/src/main/java/org/apache/felix/schematizer/impl/Activator.java
index 3b6ad94711..c737075999 100644
--- a/converter/schematizer/src/main/java/org/apache/felix/schematizer/impl/Activator.java
+++ b/converter/schematizer/src/main/java/org/apache/felix/schematizer/impl/Activator.java
@@ -23,6 +23,7 @@ import org.apache.felix.schematizer.Schematizer;
 import org.apache.felix.serializer.impl.json.JsonSerializerImpl;
 import org.osgi.framework.BundleActivator;
 import org.osgi.framework.BundleContext;
+import org.osgi.framework.ServiceFactory;
 import org.osgi.service.serializer.Serializer;
 
 public class Activator implements BundleActivator {
@@ -35,7 +36,7 @@ public class Activator implements BundleActivator {
         jsonProps.put("provider", "felix");
         context.registerService(Serializer.class, new JsonSerializerImpl(), jsonProps);
 
-        context.registerService(Schematizer.class, new SchematizerImpl(), null);
+        context.registerService(Schematizer.class, (ServiceFactory<Schematizer>)new SchematizerImpl(), null);
     }
 
     @Override
diff --git a/converter/schematizer/src/main/java/org/apache/felix/schematizer/impl/SchematizerImpl.java b/converter/schematizer/src/main/java/org/apache/felix/schematizer/impl/SchematizerImpl.java
index 268005120b..44ed9b1269 100644
--- a/converter/schematizer/src/main/java/org/apache/felix/schematizer/impl/SchematizerImpl.java
+++ b/converter/schematizer/src/main/java/org/apache/felix/schematizer/impl/SchematizerImpl.java
@@ -44,15 +44,34 @@ import org.apache.felix.schematizer.Schema;
 import org.apache.felix.schematizer.Schematizer;
 import org.apache.felix.schematizer.TypeRule;
 import org.osgi.dto.DTO;
+import org.osgi.framework.Bundle;
+import org.osgi.framework.ServiceFactory;
+import org.osgi.framework.ServiceRegistration;
 import org.osgi.util.converter.StandardConverter;
 import org.osgi.util.converter.TypeReference;
 
-public class SchematizerImpl implements Schematizer {
+public class SchematizerImpl implements Schematizer, ServiceFactory<Schematizer> {
 
     private final Map<String, SchemaImpl> schemas = new HashMap<>();
     private volatile Map<String, Map<String, Object>> typeRules = new HashMap<>();
     private final List<ClassLoader> classloaders = new ArrayList<>();
 
+    @Override
+    public Schematizer getService( Bundle bundle, ServiceRegistration<Schematizer> registration ) {
+        return this;
+    }
+
+    @Override
+    public void ungetService(Bundle bundle, ServiceRegistration<Schematizer> registration, Schematizer service) {
+        // For now, a brutish, simplistic version. If there is any change to the environment, just
+        // wipe the state and start over.
+        //
+        // TODO: something more precise, which will remove only the classes that are no longer valid (if that is possible).
+        schemas.clear();
+        typeRules.clear();
+        classloaders.clear();
+    }
+
     @Override
     public Optional<Schema> get(String name) {
         if (!schemas.containsKey(name)) {
