diff --git a/configadmin/changelog.txt b/configadmin/changelog.txt
index bc0588a840..050d7e618c 100644
--- a/configadmin/changelog.txt
+++ b/configadmin/changelog.txt
@@ -2,8 +2,10 @@ Changes in 1.9.6
 ----------------
 ** Bug
     * [FELIX-5908] : NoClassDefFoundError for the CM Security Domain combiner
+    * [FELIX-5918] : AccessControlExceptions in ConfigurationAdmin methods
+    * [FELIX-5910] : Set correct AccessControlContext when firing events
+
 
- 
 Changes in 1.9.4
 ----------------
 ** Bug
diff --git a/configadmin/src/main/java/org/apache/felix/cm/impl/Activator.java b/configadmin/src/main/java/org/apache/felix/cm/impl/Activator.java
index 11cce0f43f..3c005ec0e9 100644
--- a/configadmin/src/main/java/org/apache/felix/cm/impl/Activator.java
+++ b/configadmin/src/main/java/org/apache/felix/cm/impl/Activator.java
@@ -18,12 +18,15 @@
  */
 package org.apache.felix.cm.impl;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.util.Dictionary;
 import java.util.Hashtable;
 
 import org.apache.felix.cm.PersistenceManager;
 import org.apache.felix.cm.file.FilePersistenceManager;
 import org.apache.felix.cm.impl.persistence.PersistenceManagerTracker;
+import org.osgi.framework.Bundle;
 import org.osgi.framework.BundleActivator;
 import org.osgi.framework.BundleContext;
 import org.osgi.framework.BundleException;
@@ -151,5 +154,24 @@ public class Activator implements BundleActivator
             this.filepmRegistration = null;
         }
     }
+
+    public static String getLocation(final Bundle bundle)
+    {
+        if (System.getSecurityManager() != null)
+        {
+            return AccessController.doPrivileged(new PrivilegedAction<String>()
+            {
+                @Override
+                public String run()
+                {
+                    return bundle.getLocation();
+                }
+            });
+        }
+        else
+        {
+            return bundle.getLocation();
+        }
+    }
 }
 
diff --git a/configadmin/src/main/java/org/apache/felix/cm/impl/ConfigurationAdminImpl.java b/configadmin/src/main/java/org/apache/felix/cm/impl/ConfigurationAdminImpl.java
index 25e4c71157..caca06bde4 100644
--- a/configadmin/src/main/java/org/apache/felix/cm/impl/ConfigurationAdminImpl.java
+++ b/configadmin/src/main/java/org/apache/felix/cm/impl/ConfigurationAdminImpl.java
@@ -80,7 +80,7 @@ public class ConfigurationAdminImpl implements ConfigurationAdmin
 
         // FELIX-3360: new factory configuration with implicit binding is dynamic
         ConfigurationImpl config = configurationManager.createFactoryConfiguration( factoryPid, null );
-        config.setDynamicBundleLocation( this.getBundle().getLocation(), false );
+        config.setDynamicBundleLocation( Activator.getLocation(this.getBundle()), false );
         return this.wrap( config );
     }
 
@@ -122,7 +122,7 @@ public class ConfigurationAdminImpl implements ConfigurationAdmin
             config = configurationManager.createConfiguration( pid, null );
 
             // FELIX-3360: configuration creation with implicit binding is dynamic
-            config.setDynamicBundleLocation( getBundle().getLocation(), false );
+            config.setDynamicBundleLocation( Activator.getLocation(getBundle()), false );
         }
         else
         {
@@ -131,10 +131,10 @@ public class ConfigurationAdminImpl implements ConfigurationAdmin
                 Log.logger.log( LogService.LOG_DEBUG, "Binding configuration {0} (isNew: {1}) to bundle {2}",
                         new Object[]
                                 { config.getPid(), config.isNew() ? Boolean.TRUE : Boolean.FALSE,
-                                        this.getBundle().getLocation() } );
+                                    Activator.getLocation(this.getBundle()) } );
 
                 // FELIX-3360: first implicit binding is dynamic
-                config.setDynamicBundleLocation( getBundle().getLocation(), true );
+                config.setDynamicBundleLocation( Activator.getLocation(getBundle()), true );
             }
             else
             {
@@ -268,7 +268,7 @@ public class ConfigurationAdminImpl implements ConfigurationAdmin
         if ( sm != null )
         {
             // CM 1.4 / 104.11.1 Implicit permission
-            if ( name != null && ( checkOwn || !name.equals( getBundle().getLocation() ) ) )
+            if ( name != null && ( checkOwn || !name.equals( Activator.getLocation(getBundle()) ) ) )
             {
                 try
                 {
@@ -277,7 +277,7 @@ public class ConfigurationAdminImpl implements ConfigurationAdmin
                     Log.logger.log( LogService.LOG_DEBUG,
                             "Explicit Permission; grant {0} permission on configuration bound to {1} to bundle {2}",
                             new Object[]
-                                    { action, name, getBundle().getLocation() } );
+                                    { action, name, Activator.getLocation(getBundle()) } );
                 }
                 catch ( SecurityException se )
                 {
@@ -286,7 +286,7 @@ public class ConfigurationAdminImpl implements ConfigurationAdmin
                             LogService.LOG_DEBUG,
                             "No Permission; denied {0} permission on configuration bound to {1} to bundle {2}; reason: {3}",
                             new Object[]
-                                    { action, name, getBundle().getLocation(), se.getMessage() } );
+                                    { action, name, Activator.getLocation(getBundle()), se.getMessage() } );
                     throw se;
                 }
             }
@@ -295,7 +295,7 @@ public class ConfigurationAdminImpl implements ConfigurationAdmin
                 Log.logger.log( LogService.LOG_DEBUG,
                         "Implicit Permission; grant {0} permission on configuration bound to {1} to bundle {2}",
                         new Object[]
-                                { action, name, getBundle().getLocation() } );
+                                { action, name, Activator.getLocation(getBundle()) } );
 
             }
         }
@@ -304,7 +304,7 @@ public class ConfigurationAdminImpl implements ConfigurationAdmin
             Log.logger.log( LogService.LOG_DEBUG,
                     "No SecurityManager installed; grant {0} permission on configuration bound to {1} to bundle {2}",
                     new Object[]
-                            { action, name, getBundle().getLocation() } );
+                            { action, name, Activator.getLocation(getBundle()) } );
         }
     }
 
@@ -378,7 +378,7 @@ public class ConfigurationAdminImpl implements ConfigurationAdmin
             config = configurationManager.createFactoryConfiguration( pid, factoryPid, null );
 
             // FELIX-3360: configuration creation with implicit binding is dynamic
-            config.setDynamicBundleLocation( getBundle().getLocation(), false );
+            config.setDynamicBundleLocation( Activator.getLocation(getBundle()), false );
         }
         else
         {
@@ -387,10 +387,10 @@ public class ConfigurationAdminImpl implements ConfigurationAdmin
                 Log.logger.log( LogService.LOG_DEBUG, "Binding configuration {0} (isNew: {1}) to bundle {2}",
                         new Object[]
                                 { config.getPid(), config.isNew() ? Boolean.TRUE : Boolean.FALSE,
-                                        this.getBundle().getLocation() } );
+                                    Activator.getLocation(this.getBundle()) } );
 
                 // FELIX-3360: first implicit binding is dynamic
-                config.setDynamicBundleLocation( getBundle().getLocation(), true );
+                config.setDynamicBundleLocation( Activator.getLocation(getBundle()), true );
             }
             else
             {
diff --git a/configadmin/src/main/java/org/apache/felix/cm/impl/ConfigurationManager.java b/configadmin/src/main/java/org/apache/felix/cm/impl/ConfigurationManager.java
index 4627d6b035..0737f12bca 100644
--- a/configadmin/src/main/java/org/apache/felix/cm/impl/ConfigurationManager.java
+++ b/configadmin/src/main/java/org/apache/felix/cm/impl/ConfigurationManager.java
@@ -20,6 +20,8 @@ package org.apache.felix.cm.impl;
 
 
 import java.io.IOException;
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.security.SecureRandom;
 import java.util.ArrayList;
 import java.util.Arrays;
@@ -383,7 +385,7 @@ public class ConfigurationManager implements BundleListener
             names[i--] = targetedPid.toString();
             targetedPid.append( '|' ).append( serviceBundle.getVersion().toString() );
             names[i--] = targetedPid.toString();
-            targetedPid.append( '|' ).append( serviceBundle.getLocation() );
+            targetedPid.append( '|' ).append( Activator.getLocation(serviceBundle) );
             names[i--] = targetedPid.toString();
 
             for ( String candidate : names )
@@ -394,7 +396,7 @@ public class ConfigurationManager implements BundleListener
                     // check visibility to use and dynamically bind
                     if ( canReceive( serviceBundle, config.getBundleLocation() ) )
                     {
-                        config.tryBindLocation( serviceBundle.getLocation() );
+                        config.tryBindLocation( Activator.getLocation(serviceBundle) );
                         return config;
                     }
 
@@ -522,7 +524,7 @@ public class ConfigurationManager implements BundleListener
                         LogService.LOG_DEBUG,
                         "Omitting configuration {0}: No permission for bundle {1} on configuration bound to {2}",
                         new Object[]
-                                { pid, configurationAdmin.getBundle().getLocation(),
+                                { pid, Activator.getLocation(configurationAdmin.getBundle()),
                                         config.get( ConfigurationAdmin.SERVICE_BUNDLELOCATION ) } );
                 continue;
             }
@@ -659,7 +661,7 @@ public class ConfigurationManager implements BundleListener
     {
         if ( event.getType() == BundleEvent.UNINSTALLED && handleBundleEvents )
         {
-            final String location = event.getBundle().getLocation();
+            final String location = Activator.getLocation(event.getBundle());
 
             // we only reset dynamic bindings, which are only present in
             // cached configurations, hence only consider cached configs here
@@ -825,7 +827,7 @@ public class ConfigurationManager implements BundleListener
             targetedPid.append( '|' ).append( serviceBundle.getVersion().toString() );
             factories.add( 0, targetedPid.toString() );
 
-            targetedPid.append( '|' ).append( serviceBundle.getLocation() );
+            targetedPid.append( '|' ).append( Activator.getLocation(serviceBundle) );
             factories.add( 0, targetedPid.toString() );
         }
 
@@ -990,7 +992,7 @@ public class ConfigurationManager implements BundleListener
         if ( location == null )
         {
             Log.logger.log( LogService.LOG_DEBUG, "canReceive=true; bundle={0}; configuration=(unbound)", new Object[]
-                    { bundle.getLocation() } );
+                    { Activator.getLocation(bundle) } );
             return true;
         }
         else if ( location.startsWith( "?" ) )
@@ -1002,21 +1004,21 @@ public class ConfigurationManager implements BundleListener
                         ConfigurationPermission.TARGET ) );
                 Log.logger.log( LogService.LOG_DEBUG, "canReceive={0}: bundle={1}; configuration={2} (SecurityManager check)",
                         new Object[]
-                                { new Boolean( hasPermission ), bundle.getLocation(), location } );
+                                { new Boolean( hasPermission ), Activator.getLocation(bundle), location } );
                 return hasPermission;
             }
 
             Log.logger.log( LogService.LOG_DEBUG, "canReceive=true; bundle={0}; configuration={1} (no SecurityManager)",
                     new Object[]
-                            { bundle.getLocation(), location } );
+                            { Activator.getLocation(bundle), location } );
             return true;
         }
         else
         {
             // single location, must match
-            final boolean hasPermission = location.equals( bundle.getLocation() );
+            final boolean hasPermission = location.equals( Activator.getLocation(bundle) );
             Log.logger.log( LogService.LOG_DEBUG, "canReceive={0}: bundle={1}; configuration={2}", new Object[]
-                    { new Boolean( hasPermission ), bundle.getLocation(), location } );
+                    { new Boolean( hasPermission ), Activator.getLocation(bundle), location } );
             return hasPermission;
         }
     }
@@ -1227,7 +1229,7 @@ public class ConfigurationManager implements BundleListener
             }
 
             // 104.4.2 Dynamic Binding
-            config.tryBindLocation( serviceBundle.getLocation() );
+            config.tryBindLocation( Activator.getLocation(serviceBundle) );
 
             // update the service with the configuration (if non-null)
             if ( rawProperties != null )
@@ -1368,7 +1370,7 @@ public class ConfigurationManager implements BundleListener
                                     { srList.get(0) } );
                     return;
                 }
-                config.tryBindLocation( bundle.getLocation() );
+                config.tryBindLocation( Activator.getLocation(bundle) );
 
                 final String configBundleLocation = config.getBundleLocation();
 
@@ -1520,7 +1522,7 @@ public class ConfigurationManager implements BundleListener
                     // service if the config has been unbound causing this update
                     if ( isVisible )
                     {
-                        config.tryBindLocation( srBundle.getLocation() );
+                        config.tryBindLocation( Activator.getLocation(srBundle) );
                     }
 
                     if ( wasVisible && !isVisible )
@@ -1664,7 +1666,24 @@ public class ConfigurationManager implements BundleListener
 
                 try
                 {
-                    listeners[serviceIndex].configurationEvent( getConfigurationEvent() );
+                    if ( System.getSecurityManager() != null )
+                    {
+                        AccessController.doPrivileged(
+                            new PrivilegedAction<Object>()
+                            {
+                                @Override
+                                public Void run()
+                                {
+                                    listeners[serviceIndex].configurationEvent(getConfigurationEvent());
+                                    return null;
+                                }
+                            }, BaseTracker.getAccessControlContext(listenerProvider[serviceIndex])
+                        );
+                    }
+                    else
+                    {
+                        listeners[serviceIndex].configurationEvent(getConfigurationEvent());
+                    }
                 }
                 catch ( Throwable t )
                 {
diff --git a/configadmin/src/main/java/org/apache/felix/cm/impl/DynamicBindings.java b/configadmin/src/main/java/org/apache/felix/cm/impl/DynamicBindings.java
index d32ce9c82e..7cd8a72fa3 100644
--- a/configadmin/src/main/java/org/apache/felix/cm/impl/DynamicBindings.java
+++ b/configadmin/src/main/java/org/apache/felix/cm/impl/DynamicBindings.java
@@ -54,7 +54,7 @@ class DynamicBindings
             final Bundle[] bundles = bundleContext.getBundles();
             for ( int i = 0; i < bundles.length; i++ )
             {
-                locations.add( bundles[i].getLocation() );
+                locations.add( Activator.getLocation(bundles[i]) );
             }
 
             // collect pids whose location is not installed any more
diff --git a/configadmin/src/main/java/org/apache/felix/cm/impl/Log.java b/configadmin/src/main/java/org/apache/felix/cm/impl/Log.java
index 13cdff236f..3655868c68 100644
--- a/configadmin/src/main/java/org/apache/felix/cm/impl/Log.java
+++ b/configadmin/src/main/java/org/apache/felix/cm/impl/Log.java
@@ -240,7 +240,7 @@ public class Log
         if ( provider != null )
         {
             buf.append( ", bundle=" ).append( provider.getBundleId() );
-            buf.append( '/' ).append( provider.getLocation() );
+            buf.append( '/' ).append( Activator.getLocation(provider) );
         }
         else
         {
diff --git a/configadmin/src/main/java/org/apache/felix/cm/impl/helper/BaseTracker.java b/configadmin/src/main/java/org/apache/felix/cm/impl/helper/BaseTracker.java
index 4533f0832a..238f820dc8 100644
--- a/configadmin/src/main/java/org/apache/felix/cm/impl/helper/BaseTracker.java
+++ b/configadmin/src/main/java/org/apache/felix/cm/impl/helper/BaseTracker.java
@@ -292,7 +292,7 @@ public abstract class BaseTracker<S> extends ServiceTracker<S, ConfigurationMap<
     }
 
 
-    AccessControlContext getAccessControlContext( final Bundle bundle )
+    public static AccessControlContext getAccessControlContext( final Bundle bundle )
     {
         return new AccessControlContext(AccessController.getContext(), new CMDomainCombiner(bundle));
     }
diff --git a/configadmin/src/main/java/org/apache/felix/cm/impl/helper/TargetedPID.java b/configadmin/src/main/java/org/apache/felix/cm/impl/helper/TargetedPID.java
index a128c1d04e..e49cc5889f 100644
--- a/configadmin/src/main/java/org/apache/felix/cm/impl/helper/TargetedPID.java
+++ b/configadmin/src/main/java/org/apache/felix/cm/impl/helper/TargetedPID.java
@@ -19,6 +19,7 @@
 package org.apache.felix.cm.impl.helper;
 
 
+import org.apache.felix.cm.impl.Activator;
 import org.osgi.framework.Bundle;
 import org.osgi.framework.ServiceReference;
 
@@ -156,7 +157,7 @@ public class TargetedPID
         }
 
         // assert bundle location match
-        return this.location == null || this.location.equals( serviceBundle.getLocation() );
+        return this.location == null || this.location.equals( Activator.getLocation(serviceBundle) );
     }
 
 
