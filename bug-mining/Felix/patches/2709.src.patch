diff --git a/configadmin/src/main/java/org/apache/felix/cm/impl/helper/BaseTracker.java b/configadmin/src/main/java/org/apache/felix/cm/impl/helper/BaseTracker.java
index d8d93f4a07..d5318dfd83 100644
--- a/configadmin/src/main/java/org/apache/felix/cm/impl/helper/BaseTracker.java
+++ b/configadmin/src/main/java/org/apache/felix/cm/impl/helper/BaseTracker.java
@@ -20,6 +20,9 @@ package org.apache.felix.cm.impl.helper;
 
 
 import java.security.AccessControlContext;
+import java.security.AccessController;
+import java.security.DomainCombiner;
+import java.security.Permission;
 import java.security.ProtectionDomain;
 import java.util.ArrayList;
 import java.util.Collection;
@@ -30,6 +33,7 @@ import java.util.List;
 import org.apache.felix.cm.impl.CaseInsensitiveDictionary;
 import org.apache.felix.cm.impl.ConfigurationManager;
 import org.apache.felix.cm.impl.RankingComparator;
+import org.osgi.framework.Bundle;
 import org.osgi.framework.Constants;
 import org.osgi.framework.ServiceReference;
 import org.osgi.service.cm.ConfigurationException;
@@ -286,9 +290,41 @@ public abstract class BaseTracker<S> extends ServiceTracker<S, ConfigurationMap<
     }
 
 
-    protected AccessControlContext getAccessControlContext( final Object ref )
+    AccessControlContext getAccessControlContext( final Bundle bundle )
     {
-        return new AccessControlContext( new ProtectionDomain[]
-            { ref.getClass().getProtectionDomain() } );
+        return new AccessControlContext(AccessController.getContext(), new CMDomainCombiner(bundle));
     }
+
+    private static class CMDomainCombiner implements DomainCombiner {
+        private final Bundle bundle;
+
+        CMDomainCombiner(Bundle bundle) {
+            this.bundle = bundle;
+        }
+
+        public ProtectionDomain[] combine(ProtectionDomain[] arg0,
+                                          ProtectionDomain[] arg1) {
+            return new ProtectionDomain[] { new CMProtectionDomain(bundle) };
+        }
+
+    }
+
+    private static class CMProtectionDomain extends ProtectionDomain {
+
+        private final Bundle bundle;
+
+        CMProtectionDomain(Bundle bundle) {
+            super(null, null);
+            this.bundle = bundle;
+        }
+
+        public boolean implies(Permission permission) {
+            try {
+                return bundle.hasPermission(permission);
+            } catch (IllegalStateException e) {
+                return false;
+            }
+        }
+    }
+
 }
\ No newline at end of file
diff --git a/configadmin/src/main/java/org/apache/felix/cm/impl/helper/ManagedServiceFactoryTracker.java b/configadmin/src/main/java/org/apache/felix/cm/impl/helper/ManagedServiceFactoryTracker.java
index c668c0b419..135773ee92 100644
--- a/configadmin/src/main/java/org/apache/felix/cm/impl/helper/ManagedServiceFactoryTracker.java
+++ b/configadmin/src/main/java/org/apache/felix/cm/impl/helper/ManagedServiceFactoryTracker.java
@@ -90,7 +90,7 @@ public class ManagedServiceFactoryTracker extends BaseTracker<ManagedServiceFact
             {
                 Dictionary props = getProperties( properties, reference, configPid.toString(),
                     factoryPid.toString() );
-                updated( service, configPid.toString(), props );
+                updated( reference, service, configPid.toString(), props );
                 configs.record( configPid, factoryPid, revision );
             }
             catch ( Throwable t )
@@ -117,7 +117,7 @@ public class ManagedServiceFactoryTracker extends BaseTracker<ManagedServiceFact
             {
                 try
                 {
-                    deleted( service, configPid.toString() );
+                    deleted( reference, service, configPid.toString() );
                     configs.record( configPid, factoryPid, -1 );
                 }
                 catch ( Throwable t )
@@ -133,7 +133,7 @@ public class ManagedServiceFactoryTracker extends BaseTracker<ManagedServiceFact
     }
 
 
-    private void updated( final ManagedServiceFactory service, final String pid, final Dictionary properties )
+    private void updated( final ServiceReference<ManagedServiceFactory> reference, final ManagedServiceFactory service, final String pid, final Dictionary properties )
         throws ConfigurationException
     {
         if ( System.getSecurityManager() != null )
@@ -147,7 +147,7 @@ public class ManagedServiceFactoryTracker extends BaseTracker<ManagedServiceFact
                         service.updated( pid, properties );
                         return null;
                     }
-                }, getAccessControlContext( service ) );
+                }, getAccessControlContext( reference.getBundle() ) );
             }
             catch ( PrivilegedActionException e )
             {
@@ -161,7 +161,7 @@ public class ManagedServiceFactoryTracker extends BaseTracker<ManagedServiceFact
     }
 
 
-    private void deleted( final ManagedServiceFactory service, final String pid )
+    private void deleted( final ServiceReference<ManagedServiceFactory> reference, final ManagedServiceFactory service, final String pid )
     {
         if ( System.getSecurityManager() != null )
         {
@@ -172,7 +172,7 @@ public class ManagedServiceFactoryTracker extends BaseTracker<ManagedServiceFact
                     service.deleted( pid );
                     return null;
                 }
-            }, getAccessControlContext( service ) );
+            }, getAccessControlContext( reference.getBundle() ) );
         }
         else
         {
diff --git a/configadmin/src/main/java/org/apache/felix/cm/impl/helper/ManagedServiceTracker.java b/configadmin/src/main/java/org/apache/felix/cm/impl/helper/ManagedServiceTracker.java
index 0fd81fb7da..f05b61d980 100644
--- a/configadmin/src/main/java/org/apache/felix/cm/impl/helper/ManagedServiceTracker.java
+++ b/configadmin/src/main/java/org/apache/felix/cm/impl/helper/ManagedServiceTracker.java
@@ -149,7 +149,7 @@ public class ManagedServiceTracker extends BaseTracker<ManagedService>
         {
             try
             {
-                updated( srv, properties );
+                updated( service, srv, properties );
                 configs.record( configPid, null, revision );
             }
             catch ( Throwable t )
@@ -164,7 +164,7 @@ public class ManagedServiceTracker extends BaseTracker<ManagedService>
     }
 
 
-    private void updated( final ManagedService service, final Dictionary properties ) throws ConfigurationException
+    private void updated( final ServiceReference<ManagedService> reference, final ManagedService service, final Dictionary properties) throws ConfigurationException
     {
         if ( System.getSecurityManager() != null )
         {
@@ -177,7 +177,7 @@ public class ManagedServiceTracker extends BaseTracker<ManagedService>
                         service.updated( properties );
                         return null;
                     }
-                }, getAccessControlContext( service ) );
+                }, getAccessControlContext( reference.getBundle() ) );
             }
             catch ( PrivilegedActionException e )
             {
diff --git a/configadmin/src/main/resources/OSGI-INF/permissions.perm b/configadmin/src/main/resources/OSGI-INF/permissions.perm
index 1f3fb33591..a57f9ec378 100644
--- a/configadmin/src/main/resources/OSGI-INF/permissions.perm
+++ b/configadmin/src/main/resources/OSGI-INF/permissions.perm
@@ -47,4 +47,4 @@
 (org.osgi.framework.ServicePermission "org.apache.felix.cm.PersistenceManager" "register")
 
 # -> BaseTracker.getAccessControlContext
-(java.lang.RuntimePermission "getProtectionDomain")
+(java.security.SecurityPermission "createAccessControlContext")
