diff --git a/scr/src/main/java/org/apache/felix/scr/impl/config/AbstractComponentHolder.java b/scr/src/main/java/org/apache/felix/scr/impl/config/AbstractComponentHolder.java
index cb06c2fc28..76a5b37bda 100644
--- a/scr/src/main/java/org/apache/felix/scr/impl/config/AbstractComponentHolder.java
+++ b/scr/src/main/java/org/apache/felix/scr/impl/config/AbstractComponentHolder.java
@@ -51,17 +51,17 @@ abstract class AbstractComponentHolder implements ComponentHolder
         }
         else if ( m_componentMetadata.isImmediate() )
         {
-            manager = new ImmediateComponentManager( m_activator, m_componentMetadata );
+            manager = new ImmediateComponentManager( m_activator, this, m_componentMetadata );
         }
         else if ( m_componentMetadata.getServiceMetadata() != null )
         {
             if ( m_componentMetadata.getServiceMetadata().isServiceFactory() )
             {
-                manager = new ServiceFactoryComponentManager( m_activator, m_componentMetadata );
+                manager = new ServiceFactoryComponentManager( m_activator, this, m_componentMetadata );
             }
             else
             {
-                manager = new DelayedComponentManager( m_activator, m_componentMetadata );
+                manager = new DelayedComponentManager( m_activator, this, m_componentMetadata );
             }
         }
         else
diff --git a/scr/src/main/java/org/apache/felix/scr/impl/config/ComponentHolder.java b/scr/src/main/java/org/apache/felix/scr/impl/config/ComponentHolder.java
index 5532a1df59..c0ac7ca576 100644
--- a/scr/src/main/java/org/apache/felix/scr/impl/config/ComponentHolder.java
+++ b/scr/src/main/java/org/apache/felix/scr/impl/config/ComponentHolder.java
@@ -22,6 +22,7 @@ package org.apache.felix.scr.impl.config;
 import java.util.Dictionary;
 
 import org.apache.felix.scr.impl.BundleComponentActivator;
+import org.apache.felix.scr.impl.manager.ImmediateComponentManager;
 import org.apache.felix.scr.impl.metadata.ComponentMetadata;
 
 
@@ -86,4 +87,11 @@ public interface ComponentHolder
      * @param reason
      */
     void disposeComponents( int reason );
+
+
+    /**
+     * Informs the holder that the component has been disposed as a result of
+     * calling the dispose method.
+     */
+    void disposed( ImmediateComponentManager component );
 }
diff --git a/scr/src/main/java/org/apache/felix/scr/impl/config/ConfiguredComponentHolder.java b/scr/src/main/java/org/apache/felix/scr/impl/config/ConfiguredComponentHolder.java
index cb9fc4ed0b..2e8852773e 100644
--- a/scr/src/main/java/org/apache/felix/scr/impl/config/ConfiguredComponentHolder.java
+++ b/scr/src/main/java/org/apache/felix/scr/impl/config/ConfiguredComponentHolder.java
@@ -21,6 +21,7 @@ package org.apache.felix.scr.impl.config;
 
 import java.util.Dictionary;
 import java.util.HashMap;
+import java.util.Iterator;
 import java.util.Map;
 
 import org.apache.felix.scr.impl.BundleComponentActivator;
@@ -278,6 +279,42 @@ public class ConfiguredComponentHolder extends AbstractComponentHolder
     }
 
 
+    public void disposed( ImmediateComponentManager component )
+    {
+        // ensure the component is removed from the components map
+        synchronized ( m_components )
+        {
+            for ( Iterator vi = m_components.values().iterator(); vi.hasNext(); )
+            {
+                if ( component == vi.next() )
+                {
+                    vi.remove();
+                    break;
+                }
+            }
+        }
+
+        // if the component is the single component, we have to replace it
+        // by another entry in the map
+        if ( component == m_singleComponent )
+        {
+            synchronized ( m_components )
+            {
+                if ( m_components.isEmpty() )
+                {
+                    // now what ??
+                    // is it correct to create a new manager ???
+                    m_singleComponent = createComponentManager();
+                }
+                else
+                {
+                    m_singleComponent = ( ImmediateComponentManager ) m_components.values().iterator().next();
+                }
+            }
+        }
+    }
+
+
     //---------- internal
 
     private ImmediateComponentManager getComponentManager( String pid )
diff --git a/scr/src/main/java/org/apache/felix/scr/impl/config/UnconfiguredComponentHolder.java b/scr/src/main/java/org/apache/felix/scr/impl/config/UnconfiguredComponentHolder.java
index b20209feb1..36b086d83b 100644
--- a/scr/src/main/java/org/apache/felix/scr/impl/config/UnconfiguredComponentHolder.java
+++ b/scr/src/main/java/org/apache/felix/scr/impl/config/UnconfiguredComponentHolder.java
@@ -71,4 +71,10 @@ public class UnconfiguredComponentHolder extends AbstractComponentHolder
     {
         m_component.dispose( reason );
     }
+
+
+    public void disposed( ImmediateComponentManager component )
+    {
+        // nothing to do here...
+    }
 }
diff --git a/scr/src/main/java/org/apache/felix/scr/impl/manager/ComponentFactoryImpl.java b/scr/src/main/java/org/apache/felix/scr/impl/manager/ComponentFactoryImpl.java
index 016abda9cc..5bb3360770 100644
--- a/scr/src/main/java/org/apache/felix/scr/impl/manager/ComponentFactoryImpl.java
+++ b/scr/src/main/java/org/apache/felix/scr/impl/manager/ComponentFactoryImpl.java
@@ -347,6 +347,15 @@ public class ComponentFactoryImpl extends AbstractComponentManager implements Co
     }
 
 
+    public void disposed( ImmediateComponentManager component )
+    {
+        synchronized ( m_componentInstances )
+        {
+            m_componentInstances.remove( component );
+        }
+    }
+
+
     //---------- internal
 
     /**
@@ -357,7 +366,7 @@ public class ComponentFactoryImpl extends AbstractComponentManager implements Co
      */
     private ImmediateComponentManager createComponentManager()
     {
-        return new ImmediateComponentManager( getActivator(), getComponentMetadata() );
+        return new ImmediateComponentManager( getActivator(), this, getComponentMetadata() );
     }
 
 
diff --git a/scr/src/main/java/org/apache/felix/scr/impl/manager/DelayedComponentManager.java b/scr/src/main/java/org/apache/felix/scr/impl/manager/DelayedComponentManager.java
index 4c3f925fb1..58b5dfadc6 100644
--- a/scr/src/main/java/org/apache/felix/scr/impl/manager/DelayedComponentManager.java
+++ b/scr/src/main/java/org/apache/felix/scr/impl/manager/DelayedComponentManager.java
@@ -20,6 +20,7 @@ package org.apache.felix.scr.impl.manager;
 
 
 import org.apache.felix.scr.impl.BundleComponentActivator;
+import org.apache.felix.scr.impl.config.ComponentHolder;
 import org.apache.felix.scr.impl.metadata.ComponentMetadata;
 import org.osgi.framework.Bundle;
 import org.osgi.framework.ServiceFactory;
@@ -36,9 +37,10 @@ public class DelayedComponentManager extends ImmediateComponentManager implement
      * @param activator
      * @param metadata
      */
-    public DelayedComponentManager( BundleComponentActivator activator, ComponentMetadata metadata )
+    public DelayedComponentManager( BundleComponentActivator activator, ComponentHolder componentHolder,
+        ComponentMetadata metadata )
     {
-        super( activator, metadata );
+        super( activator, componentHolder, metadata );
     }
 
 
diff --git a/scr/src/main/java/org/apache/felix/scr/impl/manager/ImmediateComponentManager.java b/scr/src/main/java/org/apache/felix/scr/impl/manager/ImmediateComponentManager.java
index 94cc77399a..e182660c7b 100644
--- a/scr/src/main/java/org/apache/felix/scr/impl/manager/ImmediateComponentManager.java
+++ b/scr/src/main/java/org/apache/felix/scr/impl/manager/ImmediateComponentManager.java
@@ -24,6 +24,7 @@ import java.util.Iterator;
 import java.util.List;
 
 import org.apache.felix.scr.impl.BundleComponentActivator;
+import org.apache.felix.scr.impl.config.ComponentHolder;
 import org.apache.felix.scr.impl.helper.ActivateMethod;
 import org.apache.felix.scr.impl.helper.DeactivateMethod;
 import org.apache.felix.scr.impl.helper.ModifiedMethod;
@@ -49,6 +50,9 @@ public class ImmediateComponentManager extends AbstractComponentManager
     // The context that will be passed to the implementationObject
     private ComponentContextImpl m_componentContext;
 
+    // the component holder responsible for managing this component
+    private ComponentHolder m_componentHolder;
+
     // the activate method
     private ActivateMethod m_activateMethod;
 
@@ -75,9 +79,12 @@ public class ImmediateComponentManager extends AbstractComponentManager
      * @param activator
      * @param metadata
      */
-    public ImmediateComponentManager( BundleComponentActivator activator, ComponentMetadata metadata )
+    public ImmediateComponentManager( BundleComponentActivator activator, ComponentHolder componentHolder,
+        ComponentMetadata metadata )
     {
         super( activator, metadata );
+
+        m_componentHolder = componentHolder;
     }
 
 
@@ -92,6 +99,23 @@ public class ImmediateComponentManager extends AbstractComponentManager
     }
 
 
+    ComponentHolder getComponentHolder()
+    {
+        return m_componentHolder;
+    }
+
+
+    void clear()
+    {
+        if ( m_componentHolder != null )
+        {
+            m_componentHolder.disposed( this );
+        }
+
+        super.clear();
+    }
+
+
     // 1. Load the component implementation class
     // 2. Create the component instance and component context
     // 3. Bind the target services
diff --git a/scr/src/main/java/org/apache/felix/scr/impl/manager/ServiceFactoryComponentManager.java b/scr/src/main/java/org/apache/felix/scr/impl/manager/ServiceFactoryComponentManager.java
index c16ae263f1..17d359f58c 100644
--- a/scr/src/main/java/org/apache/felix/scr/impl/manager/ServiceFactoryComponentManager.java
+++ b/scr/src/main/java/org/apache/felix/scr/impl/manager/ServiceFactoryComponentManager.java
@@ -22,6 +22,7 @@ package org.apache.felix.scr.impl.manager;
 import java.util.IdentityHashMap;
 
 import org.apache.felix.scr.impl.BundleComponentActivator;
+import org.apache.felix.scr.impl.config.ComponentHolder;
 import org.apache.felix.scr.impl.metadata.ComponentMetadata;
 import org.osgi.framework.Bundle;
 import org.osgi.framework.ServiceFactory;
@@ -46,9 +47,10 @@ public class ServiceFactoryComponentManager extends ImmediateComponentManager im
      * @param activator
 	 * @param metadata
      */
-    public ServiceFactoryComponentManager( BundleComponentActivator activator, ComponentMetadata metadata )
+    public ServiceFactoryComponentManager( BundleComponentActivator activator, ComponentHolder componentHolder,
+        ComponentMetadata metadata )
     {
-        super( activator, metadata );
+        super( activator, componentHolder, metadata );
     }
 
 
diff --git a/scr/src/test/java/org/apache/felix/scr/impl/config/ConfiguredComponentHolderTest.java b/scr/src/test/java/org/apache/felix/scr/impl/config/ConfiguredComponentHolderTest.java
index 29e61dc148..54e2e3f2d4 100644
--- a/scr/src/test/java/org/apache/felix/scr/impl/config/ConfiguredComponentHolderTest.java
+++ b/scr/src/test/java/org/apache/felix/scr/impl/config/ConfiguredComponentHolderTest.java
@@ -221,7 +221,7 @@ public class ConfiguredComponentHolderTest extends TestCase
 
         protected ImmediateComponentManager createComponentManager()
         {
-            return new MockImmediateComponentManager( getActivator(), getComponentMetadata() );
+            return new MockImmediateComponentManager( getActivator(), this, getComponentMetadata() );
         }
     }
 
@@ -231,9 +231,9 @@ public class ConfiguredComponentHolderTest extends TestCase
         private Dictionary m_configuration;
 
 
-        public MockImmediateComponentManager( BundleComponentActivator activator, ComponentMetadata metadata )
+        public MockImmediateComponentManager( BundleComponentActivator activator, ComponentHolder componentHolder, ComponentMetadata metadata )
         {
-            super( activator, metadata );
+            super( activator, componentHolder, metadata );
         }
 
 
diff --git a/scr/src/test/java/org/apache/felix/scr/impl/helper/ActivateMethodTest.java b/scr/src/test/java/org/apache/felix/scr/impl/helper/ActivateMethodTest.java
index bc7faa80a9..788e872d27 100644
--- a/scr/src/test/java/org/apache/felix/scr/impl/helper/ActivateMethodTest.java
+++ b/scr/src/test/java/org/apache/felix/scr/impl/helper/ActivateMethodTest.java
@@ -55,7 +55,7 @@ public class ActivateMethodTest extends TestCase
     {
         super.setUp();
 
-        m_ctx = ( ComponentContext ) EasyMock.createNiceMock( ComponentContext.class );
+        m_ctx = (ComponentContext) EasyMock.createNiceMock( ComponentContext.class );
         EasyMock.expect( m_ctx.getProperties() ).andReturn( new Hashtable() ).anyTimes();
         EasyMock.replay( new Object[]
             { m_ctx } );
@@ -228,7 +228,7 @@ public class ActivateMethodTest extends TestCase
                 return true;
             }
         };
-        ImmediateComponentManager icm = new ImmediateComponentManager( null, metadata );
+        ImmediateComponentManager icm = new ImmediateComponentManager( null, null, metadata );
         ActivateMethod am = new ActivateMethod( icm, methodName, obj.getClass() );
         am.invoke( obj, new ActivateMethod.ActivatorParameter( m_ctx, -1 ) );
         Method m = get(am, "m_method");
@@ -256,7 +256,7 @@ public class ActivateMethodTest extends TestCase
                 return true;
             }
         };
-        ImmediateComponentManager icm = new ImmediateComponentManager( null, metadata );
+        ImmediateComponentManager icm = new ImmediateComponentManager( null, null, metadata );
         ActivateMethod am = new ActivateMethod( icm, methodName, obj.getClass() );
         am.invoke( obj, new ActivateMethod.ActivatorParameter( m_ctx, -1 ) );
         assertNull( get( am, "m_method" ) );
diff --git a/scr/src/test/java/org/apache/felix/scr/impl/helper/BindMethodTest.java b/scr/src/test/java/org/apache/felix/scr/impl/helper/BindMethodTest.java
index e09ef07eb5..5e49e1eaf9 100644
--- a/scr/src/test/java/org/apache/felix/scr/impl/helper/BindMethodTest.java
+++ b/scr/src/test/java/org/apache/felix/scr/impl/helper/BindMethodTest.java
@@ -44,8 +44,8 @@ public class BindMethodTest extends TestCase
 
     public void setUp()
     {
-        m_serviceReference = ( ServiceReference ) EasyMock.createNiceMock( ServiceReference.class );
-        m_serviceInstance = ( FakeService ) EasyMock.createNiceMock( FakeService.class );
+        m_serviceReference = (ServiceReference) EasyMock.createNiceMock( ServiceReference.class );
+        m_serviceInstance = (FakeService) EasyMock.createNiceMock( FakeService.class );
         m_service = new BindMethod.Service()
         {
             public ServiceReference getReference()
@@ -439,7 +439,7 @@ public class BindMethodTest extends TestCase
                 return isDS11;
             }
         };
-        ImmediateComponentManager icm = new ImmediateComponentManager( null, metadata );
+        ImmediateComponentManager icm = new ImmediateComponentManager( null, null, metadata );
         BindMethod bm = new BindMethod( icm, methodName, component.getClass(), "reference",
             FakeService.class.getName() );
         bm.invoke( component, m_service );
diff --git a/scr/src/test/java/org/apache/felix/scr/integration/ComponentDisposeTest.java b/scr/src/test/java/org/apache/felix/scr/integration/ComponentDisposeTest.java
new file mode 100644
index 0000000000..a039d8ab21
--- /dev/null
+++ b/scr/src/test/java/org/apache/felix/scr/integration/ComponentDisposeTest.java
@@ -0,0 +1,134 @@
+/*
+ * Copyright 1997-2009 Day Management AG
+ * Barfuesserplatz 6, 4001 Basel, Switzerland
+ * All Rights Reserved.
+ *
+ * This software is the confidential and proprietary information of
+ * Day Management AG, ("Confidential Information"). You shall not
+ * disclose such Confidential Information and shall use it only in
+ * accordance with the terms of the license agreement you entered into
+ * with Day.
+ */
+package org.apache.felix.scr.integration;
+
+
+import java.lang.reflect.Field;
+import java.util.Map;
+
+import junit.framework.TestCase;
+
+import org.apache.felix.scr.Component;
+import org.apache.felix.scr.integration.components.SimpleComponent;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.ops4j.pax.exam.junit.JUnit4TestRunner;
+import org.osgi.service.component.ComponentContext;
+
+
+@RunWith(JUnit4TestRunner.class)
+public class ComponentDisposeTest extends ComponentTestBase
+{
+    static
+    {
+        // uncomment to enable debugging of this test class
+        // paxRunnerVmOption = DEBUG_VM_OPTION;
+    }
+
+
+    @Test
+    public void test_SimpleComponent_factory_configuration()
+    {
+        final String factoryPid = "FactoryConfigurationComponent";
+
+        deleteFactoryConfigurations( factoryPid );
+        delay();
+
+        // one single component exists without configuration
+        final Component[] noConfigurations = findComponentsByName( factoryPid );
+        TestCase.assertNotNull( noConfigurations );
+        TestCase.assertEquals( 1, noConfigurations.length );
+        TestCase.assertEquals( Component.STATE_DISABLED, noConfigurations[0].getState() );
+        TestCase.assertTrue( SimpleComponent.INSTANCES.isEmpty() );
+
+        // enable the component, configuration required, hence unsatisfied
+        noConfigurations[0].enable();
+        delay();
+
+        final Component[] enabledNoConfigs = findComponentsByName( factoryPid );
+        TestCase.assertNotNull( enabledNoConfigs );
+        TestCase.assertEquals( 1, enabledNoConfigs.length );
+        TestCase.assertEquals( Component.STATE_UNSATISFIED, enabledNoConfigs[0].getState() );
+        TestCase.assertTrue( SimpleComponent.INSTANCES.isEmpty() );
+
+        // create two factory configurations expecting two components
+        final String pid0 = createFactoryConfiguration( factoryPid );
+        final String pid1 = createFactoryConfiguration( factoryPid );
+        delay();
+
+        // expect two components, only first is active, second is disabled
+        final Component[] twoConfigs = findComponentsByName( factoryPid );
+        TestCase.assertNotNull( twoConfigs );
+        TestCase.assertEquals( 2, twoConfigs.length );
+        TestCase.assertEquals( Component.STATE_ACTIVE, twoConfigs[0].getState() );
+        TestCase.assertEquals( Component.STATE_DISABLED, twoConfigs[1].getState() );
+        TestCase.assertEquals( 1, SimpleComponent.INSTANCES.size() );
+        TestCase.assertTrue( SimpleComponent.INSTANCES.containsKey( twoConfigs[0].getId() ) );
+        TestCase.assertFalse( SimpleComponent.INSTANCES.containsKey( twoConfigs[1].getId() ) );
+
+        // enable second component
+        twoConfigs[1].enable();
+        delay();
+
+        // ensure both components active
+        TestCase.assertEquals( Component.STATE_ACTIVE, twoConfigs[0].getState() );
+        TestCase.assertEquals( Component.STATE_ACTIVE, twoConfigs[1].getState() );
+        TestCase.assertEquals( 2, SimpleComponent.INSTANCES.size() );
+        TestCase.assertTrue( SimpleComponent.INSTANCES.containsKey( twoConfigs[0].getId() ) );
+        TestCase.assertTrue( SimpleComponent.INSTANCES.containsKey( twoConfigs[1].getId() ) );
+
+        // dispose an instance
+        final SimpleComponent anInstance = SimpleComponent.INSTANCE;
+        TestCase.assertNotNull( anInstance );
+        TestCase.assertNotNull( anInstance.m_activateContext );
+        anInstance.m_activateContext.getComponentInstance().dispose();
+        delay();
+
+        // expect one component
+        final Component[] oneConfig = findComponentsByName( factoryPid );
+        TestCase.assertNotNull( oneConfig );
+        TestCase.assertEquals( 1, oneConfig.length );
+        TestCase.assertEquals( Component.STATE_ACTIVE, oneConfig[0].getState() );
+        TestCase.assertEquals( 1, SimpleComponent.INSTANCES.size() );
+        TestCase.assertTrue( SimpleComponent.INSTANCES.containsKey( twoConfigs[0].getId() ) );
+        TestCase.assertFalse( SimpleComponent.INSTANCES.containsKey( anInstance.m_id ) );
+
+        final SimpleComponent instance = SimpleComponent.INSTANCES.values().iterator().next();
+
+        final Object holder = getComponentHolder( instance.m_activateContext );
+        TestCase.assertNotNull( holder );
+
+        Map<?, ?> m_components = ( Map<?, ?> ) getFieldValue( holder, "m_components" );
+        TestCase.assertNotNull( m_components );
+        TestCase.assertEquals( 1, m_components.size() );
+    }
+
+
+    private static Object getComponentHolder( ComponentContext ctx )
+    {
+        try
+        {
+            final Class<?> ccImpl = getType( ctx, "ComponentContextImpl" );
+            final Field m_componentManager = getField( ccImpl, "m_componentManager" );
+            final Object acm = m_componentManager.get( ctx );
+
+            final Class<?> cmImpl = getType( acm, "ImmediateComponentManager" );
+            final Field m_componentHolder = getField( cmImpl, "m_componentHolder" );
+            return m_componentHolder.get( acm );
+        }
+        catch ( Throwable t )
+        {
+            TestCase.fail( "Cannot get ComponentHolder for " + ctx + ": " + t );
+            return null; // keep the compiler happy
+        }
+    }
+}
diff --git a/scr/src/test/java/org/apache/felix/scr/integration/ComponentFactoryTest.java b/scr/src/test/java/org/apache/felix/scr/integration/ComponentFactoryTest.java
new file mode 100644
index 0000000000..3e9465b966
--- /dev/null
+++ b/scr/src/test/java/org/apache/felix/scr/integration/ComponentFactoryTest.java
@@ -0,0 +1,97 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+package org.apache.felix.scr.integration;
+
+
+import java.util.Hashtable;
+import java.util.Map;
+
+import junit.framework.TestCase;
+
+import org.apache.felix.scr.Component;
+import org.apache.felix.scr.integration.components.SimpleComponent;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.ops4j.pax.exam.junit.JUnit4TestRunner;
+import org.osgi.framework.InvalidSyntaxException;
+import org.osgi.framework.ServiceReference;
+import org.osgi.service.component.ComponentConstants;
+import org.osgi.service.component.ComponentFactory;
+import org.osgi.service.component.ComponentInstance;
+
+
+@RunWith(JUnit4TestRunner.class)
+public class ComponentFactoryTest extends ComponentTestBase
+{
+
+    static
+    {
+        // uncomment to enable debugging of this test class
+        // paxRunnerVmOption = DEBUG_VM_OPTION;
+    }
+
+
+    @Test
+    public void test_component_factory() throws InvalidSyntaxException
+    {
+        final String componentname = "factory.component";
+        final String componentfactory = "factory.component.factory";
+
+        final Component component = findComponentByName( componentname );
+
+        TestCase.assertNotNull( component );
+        TestCase.assertFalse( component.isDefaultEnabled() );
+
+        TestCase.assertEquals( Component.STATE_DISABLED, component.getState() );
+        TestCase.assertNull( SimpleComponent.INSTANCE );
+
+        component.enable();
+        delay();
+
+        TestCase.assertEquals( Component.STATE_FACTORY, component.getState() );
+        TestCase.assertNull( SimpleComponent.INSTANCE );
+
+        final ServiceReference[] refs = bundleContext.getServiceReferences( ComponentFactory.class.getName(), "("
+            + ComponentConstants.COMPONENT_FACTORY + "=" + componentfactory + ")" );
+        TestCase.assertNotNull( refs );
+        TestCase.assertEquals( 1, refs.length );
+        final ComponentFactory factory = ( ComponentFactory ) bundleContext.getService( refs[0] );
+        TestCase.assertNotNull( factory );
+
+        Hashtable<String, String> props = new Hashtable<String, String>();
+        props.put( PROP_NAME, PROP_NAME );
+        final ComponentInstance instance = factory.newInstance( props );
+        TestCase.assertNotNull( instance );
+
+        TestCase.assertNotNull( instance.getInstance() );
+        TestCase.assertEquals( SimpleComponent.INSTANCE, instance.getInstance() );
+        TestCase.assertEquals( PROP_NAME, SimpleComponent.INSTANCE.getProperty( PROP_NAME ) );
+
+        final Map<?, ?> instanceMap = ( Map<?, ?> ) getFieldValue( component, "m_componentInstances" );
+        TestCase.assertNotNull( instanceMap );
+        TestCase.assertEquals( 1, instanceMap.size() );
+        TestCase.assertTrue( instanceMap.containsValue( instance ) );
+
+        instance.dispose();
+        TestCase.assertNull( SimpleComponent.INSTANCE );
+
+        TestCase.assertEquals( 0, instanceMap.size() );
+        TestCase.assertFalse( instanceMap.containsValue( instance ) );
+    }
+}
diff --git a/scr/src/test/java/org/apache/felix/scr/integration/components/SimpleComponent.java b/scr/src/test/java/org/apache/felix/scr/integration/components/SimpleComponent.java
index 5c584239d1..e440fbe686 100644
--- a/scr/src/test/java/org/apache/felix/scr/integration/components/SimpleComponent.java
+++ b/scr/src/test/java/org/apache/felix/scr/integration/components/SimpleComponent.java
@@ -41,12 +41,19 @@ public class SimpleComponent
 
     private Map<?, ?> m_config;
 
+    public long m_id;
+
+    public ComponentContext m_activateContext;
+
 
     @SuppressWarnings("unused")
-    private void activate( Map<?, ?> config )
+    private void activate( ComponentContext activateContext, Map<?, ?> config )
     {
+        m_id = ( Long ) config.get( ComponentConstants.COMPONENT_ID );
+        m_activateContext = activateContext;
+
         INSTANCE = this;
-        INSTANCES.put( ( Long ) config.get( ComponentConstants.COMPONENT_ID ), this );
+        INSTANCES.put( m_id, this );
         setConfig( config );
 
         if ( PREVIOUS_INSTANCES.contains( this ) )
@@ -75,6 +82,8 @@ public class SimpleComponent
     private void deactivate()
     {
         INSTANCES.remove( getProperty( ComponentConstants.COMPONENT_ID ) );
+
+        m_activateContext = null;
         INSTANCE = null;
         setConfig( new HashMap<Object, Object>() );
     }
diff --git a/scr/src/test/resources/integration_test_simple_components.xml b/scr/src/test/resources/integration_test_simple_components.xml
index d6a5af9f8e..dcca586d5c 100644
--- a/scr/src/test/resources/integration_test_simple_components.xml
+++ b/scr/src/test/resources/integration_test_simple_components.xml
@@ -71,4 +71,11 @@
         </service>
     </scr:component>
 
+    <!-- Component Factory Instances -->
+    <scr:component name="factory.component"
+        enabled="false"
+        factory="factory.component.factory" >
+        <implementation class="org.apache.felix.scr.integration.components.SimpleComponent" />
+    </scr:component>
+
 </components>
