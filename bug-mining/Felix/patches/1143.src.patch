diff --git a/framework/src/main/java/org/apache/felix/framework/Felix.java b/framework/src/main/java/org/apache/felix/framework/Felix.java
index 1ec8304e7b..62ac4ab38c 100644
--- a/framework/src/main/java/org/apache/felix/framework/Felix.java
+++ b/framework/src/main/java/org/apache/felix/framework/Felix.java
@@ -528,48 +528,48 @@ public class Felix extends BundleImpl implements Framework
             Bundle.INSTALLED | Bundle.RESOLVED | Bundle.STARTING | Bundle.ACTIVE);
         try
         {
-            String security = (String) m_configMap.get(Constants.FRAMEWORK_SECURITY);
-            if (security != null)
+            if ((getState() == Bundle.INSTALLED) || (getState() == Bundle.RESOLVED))
             {
-                if (System.getSecurityManager() != null)
-                {
-                    throw new SecurityException("SecurityManager already installed");
-                }
-                security = security.trim();
-                if (Constants.FRAMEWORK_SECURITY_OSGI.equalsIgnoreCase(security) || (security.length() == 0))
+                String security = (String) m_configMap.get(Constants.FRAMEWORK_SECURITY);
+                if (security != null)
                 {
-                    // TODO: SECURITY - we only need our own security manager to convert the exceptions
-                    //       because the 4.2.0 ct does expect them like this in one case. 
-                    System.setSecurityManager(m_securityManager = new SecurityManager()
+                    if (System.getSecurityManager() != null)
                     {
-                        public void checkPermission(Permission perm) 
+                        throw new SecurityException("SecurityManager already installed");
+                    }
+                    security = security.trim();
+                    if (Constants.FRAMEWORK_SECURITY_OSGI.equalsIgnoreCase(security) || (security.length() == 0))
+                    {
+                        // TODO: SECURITY - we only need our own security manager to convert the exceptions
+                        //       because the 4.2.0 ct does expect them like this in one case. 
+                        System.setSecurityManager(m_securityManager = new SecurityManager()
                         {
-                            try
+                            public void checkPermission(Permission perm) 
                             {
-                                super.checkPermission(perm);
-                            }
-                            catch (AccessControlException ex)
-                            {
-                                throw new SecurityException(ex);
+                                try
+                                {
+                                    super.checkPermission(perm);
+                                }
+                                catch (AccessControlException ex)
+                                {
+                                    throw new SecurityException(ex);
+                                }
                             }
-                        }
-                    });
-                }
-                else
-                {
-                    try 
-                    {
-                        System.setSecurityManager(m_securityManager = 
-                            (SecurityManager) Class.forName(security).newInstance());
-                    } 
-                    catch (Throwable t)
+                        });
+                    }
+                    else
                     {
-                        throw new SecurityException("Unable to install custom SecurityManager: " + security, t); 
+                        try 
+                        {
+                            System.setSecurityManager(m_securityManager = 
+                                (SecurityManager) Class.forName(security).newInstance());
+                        } 
+                        catch (Throwable t)
+                        {
+                            throw new SecurityException("Unable to install custom SecurityManager: " + security, t); 
+                        }
                     }
                 }
-            }
-            if ((getState() == Bundle.INSTALLED) || (getState() == Bundle.RESOLVED))
-            {
                 // Get any system bundle activators.
                 m_activatorList = (List) m_configMutableMap.get(FelixConstants.SYSTEMBUNDLE_ACTIVATORS_PROP);
                 m_activatorList = (m_activatorList == null) ? new ArrayList() : new ArrayList(m_activatorList);
