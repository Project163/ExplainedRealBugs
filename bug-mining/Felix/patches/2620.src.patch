diff --git a/scr/src/main/java/org/apache/felix/scr/impl/manager/AbstractComponentManager.java b/scr/src/main/java/org/apache/felix/scr/impl/manager/AbstractComponentManager.java
index 5561585fea..cf8c40385f 100644
--- a/scr/src/main/java/org/apache/felix/scr/impl/manager/AbstractComponentManager.java
+++ b/scr/src/main/java/org/apache/felix/scr/impl/manager/AbstractComponentManager.java
@@ -721,7 +721,7 @@ public abstract class AbstractComponentManager<S> implements SimpleLogger, Compo
 
             if ( ( isImmediate() || getComponentMetadata().isFactory() ) )
             {
-                getServiceInternal();
+                getServiceInternal(registrationManager.getServiceRegistration());
             }
         }
         finally
@@ -808,21 +808,11 @@ public abstract class AbstractComponentManager<S> implements SimpleLogger, Compo
         unregisterComponentId();
     }
 
-    final ServiceReference<S> getServiceReference()
-    {
-        ServiceRegistration<S> reg = getServiceRegistration();
-        if (reg != null)
-        {
-            return reg.getReference();
-        }
-        return null;
-    }
-
     //---------- Component handling methods ----------------------------------
 
     protected abstract void deleteComponent( int reason );
 
-    boolean getServiceInternal()
+    boolean getServiceInternal(ServiceRegistration<S> serviceRegistration)
     {
         return false;
     }
@@ -1023,12 +1013,6 @@ public abstract class AbstractComponentManager<S> implements SimpleLogger, Compo
     }
 
 
-    final ServiceRegistration<S> getServiceRegistration()
-    {
-        return registrationManager.getServiceRegistration();
-    }
-
-
     synchronized void clear()
     {
         // for some testing, the activator may be null
diff --git a/scr/src/main/java/org/apache/felix/scr/impl/manager/ComponentContextImpl.java b/scr/src/main/java/org/apache/felix/scr/impl/manager/ComponentContextImpl.java
index cebbc3830b..768a3f0b8f 100644
--- a/scr/src/main/java/org/apache/felix/scr/impl/manager/ComponentContextImpl.java
+++ b/scr/src/main/java/org/apache/felix/scr/impl/manager/ComponentContextImpl.java
@@ -30,6 +30,7 @@ import org.apache.felix.scr.impl.helper.ReadOnlyDictionary;
 import org.osgi.framework.Bundle;
 import org.osgi.framework.BundleContext;
 import org.osgi.framework.ServiceReference;
+import org.osgi.framework.ServiceRegistration;
 import org.osgi.service.component.ComponentInstance;
 import org.osgi.service.log.LogService;
 
@@ -47,6 +48,8 @@ public class ComponentContextImpl<S> implements ExtComponentContext {
     private final ComponentInstance m_componentInstance = new ComponentInstanceImpl<S>(this);
 
     private final Bundle m_usingBundle;
+    
+    private final ServiceRegistration<S> m_serviceRegistration;
 
     private volatile S m_implementationObject;
 
@@ -56,10 +59,11 @@ public class ComponentContextImpl<S> implements ExtComponentContext {
 
     private final ComponentServiceObjectsHelper serviceObjectsHelper;
 
-    public ComponentContextImpl( final SingleComponentManager<S> componentManager, final Bundle usingBundle )
+    public ComponentContextImpl( final SingleComponentManager<S> componentManager, final Bundle usingBundle, ServiceRegistration<S> serviceRegistration )
     {
         m_componentManager = componentManager;
         m_usingBundle = usingBundle;
+        m_serviceRegistration = serviceRegistration;
         edgeInfos = new EdgeInfo[componentManager.getComponentMetadata().getDependencies().size()];
         for (int i = 0; i< edgeInfos.length; i++)
         {
@@ -99,6 +103,11 @@ public class ComponentContextImpl<S> implements ExtComponentContext {
         return edgeInfos[index];
     }
 
+    ServiceRegistration<S> getServiceRegistration()
+    {
+        return m_serviceRegistration;
+    }
+
    protected SingleComponentManager<S> getComponentManager()
     {
         return m_componentManager;
@@ -196,7 +205,7 @@ public class ComponentContextImpl<S> implements ExtComponentContext {
 
     public ServiceReference<S> getServiceReference()
     {
-        return m_componentManager.getServiceReference();
+        return m_serviceRegistration == null? null: m_serviceRegistration.getReference();
     }
 
 
@@ -263,4 +272,5 @@ public class ComponentContextImpl<S> implements ExtComponentContext {
         }
 
     }
+
 }
diff --git a/scr/src/main/java/org/apache/felix/scr/impl/manager/ServiceFactoryComponentManager.java b/scr/src/main/java/org/apache/felix/scr/impl/manager/ServiceFactoryComponentManager.java
index 5bb765ca8f..92f5ed9cdf 100644
--- a/scr/src/main/java/org/apache/felix/scr/impl/manager/ServiceFactoryComponentManager.java
+++ b/scr/src/main/java/org/apache/felix/scr/impl/manager/ServiceFactoryComponentManager.java
@@ -46,7 +46,7 @@ public class ServiceFactoryComponentManager<S> extends SingleComponentManager<S>
     @Override
     public void setServiceProperties(Dictionary<String, ?> serviceProperties)
     {
-        throw new IllegalStateException( "Bundle scoped service properties are immutable" );
+        throw new IllegalStateException( "Bundle or instance scoped service properties are immutable" );
     }
 
 
@@ -92,13 +92,13 @@ public class ServiceFactoryComponentManager<S> extends SingleComponentManager<S>
     /* (non-Javadoc)
      * @see org.osgi.framework.ServiceFactory#getService(org.osgi.framework.Bundle, org.osgi.framework.ServiceRegistration)
      */
-    public S getService( Bundle bundle, ServiceRegistration<S> registration )
+    public S getService( Bundle bundle, ServiceRegistration<S> serviceRegistration )
     {
         log( LogService.LOG_DEBUG, "ServiceFactory.getService()", null );
 
         // When the getServiceMethod is called, the implementation object must be created
 
-        ComponentContextImpl<S> componentContext = new ComponentContextImpl<S>(this, bundle);
+        ComponentContextImpl<S> componentContext = new ComponentContextImpl<S>(this, bundle, serviceRegistration);
         if (collectDependencies(componentContext) )
         {
             log( LogService.LOG_DEBUG,
diff --git a/scr/src/main/java/org/apache/felix/scr/impl/manager/SingleComponentManager.java b/scr/src/main/java/org/apache/felix/scr/impl/manager/SingleComponentManager.java
index 1ae67f8bd6..5a57e08150 100644
--- a/scr/src/main/java/org/apache/felix/scr/impl/manager/SingleComponentManager.java
+++ b/scr/src/main/java/org/apache/felix/scr/impl/manager/SingleComponentManager.java
@@ -37,6 +37,7 @@ import org.apache.felix.scr.impl.helper.ModifiedMethod;
 import org.osgi.framework.Bundle;
 import org.osgi.framework.Constants;
 import org.osgi.framework.ServiceFactory;
+import org.osgi.framework.ServiceReference;
 import org.osgi.framework.ServiceRegistration;
 import org.osgi.service.component.ComponentConstants;
 import org.osgi.service.component.ComponentInstance;
@@ -517,6 +518,22 @@ public class SingleComponentManager<S> extends AbstractComponentManager<S> imple
         return super.getServiceProperties();
     }
 
+    final ServiceRegistration<S> getServiceRegistration()
+    {
+        return m_componentContext == null? null: m_componentContext.getServiceRegistration();
+    }
+
+
+    final ServiceReference<S> getServiceReference()
+    {
+        ServiceRegistration<S> reg = getServiceRegistration();
+        if (reg != null)
+        {
+            return reg.getReference();
+        }
+        return null;
+    }
+
     private void updateServiceRegistration()
     {
         ServiceRegistration<S> sr = getServiceRegistration();
@@ -788,7 +805,7 @@ public class SingleComponentManager<S> extends AbstractComponentManager<S> imple
         }
         boolean decrement = true;
         try {
-            boolean success = getServiceInternal();
+            boolean success = getServiceInternal(serviceRegistration);
             ComponentContextImpl<S> componentContext = m_componentContext;
             if ( success && componentContext != null)
             {
@@ -811,7 +828,7 @@ public class SingleComponentManager<S> extends AbstractComponentManager<S> imple
 
 
     @Override
-    boolean getServiceInternal()
+    boolean getServiceInternal(ServiceRegistration<S> serviceRegistration)
     {
         if (m_circularReferences.get() != null)
         {
@@ -825,7 +842,7 @@ public class SingleComponentManager<S> extends AbstractComponentManager<S> imple
             boolean success = true;
             if ( m_componentContext == null )
             {
-                ComponentContextImpl<S> componentContext = new ComponentContextImpl<S>(this, this.getBundle());
+                ComponentContextImpl<S> componentContext = new ComponentContextImpl<S>(this, this.getBundle(), serviceRegistration);
                 if ( collectDependencies(componentContext))
                 {
                         log(
diff --git a/scr/src/test/java/org/apache/felix/scr/impl/helper/BindMethodTest.java b/scr/src/test/java/org/apache/felix/scr/impl/helper/BindMethodTest.java
index 2e8dc361aa..c80fad7e45 100644
--- a/scr/src/test/java/org/apache/felix/scr/impl/helper/BindMethodTest.java
+++ b/scr/src/test/java/org/apache/felix/scr/impl/helper/BindMethodTest.java
@@ -452,7 +452,7 @@ public class BindMethodTest extends TestCase
         BindMethod bm = new BindMethod( methodName, component.getClass(),
                 FakeService.class.getName(), dsVersion, false );
         RefPair refPair = new SingleRefPair( m_serviceReference );
-        ComponentContextImpl<T1> cc = new ComponentContextImpl(icm, new MockBundle());
+        ComponentContextImpl<T1> cc = new ComponentContextImpl(icm, new MockBundle(), null);
         assertTrue( bm.getServiceObject( cc, refPair, m_context, icm ) );
         BindParameters bp = new BindParameters(cc, refPair);
         bm.invoke( component, bp, null, icm );
diff --git a/scr/src/test/java/org/apache/felix/scr/impl/manager/SingleComponentManagerTest.java b/scr/src/test/java/org/apache/felix/scr/impl/manager/SingleComponentManagerTest.java
index 136b4b8a6d..f46f2c92d7 100644
--- a/scr/src/test/java/org/apache/felix/scr/impl/manager/SingleComponentManagerTest.java
+++ b/scr/src/test/java/org/apache/felix/scr/impl/manager/SingleComponentManagerTest.java
@@ -33,6 +33,7 @@ import org.junit.Test;
 import org.mockito.Mockito;
 import org.osgi.framework.Bundle;
 import org.osgi.framework.BundleContext;
+import org.osgi.framework.ServiceRegistration;
 
 public class SingleComponentManagerTest
 {
@@ -48,7 +49,7 @@ public class SingleComponentManagerTest
 
         SingleComponentManager<Object> scm = new SingleComponentManager<Object>(cc, new ComponentMethods()) {
             @Override
-            boolean getServiceInternal()
+            boolean getServiceInternal(ServiceRegistration<Object> serviceRegistration)
             {
                 return true;
             }
@@ -58,7 +59,7 @@ public class SingleComponentManagerTest
         Bundle b = Mockito.mock(Bundle.class);
         Mockito.when(b.getBundleContext()).thenReturn(bc);
 
-        ComponentContextImpl<Object> cci = new ComponentContextImpl<Object>(scm, b);
+        ComponentContextImpl<Object> cci = new ComponentContextImpl<Object>(scm, b, null);
         Object implObj = new Object();
         cci.setImplementationObject(implObj);
         cci.setImplementationAccessible(true);
@@ -89,7 +90,7 @@ public class SingleComponentManagerTest
 
         SingleComponentManager<?> scm = new SingleComponentManager<Object>(cc, new ComponentMethods()) {
             @Override
-            boolean getServiceInternal()
+            boolean getServiceInternal(ServiceRegistration<Object> serviceRegistration)
             {
                 return true;
             }
diff --git a/scr/src/test/java/org/apache/felix/scr/integration/MutablePropertiesTest.java b/scr/src/test/java/org/apache/felix/scr/integration/MutablePropertiesTest.java
index 4e4b0fefcb..ad1fedcc87 100644
--- a/scr/src/test/java/org/apache/felix/scr/integration/MutablePropertiesTest.java
+++ b/scr/src/test/java/org/apache/felix/scr/integration/MutablePropertiesTest.java
@@ -223,7 +223,7 @@ public class MutablePropertiesTest extends ComponentTestBase
 
         enableAndCheck(cd);
 
-        assertMsc(msc, false, true, null);
+        assertMsc(msc, true, true, null);
     }
 
     private void assertMsc(MutatingServiceConsumer msc, Boolean set, Boolean updated, Boolean unset)
diff --git a/scr/src/test/java/org/apache/felix/scr/integration/components/MutatingServiceImpl.java b/scr/src/test/java/org/apache/felix/scr/integration/components/MutatingServiceImpl.java
index dc69800d32..0e8c875456 100644
--- a/scr/src/test/java/org/apache/felix/scr/integration/components/MutatingServiceImpl.java
+++ b/scr/src/test/java/org/apache/felix/scr/integration/components/MutatingServiceImpl.java
@@ -46,7 +46,10 @@ public class MutatingServiceImpl implements MutatingService
     {
         this.activateContext = activateContext;
         Map result = new Hashtable( (Map )activateContext.getProperties() );
-        result.put( "theValue", "anotherValue1" );
+        if (activateContext.getServiceReference() != null) 
+        {
+            result.put( "theValue", "anotherValue1" );
+        }
         if (result.containsKey( ".p2" ))
         {
             result.put( ".theValue", "privateValue" );
