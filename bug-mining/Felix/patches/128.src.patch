diff --git a/framework/src/main/java/org/apache/felix/framework/util/manifestparser/R4LibraryClause.java b/framework/src/main/java/org/apache/felix/framework/util/manifestparser/R4LibraryClause.java
index ee33c8541e..32276205a8 100644
--- a/framework/src/main/java/org/apache/felix/framework/util/manifestparser/R4LibraryClause.java
+++ b/framework/src/main/java/org/apache/felix/framework/util/manifestparser/R4LibraryClause.java
@@ -134,9 +134,19 @@ public class R4LibraryClause
 
     private boolean checkOSNames(String currentOSName, String[] osnames)
     {
+        boolean win32 = currentOSName.startsWith("win") && 
+            (currentOSName.equals("windows95") ||
+            currentOSName.equals("windows98") ||
+            currentOSName.equals("windowsnt") ||
+            currentOSName.equals("windows2000") ||
+            currentOSName.equals("windowsxp") ||
+            currentOSName.equals("windowsce") ||
+            currentOSName.equals("windowsvista"));
+
         for (int i = 0; (osnames != null) && (i < osnames.length); i++)
         {
-            if (osnames[i].equals(currentOSName))
+            if (osnames[i].equals(currentOSName) || 
+                ("win32".equals(osnames[i]) && win32))
             {
                 return true;
             }
@@ -370,6 +380,10 @@ public class R4LibraryClause
             {
                 os = "windowsce";
             }
+            else if (value.indexOf("vista") >= 0)
+            {
+                os = "windowsvista";
+            }
             return os;
         }
         else if (value.startsWith("linux"))
