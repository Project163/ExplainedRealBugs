diff --git a/resolver/src/main/java/org/apache/felix/resolver/Candidates.java b/resolver/src/main/java/org/apache/felix/resolver/Candidates.java
index 28a1b56c85..bfa80c6ec0 100644
--- a/resolver/src/main/java/org/apache/felix/resolver/Candidates.java
+++ b/resolver/src/main/java/org/apache/felix/resolver/Candidates.java
@@ -132,7 +132,10 @@ class Candidates
             {
                 res = ((WrappedResource) res).getDeclaredResource();
             }
-            hosts.put(res, getWrappedHost(res));
+            if (!Util.isFragment(res))
+            {
+                hosts.put(res, getWrappedHost(res));
+            }
         }
         for (Capability cap : m_dependentMap.keySet())
         {
@@ -141,7 +144,10 @@ class Candidates
             {
                 res = ((WrappedResource) res).getDeclaredResource();
             }
-            hosts.put(res, getWrappedHost(res));
+            if (!Util.isFragment(res))
+            {
+                hosts.put(res, getWrappedHost(res));
+            }
         }
         return hosts;
     }
