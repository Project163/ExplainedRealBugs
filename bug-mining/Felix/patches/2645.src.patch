diff --git a/connect/pom.xml b/connect/pom.xml
index 65f61d72af..169ae51895 100644
--- a/connect/pom.xml
+++ b/connect/pom.xml
@@ -59,17 +59,20 @@
             <groupId>org.osgi</groupId>
             <artifactId>org.osgi.core</artifactId>
             <version>5.0.0</version>
+            <scope>provided</scope>
         </dependency>
         <dependency>
             <groupId>org.osgi</groupId>
             <artifactId>org.osgi.compendium</artifactId>
             <version>5.0.0</version>
+            <scope>provided</scope>
         </dependency>
         <dependency>
-		<groupId>org.jboss</groupId>
-			<artifactId>jboss-vfs</artifactId>
-			<version>3.2.11.Final</version>
-		</dependency>
+            <groupId>org.jboss</groupId>
+            <artifactId>jboss-vfs</artifactId>
+            <version>3.2.11.Final</version>
+            <scope>provided</scope>
+        </dependency>
     </dependencies>
     <repositories />
     <pluginRepositories />
@@ -100,8 +103,8 @@
                 <groupId>org.apache.maven.plugins</groupId>
                 <artifactId>maven-compiler-plugin</artifactId>
                 <configuration>
-                    <target>1.5</target>
-                    <source>1.5</source>
+                    <target>1.6</target>
+                    <source>1.6</source>
                 </configuration>
             </plugin>
             <plugin>
diff --git a/connect/src/main/java/org/apache/felix/connect/PojoSR.java b/connect/src/main/java/org/apache/felix/connect/PojoSR.java
index 25d4782c15..f4fae404fc 100644
--- a/connect/src/main/java/org/apache/felix/connect/PojoSR.java
+++ b/connect/src/main/java/org/apache/felix/connect/PojoSR.java
@@ -83,7 +83,7 @@ public class PojoSR implements PojoServiceRegistry
     private final Map<Long, Bundle> m_bundles = new HashMap<Long, Bundle>();
     private final Map<String, Object> bundleConfig;
     private final boolean m_hasVFS;
-    
+
     public static BundleDescriptor createSystemBundle() {
         final Map<String, String> headers = new HashMap<String, String>();
         headers.put(Constants.BUNDLE_SYMBOLICNAME, "org.apache.felix.connect");
@@ -250,7 +250,7 @@ public class PojoSR implements PojoServiceRegistry
             hasVFS = false;
         }
         m_hasVFS = hasVFS;
-        
+
         Collection<BundleDescriptor> scan = (Collection<BundleDescriptor>) config.get(PojoServiceRegistryFactory.BUNDLE_DESCRIPTORS);
 
         if (scan != null)
@@ -327,7 +327,7 @@ public class PojoSR implements PojoServiceRegistry
         Revision r;
         URL url = new URL(desc.getUrl());
         URL u = new URL(desc.getUrl() + "META-INF/MANIFEST.MF");
-        String extF = u.toExternalForm(); 
+        String extF = u.toExternalForm();
         if (extF.startsWith("file:"))
         {
             File root = new File(URLDecoder.decode(url.getFile(), "UTF-8"));
@@ -340,8 +340,9 @@ public class PojoSR implements PojoServiceRegistry
             {
                 String target = ((JarURLConnection) uc).getJarFileURL().toExternalForm();
                 String prefix = null;
-                if (!("jar:" + target + "!/").equals(desc.getUrl()))
+                if (!("jar:" + target + "!/").equals(desc.getUrl()) && desc.getUrl().startsWith("jar:" + target + "!/"))
                 {
+                    System.out.println(desc.getUrl() + " " + target);
                     prefix = desc.getUrl().substring(("jar:" + target + "!/").length());
                 }
                 r = new JarRevision(
@@ -350,7 +351,7 @@ public class PojoSR implements PojoServiceRegistry
                         prefix,
                         uc.getLastModified());
             }
-            else if (m_hasVFS && extF.startsWith("vfs")) 
+            else if (m_hasVFS && extF.startsWith("vfs"))
             {
                 r = new VFSRevision(url, url.openConnection().getLastModified());
             }
