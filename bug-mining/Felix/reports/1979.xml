<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:49:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-4138] TypeDeclaration calls factory.dispose() even if it already has been disposed (externally)</title>
                <link>https://issues.apache.org/jira/browse/FELIX-4138</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;In some tests, I manually destroy an iPOJO factory by calling IPojoFactory.dispose()&lt;/p&gt;

&lt;p&gt;However, on framweork shutdown, the associated type declaration tries to call the same method again, without checking the factory actual state. It may also be possible that the TypeDeclaration is not unbound despite the fact the factory is not active anymore.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12653409">FELIX-4138</key>
            <summary>TypeDeclaration calls factory.dispose() even if it already has been disposed (externally)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sauthieg">Guillaume Sauthier</assignee>
                                    <reporter username="pierre.bourret">Pierre Bourret</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 Jun 2013 09:59:30 +0000</created>
                <updated>Tue, 8 Oct 2013 17:20:02 +0000</updated>
                            <resolved>Mon, 1 Jul 2013 15:15:37 +0000</resolved>
                                    <version>ipojo-runtime-1.10</version>
                    <version>ipojo-manipulator-1.10.1</version>
                                    <fixVersion>ipojo-runtime-1.11.0</fixVersion>
                                    <component>iPOJO</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13686540" author="pierre.bourret" created="Tue, 18 Jun 2013 10:00:25 +0000"  >&lt;p&gt;Stack trace:&lt;br/&gt;
ERROR: Bundle org.apache.felix.ipojo &lt;span class=&quot;error&quot;&gt;&amp;#91;13&amp;#93;&lt;/span&gt; EventDispatcher: Error during dispatch. (java.lang.NullPointerException)&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
	at org.apache.felix.ipojo.IPojoFactory.removeFactoryStateListener(IPojoFactory.java:518)&lt;br/&gt;
	at org.apache.felix.ipojo.extender.internal.linker.ManagedType$ExtensionSupport.removedService(ManagedType.java:241)&lt;br/&gt;
	at org.osgi.util.tracker.ServiceTracker$Tracked.customizerRemoved(ServiceTracker.java:956)&lt;br/&gt;
	at org.osgi.util.tracker.ServiceTracker$Tracked.customizerRemoved(ServiceTracker.java:864)&lt;br/&gt;
	at org.osgi.util.tracker.AbstractTracked.untrack(AbstractTracked.java:341)&lt;br/&gt;
	at org.osgi.util.tracker.ServiceTracker.close(ServiceTracker.java:375)&lt;br/&gt;
	at org.apache.felix.ipojo.extender.internal.linker.ManagedType.stop(ManagedType.java:167)&lt;br/&gt;
	at org.apache.felix.ipojo.extender.internal.linker.DeclarationLinker.removedService(DeclarationLinker.java:107)&lt;br/&gt;
	at org.osgi.util.tracker.ServiceTracker$Tracked.customizerRemoved(ServiceTracker.java:956)&lt;br/&gt;
	at org.osgi.util.tracker.ServiceTracker$Tracked.customizerRemoved(ServiceTracker.java:864)&lt;br/&gt;
	at org.osgi.util.tracker.AbstractTracked.untrack(AbstractTracked.java:341)&lt;br/&gt;
	at org.osgi.util.tracker.ServiceTracker$Tracked.serviceChanged(ServiceTracker.java:902)&lt;br/&gt;
	at org.apache.felix.framework.util.EventDispatcher.invokeServiceListenerCallback(EventDispatcher.java:932)&lt;br/&gt;
	at org.apache.felix.framework.util.EventDispatcher.fireEventImmediately(EventDispatcher.java:793)&lt;br/&gt;
	at org.apache.felix.framework.util.EventDispatcher.fireServiceEvent(EventDispatcher.java:543)&lt;br/&gt;
	at org.apache.felix.framework.Felix.fireServiceEvent(Felix.java:4401)&lt;br/&gt;
	at org.apache.felix.framework.Felix.access$000(Felix.java:74)&lt;br/&gt;
	at org.apache.felix.framework.Felix$1.serviceChanged(Felix.java:390)&lt;br/&gt;
	at org.apache.felix.framework.ServiceRegistry.unregisterService(ServiceRegistry.java:151)&lt;br/&gt;
	at org.apache.felix.framework.ServiceRegistrationImpl.unregister(ServiceRegistrationImpl.java:127)&lt;br/&gt;
	at org.apache.felix.ipojo.extender.internal.AbstractService.stop(AbstractService.java:73)&lt;br/&gt;
	at org.apache.felix.ipojo.extender.internal.processor.ComponentsBundleProcessor$ComponentsAndInstances.stop(ComponentsBundleProcessor.java:223)&lt;br/&gt;
	at org.apache.felix.ipojo.extender.internal.processor.ComponentsBundleProcessor.deactivate(ComponentsBundleProcessor.java:112)&lt;br/&gt;
	at org.apache.felix.ipojo.extender.internal.processor.ChainedBundleProcessor.deactivate(ChainedBundleProcessor.java:100)&lt;br/&gt;
	at org.apache.felix.ipojo.extender.internal.Extender$1.removedBundle(Extender.java:173)&lt;br/&gt;
	at org.osgi.util.tracker.BundleTracker$Tracked.customizerRemoved(BundleTracker.java:491)&lt;br/&gt;
	at org.osgi.util.tracker.BundleTracker$Tracked.customizerRemoved(BundleTracker.java:414)&lt;br/&gt;
	at org.osgi.util.tracker.AbstractTracked.untrack(AbstractTracked.java:341)&lt;br/&gt;
	at org.osgi.util.tracker.BundleTracker$Tracked.bundleChanged(BundleTracker.java:449)&lt;br/&gt;
	at org.apache.felix.framework.util.EventDispatcher.invokeBundleListenerCallback(EventDispatcher.java:868)&lt;br/&gt;
	at org.apache.felix.framework.util.EventDispatcher.fireEventImmediately(EventDispatcher.java:789)&lt;br/&gt;
	at org.apache.felix.framework.util.EventDispatcher.fireBundleEvent(EventDispatcher.java:514)&lt;br/&gt;
	at org.apache.felix.framework.Felix.fireBundleEvent(Felix.java:4385)&lt;br/&gt;
	at org.apache.felix.framework.Felix.stopBundle(Felix.java:2508)&lt;br/&gt;
	at org.apache.felix.framework.Felix.setActiveStartLevel(Felix.java:1297)&lt;br/&gt;
	at org.apache.felix.framework.FrameworkStartLevelImpl.run(FrameworkStartLevelImpl.java:304)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:679)&lt;/p&gt;</comment>
                            <comment id="13686598" author="clement.escoffier" created="Tue, 18 Jun 2013 11:11:13 +0000"  >&lt;p&gt;Shouldn&apos;t the declaration beeing notified of the factory disposal and be unbound ?&lt;/p&gt;</comment>
                            <comment id="13694613" author="sauthieg" created="Thu, 27 Jun 2013 10:54:02 +0000"  >&lt;p&gt;I agree that no exceptions should be thrown at all if factory is already disposed/closed.&lt;br/&gt;
We can achieve this in multiple ways:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Check the state of the factory before calling dispose()&lt;/li&gt;
	&lt;li&gt;Or better Factory.dispose() check its internal state before doing anything&lt;/li&gt;
	&lt;li&gt;Or being notified of state changes through a listener&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Anyway, I assume that the creator of the factory and the caller of dispose() should be the same (I create, I dispose, not I create, you dispose).&lt;br/&gt;
Seems a weird use case for me&lt;br/&gt;
WDYT ?&lt;/p&gt;</comment>
                            <comment id="13694664" author="clement.escoffier" created="Thu, 27 Jun 2013 12:31:03 +0000"  >&lt;p&gt;&amp;gt; I agree that no exceptions should be thrown at all if factory is already disposed/closed.&lt;br/&gt;
&amp;gt; We can achieve this in multiple ways:&lt;br/&gt;
&amp;gt; * Check the state of the factory before calling dispose()&lt;br/&gt;
&amp;gt; * Or better Factory.dispose() check its internal state before doing anything&lt;br/&gt;
&amp;gt; * Or being notified of state changes through a listener&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt; Anyway, I assume that the creator of the factory and the caller of dispose() should be the same (I create, I dispose, not I create, you dispose).&lt;br/&gt;
&amp;gt; Seems a weird use case for me&lt;br/&gt;
&amp;gt; WDYT ?&lt;/p&gt;

&lt;p&gt;I&apos;m in favor of the second solution, the safer I would say. &lt;/p&gt;

&lt;p&gt;Even if the &apos;I create, I dispose&apos; is the most comme use case, we can&apos;t be totally sure that &apos;I create, you dispose&apos; won&apos;t happen sometimes.&lt;/p&gt;</comment>
                            <comment id="13696871" author="sauthieg" created="Mon, 1 Jul 2013 15:15:23 +0000"  >&lt;p&gt;I pushed a fix in the trunk&lt;br/&gt;
Please make a try&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>333687</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 21 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1lk9z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>334015</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>