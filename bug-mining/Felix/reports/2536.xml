<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:59:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-5074] Using org.apache.felix.scr.bnd together with maven-bundle-plugin leads to using the wrong bnd version</title>
                <link>https://issues.apache.org/jira/browse/FELIX-5074</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;If I have a POM with a plugin configuration like this&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;plugin&amp;gt;
  &amp;lt;groupId&amp;gt;org.apache.felix&amp;lt;/groupId&amp;gt;
  &amp;lt;artifactId&amp;gt;maven-bundle-plugin&amp;lt;/artifactId&amp;gt;
  &amp;lt;version&amp;gt;3.0.0&amp;lt;/version&amp;gt;
  &amp;lt;extensions&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;lt;/extensions&amp;gt;
  &amp;lt;configuration&amp;gt;
    &amp;lt;instructions&amp;gt;
    &amp;lt;!-- support parsing of felix annotations through the felix.scr.bnd plugin --&amp;gt;
    &amp;lt;_plugin&amp;gt;org.apache.felix.scrplugin.bnd.SCRDescriptorBndPlugin;destdir=target/classes&amp;lt;/_plugin&amp;gt;
    &amp;lt;/instructions&amp;gt;
  &amp;lt;/configuration&amp;gt;
  &amp;lt;dependencies&amp;gt;
  &amp;lt;!-- https:&lt;span class=&quot;code-comment&quot;&gt;//github.com/apache/felix/tree/trunk/tools/org.apache.felix.scr.bnd --&amp;gt;
&lt;/span&gt;   &amp;lt;dependency&amp;gt;
     &amp;lt;groupId&amp;gt;org.apache.felix&amp;lt;/groupId&amp;gt;
     &amp;lt;artifactId&amp;gt;org.apache.felix.scr.bnd&amp;lt;/artifactId&amp;gt;
     &amp;lt;version&amp;gt;1.4.0&amp;lt;/version&amp;gt;
   &amp;lt;/dependency&amp;gt;
 &amp;lt;/dependencies&amp;gt;
 &amp;lt;/plugin&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Unfortunately &lt;tt&gt;org.apache.felix.scr.bnd&lt;/tt&gt; depends on &lt;tt&gt;biz.aQute.bnd:bndlib:jar:2.1.0&lt;/tt&gt;. Therefore the classpath of maven-bundle-plugin looks like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[DEBUG] Populating &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;realm plugin&amp;gt;org.apache.felix:maven-bundle-plugin:3.0.0
[DEBUG]   Included: org.apache.felix:maven-bundle-plugin:jar:3.0.0
[DEBUG]   Included: org.apache.felix:org.apache.felix.scr.bnd:jar:1.4.0
[DEBUG]   Included: biz.aQute.bnd:bndlib:jar:2.1.0
[DEBUG]   Included: org.osgi:org.osgi.core:jar:4.3.1
[DEBUG]   Included: biz.aQute.bnd:biz.aQute.bndlib:jar:3.0.0
[DEBUG]   Included: org.apache.felix:org.apache.felix.bundlerepository:jar:1.6.6
[DEBUG]   Included: org.easymock:easymock:jar:2.5.2
[DEBUG]   Included: org.apache.felix:org.apache.felix.utils:jar:1.6.0
[DEBUG]   Included: org.osgi:org.osgi.compendium:jar:4.2.0
[DEBUG]   Included: org.slf4j:slf4j-jdk14:jar:1.5.6
[DEBUG]   Included: org.slf4j:slf4j-api:jar:1.5.6
[DEBUG]   Included: org.slf4j:jcl-over-slf4j:jar:1.5.6
[DEBUG]   Included: org.apache.maven.reporting:maven-reporting-api:jar:2.2.0
[DEBUG]   Included: org.apache.maven.doxia:doxia-logging-api:jar:1.1
[DEBUG]   Included: junit:junit:jar:4.11
[DEBUG]   Included: org.hamcrest:hamcrest-core:jar:1.3
[DEBUG]   Included: commons-cli:commons-cli:jar:1.2
[DEBUG]   Included: org.codehaus.plexus:plexus-interactivity-api:jar:1.0-alpha-4
[DEBUG]   Included: backport-util-concurrent:backport-util-concurrent:jar:3.1
[DEBUG]   Included: org.sonatype.plexus:plexus-sec-dispatcher:jar:1.3
[DEBUG]   Included: org.sonatype.plexus:plexus-cipher:jar:1.4
[DEBUG]   Included: org.apache.maven:maven-archiver:jar:2.5
[DEBUG]   Included: org.codehaus.plexus:plexus-archiver:jar:2.1
[DEBUG]   Included: org.codehaus.plexus:plexus-io:jar:2.0.2
[DEBUG]   Included: org.codehaus.plexus:plexus-interpolation:jar:1.15
[DEBUG]   Included: org.apache.maven.shared:maven-dependency-tree:jar:2.1
[DEBUG]   Included: org.codehaus.plexus:plexus-component-annotations:jar:1.5.5
[DEBUG]   Included: org.eclipse.aether:aether-util:jar:0.9.0.M2
[DEBUG]   Included: org.codehaus.plexus:plexus-utils:jar:3.0.10
[DEBUG]   Included: org.sonatype.plexus:plexus-build-api:jar:0.0.7
[DEBUG]   Included: org.apache.maven.doxia:doxia-sink-api:jar:1.0
[DEBUG]   Included: org.apache.maven.doxia:doxia-site-renderer:jar:1.0
[DEBUG]   Included: org.apache.maven.doxia:doxia-core:jar:1.0
[DEBUG]   Included: org.codehaus.plexus:plexus-i18n:jar:1.0-beta-7
[DEBUG]   Included: org.codehaus.plexus:plexus-velocity:jar:1.1.7
[DEBUG]   Included: org.apache.velocity:velocity:jar:1.5
[DEBUG]   Included: commons-lang:commons-lang:jar:2.1
[DEBUG]   Included: oro:oro:jar:2.0.8
[DEBUG]   Included: org.apache.maven.doxia:doxia-decoration-model:jar:1.0
[DEBUG]   Included: commons-collections:commons-collections:jar:3.2
[DEBUG]   Included: org.apache.maven.doxia:doxia-module-apt:jar:1.0
[DEBUG]   Included: org.apache.maven.doxia:doxia-module-fml:jar:1.0
[DEBUG]   Included: org.apache.maven.doxia:doxia-module-xdoc:jar:1.0
[DEBUG]   Included: org.apache.maven.doxia:doxia-module-xhtml:jar:1.0
[DEBUG]   Excluded: org.apache.maven:maven-core:jar:2.2.0
[DEBUG]   Excluded: org.apache.maven:maven-settings:jar:2.2.0
[DEBUG]   Excluded: org.apache.maven:maven-plugin-parameter-documenter:jar:2.2.0
[DEBUG]   Excluded: org.apache.maven:maven-profile:jar:2.2.0
[DEBUG]   Excluded: org.apache.maven:maven-model:jar:2.2.0
[DEBUG]   Excluded: org.apache.maven:maven-artifact:jar:2.2.0
[DEBUG]   Excluded: org.codehaus.plexus:plexus-container-&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;:jar:1.0-alpha-9-stable-1
[DEBUG]   Excluded: org.apache.maven:maven-repository-metadata:jar:2.2.0
[DEBUG]   Excluded: org.apache.maven:maven-error-diagnostics:jar:2.2.0
[DEBUG]   Excluded: org.apache.maven:maven-project:jar:2.2.0
[DEBUG]   Excluded: org.apache.maven:maven-plugin-registry:jar:2.2.0
[DEBUG]   Excluded: org.apache.maven:maven-plugin-api:jar:2.2.0
[DEBUG]   Excluded: org.apache.maven:maven-plugin-descriptor:jar:2.2.0
[DEBUG]   Excluded: org.apache.maven:maven-artifact-manager:jar:2.2.0
[DEBUG]   Excluded: org.apache.maven:maven-monitor:jar:2.2.0
[DEBUG]   Excluded: classworlds:classworlds:jar:1.1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So the classpath contains both bnd 2.1 and bnd 3.0.&lt;br/&gt;
IMHO the &lt;tt&gt;felix.scr.bnd&lt;/tt&gt; should not transitively influence the classpath. I guess marking the dependency to bnd as provided in its pom.xml should do the trick here!&lt;/p&gt;</description>
                <environment></environment>
        <key id="12903840">FELIX-5074</key>
            <summary>Using org.apache.felix.scr.bnd together with maven-bundle-plugin leads to using the wrong bnd version</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pderop">Pierre De Rop</assignee>
                                    <reporter username="kwin">Konrad Windszus</reporter>
                        <labels>
                    </labels>
                <created>Fri, 9 Oct 2015 17:39:44 +0000</created>
                <updated>Tue, 12 Jul 2016 04:54:13 +0000</updated>
                            <resolved>Sun, 25 Oct 2015 22:34:06 +0000</resolved>
                                    <version>scr bnd plugin 1.4.0</version>
                                    <fixVersion>scr bnd plugin 1.5.0</fixVersion>
                                    <component>SCR Tooling</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14950844" author="kwin" created="Fri, 9 Oct 2015 17:42:16 +0000"  >&lt;p&gt;Attached is a demo project. Just execute with &lt;tt&gt;mvn package -X&lt;/tt&gt; to observe the wrong classpath with two times bnd in it.&lt;/p&gt;</comment>
                            <comment id="14950939" author="kwin" created="Fri, 9 Oct 2015 18:29:15 +0000"  >&lt;p&gt;The fix from &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-4567&quot; title=&quot;scr bnd plugin incompatible with maven-bundle-plugin 2.5.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-4567&quot;&gt;&lt;del&gt;FELIX-4567&lt;/del&gt;&lt;/a&gt; is not working, as this is not a problem with embedding bnd in the resulting JAR. It rather is a problem with the pom.xml which defines bnd as transitive dependency with scope compile!&lt;/p&gt;</comment>
                            <comment id="14952270" author="kwin" created="Sun, 11 Oct 2015 11:58:30 +0000"  >&lt;p&gt;After excluding the bnd dependency via&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;dependency&amp;gt;
  &amp;lt;groupId&amp;gt;org.apache.felix&amp;lt;/groupId&amp;gt;
  &amp;lt;artifactId&amp;gt;org.apache.felix.scr.bnd&amp;lt;/artifactId&amp;gt;
  &amp;lt;version&amp;gt;1.4.0&amp;lt;/version&amp;gt;
  &amp;lt;exclusions&amp;gt;
    &amp;lt;exclusion&amp;gt;
      &amp;lt;groupId&amp;gt;biz.aQute.bnd&amp;lt;/groupId&amp;gt;
      &amp;lt;artifactId&amp;gt;bndlib&amp;lt;/artifactId&amp;gt;
    &amp;lt;/exclusion&amp;gt;
  &amp;lt;/exclusions&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I get the the following exception&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[ERROR] Failed to execute goal org.apache.felix:maven-bundle-plugin:3.0.0:bundle (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-bundle) on project oneweb-showcase-aem-components-core: Execution &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-bundle of goal org.apache.felix:maven-bundle-plugin:3.0.0:bundle failed: An API incompatibility was encountered &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; executing org.apache.felix:maven-bundle-plugin:3.0.0:bundle: java.lang.NoSuchMethodError: org.osgi.service.component.annotations.Reference.bind()Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;;
[ERROR] -----------------------------------------------------
[ERROR] realm =    extension&amp;gt;org.apache.felix:maven-bundle-plugin:3.0.0
[ERROR] strategy = org.codehaus.plexus.classworlds.strategy.SelfFirstStrategy
[ERROR] urls[0] = file:/Users/konradwindszus/.m2/repository/org/apache/felix/maven-bundle-plugin/3.0.0/maven-bundle-plugin-3.0.0.jar
[ERROR] urls[1] = file:/Users/konradwindszus/.m2/repository/org/apache/felix/org.apache.felix.scr.bnd/1.4.0/org.apache.felix.scr.bnd-1.4.0.jar
[ERROR] urls[2] = file:/Users/konradwindszus/.m2/repository/org/osgi/org.osgi.core/4.3.1/org.osgi.core-4.3.1.jar
[ERROR] urls[3] = file:/Users/konradwindszus/.m2/repository/biz/aQute/bnd/biz.aQute.bndlib/3.0.0/biz.aQute.bndlib-3.0.0.jar
[ERROR] urls[4] = file:/Users/konradwindszus/.m2/repository/org/apache/felix/org.apache.felix.bundlerepository/1.6.6/org.apache.felix.bundlerepository-1.6.6.jar
[ERROR] urls[5] = file:/Users/konradwindszus/.m2/repository/org/easymock/easymock/2.5.2/easymock-2.5.2.jar
[ERROR] urls[6] = file:/Users/konradwindszus/.m2/repository/org/apache/felix/org.apache.felix.utils/1.6.0/org.apache.felix.utils-1.6.0.jar
[ERROR] urls[7] = file:/Users/konradwindszus/.m2/repository/org/osgi/org.osgi.compendium/4.2.0/org.osgi.compendium-4.2.0.jar
[ERROR] urls[8] = file:/Users/konradwindszus/.m2/repository/org/slf4j/slf4j-jdk14/1.5.6/slf4j-jdk14-1.5.6.jar
[ERROR] urls[9] = file:/Users/konradwindszus/.m2/repository/org/slf4j/jcl-over-slf4j/1.5.6/jcl-over-slf4j-1.5.6.jar
[ERROR] urls[10] = file:/Users/konradwindszus/.m2/repository/org/apache/maven/reporting/maven-reporting-api/2.2.0/maven-reporting-api-2.2.0.jar
[ERROR] urls[11] = file:/Users/konradwindszus/.m2/repository/org/apache/maven/doxia/doxia-logging-api/1.1/doxia-logging-api-1.1.jar
[ERROR] urls[12] = file:/Users/konradwindszus/.m2/repository/junit/junit/4.11/junit-4.11.jar
[ERROR] urls[13] = file:/Users/konradwindszus/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar
[ERROR] urls[14] = file:/Users/konradwindszus/.m2/repository/commons-cli/commons-cli/1.2/commons-cli-1.2.jar
[ERROR] urls[15] = file:/Users/konradwindszus/.m2/repository/org/codehaus/plexus/plexus-interactivity-api/1.0-alpha-4/plexus-interactivity-api-1.0-alpha-4.jar
[ERROR] urls[16] = file:/Users/konradwindszus/.m2/repository/backport-util-concurrent/backport-util-concurrent/3.1/backport-util-concurrent-3.1.jar
[ERROR] urls[17] = file:/Users/konradwindszus/.m2/repository/org/sonatype/plexus/plexus-sec-dispatcher/1.3/plexus-sec-dispatcher-1.3.jar
[ERROR] urls[18] = file:/Users/konradwindszus/.m2/repository/org/sonatype/plexus/plexus-cipher/1.4/plexus-cipher-1.4.jar
[ERROR] urls[19] = file:/Users/konradwindszus/.m2/repository/org/apache/maven/maven-archiver/2.5/maven-archiver-2.5.jar
[ERROR] urls[20] = file:/Users/konradwindszus/.m2/repository/org/codehaus/plexus/plexus-archiver/2.1/plexus-archiver-2.1.jar
[ERROR] urls[21] = file:/Users/konradwindszus/.m2/repository/org/codehaus/plexus/plexus-io/2.0.2/plexus-io-2.0.2.jar
[ERROR] urls[22] = file:/Users/konradwindszus/.m2/repository/org/codehaus/plexus/plexus-interpolation/1.15/plexus-interpolation-1.15.jar
[ERROR] urls[23] = file:/Users/konradwindszus/.m2/repository/org/apache/maven/shared/maven-dependency-tree/2.1/maven-dependency-tree-2.1.jar
[ERROR] urls[24] = file:/Users/konradwindszus/.m2/repository/org/codehaus/plexus/plexus-component-annotations/1.5.5/plexus-component-annotations-1.5.5.jar
[ERROR] urls[25] = file:/Users/konradwindszus/.m2/repository/org/eclipse/aether/aether-util/0.9.0.M2/aether-util-0.9.0.M2.jar
[ERROR] urls[26] = file:/Users/konradwindszus/.m2/repository/org/codehaus/plexus/plexus-utils/3.0.10/plexus-utils-3.0.10.jar
[ERROR] urls[27] = file:/Users/konradwindszus/.m2/repository/org/sonatype/plexus/plexus-build-api/0.0.7/plexus-build-api-0.0.7.jar
[ERROR] urls[28] = file:/Users/konradwindszus/.m2/repository/org/apache/maven/doxia/doxia-sink-api/1.0/doxia-sink-api-1.0.jar
[ERROR] urls[29] = file:/Users/konradwindszus/.m2/repository/org/apache/maven/doxia/doxia-site-renderer/1.0/doxia-site-renderer-1.0.jar
[ERROR] urls[30] = file:/Users/konradwindszus/.m2/repository/org/apache/maven/doxia/doxia-core/1.0/doxia-core-1.0.jar
[ERROR] urls[31] = file:/Users/konradwindszus/.m2/repository/org/codehaus/plexus/plexus-i18n/1.0-beta-7/plexus-i18n-1.0-beta-7.jar
[ERROR] urls[32] = file:/Users/konradwindszus/.m2/repository/org/codehaus/plexus/plexus-velocity/1.1.7/plexus-velocity-1.1.7.jar
[ERROR] urls[33] = file:/Users/konradwindszus/.m2/repository/org/apache/velocity/velocity/1.5/velocity-1.5.jar
[ERROR] urls[34] = file:/Users/konradwindszus/.m2/repository/commons-lang/commons-lang/2.1/commons-lang-2.1.jar
[ERROR] urls[35] = file:/Users/konradwindszus/.m2/repository/oro/oro/2.0.8/oro-2.0.8.jar
[ERROR] urls[36] = file:/Users/konradwindszus/.m2/repository/org/apache/maven/doxia/doxia-decoration-model/1.0/doxia-decoration-model-1.0.jar
[ERROR] urls[37] = file:/Users/konradwindszus/.m2/repository/commons-collections/commons-collections/3.2/commons-collections-3.2.jar
[ERROR] urls[38] = file:/Users/konradwindszus/.m2/repository/org/apache/maven/doxia/doxia-module-apt/1.0/doxia-module-apt-1.0.jar
[ERROR] urls[39] = file:/Users/konradwindszus/.m2/repository/org/apache/maven/doxia/doxia-module-fml/1.0/doxia-module-fml-1.0.jar
[ERROR] urls[40] = file:/Users/konradwindszus/.m2/repository/org/apache/maven/doxia/doxia-module-xdoc/1.0/doxia-module-xdoc-1.0.jar
[ERROR] urls[41] = file:/Users/konradwindszus/.m2/repository/org/apache/maven/doxia/doxia-module-xhtml/1.0/doxia-module-xhtml-1.0.jar
[ERROR] &lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; of foreign imports: 1
[ERROR] &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt;: Entry[&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt;  from realm ClassRealm[maven.api, parent: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;]]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The according stack trace to the missing bind method is here &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Caused by: java.lang.NoSuchMethodError: org.osgi.service.component.annotations.Reference.bind()Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;;
	at aQute.bnd.component.AnnotationReader.doReference(AnnotationReader.java:532)
	at aQute.bnd.component.AnnotationReader.annotation(AnnotationReader.java:227)
	at aQute.bnd.osgi.Clazz.doAnnotations(Clazz.java:1485)
	at aQute.bnd.osgi.Clazz.doAttribute(Clazz.java:953)
	at aQute.bnd.osgi.Clazz.doAttributes(Clazz.java:930)
	at aQute.bnd.osgi.Clazz.parseClassFile(Clazz.java:709)
	at aQute.bnd.osgi.Clazz.parseClassFile(Clazz.java:512)
	at aQute.bnd.osgi.Clazz.parseClassFileWithCollector(Clazz.java:501)
	at aQute.bnd.component.AnnotationReader.getDef(AnnotationReader.java:131)
	at aQute.bnd.component.AnnotationReader.getDefinition(AnnotationReader.java:127)
	at aQute.bnd.component.DSAnnotations.analyzeJar(DSAnnotations.java:79)
	at aQute.bnd.osgi.Analyzer.doPlugins(Analyzer.java:658)
	at aQute.bnd.osgi.Analyzer.analyze(Analyzer.java:213)
	at aQute.bnd.osgi.Builder.analyze(Builder.java:379)
	at aQute.bnd.osgi.Analyzer.calcManifest(Analyzer.java:688)
	at aQute.bnd.osgi.Builder.build(Builder.java:104)
	at org.apache.felix.bundleplugin.BundlePlugin.buildOSGiBundle(BundlePlugin.java:651)
	at org.apache.felix.bundleplugin.BundlePlugin.execute(BundlePlugin.java:371)
	at org.apache.felix.bundleplugin.BundlePlugin.execute(BundlePlugin.java:288)
	at org.apache.felix.bundleplugin.BundlePlugin.execute(BundlePlugin.java:279)
	at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:132)
	... 20 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is due to the fact that &lt;tt&gt;org.osgi.compendium&lt;/tt&gt; in version 4.3.0 is embedded in the &lt;tt&gt;felix.scr.bnd&lt;/tt&gt; plugin JAR, while bndlib 3.0 embeds &lt;tt&gt;org.osgi.service.component.annotations&lt;/tt&gt; from &lt;tt&gt;org.osgi.compendium&lt;/tt&gt; in version 6.0. The &lt;tt&gt;felix.scr.bnd&lt;/tt&gt; plugin should not embed anything which is already part of bndlib. Even version 2.1.0 of bndlib embeds part of &lt;tt&gt;org.osgi&lt;/tt&gt;. &lt;br/&gt;
Why is embedding &lt;tt&gt;org.osgi.compendium&lt;/tt&gt; necessary at all? What dependencies from that artifact are actually used, which are not already known to bndlib?&lt;/p&gt;</comment>
                            <comment id="14952285" author="githubbot" created="Sun, 11 Oct 2015 13:17:20 +0000"  >&lt;p&gt;GitHub user kwin opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/38&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/38&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-5074&quot; title=&quot;Using org.apache.felix.scr.bnd together with maven-bundle-plugin leads to using the wrong bnd version&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-5074&quot;&gt;&lt;del&gt;FELIX-5074&lt;/del&gt;&lt;/a&gt;, make compatible with bndlib 3.0&lt;/p&gt;

&lt;p&gt;    simplify POM (only relying on maven-shade-plugin), don&apos;t embed any&lt;br/&gt;
    provided dependencies!&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/kwin/felix&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/kwin/felix&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-5074&quot; title=&quot;Using org.apache.felix.scr.bnd together with maven-bundle-plugin leads to using the wrong bnd version&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-5074&quot;&gt;&lt;del&gt;FELIX-5074&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/38.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/38.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #38&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 66814cf45ef9cc1d983dfc702378c39da676c1a4&lt;br/&gt;
Author: Konrad Windszus &amp;lt;konrad.windszus@netcentric.biz&amp;gt;&lt;br/&gt;
Date:   2015-10-11T13:15:50Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-5074&quot; title=&quot;Using org.apache.felix.scr.bnd together with maven-bundle-plugin leads to using the wrong bnd version&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-5074&quot;&gt;&lt;del&gt;FELIX-5074&lt;/del&gt;&lt;/a&gt;, make compatible with bndlib 3.0&lt;/p&gt;

&lt;p&gt;    simplify POM (only relying on maven-shade-plugin), don&apos;t embed any&lt;br/&gt;
    provided dependencies!&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14952286" author="kwin" created="Sun, 11 Oct 2015 13:19:38 +0000"  >&lt;p&gt;I attached a PR which fixes compatibility with bndlib 3.0. It also makes sure that the scr.bnd only contains the relevant classes. So there should be no longer any classpath collisions with bnd.&lt;/p&gt;</comment>
                            <comment id="14952467" author="pderop" created="Sun, 11 Oct 2015 22:33:26 +0000"  >&lt;p&gt;Hi Konrad;&lt;/p&gt;

&lt;p&gt;The compendium is included because the scr.bnd plugin is intented to be run within bndtools, and when the plugin runs in bndtools, the compendium is not available in the classpath (only bndlib is available if I&apos;m correct).&lt;/p&gt;

&lt;p&gt;Now, to verify if what I&apos;m saying is making sense, I just created a bndtools project and tried the scr.bnd plugin compiled with your patch (which does not include the compendium) and when I&apos;m building using &quot;gradle jar&quot;, I&apos;m indeed getting a CNF on org.osgi.service.component.ComponentContext class (which is needed by the scr.bnd plugin):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;gradle jar

Error  : Got unexpected exception &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; analyzing:org.apache.felix.scrplugin.SCRDescriptorException: Unable to load class.
        at org.apache.felix.scrplugin.helper.Validator.getMethod(Validator.java:222)
        at org.apache.felix.scrplugin.helper.Validator.findLifecycleMethod(Validator.java:246)
        at org.apache.felix.scrplugin.SCRDescriptorGenerator.createComponent(SCRDescriptorGenerator.java:452)
        at org.apache.felix.scrplugin.SCRDescriptorGenerator.execute(SCRDescriptorGenerator.java:161)
        at org.apache.felix.scrplugin.bnd.SCRDescriptorBndPlugin.analyzeJar(SCRDescriptorBndPlugin.java:172)
        at aQute.bnd.osgi.Analyzer.doPlugins(Analyzer.java:658)
        at aQute.bnd.osgi.Analyzer.analyze(Analyzer.java:213)
        at aQute.bnd.osgi.Builder.analyze(Builder.java:379)
        at aQute.bnd.osgi.Analyzer.calcManifest(Analyzer.java:688)
        at aQute.bnd.osgi.Builder.build(Builder.java:104)
        at aQute.bnd.osgi.Builder.builds(Builder.java:1283)
        at aQute.bnd.build.ProjectBuilder.builds(ProjectBuilder.java:540)
        at aQute.bnd.build.Project.buildLocal(Project.java:1650)
        at aQute.bnd.build.Project.build(Project.java:1497)
        at aQute.bnd.build.Project.build(Project.java:1974)
        at aQute.bnd.build.Project$build$14.call(Unknown Source)
        at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:45)
        at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:108)
        at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:112)
        at aQute.bnd.gradle.BndPlugin$_apply_closure1_closure13_closure45.doCall(BndPlugin.groovy:242)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:606)
        at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)
        at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:324)
        at org.codehaus.groovy.runtime.metaclass.ClosureMetaClass.invokeMethod(ClosureMetaClass.java:278)
        at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1016)
        at groovy.lang.Closure.call(Closure.java:423)
        at groovy.lang.Closure.call(Closure.java:439)
        at org.gradle.api.internal.AbstractTask$ClosureTaskAction.execute(AbstractTask.java:548)
        at org.gradle.api.internal.AbstractTask$ClosureTaskAction.execute(AbstractTask.java:529)
        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeAction(ExecuteActionsTaskExecuter.java:80)
        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeActions(ExecuteActionsTaskExecuter.java:61)
        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.execute(ExecuteActionsTaskExecuter.java:46)
        at org.gradle.api.internal.tasks.execution.PostExecutionAnalysisTaskExecuter.execute(PostExecutionAnalysisTaskExecuter.java:35)
        at org.gradle.api.internal.tasks.execution.SkipUpToDateTaskExecuter.execute(SkipUpToDateTaskExecuter.java:64)
        at org.gradle.api.internal.tasks.execution.ValidatingTaskExecuter.execute(ValidatingTaskExecuter.java:58)
        at org.gradle.api.internal.tasks.execution.SkipEmptySourceFilesTaskExecuter.execute(SkipEmptySourceFilesTaskExecuter.java:42)
        at org.gradle.api.internal.tasks.execution.SkipTaskWithNoActionsExecuter.execute(SkipTaskWithNoActionsExecuter.java:52)
        at org.gradle.api.internal.tasks.execution.SkipOnlyIfTaskExecuter.execute(SkipOnlyIfTaskExecuter.java:53)
        at org.gradle.api.internal.tasks.execution.ExecuteAtMostOnceTaskExecuter.execute(ExecuteAtMostOnceTaskExecuter.java:43)
        at org.gradle.api.internal.AbstractTask.executeWithoutThrowingTaskFailure(AbstractTask.java:305)
        at org.gradle.execution.taskgraph.AbstractTaskPlanExecutor$TaskExecutorWorker.executeTask(AbstractTaskPlanExecutor.java:79)
        at org.gradle.execution.taskgraph.AbstractTaskPlanExecutor$TaskExecutorWorker.processTask(AbstractTaskPlanExecutor.java:63)
        at org.gradle.execution.taskgraph.AbstractTaskPlanExecutor$TaskExecutorWorker.run(AbstractTaskPlanExecutor.java:51)
        at org.gradle.execution.taskgraph.DefaultTaskPlanExecutor.process(DefaultTaskPlanExecutor.java:23)
        at org.gradle.execution.taskgraph.DefaultTaskGraphExecuter.execute(DefaultTaskGraphExecuter.java:88)
        at org.gradle.execution.SelectedTaskExecutionAction.execute(SelectedTaskExecutionAction.java:29)
        at org.gradle.execution.DefaultBuildExecuter.execute(DefaultBuildExecuter.java:62)
        at org.gradle.execution.DefaultBuildExecuter.access$200(DefaultBuildExecuter.java:23)
        at org.gradle.execution.DefaultBuildExecuter$2.proceed(DefaultBuildExecuter.java:68)
        at org.gradle.execution.DryRunBuildExecutionAction.execute(DryRunBuildExecutionAction.java:32)
        at org.gradle.execution.DefaultBuildExecuter.execute(DefaultBuildExecuter.java:62)
        at org.gradle.execution.DefaultBuildExecuter.execute(DefaultBuildExecuter.java:55)
        at org.gradle.initialization.DefaultGradleLauncher.doBuildStages(DefaultGradleLauncher.java:149)
        at org.gradle.initialization.DefaultGradleLauncher.doBuild(DefaultGradleLauncher.java:106)
        at org.gradle.initialization.DefaultGradleLauncher.run(DefaultGradleLauncher.java:86)
        at org.gradle.launcher.exec.InProcessBuildActionExecuter$DefaultBuildController.run(InProcessBuildActionExecuter.java:80)
        at org.gradle.launcher.cli.ExecuteBuildAction.run(ExecuteBuildAction.java:33)
        at org.gradle.launcher.cli.ExecuteBuildAction.run(ExecuteBuildAction.java:24)
        at org.gradle.launcher.exec.InProcessBuildActionExecuter.execute(InProcessBuildActionExecuter.java:36)
        at org.gradle.launcher.exec.InProcessBuildActionExecuter.execute(InProcessBuildActionExecuter.java:26)
        at org.gradle.launcher.cli.RunBuildAction.run(RunBuildAction.java:51)
        at org.gradle.internal.Actions$RunnableActionAdapter.execute(Actions.java:171)
        at org.gradle.launcher.cli.CommandLineActionFactory$ParseAndBuildAction.execute(CommandLineActionFactory.java:237)
        at org.gradle.launcher.cli.CommandLineActionFactory$ParseAndBuildAction.execute(CommandLineActionFactory.java:210)
        at org.gradle.launcher.cli.JavaRuntimeValidationAction.execute(JavaRuntimeValidationAction.java:35)
        at org.gradle.launcher.cli.JavaRuntimeValidationAction.execute(JavaRuntimeValidationAction.java:24)
        at org.gradle.launcher.cli.CommandLineActionFactory$WithLogging.execute(CommandLineActionFactory.java:206)
        at org.gradle.launcher.cli.CommandLineActionFactory$WithLogging.execute(CommandLineActionFactory.java:169)
        at org.gradle.launcher.cli.ExceptionReportingAction.execute(ExceptionReportingAction.java:33)
        at org.gradle.launcher.cli.ExceptionReportingAction.execute(ExceptionReportingAction.java:22)
        at org.gradle.launcher.Main.doAction(Main.java:33)
        at org.gradle.launcher.bootstrap.EntryPoint.run(EntryPoint.java:45)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:606)
        at org.gradle.launcher.bootstrap.ProcessBootstrap.runNoExit(ProcessBootstrap.java:54)
        at org.gradle.launcher.bootstrap.ProcessBootstrap.run(ProcessBootstrap.java:35)
        at org.gradle.launcher.GradleMain.main(GradleMain.java:23)
Caused by: java.lang.ClassNotFoundException: org.osgi.service.component.ComponentContext
        at java.net.URLClassLoader$1.run(URLClassLoader.java:366)
        at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.loadClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:425)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.loadClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:358)
        at org.apache.felix.scrplugin.helper.Validator.getMethod(Validator.java:219)
        ... 81 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So, I think that we have to leave the compendium included in the scr.bnd plugin.&lt;/p&gt;

&lt;p&gt;However it seems that your initial proposal does resolve the issue: we can just declare in the tools/org.apache.felix.scr.bnd/pom.xml file a dependency on bndlib with scope=provided. &lt;br/&gt;
Moreover, we can also upgrade to 3.0.0 version (in order to be in line with the one used by the latest maven bundle plugin).&lt;/p&gt;

&lt;p&gt;Something like this (in the tools/org.apache.felix.scr.bnd/pom.xml file):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;                &amp;lt;dependency&amp;gt;
                        &amp;lt;groupId&amp;gt;biz.aQute.bnd&amp;lt;/groupId&amp;gt;
                        &amp;lt;artifactId&amp;gt;biz.aQute.bndlib&amp;lt;/artifactId&amp;gt;
                        &amp;lt;version&amp;gt;3.0.0&amp;lt;/version&amp;gt;
                        &amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
                &amp;lt;/dependency&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Will this resolve your issue ?&lt;/p&gt;

&lt;p&gt;Regarding the other modification you did in org.apache.felix.scr.generator/pom.xml, may be Carsten could give his opinion on it ?&lt;/p&gt;
</comment>
                            <comment id="14952705" author="kwin" created="Mon, 12 Oct 2015 06:45:22 +0000"  >&lt;p&gt;Hi Pierre,&lt;br/&gt;
thanks for your feedback on my patch. Ok, so it seems we need to rethink the patch. But only setting bndlib to &quot;provided&quot; will only resolve one part of the issue. The other issue that we should not include the same class within the classpath of bndlib twice remains. Let me quickly summarize what is part of bndlib 3.0 and bndlib 2.1&lt;/p&gt;

&lt;p&gt;bndlib 3.0&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;org.osgi.resource&lt;/li&gt;
	&lt;li&gt;org.osgi.service.component.annotations&lt;/li&gt;
	&lt;li&gt;org.osgi.service.metatype.annotations&lt;/li&gt;
	&lt;li&gt;org.osgi.service.repository&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;bndlib 2.1&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;org.osgi.resource&lt;/li&gt;
	&lt;li&gt;org.osgi.service.component.annotations&lt;/li&gt;
	&lt;li&gt;org.osgi.service.repository&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Those packages should not be contained in &lt;tt&gt;felix.scr.bnd&lt;/tt&gt;, otherwise you run into problems. But the issue is that those packages are part of osgi.compendium as well. Therefore I think we must depend on something less generic than osgi.compendium.&lt;br/&gt;
What is needed at runtime by &lt;tt&gt;felix.scr.bnd&lt;/tt&gt; really should be only:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;org.osgi.service.component.ComponentContext&lt;/li&gt;
	&lt;li&gt;org.osgi.framework.BundleContext&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;All the other references really seem to be constants (which are in any case being inlined by the compiler).&lt;br/&gt;
So maybe depending on &lt;a href=&quot;http://search.maven.org/#artifactdetails&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://search.maven.org/#artifactdetails&lt;/a&gt;|org.osgi|org.osgi.service.component|1.3.0|jar seems better as that includes only the relevant package (but is only available for DS 1.3, though).&lt;/p&gt;</comment>
                            <comment id="14953027" author="kwin" created="Mon, 12 Oct 2015 11:50:31 +0000"  >&lt;p&gt;Actually it is not that simple, because for org.osgi.service.component.ComponentContext there are only the following dependencies available:&lt;br/&gt;
&lt;a href=&quot;http://search.maven.org/#search&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://search.maven.org/#search&lt;/a&gt;|ga|1|fc%3A%22org.osgi.service.component.ComponentContext%22%20g%3A%22org.osgi%22&lt;br/&gt;
Only since DS 1.3 there is a dedicated artifact for something related to OSGi services.&lt;/p&gt;

&lt;p&gt;Therefore maybe the right solution is to somehow invert the classloading order, so that &lt;tt&gt;bndlib&lt;/tt&gt; is always loaded first before the &lt;tt&gt;felix.scr.bnd&lt;/tt&gt; artifact is being loaded. That way &lt;tt&gt;bndlib&lt;/tt&gt; would loads its own classes and &lt;tt&gt;felix.scr.bnd&lt;/tt&gt; would preferably leverage the classes from &lt;tt&gt;bndlib&lt;/tt&gt; and only if they are not contained in &lt;tt&gt;bndlib&lt;/tt&gt; use its own versions of those classes.&lt;/p&gt;

&lt;p&gt;The problem with that is how to modify the class loading order.&lt;br/&gt;
Currently the loading order is:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;maven-bundle-plugin-3.0.0.jar&lt;/li&gt;
	&lt;li&gt;org.apache.felix.scr.bnd-1.4.0.jar&lt;/li&gt;
	&lt;li&gt;org.osgi.core-4.3.1.jar&lt;/li&gt;
	&lt;li&gt;biz.aQute.bndlib-3.0.0.jar&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;To modify that &lt;tt&gt;felix.scr.bnd&lt;/tt&gt; would need to depend on &lt;tt&gt;bndlib&lt;/tt&gt; as well. Unfortunately &lt;tt&gt;bndlib&lt;/tt&gt; changed its artifactId from &lt;tt&gt;bndlib&lt;/tt&gt; to &lt;tt&gt;biz.aQute.bndlib&lt;/tt&gt; in version 2.4.1. Therefore it seems impossible to have the same version of &lt;tt&gt;felix.scr.bnd&lt;/tt&gt; for both bnd &amp;lt; 2.4.1 and bnd &amp;gt;= 2.4.1.&lt;/p&gt;</comment>
                            <comment id="14953068" author="kwin" created="Mon, 12 Oct 2015 12:42:28 +0000"  >&lt;p&gt;I updated the PR. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pderop&quot; class=&quot;user-hover&quot; rel=&quot;pderop&quot;&gt;pderop&lt;/a&gt; Would you mind testing it again? Now the transitive dependencies are again embedded in the final JAR but those packages which are part of bndlib are filtered out.&lt;/p&gt;</comment>
                            <comment id="14955706" author="pderop" created="Tue, 13 Oct 2015 21:23:24 +0000"  >&lt;p&gt;Hi Konrad;&lt;/p&gt;

&lt;p&gt;I just looked into your latest patch, and it looks good to me &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I made a successful test using the latest bndtools, and also using maven I verified that the bndlib 2.1.0 is not present anymore in the maven classpath; and I also observed that using your patch none of the packages that are part of bndlib are not included anymore in the scr.bnd artifact.&lt;/p&gt;

&lt;p&gt;Only one question now: why not depending on bndlib 3.0.0 instead of the old bndlib 2.1.0 ?&lt;/p&gt;

&lt;p&gt;in scr.bnd pom.xml:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;...
		&amp;lt;dependency&amp;gt;
		  &amp;lt;groupId&amp;gt;biz.aQute.bnd&amp;lt;/groupId&amp;gt;
		  &amp;lt;!--
			&amp;lt;artifactId&amp;gt;bndlib&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;2.1.0&amp;lt;/version&amp;gt;
		  --&amp;gt;
		  &amp;lt;artifactId&amp;gt;biz.aQute.bndlib&amp;lt;/artifactId&amp;gt;
                  &amp;lt;version&amp;gt;3.0.0&amp;lt;/version&amp;gt;
		&amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
		&amp;lt;/dependency&amp;gt;
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So, are you ok if I apply your patch, but using a dependency on bndlib 3.0.0 ?&lt;/p&gt;

</comment>
                            <comment id="14956325" author="kwin" created="Wed, 14 Oct 2015 05:58:17 +0000"  >&lt;p&gt;Hi Pierre,&lt;br/&gt;
thanks for testing. Usually you depend on the minimal version of a dependency you need. If felix.scr.bnd is still compatible with bndlib 2.1.0 you should still depend on exactly that version. Only if scr.bnd depends on some bndlib 3.0.0 only features you should increase that dependency. Otherwise you detect incompatibilities only at run time and not at compile time (e.g. if you leverage new methods being added in 3.0.0). If you still want to increase the dependency to bndlib 3.0.0 please clearly state, that this plugin is only compatible with bnd 3+.&lt;br/&gt;
Thanks in advance for applying my patch.&lt;br/&gt;
Konrad&lt;/p&gt;</comment>
                            <comment id="14956340" author="pderop" created="Wed, 14 Oct 2015 06:16:45 +0000"  >&lt;p&gt;Ok, I do agree; we don&apos;t depend on some specific bndlib 3+ api, so let&apos;s continue to depend on bndlib 2.1.0. &lt;br/&gt;
Thanks.&lt;/p&gt;</comment>
                            <comment id="14973469" author="githubbot" created="Sun, 25 Oct 2015 22:32:10 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/38&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/38&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14973470" author="pderop" created="Sun, 25 Oct 2015 22:34:07 +0000"  >&lt;p&gt;Applied the patch (thanks Konrad).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12728203">FELIX-4567</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12765864" name="pom.xml" size="1189" author="kwin" created="Fri, 9 Oct 2015 17:42:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 4 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2mtun:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>