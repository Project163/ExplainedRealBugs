<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:30:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-2982] noInitialDelay option does not work</title>
                <link>https://issues.apache.org/jira/browse/FELIX-2982</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;The noInitialDelay option currently does not work - bundles are installed immediately regardless of the option&apos;s value. To reproduce this, I used Apache Karaf 2.2.1, which uses fileinstall 3.1.10. I edited the etc/org.apache.felix.fileinstall-deploy.cfg file to something like this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;felix.fileinstall.dir     = ${karaf.base}/deploy
felix.fileinstall.tmpdir  = ${karaf.data}/generated-bundles
felix.fileinstall.poll    = 10000
felix.fileinstall.noInitialDelay = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I expected the jar I had in the deploy dir (&lt;a href=&quot;http://repo1.maven.org/maven2/org/apache/camel/camel-core/2.7.2/camel-core-2.7.2.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://repo1.maven.org/maven2/org/apache/camel/camel-core/2.7.2/camel-core-2.7.2.jar&lt;/a&gt;) to be installed 10 seconds after the container starts with this config, however it is installed immediately.&lt;/p&gt;

&lt;p&gt;Attaching a proposed fix for this shortly.&lt;/p&gt;</description>
                <environment>fileinstall 3.1.10</environment>
        <key id="12509216">FELIX-2982</key>
            <summary>noInitialDelay option does not work</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gnodet">Guillaume Nodet</assignee>
                                    <reporter username="janstey">Jonathan Anstey</reporter>
                        <labels>
                    </labels>
                <created>Fri, 3 Jun 2011 18:01:37 +0000</created>
                <updated>Tue, 17 Mar 2015 07:00:48 +0000</updated>
                            <resolved>Tue, 7 Jun 2011 06:58:37 +0000</resolved>
                                    <version>fileinstall-3.1.10</version>
                                    <fixVersion>fileinstall-3.2.0</fixVersion>
                                    <component>File Install</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13044824" author="gnt" created="Mon, 6 Jun 2011 12:50:35 +0000"  >&lt;p&gt;Yeah, I think the patch makes sense.   I&apos;ll apply it asap.&lt;/p&gt;</comment>
                            <comment id="13044826" author="gnt" created="Mon, 6 Jun 2011 13:01:29 +0000"  >&lt;p&gt;Though, the problem is that it would change the original behavior, so maybe introducing a new parameter would be better.&lt;/p&gt;</comment>
                            <comment id="13044832" author="janstey" created="Mon, 6 Jun 2011 13:17:01 +0000"  >&lt;p&gt;Yeah, I&apos;m fine with a new parameter for this.&lt;/p&gt;</comment>
                            <comment id="13044851" author="sahoo" created="Mon, 6 Jun 2011 14:06:25 +0000"  >&lt;p&gt;1. The change looks fine except that why not sleep(poll) before calling initializeCurrentManagedBundles()? &lt;br/&gt;
2. Because directory watcher thread could be scheduled after any amount of delay, the existing code does not ensure any lower bound for initial delay. In such a case, I don&apos;t think there is really a change in promised behavior. Why should we add yet another option in FileInstall, which is supposed to be a simple management agent? &lt;/p&gt;</comment>
                            <comment id="13044859" author="janstey" created="Mon, 6 Jun 2011 14:13:55 +0000"  >&lt;p&gt;I used Thread.sleep instead of wait(poll) because FileInstall will call notify on the DirectoryWatcher in its initial wait(poll) call every time so there will never be an initial delay.&lt;/p&gt;</comment>
                            <comment id="13044865" author="janstey" created="Mon, 6 Jun 2011 14:17:42 +0000"  >&lt;p&gt;Also, I&apos;m fine with adding the delay before initializeCurrentManagedBundles(), though I haven&apos;t tested if this will change the behavior.&lt;/p&gt;</comment>
                            <comment id="13044875" author="gnt" created="Mon, 6 Jun 2011 14:31:04 +0000"  >&lt;p&gt;@sahoo: the noInitialDelay has this particular purpose as the first scan is executed in the same thread when the flag is set to true.&lt;br/&gt;
It was introduced to minimize the latency and make sure you could somewhat control a bit more what&apos;s going on, especially when the provisioning is not only done with fileinstall, which i think is the root of the problems.&lt;/p&gt;

&lt;p&gt;If nobody thinks keeping the old behavior is important, we definitely do not need the delay, but i thought that would prevent possible behavioral changes.&lt;/p&gt;</comment>
                            <comment id="13044912" author="sahoo" created="Mon, 6 Jun 2011 15:28:07 +0000"  >&lt;p&gt;I understand the effect of noInitialDelay=true, but this bug is about noInitialDelay=false. When noInitialDelay=false, since currently there is no guaranteed lower bound for initial delay, I don&apos;t see what behavior we are breaking by introducing a lower bound for the delay.&lt;/p&gt;</comment>
                            <comment id="13044931" author="gnt" created="Mon, 6 Jun 2011 16:08:19 +0000"  >&lt;p&gt;Committing to &lt;a href=&quot;https://svn.apache.org/repos/asf/felix/trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/repos/asf/felix/trunk&lt;/a&gt; ...&lt;br/&gt;
	M	fileinstall/src/main/java/org/apache/felix/fileinstall/internal/DirectoryWatcher.java&lt;br/&gt;
Committed r1132690&lt;/p&gt;

&lt;p&gt;Patch from Jon improved with Sahoo suggestions.&lt;/p&gt;</comment>
                            <comment id="13044935" author="janstey" created="Mon, 6 Jun 2011 16:11:16 +0000"  >&lt;p&gt;Great, thanks guys.&lt;/p&gt;</comment>
                            <comment id="13044984" author="sahoo" created="Mon, 6 Jun 2011 18:00:02 +0000"  >&lt;p&gt;On a second look, I think there is a bug in the patch. Upon InterruptedException, it does not return from run(), it merely logs the exception. Please fix this.&lt;/p&gt;</comment>
                            <comment id="13045004" author="gnt" created="Mon, 6 Jun 2011 18:28:11 +0000"  >&lt;p&gt;Fixed&lt;/p&gt;</comment>
                            <comment id="13045258" author="sahoo" created="Tue, 7 Jun 2011 03:39:35 +0000"  >&lt;p&gt;Did you forget to mark it RESOLVED?&lt;/p&gt;</comment>
                            <comment id="13045298" author="gnt" created="Tue, 7 Jun 2011 06:58:37 +0000"  >&lt;p&gt;Thx, I did not noticed you actually re-opened it, I thought it was just a comment.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12496210">FELIX-2794</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12481381" name="FELIX-2982.patch" size="1189" author="janstey" created="Fri, 3 Jun 2011 18:02:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40372</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 25 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0apvb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>60464</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>