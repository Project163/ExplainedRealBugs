<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:23:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-2927] [gogo] coercion mechanism invokes foo(String) instead of foo(int) - even with explicit int argument</title>
                <link>https://issues.apache.org/jira/browse/FELIX-2927</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;Equinox 3.7.M6 supports OSGi R4.3 which adds the overloaded method BundleContext.getBundle(String).&lt;/p&gt;

&lt;p&gt;This causes gogo startup to fail, as it expects to invoke getBundle(int) but actually invokes getBundle(String).&lt;/p&gt;

&lt;p&gt;Prior to R4.3, the gogo command: bundle 1&lt;br/&gt;
resulted in the String &quot;1&quot; being coerced into a long, so that getBundle(long) could be invoked.&lt;/p&gt;

&lt;p&gt;Now that getBundle(String) exists, the result depends on the order that methods are returned from Class.getMethods(), which varies between platforms:&lt;/p&gt;

&lt;p&gt;On Mac java version &quot;1.6.0_24&quot;:&lt;/p&gt;

&lt;p&gt;g! type bundle&lt;br/&gt;
bundle is Bundle context:bundle(long)&lt;br/&gt;
bundle is Bundle context:bundle()&lt;br/&gt;
bundle is Bundle context:bundle(String)&lt;/p&gt;


&lt;p&gt;On Windows 2003 server, java version &quot;1.6.0_24&quot;:&lt;br/&gt;
g! type bundle&lt;br/&gt;
bundle is Bundle context:bundle()&lt;br/&gt;
bundle is Bundle context:bundle(String)&lt;br/&gt;
bundle is Bundle context:bundle(long)&lt;/p&gt;

&lt;p&gt;The first &quot;exact&quot; match wins, where &quot;exact&quot; just means that all supplied arguments are used.&lt;br/&gt;
On the Mac, getBundle(long) still wins, but on Windows getBundle(String) wins and the gogo startup scripts fails.&lt;/p&gt;

&lt;p&gt;What&apos;s worse, is that even when you realise what is happening, it is still not possible to invoke getBundle(long):&lt;/p&gt;

&lt;p&gt;g! 1L = new Long 1&lt;br/&gt;
g! bundle $1L&lt;/p&gt;

&lt;p&gt;because in this case the long is coerced to a String to invoke get Bundle(String) and the getBundle(long) method is ignored.&lt;/p&gt;


&lt;p&gt;There are at least two problems here:&lt;/p&gt;

&lt;p&gt;1. the gogo coercion mechanism simply invokes the first method it can, regardless of whether any arguments needed to be converted.&lt;/p&gt;

&lt;p&gt;It should instead try to score each method, perhaps adding to the score each time an argument needs to be converted,&lt;br/&gt;
then it could invoke the method with the lowest score.&lt;br/&gt;
However, there may still be occasions when two methods have the same score and gogo needs to behave deterministically&lt;br/&gt;
and allow either method to be invoked by supplying less ambiguous arguments.&lt;/p&gt;

&lt;p&gt;2. all arguments in gogo start out as Strings, which make it awkward to prefer a method that takes an integer:&lt;br/&gt;
for example: g! bundle (new Long 1)&lt;/p&gt;

&lt;p&gt;getBundle(long) is the most likely target method, but gogo does not any syntax to indicate that arguments should be treated as numbers rather than Strings. One possibility would be to recognize numbers in gogo&apos;s Tokenizer similar to the way that true/false are handled:&lt;/p&gt;

&lt;p&gt;g! t = true&lt;br/&gt;
true&lt;br/&gt;
g! tt = &apos;true&apos;&lt;br/&gt;
true&lt;br/&gt;
g! set t&lt;br/&gt;
Boolean       t               true&lt;br/&gt;
String          tt              true&lt;/p&gt;

&lt;p&gt;The above shows that the bare word: true is tokenized as a Boolean, where as the quoted word &apos;true&apos; is tokenized as a String.&lt;br/&gt;
So bare numbers could be tokenized as Numbers, and the existing coercion mechanism would convert them back to Strings as needed;&lt;br/&gt;
alternative by quoting something that looks like a number, you force it to be tokenized as a String.&lt;/p&gt;












</description>
                <environment></environment>
        <key id="12504885">FELIX-2927</key>
            <summary>[gogo] coercion mechanism invokes foo(String) instead of foo(int) - even with explicit int argument</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="db82407">Derek Baum</assignee>
                                    <reporter username="db82407">Derek Baum</reporter>
                        <labels>
                    </labels>
                <created>Thu, 21 Apr 2011 12:56:24 +0000</created>
                <updated>Tue, 17 Mar 2015 07:06:32 +0000</updated>
                            <resolved>Sun, 12 Jun 2011 14:02:43 +0000</resolved>
                                    <version>gogo.runtime-0.8.0</version>
                                    <fixVersion>gogo.runtime-0.10.0</fixVersion>
                                    <component>Gogo Runtime</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13048326" author="db82407" created="Sun, 12 Jun 2011 14:02:43 +0000"  >&lt;p&gt;fixed by refactoring Reflective.java to give conversion cost for coercion.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12502739">FELIX-2894</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>50951</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 24 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0vs8n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>183548</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>