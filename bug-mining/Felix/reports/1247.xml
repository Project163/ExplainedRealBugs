<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:22:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-2825] The maven-ipojo-plugin does not replace component classes in WAR files</title>
                <link>https://issues.apache.org/jira/browse/FELIX-2825</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;HI,&lt;br/&gt;
I have notice a problem with the maven-ipojo-plugin on war package.&lt;br/&gt;
The resulting classes are incorrect.&lt;br/&gt;
Indeed when i create a war i have this error when i deploy it:&lt;br/&gt;
 createInstance -&amp;gt; Cannot invoke the constructor (method not found) :&lt;br/&gt;
Now if i create a bundle instead, i take the classes from it and i put it in the former war, the war works&lt;/p&gt;

&lt;p&gt;my plugins part of maven:&lt;br/&gt;
-------------------------------------------------&lt;br/&gt;
        &amp;lt;plugins&amp;gt;&lt;br/&gt;
            &amp;lt;plugin&amp;gt;&lt;br/&gt;
                &amp;lt;artifactId&amp;gt;maven-war-plugin&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
                &amp;lt;configuration&amp;gt;&lt;br/&gt;
                    &amp;lt;archive&amp;gt;&lt;br/&gt;
                        &amp;lt;manifestFile&amp;gt;${project.build.outputDirectory}/META-INF/MANIFEST.MF&amp;lt;/manifestFile&amp;gt;&lt;br/&gt;
                    &amp;lt;/archive&amp;gt;&lt;br/&gt;
                &amp;lt;/configuration&amp;gt;&lt;br/&gt;
            &amp;lt;/plugin&amp;gt;&lt;/p&gt;

&lt;p&gt;            &amp;lt;plugin&amp;gt;&lt;br/&gt;
                &amp;lt;groupId&amp;gt;org.apache.felix&amp;lt;/groupId&amp;gt;&lt;br/&gt;
                &amp;lt;artifactId&amp;gt;maven-bundle-plugin&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
                &amp;lt;version&amp;gt;1.4.3&amp;lt;/version&amp;gt;&lt;br/&gt;
                &amp;lt;extensions&amp;gt;true&amp;lt;/extensions&amp;gt;&lt;br/&gt;
                &amp;lt;executions&amp;gt;&lt;br/&gt;
                    &amp;lt;execution&amp;gt;&lt;br/&gt;
                        &amp;lt;id&amp;gt;bundle-manifest&amp;lt;/id&amp;gt;&lt;br/&gt;
                        &amp;lt;phase&amp;gt;process-classes&amp;lt;/phase&amp;gt;&lt;br/&gt;
                        &amp;lt;goals&amp;gt;&lt;br/&gt;
                            &amp;lt;goal&amp;gt;manifest&amp;lt;/goal&amp;gt;&lt;br/&gt;
                        &amp;lt;/goals&amp;gt;&lt;br/&gt;
                        &amp;lt;configuration&amp;gt;&lt;br/&gt;
                            &amp;lt;instructions&amp;gt;&lt;br/&gt;
                                &amp;lt;Bundle-ClassPath&amp;gt;&lt;br/&gt;
                                    .,&lt;br/&gt;
                                    WEB-INF/classes&lt;br/&gt;
                                &amp;lt;/Bundle-ClassPath&amp;gt;&lt;br/&gt;
                                &amp;lt;Embed-Directory&amp;gt;WEB-INF/lib&amp;lt;/Embed-Directory&amp;gt;&lt;br/&gt;
                                &amp;lt;Embed-Dependency&amp;gt;*;scope=compile|runtime&amp;lt;/Embed-Dependency&amp;gt;&lt;br/&gt;
                                &amp;lt;Embed-Transitive&amp;gt;true&amp;lt;/Embed-Transitive&amp;gt;&lt;br/&gt;
                                &amp;lt;Web-ContextPath&amp;gt;webapp&amp;lt;/Web-ContextPath&amp;gt;&lt;br/&gt;
                                &amp;lt;Webapp-Context&amp;gt;webapp&amp;lt;/Webapp-Context&amp;gt;&lt;br/&gt;
                            &amp;lt;/instructions&amp;gt;&lt;br/&gt;
                        &amp;lt;/configuration&amp;gt;&lt;br/&gt;
                    &amp;lt;/execution&amp;gt;&lt;br/&gt;
                &amp;lt;/executions&amp;gt;&lt;br/&gt;
                &amp;lt;configuration&amp;gt;&lt;br/&gt;
                    &amp;lt;supportedProjectTypes&amp;gt;&lt;br/&gt;
                        &amp;lt;supportedProjectType&amp;gt;jar&amp;lt;/supportedProjectType&amp;gt;&lt;br/&gt;
                        &amp;lt;supportedProjectType&amp;gt;bundle&amp;lt;/supportedProjectType&amp;gt;&lt;br/&gt;
                        &amp;lt;supportedProjectType&amp;gt;war&amp;lt;/supportedProjectType&amp;gt;&lt;br/&gt;
                    &amp;lt;/supportedProjectTypes&amp;gt;&lt;br/&gt;
                &amp;lt;/configuration&amp;gt;&lt;br/&gt;
            &amp;lt;/plugin&amp;gt;&lt;/p&gt;

&lt;p&gt;            &amp;lt;plugin&amp;gt;&lt;br/&gt;
                &amp;lt;groupId&amp;gt;org.apache.felix&amp;lt;/groupId&amp;gt;&lt;br/&gt;
                &amp;lt;artifactId&amp;gt;maven-ipojo-plugin&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
                &amp;lt;version&amp;gt;1.8.0&amp;lt;/version&amp;gt;&lt;br/&gt;
                &amp;lt;executions&amp;gt;&lt;br/&gt;
                    &amp;lt;execution&amp;gt;&lt;br/&gt;
                        &amp;lt;goals&amp;gt;&lt;br/&gt;
                            &amp;lt;goal&amp;gt;ipojo-bundle&amp;lt;/goal&amp;gt;&lt;br/&gt;
                        &amp;lt;/goals&amp;gt;&lt;br/&gt;
                    &amp;lt;/execution&amp;gt;&lt;br/&gt;
                &amp;lt;/executions&amp;gt;&lt;br/&gt;
            &amp;lt;/plugin&amp;gt;&lt;br/&gt;
        &amp;lt;/plugins&amp;gt;&lt;br/&gt;
-------------------------------------------------------------&lt;/p&gt;</description>
                <environment>Jetty, Windows</environment>
        <key id="12497773">FELIX-2825</key>
            <summary>The maven-ipojo-plugin does not replace component classes in WAR files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="clement.escoffier">Clement Escoffier</assignee>
                                    <reporter username="dyblast">Dyblast</reporter>
                        <labels>
                    </labels>
                <created>Sun, 6 Feb 2011 00:54:40 +0000</created>
                <updated>Mon, 4 Feb 2013 12:34:27 +0000</updated>
                            <resolved>Mon, 7 Feb 2011 15:56:18 +0000</resolved>
                                    <version>iPOJO-1.8.0</version>
                                    <fixVersion>ipojo-manipulator-1.8.2</fixVersion>
                                    <component>iPOJO</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12991227" author="dyblast" created="Sun, 6 Feb 2011 22:02:41 +0000"  >&lt;p&gt;I have found the issue...&lt;br/&gt;
the class is correctly generated but it never inject into the final war...&lt;br/&gt;
Indeed&lt;br/&gt;
Pojoization.java:382&lt;br/&gt;
                // If the class was manipulated, write out the manipulated&lt;br/&gt;
                // version of the bytecode&lt;br/&gt;
                if (m_classes.containsKey(curEntry.getName())) {&lt;br/&gt;
                    JarEntry je = new JarEntry(curEntry.getName());&lt;br/&gt;
                    byte[] outClazz = (byte[]) m_classes.get(curEntry.getName());&lt;br/&gt;
                    if (outClazz != null &amp;amp;&amp;amp; outClazz.length != 0) {&lt;br/&gt;
                        jos.putNextEntry(je); // copy the entry header to jos&lt;br/&gt;
                        jos.write(outClazz);&lt;/p&gt;

&lt;p&gt;So the program check if there is a class corresponding to a directory entry ... for example&lt;br/&gt;
m_classes = &lt;/p&gt;
{com/truc/blabla.class}
&lt;p&gt; and curEntry = WEB-INF/classes/com/truc/blabla.class&lt;br/&gt;
So the orignal class is copied and not replaced.&lt;/p&gt;

&lt;p&gt;Small ugly fix: &lt;br/&gt;
                String classEntry = curEntry.getName().replace(&quot;WEB-INF/classes/&quot;,&quot;&quot;);&lt;br/&gt;
                if (m_classes.containsKey(classEntry)) {&lt;br/&gt;
                    JarEntry je = new JarEntry(curEntry.getName());&lt;br/&gt;
                    byte[] outClazz = (byte[]) m_classes.get(classEntry);&lt;/p&gt;</comment>
                            <comment id="12991422" author="clement.escoffier" created="Mon, 7 Feb 2011 15:56:19 +0000"  >&lt;p&gt;Fixed in trunk.&lt;/p&gt;

&lt;p&gt;I&apos;ve modified your patch a bit, please check with the manipulator and the maven-ipojo-plugin from the trunk (1.9.0-SNAPSHOT).&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13178088" author="bob.ziuchkovski@gmail.com" created="Sat, 31 Dec 2011 22:41:57 +0000"  >&lt;p&gt;I have run into the same problem.  I checked-out and built the ipojo trunk to test this fix.  Unfortunately, it looks like the code in the externalize() method of src/main/java/org/apache/felix/ipojo/manipulator/store/mapper/WABResourceMapper.java fails via throwing IllegalArgumentException when it encounters any non-class file, such as META-INF/MANIFEST.MF.  If desired, I can craft and upload a simple test maven war project to reproduce the issue.&lt;/p&gt;</comment>
                            <comment id="13178707" author="sauthieg" created="Tue, 3 Jan 2012 12:09:46 +0000"  >&lt;p&gt;As you already have the source code of the manipulator, maybe you could add a simple WABResourceMapperTestCase (if not already existing) that reproduce the problem.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40407</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 47 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0aq27:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>60495</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>