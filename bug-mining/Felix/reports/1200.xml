<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:21:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-2752] DepencyManager causes IllegalStateException by calling setProperties on unregistered ServiceRegistration</title>
                <link>https://issues.apache.org/jira/browse/FELIX-2752</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;When DependecyManager unBinds a component it calls unregister on the underlying ServiceRegistration but does NOT nullify the m_registration reference to it. When at a later time it binds the component again the reference is overwritten with a new one and all is well. However, when the service implementaion calls setSetserviceProperties(props) on the component during the start callback (and thus before registration) this method will call setProperties on the unregistered m_registration resulting in an IllegalStateException thrown by org.apache.felix.framework.ServiceRegistrationImpl. Below the stacktrace. Simple setting m_registration to null at line 910 seems to resolve the issue.&lt;/p&gt;

&lt;p&gt;The service registration is no longer valid.&lt;br/&gt;
java.lang.IllegalStateException: The service registration is no longer valid.&lt;br/&gt;
        at org.apache.felix.framework.ServiceRegistrationImpl.setProperties(ServiceRegistrationImpl.java:107)&lt;br/&gt;
        at org.apache.felix.dm.impl.ServiceRegistrationImpl.setProperties(ServiceRegistrationImpl.java:45)&lt;br/&gt;
        at org.apache.felix.dm.impl.ComponentImpl.setServiceProperties(ComponentImpl.java:501)&lt;br/&gt;
        at org.amdatu.core.fabrictest.internal.RemotableServiceImpl.start(RemotableServiceImpl.java:33)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
        at org.apache.felix.dm.InvocationUtil.invokeMethod(InvocationUtil.java:45)&lt;br/&gt;
        at org.apache.felix.dm.InvocationUtil.invokeCallbackMethod(InvocationUtil.java:13)&lt;br/&gt;
        at org.apache.felix.dm.impl.ComponentImpl.invokeCallbackMethod(ComponentImpl.java:684)&lt;br/&gt;
        at org.apache.felix.dm.impl.ComponentImpl.invoke(ComponentImpl.java:675)&lt;br/&gt;
        at org.apache.felix.dm.impl.ComponentImpl.bindService(ComponentImpl.java:620)&lt;br/&gt;
        at org.apache.felix.dm.impl.ComponentImpl.access$400(ComponentImpl.java:52)&lt;br/&gt;
        at org.apache.felix.dm.impl.ComponentImpl$7.run(ComponentImpl.java:178)&lt;br/&gt;
        at org.apache.felix.dm.impl.SerialExecutor$1.run(SerialExecutor.java:47)&lt;br/&gt;
        at org.apache.felix.dm.impl.SerialExecutor.scheduleNext(SerialExecutor.java:84)&lt;br/&gt;
        at org.apache.felix.dm.impl.SerialExecutor.access$000(SerialExecutor.java:33)&lt;br/&gt;
        at org.apache.felix.dm.impl.SerialExecutor$1.run(SerialExecutor.java:50)&lt;br/&gt;
        at org.apache.felix.dm.impl.SerialExecutor.scheduleNext(SerialExecutor.java:84)&lt;br/&gt;
        at org.apache.felix.dm.impl.SerialExecutor.execute(SerialExecutor.java:68)&lt;br/&gt;
        at org.apache.felix.dm.impl.ComponentImpl.calculateStateChanges(ComponentImpl.java:228)&lt;br/&gt;
        at org.apache.felix.dm.impl.ComponentImpl.dependencyAvailable(ComponentImpl.java:371)&lt;br/&gt;
        at org.apache.felix.dm.impl.dependencies.ServiceDependencyImpl.addedService(ServiceDependencyImpl.java:433)&lt;br/&gt;
        at org.apache.felix.dm.tracker.ServiceTracker$Tracked.customizerAdded(ServiceTracker.java:1145)&lt;br/&gt;
        at org.apache.felix.dm.tracker.AbstractTracked.trackAdding(AbstractTracked.java:286)&lt;br/&gt;
        at org.apache.felix.dm.tracker.AbstractTracked.track(AbstractTracked.java:232)&lt;br/&gt;
        at org.apache.felix.dm.tracker.ServiceTracker$Tracked.serviceChanged(ServiceTracker.java:1026)&lt;br/&gt;
        at org.apache.felix.framework.util.EventDispatcher.invokeServiceListenerCallback(EventDispatcher.java:871)&lt;br/&gt;
        at org.apache.felix.framework.util.EventDispatcher.fireEventImmediately(EventDispatcher.java:733)&lt;br/&gt;
        at org.apache.felix.framework.util.EventDispatcher.fireServiceEvent(EventDispatcher.java:662)&lt;br/&gt;
        at org.apache.felix.framework.Felix.fireServiceEvent(Felix.java:3721)&lt;br/&gt;
        at org.apache.felix.framework.Felix.access$000(Felix.java:80)&lt;br/&gt;
        at org.apache.felix.framework.Felix$2.serviceChanged(Felix.java:717)&lt;br/&gt;
        at org.apache.felix.framework.ServiceRegistry.registerService(ServiceRegistry.java:107)&lt;br/&gt;
        at org.apache.felix.framework.Felix.registerService(Felix.java:2842)&lt;br/&gt;
        at org.apache.felix.framework.BundleContextImpl.registerService(BundleContextImpl.java:251)&lt;br/&gt;
        at org.apache.felix.framework.BundleContextImpl.registerService(BundleContextImpl.java:229)&lt;br/&gt;
        at org.apache.felix.dm.impl.ComponentImpl.registerService(ComponentImpl.java:860)&lt;br/&gt;
        at org.apache.felix.dm.impl.ComponentImpl.bindService(ComponentImpl.java:624)&lt;br/&gt;
        at org.apache.felix.dm.impl.ComponentImpl.access$400(ComponentImpl.java:52)&lt;br/&gt;
        at org.apache.felix.dm.impl.ComponentImpl$7.run(ComponentImpl.java:178)&lt;br/&gt;
        at org.apache.felix.dm.impl.SerialExecutor$1.run(SerialExecutor.java:47)&lt;br/&gt;
        at org.apache.felix.dm.impl.SerialExecutor.scheduleNext(SerialExecutor.java:84)&lt;br/&gt;
        at org.apache.felix.dm.impl.SerialExecutor.access$000(SerialExecutor.java:33)&lt;br/&gt;
        at org.apache.felix.dm.impl.SerialExecutor$1.run(SerialExecutor.java:50)&lt;br/&gt;
        at org.apache.felix.dm.impl.SerialExecutor.scheduleNext(SerialExecutor.java:84)&lt;br/&gt;
        at org.apache.felix.dm.impl.SerialExecutor.access$000(SerialExecutor.java:33)&lt;br/&gt;
        at org.apache.felix.dm.impl.SerialExecutor$1.run(SerialExecutor.java:50)&lt;br/&gt;
        at org.apache.felix.dm.impl.SerialExecutor.scheduleNext(SerialExecutor.java:84)&lt;br/&gt;
        at org.apache.felix.dm.impl.SerialExecutor.execute(SerialExecutor.java:68)&lt;br/&gt;
        at org.apache.felix.dm.impl.ComponentImpl.calculateStateChanges(ComponentImpl.java:228)&lt;br/&gt;
        at org.apache.felix.dm.impl.ComponentImpl.start(ComponentImpl.java:406)&lt;br/&gt;
        at org.apache.felix.dm.DependencyManager.add(DependencyManager.java:81)&lt;br/&gt;
        at org.amdatu.core.fabric.service.FabricManagerServiceImpl.createRemote(FabricManagerServiceImpl.java:149)&lt;br/&gt;
        at org.amdatu.core.fabrictest.shell.FabricManagerCommand.executeRemoteCreateCommand(FabricManagerCommand.java:260)&lt;/p&gt;

</description>
                <environment>trunk revision: 1053368</environment>
        <key id="12494182">FELIX-2752</key>
            <summary>DepencyManager causes IllegalStateException by calling setProperties on unregistered ServiceRegistration</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="marrs">Marcel Offermans</assignee>
                                    <reporter username="bramk">Bram de Kruijff</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Dec 2010 17:07:54 +0000</created>
                <updated>Wed, 29 Dec 2010 12:13:28 +0000</updated>
                            <resolved>Tue, 28 Dec 2010 18:53:02 +0000</resolved>
                                                                    <component>Dependency Manager</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12975582" author="marrs" created="Tue, 28 Dec 2010 18:53:02 +0000"  >&lt;p&gt;Fixed. Please close if this resolves your issue, Bram.&lt;/p&gt;</comment>
                            <comment id="12975767" author="bramk" created="Wed, 29 Dec 2010 12:13:28 +0000"  >&lt;p&gt;Works for me. Case closed. Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40470</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 48 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0aq9j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>60528</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>