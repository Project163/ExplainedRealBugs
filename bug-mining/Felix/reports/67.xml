<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:05:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-340] Plug-in fails if dependencies are not all jar files</title>
                <link>https://issues.apache.org/jira/browse/FELIX-340</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;I&apos;m just trying to make my first bundle using the felix maven-bundle-plugin.&lt;br/&gt;
As this bundle is intended to have a quite big number of dependencies, I&apos;ve created a pom module that only defines all the dependencies. The  this module has been placed in the dependencies section of my bundle&apos;s pom.xml.&lt;br/&gt;
looks like this: a --&amp;gt; b --&amp;gt; (c, d, e, f, g, h, i, ...)&lt;/p&gt;

&lt;p&gt;When I just build my bundle, It finish quite soon with a NPE in JarFile!&lt;br/&gt;
-&amp;gt; The bundleplugin only manage jar file as dependencies. It should at least check the dependency type before assuming this is a jar file.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12376228">FELIX-340</key>
            <summary>Plug-in fails if dependencies are not all jar files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mcculls">Stuart McCulloch</assignee>
                                    <reporter username="sauthieg">Guillaume Sauthier</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Aug 2007 09:11:20 +0000</created>
                <updated>Tue, 25 Sep 2007 06:59:16 +0000</updated>
                            <resolved>Wed, 22 Aug 2007 03:30:11 +0000</resolved>
                                    <version>framework-1.0.0</version>
                                                    <component>Maven Bundle Plugin</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12520501" author="sauthieg" created="Fri, 17 Aug 2007 09:15:02 +0000"  >&lt;p&gt;Here are the poms that can be used to reproduce the issue:&lt;/p&gt;

&lt;p&gt;1. mvn install in the &apos;api&apos; module&lt;br/&gt;
2. mvn install in the &apos;bundle&apos; module&lt;/p&gt;

&lt;p&gt;This will produce the following Exception (with both 1.0.0 or 1.10-SNAPSHOT)&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; ------------------------------------------------------------------------&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; BUILD ERROR&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; ------------------------------------------------------------------------&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Error calculating classpath for project org.apache.maven.project.MavenProject@f51209b4&lt;/p&gt;

&lt;p&gt;Embedded error: error in opening zip file&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; ------------------------------------------------------------------------&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Trace&lt;br/&gt;
org.apache.maven.lifecycle.LifecycleExecutionException: Error calculating classpath for project org.apache.maven.project.MavenProject@f51209b4&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoals(DefaultLifecycleExecutor.java:564)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalWithLifecycle(DefaultLifecycleExecutor.java:480)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoal(DefaultLifecycleExecutor.java:459)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalAndHandleFailures(DefaultLifecycleExecutor.java:311)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeTaskSegments(DefaultLifecycleExecutor.java:278)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.execute(DefaultLifecycleExecutor.java:143)&lt;br/&gt;
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:334)&lt;br/&gt;
        at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:125)&lt;br/&gt;
        at org.apache.maven.cli.MavenCli.main(MavenCli.java:272)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:585)&lt;br/&gt;
        at org.codehaus.classworlds.Launcher.launchEnhanced(Launcher.java:315)&lt;br/&gt;
        at org.codehaus.classworlds.Launcher.launch(Launcher.java:255)&lt;br/&gt;
        at org.codehaus.classworlds.Launcher.mainWithExitCode(Launcher.java:430)&lt;br/&gt;
        at org.codehaus.classworlds.Launcher.main(Launcher.java:375)&lt;br/&gt;
Caused by: org.apache.maven.plugin.MojoExecutionException: Error calculating classpath for project org.apache.maven.project.MavenProject@f51209b4&lt;br/&gt;
        at org.apache.felix.bundleplugin.BundlePlugin.execute(BundlePlugin.java:155)&lt;br/&gt;
        at org.apache.felix.bundleplugin.BundlePlugin.execute(BundlePlugin.java:143)&lt;br/&gt;
        at org.apache.maven.plugin.DefaultPluginManager.executeMojo(DefaultPluginManager.java:443)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoals(DefaultLifecycleExecutor.java:539)&lt;br/&gt;
        ... 16 more&lt;br/&gt;
Caused by: java.util.zip.ZipException: error in opening zip file&lt;br/&gt;
        at java.util.zip.ZipFile.open(Native Method)&lt;br/&gt;
        at java.util.zip.ZipFile.&amp;lt;init&amp;gt;(ZipFile.java:203)&lt;br/&gt;
        at java.util.zip.ZipFile.&amp;lt;init&amp;gt;(ZipFile.java:234)&lt;br/&gt;
        at aQute.lib.osgi.ZipResource.build(ZipResource.java:39)&lt;br/&gt;
        at aQute.lib.osgi.ZipResource.build(ZipResource.java:32)&lt;br/&gt;
        at aQute.lib.osgi.Jar.&amp;lt;init&amp;gt;(Jar.java:31)&lt;br/&gt;
        at org.apache.felix.bundleplugin.BundlePlugin.getClasspath(BundlePlugin.java:356)&lt;br/&gt;
        at org.apache.felix.bundleplugin.BundlePlugin.execute(BundlePlugin.java:151)&lt;br/&gt;
        ... 19 more&lt;/p&gt;</comment>
                            <comment id="12520502" author="sauthieg" created="Fri, 17 Aug 2007 09:26:36 +0000"  >&lt;p&gt;Here is the patch.&lt;/p&gt;

&lt;p&gt;This patch simply select only the dependencies that are .jar files before trying to unpack them.&lt;/p&gt;

&lt;p&gt;Just notice that if you try to re-run the pom I provided, you will still have an error, but only telling that the result jar file is empty (as my only dependency is a pom, and because I did not selected it, I have no deps to filter, resulting in an empty jar, and thus an error from BND).&lt;/p&gt;

&lt;p&gt;Here is the new exception, for info:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;bundle:bundle&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Error building bundle test.osgi:bundle:bundle:1.0.0-SNAPSHOT : The JAR is empty&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; ------------------------------------------------------------------------&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; BUILD ERROR&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; ------------------------------------------------------------------------&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Found errors, see log&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; ------------------------------------------------------------------------&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Trace&lt;br/&gt;
org.apache.maven.lifecycle.LifecycleExecutionException: Unknown error occurred&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoals(DefaultLifecycleExecutor.java:564)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalWithLifecycle(DefaultLifecycleExecutor.java:480)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoal(DefaultLifecycleExecutor.java:459)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalAndHandleFailures(DefaultLifecycleExecutor.java:311)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeTaskSegments(DefaultLifecycleExecutor.java:278)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.execute(DefaultLifecycleExecutor.java:143)&lt;br/&gt;
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:334)&lt;br/&gt;
        at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:125)&lt;br/&gt;
        at org.apache.maven.cli.MavenCli.main(MavenCli.java:272)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:585)&lt;br/&gt;
        at org.codehaus.classworlds.Launcher.launchEnhanced(Launcher.java:315)&lt;br/&gt;
        at org.codehaus.classworlds.Launcher.launch(Launcher.java:255)&lt;br/&gt;
        at org.codehaus.classworlds.Launcher.mainWithExitCode(Launcher.java:430)&lt;br/&gt;
        at org.codehaus.classworlds.Launcher.main(Launcher.java:375)&lt;br/&gt;
Caused by: org.apache.maven.plugin.MojoExecutionException: Unknown error occurred&lt;br/&gt;
        at org.apache.felix.bundleplugin.BundlePlugin.execute(BundlePlugin.java:262)&lt;br/&gt;
        at org.apache.felix.bundleplugin.BundlePlugin.execute(BundlePlugin.java:156)&lt;br/&gt;
        at org.apache.felix.bundleplugin.BundlePlugin.execute(BundlePlugin.java:148)&lt;br/&gt;
        at org.apache.maven.plugin.DefaultPluginManager.executeMojo(DefaultPluginManager.java:443)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoals(DefaultLifecycleExecutor.java:539)&lt;br/&gt;
        ... 16 more&lt;br/&gt;
Caused by: org.apache.maven.plugin.MojoFailureException: Found errors, see log&lt;br/&gt;
        at org.apache.felix.bundleplugin.BundlePlugin.execute(BundlePlugin.java:245)&lt;br/&gt;
        ... 20 more&lt;/p&gt;</comment>
                            <comment id="12521663" author="mcculls" created="Wed, 22 Aug 2007 03:15:52 +0000"  >&lt;p&gt;looking at the maven documentation, the correct way to filter classpath artifacts is using:&lt;/p&gt;

&lt;p&gt;   artifact.getArtifactHandler().isAddedToClasspath()&lt;/p&gt;

&lt;p&gt;I also believe we should be using project.getArtifacts() instead of getDependencyArtifacts&lt;br/&gt;
because the compilation classpath used to build Java sources is derived from getArtifacts.&lt;/p&gt;

&lt;p&gt;getDependencyArtifacts only returns artifacts directly referenced in the pom, which is why&lt;br/&gt;
the provided testcase failed with the provided patch - using getArtifacts it builds a bundle&lt;br/&gt;
containing various javax.* classes (because the test pom has Export-Package: javax.*)&lt;/p&gt;

&lt;p&gt;FYI, the key difference between the bundleplugin classpath and the compilation classpath is&lt;br/&gt;
that the bundleplugin always uses the file in the local repository, whereas maven will use the&lt;br/&gt;
output directories (ie. &apos;target/classes&apos;) for any projects in the same reactor.&lt;/p&gt;

&lt;p&gt;  (the reason the bundleplugin doesn&apos;t use the output directories is because for bundles&lt;br/&gt;
   they may not exist, or they may only contain some of the actual classes of the bundle)&lt;/p&gt;</comment>
                            <comment id="12521664" author="mcculls" created="Wed, 22 Aug 2007 03:22:04 +0000"  >&lt;p&gt;I also updated the maven-plugin-testing-harness to 1.1 because the 1.0 version&lt;br/&gt;
contained a bug where the maven project stub code always returned a list with&lt;br/&gt;
an empty string for getArtifacts() causing a class-cast-exception in the test.&lt;/p&gt;</comment>
                            <comment id="12521667" author="mcculls" created="Wed, 22 Aug 2007 03:30:11 +0000"  >&lt;p&gt;I&apos;ve fixed this in trunk and hope to make a new deployment of the bundleplugin once &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-308&quot; title=&quot;Add support for embedding dependency JAR files to bundle plugin&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-308&quot;&gt;&lt;del&gt;FELIX-308&lt;/del&gt;&lt;/a&gt; is applied.&lt;/p&gt;</comment>
                            <comment id="12521735" author="sauthieg" created="Wed, 22 Aug 2007 08:37:38 +0000"  >&lt;p&gt;Yep you&apos;re right, project.getArtifacts() is the good way to obtain all the resolved dependencies.&lt;br/&gt;
Thanks to point this out.&lt;/p&gt;
</comment>
                            <comment id="12529497" author="mcculls" created="Fri, 21 Sep 2007 17:02:26 +0000"  >&lt;p&gt;can this issue be closed?&lt;/p&gt;</comment>
                            <comment id="12530056" author="sauthieg" created="Tue, 25 Sep 2007 06:59:16 +0000"  >&lt;p&gt;Yep, that&apos;s OK for me&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12364013" name="FELIX-340.patch" size="1656" author="sauthieg" created="Fri, 17 Aug 2007 09:26:35 +0000"/>
                            <attachment id="12364012" name="FELIX-340.poms.zip" size="2267" author="sauthieg" created="Fri, 17 Aug 2007 09:15:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>58644</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 10 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0vygn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>184556</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>