<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:10:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-1197] Bundle Fragments not resolved correctly</title>
                <link>https://issues.apache.org/jira/browse/FELIX-1197</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;Hi all,&lt;/p&gt;

&lt;p&gt;I have the following behaviour, if I try to attach more than one bundle fragment to the same bundle host.&lt;/p&gt;

&lt;p&gt;java.lang.ClassCastException: org.apache.felix.framework.searchpolicy.ModuleImpl cannot be cast to [Ljava.lang.Object;&lt;br/&gt;
        at org.apache.felix.framework.FelixResolverState.checkForConflicts(FelixResolverState.java:220)&lt;br/&gt;
ERROR: Error starting &lt;a href=&quot;file:bundle/org.apache.felix.shell.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:bundle/org.apache.felix.shell.jar&lt;/a&gt; (org.osgi.framework.BundleException: Unresolved constraint in bundle 31: Unable to merge fragments)&lt;br/&gt;
        at org.apache.felix.framework.FelixResolverState.mergeFragments(FelixResolverState.java:139)&lt;br/&gt;
        at org.apache.felix.framework.Felix$FelixResolver.resolve(Felix.java:3708)&lt;br/&gt;
        at org.apache.felix.framework.Felix.resolveBundle(Felix.java:3091)&lt;br/&gt;
        at org.apache.felix.framework.Felix.startBundle(Felix.java:1439)&lt;br/&gt;
        at org.apache.felix.framework.Felix.setActiveStartLevel(Felix.java:984)&lt;br/&gt;
        at org.apache.felix.framework.StartLevelImpl.run(StartLevelImpl.java:263)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:619)&lt;/p&gt;

&lt;p&gt;The bundle fragments have been tested separately and they work as they should. &lt;br/&gt;
( e.g. Frag A =&amp;gt; Host A =&amp;gt; O.K.&lt;br/&gt;
          Frag B =&amp;gt; Host A =&amp;gt; O.K.&lt;br/&gt;
)&lt;/p&gt;

&lt;p&gt;If I try to resolve both bundle fragments than i get the exception above. I took a look at the source and it seems to me that there is a bug in the FelixResolverState class. Inside the method checkForConflicts(IModule host, List fragmentList) there is a map definition Map ipMerged = new HashMap(); where the key is a String and the Value a Object[] . &lt;br/&gt;
Later on in a for loop the same map is used to store keys from type String and values from type ModuleImpl. This causes a the above classcast exception in the line 220. &lt;/p&gt;

&lt;p&gt;Do I have any mistakes in my bundle fragment headers or is this realy a bug ?&lt;/p&gt;

&lt;p&gt;Best regards&lt;br/&gt;
Sergio&lt;/p&gt;</description>
                <environment></environment>
        <key id="12426941">FELIX-1197</key>
            <summary>Bundle Fragments not resolved correctly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rickhall">Richard S. Hall</assignee>
                                    <reporter username="sergiomestre">Sergio Mestre</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 Jun 2009 16:38:00 +0000</created>
                <updated>Wed, 10 Jun 2009 15:51:36 +0000</updated>
                            <resolved>Wed, 10 Jun 2009 15:51:36 +0000</resolved>
                                    <version>framework-1.8.0</version>
                                    <fixVersion>framework-2.0.0</fixVersion>
                                    <component>Framework</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12715615" author="rickhall" created="Tue, 2 Jun 2009 18:38:16 +0000"  >&lt;p&gt;Sounds like a bug. To make sure I understand the scenario, you just have two fragments wanting to attach to the same host, that&apos;s it. Right? If so, I will create such a test case and fix it. Thanks for reporting it.&lt;/p&gt;</comment>
                            <comment id="12715850" author="sergiomestre" created="Wed, 3 Jun 2009 07:33:41 +0000"  >&lt;p&gt;Yes that&apos;s right. I have two fragments importing nearly the same packages but exporting different packages. Both fragments should attach the same host.&lt;/p&gt;</comment>
                            <comment id="12715947" author="rickhall" created="Wed, 3 Jun 2009 15:14:16 +0000"  >&lt;p&gt;You mention that your fragments import nearly the same packages, Be aware that Felix fragment import conflict detection currently requires overlapping imports of fragments to be identical (i.e., same package, version range, attributes, and directives). If not, then it will not allow it.&lt;/p&gt;</comment>
                            <comment id="12716180" author="sergiomestre" created="Thu, 4 Jun 2009 06:56:51 +0000"  >&lt;p&gt;Thanks for this advise.&lt;/p&gt;</comment>
                            <comment id="12718118" author="rickhall" created="Wed, 10 Jun 2009 15:51:36 +0000"  >&lt;p&gt;Yes, this was just a bug in the use of a map with incorrect types for values. I guess generics would have helped in this case. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;It is fixed now. If you can test against the trunk, please do and then close this issue if satisfied. Thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>57821</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 24 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0vusn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>183962</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>