<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 16:13:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-6049] Listeners registered with boolean property are ignored</title>
                <link>https://issues.apache.org/jira/browse/FELIX-6049</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;I just tried to get a ServletContextListener to work, but did not succeed, although everything is done as defined by the spec.&lt;br/&gt;
&#160;&lt;br/&gt;
Here you can find a minimal example of my setup &lt;a href=&quot;https://github.com/Sandared/io.jatoms.osgi.possiblebugs.scl&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/Sandared/io.jatoms.osgi.possiblebugs.scl&lt;/a&gt;&lt;br/&gt;
&#160;&lt;br/&gt;
The Servlet I&apos;m registering is working fine, but the ServletContextListener that I registered too is never called.&#160;&lt;br/&gt;
Even if I call getServletContext() from within the Servlet, my Listener is never called.&lt;br/&gt;
I would have expected the ServletContextListener to be called at least once, after a DefaultServletContext has been created by the ServletContainer&lt;br/&gt;
&#160;&lt;br/&gt;
Additional Information:&lt;br/&gt;
The MySCL.java:&lt;br/&gt;
&#160;&lt;br/&gt;
@Component&lt;br/&gt;
@HttpWhiteboardListener&lt;br/&gt;
public class MySCL implements ServletContextListener {&lt;br/&gt;
&#160; &#160; @Override&lt;br/&gt;
&#160; &#160; public void contextDestroyed(ServletContextEvent arg0) &lt;/p&gt;
{
&#160; &#160; &#160; &#160; System.out.println(&quot;Destroyed&quot;);
&#160; &#160; }

&lt;p&gt;&#160; &#160; @Override&lt;br/&gt;
&#160; &#160; public void contextInitialized(ServletContextEvent arg0) &lt;/p&gt;
{
&#160; &#160; &#160; &#160; System.out.println(&quot;Initialized&quot;);
&#160; &#160; }
&lt;p&gt;}&lt;br/&gt;
&#160;&lt;br/&gt;
Bundles running:&lt;br/&gt;
START LEVEL 1&lt;br/&gt;
&#160; &#160;ID|State&#160; &#160;&#160; &#160;|Level|Name&lt;br/&gt;
&#160; &#160; 0|Active&#160; &#160;&#160; |&#160; &#160; 0|OSGi System Bundle (3.13.100.v20180827-1536)|3.13.100.v20180827-1536&lt;br/&gt;
&#160; &#160; 1|Active&#160; &#160;&#160; |&#160; &#160; 1|osgi.possiblebugs.scl.impl (0.0.1.201902051255)|0.0.1.201902051255&lt;br/&gt;
&#160; &#160; 2|Active&#160; &#160;&#160; |&#160; &#160; 1|Apache Commons FileUpload (1.3.3)|1.3.3&lt;br/&gt;
&#160; &#160; 3|Active&#160; &#160;&#160; |&#160; &#160; 1|Apache Commons IO (2.6.0)|2.6.0&lt;br/&gt;
&#160; &#160; 4|Active&#160; &#160;&#160; |&#160; &#160; 1|Apache Felix Gogo Command (1.0.2)|1.0.2&lt;br/&gt;
&#160; &#160; 5|Active&#160; &#160;&#160; |&#160; &#160; 1|Apache Felix Gogo Runtime (1.0.10)|1.0.10&lt;br/&gt;
&#160; &#160; 6|Active&#160; &#160;&#160; |&#160; &#160; 1|Apache Felix Gogo Shell (1.0.0)|1.0.0&lt;br/&gt;
&#160; &#160; 7|Active&#160; &#160;&#160; |&#160; &#160; 1|Apache Felix Http Jetty (4.0.6)|4.0.6Li&lt;br/&gt;
&#160; &#160; 8|Active&#160; &#160;&#160; |&#160; &#160; 1|Apache Felix Servlet API (1.1.2)|1.1.2&lt;br/&gt;
&#160; &#160; 9|Active&#160; &#160;&#160; |&#160; &#160; 1|Apache Felix Inventory (1.0.4)|1.0.4&lt;br/&gt;
&#160; &#160;10|Active&#160; &#160;&#160; |&#160; &#160; 1|Apache Felix Declarative Services (2.1.10)|2.1.10&lt;br/&gt;
&#160; &#160;11|Active&#160; &#160;&#160; |&#160; &#160; 1|Apache Felix Web Management Console (4.3.4)|4.3.4&lt;br/&gt;
&#160; &#160;12|Active&#160; &#160;&#160; |&#160; &#160; 1|Apache Felix Web Console Service Component Runtime/Declarative Services Plugin (2.0.8)|2.0.8&lt;br/&gt;
&#160; &#160;13|Active&#160; &#160;&#160; |&#160; &#160; 1|org.osgi:org.osgi.util.function (1.1.0.201802012106)|1.1.0.201802012106&lt;/p&gt;


&lt;p&gt;List of components registered:&lt;br/&gt;
&#160;&lt;br/&gt;
io.jatoms.osgi.possiblebugs.scl.MyServlet in bundle 1 (io.jatoms.osgi.possiblebugs.scl.impl:0.0.1.201902051258) enabled, 1 instance.&lt;br/&gt;
&#160; &#160; Id: 1, State:ACTIVE&lt;br/&gt;
io.jatoms.osgi.possiblebugs.scl.MySCL in bundle 1 (io.jatoms.osgi.possiblebugs.scl.impl:0.0.1.201902051258) enabled, 1 instance.&lt;br/&gt;
&#160; &#160; Id: 0, State:SATISFIED&lt;br/&gt;
&#160;&lt;br/&gt;
Info for MySCL component:&lt;br/&gt;
Class:&#160; &#160;&#160; &#160;&#160; &#160;io.jatoms.osgi.possiblebugs.scl.MySCL&lt;br/&gt;
Bundle:&#160; &#160;&#160; &#160;&#160; 1 (io.jatoms.osgi.possiblebugs.scl.impl:0.0.1.201902051258)&lt;br/&gt;
Enabled:&#160; &#160;&#160; &#160; true&lt;br/&gt;
Immediate:&#160; &#160;&#160; false&lt;br/&gt;
Services:&#160; &#160;&#160; &#160;&lt;span class=&quot;error&quot;&gt;&amp;#91;javax.servlet.ServletContextListener&amp;#93;&lt;/span&gt;&lt;br/&gt;
Scope:&#160; &#160;&#160; &#160;&#160; &#160;singleton&lt;br/&gt;
Config PID(s): &lt;span class=&quot;error&quot;&gt;&amp;#91;io.jatoms.osgi.possiblebugs.scl.MySCL&amp;#93;&lt;/span&gt;, Policy: optional&lt;br/&gt;
Base Props:&#160; &#160; (1 entry)&lt;br/&gt;
&#160; osgi.http.whiteboard.listener&amp;lt;Boolean&amp;gt; = true&lt;/p&gt;

&lt;p&gt;Component Configuration Id: 0&lt;br/&gt;
-----------------------------&lt;br/&gt;
State:&#160; &#160;&#160; &#160;&#160; SATISFIED&lt;br/&gt;
Service:&#160; &#160;&#160; &#160;50 &lt;span class=&quot;error&quot;&gt;&amp;#91;javax.servlet.ServletContextListener&amp;#93;&lt;/span&gt;&lt;br/&gt;
Config Props: (3 entries)&lt;br/&gt;
&#160; component.id&amp;lt;Long&amp;gt; = 0&lt;br/&gt;
&#160; component.name&amp;lt;String&amp;gt; = io.jatoms.osgi.possiblebugs.scl.MySCL&lt;br/&gt;
&#160; osgi.http.whiteboard.listener&amp;lt;Boolean&amp;gt; = true&lt;br/&gt;
References:&#160; &#160;(total 0)&lt;br/&gt;
&#160;&lt;br/&gt;
Is there anything wrong with this setup? Or is this a bug of felix.http?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13213936">FELIX-6049</key>
            <summary>Listeners registered with boolean property are ignored</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cziegeler">Carsten Ziegeler</assignee>
                                    <reporter username="tdriessen">Thomas Driessen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Feb 2019 15:16:49 +0000</created>
                <updated>Fri, 1 Mar 2019 14:13:53 +0000</updated>
                            <resolved>Thu, 7 Feb 2019 06:40:28 +0000</resolved>
                                    <version>http.jetty-4.0.6</version>
                    <version>http.base-4.0.4</version>
                    <version>http.bridge-4.0.4</version>
                                    <fixVersion>http.base-4.0.6</fixVersion>
                    <fixVersion>http.jetty-4.0.8</fixVersion>
                    <fixVersion>http.bridge-4.0.6</fixVersion>
                                    <component>HTTP Service</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16761840" author="cziegeler" created="Wed, 6 Feb 2019 15:14:54 +0000"  >&lt;p&gt;Registration looks ok to me, it seems your listener is not picked up.&lt;br/&gt;
Can you debug and see whether ListenersTracker#getServiceInfo is called for your listener? &lt;/p&gt;</comment>
                            <comment id="16761900" author="tdriessen" created="Wed, 6 Feb 2019 16:27:38 +0000"  >&lt;p&gt;ListenersTracker#getServiceInfo is called.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I searched a little bit and I think I found the reason why this is not working:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Within ListenerInfo constructor there is the following statement:&lt;/p&gt;

&lt;p&gt;this.enabled = &quot;true&quot;.equalsIgnoreCase(this.getStringProperty(ref, HttpWhiteboardConstants.HTTP_WHITEBOARD_LISTENER));&lt;/p&gt;

&lt;p&gt;This one returns false although the value is actually set to &quot;true&quot;.&lt;/p&gt;

&lt;p&gt;This is because getStringProperty() returns null if the value asked for is not of type String.&lt;/p&gt;

&lt;p&gt;The attribute HttpWhiteboardConstants.HTTP_WHITEBOARD_LISTENER is of type Boolean, so this statement evaluates to&#160;&quot;true&quot;.equalsIgnoreCase(null);&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The &quot;enabled&quot; value is then used in WhiteboardManager#addWhiteboardService to determine if the the service is actually valid, which it is not because it is not enabled.&lt;/p&gt;</comment>
                            <comment id="16761904" author="tdriessen" created="Wed, 6 Feb 2019 16:31:22 +0000"  >&lt;p&gt;A quick check validated this.&lt;/p&gt;

&lt;p&gt;If I change my component like this:&lt;/p&gt;

&lt;p&gt;@Component(property= {HttpWhiteboardConstants.HTTP_WHITEBOARD_LISTENER + &quot;=true&quot;})&lt;br/&gt;
public class MySCL implements ServletContextListener ...&lt;/p&gt;

&lt;p&gt;it works as expected.&lt;/p&gt;</comment>
                            <comment id="16762400" author="cziegeler" created="Thu, 7 Feb 2019 06:06:35 +0000"  >&lt;p&gt;Thanks, yes in R6 this property needed to be of type String, we relaxed that for R7 but apparently forgot to adjust the code&lt;/p&gt;</comment>
                            <comment id="16762408" author="cziegeler" created="Thu, 7 Feb 2019 06:37:01 +0000"  >&lt;p&gt;Fixed in rev 1853114.&lt;/p&gt;</comment>
                            <comment id="16763488" author="tdriessen" created="Fri, 8 Feb 2019 10:46:20 +0000"  >&lt;p&gt;Thanks &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 40 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|yi0oag:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>