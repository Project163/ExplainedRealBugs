<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:13:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-1715] osgi:update on xml deployments will cause ZIPExceptions</title>
                <link>https://issues.apache.org/jira/browse/FELIX-1715</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;I deployed a Spring xml file by copying it to deploy folder. It was installed fine.&lt;/p&gt;

&lt;p&gt;When trying to run&lt;br/&gt;
     osgi:update&lt;br/&gt;
on that bundle then it throws exceptions:&lt;/p&gt;

&lt;p&gt;-------------------------------------------------&lt;br/&gt;
karaf@root&amp;gt; update 195                                                                                                                                      &lt;br/&gt;
ERROR: Unable to update the bundle. (java.util.zip.ZipException: error in opening zip file)                                                                 &lt;br/&gt;
java.util.zip.ZipException: error in opening zip file                                                                                                       &lt;br/&gt;
        at java.util.zip.ZipFile.open(Native Method)                                                                                                        &lt;br/&gt;
        at java.util.zip.ZipFile.&amp;lt;init&amp;gt;(ZipFile.java:114)                                                                                                   &lt;br/&gt;
        at java.util.jar.JarFile.&amp;lt;init&amp;gt;(JarFile.java:133)                                                                                                   &lt;br/&gt;
        at java.util.jar.JarFile.&amp;lt;init&amp;gt;(JarFile.java:97)                                                                                                    &lt;br/&gt;
        at org.apache.felix.framework.util.JarFileX.&amp;lt;init&amp;gt;(JarFileX.java:36)                                                                                &lt;br/&gt;
        at org.apache.felix.framework.util.SecureAction.openJAR(SecureAction.java:592)                                                                      &lt;br/&gt;
        at org.apache.felix.framework.cache.JarRevision.getManifestHeader(JarRevision.java:90)                                                              &lt;br/&gt;
        at org.apache.felix.framework.BundleImpl.createModule(BundleImpl.java:1090)                                                                         &lt;br/&gt;
        at org.apache.felix.framework.BundleImpl.revise(BundleImpl.java:1044)                                                                               &lt;br/&gt;
        at org.apache.felix.framework.Felix.updateBundle(Felix.java:1835)                                                                                   &lt;br/&gt;
        at org.apache.felix.framework.BundleImpl.update(BundleImpl.java:908)                                                                                &lt;br/&gt;
        at org.apache.felix.framework.BundleImpl.update(BundleImpl.java:895)                                                                                &lt;br/&gt;
        at org.apache.felix.karaf.shell.osgi.UpdateBundle.doExecute(UpdateBundle.java:37)                                                                   &lt;br/&gt;
        at org.apache.felix.karaf.shell.osgi.BundleCommand.doExecute(BundleCommand.java:42)                                                                 &lt;br/&gt;
        at org.apache.felix.karaf.shell.console.OsgiCommandSupport.execute(OsgiCommandSupport.java:41)                                                      &lt;br/&gt;
        at org.apache.felix.gogo.commands.basic.AbstractCommand.execute(AbstractCommand.java:34)                                                            &lt;br/&gt;
        at org.apache.felix.gogo.runtime.shell.CommandProxy.execute(CommandProxy.java:45)                                                                   &lt;br/&gt;
        at org.apache.felix.gogo.runtime.shell.Closure.execute(Closure.java:211)                                                                            &lt;br/&gt;
        at org.apache.felix.gogo.runtime.shell.Closure.executeStatement(Closure.java:146)                                                                   &lt;br/&gt;
        at org.apache.felix.gogo.runtime.shell.Pipe.run(Pipe.java:91)                                                                                       &lt;br/&gt;
        at org.apache.felix.gogo.runtime.shell.Closure.execute(Closure.java:75)                                                                             &lt;br/&gt;
        at org.apache.felix.gogo.runtime.shell.CommandSessionImpl.execute(CommandSessionImpl.java:71)&lt;br/&gt;
        at org.apache.felix.karaf.shell.console.jline.Console.run(Console.java:115)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:619)&lt;br/&gt;
org.osgi.framework.BundleException: Update of bundle net.compart.dbesb.examples.webservice.mill &lt;span class=&quot;error&quot;&gt;&amp;#91;195&amp;#93;&lt;/span&gt; failed.&lt;br/&gt;
        at org.apache.felix.framework.Felix.updateBundle(Felix.java:1966)&lt;br/&gt;
        at org.apache.felix.framework.BundleImpl.update(BundleImpl.java:908)&lt;br/&gt;
        at org.apache.felix.framework.BundleImpl.update(BundleImpl.java:895)&lt;br/&gt;
        at org.apache.felix.karaf.shell.osgi.UpdateBundle.doExecute(UpdateBundle.java:37)&lt;br/&gt;
        at org.apache.felix.karaf.shell.osgi.BundleCommand.doExecute(BundleCommand.java:42)&lt;br/&gt;
        at org.apache.felix.karaf.shell.console.OsgiCommandSupport.execute(OsgiCommandSupport.java:41)&lt;br/&gt;
        at org.apache.felix.gogo.commands.basic.AbstractCommand.execute(AbstractCommand.java:34)&lt;br/&gt;
        at org.apache.felix.gogo.runtime.shell.CommandProxy.execute(CommandProxy.java:45)&lt;br/&gt;
        at org.apache.felix.gogo.runtime.shell.Closure.execute(Closure.java:211)&lt;br/&gt;
        at org.apache.felix.gogo.runtime.shell.Closure.executeStatement(Closure.java:146)&lt;br/&gt;
        at org.apache.felix.gogo.runtime.shell.Pipe.run(Pipe.java:91)&lt;br/&gt;
        at org.apache.felix.gogo.runtime.shell.Closure.execute(Closure.java:75)&lt;br/&gt;
        at org.apache.felix.gogo.runtime.shell.CommandSessionImpl.execute(CommandSessionImpl.java:71)&lt;br/&gt;
        at org.apache.felix.karaf.shell.console.jline.Console.run(Console.java:115)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:619)&lt;br/&gt;
Caused by: java.util.zip.ZipException: error in opening zip file&lt;br/&gt;
        at java.util.zip.ZipFile.open(Native Method)&lt;br/&gt;
        at java.util.zip.ZipFile.&amp;lt;init&amp;gt;(ZipFile.java:114)&lt;br/&gt;
        at java.util.jar.JarFile.&amp;lt;init&amp;gt;(JarFile.java:133)&lt;br/&gt;
        at java.util.jar.JarFile.&amp;lt;init&amp;gt;(JarFile.java:97)&lt;br/&gt;
        at org.apache.felix.framework.util.JarFileX.&amp;lt;init&amp;gt;(JarFileX.java:36)&lt;br/&gt;
        at org.apache.felix.framework.util.SecureAction.openJAR(SecureAction.java:592)&lt;br/&gt;
        at org.apache.felix.framework.cache.JarRevision.getManifestHeader(JarRevision.java:90)&lt;br/&gt;
        at org.apache.felix.framework.BundleImpl.createModule(BundleImpl.java:1090)&lt;br/&gt;
        at org.apache.felix.framework.BundleImpl.revise(BundleImpl.java:1044)&lt;br/&gt;
        at org.apache.felix.framework.Felix.updateBundle(Felix.java:1835)&lt;br/&gt;
        ... 14 more&lt;/p&gt;</description>
                <environment></environment>
        <key id="12437462">FELIX-1715</key>
            <summary>osgi:update on xml deployments will cause ZIPExceptions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gnodet">Guillaume Nodet</assignee>
                                    <reporter username="lhein">Lars Heinemann</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 Oct 2009 07:11:53 +0000</created>
                <updated>Wed, 25 Nov 2009 12:20:08 +0000</updated>
                            <resolved>Wed, 14 Oct 2009 11:47:05 +0000</resolved>
                                    <version>karaf-1.0.0</version>
                                    <fixVersion>fileinstall-2.0.4</fixVersion>
                    <fixVersion>karaf-1.2.0</fixVersion>
                                    <component>File Install</component>
                    <component>Karaf</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12764664" author="gnt" created="Mon, 12 Oct 2009 12:24:45 +0000"  >&lt;p&gt;Not sure how to handle this use case.&lt;br/&gt;
The problem is that the url for the installed bundle directly points to the xml (non transformed artifact) file.&lt;br/&gt;
So if you run &quot;osgi:update&quot;, the deployer is bypassed and the osgi framework try to update from the non transformed artifact, which obviously fails in this case.&lt;/p&gt;

&lt;p&gt;One possible enhancement would be to have fileinstall use a different url.  We could force custom deployment listeners to always go through a custom url handler and have the transformed artifact be done on the fly.   I think this would solve the problem.&lt;/p&gt;

&lt;p&gt;FWIW, you don&apos;t really need to to an osgi:update on transformed artifacts, because those are already updated as soon as a change is detected by fileinstall, but I guess that&apos;s not really the point.&lt;/p&gt;</comment>
                            <comment id="12765523" author="gnt" created="Wed, 14 Oct 2009 11:47:05 +0000"  >&lt;p&gt;Committing to &lt;a href=&quot;https://svn.apache.org/repos/asf/felix/trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/repos/asf/felix/trunk&lt;/a&gt; ...&lt;br/&gt;
	A	fileinstall/src/main/java/org/apache/felix/fileinstall/ArtifactUrlTransformer.java&lt;br/&gt;
	M	fileinstall/src/main/java/org/apache/felix/fileinstall/internal/Artifact.java&lt;br/&gt;
	M	fileinstall/src/main/java/org/apache/felix/fileinstall/internal/BundleTransformer.java&lt;br/&gt;
	M	fileinstall/src/main/java/org/apache/felix/fileinstall/internal/DirectoryWatcher.java&lt;br/&gt;
	M	fileinstall/src/main/java/org/apache/felix/fileinstall/internal/FileInstall.java&lt;br/&gt;
	A	fileinstall/src/main/java/org/apache/felix/fileinstall/internal/JarDirUrlHandler.java&lt;br/&gt;
	M	fileinstall/src/main/java/org/apache/felix/fileinstall/internal/Util.java&lt;br/&gt;
	M	karaf/deployer/blueprint/src/main/java/org/apache/felix/karaf/deployer/blueprint/BlueprintDeploymentListener.java&lt;br/&gt;
	M	karaf/deployer/blueprint/src/main/java/org/apache/felix/karaf/deployer/blueprint/BlueprintURLHandler.java&lt;br/&gt;
	M	karaf/deployer/blueprint/src/main/resources/OSGI-INF/blueprint/blueprint-deployer.xml&lt;br/&gt;
	M	karaf/deployer/spring/src/main/java/org/apache/felix/karaf/deployer/spring/SpringDeploymentListener.java&lt;br/&gt;
	M	karaf/deployer/spring/src/main/java/org/apache/felix/karaf/deployer/spring/SpringURLHandler.java&lt;br/&gt;
	M	karaf/deployer/spring/src/main/resources/OSGI-INF/blueprint/spring-deployer.xml&lt;br/&gt;
Committed r825093&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>57314</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 7 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0vs27:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>183519</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>