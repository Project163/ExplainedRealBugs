<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:49:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-1908] PreferencesService doesn&apos;t work if a PermissionAdmin is present</title>
                <link>https://issues.apache.org/jira/browse/FELIX-1908</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;If a PermissionAdmin service is present, then a bundle making use of PreferencesService currently needs a &quot;org.osgi.service.prefs.PreferencesService&quot; &quot;get&quot; ServicePermission (which is as it should be), but also a FilePermission for the felix-cache subdirectory that contains the data for the PreferencesService bundle. WIthout it, an attempt to alter preferences results in a security exception.&lt;/p&gt;

&lt;p&gt;A bundle should not have (or need) file access to another bundle&apos;s private data.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12441935">FELIX-1908</key>
            <summary>PreferencesService doesn&apos;t work if a PermissionAdmin is present</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sahoo">Sanjeeb Kumar Sahoo</assignee>
                                    <reporter username="udittmer">Ulf Dittmer</reporter>
                        <labels>
                    </labels>
                <created>Mon, 30 Nov 2009 09:55:51 +0000</created>
                <updated>Sat, 25 May 2013 01:07:48 +0000</updated>
                            <resolved>Sat, 25 May 2013 01:07:48 +0000</resolved>
                                    <version>prefs-1.0.4</version>
                                    <fixVersion>prefs-1.0.6</fixVersion>
                                    <component>Preferences Service</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="12786823" author="udittmer" created="Mon, 7 Dec 2009 08:47:46 +0000"  >&lt;p&gt;Just to clarify, the Prefs bundle had AllPermission assigned.&lt;/p&gt;</comment>
                            <comment id="12791282" author="udittmer" created="Wed, 16 Dec 2009 09:28:29 +0000"  >&lt;p&gt;Added &quot;Permission Admin&quot; to components, since I&apos;m not sure where the actual problem is.&lt;/p&gt;</comment>
                            <comment id="12887176" author="udittmer" created="Sun, 11 Jul 2010 10:39:58 +0000"  >&lt;p&gt;I can no longer reproduce this with the current versions (Felix Main 3.0.1, Security 1.2.0, Prefs 1.0.4), so I think this has been resolved.&lt;/p&gt;</comment>
                            <comment id="13663885" author="sahoo" created="Wed, 22 May 2013 07:29:28 +0000"  >&lt;p&gt;I am going to attach a test case that demonstrates the issue with Felix 4.2.1. So, I am reopening this bug.&lt;/p&gt;</comment>
                            <comment id="13663888" author="sahoo" created="Wed, 22 May 2013 07:34:56 +0000"  >&lt;p&gt;To reproduce the issue please follow these steps:&lt;/p&gt;

&lt;p&gt;0) Unzip the attached zip file. It contains sources as well as ready to use jar files in respective target directories. It has 2 netbeans/maven projects, viz:&lt;/p&gt;

&lt;p&gt;a) FelixPrefsServiceTestLauncher -&amp;gt; This contains the launcher that embeds Felix, configures security &amp;amp; deploys the test&lt;/p&gt;

&lt;p&gt;b) FelixPrefsServiceTest -&amp;gt; This contains a test that just tries to use FelixPreferencesService. This test configured to have limited permissions ( package import &amp;amp; service get only) by the launcher&lt;/p&gt;

&lt;p&gt;1) Download &lt;a href=&quot;http://mirrors.gigenet.com/apache//felix/org.apache.felix.main.distribution-4.2.1.zip&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mirrors.gigenet.com/apache//felix/org.apache.felix.main.distribution-4.2.1.zip&lt;/a&gt;&lt;br/&gt;
2) Extract the zip file &amp;amp; goto felix-framework-4.2.1 directory&lt;br/&gt;
3) Download the following &amp;amp; copy to the bundle directory&lt;br/&gt;
a) &lt;a href=&quot;http://mirrors.gigenet.com/apache//felix/org.apache.felix.framework.security-2.2.0.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mirrors.gigenet.com/apache//felix/org.apache.felix.framework.security-2.2.0.jar&lt;/a&gt;&lt;br/&gt;
b) &lt;a href=&quot;http://mirrors.gigenet.com/apache//felix/org.apache.felix.log-1.0.1.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mirrors.gigenet.com/apache//felix/org.apache.felix.log-1.0.1.jar&lt;/a&gt;&lt;br/&gt;
c) &lt;a href=&quot;http://mirrors.gigenet.com/apache//felix/org.apache.felix.prefs-1.0.4.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mirrors.gigenet.com/apache//felix/org.apache.felix.prefs-1.0.4.jar&lt;/a&gt;&lt;br/&gt;
4) create a all.policy file with the following content&lt;br/&gt;
grant &lt;/p&gt;
{ permission java.security.AllPermission; }
&lt;p&gt;;&lt;br/&gt;
5) Run the following command after replacing &amp;lt;path&amp;gt; with the full path to the directory where you extracted the FelixPrefsServiceTest.zip file&lt;br/&gt;
java -Djava.security.policy=./all.policy -cp ./bundle/org.apache.felix.framework.security-2.2.0.jar:./bin/felix.jar:&amp;lt;path&amp;gt;/FelixPrefsServiceTestLauncher/target/FelixPrefsServiceTestLauncher-1.0-SNAPSHOT.jar test.felixprefsservicetestlauncher.Main file:&amp;lt;path&amp;gt;/FelixPrefsServiceTest/target/FelixPrefsServiceTest-1.0-SNAPSHOT.jar&lt;/p&gt;

&lt;p&gt;6) You should see the following message&lt;/p&gt;

&lt;p&gt;Starting framework...&lt;br/&gt;
Configuring framework security...&lt;br/&gt;
Deploying system bundles...&lt;br/&gt;
deployed &lt;a href=&quot;file:/Users/riaz/Work/embedded/jes8/felix-framework-4.2.1/bundle/org.apache.felix.log-1.0.1.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/Users/riaz/Work/embedded/jes8/felix-framework-4.2.1/bundle/org.apache.felix.log-1.0.1.jar&lt;/a&gt;&lt;br/&gt;
deployed &lt;a href=&quot;file:/Users/riaz/Work/embedded/jes8/felix-framework-4.2.1/bundle/org.apache.felix.prefs-1.0.4.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/Users/riaz/Work/embedded/jes8/felix-framework-4.2.1/bundle/org.apache.felix.prefs-1.0.4.jar&lt;/a&gt;&lt;br/&gt;
Deploying application bundle...&lt;br/&gt;
deployed &lt;a href=&quot;file:/Users/riaz/NetBeansProjects/FelixPrefsServiceTest/target/FelixPrefsServiceTest-1.0-SNAPSHOT.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/Users/riaz/NetBeansProjects/FelixPrefsServiceTest/target/FelixPrefsServiceTest-1.0-SNAPSHOT.jar&lt;/a&gt;&lt;br/&gt;
Exception in thread &quot;main&quot; org.osgi.framework.BundleException: Activator start error in bundle test.FelixPrefsServiceTest &lt;span class=&quot;error&quot;&gt;&amp;#91;4&amp;#93;&lt;/span&gt;.&lt;br/&gt;
at org.apache.felix.framework.Felix.activateBundle(Felix.java:2196)&lt;br/&gt;
at org.apache.felix.framework.Felix.startBundle(Felix.java:2064)&lt;br/&gt;
at org.apache.felix.framework.BundleImpl.start(BundleImpl.java:955)&lt;br/&gt;
at org.apache.felix.framework.BundleImpl.start(BundleImpl.java:942)&lt;br/&gt;
at test.felixprefsservicetestlauncher.Main.main(Main.java:66)&lt;br/&gt;
Caused by: java.security.AccessControlException: access denied (java.io.FilePermission ./felix-cache/bundle3/data/P4.ser read)&lt;br/&gt;
at java.security.AccessControlContext.checkPermission(AccessControlContext.java:374)&lt;br/&gt;
at java.security.AccessController.checkPermission(AccessController.java:549)&lt;br/&gt;
at java.lang.SecurityManager.checkPermission(SecurityManager.java:532)&lt;br/&gt;
at java.lang.SecurityManager.checkRead(SecurityManager.java:871)&lt;br/&gt;
at java.io.File.exists(File.java:731)&lt;br/&gt;
at org.apache.felix.prefs.impl.DataFileBackingStoreImpl.load(DataFileBackingStoreImpl.java:155)&lt;br/&gt;
at org.apache.felix.prefs.impl.StreamBackingStoreImpl.update(StreamBackingStoreImpl.java:102)&lt;br/&gt;
at org.apache.felix.prefs.PreferencesImpl.sync(PreferencesImpl.java:588)&lt;br/&gt;
at org.apache.felix.prefs.impl.PreferencesServiceImpl.getSystemPreferences(PreferencesServiceImpl.java:80)&lt;br/&gt;
at test.felixprefsservicetest.Activator.start(Activator.java:18)&lt;br/&gt;
at org.apache.felix.framework.util.SecureAction$Actions.run(SecureAction.java:1605)&lt;br/&gt;
at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
at org.apache.felix.framework.util.SecureAction.startActivator(SecureAction.java:636)&lt;br/&gt;
at org.apache.felix.framework.Felix.activateBundle(Felix.java:2146)&lt;br/&gt;
... 4 more&lt;/p&gt;</comment>
                            <comment id="13664057" author="sahoo" created="Wed, 22 May 2013 12:41:12 +0000"  >&lt;p&gt;All that&apos;s missing in the code are a few doPrivileged blocks. A simple patch. If nobody has objections, I would like to commit it.&lt;/p&gt;</comment>
                            <comment id="13664097" author="rickhall" created="Wed, 22 May 2013 13:31:47 +0000"  >&lt;p&gt;Go for it.&lt;/p&gt;</comment>
                            <comment id="13666891" author="sahoo" created="Sat, 25 May 2013 01:07:48 +0000"  >&lt;p&gt;Committed the attached patch in svn #1486267.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12584264" name="FelixPrefsServiceTest.zip" size="30893" author="sahoo" created="Wed, 22 May 2013 07:34:56 +0000"/>
                            <attachment id="12584299" name="felix.preferences.security.patch" size="5658" author="sahoo" created="Wed, 22 May 2013 12:41:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>57137</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 26 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1asqn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>271122</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>