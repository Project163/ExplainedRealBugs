<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:52:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-4349] Synchronization issue in ComponentRegistry</title>
                <link>https://issues.apache.org/jira/browse/FELIX-4349</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;Investigating an issue in some of our integration test, we found that the ComponentRegistry#m_missingDependencies field is wrongly synchronized.&lt;/p&gt;

&lt;p&gt;Two methods are accessing this Map, registerMissingDependency and missingServicePresent, but only the first one is synchronized.&lt;/p&gt;

&lt;p&gt;Patch proposed:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;diff --git a/scr/src/main/java/org/apache/felix/scr/impl/ComponentRegistry.java b/scr/src/main/java/org/apache/felix/scr/impl/ComponentRegistry.java
index 9b307a9..c40ab5f 100644
--- a/scr/src/main/java/org/apache/felix/scr/impl/ComponentRegistry.java
+++ b/scr/src/main/java/org/apache/felix/scr/impl/ComponentRegistry.java
@@ -660,7 +660,7 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;ComponentRegistry &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; ScrService, ServiceListener
         }
     }
 
-    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void missingServicePresent( &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ServiceReference serviceReference, ComponentActorThread actor )
+    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; void missingServicePresent( &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ServiceReference serviceReference, ComponentActorThread actor )
     {
         &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; List&amp;lt;Entry&amp;gt; dependencyManagers = m_missingDependencies.remove( serviceReference );
         &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ( dependencyManagers != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; )
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12683430">FELIX-4349</key>
            <summary>Synchronization issue in ComponentRegistry</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gnodet">Guillaume Nodet</assignee>
                                    <reporter username="gnodet">Guillaume Nodet</reporter>
                        <labels>
                    </labels>
                <created>Sun, 8 Dec 2013 19:42:54 +0000</created>
                <updated>Wed, 6 Aug 2014 02:21:51 +0000</updated>
                            <resolved>Sun, 8 Dec 2013 20:25:49 +0000</resolved>
                                    <version>scr-1.8.0</version>
                                    <fixVersion>scr-1.8.2</fixVersion>
                                    <component>Declarative Services (SCR)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13842690" author="djencks" created="Sun, 8 Dec 2013 20:06:17 +0000"  >&lt;p&gt;This looks good.  Could I ask what problem this caused?  A concurrent modification exception or a circular dependency that didn&apos;t consistently get eventually resolved (or something else)?&lt;/p&gt;</comment>
                            <comment id="13842695" author="gnt" created="Sun, 8 Dec 2013 20:20:12 +0000"  >&lt;p&gt;The state I end in is weird: one component has a dependency which seems outdated, i.e. it&apos;s not registered anymore.  Another service has been registered in place of that one, but it seems this change has been missed somehow.  The reason I know that, is that the service uses a ServiceFactory and when the service is unbound, the service internal state is changed and I&apos;ve been able to inspect the variables in that failing state.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure this actually fixes my issue, but while investigating the SCR code, Ioannis discovered this problem.  &lt;/p&gt;

&lt;p&gt;I&apos;ll commit a fix asap.&lt;/p&gt;</comment>
                            <comment id="13842696" author="gnt" created="Sun, 8 Dec 2013 20:25:49 +0000"  >&lt;p&gt;Committing to &lt;a href=&quot;https://svn.apache.org/repos/asf/felix/trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/repos/asf/felix/trunk&lt;/a&gt; ...&lt;br/&gt;
	M	scr/src/main/java/org/apache/felix/scr/impl/ComponentRegistry.java&lt;br/&gt;
Committed r1549206&lt;/p&gt;</comment>
                            <comment id="13842893" author="djencks" created="Mon, 9 Dec 2013 03:52:42 +0000"  >&lt;p&gt;I doubt very much this fixes your issue.  If you have a debug level log for DS for when the problem occurred and can send it to me I&apos;ll take a look.&lt;/p&gt;</comment>
                            <comment id="13843053" author="gnt" created="Mon, 9 Dec 2013 10:46:42 +0000"  >&lt;p&gt;I&apos;ve raised &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-4350&quot; title=&quot;Component wrongly activated&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-4350&quot;&gt;&lt;del&gt;FELIX-4350&lt;/del&gt;&lt;/a&gt; to cover my initial problem and attached a log with some SCR debug statements.&lt;/p&gt;</comment>
                            <comment id="14087149" author="djencks" created="Wed, 6 Aug 2014 02:21:51 +0000"  >&lt;p&gt;closing remaining 1.8.2 resolved issues&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>362599</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 16 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1qi3z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>362893</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>