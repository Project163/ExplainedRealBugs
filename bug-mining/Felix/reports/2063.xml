<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:51:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-4184] Temporary resolver errors while updating bundles with deploymentadmin</title>
                <link>https://issues.apache.org/jira/browse/FELIX-4184</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;When you use the system property to not stop the world during an update, updating a running bundle might cause a (temporary) resolver error (I&apos;ve seen it throw exceptions related to uses constraints). According to the spec, if we get an exception here, we should rollback. If you stop the world, this never happens, but here such temporary exceptions are probably resolved when we refresh packages at the end. That does not happen though, since we never get there. We should consider covering this use case, letting the deployment continue and deal with errors when resolving (and maybe then rolling back).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12659751">FELIX-4184</key>
            <summary>Temporary resolver errors while updating bundles with deploymentadmin</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="marrs">Marcel Offermans</reporter>
                        <labels>
                    </labels>
                <created>Thu, 25 Jul 2013 09:30:39 +0000</created>
                <updated>Tue, 1 Apr 2014 12:48:26 +0000</updated>
                            <resolved>Fri, 15 Nov 2013 18:02:04 +0000</resolved>
                                    <version>deploymentadmin-0.9.4</version>
                                                    <component>Deployment Admin</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13719458" author="jajans" created="Thu, 25 Jul 2013 09:57:25 +0000"  >&lt;p&gt;We&apos;re already deviating from the DA spec by stopping only &quot;affected&quot; bundles. &lt;/p&gt;

&lt;p&gt;Wouldn&apos;t it be an idea to split out the commands of the current implementation to a sort of SPI in which we could plug in new/replace existing commands?&lt;/p&gt;</comment>
                            <comment id="13719584" author="bramk" created="Thu, 25 Jul 2013 12:47:06 +0000"  >&lt;p&gt;Alternatively, could we not make the definition of &apos;affected&apos; smarter? AFAICS the current heuristic looks at bsn only. What about if the bundle transitively imports any package that is included in the superset of exported packages in the dp?&lt;/p&gt;</comment>
                            <comment id="13719605" author="marrs" created="Thu, 25 Jul 2013 13:21:45 +0000"  >&lt;p&gt;I&apos;m hesitant to go that way Bram, as ultimately it would have to exactly simulate what the resolver does. In the case I had, it was a uses constraint that failed. Also, unlike what Jan Willem said, we&apos;re currently NOT stopping any bundles. We leave everything running and invoke update on the active bundles.&lt;/p&gt;</comment>
                            <comment id="13719624" author="jajans" created="Thu, 25 Jul 2013 13:47:27 +0000"  >&lt;p&gt;Unlike to what Marcel said, DA &lt;b&gt;is&lt;/b&gt; stopping affected bundles, at least, it should do that if I read the StopBundleCommand#omitBundleStop() method correctly. &lt;/p&gt;

&lt;p&gt;However, that method contains a flaw, as it retrieves the bundle information &lt;b&gt;twice from the same&lt;/b&gt; (source) DP, instead of once from the source DP and once from the target DP. Hence, the &quot;sameVersion&quot; boolean always equals to &quot;true&quot;, causing &lt;b&gt;none&lt;/b&gt; of the affected bundles to be stopped. This might explain the resolver problems (partly). &lt;/p&gt;

&lt;p&gt;If we would fix this issue, then the affected bundles will be stopped during the installation of a DP, but I&apos;m not sure yet whether this would also prevent any resolver issues...&lt;/p&gt;</comment>
                            <comment id="13823702" author="marrs" created="Fri, 15 Nov 2013 14:49:50 +0000"  >&lt;p&gt;Following up. Jan Willem correctly mentions that, due to a flaw, we currently don&apos;t stop &lt;b&gt;affected&lt;/b&gt; bundles at all, but attempt to update them while running. This causes the resolve issues mentioned above. An example:&lt;/p&gt;

&lt;p&gt;Say we update a bundle that implements some API, and the bundle containing it, because the API has been changed. If we first update the implementation without stopping it, it will try to resolve against the new API and fail because that has not yet been installed. Stopping both bundles first, then updating, refreshing and then starting again solves that issue nicely.&lt;/p&gt;

&lt;p&gt;So that&apos;s what we need to do here!&lt;/p&gt;</comment>
                            <comment id="13823872" author="marrs" created="Fri, 15 Nov 2013 18:02:04 +0000"  >&lt;p&gt;Added test and fix for the issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>339943</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 1 week, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1mmr3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>340261</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>