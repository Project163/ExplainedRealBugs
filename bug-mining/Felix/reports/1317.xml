<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:30:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-2944] SCR/ spec version 1.1-felix is causing NPE in XmlHandler</title>
                <link>https://issues.apache.org/jira/browse/FELIX-2944</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;This issue is described in the following post: &lt;a href=&quot;http://www.mail-archive.com/users@felix.apache.org/msg10138.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.mail-archive.com/users@felix.apache.org/msg10138.html&lt;/a&gt;&lt;br/&gt;
and might also be related in the  &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-1898&quot; title=&quot;Extend SCR Plugin to support new updated method declaration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-1898&quot;&gt;&lt;del&gt;FELIX-1898&lt;/del&gt;&lt;/a&gt; issue.&lt;/p&gt;

&lt;p&gt;When using SCR (trunk) and the new Reference &quot;updated&quot; callback, we have to specify the spec version &quot;1.1-felix&quot;. &lt;br/&gt;
However, when using such version, we get the following NPE at runtime: (latest scrplugin has been used to generate the scr xml descriptor):&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
        at org.apache.felix.scr.impl.metadata.XmlHandler.startElement(XmlHandler.java:237)&lt;br/&gt;
        at org.apache.felix.scr.impl.parser.KXml2SAXParser.parseXML(KXml2SAXParser.java:73)&lt;br/&gt;
        at org.apache.felix.scr.impl.BundleComponentActivator.loadDescriptor(BundleComponentActivator.java:227)&lt;br/&gt;
        at org.apache.felix.scr.impl.BundleComponentActivator.initialize(BundleComponentActivator.java:147)&lt;br/&gt;
        at org.apache.felix.scr.impl.BundleComponentActivator.&amp;lt;init&amp;gt;(BundleComponentActivator.java:111)&lt;br/&gt;
        at org.apache.felix.scr.impl.Activator.loadComponents(Activator.java:274)&lt;br/&gt;
        at org.apache.felix.scr.impl.Activator.bundleChanged(Activator.java:192)&lt;br/&gt;
        at org.apache.felix.framework.util.EventDispatcher.invokeBundleListenerCallback(EventDispatcher.java:807)&lt;br/&gt;
        at org.apache.felix.framework.util.EventDispatcher.fireEventImmediately(EventDispatcher.java:729)&lt;br/&gt;
        at org.apache.felix.framework.util.EventDispatcher.fireBundleEvent(EventDispatcher.java:610)&lt;br/&gt;
        at org.apache.felix.framework.Felix.fireBundleEvent(Felix.java:3833)&lt;br/&gt;
        at org.apache.felix.framework.Felix.startBundle(Felix.java:1803)&lt;br/&gt;
        at org.apache.felix.framework.Felix.setActiveStartLevel(Felix.java:1179)&lt;br/&gt;
        at org.apache.felix.framework.StartLevelImpl.run(StartLevelImpl.java:264)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:662)&lt;/p&gt;

&lt;p&gt;Notice that this exception is displayed on stdout, and it would be probably better to log it using the log service;&lt;br/&gt;
From log service, we then get the following exception:&lt;/p&gt;

&lt;p&gt;.scr.impl.parser.ParseException: Exception during parsing&lt;br/&gt;
        at org.apache.felix.scr.impl.metadata.XmlHandler.startElement(XmlHandler.java:333)&lt;br/&gt;
        at org.apache.felix.scr.impl.parser.KXml2SAXParser.parseXML(KXml2SAXParser.java:73)&lt;br/&gt;
        at org.apache.felix.scr.impl.BundleComponentActivator.loadDescriptor(BundleComponentActivator.java:227)&lt;br/&gt;
        at org.apache.felix.scr.impl.BundleComponentActivator.initialize(BundleComponentActivator.java:147)&lt;br/&gt;
        at org.apache.felix.scr.impl.BundleComponentActivator.&amp;lt;init&amp;gt;(BundleComponentActivator.java:111)&lt;br/&gt;
        at org.apache.felix.scr.impl.Activator.loadComponents(Activator.java:274)&lt;br/&gt;
        at org.apache.felix.scr.impl.Activator.bundleChanged(Activator.java:192)&lt;br/&gt;
        at org.apache.felix.framework.util.EventDispatcher.invokeBundleListenerCallback(EventDispatcher.java:807)&lt;br/&gt;
        at org.apache.felix.framework.util.EventDispatcher.fireEventImmediately(EventDispatcher.java:729)&lt;br/&gt;
        at org.apache.felix.framework.util.EventDispatcher.fireBundleEvent(EventDispatcher.java:610)&lt;br/&gt;
        at org.apache.felix.framework.Felix.fireBundleEvent(Felix.java:3833)&lt;br/&gt;
        at org.apache.felix.framework.Felix.startBundle(Felix.java:1803)&lt;br/&gt;
        at org.apache.felix.framework.Felix.setActiveStartLevel(Felix.java:1179)&lt;br/&gt;
        at org.apache.felix.framework.StartLevelImpl.run(StartLevelImpl.java:264)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:662)&lt;/p&gt;

&lt;p&gt;I think that the root cause of the problem is that the scrplugin is generating the following xml namespace:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;http://www.osgi.org/xmlns/scr/v1.1.0-felix&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.osgi.org/xmlns/scr/v1.1.0-felix&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;but the scr runtime is expecting the following namespace:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;http://felix.apache.org/xmlns/scr/v1.1.0-felix&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://felix.apache.org/xmlns/scr/v1.1.0-felix&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;so, there is a mismatch here.&lt;br/&gt;
The following patch seems to work and consists in fixing the class XmlHandler.java, in the SCR: &lt;br/&gt;
The XmlHandler.NAMESPACE_URI_1_1_FELIX constant can be changed with the following scheme (which must match the one generated by the scrplugin):&lt;/p&gt;

&lt;p&gt;    public static final String NAMESPACE_URI_1_1_FELIX = &quot;http://www.osgi.org/xmlns/scr/v1.1.0-felix&quot;;&lt;/p&gt;

&lt;p&gt;Or another option is to fix the scrplugin in order to use the felix.apache.org scheme ?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12506285">FELIX-2944</key>
            <summary>SCR/ spec version 1.1-felix is causing NPE in XmlHandler</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fmeschbe">Felix Meschberger</assignee>
                                    <reporter username="pderop">Pierre De Rop</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 May 2011 14:14:00 +0000</created>
                <updated>Tue, 20 Nov 2012 10:58:18 +0000</updated>
                            <resolved>Tue, 31 May 2011 13:56:00 +0000</resolved>
                                    <version> scr-1.6.0</version>
                    <version>scr generator 1.1.0</version>
                                    <fixVersion>scr-1.6.2</fixVersion>
                    <fixVersion>scr generator 1.1.2</fixVersion>
                                    <component>Declarative Services (SCR)</component>
                    <component>SCR Tooling</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13041561" author="fmeschbe" created="Tue, 31 May 2011 12:50:52 +0000"  >&lt;p&gt;Thanks, Pierre, for tracking this down.&lt;/p&gt;

&lt;p&gt;Actually, I think the problem is the SCR Plugin not setting the correct URI &amp;#8211; I don&apos;t think the Apache Felix project should define namespaces in the osgi.org domain. So the fix is to change the SCR Plugin to use the correct Namespace URI.&lt;/p&gt;

&lt;p&gt;In fact, there is another issue: The XML parser should not print to stdout (already fixed in Rev. 1129137 for &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-2962&quot; title=&quot;SCR doesn&amp;#39;t detect invalid XML&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-2962&quot;&gt;&lt;del&gt;FELIX-2962&lt;/del&gt;&lt;/a&gt;) and should print something readable and not just throw a NPE.&lt;/p&gt;</comment>
                            <comment id="13041565" author="fmeschbe" created="Tue, 31 May 2011 12:54:26 +0000"  >&lt;p&gt;Fixed namespace URI in the SCR plugin (generator) Rev. 1129654.&lt;/p&gt;

&lt;p&gt;To test this you can add a dependency to the SCR generator SNAPSHOT build in the SCR plugin configuration, e.g.:&lt;/p&gt;

&lt;p&gt;            &amp;lt;plugin&amp;gt;&lt;br/&gt;
                &amp;lt;groupId&amp;gt;org.apache.felix&amp;lt;/groupId&amp;gt;&lt;br/&gt;
                &amp;lt;artifactId&amp;gt;maven-scr-plugin&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
                &amp;lt;version&amp;gt;1.7.0&amp;lt;/version&amp;gt;&lt;br/&gt;
                &amp;lt;dependencies&amp;gt;&lt;br/&gt;
                    &amp;lt;dependency&amp;gt;&lt;br/&gt;
                        &amp;lt;groupId&amp;gt;org.apache.felix&amp;lt;/groupId&amp;gt;&lt;br/&gt;
                        &amp;lt;artifactId&amp;gt;org.apache.felix.scr.generator&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
                        &amp;lt;version&amp;gt;1.1.1-SNAPSHOT&amp;lt;/version&amp;gt;&lt;br/&gt;
                    &amp;lt;/dependency&amp;gt;&lt;br/&gt;
                &amp;lt;/dependencies&amp;gt;&lt;br/&gt;
            &amp;lt;/plugin&amp;gt;&lt;/p&gt;</comment>
                            <comment id="13041585" author="fmeschbe" created="Tue, 31 May 2011 13:56:00 +0000"  >&lt;p&gt;Fixed handling in the XmlHandler class in Rev. 1129674 and a test case in Rev. 1129677&lt;/p&gt;

&lt;p&gt;According to the specs, elements whose namespace is not know are to be ignored. This has been done for the &amp;lt;component&amp;gt; element. But then comes the &amp;lt;implementation&amp;gt; element which is handled but there is no component context to put information into and an NPE is generated.&lt;/p&gt;

&lt;p&gt;Now, any element is ignored if there is no component context to fill data into.&lt;/p&gt;

&lt;p&gt;We cannot log error or warn messages since the spec states that the XML parser is to be lenient has to ignore unknown elements and namespaces. We just log DEBUG messages in these cases.&lt;/p&gt;</comment>
                            <comment id="13501066" author="fmeschbe" created="Tue, 20 Nov 2012 10:58:18 +0000"  >&lt;p&gt;Close after release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56041</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 1 week, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l47z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>121334</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>