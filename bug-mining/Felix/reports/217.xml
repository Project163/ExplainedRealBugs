<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:07:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-650] Bundle-SymbolicName not handled correctly when header contains parameters</title>
                <link>https://issues.apache.org/jira/browse/FELIX-650</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;The OSGi specs mandates that syntax for Bundle-Symbolicname is:&lt;br/&gt;
Bundle-SymbolicName ::= symbolic-name ( &apos;;&apos; parameter ) * &lt;br/&gt;
meaning that you can add parameters to symbolic name as for example singleton:=true.&lt;/p&gt;

&lt;p&gt;Let&apos;s use the following as an example:&lt;br/&gt;
Bundle-SymbolicName: org.ops4j.pax.url.mvn; singleton:=true&lt;/p&gt;

&lt;p&gt;If I use such an parameter the bundle symbolic name returned by Felix Bundle.getSymbolicName will be inclusive the parameters which is not correct. In the example above the returned value will be org.ops4j.pax.url.mvn; singleton:=true.&lt;br/&gt;
The problem is that some places in Felix lookup the symbolic name using a pattern like: &lt;br/&gt;
((FelixBundle) bundle).getInfo().getCurrentHeader().get(Constants.BUNDLE_SYMBOLICNAME)&lt;br/&gt;
so, searching the headers for symbolic name not the parsed value.&lt;/p&gt;

&lt;p&gt;This had the side effect of being able to install two bundles with same symbolic name and version, fact that is prohibited by the specs. Felix has the code to verify that you cannot install but the problem is that when installing a bundle the symbolic name comparation is doen between the parsed symbolic name of the bundle to be installed and the symbolic name of the other bundles (already installed) where the symbolic name is determined using the pattern above.&lt;br/&gt;
You can see this behavior in the example bellow.&lt;/p&gt;

&lt;p&gt;I wil atach a path that solves this problem by changing the getSymbolicName to lookup the symbolic name in the parsed values (&quot;module&quot; ICapability of the current IModule) and change all the places that did it&apos;s own lookup of the symbolic name to use Bundle.getSymbolicName. &lt;br/&gt;
But this is if we do not want an &quot;invasive&quot; change and it may not perform well as the lookup is done all the time. A better cleaner/solution would be to add symbolic name (and maybe version) to IModuleDefinition (I would say but I&apos;m not very aware of Felix implementation internals) and set the values while creating the module as the values are already parsed by ManifestParser (same place as when the capabilities/requirements are parsed/created).&lt;/p&gt;

&lt;p&gt;-&amp;gt; install &lt;a href=&quot;file:/Users/alindreghiciu/.m2/repository/org/ops4j/pax/url/pax-url-mvn/0.3.0/pax-url-mvn-0.3.0.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/Users/alindreghiciu/.m2/repository/org/ops4j/pax/url/pax-url-mvn/0.3.0/pax-url-mvn-0.3.0.jar&lt;/a&gt;&lt;br/&gt;
Bundle ID: 5&lt;/p&gt;

&lt;p&gt;-&amp;gt; ps -s&lt;br/&gt;
START LEVEL 1&lt;br/&gt;
  ID   State         Level  Symbolic name&lt;br/&gt;
[   0] &lt;span class=&quot;error&quot;&gt;&amp;#91;Active     &amp;#93;&lt;/span&gt; [    0] System Bundle (1.0.4)&lt;br/&gt;
[   1] &lt;span class=&quot;error&quot;&gt;&amp;#91;Active     &amp;#93;&lt;/span&gt; [    1] org.apache.felix.shell (1.0.1)&lt;br/&gt;
[   2] &lt;span class=&quot;error&quot;&gt;&amp;#91;Active     &amp;#93;&lt;/span&gt; [    1] org.apache.felix.shell.tui (1.0.1)&lt;br/&gt;
[   3] &lt;span class=&quot;error&quot;&gt;&amp;#91;Active     &amp;#93;&lt;/span&gt; [    1] org.apache.felix.bundlerepository (1.0.3)&lt;br/&gt;
[   5] &lt;span class=&quot;error&quot;&gt;&amp;#91;Installed  &amp;#93;&lt;/span&gt; [    1] org.ops4j.pax.url.mvn; singleton:=true   (0.3.0)&lt;/p&gt;

&lt;p&gt;-&amp;gt; install &lt;a href=&quot;file:/Users/alindreghiciu/work/pax-url-mvn-0.3.0.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/Users/alindreghiciu/work/pax-url-mvn-0.3.0.jar&lt;/a&gt;&lt;br/&gt;
Bundle ID: 7&lt;/p&gt;

&lt;p&gt;-&amp;gt; ps -s&lt;br/&gt;
START LEVEL 1&lt;br/&gt;
   ID   State         Level  Symbolic name&lt;br/&gt;
[   0] &lt;span class=&quot;error&quot;&gt;&amp;#91;Active     &amp;#93;&lt;/span&gt; [    0] System Bundle (1.0.4)&lt;br/&gt;
[   1] &lt;span class=&quot;error&quot;&gt;&amp;#91;Active     &amp;#93;&lt;/span&gt; [    1] org.apache.felix.shell (1.0.1)&lt;br/&gt;
[   2] &lt;span class=&quot;error&quot;&gt;&amp;#91;Active     &amp;#93;&lt;/span&gt; [    1] org.apache.felix.shell.tui (1.0.1)&lt;br/&gt;
[   3] &lt;span class=&quot;error&quot;&gt;&amp;#91;Active     &amp;#93;&lt;/span&gt; [    1] org.apache.felix.bundlerepository (1.0.3)&lt;br/&gt;
[   5] &lt;span class=&quot;error&quot;&gt;&amp;#91;Installed  &amp;#93;&lt;/span&gt; [    1] org.ops4j.pax.url.mvn; singleton:=true   (0.3.0)&lt;br/&gt;
[   7] &lt;span class=&quot;error&quot;&gt;&amp;#91;Installed  &amp;#93;&lt;/span&gt; [    1] org.ops4j.pax.url.mvn; singleton:=true   (0.3.0)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12401231">FELIX-650</key>
            <summary>Bundle-SymbolicName not handled correctly when header contains parameters</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rickhall">Richard S. Hall</assignee>
                                    <reporter username="adreghiciu">Alin George Dreghiciu</reporter>
                        <labels>
                    </labels>
                <created>Tue, 29 Jul 2008 12:12:30 +0000</created>
                <updated>Fri, 8 Aug 2008 18:50:17 +0000</updated>
                            <resolved>Fri, 1 Aug 2008 15:43:56 +0000</resolved>
                                                    <fixVersion>framework-1.2.0</fixVersion>
                                    <component>Framework</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12617805" author="rickhall" created="Tue, 29 Jul 2008 14:50:32 +0000"  >&lt;p&gt;I will look into this patch when I look into your other patch, later this week. Thanks for the feedback. Keep in mind that Felix does not currently implement singleton support.&lt;/p&gt;</comment>
                            <comment id="12617817" author="adreghiciu" created="Tue, 29 Jul 2008 15:22:36 +0000"  >&lt;p&gt;I know that Felix does not implement the singleton support. But that is another story that I&apos;m working on. I will create an issue/pacth for that also as I&apos;m pretty close to have it done.&lt;br/&gt;
But even without the support the current behavior is incorrect in case that the Bundle-SymbolicnNme is not just a simple string without attributes/directives.&lt;/p&gt;

&lt;p&gt;BTW, I do not know what to do now regrading the singleton support. Shall I base the patch on the patch from this issu or on the current code base? Right now I&apos;m working against the current code base.&lt;/p&gt;

&lt;p&gt;It would had been more simpler if I would have commit rights &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. But maybe in the future when Pax Web will become a Felix project.&lt;/p&gt;</comment>
                            <comment id="12617821" author="rickhall" created="Tue, 29 Jul 2008 15:29:43 +0000"  >&lt;p&gt;Agreed, the current behavior is incorrect, I just didn&apos;t want you disappointed. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;If you create your singleton jira patch before this one is applied, then just include them together and close this bug.&lt;/p&gt;

&lt;p&gt;I agree that commit rights would make this simpler and supplying patches is the primary way to gain commit rights, so you are on the right path regardless what happens with Pax Web. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12619051" author="rickhall" created="Fri, 1 Aug 2008 15:43:56 +0000"  >&lt;p&gt;I have applied this patch. There was a small bug in that it assume that all bundles have symbolic names, but since that is not the case, I had to add a check for null.&lt;/p&gt;

&lt;p&gt;Alin, please close this bug if you are satisfied. Thanks.&lt;/p&gt;</comment>
                            <comment id="12619052" author="adreghiciu" created="Fri, 1 Aug 2008 15:55:42 +0000"  >&lt;p&gt;Interesting. Bundle-SymbolicName is a mandatory header. Are we talking about R3?&lt;/p&gt;</comment>
                            <comment id="12619054" author="rickhall" created="Fri, 1 Aug 2008 16:04:00 +0000"  >&lt;p&gt;Yes, Felix still has to be compatible with R3 bundles.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12346670">FELIX-100</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12387092" name="FELIX-650.patch" size="2395" author="adreghiciu" created="Tue, 29 Jul 2008 12:13:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>58338</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 17 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0vxwv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>184467</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>