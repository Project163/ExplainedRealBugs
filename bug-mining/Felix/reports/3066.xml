<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 16:13:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-6041] scr gogo commands require gogo runtime to be present when scr resolves</title>
                <link>https://issues.apache.org/jira/browse/FELIX-6041</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;I cannot seem to find the actual jira issue this was worked under.  At some point in the 2.1 version of SCR the scr gogo commands were significantly reworked with the following commit:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/felix/commit/d6232f91ffb386835d3ae22dd2f003c854310ef5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/commit/d6232f91ffb386835d3ae22dd2f003c854310ef5&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This put a hard dependency on the gogo package &lt;tt&gt;org.apache.felix.service.command&lt;/tt&gt; package.  The dependency was declared as optional, but this means that if the gogo.runtime bundle is installed/resolved after the scr bundle then the scr bundle will never wire to the package for the Converter service.  SCR then proceeds to register a Converter service using a ServiceFactory, but this service cannot be used for two reasons.&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;For the gogo.runtime to see the service the scr bundle must be wired to the service package otherwise the framework will not give the service to the gogo.runtime.&lt;/li&gt;
	&lt;li&gt;Even if the gogo.runtime could see the service the ServiceFactory would ultimately fail to create the Converter service object with some class loading error.&lt;br/&gt;
This ultimately leaves the scr commands that require DTO conversion/formating by the gogo.runtime to fall back to using toString which prints out confusing (for the user) json like output.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Perhaps some use of late binding dynamic import could be used, but that would require some kind of trigger to SCR to load the class from the package to force the dynamic wire and then registration of the Converter service.  Even then it would cause a re-resolve of the SCR bundle if the gogo bundles are then uninstalled which I would like to avoid.&lt;/p&gt;

&lt;p&gt;One possible solution is to track the CommandProcessor service and when it is available then register a Proxy Converter service with the BundleContext of the bundle that registers the CommandProcessor.  This way we do not need a hard requirement on the &lt;tt&gt;org.apache.felix.service.command&lt;/tt&gt; in order to get good output from the scr gogo commands.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13212566">FELIX-6041</key>
            <summary>scr gogo commands require gogo runtime to be present when scr resolves</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tjwatson">Tom Watson</assignee>
                                    <reporter username="tjwatson">Tom Watson</reporter>
                        <labels>
                    </labels>
                <created>Tue, 29 Jan 2019 15:01:59 +0000</created>
                <updated>Tue, 2 Apr 2019 15:03:09 +0000</updated>
                            <resolved>Tue, 29 Jan 2019 19:30:24 +0000</resolved>
                                    <version>scr-2.1.14</version>
                                    <fixVersion>scr-2.1.16</fixVersion>
                                    <component>Declarative Services (SCR)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16755153" author="githubbot" created="Tue, 29 Jan 2019 15:58:04 +0000"  >&lt;p&gt;GitHub user tjwatson opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/174&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/174&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-6041&quot; title=&quot;scr gogo commands require gogo runtime to be present when scr resolves&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-6041&quot;&gt;&lt;del&gt;FELIX-6041&lt;/del&gt;&lt;/a&gt; - allow scr commands to work when gogo.runtime resolves later&lt;/p&gt;

&lt;p&gt;    Remove the optional dependency on org.apache.felix.service.command&lt;br/&gt;
    package to allow gogo.runtime to be installed and resolved after the SCR&lt;br/&gt;
    bundle.  This allows the scr gogo commands to work while avoiding a wire&lt;br/&gt;
    from the SCR bundle to the gogo packages.&lt;/p&gt;

&lt;p&gt;    This is achieved by generating a proxy instance of the Converter service&lt;br/&gt;
    and registering it with the gogo.runtime BundleContext (or what ever&lt;br/&gt;
    bundle registers the CommandProcessor service.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/tjwatson/felix&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tjwatson/felix&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-6041&quot; title=&quot;scr gogo commands require gogo runtime to be present when scr resolves&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-6041&quot;&gt;&lt;del&gt;FELIX-6041&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/174.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/174.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #174&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 787f792afaaabcf6f5b50e1af4c496814f3c8364&lt;br/&gt;
Author: Tom Watson &amp;lt;tjwatson@...&amp;gt;&lt;br/&gt;
Date:   2019-01-29T15:45:12Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-6041&quot; title=&quot;scr gogo commands require gogo runtime to be present when scr resolves&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-6041&quot;&gt;&lt;del&gt;FELIX-6041&lt;/del&gt;&lt;/a&gt; - allow scr commands to work when gogo.runtime resolves later&lt;/p&gt;

&lt;p&gt;    Remove the optional dependency on org.apache.felix.service.command&lt;br/&gt;
    package to allow gogo.runtime to be installed and resolved after the SCR&lt;br/&gt;
    bundle.  This allows the scr gogo commands to work while avoiding a wire&lt;br/&gt;
    from the SCR bundle to the gogo packages.&lt;/p&gt;

&lt;p&gt;    This is achieved by generating a proxy instance of the Converter service&lt;br/&gt;
    and registering it with the gogo.runtime BundleContext (or what ever&lt;br/&gt;
    bundle registers the CommandProcessor service.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16755285" author="githubbot" created="Tue, 29 Jan 2019 18:51:34 +0000"  >&lt;p&gt;Github user tjwatson closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/174&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/174&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16806871" author="jbonofre" created="Mon, 1 Apr 2019 14:54:58 +0000"  >&lt;p&gt;It seems that this change is causing the scr:* commands to display the raw json in Karaf. I&apos;m checking.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13223586">KARAF-6208</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 33 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|yi0fuo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>