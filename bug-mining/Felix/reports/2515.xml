<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:59:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-5045] DM Optional callbacks may sometimes be invoked before start callback</title>
                <link>https://issues.apache.org/jira/browse/FELIX-5045</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;We just found a corner case that triggers optional dependency callbacks before the component is invoked in its &apos;start&apos; lifecycel callback. This is a bug, because in DM, optional dependency callbacks should be always invoked after the component&apos;s &apos;start&apos; lifecycle callback.&lt;/p&gt;

&lt;p&gt;I&apos;m describing now the use case: we have the following component players: &lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;B: a simple service component.&lt;/li&gt;
	&lt;li&gt;BFactory: a service that has a &apos;create&apos; method which registers in the OSGi registry a new B service instance.&lt;/li&gt;
	&lt;li&gt;A: a component that adds from A.init() lifecycle callback a required dependency (with a callback) on BFactory, as well as an optional dependency (with a callback) on B.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;when A.bind(BFactory factory) is called, it then calls &quot;factory.create()&quot; method which triggers the registration of the B Service.  At this point, A.bind(B b) is then invoked, but the A.start() lifecycle callback has not yet been called. This is because we are currently transiting from INSTANTIATED_AND_WAITING_FOR_REQUIRED -&amp;gt; TRACKING_OPTIONAL; so the current state is TRACKING_OPTIONAL, and we are calling the             invokeAddRequiredInstanceBoundDependencies()&lt;br/&gt;
method, which calls A.bind(BFactory) method, which synchronously registers a B service instance; so this ends up calling the handleAdded method, which invoke A.bind(B b) method, but at this point we have not yet called the A.start() callback.&lt;/li&gt;
	&lt;li&gt;then &quot;A.start()&quot; is called.&lt;/li&gt;
&lt;/ul&gt;


</description>
                <environment></environment>
        <key id="12888687">FELIX-5045</key>
            <summary>DM Optional callbacks may sometimes be invoked before start callback</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pderop">Pierre De Rop</assignee>
                                    <reporter username="pderop">Pierre De Rop</reporter>
                        <labels>
                    </labels>
                <created>Fri, 18 Sep 2015 21:51:03 +0000</created>
                <updated>Mon, 30 Nov 2015 12:54:27 +0000</updated>
                            <resolved>Fri, 18 Sep 2015 22:10:40 +0000</resolved>
                                    <version>  org.apache.felix.dependencymanager-r5</version>
                                    <fixVersion>org.apache.felix.dependencymanager-r6</fixVersion>
                                    <component>Dependency Manager</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14876554" author="pderop" created="Fri, 18 Sep 2015 22:10:40 +0000"  >&lt;p&gt;Fixed in revision 1703922.&lt;/p&gt;</comment>
                            <comment id="14907117" author="pderop" created="Thu, 24 Sep 2015 22:06:33 +0000"  >&lt;p&gt;The integration test for this issue is located in org.apache.felix.dm.itest.api.FELIX5045_OptionalDependencyCBCalledBeforeStartTest.java&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 8 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2l53z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>