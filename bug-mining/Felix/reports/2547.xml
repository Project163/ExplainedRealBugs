<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:59:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-5093] HttpServletRequest.getRequestURI is broken for escaped char in URL since 3.1.0</title>
                <link>https://issues.apache.org/jira/browse/FELIX-5093</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;The HttpServletRequest.getRequestURI must return the URI without processing % escaping. Since version 3.1.0 this processing is done, so the returned value is incorrect. For exemple this can lead to error in Apache Shiro when it try to unescape % of an URI.&lt;/p&gt;

&lt;p&gt;See the attached jar for a bundle that can be used to reproduce the problem:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;load the bundle&lt;/li&gt;
	&lt;li&gt;with a browser go on &lt;a href=&quot;http://localhost:8080/requesturibug/test%2Ftest%25test&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8080/requesturibug/test%2Ftest%25test&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;With HTTP Jetty &amp;lt; 3.1.0 it prints:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Request URI: /requesturibug/test%2Ftest%25test (org.apache.felix.http.base.internal.handler.ServletHandlerRequest)
Wrapped URI: /requesturibug/test%2Ftest%25test (org.apache.felix.http.base.internal.dispatch.FilterPipeline$FilterRequestWrapper)
Wrapped URI: /requesturibug/test%2Ftest%25test (org.apache.felix.http.base.internal.DispatcherServlet$AttributeEventRequest)
Wrapped URI: /requesturibug/test%2Ftest%25test (org.eclipse.jetty.server.Request)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;=&amp;gt; request URI is ok&lt;/p&gt;

&lt;p&gt;With HTTP Jetty 3.1.0 or 3.1.2 it prints:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Request URI: /requesturibug/test/test%test (org.apache.felix.http.base.internal.dispatch.ServletRequestWrapper)
Wrapped URI: /requesturibug/test%2Ftest%25test (org.eclipse.jetty.server.Request)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;=&amp;gt; request URI is wrong while the underlying request URI returned by Jetty itself is correct.&lt;br/&gt;
When this request come the Shiro filter it will issue an exception because it will try to unescape &quot;%te&quot; which is not valid since &quot;te&quot; is not a number&lt;/p&gt;</description>
                <environment></environment>
        <key id="12909754">FELIX-5093</key>
            <summary>HttpServletRequest.getRequestURI is broken for escaped char in URL since 3.1.0</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cziegeler">Carsten Ziegeler</assignee>
                                    <reporter username="xfournet">Xavier Fournet</reporter>
                        <labels>
                    </labels>
                <created>Mon, 2 Nov 2015 19:03:33 +0000</created>
                <updated>Fri, 11 Dec 2015 15:17:35 +0000</updated>
                            <resolved>Thu, 26 Nov 2015 11:46:56 +0000</resolved>
                                    <version>http.base-3.0.0</version>
                    <version>http.base-3.0.2</version>
                    <version>http.jetty-3.1.0</version>
                    <version>http.jetty-3.1.2</version>
                    <version>http.bridge-3.0.0</version>
                    <version>http.bridge-3.0.2</version>
                                    <fixVersion>http.base-3.0.4</fixVersion>
                    <fixVersion>http.jetty-3.1.4</fixVersion>
                    <fixVersion>http.bridge-3.0.4</fixVersion>
                                    <component>HTTP Service</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14986283" author="xfournet" created="Mon, 2 Nov 2015 23:36:39 +0000"  >&lt;p&gt;The regression has been introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-4925&quot; title=&quot;Request path is not decoded&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-4925&quot;&gt;&lt;del&gt;FELIX-4925&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14994517" author="githubbot" created="Fri, 6 Nov 2015 21:50:19 +0000"  >&lt;p&gt;GitHub user xfournet opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/39&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/39&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-5093&quot; title=&quot;HttpServletRequest.getRequestURI is broken for escaped char in URL since 3.1.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-5093&quot;&gt;&lt;del&gt;FELIX-5093&lt;/del&gt;&lt;/a&gt; remove the override of getRequestURI&lt;/p&gt;

&lt;p&gt;    Quite simple (maybe naive ?) fix. Let me know if this approach is valid or not.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/xfournet/felix&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/xfournet/felix&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-5093&quot; title=&quot;HttpServletRequest.getRequestURI is broken for escaped char in URL since 3.1.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-5093&quot;&gt;&lt;del&gt;FELIX-5093&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/39.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/39.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #39&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit e93efa3e471f380f8043ee1dea29c53bfc7393c7&lt;br/&gt;
Author: Xavier Fournet &amp;lt;xavier.fournet@gmail.com&amp;gt;&lt;br/&gt;
Date:   2015-11-06T21:47:00Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-5093&quot; title=&quot;HttpServletRequest.getRequestURI is broken for escaped char in URL since 3.1.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-5093&quot;&gt;&lt;del&gt;FELIX-5093&lt;/del&gt;&lt;/a&gt; remove the override of getRequestURI&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15014588" author="cziegeler" created="Thu, 19 Nov 2015 22:38:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xfournet&quot; class=&quot;user-hover&quot; rel=&quot;xfournet&quot;&gt;xfournet&lt;/a&gt; Thanks for your patch. Unfortunately it breaks some it tests, I haven&apos;t looked in detail why they fail but it seems there is a problem when requests are forwarded or included (four tests are failing in RequestDispatchTest)&lt;/p&gt;</comment>
                            <comment id="15014660" author="xfournet" created="Thu, 19 Nov 2015 22:54:28 +0000"  >&lt;p&gt;Ok i see, i missed the execution of felix.http.itests. I will look at the result of thoses tests.&lt;/p&gt;</comment>
                            <comment id="15028616" author="cziegeler" created="Thu, 26 Nov 2015 11:46:56 +0000"  >&lt;p&gt;I found a different solution which I committed in rev 1716611.&lt;br/&gt;
The attached bundle shows now the same output as in versions &amp;lt; 3.1.0 and the integration tests still pass&lt;/p&gt;</comment>
                            <comment id="15052885" author="githubbot" created="Fri, 11 Dec 2015 15:17:35 +0000"  >&lt;p&gt;Github user xfournet closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/39&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/39&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12837383">FELIX-4925</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12770148" name="requesturibug-1.0.0-SNAPSHOT.jar" size="4894" author="xfournet" created="Mon, 2 Nov 2015 19:07:10 +0000"/>
                            <attachment id="12770149" name="requesturibug-sources.zip" size="2518" author="xfournet" created="Mon, 2 Nov 2015 19:08:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 49 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2nu6n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>