<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:48:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-3934] osgi.identity capabilities from fragments can cause problems when resolving multiple fragments</title>
                <link>https://issues.apache.org/jira/browse/FELIX-3934</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;If you are resolving multiple fragments against the same host at the same time then the osgi.identity capabilities provided by fragments can cause the wiring result to be miscalculated because a wrapped host is not used to populate the wires.  Here is a simple scenario:&lt;/p&gt;

&lt;p&gt;Bundle-SymbolicName: A&lt;/p&gt;

&lt;p&gt;Bundle-SymbolicName: F1&lt;br/&gt;
Fragment-Host: A&lt;/p&gt;

&lt;p&gt;Bundle-SymbolicName: F2&lt;br/&gt;
Fragment-Host: A&lt;/p&gt;

&lt;p&gt;Bundle-SymbolicName: B&lt;br/&gt;
Require-Capability: osgi.identity; filter:=&quot;(osgi.identity=F2)&quot;&lt;/p&gt;

&lt;p&gt;During the final phase of resolution when calling populateWireMap, if the first Resource target is B then it will cause a recursive call to populateWireMap using the raw resouce of F2 since it provides the identity capability required by B.  This ultimately will result in another recursive call to populateWireMap using the raw resource of A since it provides the host capability required by F2.  This is wrong, we must ensure only wrappedResources for the host of a resolving fragment resource are passed to populateWireMap.&lt;/p&gt;

&lt;p&gt;All other namespaces besides osgi.identity are considered payload capabilities from fragments.  This results in proper wrapping of the capabilities provided by fragments which then results in proper calls to populateWireMap since capabilities coming from fragments will be properly wrapped with their hosting resource.  But in the case of osgi.identity no wrapping is done for the capability so we are left with the raw capability when resolving a required wire to the osgi.identity.  &lt;/p&gt;

&lt;p&gt;I will provide a patch with a potential fix.  The fix is probably not the most elegant approach.  It basically spacial cases the osgi.identity namespace in the recursive call to populateWireMap to check if the providing resource is a fragment and if so then find the target wrapped host for proper calls to populateWireMap&lt;/p&gt;</description>
                <environment>All</environment>
        <key id="12634166">FELIX-3934</key>
            <summary>osgi.identity capabilities from fragments can cause problems when resolving multiple fragments</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rickhall">Richard S. Hall</assignee>
                                    <reporter username="tjwatson">Tom Watson</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Feb 2013 14:52:47 +0000</created>
                <updated>Thu, 7 Mar 2013 19:48:36 +0000</updated>
                            <resolved>Mon, 4 Mar 2013 21:31:04 +0000</resolved>
                                                                    <component>Resolver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13587181" author="tjwatson" created="Tue, 26 Feb 2013 14:59:46 +0000"  >&lt;p&gt;Here is the possible fix.  I also added the scenario to Main (scenario 7).  When things go wrong you will see that the wiring result does not provide any wires for fragment F1.  I could not find an easy way to force the situation.  You basically have to try and force resource B to be the first resource to call populateWireMap.  If any other resource is first then the proper wrapped resource of A is used to populate the wire map.&lt;/p&gt;</comment>
                            <comment id="13592657" author="rickhall" created="Mon, 4 Mar 2013 21:31:04 +0000"  >&lt;p&gt;I applied the patch with minor modifications, please close if satisfied. Thanks.&lt;/p&gt;</comment>
                            <comment id="13596278" author="tjwatson" created="Thu, 7 Mar 2013 19:48:36 +0000"  >&lt;p&gt;Thanks for release the fix.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12570987" name="org.apache.felix.resolver.patch" size="8240" author="tjwatson" created="Tue, 26 Feb 2013 14:59:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>314659</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 37 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1iarj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>315003</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>