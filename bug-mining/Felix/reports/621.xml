<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:12:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-1461] Corrupted repository.xml when maven is run in parallel</title>
                <link>https://issues.apache.org/jira/browse/FELIX-1461</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;Sometimes I&apos;m running several maven commands in parallel (different shells) and sometimes in these cases this ends in a corrupted repository.xml.&lt;br/&gt;
It seems that in this case the repository.xml just contains this single line:&lt;br/&gt;
&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot; standalone=&quot;yes&quot;?&amp;gt;&lt;br/&gt;
which produces errors when it is tried to be read again.&lt;/p&gt;

&lt;p&gt;I guess that there are not that many people running maven in parallel but I think the repository.xml shouldn&apos;t be corrupted/erased in these cases either &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12432515">FELIX-1461</key>
            <summary>Corrupted repository.xml when maven is run in parallel</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mcculls">Stuart McCulloch</assignee>
                                    <reporter username="cziegeler">Carsten Ziegeler</reporter>
                        <labels>
                    </labels>
                <created>Fri, 7 Aug 2009 11:39:10 +0000</created>
                <updated>Fri, 24 Jun 2011 12:36:55 +0000</updated>
                            <resolved>Thu, 3 Sep 2009 02:57:19 +0000</resolved>
                                    <version>maven-bundle-plugin-1.4.3</version>
                                    <fixVersion>maven-bundle-plugin-2.0.1</fixVersion>
                                    <component>Maven Bundle Plugin</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12740518" author="sseifert@pro-vision.de" created="Fri, 7 Aug 2009 11:46:24 +0000"  >&lt;p&gt;we&apos;ve encountered this problem too multiple times the last months, i think i can happen as well if a running maven build is killed by CTRL+C.&lt;br/&gt;
i was not sure if it is general maven-specific problem or specific to this plugin.&lt;/p&gt;</comment>
                            <comment id="12750794" author="mcculls" created="Thu, 3 Sep 2009 02:57:19 +0000"  >&lt;p&gt;I&apos;ve tweaked the code so it uses a temporary file to build the updated OBR, it only overwrites the old file when the new file is complete. This should radically reduce the chance of getting a corrupted OBR - that said, it is considered Maven best-practice to not run parallel builds that use the same local repository.&lt;/p&gt;
</comment>
                            <comment id="12750985" author="h2o" created="Thu, 3 Sep 2009 12:30:14 +0000"  >&lt;p&gt;But now you&apos;ve traded corruption for (possible) silent data loss. It is simply not possible to fix this without a lockfile..which you then need to cleanup if it is stale.. ad inf. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12750988" author="h2o" created="Thu, 3 Sep 2009 12:32:31 +0000"  >&lt;p&gt;One possible and low-impactish-way to treat this could be taking the ctime/mtime of the file, create your new file, and only overwrite if the mtime has not changed; otherwise recreate. Basically CAS/retry for files..&lt;/p&gt;</comment>
                            <comment id="12751001" author="mcculls" created="Thu, 3 Sep 2009 13:01:19 +0000"  >&lt;p&gt;Exactly - before this fix it was possible to trash the repository file which meant you had to completely zap it, losing everything.&lt;br/&gt;
Now we at least make sure the repository file is consistent, so although you may lose an entry you could check and try again.&lt;/p&gt;

&lt;p&gt;Also Maven has a fundamental design issue where running two processes against the same local repository could lead to&lt;br/&gt;
corrupt Maven metadata (this is well known, which is why many CI machines use separate repositories for different builds).&lt;br/&gt;
So I&apos;m not sure how much time we should spend trying to workaround something that Maven itself doesn&apos;t support.&lt;/p&gt;

&lt;p&gt;Adding a ctime/mtime check would be an option, but we&apos;d need to limit the number of retries - otherwise you could end up in&lt;br/&gt;
some sort of live-lock situation. Even then it&apos;s possible to end up with missing data, as timestamps have limited granularity.&lt;/p&gt;

&lt;p&gt;If someone wants to write a patch I&apos;d be happy to integrate it, but for 2.0.1 this is the least disruptive solution to avoid corruption.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>57563</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 12 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0vy5j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>184506</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>