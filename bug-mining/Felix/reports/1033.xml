<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:18:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-2177] Fragment bundles not loaded after second start when using autodeploy</title>
                <link>https://issues.apache.org/jira/browse/FELIX-2177</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;After &lt;a href=&quot;http://hg.netbeans.org/core-main/rev/6a05c30c5d0b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hg.netbeans.org/core-main/rev/6a05c30c5d0b&lt;/a&gt;, I can translate a NetBeans module suite to OSGi bundles and load them including branding/localization using fragment bundles. For example, with NetBeans&apos; &quot;FeedReader&quot; demo app, org.netbeans.core.startup-*.jar contains a manifest&lt;/p&gt;

&lt;p&gt;Bundle-SymbolicName: org.netbeans.core.startup&lt;br/&gt;
....&lt;/p&gt;

&lt;p&gt;and a resource org/netbeans/core/startup/splash.gif, whereas core_feedreader.jar contains a manifest&lt;/p&gt;

&lt;p&gt;Bundle-SymbolicName: org.netbeans.core.startup-branding&lt;br/&gt;
Fragment-Host: org.netbeans.core.startup&lt;/p&gt;

&lt;p&gt;and a resource org/netbeans/core/startup/splash_feedreader.gif providing branding (akin to localization). At runtime, Bundle.getResource(&quot;org/netbeans/core/startup/splash_feedreader.gif&quot;) is called before Bundle.getResource(&quot;org/netbeans/core/startup/splash.gif&quot;) to permit the branding override.&lt;/p&gt;

&lt;p&gt;This all works fine when I create a directory of bundles and launch Felix using -b on that directory, an empty cache dir, and felix.auto.deploy.action=uninstall,install,update,start.&lt;/p&gt;

&lt;p&gt;But when I launch Felix again using the same cache dir (without first deleting its contents), none of the resources from the fragment bundles seem to be available. If I delete the bundle* subdirs of the cache dir - even just the subdirs corresponding to the fragments - before starting Felix then it works, so the problem is really with the bundle cache (as opposed to some problem with the application&apos;s own settings).&lt;/p&gt;

&lt;p&gt;Debug printlns show the fragment bundle in state RESOLVED on the first start, INSTALLED thereafter.&lt;/p&gt;

&lt;p&gt;Appending &quot;;fragment-attachment=resolve-time&quot; to the Bundle-SymbolicName of all (non-fragment) bundles in the directory does not have any effect.&lt;/p&gt;

&lt;p&gt;AutoProcessor handling AUTO_DEPLOY_START_VALUE skips fragment bundles, since start() would be illegal on them. But why aren&apos;t they resolved as a consequence of their hosts being resolved and started?&lt;/p&gt;</description>
                <environment>JDK 6, Linux. felix-framework 2.0.3, felix-main 2.0.2.</environment>
        <key id="12458290">FELIX-2177</key>
            <summary>Fragment bundles not loaded after second start when using autodeploy</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rickhall">Richard S. Hall</assignee>
                                    <reporter username="jglick@netbeans.org">Jesse Glick</reporter>
                        <labels>
                    </labels>
                <created>Fri, 5 Mar 2010 21:13:05 +0000</created>
                <updated>Sun, 6 Jun 2010 21:37:32 +0000</updated>
                            <resolved>Wed, 26 May 2010 19:25:59 +0000</resolved>
                                    <version>framework-2.0.3</version>
                                    <fixVersion>framework-3.0.0</fixVersion>
                                    <component>Framework</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12842033" author="karlpauls" created="Fri, 5 Mar 2010 21:40:26 +0000"  >&lt;p&gt;Sounds like a bug. Could you try with the current trunk/latest snapshot?&lt;/p&gt;</comment>
                            <comment id="12842069" author="jglick@netbeans.org" created="Fri, 5 Mar 2010 22:32:23 +0000"  >&lt;p&gt;Still reproducible with 2.1.0-SNAPSHOT (rev 919644) of framework &amp;amp; main.&lt;/p&gt;</comment>
                            <comment id="12870802" author="jglick@netbeans.org" created="Mon, 24 May 2010 19:38:08 +0000"  >&lt;p&gt;Still reproducible with 2.1.0-SNAPSHOT (rev 947700) of framework &amp;amp; main. I build SNAPSHOT JARs and copy them over platform/modules/ext/felix*.jar in a NB 6.9 installation. Then start IDE, File &amp;gt; New Project, Samples &amp;gt; NetBeans Modules &amp;gt; FeedReader; right-click it and select OSGi &amp;gt; Run in Felix. (See &lt;a href=&quot;http://wiki.netbeans.org/NetBeansInOSGi&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://wiki.netbeans.org/NetBeansInOSGi&lt;/a&gt; for background.) Correctly shows FeedReader splash screen and window title. With the addition of some println&apos;s, it seems that the three fragment bundles org.netbeans.core&lt;/p&gt;
{,.startup,.windows}
&lt;p&gt;-branding are in AutoProcessor&apos;s startBundleList but it skips them (as expected), yet they are still visible somehow at runtime: bundle #3 (org.netbeans.core.startup-branding) can load bundle://13.0:2/org/netbeans/core/startup/splash_feedreader.gif (bundle #13 is org.netbeans.core.startup, its host). The println&apos;s show the same sequence when Run in Felix is invoked again, but now the generic splash screen and window title are shown, indicating that these fragments are not being loaded; bundle #3 is now INSTALLED. There seems to be no difference between first and second run in terms of timing of events (the NB integration waits until the framework has started before doing anything of its own); the only visible difference is that the fragments are RESOLVED on the first run, but only INSTALLED on the second.&lt;/p&gt;</comment>
                            <comment id="12870866" author="rickhall" created="Mon, 24 May 2010 21:54:05 +0000"  >&lt;p&gt;Ok, I&apos;ve been able to reproduce the issue and I narrowed the cause down to the fact that the fragments are being updated on restart. I was able to create a simpler use case to demonstrate the issue, so I will look into a fix. Thanks.&lt;/p&gt;</comment>
                            <comment id="12871903" author="rickhall" created="Wed, 26 May 2010 19:25:59 +0000"  >&lt;p&gt;I have committed a fix for this issue and was able to correctly get the custom splash screen on subsequent runs for your example. Please close this issue if you are satisfied, thanks.&lt;/p&gt;</comment>
                            <comment id="12871935" author="jglick@netbeans.org" created="Wed, 26 May 2010 20:43:43 +0000"  >&lt;p&gt;After 948547 it works as expected.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56561</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 26 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0vxa7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>184365</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>