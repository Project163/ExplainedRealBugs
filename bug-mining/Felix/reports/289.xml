<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:08:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-849] checking a &quot;self-defined&quot; permission (extends java.security.Permission) does not work</title>
                <link>https://issues.apache.org/jira/browse/FELIX-849</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;I have problems in using Permission derived from java.security.Permission&lt;br/&gt;
with the felix ConditionalPermissionAdmin.&lt;/p&gt;

&lt;p&gt;I have 3 bundles:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;PermissionManagement: defines MyPermission class and assigns this permission to all bundles&lt;/li&gt;
	&lt;li&gt;Provider: exposes a function f with security check on MyPermission&lt;/li&gt;
	&lt;li&gt;Consumer: try to use function f&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I run these bundles in felix + framework.security + scr and got access denied&lt;br/&gt;
(Consumer is not allowed to use function f although MyPermission is already assigned to all bundles)&lt;/p&gt;

&lt;p&gt;Problems in detail:&lt;/p&gt;

&lt;p&gt;I have a bundle named PermissionManagement which defines a new Permission class&lt;br/&gt;
as follows:&lt;/p&gt;

&lt;p&gt;public class MyPermission extends Permission {&lt;br/&gt;
   private String actions;&lt;/p&gt;

&lt;p&gt;   public MyPermission(String name, String actions) &lt;/p&gt;
{
       super(name);
       this.actions = actions;
       System.out.println(&quot;MyPermission constructor called with params: &quot; +
           name + &quot;, &quot; + actions);
   }
&lt;p&gt;   ...&lt;/p&gt;

&lt;p&gt;   @Override&lt;br/&gt;
   public String getActions() &lt;/p&gt;
{
       System.out.println(&quot;MyPermission getActions method called&quot;);
       return this.actions;
   }

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;PermissionManagement also defines a class called &quot;PermissionManager&quot; to assign&lt;br/&gt;
MyPermission to all bundles using ConditionalPermissionAdmin as follows:&lt;/p&gt;

&lt;p&gt;   cpa.addConditionalPermissionInfo(new ConditionInfo[]&lt;/p&gt;
{
       null
   }
&lt;p&gt;,&lt;br/&gt;
   new PermissionInfo[]&lt;/p&gt;
{
       new PermissionInfo(
       MyPermission.class.getName(), &quot;MyName&quot;, &quot;MyAction&quot;)
   }
&lt;p&gt;);&lt;/p&gt;

&lt;p&gt;Provider bundle defines a class DummyProvider which exposes a function F guarded with security check&lt;/p&gt;

&lt;p&gt;   public String f() {&lt;br/&gt;
       MyPermission myPerm = new MyPermission(&quot;MyName&quot;, &quot;MyAction&quot;);&lt;br/&gt;
       SecurityManager security = System.getSecurityManager();&lt;br/&gt;
       if (security != null) &lt;/p&gt;
{
           security.checkPermission(myPerm);
       }
&lt;p&gt;       return &quot;test&quot;;&lt;br/&gt;
   }&lt;/p&gt;

&lt;p&gt;Consumer bundle has an Activator as follows:&lt;br/&gt;
public class Activator implements BundleActivator {&lt;/p&gt;

&lt;p&gt;   @Override&lt;br/&gt;
   public void start(BundleContext arg0) throws Exception &lt;/p&gt;
{
       DummyProvider dp = new DummyProvider();
       System.out.println(dp.f());
   }
&lt;p&gt;   ...&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;in felix shell&lt;br/&gt;
-&amp;gt; start &lt;a href=&quot;file:///.../consumer-1.0-SNAPSHOT.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:///.../consumer-1.0-SNAPSHOT.jar&lt;/a&gt;&lt;br/&gt;
DummyProvider constructor called&lt;br/&gt;
MyPermission constructor called with params: MyName, MyAction&lt;br/&gt;
MyPermission hashCode method called&lt;br/&gt;
MyPermission hashCode method called&lt;br/&gt;
MyPermission hashCode method called&lt;br/&gt;
MyPermission hashCode method called&lt;br/&gt;
MyPermission getActions method called&lt;/p&gt;

&lt;p&gt;java.security.AccessControlException: access denied (testbundles.permissionmanagement.MyPermission MyName MyAction) &lt;/p&gt;</description>
                <environment></environment>
        <key id="12410801">FELIX-849</key>
            <summary>checking a &quot;self-defined&quot; permission (extends java.security.Permission) does not work</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="karlpauls">Karl Pauls</assignee>
                                    <reporter username="hasan">Hasan Hasan</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Dec 2008 14:32:31 +0000</created>
                <updated>Tue, 16 Dec 2008 17:02:13 +0000</updated>
                            <resolved>Tue, 16 Dec 2008 15:52:01 +0000</resolved>
                                                                    <component>Conditional Permission Admin</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12657030" author="karlpauls" created="Tue, 16 Dec 2008 15:52:01 +0000"  >&lt;p&gt;We did miss a doPriv block when trying to access the PackageAdmin service. Because of that, we haven&apos;t been able to load the permission. This is sort of an edge case but I fixed it. Please do an svn up and see whether it works for you. If so, then please close this issue.&lt;/p&gt;</comment>
                            <comment id="12657060" author="hasan" created="Tue, 16 Dec 2008 17:02:13 +0000"  >&lt;p&gt;Thanks for resolving this issue. It works for me.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12396190" name="felix_security_issue.tgz" size="2651" author="hasan" created="Tue, 16 Dec 2008 14:34:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>58140</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 50 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1aqgf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>270752</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>