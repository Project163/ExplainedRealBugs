<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 16:00:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-5200] Factory configuration adapter not restarted</title>
                <link>https://issues.apache.org/jira/browse/FELIX-5200</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;When a factory pid adapter is losing one of its required service dependencies, it is stopped, but when the lost dependency comes up again, the configuration adapter instance is not re-created and re-started.&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;A factory configuration adapter has a required dependency on a &quot;Required&quot; service.&lt;/li&gt;
	&lt;li&gt;The factory configuration is created, the &quot;Required&quot; service is registered, so a factory configuration adapter INSTANCE1 is then created.&lt;/li&gt;
	&lt;li&gt;Now the &quot;Required&quot; service is unregistered: the INSTANCE1 is then stopped.&lt;/li&gt;
	&lt;li&gt;And when the &quot;Required&quot; service comes up again, then a new factory config adapter INSTANCE2 should be re-created, updated and started, But since R1 this is not the case anymore.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The bug is located in the AbstractDecorator.stop() method, this method currently does this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void stop() {
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Component component : m_services.values()) {
            m_manager.remove(component);
        }
    }    
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Clearly, this is a bug because the &quot;m_services&quot; list is not cleared, so when the AbstractDecorator.updated(String, Dictionary) method is called again, it finds again some old stale components, and updates them instead of re-creating new adapter instances.&lt;/p&gt;

&lt;p&gt;In DM3, the list was correctly cleared:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void stop() { 
        &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[] components;
        &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (m_services) {
            components = m_services.values().toArray();
            m_services.clear();
        }
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; components.length; i++) {
            m_manager.remove((Component) components[i]);
        }
    }    
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I will add a test case soon.&lt;/p&gt;


</description>
                <environment></environment>
        <key id="12945206">FELIX-5200</key>
            <summary>Factory configuration adapter not restarted</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pderop">Pierre De Rop</assignee>
                                    <reporter username="pderop">Pierre De Rop</reporter>
                        <labels>
                    </labels>
                <created>Sat, 27 Feb 2016 17:04:54 +0000</created>
                <updated>Sun, 6 Mar 2016 19:07:47 +0000</updated>
                            <resolved>Sat, 27 Feb 2016 17:08:32 +0000</resolved>
                                    <version>org.apache.felix.dependencymanager-r1</version>
                                    <fixVersion>org.apache.felix.dependencymanager-r8</fixVersion>
                                    <component>Dependency Manager</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="15170654" author="pderop" created="Sat, 27 Feb 2016 17:08:32 +0000"  >&lt;p&gt;Fixed issue in rv 1732653, and added the following test case:&lt;/p&gt;

&lt;p&gt;org.apache.felix.dependencymanager.itest/src/org/apache/felix/dm/itest/api/FELIX5200_FactoryPidNotRestartedTest.java&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 38 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2tvan:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>