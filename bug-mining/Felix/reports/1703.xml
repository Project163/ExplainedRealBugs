<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:44:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-3720] Designate&apos;s pid attribute is optional and not mandatory</title>
                <link>https://issues.apache.org/jira/browse/FELIX-3720</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;In class org.apache.felix.metatype.MetaDataReader method readDesignate the &quot;pid&quot; attribute of a &quot;Designate&quot; element is read as required attribute:&lt;/p&gt;

&lt;p&gt;       designate.setPid( this.getRequiredAttribute( &quot;pid&quot; ) );  &lt;br/&gt;
       designate.setFactoryPid( this.getOptionalAttribute( &quot;factoryPid&quot; ) );&lt;/p&gt;

&lt;p&gt;This is wrong as according to the Metatype Service Specification (Version 1.2) the attributes &quot;pid&quot; and &quot;factoryPid&quot; are both optional but at least one of these two must be present (either &quot;pid&quot; or &quot;factoryPid&quot;). Thus the code should be changed to something like this:&lt;/p&gt;

&lt;p&gt;        final String pid = this.getOptionalAttribute( &quot;pid&quot; );&lt;br/&gt;
        final String factoryPid = this.getOptionalAttribute( &quot;factoryPid&quot; );&lt;br/&gt;
        if ( pid == null &amp;amp;&amp;amp; factoryPid == null ) &lt;/p&gt;
{
        	missingAttribute(&quot;pid or factoryPid&quot;);
        }
&lt;p&gt;        designate.setPid( pid );&lt;br/&gt;
        designate.setFactoryPid( factoryPid );&lt;/p&gt;

&lt;p&gt;Also the class MetaData should be fixed, its addDesignate member looks like this:&lt;/p&gt;

&lt;p&gt;    public void addDesignate( Designate designate )&lt;br/&gt;
    {&lt;br/&gt;
        if ( designate != null )&lt;br/&gt;
        {&lt;br/&gt;
            if ( designates == null )&lt;/p&gt;
            {
                designates = new HashMap();
            }&lt;br/&gt;
&lt;br/&gt;
            designates.put( designate.getPid(), designate );&lt;br/&gt;
        }&lt;br/&gt;
    }&lt;br/&gt;
&lt;br/&gt;
but should be implemented something like this:&lt;br/&gt;
&lt;br/&gt;
    public void addDesignate( Designate designate )&lt;br/&gt;
    {&lt;br/&gt;
        if ( designate != null )&lt;br/&gt;
        {&lt;br/&gt;
            if ( designates == null )&lt;br/&gt;
            {                designates = new HashMap();            }
&lt;p&gt;            final String factoryPid = designate.getFactoryPid();&lt;br/&gt;
            if ( factoryPid == null ) &lt;/p&gt;
{
            	designates.put( designate.getPid(), designate );	
            }
&lt;p&gt; else &lt;/p&gt;
{
            	designates.put( factoryPid, designate );
            }
&lt;p&gt;            &lt;br/&gt;
        }&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;Additionally the attribute OCD/name should also be treated to be optional (see MetaDataReader&apos;s member readOCD).&lt;/p&gt;

&lt;p&gt;And last but not least MetaTypeInformationImpl&apos;s addMetaData member should be changed like this:&lt;/p&gt;

&lt;p&gt;                // gather pids and factory pids&lt;br/&gt;
                if (designate.getFactoryPid() != null) &lt;/p&gt;
{
                    this.factoryPids.add( designate.getFactoryPid() );
                    this.addMetaTypeProvider(designate.getFactoryPid(), dmtp);
                }
&lt;p&gt; else &lt;/p&gt;
{
                    this.pids.add(designate.getPid());
                    this.addMetaTypeProvider(designate.getPid(), dmtp);
                }</description>
                <environment></environment>
        <key id="12612370">FELIX-3720</key>
            <summary>Designate&apos;s pid attribute is optional and not mandatory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fmeschbe">Felix Meschberger</assignee>
                                    <reporter username="alexberger">Alexander Berger</reporter>
                        <labels>
                    </labels>
                <created>Thu, 18 Oct 2012 06:05:08 +0000</created>
                <updated>Thu, 18 Oct 2012 12:43:07 +0000</updated>
                            <resolved>Thu, 18 Oct 2012 12:32:53 +0000</resolved>
                                    <version>metatype-1.0.4</version>
                                    <fixVersion> metatype-1.0.6</fixVersion>
                                    <component>Metatype Service</component>
                    <component>Specification compliance</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13478752" author="alexberger" created="Thu, 18 Oct 2012 07:23:20 +0000"  >&lt;p&gt;A patch against trunk which should fix all the problems mentioned in this issue.&lt;/p&gt;</comment>
                            <comment id="13478939" author="fmeschbe" created="Thu, 18 Oct 2012 12:13:02 +0000"  >&lt;p&gt;Thanks for providing the patch. &lt;/p&gt;

&lt;p&gt;I agree with the optionality of the pid and factoryPid attributes and with the respective changes.&lt;/p&gt;

&lt;p&gt;Yet, I do not agree with the OCD/name attribute being optional: According to the schema, this attribute is required. Why should it not be ?&lt;/p&gt;</comment>
                            <comment id="13478943" author="alexberger" created="Thu, 18 Oct 2012 12:17:51 +0000"  >&lt;p&gt;Yes you are right OCD/name is required. I must have been looking at the wrong line in the XSD &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
I just updated the patch (diff) file&lt;/p&gt;</comment>
                            <comment id="13478950" author="fmeschbe" created="Thu, 18 Oct 2012 12:32:53 +0000"  >&lt;p&gt;Thanks for the updated patch. I have applied it slightly modified (formatting mostly) in Rev. 1399617.&lt;/p&gt;</comment>
                            <comment id="13478958" author="alexberger" created="Thu, 18 Oct 2012 12:42:53 +0000"  >&lt;p&gt;Ok, that was a really fast fix and it passed all my tests. Thank you very much.&lt;/p&gt;

&lt;p&gt;regards,&lt;br/&gt;
Alex&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12549681" name="metatype.diff" size="3040" author="alexberger" created="Thu, 18 Oct 2012 12:21:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>249481</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 5 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0aerj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>58665</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>