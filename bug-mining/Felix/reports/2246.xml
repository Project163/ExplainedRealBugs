<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:54:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-4296] Cannot deactivate service interface detection in DS annotations</title>
                <link>https://issues.apache.org/jira/browse/FELIX-4296</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;I am trying to use DS annotations to declare an extender, and I have the following annotation and class definition in order to prevent declaring a service with a SynchronousBundleListener interface : &lt;/p&gt;

&lt;p&gt;@Component(service={})&lt;br/&gt;
public class ExtenderBundleListener implements SynchronousBundleListener {&lt;/p&gt;

&lt;p&gt;According to the DS annotation specification this is value, as is illustrated from the javadoc :&lt;/p&gt;

&lt;p&gt;	/**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;The types under which to register this Component as a service.&lt;br/&gt;
	 *&lt;/li&gt;
	&lt;li&gt;&amp;lt;p&amp;gt;&lt;/li&gt;
	&lt;li&gt;If no service should be registered, the empty value&lt;/li&gt;
	&lt;li&gt;&amp;lt;code&amp;gt;&amp;#x7B;&amp;#x7D;&amp;lt;/code&amp;gt; must be specified.&lt;br/&gt;
	 *&lt;/li&gt;
	&lt;li&gt;&amp;lt;p&amp;gt;&lt;/li&gt;
	&lt;li&gt;If not specified, the service types for this Component are all the&lt;/li&gt;
	&lt;li&gt;&amp;lt;i&amp;gt;directly&amp;lt;/i&amp;gt; implemented interfaces of the class being annotated.&lt;br/&gt;
	 *&lt;/li&gt;
	&lt;li&gt;@see &quot;The service element of a Component Description.&quot;&lt;br/&gt;
	 */&lt;br/&gt;
	Class&amp;lt; ? &amp;gt;[] service() default {};&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Unfortunately this doesn&apos;t work, as it seems that the annotation parser transforms the {} value into &quot;null&quot; so the following code in the DS annotation processor doesn&apos;t work as expected : &lt;/p&gt;

&lt;p&gt;        final List&amp;lt;String&amp;gt; listedInterfaces = new ArrayList&amp;lt;String&amp;gt;();&lt;br/&gt;
        if (cad.getValue(&quot;service&quot;) != null) {&lt;br/&gt;
            final String[] interfaces = (String[]) cad.getValue(&quot;service&quot;);&lt;br/&gt;
            for (final String t : interfaces) &lt;/p&gt;
{
                listedInterfaces.add(t);
            }
&lt;p&gt;        } else &lt;/p&gt;
{
            // scan directly implemented interfaces
            this.searchInterfaces(listedInterfaces, scannedClass.getScannedClass());
        }

&lt;p&gt;This is a bit problematic to solve because we would need to differentiate between the null and empty case, but it seems that this is somehow not supported by the annotations parser ?&lt;/p&gt;

&lt;p&gt;For the moment I worked around the problem by using the following annotation, but it&apos;s rather ugly since it still generates a service that is not needed :&lt;/p&gt;

&lt;p&gt;@Component(service=&lt;/p&gt;
{ExtenderBundleListener.class}
&lt;p&gt;, immediate = true) // ideally we would like to not specify any service but it&apos;s seems that due to a bug in the DS annotation processor this is not possible so we use the immediate setting instead&lt;br/&gt;
public class ExtenderBundleListener implements SynchronousBundleListener {&lt;/p&gt;</description>
                <environment></environment>
        <key id="12676095">FELIX-4296</key>
            <summary>Cannot deactivate service interface detection in DS annotations</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cziegeler">Carsten Ziegeler</assignee>
                                    <reporter username="bhillou">Serge Huber</reporter>
                        <labels>
                    </labels>
                <created>Mon, 28 Oct 2013 10:11:42 +0000</created>
                <updated>Thu, 31 Jul 2014 13:13:05 +0000</updated>
                            <resolved>Thu, 24 Jul 2014 13:18:58 +0000</resolved>
                                    <version>scr generator 1.10.0</version>
                    <version>scr ds annotations 1.2.4</version>
                                    <fixVersion>maven-scr-plugin 1.19.0</fixVersion>
                    <fixVersion>scr ant task 1.13.0</fixVersion>
                    <fixVersion>scr generator 1.12.0</fixVersion>
                    <fixVersion>scr ds annotations 1.2.8</fixVersion>
                                    <component>SCR Tooling</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14071749" author="cziegeler" created="Wed, 23 Jul 2014 14:02:42 +0000"  >&lt;p&gt;I think the problem lies in the ClassScanner.parseAnnotation - it discards empty arrays as it can&apos;t do a type conversion&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bhillou&quot; class=&quot;user-hover&quot; rel=&quot;bhillou&quot;&gt;bhillou&lt;/a&gt; do you have a simple test project to share?&lt;/p&gt;</comment>
                            <comment id="14073175" author="cziegeler" created="Thu, 24 Jul 2014 13:18:58 +0000"  >&lt;p&gt;I&apos;ve added a check distinguishing between the empty array and not providing a value in rev 1613113&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>355592</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 17 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1pawv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>355880</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>