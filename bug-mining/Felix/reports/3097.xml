<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 16:14:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-6117] Json does not show tags if tags are configured as Vector in ConfigurationAdmin</title>
                <link>https://issues.apache.org/jira/browse/FELIX-6117</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;i configured a generalchecks.DiskSpaceCheck with tags&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;//config
&lt;/span&gt;org.apache.felix.hc.generalchecks.DiskSpaceCheck~test2:
&#160;&#160; hc.name: myTest222
&#160;&#160; hc.tags: [system,system_memory,dings]
&#160;&#160; diskPaths: [.]
&#160;&#160; diskUsedThresholdWarn: 15
&#160;&#160; diskUsedThresholdCritical: 10
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;filtering by these tags works ans shows the corrent results.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8080/system/health/*.json&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8080/system/health/*.json&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8080/system/health/system.json&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8080/system/health/system.json&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;but ins the result json the&#160; attribute &quot;tags&quot; isn&apos;t set properly.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
{
  &lt;span class=&quot;code-quote&quot;&gt;&quot;overallResult&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;CRITICAL&quot;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&quot;results&quot;&lt;/span&gt;: [
    {
      &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;myTest222&quot;&lt;/span&gt;,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;status&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;CRITICAL&quot;&lt;/span&gt;,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;timeInMs&quot;&lt;/span&gt;: 2,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;finishedAt&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;2019-05-02T15:22:18.646&quot;&lt;/span&gt;,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;tags&quot;&lt;/span&gt;: [],
      &lt;span class=&quot;code-quote&quot;&gt;&quot;messages&quot;&lt;/span&gt;: [
        {
          &lt;span class=&quot;code-quote&quot;&gt;&quot;status&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;CRITICAL&quot;&lt;/span&gt;,
          &lt;span class=&quot;code-quote&quot;&gt;&quot;message&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;Disk Usage /home/name/dev/git/fooo/health/.: 11.3% of 166.2GB used / 147.5GB free&quot;&lt;/span&gt;
        }
      ]
    }
  ]
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;With my own implementations of healthcheck this works.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13231256">FELIX-6117</key>
            <summary>Json does not show tags if tags are configured as Vector in ConfigurationAdmin</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="henzlerg">Georg Henzler</assignee>
                                    <reporter username="bischofs@jena.de">Stefan Bischof</reporter>
                        <labels>
                    </labels>
                <created>Thu, 2 May 2019 13:28:24 +0000</created>
                <updated>Mon, 20 May 2019 07:10:38 +0000</updated>
                            <resolved>Wed, 15 May 2019 17:23:07 +0000</resolved>
                                    <version>healthcheck.api 2.0.0</version>
                                    <fixVersion>healthcheck.api 2.0.2</fixVersion>
                                    <component>Health Checks</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16835332" author="henzlerg" created="Wed, 8 May 2019 06:00:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bischofs%40jena.de&quot; class=&quot;user-hover&quot; rel=&quot;bischofs@jena.de&quot;&gt;bischofs@jena.de&lt;/a&gt; I tried to reproduce but I couldn&apos;t  - could you please check the following:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;check the html rendering if it shows the tags &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12968157/12968157_tags-in-html-rendering.png&quot; width=&quot;300&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/li&gt;
	&lt;li&gt;check the SCR component properties in web console (this should show the tags correctly as well)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16835869" author="henzlerg" created="Wed, 8 May 2019 20:07:34 +0000"  >&lt;p&gt;Looking at the code &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; it seems that the config line &quot;hc.tags: &lt;span class=&quot;error&quot;&gt;&amp;#91;system,system_memory,dings&amp;#93;&lt;/span&gt;&quot; does not produce a String array (what config mechanism are you using? The format seems non-standard?). For selecting HCs the input given is directly added to a filter expression, hence that &lt;br/&gt;
might still find the correct HC services even though the type of the properties is not a String/String[].&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://svn.apache.org/viewvc/felix/trunk/healthcheck/api/src/main/java/org/apache/felix/hc/api/execution/HealthCheckMetadata.java?revision=1857710&amp;amp;view=markup#l200&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/felix/trunk/healthcheck/api/src/main/java/org/apache/felix/hc/api/execution/HealthCheckMetadata.java?revision=1857710&amp;amp;view=markup#l200&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16837249" author="bischofs@jena.de" created="Fri, 10 May 2019 12:57:45 +0000"  >&lt;p&gt;The Result of Gogo SCR:info&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Component Description: org.apache.felix.hc.generalchecks.DiskSpaceCheck
=======================================================================
&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; org.apache.felix.hc.generalchecks.DiskSpaceCheck
Bundle:&#160;&#160;&#160;&#160;&#160;&#160;&#160; 26 (org.apache.felix.healthcheck.generalchecks:2.0.0)
Enabled:&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
Immediate:&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
Services:&#160;&#160;&#160;&#160;&#160; [org.apache.felix.hc.api.HealthCheck]
Scope:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; singleton
Config PID(s): [org.apache.felix.hc.generalchecks.DiskSpaceCheck], Policy: require
Base Props:&#160;&#160;&#160; (5 entries)
&#160; diskPaths&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[]&amp;gt; = [.]
&#160; diskUsedThresholdCritical&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;&amp;gt; = 97
&#160; diskUsedThresholdWarn&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;&amp;gt; = 90
&#160; hc.name&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; = Disk Space
&#160; webconsole.configurationFactory.nameHint&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; = {hc.name}: {diskPaths} used&amp;gt;{diskUsedThresholdWarn}% -&amp;gt; WARN&#160; used&amp;gt;{diskUsedThresholdCritical}% -&amp;gt; CRITICAL

Component Configuration Id: 11
------------------------------
State:&#160;&#160;&#160;&#160;&#160;&#160;&#160; SATISFIED
Service:&#160;&#160;&#160;&#160;&#160; 43 [org.apache.felix.hc.api.HealthCheck]
Config Props: (11 entries)
&#160; component.id&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;&amp;gt; = 11
&#160; component.name&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; = org.apache.felix.hc.generalchecks.DiskSpaceCheck
&#160; diskPaths&amp;lt;Vector&amp;gt; = [.]
&#160; diskUsedThresholdCritical&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt; = 10
&#160; diskUsedThresholdWarn&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt; = 15
&#160; hc.name&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; = myTest222
&#160; hc.tags&amp;lt;Vector&amp;gt; = [system, system_memory, dings]
&#160; service.factoryPid&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; = org.apache.felix.hc.generalchecks.DiskSpaceCheck
&#160; service.pid&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; = org.apache.felix.hc.generalchecks.DiskSpaceCheck~test2
&#160; webconsole.configurationFactory.nameHint&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; = {hc.name}: {diskPaths} used&amp;gt;{diskUsedThresholdWarn}% -&amp;gt; WARN&#160; used&amp;gt;{diskUsedThresholdCritical}% -&amp;gt; CRITICAL
References:&#160;&#160; (total 0)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
I think the configuration works correct!&#160; 

hc.tags&amp;lt;Vector&amp;gt; = [system, system_memory, dings]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;did you tryed to request the json?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8080/system/health/*.json&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8080/system/health/*.json&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16838601" author="henzlerg" created="Mon, 13 May 2019 14:59:32 +0000"  >&lt;p&gt;Yes I also tried &lt;a href=&quot;http://localhost:8080/system/health/*.json&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8080/system/health/*.json&lt;/a&gt; and it worked fine. The root cause is really the type conversion in &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; in previous comment - it&apos;s easy to fix to also deal with collections (and not only String arrays), but out of interest: How did you create the configuration exactly?&lt;/p&gt;</comment>
                            <comment id="16838615" author="bischofs@jena.de" created="Mon, 13 May 2019 15:14:57 +0000"  >&lt;p&gt;We use our own Configurator wich handles enc. yaml files. It might be that yaml-consumer reads an Collection instead of String[].&lt;/p&gt;</comment>
                            <comment id="16838627" author="henzlerg" created="Mon, 13 May 2019 15:31:35 +0000"  >&lt;p&gt;If you have the creation of configuration under your control (the mechanism that handles the enc yaml files) you might be able to save String arrays instead of a Vector (and I suppose that would be a quick fix it for you). But on the other hand the class HealthCheckMetadata should also be able to deal with it, will fix this as well. &lt;/p&gt;</comment>
                            <comment id="16838638" author="bischofs@jena.de" created="Mon, 13 May 2019 15:51:31 +0000"  >&lt;p&gt;I&apos;m not sure about the OSGi Spec:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
104.4.3&#160;Configuration Properties

A configuration dictionary contains a set of properties in a Dictionary object. The value of the property must be the same type as the set of Primary Property Types specified in OSGi Core Release 7(https:&lt;span class=&quot;code-comment&quot;&gt;//osgi.org/specification/osgi.cmpn/7.0.0/introduction.html#intro.core.release) Filter Syntax.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I couldn&apos;t find the list of &quot;Primary Property Types specified in OSGi Core Release 7 Filter Syntax&quot;. Do you know where this is described&lt;/p&gt;

&lt;p&gt;If a Collection&amp;lt;&amp;gt; of is not specified we MUST fix our Configurator and there is no reason for you to fix it.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thank you for explanation&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16838849" author="henzlerg" created="Mon, 13 May 2019 20:02:28 +0000"  >&lt;p&gt;The spec at &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; says &quot;Multiple values for the same key are supported with arrays ([]) and Collection objects&quot; - hence I think this is a valid bug.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://osgi.org/specification/osgi.core/7.0.0/framework.service.html#framework.service.serviceproperties&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://osgi.org/specification/osgi.core/7.0.0/framework.service.html#framework.service.serviceproperties&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16840592" author="henzlerg" created="Wed, 15 May 2019 17:23:07 +0000"  >&lt;p&gt;Fixed in &lt;a href=&quot;http://svn.apache.org/r1859304&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;r1859304&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12968157" name="tags-in-html-rendering.png" size="29649" author="henzlerg" created="Wed, 8 May 2019 05:58:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 26 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z02c28:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>