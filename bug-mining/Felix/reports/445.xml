<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:10:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-1235] NullPointerException due to misconfigured watched dir</title>
                <link>https://issues.apache.org/jira/browse/FELIX-1235</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;The &quot;traverse&quot; method of the DirectoryWatcher class will raise a NPE if the provided &quot;jardir&quot; parameter does not point to a directory.&lt;br/&gt;
The for loop inside that method should read:&lt;br/&gt;
for (int i = 0; (list!=null) &amp;amp;&amp;amp; (i &amp;lt; list.length); i++)&lt;/p&gt;
{...}

&lt;p&gt;To avoid hiding the configuration problem, the constructor of the DirectoryWatcher class could be amended like this:&lt;/p&gt;

&lt;p&gt;...&lt;br/&gt;
this.watchedDirectory = new File(dir);&lt;/p&gt;

&lt;p&gt;        if (!this.watchedDirectory.exists()){                &lt;br/&gt;
            if (!this.watchedDirectory.mkdirs()) &lt;/p&gt;
{ throw new RuntimeException(&quot;Failed to create directory &quot; + this.watchedDirectory.getAbsolutePath());}
&lt;p&gt;        }else{&lt;br/&gt;
            if (this.watchedDirectory.isDirectory())&lt;/p&gt;
{
                log(this.watchedDirectory.getAbsolutePath() + &quot; already existing&quot;, null);
            }
&lt;p&gt;else&lt;/p&gt;
{
                log(this.watchedDirectory.getAbsolutePath() + &quot; exists, but is not a directory&quot;, null);
                throw new RuntimeException(this.watchedDirectory.getAbsolutePath()+&quot; exists, but is not a directory&quot;);
            }
&lt;p&gt;        }&lt;/p&gt;

&lt;p&gt;Object value = properties.get(START_NEW_BUNDLES);&lt;br/&gt;
...&lt;/p&gt;</description>
                <environment>Windows [Vista|XP]</environment>
        <key id="12427758">FELIX-1235</key>
            <summary>NullPointerException due to misconfigured watched dir</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rickhall">Richard S. Hall</assignee>
                                    <reporter username="gspadotto">Guido Spadotto</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Jun 2009 16:01:26 +0000</created>
                <updated>Thu, 18 Jun 2009 08:22:36 +0000</updated>
                            <resolved>Wed, 17 Jun 2009 15:26:47 +0000</resolved>
                                    <version> fileinstall-1.0.0</version>
                                    <fixVersion>fileinstall-1.2.0</fixVersion>
                                    <component>File Install</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="5400">1.5h</timeoriginalestimate>
                            <timeestimate seconds="5400">1.5h</timeestimate>
                                        <comments>
                            <comment id="12720580" author="fdiotalevi" created="Wed, 17 Jun 2009 09:24:25 +0000"  >&lt;p&gt;Do you get an exception if you start FileInstall watching a non-existent directory? &lt;br/&gt;
I don&apos;t have Win machine to check, but with Linux/MacOS that&apos;s not the case; the directory is created at startup. &lt;/p&gt;

&lt;p&gt;Anyway, I spot a (quite unlikely to happen) bug. If you start FileInstall watching a &quot;foo&quot; directory, but &quot;foo&quot; is actually a file, you get into a pretty bad situation: &lt;br/&gt;
Welcome to Felix. &lt;br/&gt;
================= &lt;br/&gt;
felix.fileinstall.poll (ms) 2000 &lt;br/&gt;
felix.fileinstall.dir /opt/myprojects/felix-1.8.0/./load &lt;br/&gt;
felix.fileinstall.debug -1 &lt;br/&gt;
felix.fileinstall.bundles.new.start true &lt;br/&gt;
In main loop, we have serious trouble: java.lang.NullPointerException &lt;br/&gt;
In main loop, we have serious trouble: java.lang.NullPointerException &lt;br/&gt;
In main loop, we have serious trouble: java.lang.NullPointerException &lt;br/&gt;
...... &lt;/p&gt;

&lt;p&gt;I&apos;ll submit a patch for it, but I need to check it does not interfere with &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-1228&quot; title=&quot;Felix File Install - Spaces in File Names&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-1228&quot;&gt;&lt;del&gt;FELIX-1228&lt;/del&gt;&lt;/a&gt; &lt;/p&gt;</comment>
                            <comment id="12720581" author="fdiotalevi" created="Wed, 17 Jun 2009 09:27:45 +0000"  >&lt;p&gt;Just found the code...&lt;/p&gt;

&lt;p&gt;DirectoryWatcher.java, lines 93-94&lt;/p&gt;

&lt;p&gt;        this.watchedDirectory = new File(dir);&lt;br/&gt;
        this.watchedDirectory.mkdirs();&lt;/p&gt;</comment>
                            <comment id="12720596" author="fdiotalevi" created="Wed, 17 Jun 2009 09:57:05 +0000"  >&lt;p&gt;Patch attached.&lt;/p&gt;

&lt;p&gt;To summarize:&lt;/p&gt;

&lt;p&gt;1) if FileInstall starts watching a non-existent directory, the directory is already created automatically (check DirectoryWatcher, lines 93-94). No issue here&lt;/p&gt;

&lt;p&gt;2) if FileInstall is incorrectly configure to watch a file (instead of a directory), it goes in an infinite loop writing:&lt;br/&gt;
&quot;In main loop, we have serious trouble: java.lang.NullPointerException&quot;&lt;/p&gt;

&lt;p&gt;The attached patch solves 2)&lt;/p&gt;</comment>
                            <comment id="12720609" author="gspadotto" created="Wed, 17 Jun 2009 10:32:50 +0000"  >&lt;p&gt;This bug is actually a spin-off of &lt;br/&gt;
&lt;a href=&quot;http://issues.apache.org/jira/browse/FELIX-1228&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/FELIX-1228&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For a bit of context, check:&lt;br/&gt;
&lt;a href=&quot;http://www.nabble.com/Re%3A-Felix-File-Install---Spaces-in-watched-directory-name-p24000232.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.nabble.com/Re%3A-Felix-File-Install---Spaces-in-watched-directory-name-p24000232.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;and the related mail thread.&lt;/p&gt;

&lt;p&gt;About this line in the patch:&lt;br/&gt;
throw new RuntimeException( &quot;Cannot start FileInstall to watch a non-existent directory&quot; );&lt;br/&gt;
actually, you &lt;b&gt;can&lt;/b&gt; start FileInstall to watch a non-existent directory.&lt;/p&gt;

&lt;p&gt;Should be something like:&lt;br/&gt;
throw new RuntimeException( &quot;Cannot start FileInstall to watch something that is not a directory&quot; );&lt;/p&gt;</comment>
                            <comment id="12720653" author="fdiotalevi" created="Wed, 17 Jun 2009 13:11:34 +0000"  >&lt;p&gt;Second version of the patch attached.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Error message revised&lt;/li&gt;
	&lt;li&gt;Added a check to verify that the watched folder has been successfully created&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12720712" author="rickhall" created="Wed, 17 Jun 2009 15:26:47 +0000"  >&lt;p&gt;I committed this patch. Please close if satisfied.&lt;/p&gt;</comment>
                            <comment id="12720713" author="gspadotto" created="Wed, 17 Jun 2009 15:30:25 +0000"  >&lt;p&gt;Works as expected.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12428188">FELIX-1251</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12410930" name="FELIX-1235-2.txt" size="1178" author="fdiotalevi" created="Wed, 17 Jun 2009 13:11:33 +0000"/>
                            <attachment id="12410916" name="FELIX-1235.txt" size="829" author="fdiotalevi" created="Wed, 17 Jun 2009 09:57:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>57783</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 23 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0vyr3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>184603</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>