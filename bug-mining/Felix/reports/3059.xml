<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 16:13:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-6023] SCR bnd plugin sometimes fails with IncompatibleClassChangeError: Implementing class</title>
                <link>https://issues.apache.org/jira/browse/FELIX-6023</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;When building a project where a newer version of a dependency is embedded in the project artifact with a conflicting older version of said dependency is also present on the classpath, SOME environments encounter an exception that is similar to the following:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[ERROR] Manifest com.adobe.acs:acs-aem-commons-bundle:bundle:3.19.1-SNAPSHOT : Got unexpected exception while analyzing:org.apache.felix.scrplugin.SCRDescriptorException: Unable to load compiled class: com.google.common.base.Suppliers$SupplierFunctionImpl
	at org.apache.felix.scrplugin.helper.ClassScanner.scanSources(ClassScanner.java:156)
	at org.apache.felix.scrplugin.SCRDescriptorGenerator.execute(SCRDescriptorGenerator.java:146)
	at org.apache.felix.scrplugin.bnd.SCRDescriptorBndPlugin.analyzeJar(SCRDescriptorBndPlugin.java:178)
	at aQute.bnd.osgi.Analyzer.doPlugins(Analyzer.java:820)
	at aQute.bnd.osgi.Analyzer.analyze(Analyzer.java:229)
	at aQute.bnd.osgi.Builder.analyze(Builder.java:408)
	at aQute.bnd.osgi.Analyzer.calcManifest(Analyzer.java:850)
	at aQute.bnd.osgi.Builder.build(Builder.java:116)
	at org.apache.felix.bundleplugin.ManifestPlugin.getAnalyzer(ManifestPlugin.java:291)
	at org.apache.felix.bundleplugin.ManifestPlugin.execute(ManifestPlugin.java:98)
	at org.apache.felix.bundleplugin.BundlePlugin.execute(BundlePlugin.java:384)
	at org.apache.felix.bundleplugin.BundlePlugin.execute(BundlePlugin.java:375)
	at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:137)
	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:210)
	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:156)
	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:148)
	at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:117)
	at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:81)
	at org.apache.maven.lifecycle.internal.builder.singlethreaded.SingleThreadedBuilder.build(SingleThreadedBuilder.java:56)
	at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:128)
	at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:305)
	at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:192)
	at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:105)
	at org.apache.maven.cli.MavenCli.execute(MavenCli.java:956)
	at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:288)
	at org.apache.maven.cli.MavenCli.main(MavenCli.java:192)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:289)
	at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:229)
	at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:415)
	at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:356)
Caused by: java.lang.IncompatibleClassChangeError: Implementing class
	at java.lang.ClassLoader.defineClass1(Native Method)
	at java.lang.ClassLoader.defineClass(ClassLoader.java:763)
	at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
	at java.net.URLClassLoader.defineClass(URLClassLoader.java:468)
	at java.net.URLClassLoader.access$100(URLClassLoader.java:74)
	at java.net.URLClassLoader$1.run(URLClassLoader.java:369)
	at java.net.URLClassLoader$1.run(URLClassLoader.java:363)
	at java.security.AccessController.doPrivileged(Native Method)
	at java.net.URLClassLoader.findClass(URLClassLoader.java:362)
	at java.lang.ClassLoader.loadClass(ClassLoader.java:424)
	at java.lang.ClassLoader.loadClass(ClassLoader.java:357)
	at org.apache.felix.scrplugin.helper.ClassScanner.scanSources(ClassScanner.java:144)
	... 33 more

[ERROR] Error(s) found in manifest configuration&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The sequence of dependencies in the build should allow the preferred embedded version to be declared with higher precedence than the non-preferred version, but this sequence does not appear to be respected because of the use of a non-linked HashSet in `SCRDescriptorBndPlugin.getClassPath()` to post-process the list of classpath elements returned from Analyzer.getClasspath().&lt;/p&gt;

&lt;p&gt;I attached to debug logs from the execution. the *.bnd-1.9.0.log file shows the `uber-jar` artifact listed before the `guava` artifact in the classpath log, but their order is reversed in the dependencies log.&lt;/p&gt;

&lt;p&gt;I then replaced the HashSet with a LinkedHashSet in the bnd plugin and rebuilt the project, resulting in the *.bnd-1.9.1-SNAPSHOT.log, which shows the sequence of these two artifacts being the same in both the classpath log and the dependencies log.&lt;/p&gt;

&lt;p&gt;See: &lt;a href=&quot;https://github.com/Adobe-Consulting-Services/acs-aem-commons/issues/1675&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/Adobe-Consulting-Services/acs-aem-commons/issues/1675&lt;/a&gt; for background.&lt;/p&gt;</description>
                <environment>Maven home: /usr/local/Cellar/maven/3.6.0/libexec&lt;br/&gt;
Java version: 1.8.0_192, vendor: Oracle Corporation, runtime: /Library/Java/JavaVirtualMachines/jdk1.8.0_192.jdk/Contents/Home/jre&lt;br/&gt;
Default locale: en_US, platform encoding: UTF-8&lt;br/&gt;
OS name: &amp;quot;mac os x&amp;quot;, version: &amp;quot;10.14.2&amp;quot;, arch: &amp;quot;x86_64&amp;quot;, family: &amp;quot;mac&amp;quot;</environment>
        <key id="13208860">FELIX-6023</key>
            <summary>SCR bnd plugin sometimes fails with IncompatibleClassChangeError: Implementing class</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sseifert">Stefan Seifert</assignee>
                                    <reporter username="madamcin">Mark Adamcin</reporter>
                        <labels>
                            <label>patch-available</label>
                    </labels>
                <created>Thu, 10 Jan 2019 20:28:57 +0000</created>
                <updated>Sat, 26 Jan 2019 11:07:21 +0000</updated>
                            <resolved>Thu, 17 Jan 2019 08:53:05 +0000</resolved>
                                    <version>scr bnd plugin 1.9.0</version>
                                    <fixVersion>scr bnd plugin 1.9.2</fixVersion>
                                    <component>SCR Tooling</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16739756" author="githubbot" created="Thu, 10 Jan 2019 20:33:52 +0000"  >&lt;p&gt;GitHub user adamcin opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/165&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/165&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-6023&quot; title=&quot;SCR bnd plugin sometimes fails with IncompatibleClassChangeError: Implementing class&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-6023&quot;&gt;&lt;del&gt;FELIX-6023&lt;/del&gt;&lt;/a&gt; bnd scrplugin preserve sequence of classpath entries.&lt;/p&gt;

&lt;p&gt;    Replace the HashSet used for deduping classpath entries with a LinkedHashSet to retain the precedence established by the Analyzer.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/adamcin/felix&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/adamcin/felix&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-6023&quot; title=&quot;SCR bnd plugin sometimes fails with IncompatibleClassChangeError: Implementing class&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-6023&quot;&gt;&lt;del&gt;FELIX-6023&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/165.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/165.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #165&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 0e50d6bdff9f53ef6fb5efe9aa8f9ff88d4c82d1&lt;br/&gt;
Author: Mark Adamcin &amp;lt;adamcin@...&amp;gt;&lt;br/&gt;
Date:   2019-01-10T20:29:40Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-6023&quot; title=&quot;SCR bnd plugin sometimes fails with IncompatibleClassChangeError: Implementing class&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-6023&quot;&gt;&lt;del&gt;FELIX-6023&lt;/del&gt;&lt;/a&gt; bnd scrplugin preserve sequence of classpath entries.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16744626" author="madamcin" created="Thu, 17 Jan 2019 02:50:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwin&quot; class=&quot;user-hover&quot; rel=&quot;kwin&quot;&gt;kwin&lt;/a&gt; do you have any concerns with this change?&lt;/p&gt;</comment>
                            <comment id="16744713" author="kwin" created="Thu, 17 Jan 2019 06:11:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=madamcin&quot; class=&quot;user-hover&quot; rel=&quot;madamcin&quot;&gt;madamcin&lt;/a&gt; Looks good to me, but I am not a committer on Felix, so I cannot apply it.&lt;/p&gt;</comment>
                            <comment id="16744796" author="githubbot" created="Thu, 17 Jan 2019 08:52:34 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/165&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/165&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16744798" author="sseifert@pro-vision.de" created="Thu, 17 Jan 2019 08:53:05 +0000"  >&lt;p&gt;thanks, patch applied in rev. 1851503&lt;/p&gt;</comment>
                            <comment id="16749664" author="kwin" created="Wed, 23 Jan 2019 08:41:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sseifert%40pro-vision.de&quot; class=&quot;user-hover&quot; rel=&quot;sseifert@pro-vision.de&quot;&gt;sseifert@pro-vision.de&lt;/a&gt; Would you mind starting a release? This issue currently prevents some people building ACS AEM Commons (&lt;a href=&quot;https://github.com/Adobe-Consulting-Services/acs-aem-commons/issues/1675&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/Adobe-Consulting-Services/acs-aem-commons/issues/1675&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="16749670" author="sseifert@pro-vision.de" created="Wed, 23 Jan 2019 08:43:21 +0000"  >&lt;p&gt;yes, i can start a release vote today&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12954482" name="com.adobe.acs.acs-aem-commons-bundle.bnd-1.9.0.log" size="786964" author="madamcin" created="Thu, 10 Jan 2019 20:24:42 +0000"/>
                            <attachment id="12954481" name="com.adobe.acs.acs-aem-commons-bundle.bnd-1.9.1-SNAPSHOT.log" size="2056225" author="madamcin" created="Thu, 10 Jan 2019 20:24:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 43 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|u00pyo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>