<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:18:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-2306] ClassCastException in Wrapper.unwrap() when calling Resolver.add(x implements Resource)</title>
                <link>https://issues.apache.org/jira/browse/FELIX-2306</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;This looks like a regression from OBR 1.4.1 to 1.6.  I have a resource class that implements org.osgi.service.obr.Resource. When I call Resolver.add(myResource) I&lt;br/&gt;
get a ClassCastException:&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.ClassCastException:my.resources.MyResource&lt;br/&gt;
incompatible with&lt;br/&gt;
org.apache.felix.bundlerepository.impl.wrapper.ResourceWrapper&lt;br/&gt;
       at org.apache.felix.bundlerepository.impl.wrapper.Wrapper.unwrap(Wrapper.java:59)&lt;br/&gt;
       at org.apache.felix.bundlerepository.impl.wrapper.ResolverWrapper.add(ResolverWrapper.java:40)&lt;br/&gt;
       at my.provisioning.impl.OBRProvisioner.resolve(OBRProvisioner.java:496)&lt;/p&gt;

&lt;p&gt;Looking at Wrapper.java:&lt;/p&gt;

&lt;p&gt;   public static Resource unwrap(org.osgi.service.obr.Resource resource) &lt;/p&gt;
{
       return ((ResourceWrapper) resource).resource;
   }

&lt;p&gt;I&apos;ve passed in a class that implemented obr.Resource which this code is attempting to cast to ResourceWrapper: this fails. We got there via,&lt;/p&gt;

&lt;p&gt;  // ResolverWrapper.java&lt;br/&gt;
  public void add(org.osgi.service.obr.Resource resource) &lt;/p&gt;
{
       resolver.add(Wrapper.unwrap(resource));
   }

&lt;p&gt;At no time was my Resource wrapped before it was unwrapped. &lt;/p&gt;</description>
                <environment>Windows 7, Java 6</environment>
        <key id="12463204">FELIX-2306</key>
            <summary>ClassCastException in Wrapper.unwrap() when calling Resolver.add(x implements Resource)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gnodet">Guillaume Nodet</assignee>
                                    <reporter username="mnuttall">Mark Nuttall</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 Apr 2010 12:11:44 +0000</created>
                <updated>Tue, 15 Jun 2010 11:05:37 +0000</updated>
                            <resolved>Tue, 15 Jun 2010 08:41:04 +0000</resolved>
                                    <version>bundlerepository-1.6.0</version>
                                    <fixVersion>bundlerepository-1.6.4</fixVersion>
                                    <component>Bundle Repository (OBR)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12878610" author="gawor@mcs.anl.gov" created="Mon, 14 Jun 2010 15:16:17 +0000"  >&lt;p&gt;Proposed patch for this issue. The patch code will attempt to covert osgi Resource to felix Resource by copying the data. This might not work in all cases but should in most.&lt;/p&gt;</comment>
                            <comment id="12878890" author="gnt" created="Tue, 15 Jun 2010 08:41:04 +0000"  >&lt;p&gt;Adding         bundlerepository/src/main/java/org/apache/felix/bundlerepository/impl/wrapper/ConvertedResource.java&lt;br/&gt;
Sending        bundlerepository/src/main/java/org/apache/felix/bundlerepository/impl/wrapper/Wrapper.java&lt;br/&gt;
Transmitting file data ..&lt;br/&gt;
Committed revision 954751.&lt;/p&gt;</comment>
                            <comment id="12878927" author="mnuttall" created="Tue, 15 Jun 2010 11:05:37 +0000"  >&lt;p&gt;Thank you for this. I&apos;ve only a minor comment - &apos;int j = 0;&apos; inside ConvertedResource() seems to be spurious. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12447032" name="FELIX-2306.patch" size="5311" author="gawor@mcs.anl.gov" created="Mon, 14 Jun 2010 15:16:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56433</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 24 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0vrwv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>183495</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>