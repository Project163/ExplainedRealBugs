<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:34:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-2066] File Install fails to move fragment bundle into RESOLVED state</title>
                <link>https://issues.apache.org/jira/browse/FELIX-2066</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;The file-install will install the fragment bundle but fails to move it to resolve. The fragment bundle remains in INSTALLED state. &lt;/p&gt;

&lt;p&gt;If we install it from equinox shell, then fragment bundle is installed and resolved correctly. &lt;/p&gt;

&lt;p&gt;Can someone please comment ?&lt;/p&gt;


</description>
                <environment>Windows XP, Java 6, Equinox , File-Install 2.0.8</environment>
        <key id="12456010">FELIX-2066</key>
            <summary>File Install fails to move fragment bundle into RESOLVED state</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gnodet">Guillaume Nodet</assignee>
                                    <reporter username="shreeneewas">Shrini Joshi</reporter>
                        <labels>
                            <label>fileinstall</label>
                            <label>fragment</label>
                            <label>resolved</label>
                    </labels>
                <created>Thu, 11 Feb 2010 12:50:50 +0000</created>
                <updated>Tue, 17 Mar 2015 07:00:49 +0000</updated>
                            <resolved>Fri, 16 Mar 2012 15:00:42 +0000</resolved>
                                                    <fixVersion>fileinstall-3.2.0</fixVersion>
                                    <component>File Install</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12832492" author="shreeneewas" created="Thu, 11 Feb 2010 14:17:05 +0000"  >&lt;p&gt;Something I realized later:&lt;/p&gt;

&lt;p&gt;The fragment bundle is not resolved only if its host bundle resides in another directory. The directory watcher needs to be made smarter to ensure that fragment bundles in all the directories are resolved again (using package admin service) in response to any directory change. &lt;/p&gt;

&lt;p&gt;Any comments pls?&lt;/p&gt;
</comment>
                            <comment id="12832494" author="brindy" created="Thu, 11 Feb 2010 14:20:42 +0000"  >&lt;p&gt;I noticed this very same problem today myself.  I can live with having the fragment in the same directory for now, but not in the long term.  Thanks in advance.&lt;/p&gt;</comment>
                            <comment id="12832497" author="gnt" created="Thu, 11 Feb 2010 14:27:40 +0000"  >&lt;p&gt;Is one of you fancy writing a patch for this problem ? I&apos;d be happy to apply it ...&lt;/p&gt;</comment>
                            <comment id="12832505" author="brindy" created="Thu, 11 Feb 2010 14:38:55 +0000"  >&lt;p&gt;I can probably take a look at the weekend, unless Shrini has time before then?&lt;/p&gt;</comment>
                            <comment id="12832532" author="shreeneewas" created="Thu, 11 Feb 2010 15:45:16 +0000"  >&lt;p&gt;Thanks everyone for comments. &lt;/p&gt;

&lt;p&gt;Chris, I would like to look into it.  But considering this being my first patch, I can not promise on time line. &lt;/p&gt;</comment>
                            <comment id="12832535" author="brindy" created="Thu, 11 Feb 2010 15:50:11 +0000"  >&lt;p&gt;That&apos;s fine, I&apos;ll leave it for you to look at then, but let us know if you don&apos;t think you&apos;re going to be able to do it. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12832825" author="rickhall" created="Fri, 12 Feb 2010 03:38:37 +0000"  >&lt;p&gt;I think this is more complicated than it sounds.&lt;/p&gt;

&lt;p&gt;I think File Install will automatically start all bundles in a directory after it installs them. If fragments are coming from a separate directory and File Install deploys them after the host bundles, then it is too late to attach the fragments since the hosts have already been installed. However, if you can somehow guarantee that File Install processes the fragment directory before the host directory (I don&apos;t think this is possible), then it would work.&lt;/p&gt;

&lt;p&gt;You may or may not notice this working in Equinox, because it supports dynamic attachment of fragments, but even it (from what I understand) will only dynamically attach fragments to a resolved host if the fragments do not import nor export anything. This is an under specified area of the spec and relying on any details is likely to leave your bundles implementation specific.&lt;/p&gt;

&lt;p&gt;The only platform-neutral way is to modify File Install to deploy the fragment directory before the host directory and perform a refresh on all hosts.&lt;/p&gt;</comment>
                            <comment id="12832899" author="brindy" created="Fri, 12 Feb 2010 09:01:29 +0000"  >&lt;p&gt;I&apos;ve been manually calling &apos;update&apos; on the host bundle and that sorts it out.  Though while that works for me I suppose it could cause problems for other people?&lt;/p&gt;</comment>
                            <comment id="12832907" author="rickhall" created="Fri, 12 Feb 2010 09:13:51 +0000"  >&lt;p&gt;Yeah, I think you can manually refresh the host too, without updating it and that should work too...that is what I was also saying in my suggestion for a &quot;platform-neutral&quot; approach.&lt;/p&gt;</comment>
                            <comment id="12832923" author="shreeneewas" created="Fri, 12 Feb 2010 10:08:11 +0000"  >&lt;p&gt;I agree with Richard that this is not a straight forward fix.&lt;/p&gt;

&lt;p&gt;&quot;The only platform-neutral way is to modify File Install to deploy the fragment directory before the host directory and perform a refresh on all hosts.&quot;&lt;br/&gt;
But I think above proposal assumes that all fragments are dpeloyed in same directory which may not be a case. &lt;/p&gt;

&lt;p&gt;I was thinking of following option:&lt;/p&gt;

&lt;p&gt;After every scan, if one or more (non-fragment) bundles have been installed, then call packageadmin.resolve(null). As per the javadoc call to this method with &quot;null&quot; means that framework will resolve all the unresolved bundles. This wil ensure that all unresolved fragments can get resolved.&lt;/p&gt;

&lt;p&gt;This should be done before starting these new bundles to ensure that fragment bundles are attached to their host.&lt;/p&gt;

&lt;p&gt;Any comments? &lt;/p&gt;</comment>
                            <comment id="12833291" author="rickhall" created="Sat, 13 Feb 2010 02:31:36 +0000"  >&lt;p&gt;Yes, I agree, that is the way. You could obviously make it smarter by parsing the Fragment-Host header and only refreshing the corresponding hosts.&lt;/p&gt;</comment>
                            <comment id="12837236" author="shreeneewas" created="Tue, 23 Feb 2010 13:43:04 +0000"  >&lt;p&gt;Just a FYI who is waiting for this fix. .... I am really held up over weekends in few high priority domestic things. &lt;/p&gt;

&lt;p&gt;Sorry about this but it seems I wont be able to look into this issue for next few weeks atleast.&lt;/p&gt;

&lt;p&gt;I will submit my patch once I get free unless someone else had placed it before me.&lt;/p&gt;



</comment>
                            <comment id="12844963" author="shreeneewas" created="Sat, 13 Mar 2010 20:41:58 +0000"  >&lt;p&gt;This is the patch I would like to submit for the fix. &lt;/p&gt;

</comment>
                            <comment id="12844964" author="shreeneewas" created="Sat, 13 Mar 2010 20:47:12 +0000"  >&lt;p&gt;At the moment, this fix invokes the &quot;resolveAll()&quot; of package admin service. This will be applied on all the unresolved bundles. &lt;/p&gt;

&lt;p&gt;I don&apos;t see any compelling reason to identify unresolved fragment bundles for calling resolve method on their host as Richard suggested. As package admin does that for you.&lt;/p&gt;

&lt;p&gt;Please let me know your comments.&lt;/p&gt;
</comment>
                            <comment id="12845786" author="gnt" created="Tue, 16 Mar 2010 09:59:02 +0000"  >&lt;p&gt;I don&apos;t think calling resolve(null) is a good idea.  Fileinstall should not have any effect on bundles that are not managed by fileinstall, so we need to compute the exact list of bundles that need to be resolved (same as the ones to start ?) and only resolve those.&lt;/p&gt;

&lt;p&gt;In addition, fileinstall has the feature to not resolve / start bundles at all if the property felix.fileinstall.bundles.new.start is set to false.  We should keep this behavior, or maybe add a new property named felix.fileinstall.bundles.new.resolve, so that people can configure fileinstall to only resolve the bundles correctly but not start them.&lt;/p&gt;</comment>
                            <comment id="12846017" author="shreeneewas" created="Tue, 16 Mar 2010 17:34:04 +0000"  >&lt;p&gt;I can see that submitted patch clearly misses to address above use case.&lt;/p&gt;


&lt;p&gt;&quot;so we need to compute the exact list of bundles that need to be resolved (same as the ones to start ?) and only resolve those.&quot;&lt;br/&gt;
To refine above point - we should compute all those unresolved bundles handled by file install.&lt;/p&gt;

&lt;p&gt;But I believe property &quot;felix.fileinstall.bundles.new.start&quot; affects only the startup action and not the resolve action. So in other words, file install always tries to resolve a bundle but the decision of starting it is driven by above mentioned flag. &lt;/p&gt;

&lt;p&gt;Do you think I got this right?&lt;/p&gt;

</comment>
                            <comment id="12846019" author="gnt" created="Tue, 16 Mar 2010 17:40:37 +0000"  >&lt;p&gt;Not completely.  Fileinstall does not try to &quot;resolve only&quot; any bundles at all.  Bundles are resolved only has a consequence of fileinstall starting them.  As fragments can&apos;t be started, fileinstall ignore those and they stay in the installed state.&lt;/p&gt;</comment>
                            <comment id="13068777" author="gfremex" created="Thu, 21 Jul 2011 03:12:40 +0000"  >&lt;p&gt;It&apos;s a long time since this bug has been reported.&lt;/p&gt;

&lt;p&gt;We have to deploy fragment bundles. Everything is ok except the fragment bundles may not be attached to their host bundles.&lt;/p&gt;

&lt;p&gt;Sometimes the attaching succeeded. Sometimes it failed.&lt;/p&gt;

&lt;p&gt;Can anyone fix this bug?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12438708" name="FELIX-2066.patch" size="1502" author="shreeneewas" created="Sat, 13 Mar 2010 20:41:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56664</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 18 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i07gr3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>41480</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>