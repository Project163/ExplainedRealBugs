<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:21:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-2318] Possible NPE for jars with null Manifest</title>
                <link>https://issues.apache.org/jira/browse/FELIX-2318</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;JarFile.getManifest() can return null, so caller must check return value for null-ness to avoid NPE. I see two such occurrences in fileinstall:&lt;/p&gt;

&lt;p&gt;DirectoryWatcher.java:&lt;br/&gt;
    private Bundle installOrUpdateBundle(&lt;br/&gt;
        String bundleLocation, BufferedInputStream is, long checksum)&lt;br/&gt;
        throws IOException, BundleException&lt;br/&gt;
    {&lt;br/&gt;
        is.mark(256 * 1024);&lt;br/&gt;
        JarInputStream jar = new JarInputStream(is);&lt;br/&gt;
        Manifest m = jar.getManifest();&lt;br/&gt;
        String sn = m.getMainAttributes().getValue(Constants.BUNDLE_SYMBOLICNAME);&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;BundleTransformer.java:&lt;br/&gt;
            Manifest m = jar.getManifest();&lt;br/&gt;
            if (m.getMainAttributes().getValue(new Attributes.Name(&quot;Bundle-SymbolicName&quot;)) != null)&lt;br/&gt;
            ...&lt;/p&gt;</description>
                <environment></environment>
        <key id="12463560">FELIX-2318</key>
            <summary>Possible NPE for jars with null Manifest</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gnodet">Guillaume Nodet</assignee>
                                    <reporter username="sahoo">Sanjeeb Kumar Sahoo</reporter>
                        <labels>
                    </labels>
                <created>Mon, 3 May 2010 14:23:12 +0000</created>
                <updated>Tue, 16 May 2017 08:41:20 +0000</updated>
                            <resolved>Tue, 26 Oct 2010 07:02:47 +0000</resolved>
                                                    <fixVersion>fileinstall-3.1.0</fixVersion>
                                    <component>File Install</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12863839" author="nlmarco" created="Tue, 4 May 2010 15:19:27 +0000"  >&lt;p&gt;Yesterday, I stumbled exactly over this NPE, which was not very developer friendly and forced me to dig quite deep into it (decompiling &amp;amp; debugging).&lt;/p&gt;

&lt;p&gt;I&apos;m not sure whether I can agree to Sahoo&apos;s suggestion to return a value in this case. I mean, if there is no proper MANIFEST, it is not a valid OSGi bundle and thus the method installOrUpdateBundle(...) cannot really return anything meaningful. Or am I overlooking anything?&lt;/p&gt;

&lt;p&gt;Anyway, for me (and everyone else not being aware of the MANIFEST.MF being required at the very beginning of the JAR) a simple exception with a precise error message would have been most helpful. I therefore recommend to simply add sth. like this:&lt;/p&gt;

&lt;p&gt;if (m == null)&lt;br/&gt;
  throw new BundleException(&lt;br/&gt;
    String.format(&lt;br/&gt;
      &quot;The bundle %s does not have a META-INF/MANIFEST.MF! &quot;+&lt;br/&gt;
      &quot;Make sure, META-INF and MANIFEST.MF are the first 2 entries in your JAR!&quot;,&lt;br/&gt;
      bundleLocation&lt;br/&gt;
    )&lt;br/&gt;
  );&lt;/p&gt;</comment>
                            <comment id="12924866" author="gnt" created="Tue, 26 Oct 2010 07:02:47 +0000"  >&lt;p&gt;Committing to &lt;a href=&quot;https://svn.apache.org/repos/asf/felix/trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/repos/asf/felix/trunk&lt;/a&gt; ...&lt;br/&gt;
	M	fileinstall/src/main/java/org/apache/felix/fileinstall/internal/BundleTransformer.java&lt;br/&gt;
	M	fileinstall/src/main/java/org/apache/felix/fileinstall/internal/DirectoryWatcher.java&lt;br/&gt;
Committed r1027387&lt;/p&gt;</comment>
                            <comment id="16011661" author="andy.wu" created="Tue, 16 May 2017 02:46:31 +0000"  >&lt;p&gt;I have a question about this , I didn&apos;t find the limit of META-INF/MANIFEST.MF must be the first file in the jar  , but java.util.jar.JarInputStream in jdk seems to make such assumption, but java.util.jar.JarFile can get MANIFEST.MF even if it is not the first file , so felix could use this class to get manifest information to avoid NPE. What do you think about this ? please let me know. thanks.&lt;/p&gt;</comment>
                            <comment id="16011848" author="gnt" created="Tue, 16 May 2017 06:56:13 +0000"  >&lt;p&gt;In this case, having to use JarInputStream would force the use of an intermediary file to copy the content of the input stream so that it can be opened using a JarFile.  Supporting that correctly might be doable in a proper way though, and if you&apos;re willing to provide a patch, please raise a new issue and attach a patch or PR, I&apos;d be happy to help reviewing it.&lt;/p&gt;</comment>
                            <comment id="16011998" author="andy.wu" created="Tue, 16 May 2017 08:41:20 +0000"  >&lt;p&gt;thanks for your response , I will send a pr to github.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40506</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 27 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0aq5j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>60510</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>