<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:53:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-4436] DirectoryWatcher should not refresh transformed bundles on every start-up</title>
                <link>https://issues.apache.org/jira/browse/FELIX-4436</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;DirectoryWatcher can auto-deploy JAR or XML files placed in a directory.&lt;br/&gt;
Blueprint XML files (containing for instance ActiveMQ factories or JAAS realms) are detected as &quot;installed&quot; on every start-up.  Prior to &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-2066&quot; title=&quot;File Install fails to move fragment bundle into RESOLVED state&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-2066&quot;&gt;&lt;del&gt;FELIX-2066&lt;/del&gt;&lt;/a&gt;, this had no effect.  Since &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-2066&quot; title=&quot;File Install fails to move fragment bundle into RESOLVED state&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-2066&quot;&gt;&lt;del&gt;FELIX-2066&lt;/del&gt;&lt;/a&gt;, bundles detected as &quot;installed&quot; are now forcibly &quot;refreshed&quot; on every start-up.  The impact is that these bundles are stopped and restarted during the container start-up.  Because there are some race conditions (see &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-3067&quot; title=&quot;Prevent Deadlock Situation in Felix.acquireGlobalLock&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-3067&quot;&gt;FELIX-3067&lt;/a&gt;), this can prevent those XML files or other bundles depending on them from fully starting.  Here is a patch which avoids restarting those bundles when they were not modified.&lt;/p&gt;</description>
                <environment>ServiceMix 4.5.3</environment>
        <key id="12697369">FELIX-4436</key>
            <summary>DirectoryWatcher should not refresh transformed bundles on every start-up</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gnodet">Guillaume Nodet</assignee>
                                    <reporter username="metatech">metatech</reporter>
                        <labels>
                    </labels>
                <created>Wed, 26 Feb 2014 14:02:13 +0000</created>
                <updated>Tue, 17 Mar 2015 06:55:18 +0000</updated>
                            <resolved>Tue, 8 Apr 2014 14:01:08 +0000</resolved>
                                    <version>fileinstall-3.2.4</version>
                                    <fixVersion>fileinstall-3.4.0</fixVersion>
                                    <component>File Install</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13919641" author="barthel" created="Tue, 4 Mar 2014 17:14:31 +0000"  >&lt;p&gt;I think the provided patch does not solve the real problem.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;Explanationofmyunderstanding&quot;&gt;&lt;/a&gt;Explanation of my understanding&lt;/h4&gt;

&lt;p&gt;The blueprint deployer extending the &lt;tt&gt;ArtifactUrlTransformer&lt;/tt&gt; and create a new bundle (JAR) based on passed blueprint XML file. This bundle goes the normal way and will be installed. The bundle location is a opaque URI like:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;blueprint:file:/tmp/fileinstall/deploy/blueprint.xml
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The real problem, as I understand it, is located deep in the &lt;tt&gt;#initializeCurrentManagedBundles()&lt;/tt&gt; method.&lt;/p&gt;

&lt;p&gt;If the &lt;tt&gt;DirectoryWatcher&lt;/tt&gt; starts to work, the &lt;tt&gt;#initializeCurrentManagedBundles()&lt;/tt&gt; will be executed and analysed the installed artifacts:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;get all installed bundles&lt;/li&gt;
	&lt;li&gt;interate over all bundles and get the bundle location&lt;/li&gt;
	&lt;li&gt;create normalized &lt;tt&gt;URI&lt;/tt&gt; based on bundle location&lt;/li&gt;
	&lt;li&gt;check &lt;tt&gt;URI#getPath()&lt;/tt&gt;
	&lt;ol&gt;
		&lt;li&gt;if path is &lt;tt&gt;null&lt;/tt&gt; or path doesn&apos;t starts with the configured watch directory
		&lt;ul&gt;
			&lt;li&gt;continue &lt;b&gt;without&lt;/b&gt; create &lt;tt&gt;Artifact&lt;/tt&gt; object for the installed bundle/&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
		&lt;li&gt;otherwise
		&lt;ul&gt;
			&lt;li&gt;create &lt;tt&gt;Artifact&lt;/tt&gt; object and add to global &lt;tt&gt;currentManagedArtifacts&lt;/tt&gt; via &lt;tt&gt;#setArtifact(...)&lt;/tt&gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;After all the &lt;tt&gt;#process(...)&lt;/tt&gt; method will be execute (this is the method where the provided patch is located).&lt;br/&gt;
This method iterate also over the files and tried to get a &lt;tt&gt;Artifact&lt;/tt&gt; object for the passed file.&lt;/p&gt;

&lt;p&gt;In the described case no &lt;tt&gt;Artifact&lt;/tt&gt; object will be found for the blueprint XML file and the way goes to the &lt;tt&gt;// File has been added&lt;/tt&gt;-&lt;em&gt;else&lt;/em&gt; part of the big &lt;em&gt;if-else&lt;/em&gt; statement.&lt;br/&gt;
At this point a new &lt;tt&gt;Artifact&lt;/tt&gt; object will be created and added to the &lt;tt&gt;created&lt;/tt&gt;-List.&lt;br/&gt;
The content of the &lt;tt&gt;created&lt;/tt&gt;-List will be installed or updated via &lt;tt&gt;#install(...)&lt;/tt&gt; and the returned &lt;tt&gt;Bundle&lt;/tt&gt; objects goes directly into the &lt;tt&gt;toRefresh&lt;/tt&gt;-Set.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;Possiblesolution&quot;&gt;&lt;/a&gt;Possible solution&lt;/h4&gt;
&lt;p&gt;Try to handle opaque &lt;tt&gt;URI&lt;/tt&gt; at the point &lt;em&gt;4.1&lt;/em&gt;.&lt;/p&gt;
</comment>
                            <comment id="13920581" author="githubbot" created="Wed, 5 Mar 2014 06:39:42 +0000"  >&lt;p&gt;GitHub user barthel opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/3&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-4436&quot; title=&quot;DirectoryWatcher should not refresh transformed bundles on every start-up&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-4436&quot;&gt;&lt;del&gt;FELIX-4436&lt;/del&gt;&lt;/a&gt; handle bundle if bundle location is a opaque uri&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/barthel/felix&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/barthel/felix&lt;/a&gt; trunk&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/3.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/3.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #3&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 008c1c43aca0b8d10f54f6eb1bf55854128e1614&lt;br/&gt;
Author: Uwe Barthel &amp;lt;barthel@x-reizend.de&amp;gt;&lt;br/&gt;
Date:   2014-03-05T06:34:52Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-4436&quot; title=&quot;DirectoryWatcher should not refresh transformed bundles on every start-up&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-4436&quot;&gt;&lt;del&gt;FELIX-4436&lt;/del&gt;&lt;/a&gt; handle bundle if bundle location is a opaque uri&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="13933306" author="metatech" created="Thu, 13 Mar 2014 14:26:29 +0000"  >&lt;p&gt;Hi Uwe,&lt;br/&gt;
Thanks for looking into this issue.&lt;br/&gt;
I tried your patch but it does not change my observations : on every start-up, the Blueprint XML are still refreshed.&lt;br/&gt;
To be honest, I do not understand how your patch is supposed to solve the problem, could you please elaborate ?&lt;br/&gt;
Also, I notice that on Windows, the path extraction algorithm does not work, because there is an extra colon in the path, eg C:/&lt;br/&gt;
Regards,&lt;br/&gt;
metatech&lt;/p&gt;</comment>
                            <comment id="13934319" author="githubbot" created="Thu, 13 Mar 2014 23:58:08 +0000"  >&lt;p&gt;Github user barthel closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/3&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13934320" author="barthel" created="Thu, 13 Mar 2014 23:58:21 +0000"  >&lt;p&gt;Hi metatech,&lt;/p&gt;

&lt;p&gt;Thx for review my patch.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;To be honest, I do not understand how your patch is supposed to solve the problem, could you please elaborate ?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The idea behind my patch is to prevent to put the bundle into the &lt;tt&gt;installedBundles&lt;/tt&gt; collection. This collection will be added into the &lt;tt&gt;toRefresh&lt;/tt&gt; set, which you comment out in your patch.&lt;/p&gt;

&lt;p&gt;If you&apos;re going the way back, you&apos;ll find a long if-else statement. In this if-else statement, it&apos;s about if the file exists and whether an &lt;tt&gt;Artifact&lt;/tt&gt; object exists.&lt;/p&gt;

&lt;p&gt;If this &lt;tt&gt;Artifact&lt;/tt&gt; object is not found, it is newly created and inserted into the &lt;tt&gt;toRefresh&lt;/tt&gt; set.&lt;/p&gt;

&lt;p&gt;A list of all known &lt;tt&gt;Artifact&lt;/tt&gt; objects is collected at startup in the method &lt;tt&gt;#initializeCurrentManagedBundles()&lt;/tt&gt;. Creating the &lt;tt&gt;Artifact&lt;/tt&gt; object for the Blueprint XML file based on the path of the found file and the Bundle Location of the already known bundles.&lt;/p&gt;

&lt;p&gt;I hope this and my explanation above, have explained my thought better.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Also, I notice that on Windows, the path extraction algorithm does not work, because there is an extra colon in the path, eg C:/&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;You&apos;re absolutely right. My solution is not optimal at this point. Perhaps it is better to search &lt;tt&gt;file:&lt;/tt&gt;, instead of the last colon. This could be the reason why it does not work for you.&lt;/p&gt;

&lt;p&gt;I&apos;ve change the implementation. Please try it again.&lt;br/&gt;
Did you run the &lt;tt&gt;DirectoryWatcherTest&lt;/tt&gt; test?&lt;/p&gt;

&lt;p&gt;Sincerely&lt;br/&gt;
barthel&lt;/p&gt;</comment>
                            <comment id="13934322" author="githubbot" created="Fri, 14 Mar 2014 00:00:47 +0000"  >&lt;p&gt;GitHub user barthel opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/4&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Possible fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-4436&quot; title=&quot;DirectoryWatcher should not refresh transformed bundles on every start-up&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-4436&quot;&gt;&lt;del&gt;FELIX-4436&lt;/del&gt;&lt;/a&gt;  &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-4436&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/FELIX-4436&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;handle bundle if bundle location is a opaque uri&lt;/li&gt;
	&lt;li&gt;use &apos;file:&apos; instead of last index of colon for extract the path name from opaque uri&lt;/li&gt;
	&lt;li&gt;test added&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/barthel/felix&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/barthel/felix&lt;/a&gt; trunk&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/4.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/4.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #4&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 008c1c43aca0b8d10f54f6eb1bf55854128e1614&lt;br/&gt;
Author: Uwe Barthel &amp;lt;barthel@x-reizend.de&amp;gt;&lt;br/&gt;
Date:   2014-03-05T06:34:52Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-4436&quot; title=&quot;DirectoryWatcher should not refresh transformed bundles on every start-up&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-4436&quot;&gt;&lt;del&gt;FELIX-4436&lt;/del&gt;&lt;/a&gt; handle bundle if bundle location is a opaque uri&lt;/p&gt;

&lt;p&gt;commit b623ec0a2a607c4f8baa827660ba32bfdfccf09d&lt;br/&gt;
Author: Uwe Barthel &amp;lt;barthel@x-reizend.de&amp;gt;&lt;br/&gt;
Date:   2014-03-13T23:52:55Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-4436&quot; title=&quot;DirectoryWatcher should not refresh transformed bundles on every start-up&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-4436&quot;&gt;&lt;del&gt;FELIX-4436&lt;/del&gt;&lt;/a&gt; handle bundle if bundle location is a opaque uri&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;use &apos;file:&apos; instead of last index of colon for extract the path name from opaque uri&lt;/li&gt;
	&lt;li&gt;test added&lt;/li&gt;
&lt;/ul&gt;


&lt;hr /&gt;</comment>
                            <comment id="13934785" author="metatech" created="Fri, 14 Mar 2014 08:51:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=barthel&quot; class=&quot;user-hover&quot; rel=&quot;barthel&quot;&gt;barthel&lt;/a&gt; : your pull #4 is the same as #3&lt;/p&gt;</comment>
                            <comment id="13934813" author="barthel" created="Fri, 14 Mar 2014 09:35:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=metatech&quot; class=&quot;user-hover&quot; rel=&quot;metatech&quot;&gt;metatech&lt;/a&gt;: the patch (pull req. #4) contains the commits of #3 and two new commits. If it is the &apos;felix&apos; way, so may I provide a patch file instead of git pull requests?&lt;/p&gt;</comment>
                            <comment id="13934910" author="metatech" created="Fri, 14 Mar 2014 11:55:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=barthel&quot; class=&quot;user-hover&quot; rel=&quot;barthel&quot;&gt;barthel&lt;/a&gt; Sorry, I do not use Github, so I downloaded the patch manually and only looked at the beginning and did not see the other changes. I will give it a try.&lt;/p&gt;</comment>
                            <comment id="13939297" author="barthel" created="Tue, 18 Mar 2014 14:47:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=metatech&quot; class=&quot;user-hover&quot; rel=&quot;metatech&quot;&gt;metatech&lt;/a&gt; Have you had time for a test? &lt;br/&gt;
In my test setup the patch works on Linux.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;g! lb
START LEVEL 1
   ID|State      |Level|Name
    0|Active     |    0|&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt; Bundle (4.2.1)
    1|Active     |    1|HSQLDB (2.2.4)
    2|Active     |    1|Apache Aries Blueprint Bundle (1.1.0)
    3|Active     |    1|Apache Aries Proxy Bundle (1.0.0)
    4|Active     |    1|Apache Aries Util (1.0.0)
    5|Active     |    1|Apache Felix Bundle Repository (1.6.6)
    6|Active     |    1|Apache Felix Configuration Admin Service (1.8.0)
    7|Active     |    1|Apache Felix File Install (3.3.0.SNAPSHOT)
    8|Active     |    1|Apache Felix Gogo Command (0.12.0)
    9|Active     |    1|Apache Felix Gogo &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; (0.10.0)
   10|Active     |    1|Apache Felix Gogo Shell (0.10.0)
   11|Active     |    1|Apache Karaf :: Deployer :: Blueprint (2.2.8)
   12|Active     |    1|OPS4J Pax Logging - API (1.6.7)
   13|Active     |    1|OPS4J Pax Logging - Service (1.6.7)
   14|Active     |    1|datasource-hsqldb.xml (0.0.0)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;tt&gt;datasource-hsqldb.xml&lt;/tt&gt; is the Blueprint XML file deployed in &lt;tt&gt;./load&lt;/tt&gt;. After a restart the bundle was found and not refreshed/reinstalled anymore. If I touch the file, the bundle will be refreshed.&lt;/p&gt;</comment>
                            <comment id="13939546" author="gnt" created="Tue, 18 Mar 2014 17:54:48 +0000"  >&lt;p&gt;I&apos;ve committed a slightly improved patch which also supports the Karaf wrap url handler which may add $xxx stuff after the file path.&lt;br/&gt;
Thx for the work Uwe !&lt;/p&gt;

&lt;p&gt;Committing to &lt;a href=&quot;https://svn.apache.org/repos/asf/felix/trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/repos/asf/felix/trunk&lt;/a&gt; ...&lt;br/&gt;
	M	fileinstall/src/main/java/org/apache/felix/fileinstall/internal/DirectoryWatcher.java&lt;br/&gt;
	M	fileinstall/src/test/java/org/apache/felix/fileinstall/internal/DirectoryWatcherTest.java&lt;br/&gt;
Committed r1578984&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://svn.apache.org/viewvc?view=revision&amp;amp;revision=1578984&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/viewvc?view=revision&amp;amp;revision=1578984&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13939752" author="barthel" created="Tue, 18 Mar 2014 20:41:37 +0000"  >&lt;p&gt;Should I write a test for your improvement?&lt;/p&gt;</comment>
                            <comment id="13939756" author="gnt" created="Tue, 18 Mar 2014 20:44:44 +0000"  >&lt;p&gt;I actually modified the testInitializeCurrentManagedBundlesOpaqueURIOnBundleLocation to make sure this is tested.&lt;/p&gt;</comment>
                            <comment id="13939758" author="githubbot" created="Tue, 18 Mar 2014 20:45:21 +0000"  >&lt;p&gt;Github user barthel closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/4&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13940448" author="metatech" created="Wed, 19 Mar 2014 13:06:50 +0000"  >&lt;p&gt;I tested using Guillaume&apos;s commit version.&lt;br/&gt;
Indeed the Blueprint XML are not detected anymore as &quot;installed&quot; on every start-up.&lt;br/&gt;
However, I see now that the &quot;activemq-broker.xml&quot; gets restarted during start-up, which generates many errors in depending bundles.&lt;br/&gt;
I also see that the &quot;cfg&quot; files in the &quot;etc&quot; directory are still detected as &quot;installed&quot; on every start-up, although this does not seem to cause any harm.&lt;/p&gt;

&lt;p&gt;Below is the stack trace when the &quot;activemq-broker.xml&quot; is stopped during start-up, if it can help.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;fileinstall-C:\smx\servicemix/etc&quot;&lt;/span&gt; daemon prio=6 tid=0x000000000a18e000 nid=0x1210 at breakpoint[0x000000000bfbf000]
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: RUNNABLE
        at org.apache.felix.framework.Felix.stopBundle(Felix.java:2217)
        at org.apache.felix.framework.BundleImpl.stop(BundleImpl.java:963)
        at org.apache.felix.fileinstall.internal.DirectoryWatcher.stopTransient(DirectoryWatcher.java:1214)
        at org.apache.felix.fileinstall.internal.DirectoryWatcher.update(DirectoryWatcher.java:1156)
        at org.apache.felix.fileinstall.internal.DirectoryWatcher.update(DirectoryWatcher.java:935)
        at org.apache.felix.fileinstall.internal.DirectoryWatcher.process(DirectoryWatcher.java:498)
        at org.apache.felix.fileinstall.internal.DirectoryWatcher.run(DirectoryWatcher.java:308)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="13940674" author="gnt" created="Wed, 19 Mar 2014 16:55:28 +0000"  >&lt;p&gt;Reopening to check the activemq xml config&lt;/p&gt;</comment>
                            <comment id="13940952" author="barthel" created="Wed, 19 Mar 2014 20:39:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=metatech&quot; class=&quot;user-hover&quot; rel=&quot;metatech&quot;&gt;metatech&lt;/a&gt; Oh, that isn&apos;t cool.&lt;br/&gt;
Please provide information about your framework and setup.&lt;br/&gt;
Debug log information are helpful too.&lt;br/&gt;
Is it possible that you provide the bundle cache content for that file ?&lt;br/&gt;
It sounds like a failure in scanner on calculate the checksum or something else in this context.&lt;/p&gt;

&lt;p&gt;Under Linux with a minimal Felix setup I have not noticed this behavior.&lt;/p&gt;

&lt;p&gt;Please retry with a clear bundle cache.&lt;/p&gt;</comment>
                            <comment id="13941648" author="metatech" created="Thu, 20 Mar 2014 11:53:38 +0000"  >&lt;p&gt;The restart of the activemq-broker.xml bundle seems to be caused by the fact that there are 2 DirectoryWatcher for this file : &lt;br/&gt;
1. the normal one for &quot;/etc/*&quot;.&lt;br/&gt;
2. the specific &quot;org.apache.felix.fileinstall-activemq.cfg&quot; for &quot;etc/activemq-broker.xml&quot;.&lt;br/&gt;
When deleting the &quot;org.apache.felix.fileinstall-activemq.cfg&quot;, the bundle is not restarted anymore at start-up.&lt;br/&gt;
Strangely, in the previous version, this unusual configuration was working fine.&lt;/p&gt;</comment>
                            <comment id="13941654" author="metatech" created="Thu, 20 Mar 2014 12:05:08 +0000"  >&lt;p&gt;I emphasize that this double DirectoryWatcher is configured this way &quot;out of the box&quot; with ServiceMix.&lt;/p&gt;</comment>
                            <comment id="13943459" author="barthel" created="Fri, 21 Mar 2014 19:47:02 +0000"  >&lt;p&gt;The two processes monitor the same directory?&lt;br/&gt;
I have not check until now if both watcher processes are working on the same file.&lt;br/&gt;
For me It is a new BUG.&lt;/p&gt;</comment>
                            <comment id="13963002" author="gnt" created="Tue, 8 Apr 2014 14:01:08 +0000"  >&lt;p&gt;Committing to &lt;a href=&quot;https://svn.apache.org/repos/asf/felix/trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/repos/asf/felix/trunk&lt;/a&gt; ...&lt;br/&gt;
	M	fileinstall/src/main/java/org/apache/felix/fileinstall/internal/DirectoryWatcher.java&lt;br/&gt;
Committed r1585732&lt;/p&gt;</comment>
                            <comment id="13967441" author="barthel" created="Sat, 12 Apr 2014 08:22:37 +0000"  >&lt;p&gt;For use with Karaf this BUG has not Minor priority. It is a Major in my oppinion.&lt;br/&gt;
It would be great integrate this fix into &quot;fileinstall-3.2.x&quot; for integrating in Karaf 2.3.x and Karaf 3.0.x.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12660794">KARAF-2420</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12528942">SMX4-956</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12631228" name="felix_no_refresh_installed.patch" size="670" author="metatech" created="Wed, 26 Feb 2014 14:03:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>375843</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 32 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1srkv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>376139</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>