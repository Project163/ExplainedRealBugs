<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:15:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-1851] FileInstall watched bundles are restarted twice upon update</title>
                <link>https://issues.apache.org/jira/browse/FELIX-1851</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;I am observing that bundles watched by fileinstall (1.2.0) are getting stopped &amp;amp; subsequently started twice when they are updated. First time, they are stopped and started by a call to update() and then because of a call to refreshPackages(). The scenario where this is happening is given below:&lt;/p&gt;

&lt;p&gt;bundle A exports package p and is tracking service of type p.Foo.&lt;br/&gt;
bundle B imports a package p from A. It exports a service object with the service interface p.Foo.&lt;/p&gt;

&lt;p&gt;I am updating bundle A and it is getting stopped and started twice.&lt;/p&gt;

&lt;p&gt;The explanation given to me (thanks to Richard) is that:&lt;/p&gt;

&lt;p&gt;&quot;The update operation is defined as first stopping a bundle and restarting it after the update. This is once.&lt;/p&gt;

&lt;p&gt;Since an updated bundle is not really updated until it is refreshed, when you refresh, bundle A&apos;s update is finalized by being refreshed, which causes it to stop and restart. This is twice. &lt;br/&gt;
...&lt;br/&gt;
If bundle A was not being used, Felix would optimize this and do the refresh as part of the update, so it would only happen once.&lt;/p&gt;

&lt;p&gt;If File Install always refreshes after an update, it would be better to change it to first stop all bundles being updated, then update all bundles, then refresh, then restart all updated bundles. This way they would only stop/restart once.&quot;&lt;/p&gt;

&lt;p&gt;I am not sure if the behavior has changed in newer version of fileinstall or not. If not, this will be a good change to make.&lt;/p&gt;

</description>
                <environment>generic</environment>
        <key id="12439961">FELIX-1851</key>
            <summary>FileInstall watched bundles are restarted twice upon update</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gnodet">Guillaume Nodet</assignee>
                                    <reporter username="sahoo">Sanjeeb Kumar Sahoo</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 Nov 2009 18:16:03 +0000</created>
                <updated>Wed, 24 Apr 2013 13:03:54 +0000</updated>
                            <resolved>Wed, 16 Dec 2009 12:16:48 +0000</resolved>
                                    <version>fileinstall-1.2.0</version>
                                    <fixVersion>fileinstall-2.0.8</fixVersion>
                                    <component>File Install</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12791343" author="gnt" created="Wed, 16 Dec 2009 12:16:48 +0000"  >&lt;p&gt;Sending        fileinstall/pom.xml&lt;br/&gt;
Sending        fileinstall/src/main/java/org/apache/felix/fileinstall/internal/DirectoryWatcher.java&lt;br/&gt;
Transmitting file data ..&lt;br/&gt;
Committed revision 891210.&lt;/p&gt;</comment>
                            <comment id="13640410" author="draier" created="Wed, 24 Apr 2013 13:03:18 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;The fix that has been submitted here only works when you have the &quot;felix.fileinstall.bundles.new.start&quot; set to true - when auto start is not used , I have exactly the same issue - bundle is restarted first by the framework, then by the refresh. &lt;br/&gt;
I did a patch to handle this case - can you confirm the patch is correct and can be included in a next release ?&lt;/p&gt;

&lt;p&gt;Regards,&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12580282" name="FELIX-1851.patch" size="2316" author="draier" created="Wed, 24 Apr 2013 13:03:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>57190</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 31 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0vuav:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>183882</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>