<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:48:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-3542] Escape property values used as Metatype default values</title>
                <link>https://issues.apache.org/jira/browse/FELIX-3542</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;For a component property defined as below:&lt;br/&gt;
~~~~~~~~~~~~&lt;br/&gt;
static private final String DEFAULT_FILE_PATTERN = &quot;(?i)index&lt;br class=&quot;atl-forced-newline&quot; /&gt;.html&quot;;&lt;/p&gt;

&lt;p&gt;@Property(value=DEFAULT_FILE_PATTERN)&lt;br/&gt;
static private final String PN_FILE_PATTERN = &quot;file.pattern&quot;; &lt;br/&gt;
~~~~~~~~~~~~&lt;/p&gt;

&lt;p&gt;The backslash gets eaten up in the felix web console. The default value should appear as (?i)index\.html but ends up looking like (?i)index.html. This regex has a different meaning than the one intended.&lt;/p&gt;

&lt;p&gt;The component gets the correct initial value. But things fail when you open the property editor and save without making any changes(because the editor loaded up with an incorrect default value). Note that the property values when saved from the property editor render correctly the next time the editor loads.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12560149">FELIX-3542</key>
            <summary>Escape property values used as Metatype default values</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cziegeler">Carsten Ziegeler</assignee>
                                    <reporter username="ankurpathela">Ankur Pathela</reporter>
                        <labels>
                    </labels>
                <created>Mon, 11 Jun 2012 10:38:16 +0000</created>
                <updated>Thu, 11 Jun 2015 14:30:58 +0000</updated>
                            <resolved>Tue, 23 Apr 2013 13:38:15 +0000</resolved>
                                    <version>maven-scr-plugin-1.11.0</version>
                    <version>scr ant task 1.5.0</version>
                    <version>scr generator 1.5.0</version>
                                    <fixVersion>maven-scr-plugin-1.12.0</fixVersion>
                    <fixVersion>scr ant task 1.6.0</fixVersion>
                    <fixVersion>scr generator 1.6.0</fixVersion>
                                    <component>SCR Tooling</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13620631" author="tripod" created="Wed, 3 Apr 2013 05:29:46 +0000"  >&lt;p&gt;debugging shows that the webconsole is doing everything ok. the problem is that the org.osgi.service.metatype.AttributeDefinition retrieved from the org.osgi.service.metatype.ObjectClassDefinition already has the wrong default values.&lt;/p&gt;</comment>
                            <comment id="13620715" author="fmeschbe" created="Wed, 3 Apr 2013 08:14:48 +0000"  >&lt;p&gt;The problem is, that we need double escaping: Once for Java and once for the Metatype attribute&apos;s default value.&lt;/p&gt;

&lt;p&gt;So the actual property definition in your case must be:&lt;/p&gt;

&lt;p&gt;    static private final String DEFAULT_FILE_PATTERN = &quot;(?i)index\\\\.html&quot;;&lt;/p&gt;

&lt;p&gt;with 4 (four) backslash characters in Java to actually get 2 (two) characters in the XML file and thus finally get the single backslash in the default value from the Metatype service.&lt;/p&gt;

&lt;p&gt;Metatype service escaping is described in the JavaDoc of the AttributeDefinition.validate(String) method (or section 105.13.3.21 of the OSGi Enterprise R5 specification):&lt;/p&gt;

&lt;p&gt;    Commas ( &#8216;,&#8217; \u002C) and spaces (&#8216; &#8216; \u0020) and backslashes (&#8216;\&#8217; \u005C) can be escaped with&lt;br/&gt;
    another backslash. Escaped spaces must not be trimmed. For example:&lt;br/&gt;
          value=&#8221;  a\,b,b\,c,\ c&lt;br class=&quot;atl-forced-newline&quot; /&gt;,d   &#8220; =&amp;gt; [ &#8220;a,b&#8221;, &#8220;b,c&#8221;, &#8220; c\&#8221;, &#8220;d&#8221; ]&lt;/p&gt;

&lt;p&gt;Hence resolving this as not being a problem.&lt;/p&gt;</comment>
                            <comment id="13621245" author="tripod" created="Wed, 3 Apr 2013 19:34:42 +0000"  >&lt;p&gt;yes it is a problem.&lt;/p&gt;

&lt;p&gt;the properties passed in the &apos;activate&apos; method are identical to the ones specified in the annotation. so no double escaping needed. &lt;/p&gt;

&lt;p&gt;as ankur mentioned above: &lt;br/&gt;
&amp;gt; The component gets the correct initial value. But things fail when you open the property editor and save without making any changes&lt;/p&gt;</comment>
                            <comment id="13621985" author="fmeschbe" created="Thu, 4 Apr 2013 09:59:10 +0000"  >&lt;p&gt;Hmm, ok, I see.&lt;/p&gt;

&lt;p&gt;Ok, I think the SCR plugin should probably properly handle escaping: if a property value contains special characters requiring escaping in the Metatype Service, the SCR plugin should escape them when writing the metatype.xml file.&lt;/p&gt;

&lt;p&gt;That is the value of &lt;/p&gt;

&lt;p&gt;&amp;gt; @Property(value=&quot;sample&lt;br class=&quot;atl-forced-newline&quot; /&gt; value&quot;)&lt;/p&gt;

&lt;p&gt;should be written as &quot;sample\ value&quot; to the DS descriptor and &quot;sample&lt;br class=&quot;atl-forced-newline&quot; /&gt; value&quot; to the Metatype descriptor.&lt;/p&gt;</comment>
                            <comment id="13639052" author="cziegeler" created="Tue, 23 Apr 2013 13:38:15 +0000"  >&lt;p&gt;Fixed in 1470946 - the default value is now escaped according to the validate method&lt;/p&gt;</comment>
                            <comment id="13640271" author="tripod" created="Wed, 24 Apr 2013 09:17:48 +0000"  >&lt;p&gt;thank you. works for me.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12837148">FELIX-4919</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>307330</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 31 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1avkv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>271582</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>