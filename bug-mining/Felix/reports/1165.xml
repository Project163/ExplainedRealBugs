<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:21:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-2670] [Framework] Implicit boot delegation doesn&apos;t delegate for external code in all cases</title>
                <link>https://issues.apache.org/jira/browse/FELIX-2670</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;When determining if a class is not from a bundle in ModuleImpl.isClassNotLoadedFromBundle() (terrible method name, by the way), it attempts to ignore all framework classes by checking if the target class&apos; class loader is the same as the framework&apos;s class loader. This check is too broad since the framework&apos;s class loader is typically the app class loader, which means that any other code on the class path will not trigger implicit boot delegation.&lt;/p&gt;

&lt;p&gt;You could argue that implicit boot delegation was intended for JRE code and this is ok. However, just by changing the framework launcher to use a different class loader for the framework, you would get implicit boot delegation for code on the class path, so it seems odd that we trigger it under one situation but not another.&lt;/p&gt;

&lt;p&gt;Perhaps the simple solution is to not perform a class loader check, but to compare the package namespace (i.e., use org.apache.felix.framework to determine framework classes).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12477888">FELIX-2670</key>
            <summary>[Framework] Implicit boot delegation doesn&apos;t delegate for external code in all cases</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rickhall">Richard S. Hall</assignee>
                                    <reporter username="rickhall">Richard S. Hall</reporter>
                        <labels>
                    </labels>
                <created>Wed, 20 Oct 2010 17:24:15 +0000</created>
                <updated>Wed, 3 Nov 2010 20:41:15 +0000</updated>
                            <resolved>Mon, 25 Oct 2010 20:23:52 +0000</resolved>
                                    <version>framework-3.0.5</version>
                                    <fixVersion>framework-3.0.6</fixVersion>
                                    <component>Framework</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12923680" author="rickhall" created="Thu, 21 Oct 2010 22:51:51 +0000"  >&lt;p&gt;After some investigation and test case creation, I think the trigger for implicit boot delegation isn&apos;t completely correct. We are walking the stack to determine the ultimate originating class that triggered the entire class load request. In reality, I think we only want to find the first external class that called into the framework&apos;s class loading infrastructure.&lt;/p&gt;

&lt;p&gt;If the immediate trigger class was loaded by a bundle, then OSGi rules apply and there is no implicit boot delegation.&lt;/p&gt;

&lt;p&gt;If the immediate trigger class was loaded by an external class loader, then OSGi rules apply if Bundle.loadClass() is being called, but implicit boot delegation should occur if it is delegating to a module class loader.&lt;/p&gt;

&lt;p&gt;I am attaching a patch that implements this approach, it simplifies the implicit boot delegation logic quite a bit. Also, it passes all of the tests I&apos;ve created, although I still need to create a test for proxies. I will shortly apply this to trunk and then we should also try some real-world tests. If everything looks ok, then we will go back to addressing exceptional scenarios as they arise.&lt;/p&gt;

&lt;p&gt;I am particularly interested if Guillaume could test his scenario from &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-962&quot; title=&quot;Erroneous class loading delegation to the application launcher classloader in some cases&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-962&quot;&gt;&lt;del&gt;FELIX-962&lt;/del&gt;&lt;/a&gt; to make sure it still works with this patch, since this is where I think we started to make things too complicated.&lt;/p&gt;</comment>
                            <comment id="12924707" author="rickhall" created="Mon, 25 Oct 2010 20:23:52 +0000"  >&lt;p&gt;I&apos;ve applied a patch for this and have created several test cases for it that all pass. I also tested it against the scenario in &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-2653&quot; title=&quot;LinkageError caused by duplicate class definition during implicit boot delegation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-2653&quot;&gt;&lt;del&gt;FELIX-2653&lt;/del&gt;&lt;/a&gt;. Everything looks good, but it is possible that I&apos;m missing something. We&apos;ll just address any regressions as they are discovered.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12457799" name="FELIX-2670.txt" size="6549" author="rickhall" created="Thu, 21 Oct 2010 22:52:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40547</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 5 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0aqs7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>60612</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>