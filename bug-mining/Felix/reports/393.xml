<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:09:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-1130] Bundle.getHeaders() returns a Dictionary&lt;java.util.jar.Attribute.Name,String&gt;</title>
                <link>https://issues.apache.org/jira/browse/FELIX-1130</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;Bundle.getHeaders() returns a Dictionary whose key type is java.util.jar.Attribute.Name but the key type should be &lt;br/&gt;
java.lang.String. For some unknown reasons (I guess different implementations of equals() and hashCode()) this&lt;br/&gt;
causes no problems with SUN&apos;s JRE but a lot of trouble with IBM&apos;s JRE. Especially bundles that rely on bundle &lt;br/&gt;
headers (like for example Felix SCR) do not work on IBM&apos;s JRE due to this bug.&lt;/p&gt;

&lt;p&gt;The suspicious code is in the getManifestHeader() member of org.apache.felix.framework.cache.JarRevision and DirectoryRevision:&lt;/p&gt;

&lt;p&gt;            Manifest mf = jarFile.getManifest();&lt;br/&gt;
            // Create a case insensitive map of manifest attributes.&lt;br/&gt;
            return new StringMap(mf.getMainAttributes(), false);&lt;/p&gt;

&lt;p&gt;So either org.apache.felix.framework.cache.JarRevision and DirectoryRevision should be changed in order for &lt;br/&gt;
their getManifestHeader() member to return a Dictionary&amp;lt;String,String&amp;gt; &lt;/p&gt;

&lt;p&gt;            Manifest mf = jarFile.getManifest();&lt;br/&gt;
            // Create a case insensitive map of manifest attributes.&lt;br/&gt;
            final Attributes attributes = mf.getMainAttributes();&lt;br/&gt;
            final StringMap m = new StringMap(false);&lt;br/&gt;
            for ( final Object name : attributes.keySet() ) &lt;/p&gt;
{
                final String text = name.toString();
                m.put(text, attributes.getValue(text));
            }
&lt;p&gt;            return m;&lt;/p&gt;

&lt;p&gt;or as Richard suggested the org.apache.felix.framework.util.StringMap&lt;br/&gt;
class should override putAll(Map) and ensure that all keys are of type String (like StringMap.put(...)) does.&lt;/p&gt;

&lt;p&gt;Corresponding mailing list entries:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.mail-archive.com/users@felix.apache.org/msg04248.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.mail-archive.com/users@felix.apache.org/msg04248.html&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://www.mail-archive.com/users@felix.apache.org/msg04249.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.mail-archive.com/users@felix.apache.org/msg04249.html&lt;/a&gt;&lt;/p&gt;</description>
                <environment>IBM J9 VM (build 2.4, J2RE 1.6.0 IBM J9 2.4 AIX ppc64-64 jvmap6460-20090215_29883 (JIT enabled, AOT enabled)</environment>
        <key id="12424782">FELIX-1130</key>
            <summary>Bundle.getHeaders() returns a Dictionary&lt;java.util.jar.Attribute.Name,String&gt;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rickhall">Richard S. Hall</assignee>
                                    <reporter username="alexberger">Alexander Berger</reporter>
                        <labels>
                    </labels>
                <created>Thu, 7 May 2009 05:57:06 +0000</created>
                <updated>Fri, 15 May 2009 06:09:33 +0000</updated>
                            <resolved>Mon, 11 May 2009 16:08:00 +0000</resolved>
                                    <version>framework-1.6.1</version>
                                    <fixVersion>framework-2.0.0</fixVersion>
                                    <component>Framework</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12708093" author="rickhall" created="Mon, 11 May 2009 16:08:00 +0000"  >&lt;p&gt;I committed a patch that overrides putAll() and calls put() on each entry, where put() overrides the super class to do a toString() on each key. Please close this issue if you are satisfied. Thanks for the feedback.&lt;/p&gt;</comment>
                            <comment id="12709730" author="alexberger" created="Fri, 15 May 2009 06:09:33 +0000"  >&lt;p&gt;Thanks Richard. &lt;/p&gt;

&lt;p&gt;As the patch is very simple and is identically with the one I use for Felix 1.6.1 I close this issue as it works.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>57887</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 28 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0vz1j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>184650</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>