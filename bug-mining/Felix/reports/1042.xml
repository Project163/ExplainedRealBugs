<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:18:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-2378] Deadlock in Felix Shell implementation</title>
                <link>https://issues.apache.org/jira/browse/FELIX-2378</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;The class org.apache.felix.shell.impl.Activator$ShellServiceImpl makes heavy use of synchronized methods which synchronized on the ShellServiceImpl itself. This causes a deadlock if a refresh/resolve (PackageAdmin) cycle is initiated using the shell and some Commands are about to be removed from the OSGi service registry (as a result of the refresh/resolve).&lt;/p&gt;

&lt;p&gt;This happens because executeCommand locks the ShellServiceImpl instance and later on when the PackageAdmin indirectly triggers the removal of some registered Commands ShellServiceImpl.removeCommand(...) will try to lock the same ShellServiceImpl instance which is still locked by the executeCommand.&lt;/p&gt;

&lt;p&gt;I have created a patch for org.apache.felix.shell.impl.Activator (see Attachment) for a possible solution of this problem.&lt;/p&gt;</description>
                <environment>Felix Framework Version 2.0.5&lt;br/&gt;
SunOS castor 5.10 Generic_138888-06 sun4u sparc SUNW,Sun-Fire-V890&lt;br/&gt;
java version &amp;quot;1.6.0_12&amp;quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.6.0_12-b04)&lt;br/&gt;
Java HotSpot(TM) Server VM (build 11.2-b01, mixed mode)</environment>
        <key id="12465855">FELIX-2378</key>
            <summary>Deadlock in Felix Shell implementation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rickhall">Richard S. Hall</assignee>
                                    <reporter username="alexberger">Alexander Berger</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Jun 2010 11:55:27 +0000</created>
                <updated>Tue, 1 Jun 2010 15:18:38 +0000</updated>
                            <resolved>Tue, 1 Jun 2010 14:55:52 +0000</resolved>
                                    <version>shell-1.4.2</version>
                                    <fixVersion>shell-1.4.3</fixVersion>
                                    <component>Shell</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12873967" author="alexberger" created="Tue, 1 Jun 2010 11:57:00 +0000"  >&lt;p&gt;Patch for org.apache.felix.shell.impl.Activator which used more fine grained locking to avoid deadlock.&lt;/p&gt;</comment>
                            <comment id="12874028" author="rickhall" created="Tue, 1 Jun 2010 14:29:00 +0000"  >&lt;p&gt;Applied patch with a few minor modifications. Please close if you are satisfied, thanks.&lt;/p&gt;</comment>
                            <comment id="12874033" author="rickhall" created="Tue, 1 Jun 2010 14:36:26 +0000"  >&lt;p&gt;On second thought, I think I will address this a different way.&lt;/p&gt;</comment>
                            <comment id="12874048" author="rickhall" created="Tue, 1 Jun 2010 14:55:52 +0000"  >&lt;p&gt;Since I saw some other minor concurrency issues, I decided to convert shell to use the ServiceTracker which I believe will also address your deadlock issues. Please close this issue if you are satisfied with the result. Thanks.&lt;/p&gt;</comment>
                            <comment id="12874065" author="alexberger" created="Tue, 1 Jun 2010 15:18:38 +0000"  >&lt;p&gt;Ok. Works perfectly now, no deadlocks anymore &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Thank you very much for the quick bugfix.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12446017" name="Activator.patch" size="5348" author="alexberger" created="Tue, 1 Jun 2010 11:57:00 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56376</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 26 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0vzdz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>184706</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>