<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:16:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-1809] OBR issue when using parameters with exported packages</title>
                <link>https://issues.apache.org/jira/browse/FELIX-1809</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;Please consider the attached test case along with the proposed patch.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I have single bundle (A.jar) containing com.a.class and exporting the package com.a with a version and a &quot;tag&quot;&lt;br/&gt;
ie: Export-Package: com.a; version=&quot;1.2.3&quot;;tag=&quot;mytag&quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I use bnd to build the bundle and it generates a similar import (which is good)&lt;br/&gt;
ie: Import-Package: com.a; version=&quot;1.2.3&quot;;tag=&quot;mytag&quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I use bindex to generate the repository (containing only this bundle) which, in turn, generates the following requirement:&lt;br/&gt;
&amp;lt;require extend=&apos;false&apos; filter=&apos;(&amp;amp;(package=com.a)(version&amp;gt;=1.2.3)(tag=mytag)(mandatory:&amp;lt;*tag))&apos; multiple=&apos;false&apos; name=&apos;package&apos; optional=&apos;false&apos;&amp;gt;&lt;br/&gt;
      Import package com.a ;version=1.2.3&lt;br/&gt;
&amp;lt;/require&amp;gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;As such when I try to resolve bundle A from the OBR, it fails. &lt;br/&gt;
Bundle A does not have a &quot;mandatory&quot; attribute in its capabilities, but as the spec suggests (p18 of RFC-0112):&lt;/p&gt;

&lt;p&gt;&quot;If the value does not exist, then it is still possible to match a subset. A non-existent property is a proper subset of&lt;br/&gt;
any set. A non-existent property is a superset if the list is empty.&lt;br/&gt;
    (mandatory:&amp;lt;*vendor,var)                                         Mandatory must contain vendor, var, both or be empty.&quot;&lt;/p&gt;

&lt;p&gt;While investigating this issue, i found 2 NullPointerExceptions, in the code of bundlerepository (the first one being hidden behind an empty try/catch)&lt;/p&gt;

&lt;p&gt;When I fix these NullPointerExceptions, the OBR successfully resolves bundle A and my test passes. &lt;br/&gt;
BUT.. FilterImplTest now fails!&lt;/p&gt;

&lt;p&gt;IF my understanding is right, i think line 73 of FilterImplTest should read assertTrue instead of assertFalse.. (but I must admit that i find the meaning of this &quot;mandatory&quot; part quite confusing!)&lt;/p&gt;

&lt;p&gt;I&apos;m attaching the test and the proposed patch in 2 separate tar files (to be extracted under felix-trunk/bundlerepository).&lt;/p&gt;

&lt;p&gt;Regards,&lt;br/&gt;
Arjun&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12439086">FELIX-1809</key>
            <summary>OBR issue when using parameters with exported packages</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rickhall">Richard S. Hall</assignee>
                                    <reporter username="apanday">Arjun Panday</reporter>
                        <labels>
                    </labels>
                <created>Mon, 26 Oct 2009 16:52:30 +0000</created>
                <updated>Fri, 19 Feb 2010 15:27:17 +0000</updated>
                            <resolved>Tue, 16 Feb 2010 09:10:36 +0000</resolved>
                                                    <fixVersion>bundlerepository-1.6.0</fixVersion>
                                    <component>Bundle Repository (OBR)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12770089" author="apanday" created="Mon, 26 Oct 2009 16:53:48 +0000"  >&lt;p&gt;testobr.tar : a simple test case to demonstrate the problem&lt;/p&gt;

&lt;p&gt;patchfilter.tgz : the proposed fix&lt;/p&gt;</comment>
                            <comment id="12834130" author="rickhall" created="Tue, 16 Feb 2010 09:10:35 +0000"  >&lt;p&gt;I think you are correct. I applied your patch. Please close this issue if you are satisfied. Thanks!&lt;/p&gt;</comment>
                            <comment id="12835778" author="apanday" created="Fri, 19 Feb 2010 15:27:17 +0000"  >&lt;p&gt;The test case works; i think it&apos;s fine. &lt;br/&gt;
Thanks  a lot,&lt;br/&gt;
Arjun&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12423221" name="patchfilter.tgz" size="4313" author="apanday" created="Mon, 26 Oct 2009 16:53:48 +0000"/>
                            <attachment id="12423220" name="testobr.tar" size="20480" author="apanday" created="Mon, 26 Oct 2009 16:53:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>57228</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 40 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0vzkv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>184737</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>