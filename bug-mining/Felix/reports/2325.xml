<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:55:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-4727] WrappedResource.getCapabilities ignores the namespace param</title>
                <link>https://issues.apache.org/jira/browse/FELIX-4727</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;The overall design of org.apache.felix.resolver.WrappedResource is that it is an internal type to the ResolverImpl and is not exposed to external code.  The fact that it does not pay attention to the namespace param is an oversite, but not one that effects the ResolverImpl since it uses a null param anyway and does its own filtering of the capabilities.&lt;/p&gt;

&lt;p&gt;But there are cases where this type will get exposed to code outside the resolver implementation.  One example is when ResolverImpl.mergeUses is called and does a ArrayList.contains.  Typically the types in the list are provided by the ResolveContext implementation.  If a WrappedCapability is passed to the ArrayList.contains method then it does an equals call across all values in the list.  If a ResolveContext capability implementation of that equals method calls getResource on  WrappedCapability then it will be exposed to the WrappedResource.  I know of one case where this causes issues when the client code is trying to get the osgi.identity capability of the WrappedResource.  All capabilities are being returned but the first one is not the expected osgi.identity.&lt;/p&gt;

&lt;p&gt;Here is a stacktrace from Aries:&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.NullPointerException&lt;br/&gt;
	at org.apache.aries.subsystem.obr.internal.FelixResourceAdapter.equals(FelixResourceAdapter.java:44)&lt;br/&gt;
	at java.util.ArrayList.indexOf(ArrayList.java:319)&lt;br/&gt;
	at java.util.ArrayList.contains(ArrayList.java:302)&lt;br/&gt;
	at org.apache.felix.resolver.ResolverImpl.mergeUses(ResolverImpl.java:955)&lt;br/&gt;
	at org.apache.felix.resolver.ResolverImpl.calculatePackageSpaces(ResolverImpl.java:767)&lt;br/&gt;
	at org.apache.felix.resolver.ResolverImpl.calculatePackageSpaces(ResolverImpl.java:715)&lt;br/&gt;
	at org.apache.felix.resolver.ResolverImpl.calculatePackageSpaces(ResolverImpl.java:715)&lt;br/&gt;
	at org.apache.felix.resolver.ResolverImpl.calculatePackageSpaces(ResolverImpl.java:715)&lt;br/&gt;
	at org.apache.felix.resolver.ResolverImpl.resolve(ResolverImpl.java:249)&lt;br/&gt;
	at org.apache.aries.subsystem.core.internal.SubsystemResource.computeDependencies(SubsystemResource.java:410)&lt;br/&gt;
	at org.apache.aries.subsystem.core.internal.SubsystemResource.computeDependencies(SubsystemResource.java:393)&lt;br/&gt;
	at org.apache.aries.subsystem.core.internal.SubsystemResource.&amp;lt;init&amp;gt;(SubsystemResource.java:101)&lt;br/&gt;
	at org.apache.aries.subsystem.core.internal.SubsystemResource.&amp;lt;init&amp;gt;(SubsystemResource.java:92)&lt;br/&gt;
	at org.apache.aries.subsystem.core.internal.InstallAction.createSubsystemResource(InstallAction.java:128)&lt;br/&gt;
	at org.apache.aries.subsystem.core.internal.InstallAction.run(InstallAction.java:62)&lt;/p&gt;</description>
                <environment>All</environment>
        <key id="12761086">FELIX-4727</key>
            <summary>WrappedResource.getCapabilities ignores the namespace param</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rickhall">Richard S. Hall</assignee>
                                    <reporter username="tjwatson">Tom Watson</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Dec 2014 15:30:10 +0000</created>
                <updated>Mon, 15 Dec 2014 14:17:35 +0000</updated>
                            <resolved>Fri, 12 Dec 2014 20:53:06 +0000</resolved>
                                                    <fixVersion>resolver-1.2.0</fixVersion>
                                    <component>Resolver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14242787" author="tjwatson" created="Thu, 11 Dec 2014 16:57:25 +0000"  >&lt;p&gt;Fix is to pass the namespace param to the wrapped resource/fragments&lt;/p&gt;</comment>
                            <comment id="14244759" author="rickhall" created="Fri, 12 Dec 2014 20:53:06 +0000"  >&lt;p&gt;I&apos;ve applied the patch, please close if satisfied. Thanks.&lt;/p&gt;</comment>
                            <comment id="14246667" author="tjwatson" created="Mon, 15 Dec 2014 14:17:35 +0000"  >&lt;p&gt;Thanks.  Closing.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12686615" name="Felix-4737.patch" size="1077" author="tjwatson" created="Thu, 11 Dec 2014 16:57:25 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 49 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i23bl3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>