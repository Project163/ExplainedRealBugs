<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:33:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-2888] if you create a factory configuration and anybody takes a peek before you&apos;ve had a chance to update, your pudding is trapped forever</title>
                <link>https://issues.apache.org/jira/browse/FELIX-2888</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;If you create a factory configuration and then one of your bundle comrades (or another internal class) has a peek to see if there&apos;s anything ready yet, the original code that created the factory configuration is locked out because the peeker triggers a cache of a NEW configuration.&lt;/p&gt;

&lt;p&gt;Here&apos;s the sequence&lt;/p&gt;

&lt;p&gt;1) &lt;br/&gt;
Userside -&amp;gt; call createFactoryConfiguration and catch the return value so you can do an update with it&lt;br/&gt;
felix side -&amp;gt; creates the configuration but doesn&apos;t cache it&lt;/p&gt;

&lt;p&gt;2)&lt;br/&gt;
Userside -&amp;gt; let your friends know about the pid which they can peek at for future reference.  One of your friends is excited and peeks immediately (or soon after being informed).&lt;br/&gt;
felix side -&amp;gt; since an update hasn&apos;t been done yet, it creates a new configuration and puts it in cache&lt;/p&gt;

&lt;p&gt;3)&lt;br/&gt;
Userside -&amp;gt; The code that called createFactoryConfiguration finishes its pondering and is ready to call conf.update(props) .. it gets no exception from the void method and so carries on with life.&lt;br/&gt;
felix side -&amp;gt; The cache already has something in it for this pid, so updates to the generated conf no longer have any effect, so the caller of createFactoryConfiguration&apos;s assumptions of update success are erroneous&lt;/p&gt;

&lt;p&gt;4) &lt;br/&gt;
Userside -&amp;gt; Someone does listConfigurations, and doesn&apos;t see this conf&lt;br/&gt;
felix side -&amp;gt; This is because the system still believes that the configuration has no properties&lt;/p&gt;

&lt;p&gt;It&apos;s also useful to note that it is NOT a workaround to simply kludge things by doing a config regrab immediately before doing the update(props) operation because the config generated and cached by the peek call was NOT a factory configuration, because getConfiguration() had no reason to believe it should autogenerate a factory config, so it autogenerates a normal one.&lt;/p&gt;

&lt;p&gt;I think (but am not totally sure) that this may have been a regression from &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-612&quot; title=&quot;ConfigurationAdmin.createFactoryConfiguration should not persist Configuration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-612&quot;&gt;&lt;del&gt;FELIX-612&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</description>
                <environment>Ubuntu 10.04</environment>
        <key id="12501910">FELIX-2888</key>
            <summary>if you create a factory configuration and anybody takes a peek before you&apos;ve had a chance to update, your pudding is trapped forever</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fmeschbe">Felix Meschberger</assignee>
                                    <reporter username="aradzak">jamie campbell</reporter>
                        <labels>
                    </labels>
                <created>Sun, 20 Mar 2011 23:22:57 +0000</created>
                <updated>Wed, 25 Sep 2013 14:02:34 +0000</updated>
                            <resolved>Thu, 16 Feb 2012 14:02:24 +0000</resolved>
                                    <version> configadmin-1.2.8</version>
                                    <fixVersion>configadmin-1.4.0</fixVersion>
                                    <component>Configuration Admin</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13010646" author="fmeschbe" created="Thu, 24 Mar 2011 12:30:29 +0000"  >&lt;p&gt;Well, the createFactoryConfiguration method creates just a transient configuration object which is not persisted; in fact not even internally known to exist. So before informing &quot;your friends&quot; in the second step you currently would have to call Configuration.update(Dictionary) before informing &quot;your friends&quot;.&lt;/p&gt;

&lt;p&gt;In addition &quot;your excited friend&quot; taking a &quot;peek&quot; is probably calling getConfiguration this will create a Configuration if not existing yet &amp;#8211; which is the case here because the factory configuration does not exist yet. But then this now existing configuration is not a factory configuration but a singleton configuration whose Configuration.getFactoryPid() method will return null.&lt;/p&gt;

&lt;p&gt;I think I can build this additional stability (kind of semi-caching the created factory configuration) into Configuration Admin without much effort.&lt;/p&gt;</comment>
                            <comment id="13209367" author="fmeschbe" created="Thu, 16 Feb 2012 14:02:24 +0000"  >&lt;p&gt;Fixed in Rev. 1244978&lt;/p&gt;

&lt;p&gt;Configuration retrieved through getConfiguration now also includes factory configuration which has not been persisted yet.&lt;/p&gt;

&lt;p&gt;Also configuration retrieved from getConfiguration is always persisted (even new factory configuration not updated yet). This is to comply with the getConfiguration contract.&lt;/p&gt;</comment>
                            <comment id="13777502" author="fmeschbe" created="Wed, 25 Sep 2013 14:02:34 +0000"  >&lt;p&gt;Close issues after release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56092</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 9 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i07h3z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>41538</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>