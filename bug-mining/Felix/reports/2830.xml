<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 16:09:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-5543] Component property types must implement java.lang.annotation.Annotation methods properly</title>
                <link>https://issues.apache.org/jira/browse/FELIX-5543</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;Currently component property types only implement one getter method for each element. The methods &lt;tt&gt;toString()&lt;/tt&gt;, &lt;tt&gt;equals()&lt;/tt&gt;, &lt;tt&gt;hashCode()&lt;/tt&gt; and &lt;tt&gt;annotationType&lt;/tt&gt; are not implemented properly (i.e. all return just &lt;tt&gt;null&lt;/tt&gt;). This violates JLS 9.6 (&lt;a href=&quot;https://docs.oracle.com/javase/specs/jls/se7/html/jls-9.html#jls-9.6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.oracle.com/javase/specs/jls/se7/html/jls-9.html#jls-9.6&lt;/a&gt;).&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;The direct superinterface of an annotation type is always java.lang.annotation.Annotation.  &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The component property type needs to implement &lt;tt&gt;java.lang.annotation.Annotation&lt;/tt&gt; and all its methods properly. The current implementation is clearly violating the contract of the &lt;tt&gt;java.lang.annotation.Annotation&lt;/tt&gt;.&lt;br/&gt;
For that the &lt;tt&gt;Annotations#toObject(...)&lt;/tt&gt; needs to be adjusted in &lt;a href=&quot;https://github.com/apache/felix/blob/trunk/scr/src/main/java/org/apache/felix/scr/impl/inject/Annotations.java#L41&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/blob/trunk/scr/src/main/java/org/apache/felix/scr/impl/inject/Annotations.java#L41&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13042889">FELIX-5543</key>
            <summary>Component property types must implement java.lang.annotation.Annotation methods properly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cziegeler">Carsten Ziegeler</assignee>
                                    <reporter username="kwin">Konrad Windszus</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 Feb 2017 10:09:18 +0000</created>
                <updated>Mon, 30 Apr 2018 08:13:49 +0000</updated>
                            <resolved>Fri, 17 Mar 2017 06:50:51 +0000</resolved>
                                    <version>scr-2.1.0</version>
                                    <fixVersion>scr-2.1.0</fixVersion>
                                    <component>Declarative Services (SCR)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15865523" author="kwin" created="Tue, 14 Feb 2017 10:15:08 +0000"  >&lt;p&gt;Right now the component property type object returns &lt;tt&gt;null&lt;/tt&gt; for all methods, which are not given in the &lt;tt&gt;HashMap&lt;/tt&gt; in &lt;a href=&quot;https://github.com/apache/felix/blob/trunk/scr/src/main/java/org/apache/felix/scr/impl/inject/Annotations.java#L246&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/blob/trunk/scr/src/main/java/org/apache/felix/scr/impl/inject/Annotations.java#L246&lt;/a&gt;. &lt;br/&gt;
Instead of the simple &lt;tt&gt;Handler&lt;/tt&gt; class one must implement something similar to &lt;tt&gt;sun.reflect.annotation.AnnotationInvocationHandler&lt;/tt&gt;. There is such a code in bytebuddy (Apache License 2.0) (&lt;a href=&quot;https://github.com/raphw/byte-buddy/blob/master/byte-buddy-dep/src/main/java/net/bytebuddy/description/annotation/AnnotationDescription.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/raphw/byte-buddy/blob/master/byte-buddy-dep/src/main/java/net/bytebuddy/description/annotation/AnnotationDescription.java&lt;/a&gt;) one could maybe just embed.&lt;/p&gt;</comment>
                            <comment id="15929388" author="cziegeler" created="Fri, 17 Mar 2017 03:53:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwin&quot; class=&quot;user-hover&quot; rel=&quot;kwin&quot;&gt;kwin&lt;/a&gt; Thanks for reporting. I&apos;ve committed an updated version of the Handler class implementing these methods in rev 1787280 to the 2.1.0 branch. Please have a look at this.&lt;br/&gt;
Now, this obviously blows up the code for creating the proxy and the committed code does not implement these methods 100% according to what is mentioned in the Annotations javadoc. Even the more complicated code mentioned above does not do it 100% correct. So i&apos;m a little bit reluctant to make it even more complicated as I&apos;m not quiet sure what the benefits are. It would be great to also hear about the use cases for using these methods.&lt;/p&gt;</comment>
                            <comment id="15929488" author="kwin" created="Fri, 17 Mar 2017 06:37:55 +0000"  >&lt;p&gt;Thanks for the fix in SCR 2.1. My main use case was debugging in an IDE where it was confusing that the property type object was exposed as &lt;tt&gt;null&lt;/tt&gt; due to the missing toString() implementation. Not too sure about the other methods. Probably they are not really useful in this context. However, I think the fix is good enough for now. If someone really relies on certain semantics of these methods which are not fulfilled by the new implementation, that should be raised in an additional ticket together with a use case.&lt;/p&gt;</comment>
                            <comment id="15929501" author="cziegeler" created="Fri, 17 Mar 2017 06:50:51 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kwin&quot; class=&quot;user-hover&quot; rel=&quot;kwin&quot;&gt;kwin&lt;/a&gt;, yes debugging (toString) was the only use case I could see for this as well&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 35 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3a1tb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>