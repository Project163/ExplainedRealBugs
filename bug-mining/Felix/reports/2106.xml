<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:52:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-4362] Security ConfigAdmin permissions are inherited on the stack</title>
                <link>https://issues.apache.org/jira/browse/FELIX-4362</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;It seems to cause lots of issues for me when testing.&lt;br/&gt;
For example, I end up with lots of exceptions like:&lt;br/&gt;
[CM Configuration Updater (ManagedServiceFactory Update: factoryPid=&lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.felix.fileinstall&amp;#93;&lt;/span&gt;)] ERROR org.apache.felix.configadmin - &lt;span class=&quot;error&quot;&gt;&amp;#91;org.osgi.service.cm.ManagedServiceFactory, id=233, bundle=7/mvn:org.apache.felix/org.apache.felix.fileinstall/3.2.6&amp;#93;&lt;/span&gt;: Unexpected problem updating configuration org.apache.felix.fileinstall.c0eba252-35f7-4ab6-bc11-ad11e131711c&lt;br/&gt;
java.security.AccessControlException: access denied (&quot;java.util.PropertyPermission&quot; &quot;java.io.tmpdir&quot; &quot;read&quot;)&lt;br/&gt;
	at java.security.AccessControlContext.checkPermission(AccessControlContext.java:372)&lt;br/&gt;
	at java.security.AccessController.checkPermission(AccessController.java:559)&lt;br/&gt;
	at java.lang.SecurityManager.checkPermission(SecurityManager.java:549)&lt;br/&gt;
	at java.lang.SecurityManager.checkPropertyAccess(SecurityManager.java:1302)&lt;br/&gt;
	at java.lang.System.getProperty(System.java:708)&lt;br/&gt;
	at org.apache.felix.fileinstall.internal.DirectoryWatcher.&amp;lt;init&amp;gt;(DirectoryWatcher.java:109)&lt;br/&gt;
	at org.apache.felix.fileinstall.internal.FileInstall.updated(FileInstall.java:246)&lt;br/&gt;
	at org.apache.felix.fileinstall.internal.FileInstall$ConfigAdminSupport$Tracker.updated(FileInstall.java:422)&lt;br/&gt;
	at org.apache.felix.cm.impl.helper.ManagedServiceFactoryTracker.provideConfiguration(ManagedServiceFactoryTracker.java:88)&lt;br/&gt;
	at org.apache.felix.cm.impl.ConfigurationManager$ManagedServiceFactoryUpdate.provide(ConfigurationManager.java:1605)&lt;br/&gt;
	at org.apache.felix.cm.impl.ConfigurationManager$ManagedServiceFactoryUpdate.run(ConfigurationManager.java:1548)&lt;br/&gt;
	at org.apache.felix.cm.impl.UpdateThread.run(UpdateThread.java:103)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:744)&lt;br/&gt;
I think if we want to allow such a permissions file, we also need to ensure that all access to bundles are not conditioned by it.&lt;br/&gt;
In the above stack trace and when running with a security manager, the call to service.updated() should be done inside a priviledged action I think:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; AccessController.doPrivileged(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PrivilegedAction&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt;() {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; run() { service.updated( configPid.toString(), props ); }
  }, accessControlContext);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;so that permissions of ConfigAdmin bundle are not inherited by other bundles.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12685388">FELIX-4362</key>
            <summary>Security ConfigAdmin permissions are inherited on the stack</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fmeschbe">Felix Meschberger</assignee>
                                    <reporter username="gnodet">Guillaume Nodet</reporter>
                        <labels>
                    </labels>
                <created>Wed, 18 Dec 2013 14:26:49 +0000</created>
                <updated>Tue, 17 Mar 2015 06:45:02 +0000</updated>
                            <resolved>Tue, 3 Mar 2015 11:19:18 +0000</resolved>
                                    <version>configadmin-1.8.0</version>
                                    <fixVersion>configadmin-1.8.2</fixVersion>
                                    <component>Configuration Admin</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13858105" author="fmeschbe" created="Sat, 28 Dec 2013 20:15:36 +0000"  >&lt;p&gt;Implemented calling the ManagedService&lt;span class=&quot;error&quot;&gt;&amp;#91;Factory&amp;#93;&lt;/span&gt; methods as privileged actions if a SecurityManager is installed in Rev. 1553904.&lt;/p&gt;

&lt;p&gt;As for the AccessControlContext required: I am not really sure, what AccessControlContext we should use here, so an AccessControlContext is created using the called service&apos;s ProtectionDomain. For sure, the AccessControlContext from AccessControll.getContext() cannot be used because that is based on the ConfigurationAdmin bundle&apos;s protection domain.&lt;/p&gt;

&lt;p&gt;The trunk build currently passes our own tests as well as OSGi CT tests.&lt;/p&gt;

&lt;p&gt;Please check, whether a trunk build of the Configuration Admin bundle fixes your issues.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12685397">KARAF-2636</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12645069">FELIX-4039</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>364465</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 47 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1qtl3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>364765</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>