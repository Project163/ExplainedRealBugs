<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:21:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-2681] NPE in assertMinScrAnnotationArtifactVersion when checking min. version of annotations dependency</title>
                <link>https://issues.apache.org/jira/browse/FELIX-2681</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;i tested the scr plugin 1.6.0 from the staging repository:&lt;br/&gt;
&lt;a href=&quot;https://repository.apache.org/content/repositories/orgapachefelix-010/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/repositories/orgapachefelix-010/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;with a complex project consisting of mutliple osgi bundles and custom annotation tag providers.&lt;/p&gt;

&lt;p&gt;compiling this set of maven projects/osgi bundles fails with this stackstrace:&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
        at org.apache.maven.artifact.DefaultArtifact.getSelectedVersion(DefaultArtifact.java:621)&lt;br/&gt;
        at org.apache.felix.scrplugin.mojo.SCRDescriptorMojo.assertMinScrAnnotationArtifactVersion(SCRDescriptorMojo.java:249)&lt;br/&gt;
        at org.apache.felix.scrplugin.mojo.SCRDescriptorMojo.getClassPath(SCRDescriptorMojo.java:216)&lt;br/&gt;
        at org.apache.felix.scrplugin.mojo.SCRDescriptorMojo.execute(SCRDescriptorMojo.java:167)&lt;br/&gt;
        at org.apache.maven.plugin.DefaultPluginManager.executeMojo(DefaultPluginManager.java:490)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoals(DefaultLifecycleExecutor.java:694)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalWithLifecycle(DefaultLifecycleExecutor.java:556)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoal(DefaultLifecycleExecutor.java:535)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalAndHandleFailures(DefaultLifecycleExecutor.java:387)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeTaskSegments(DefaultLifecycleExecutor.java:348)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.execute(DefaultLifecycleExecutor.java:180)&lt;br/&gt;
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:328)&lt;br/&gt;
        at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:138)&lt;br/&gt;
        at org.apache.maven.cli.MavenCli.main(MavenCli.java:362)&lt;br/&gt;
        at org.apache.maven.cli.compat.CompatibleMain.main(CompatibleMain.java:60)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
        at org.codehaus.classworlds.Launcher.launchEnhanced(Launcher.java:315)&lt;br/&gt;
        at org.codehaus.classworlds.Launcher.launch(Launcher.java:255)&lt;br/&gt;
        at org.codehaus.classworlds.Launcher.mainWithExitCode(Launcher.java:430)&lt;br/&gt;
        at org.codehaus.classworlds.Launcher.main(Launcher.java:375)&lt;/p&gt;

&lt;p&gt;the annotations dependeny is declared like this:&lt;br/&gt;
      &amp;lt;dependency&amp;gt;&lt;br/&gt;
        &amp;lt;groupId&amp;gt;org.apache.felix&amp;lt;/groupId&amp;gt;&lt;br/&gt;
        &amp;lt;artifactId&amp;gt;org.apache.felix.scr.annotations&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
        &amp;lt;version&amp;gt;1.4.0&amp;lt;/version&amp;gt;&lt;br/&gt;
        &amp;lt;scope&amp;gt;compile&amp;lt;/scope&amp;gt;&lt;br/&gt;
      &amp;lt;/dependency&amp;gt;&lt;/p&gt;

&lt;p&gt;debugging shows that the &quot;versionrange&quot; member variable of the artifact is null.&lt;/p&gt;

&lt;p&gt;if i change the version declaration to &lt;br/&gt;
        &amp;lt;version&amp;gt;[1.4.0,)&amp;lt;/version&amp;gt;&lt;/p&gt;

&lt;p&gt;the stacktrace changes:&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
        at org.apache.maven.artifact.versioning.DefaultArtifactVersion.compareTo(DefaultArtifactVersion.java:54)&lt;br/&gt;
        at org.apache.felix.scrplugin.mojo.SCRDescriptorMojo.assertMinScrAnnotationArtifactVersion(SCRDescriptorMojo.java:250)&lt;br/&gt;
        at org.apache.felix.scrplugin.mojo.SCRDescriptorMojo.getClassPath(SCRDescriptorMojo.java:216)&lt;br/&gt;
        at org.apache.felix.scrplugin.mojo.SCRDescriptorMojo.execute(SCRDescriptorMojo.java:167)&lt;br/&gt;
        at org.apache.maven.plugin.DefaultPluginManager.executeMojo(DefaultPluginManager.java:490)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoals(DefaultLifecycleExecutor.java:694)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalWithLifecycle(DefaultLifecycleExecutor.java:556)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoal(DefaultLifecycleExecutor.java:535)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalAndHandleFailures(DefaultLifecycleExecutor.java:387)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeTaskSegments(DefaultLifecycleExecutor.java:348)&lt;br/&gt;
        at org.apache.maven.lifecycle.DefaultLifecycleExecutor.execute(DefaultLifecycleExecutor.java:180)&lt;br/&gt;
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:328)&lt;br/&gt;
        at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:138)&lt;br/&gt;
        at org.apache.maven.cli.MavenCli.main(MavenCli.java:362)&lt;br/&gt;
        at org.apache.maven.cli.compat.CompatibleMain.main(CompatibleMain.java:60)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
        at org.codehaus.classworlds.Launcher.launchEnhanced(Launcher.java:315)&lt;br/&gt;
        at org.codehaus.classworlds.Launcher.launch(Launcher.java:255)&lt;br/&gt;
        at org.codehaus.classworlds.Launcher.mainWithExitCode(Launcher.java:430)&lt;br/&gt;
        at org.codehaus.classworlds.Launcher.main(Launcher.java:375)&lt;/p&gt;

&lt;p&gt;because the value returned by getSelectedVersion() is null.&lt;/p&gt;

&lt;p&gt;please note: the annotation depency is not declared in the project that fails to compile, but in a project the failing project depends upon (transitive dependency).&lt;/p&gt;

&lt;p&gt;looking on the documentation of the Artifact interface i&apos;m not sure if the getSelectedVersion() method is really intended to be used by plugins.&lt;/p&gt;</description>
                <environment>windows 7 64bit</environment>
        <key id="12478913">FELIX-2681</key>
            <summary>NPE in assertMinScrAnnotationArtifactVersion when checking min. version of annotations dependency</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fmeschbe">Felix Meschberger</assignee>
                                    <reporter username="sseifert">Stefan Seifert</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 Nov 2010 17:41:48 +0000</created>
                <updated>Sun, 13 Mar 2011 12:56:34 +0000</updated>
                            <resolved>Tue, 2 Nov 2010 20:55:24 +0000</resolved>
                                    <version> maven-scr-plugin-1.6.0</version>
                                    <fixVersion>maven-scr-plugin-1.7.0</fixVersion>
                                    <component>SCR Tooling</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12927566" author="fmeschbe" created="Tue, 2 Nov 2010 19:41:10 +0000"  >&lt;p&gt;This is weird &amp;#8211; I cannot reproduce. What version of Maven are you using ?&lt;/p&gt;

&lt;p&gt;Nevertheless, a potential patch could be:&lt;/p&gt;

&lt;p&gt;diff --git a/scrplugin/maven-scr-plugin/src/main/java/org/apache/felix/scrplugin/mojo/SCRDescriptorMojo.java b/scrplugin/maven-scr-plugin/src/main/java/org/apache/felix/scrplugin/mojo/SCRDescri&lt;br/&gt;
index 8517989..cf412be 100644&lt;br/&gt;
&amp;#8212; a/scrplugin/maven-scr-plugin/src/main/java/org/apache/felix/scrplugin/mojo/SCRDescriptorMojo.java&lt;br/&gt;
+++ b/scrplugin/maven-scr-plugin/src/main/java/org/apache/felix/scrplugin/mojo/SCRDescriptorMojo.java&lt;br/&gt;
@@ -246,7 +246,20 @@ public class SCRDescriptorMojo extends AbstractMojo {&lt;br/&gt;
             // compare version number&lt;br/&gt;
             try&lt;br/&gt;
             {&lt;br/&gt;
+                // try to find out the artifact&apos;s version&lt;br/&gt;
                 ArtifactVersion aVersion = a.getSelectedVersion();&lt;br/&gt;
+                if (aVersion == null)&lt;br/&gt;
+                {&lt;br/&gt;
+                    String version = a.getVersion();&lt;br/&gt;
+                    if (version == null)&lt;br/&gt;
+                    &lt;/p&gt;
{
+                        getLog().error(&quot;Cannot find version of &quot; + a + &quot;, assuming 0.0.0&quot;);
+                        version = &quot;0.0.0&quot;;
+                    }
&lt;p&gt;+                    aVersion = new DefaultArtifactVersion(version);&lt;br/&gt;
+                }&lt;br/&gt;
+&lt;br/&gt;
+                // assert minimal version&lt;br/&gt;
                 if (SCR_ANN_MIN_VERSION.compareTo(aVersion) &amp;gt; 0)&lt;br/&gt;
                 {&lt;br/&gt;
                     getLog().error(&quot;Project depends on &quot; + a);&lt;/p&gt;

&lt;p&gt;Would you be able to validate this in your environment ? Thanks.&lt;/p&gt;</comment>
                            <comment id="12927590" author="fmeschbe" created="Tue, 2 Nov 2010 20:55:24 +0000"  >&lt;p&gt;Applied a much simpler fix in Rev. 1030211: Just us the Artifact.getBaseVersion() which gets the correct version to be compared.&lt;/p&gt;</comment>
                            <comment id="12927619" author="sseifert@pro-vision.de" created="Tue, 2 Nov 2010 21:32:12 +0000"  >&lt;p&gt;i&apos;m using maven version 2.2.1&lt;/p&gt;

&lt;p&gt;i&apos;ve tested it a bit more with our projects, adding an explicit dependency to the failing project is a workaround. strangely enough not all projects with a transient dependency fail, but only one.&lt;/p&gt;

&lt;p&gt;upgrading to scrplugin 1.6.1-SNAPSHOT with rev. 1030211 applied solves the problem altogether, so it is solved in the trunk.&lt;br/&gt;
thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40488</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0aqvj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>60627</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>