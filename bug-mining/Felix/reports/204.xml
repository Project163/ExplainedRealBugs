<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:06:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-624] Wrong classloader is used to detect bind/unbind methods</title>
                <link>https://issues.apache.org/jira/browse/FELIX-624</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;I have two bundles:&lt;br/&gt;
Bundle a exporting an abstract class which has a reference to another class (in my test scenario to a class from commons-collections)&lt;br/&gt;
Bundle b has a class inheriting from the abstract class from Bundle a&lt;/p&gt;

&lt;p&gt;The import package statement in Bundle b does not include the commons-collections class which results in class not found exceptions&lt;br/&gt;
when bundle b is started.&lt;/p&gt;

&lt;p&gt;This might either be a buig in the maven-bundle-plugin or the used bnd version.&lt;/p&gt;

&lt;p&gt;I&apos;ll add a simple test case&lt;/p&gt;</description>
                <environment></environment>
        <key id="12399707">FELIX-624</key>
            <summary>Wrong classloader is used to detect bind/unbind methods</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="cziegeler">Carsten Ziegeler</reporter>
                        <labels>
                    </labels>
                <created>Mon, 7 Jul 2008 10:31:48 +0000</created>
                <updated>Mon, 25 Aug 2008 09:44:56 +0000</updated>
                            <resolved>Tue, 8 Jul 2008 06:58:29 +0000</resolved>
                                    <version>scr-1.0.2</version>
                                    <fixVersion>scr-1.0.4</fixVersion>
                                    <component>Declarative Services (SCR)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12610947" author="cziegeler" created="Mon, 7 Jul 2008 10:32:53 +0000"  >&lt;p&gt;Test case with two bundles.&lt;/p&gt;</comment>
                            <comment id="12610949" author="mcculls" created="Mon, 7 Jul 2008 10:39:03 +0000"  >&lt;p&gt;I&apos;m not sure that the import is actually needed - have you checked the bytecode to see if the subclass uses the reference?&lt;/p&gt;

&lt;p&gt;Note that there is a bug in Eclipse/PDE which does require this import (due to how PDE is grafted on top of JDT) but the bundles will typically deploy without error onto OSGi frameworks.&lt;/p&gt;</comment>
                            <comment id="12610954" author="cziegeler" created="Mon, 7 Jul 2008 10:47:14 +0000"  >&lt;p&gt;No, the subclass is not directly using the class from commons-collections. &lt;/p&gt;

&lt;p&gt;Ah, i see (dumb me)  - yes, the bundle is loaded correctly - it&apos;s a problem later on with SCR - the scr implementation is not able to instantiate&lt;br/&gt;
an instance of this class.&lt;/p&gt;

&lt;p&gt;So I guess that this is rather an SCR bug then, right?&lt;/p&gt;</comment>
                            <comment id="12611000" author="mcculls" created="Mon, 7 Jul 2008 10:53:24 +0000"  >&lt;p&gt;I ran javap over the subclass and cannot find any reference to commons-collections in the bytecode, so it seems odd this bundle threw a CNFE because it should not need the import during classloading if there is no reference to it in the bytecode / constant pool (at least according to the JVM spec). Also I started the two bundles and the commons-collections bundle (v3.2.1) successfully in Felix and saw no problem - all the bundles resolved ok.&lt;/p&gt;</comment>
                            <comment id="12611001" author="mcculls" created="Mon, 7 Jul 2008 10:55:31 +0000"  >&lt;p&gt;Yes, that sounds like an SCR issue - is it using the correct classloader?&lt;/p&gt;</comment>
                            <comment id="12611003" author="mcculls" created="Mon, 7 Jul 2008 11:00:41 +0000"  >&lt;p&gt;Moving issue over to SCR for further investigation.&lt;/p&gt;</comment>
                            <comment id="12611141" author="cziegeler" created="Mon, 7 Jul 2008 12:50:47 +0000"  >&lt;p&gt;Ok, i&apos;ve updated my test case and it seems to be an SCR problem...however I haven&apos;t dug into the code yet.&lt;/p&gt;

&lt;p&gt;Here&apos;s the exception I get when deploying bundle B (after deploying bundle c and a)&lt;br/&gt;
07.07.2008 14:48:14.005 &lt;b&gt;ERROR&lt;/b&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;SCR Component Actor&amp;#93;&lt;/span&gt; com.cziegeler.test.b &lt;span class=&quot;error&quot;&gt;&amp;#91;com.c2.Test&amp;#93;&lt;/span&gt; Cannot load class used as parameter org.apache.commons.collections.bag.TreeBag (java.lang.ClassNotFoundException: org.apache.commons.collections.bag.TreeBag) java.lang.ClassNotFoundException: org.apache.commons.collections.bag.TreeBag&lt;br/&gt;
	at org.apache.felix.framework.Felix.loadBundleClass(Felix.java:1504)&lt;br/&gt;
	at org.apache.felix.framework.BundleImpl.loadClass(BundleImpl.java:358)&lt;br/&gt;
	at org.apache.felix.scr.impl.DependencyManager.getBindingMethod(DependencyManager.java:734)&lt;br/&gt;
	at org.apache.felix.scr.impl.DependencyManager.getBindingMethod(DependencyManager.java:793)&lt;br/&gt;
	at org.apache.felix.scr.impl.DependencyManager.getBindingMethod(DependencyManager.java:793)&lt;br/&gt;
	at org.apache.felix.scr.impl.DependencyManager.invokeBindMethod(DependencyManager.java:827)&lt;br/&gt;
	at org.apache.felix.scr.impl.DependencyManager.bind(DependencyManager.java:651)&lt;br/&gt;
	at org.apache.felix.scr.impl.ImmediateComponentManager.createImplementationObject(ImmediateComponentManager.java:203)&lt;br/&gt;
	at org.apache.felix.scr.impl.ImmediateComponentManager.createComponent(ImmediateComponentManager.java:133)&lt;br/&gt;
	at org.apache.felix.scr.impl.AbstractComponentManager.activateInternal(AbstractComponentManager.java:476)&lt;br/&gt;
	at org.apache.felix.scr.impl.AbstractComponentManager.enableInternal(AbstractComponentManager.java:398)&lt;br/&gt;
	at org.apache.felix.scr.impl.AbstractComponentManager.access$000(AbstractComponentManager.java:36)&lt;br/&gt;
	at org.apache.felix.scr.impl.AbstractComponentManager$1.run(AbstractComponentManager.java:99)&lt;br/&gt;
	at org.apache.felix.scr.impl.ComponentActorThread.run(ComponentActorThread.java:85)&lt;br/&gt;
07.07.2008 14:48:14.006 &lt;b&gt;ERROR&lt;/b&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;SCR Component Actor&amp;#93;&lt;/span&gt; com.cziegeler.test.b &lt;span class=&quot;error&quot;&gt;&amp;#91;com.c2.Test&amp;#93;&lt;/span&gt; bind() method not found&lt;/p&gt;</comment>
                            <comment id="12611143" author="cziegeler" created="Mon, 7 Jul 2008 12:51:50 +0000"  >&lt;p&gt;Updated test case with three bundles&lt;/p&gt;</comment>
                            <comment id="12611188" author="cziegeler" created="Mon, 7 Jul 2008 14:50:55 +0000"  >&lt;p&gt;As discussed in the list, the SCR implementation should not use the classloader of the component itself to load&lt;br/&gt;
the parameter classes for the bind/unbind methods. It should rather use the classloader of the class implementing&lt;br/&gt;
the bind/unbind methods.&lt;br/&gt;
I&apos;ve implemented a simpler variant which uses the classloader of the bundle exporting the service. This classloader&lt;br/&gt;
is definitly able to load the class (and has already loaded it as the service is available). Available with revision 674514.&lt;/p&gt;</comment>
                            <comment id="12625298" author="cziegeler" created="Mon, 25 Aug 2008 09:44:05 +0000"  >&lt;p&gt;This has been reimplemented to use the correct classloader with &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-694&quot; title=&quot;NullPointerException on shutdown&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-694&quot;&gt;&lt;del&gt;FELIX-694&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12385393" name="Archiv.zip" size="5237" author="cziegeler" created="Mon, 7 Jul 2008 12:51:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>58364</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 14 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14113:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>231629</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>