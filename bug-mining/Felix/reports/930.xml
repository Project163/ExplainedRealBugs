<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:16:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-2119] Bundle update fails, if OBR is not installed</title>
                <link>https://issues.apache.org/jira/browse/FELIX-2119</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;The reason for this is that UpdateHelper depends on OBR service API. While OBR is not a core service, its absence shouldn&apos;t disallow execution of normal bundle life-cycle commands.&lt;/p&gt;


&lt;p&gt;Stack trace:&lt;/p&gt;

&lt;p&gt;Exception: java.lang.NoClassDefFoundError: [Lorg/osgi/service/obr/Resource;&lt;br/&gt;
        at java.lang.Class.getDeclaredMethods0(Native Method)&lt;br/&gt;
        at java.lang.Class.privateGetDeclaredMethods(Unknown Source)&lt;br/&gt;
        at java.lang.Class.getDeclaredMethod(Unknown Source)&lt;br/&gt;
        at java.lang.Thread$1.run(Unknown Source)&lt;br/&gt;
        at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
        at java.lang.Thread.auditSubclass(Unknown Source)&lt;br/&gt;
        at java.lang.Thread.isCCLOverridden(Unknown Source)&lt;br/&gt;
        at java.lang.Thread.init(Unknown Source)&lt;br/&gt;
        at java.lang.Thread.&amp;lt;init&amp;gt;(Unknown Source)&lt;br/&gt;
        at org.apache.felix.webconsole.internal.core.BaseUpdateInstallHelper.&amp;lt;init&amp;gt;(BaseUpdateInstallHelper.java:45)&lt;br/&gt;
        at org.apache.felix.webconsole.internal.core.UpdateHelper.&amp;lt;init&amp;gt;(UpdateHelper.java:52)&lt;br/&gt;
        at org.apache.felix.webconsole.internal.core.UpdateHelper.&amp;lt;init&amp;gt;(UpdateHelper.java:46)&lt;br/&gt;
        at org.apache.felix.webconsole.internal.core.BundlesServlet$4.&amp;lt;init&amp;gt;(BundlesServlet.java:1283)&lt;br/&gt;
        at org.apache.felix.webconsole.internal.core.BundlesServlet.update(BundlesServlet.java:1282)&lt;br/&gt;
        at org.apache.felix.webconsole.internal.core.BundlesServlet.doPost(BundlesServlet.java:312)&lt;br/&gt;
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)&lt;br/&gt;
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:815)&lt;br/&gt;
        at org.apache.felix.webconsole.internal.servlet.OsgiManager.service(OsgiManager.java:372)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12457016">FELIX-2119</key>
            <summary>Bundle update fails, if OBR is not installed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fmeschbe">Felix Meschberger</assignee>
                                    <reporter username="v_valchev">Valentin Valchev</reporter>
                        <labels>
                    </labels>
                <created>Mon, 22 Feb 2010 15:38:09 +0000</created>
                <updated>Thu, 1 Apr 2010 11:50:38 +0000</updated>
                            <resolved>Wed, 3 Mar 2010 12:47:34 +0000</resolved>
                                                    <fixVersion>webconsole-3.0.0</fixVersion>
                                    <component>Web Console</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12840630" author="fmeschbe" created="Wed, 3 Mar 2010 12:31:24 +0000"  >&lt;p&gt;The problem is caused by the Thread.init method checking whether any security sensitive method, which is not final, is overwritten by the extension of the Thread class. This causes &amp;#8211; in the Sun VM &amp;#8211; all declared methods to be accessed which in turn causes the Resource interface to be required.&lt;/p&gt;

&lt;p&gt;By refactoring the BsaeUpdateInstaller class in Rev. 918442/918443 the Thread class is now not overwritten any more and thus the methods are not accessed any longer. This should fix this issue.&lt;/p&gt;</comment>
                            <comment id="12840638" author="fmeschbe" created="Wed, 3 Mar 2010 12:47:34 +0000"  >&lt;p&gt;Also have to use a constant string as RepositoryAdmin service name instead of &quot;RepositoryAdmin.class&quot; expression to prevent ClassDefNotFoundError. Fixed in Rev. 918449.&lt;/p&gt;

&lt;p&gt;This now completes fixing this issue.&lt;/p&gt;</comment>
                            <comment id="12841123" author="v_valchev" created="Thu, 4 Mar 2010 08:37:31 +0000"  >&lt;p&gt;Ok, now it works even if OBR is not installed. I&apos;m just curious why the updateFromBundleLocation() method is so complex?&lt;/p&gt;

&lt;p&gt;If we update a bundle from it&apos;s own location, then why bothering opening getting it&apos;s location, creating URL, getting the stream, update from the new stream, and then make sure stream is closed ..&lt;/p&gt;

&lt;p&gt;Isn&apos;t it better to leave the framework do it&apos;s job and just use bundle.update(), instead of bundle.update(InputStream). Plus, the framework might have some optimizations on this update, and may perform it faster, than us (example it might internally cache the URL object for the location, might also check last updated time of the URLConnection, and if no-later than current, might decide to simply ignore the update operation).&lt;/p&gt;

&lt;p&gt;So IMHO, the method show be:&lt;br/&gt;
private boolean updateFromBundleLocation() throws BundleException&lt;br/&gt;
    {&lt;br/&gt;
        getLog().log( LogService.LOG_DEBUG, &quot;Trying to update from bundle location &quot; + location );&lt;/p&gt;

&lt;p&gt;        try&lt;/p&gt;
        {
                bundle.update();
                getLog().log( LogService.LOG_INFO, &quot;Bundle updated from bundle location &quot; + location );
                return true;
            }
&lt;p&gt;        }&lt;br/&gt;
        catch ( Throwable ioe )&lt;/p&gt;
        {
            // BundleException, IllegalStateException or SecurityException? lets use OBR then
            getLog().log( LogService.LOG_DEBUG, &quot;Update failure from bundle location &quot; + location, ioe );
        }
&lt;p&gt;        // not installed from the bundle location&lt;br/&gt;
        return false;&lt;br/&gt;
    }&lt;/p&gt;</comment>
                            <comment id="12841156" author="fmeschbe" created="Thu, 4 Mar 2010 10:06:20 +0000"  >&lt;p&gt;You are right &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Created &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-2167&quot; title=&quot;Simplify UpdateHelper.updateFromBundleLocation method&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-2167&quot;&gt;&lt;del&gt;FELIX-2167&lt;/del&gt;&lt;/a&gt; to track this change&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56615</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 38 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0vwyf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>184312</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>