<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:58:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-4957] [DS][RFC-212] Various issues with field references</title>
                <link>https://issues.apache.org/jira/browse/FELIX-4957</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;1. The DS spec states that non-volatile fields with dynamic references is an error. These fields must not be injected. See 112.3.8.1:&lt;/p&gt;

&lt;p&gt;&quot;For a dynamic reference, the field must be declared with the volatile modifier so that field value changes made by SCR are visible to other threads. If the field is not declared with the volatile modifier, SCR must log an error message with the Log Service, if present, and the field must not be modified.&quot;&lt;/p&gt;

&lt;p&gt;2. When a field with a dynamic reference holds the service properties of the referenced service, the field must be modified when the referenced service&apos;s properties are changed.&lt;/p&gt;

&lt;p&gt;See 112.3.8.1: &quot;For a dynamic reference with unary cardinality, SCR must set the field with initial bound service, if any, before the component instance is activated. When there is a new bound service or the service properties of the bound service are modified and the field holds service properties, SCR must replace the field value. &quot;&lt;/p&gt;

&lt;p&gt;3. When a component uses a static field reference holding properties for the referenced service and these service properties change, DS must reactivate the component to inject the updated service properties.&lt;/p&gt;

&lt;p&gt;See 112.3.8.1: &quot;For a static reference, SCR must set the value of the field before the component instance is activat- ed and must not change the field while the component is active.&quot;&lt;br/&gt;
So the component must be reactivated to receive the updated service properties.&lt;/p&gt;

&lt;p&gt;4. When a final field is used as a reference, DS must activate the component but not set the field value.&lt;/p&gt;

&lt;p&gt;See 112.3.8.1: &quot;If the field is declared with the final modifier, SCR must log an error message with the Log Service, if present, and the field must not be modified.&quot;&lt;/p&gt;

&lt;p&gt;5. If a field reference is optional and there is no bound service, DS must null the field.&lt;/p&gt;

&lt;p&gt;See 112.3.8.1: &quot;If the reference has optional cardinality and there is no bound service, SCR must set the field value to null.&quot;&lt;/p&gt;

&lt;p&gt;6. The spec says that for an optional reference with no target services, DS must inject an empty mutable collection/list. Currentyl DS is not injecting the field and leaving the constructor set value.&lt;/p&gt;

&lt;p&gt;From 112.3.8.1:&lt;br/&gt;
&quot;Before the component instance is activated, SCR must set the field with a new mutable collection that must contain the initial set of bound services sorted using the same ordering as ServiceReference.compareTo based upon service ranking and service id. The new collection may be empty if the reference has optional cardinality and there are no bound services.&quot;&lt;/p&gt;

&lt;p&gt;7. The DS spec, 112.3.8, says:&lt;/p&gt;

&lt;p&gt;&quot;If the update option is used when not permitted, SCR must log an error message with the Log Service, if present, and the field must not be modified.&quot;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12844365">FELIX-4957</key>
            <summary>[DS][RFC-212] Various issues with field references</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cziegeler">Carsten Ziegeler</assignee>
                                    <reporter username="cziegeler">Carsten Ziegeler</reporter>
                        <labels>
                    </labels>
                <created>Sat, 11 Jul 2015 11:47:39 +0000</created>
                <updated>Mon, 14 Dec 2015 13:40:54 +0000</updated>
                            <resolved>Thu, 16 Jul 2015 07:04:43 +0000</resolved>
                                                    <fixVersion>scr-2.0.0</fixVersion>
                                    <component>Declarative Services (SCR)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14623399" author="cziegeler" created="Sat, 11 Jul 2015 13:47:14 +0000"  >&lt;p&gt;Fixed the following issues in rev 1690370&lt;br/&gt;
1. The check for volatile was not done in all cases - and if it failed, the component was not activated. Added missing checks and added a way to ignore the reference but activate the component&lt;br/&gt;
4. If a final field was used, component was not activated - now the field is ignored but the component is activated.&lt;/p&gt;</comment>
                            <comment id="14623427" author="cziegeler" created="Sat, 11 Jul 2015 14:48:26 +0000"  >&lt;p&gt;Fixed the following issue in rev 1690372:&lt;/p&gt;

&lt;p&gt;2. When a field with a dynamic reference holds the service properties of the referenced service, the field must be modified when the referenced service&apos;s properties are changed.&lt;/p&gt;</comment>
                            <comment id="14623723" author="cziegeler" created="Sun, 12 Jul 2015 09:31:00 +0000"  >&lt;p&gt;Fixed the following issue in rev 1690437:&lt;br/&gt;
5. If a field reference is optional and there is no bound service, DS must null the field.&lt;/p&gt;</comment>
                            <comment id="14623738" author="cziegeler" created="Sun, 12 Jul 2015 10:28:18 +0000"  >&lt;p&gt;Fixed the remaining issue in rev 1690440:&lt;br/&gt;
3. When a component uses a static field reference holding properties for the referenced service and these service properties change, DS must reactivate the component to inject the updated service properties.&lt;/p&gt;</comment>
                            <comment id="14625857" author="cziegeler" created="Tue, 14 Jul 2015 05:42:19 +0000"  >&lt;p&gt;Fixed this issue in rev 1690864:&lt;br/&gt;
 The spec says that for an optional reference with no target services, DS must inject an empty mutable collection/list. Currentyl DS is not injecting the field and leaving the constructor set value.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12921665">FELIX-5139</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 19 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2h4x3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>