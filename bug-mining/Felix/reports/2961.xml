<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 16:11:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-5601] issues resolving with substitutable exports when the export is the last available provider</title>
                <link>https://issues.apache.org/jira/browse/FELIX-5601</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;Substitutable exports that are used by other exported packages can cause a case where a valid solution cannot be found when one exists.  The issue only can occur when a substitutable export is the only valid candidate left for a resources mandatory requirement and the resolver decides to permute the substitutable requirement becaused of a used blame.  Something like the following resources&lt;/p&gt;

&lt;p&gt;resource A1&lt;br/&gt;
  provides pkg X v1&lt;br/&gt;
  provides pkg Y v1 uses-&amp;gt;X&lt;br/&gt;
  provides pkg Z v1 uses-&amp;gt;Y&lt;/p&gt;

&lt;p&gt;resource A2&lt;br/&gt;
  provides pkg X v2&lt;br/&gt;
  provides pkg Y v2 uses-&amp;gt;X&lt;br/&gt;
  provides pkg Z v2 uses-&amp;gt;Y&lt;br/&gt;
  import pkg X v[2,4)&lt;br/&gt;
  import pkg Y v[2,4)&lt;br/&gt;
  import pkg Z v[2,4)&lt;/p&gt;

&lt;p&gt;resource A3&lt;br/&gt;
  provides pkg X v3&lt;br/&gt;
  provides pkg Y v3 uses-&amp;gt;X&lt;br/&gt;
  provides pkg Z v3 uses-&amp;gt;Y&lt;br/&gt;
  import pkg X v[2,4)&lt;br/&gt;
  import pkg Y v[2,4)&lt;br/&gt;
  import pkg Z v[2,4)&lt;/p&gt;

&lt;p&gt;resource B1&lt;br/&gt;
  provides pkg W v1 uses-&amp;gt;Z&lt;br/&gt;
  import pkg Z v[1,4)&lt;/p&gt;

&lt;p&gt;resource C1&lt;br/&gt;
  imports pkg X v[3,4)&lt;/p&gt;

&lt;p&gt;Resolve all resources A1, A2, A3, B1, C1 as mandatory resources.  This will result in resolution error for B1 because it is exposed to two versions of X through two uses blame chains.  The reason this fails is because the resolver first chooses to permute the substitutable requirement from A3 for X which causes X v3 to no longer be available for C1 to import.  This causes an error and the permutation fails and all other permutations based off that permutation will be ignored.  If instead the resolver would not permute the requirement for X from A3 the resolver would find a valid solution.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13059603">FELIX-5601</key>
            <summary>issues resolving with substitutable exports when the export is the last available provider</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tjwatson">Tom Watson</assignee>
                                    <reporter username="tjwatson">Tom Watson</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Mar 2017 02:39:05 +0000</created>
                <updated>Tue, 4 Jul 2017 15:05:48 +0000</updated>
                            <resolved>Tue, 28 Mar 2017 21:50:23 +0000</resolved>
                                                    <fixVersion>resolver-1.14.0</fixVersion>
                                    <component>Resolver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="15944432" author="tjwatson" created="Tue, 28 Mar 2017 02:48:44 +0000"  >&lt;p&gt;Fixed by not allowing an export to be substituted in a permutation when the export is the only available export left for another mandatory requirement.  I added some implementation notes in the code to explain why this is needed.&lt;/p&gt;</comment>
                            <comment id="15945979" author="tjwatson" created="Tue, 28 Mar 2017 21:13:31 +0000"  >&lt;p&gt;I&apos;ve found an issue with the current fix that needs addressed.&lt;/p&gt;

&lt;p&gt;The original fix has issues with assuming the Candidates::m_dependenMap&lt;br/&gt;
is updated as the CandidateSelectors moved on to the next candidate.&lt;br/&gt;
An additional check is needed to make sure the current candidate is the&lt;br/&gt;
one that could be substituted.&lt;/p&gt;

&lt;p&gt;This also exposed an issue with the solution for the testcase&lt;br/&gt;
that has a long blame requirement chain.  In this case we have&lt;br/&gt;
historically started at the direct requirement for the conflicting&lt;br/&gt;
capability and worked our way back to the root requirement for&lt;br/&gt;
the blame chain.&lt;/p&gt;

&lt;p&gt;This worked for the most part when we didn&apos;t pay attention to&lt;br/&gt;
substitutable capabilities when permuting, but I suspect there&lt;br/&gt;
were still cases where this would eliminate.  Now that we are paying attention to substitutions there are cases where the solution will be found if we start traversing from the root -&amp;gt; direct requirement in the blame chain.&lt;/p&gt;</comment>
                            <comment id="15946037" author="tjwatson" created="Tue, 28 Mar 2017 21:50:23 +0000"  >&lt;p&gt;I fixed this by doing an additional check in Candidates::canRemoveCandidate that makes sure the current candidate of the dependent CandidateSelector is the candidate that is about to be substituted.&lt;/p&gt;

&lt;p&gt;I also did the change to traverse the blame requirement chain from direct-&amp;gt;root and root-&amp;gt;direct requirement to be sure to find a solution if it exists.  This was necessary to pass the test testScenario18 which has a blame chain with 4 reqs.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="13084580">FELIX-5663</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 34 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3cvdz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>