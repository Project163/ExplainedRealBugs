<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:34:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-3346] File Install doesn&apos;t scan when the framework start level is lower than felix.fileinstall.start.level setting</title>
                <link>https://issues.apache.org/jira/browse/FELIX-3346</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;1. Set the OSGi start-level to 100 (Karaf default).&lt;/p&gt;

&lt;p&gt;2. Configure the following setting in the system properties or factory config for FileInstall:&lt;br/&gt;
    felix.fileinstall.start.level = 150&lt;/p&gt;

&lt;p&gt;3. Drop something in a folder watched by the File Install component. No bundles get installed or updated.&lt;/p&gt;

&lt;p&gt;Expected behaviour is that bundles get installed, and obviously without them starting.&lt;/p&gt;</description>
                <environment>Karaf 2.2.5, Windows</environment>
        <key id="12542136">FELIX-3346</key>
            <summary>File Install doesn&apos;t scan when the framework start level is lower than felix.fileinstall.start.level setting</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gnodet">Guillaume Nodet</assignee>
                                    <reporter username="albertdevs">Bert Jacobs</reporter>
                        <labels>
                    </labels>
                <created>Fri, 10 Feb 2012 15:35:13 +0000</created>
                <updated>Tue, 17 Mar 2015 07:00:46 +0000</updated>
                            <resolved>Fri, 16 Mar 2012 08:12:49 +0000</resolved>
                                                    <fixVersion>fileinstall-3.2.0</fixVersion>
                                    <component>File Install</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13205510" author="albertdevs" created="Fri, 10 Feb 2012 15:39:21 +0000"  >&lt;p&gt;Just a note for someone willing to work on this:&lt;br/&gt;
fileinstall/src/main/java/org/apache/felix/fileinstall/internal/DirectoryWatcher.java has the following on line 262:&lt;br/&gt;
                // Waiting for start level&lt;br/&gt;
                if (FileInstall.getStartLevel().getStartLevel() &amp;gt;= startLevel)&lt;br/&gt;
                {&lt;br/&gt;
                    Set/&lt;b&gt;&amp;lt;File&amp;gt;&lt;/b&gt;/ files = scanner.scan(false);&lt;br/&gt;
                    // Check that there is a result.  If not, this means that the directory can not be listed,&lt;br/&gt;
                    // so it&apos;s presumably not a valid directory (it may have been deleted by someone).&lt;br/&gt;
                    // In such case, just sleep&lt;br/&gt;
                    if (files != null)&lt;/p&gt;
                    {
                        process(files);
                    }
&lt;p&gt;                }&lt;/p&gt;

&lt;p&gt;I&apos;m not sure why that if was added (maybe process(...) has no idea about the start level) but this causes the component to idle when the start level configured in felix.fileinstall.start.level is not reached.&lt;/p&gt;</comment>
                            <comment id="13220911" author="albertdevs" created="Fri, 2 Mar 2012 13:26:05 +0000"  >&lt;p&gt;Issue &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-2021&quot; title=&quot;Enable FileInstall to set Bundle Start Level&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-2021&quot;&gt;&lt;del&gt;FELIX-2021&lt;/del&gt;&lt;/a&gt; introduced the start level feature. The comments mention that the scanner now waits for the start level because all bundles were automatically started, even when they weren&apos;t supposed to.&lt;/p&gt;

&lt;p&gt;I&apos;ll see if I can supply a patch which fixes this issue but doesn&apos;t start bundles unless the right start level is reached.&lt;/p&gt;</comment>
                            <comment id="13227107" author="albertdevs" created="Sun, 11 Mar 2012 17:41:48 +0000"  >&lt;p&gt;I&apos;ve attached a patch (&quot;fileinstall-lognstartlvl.patch&quot;) which changes&lt;br/&gt;
the following things: &lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;When I configured the &quot;felix.fileinstall.start.level&quot; setting, the&lt;br/&gt;
component wouldn&apos;t run update or refresh when the framework&apos;s start&lt;br/&gt;
level is too low. I&apos;ve introduced a new setting&lt;br/&gt;
&quot;felix.fileinstall.active.level&quot; to configure the scan behaviour, e.g.&lt;br/&gt;
so you can set it higher than the system bundle start-level so that&lt;br/&gt;
the framework bundles resolve first. By default, the file install&lt;br/&gt;
component now always updates, irregardless of the&lt;br/&gt;
&quot;felix.fileinstall.start.level&quot; setting.&lt;/li&gt;
	&lt;li&gt;The bundle start level is now only set when a bundle is installed&lt;br/&gt;
and not every time a bundle gets restarted. I&apos;d expect that a user&lt;br/&gt;
should be able to override the bundle start level instead of it being&lt;br/&gt;
reset each time the file install component triggers a bundle start.&lt;/li&gt;
	&lt;li&gt;The bundle-start-level and start-new-bundles settings now work independently. The bundle start-level will get updated when configured, but the bundle will not be persistently started unless the start-setting is also true.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Please note that these changes might warrant a new minor release instead of a bug fix release.&lt;/p&gt;</comment>
                            <comment id="13230547" author="albertdevs" created="Thu, 15 Mar 2012 21:09:19 +0000"  >&lt;p&gt;I&apos;m going to make a new patch... This one&apos;s faulty.&lt;/p&gt;</comment>
                            <comment id="13230554" author="gnt" created="Thu, 15 Mar 2012 21:13:11 +0000"  >&lt;p&gt;I&apos;m planning to do a release asap, so let me know when you think you&apos;ll have a working patch.&lt;/p&gt;</comment>
                            <comment id="13230571" author="albertdevs" created="Thu, 15 Mar 2012 21:26:46 +0000"  >&lt;p&gt;I&apos;ve been testing the new code today, but I want to do one last test. I guess it&apos;ll be ready within the hour.&lt;/p&gt;</comment>
                            <comment id="13230640" author="albertdevs" created="Thu, 15 Mar 2012 22:25:36 +0000"  >&lt;p&gt;Updated patch (fileinstall-startlevel2.patch) attached.&lt;/p&gt;

&lt;p&gt;Any bundles which can&apos;t be started at install time will now use a &quot;delayed start&quot;; i.e. when the framework start level is raised, those bundles will attempt another start.&lt;/p&gt;

&lt;p&gt;This patch also mitigates a ConcurrentModificationException in the bundleChanged method.&lt;/p&gt;</comment>
                            <comment id="13230650" author="albertdevs" created="Thu, 15 Mar 2012 22:32:48 +0000"  >&lt;p&gt;Ok, the patch is done.&lt;/p&gt;

&lt;p&gt;Please let me know if there are any issues with this patch or the one I submitted for &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-3373&quot; title=&quot;File install logging doesn&amp;#39;t notify user of important errors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-3373&quot;&gt;&lt;del&gt;FELIX-3373&lt;/del&gt;&lt;/a&gt; (file install logging).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12447052">FELIX-2021</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310051">
                    <name>Supercedes</name>
                                            <outwardlinks description="supercedes">
                                        <issuelink>
            <issuekey id="12495924">FELIX-2787</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12518559" name="fileinstall-startlevel2.patch" size="7440" author="albertdevs" created="Thu, 15 Mar 2012 22:25:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>227423</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 36 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i07g9r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>41402</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>