<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 16:04:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-5387] NPE for requests missing &apos;felix-webconsole-locale&apos; cookie</title>
                <link>https://issues.apache.org/jira/browse/FELIX-5387</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;Issuing a request without &apos;felix-webconsole-locale&apos; cookies throws a NPE similar to &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;24.10.2016 12:44:44.617 *ERROR* [qtp1226339741-3423] org.apache.felix.http.jetty Exception &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing request to /system/console/configMgr (java.lang.NullPointerException)
java.lang.NullPointerException: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
	at org.apache.felix.webconsole.internal.servlet.OsgiManager.ensureLocaleCookieSet(OsgiManager.java:502)
	at org.apache.felix.webconsole.internal.servlet.OsgiManager.service(OsgiManager.java:561)
	at org.apache.felix.webconsole.internal.servlet.OsgiManager$3.run(OsgiManager.java:465)
	at java.security.AccessController.doPrivileged(Native Method)
	at org.apache.felix.webconsole.internal.servlet.OsgiManager.service(OsgiManager.java:461)
	at org.apache.felix.http.base.internal.handler.ServletHandler.handle(ServletHandler.java:85)
	at org.apache.felix.http.base.internal.dispatch.InvocationChain.doFilter(InvocationChain.java:79)
	at com.adobe.granite.license.impl.LicenseCheckFilter.doFilter(LicenseCheckFilter.java:308)
	at org.apache.felix.http.base.internal.handler.FilterHandler.handle(FilterHandler.java:135)
	at org.apache.felix.http.base.internal.dispatch.InvocationChain.doFilter(InvocationChain.java:74)
	at org.apache.felix.http.sslfilter.internal.SslFilter.doFilter(SslFilter.java:96)
	at org.apache.felix.http.base.internal.handler.FilterHandler.handle(FilterHandler.java:135)
	at org.apache.felix.http.base.internal.dispatch.InvocationChain.doFilter(InvocationChain.java:74)
	at org.apache.sling.security.impl.ReferrerFilter.doFilter(ReferrerFilter.java:295)
	at org.apache.felix.http.base.internal.handler.FilterHandler.handle(FilterHandler.java:135)
	at org.apache.felix.http.base.internal.dispatch.InvocationChain.doFilter(InvocationChain.java:74)
	at org.apache.sling.i18n.impl.I18NFilter.doFilter(I18NFilter.java:133)
	at org.apache.felix.http.base.internal.handler.FilterHandler.handle(FilterHandler.java:135)
	at org.apache.felix.http.base.internal.dispatch.InvocationChain.doFilter(InvocationChain.java:74)
	at org.apache.felix.http.base.internal.dispatch.Dispatcher.dispatch(Dispatcher.java:128)
	at org.apache.felix.http.base.internal.dispatch.DispatcherServlet.service(DispatcherServlet.java:49)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:725)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:812)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:587)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:221)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1127)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1061)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:215)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)
	at org.eclipse.jetty.server.Server.handle(Server.java:499)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:311)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)
	at org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:544)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13014731">FELIX-5387</key>
            <summary>NPE for requests missing &apos;felix-webconsole-locale&apos; cookie</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cziegeler">Carsten Ziegeler</assignee>
                                    <reporter username="marett">Timothee Maret</reporter>
                        <labels>
                    </labels>
                <created>Mon, 24 Oct 2016 14:10:55 +0000</created>
                <updated>Fri, 13 Jan 2017 20:45:42 +0000</updated>
                            <resolved>Tue, 25 Oct 2016 19:13:17 +0000</resolved>
                                    <version>webconsole-4.2.16</version>
                                    <fixVersion>webconsole-4.2.18</fixVersion>
                                    <component>Web Console</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15602106" author="marett" created="Mon, 24 Oct 2016 14:14:50 +0000"  >&lt;p&gt;As an example, the following authenticated request throws a NPE&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;curl &lt;span class=&quot;code-quote&quot;&gt;&apos;http:&lt;span class=&quot;code-comment&quot;&gt;//10.131.170.170:4504/system/console/bundles&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Pragma: no-cache&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;DNT: 1&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Accept-Encoding: gzip, deflate, sdch&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Accept-Language: en-US,en;q=0.8,fr;q=0.6&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Upgrade-Insecure-Requests: 1&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Cache-Control: no-cache&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Authorization: Basic YWRtaW46YWRtaW4=&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Connection: keep-alive&apos;&lt;/span&gt; --compressed&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and the same request with added cookie succeeds&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;curl &lt;span class=&quot;code-quote&quot;&gt;&apos;http:&lt;span class=&quot;code-comment&quot;&gt;//10.131.170.170:4504/system/console/bundles&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Pragma: no-cache&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;DNT: 1&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Accept-Encoding: gzip, deflate, sdch&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Accept-Language: en-US,en;q=0.8,fr;q=0.6&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Upgrade-Insecure-Requests: 1&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Cache-Control: no-cache&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Authorization: Basic YWRtaW46YWRtaW4=&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Connection: keep-alive&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Cookie: felix-webconsole-locale=en&apos;&lt;/span&gt; --compressed&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Debugging it, the NPE is thrown at&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/felix/blob/trunk/webconsole/src/main/java/org/apache/felix/webconsole/internal/servlet/OsgiManager.java#L498&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/blob/trunk/webconsole/src/main/java/org/apache/felix/webconsole/internal/servlet/OsgiManager.java#L498&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;with the method call&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;locale.toString()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;indeed, the &lt;tt&gt;locale&lt;/tt&gt;&#160;is &lt;tt&gt;null&lt;/tt&gt; at that point.&lt;/p&gt;</comment>
                            <comment id="15602129" author="cziegeler" created="Mon, 24 Oct 2016 14:21:35 +0000"  >&lt;p&gt;This is not a bug in the web console, a fallback in the  code is using request.getLocale() which must not return NULL.&lt;br/&gt;
So it seems there is a faulty request implementation that returns null.&lt;br/&gt;
We could add a workround in the web console to avoid an NPE, but still the real bug is somewhere else&lt;/p&gt;</comment>
                            <comment id="15604756" author="marett" created="Tue, 25 Oct 2016 09:23:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cziegeler&quot; class=&quot;user-hover&quot; rel=&quot;cziegeler&quot;&gt;cziegeler&lt;/a&gt; thanks for looking at this! The &lt;tt&gt;javax.servlet.ServletRequest#getLocale&lt;/tt&gt; JavaDoc is not super clear whether it may return &lt;tt&gt;null&lt;/tt&gt; or not in case there is no default server locale configured.&lt;br/&gt;
I am fine with assuming it must not return &lt;tt&gt;null&lt;/tt&gt; and therefor the issue is rooted somewhere else as you wrote.&lt;br/&gt;
No need to workaround it.&lt;br/&gt;
Closing.&lt;/p&gt;</comment>
                            <comment id="15605929" author="cziegeler" created="Tue, 25 Oct 2016 17:32:25 +0000"  >&lt;p&gt;I think it makes sense to catch the NPE nevertheless and fail gracefully&lt;/p&gt;</comment>
                            <comment id="15606199" author="cziegeler" created="Tue, 25 Oct 2016 19:13:17 +0000"  >&lt;p&gt;I&apos;ve added falling back to english as the default, if there is a faulty filter in the processing chain&lt;/p&gt;</comment>
                            <comment id="15713769" author="alexander.klimetschek" created="Fri, 2 Dec 2016 02:15:31 +0000"  >&lt;p&gt;FWIW, I was seeing the same issue using &lt;tt&gt;sling:install&lt;/tt&gt; installing a bundle to the webconsole, while not all bundles were up on my system (it is likely that a custom &lt;tt&gt;request.getLocale()&lt;/tt&gt; implementation on our system returned null due to this state). Good to see it guarded.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 50 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i35av3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>