<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:09:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-969] System bundle does not correctly handle (export) package attributes</title>
                <link>https://issues.apache.org/jira/browse/FELIX-969</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;This issue is related to the follwing mailing list thread:&lt;br/&gt;
&lt;a href=&quot;http://www.mail-archive.com/users@felix.apache.org/msg03403.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.mail-archive.com/users@felix.apache.org/msg03403.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Section 3.5.5 of the OSGi core specification (4.1) states:&lt;/p&gt;

&lt;p&gt;  The Framework will automatically associate each package export definition&lt;br/&gt;
  with the following attributes:&lt;/p&gt;

&lt;p&gt;    &#8226; bundle-symbolic-name - The bundle symbolic name of the exporting&lt;br/&gt;
      bundle. In the case of a Fragment bundle, this is the host bundle&apos;s symbolic&lt;br/&gt;
      name.&lt;br/&gt;
    &#8226; bundle-version - The bundle version of the exporting bundle. In the case&lt;br/&gt;
      of a Fragment bundle, this is the host bundle&apos;s version.&lt;/p&gt;

&lt;p&gt;And section 3.6.5 specifies how these attributes must be applied when resolving&lt;br/&gt;
packages.&lt;/p&gt;

&lt;p&gt;Using Apache Felix Version 1.4.1 I have encountered the following behaviour &lt;br/&gt;
when using different approaches to import packages exported by the system bundle&lt;br/&gt;
(org.apache.felix.framework respectively system.bundle) when using attribute&lt;br/&gt;
matching:&lt;/p&gt;

&lt;p&gt;For the following test cases the bundle manifest of the system bundle looks like&lt;br/&gt;
this:&lt;/p&gt;

&lt;p&gt;  Bundle-Version = 1.4.1&lt;br/&gt;
  Bundle-Name = System Bundle&lt;br/&gt;
  Bundle-SymbolicName = org.apache.felix.framework&lt;br/&gt;
  Export-Package = my.package; provider=&quot;xxx&quot;, ...&lt;/p&gt;

&lt;p&gt;Test Case 1:&lt;/p&gt;

&lt;p&gt;   Import-Package: my.package;bundle-symbolic-name=&quot;system.bundle&quot;&lt;/p&gt;

&lt;p&gt; Result: Package my.package could not be resolved!&lt;/p&gt;


&lt;p&gt;Test Case 2:&lt;/p&gt;

&lt;p&gt;   Import-Package: my.package;bundle-symbolic-name=&quot;org.apache.felix.framework&quot;&lt;/p&gt;

&lt;p&gt; Result: Package my.package could not be resolved!&lt;/p&gt;


&lt;p&gt;Test Case 3:&lt;/p&gt;

&lt;p&gt;   Import-Package: my.package;provider=&quot;xxx&quot;&lt;/p&gt;

&lt;p&gt; Result: Package my.package was resolved successfully.&lt;/p&gt;


&lt;p&gt;Test Case 4:&lt;/p&gt;

&lt;p&gt;   DynamicImport-Package: *;bundle-symbolic-name=&quot;system.bundle&quot;&lt;/p&gt;

&lt;p&gt; Result: Package my.package could not be resolved (class not found at runtime)!&lt;/p&gt;


&lt;p&gt;Test Case 2:&lt;/p&gt;

&lt;p&gt;   DynamicImport-Package: *;bundle-symbolic-name=&quot;org.apache.felix.framework&quot;&lt;/p&gt;

&lt;p&gt; Result: Package my.package could not be resolved (class not found at runtime)!&lt;/p&gt;


&lt;p&gt;Test Case 3:&lt;/p&gt;

&lt;p&gt;   DynamicImport-Package: my.package;provider=&quot;xxx&quot;&lt;/p&gt;

&lt;p&gt; Result: Package my.package was resolved successfully (at runtime).&lt;/p&gt;

&lt;p&gt;The same behaviour is also true for packages that are added to the list of &lt;br/&gt;
exported packages of the system bundle by extension bundles (fragment bundles &lt;br/&gt;
with extension:=framework). For such packages another problem arises as the &lt;br/&gt;
matching attributes as defined in the Export-Package header of the extension &lt;br/&gt;
bundle are not taken over by the system bundle. So for example if the extension&lt;br/&gt;
bundle has the following export:&lt;/p&gt;

&lt;p&gt;   Export-Package my.package;provider=&quot;xxx&quot;;version=&quot;1.0.0&quot;&lt;/p&gt;

&lt;p&gt;Then the system bundle seems to discard the attribute &quot;provider&quot; but respects the&lt;br/&gt;
version attribute:&lt;/p&gt;

&lt;p&gt;   Export-Package my.package;version=&quot;1.0.0&quot;&lt;/p&gt;

&lt;p&gt;So it looks as if the framework should be fixed to always add the automatic attributes to &lt;br/&gt;
exported packages (as defined in 3.5.5). Furthermore it should also make sure that all&lt;br/&gt;
other (non automatic) attributes are respected especially for exorts that are added by&lt;br/&gt;
extension bundles.&lt;/p&gt;</description>
                <environment>java version &amp;quot;1.6.0_07&amp;quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.6.0_07-b06)&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM (build 10.0-b23, mixed mode)&lt;br/&gt;
SunOS castor 5.10 Generic_137111-08 sun4u sparc SUNW,Sun-Fire-V890</environment>
        <key id="12416082">FELIX-969</key>
            <summary>System bundle does not correctly handle (export) package attributes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rickhall">Richard S. Hall</assignee>
                                    <reporter username="alexberger">Alexander Berger</reporter>
                        <labels>
                    </labels>
                <created>Wed, 4 Mar 2009 08:18:16 +0000</created>
                <updated>Mon, 11 May 2009 18:43:31 +0000</updated>
                            <resolved>Tue, 5 May 2009 20:18:03 +0000</resolved>
                                    <version>framework-1.4.1</version>
                                    <fixVersion>framework-1.6.0</fixVersion>
                                    <component>Framework</component>
                    <component>Specification compliance</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12679711" author="rickhall" created="Fri, 6 Mar 2009 20:24:24 +0000"  >&lt;p&gt;Yes, this definitely is a bug. I have modified the trunk so that system bundle exports correctly have bundle symbolic name and bundle version attributes attached to them. The symbolic name is properly alias to be &quot;system.bundle&quot; as well as &quot;org.apache.felix.framework&quot;. So, in the normal case, this should now be working in the trunk.&lt;/p&gt;

&lt;p&gt;Regarding system bundle extensions, they are currently broken in the trunk due to other refactoring work, so I will not close this issue until I get them working again, which will include a fix for this.&lt;/p&gt;</comment>
                            <comment id="12682667" author="rickhall" created="Tue, 17 Mar 2009 12:59:06 +0000"  >&lt;p&gt;We just committed a patch for system bundle extensions and have some tests indicating it is working. I deployed new snapshots. Please close this issue if satisfied. Thanks.&lt;/p&gt;</comment>
                            <comment id="12704545" author="alexberger" created="Thu, 30 Apr 2009 09:27:33 +0000"  >&lt;p&gt;I reopen this issue as it is still not completely fixed. The test cases show&lt;br/&gt;
(see below) that imports using the &quot;bundle-symblic-name&quot; attribute still do not&lt;br/&gt;
work for packages that are added by extension bundles (fragment bundles&lt;br/&gt;
with extension:=framework).&lt;/p&gt;

&lt;p&gt;I have created the following test scenario consisting of two bundles. The&lt;br/&gt;
first bundle (called the Provider bundle) looks like this:&lt;/p&gt;

&lt;p&gt; Manifest-Version: 1.0&lt;br/&gt;
 Bundle-ManifestVersion: 2&lt;br/&gt;
 Bundle-Name: Provider&lt;br/&gt;
 Bundle-SymbolicName: Provider&lt;br/&gt;
 Bundle-Version: 1.0.0&lt;br/&gt;
 Export-Package: normal.export;provider=bundle&lt;/p&gt;

&lt;p&gt;The second bundle (called the Fragment bundle) looks like this:&lt;/p&gt;

&lt;p&gt; Manifest-Version: 1.0&lt;br/&gt;
 Bundle-ManifestVersion: 2&lt;br/&gt;
 Bundle-Name: Fragment&lt;br/&gt;
 Bundle-SymbolicName: Fragment&lt;br/&gt;
 Bundle-Version: 1.0.0&lt;br/&gt;
 Fragment-Host: system.bundle;extension:=framework&lt;br/&gt;
 Export-Package: fragment.export;provider=  &lt;/p&gt;


&lt;p&gt;Then I created the following bundles to test each single scenario:&lt;/p&gt;

&lt;p&gt;Case 1: Import using the bundle-symbolic-name attribute:&lt;br/&gt;
--------------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt; Manifest-Version: 1.0&lt;br/&gt;
 Bundle-ManifestVersion: 2&lt;br/&gt;
 Bundle-Name: Case 1&lt;br/&gt;
 Bundle-SymbolicName: Case.1&lt;br/&gt;
 Bundle-Version: 1.0.0&lt;br/&gt;
 Bundle-Activator: dummy.Activator&lt;br/&gt;
 Import-Package: org.osgi.framework,&lt;br/&gt;
  normal.export;bundle-symbolic-name=&quot;Provider&quot;;resolution:=optional,&lt;br/&gt;
  fragment.export;bundle-symbolic-name=&quot;system.bundle&quot;;resolution:=optional&lt;/p&gt;

&lt;p&gt;Result:&lt;br/&gt;
    package                   resolved&lt;br/&gt;
    ----------------------------------&lt;br/&gt;
    normal.export             ok&lt;br/&gt;
    fragment.export           failed&lt;/p&gt;


&lt;p&gt;Case 2: Import using the bundle-symbolic-name attribute 2:&lt;br/&gt;
--------------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt; Manifest-Version: 1.0&lt;br/&gt;
 Bundle-ManifestVersion: 2&lt;br/&gt;
 Bundle-Name: Case 2&lt;br/&gt;
 Bundle-SymbolicName: Case.2&lt;br/&gt;
 Bundle-Version: 1.0.0&lt;br/&gt;
 Bundle-Activator: dummy.Activator&lt;br/&gt;
 Import-Package: org.osgi.framework,&lt;br/&gt;
  normal.export;bundle-symbolic-name=&quot;Provider&quot;;resolution:=optional,&lt;br/&gt;
  fragment.export;bundle-symbolic-name=&quot;org.apache.felix.framework&quot;;resolution:=optional&lt;/p&gt;

&lt;p&gt;Result:&lt;br/&gt;
    package                   resolved&lt;br/&gt;
    ----------------------------------&lt;br/&gt;
    normal.export             ok&lt;br/&gt;
    fragment.export           failed&lt;/p&gt;


&lt;p&gt;Case 3: Import using the bundle-symbolic-name attribute 3:&lt;br/&gt;
--------------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt; Manifest-Version: 1.0&lt;br/&gt;
 Bundle-ManifestVersion: 2&lt;br/&gt;
 Bundle-Name: Case 3&lt;br/&gt;
 Bundle-SymbolicName: Case.3&lt;br/&gt;
 Bundle-Version: 1.0.0&lt;br/&gt;
 Bundle-Activator: dummy.Activator&lt;br/&gt;
 Import-Package: org.osgi.framework,&lt;br/&gt;
  normal.export;bundle-symbolic-name=&quot;Provider&quot;;resolution:=optional,&lt;br/&gt;
  fragment.export;bundle-symbolic-name=&quot;Fragment&quot;;resolution:=optional&lt;/p&gt;

&lt;p&gt;Result:&lt;br/&gt;
    package                   resolved&lt;br/&gt;
    ----------------------------------&lt;br/&gt;
    normal.export             ok&lt;br/&gt;
    fragment.export           failed&lt;/p&gt;


&lt;p&gt;Case 4: Import using custom attribute:&lt;br/&gt;
--------------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt; Manifest-Version: 1.0&lt;br/&gt;
 Bundle-ManifestVersion: 2&lt;br/&gt;
 Bundle-Name: Case 4&lt;br/&gt;
 Bundle-SymbolicName: Case.4&lt;br/&gt;
 Bundle-Version: 1.0.0&lt;br/&gt;
 Bundle-Activator: dummy.Activator&lt;br/&gt;
 Import-Package: org.osgi.framework,&lt;br/&gt;
  normal.export;provider=&quot;bundle&quot;;resolution:=optional,&lt;br/&gt;
  fragment.export;provider=&quot;fragment&quot;;resolution:=optional&lt;/p&gt;

&lt;p&gt;Result:&lt;br/&gt;
    package                   resolved&lt;br/&gt;
    ----------------------------------&lt;br/&gt;
    normal.export             ok&lt;br/&gt;
    fragment.export           ok&lt;/p&gt;


&lt;p&gt;Case 5: DynamicImport-Package using the bundle-symbolic-name attribute:&lt;br/&gt;
--------------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt; Manifest-Version: 1.0&lt;br/&gt;
 Bundle-ManifestVersion: 2&lt;br/&gt;
 Bundle-Name: Case 5&lt;br/&gt;
 Bundle-SymbolicName: Case.5&lt;br/&gt;
 Bundle-Version: 1.0.0&lt;br/&gt;
 Bundle-Activator: dummy.Activator&lt;br/&gt;
 Import-Package: org.osgi.framework&lt;br/&gt;
 DynamicImport-Package: normal.export;bundle-symbolic-name=&quot;Provider&quot;,&lt;br/&gt;
  fragment.export;bundle-symbolic-name=&quot;system.bundle&quot;&lt;/p&gt;

&lt;p&gt;Result:&lt;br/&gt;
    package                   resolved&lt;br/&gt;
    ----------------------------------&lt;br/&gt;
    normal.export             ok&lt;br/&gt;
    fragment.export           failed&lt;/p&gt;


&lt;p&gt;Case 6: DynamicImport-Package using the bundle-symbolic-name attribute 2:&lt;br/&gt;
--------------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt; Manifest-Version: 1.0&lt;br/&gt;
 Bundle-ManifestVersion: 2&lt;br/&gt;
 Bundle-Name: Case 6&lt;br/&gt;
 Bundle-SymbolicName: Case.6&lt;br/&gt;
 Bundle-Version: 1.0.0&lt;br/&gt;
 Bundle-Activator: dummy.Activator&lt;br/&gt;
 Import-Package: org.osgi.framework&lt;br/&gt;
 DynamicImport-Package: normal.export;bundle-symbolic-name=&quot;Provider&quot;,&lt;br/&gt;
  fragment.export;bundle-symbolic-name=&quot;org.apache.felix.framework&quot;&lt;/p&gt;

&lt;p&gt;Result:&lt;br/&gt;
    package                   resolved&lt;br/&gt;
    ----------------------------------&lt;br/&gt;
    normal.export             ok&lt;br/&gt;
    fragment.export           failed&lt;/p&gt;


&lt;p&gt;Case 7: DynamicImport-Package using custome attribute:&lt;br/&gt;
--------------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt; Manifest-Version: 1.0&lt;br/&gt;
 Bundle-ManifestVersion: 2&lt;br/&gt;
 Bundle-Name: Case 7&lt;br/&gt;
 Bundle-SymbolicName: Case.7&lt;br/&gt;
 Bundle-Version: 1.0.0&lt;br/&gt;
 Bundle-Activator: dummy.Activator&lt;br/&gt;
 Import-Package: org.osgi.framework&lt;br/&gt;
 DynamicImport-Package: normal.export;provider=&quot;bundle&quot;,&lt;br/&gt;
  fragment.export;provider=&quot;fragment&quot;&lt;/p&gt;

&lt;p&gt;Result:&lt;br/&gt;
    package                   resolved&lt;br/&gt;
    ----------------------------------&lt;br/&gt;
    normal.export             ok&lt;br/&gt;
    fragment.export           ok&lt;/p&gt;</comment>
                            <comment id="12704547" author="alexberger" created="Thu, 30 Apr 2009 09:29:07 +0000"  >&lt;p&gt;The bundles used in the Test cases (binary + source)&lt;/p&gt;</comment>
                            <comment id="12706183" author="rickhall" created="Tue, 5 May 2009 20:18:03 +0000"  >&lt;p&gt;We are tracking this on &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-1123&quot; title=&quot;System bundle does still not correctly handle (export) package attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-1123&quot;&gt;&lt;del&gt;FELIX-1123&lt;/del&gt;&lt;/a&gt; for a future Felix release.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="12424636">FELIX-1123</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12406893" name="Test_cases.zip" size="12597" author="alexberger" created="Thu, 30 Apr 2009 09:29:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>58021</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 30 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0vxzz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>184481</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>