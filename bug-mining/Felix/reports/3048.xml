<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 16:13:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-5978] Felix framework unable to retrieve custom URL handlers when security is on</title>
                <link>https://issues.apache.org/jira/browse/FELIX-5978</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;When running with multiple frameworks in the same VM, custom URL Handlers, and OSGi security on there are a couple of problems:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Firstly, this security exception results in the custom URL handler being ignored. The framework should really be using a doPriv here.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.security.AccessControlException: access denied (&lt;span class=&quot;code-quote&quot;&gt;&quot;java.lang.RuntimePermission&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;getClassLoader&quot;&lt;/span&gt;)
at java.security.AccessControlContext.checkPermission(AccessControlContext.java:472)
at java.security.AccessController.checkPermission(AccessController.java:884)
at java.lang.&lt;span class=&quot;code-object&quot;&gt;SecurityManager&lt;/span&gt;.checkPermission(&lt;span class=&quot;code-object&quot;&gt;SecurityManager&lt;/span&gt;.java:549)
at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.checkClassLoaderPermission(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:1528)
at java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.getClassLoader(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:683)
at org.apache.felix.framework.URLHandlers.getFrameworkFromContext(URLHandlers.java:690)
at org.apache.felix.framework.URLHandlersStreamHandlerProxy.getStreamHandlerService(URLHandlersStreamHandlerProxy.java:574)
at org.apache.felix.framework.URLHandlersStreamHandlerProxy.toExternalForm(URLHandlersStreamHandlerProxy.java:474)
at java.net.URL.toExternalForm(URL.java:929)
at java.net.URL.toString(URL.java:915)
at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.defineClassSourceLocation(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:678)
at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.defineClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:762)
at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.defineClass(BundleWiringImpl.java:2344)
at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.defineClassParallel(BundleWiringImpl.java:2162)
at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.findClass(BundleWiringImpl.java:2096)
at org.apache.felix.framework.BundleWiringImpl.findClassOrResourceByDelegation(BundleWiringImpl.java:1565)
at org.apache.felix.framework.BundleWiringImpl.access$300(BundleWiringImpl.java:79)
at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.loadClass(BundleWiringImpl.java:1982)
at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.loadClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:357)
at org.apache.felix.cm.impl.ConfigurationManager.configure(ConfigurationManager.java:758)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Secondly, the wrong framework is returned some of the time due to the logic of URLHandlers.getFrameworkContext() - in this method it assumes that there will be a bundle class loader on the stack, which is not true when the launcher is starting a bundle (the framework reflectively loads the Activator type which requires a URL check to set the security domain).&lt;/p&gt;</description>
                <environment></environment>
        <key id="13197093">FELIX-5978</key>
            <summary>Felix framework unable to retrieve custom URL handlers when security is on</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="karlpauls">Karl Pauls</assignee>
                                    <reporter username="timothyjward">Timothy James Ward</reporter>
                        <labels>
                    </labels>
                <created>Thu, 8 Nov 2018 11:22:26 +0000</created>
                <updated>Thu, 31 Jan 2019 13:08:52 +0000</updated>
                            <resolved>Thu, 8 Nov 2018 21:27:40 +0000</resolved>
                                    <version>framework-6.0.0</version>
                    <version>framework-6.0.1</version>
                                    <fixVersion>framework-6.0.2</fixVersion>
                                    <component>Framework</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16679665" author="githubbot" created="Thu, 8 Nov 2018 12:12:54 +0000"  >&lt;p&gt;GitHub user timothyjward opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/160&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/160&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-5978&quot; title=&quot;Felix framework unable to retrieve custom URL handlers when security is on&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-5978&quot;&gt;&lt;del&gt;FELIX-5978&lt;/del&gt;&lt;/a&gt; Ensure getClassLoader() is called in a safe way when sec&#8230;&lt;/p&gt;

&lt;p&gt;    &#8230;urity is enabled&lt;/p&gt;

&lt;p&gt;    Previously URLHandlers would explode when security was on because it didn&apos;t have permission to get the ClassLoader all the way down the stack&lt;/p&gt;

&lt;p&gt;    Signed-off-by: Tim Ward &amp;lt;timothyjward@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/timothyjward/felix&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/timothyjward/felix&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-5978&quot; title=&quot;Felix framework unable to retrieve custom URL handlers when security is on&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-5978&quot;&gt;&lt;del&gt;FELIX-5978&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/160.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/160.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #160&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit e30d80a31b03731fd1b67fb551d58b10741eb5d1&lt;br/&gt;
Author: Tim Ward &amp;lt;timothyjward@...&amp;gt;&lt;br/&gt;
Date:   2018-11-08T12:11:29Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-5978&quot; title=&quot;Felix framework unable to retrieve custom URL handlers when security is on&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-5978&quot;&gt;&lt;del&gt;FELIX-5978&lt;/del&gt;&lt;/a&gt; Ensure getClassLoader() is called in a safe way when security is enabled&lt;/p&gt;

&lt;p&gt;    Previously URLHandlers would explode when security was on because it didn&apos;t have permission to get the ClassLoader all the way down the stack&lt;/p&gt;

&lt;p&gt;    Signed-off-by: Tim Ward &amp;lt;timothyjward@apache.org&amp;gt;&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16679712" author="timothyjward" created="Thu, 8 Nov 2018 12:50:14 +0000"  >&lt;blockquote&gt;&lt;p&gt;Secondly, the wrong framework is returned some of the time due to the logic of URLHandlers.getFrameworkContext() - in this method it assumes that there will be a bundle class loader on the stack, which is not true when the launcher is starting a bundle (the framework reflectively loads the Activator type which requires a URL check to set the security domain).&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;While it would be nice to fix this, I&apos;ve thought more deeply about it and I&apos;m really not sure whether it is possible to fix without a significant change to the Felix BundleClassLoader (basically to register the Framework that is associated with the current class load). I would like some advice as to whether people think this would be a good idea. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=karlpauls&quot; class=&quot;user-hover&quot; rel=&quot;karlpauls&quot;&gt;karlpauls&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="16680409" author="githubbot" created="Thu, 8 Nov 2018 21:24:56 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/felix/pull/160&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/felix/pull/160&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16680417" author="karlpauls" created="Thu, 8 Nov 2018 21:28:08 +0000"  >&lt;p&gt;I applied the patch provided by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=timothyjward&quot; class=&quot;user-hover&quot; rel=&quot;timothyjward&quot;&gt;timothyjward&lt;/a&gt; - thanks a lot!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|s009qw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>