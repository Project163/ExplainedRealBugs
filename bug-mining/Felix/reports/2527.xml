<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:59:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-5061] Optional resource fragment with requirements that cause class space consistency issues with the host export cause unexpected ResolutionExceptions</title>
                <link>https://issues.apache.org/jira/browse/FELIX-5061</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;Not sure if this is actually a bug in version 1.6.0.  I am testing with the latest out of trunk so it could be something after 1.6.0.&lt;/p&gt;

&lt;p&gt;If a fragment contains a requirement that ultimately causes a uses constraint conflict with one of the hosts exported packages then the resolver will end up throwing a ResolutionExceptoin even when the fragment and host are considered to be optional resources by the ResolverContext.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12902135">FELIX-5061</key>
            <summary>Optional resource fragment with requirements that cause class space consistency issues with the host export cause unexpected ResolutionExceptions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rickhall">Richard S. Hall</assignee>
                                    <reporter username="tjwatson">Tom Watson</reporter>
                        <labels>
                    </labels>
                <created>Fri, 2 Oct 2015 15:08:34 +0000</created>
                <updated>Fri, 16 Oct 2015 16:44:34 +0000</updated>
                            <resolved>Mon, 5 Oct 2015 18:50:45 +0000</resolved>
                                    <version>resolver-1.6.0</version>
                                    <fixVersion>framework-5.4.0</fixVersion>
                                    <component>Resolver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14941302" author="tjwatson" created="Fri, 2 Oct 2015 15:59:33 +0000"  >&lt;p&gt;Here is a possible fix.  The issue is the loop used to call  ResolverImpl.checkPackageSpaceConsistency changed to only loop over host resources.  I like that change and do not suggest that we change that.&lt;/p&gt;

&lt;p&gt;Before it used to loop over all the &apos;seed&apos; resources and check their consistency.  This included any fragments that are mandatory or optional resources according to the ResolveContext.  When checking the consistency of the fragment the impl would first find its hosts and do the check on the host, but the original fragment resource was kept for the faulty resource and could therefore be optionally removed from the resolution and we would retry resolution without the fragment.&lt;/p&gt;

&lt;p&gt;Now we have lost the context of the fragment seeds and only have their hosts and that causes the issues.  At first I was thinking we needed to somehow bring the context back for the fragment during the consistency check, but that proved to be overcomplicated.&lt;/p&gt;

&lt;p&gt;Instead I decided to fix an issue with the UseConstraintError so that we report back the Requirement that is to blame for the conflict with the host export.  That way the bit of code in ResolverImpl.checkConsistency that finds the faulty resource will correctly detect faultyReq is a WrappedRequirement from a fragment resource.&lt;/p&gt;

&lt;p&gt;This also fixes an existing issue in the prior implementation that would end up throwing out the host as well even though it could have resolved the host once the fragment was removed from resolution.&lt;/p&gt;</comment>
                            <comment id="14941336" author="tjwatson" created="Fri, 2 Oct 2015 16:24:36 +0000"  >&lt;p&gt;I did add a new testcase to Equinox for this case.  You can find it in the twatson/newResolver branch as I described in &lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-4987&quot; title=&quot;Dynamic package resolution with unresolvable or fragment package exports can lead to invalid wirings&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-4987&quot;&gt;&lt;del&gt;FELIX-4987&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14943819" author="rickhall" created="Mon, 5 Oct 2015 18:50:45 +0000"  >&lt;p&gt;I applied the patch, please close if satisfied. Thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12764779" name="FELIX-5061.patch" size="985" author="tjwatson" created="Fri, 2 Oct 2015 15:59:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 7 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2mjj3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>