<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:07:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-763] Jetty6 version of Http doesn&apos;t resolve aliases according to OSGi spec</title>
                <link>https://issues.apache.org/jira/browse/FELIX-763</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;We have both of the following aliases mounted for resource serving:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;/VtWebUi - served by a &quot;WebUiContext&quot; class&lt;/li&gt;
	&lt;li&gt;/VtWebUi/logs - served by a &quot;LogsContext&quot; class&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;A request to&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;http://localhost:8084/VtWebUi&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8084/VtWebUi&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;is getting directed to the LogsContext class (which serves /VtWebUi/logs) -&lt;br/&gt;
and the attached resource path is empty&lt;/p&gt;

&lt;p&gt;According to my understanding (and the previous Jetty 4 version) - this&lt;br/&gt;
should get directed to the &quot;WebUiContext&quot; &lt;/p&gt;

&lt;p&gt;====&lt;/p&gt;

&lt;p&gt;Form further analysis:&lt;/p&gt;

&lt;p&gt;This looks definitely wrong to me in the current SVN rev, albeit our usage is a strange case that perhaps not many use, I think the new internal operation is wrong&lt;/p&gt;

&lt;p&gt;We have a very similar example to the table in 102.4 of the R4 companion spec. &lt;/p&gt;

&lt;p&gt;alias 1 - /VtWebUi&lt;br/&gt;
alias 2 - /VtWebUi/logs&lt;/p&gt;

&lt;p&gt;To me - a request for /VtWebUi - should only get routed to the getResource of alias 1?&lt;/p&gt;

&lt;p&gt;I can&apos;t see any way according to the spec, the getResource of alias 2 should be called - it&apos;s not a matching substring, even if the getResource for alias 1 returned null (which it wouldn&apos;t in our case anyhow).&lt;/p&gt;

&lt;p&gt;===&lt;/p&gt;

&lt;p&gt;Additional info:&lt;/p&gt;

&lt;p&gt;Hmmm - some further clues that something may be amiss here:&lt;/p&gt;

&lt;p&gt;         //fails:&lt;br/&gt;
         //srvHttp.registerResources(alias, &quot;&quot;, myContext);&lt;br/&gt;
         //srvHttp.registerResources(alias + logsAlias, &quot;&quot;, this.envLogsContext);&lt;/p&gt;

&lt;p&gt;         //works:&lt;br/&gt;
         srvHttp.registerResources(alias + logsAlias, &quot;&quot;, this.envLogsContext);&lt;br/&gt;
         srvHttp.registerResources(alias, &quot;&quot;, myContext);&lt;/p&gt;

&lt;p&gt;Simply swapping the order of registration changes the behaviour , not quite to fully working - but a lot closer.&lt;/p&gt;

&lt;p&gt;I&apos;m fairly sure the order of registration shouldn&apos;t change any behaviour, except in the case of a duplicate alias exception - which this isn&apos;t. The OSGi rules for walking back down a substring of aliases until there&apos;s a match aren&apos;t based on which got registered first&lt;/p&gt;

&lt;p&gt;Looking at the traces, Jetty seems to be using later registered aliases first - hence why the swap makes a difference. I suspect what is broken here is how Jetty does path matching to servlets - it doesn&apos;t look like it matches according to alias rules for OSGi in this newer Jetty version.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12406277">FELIX-763</key>
            <summary>Jetty6 version of Http doesn&apos;t resolve aliases according to OSGi spec</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="walkerr">Rob Walker</reporter>
                        <labels>
                    </labels>
                <created>Mon, 13 Oct 2008 05:49:27 +0000</created>
                <updated>Fri, 13 Jun 2014 09:27:15 +0000</updated>
                            <resolved>Tue, 14 Oct 2008 19:59:14 +0000</resolved>
                                                                    <component>HTTP Service</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12638948" author="niclas" created="Mon, 13 Oct 2008 06:07:34 +0000"  >&lt;p&gt;AFAIR, not Jetty 4 nor Jetty 5 did it any differently. The described problem has been in the org.ungoverned codebase since we first used it 2-3 years ago. The scary part is that the TCK doesn&apos;t test this, and a few other spec bits where org.ungoverned doesn&apos;t fully comply (can&apos;t recall what it was).&lt;/p&gt;</comment>
                            <comment id="12638953" author="walkerr" created="Mon, 13 Oct 2008 06:33:03 +0000"  >&lt;p&gt;Agree that the earlier Jetty4 version didn&apos;t fully follow spec, but this is a new error case - our original code worked fine against the Jetty4 version and now totally breaks under the above.  The Jetty4 version definitely didn&apos;t send getResource requests to aliases that didn&apos;t match the base path, at least not for the codebase / examples we have here.&lt;/p&gt;

&lt;p&gt;Totally agree that it&apos;d be nice if a TCK of some form existed to verify this specific part.&lt;/p&gt;</comment>
                            <comment id="12639573" author="walkerr" created="Tue, 14 Oct 2008 19:59:14 +0000"  >&lt;p&gt;Have marked as &quot;resolved&quot; for now.&lt;/p&gt;

&lt;p&gt;Managed with a relatively small number of changes to get Jetty mapping paths to aliases in a way that looks much closer to the spec so far. Certainly for our examples here, it&apos;s much more according to spec.&lt;/p&gt;

&lt;p&gt;Changes comitted to SVN - will leave a few weeks before feedback before closing the issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>58226</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 7 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0vtr3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>183793</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>