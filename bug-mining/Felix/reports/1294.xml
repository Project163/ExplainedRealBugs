<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:24:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-2942] Bundles with higher start level get activated even before framework reaches that start level</title>
                <link>https://issues.apache.org/jira/browse/FELIX-2942</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;In my environment, this is what&apos;s going on:&lt;/p&gt;

&lt;p&gt;1. framework is started with start level 1.&lt;br/&gt;
2. bundles are installed and assigned start level varying from 2 to 4.&lt;br/&gt;
3. framework&apos;s start level is set to 5.&lt;br/&gt;
4. another bundle is installed and is assigned start level 5. This bundle is then started.&lt;/p&gt;

&lt;p&gt;Immediately I see Bundle.STARTED event for the last bundle with start level 5 is fired. While trying to understand why certain bundles are getting started earlier than bundles with lower start levels, I stepped into Felix and found the following code:&lt;/p&gt;

&lt;p&gt;            // Check to see if the bundle&apos;s start level is greater than the&lt;br/&gt;
            // the framework&apos;s active start level.&lt;br/&gt;
// TODO: STARTLEVEL - Technically, this is not correct since we could be in the&lt;br/&gt;
//       middle of a framework start level change and we might not have yet&lt;br/&gt;
//       reached the target start level, but we will activate the bundle anyway.&lt;br/&gt;
//       This means the bundle will be running in a higher start level temporarily&lt;br/&gt;
//       until the start level thread catches up.&lt;br/&gt;
            if (bundle.getStartLevel(getInitialBundleStartLevel()) &amp;gt; m_targetStartLevel)&lt;br/&gt;
            {&lt;br/&gt;
                // Throw an exception for transient starts.&lt;br/&gt;
                if ((options &amp;amp; Bundle.START_TRANSIENT) != 0)&lt;/p&gt;
                {
                    throw new BundleException(
                        &quot;Cannot start bundle &quot; + bundle + &quot; because its start level is &quot;
                        + bundle.getStartLevel(getInitialBundleStartLevel())
                        + &quot;, which is greater than the framework&apos;s start level of &quot;
                        + m_targetStartLevel + &quot;.&quot;);
                }
&lt;p&gt;                // Ignore persistent starts.&lt;br/&gt;
                return;&lt;br/&gt;
            }&lt;/p&gt;

&lt;p&gt;The above code compares against &quot;target start level&quot; as opposed to the &quot;currently active start level&quot;. The comment indicates that it is a known issue, so if there is already a bug filed to this extent, please close this one as duplicate. It pretty much makes it difficult to use start level service reliably.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12506034">FELIX-2942</key>
            <summary>Bundles with higher start level get activated even before framework reaches that start level</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rickhall">Richard S. Hall</assignee>
                                    <reporter username="sahoo">Sanjeeb Kumar Sahoo</reporter>
                        <labels>
                    </labels>
                <created>Tue, 3 May 2011 08:10:52 +0000</created>
                <updated>Wed, 11 May 2011 17:40:36 +0000</updated>
                            <resolved>Wed, 11 May 2011 17:39:13 +0000</resolved>
                                    <version>framework-3.0.8</version>
                                    <fixVersion>framework-3.2.2</fixVersion>
                                    <component>Framework</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13031878" author="rickhall" created="Wed, 11 May 2011 17:39:13 +0000"  >&lt;p&gt;I have committed a patch that creates a shared set of bundles being processed by the start level thread so that concurrent calls to start a bundle can be queued for the start level thread to avoid bundles starting out of the proper start level.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56043</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 28 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0vqsf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>183313</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>