<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:05:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-384] Possible deadlock on framework startlevel change</title>
                <link>https://issues.apache.org/jira/browse/FELIX-384</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;Felix SCR uses java synchronization on component manager instances to prevent synchronous execution of certain actions like activation and deactivation. In concert with the locking implemented by the Felix framework, deadlocks may occurr in certain situations.&lt;/p&gt;

&lt;p&gt;For example: If the framework has been started but the SCR Activator queue still has a deadlock and the framework is instructed to shutdown.&lt;/p&gt;

&lt;p&gt;The start level service will now stop bundles in the FelixStartLevel thread. At one point in time Bundle X will be stopped and the framework holds the bundle lock while stopping the bundle. Stopping the bundle causes a synchronous STOPPING event being handled by the SCR, which causes immediate deactivation of all components of the bundle. This causes the AbstractComponentManager.deactivateInternal method to be called which is synchronized on the instance.&lt;/p&gt;

&lt;p&gt;At the same time, the components of Bundle X may still be scheduled for activation in the SCR Activator queue handled by the  SCR Component Actor thread. This thread may be activating a component of Bundle X trying to register the component as a service in the AbstractComponentManager.activateInternal method (synchronized on the instance). Registering the service tries to acquire the bundle lock first.&lt;/p&gt;

&lt;p&gt;The result is a deadlock between the FelixStartLevel thread (holding the bundle lock and waiting for the component manager lock) and the SCR Component Actor thread (holding the component lock and waiting for the bundle lock).&lt;/p&gt;

&lt;p&gt;While this is probably a seldom situation, it must be prevent from happening nevertheless.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12379384">FELIX-384</key>
            <summary>Possible deadlock on framework startlevel change</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fmeschbe">Felix Meschberger</assignee>
                                    <reporter username="fmeschbe">Felix Meschberger</reporter>
                        <labels>
                    </labels>
                <created>Mon, 1 Oct 2007 06:57:28 +0000</created>
                <updated>Fri, 30 May 2008 18:15:56 +0000</updated>
                            <resolved>Mon, 1 Oct 2007 07:20:23 +0000</resolved>
                                                    <fixVersion>scr-1.0.0</fixVersion>
                                    <component>Declarative Services (SCR)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12531424" author="fmeschbe" created="Mon, 1 Oct 2007 07:20:23 +0000"  >&lt;p&gt;Taking service registration out of the synchronization on the component manager instance in the AbstractComponentManager.activateInternal method should fix this issue in the Felix implementation.&lt;/p&gt;

&lt;p&gt;While this fix targets the Felix framework implementation, I assume, this does not harm any other framework implementation but may prevent similar issues in them.&lt;/p&gt;

&lt;p&gt;Fixed in Rev. 580873.&lt;/p&gt;

&lt;p&gt;Will close the issue, when deploying a snapshot&lt;/p&gt;</comment>
                            <comment id="12531525" author="fmeschbe" created="Mon, 1 Oct 2007 14:59:16 +0000"  >&lt;p&gt;Uploaded SNAPSHOT build number 20071001.145653-5 containing the fix.&lt;/p&gt;

&lt;p&gt;Now closing this issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>58601</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 9 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0vwhj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>184236</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>