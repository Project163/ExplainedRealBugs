<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:32:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-3126] SCR activates a service component while the containing bundle is stopping.</title>
                <link>https://issues.apache.org/jira/browse/FELIX-3126</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;I&apos;ve got the following setup:&lt;/p&gt;

&lt;p&gt;Bundle 1: Implements a pattern similar to the extender pattern. A bundle tracker monitors bundles containing a certain configuration entry. Each time a bundle with the coniguration entry enters or leaves the ACTIVE state, a service of the interface &quot;com.example.bundle1.Bundle1Service&quot; is unregistered and a new service with the same interface is re-registered.&lt;/p&gt;

&lt;p&gt;Bundle 2: Has an immediate service component with the following configuration:&lt;/p&gt;

&lt;p&gt;&amp;lt;component name=&quot;Bundle2Component&quot; immediate=&quot;true&quot; xmlns=&quot;http://www.osgi.org/xmlns/scr/v1.1.0&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;implementation class=&quot;com.example.bundle2.TestComponent&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;service&amp;gt;&lt;br/&gt;
		&amp;lt;provide interface=&quot;java.lang.Object&quot; /&amp;gt;&lt;br/&gt;
	&amp;lt;/service&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;reference &lt;br/&gt;
		name=&quot;bundle1service&quot; &lt;br/&gt;
		interface=&quot;com.example.bundle1.Bundle1Service&quot;&lt;br/&gt;
		cardinality=&quot;1..1&quot; &lt;br/&gt;
		policy=&quot;static&quot; &lt;br/&gt;
		bind=&quot;setBundle1Service&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;/component&amp;gt;&lt;/p&gt;

&lt;p&gt;Situation: Both bundles have been started. The service component from bundle 2 is active and the reference is bound to the current Bundle1Service exported from bundle 1.&lt;/p&gt;

&lt;p&gt;Now, when i stop bundle 2 the following occur:&lt;/p&gt;

&lt;p&gt;1. The state of bundle 2 is changed to STOPPING&lt;br/&gt;
2. The state change is discovered by the service tracker in bundle 1 which causes it to unregister the Bundle1Service and then register a a new Bundle1Service.&lt;br/&gt;
3. The SCR discovers that the bundle1service reference of the component has become unsatisfied and deactivates the component.&lt;br/&gt;
4. The SCR discovers that the bundle1service reference of the component has become satisfied (with a new service) and activates the component.&lt;br/&gt;
5. The SCR tries to export the newly activated component as a service, but fails since the bundle is stopping.&lt;/p&gt;

&lt;p&gt;The problem seems to be that SCR has not discovered that the bundle is STOPPING and disabled the component. A simple fix might be to check whether to disable the component based on bundle status before activating a new instance of the component.&lt;/p&gt;</description>
                <environment>&lt;a href=&quot;https://issues.apache.org/jira/browse/FELIX-3&quot; title=&quot;Determine of notifications are working in JIRA&quot; class=&quot;issue-link&quot; data-issue-key=&quot;FELIX-3&quot;&gt;&lt;strike&gt;FELIX-3&lt;/strike&gt;&lt;/a&gt;.2.2, SCR-1.6.0</environment>
        <key id="12524252">FELIX-3126</key>
            <summary>SCR activates a service component while the containing bundle is stopping.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fmeschbe">Felix Meschberger</assignee>
                                    <reporter username="sorenp">Soren Petersen</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Sep 2011 08:29:53 +0000</created>
                <updated>Tue, 20 Nov 2012 10:58:15 +0000</updated>
                            <resolved>Tue, 11 Oct 2011 18:23:52 +0000</resolved>
                                    <version> scr-1.6.0</version>
                                    <fixVersion>scr-1.6.2</fixVersion>
                                    <component>Declarative Services (SCR)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13125247" author="fmeschbe" created="Tue, 11 Oct 2011 18:23:20 +0000"  >&lt;p&gt;Committed a fix in Rev. 1181999 which prevents the component from being enabled or activated while the bundle is being stopped.&lt;/p&gt;

&lt;p&gt;Can you please check, whether this helps you use case ? Thanks.&lt;/p&gt;</comment>
                            <comment id="13125248" author="fmeschbe" created="Tue, 11 Oct 2011 18:23:52 +0000"  >&lt;p&gt;Considering this issue fixed. If it ain&apos;t so, we can still reopen.&lt;/p&gt;</comment>
                            <comment id="13501024" author="fmeschbe" created="Tue, 20 Nov 2012 10:58:15 +0000"  >&lt;p&gt;Close after release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>55878</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 1 week, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l49j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>121341</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>