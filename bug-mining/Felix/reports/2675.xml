<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 16:03:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-5319] HttpServiceRuntime provides incorrect info for service that is both Servlet and Resource</title>
                <link>https://issues.apache.org/jira/browse/FELIX-5319</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;I have a servlet defined as follows:&lt;br/&gt;
Note: it defines &lt;em&gt;both&lt;/em&gt; servlet and resource properties.&lt;/p&gt;

&lt;p&gt;@Component(property = &lt;/p&gt;
{
		HttpWhiteboardConstants.HTTP_WHITEBOARD_SERVLET_NAME + &quot;=Hello World&quot;,
		HttpWhiteboardConstants.HTTP_WHITEBOARD_SERVLET_PATTERN + &quot;=/hello/sayHello&quot;,
        HttpWhiteboardConstants.HTTP_WHITEBOARD_RESOURCE_PATTERN + &quot;=/hello/static/*&quot;,
        HttpWhiteboardConstants.HTTP_WHITEBOARD_RESOURCE_PREFIX + &quot;=/static&quot;
        }
&lt;p&gt;)&lt;br/&gt;
public class HelloWorldServlet extends HttpServlet implements Servlet {&lt;br/&gt;
}&lt;/p&gt;


&lt;p&gt;I am using the HttpServiceRuntime to discover servlet info, but this servlet does not appear.&lt;/p&gt;

&lt;p&gt;@Reference&lt;br/&gt;
HttpServiceRuntime httpRuntime;&lt;/p&gt;

&lt;p&gt;RuntimeDTO runtimeDTO = httpRuntime.getRuntimeDTO();&lt;/p&gt;

&lt;p&gt;for (ServletContextDTO servletContextDTO : runtimeDTO.servletContextDTOs) {&lt;br/&gt;
	ServletDTO[] servletDTOs = servletContextDTO.servletDTOs;&lt;br/&gt;
    // servletDTOs.length == 0&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;The equivalent code for ResourceDTO &lt;em&gt;does&lt;/em&gt; find a ResourceDTO for this servlet, but it contains servlet, rather than resource info:&lt;/p&gt;

&lt;p&gt;resourceDTO.patterns = &lt;span class=&quot;error&quot;&gt;&amp;#91;/hello/sayHello&amp;#93;&lt;/span&gt;&lt;br/&gt;
resourceDTO.prefix = null&lt;/p&gt;


&lt;p&gt;If I remove this resource property from the servlet, then the above code finds the servlet, as expected:&lt;br/&gt;
HttpWhiteboardConstants.HTTP_WHITEBOARD_RESOURCE_PATTERN + &quot;=/hello/static/*&quot;&lt;/p&gt;


</description>
                <environment></environment>
        <key id="12995187">FELIX-5319</key>
            <summary>HttpServiceRuntime provides incorrect info for service that is both Servlet and Resource</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cziegeler">Carsten Ziegeler</assignee>
                                    <reporter username="db82407">Derek Baum</reporter>
                        <labels>
                    </labels>
                <created>Fri, 5 Aug 2016 11:50:59 +0000</created>
                <updated>Fri, 12 Aug 2016 09:31:28 +0000</updated>
                            <resolved>Fri, 5 Aug 2016 14:54:59 +0000</resolved>
                                    <version>http.base-3.0.10</version>
                    <version>http.jetty-3.2.2</version>
                    <version>http.bridge-3.0.10</version>
                                    <fixVersion>http.base-3.0.12</fixVersion>
                    <fixVersion>http.jetty-3.2.4</fixVersion>
                    <fixVersion>http.bridge-3.0.12</fixVersion>
                                    <component>HTTP Service</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15409497" author="cziegeler" created="Fri, 5 Aug 2016 14:10:29 +0000"  >&lt;p&gt;Thanks for reporting, as a first step I&apos;ve added a test case for that to our integration tests...and the test fails of course atm, with the problem mentioned in the description&lt;/p&gt;</comment>
                            <comment id="15409549" author="cziegeler" created="Fri, 5 Aug 2016 14:55:00 +0000"  >&lt;p&gt;I&apos;ve committed a fix - test passes now.&lt;/p&gt;

&lt;p&gt;The problem was that internally a Resource is treated like a Servlet using the same ServletInfo implementation - which then leads to one object overwriting the other. As the DTO handling makes the assumption that this can&apos;t happen, the state gets totally corrupted.&lt;br/&gt;
We&apos;re now using a  sub class of ServletInfo for resources and compare the class names in the compareTo method&lt;/p&gt;</comment>
                            <comment id="15409596" author="db82407" created="Fri, 5 Aug 2016 15:48:40 +0000"  >&lt;p&gt;Hi Carsten,&lt;/p&gt;

&lt;p&gt;Thanks for fixing this so quickly.&lt;/p&gt;

&lt;p&gt;I can confirm that a local build of 3.2.3-SNAPSHOT works fine for me.&lt;/p&gt;

&lt;p&gt;&amp;#8211;&lt;br/&gt;
Derek&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 15 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31yi7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>