<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 15:15:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[FELIX-1922] issue with configuration policy=require and with factory components</title>
                <link>https://issues.apache.org/jira/browse/FELIX-1922</link>
                <project id="12310100" key="FELIX">Felix</project>
                    <description>&lt;p&gt;This issue is related to the following dev post: -&amp;gt; &lt;a href=&quot;http://www.mail-archive.com/dev@felix.apache.org/msg14167.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.mail-archive.com/dev@felix.apache.org/msg14167.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;There are two components that comes into play: &lt;/p&gt;

&lt;p&gt;1) The first one (EnglishDictionary) has a configuration-policy=&quot;require&quot; parameter and a factory=&quot;true&quot; parameter:&lt;/p&gt;

&lt;p&gt;&amp;lt;?xml version=&apos;1.0&apos; encoding=&apos;utf-8&apos;?&amp;gt;&lt;br/&gt;
&amp;lt;component name=&apos;EnglishDictionary&apos; xmlns=&apos;http://www.osgi.org/xmlns/scr/v1.1.0&apos; factory=&apos;true&apos; configuration-policy=&apos;require&apos; modified=&apos;updated&apos;&amp;gt;&lt;br/&gt;
 &amp;lt;implementation class=&apos;com.alcatel_lucent.samples.scr.dictionary.english.EnglishDictionary&apos;/&amp;gt;&lt;br/&gt;
 &amp;lt;service&amp;gt;&lt;br/&gt;
   &amp;lt;provide interface=&apos;com.alcatel_lucent.samples.scr.dictionary.DictionaryService&apos;/&amp;gt;&lt;br/&gt;
 &amp;lt;/service&amp;gt;&lt;br/&gt;
&amp;lt;/component&amp;gt; &lt;/p&gt;

&lt;p&gt;The EnglishDictionary parameter has actually a CM Configuration which is required before activation: that is why it uses configuration-policy=&apos;require&apos;.&lt;/p&gt;

&lt;p&gt;2) The second one (EnglishDictionaryFactory) is a factory component that is meant to instantiate the EnglishDictionary component.:&lt;/p&gt;

&lt;p&gt;&amp;lt;?xml version=&apos;1.0&apos; encoding=&apos;utf-8&apos;?&amp;gt;&lt;br/&gt;
&amp;lt;component name=&apos;EnglishDictionaryFactory&apos;&amp;gt;&lt;br/&gt;
 &amp;lt;implementation class=&apos;com.alcatel_lucent.samples.scr.dictionary.english.EnglishDictionaryFactory&apos;/&amp;gt;&lt;br/&gt;
 &amp;lt;reference name=&apos;bind&apos; interface=&apos;org.osgi.service.component.ComponentFactory&apos; bind=&apos;bind&apos; unbind=&apos;unbind&apos; target=&apos;(component.name=EnglishDictionary)&apos;/&amp;gt;&lt;br/&gt;
&amp;lt;/component&amp;gt; &lt;/p&gt;


&lt;p&gt;The issue takes place when the EnglishDictionaryFactory component tries to instantiate the EnglishDictionary like this:&lt;/p&gt;

&lt;p&gt;class EnglishDictionaryFactory {&lt;br/&gt;
  public void bind(ComponentFactory factory) &lt;/p&gt;
{
    factory.newInstance(new Hashtable());
  }
&lt;p&gt; &lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;-&amp;gt; The newInstance raises the following exception:&lt;/p&gt;

&lt;p&gt;org.osgi.service.component.ComponentException: Failed activating component&lt;br/&gt;
       at org.apache.felix.scr.impl.manager.ComponentFactoryImpl.newInstance(ComponentFactoryImpl.java:118)&lt;br/&gt;
       at com.alcatel_lucent.samples.scr.dictionary.english.EnglishDictionaryFactory.bind(EnglishDictionaryFactory.java:19)&lt;br/&gt;
       at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
       at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
       at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
       at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
       at org.apache.felix.scr.impl.helper.BaseMethod.invokeMethod(BaseMethod.java:213)&lt;br/&gt;
       at org.apache.felix.scr.impl.helper.BaseMethod.access$500(BaseMethod.java:38)&lt;br/&gt;
       at org.apache.felix.scr.impl.helper.BaseMethod$Resolved.invoke(BaseMethod.java:542)&lt;br/&gt;
       at org.apache.felix.scr.impl.helper.BaseMethod$NotResolved.invoke(BaseMethod.java:500)&lt;br/&gt;
       at org.apache.felix.scr.impl.helper.BaseMethod.invoke(BaseMethod.java:434)&lt;br/&gt;
       at org.apache.felix.scr.impl.manager.DependencyManager.invokeBindMethod(DependencyManager.java:997)&lt;br/&gt;
       at org.apache.felix.scr.impl.manager.DependencyManager.bind(DependencyManager.java:908)&lt;br/&gt;
       at org.apache.felix.scr.impl.manager.DependencyManager.open(DependencyManager.java:832)&lt;br/&gt;
       at org.apache.felix.scr.impl.manager.ImmediateComponentManager.createImplementationObject(ImmediateComponentManager.java:200)&lt;br/&gt;
       at org.apache.felix.scr.impl.manager.ImmediateComponentManager.createComponent(ImmediateComponentManager.java:118)&lt;br/&gt;
       at org.apache.felix.scr.impl.manager.AbstractComponentManager$Unsatisfied.activate(AbstractComponentManager.java:982)&lt;br/&gt;
       at org.apache.felix.scr.impl.manager.AbstractComponentManager.activateInternal(AbstractComponentManager.java:297)&lt;br/&gt;
       at org.apache.felix.scr.impl.manager.AbstractComponentManager$1.doRun(AbstractComponentManager.java:137)&lt;br/&gt;
       at org.apache.felix.scr.impl.ComponentActivatorTask.run(ComponentActivatorTask.java:67)&lt;br/&gt;
       at org.apache.felix.scr.impl.ComponentActorThread.run(ComponentActorThread.java:96)&lt;br/&gt;
       at java.lang.Thread.run(Thread.java:619)&lt;/p&gt;</description>
                <environment>linux fc10, jdk1.5, jdk.1.6</environment>
        <key id="12442582">FELIX-1922</key>
            <summary>issue with configuration policy=require and with factory components</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fmeschbe">Felix Meschberger</assignee>
                                    <reporter username="pderop">Pierre De Rop</reporter>
                        <labels>
                    </labels>
                <created>Sun, 6 Dec 2009 19:26:05 +0000</created>
                <updated>Fri, 30 Jul 2010 11:42:07 +0000</updated>
                            <resolved>Mon, 14 Dec 2009 10:06:04 +0000</resolved>
                                    <version>scr-1.2.0</version>
                                    <fixVersion> scr-1.4.0</fixVersion>
                                    <component>Declarative Services (SCR)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12790038" author="fmeschbe" created="Mon, 14 Dec 2009 08:34:33 +0000"  >&lt;p&gt;The problem is actually that Component Factories do not really care about configuration objects: If they are there, they are used as the basis for new components, if they are not existing, it does not matter either.&lt;/p&gt;

&lt;p&gt;In addition, according to section 112.5.5, Factory Component, configuration objects are ignored to satisfy component factories (as opposed to other components, which take configurations into account in the case of configuraiton-policy=require).&lt;/p&gt;

&lt;p&gt;The fix is to prevent activation failure if no configuration is actually present.&lt;/p&gt;</comment>
                            <comment id="12790074" author="fmeschbe" created="Mon, 14 Dec 2009 10:06:04 +0000"  >&lt;p&gt;Added testcase ensuring proper operation if configuration is missing in Rev. 890254 (even if configuration-policy=require is set)&lt;/p&gt;

&lt;p&gt;In Rev. 890259 always mimick existing configuration to component factory instances. In case of Configuration Admin service not providing configuration, an empty configuration is placed to simulate existence. Reason for this is that component factories do not obey configuration-policy=require for satisfaction setting.&lt;/p&gt;

&lt;p&gt;This fixes this issue.&lt;/p&gt;</comment>
                            <comment id="12894015" author="fmeschbe" created="Fri, 30 Jul 2010 11:42:07 +0000"  >&lt;p&gt;Closing since version is released.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>57123</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 17 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1aspj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>271117</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>