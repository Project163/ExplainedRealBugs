<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:32:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[COMPRESS-417] Decompress tar.gz file failed. java.io.Exception:Error detected parsing the header</title>
                <link>https://issues.apache.org/jira/browse/COMPRESS-417</link>
                <project id="12310904" key="COMPRESS">Commons Compress</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void deGzipArchive(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; filepath,&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; dir)
            &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; File input = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(filepath);
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; InputStream is = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileInputStream(input);
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; CompressorInputStream in = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GzipCompressorInputStream(is, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
        TarArchiveInputStream tin = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TarArchiveInputStream(in);
        TarArchiveEntry entry = tin.getNextTarEntry();
        &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (entry != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            File archiveEntry = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(dir, entry.getName());
            archiveEntry.getParentFile().mkdirs();
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (entry.isDirectory()) {
                archiveEntry.mkdir();
                entry = tin.getNextTarEntry();
                &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;
            }
            OutputStream out = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileOutputStream(archiveEntry);
            IOUtils.copy(tin, out);
            out.close();
            entry = tin.getNextTarEntry();
        }
        in.close();
        tin.close();
    }

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        Gztest.deGzipArchive(&lt;span class=&quot;code-quote&quot;&gt;&quot;D:/20000102.0000+0800-20000102.0015+0800_0.tar.gz&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;D:/&quot;&lt;/span&gt;);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the tar.gz file can be decompressed in linux environment use &apos;tar&apos; command.&lt;/p&gt;

&lt;p&gt;The error log:&lt;/p&gt;

&lt;p&gt;Exception in thread &quot;main&quot; java.io.IOException: Error detected parsing the header&lt;br/&gt;
	at org.apache.commons.compress.archivers.tar.TarArchiveInputStream.getNextTarEntry(TarArchiveInputStream.java:286)&lt;br/&gt;
	at gztest.deGzipArchive(gztest.java:23)&lt;br/&gt;
	at gztest.main(gztest.java:149)&lt;br/&gt;
Caused by: java.lang.IllegalArgumentException: Invalid byte 100 at offset 0 in &apos;dos&lt;/p&gt;
{NUL}
{NUL}
{NUL}
&lt;p&gt;&apos; len=8&lt;br/&gt;
	at org.apache.commons.compress.archivers.tar.TarUtils.parseOctal(TarUtils.java:141)&lt;br/&gt;
	at org.apache.commons.compress.archivers.tar.TarUtils.parseOctalOrBinary(TarUtils.java:171)&lt;br/&gt;
	at org.apache.commons.compress.archivers.tar.TarArchiveEntry.parseTarHeader(TarArchiveEntry.java:1128)&lt;br/&gt;
	at org.apache.commons.compress.archivers.tar.TarArchiveEntry.parseTarHeader(TarArchiveEntry.java:1091)&lt;br/&gt;
	at org.apache.commons.compress.archivers.tar.TarArchiveEntry.&amp;lt;init&amp;gt;(TarArchiveEntry.java:368)&lt;br/&gt;
	at org.apache.commons.compress.archivers.tar.TarArchiveInputStream.getNextTarEntry(TarArchiveInputStream.java:284)&lt;br/&gt;
	... 2 more&lt;/p&gt;
</description>
                <environment></environment>
        <key id="13087916">COMPRESS-417</key>
            <summary>Decompress tar.gz file failed. java.io.Exception:Error detected parsing the header</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="alphacome">alphacome</reporter>
                        <labels>
                            <label>tar</label>
                    </labels>
                <created>Tue, 18 Jul 2017 12:22:48 +0000</created>
                <updated>Tue, 25 Jul 2017 09:34:12 +0000</updated>
                            <resolved>Sun, 23 Jul 2017 14:34:42 +0000</resolved>
                                    <version>1.14</version>
                                    <fixVersion>1.15</fixVersion>
                                    <component>Archivers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16091480" author="alphacome" created="Tue, 18 Jul 2017 12:24:18 +0000"  >&lt;p&gt;the tar.gz file!&lt;/p&gt;</comment>
                            <comment id="16091703" author="bodewig" created="Tue, 18 Jul 2017 15:19:18 +0000"  >&lt;p&gt;Many thanks. Have you tried unarchiving the file without gzip compression, i.e. gunzip on the command line and read the resulting tar? That way we may know whether gzip or tar is to blame.&lt;/p&gt;

&lt;p&gt;I should be able to look into this sometime later this week, but maybe the experiment may provide a useful workaround.&lt;/p&gt;</comment>
                            <comment id="16092403" author="alphacome" created="Wed, 19 Jul 2017 00:35:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bodewig&quot; class=&quot;user-hover&quot; rel=&quot;bodewig&quot;&gt;bodewig&lt;/a&gt; yes, &apos;gunzip&apos; commoand is worked, and then use &apos;tar&apos; command to deachive the result tar file also ok.&lt;/p&gt;</comment>
                            <comment id="16092923" author="bodewig" created="Wed, 19 Jul 2017 10:54:27 +0000"  >&lt;p&gt;I didn&apos;t mean to use the tar command, but rather &lt;tt&gt;TarArchiveInputStream&lt;/tt&gt;, I&apos;ll have a look myself.&lt;/p&gt;

&lt;p&gt;The somewhat good news is I can reproduce the error.&lt;/p&gt;

&lt;p&gt;Does the archive containing anything sensitive or would it be OK to ship it with Compress&apos; unit tests?&lt;/p&gt;</comment>
                            <comment id="16092928" author="bodewig" created="Wed, 19 Jul 2017 10:57:19 +0000"  >&lt;p&gt;The problem is inside the tar package as&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Untargz {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; File input = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(args[0]);
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (InputStream is = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileInputStream(input);
             CompressorInputStream in = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GzipCompressorInputStream(is, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
             OutputStream out = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileOutputStream(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo.tar&quot;&lt;/span&gt;)) {
            IOUtils.copy(in, out);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (InputStream is = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileInputStream(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo.tar&quot;&lt;/span&gt;);
             TarArchiveInputStream tin = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TarArchiveInputStream(is)) {
            TarArchiveEntry entry = tin.getNextTarEntry();
            &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (entry != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                File archiveEntry = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(entry.getName());
                archiveEntry.getParentFile().mkdirs();
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (entry.isDirectory()) {
                    archiveEntry.mkdir();
                    entry = tin.getNextTarEntry();
                    &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;
                }
                &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (OutputStream out = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileOutputStream(archiveEntry)) {
                    IOUtils.copy(tin, out);
                }
                entry = tin.getNextTarEntry();
            }
        }
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;fails for me and &lt;tt&gt;foo.tar&lt;/tt&gt; is a valid archive.&lt;/p&gt;</comment>
                            <comment id="16092936" author="bodewig" created="Wed, 19 Jul 2017 11:10:44 +0000"  >&lt;p&gt;The archive contains the value &quot;dos&quot; where the &quot;major device number&quot; is expected in ustar tar archives. After reading what the GNU tar and BSD tar pages say, we should probably ignore devmajor and devminor unless the file type is a character or block special file.&lt;/p&gt;</comment>
                            <comment id="16092944" author="bodewig" created="Wed, 19 Jul 2017 11:19:48 +0000"  >&lt;p&gt;fixed in master branch, maybe you can try a recent 1.15-SNAPSHOT. I&apos;ll close this issue once I&apos;ve got a unit test. It should be easy to create one myself should your archive contain sensitive data.&lt;/p&gt;</comment>
                            <comment id="16094014" author="alphacome" created="Thu, 20 Jul 2017 00:39:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bodewig&quot; class=&quot;user-hover&quot; rel=&quot;bodewig&quot;&gt;bodewig&lt;/a&gt;, I &apos;ve tried 1.15-SNAPSHOT.  issue is fixed. many thx for your support. &lt;/p&gt;</comment>
                            <comment id="16099724" author="aks_apache" created="Tue, 25 Jul 2017 08:50:13 +0000"  >&lt;p&gt;I am also getting the similar issue, 1.15-SNAPSHOT will work in my case . if so, how to download it ?&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Untaring %s to dir %s.D:\ddc_data\010617.tar.gz D:\ddc_data
java.io.IOException: Error detected parsing the header
	at org.apache.commons.compress.archivers.tar.TarArchiveInputStream.getNextTarEntry(TarArchiveInputStream.java:286)
	at org.apache.commons.compress.archivers.tar.TarArchiveInputStream.getNextEntry(TarArchiveInputStream.java:600)
	at Main.unTar(Main.java:40)
	at Main.extractTarGzFile(Main.java:79)
	at Main.main(Main.java:108)
Caused by: java.lang.IllegalArgumentException: At offset 124, 12 byte binary number exceeds maximum signed long value
	at org.apache.commons.compress.archivers.tar.TarUtils.parseBinaryBigInteger(TarUtils.java:213)
	at org.apache.commons.compress.archivers.tar.TarUtils.parseOctalOrBinary(TarUtils.java:177)
	at org.apache.commons.compress.archivers.tar.TarArchiveEntry.parseTarHeader(TarArchiveEntry.java:1108)
	at org.apache.commons.compress.archivers.tar.TarArchiveEntry.parseTarHeader(TarArchiveEntry.java:1091)
	at org.apache.commons.compress.archivers.tar.TarArchiveEntry.&amp;lt;init&amp;gt;(TarArchiveEntry.java:368)
	at org.apache.commons.compress.archivers.tar.TarArchiveInputStream.getNextTarEntry(TarArchiveInputStream.java:284)
	... 4 more

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16099773" author="bodewig" created="Tue, 25 Jul 2017 09:34:12 +0000"  >&lt;p&gt;It is available from the Apache Snapshots repository: &lt;a href=&quot;https://repository.apache.org/snapshots/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/snapshots/&lt;/a&gt; - more specifically &lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/commons/commons-compress/1.15-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/commons/commons-compress/1.15-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Any version built after 2017-07-20 should do.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 16 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3hnlr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>