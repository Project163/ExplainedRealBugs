<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:29:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[COMPRESS-60] ChangeSet does not synchronise whilst using the Iterator</title>
                <link>https://issues.apache.org/jira/browse/COMPRESS-60</link>
                <project id="12310904" key="COMPRESS">Commons Compress</project>
                    <description>&lt;p&gt;ChangeSet does not synchronize whilst using the Iterator on the Set &quot;changes&quot; which is a synchronizedSet.&lt;/p&gt;

&lt;p&gt;The Javadoc for Collections.synchronizedSet says: &quot;&lt;br/&gt;
...&lt;br/&gt;
It is imperative that the user manually synchronize on the returned set when iterating over it:&lt;br/&gt;
...&lt;br/&gt;
Failure to follow this advice may result in non-deterministic behavior.&quot;&lt;/p&gt;

&lt;p&gt;This affects the add() and perfom() methods.&lt;/p&gt;

&lt;p&gt;Also, the asSet() method returns a reference to the Set.  This method does not seem to be used at present, so perhaps could be removed.&lt;br/&gt;
Otherwise, it should either return a copy of the set, or the Javadoc should point out that any iteration over the set must synchronize on the set.&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12419688">COMPRESS-60</key>
            <summary>ChangeSet does not synchronise whilst using the Iterator</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="grobmeier">Christian Grobmeier</assignee>
                                    <reporter username="sebb">Sebb</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Mar 2009 23:54:47 +0000</created>
                <updated>Tue, 2 May 2023 17:11:26 +0000</updated>
                            <resolved>Thu, 9 Apr 2009 11:17:27 +0000</resolved>
                                                    <fixVersion>1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12693434" author="grobmeier" created="Sat, 28 Mar 2009 13:03:36 +0000"  >&lt;p&gt;Reading this, I would think that we should remove asSet() to avoid those conflicts.&lt;br/&gt;
I cannot think about a usecase where a user should iterate over the set he just created.&lt;/p&gt;

&lt;p&gt;Sebb, as a threading guru, I am asking myself why I used a synchronized set. When removing asSet(),&lt;br/&gt;
is this necessary? I think not.&lt;/p&gt;
</comment>
                            <comment id="12693438" author="sebb@apache.org" created="Sat, 28 Mar 2009 13:51:16 +0000"  >&lt;p&gt;Depends on whether you want to make the class thread-safe or not.&lt;/p&gt;

&lt;p&gt;Would one ever want to create the same ChangeSet and apply it to multiple archives in multiple threads?&lt;br/&gt;
Probably not, and even if the class were thread-safe, sharing the same set of changes would not work.&lt;br/&gt;
The first thread to perform() the ChangeSet would remove one or more of the entries.&lt;/p&gt;

&lt;p&gt;In fact, ChangeSet is not even re-usable in a single thread, as perform empties the list of changes.&lt;/p&gt;

&lt;p&gt;There might be a use-case for making it re-usable - i.e. perform the same changes on multiple archives.&lt;/p&gt;

&lt;p&gt;In which case, perfom() should operate on a copy of the Set.&lt;/p&gt;

&lt;p&gt;It should then be possible to use the class in multiple threads, so long as:&lt;br/&gt;
+ other threads only used perform()&lt;br/&gt;
+ the creator thread did not change the instance after calling start() on the worker threads.&lt;/p&gt;

&lt;p&gt;Or I suppose one could create a new thread-safe (perhaps immutable)  &quot;performer&quot; class once a change set had been set up.&lt;br/&gt;
I.e. separate the creation of the ChangeSet from its application.&lt;/p&gt;</comment>
                            <comment id="12697475" author="grobmeier" created="Thu, 9 Apr 2009 11:17:27 +0000"  >&lt;p&gt;Issue resolved with: r763604&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Extracted immutable Performer class&lt;/li&gt;
	&lt;li&gt;added some notes on thread safety&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>110570</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 33 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0tflr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>169837</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>