<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:32:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[COMPRESS-452] &quot;Stream is not in the BZip2 format&quot; exception on valid archive</title>
                <link>https://issues.apache.org/jira/browse/COMPRESS-452</link>
                <project id="12310904" key="COMPRESS">Commons Compress</project>
                    <description>&lt;p&gt;The included 7z archive (with only one file), that is password protected, can be properly decompressed with 7z tool. Yet,&#160;getNextEntry() throws &quot;Stream is not in the BZip2 format&quot; exception.&lt;/p&gt;

&lt;p&gt;The code is:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] PASSWORD = &lt;span class=&quot;code-quote&quot;&gt;&quot;iBlm8NTigvru0Jr0&quot;&lt;/span&gt;.getBytes();

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
 &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; fileName = &lt;span class=&quot;code-quote&quot;&gt;&quot;r:/txt.7z&quot;&lt;/span&gt;;
 &#160; &#160; SevenZArchiveEntry entry;
 &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (SevenZFile arch = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SevenZFile(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(fileName), PASSWORD)) {
 &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; ((entry = arch.getNextEntry()) != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)&#160;

{ &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(entry.getName()); }

}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The same exception is thrown when one uses SevenZFile(SeekableByteChannel, byte[]) constructor. Password seems to be OK, since changing it yields different exception (and it also works in 7z tool).&lt;/p&gt;

&lt;p&gt;Full exception is:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Exception in thread &quot;main&quot; java.io.IOException: Stream is not in the BZip2 format
 &#160;at org.apache.commons.compress.compressors.bzip2.BZip2CompressorInputStream.init(BZip2CompressorInputStream.java:252)
 &#160;at org.apache.commons.compress.compressors.bzip2.BZip2CompressorInputStream.&amp;lt;init&amp;gt;(BZip2CompressorInputStream.java:134)
 &#160;at org.apache.commons.compress.compressors.bzip2.BZip2CompressorInputStream.&amp;lt;init&amp;gt;(BZip2CompressorInputStream.java:112)
 &#160;at org.apache.commons.compress.archivers.sevenz.Coders$BZIP2Decoder.decode(Coders.java:254)
 &#160;at org.apache.commons.compress.archivers.sevenz.Coders.addDecoder(Coders.java:79)
 &#160;at org.apache.commons.compress.archivers.sevenz.SevenZFile.buildDecoderStack(SevenZFile.java:933)
 &#160;at org.apache.commons.compress.archivers.sevenz.SevenZFile.buildDecodingStream(SevenZFile.java:909)
 &#160;at org.apache.commons.compress.archivers.sevenz.SevenZFile.getNextEntry(SevenZFile.java:222)
 &#160;at UnpackTest.main(UnpackTest.java:17)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13157456">COMPRESS-452</key>
            <summary>&quot;Stream is not in the BZip2 format&quot; exception on valid archive</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bodewig">Stefan Bodewig</assignee>
                                    <reporter username="cromax">Tomis&#322;aw Kity&#324;ski</reporter>
                        <labels>
                    </labels>
                <created>Sun, 6 May 2018 21:23:10 +0000</created>
                <updated>Thu, 10 May 2018 08:53:45 +0000</updated>
                            <resolved>Wed, 9 May 2018 10:45:10 +0000</resolved>
                                    <version>1.16.1</version>
                                    <fixVersion>1.17</fixVersion>
                                    <component>Archivers</component>
                    <component>Compressors</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16465415" author="bodewig" created="Mon, 7 May 2018 04:22:23 +0000"  >&lt;p&gt;Many thanks for the test case. Encryption is probably one of the less frequently used features so I&apos;m not surprised if there are bugs to be found. Is the archive something we could add to our test suite once the bug is fixed?&lt;/p&gt;

&lt;p&gt;BTW, I&apos;ve removed the &quot;fixed version&quot;, as the issue still exists in 1.16.1.&lt;/p&gt;</comment>
                            <comment id="16465448" author="bodewig" created="Mon, 7 May 2018 05:28:35 +0000"  >&lt;p&gt;Ah, the problem is this innocent looking part of the javadocs:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;the byte array is supposed to be the UTF16-LE encoded representation of the password.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;If you use&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;iBlm8NTigvru0Jr0&quot;&lt;/span&gt;.getBytes(&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-16LE&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;things start to work. I&apos;ll keep this issue open as a reminder to stress this even more in the docs and maybe add alternative constructors that help avoiding the trap.&lt;/p&gt;</comment>
                            <comment id="16465655" author="cromax" created="Mon, 7 May 2018 09:12:16 +0000"  >&lt;p&gt;Oh, I admit I blindly assumed it should be 8-bit ASCII encoding... Thanks for pointing that out! 8) Sure, you can include this archive into test suite if you wish to. Thanks once again!&lt;/p&gt;</comment>
                            <comment id="16465893" author="michael-o" created="Mon, 7 May 2018 13:11:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bodewig&quot; class=&quot;user-hover&quot; rel=&quot;bodewig&quot;&gt;bodewig&lt;/a&gt;, I&apos;d really deprecate the constructors and move to &lt;tt&gt;char[]&lt;/tt&gt;. This bug is so subtile that the client will search way too long for the cause.&lt;/p&gt;</comment>
                            <comment id="16465961" author="bodewig" created="Mon, 7 May 2018 14:28:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=michael-o&quot; class=&quot;user-hover&quot; rel=&quot;michael-o&quot;&gt;michael-o&lt;/a&gt; &lt;a href=&quot;https://github.com/apache/commons-compress/commit/237e1721221d158f6800e868cbefc83f02385029&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-compress/commit/237e1721221d158f6800e868cbefc83f02385029&lt;/a&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Problem is - and that&apos;s why it is not on master, yet - all code that used a constructor passing an explicit &lt;tt&gt;null&lt;/tt&gt; as password would need to be adjusted in order to compile.&lt;/p&gt;</comment>
                            <comment id="16465989" author="michael-o" created="Mon, 7 May 2018 14:58:20 +0000"  >&lt;p&gt;Ouch, this breaks binary compat, doesn&apos;t it?&lt;/p&gt;</comment>
                            <comment id="16466031" author="garydgregory" created="Mon, 7 May 2018 15:28:49 +0000"  >&lt;p&gt;Adding constructors does not break BC since the old ones are still there to be found. Breaking source compatibility is a pain but OK as long as we document what users should do in Javadocs.&lt;/p&gt;

&lt;p&gt;What does mvn clirr:check report? Also try japicmp.&lt;/p&gt;</comment>
                            <comment id="16466041" author="michael-o" created="Mon, 7 May 2018 15:36:03 +0000"  >&lt;p&gt;Passing&#160; &lt;tt&gt;null&lt;/tt&gt; would be a problem, wouldn&apos;t it &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="16466055" author="garydgregory" created="Mon, 7 May 2018 15:47:14 +0000"  >&lt;p&gt;How? Please explain.&lt;/p&gt;</comment>
                            <comment id="16466069" author="michael-o" created="Mon, 7 May 2018 15:57:32 +0000"  >&lt;p&gt;Which constructor would be chosen?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SevenZFile(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(fileName), &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;tt&gt;byte[]&lt;/tt&gt; or &lt;tt&gt;char[]&lt;/tt&gt;?&lt;/p&gt;</comment>
                            <comment id="16466089" author="bodewig" created="Mon, 7 May 2018 16:11:44 +0000"  >&lt;p&gt;japicmp doesn&apos;t see any breaking change at all, not even a source one. I&apos;d blame this on japicmp &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I haven&apos;t been able to use Clirr on Compress for a while now, the details are escaping me.&lt;br/&gt;
As for binary compatibility I&apos;m pretty sure the constructor signature seen by the compiler will be used. Method dispatch does most of its magic at compile time and at runtime only looks for the most derived class that provides the signature. In the case of constructors there is no derived class to look into at all.&lt;/p&gt;</comment>
                            <comment id="16466094" author="sebb@apache.org" created="Mon, 7 May 2018 16:18:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://docs.oracle.com/javase/specs/jls/se7/html/jls-13.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.oracle.com/javase/specs/jls/se7/html/jls-13.html&lt;/a&gt;&lt;br/&gt;
13.2 &quot;... The Java programming language is designed to prevent additions to contracts and accidental name collisions from breaking binary compatibility. Specifically, addition of more methods overloading a particular method name does not break compatibility with pre-existing binaries. The method signature that the pre-existing binary will use for method lookup is chosen by the method overload resolution algorithm at compile time (&#167;15.12.2).&quot;&lt;/p&gt;

&lt;p&gt;AFAICT the method signature is recorded in the class file in order to facilitate this.&lt;/p&gt;

&lt;p&gt;However it will break source compatibility; the compiler cannot resolve the ambiguity once the new method is available.&lt;/p&gt;

&lt;p&gt;Note that Maven/Clirr does not distinguish binary and source compatibility. Don&apos;t know about Japicmp.&lt;/p&gt;</comment>
                            <comment id="16466117" author="joehni" created="Mon, 7 May 2018 16:38:03 +0000"  >&lt;p&gt;We may add one more constructor without password argument. Anybody using null may then simply remove it.&lt;/p&gt;</comment>
                            <comment id="16466246" author="bodewig" created="Mon, 7 May 2018 17:51:53 +0000"  >&lt;p&gt;yes, done: &lt;a href=&quot;https://github.com/apache/commons-compress/commit/8040ea3db6f813afe6e83c935ed33e5c65966a60&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-compress/commit/8040ea3db6f813afe6e83c935ed33e5c65966a60&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16468691" author="bodewig" created="Wed, 9 May 2018 10:45:10 +0000"  >&lt;p&gt;The new constructors are in master now, also I updated the examples page to explicitly talk about the encoding to use.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12922198" name="txt.7z" size="24427" author="cromax" created="Sun, 6 May 2018 21:21:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311020" key="com.atlassian.jira.plugin.system.customfieldtypes:url">
                        <customfieldname>External issue URL</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[https://stackoverflow.com/questions/50198804/commons-compress-using-7z-gives-stream-is-not-in-the-bzip2-format]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 27 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3te7z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>