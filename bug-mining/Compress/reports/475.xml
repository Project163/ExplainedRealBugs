<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:36:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[COMPRESS-674] commons-compress-1.26.1 false positive on detecting archive</title>
                <link>https://issues.apache.org/jira/browse/COMPRESS-674</link>
                <project id="12310904" key="COMPRESS">Commons Compress</project>
                    <description>&lt;p&gt;I&#8217;m finding that commons-compress-1.26.1 is recognising a utf-16 text file as a tar archive &#8211; unlike the previous version&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This is the code that changed in that release in ArchiveStreamFactory - &lt;b&gt;public static String detect(final InputStream in) throws ArchiveException {&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;that differs in detection:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;if (signatureLength &amp;gt;= &lt;em&gt;TAR_HEADER_SIZE&lt;/em&gt;) {&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160; try (TarArchiveInputStream inputStream = new TarArchiveInputStream(new ByteArrayInputStream(tarHeader))) {&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;em&gt;// &lt;a href=&quot;https://issues.apache.org/jira/browse/COMPRESS-191&quot; title=&quot;Too relaxed tar detection in ArchiveStreamFactory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;COMPRESS-191&quot;&gt;&lt;del&gt;COMPRESS-191&lt;/del&gt;&lt;/a&gt; - verify the header checksum&lt;/em&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;em&gt;// &lt;a href=&quot;https://issues.apache.org/jira/browse/COMPRESS-644&quot; title=&quot;ArchiveStreamFactory.detect(InputStream) returns TAR for ICO file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;COMPRESS-644&quot;&gt;&lt;del&gt;COMPRESS-644&lt;/del&gt;&lt;/a&gt; - do not allow zero byte file entries&lt;/em&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; __&#160;&#160;&#160;&#160;&#160;&#160;&#160; TarArchiveEntry entry = inputStream.getNextEntry();&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;em&gt;// try to find the first non-directory entry within the first 10 entries.&lt;/em&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; __&#160;&#160;&#160;&#160;&#160;&#160;&#160; int count = 0;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; while (entry != null &amp;amp;&amp;amp; entry.isDirectory() &amp;amp;&amp;amp; count++ &amp;lt; &lt;em&gt;TAR_TEST_ENTRY_COUNT&lt;/em&gt;) {&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; entry = inputStream.getNextEntry();&lt;/tt&gt;&lt;br/&gt;
{{&#160;&#160;&#160;&#160;&#160;&#160;&#160; }}}&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (entry != null &amp;amp;&amp;amp; entry.isCheckSumOK() &amp;amp;&amp;amp; !entry.isDirectory() &amp;amp;&amp;amp; entry.getSize() &amp;gt; 0 || count &amp;gt; 0) {&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; return &lt;em&gt;TAR&lt;/em&gt;;&lt;/tt&gt;&lt;br/&gt;
{{&#160;&#160;&#160;&#160;&#160;&#160;&#160; }}}&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160; } catch (final Exception e) { &lt;em&gt;// NOPMD NOSONAR&lt;/em&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;em&gt;// can generate IllegalArgumentException as well as IOException auto-detection, simply not a TAR ignored&lt;/em&gt;&lt;/tt&gt;&lt;br/&gt;
{{&#160;&#160;&#160; __&#160;&#160;&#160; }}}&lt;br/&gt;
&lt;tt&gt;}&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I feel this is being too lenient.&#160; For instance at the last &#8220;if&#8221; statement, for the test file, entry is null and count=1.&#160; The code suggests it is looking for the first non-directory entry.&#160; It hasn&#8217;t found a non-directory entry in our case.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;For instance, the earlier code at least checked that the checksum was OK for the one entry it checked (it isn&#8217;t for our test file&#8230;)&lt;/p&gt;</description>
                <environment>&lt;p&gt;Intel running macOS Sonoma - but doubt this is significant&lt;/p&gt;</environment>
        <key id="13572744">COMPRESS-674</key>
            <summary>commons-compress-1.26.1 false positive on detecting archive</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="fatkudu">Gren Elliot</reporter>
                        <labels>
                    </labels>
                <created>Wed, 20 Mar 2024 22:12:29 +0000</created>
                <updated>Sat, 23 Mar 2024 18:30:25 +0000</updated>
                            <resolved>Thu, 21 Mar 2024 01:08:23 +0000</resolved>
                                    <version>1.26.1</version>
                                    <fixVersion>1.26.2</fixVersion>
                                    <component>Archivers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17829324" author="garydgregory" created="Wed, 20 Mar 2024 22:21:06 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fatkudu&quot; class=&quot;user-hover&quot; rel=&quot;fatkudu&quot;&gt;fatkudu&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thank you for your report.&lt;/p&gt;

&lt;p&gt;The best path forward is to provide a failing unit test as a PR on GitHub. If you have a fix, include it in the PR.&lt;/p&gt;

&lt;p&gt;Note that your description of the code is a mix of code and markup.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17830083" author="tallison@mitre.org" created="Sat, 23 Mar 2024 14:18:49 +0000"  >&lt;p&gt;Noticing this, too, just now, over on Tika: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-4220&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TIKA-4220&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We&apos;ll fork the fix and see how that improves results on our regression corpus. Thank you so much &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggregory&quot; class=&quot;user-hover&quot; rel=&quot;ggregory&quot;&gt;ggregory&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fatkudu&quot; class=&quot;user-hover&quot; rel=&quot;fatkudu&quot;&gt;fatkudu&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13573061">TIKA-4220</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 33 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1o48o:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>