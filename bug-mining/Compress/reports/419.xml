<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:34:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[COMPRESS-583] 1.21 generates different output binaries compared to older versions as well as on different OSes</title>
                <link>https://issues.apache.org/jira/browse/COMPRESS-583</link>
                <project id="12310904" key="COMPRESS">Commons Compress</project>
                    <description>&lt;p&gt;Upgrading &lt;tt&gt;commons-compress&lt;/tt&gt; had always been generating the same compressed output byte-to-byte for the same input (i.e., their SHA checksum didn&apos;t change between versions). However, starting with 1.21, we noticed it&apos;s generating different output than what previous versions are generating.&lt;/p&gt;

&lt;p&gt;We also noticed that the same code generates different binaries on different OSes. For example, 1.21 on Linux is different from 1.21 on Mac.&lt;/p&gt;

&lt;p&gt;However, at least on the same OS, 1.21 seems to reproducibly generate the same output.&lt;/p&gt;

&lt;p&gt;See the context at &lt;a href=&quot;https://github.com/GoogleContainerTools/jib/pull/3342&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/GoogleContainerTools/jib/pull/3342&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;b&gt;UPDATE&lt;/b&gt;: running diffoscope reveals that 1.21 is picking up the user and group of a local environment.&lt;/p&gt;

&lt;p&gt;(output below manually reformatted slightly for readability)&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;$ diffoscope 6d2763b0f3940d324ea6b55386429e5b173899608abf7d1bff62e25dd2e4dcea.tar.gz 32258c626498c13412679442e3417811bc7ab801c6928da2c2a97e0bbc380a88.tar.gz&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;--- 6d2763b0f3940d324ea6b55386429e5b173899608abf7d1bff62e25dd2e4dcea.tar.gz&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;+++ 32258c626498c13412679442e3417811bc7ab801c6928da2c2a97e0bbc380a88.tar.gz&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#9474; &amp;#8212; 6d2763b0f3940d324ea6b55386429e5b173899608abf7d1bff62e25dd2e4dcea.tar&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#9500;&#9472;&#9472; +++ 32258c626498c13412679442e3417811bc7ab801c6928da2c2a97e0bbc380a88.tar&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#9474; &#9500;&#9472;&#9472; file list&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#9474; &#9474; @@ -1,3 +1,3 @@&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#9474; &#9474; &lt;font color=&quot;#de350b&quot;&gt;-drwxr-xr-x 0&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;0&#160; &#160; &#160; &#160; &#160; 0 0 1970-01-01 00:00:01.000000 app/&lt;/font&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#9474; &#9474; &lt;font color=&quot;#00875a&quot;&gt;+drwxr-xr-x 0 chanseok (252384) eng (5000) 0 1970-01-01 00:00:01.000000 app/&lt;/font&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#9474; &#9474; &lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;-&#160; 0&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;0&#160; &#160; &#160; &#160; &#160; 0 0 1970-01-01 00:00:01.000000 app/fileB.txt&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#9474; &#9474; &lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;-&#160; 0&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;0&#160; &#160; &#160; &#160; &#160; 0 0 1970-01-01 00:00:01.000000 app/fileC.txt&lt;/tt&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13390775">COMPRESS-583</key>
            <summary>1.21 generates different output binaries compared to older versions as well as on different OSes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10008">Information Provided</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="francium25">Chanseok Oh</reporter>
                        <labels>
                    </labels>
                <created>Mon, 19 Jul 2021 20:50:59 +0000</created>
                <updated>Fri, 17 Mar 2023 19:22:45 +0000</updated>
                            <resolved>Fri, 17 Mar 2023 19:22:45 +0000</resolved>
                                    <version>1.21</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17383588" author="michael-o" created="Mon, 19 Jul 2021 21:12:35 +0000"  >&lt;p&gt;Did you run diffoscope on it?&lt;/p&gt;</comment>
                            <comment id="17385135" author="francium25" created="Wed, 21 Jul 2021 22:20:31 +0000"  >&lt;p&gt;Thanks for suggesting diffoscope. Looks like 1.21 is picking up the user and group of a local environment. I&apos;ve updated the description with the details.&lt;/p&gt;</comment>
                            <comment id="17385323" author="michael-o" created="Thu, 22 Jul 2021 07:38:17 +0000"  >&lt;p&gt;This isn&apos;t necessarily a bug, this is default behavior of &lt;tt&gt;tar(1)&lt;/tt&gt; and I guess this lib applies the same logic.&lt;/p&gt;</comment>
                            <comment id="17385550" author="francium25" created="Thu, 22 Jul 2021 14:40:41 +0000"  >&lt;p&gt;That&apos;s fair. Nothing is a bug if you say if the logic is intended to work that way, but my point is that this is a regression from 1.20 and a breaking change. I don&apos;t see any relevant changelog entry for this fix (or breaking change). Previously, it was always setting UID:GID as &lt;tt&gt;0:0&lt;/tt&gt; by default, and now with 1.21, I have to modify my code to call &lt;tt&gt;dir.setUserId(0)&lt;/tt&gt;, etc. So my question is, did you really introduce this fix intentionally (if so, where&apos;s the doc?) or it happened to be like this (i.e., regression)?&lt;/p&gt;</comment>
                            <comment id="17385575" author="michael-o" created="Thu, 22 Jul 2021 14:55:52 +0000"  >&lt;p&gt;I agree that this is an issue, it has not been documented as such: &lt;a href=&quot;https://commons.apache.org/proper/commons-compress/changes-report.html#a1.21&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://commons.apache.org/proper/commons-compress/changes-report.html#a1.21&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/commons-compress/commit/510d58915d4397e2184c63c55284fd7a315ed57d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-compress/commit/510d58915d4397e2184c63c55284fd7a315ed57d&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/COMPRESS-404&quot; title=&quot;Add Path equivalents to TarArchiveEntry, with methods using File delegating to equivalents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;COMPRESS-404&quot;&gt;&lt;del&gt;COMPRESS-404&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/commons-compress/pull/97&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-compress/pull/97&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17390263" author="peterlee" created="Fri, 30 Jul 2021 03:20:33 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=francium25&quot; class=&quot;user-hover&quot; rel=&quot;francium25&quot;&gt;francium25&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=michael-o&quot; class=&quot;user-hover&quot; rel=&quot;michael-o&quot;&gt;michael-o&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Sorry about the late reply and thank you for your reporting.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Upgrading&#160;&lt;tt&gt;commons-compress&lt;/tt&gt;&#160;had always been generating the same compressed output byte-to-byte for the same input (i.e., their SHA checksum didn&apos;t change between versions).&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Seems you are expecting Compress to generate exactly the same output in different versions and different OSes - IMHO this is not a breaking change. I will start a mail list thread to discuss about this.&lt;/p&gt;

&lt;p&gt;And of course you are welcome to join the mail list discussions. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Previously, it was always setting UID:GID as&#160;&lt;tt&gt;0:0&lt;/tt&gt;&#160;by default&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Yes, the uid/gid was not set when you create a&#160;TarArchiveEntry before 1.21, and it was changed in 1.21.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;So my question is, did you really introduce this fix intentionally (if so, where&apos;s the doc?) or it happened to be like this (i.e., regression)?&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/COMPRESS-404&quot; title=&quot;Add Path equivalents to TarArchiveEntry, with methods using File delegating to equivalents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;COMPRESS-404&quot;&gt;&lt;del&gt;COMPRESS-404&lt;/del&gt;&lt;/a&gt;&#160;was not to meant to read the UID/GID in&#160;TarArchiveEntry. As &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=michael-o&quot; class=&quot;user-hover&quot; rel=&quot;michael-o&quot;&gt;michael-o&lt;/a&gt;&#160;said, this is the&#160;default behavior of&#160;&lt;tt&gt;tar(1)&lt;/tt&gt;&#160;but we didn&apos;t do it before 1.21, so I approved that PR.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;I agree that this is an issue, it has not been documented as such:&lt;/em&gt;&#160;&lt;a href=&quot;#a1.21_&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;_https://commons.apache.org/proper/commons-compress/changes-report.html#a1.21_&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Yes. I think we didn&apos;t document this.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17390666" author="francium25" created="Fri, 30 Jul 2021 16:24:41 +0000"  >&lt;p&gt;Thanks for the update, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=peterlee&quot; class=&quot;user-hover&quot; rel=&quot;peterlee&quot;&gt;peterlee&lt;/a&gt;. We updated our code to always scrub UID/GID/user name/group name, which I think is the right thing to do on our side, so this change in 1.21 won&apos;t block us. I wouldn&apos;t argue that this should be reverted. Actually, I believe 1.20 was already picking up timestamp, so one could think that UID, GID, etc. are just new additions to it.&lt;/p&gt;

&lt;p&gt;I am not saying upgrading Compress should always generate exactly the same output in different versions and different OSes. Of course, you can freely introduce any kind of breaking changes (or &quot;behavioral changes&quot; if you don&apos;t consider the changes as &quot;breaking&quot;). It&apos;s just that initially, I had a good reason to believe that this could be an unintended regression (which mattered a lot to us), as I didn&apos;t find any relevant changelog for this behavioral change.&lt;/p&gt;

&lt;p&gt;BTW, reproducibility is very important in Docker (and thus to the broad Cloud ecosystem), because a container image is really just a collection of tarballs (+ some small metadata JSON files). Docker images are content-addressable; a difference of one byte means a different SHA digest checksum (i.e., considered a totally different image). Jib is a Docker image build tool, so that&apos;s why we immediately noticed this change in Compress. Not even just for Docker, reproducibility plays an important role for security and verification. So basically, I just hope Compress doesn&apos;t totally neglect this reproducibility aspect going forward.&lt;/p&gt;</comment>
                            <comment id="17390835" author="peterlee" created="Sat, 31 Jul 2021 01:31:07 +0000"  >&lt;p&gt;Thanks for your explanations&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=francium25&quot; class=&quot;user-hover&quot; rel=&quot;francium25&quot;&gt;francium25&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Now I understand the importance of reproducibility. We didn&apos;t do much for reproducibility before - we don&apos;t have enough related tests. We will try to improve this. PRs are always welcome. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&amp;gt;&#160;&lt;em&gt;as I didn&apos;t find any relevant changelog for this behavioral change.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;This is my bad. The PR #97 was not meant to introduce the uid/gid to TarArchiveEntry. I reviewed and merged this but I didn&apos;t notice this may cause a&#160;reproducibility problem - and I didn&apos;t record this in changelog.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;As you mentioned, 1.21 is already released and this could not be reverted. But you&apos;re right about the changelog. I&apos;m trying to update the release log of 1.21.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thank you for your reporting again.&lt;/p&gt;</comment>
                            <comment id="17390837" author="peterlee" created="Sat, 31 Jul 2021 01:46:36 +0000"  >&lt;p&gt;I pushed a commit &lt;a href=&quot;https://github.com/apache/commons-compress/commit/d57b8e9068bc0184b783aa488e613f4fcf2140d6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;d57b8e9&lt;/a&gt;&#160;to add this in changelog.&#160;Please have a look.&lt;/p&gt;

&lt;p&gt;Now the changelog of &lt;a href=&quot;https://issues.apache.org/jira/browse/COMPRESS-404&quot; title=&quot;Add Path equivalents to TarArchiveEntry, with methods using File delegating to equivalents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;COMPRESS-404&quot;&gt;&lt;del&gt;COMPRESS-404&lt;/del&gt;&lt;/a&gt; is :&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Update the class of variable file in TarArchiveEntry from&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;java.io.File to java.nio.file.Path. Corresponding constructors&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;and methods are also modified/added.&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;NOTE: The userName, groupName, userID and groupID will also be&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;set if they are available. The userName and groupName was not&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;set previously, and the previous value of UserID:GroupID was&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;0:0 by default.&lt;/em&gt;&lt;br/&gt;
 &lt;em&gt;Please note this may cause a reproducibility problem.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Github Pull Request #97.&lt;/em&gt;&lt;/p&gt;</comment>
                            <comment id="17391366" author="peterlee" created="Mon, 2 Aug 2021 06:34:24 +0000"  >&lt;p&gt;The website is updated. Please have a look. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=francium25&quot; class=&quot;user-hover&quot; rel=&quot;francium25&quot;&gt;francium25&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13078885">COMPRESS-404</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311020" key="com.atlassian.jira.plugin.system.customfieldtypes:url">
                        <customfieldname>External issue URL</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[https://github.com/GoogleContainerTools/jib/pull/3342]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 14 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0t52w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>