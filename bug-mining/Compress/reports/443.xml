<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:35:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[COMPRESS-638] The GzipCompressorOutputStream#writeHeader() uses ISO_8859_1 to write the file name and comment.  If the strings contains non-ISO_8859_1 characters, unknown characters are displayed after decompression. Use percent encoding for non ISO_8859_1 characters.</title>
                <link>https://issues.apache.org/jira/browse/COMPRESS-638</link>
                <project id="12310904" key="COMPRESS">Commons Compress</project>
                    <description>&lt;p&gt;The GzipCompressorOutputStream#writeHeader method uses the ISO_8859_1 to write the file name.&#160;&lt;br/&gt;
If the file name contains non-ISO_8859_1 characters, some unknown characters are displayed after decompression. &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13054462/13054462_0110.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;br/&gt;
&#160;Can change the ISO_8859_1 to UTF-8?&#160;&lt;br/&gt;
&#160; &#160; &#160; &#160; if (filename != null) &lt;/p&gt;
{
&#160; &#160; &#160; &#160; &#160; &#160; out.write(filename.getBytes(ISO_8859_1));
&#160; &#160; &#160; &#160; &#160; &#160; out.write(0);
&#160; &#160; &#160; &#160; }

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13517301">COMPRESS-638</key>
            <summary>The GzipCompressorOutputStream#writeHeader() uses ISO_8859_1 to write the file name and comment.  If the strings contains non-ISO_8859_1 characters, unknown characters are displayed after decompression. Use percent encoding for non ISO_8859_1 characters.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="Radar">Radar wen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Jan 2023 01:42:40 +0000</created>
                <updated>Thu, 7 Nov 2024 13:27:03 +0000</updated>
                            <resolved>Sat, 21 Jan 2023 14:24:14 +0000</resolved>
                                                    <fixVersion>1.23.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17656372" author="garydgregory" created="Tue, 10 Jan 2023 02:18:55 +0000"  >&lt;p&gt;You should likely check the GZip specification to see how this data is allowed to be encoded.&lt;/p&gt;</comment>
                            <comment id="17656390" author="garydgregory" created="Tue, 10 Jan 2023 03:03:31 +0000"  >&lt;p&gt;Looks like no:&#160;&lt;/p&gt;

&lt;p&gt;&quot;If FNAME is set, an original file name is present, terminated by a zero byte. The name must consist of ISO 8859-1 (LATIN-1) characters; on operating systems using EBCDIC or any other character set for file names, the name must be translated to the ISO LATIN-1 character set.&quot;&lt;/p&gt;

&lt;p&gt;From &lt;a href=&quot;https://www.ietf.org/rfc/rfc1952.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.ietf.org/rfc/rfc1952.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Do you have other sources that indicate otherwise?&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17657052" author="radar" created="Wed, 11 Jan 2023 02:54:03 +0000"  >&lt;p&gt;&#160; compress a single file into a .gz file without tar.&lt;/p&gt;

&lt;p&gt;&#160; &#160; &#160; &#160; String sourceFile = &quot;/tmp/&#27979;&#35797;&#20013;&#25991;&#21517;&#31216;.xml&quot;;&lt;br/&gt;
&#160; &#160; &#160; &#160; String targetFile = &quot;/tmp/test.gz&quot;;&lt;br/&gt;
&#160; &#160; &#160; &#160; GzipParameters parameters = new GzipParameters();&lt;br/&gt;
&#160; &#160; &#160; &#160; parameters.setFilename(&quot;&#27979;&#35797;&#20013;&#25991;&#21517;&#31216;.xml&quot;);&lt;br/&gt;
&#160; &#160; &#160; &#160; try (BufferedInputStream bis = new BufferedInputStream(new FileInputStream(new File(sourceFile)));&lt;br/&gt;
&#160; &#160; &#160; &#160; &#160; &#160; FileOutputStream fos = new FileOutputStream(new File(targetFile));&lt;br/&gt;
&#160; &#160; &#160; &#160; &#160; &#160; GzipCompressorOutputStream gos = new GzipCompressorOutputStream(fos, parameters)) &lt;/p&gt;
{
&#160; &#160; &#160; &#160; &#160; &#160; IOUtils.copy(bis, gos);
&#160; &#160; &#160; &#160; }
&lt;p&gt; catch (IOException e) {&lt;/p&gt;</comment>
                            <comment id="17657058" author="garydgregory" created="Wed, 11 Jan 2023 03:08:04 +0000"  >&lt;p&gt;See my previous comment.&lt;/p&gt;</comment>
                            <comment id="17657063" author="radar" created="Wed, 11 Jan 2023 03:25:33 +0000"  >&lt;p&gt;Currently, only ISO 8859-1 (LATIN-1) is supported. Can UTF-8 be supported?&lt;/p&gt;</comment>
                            <comment id="17657068" author="garydgregory" created="Wed, 11 Jan 2023 03:46:35 +0000"  >&lt;p&gt;I guess but it would break adherence to the RFC. It would have to be pluggable as well. Feel free to provide a PR.&lt;/p&gt;</comment>
                            <comment id="17675572" author="michael-o" created="Wed, 11 Jan 2023 13:34:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggregory&quot; class=&quot;user-hover&quot; rel=&quot;ggregory&quot;&gt;ggregory&lt;/a&gt;, I would not support a deviation from the RFC because that will creep into many other spheres. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Radar&quot; class=&quot;user-hover&quot; rel=&quot;Radar&quot;&gt;Radar&lt;/a&gt;, ugly but you could use percent-encoded UTF-8 values.&lt;/p&gt;</comment>
                            <comment id="17675574" author="michael-o" created="Wed, 11 Jan 2023 13:37:46 +0000"  >&lt;p&gt;I would at most do this approach via a flag: &lt;a href=&quot;https://stackoverflow.com/a/30446122/696632&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/a/30446122/696632&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17677398" author="garydgregory" created="Mon, 16 Jan 2023 13:50:05 +0000"  >&lt;p&gt;Note: I added &lt;tt&gt;org.apache.commons.compress.compressors.gzip.GzipCompressorOutputStreamTest&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;I don&apos;t think we can do anything that will be interoperable with all of the gzip utilities out in the world.&lt;/p&gt;

&lt;p&gt;Even if we convert non-ISO-8859-1-encodable file names to &lt;em&gt;something&lt;/em&gt; that &lt;em&gt;we&lt;/em&gt; can convert back ourselves, that will look odd elsewhere.&lt;/p&gt;

&lt;p&gt;For example, we could encode &quot;&#27979;&#35797;&#20013;&#25991;&#21517;&#31216;.xml&quot;/&quot;Test Chinese name.xml&quot; to &quot;\u6D4B\u8BD5\u4E2D\u6587\u540D\u79F0.xml&quot;&lt;/p&gt;</comment>
                            <comment id="17679127" author="garydgregory" created="Fri, 20 Jan 2023 12:21:18 +0000"  >&lt;p&gt;No further comments?&lt;br/&gt;
I might implement &lt;em&gt;something&lt;/em&gt; , or not, unless someone pipes up, such that at least we get legal characters instead of junk.&lt;/p&gt;</comment>
                            <comment id="17679322" author="michael-o" created="Fri, 20 Jan 2023 21:07:48 +0000"  >&lt;p&gt;Gary, why not pick up my proposal? Log a warning and make it percent-encoded?&lt;/p&gt;</comment>
                            <comment id="17679352" author="garydgregory" created="Fri, 20 Jan 2023 23:15:06 +0000"  >&lt;p&gt;Sure, I&apos;ll take a look this weekend but where is your proposal? A file name can&apos;t have percent signs in it on Windows IIRC. RE logging, I do not think ower level, components like Commons should log, so I&apos;d rather not add more logging. &lt;/p&gt;</comment>
                            <comment id="17679354" author="michael-o" created="Fri, 20 Jan 2023 23:19:08 +0000"  >&lt;p&gt;&lt;tt&gt;%%%.txt&lt;/tt&gt; works like a charm. Here is the proposal: &lt;a href=&quot;https://stackoverflow.com/questions/5325322/java-servlet-download-filename-special-characters/30446122#30446122&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/questions/5325322/java-servlet-download-filename-special-characters/30446122#30446122&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17679451" author="garydgregory" created="Sat, 21 Jan 2023 14:28:16 +0000"  >&lt;p&gt;Percent-encoding is now used for non-ISO_8859_1 characters.&lt;/p&gt;

&lt;p&gt;Please see git master or a snapshot build here: &lt;a href=&quot;https://repository.apache.org/content/repositories/snapshots/org/apache/commons/commons-compress/1.23-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/repositories/snapshots/org/apache/commons/commons-compress/1.23-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This should be considered a workaround IMO and we could change the percent-encoding format to something else in the future if needed.&lt;/p&gt;

&lt;p&gt;There is no roundtrip back to the non-ISO_8859_1 characters when reading a GZip since we cannot tell what the intent of the file name bytes really is unless we used some special marker, which is possible in the future in suppose.&lt;/p&gt;</comment>
                            <comment id="17896314" author="garydgregory" created="Thu, 7 Nov 2024 13:27:03 +0000"  >&lt;p&gt;See also git master for 1.28.0 and &lt;a href=&quot;https://github.com/apache/commons-compress/pull/602&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-compress/pull/602&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13054462" name="0110.png" size="5556" author="Radar" created="Tue, 10 Jan 2023 01:42:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1eo5k:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>