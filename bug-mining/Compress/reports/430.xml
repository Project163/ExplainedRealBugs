<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:34:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[COMPRESS-603] Expander does not support archives with archive entries beginning with ./</title>
                <link>https://issues.apache.org/jira/browse/COMPRESS-603</link>
                <project id="12310904" key="COMPRESS">Commons Compress</project>
                    <description>&lt;p&gt;Suppose I create a tar file from a directory like so:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
tar -cf foo.tar ./foo&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;When I try to extract the tar entries using the Expander class, that throws a&#160;java.io.IOException: Expanding ./ would create file outside of ...&lt;/p&gt;

&lt;p&gt;When I create the tar file without the leading ./, then Expander doesn&apos;t complain.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13420902">COMPRESS-603</key>
            <summary>Expander does not support archives with archive entries beginning with ./</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="peterlee">Peter Lee</assignee>
                                    <reporter username="mattsicker">Matt Sicker</reporter>
                        <labels>
                    </labels>
                <created>Wed, 5 Jan 2022 18:43:47 +0000</created>
                <updated>Mon, 21 Mar 2022 19:50:08 +0000</updated>
                            <resolved>Mon, 21 Mar 2022 19:49:58 +0000</resolved>
                                    <version>1.21</version>
                                    <fixVersion>1.22</fixVersion>
                                    <component>Archivers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17487914" author="peterlee" created="Mon, 7 Feb 2022 07:27:53 +0000"  >&lt;p&gt;I tested with the latest code but I can not reproduce this.&lt;/p&gt;

&lt;p&gt;My test code :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Test
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testCompress603() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException, ArchiveException {
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (TarFile f = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TarFile(getFile(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo.tar&quot;&lt;/span&gt;))) {
        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Expander().expand(f, resultDir);
    }
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Could you also attach the foo.tar so I can reproduce this? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17488298" author="jvz" created="Mon, 7 Feb 2022 18:03:29 +0000"  >&lt;p&gt;Added a basic test file.&lt;/p&gt;</comment>
                            <comment id="17488565" author="peterlee" created="Tue, 8 Feb 2022 02:45:49 +0000"  >&lt;p&gt;So this is a tar.gz archive, instead of a tar?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I tested with code at tag &lt;em&gt;rel/1.21&lt;/em&gt;, and it works well. My test code is :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Test
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testCompress603() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException, ArchiveException {
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; InputStream is = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileInputStream(getFile(&lt;span class=&quot;code-quote&quot;&gt;&quot;test.tar.gz&quot;&lt;/span&gt;))) {
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; InputStream gin = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GZIPInputStream(is);
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; TarArchiveInputStream tin = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TarArchiveInputStream(gin);
        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Expander().expand(tin, resultDir);
    }
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17488585" author="jvz" created="Tue, 8 Feb 2022 04:30:25 +0000"  >&lt;p&gt;I&apos;ll have to reproduce this issue again. I&apos;ll get further details from there. Did you use GNU tar, bsdtar, or something else when you first tried to create foo.tar yourself? I used GNU tar for the attached file, though it might be an issue with other tar files.&lt;/p&gt;</comment>
                            <comment id="17488621" author="peterlee" created="Tue, 8 Feb 2022 06:41:37 +0000"  >&lt;p&gt;I created foo.tar with GNU tar, and the expander works well.&lt;/p&gt;

&lt;p&gt;I will try to reproduce this issue with BSD tar.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Update:&lt;/p&gt;

&lt;p&gt;I&apos;m using bsdtar 3.2.2 to create a tar like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
bsdtar -cf foo.tar ./test.txt &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Still can not reproduce this issue.&lt;/p&gt;</comment>
                            <comment id="17489035" author="jvz" created="Tue, 8 Feb 2022 17:56:26 +0000"  >&lt;p&gt;I see two potential things that may be contributing to my initial issue:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;In my affected code, I extract a tarball to a directory created via &lt;tt&gt;Files.createTempDirectory().toFile()&lt;/tt&gt;; on Linux, this ends up somewhere in &lt;tt&gt;/tmp&lt;/tt&gt;, though I wonder how this would work if the Java tmpdir is a symlink.&lt;/li&gt;
	&lt;li&gt;The affected tarball I was initially notified about has a more complex directory structure, but the exception was thrown when the &lt;tt&gt;./&lt;/tt&gt; directory entry at the beginning of the tar file was attempted to be made. Running &lt;tt&gt;tar tf&lt;/tt&gt; on the file shows something like:&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&lt;tt&gt;./&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;./foo/&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;./foo/bar/&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;./foo/bar/baz.txt&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="17489299" author="peterlee" created="Wed, 9 Feb 2022 07:16:56 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mattsicker&quot; class=&quot;user-hover&quot; rel=&quot;mattsicker&quot;&gt;mattsicker&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;I can reproduce this like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Test
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testCompress603Tar() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException, ArchiveException {
    setupTarForCompress603();

    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (TarFile f = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TarFile(archive)) {
        &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Expander().expand(f, resultDir);
    }
}

&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void setupTarForCompress603() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException, ArchiveException {
    archive = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(dir, &lt;span class=&quot;code-quote&quot;&gt;&quot;test.tar&quot;&lt;/span&gt;);
    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; File dummy = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(dir, &lt;span class=&quot;code-quote&quot;&gt;&quot;x&quot;&lt;/span&gt;);
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (OutputStream o = Files.newOutputStream(dummy.toPath())) {
        o.write(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[14]);
    }
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (ArchiveOutputStream aos = ArchiveStreamFactory.DEFAULT
            .createArchiveOutputStream(&lt;span class=&quot;code-quote&quot;&gt;&quot;tar&quot;&lt;/span&gt;, Files.newOutputStream(archive.toPath()))) {
        aos.putArchiveEntry(aos.createArchiveEntry(dir, &lt;span class=&quot;code-quote&quot;&gt;&quot;./&quot;&lt;/span&gt;));
        aos.closeArchiveEntry();
        aos.putArchiveEntry(aos.createArchiveEntry(dir, &lt;span class=&quot;code-quote&quot;&gt;&quot;./a&quot;&lt;/span&gt;));
        aos.closeArchiveEntry();
        aos.finish();
    }
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;IMO creating a tar containing an entry with name of &quot;./&quot; a edge case, but I have to admit this is legal case - and GNU tar &amp;amp; bsdtar can successfully handle this.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Will fix this soon.&lt;/p&gt;</comment>
                            <comment id="17489313" author="peterlee" created="Wed, 9 Feb 2022 07:46:57 +0000"  >&lt;p&gt;Fixed with commit 510be7f.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mattsicker&quot; class=&quot;user-hover&quot; rel=&quot;mattsicker&quot;&gt;mattsicker&lt;/a&gt;&#160; Please have a look if it works. &#160;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17510087" author="jvz" created="Mon, 21 Mar 2022 19:49:45 +0000"  >&lt;p&gt;Alright, I finally had a chance to verify this, and I can confirm that your commit fixes the issue. I reproduced the problem with a basic unit test which fails with 1.21 but passes with a snapshot of 1.22. Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13039744" name="test.tar.gz" size="174" author="mattsicker" created="Mon, 7 Feb 2022 18:03:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 33 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ya80:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>