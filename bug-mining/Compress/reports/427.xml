<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:34:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[COMPRESS-592] Checksum verification failed reading 7z archive with more than 65536 entries</title>
                <link>https://issues.apache.org/jira/browse/COMPRESS-592</link>
                <project id="12310904" key="COMPRESS">Commons Compress</project>
                    <description>&lt;p&gt;I have a use-case where I have to decompress Sevenzip archives from an external source which may have a large number of entries.&lt;/p&gt;

&lt;p&gt;I found decompression fails when trying to extract entry 65536 (zero-based index) with a checksum failure.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I was able to reproduce the issue with a simple 7Zip file containing 70.001 entries with random MD5 checksum textfiles (attached).&lt;/p&gt;

&lt;p&gt;The sample Archive was created using the 7Zip Windows client and uses LZMA2:3m.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;My code is a simple sequential read of all contents of the file like&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    @Test
    void readBigSevenZipFile() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
    {
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (SevenZFile sevenZFile = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SevenZFile(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&quot;E:\\Temp\\0000_DOC.7z&quot;&lt;/span&gt;)))
        {
            SevenZArchiveEntry entry = sevenZFile.getNextEntry();
            &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (entry != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
            {
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (entry.hasStream())
                {
                    &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] content = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;) entry.getSize()];
                    sevenZFile.read(content);

                    &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(entry.getName());
                }

                entry = sevenZFile.getNextEntry();
            }
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;which fails consistently after file65535.txt with&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.io.IOException: Checksum verification failed
        at org.apache.commons.compress.utils.ChecksumVerifyingInputStream.read(ChecksumVerifyingInputStream.java:94) ~[commons-compress-1.21.jar!/:1.21]
        at org.apache.commons.compress.archivers.sevenz.SevenZFile.read(SevenZFile.java:1905) ~[commons-compress-1.21.jar!/:1.21]
        at org.apache.commons.compress.archivers.sevenz.SevenZFile.read(SevenZFile.java:1888) ~[commons-compress-1.21.jar!/:1.21]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;It is noticeable that the value is 2 to the 16th power, which could suggest an overflow error of some sorts.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;While the minimal sample contains only small txt files, I originally found the issue with larger archives containing also Image and PDF files. The archive&apos;s contents or size in byte does not seem to have direct influence on the issue, only the number of files contained within.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I did not find any workaround yet.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Compress 1.21 and XZ 1.9 on JDK 11; reproduced on both Windows and Ubuntu Linux&lt;/p&gt;</environment>
        <key id="13403536">COMPRESS-592</key>
            <summary>Checksum verification failed reading 7z archive with more than 65536 entries</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="rolandkreuzer">Roland Kreuzer</reporter>
                        <labels>
                    </labels>
                <created>Mon, 27 Sep 2021 13:31:02 +0000</created>
                <updated>Sat, 30 Oct 2021 01:03:50 +0000</updated>
                            <resolved>Sat, 30 Oct 2021 01:03:50 +0000</resolved>
                                    <version>1.21</version>
                                    <fixVersion>1.22</fixVersion>
                                    <component>Compressors</component>
                        <due></due>
                            <votes>3</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17435881" author="peterlee" created="Fri, 29 Oct 2021 10:08:49 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rolandkreuzer&quot; class=&quot;user-hover&quot; rel=&quot;rolandkreuzer&quot;&gt;rolandkreuzer&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thank you for your reporting! I think I have located this problem. Will try to fix this soon.&lt;/p&gt;</comment>
                            <comment id="17435890" author="peterlee" created="Fri, 29 Oct 2021 10:33:12 +0000"  >&lt;p&gt;I pushed a fix. Please have a look. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rolandkreuzer&quot; class=&quot;user-hover&quot; rel=&quot;rolandkreuzer&quot;&gt;rolandkreuzer&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17436069" author="rolandkreuzer" created="Fri, 29 Oct 2021 16:39:23 +0000"  >&lt;p&gt;Just did a test run on one of the previously failing archives and can confirm the issue fixed.&lt;/p&gt;

&lt;p&gt;Thanks a lot, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=peterlee&quot; class=&quot;user-hover&quot; rel=&quot;peterlee&quot;&gt;peterlee&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13034196" name="0000_DOC.7z" size="1053510" author="rolandkreuzer" created="Mon, 27 Sep 2021 13:23:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12314421" key="com.atlassian.jira.plugin.system.customfieldtypes:labels">
                        <customfieldname>Language</customfieldname>
                        <customfieldvalues>
                                        <label>Java</label>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 2 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0vbsw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>