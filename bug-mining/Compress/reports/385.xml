<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:34:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[COMPRESS-567] IllegalArgumentException in ZipFile.positionAtCentralDirectory</title>
                <link>https://issues.apache.org/jira/browse/COMPRESS-567</link>
                <project id="12310904" key="COMPRESS">Commons Compress</project>
                    <description>&lt;p&gt;The following snippet of code throws an undeclared IllegalArgumentException:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] bytes = Base64.getDecoder().decode(&lt;span class=&quot;code-quote&quot;&gt;&quot;UEsFBgAAAQD&lt;span class=&quot;code-comment&quot;&gt;//////////1AAJP9QAA==&quot;&lt;/span&gt;);
&lt;/span&gt;SeekableInMemoryByteChannel input = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SeekableInMemoryByteChannel(bytes);
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
    ZipFile file = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ZipFile(input);
} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException ignored) {}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The stack trace is:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.IllegalArgumentException: Position has to be in range 0.. 2147483647
	at org.apache.commons.compress.utils.SeekableInMemoryByteChannel.position(SeekableInMemoryByteChannel.java:94)
	at org.apache.commons.compress.archivers.zip.ZipFile.positionAtCentralDirectory32(ZipFile.java:1128)
	at org.apache.commons.compress.archivers.zip.ZipFile.positionAtCentralDirectory(ZipFile.java:1037)
	at org.apache.commons.compress.archivers.zip.ZipFile.populateFromCentralDirectory(ZipFile.java:702)
	at org.apache.commons.compress.archivers.zip.ZipFile.&amp;lt;init&amp;gt;(ZipFile.java:371)
	at org.apache.commons.compress.archivers.zip.ZipFile.&amp;lt;init&amp;gt;(ZipFile.java:318)
	at org.apache.commons.compress.archivers.zip.ZipFile.&amp;lt;init&amp;gt;(ZipFile.java:274)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I also attached the input as a ZIP file.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13360908">COMPRESS-567</key>
            <summary>IllegalArgumentException in ZipFile.positionAtCentralDirectory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="Meumertzheim">Fabian Meumertzheim</reporter>
                        <labels>
                    </labels>
                <created>Thu, 25 Feb 2021 08:41:24 +0000</created>
                <updated>Sat, 1 May 2021 08:14:40 +0000</updated>
                            <resolved>Sat, 1 May 2021 08:14:40 +0000</resolved>
                                    <version>1.20</version>
                                    <fixVersion>1.21</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17290875" author="peterlee" created="Thu, 25 Feb 2021 11:56:49 +0000"  >&lt;p&gt;The offset of start of CFH is a 4 bytes unsigned value with a maximum of 2^32 - 1 =&#160;4,294,967,295, which may exceeds the allowed range of&#160;SeekableInMemoryByteChannel.&lt;/p&gt;

&lt;p&gt;So you are expecting some other exception instead of&#160;IllegalArgumentException, is it?&lt;/p&gt;</comment>
                            <comment id="17290882" author="meumertzheim" created="Thu, 25 Feb 2021 12:17:34 +0000"  >&lt;p&gt;Yes, the ZIP is clearly invalid, but I would expect a (subclass of) IOException here instead of an IllegalArgumentException.&lt;/p&gt;</comment>
                            <comment id="17291474" author="peterlee" created="Fri, 26 Feb 2021 08:21:53 +0000"  >&lt;p&gt;Just curious about the test : how is the test file&#160;&lt;em&gt;Base64.getDecoder().decode(&quot;UEsFBgAAAQD//////////1AAJP9QAA==&quot;)&lt;/em&gt; generated?&#160;&lt;/p&gt;

&lt;p&gt;I believe this zip is generated by some fuzzer, and you encoded it with Base64 to simpify the test. Am I right?&lt;/p&gt;</comment>
                            <comment id="17291490" author="meumertzheim" created="Fri, 26 Feb 2021 08:49:44 +0000"  >&lt;p&gt;I found these bugs using &lt;a href=&quot;https://github.com/CodeIntelligenceTesting/jazzer&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/CodeIntelligenceTesting/jazzer&lt;/a&gt;, which provides you with both the raw crashing input and a Java reproducer with the raw input encoded as Base64 for easier sharing (byte array literals are cumbersome in Java and would need more characters).&lt;/p&gt;</comment>
                            <comment id="17291491" author="peterlee" created="Fri, 26 Feb 2021 08:52:29 +0000"  >&lt;p&gt;I see. Thank you for you explanation.&lt;/p&gt;</comment>
                            <comment id="17291742" author="bodewig" created="Fri, 26 Feb 2021 16:27:24 +0000"  >&lt;p&gt;most likely we should be throwing &lt;tt&gt;IOExceptions&lt;/tt&gt; in &lt;tt&gt;SeekableByteChannel&lt;/tt&gt;&apos;s &lt;tt&gt;position&lt;/tt&gt; - and fix &lt;tt&gt;truncate&lt;/tt&gt; at the same time.&lt;/p&gt;</comment>
                            <comment id="17292369" author="bodewig" created="Sun, 28 Feb 2021 10:45:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=peterlee&quot; class=&quot;user-hover&quot; rel=&quot;peterlee&quot;&gt;peterlee&lt;/a&gt; I&apos;ve gone a step further and made all our internally used stream classes throw &lt;tt&gt;IOException&lt;/tt&gt; with commit 32509ee9 - I&apos;d appreciate a second set of eyes.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13021197" name="crash.zip" size="22" author="Meumertzheim" created="Thu, 25 Feb 2021 08:36:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 36 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0o1uw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>