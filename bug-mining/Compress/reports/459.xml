<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:35:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[COMPRESS-654] Issue extracting certain sparse tarballs</title>
                <link>https://issues.apache.org/jira/browse/COMPRESS-654</link>
                <project id="12310904" key="COMPRESS">Commons Compress</project>
                    <description>&lt;p&gt;We maintain the Bazel (&lt;a href=&quot;https://bazel.build/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bazel.build/&lt;/a&gt;) build system, which uses Apache Commons Compress to handle archive extraction. A user reported that a certain sparse tarball always triggers an error (&lt;a href=&quot;https://github.com/bazelbuild/bazel/issues/20269#issuecomment-1821250607&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/bazelbuild/bazel/issues/20269#issuecomment-1821250607&lt;/a&gt;), and the steps to reproduce the error are very simple:&lt;br/&gt;
&#160;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;#!/usr/bin/env bash&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;set -o errexit -o nounset&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;echo &quot;Downloading commons-compress&quot;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;wget &lt;a href=&quot;https://repo1.maven.org/maven2/org/apache/commons/commons-compress/1.25.0/commons-compress-1.25.0.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repo1.maven.org/maven2/org/apache/commons/commons-compress/1.25.0/commons-compress-1.25.0.jar&lt;/a&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;echo &quot;Downloading sample sparse archive&quot;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;wget &lt;a href=&quot;https://github.com/astral-sh/ruff/releases/download/v0.1.6/ruff-aarch64-apple-darwin.tar.gz&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/astral-sh/ruff/releases/download/v0.1.6/ruff-aarch64-apple-darwin.tar.gz&lt;/a&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;gunzip ruff-aarch64-apple-darwin.tar.gz&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;echo &quot;Testing with system tar&quot;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;tar -tf ruff-aarch64-apple-darwin.tar&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;echo &quot;Testing with commons-compress&quot;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;java -jar commons-compress-1.25.0.jar ruff-aarch64-apple-darwin.tar&lt;/tt&gt;&lt;br/&gt;
&#160;&lt;/p&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;Testing with system tar&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;ruff&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Testing with commons-compress&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Analysing ruff-aarch64-apple-darwin.tar&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Created org.apache.commons.compress.archivers.tar.TarArchiveInputStream@17f052a3&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;ruff&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Exception in thread &quot;main&quot; java.io.IOException: Truncated TAR archive&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;at org.apache.commons.compress.archivers.tar.TarArchiveInputStream.read(TarArchiveInputStream.java:694)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;at org.apache.commons.compress.utils.IOUtils.readFully(IOUtils.java:244)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;at org.apache.commons.compress.utils.IOUtils.skip(IOUtils.java:355)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;at org.apache.commons.compress.archivers.tar.TarArchiveInputStream.getNextTarEntry(TarArchiveInputStream.java:451)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;at org.apache.commons.compress.archivers.tar.TarArchiveInputStream.getNextEntry(TarArchiveInputStream.java:426)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;at org.apache.commons.compress.archivers.tar.TarArchiveInputStream.getNextEntry(TarArchiveInputStream.java:50)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;at org.apache.commons.compress.archivers.Lister.listStream(Lister.java:79)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;at org.apache.commons.compress.archivers.Lister.main(Lister.java:133)&lt;/tt&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13559097">COMPRESS-654</key>
            <summary>Issue extracting certain sparse tarballs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="wyverald">Xudong Yang</reporter>
                        <labels>
                    </labels>
                <created>Wed, 22 Nov 2023 19:53:16 +0000</created>
                <updated>Thu, 1 Feb 2024 14:07:15 +0000</updated>
                            <resolved>Thu, 1 Feb 2024 14:07:15 +0000</resolved>
                                    <version>1.25.0</version>
                                    <fixVersion>1.26.0</fixVersion>
                                    <component>Archivers</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17812694" author="garydgregory" created="Wed, 31 Jan 2024 12:52:14 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=wyverald&quot; class=&quot;user-hover&quot; rel=&quot;wyverald&quot;&gt;wyverald&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thank you for your report. Would you please attach a problematic file to this ticket? This will avoid any reproducibility issue.&lt;/p&gt;</comment>
                            <comment id="17812860" author="JIRAUSER303229" created="Wed, 31 Jan 2024 21:08:22 +0000"  >&lt;p&gt;I just downloaded and attached the file linked in the repro steps.&lt;/p&gt;</comment>
                            <comment id="17813198" author="garydgregory" created="Thu, 1 Feb 2024 12:45:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=wyverald&quot; class=&quot;user-hover&quot; rel=&quot;wyverald&quot;&gt;wyverald&lt;/a&gt;&lt;br/&gt;
From the dev mailing list at &lt;a href=&quot;https://lists.apache.org/thread/c8k9cgoko3d1xntjnscq9s7fhz85x276&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lists.apache.org/thread/c8k9cgoko3d1xntjnscq9s7fhz85x276&lt;/a&gt; :&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;---------- Forwarded message ---------
From: Peter Hull &amp;lt;peterhull90@gmail.com&amp;gt;
Date: Wed, Jan 31, 2024 at 8:34&#8239;AM
Subject: Re: [COMPRESS] Decompress BZIP2 File Max Output is 900000 chars
To: Commons Developers List &amp;lt;dev@commons.apache.org&amp;gt;


I can&apos;t add to the JIRA bug but I had a quick play on WSL (debian),
Java 21, compress 1.25.0 and found:
Using dd if=/dev/random I could create a big file, compress it with
bzip2 and then decompress it with BZip2CompressorInputStream , no
problems
Same file compressed with pbzip2 was truncated at 900000 as described.
Those 900000 bytes were just the first 900000 bytes of the correct output
So it is pbzip2 vs bzip2, nothing to do with tar files.

Description for BZip2CompressorInputStream
(https://commons.apache.org/proper/commons-compress/apidocs/org/apache/commons/compress/compressors/bzip2/BZip2CompressorInputStream.html)
says there is another constructor with a boolean flag for
decompressing concatenated files.

Using this constructor appears to work OK.

Therefore I assume that pbzip2 creates concatenated bzip files?

Hope that helps
Peter
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17813242" author="garydgregory" created="Thu, 1 Feb 2024 14:07:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=wyverald&quot; class=&quot;user-hover&quot; rel=&quot;wyverald&quot;&gt;wyverald&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;The &lt;tt&gt;Lister&lt;/tt&gt; app is fixed in git master and snapshot builds in &lt;a href=&quot;https://repository.apache.org/content/repositories/snapshots/org/apache/commons/commons-compress/1.26.0-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/repositories/snapshots/org/apache/commons/commons-compress/1.26.0-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If you code against our input stream classes, you&apos;ll likely have to use the constructor that allows for reading additional input.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13066385" name="ruff-aarch64-apple-darwin.tar.gz" size="5638169" author="wyverald" created="Wed, 31 Jan 2024 21:08:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 40 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1lsiw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>