diff --git a/src/main/java/org/apache/commons/compress/archivers/sevenz/SevenZFile.java b/src/main/java/org/apache/commons/compress/archivers/sevenz/SevenZFile.java
index 793df3c26..cdf38206a 100644
--- a/src/main/java/org/apache/commons/compress/archivers/sevenz/SevenZFile.java
+++ b/src/main/java/org/apache/commons/compress/archivers/sevenz/SevenZFile.java
@@ -1144,12 +1144,12 @@ private BitSet readAllOrBits(final ByteBuffer header, final int size) throws IOE
 
     private void readArchiveProperties(final ByteBuffer input) throws IOException {
         // FIXME: the reference implementation just throws them away?
-        int nid = getUnsignedByte(input);
+        long nid = readUint64(input);
         while (nid != NID.kEnd) {
             final long propertySize = readUint64(input);
             final byte[] property = new byte[(int) propertySize];
             get(input, property);
-            nid = getUnsignedByte(input);
+            nid = readUint64(input);
         }
     }
 
@@ -1739,13 +1739,13 @@ private ArchiveStatistics sanityCheckAndCollectStatistics(final ByteBuffer heade
     }
 
     private void sanityCheckArchiveProperties(final ByteBuffer header) throws IOException {
-        int nid = getUnsignedByte(header);
+        long nid = readUint64(header);
         while (nid != NID.kEnd) {
             final int propertySize = assertFitsIntoNonNegativeInt("propertySize", readUint64(header));
             if (skipBytesFully(header, propertySize) < propertySize) {
                 throw new IOException("invalid property size");
             }
-            nid = getUnsignedByte(header);
+            nid = readUint64(header);
         }
     }
 
diff --git a/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java b/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java
index 717f890e5..5ed40f5f4 100644
--- a/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java
+++ b/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java
@@ -787,6 +787,28 @@ public void testReadEntriesOfSize0() throws IOException {
         }
     }
 
+    /**
+     * Test case for <a href="https://issues.apache.org/jira/browse/COMPRESS-681" >COMPRESS-681</a>.
+     */
+    @Test
+    public void testReadingArchiveProperties() throws IOException {
+        final String entryName = "COMPRESS-681.txt";
+        final String entryContent = "https://issues.apache.org/jira/browse/COMPRESS-681";
+        try (SevenZFile archive = getSevenZFile("COMPRESS-681.7z")) {
+            final SevenZArchiveEntry entry = archive.getNextEntry();
+            assertEquals(entryName, entry.getName());
+            final byte[] contents = new byte[(int) entry.getSize()];
+            int off = 0;
+            while (off < contents.length) {
+                final int bytesRead = archive.read(contents, off, contents.length - off);
+                assert bytesRead >= 0;
+                off += bytesRead;
+            }
+            assertEquals(entryContent, new String(contents, UTF_8));
+            assertNull(archive.getNextEntry());
+        }
+    }
+
     @Test
     public void testReadingBackDeltaDistance() throws Exception {
         final File output = newTempFile("delta-distance.7z");
diff --git a/src/test/resources/COMPRESS-681.7z b/src/test/resources/COMPRESS-681.7z
new file mode 100644
index 000000000..f457f7aaa
Binary files /dev/null and b/src/test/resources/COMPRESS-681.7z differ
