diff --git a/src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java b/src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java
index 9c13316aa..99ea2acf0 100644
--- a/src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java
+++ b/src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java
@@ -282,7 +282,7 @@ public static String detect(final InputStream in) throws ArchiveException {
                 TarArchiveEntry entry = inputStream.getNextEntry();
                 // try to find the first non-directory entry within the first 10 entries.
                 int count = 0;
-                while (entry != null && entry.isDirectory() && count++ < TAR_TEST_ENTRY_COUNT) {
+                while (entry != null && entry.isDirectory() && entry.isCheckSumOK() && count++ < TAR_TEST_ENTRY_COUNT) {
                     entry = inputStream.getNextEntry();
                 }
                 if (entry != null && entry.isCheckSumOK() && !entry.isDirectory() && entry.getSize() > 0 || count > 0) {
diff --git a/src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java b/src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java
index f2a172273..65f879364 100644
--- a/src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java
+++ b/src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java
@@ -282,6 +282,26 @@ public void testDetect() throws Exception {
         assertEquals("IOException while reading signature.", e3.getMessage());
     }
 
+    /**
+     * Test case for <a href="https://issues.apache.org/jira/browse/COMPRESS-674" >COMPRESS-674</a>.
+     */
+    @Test
+    void testUtf16TextIsNotTAR() {
+        final ArchiveException archiveException = assertThrows(ArchiveException.class,
+                () -> detect("utf16-text.txt"));
+        assertEquals("No Archiver found for the stream signature", archiveException.getMessage());
+    }
+
+    @Test
+    void testTarContainingEmptyDirIsTAR() throws IOException, ArchiveException {
+        assertEquals(ArchiveStreamFactory.TAR, detect("emptyDir.tar"));
+    }
+
+    @Test
+    void testTarContainingDirWith1TxtFileIsTAR() throws IOException, ArchiveException {
+        assertEquals(ArchiveStreamFactory.TAR, detect("dirWith1TxtFile.tar"));
+    }
+
     /**
      * Test case for <a href="https://issues.apache.org/jira/browse/COMPRESS-267" >COMPRESS-267</a>.
      */
diff --git a/src/test/resources/dirWith1TxtFile.tar b/src/test/resources/dirWith1TxtFile.tar
new file mode 100644
index 000000000..e38d8e595
Binary files /dev/null and b/src/test/resources/dirWith1TxtFile.tar differ
diff --git a/src/test/resources/emptyDir.tar b/src/test/resources/emptyDir.tar
new file mode 100644
index 000000000..86c0bc961
Binary files /dev/null and b/src/test/resources/emptyDir.tar differ
diff --git a/src/test/resources/utf16-text.txt b/src/test/resources/utf16-text.txt
new file mode 100644
index 000000000..c45e48e74
Binary files /dev/null and b/src/test/resources/utf16-text.txt differ
