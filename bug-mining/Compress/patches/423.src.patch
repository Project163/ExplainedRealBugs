diff --git a/src/main/java/org/apache/commons/compress/utils/IOUtils.java b/src/main/java/org/apache/commons/compress/utils/IOUtils.java
index 3a1f58299..d07f3d879 100644
--- a/src/main/java/org/apache/commons/compress/utils/IOUtils.java
+++ b/src/main/java/org/apache/commons/compress/utils/IOUtils.java
@@ -367,6 +367,8 @@ public static byte[] readRange(final ReadableByteChannel input, final int len) t
         final ByteBuffer b = ByteBuffer.allocate(Math.min(len, COPY_BUF_SIZE));
         int read = 0;
         while (read < len) {
+            // Make sure we never read more than len bytes
+            b.limit(Math.min(len - read, b.capacity()));
             final int readNow = input.read(b);
             if (readNow <= 0) {
                 break;
diff --git a/src/test/java/org/apache/commons/compress/utils/IOUtilsTest.java b/src/test/java/org/apache/commons/compress/utils/IOUtilsTest.java
index a692ef03b..f5d00dcc9 100644
--- a/src/test/java/org/apache/commons/compress/utils/IOUtilsTest.java
+++ b/src/test/java/org/apache/commons/compress/utils/IOUtilsTest.java
@@ -23,6 +23,7 @@
 import java.io.FilterInputStream;
 import java.io.InputStream;
 import java.io.IOException;
+import java.lang.reflect.Field;
 import java.nio.ByteBuffer;
 import java.nio.channels.ReadableByteChannel;
 
@@ -148,6 +149,43 @@ public void readRangeFromChannelDoesntReadMoreThanAskedFor() throws IOException
         }
     }
 
+    @Test
+    public void readRangeFromChannelDoesntReadMoreThanAskedForWhenItGotLessInFirstReadCall() throws IOException {
+        try (ReadableByteChannel in = new SeekableInMemoryByteChannel(new byte[] { 1, 2, 3, 4, 5, 6, 7 }) {
+            @Override
+            public int read(ByteBuffer buf) throws IOException {
+                // Trickle max 2 bytes at a time to trigger COMPRESS-584
+                final ByteBuffer temp = ByteBuffer.allocate(Math.min(2, buf.remaining()));
+                final int read = super.read(temp);
+                if (read > 0) {
+                    buf.put(temp.array(), 0, read);
+                }
+                return read;
+            }
+        }) {
+            final byte[] read = IOUtils.readRange(in, 5);
+            Assert.assertArrayEquals(new byte[] { 1, 2, 3, 4, 5 }, read);
+        }
+    }
+
+    @Test
+    public void readRangeMoreThanCopyBufferSize() throws Exception {
+        final Field COPY_BUF_SIZE = IOUtils.class.getDeclaredField("COPY_BUF_SIZE");
+        COPY_BUF_SIZE.setAccessible(true);
+        final int copyBufSize = (int)COPY_BUF_SIZE.get(null);
+
+        // Make an input that requires two read loops to trigger COMPRESS-585
+        final byte[] input = new byte[copyBufSize + 10];
+
+        try (SeekableInMemoryByteChannel in = new SeekableInMemoryByteChannel(input)) {
+            // Ask for less than the input length, but more than the buffer size
+            final int toRead = copyBufSize + 1;
+            final byte[] read = IOUtils.readRange(in, toRead);
+            Assert.assertEquals(toRead, read.length);
+            Assert.assertEquals(toRead, in.position());
+        }
+    }
+
     @Test
     public void readRangeFromChannelStopsIfThereIsNothingToReadAnymore() throws IOException {
         try (ReadableByteChannel in = new SeekableInMemoryByteChannel(new byte[] { 1, 2, 3, 4, 5 })) {
