diff --git a/src/test/java/org/apache/commons/compress/compressors/snappy/FramedSnappyCompressorInputStreamTest.java b/src/test/java/org/apache/commons/compress/compressors/snappy/FramedSnappyCompressorInputStreamTest.java
index cca9495bc..0f0704186 100644
--- a/src/test/java/org/apache/commons/compress/compressors/snappy/FramedSnappyCompressorInputStreamTest.java
+++ b/src/test/java/org/apache/commons/compress/compressors/snappy/FramedSnappyCompressorInputStreamTest.java
@@ -170,6 +170,26 @@ public void readIWAFile() throws Exception {
         }
     }
 
+    /**
+     * @see "https://issues.apache.org/jira/browse/COMPRESS-358"
+     */
+    @Test
+    public void readIWAFileWithBiggerOffset() throws Exception {
+        File o = new File(dir, "COMPRESS-358.raw");
+        try (InputStream is = new FileInputStream(getFile("COMPRESS-358.iwa"));
+             FramedSnappyCompressorInputStream in =
+                 new FramedSnappyCompressorInputStream(is, 1<<16, FramedSnappyDialect.IWORK_ARCHIVE);
+             FileOutputStream out = new FileOutputStream(o)) {
+            IOUtils.copy(in, out);
+        }
+        try (FileInputStream a = new FileInputStream(o);
+             FileInputStream e = new FileInputStream(getFile("COMPRESS-358.uncompressed"))) {
+            byte[] expected = IOUtils.toByteArray(e);
+            byte[] actual = IOUtils.toByteArray(a);
+            assertArrayEquals(expected, actual);
+        }
+    }
+
     private void testChecksumUnmasking(final long x) {
         assertEquals(Long.toHexString(x),
                      Long.toHexString(FramedSnappyCompressorInputStream
diff --git a/src/test/resources/COMPRESS-358.iwa b/src/test/resources/COMPRESS-358.iwa
new file mode 100644
index 000000000..116d79cc3
Binary files /dev/null and b/src/test/resources/COMPRESS-358.iwa differ
diff --git a/src/test/resources/COMPRESS-358.uncompressed b/src/test/resources/COMPRESS-358.uncompressed
new file mode 100644
index 000000000..e7cfa3415
Binary files /dev/null and b/src/test/resources/COMPRESS-358.uncompressed differ
