diff --git a/src/main/java/org/apache/commons/compress/archivers/sevenz/SevenZFile.java b/src/main/java/org/apache/commons/compress/archivers/sevenz/SevenZFile.java
index 8be1a4c99..d926cb06c 100644
--- a/src/main/java/org/apache/commons/compress/archivers/sevenz/SevenZFile.java
+++ b/src/main/java/org/apache/commons/compress/archivers/sevenz/SevenZFile.java
@@ -874,6 +874,7 @@ private void buildDecodingStream(final int entryIndex, final boolean isRandomAcc
                     .setChecksum(new CRC32())
                     .setInputStream(fileStream)
                     .setExpectedChecksumValue(file.getCrcValue())
+                    .setCountThreshold(file.getSize())
                     .get();
             // @formatter:on
         }
diff --git a/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java b/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java
index 8106b232f..01cb22c67 100644
--- a/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java
+++ b/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java
@@ -57,6 +57,7 @@
 import org.apache.commons.compress.utils.MultiReadOnlySeekableByteChannel;
 import org.apache.commons.compress.utils.SeekableInMemoryByteChannel;
 import org.apache.commons.io.IOUtils;
+import org.apache.commons.io.input.ChecksumInputStream;
 import org.junit.jupiter.api.Test;
 
 class SevenZFileTest extends AbstractTest {
@@ -939,4 +940,21 @@ void testSignatureCheck() {
         assertTrue(SevenZFile.matches(new byte[] { '7', 'z', (byte) 0xBC, (byte) 0xAF, 0x27, 0x1C }, 6));
         assertFalse(SevenZFile.matches(new byte[] { '7', 'z', (byte) 0xBC, (byte) 0xAF, 0x27, 0x1D }, 6));
     }
+
+    @Test
+    void testRemainingBytesUnchangedAfterRead() throws Exception {
+        try (SevenZFile sevenZFile = getSevenZFile("COMPRESS-256.7z")) {
+            for (final SevenZArchiveEntry entry : sevenZFile.getEntries()) {
+                final InputStream inputStream = sevenZFile.getInputStream(entry);
+                if (!(inputStream instanceof ChecksumInputStream)) {
+                    continue;
+                }
+                assertEquals(entry.getSize(), ((ChecksumInputStream) inputStream).getRemaining());
+                // read 10 byte
+                final byte[] bytes = new byte[10];
+                inputStream.read(bytes);
+                assertNotEquals(entry.getSize(), ((ChecksumInputStream) inputStream).getRemaining());
+            }
+        }
+    }
 }
