diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index b329286fc..232710b31 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -48,6 +48,11 @@ The <action> type attribute can be add,update,fix,remove.
         BZip2CompressorInputStream read fewer bytes than possible from
         a truncated stream.
       </action> 
+      <action issue="COMPRESS-253" type="fix" date="2014-01-22">
+        SevenZFile failed claiming the dictionary was too large when
+        archives used LZMA compression for headers and content and
+        certain non-default dictinary sizes.
+      </action>
     </release>
     <release version="1.7" date="2014-01-20"
              description="Release 1.7">
diff --git a/src/main/java/org/apache/commons/compress/archivers/sevenz/Coders.java b/src/main/java/org/apache/commons/compress/archivers/sevenz/Coders.java
index 0bc5a1ee8..5e4f3e9d8 100644
--- a/src/main/java/org/apache/commons/compress/archivers/sevenz/Coders.java
+++ b/src/main/java/org/apache/commons/compress/archivers/sevenz/Coders.java
@@ -109,7 +109,7 @@ InputStream decode(final InputStream in, final Coder coder,
             byte propsByte = coder.properties[0];
             long dictSize = coder.properties[1];
             for (int i = 1; i < 4; i++) {
-                dictSize |= (coder.properties[i + 1] << (8 * i));
+                dictSize |= (coder.properties[i + 1] & 0xffl) << (8 * i);
             }
             if (dictSize > LZMAInputStream.DICT_SIZE_MAX) {
                 throw new IOException("Dictionary larger than 4GiB maximum size");
diff --git a/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java b/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java
index 69200b633..e2a91f47c 100644
--- a/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java
+++ b/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java
@@ -72,6 +72,22 @@ public void testEncryptedArchiveRequiresPassword() throws Exception {
         }
     }
 
+    /**
+     * @see "https://issues.apache.org/jira/browse/COMPRESS-256"
+     */
+    public void testCompressedHeaderWithNonDefaultDictionarySize() throws Exception {
+        SevenZFile sevenZFile = new SevenZFile(getFile("COMPRESS-256.7z"));
+        try {
+            int count = 0;
+            while (sevenZFile.getNextEntry() != null) {
+                count++;
+            }
+            assertEquals(446, count);
+        } finally {
+            sevenZFile.close();
+        }
+    }
+
     private void test7zUnarchive(File f, byte[] password) throws Exception {
         SevenZFile sevenZFile = new SevenZFile(f, password);
         try {
diff --git a/src/test/resources/COMPRESS-256.7z b/src/test/resources/COMPRESS-256.7z
new file mode 100644
index 000000000..1c6a2e787
Binary files /dev/null and b/src/test/resources/COMPRESS-256.7z differ
