diff --git a/src/main/java/org/apache/commons/compress/compressors/lz4/FramedLZ4CompressorInputStream.java b/src/main/java/org/apache/commons/compress/compressors/lz4/FramedLZ4CompressorInputStream.java
index 338725eb3..f0cf22269 100644
--- a/src/main/java/org/apache/commons/compress/compressors/lz4/FramedLZ4CompressorInputStream.java
+++ b/src/main/java/org/apache/commons/compress/compressors/lz4/FramedLZ4CompressorInputStream.java
@@ -251,6 +251,9 @@ private void nextBlock() throws IOException {
         long len = ByteUtils.fromLittleEndian(supplier, 4);
         boolean uncompressed = (len & UNCOMPRESSED_FLAG_MASK) != 0;
         int realLen = (int) (len & (~UNCOMPRESSED_FLAG_MASK));
+        if (realLen < 0) {
+            throw new IOException("found illegal block with negative size");
+        }
         if (realLen == 0) {
             verifyContentChecksum();
             if (!decompressConcatenated) {
@@ -353,7 +356,10 @@ private static boolean isSkippableFrameSignature(byte[] b) {
     private int skipSkippableFrame(byte[] b) throws IOException {
         int read = 4;
         while (read == 4 && isSkippableFrameSignature(b)) {
-            long len = ByteUtils.fromLittleEndian(supplier, 4);
+            final long len = ByteUtils.fromLittleEndian(supplier, 4);
+            if (len < 0) {
+                throw new IOException("found illegal skippable frame with negative size");
+            }
             long skipped = IOUtils.skip(in, len);
             count(skipped);
             if (len != skipped) {
diff --git a/src/main/java/org/apache/commons/compress/compressors/snappy/FramedSnappyCompressorInputStream.java b/src/main/java/org/apache/commons/compress/compressors/snappy/FramedSnappyCompressorInputStream.java
index ff3d63cb5..ddc6462a2 100644
--- a/src/main/java/org/apache/commons/compress/compressors/snappy/FramedSnappyCompressorInputStream.java
+++ b/src/main/java/org/apache/commons/compress/compressors/snappy/FramedSnappyCompressorInputStream.java
@@ -120,12 +120,16 @@ public FramedSnappyCompressorInputStream(final InputStream in,
      * @param blockSize the block size to use for the compressed stream
      * @param dialect the dialect used by the compressed stream
      * @throws IOException if reading fails
+     * @throws IllegalArgumentException if blockSize is not bigger than 0
      * @since 1.14
      */
     public FramedSnappyCompressorInputStream(final InputStream in,
                                              final int blockSize,
                                              final FramedSnappyDialect dialect)
         throws IOException {
+        if (blockSize <= 0) {
+            throw new IllegalArgumentException("blockSize must be bigger than 0");
+        }
         countingStream = new CountingInputStream(in);
         this.in = new PushbackInputStream(countingStream, 1);
         this.blockSize = blockSize;
@@ -246,10 +250,16 @@ private void readNextBlock() throws IOException {
         } else if (type == UNCOMPRESSED_CHUNK_TYPE) {
             inUncompressedChunk = true;
             uncompressedBytesRemaining = readSize() - 4 /* CRC */;
+            if (uncompressedBytesRemaining < 0) {
+                throw new IOException("found illegal chunk with negative size");
+            }
             expectedChecksum = unmask(readCrc());
         } else if (type == COMPRESSED_CHUNK_TYPE) {
             final boolean expectChecksum = dialect.usesChecksumWithCompressedChunks();
             final long size = readSize() - (expectChecksum ? 4L : 0L);
+            if (size < 0) {
+                throw new IOException("found illegal chunk with negative size");
+            }
             if (expectChecksum) {
                 expectedChecksum = unmask(readCrc());
             } else {
@@ -290,6 +300,9 @@ private int readSize() throws IOException {
 
     private void skipBlock() throws IOException {
         final int size = readSize();
+        if (size < 0) {
+            throw new IOException("found illegal chunk with negative size");
+        }
         final long read = IOUtils.skip(in, size);
         count(read);
         if (read != size) {
