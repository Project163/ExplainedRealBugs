diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 5ed50ff2a..5a3cc09e4 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -50,6 +50,11 @@ The <action> type attribute can be add,update,fix,remove.
       <action type="update" date="2019-08-27">
         Update tests from org.apache.felix:org.apache.felix.framework 6.0.2 to 6.0.3.
       </action>
+      <action issue="COMPRESS-492" type="fix" date="2019-08-28">
+        SevenZFile could throw NullPointerException rather than
+        IOException for certain archives. In addition it now handles
+        certain empty archives more gracefully.
+      </action>
     </release>
     <release version="1.19" date="2019-08-27"
              description="Release 1.19
diff --git a/src/main/java/org/apache/commons/compress/archivers/sevenz/Archive.java b/src/main/java/org/apache/commons/compress/archivers/sevenz/Archive.java
index dd1c75aa2..00ca8b4b9 100644
--- a/src/main/java/org/apache/commons/compress/archivers/sevenz/Archive.java
+++ b/src/main/java/org/apache/commons/compress/archivers/sevenz/Archive.java
@@ -23,17 +23,17 @@ class Archive {
     /// Offset from beginning of file + SIGNATURE_HEADER_SIZE to packed streams.
     long packPos;
     /// Size of each packed stream.
-    long[] packSizes;
+    long[] packSizes = new long[0];
     /// Whether each particular packed streams has a CRC.
     BitSet packCrcsDefined;
     /// CRCs for each packed stream, valid only if that packed stream has one.
     long[] packCrcs;
     /// Properties of solid compression blocks.
-    Folder[] folders;
+    Folder[] folders = new Folder[0];
     /// Temporary properties for non-empty files (subsumed into the files array later).
     SubStreamsInfo subStreamsInfo;
     /// The files and directories in the archive.
-    SevenZArchiveEntry[] files;
+    SevenZArchiveEntry[] files = new SevenZArchiveEntry[0];
     /// Mapping between folders, files and streams.
     StreamMap streamMap;
 
diff --git a/src/main/java/org/apache/commons/compress/archivers/sevenz/SevenZFile.java b/src/main/java/org/apache/commons/compress/archivers/sevenz/SevenZFile.java
index ac148e593..7a02d7892 100644
--- a/src/main/java/org/apache/commons/compress/archivers/sevenz/SevenZFile.java
+++ b/src/main/java/org/apache/commons/compress/archivers/sevenz/SevenZFile.java
@@ -1002,6 +1002,9 @@ private void readFilesInfo(final ByteBuffer header, final Archive archive) throw
         for (int i = 0; i < files.length; i++) {
             files[i].setHasStream(isEmptyStream == null || !isEmptyStream.get(i));
             if (files[i].hasStream()) {
+                if (archive.subStreamsInfo == null) {
+                    throw new IOException("Archive contains file with streams but no subStreamsInfo");
+                }
                 files[i].setDirectory(false);
                 files[i].setAntiItem(false);
                 files[i].setHasCrc(archive.subStreamsInfo.hasCrc.get(nonEmptyFileCounter));
@@ -1074,6 +1077,9 @@ private void calculateStreamMap(final Archive archive) throws IOException {
     }
 
     private void buildDecodingStream() throws IOException {
+        if (archive.streamMap == null) {
+            throw new IOException("Archive doesn't contain stream information to read entries");
+        }
         final int folderIndex = archive.streamMap.fileFolderIndex[currentEntryIndex];
         if (folderIndex < 0) {
             deferredBlockStreams.clear();
diff --git a/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java b/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java
index c99693522..db4fe1d5f 100644
--- a/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java
+++ b/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java
@@ -370,6 +370,31 @@ public void givenNameWinsOverDefaultName() throws Exception {
         }
     }
 
+    /**
+     * @see https://issues.apache.org/jira/browse/COMPRESS-492
+     */
+    @Test
+    public void handlesEmptyArchiveWithFilesInfo() throws Exception {
+        File f = new File(dir, "empty.7z");
+        try (SevenZOutputFile s = new SevenZOutputFile(f)) {
+        }
+        try (SevenZFile z = new SevenZFile(f)) {
+            assertFalse(z.getEntries().iterator().hasNext());
+            assertNull(z.getNextEntry());
+        }
+    }
+
+    /**
+     * @see https://issues.apache.org/jira/browse/COMPRESS-492
+     */
+    @Test
+    public void handlesEmptyArchiveWithoutFilesInfo() throws Exception {
+        try (SevenZFile z = new SevenZFile(getFile("COMPRESS-492.7z"))) {
+            assertFalse(z.getEntries().iterator().hasNext());
+            assertNull(z.getNextEntry());
+        }
+    }
+
     private void test7zUnarchive(final File f, final SevenZMethod m, final byte[] password) throws Exception {
         try (SevenZFile sevenZFile = new SevenZFile(f, password)) {
             test7zUnarchive(sevenZFile, m);
diff --git a/src/test/resources/COMPRESS-492.7z b/src/test/resources/COMPRESS-492.7z
new file mode 100644
index 000000000..53edfbc92
Binary files /dev/null and b/src/test/resources/COMPRESS-492.7z differ
