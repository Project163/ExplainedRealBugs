diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index b217d7705..3a3731d71 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -212,6 +212,11 @@ The <action> type attribute can be add,update,fix,remove.
         Add a new maven profile in pom.xml for JDK14+ to ignore the
         failing tests about Pack200.
       </action>
+      <action issue="COMPRESS-548" type="fix" date="2020-08-24"
+              due-to="Maksim Zuev" dev="PeterLee">
+        Throw an exception when reading the zip extra field if the
+        length is too short.
+      </action>
     </release>
     <release version="1.20" date="2020-02-08"
              description="Release 1.20 (Java 7)">
diff --git a/src/main/java/org/apache/commons/compress/archivers/zip/AsiExtraField.java b/src/main/java/org/apache/commons/compress/archivers/zip/AsiExtraField.java
index d2ed167d1..1909a2fb9 100644
--- a/src/main/java/org/apache/commons/compress/archivers/zip/AsiExtraField.java
+++ b/src/main/java/org/apache/commons/compress/archivers/zip/AsiExtraField.java
@@ -266,6 +266,10 @@ public boolean isDirectory() {
     @Override
     public void parseFromLocalFileData(final byte[] data, final int offset, final int length)
         throws ZipException {
+        if (length < WORD) {
+            throw new ZipException("The length is too short, only "
+                    + length + " bytes, expected at least " + WORD);
+        }
 
         final long givenChecksum = ZipLong.getValue(data, offset);
         final byte[] tmp = new byte[length - WORD];
diff --git a/src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java b/src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java
index 23b695a2a..917547604 100644
--- a/src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java
+++ b/src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java
@@ -719,6 +719,15 @@ public void throwsIOExceptionIfThereIsCorruptedZip64Extra() throws IOException {
         }
     }
 
+    @Test
+    public void testZipWithBadExtraFields() throws IOException {
+        try (InputStream fis = new FileInputStream(getFile("COMPRESS-548.zip"));
+             ZipArchiveInputStream zipInputStream = new ZipArchiveInputStream(fis);) {
+            while (zipInputStream.getNextZipEntry() != null) {
+            }
+        }
+    }
+
     private static byte[] readEntry(final ZipArchiveInputStream zip, final ZipArchiveEntry zae) throws IOException {
         final int len = (int)zae.getSize();
         final byte[] buff = new byte[len];
diff --git a/src/test/resources/COMPRESS-548.zip b/src/test/resources/COMPRESS-548.zip
new file mode 100644
index 000000000..2795cd2e7
Binary files /dev/null and b/src/test/resources/COMPRESS-548.zip differ
