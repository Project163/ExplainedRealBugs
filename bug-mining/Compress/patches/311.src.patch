diff --git a/src/test/java/org/apache/commons/compress/compressors/lz4/FramedLZ4CompressorInputStreamTest.java b/src/test/java/org/apache/commons/compress/compressors/lz4/FramedLZ4CompressorInputStreamTest.java
index a57c007aa..82e50751f 100644
--- a/src/test/java/org/apache/commons/compress/compressors/lz4/FramedLZ4CompressorInputStreamTest.java
+++ b/src/test/java/org/apache/commons/compress/compressors/lz4/FramedLZ4CompressorInputStreamTest.java
@@ -32,11 +32,16 @@
 import org.apache.commons.compress.AbstractTestCase;
 import org.apache.commons.compress.compressors.CompressorStreamFactory;
 import org.apache.commons.compress.utils.IOUtils;
+import org.junit.Rule;
 import org.junit.Test;
+import org.junit.rules.ExpectedException;
 
 public final class FramedLZ4CompressorInputStreamTest
     extends AbstractTestCase {
 
+    @Rule
+    public ExpectedException thrown = ExpectedException.none();
+
     @Test
     public void testMatches() throws IOException {
         assertFalse(FramedLZ4CompressorInputStream.matches(new byte[10], 4));
@@ -619,6 +624,21 @@ public void multiByteReadConsistentlyReturnsMinusOneAtEof() throws IOException {
         }
     }
 
+    @Test
+    public void backreferenceOfSize0CausesIOException() throws IOException {
+        expectIOException("COMPRESS-490/ArithmeticException.lz4");
+    }
+
+    @Test
+    public void backreferenceAtStartCausesIOException() throws IOException {
+        expectIOException("COMPRESS-490/ArrayIndexOutOfBoundsException1.lz4");
+    }
+
+    @Test
+    public void backreferenceWithOffsetTooBigCausesIOException() throws IOException {
+        expectIOException("COMPRESS-490/ArrayIndexOutOfBoundsException2.lz4");
+    }
+
     interface StreamWrapper {
         InputStream wrap(InputStream in) throws Exception;
     }
@@ -642,4 +662,13 @@ private static byte[] duplicate(byte[] from) {
         System.arraycopy(from, 0, to, from.length, from.length);
         return to;
     }
+
+    private void expectIOException(String fileName) throws IOException {
+        thrown.expect(IOException.class);
+        try (InputStream is = new FileInputStream(getFile(fileName))) {
+            final FramedLZ4CompressorInputStream in = new FramedLZ4CompressorInputStream(is);
+            IOUtils.toByteArray(in);
+        }
+    }
+
 }
diff --git a/src/test/resources/COMPRESS-490/ArithmeticException.lz4 b/src/test/resources/COMPRESS-490/ArithmeticException.lz4
new file mode 100644
index 000000000..6e11a817e
Binary files /dev/null and b/src/test/resources/COMPRESS-490/ArithmeticException.lz4 differ
diff --git a/src/test/resources/COMPRESS-490/ArrayIndexOutOfBoundsException1.lz4 b/src/test/resources/COMPRESS-490/ArrayIndexOutOfBoundsException1.lz4
new file mode 100644
index 000000000..7bbe4d872
--- /dev/null
+++ b/src/test/resources/COMPRESS-490/ArrayIndexOutOfBoundsException1.lz4
@@ -0,0 +1 @@
+"Md@0000000000
\ No newline at end of file
diff --git a/src/test/resources/COMPRESS-490/ArrayIndexOutOfBoundsException2.lz4 b/src/test/resources/COMPRESS-490/ArrayIndexOutOfBoundsException2.lz4
new file mode 100644
index 000000000..e37c3a8e5
Binary files /dev/null and b/src/test/resources/COMPRESS-490/ArrayIndexOutOfBoundsException2.lz4 differ
