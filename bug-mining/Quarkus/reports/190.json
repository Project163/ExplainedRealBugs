{"url":"https://api.github.com/repos/quarkusio/quarkus/issues/46459","repository_url":"https://api.github.com/repos/quarkusio/quarkus","labels_url":"https://api.github.com/repos/quarkusio/quarkus/issues/46459/labels{/name}","comments_url":"https://api.github.com/repos/quarkusio/quarkus/issues/46459/comments","events_url":"https://api.github.com/repos/quarkusio/quarkus/issues/46459/events","html_url":"https://github.com/quarkusio/quarkus/issues/46459","id":2875560604,"node_id":"I_kwDOCFbutM6rZZKc","number":46459,"title":"Upgrading from 3.18.2 to 3.18.3 Results in OutOfMemoryError when using @QuarkusTest with Quarkus Junit 5","user":{"login":"brianwyka","id":46069296,"node_id":"MDQ6VXNlcjQ2MDY5Mjk2","avatar_url":"https://avatars.githubusercontent.com/u/46069296?v=4","gravatar_id":"","url":"https://api.github.com/users/brianwyka","html_url":"https://github.com/brianwyka","followers_url":"https://api.github.com/users/brianwyka/followers","following_url":"https://api.github.com/users/brianwyka/following{/other_user}","gists_url":"https://api.github.com/users/brianwyka/gists{/gist_id}","starred_url":"https://api.github.com/users/brianwyka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brianwyka/subscriptions","organizations_url":"https://api.github.com/users/brianwyka/orgs","repos_url":"https://api.github.com/users/brianwyka/repos","events_url":"https://api.github.com/users/brianwyka/events{/privacy}","received_events_url":"https://api.github.com/users/brianwyka/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":985346620,"node_id":"MDU6TGFiZWw5ODUzNDY2MjA=","url":"https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug","name":"kind/bug","color":"d73a4a","default":false,"description":"Something isn't working"},{"id":1375177076,"node_id":"MDU6TGFiZWwxMzc1MTc3MDc2","url":"https://api.github.com/repos/quarkusio/quarkus/labels/area/testing","name":"area/testing","color":"0366d6","default":false,"description":""},{"id":2744442223,"node_id":"MDU6TGFiZWwyNzQ0NDQyMjIz","url":"https://api.github.com/repos/quarkusio/quarkus/labels/triage/needs-reproducer","name":"triage/needs-reproducer","color":"FDE078","default":false,"description":"We are waiting for a reproducer."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/quarkusio/quarkus/milestones/385","html_url":"https://github.com/quarkusio/quarkus/milestone/385","labels_url":"https://api.github.com/repos/quarkusio/quarkus/milestones/385/labels","id":12490997,"node_id":"MI_kwDOCFbutM4Avpj1","number":385,"title":"3.19.3","description":"","creator":{"login":"gsmet","id":1279749,"node_id":"MDQ6VXNlcjEyNzk3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1279749?v=4","gravatar_id":"","url":"https://api.github.com/users/gsmet","html_url":"https://github.com/gsmet","followers_url":"https://api.github.com/users/gsmet/followers","following_url":"https://api.github.com/users/gsmet/following{/other_user}","gists_url":"https://api.github.com/users/gsmet/gists{/gist_id}","starred_url":"https://api.github.com/users/gsmet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gsmet/subscriptions","organizations_url":"https://api.github.com/users/gsmet/orgs","repos_url":"https://api.github.com/users/gsmet/repos","events_url":"https://api.github.com/users/gsmet/events{/privacy}","received_events_url":"https://api.github.com/users/gsmet/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":27,"state":"closed","created_at":"2025-03-11T17:34:18Z","updated_at":"2025-04-23T11:37:28Z","due_on":null,"closed_at":"2025-03-12T13:47:38Z"},"comments":14,"created_at":"2025-02-24T16:35:53Z","updated_at":"2025-03-11T17:36:16Z","closed_at":"2025-03-10T09:56:42Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nWhen upgrading from Quarkus `3.18.2` to `3.18.3` our `@QuarkusTest`s start to throw `OutOfMemoryError`. \n\nIt seems the issue is isolated in `quarkus-junit5` dependency or one of its transitives, when I upgrade the rest of dependencies and leave that, things work fine.\n\nPerhaps something to do with this change?  But I'm not sure...\nhttps://github.com/quarkusio/quarkus/commit/820360362c2ae76fc1e97f541ff85f157a363907\n\n### Expected behavior\n\nTests pass without `OutOfMemoryError`\n\n### Actual behavior\n\nTests annotated with `@QuarkusTest` hang and eventually run out of memory with different errors each time.\nExample errors:\n\n```\njava.lang.RuntimeException: io.quarkus.builder.BuildException: Build failure: Build failed due to errors\n\t[error]: Build step io.quarkus.arc.deployment.ArcProcessor#registerBeans threw an exception: java.lang.OutOfMemoryError: Java heap space\n\njava.lang.RuntimeException: java.lang.RuntimeException: io.quarkus.builder.BuildException: Build failure: Build failed due to errors\n\t[error]: Build step io.quarkus.arc.deployment.ArcProcessor#registerBeans threw an exception: java.lang.OutOfMemoryError: Java heap space\n\n\tat io.quarkus.test.junit.QuarkusTestExtension.throwBootFailureException(QuarkusTestExtension.java:611)\n\tat io.quarkus.test.junit.QuarkusTestExtension.interceptTestClassConstructor(QuarkusTestExtension.java:695)\n\tat java.base/java.util.Optional.orElseGet(Optional.java:364)\n\tat java.base/java.util.ArrayList.forEach(ArrayList.java:1511)\n\tat java.base/java.util.ArrayList.forEach(ArrayList.java:1511)\nCaused by: java.lang.RuntimeException: io.quarkus.builder.BuildException: Build failure: Build failed due to errors\n\t[error]: Build step io.quarkus.arc.deployment.ArcProcessor#registerBeans threw an exception: java.lang.OutOfMemoryError: Java heap space\n\n\tat io.quarkus.runner.bootstrap.AugmentActionImpl.runAugment(AugmentActionImpl.java:354)\n\tat io.quarkus.runner.bootstrap.AugmentActionImpl.createInitialRuntimeApplication(AugmentActionImpl.java:271)\n\tat io.quarkus.runner.bootstrap.AugmentActionImpl.createInitialRuntimeApplication(AugmentActionImpl.java:61)\n\tat io.quarkus.test.junit.QuarkusTestExtension.doJavaStart(QuarkusTestExtension.java:195)\n\tat io.quarkus.test.junit.QuarkusTestExtension.ensureStarted(QuarkusTestExtension.java:578)\n\tat io.quarkus.test.junit.QuarkusTestExtension.beforeAll(QuarkusTestExtension.java:628)\n\t... 1 more\nCaused by: io.quarkus.builder.BuildException: Build failure: Build failed due to errors\n\t[error]: Build step io.quarkus.arc.deployment.ArcProcessor#registerBeans threw an exception: java.lang.OutOfMemoryError: Java heap space\n\n\tat io.quarkus.builder.Execution.run(Execution.java:124)\n\tat io.quarkus.builder.BuildExecutionBuilder.execute(BuildExecutionBuilder.java:79)\n\tat io.quarkus.deployment.QuarkusAugmentor.run(QuarkusAugmentor.java:161)\n\tat io.quarkus.runner.bootstrap.AugmentActionImpl.runAugment(AugmentActionImpl.java:350)\n\t... 6 more\nCaused by: java.lang.OutOfMemoryError: Java heap space\n```\n\n### How to Reproduce?\n\n_No response_\n\n### Output of `uname -a` or `ver`\n\nOSX and Linux\n\n### Output of `java -version`\n\n17.0\n\n### Quarkus version or git rev\n\n3.18.3\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\nGradle 8.12.1\n\n### Additional information\n\nI've also tried version `3.19.0` and the issue has NOT been resolved.","closed_by":{"login":"geoand","id":4374975,"node_id":"MDQ6VXNlcjQzNzQ5NzU=","avatar_url":"https://avatars.githubusercontent.com/u/4374975?v=4","gravatar_id":"","url":"https://api.github.com/users/geoand","html_url":"https://github.com/geoand","followers_url":"https://api.github.com/users/geoand/followers","following_url":"https://api.github.com/users/geoand/following{/other_user}","gists_url":"https://api.github.com/users/geoand/gists{/gist_id}","starred_url":"https://api.github.com/users/geoand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/geoand/subscriptions","organizations_url":"https://api.github.com/users/geoand/orgs","repos_url":"https://api.github.com/users/geoand/repos","events_url":"https://api.github.com/users/geoand/events{/privacy}","received_events_url":"https://api.github.com/users/geoand/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/quarkusio/quarkus/issues/46459/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/quarkusio/quarkus/issues/46459/timeline","performed_via_github_app":null,"state_reason":"completed"}