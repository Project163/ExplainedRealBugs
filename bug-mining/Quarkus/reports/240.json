{"url":"https://api.github.com/repos/quarkusio/quarkus/issues/48768","repository_url":"https://api.github.com/repos/quarkusio/quarkus","labels_url":"https://api.github.com/repos/quarkusio/quarkus/issues/48768/labels{/name}","comments_url":"https://api.github.com/repos/quarkusio/quarkus/issues/48768/comments","events_url":"https://api.github.com/repos/quarkusio/quarkus/issues/48768/events","html_url":"https://github.com/quarkusio/quarkus/issues/48768","id":3200775654,"node_id":"I_kwDOCFbutM6-x_Xm","number":48768,"title":"Gradle task fails to copy over sourceset jar properly","user":{"login":"TSFenwick","id":3538026,"node_id":"MDQ6VXNlcjM1MzgwMjY=","avatar_url":"https://avatars.githubusercontent.com/u/3538026?v=4","gravatar_id":"","url":"https://api.github.com/users/TSFenwick","html_url":"https://github.com/TSFenwick","followers_url":"https://api.github.com/users/TSFenwick/followers","following_url":"https://api.github.com/users/TSFenwick/following{/other_user}","gists_url":"https://api.github.com/users/TSFenwick/gists{/gist_id}","starred_url":"https://api.github.com/users/TSFenwick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TSFenwick/subscriptions","organizations_url":"https://api.github.com/users/TSFenwick/orgs","repos_url":"https://api.github.com/users/TSFenwick/repos","events_url":"https://api.github.com/users/TSFenwick/events{/privacy}","received_events_url":"https://api.github.com/users/TSFenwick/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":985346620,"node_id":"MDU6TGFiZWw5ODUzNDY2MjA=","url":"https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug","name":"kind/bug","color":"d73a4a","default":false,"description":"Something isn't working"},{"id":1273026591,"node_id":"MDU6TGFiZWwxMjczMDI2NTkx","url":"https://api.github.com/repos/quarkusio/quarkus/labels/area/gradle","name":"area/gradle","color":"0366d6","default":false,"description":"Gradle"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/quarkusio/quarkus/milestones/414","html_url":"https://github.com/quarkusio/quarkus/milestone/414","labels_url":"https://api.github.com/repos/quarkusio/quarkus/milestones/414/labels","id":13230442,"node_id":"MI_kwDOCFbutM4AyeFq","number":414,"title":"3.24.3","description":"","creator":{"login":"gsmet","id":1279749,"node_id":"MDQ6VXNlcjEyNzk3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1279749?v=4","gravatar_id":"","url":"https://api.github.com/users/gsmet","html_url":"https://github.com/gsmet","followers_url":"https://api.github.com/users/gsmet/followers","following_url":"https://api.github.com/users/gsmet/following{/other_user}","gists_url":"https://api.github.com/users/gsmet/gists{/gist_id}","starred_url":"https://api.github.com/users/gsmet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gsmet/subscriptions","organizations_url":"https://api.github.com/users/gsmet/orgs","repos_url":"https://api.github.com/users/gsmet/repos","events_url":"https://api.github.com/users/gsmet/events{/privacy}","received_events_url":"https://api.github.com/users/gsmet/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":23,"state":"closed","created_at":"2025-07-08T16:56:11Z","updated_at":"2025-08-13T11:43:01Z","due_on":null,"closed_at":"2025-07-09T09:54:38Z"},"comments":7,"created_at":"2025-07-03T22:08:50Z","updated_at":"2025-07-08T16:57:47Z","closed_at":"2025-07-08T05:51:26Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nAfter upgrading to Quarkus 3.24.2 we started having failures running our application.\n\nWhen running \n\n```sh\n./gradlew quarkusRun\n```\n\nThe application fails to run with the following error\n```\n14:47:06,458 ERROR [io.qua.run.Quarkus] Error running Quarkus: java.lang.ExceptionInInitializerError\n        at java.base/jdk.internal.misc.Unsafe.allocateInstance(Native Method)\n        at java.base/java.lang.invoke.DirectMethodHandle.allocateInstance(DirectMethodHandle.java:501)\n        at io.quarkus.runtime.Quarkus.run(Quarkus.java:79)\n        at io.quarkus.runtime.Quarkus.run(Quarkus.java:51)\n        at io.quarkus.runtime.Quarkus.run(Quarkus.java:144)\n        at io.quarkus.runner.GeneratedMain.main(Unknown Source)\n        at io.quarkus.bootstrap.runner.QuarkusEntryPoint.doRun(QuarkusEntryPoint.java:69)\n        at io.quarkus.bootstrap.runner.QuarkusEntryPoint.main(QuarkusEntryPoint.java:37)\nCaused by: java.lang.RuntimeException: Failed to start quarkus\n        at io.quarkus.runner.ApplicationImpl.<clinit>(Unknown Source)\n        ... 8 more\nCaused by: java.lang.RuntimeException: java.nio.file.NoSuchFileException: /Users/tomfenwick/Dev/github.com/tsfenwick/sourceset-quarkus-gradle-repro/build/quarkus-app/lib/main/86495d84d99483297caec829b5c55a19e46cea95.generatedApi-1751578994559.jar\n        at io.quarkus.bootstrap.runner.JarFileReference.asyncLoadAcquiredJarFile(JarFileReference.java:209)\n        at io.quarkus.bootstrap.runner.JarFileReference.withJarFile(JarFileReference.java:147)\n        at io.quarkus.bootstrap.runner.JarResource.getResourceData(JarResource.java:56)\n        at io.quarkus.bootstrap.runner.RunnerClassLoader.loadClass(RunnerClassLoader.java:106)\n        at io.quarkus.bootstrap.runner.RunnerClassLoader.loadClass(RunnerClassLoader.java:72)\n        at java.base/java.lang.ClassLoader.defineClass1(Native Method)\n        at java.base/java.lang.ClassLoader.defineClass(ClassLoader.java:1027)\n        at io.quarkus.bootstrap.runner.RunnerClassLoader.defineClass(RunnerClassLoader.java:152)\n        at io.quarkus.bootstrap.runner.RunnerClassLoader.loadClass(RunnerClassLoader.java:111)\n        at io.quarkus.bootstrap.runner.RunnerClassLoader.loadClass(RunnerClassLoader.java:72)\n        at java.base/java.lang.Class.forName0(Native Method)\n        at java.base/java.lang.Class.forName(Class.java:534)\n        at java.base/java.lang.Class.forName(Class.java:513)\n        at my.groupId.PetsResource_Bean.<init>(Unknown Source)\n        at io.quarkus.arc.setup.Default_ComponentsProvider.addBeans1(Unknown Source)\n        at io.quarkus.arc.setup.Default_ComponentsProvider.getComponents(Unknown Source)\n        at io.quarkus.arc.impl.ArcContainerImpl.<init>(ArcContainerImpl.java:129)\n        at io.quarkus.arc.Arc.initialize(Arc.java:38)\n        at io.quarkus.arc.runtime.ArcRecorder.initContainer(ArcRecorder.java:52)\n        at io.quarkus.runner.recorded.ArcProcessor$initializeContainer1770303700.deploy_0(Unknown Source)\n        at io.quarkus.runner.recorded.ArcProcessor$initializeContainer1770303700.deploy(Unknown Source)\n        ... 9 more\nCaused by: java.nio.file.NoSuchFileException: /Users/tomfenwick/Dev/github.com/tsfenwick/sourceset-quarkus-gradle-repro/build/quarkus-app/lib/main/86495d84d99483297caec829b5c55a19e46cea95.generatedApi-1751578994559.jar\n        at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)\n        at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)\n        at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)\n        at java.base/sun.nio.fs.UnixFileAttributeViews$Basic.readAttributes(UnixFileAttributeViews.java:55)\n        at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributes(UnixFileSystemProvider.java:171)\n        at java.base/java.nio.file.Files.readAttributes(Files.java:1854)\n        at java.base/java.util.zip.ZipFile$Source.get(ZipFile.java:1445)\n        at java.base/java.util.zip.ZipFile$CleanableResource.<init>(ZipFile.java:724)\n        at java.base/java.util.zip.ZipFile.<init>(ZipFile.java:251)\n        at java.base/java.util.zip.ZipFile.<init>(ZipFile.java:180)\n        at java.base/java.util.jar.JarFile.<init>(JarFile.java:345)\n        at io.smallrye.common.io.jar.JarFiles.create(JarFiles.java:49)\n        at io.quarkus.bootstrap.runner.JarFileReference.asyncLoadAcquiredJarFile(JarFileReference.java:207)\n        ... 29 more\n```\n\n\nThis bug isn't present in `3.24.1`. It `quarkusRun` passes with the following properties:\n```\n# Gradle properties\nquarkusPluginId=io.quarkus\nquarkusPluginVersion=3.24.1\nquarkusPlatformGroupId=io.quarkus.platform\nquarkusPlatformArtifactId=quarkus-bom\nquarkusPlatformVersion=3.24.1\n```\n\nThe key thing the gradle build script is doing is generating Resources and DTOs from an [openapi.yaml schema](https://github.com/TSFenwick/sourceset-quarkus-gradle-repro/blob/main/src/main/resources/openapi/openapi.yaml) into a separate sourceset [generatedApi](https://github.com/TSFenwick/sourceset-quarkus-gradle-repro/blob/main/build.gradle.kts#L34-L40) that the sourceset main depends upon.\n\n### Expected behavior\n\nApplication runs properly with no exception\n\n```\n./gradlew quarkusRun\n\n> Task :openApiGenerate\n############################################################################################\n# Thanks for using OpenAPI Generator.                                                      #\n# We appreciate your support! Please consider donation to help us maintain this project.   #\n# https://opencollective.com/openapi_generator/donate                                      #\n############################################################################################\nSuccessfully generated code to /Users/tomfenwick/Dev/github.com/tsfenwick/sourceset-quarkus-gradle-repro/build/generated-src\n__  ____  __  _____   ___  __ ____  ______ \n --/ __ \\/ / / / _ | / _ \\/ //_/ / / / __/ \n -/ /_/ / /_/ / __ |/ , _/ ,< / /_/ /\\ \\   \n--\\___\\_\\____/_/ |_/_/|_/_/|_|\\____/___/   \n2025-07-03 15:04:32,508 INFO  [io.quarkus] (main) sourceset-quarkus-gradle-repro 1.0.0-SNAPSHOT on JVM (powered by Quarkus 3.24.1) started in 0.275s. Listening on: http://0.0.0.0:8080\n2025-07-03 15:04:32,510 INFO  [io.quarkus] (main) Profile prod activated. \n2025-07-03 15:04:32,510 INFO  [io.quarkus] (main) Installed features: [cdi, hibernate-validator, reactive-routes, rest, rest-jackson, smallrye-context-propagation, vertx]\n```\n\n### Actual behavior\n\nWhen running \n\n```sh\n./gradlew quarkusRun\n```\n\nThe application fails to run with the following error\n```\n14:47:06,458 ERROR [io.qua.run.Quarkus] Error running Quarkus: java.lang.ExceptionInInitializerError\n        at java.base/jdk.internal.misc.Unsafe.allocateInstance(Native Method)\n        at java.base/java.lang.invoke.DirectMethodHandle.allocateInstance(DirectMethodHandle.java:501)\n        at io.quarkus.runtime.Quarkus.run(Quarkus.java:79)\n        at io.quarkus.runtime.Quarkus.run(Quarkus.java:51)\n        at io.quarkus.runtime.Quarkus.run(Quarkus.java:144)\n        at io.quarkus.runner.GeneratedMain.main(Unknown Source)\n        at io.quarkus.bootstrap.runner.QuarkusEntryPoint.doRun(QuarkusEntryPoint.java:69)\n        at io.quarkus.bootstrap.runner.QuarkusEntryPoint.main(QuarkusEntryPoint.java:37)\nCaused by: java.lang.RuntimeException: Failed to start quarkus\n        at io.quarkus.runner.ApplicationImpl.<clinit>(Unknown Source)\n        ... 8 more\nCaused by: java.lang.RuntimeException: java.nio.file.NoSuchFileException: /Users/tomfenwick/Dev/github.com/tsfenwick/sourceset-quarkus-gradle-repro/build/quarkus-app/lib/main/86495d84d99483297caec829b5c55a19e46cea95.generatedApi-1751578994559.jar\n        at io.quarkus.bootstrap.runner.JarFileReference.asyncLoadAcquiredJarFile(JarFileReference.java:209)\n        at io.quarkus.bootstrap.runner.JarFileReference.withJarFile(JarFileReference.java:147)\n        at io.quarkus.bootstrap.runner.JarResource.getResourceData(JarResource.java:56)\n        at io.quarkus.bootstrap.runner.RunnerClassLoader.loadClass(RunnerClassLoader.java:106)\n        at io.quarkus.bootstrap.runner.RunnerClassLoader.loadClass(RunnerClassLoader.java:72)\n        at java.base/java.lang.ClassLoader.defineClass1(Native Method)\n        at java.base/java.lang.ClassLoader.defineClass(ClassLoader.java:1027)\n        at io.quarkus.bootstrap.runner.RunnerClassLoader.defineClass(RunnerClassLoader.java:152)\n        at io.quarkus.bootstrap.runner.RunnerClassLoader.loadClass(RunnerClassLoader.java:111)\n        at io.quarkus.bootstrap.runner.RunnerClassLoader.loadClass(RunnerClassLoader.java:72)\n        at java.base/java.lang.Class.forName0(Native Method)\n        at java.base/java.lang.Class.forName(Class.java:534)\n        at java.base/java.lang.Class.forName(Class.java:513)\n        at my.groupId.PetsResource_Bean.<init>(Unknown Source)\n        at io.quarkus.arc.setup.Default_ComponentsProvider.addBeans1(Unknown Source)\n        at io.quarkus.arc.setup.Default_ComponentsProvider.getComponents(Unknown Source)\n        at io.quarkus.arc.impl.ArcContainerImpl.<init>(ArcContainerImpl.java:129)\n        at io.quarkus.arc.Arc.initialize(Arc.java:38)\n        at io.quarkus.arc.runtime.ArcRecorder.initContainer(ArcRecorder.java:52)\n        at io.quarkus.runner.recorded.ArcProcessor$initializeContainer1770303700.deploy_0(Unknown Source)\n        at io.quarkus.runner.recorded.ArcProcessor$initializeContainer1770303700.deploy(Unknown Source)\n        ... 9 more\nCaused by: java.nio.file.NoSuchFileException: /Users/tomfenwick/Dev/github.com/tsfenwick/sourceset-quarkus-gradle-repro/build/quarkus-app/lib/main/86495d84d99483297caec829b5c55a19e46cea95.generatedApi-1751578994559.jar\n        at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)\n        at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)\n        at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)\n        at java.base/sun.nio.fs.UnixFileAttributeViews$Basic.readAttributes(UnixFileAttributeViews.java:55)\n        at java.base/sun.nio.fs.UnixFileSystemProvider.readAttributes(UnixFileSystemProvider.java:171)\n        at java.base/java.nio.file.Files.readAttributes(Files.java:1854)\n        at java.base/java.util.zip.ZipFile$Source.get(ZipFile.java:1445)\n        at java.base/java.util.zip.ZipFile$CleanableResource.<init>(ZipFile.java:724)\n        at java.base/java.util.zip.ZipFile.<init>(ZipFile.java:251)\n        at java.base/java.util.zip.ZipFile.<init>(ZipFile.java:180)\n        at java.base/java.util.jar.JarFile.<init>(JarFile.java:345)\n        at io.smallrye.common.io.jar.JarFiles.create(JarFiles.java:49)\n        at io.quarkus.bootstrap.runner.JarFileReference.asyncLoadAcquiredJarFile(JarFileReference.java:207)\n        ... 29 more\n```\n\n\nThe task `quarkusDependenciesBuild` isn't copying the correct jar name over.\n```\n2025-07-03T14:56:32.233-0700 [DEBUG] [org.gradle.api.Task] Dependency 86495d84d99483297caec829b5c55a19e46cea95:generatedApi::jar:1751579790328 : copying /Users/tomfenwick/Dev/github.com/tsfenwick/sourceset-quarkus-gradle-repro/build/classes/java/generatedApi to /Users/tomfenwick/Dev/github.com/tsfenwick/sourceset-quarkus-gradle-repro/build/quarkus-build/dep/lib/main/86495d84d99483297caec829b5c55a19e46cea95.generatedApi\n```\n is looking for `86495d84d99483297caec829b5c55a19e46cea95.generatedApi-1751578994559.jar` to run successfully\n\n[build scan](https://scans.gradle.com/s/ntjldmjtsoqcw)\n\n`./gradlew quarkusRun` with info and debug logging\n\n[gradle-info.txt](https://github.com/user-attachments/files/21047473/gradle-info.txt)\n[gradle-debug.txt](https://github.com/user-attachments/files/21047472/gradle-debug.txt)\n\n\n\n\n### How to Reproduce?\n\nhttps://github.com/TSFenwick/sourceset-quarkus-gradle-repro\n\nrun `./gradlew quarkusRun`\n\n### Output of `uname -a` or `ver`\n\nDarwin Tom-Fenwick 24.5.0 Darwin Kernel Version 24.5.0: Tue Apr 22 19:53:27 PDT 2025; root:xnu-11417.121.6~2/RELEASE_ARM64_T6041 arm64\n\n### Output of `java -version`\n\nopenjdk 21.0.7 2025-04-15 LTS OpenJDK Runtime Environment Zulu21.42+19-CA (build 21.0.7+6-LTS) OpenJDK 64-Bit Server VM Zulu21.42+19-CA (build 21.0.7+6-LTS, mixed mode, sharing)\n\n### Quarkus version or git rev\n\n3.24.2\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\nGradle 8.14.2\n\n### Additional information\n\nScanning through some of the changes for 3.24.2. This failure could be related to https://github.com/quarkusio/quarkus/pull/48551","closed_by":{"login":"aloubyansky","id":323379,"node_id":"MDQ6VXNlcjMyMzM3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/323379?v=4","gravatar_id":"","url":"https://api.github.com/users/aloubyansky","html_url":"https://github.com/aloubyansky","followers_url":"https://api.github.com/users/aloubyansky/followers","following_url":"https://api.github.com/users/aloubyansky/following{/other_user}","gists_url":"https://api.github.com/users/aloubyansky/gists{/gist_id}","starred_url":"https://api.github.com/users/aloubyansky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aloubyansky/subscriptions","organizations_url":"https://api.github.com/users/aloubyansky/orgs","repos_url":"https://api.github.com/users/aloubyansky/repos","events_url":"https://api.github.com/users/aloubyansky/events{/privacy}","received_events_url":"https://api.github.com/users/aloubyansky/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/quarkusio/quarkus/issues/48768/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/quarkusio/quarkus/issues/48768/timeline","performed_via_github_app":null,"state_reason":"completed"}