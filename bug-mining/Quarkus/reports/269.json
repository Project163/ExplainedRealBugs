{"url":"https://api.github.com/repos/quarkusio/quarkus/issues/50556","repository_url":"https://api.github.com/repos/quarkusio/quarkus","labels_url":"https://api.github.com/repos/quarkusio/quarkus/issues/50556/labels{/name}","comments_url":"https://api.github.com/repos/quarkusio/quarkus/issues/50556/comments","events_url":"https://api.github.com/repos/quarkusio/quarkus/issues/50556/events","html_url":"https://github.com/quarkusio/quarkus/issues/50556","id":3513751974,"node_id":"I_kwDOCFbutM7Rb5mm","number":50556,"title":"Quarkus augmentation weakens file permissions","user":{"login":"fjakop","id":1125261,"node_id":"MDQ6VXNlcjExMjUyNjE=","avatar_url":"https://avatars.githubusercontent.com/u/1125261?v=4","gravatar_id":"","url":"https://api.github.com/users/fjakop","html_url":"https://github.com/fjakop","followers_url":"https://api.github.com/users/fjakop/followers","following_url":"https://api.github.com/users/fjakop/following{/other_user}","gists_url":"https://api.github.com/users/fjakop/gists{/gist_id}","starred_url":"https://api.github.com/users/fjakop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjakop/subscriptions","organizations_url":"https://api.github.com/users/fjakop/orgs","repos_url":"https://api.github.com/users/fjakop/repos","events_url":"https://api.github.com/users/fjakop/events{/privacy}","received_events_url":"https://api.github.com/users/fjakop/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":985346620,"node_id":"MDU6TGFiZWw5ODUzNDY2MjA=","url":"https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug","name":"kind/bug","color":"d73a4a","default":false,"description":"Something isn't working"},{"id":1273027849,"node_id":"MDU6TGFiZWwxMjczMDI3ODQ5","url":"https://api.github.com/repos/quarkusio/quarkus/labels/area/core","name":"area/core","color":"0366d6","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/quarkusio/quarkus/milestones/446","html_url":"https://github.com/quarkusio/quarkus/milestone/446","labels_url":"https://api.github.com/repos/quarkusio/quarkus/milestones/446/labels","id":13898923,"node_id":"MI_kwDOCFbutM4A1BSr","number":446,"title":"3.28.4","description":"","creator":{"login":"gsmet","id":1279749,"node_id":"MDQ6VXNlcjEyNzk3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1279749?v=4","gravatar_id":"","url":"https://api.github.com/users/gsmet","html_url":"https://github.com/gsmet","followers_url":"https://api.github.com/users/gsmet/followers","following_url":"https://api.github.com/users/gsmet/following{/other_user}","gists_url":"https://api.github.com/users/gsmet/gists{/gist_id}","starred_url":"https://api.github.com/users/gsmet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gsmet/subscriptions","organizations_url":"https://api.github.com/users/gsmet/orgs","repos_url":"https://api.github.com/users/gsmet/repos","events_url":"https://api.github.com/users/gsmet/events{/privacy}","received_events_url":"https://api.github.com/users/gsmet/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":8,"state":"closed","created_at":"2025-10-15T16:16:11Z","updated_at":"2025-10-29T12:48:14Z","due_on":null,"closed_at":"2025-10-16T11:16:41Z"},"comments":1,"created_at":"2025-10-14T12:38:45Z","updated_at":"2025-10-15T16:20:23Z","closed_at":"2025-10-15T08:03:04Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nOn our UNIX systems th user running Keycloak has a restrictive umask of 0027 (no access for others) set.\nWhen we start Keycloak in production mode or run \"kc.sh build\" the Quarkus augmentation changes the file permissions on files below the lib folder.\n\nBefore\n\n    lib/lib/boot:\n    total 1350\n    drwxr-s--- 2 me users   2048 Aug 21 13:48 .\n    drwxr-s--- 5 me users     96 Aug 21 13:47 ..\n    -rw-r----- 1 me users   9341 May 13  2022 io.github.crac.org-crac-0.1.3.jar\n    -rw-r----- 1 me users  61466 Aug 18 10:40 io.quarkus.quarkus-bootstrap-runner-3.20.2.1.jar\n    -rw-r----- 1 me users   7704 Aug 18 10:40 io.quarkus.quarkus-classloader-commons-3.20.2.1.jar\n    -rw-r----- 1 me users  53760 Aug 18 10:40 io.quarkus.quarkus-development-mode-spi-3.20.2.1.jar\n    -rw-r----- 1 me users  10160 Aug 18 10:40 io.quarkus.quarkus-vertx-latebound-mdc-provider-3.20.2.1.jar\n    -rw-r----- 1 me users  13968 Apr 11  2025 io.smallrye.common.smallrye-common-constraint-2.12.0.jar\n    ...\n    \nthen run \n\n    me@machine:/opt/keycloak/bin> ./kc.sh build\n    INFO: The following run time options were found, but will be ignored during build time: kc.cache, kc.cache-config-file, kc.hostname, kc.proxy-headers, kc.http-management-port, kc.vault-dir, kc.db-url, kc.db-username, kc.http-enabled, kc.http-host, kc.http-port, kc.log, kc.log-file, kc.log-level\n    \n    Updating the configuration and installing your custom providers, if any. Please wait.\n    Server configuration updated and persisted. Run the following command to review the configuration:\n    \n            kc.sh show-config\n    \nAfter\n\n    lib/lib/boot:\n    total 1350\n    drwxr-sr-- 2 me users   2048 Aug 21 13:48 .\n    drwxr-sr-- 5 me users     96 Aug 21 13:47 ..\n    -rw-r--r-- 1 me users   9341 May 13  2022 io.github.crac.org-crac-0.1.3.jar\n    -rw-r--r-- 1 me users  61466 Aug 18 10:40 io.quarkus.quarkus-bootstrap-runner-3.20.2.1.jar\n    -rw-r--r-- 1 me users   7704 Aug 18 10:40 io.quarkus.quarkus-classloader-commons-3.20.2.1.jar\n    -rw-r--r-- 1 me users  53760 Aug 18 10:40 io.quarkus.quarkus-development-mode-spi-3.20.2.1.jar\n    -rw-r--r-- 1 me users  10160 Aug 18 10:40 io.quarkus.quarkus-vertx-latebound-mdc-provider-3.20.2.1.jar\n    -rw-r--r-- 1 me users  13968 Apr 11  2025 io.smallrye.common.smallrye-common-constraint-2.12.0.jar\n    ...\n\n\n### Expected behavior\n\nThe file permissions on files/dirs below lib folder should be left unchanged.\n\n### Actual behavior\n\nThe \"kc.sh build\" command sets read permissions for others on files/dirs below lib folder.\n\n### How to Reproduce?\n\n* untar a fresh Keycloak 26.4.0\n* `chmod -R o-rwx keycloak-26.4.0/lib`\n* `ls -la keycloak-26.4.0/lib/lib/boot/`\n* verify no read permissions for others\n* ` ./keycloak-26.4.0/bin/kc.sh build`\n* `ls -la keycloak-26.4.0/lib/lib/boot/`\n* notice read permissions for others\n\n\n### Output of `uname -a` or `ver`\n\nLinux 4.12.14-122.266-default #1 SMP Wed Jul 9 09:39:59 UTC 2025 (7935351) x86_64 x86_64 x86_64 GNU/Linux\n\n### Output of `java -version`\n\nopenjdk version \"21.0.7\" 2025-04-15 LTS OpenJDK Runtime Environment Temurin-21.0.7+6 (build 21.0.7+6-LTS) OpenJDK 64-Bit Server VM Temurin-21.0.7+6 (build 21.0.7+6-LTS, mixed mode, sharing)\n\n### Quarkus version or git rev\n\n3.27.0\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\n_No response_\n\n### Additional information\n\nThis issue was first raised in https://github.com/keycloak/keycloak/issues/43437 but seems more Quarkus than Keycloak related.","closed_by":{"login":"gsmet","id":1279749,"node_id":"MDQ6VXNlcjEyNzk3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1279749?v=4","gravatar_id":"","url":"https://api.github.com/users/gsmet","html_url":"https://github.com/gsmet","followers_url":"https://api.github.com/users/gsmet/followers","following_url":"https://api.github.com/users/gsmet/following{/other_user}","gists_url":"https://api.github.com/users/gsmet/gists{/gist_id}","starred_url":"https://api.github.com/users/gsmet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gsmet/subscriptions","organizations_url":"https://api.github.com/users/gsmet/orgs","repos_url":"https://api.github.com/users/gsmet/repos","events_url":"https://api.github.com/users/gsmet/events{/privacy}","received_events_url":"https://api.github.com/users/gsmet/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/quarkusio/quarkus/issues/50556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/quarkusio/quarkus/issues/50556/timeline","performed_via_github_app":null,"state_reason":"completed"}