{"url":"https://api.github.com/repos/quarkusio/quarkus/issues/46403","repository_url":"https://api.github.com/repos/quarkusio/quarkus","labels_url":"https://api.github.com/repos/quarkusio/quarkus/issues/46403/labels{/name}","comments_url":"https://api.github.com/repos/quarkusio/quarkus/issues/46403/comments","events_url":"https://api.github.com/repos/quarkusio/quarkus/issues/46403/events","html_url":"https://github.com/quarkusio/quarkus/issues/46403","id":2867111351,"node_id":"I_kwDOCFbutM6q5KW3","number":46403,"title":"DB2: Missing resource bundle","user":{"login":"turing85","id":32584495,"node_id":"MDQ6VXNlcjMyNTg0NDk1","avatar_url":"https://avatars.githubusercontent.com/u/32584495?v=4","gravatar_id":"","url":"https://api.github.com/users/turing85","html_url":"https://github.com/turing85","followers_url":"https://api.github.com/users/turing85/followers","following_url":"https://api.github.com/users/turing85/following{/other_user}","gists_url":"https://api.github.com/users/turing85/gists{/gist_id}","starred_url":"https://api.github.com/users/turing85/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/turing85/subscriptions","organizations_url":"https://api.github.com/users/turing85/orgs","repos_url":"https://api.github.com/users/turing85/repos","events_url":"https://api.github.com/users/turing85/events{/privacy}","received_events_url":"https://api.github.com/users/turing85/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":985346620,"node_id":"MDU6TGFiZWw5ODUzNDY2MjA=","url":"https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug","name":"kind/bug","color":"d73a4a","default":false,"description":"Something isn't working"},{"id":2497075451,"node_id":"MDU6TGFiZWwyNDk3MDc1NDUx","url":"https://api.github.com/repos/quarkusio/quarkus/labels/area/native-image","name":"area/native-image","color":"0366d6","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/quarkusio/quarkus/milestones/372","html_url":"https://github.com/quarkusio/quarkus/milestone/372","labels_url":"https://api.github.com/repos/quarkusio/quarkus/milestones/372/labels","id":12181460,"node_id":"MI_kwDOCFbutM4Aud_U","number":372,"title":"3.15.4","description":"","creator":{"login":"gsmet","id":1279749,"node_id":"MDQ6VXNlcjEyNzk3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1279749?v=4","gravatar_id":"","url":"https://api.github.com/users/gsmet","html_url":"https://github.com/gsmet","followers_url":"https://api.github.com/users/gsmet/followers","following_url":"https://api.github.com/users/gsmet/following{/other_user}","gists_url":"https://api.github.com/users/gsmet/gists{/gist_id}","starred_url":"https://api.github.com/users/gsmet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gsmet/subscriptions","organizations_url":"https://api.github.com/users/gsmet/orgs","repos_url":"https://api.github.com/users/gsmet/repos","events_url":"https://api.github.com/users/gsmet/events{/privacy}","received_events_url":"https://api.github.com/users/gsmet/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":105,"state":"closed","created_at":"2025-01-17T08:42:44Z","updated_at":"2025-07-09T16:36:56Z","due_on":null,"closed_at":"2025-03-11T14:00:10Z"},"comments":8,"created_at":"2025-02-20T19:43:55Z","updated_at":"2025-08-08T04:17:29Z","closed_at":"2025-02-26T13:29:08Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nIn some cases, when an exception is thrown, the error message is not localized due to a missing resource bundle. The error message reads `Missing resource bundle: A resource bundle could not be found in the com.ibm.db2.jcc package for IBM Data Server Driver for JDBC and SQLJ ...`. The DB2 `ERRORCODE` and `SQLSTATE` are correct.\n\n### Expected behavior\n\nA helpful error message is shown.\n\n### Actual behavior\n\nError message says `Missing resource bundle: A resource bundle could not be found in the com.ibm.db2.jcc package for IBM Data Server Driver for JDBC and SQLJ ...`\n\n### How to Reproduce?\n\nReproducer:\n\n1. clone https://github.com/turing85/quarkus-db2-resource-bundle:\n```bash\ngit clone https://github.com/turing85/quarkus-db2-resource-bundle.git && \\\n  quarkus-db2-resource-bundle\n```\n2. Start the db2 container, wait for it to be started:\n```bash\ndocker compose \\\n  --file local-deployment/docker-compose.yml \\\n  up --detach\n```\n3. Take a look at the [`application.properties`  (`github.com`)](https://github.com/turing85/quarkus-db2-resource-bundle/blob/main/src/main/resources/application.properties), notice that the datasource is misconfigured: the `username` is missing\n4. Run the application in dev mode\n```bash\n./mvnw clean quarkus:dev\n``` \n5. Notice that the application throws the following exception:\n```\n...\n2025-02-20 20:18:29,206 WARN  [io.agr.pool] (agroal-11) Datasource '<default>': [jcc][t4][10205][11234][4.34.30] Null userid is not supported. ERRORCODE=-4461, SQLSTATE=42815\n2025-02-20 20:18:29,207 ERROR [de.tur.qua.db2.res.bun.Timer] (vert.x-worker-thread-1) Error while polling timer: com.ibm.db2.jcc.am.SqlSyntaxErrorException: [jcc][t4][10205][11234][4.34.30] Null userid is not supported. ERRORCODE=-4461, SQLSTATE=42815\n\tat com.ibm.db2.jcc.am.b5.a(b5.java:810)\n\tat com.ibm.db2.jcc.am.b5.a(b5.java:66)\n\tat com.ibm.db2.jcc.am.b5.a(b5.java:116)\n\tat com.ibm.db2.jcc.t4.b.f(b.java:2703)\n\tat com.ibm.db2.jcc.t4.b.a(b.java:2710)\n\tat com.ibm.db2.jcc.t4.b.b(b.java:939)\n\tat com.ibm.db2.jcc.t4.b.a(b.java:893)\n\tat com.ibm.db2.jcc.t4.b.a(b.java:461)\n\tat com.ibm.db2.jcc.t4.b.a(b.java:434)\n\tat com.ibm.db2.jcc.t4.b.<init>(b.java:372)\n\tat com.ibm.db2.jcc.DB2SimpleDataSource.getConnection(DB2SimpleDataSource.java:259)\n\tat com.ibm.db2.jcc.DB2SimpleDataSource.getConnection(DB2SimpleDataSource.java:215)\n\tat com.ibm.db2.jcc.DB2Driver.connect(DB2Driver.java:491)\n\tat com.ibm.db2.jcc.DB2Driver.connect(DB2Driver.java:117)\n\tat io.agroal.pool.ConnectionFactory.createConnection(ConnectionFactory.java:225)\n\tat io.agroal.pool.ConnectionPool$CreateConnectionTask.call(ConnectionPool.java:580)\n\tat io.agroal.pool.ConnectionPool$CreateConnectionTask.call(ConnectionPool.java:561)\n\tat java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)\n\tat io.agroal.pool.util.PriorityScheduledExecutor.beforeExecute(PriorityScheduledExecutor.java:75)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)\n\tat java.base/java.lang.Thread.run(Thread.java:1583)\n...\n```\n6. Build the application natively, run the native executable\n```\n$ ./mvnw --activate-profiles native clean package && \\\n  target/quarkus-db2-resource-bundle-999-SNAPSHOT-runner\n```\n7. Notice that the application throws the following exception:\n```\n...\n2025-02-20 20:02:15,000 WARN  [io.agr.pool] (agroal-11) Datasource '<default>': [jcc]Missing resource bundle: A resource bundle could not be found in the com.ibm.db2.jcc package for IBM Data Server Driver for JDBC and SQLJ ERRORCODE=-4461, SQLSTATE=42815\n2025-02-20 20:02:15,001 ERROR [de.tur.qua.db2.res.bun.Timer] (executor-thread-1) Error while polling timer: com.ibm.db2.jcc.am.SqlSyntaxErrorException: [jcc]Missing resource bundle: A resource bundle could not be found in the com.ibm.db2.jcc package for IBM Data Server Driver for JDBC and SQLJ ERRORCODE=-4461, SQLSTATE=42815\n\tat com.ibm.db2.jcc.am.b5.a(b5.java:810)\n\tat com.ibm.db2.jcc.am.b5.a(b5.java:66)\n\tat com.ibm.db2.jcc.am.b5.a(b5.java:116)\n\tat com.ibm.db2.jcc.t4.b.f(b.java:2703)\n\tat com.ibm.db2.jcc.t4.b.a(b.java:2710)\n\tat com.ibm.db2.jcc.t4.b.b(b.java:939)\n\tat com.ibm.db2.jcc.t4.b.a(b.java:893)\n\tat com.ibm.db2.jcc.t4.b.a(b.java:461)\n\tat com.ibm.db2.jcc.t4.b.a(b.java:434)\n\tat com.ibm.db2.jcc.t4.b.<init>(b.java:372)\n\tat com.ibm.db2.jcc.DB2SimpleDataSource.getConnection(DB2SimpleDataSource.java:259)\n\tat com.ibm.db2.jcc.DB2SimpleDataSource.getConnection(DB2SimpleDataSource.java:215)\n\tat com.ibm.db2.jcc.DB2Driver.connect(DB2Driver.java:491)\n\tat com.ibm.db2.jcc.DB2Driver.connect(DB2Driver.java:117)\n\tat io.agroal.pool.ConnectionFactory.createConnection(ConnectionFactory.java:225)\n\tat io.agroal.pool.ConnectionPool$CreateConnectionTask.call(ConnectionPool.java:580)\n\tat io.agroal.pool.ConnectionPool$CreateConnectionTask.call(ConnectionPool.java:561)\n\tat java.base@21.0.5/java.util.concurrent.FutureTask.run(FutureTask.java:317)\n\tat io.agroal.pool.util.PriorityScheduledExecutor.beforeExecute(PriorityScheduledExecutor.java:75)\n\tat java.base@21.0.5/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.base@21.0.5/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)\n\tat java.base@21.0.5/java.lang.Thread.runWith(Thread.java:1596)\n\tat java.base@21.0.5/java.lang.Thread.run(Thread.java:1583)\n\tat org.graalvm.nativeimage.builder/com.oracle.svm.core.thread.PlatformThreads.threadStartRoutine(PlatformThreads.java:896)\n\tat org.graalvm.nativeimage.builder/com.oracle.svm.core.thread.PlatformThreads.threadStartRoutine(PlatformThreads.java:872)\n...\n```\n\n### Output of `uname -a` or `ver`\n\n```\nLinux xxx 6.8.0-53-generic #55-Ubuntu SMP PREEMPT_DYNAMIC Fri Jan 17 15:37:52 UTC 2025 x86_64 x86_64 x86_64 GNU/Linux\n```\n\n### Output of `java -version`\n\n```\nopenjdk version \"21.0.3\" 2024-04-16 LTS\nOpenJDK Runtime Environment Temurin-21.0.3+9 (build 21.0.3+9-LTS)\nOpenJDK 64-Bit Server VM Temurin-21.0.3+9 (build 21.0.3+9-LTS, mixed mode, sharing)\n```\n\n### Mandrel or GraalVM version (if different from Java)\n\n```\nquay.io/quarkus/ubi-quarkus-mandrel-builder-image:23.1.5.0-Final-java21-2024-12-29@sha256:f74137a6274ddee19ae595202bcfa06008876826549d4f72d6589d8233c55625\n```\n\n### Quarkus version or git rev\n\n(at least) `3.8.5` - `3.18.4`\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\n```\nApache Maven 3.9.9 (8e8579a9e76f7d015ee5ec7bfcdc97d260186937) \nMaven home: /home/marco/.m2/wrapper/dists/apache-maven-3.9.9/3477a4f1\nJava version: 21.0.3, vendor: Eclipse Adoptium, runtime: /opt/java/mandrel/23.1.3.1-java21\nDefault locale: en_US, platform encoding: UTF-8\nOS name: \"linux\", version: \"6.8.0-53-generic\", arch: \"amd64\", family: \"unix\"\n```\n\n### Additional information\n\n- Adding all resources in `com.imb.db2.jcc:jcc`, package `com.ibm.db2.jcc.resources` does not help\n- The error seems to occur in `com.ibm.db2.jcc.am.b5.a(b5.java:810)`, but since the driver is not open-source, we cannot further analyze the issue\n- This issue is most probably related to https://github.com/quarkusio/quarkus/issues/36399","closed_by":{"login":"gsmet","id":1279749,"node_id":"MDQ6VXNlcjEyNzk3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1279749?v=4","gravatar_id":"","url":"https://api.github.com/users/gsmet","html_url":"https://github.com/gsmet","followers_url":"https://api.github.com/users/gsmet/followers","following_url":"https://api.github.com/users/gsmet/following{/other_user}","gists_url":"https://api.github.com/users/gsmet/gists{/gist_id}","starred_url":"https://api.github.com/users/gsmet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gsmet/subscriptions","organizations_url":"https://api.github.com/users/gsmet/orgs","repos_url":"https://api.github.com/users/gsmet/repos","events_url":"https://api.github.com/users/gsmet/events{/privacy}","received_events_url":"https://api.github.com/users/gsmet/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/quarkusio/quarkus/issues/46403/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/quarkusio/quarkus/issues/46403/timeline","performed_via_github_app":null,"state_reason":"completed"}