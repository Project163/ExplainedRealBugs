{"url":"https://api.github.com/repos/quarkusio/quarkus/issues/44857","repository_url":"https://api.github.com/repos/quarkusio/quarkus","labels_url":"https://api.github.com/repos/quarkusio/quarkus/issues/44857/labels{/name}","comments_url":"https://api.github.com/repos/quarkusio/quarkus/issues/44857/comments","events_url":"https://api.github.com/repos/quarkusio/quarkus/issues/44857/events","html_url":"https://github.com/quarkusio/quarkus/issues/44857","id":2709599720,"node_id":"I_kwDOCFbutM6hgTXo","number":44857,"title":"deploying-to-heroku is out of date","user":{"login":"starksm64","id":332210,"node_id":"MDQ6VXNlcjMzMjIxMA==","avatar_url":"https://avatars.githubusercontent.com/u/332210?v=4","gravatar_id":"","url":"https://api.github.com/users/starksm64","html_url":"https://github.com/starksm64","followers_url":"https://api.github.com/users/starksm64/followers","following_url":"https://api.github.com/users/starksm64/following{/other_user}","gists_url":"https://api.github.com/users/starksm64/gists{/gist_id}","starred_url":"https://api.github.com/users/starksm64/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/starksm64/subscriptions","organizations_url":"https://api.github.com/users/starksm64/orgs","repos_url":"https://api.github.com/users/starksm64/repos","events_url":"https://api.github.com/users/starksm64/events{/privacy}","received_events_url":"https://api.github.com/users/starksm64/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1710069947,"node_id":"MDU6TGFiZWwxNzEwMDY5OTQ3","url":"https://api.github.com/repos/quarkusio/quarkus/labels/area/housekeeping","name":"area/housekeeping","color":"d1d86a","default":false,"description":"Issue type for generalized tasks not related to bugs or enhancements"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/quarkusio/quarkus/milestones/361","html_url":"https://github.com/quarkusio/quarkus/milestone/361","labels_url":"https://api.github.com/repos/quarkusio/quarkus/milestones/361/labels","id":11887234,"node_id":"MI_kwDOCFbutM4AtWKC","number":361,"title":"3.18.0.CR1","description":"","creator":{"login":"quarkusbot","id":61254497,"node_id":"MDQ6VXNlcjYxMjU0NDk3","avatar_url":"https://avatars.githubusercontent.com/u/61254497?v=4","gravatar_id":"","url":"https://api.github.com/users/quarkusbot","html_url":"https://github.com/quarkusbot","followers_url":"https://api.github.com/users/quarkusbot/followers","following_url":"https://api.github.com/users/quarkusbot/following{/other_user}","gists_url":"https://api.github.com/users/quarkusbot/gists{/gist_id}","starred_url":"https://api.github.com/users/quarkusbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/quarkusbot/subscriptions","organizations_url":"https://api.github.com/users/quarkusbot/orgs","repos_url":"https://api.github.com/users/quarkusbot/repos","events_url":"https://api.github.com/users/quarkusbot/events{/privacy}","received_events_url":"https://api.github.com/users/quarkusbot/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":1,"closed_issues":462,"state":"closed","created_at":"2024-11-13T09:13:02Z","updated_at":"2025-06-18T13:20:45Z","due_on":null,"closed_at":"2025-01-15T13:20:03Z"},"comments":2,"created_at":"2024-12-01T18:07:17Z","updated_at":"2025-01-06T08:44:35Z","closed_at":"2025-01-06T08:44:32Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description\n\nI'm going through the https://quarkus.io/guides/deploying-to-heroku guide with a new heroku account and have run into the following 6 issues to deploy the quarkus app:\n\n``` bash\nheroku create\ngit push heroku master\nheroku open\n```\n\n0. The guide says a free account is allowed, but I needed to verify a credit card to be able to attempt to push a repo. After I completed getting an app pushed, I see I'm running a basic dyno at a cost of 0.010/hour. I can go in and turn this off, but then the app is no longer accessible. \n\n\n1. The first is that `master` is an invalid branch name for the current getting-started repo. It should be `main`.\n\n2. The second is that there is no remote heroku repository. Running the `heroku create` command appears to create a tmp remote repository that would need to be added before the push:\n```bash\nstarksm@Scotts-Mac-Studio getting-started % heroku create\ngit push heroku main  \nheroku open\nCreating app... done, â¬¢ fast-eyrie-75995\nhttps://fast-eyrie-75995-af4ca00a28cc.herokuapp.com/ | https://git.heroku.com/fast-eyrie-75995.git\nfatal: 'heroku' does not appear to be a git repository\nfatal: Could not read from remote repository.\n```\n\n3. Third, if I add the heroku remote using the previously created https://git.heroku.com/nameless-reef-15092.git repo, pushing to it fails with:\n\n```bash\nstarksm@Scotts-Mac-Studio getting-started % git remote add heroku https://git.heroku.com/nameless-reef-15092.git\nstarksm@Scotts-Mac-Studio getting-started % git push heroku main\nEnumerating objects: 3411, done.\nCounting objects: 100% (3411/3411), done.\nDelta compression using up to 10 threads\nCompressing objects: 100% (1360/1360), done.\nfatal: protocol error: bad line length character: fata\nWriting objects: 100% (3411/3411), 2.59 MiB | 2.17 MiB/s, done.\nTotal 3411 (delta 985), reused 3394 (delta 979), pack-reused 0\nfatal: the remote end hung up unexpectedly\nerror: failed to push some refs to 'https://git.heroku.com/nameless-reef-15092.git'\n```\n\nThis is apparently an out of date git problem on macOS:\nhttps://help.heroku.com/GJ1XRFT5/fatal-error-pushing-to-heroku-on-macos-with-git-2-39-3-apple-git-146\n\nUpdating git using homebrew \n\n```bash\nstarksm@Scotts-Mac-Studio getting-started % PATH=/opt/homebrew/bin/:$PATH\nstarksm@Scotts-Mac-Studio getting-started % type git                     \ngit is /opt/homebrew/bin//git\nstarksm@Scotts-Mac-Studio getting-started % git --version                \ngit version 2.47.1\nstarksm@Scotts-Mac-Studio getting-started % git push heroku main\nEnumerating objects: 3411, done.\nCounting objects: 100% (3411/3411), done.\nDelta compression using up to 10 threads\nCompressing objects: 100% (1360/1360), done.\nWriting objects: 100% (3411/3411), 2.59 MiB | 609.00 KiB/s, done.\nTotal 3411 (delta 985), reused 3394 (delta 979), pack-reused 0 (from 0)\nremote: Resolving deltas: 100% (985/985), done.\nremote: \nremote: !\tPush rejected, source repository is a shallow clone. Unshallow it with `git fetch --all --unshallow` and try pushing again.\nremote: \nTo https://git.heroku.com/nameless-reef-15092.git\n ! [remote rejected] main -> main (shallow update not allowed)\nerror: failed to push some refs to 'https://git.heroku.com/nameless-reef-15092.git'\n```\n\nFailed because I made a shallow clone of the https://github.com/quarkusio/quarkus-quickstarts.git repo. I had to unshallow the repo using `git fetch origin --unshallow`. The suggested `git fetch --all --unshallow` did not work.\n\n4. pushing the repo to heroku ends up building the etire quickstart repo, not just the \n```bash\nstarksm@Scotts-Mac-Studio getting-started % git push heroku main        \nEnumerating objects: 31140, done.\nCounting objects: 100% (31140/31140), done.\nDelta compression using up to 10 threads\nCompressing objects: 100% (10030/10030), done.\nWriting objects: 100% (31140/31140), 6.49 MiB | 655.00 KiB/s, done.\nTotal 31140 (delta 15326), reused 30834 (delta 15031), pack-reused 0 (from 0)\nremote: Resolving deltas: 100% (15326/15326), done.\nremote: Updated 2248 paths from ab471b96\nremote: Compressing source files... done.\nremote: Building source:\nremote: \nremote: -----> Building on the Heroku-24 stack\nremote: -----> Determining which buildpack to use for this app\nremote: -----> Java app detected\nremote: \nremote:  !     WARNING: No OpenJDK version specified\nremote:        Your application does not explicitly specify an OpenJDK\nremote:        version. The latest long-term support (LTS) version will be\nremote:        installed. This currently is OpenJDK 21.\nremote:        \nremote:        This default version will change when a new LTS version is\nremote:        released. Your application might fail to build with the new\nremote:        version. We recommend explicitly setting the required OpenJDK\nremote:        version for your application.\nremote:        \nremote:        To set the OpenJDK version, add or edit the system.properties\nremote:        file in the root directory of your application to contain:\nremote:        \nremote:        java.runtime.version = 21\nremote:        \nremote: \nremote: -----> Installing OpenJDK 21... done\nremote: -----> Executing Maven\nremote:        $ ./mvnw -DskipTests clean dependency:list install\nremote:        [INFO] Scanning for projects...\n\n...\nremote:        [INFO] ------------------------------------------------------------------------\nremote: -----> Discovering process types\nremote:        Procfile declares types     -> (none)\nremote:        Default types for buildpack -> web\nremote: \nremote: -----> Compressing...\nremote:  !     Compiled slug size: 2.9G is too large (max is 500M).\nremote:  !     See: http://devcenter.heroku.com/articles/slug-size\nremote: \nremote:  !     Push failed\nremote: Verifying deploy...\nremote: \nremote: !\tPush rejected to nameless-reef-15092.\nremote: \nTo https://git.heroku.com/nameless-reef-15092.git\n ! [remote rejected]   main -> main (pre-receive hook declined)\nerror: failed to push some refs to 'https://git.heroku.com/nameless-reef-15092.git'\n```\n\n5. After copying the getting-started directory to a separate directory and initializing a new git repo and readding the heroku remote repo, the app deploys, but the `heroku open` command fails because that attempts to `/` context, which has no handler. One needs to use `heroku open hello`:\n\n```bash\nstarksm@Scotts-Mac-Studio getting-started % git push heroku main       \nEnumerating objects: 34, done.\nCounting objects: 100% (34/34), done.\nDelta compression using up to 10 threads\nCompressing objects: 100% (24/24), done.\nWriting objects: 100% (34/34), 14.04 KiB | 4.68 MiB/s, done.\nTotal 34 (delta 2), reused 0 (delta 0), pack-reused 0 (from 0)\nremote: Updated 17 paths from 1d2525c\nremote: Compressing source files... done.\nremote: Building source:\nremote: \nremote: -----> Building on the Heroku-24 stack\nremote: -----> Determining which buildpack to use for this app\nremote: -----> Java app detected\nremote: -----> Installing OpenJDK 17... done\nremote: -----> Installing Maven 3.9.4... done\nremote: -----> Executing Maven\nremote:        $ mvn -DskipTests clean dependency:list install\nremote:        [INFO] Scanning for projects...\n...\nremote:        [INFO] ------------------------------------------------------------------------\nremote:        [INFO] BUILD SUCCESS\nremote:        [INFO] ------------------------------------------------------------------------\nremote:        [INFO] Total time:  13.291 s\nremote:        [INFO] Finished at: 2024-12-01T18:35:51Z\nremote:        [INFO] ------------------------------------------------------------------------\nremote: -----> Discovering process types\nremote:        Procfile declares types -> web\nremote: \nremote: -----> Compressing...\nremote:        Done: 79.8M\nremote: -----> Launching...\nremote:        Released v3\nremote:        https://nameless-reef-15092-932f904bd6bc.herokuapp.com/ deployed to Heroku\nremote: \nremote: Verifying deploy... done.\nTo https://git.heroku.com/nameless-reef-15092.git\n * [new branch]      main -> main\nstarksm@Scotts-Mac-Studio getting-started % heroku open\nstarksm@Scotts-Mac-Studio getting-started % heroku open /hello\n```","closed_by":{"login":"cescoffier","id":402301,"node_id":"MDQ6VXNlcjQwMjMwMQ==","avatar_url":"https://avatars.githubusercontent.com/u/402301?v=4","gravatar_id":"","url":"https://api.github.com/users/cescoffier","html_url":"https://github.com/cescoffier","followers_url":"https://api.github.com/users/cescoffier/followers","following_url":"https://api.github.com/users/cescoffier/following{/other_user}","gists_url":"https://api.github.com/users/cescoffier/gists{/gist_id}","starred_url":"https://api.github.com/users/cescoffier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cescoffier/subscriptions","organizations_url":"https://api.github.com/users/cescoffier/orgs","repos_url":"https://api.github.com/users/cescoffier/repos","events_url":"https://api.github.com/users/cescoffier/events{/privacy}","received_events_url":"https://api.github.com/users/cescoffier/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/quarkusio/quarkus/issues/44857/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/quarkusio/quarkus/issues/44857/timeline","performed_via_github_app":null,"state_reason":"completed"}