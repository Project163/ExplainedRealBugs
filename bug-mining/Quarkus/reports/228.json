{"url":"https://api.github.com/repos/quarkusio/quarkus/issues/47936","repository_url":"https://api.github.com/repos/quarkusio/quarkus","labels_url":"https://api.github.com/repos/quarkusio/quarkus/issues/47936/labels{/name}","comments_url":"https://api.github.com/repos/quarkusio/quarkus/issues/47936/comments","events_url":"https://api.github.com/repos/quarkusio/quarkus/issues/47936/events","html_url":"https://github.com/quarkusio/quarkus/issues/47936","id":3072979263,"node_id":"I_kwDOCFbutM63KfE_","number":47936,"title":"quarkus-grpc provides insufficient reachability metadata for enum","user":{"login":"nconcetti","id":25587868,"node_id":"MDQ6VXNlcjI1NTg3ODY4","avatar_url":"https://avatars.githubusercontent.com/u/25587868?v=4","gravatar_id":"","url":"https://api.github.com/users/nconcetti","html_url":"https://github.com/nconcetti","followers_url":"https://api.github.com/users/nconcetti/followers","following_url":"https://api.github.com/users/nconcetti/following{/other_user}","gists_url":"https://api.github.com/users/nconcetti/gists{/gist_id}","starred_url":"https://api.github.com/users/nconcetti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nconcetti/subscriptions","organizations_url":"https://api.github.com/users/nconcetti/orgs","repos_url":"https://api.github.com/users/nconcetti/repos","events_url":"https://api.github.com/users/nconcetti/events{/privacy}","received_events_url":"https://api.github.com/users/nconcetti/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":985346620,"node_id":"MDU6TGFiZWw5ODUzNDY2MjA=","url":"https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug","name":"kind/bug","color":"d73a4a","default":false,"description":"Something isn't working"},{"id":2062531368,"node_id":"MDU6TGFiZWwyMDYyNTMxMzY4","url":"https://api.github.com/repos/quarkusio/quarkus/labels/area/grpc","name":"area/grpc","color":"0366d6","default":false,"description":"gRPC"},{"id":2497075451,"node_id":"MDU6TGFiZWwyNDk3MDc1NDUx","url":"https://api.github.com/repos/quarkusio/quarkus/labels/area/native-image","name":"area/native-image","color":"0366d6","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2025-05-19T08:24:13Z","updated_at":"2025-05-19T13:15:55Z","closed_at":"2025-05-19T13:15:55Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nWhen trying to call `toString()` on a generated proto message, a `IllegalStateException` is thrown, if any of these conditions are true\n \n- The message contains an enum (locally defined or imported)\n- The message contains anything from `protobuf-java` (such as `com.google.protobuf.Timestamp`)\n\n\n\n### Expected behavior\n\nCalling `toString` on a generated proto class should not throw exceptions. Implicit calls, such as passing the proto to a logger, should neither throw.\n\n### Actual behavior\n\nException, if calling `toString` on generated class containing Enum:\n\n```posh\njava.lang.IllegalStateException: Generated message class \"demo.DemoOuterClass$Enum\" missing method \"valueOf\".\n        at com.google.protobuf.GeneratedMessageV3.getMethodOrDie(GeneratedMessageV3.java:2005)\n        at com.google.protobuf.GeneratedMessageV3.access$1000(GeneratedMessageV3.java:56)\n        at com.google.protobuf.GeneratedMessageV3$FieldAccessorTable$SingularEnumFieldAccessor.<init>(GeneratedMessageV3.java:2946)\n        at com.google.protobuf.GeneratedMessageV3$FieldAccessorTable.ensureFieldAccessorsInitialized(GeneratedMessageV3.java:2145)\n        at demo.DemoOuterClass$EnumTriggerRequest.internalGetFieldAccessorTable(DemoOuterClass.java:167)\n        at com.google.protobuf.GeneratedMessageV3.getDescriptorForType(GeneratedMessageV3.java:116)\n        at com.google.protobuf.TextFormat$Printer.print(TextFormat.java:340)\n        at com.google.protobuf.TextFormat$Printer.print(TextFormat.java:330)\n        at com.google.protobuf.TextFormat$Printer.printToString(TextFormat.java:592)\n        at com.google.protobuf.AbstractMessage.toString(AbstractMessage.java:87)\n        at java.base@21.0.7/java.lang.String.valueOf(String.java:4465)\n        at org.jboss.logging.JBossLogManagerLogger.doLog(JBossLogManagerLogger.java:43)\n        at org.jboss.logging.Logger.info(Logger.java:957)\n        at org.acme.DemoGrpcService.lambda$triggerEnumError$0(DemoGrpcService.java:18)\n        at io.smallrye.context.impl.wrappers.SlowContextualConsumer.accept(SlowContextualConsumer.java:21)\n        at io.smallrye.mutiny.operators.uni.UniOnItemConsume$UniOnItemComsumeProcessor.invokeEventHandler(UniOnItemConsume.java:77)\n        at io.smallrye.mutiny.operators.uni.UniOnItemConsume$UniOnItemComsumeProcessor.onItem(UniOnItemConsume.java:42)\n        at io.smallrye.mutiny.operators.uni.builders.UniCreateFromKnownItem$KnownItemSubscription.forward(UniCreateFromKnownItem.java:38)\n        at io.smallrye.mutiny.operators.uni.builders.UniCreateFromKnownItem.subscribe(UniCreateFromKnownItem.java:23)\n        at io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:35)\n        at io.smallrye.mutiny.operators.uni.UniOnItemConsume.subscribe(UniOnItemConsume.java:30)\n        at io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:35)\n        at io.smallrye.mutiny.operators.uni.UniOnItemTransform.subscribe(UniOnItemTransform.java:22)\n        at io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:35)\n        at io.smallrye.mutiny.operators.uni.UniOnItemConsume.subscribe(UniOnItemConsume.java:30)\n        at io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:35)\n        at io.smallrye.mutiny.groups.UniSubscribe.withSubscriber(UniSubscribe.java:51)\n        at io.smallrye.mutiny.groups.UniSubscribe.with(UniSubscribe.java:110)\n        at io.smallrye.mutiny.groups.UniSubscribe.with(UniSubscribe.java:88)\n        at io.quarkus.grpc.stubs.ServerCalls.oneToOne(ServerCalls.java:38)\n        at demo.MutinyDemoGrpc$MethodHandlers.invoke(MutinyDemoGrpc.java:98)\n        at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n        at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n        at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n        at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n        at io.quarkus.grpc.ExceptionHandler.onHalfClose(ExceptionHandler.java:36)\n        at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n        at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n        at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n        at io.quarkus.grpc.runtime.supports.context.GrpcRequestContextGrpcInterceptor$1.onHalfClose(GrpcRequestContextGrpcInterceptor.java:84)\n        at io.quarkus.grpc.runtime.supports.context.GrpcDuplicatedContextGrpcInterceptor$ListenedOnDuplicatedContext.invoke(GrpcDuplicatedContextGrpcInterceptor.java:130)\n        at io.quarkus.grpc.runtime.supports.context.GrpcDuplicatedContextGrpcInterceptor$ListenedOnDuplicatedContext.onHalfClose(GrpcDuplicatedContextGrpcInterceptor.java:161)\n        at io.vertx.grpc.server.impl.GrpcServiceBridgeImpl$ServerCallImpl$1.handleClose(GrpcServiceBridgeImpl.java:112)\n        at io.vertx.grpc.common.impl.ReadStreamAdapter.lambda$init$1(ReadStreamAdapter.java:33)\n        at io.vertx.grpc.common.impl.GrpcReadStreamBase.handleEnd(GrpcReadStreamBase.java:266)\n        at io.vertx.grpc.common.impl.GrpcReadStreamBase.lambda$init$3(GrpcReadStreamBase.java:91)\n        at io.vertx.core.streams.impl.InboundBuffer.handleEvent(InboundBuffer.java:279)\n        at io.vertx.core.streams.impl.InboundBuffer.write(InboundBuffer.java:157)\n        at io.vertx.grpc.common.impl.GrpcReadStreamBase.lambda$init$0(GrpcReadStreamBase.java:80)\n        at io.vertx.core.impl.ContextInternal.dispatch(ContextInternal.java:270)\n        at io.vertx.core.impl.ContextInternal.dispatch(ContextInternal.java:252)\n        at io.vertx.core.http.impl.HttpEventHandler.handleEnd(HttpEventHandler.java:76)\n        at io.vertx.core.http.impl.Http2ServerRequest.handleEnd(Http2ServerRequest.java:186)\n        at io.vertx.core.http.impl.Http2ServerStream.handleEnd(Http2ServerStream.java:211)\n        at io.vertx.core.http.impl.VertxHttp2Stream.lambda$new$1(VertxHttp2Stream.java:65)\n        at io.vertx.core.streams.impl.InboundBuffer.handleEvent(InboundBuffer.java:279)\n        at io.vertx.core.streams.impl.InboundBuffer.write(InboundBuffer.java:157)\n        at io.vertx.core.impl.ContextImpl.emit(ContextImpl.java:342)\n        at io.vertx.core.impl.DuplicatedContext.emit(DuplicatedContext.java:163)\n        at io.vertx.core.http.impl.VertxHttp2Stream.onEnd(VertxHttp2Stream.java:143)\n        at io.vertx.core.http.impl.Http2ServerStream.onEnd(Http2ServerStream.java:136)\n        at io.vertx.core.http.impl.VertxHttp2Stream.onEnd(VertxHttp2Stream.java:138)\n        at io.vertx.core.http.impl.Http2ConnectionBase.onDataRead(Http2ConnectionBase.java:318)\n        at io.vertx.core.http.impl.Http2ServerConnection.onDataRead(Http2ServerConnection.java:38)\n        at io.netty.handler.codec.http2.Http2FrameListenerDecorator.onDataRead(Http2FrameListenerDecorator.java:34)\n        at io.netty.handler.codec.http2.Http2FrameListenerDecorator.onDataRead(Http2FrameListenerDecorator.java:34)\n        at io.netty.handler.codec.http2.Http2EmptyDataFrameListener.onDataRead(Http2EmptyDataFrameListener.java:49)\n        at io.netty.handler.codec.http2.DefaultHttp2ConnectionDecoder$FrameReadListener.onDataRead(DefaultHttp2ConnectionDecoder.java:320)\n        at io.netty.handler.codec.http2.DefaultHttp2FrameReader.readDataFrame(DefaultHttp2FrameReader.java:409)\n        at io.netty.handler.codec.http2.DefaultHttp2FrameReader.processPayloadState(DefaultHttp2FrameReader.java:244)\n        at io.netty.handler.codec.http2.DefaultHttp2FrameReader.readFrame(DefaultHttp2FrameReader.java:164)\n        at io.netty.handler.codec.http2.DefaultHttp2ConnectionDecoder.decodeFrame(DefaultHttp2ConnectionDecoder.java:186)\n        at io.netty.handler.codec.http2.DecoratingHttp2ConnectionDecoder.decodeFrame(DecoratingHttp2ConnectionDecoder.java:61)\n        at io.netty.handler.codec.http2.DecoratingHttp2ConnectionDecoder.decodeFrame(DecoratingHttp2ConnectionDecoder.java:61)\n        at io.netty.handler.codec.http2.Http2ConnectionHandler$FrameDecoder.decode(Http2ConnectionHandler.java:391)\n        at io.netty.handler.codec.http2.Http2ConnectionHandler.decode(Http2ConnectionHandler.java:451)\n        at io.netty.handler.codec.ByteToMessageDecoder.decodeRemovalReentryProtection(ByteToMessageDecoder.java:530)\n        at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:469)\n        at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:290)\n        at io.vertx.core.http.impl.VertxHttp2ConnectionHandler.channelRead(VertxHttp2ConnectionHandler.java:405)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n        at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:289)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n        at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n        at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868)\n        at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)\n        at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:796)\n        at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:732)\n        at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:658)\n        at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)\n        at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998)\n        at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n        at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\n        at java.base@21.0.7/java.lang.Thread.runWith(Thread.java:1596)\n        at java.base@21.0.7/java.lang.Thread.run(Thread.java:1583)\n        at org.graalvm.nativeimage.builder/com.oracle.svm.core.thread.PlatformThreads.threadStartRoutine(PlatformThreads.java:896)\n        at org.graalvm.nativeimage.builder/com.oracle.svm.core.thread.PlatformThreads.threadStartRoutine(PlatformThreads.java:872)\nCaused by: java.lang.NoSuchMethodException: demo.DemoOuterClass$Enum.valueOf(com.google.protobuf.Descriptors$EnumValueDescriptor)\n        at java.base@21.0.7/java.lang.Class.checkMethod(DynamicHub.java:1078)\n        at java.base@21.0.7/java.lang.Class.getMethod(DynamicHub.java:1063)\n        at com.google.protobuf.GeneratedMessageV3.getMethodOrDie(GeneratedMessageV3.java:2002)\n        ... 102 more\n```\n\nException, if calling `toString` on generated class containing `com.google.protobuf.timestamp`:\n\n```posh\njava.lang.IllegalStateException: Generated message class \"com.google.protobuf.Timestamp\" missing method \"newBuilder\".\n        at com.google.protobuf.GeneratedMessageV3.getMethodOrDie(GeneratedMessageV3.java:2005)\n        at com.google.protobuf.GeneratedMessageV3.access$1000(GeneratedMessageV3.java:56)\n        at com.google.protobuf.GeneratedMessageV3$FieldAccessorTable$SingularMessageFieldAccessor.<init>(GeneratedMessageV3.java:3156)\n        at com.google.protobuf.GeneratedMessageV3$FieldAccessorTable.ensureFieldAccessorsInitialized(GeneratedMessageV3.java:2137)\n        at demo.DemoOuterClass$TimestampTriggerRequest.internalGetFieldAccessorTable(DemoOuterClass.java:1453)\n        at com.google.protobuf.GeneratedMessageV3.getDescriptorForType(GeneratedMessageV3.java:116)\n        at com.google.protobuf.TextFormat$Printer.print(TextFormat.java:340)\n        at com.google.protobuf.TextFormat$Printer.print(TextFormat.java:330)\n        at com.google.protobuf.TextFormat$Printer.printToString(TextFormat.java:592)\n        at com.google.protobuf.AbstractMessage.toString(AbstractMessage.java:87)\n        at java.base@21.0.7/java.lang.String.valueOf(String.java:4465)\n        at org.jboss.logging.JBossLogManagerLogger.doLog(JBossLogManagerLogger.java:43)\n        at org.jboss.logging.Logger.info(Logger.java:957)\n        at org.acme.DemoGrpcService.lambda$triggerTimestampError$2(DemoGrpcService.java:30)\n        at io.smallrye.context.impl.wrappers.SlowContextualConsumer.accept(SlowContextualConsumer.java:21)\n        at io.smallrye.mutiny.operators.uni.UniOnItemConsume$UniOnItemComsumeProcessor.invokeEventHandler(UniOnItemConsume.java:77)\n        at io.smallrye.mutiny.operators.uni.UniOnItemConsume$UniOnItemComsumeProcessor.onItem(UniOnItemConsume.java:42)\n        at io.smallrye.mutiny.operators.uni.builders.UniCreateFromKnownItem$KnownItemSubscription.forward(UniCreateFromKnownItem.java:38)\n        at io.smallrye.mutiny.operators.uni.builders.UniCreateFromKnownItem.subscribe(UniCreateFromKnownItem.java:23)\n        at io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:35)\n        at io.smallrye.mutiny.operators.uni.UniOnItemConsume.subscribe(UniOnItemConsume.java:30)\n        at io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:35)\n        at io.smallrye.mutiny.operators.uni.UniOnItemTransform.subscribe(UniOnItemTransform.java:22)\n        at io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:35)\n        at io.smallrye.mutiny.operators.uni.UniOnItemConsume.subscribe(UniOnItemConsume.java:30)\n        at io.smallrye.mutiny.operators.AbstractUni.subscribe(AbstractUni.java:35)\n        at io.smallrye.mutiny.groups.UniSubscribe.withSubscriber(UniSubscribe.java:51)\n        at io.smallrye.mutiny.groups.UniSubscribe.with(UniSubscribe.java:110)\n        at io.smallrye.mutiny.groups.UniSubscribe.with(UniSubscribe.java:88)\n        at io.quarkus.grpc.stubs.ServerCalls.oneToOne(ServerCalls.java:38)\n        at demo.MutinyDemoGrpc$MethodHandlers.invoke(MutinyDemoGrpc.java:101)\n        at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182)\n        at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n        at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n        at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n        at io.quarkus.grpc.ExceptionHandler.onHalfClose(ExceptionHandler.java:36)\n        at io.grpc.PartialForwardingServerCallListener.onHalfClose(PartialForwardingServerCallListener.java:35)\n        at io.grpc.ForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:23)\n        at io.grpc.ForwardingServerCallListener$SimpleForwardingServerCallListener.onHalfClose(ForwardingServerCallListener.java:40)\n        at io.quarkus.grpc.runtime.supports.context.GrpcRequestContextGrpcInterceptor$1.onHalfClose(GrpcRequestContextGrpcInterceptor.java:84)\n        at io.quarkus.grpc.runtime.supports.context.GrpcDuplicatedContextGrpcInterceptor$ListenedOnDuplicatedContext.invoke(GrpcDuplicatedContextGrpcInterceptor.java:130)\n        at io.quarkus.grpc.runtime.supports.context.GrpcDuplicatedContextGrpcInterceptor$ListenedOnDuplicatedContext.onHalfClose(GrpcDuplicatedContextGrpcInterceptor.java:161)\n        at io.vertx.grpc.server.impl.GrpcServiceBridgeImpl$ServerCallImpl$1.handleClose(GrpcServiceBridgeImpl.java:112)\n        at io.vertx.grpc.common.impl.ReadStreamAdapter.lambda$init$1(ReadStreamAdapter.java:33)\n        at io.vertx.grpc.common.impl.GrpcReadStreamBase.handleEnd(GrpcReadStreamBase.java:266)\n        at io.vertx.grpc.common.impl.GrpcReadStreamBase.lambda$init$3(GrpcReadStreamBase.java:91)\n        at io.vertx.core.streams.impl.InboundBuffer.handleEvent(InboundBuffer.java:279)\n        at io.vertx.core.streams.impl.InboundBuffer.write(InboundBuffer.java:157)\n        at io.vertx.grpc.common.impl.GrpcReadStreamBase.lambda$init$0(GrpcReadStreamBase.java:80)\n        at io.vertx.core.impl.ContextInternal.dispatch(ContextInternal.java:270)\n        at io.vertx.core.impl.ContextInternal.dispatch(ContextInternal.java:252)\n        at io.vertx.core.http.impl.HttpEventHandler.handleEnd(HttpEventHandler.java:76)\n        at io.vertx.core.http.impl.Http2ServerRequest.handleEnd(Http2ServerRequest.java:186)\n        at io.vertx.core.http.impl.Http2ServerStream.handleEnd(Http2ServerStream.java:211)\n        at io.vertx.core.http.impl.VertxHttp2Stream.lambda$new$1(VertxHttp2Stream.java:65)\n        at io.vertx.core.streams.impl.InboundBuffer.handleEvent(InboundBuffer.java:279)\n        at io.vertx.core.streams.impl.InboundBuffer.write(InboundBuffer.java:157)\n        at io.vertx.core.impl.ContextImpl.emit(ContextImpl.java:342)\n        at io.vertx.core.impl.DuplicatedContext.emit(DuplicatedContext.java:163)\n        at io.vertx.core.http.impl.VertxHttp2Stream.onEnd(VertxHttp2Stream.java:143)\n        at io.vertx.core.http.impl.Http2ServerStream.onEnd(Http2ServerStream.java:136)\n        at io.vertx.core.http.impl.VertxHttp2Stream.onEnd(VertxHttp2Stream.java:138)\n        at io.vertx.core.http.impl.Http2ConnectionBase.onDataRead(Http2ConnectionBase.java:318)\n        at io.vertx.core.http.impl.Http2ServerConnection.onDataRead(Http2ServerConnection.java:38)\n        at io.netty.handler.codec.http2.Http2FrameListenerDecorator.onDataRead(Http2FrameListenerDecorator.java:34)\n        at io.netty.handler.codec.http2.Http2FrameListenerDecorator.onDataRead(Http2FrameListenerDecorator.java:34)\n        at io.netty.handler.codec.http2.Http2EmptyDataFrameListener.onDataRead(Http2EmptyDataFrameListener.java:49)\n        at io.netty.handler.codec.http2.DefaultHttp2ConnectionDecoder$FrameReadListener.onDataRead(DefaultHttp2ConnectionDecoder.java:320)\n        at io.netty.handler.codec.http2.DefaultHttp2FrameReader.readDataFrame(DefaultHttp2FrameReader.java:409)\n        at io.netty.handler.codec.http2.DefaultHttp2FrameReader.processPayloadState(DefaultHttp2FrameReader.java:244)\n        at io.netty.handler.codec.http2.DefaultHttp2FrameReader.readFrame(DefaultHttp2FrameReader.java:164)\n        at io.netty.handler.codec.http2.DefaultHttp2ConnectionDecoder.decodeFrame(DefaultHttp2ConnectionDecoder.java:186)\n        at io.netty.handler.codec.http2.DecoratingHttp2ConnectionDecoder.decodeFrame(DecoratingHttp2ConnectionDecoder.java:61)\n        at io.netty.handler.codec.http2.DecoratingHttp2ConnectionDecoder.decodeFrame(DecoratingHttp2ConnectionDecoder.java:61)\n        at io.netty.handler.codec.http2.Http2ConnectionHandler$FrameDecoder.decode(Http2ConnectionHandler.java:391)\n        at io.netty.handler.codec.http2.Http2ConnectionHandler.decode(Http2ConnectionHandler.java:451)\n        at io.netty.handler.codec.ByteToMessageDecoder.decodeRemovalReentryProtection(ByteToMessageDecoder.java:530)\n        at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:469)\n        at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:290)\n        at io.vertx.core.http.impl.VertxHttp2ConnectionHandler.channelRead(VertxHttp2ConnectionHandler.java:405)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n        at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:289)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n        at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)\n        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n        at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868)\n        at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)\n        at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:796)\n        at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:732)\n        at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:658)\n        at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)\n        at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998)\n        at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n        at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\n        at java.base@21.0.7/java.lang.Thread.runWith(Thread.java:1596)\n        at java.base@21.0.7/java.lang.Thread.run(Thread.java:1583)\n        at org.graalvm.nativeimage.builder/com.oracle.svm.core.thread.PlatformThreads.threadStartRoutine(PlatformThreads.java:896)\n        at org.graalvm.nativeimage.builder/com.oracle.svm.core.thread.PlatformThreads.threadStartRoutine(PlatformThreads.java:872)\nCaused by: java.lang.NoSuchMethodException: com.google.protobuf.Timestamp.newBuilder()\n        at java.base@21.0.7/java.lang.Class.checkMethod(DynamicHub.java:1078)\n        at java.base@21.0.7/java.lang.Class.getMethod(DynamicHub.java:1063)\n        at com.google.protobuf.GeneratedMessageV3.getMethodOrDie(GeneratedMessageV3.java:2002)\n        ... 102 more\n\n```\n\n### How to Reproduce?\n\n1. Checkout https://github.com/nconcetti/quarkus-grpc-native-bugs\n2. Compile with `./gradlew build -Dquarkus.native.enabled=true -Dquarkus.native.container-build=true -Dquarkus.package.jar.enabled=false`\n3. Run `./build/quarkus-grpc-native-bugs-1.0-SNAPSHOT-runner`\n4. Hit the service with something like `grpcurl`\n  - To trigger exception with enum: `grpcurl  -plaintext  -d '{\"name\": \"a\", \"enum\": \"A\"}' localhost:8080 demo.Demo/TriggerEnumError`\n  - To trigger exception with timestamp:  `grpcurl  -plaintext  -d '{\"name\": \"a\", \"timestamp\": \"2006-01-02T15:04:05.999999999Z\"}' localhost:8080 demo.Demo/TriggerTimestampError`\n\n\n### Output of `uname -a` or `ver`\n\nLinux precision-3440 6.14.6-arch1-1 #1 SMP PREEMPT_DYNAMIC Fri, 09 May 2025 17:36:18 +0000 x86_64 GNU/Linux\n\n### Output of `java -version`\n\nopenjdk version \"21.0.7\" 2025-04-15 LTS OpenJDK Runtime Environment Temurin-21.0.7+6 (build 21.0.7+6-LTS) OpenJDK 64-Bit Server VM Temurin-21.0.7+6 (build 21.0.7+6-LTS, mixed mode, sharing)\n\n### Mandrel or GraalVM version (if different from Java)\n\nquay.io/quarkus/ubi9-quarkus-mandrel-builder-image:jdk-21\n\n### Quarkus version or git rev\n\nat least from 3.20.0 to 3.22.3\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\ngradle 8.13\n\n### Additional information\n\nI have tracked the causes down to:\n\n- [GrpcCommonProcessor.java#L32](https://github.com/quarkusio/quarkus/blob/main/extensions/grpc-common/deployment/src/main/java/io/quarkus/grpc/common/deployment/GrpcCommonProcessor.java#L32) where it should identify implementors instead of subclasses\n- `protobuf-java` nowhere being added to the CombinedIndex, so native configuration has no effect on contained classes","closed_by":{"login":"geoand","id":4374975,"node_id":"MDQ6VXNlcjQzNzQ5NzU=","avatar_url":"https://avatars.githubusercontent.com/u/4374975?v=4","gravatar_id":"","url":"https://api.github.com/users/geoand","html_url":"https://github.com/geoand","followers_url":"https://api.github.com/users/geoand/followers","following_url":"https://api.github.com/users/geoand/following{/other_user}","gists_url":"https://api.github.com/users/geoand/gists{/gist_id}","starred_url":"https://api.github.com/users/geoand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/geoand/subscriptions","organizations_url":"https://api.github.com/users/geoand/orgs","repos_url":"https://api.github.com/users/geoand/repos","events_url":"https://api.github.com/users/geoand/events{/privacy}","received_events_url":"https://api.github.com/users/geoand/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/quarkusio/quarkus/issues/47936/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/quarkusio/quarkus/issues/47936/timeline","performed_via_github_app":null,"state_reason":"completed"}