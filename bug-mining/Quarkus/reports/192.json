{"url":"https://api.github.com/repos/quarkusio/quarkus/issues/46721","repository_url":"https://api.github.com/repos/quarkusio/quarkus","labels_url":"https://api.github.com/repos/quarkusio/quarkus/issues/46721/labels{/name}","comments_url":"https://api.github.com/repos/quarkusio/quarkus/issues/46721/comments","events_url":"https://api.github.com/repos/quarkusio/quarkus/issues/46721/events","html_url":"https://github.com/quarkusio/quarkus/issues/46721","id":2910406264,"node_id":"I_kwDOCFbutM6teUZ4","number":46721,"title":"Decorator for default methods of decorated types not being called","user":{"login":"slinstaedt-hlag","id":171125563,"node_id":"U_kgDOCjMrOw","avatar_url":"https://avatars.githubusercontent.com/u/171125563?v=4","gravatar_id":"","url":"https://api.github.com/users/slinstaedt-hlag","html_url":"https://github.com/slinstaedt-hlag","followers_url":"https://api.github.com/users/slinstaedt-hlag/followers","following_url":"https://api.github.com/users/slinstaedt-hlag/following{/other_user}","gists_url":"https://api.github.com/users/slinstaedt-hlag/gists{/gist_id}","starred_url":"https://api.github.com/users/slinstaedt-hlag/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/slinstaedt-hlag/subscriptions","organizations_url":"https://api.github.com/users/slinstaedt-hlag/orgs","repos_url":"https://api.github.com/users/slinstaedt-hlag/repos","events_url":"https://api.github.com/users/slinstaedt-hlag/events{/privacy}","received_events_url":"https://api.github.com/users/slinstaedt-hlag/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":985346620,"node_id":"MDU6TGFiZWw5ODUzNDY2MjA=","url":"https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug","name":"kind/bug","color":"d73a4a","default":false,"description":"Something isn't working"},{"id":1282102389,"node_id":"MDU6TGFiZWwxMjgyMTAyMzg5","url":"https://api.github.com/repos/quarkusio/quarkus/labels/area/arc","name":"area/arc","color":"0366d6","default":false,"description":"Issue related to ARC (dependency injection)"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/quarkusio/quarkus/milestones/388","html_url":"https://github.com/quarkusio/quarkus/milestone/388","labels_url":"https://api.github.com/repos/quarkusio/quarkus/milestones/388/labels","id":12560114,"node_id":"MI_kwDOCFbutM4Av6by","number":388,"title":"3.21.0","description":"","creator":{"login":"gsmet","id":1279749,"node_id":"MDQ6VXNlcjEyNzk3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1279749?v=4","gravatar_id":"","url":"https://api.github.com/users/gsmet","html_url":"https://github.com/gsmet","followers_url":"https://api.github.com/users/gsmet/followers","following_url":"https://api.github.com/users/gsmet/following{/other_user}","gists_url":"https://api.github.com/users/gsmet/gists{/gist_id}","starred_url":"https://api.github.com/users/gsmet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gsmet/subscriptions","organizations_url":"https://api.github.com/users/gsmet/orgs","repos_url":"https://api.github.com/users/gsmet/repos","events_url":"https://api.github.com/users/gsmet/events{/privacy}","received_events_url":"https://api.github.com/users/gsmet/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":18,"state":"closed","created_at":"2025-03-18T17:21:19Z","updated_at":"2025-08-13T11:22:56Z","due_on":null,"closed_at":"2025-03-19T13:00:32Z"},"comments":11,"created_at":"2025-03-11T12:43:56Z","updated_at":"2025-03-18T17:25:55Z","closed_at":"2025-03-18T11:28:52Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nFirst: I am aware, quarkus is an implementation of CDI light, but not CDI full. Nevertheless it provides some functionalities of CDI full, like decorators, which I would expect to work like specified in CDI full.\n\nWe discovered actually some corner cases, where quarkus' implementation of CDI decorators actually behaves differently (in terms of not failing with an exception, but interpreting the spec differently) from other CDI implementations: If a bean has a bean type being an interface with default methods, which the bean itself does not override, any applied decorator for that bean type that override that method is never getting called but any calls are directly delegated to the interface's default method. If the bean overrides these default method (even if it just delegates it's calls to interface's default method), the decorator is getting called as expected.\n\nAs CDI light is not mentioning anything regarding decoration behaviour, I am [referring to the CDI full spec of decotors](https://jakarta.ee/specifications/cdi/4.1/jakarta-cdi-spec-4.1#decorated_types): \n> The decorator intercepts every method which is declared by a decorated type of the decorator and is implemented by the bean class of the decorator.\n\nFrom my interpretation, that reads like: If an interface declares a method (independently of being abstract or concrete) and an decorator class implements this method, the decorator is getting called for invocations of this method. The spec does not mention any differentiation between abstract and default methods. \n\n### Expected behavior\n\nYou can imagine I was somehow surprised when changing some interface's abstract methods to default ones (e.g. to remove duplications in implementing classes), that some decorations did not get applied any more, especially if these decorations are security relevant. I have silently assumed that decoration works, like in other CDI implementations and also programmatically applied DIY GoF decorator pattern.\n\n### Actual behavior\n\nCalls to default methods of decorated bean types, which are not overridden by the decorated bean itself, are not getting decorated, but directly delegated to the default method's implementation.\n\n### How to Reproduce?\n\n_No response_\n\n### Output of `uname -a` or `ver`\n\nLinux NHH43414 5.15.167.4-microsoft-standard-WSL2 #1 SMP Tue Nov 5 00:21:55 UTC 2024 x86_64 x86_64 x86_64 GNU/Linux\n\n### Output of `java -version`\n\nJava version: 21.0.6, vendor: Ubuntu, runtime: /usr/lib/jvm/java-21-openjdk-amd64\n\n### Quarkus version or git rev\n\n3.19.2\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\nApache Maven 3.9.9\n\n### Additional information\n\n_No response_","closed_by":{"login":"manovotn","id":4181235,"node_id":"MDQ6VXNlcjQxODEyMzU=","avatar_url":"https://avatars.githubusercontent.com/u/4181235?v=4","gravatar_id":"","url":"https://api.github.com/users/manovotn","html_url":"https://github.com/manovotn","followers_url":"https://api.github.com/users/manovotn/followers","following_url":"https://api.github.com/users/manovotn/following{/other_user}","gists_url":"https://api.github.com/users/manovotn/gists{/gist_id}","starred_url":"https://api.github.com/users/manovotn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manovotn/subscriptions","organizations_url":"https://api.github.com/users/manovotn/orgs","repos_url":"https://api.github.com/users/manovotn/repos","events_url":"https://api.github.com/users/manovotn/events{/privacy}","received_events_url":"https://api.github.com/users/manovotn/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/quarkusio/quarkus/issues/46721/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/quarkusio/quarkus/issues/46721/timeline","performed_via_github_app":null,"state_reason":"completed"}