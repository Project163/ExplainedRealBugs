{"url":"https://api.github.com/repos/quarkusio/quarkus/issues/48151","repository_url":"https://api.github.com/repos/quarkusio/quarkus","labels_url":"https://api.github.com/repos/quarkusio/quarkus/issues/48151/labels{/name}","comments_url":"https://api.github.com/repos/quarkusio/quarkus/issues/48151/comments","events_url":"https://api.github.com/repos/quarkusio/quarkus/issues/48151/events","html_url":"https://github.com/quarkusio/quarkus/issues/48151","id":3103376585,"node_id":"I_kwDOCFbutM64-cTJ","number":48151,"title":"Can not post body to custom management endpoint in DEV mode","user":{"login":"lschmierer","id":2204708,"node_id":"MDQ6VXNlcjIyMDQ3MDg=","avatar_url":"https://avatars.githubusercontent.com/u/2204708?v=4","gravatar_id":"","url":"https://api.github.com/users/lschmierer","html_url":"https://github.com/lschmierer","followers_url":"https://api.github.com/users/lschmierer/followers","following_url":"https://api.github.com/users/lschmierer/following{/other_user}","gists_url":"https://api.github.com/users/lschmierer/gists{/gist_id}","starred_url":"https://api.github.com/users/lschmierer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lschmierer/subscriptions","organizations_url":"https://api.github.com/users/lschmierer/orgs","repos_url":"https://api.github.com/users/lschmierer/repos","events_url":"https://api.github.com/users/lschmierer/events{/privacy}","received_events_url":"https://api.github.com/users/lschmierer/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":985346620,"node_id":"MDU6TGFiZWw5ODUzNDY2MjA=","url":"https://api.github.com/repos/quarkusio/quarkus/labels/kind/bug","name":"kind/bug","color":"d73a4a","default":false,"description":"Something isn't working"},{"id":1320737519,"node_id":"MDU6TGFiZWwxMzIwNzM3NTE5","url":"https://api.github.com/repos/quarkusio/quarkus/labels/area/vertx","name":"area/vertx","color":"0366d6","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/quarkusio/quarkus/milestones/404","html_url":"https://github.com/quarkusio/quarkus/milestone/404","labels_url":"https://api.github.com/repos/quarkusio/quarkus/milestones/404/labels","id":13019204,"node_id":"MI_kwDOCFbutM4AxqhE","number":404,"title":"3.23.1","description":"","creator":{"login":"gsmet","id":1279749,"node_id":"MDQ6VXNlcjEyNzk3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/1279749?v=4","gravatar_id":"","url":"https://api.github.com/users/gsmet","html_url":"https://github.com/gsmet","followers_url":"https://api.github.com/users/gsmet/followers","following_url":"https://api.github.com/users/gsmet/following{/other_user}","gists_url":"https://api.github.com/users/gsmet/gists{/gist_id}","starred_url":"https://api.github.com/users/gsmet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gsmet/subscriptions","organizations_url":"https://api.github.com/users/gsmet/orgs","repos_url":"https://api.github.com/users/gsmet/repos","events_url":"https://api.github.com/users/gsmet/events{/privacy}","received_events_url":"https://api.github.com/users/gsmet/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":52,"state":"closed","created_at":"2025-06-03T17:12:24Z","updated_at":"2025-07-02T11:18:15Z","due_on":null,"closed_at":"2025-06-04T12:28:51Z"},"comments":14,"created_at":"2025-05-30T14:17:46Z","updated_at":"2025-06-03T17:22:32Z","closed_at":"2025-06-03T09:38:17Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nHi, I am trying to accept simple `plain/text` on a post endpoint.\n```Kotlin\nclass Management {\n    fun registerManagementRoutes(@Observes mi: ManagementInterface) {\n        mi.router()\n            .post(\"/test\")\n            // .handler(BodyHandler.create()) // does not change anything\n            .handler { rc: RoutingContext ->\n                val message = rc.body().asString()\n                rc.response().end(\"Received: $message\")\n            }\n    }\n}\n```\n\n### Expected behavior\n\n```\ncurl -X POST http://localhost:9000/test -H \"Content-Type: plain/text\" -d hello --verbose\n```\nshould return \"Received: hello\"\n\n### Actual behavior\n\nRunning\n```\ncurl -X POST http://localhost:9000/test -H \"Content-Type: plain/text\" -d hello --verbose\n```\nthe server just does not accepts or routes the request, my handler is never called.\n\n```\ncurl -X POST http://localhost:9000/test -H \"Content-Type: application/x-www-form-urlencoded\" -d hello --verbose\n```\non the other hand gives\n```\nNote: Unnecessary use of -X or --request, POST is already inferred.\n*   Trying [::1]:9000...\n* connect to ::1 port 9000 failed: Connection refused\n*   Trying 127.0.0.1:9000...\n* Connected to localhost (127.0.0.1) port 9000\n> POST /test HTTP/1.1\n> Host: localhost:9000\n> User-Agent: curl/8.4.0\n> Accept: */*\n> Content-Type: application/x-www-form-urlencoded\n> Content-Length: 5\n> \n< HTTP/1.1 500 Internal Server Error\n< content-type: text/plain; charset=utf-8\n< content-length: 2402\n< \n\n500 - Internal Server Error\n---------------------------\n\nDetails:\n        Error id d1513df2-a061-4b0e-990b-f3b72f260633-1, java.lang.IllegalStateException: Request has already been read\nStack:\n        java.lang.IllegalStateException: Request has already been read\n        at io.vertx.core.http.impl.Http1xServerRequest.checkEnded(Http1xServerRequest.java:733)\n        at io.vertx.core.http.impl.Http1xServerRequest.setExpectMultipart(Http1xServerRequest.java:522)\n        at io.vertx.core.http.impl.HttpServerRequestWrapper.setExpectMultipart(HttpServerRequestWrapper.java:190)\n        at io.vertx.core.http.impl.HttpServerRequestWrapper.setExpectMultipart(HttpServerRequestWrapper.java:190)\n        at io.vertx.ext.web.handler.impl.BodyHandlerImpl$BHandler.<init>(BodyHandlerImpl.java:230)\n        at io.vertx.ext.web.handler.impl.BodyHandlerImpl.handle(BodyHandlerImpl.java:126)\n        at io.vertx.ext.web.handler.impl.BodyHandlerImpl.handle(BodyHandlerImpl.java:45)\n        at io.quarkus.vertx.http.runtime.VertxHttpRecorder$18.handle(VertxHttpRecorder.java:1622)\n        at io.quarkus.vertx.http.runtime.VertxHttpRecorder$18.handle(VertxHttpRecorder.java:1593)\n        at io.vertx.ext.web.impl.RouteState.handleContext(RouteState.java:1283)\n        at io.vertx.ext.web.impl.RoutingContextImplBase.iterateNext(RoutingContextImplBase.java:177)\n        at io.vertx.ext.web.impl.RoutingContextImpl.next(RoutingContextImpl.java:151)\n        at io.quarkus.vertx.http.runtime.devmode.VertxHttpHotReplacementSetup$5.handle(VertxHttpHotReplacementSetup.java:206)\n        at io.quarkus.vertx.http.runtime.devmode.VertxHttpHotReplacementSetup$5.handle(VertxHttpHotReplacementSetup.java:194)\n        at io.vertx.core.impl.future.FutureImpl$4.onSuccess(FutureImpl.java:176)\n        at io.vertx.core.impl.future.FutureBase.lambda$emitSuccess$0(FutureBase.java:60)\n        at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)\n        at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:166)\n        at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)\n        at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)\n        at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998)\n        at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n        at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\n        at java.base/java.lang.Thread.run(Thread.java:1583)\n* Connection #0 to host localhost left intact\n```\n\n\n\n### How to Reproduce?\n\n[quarkus-management-vertx.zip](https://github.com/user-attachments/files/20521971/quarkus-management-vertx.zip)\n\n### Output of `uname -a` or `ver`\n\nDarwin DaMac-J9QVF643HM 23.4.0 Darwin Kernel Version 23.4.0: Wed Feb 21 21:44:54 PST 2024; root:xnu-10063.101.15~2/RELEASE_ARM64_T6030 arm64\n\n### Output of `java -version`\n\nopenjdk version \"22.0.2\" 2024-07-16 OpenJDK Runtime Environment (build 22.0.2+9-70) OpenJDK 64-Bit Server VM (build 22.0.2+9-70, mixed mode, sharing)\n\n### Quarkus version or git rev\n\nreproduced on 3.15, 3.20, 3.23\n\n### Build tool (ie. output of `mvnw --version` or `gradlew --version`)\n\n ------------------------------------------------------------ Gradle 8.13 ------------------------------------------------------------  Build time:    2025-02-25 09:22:14 UTC Revision:      073314332697ba45c16c0a0ce1891fa6794179ff  Kotlin:        2.0.21 Groovy:        3.0.22 Ant:           Apache Ant(TM) version 1.10.15 compiled on August 25 2024 Launcher JVM:  22.0.2 (Oracle Corporation 22.0.2+9-70) Daemon JVM:    /Users/lukas.schmierer/Library/Java/JavaVirtualMachines/openjdk-22.0.2/Contents/Home (no JDK specified, using current Java home) OS:            Mac OS X 14.4 aarch64\n\n### Additional information\n\n_No response_","closed_by":{"login":"geoand","id":4374975,"node_id":"MDQ6VXNlcjQzNzQ5NzU=","avatar_url":"https://avatars.githubusercontent.com/u/4374975?v=4","gravatar_id":"","url":"https://api.github.com/users/geoand","html_url":"https://github.com/geoand","followers_url":"https://api.github.com/users/geoand/followers","following_url":"https://api.github.com/users/geoand/following{/other_user}","gists_url":"https://api.github.com/users/geoand/gists{/gist_id}","starred_url":"https://api.github.com/users/geoand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/geoand/subscriptions","organizations_url":"https://api.github.com/users/geoand/orgs","repos_url":"https://api.github.com/users/geoand/repos","events_url":"https://api.github.com/users/geoand/events{/privacy}","received_events_url":"https://api.github.com/users/geoand/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/quarkusio/quarkus/issues/48151/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/quarkusio/quarkus/issues/48151/timeline","performed_via_github_app":null,"state_reason":"completed"}