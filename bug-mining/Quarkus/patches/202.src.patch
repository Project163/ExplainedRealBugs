diff --git a/extensions/tls-registry/runtime/pom.xml b/extensions/tls-registry/runtime/pom.xml
index d4147418b05..18d5f7c9fa2 100644
--- a/extensions/tls-registry/runtime/pom.xml
+++ b/extensions/tls-registry/runtime/pom.xml
@@ -37,6 +37,17 @@
             <artifactId>vertx-web</artifactId>
             <optional>true</optional>
         </dependency>
+
+        <dependency>
+            <groupId>org.junit.jupiter</groupId>
+            <artifactId>junit-jupiter</artifactId>
+            <scope>test</scope>
+        </dependency>
+        <dependency>
+            <groupId>org.assertj</groupId>
+            <artifactId>assertj-core</artifactId>
+            <scope>test</scope>
+        </dependency>
     </dependencies>
 
     <build>
diff --git a/extensions/tls-registry/runtime/src/main/java/io/quarkus/tls/runtime/JavaxNetSslTrustStoreProvider.java b/extensions/tls-registry/runtime/src/main/java/io/quarkus/tls/runtime/JavaxNetSslTrustStoreProvider.java
index 340d205155f..0ef273e0deb 100644
--- a/extensions/tls-registry/runtime/src/main/java/io/quarkus/tls/runtime/JavaxNetSslTrustStoreProvider.java
+++ b/extensions/tls-registry/runtime/src/main/java/io/quarkus/tls/runtime/JavaxNetSslTrustStoreProvider.java
@@ -6,8 +6,10 @@
 import java.security.NoSuchAlgorithmException;
 import java.security.cert.CertificateException;
 import java.security.cert.X509Certificate;
+import java.util.HashSet;
 import java.util.List;
 import java.util.Locale;
+import java.util.Set;
 import java.util.function.Function;
 
 import javax.naming.InvalidNameException;
@@ -56,27 +58,7 @@ static class JavaNetSslTrustOptions implements TrustOptions {
                 final TrustManagerFactory tmf = TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
                 tmf.init((KeyStore) null);
 
-                final String tsType = System.getProperty("javax.net.ssl.trustStoreType", KeyStore.getDefaultType());
-                final KeyStore cacerts = KeyStore.getInstance(tsType);
-                cacerts.load(null, null);
-                for (TrustManager tm : tmf.getTrustManagers()) {
-                    for (X509Certificate c : ((X509TrustManager) tm).getAcceptedIssuers()) {
-                        final String dn = c.getSubjectX500Principal().getName();
-                        final List<Rdn> rdns = new LdapName(dn).getRdns();
-                        String alias = rdns.stream()
-                                .filter(rdn -> rdn.getType().equalsIgnoreCase("cn"))
-                                .map(rdn -> rdn.getValue().toString())
-                                .findFirst()
-                                .orElseGet(() -> rdns.stream()
-                                        .filter(rdn -> rdn.getType().equalsIgnoreCase("ou"))
-                                        .map(rdn -> rdn.getValue().toString())
-                                        .findFirst()
-                                        .orElseThrow(() -> new IllegalStateException("No CN or OU in " + dn)));
-                        alias = alias.replace(" ", "");
-                        alias = alias.toLowerCase(Locale.ROOT);
-                        cacerts.setCertificateEntry(alias, c);
-                    }
-                }
+                final KeyStore cacerts = copyCerts(tmf);
                 trustManagerFactory = tmf;
                 keystore = cacerts;
             } catch (NoSuchAlgorithmException | KeyStoreException | InvalidNameException | CertificateException
@@ -85,6 +67,43 @@ static class JavaNetSslTrustOptions implements TrustOptions {
             }
         }
 
+        static KeyStore copyCerts(final TrustManagerFactory tmf)
+                throws KeyStoreException, IOException, NoSuchAlgorithmException, CertificateException, InvalidNameException {
+            final String tsType = System.getProperty("javax.net.ssl.trustStoreType", KeyStore.getDefaultType());
+            final KeyStore cacerts = KeyStore.getInstance(tsType);
+            cacerts.load(null, null);
+            final Set<String> aliases = new HashSet<>();
+            for (TrustManager tm : tmf.getTrustManagers()) {
+                for (X509Certificate c : ((X509TrustManager) tm).getAcceptedIssuers()) {
+                    final String dn = c.getSubjectX500Principal().getName();
+                    final List<Rdn> rdns = new LdapName(dn).getRdns();
+                    String alias = rdns.stream()
+                            .filter(rdn -> rdn.getType().equalsIgnoreCase("cn"))
+                            .map(rdn -> rdn.getValue().toString())
+                            .findFirst()
+                            .orElseGet(() -> rdns.stream()
+                                    .filter(rdn -> rdn.getType().equalsIgnoreCase("ou"))
+                                    .map(rdn -> rdn.getValue().toString())
+                                    .findFirst()
+                                    .orElse(dn));
+                    alias = alias.replace(" ", "");
+                    alias = alias.toLowerCase(Locale.ROOT);
+                    if (aliases.contains(alias)) {
+                        /* Make the alias unique if needed */
+                        int i = 1;
+                        String indexedAlias = alias + i;
+                        while (aliases.contains(indexedAlias)) {
+                            indexedAlias = alias + (++i);
+                        }
+                        alias = indexedAlias;
+                    }
+                    aliases.add(alias);
+                    cacerts.setCertificateEntry(alias, c);
+                }
+            }
+            return cacerts;
+        }
+
         @Override
         public Function<String, TrustManager[]> trustManagerMapper(Vertx vertx) throws Exception {
             if (helper == null) {
diff --git a/extensions/tls-registry/runtime/src/test/java/io/quarkus/tls/runtime/JavaxNetSslTrustStoreProviderTest.java b/extensions/tls-registry/runtime/src/test/java/io/quarkus/tls/runtime/JavaxNetSslTrustStoreProviderTest.java
new file mode 100644
index 00000000000..e1eedb46491
--- /dev/null
+++ b/extensions/tls-registry/runtime/src/test/java/io/quarkus/tls/runtime/JavaxNetSslTrustStoreProviderTest.java
@@ -0,0 +1,33 @@
+package io.quarkus.tls.runtime;
+
+import java.io.IOException;
+import java.io.InputStream;
+import java.security.KeyStore;
+import java.security.KeyStoreException;
+import java.security.NoSuchAlgorithmException;
+import java.security.cert.CertificateException;
+
+import javax.naming.InvalidNameException;
+import javax.net.ssl.TrustManagerFactory;
+
+import org.assertj.core.api.Assertions;
+import org.junit.jupiter.api.Test;
+
+import io.quarkus.tls.runtime.JavaxNetSslTrustStoreProvider.JavaNetSslTrustOptions;
+
+public class JavaxNetSslTrustStoreProviderTest {
+
+    @Test
+    void copyCerts()
+            throws NoSuchAlgorithmException, KeyStoreException, IOException, CertificateException, InvalidNameException {
+        final TrustManagerFactory tmf = TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
+        KeyStore ks = KeyStore.getInstance("JKS");
+        try (InputStream in = getClass().getClassLoader().getResourceAsStream("JavaxNetSslTrustStoreProviderTest.jks")) {
+            ks.load(in, "changeit".toCharArray());
+        }
+        Assertions.assertThat(ks.size()).isGreaterThan(0);
+        tmf.init(ks);
+        final KeyStore cacerts = JavaNetSslTrustOptions.copyCerts(tmf);
+        Assertions.assertThat(cacerts.size()).isEqualTo(ks.size());
+    }
+}
diff --git a/extensions/tls-registry/runtime/src/test/resources/JavaxNetSslTrustStoreProviderTest.jks b/extensions/tls-registry/runtime/src/test/resources/JavaxNetSslTrustStoreProviderTest.jks
new file mode 100644
index 00000000000..fa17a264627
Binary files /dev/null and b/extensions/tls-registry/runtime/src/test/resources/JavaxNetSslTrustStoreProviderTest.jks differ
