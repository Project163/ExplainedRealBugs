diff --git a/core/deployment/src/main/java/io/quarkus/deployment/pkg/jar/AbstractJarBuilder.java b/core/deployment/src/main/java/io/quarkus/deployment/pkg/jar/AbstractJarBuilder.java
index d06dcf01f72..6aafbea25f0 100644
--- a/core/deployment/src/main/java/io/quarkus/deployment/pkg/jar/AbstractJarBuilder.java
+++ b/core/deployment/src/main/java/io/quarkus/deployment/pkg/jar/AbstractJarBuilder.java
@@ -13,6 +13,7 @@
 import java.util.Map.Entry;
 import java.util.Optional;
 import java.util.Set;
+import java.util.TreeMap;
 import java.util.function.Predicate;
 import java.util.jar.Attributes;
 import java.util.jar.Manifest;
@@ -105,6 +106,7 @@ protected static void copyFiles(ApplicationArchive archive, ArchiveCreator archi
             Map<String, List<byte[]>> services,
             Predicate<String> ignoredEntriesPredicate) throws IOException {
         try {
+            Map<String, Path> pathsToCopy = new TreeMap<>();
             archive.accept(tree -> {
                 tree.walk(new PathVisitor() {
                     @Override
@@ -114,32 +116,35 @@ public void visitPath(PathVisit visit) {
                         if (relativePath.isEmpty() || ignoredEntriesPredicate.test(relativePath)) {
                             return;
                         }
-                        try {
-                            if (Files.isDirectory(visit.getPath())) {
-                                archiveCreator.addDirectory(relativePath);
-                            } else {
-                                if (relativePath.startsWith("META-INF/services/") && relativePath.length() > 18
-                                        && services != null) {
-                                    final byte[] content;
-                                    try {
-                                        content = Files.readAllBytes(visit.getPath());
-                                    } catch (IOException e) {
-                                        throw new UncheckedIOException(e);
-                                    }
-                                    services.computeIfAbsent(relativePath, (u) -> new ArrayList<>()).add(content);
-                                } else if (!relativePath.equals("META-INF/INDEX.LIST")) {
-                                    //TODO: auto generate INDEX.LIST
-                                    //this may have implications for Camel though, as they change the layout
-                                    //also this is only really relevant for the thin jar layout
-                                    archiveCreator.addFileIfNotExists(visit.getPath(), relativePath);
+                        if (Files.isDirectory(visit.getPath())) {
+                            pathsToCopy.put(relativePath, visit.getPath());
+                        } else {
+                            if (relativePath.startsWith("META-INF/services/") && relativePath.length() > 18
+                                    && services != null) {
+                                final byte[] content;
+                                try {
+                                    content = Files.readAllBytes(visit.getPath());
+                                } catch (IOException e) {
+                                    throw new UncheckedIOException(e);
                                 }
+                                services.computeIfAbsent(relativePath, (u) -> new ArrayList<>()).add(content);
+                            } else if (!relativePath.equals("META-INF/INDEX.LIST")) {
+                                //TODO: auto generate INDEX.LIST
+                                //this may have implications for Camel though, as they change the layout
+                                //also this is only really relevant for the thin jar layout
+                                pathsToCopy.put(relativePath, visit.getPath());
                             }
-                        } catch (IOException e) {
-                            throw new UncheckedIOException(e);
                         }
                     }
                 });
             });
+            for (Entry<String, Path> pathEntry : pathsToCopy.entrySet()) {
+                if (Files.isDirectory(pathEntry.getValue())) {
+                    archiveCreator.addDirectory(pathEntry.getKey());
+                } else {
+                    archiveCreator.addFileIfNotExists(pathEntry.getValue(), pathEntry.getKey());
+                }
+            }
         } catch (RuntimeException re) {
             final Throwable cause = re.getCause();
             if (cause instanceof IOException) {
