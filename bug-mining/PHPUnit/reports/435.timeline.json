[{"id":5331546,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDUzMzE1NDY=","url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/events/5331546","actor":{"login":"sebastianbergmann","id":25218,"node_id":"MDQ6VXNlcjI1MjE4","avatar_url":"https://avatars.githubusercontent.com/u/25218?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianbergmann","html_url":"https://github.com/sebastianbergmann","followers_url":"https://api.github.com/users/sebastianbergmann/followers","following_url":"https://api.github.com/users/sebastianbergmann/following{/other_user}","gists_url":"https://api.github.com/users/sebastianbergmann/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianbergmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianbergmann/subscriptions","organizations_url":"https://api.github.com/users/sebastianbergmann/orgs","repos_url":"https://api.github.com/users/sebastianbergmann/repos","events_url":"https://api.github.com/users/sebastianbergmann/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianbergmann/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2011-11-12T08:41:20Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/comments/2729273","html_url":"https://github.com/sebastianbergmann/phpunit/issues/406#issuecomment-2729273","issue_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/406","id":2729273,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MjkyNzM=","user":{"login":"edorian","id":247397,"node_id":"MDQ6VXNlcjI0NzM5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/247397?v=4","gravatar_id":"","url":"https://api.github.com/users/edorian","html_url":"https://github.com/edorian","followers_url":"https://api.github.com/users/edorian/followers","following_url":"https://api.github.com/users/edorian/following{/other_user}","gists_url":"https://api.github.com/users/edorian/gists{/gist_id}","starred_url":"https://api.github.com/users/edorian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edorian/subscriptions","organizations_url":"https://api.github.com/users/edorian/orgs","repos_url":"https://api.github.com/users/edorian/repos","events_url":"https://api.github.com/users/edorian/events{/privacy}","received_events_url":"https://api.github.com/users/edorian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2011-11-14T11:21:28Z","updated_at":"2011-11-14T11:21:28Z","body":"I'm not quite sure that this is the way to go here but thats my current progress.\n\nI can't get the test to work properly (not really a clue why) but thats the current status. If this should be solved somewhere else let me know :)\n\n```\n--- a/PHPUnit/Framework/Constraint.php\n+++ b/PHPUnit/Framework/Constraint.php\n@@ -129,9 +129,10 @@ abstract class PHPUnit_Framework_Constraint implements Countable, PHPUnit_Framew\n     protected function fail($other, $description, PHPUnit_Framework_ComparisonFailure $comparisonFailure = NULL)\n     {\n         $failureDescription = sprintf(\n-          'Failed asserting that %s.',\n+          'Failed asserting that %s.%s',\n\n-          $this->failureDescription($other)\n+          $this->failureDescription($other),\n+          $this->additionalFailureDescription($other)\n         );\n\n         if (!empty($description)) {\n@@ -157,4 +158,18 @@ abstract class PHPUnit_Framework_Constraint implements Countable, PHPUnit_Framew\n     {\n         return PHPUnit_Util_Type::export($other) . ' ' . $this->toString();\n     }\n+\n+    /**\n+     * Return additional failure description where needed\n+     *\n+     * The function can be overritten to provide additional failure \n+     * information like a diff\n+     *\n+     * @param  mixed $other Evaluated value or object.\n+     * @return string\n+     */\n+    protected function additionalFailureDescription($other)\n+    {\n+        return \"\";\n+    }\n }\ndiff --git a/PHPUnit/Framework/Constraint/StringMatches.php b/PHPUnit/Framework/Constraint/StringMatches.php\nindex c77664d..8953ba7 100644\n--- a/PHPUnit/Framework/Constraint/StringMatches.php\n+++ b/PHPUnit/Framework/Constraint/StringMatches.php\n@@ -103,4 +103,13 @@ class PHPUnit_Framework_Constraint_StringMatches extends PHPUnit_Framework_Const\n         $this->pattern = '/^' . $this->pattern . '$/s';\n         $this->string  = $string;\n     }\n+\n+    protected function failureDescription($other) \n+    {\n+        return \"format description matches text\";\n+    }\n+\n+    protected function additionalFailureDescription($other) {\n+        return \"\\n\" . PHPUnit_Util_Diff::diff($this->string, $other);\n+    }\n }\n```\n\n---\n\n and for the regression test\n\n```\n--TEST--\nGH-406: Failure description for assertStringMatchesFormatExpected is unreadable \n--FILE--\n<?php\ndefine('PHPUNIT_TESTSUITE', TRUE);\n\n$_SERVER['argv'][1] = '--no-configuration';\n$_SERVER['argv'][3] = 'Issue406Test';\n$_SERVER['argv'][4] = dirname(__FILE__).'/406/Issue406Test.php';\n\nrequire_once dirname(dirname(dirname(dirname(__FILE__)))) . '/PHPUnit/Autoload.php';\nPHPUnit_TextUI_Command::main();\n?>\n--EXPECTF--\nPHPUnit %s by Sebastian Bergmann.\n\nF\n\nTime: %i %s, Memory: %sMb\n\nThere was 1 failure:\n\n1) Issue406Test::testStringMatchesFormatFileProducesNiceFailureOutput\nFailed asserting that format description matches text.\n--- Expected\n+++ Actual\n@@ @@\n-%sFOO%d\n-\n+...BAR...\n\n\n%s:%i\n\nFAILURES!\nTests: 1, Assertions: 2, Failures: 1.\n```\n\n---\n\nTests/Regression/GitHub/406/issue406expected.txt \n\n```\n%sFOO%d\n```\n\n---\n\nTests/Regression/GitHub/406/Issue406Test.php \n\n```\n<?php\n\nclass Issue406Test extends PHPUnit_Framework_TestCase {\n\n    public function testStringMatchesFormatFileProducesNiceFailureOutput() {\n        $this->assertStringMatchesFormatFile(dirname(__FILE__) . '/issue406expected.txt', '...BAR...');\n    }\n\n}\n```\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/comments/2729273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"edorian","id":247397,"node_id":"MDQ6VXNlcjI0NzM5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/247397?v=4","gravatar_id":"","url":"https://api.github.com/users/edorian","html_url":"https://github.com/edorian","followers_url":"https://api.github.com/users/edorian/followers","following_url":"https://api.github.com/users/edorian/following{/other_user}","gists_url":"https://api.github.com/users/edorian/gists{/gist_id}","starred_url":"https://api.github.com/users/edorian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edorian/subscriptions","organizations_url":"https://api.github.com/users/edorian/orgs","repos_url":"https://api.github.com/users/edorian/repos","events_url":"https://api.github.com/users/edorian/events{/privacy}","received_events_url":"https://api.github.com/users/edorian/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":5376313,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDUzNzYzMTM=","url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/events/5376313","actor":{"login":"edorian","id":247397,"node_id":"MDQ6VXNlcjI0NzM5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/247397?v=4","gravatar_id":"","url":"https://api.github.com/users/edorian","html_url":"https://github.com/edorian","followers_url":"https://api.github.com/users/edorian/followers","following_url":"https://api.github.com/users/edorian/following{/other_user}","gists_url":"https://api.github.com/users/edorian/gists{/gist_id}","starred_url":"https://api.github.com/users/edorian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edorian/subscriptions","organizations_url":"https://api.github.com/users/edorian/orgs","repos_url":"https://api.github.com/users/edorian/repos","events_url":"https://api.github.com/users/edorian/events{/privacy}","received_events_url":"https://api.github.com/users/edorian/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2011-11-14T11:21:28Z","performed_via_github_app":null},{"id":6793745,"node_id":"MDExOkNsb3NlZEV2ZW50Njc5Mzc0NQ==","url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/events/6793745","actor":{"login":"edorian","id":247397,"node_id":"MDQ6VXNlcjI0NzM5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/247397?v=4","gravatar_id":"","url":"https://api.github.com/users/edorian","html_url":"https://github.com/edorian","followers_url":"https://api.github.com/users/edorian/followers","following_url":"https://api.github.com/users/edorian/following{/other_user}","gists_url":"https://api.github.com/users/edorian/gists{/gist_id}","starred_url":"https://api.github.com/users/edorian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edorian/subscriptions","organizations_url":"https://api.github.com/users/edorian/orgs","repos_url":"https://api.github.com/users/edorian/repos","events_url":"https://api.github.com/users/edorian/events{/privacy}","received_events_url":"https://api.github.com/users/edorian/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"1d7f69e75a85fbdfc20f9fff34b3e3aebe269430","commit_url":"https://api.github.com/repos/sebastianbergmann/phpunit/commits/1d7f69e75a85fbdfc20f9fff34b3e3aebe269430","created_at":"2011-12-15T18:22:23Z","state_reason":null,"performed_via_github_app":null},{"id":6807012,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDY4MDcwMTI=","url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/events/6807012","actor":{"login":"edorian","id":247397,"node_id":"MDQ6VXNlcjI0NzM5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/247397?v=4","gravatar_id":"","url":"https://api.github.com/users/edorian","html_url":"https://github.com/edorian","followers_url":"https://api.github.com/users/edorian/followers","following_url":"https://api.github.com/users/edorian/following{/other_user}","gists_url":"https://api.github.com/users/edorian/gists{/gist_id}","starred_url":"https://api.github.com/users/edorian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edorian/subscriptions","organizations_url":"https://api.github.com/users/edorian/orgs","repos_url":"https://api.github.com/users/edorian/repos","events_url":"https://api.github.com/users/edorian/events{/privacy}","received_events_url":"https://api.github.com/users/edorian/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"500a71891e21747b749875a33a6ea063d9a0e812","commit_url":"https://api.github.com/repos/sebastianbergmann/phpunit/commits/500a71891e21747b749875a33a6ea063d9a0e812","created_at":"2011-12-15T22:16:07Z","performed_via_github_app":null},{"id":6807131,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDY4MDcxMzE=","url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/events/6807131","actor":{"login":"edorian","id":247397,"node_id":"MDQ6VXNlcjI0NzM5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/247397?v=4","gravatar_id":"","url":"https://api.github.com/users/edorian","html_url":"https://github.com/edorian","followers_url":"https://api.github.com/users/edorian/followers","following_url":"https://api.github.com/users/edorian/following{/other_user}","gists_url":"https://api.github.com/users/edorian/gists{/gist_id}","starred_url":"https://api.github.com/users/edorian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edorian/subscriptions","organizations_url":"https://api.github.com/users/edorian/orgs","repos_url":"https://api.github.com/users/edorian/repos","events_url":"https://api.github.com/users/edorian/events{/privacy}","received_events_url":"https://api.github.com/users/edorian/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"81d68fa1edae25b3f646df323b28e6e07939c5cf","commit_url":"https://api.github.com/repos/sebastianbergmann/phpunit/commits/81d68fa1edae25b3f646df323b28e6e07939c5cf","created_at":"2011-12-15T22:18:08Z","performed_via_github_app":null},{"id":1616392036,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDE2MTYzOTIwMzY=","url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/events/1616392036","actor":{"login":"axiac","id":1086598,"node_id":"MDQ6VXNlcjEwODY1OTg=","avatar_url":"https://avatars.githubusercontent.com/u/1086598?v=4","gravatar_id":"","url":"https://api.github.com/users/axiac","html_url":"https://github.com/axiac","followers_url":"https://api.github.com/users/axiac/followers","following_url":"https://api.github.com/users/axiac/following{/other_user}","gists_url":"https://api.github.com/users/axiac/gists{/gist_id}","starred_url":"https://api.github.com/users/axiac/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/axiac/subscriptions","organizations_url":"https://api.github.com/users/axiac/orgs","repos_url":"https://api.github.com/users/axiac/repos","events_url":"https://api.github.com/users/axiac/events{/privacy}","received_events_url":"https://api.github.com/users/axiac/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"faa26605b9a7e81f4f545bd87cbe8223e55144d2","commit_url":"https://api.github.com/repos/axiac/phpunit/commits/faa26605b9a7e81f4f545bd87cbe8223e55144d2","created_at":"2018-05-08T22:10:31Z","performed_via_github_app":null}]