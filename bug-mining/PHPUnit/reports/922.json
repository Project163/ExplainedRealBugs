{"url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/6133","repository_url":"https://api.github.com/repos/sebastianbergmann/phpunit","labels_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/6133/labels{/name}","comments_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/6133/comments","events_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/6133/events","html_url":"https://github.com/sebastianbergmann/phpunit/issues/6133","id":2858190638,"node_id":"I_kwDOAAbWLc6qXIcu","number":6133,"title":"Precision loss in aggregated test suite execution time(s) reported by JUnit XML logger","user":{"login":"niconoe-","id":9560327,"node_id":"MDQ6VXNlcjk1NjAzMjc=","avatar_url":"https://avatars.githubusercontent.com/u/9560327?v=4","gravatar_id":"","url":"https://api.github.com/users/niconoe-","html_url":"https://github.com/niconoe-","followers_url":"https://api.github.com/users/niconoe-/followers","following_url":"https://api.github.com/users/niconoe-/following{/other_user}","gists_url":"https://api.github.com/users/niconoe-/gists{/gist_id}","starred_url":"https://api.github.com/users/niconoe-/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/niconoe-/subscriptions","organizations_url":"https://api.github.com/users/niconoe-/orgs","repos_url":"https://api.github.com/users/niconoe-/repos","events_url":"https://api.github.com/users/niconoe-/events{/privacy}","received_events_url":"https://api.github.com/users/niconoe-/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":44001,"node_id":"MDU6TGFiZWw0NDAwMQ==","url":"https://api.github.com/repos/sebastianbergmann/phpunit/labels/type/bug","name":"type/bug","color":"cc0000","default":false,"description":"Something is broken"},{"id":7573337865,"node_id":"LA_kwDOAAbWLc8AAAABw2f3CQ","url":"https://api.github.com/repos/sebastianbergmann/phpunit/labels/version/12","name":"version/12","color":"888a85","default":false,"description":"Something affects PHPUnit 12"},{"id":8052990377,"node_id":"LA_kwDOAAbWLc8AAAAB3_7hqQ","url":"https://api.github.com/repos/sebastianbergmann/phpunit/labels/feature/logging/junit","name":"feature/logging/junit","color":"e9b96e","default":false,"description":"Issues related to logging test results in JUnit XML format"}],"state":"closed","locked":false,"assignee":{"login":"sebastianbergmann","id":25218,"node_id":"MDQ6VXNlcjI1MjE4","avatar_url":"https://avatars.githubusercontent.com/u/25218?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianbergmann","html_url":"https://github.com/sebastianbergmann","followers_url":"https://api.github.com/users/sebastianbergmann/followers","following_url":"https://api.github.com/users/sebastianbergmann/following{/other_user}","gists_url":"https://api.github.com/users/sebastianbergmann/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianbergmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianbergmann/subscriptions","organizations_url":"https://api.github.com/users/sebastianbergmann/orgs","repos_url":"https://api.github.com/users/sebastianbergmann/repos","events_url":"https://api.github.com/users/sebastianbergmann/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianbergmann/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"sebastianbergmann","id":25218,"node_id":"MDQ6VXNlcjI1MjE4","avatar_url":"https://avatars.githubusercontent.com/u/25218?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianbergmann","html_url":"https://github.com/sebastianbergmann","followers_url":"https://api.github.com/users/sebastianbergmann/followers","following_url":"https://api.github.com/users/sebastianbergmann/following{/other_user}","gists_url":"https://api.github.com/users/sebastianbergmann/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianbergmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianbergmann/subscriptions","organizations_url":"https://api.github.com/users/sebastianbergmann/orgs","repos_url":"https://api.github.com/users/sebastianbergmann/repos","events_url":"https://api.github.com/users/sebastianbergmann/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianbergmann/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":1,"created_at":"2025-02-17T15:38:35Z","updated_at":"2025-02-17T16:42:24Z","closed_at":"2025-02-17T16:03:48Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"| Q                   | A\n| --------------------| ---------------\n| PHPUnit version     | >= 12.0.0\n| PHP version         | 8.3.* or 8.4.*\n| Installation Method | Composer\n\n#### Summary\n\nSince PHPUnit 12, the execution time of testsuites has been truncated as integers (seconds), which makes losing the precision. For extra processing like summing or averaging using the JUnit report, this causes wrong calculation or worse: division by zero on averages calculations.\n\n#### Current behavior\n\nIn the JUnit report in XML since PHPUnit 12, on <testsuite> tags, the `time` attribute is cast as an integer (even if displayed as a float).\n\n#### How to reproduce\n\nJust run a test suite and look at the JUnit report.\n\n#### Expected behavior\n\nThe expected behavior is to keep the highest possible precision on filling the `time` attribute, and not losing the milliseconds.\n\n#### Additional information\n\nI think the issue is coming from the additional cast into an integer of the `$time` variable here:\n\nhttps://github.com/sebastianbergmann/phpunit/blob/6301fe5c1f5f34192ffd650a87fe055677a32212/src/Logging/JUnit/JunitXmlLogger.php#L288\n\nComparing to the latest v11, where there is no cast:\n\nhttps://github.com/sebastianbergmann/phpunit/blob/e1cb706f019e2547039ca2c839898cd5f557ee5d/src/Logging/JUnit/JunitXmlLogger.php#L288\n\nI don't know if there is any other implications about removing the cast (PHPStan / Psalm / unit tests / infectionsâ€¦) so I'm not sure I can provide a PR and take care about it. If that's really as simple as removing the cast and no implication so far, I can do it.\n\n\n","closed_by":{"login":"sebastianbergmann","id":25218,"node_id":"MDQ6VXNlcjI1MjE4","avatar_url":"https://avatars.githubusercontent.com/u/25218?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianbergmann","html_url":"https://github.com/sebastianbergmann","followers_url":"https://api.github.com/users/sebastianbergmann/followers","following_url":"https://api.github.com/users/sebastianbergmann/following{/other_user}","gists_url":"https://api.github.com/users/sebastianbergmann/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianbergmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianbergmann/subscriptions","organizations_url":"https://api.github.com/users/sebastianbergmann/orgs","repos_url":"https://api.github.com/users/sebastianbergmann/repos","events_url":"https://api.github.com/users/sebastianbergmann/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianbergmann/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/6133/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/6133/timeline","performed_via_github_app":null,"state_reason":"completed"}