{"url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/5640","repository_url":"https://api.github.com/repos/sebastianbergmann/phpunit","labels_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/5640/labels{/name}","comments_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/5640/comments","events_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/5640/events","html_url":"https://github.com/sebastianbergmann/phpunit/issues/5640","id":2062364108,"node_id":"I_kwDOAAbWLc567S3M","number":5640,"title":"`#[Small]`, `#[Medium]`, `#[Large]` aren't proper aliases for `#[Group('small')]` and so on","user":{"login":"fluffycondor","id":62219548,"node_id":"MDQ6VXNlcjYyMjE5NTQ4","avatar_url":"https://avatars.githubusercontent.com/u/62219548?v=4","gravatar_id":"","url":"https://api.github.com/users/fluffycondor","html_url":"https://github.com/fluffycondor","followers_url":"https://api.github.com/users/fluffycondor/followers","following_url":"https://api.github.com/users/fluffycondor/following{/other_user}","gists_url":"https://api.github.com/users/fluffycondor/gists{/gist_id}","starred_url":"https://api.github.com/users/fluffycondor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fluffycondor/subscriptions","organizations_url":"https://api.github.com/users/fluffycondor/orgs","repos_url":"https://api.github.com/users/fluffycondor/repos","events_url":"https://api.github.com/users/fluffycondor/events{/privacy}","received_events_url":"https://api.github.com/users/fluffycondor/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":44001,"node_id":"MDU6TGFiZWw0NDAwMQ==","url":"https://api.github.com/repos/sebastianbergmann/phpunit/labels/type/bug","name":"type/bug","color":"cc0000","default":false,"description":"Something is broken"},{"id":1329317012,"node_id":"MDU6TGFiZWwxMzI5MzE3MDEy","url":"https://api.github.com/repos/sebastianbergmann/phpunit/labels/feature/test-runner","name":"feature/test-runner","color":"e9b96e","default":false,"description":"CLI test runner"},{"id":5111411238,"node_id":"LA_kwDOAAbWLc8AAAABMKnyJg","url":"https://api.github.com/repos/sebastianbergmann/phpunit/labels/version/10","name":"version/10","color":"888a85","default":false,"description":"Something affects PHPUnit 10"},{"id":5111424008,"node_id":"LA_kwDOAAbWLc8AAAABMKokCA","url":"https://api.github.com/repos/sebastianbergmann/phpunit/labels/feature/metadata/attributes","name":"feature/metadata/attributes","color":"e9b96e","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2024-01-02T12:38:21Z","updated_at":"2024-01-17T08:03:58Z","closed_at":"2024-01-17T08:03:58Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"| Q                   | A\r\n| --------------------| ---------------\r\n| PHPUnit version     | 10.5.5\r\n| PHP version         | 8.2.14\r\n| Installation Method | Composer\r\n\r\n```\r\ncomposer info | sort\r\namphp/amp                             v2.6.2    A non-blocking concurrency framework for PHP applications.\r\namphp/byte-stream                     v1.8.1    A stream abstraction to make working with non-blocking I/O simple.\r\ncomposer/package-versions-deprecated  1.11.99.5 Composer plugin that provides efficient querying for installed package versions (no runtime IO)\r\ncomposer/pcre                         3.1.1     PCRE wrapping library that offers type-safe preg_* replacements.\r\ncomposer/semver                       3.4.0     Semver library that offers utilities, version constraint parsing and validation.\r\ncomposer/xdebug-handler               3.0.3     Restarts a process without Xdebug.\r\ndnoegel/php-xdg-base-dir              v0.1.1    implementation of xdg base directory specification for php\r\ndoctrine/deprecations                 1.1.2     A small layer on top of trigger_error(E_USER_DEPRECATED) or PSR-3 logging with options to disable ...   \r\nfelixfbecker/advanced-json-rpc        v3.2.1    A more advanced JSONRPC implementation\r\nfelixfbecker/language-server-protocol v1.5.2    PHP classes for the Language Server Protocol\r\nfidry/cpu-core-counter                1.0.0     Tiny utility to get the number of CPU cores.\r\nmyclabs/deep-copy                     1.11.1    Create deep copies (clones) of your objects\r\nnetresearch/jsonmapper                v4.2.0    Map nested JSON structures onto PHP classes\r\nnikic/php-parser                      v4.18.0   A PHP parser written in PHP\r\nphar-io/manifest                      2.0.3     Component for reading phar.io manifest information from a PHP Archive (PHAR)\r\nphar-io/version                       3.2.1     Library for handling version information and constraints\r\nphpdocumentor/reflection-common       2.2.0     Common reflection classes used by phpdocumentor to reflect the code structure\r\nphpdocumentor/reflection-docblock     5.3.0     With this component, a library can provide support for annotations via DocBlocks or otherwise retr...   \r\nphpdocumentor/type-resolver           1.7.3     A PSR-5 based resolver of Class names, Types and Structural Element Names\r\nphpstan/phpdoc-parser                 1.24.5    PHPDoc parser with support for nullable, intersection and generic types\r\nphpstan/phpstan                       1.10.50   PHPStan - PHP Static Analysis Tool\r\nphpstan/phpstan-phpunit               1.3.15    PHPUnit extensions and rules for PHPStan\r\nphpstan/phpstan-strict-rules          1.5.2     Extra strict and opinionated rules for PHPStan\r\nphpunit/php-code-coverage             10.1.11   Library that provides collection, processing, and rendering functionality for PHP code coverage in...   \r\nphpunit/php-file-iterator             4.1.0     FilterIterator implementation that filters files based on a list of suffixes.\r\nphpunit/php-invoker                   4.0.0     Invoke callables with a timeout\r\nphpunit/php-text-template             3.0.1     Simple template engine.\r\nphpunit/php-timer                     6.0.0     Utility class for timing\r\nphpunit/phpunit                       10.5.5    The PHP Unit Testing framework.\r\npsalm/plugin-phpunit                  0.18.4    Psalm plugin for PHPUnit\r\npsr/container                         2.0.2     Common Container Interface (PHP FIG PSR-11)\r\npsr/log                               3.0.0     Common interface for logging libraries\r\nsebastian/cli-parser                  2.0.0     Library for parsing CLI options\r\nsebastian/code-unit                   2.0.0     Collection of value objects that represent the PHP code units\r\nsebastian/code-unit-reverse-lookup    3.0.0     Looks up which function or method a line of code belongs to\r\nsebastian/comparator                  5.0.1     Provides the functionality to compare PHP values for equality\r\nsebastian/complexity                  3.2.0     Library for calculating the complexity of PHP code units\r\nsebastian/diff                        5.1.0     Diff implementation\r\nsebastian/environment                 6.0.1     Provides functionality to handle HHVM/PHP environments\r\nsebastian/exporter                    5.1.1     Provides the functionality to export PHP variables for visualization\r\nsebastian/global-state                6.0.1     Snapshotting of global state\r\nsebastian/lines-of-code               2.0.2     Library for counting the lines of code in PHP source code\r\nsebastian/object-enumerator           5.0.0     Traverses array structures and object graphs to enumerate all referenced objects\r\nsebastian/object-reflector            3.0.0     Allows reflection of object attributes, including inherited and non-public ones\r\nsebastian/recursion-context           5.0.0     Provides functionality to recursively process PHP variables\r\nsebastian/type                        4.0.0     Collection of value objects that represent the types of the PHP type system\r\nsebastian/version                     4.0.1     Library that helps with managing the version number of Git-hosted PHP projects\r\nspatie/array-to-xml                   3.2.2     Convert an array to xml\r\nsymfony/console                       v7.0.2    Eases the creation of beautiful and testable command line interfaces\r\nsymfony/filesystem                    v7.0.0    Provides basic utilities for the filesystem\r\nsymfony/polyfill-ctype                v1.28.0   Symfony polyfill for ctype functions\r\nsymfony/polyfill-intl-grapheme        v1.28.0   Symfony polyfill for intl's grapheme_* functions\r\nsymfony/polyfill-intl-normalizer      v1.28.0   Symfony polyfill for intl's Normalizer class and related functions\r\nsymfony/polyfill-mbstring             v1.28.0   Symfony polyfill for the Mbstring extension\r\nsymfony/service-contracts             v3.4.1    Generic abstractions related to writing services\r\nsymfony/string                        v7.0.2    Provides an object-oriented API to strings and deals with bytes, UTF-8 code points and grapheme cl...   \r\ntheseer/tokenizer                     1.2.2     A small library for converting tokenized PHP source code into XML and potentially other formats\r\nvimeo/psalm                           5.18.0    A static analysis tool for finding errors in PHP applications\r\nwebmozart/assert                      1.11.0    Assertions to validate method input/output with nice error messages.\r\n```\r\n\r\n#### Summary\r\n\r\nThe documentation says that \"The Small attribute is an alias for Group('small').\" and so on. But `#[Group]` have `Attribute::TARGET_METHOD` flag, while any of those three aliases doesn't. So I can put `#[Group('small')]` over my test method, but I can't do the same with `#[Small]`. Looks like an issue to me.\r\n\r\nAnd the second issue there's no any warning while running tests with `#[Small]`, `#[Medium]`, `#[Large]` annontation if the pcntl extension isn't installed.\r\nIf one runs PHPUnit with --enforce-time-limit and no pcntl, they see the proper warning, so they know something is wrong with their environment. But if one put any of those annonations over their tests without proper understanding that they need to install pcntl and enforce time limits in the config or with an argument, there won't be any warnings. It can give one a false sense of security that PHPUnit takes care about test time limits, while it actually doesn't.\r\nI think using `#[Small]`, `#[Medium]`, `#[Large]` without having pcntl extension installed should lead to a warning, or marking such tests risky unconditionally.\r\n\r\nAlso the documentation isn't quite clear if the time limit is enforced for a test method or the whole test class, in my opinion.\r\n\r\n#### Current behavior\r\n\r\nPHPUnit doesn't allow to use `#[Small]`, `#[Medium]`, `#[Large]` over test methods, while `#[Group('small')]` can be used as such.   \r\nThere aren't any warnings that time limits aren't enforced just by applying those annotations.\r\n\r\n#### How to reproduce\r\n\r\nApply any of `#[Small]`, `#[Medium]`, `#[Large]` to a test method.\r\n\r\n#### Expected behavior\r\n\r\n`#[Small]`, `#[Medium]`, `#[Large]` should be allowed over methods, as `#[Group]` does.\r\nPreferably there may be a warning that time limits aren't enforced without explicitly enabling those and installing pcntl, or PHPUnit may mark such tests as risky uncoditionally.\r\n","closed_by":{"login":"sebastianbergmann","id":25218,"node_id":"MDQ6VXNlcjI1MjE4","avatar_url":"https://avatars.githubusercontent.com/u/25218?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianbergmann","html_url":"https://github.com/sebastianbergmann","followers_url":"https://api.github.com/users/sebastianbergmann/followers","following_url":"https://api.github.com/users/sebastianbergmann/following{/other_user}","gists_url":"https://api.github.com/users/sebastianbergmann/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianbergmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianbergmann/subscriptions","organizations_url":"https://api.github.com/users/sebastianbergmann/orgs","repos_url":"https://api.github.com/users/sebastianbergmann/repos","events_url":"https://api.github.com/users/sebastianbergmann/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianbergmann/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/5640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/5640/timeline","performed_via_github_app":null,"state_reason":"completed"}