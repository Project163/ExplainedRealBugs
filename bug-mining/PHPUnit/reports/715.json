{"url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/4618","repository_url":"https://api.github.com/repos/sebastianbergmann/phpunit","labels_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/4618/labels{/name}","comments_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/4618/comments","events_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/4618/events","html_url":"https://github.com/sebastianbergmann/phpunit/issues/4618","id":827284578,"node_id":"MDU6SXNzdWU4MjcyODQ1Nzg=","number":4618,"title":"Support for generators in assertCount() etc. is not marked as deprecated in PHPUnit 9.6","user":{"login":"eigan","id":41789,"node_id":"MDQ6VXNlcjQxNzg5","avatar_url":"https://avatars.githubusercontent.com/u/41789?v=4","gravatar_id":"","url":"https://api.github.com/users/eigan","html_url":"https://github.com/eigan","followers_url":"https://api.github.com/users/eigan/followers","following_url":"https://api.github.com/users/eigan/following{/other_user}","gists_url":"https://api.github.com/users/eigan/gists{/gist_id}","starred_url":"https://api.github.com/users/eigan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eigan/subscriptions","organizations_url":"https://api.github.com/users/eigan/orgs","repos_url":"https://api.github.com/users/eigan/repos","events_url":"https://api.github.com/users/eigan/events{/privacy}","received_events_url":"https://api.github.com/users/eigan/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":44001,"node_id":"MDU6TGFiZWw0NDAwMQ==","url":"https://api.github.com/repos/sebastianbergmann/phpunit/labels/type/bug","name":"type/bug","color":"cc0000","default":false,"description":"Something is broken"},{"id":1842312450,"node_id":"MDU6TGFiZWwxODQyMzEyNDUw","url":"https://api.github.com/repos/sebastianbergmann/phpunit/labels/feature/assertion","name":"feature/assertion","color":"e9b96e","default":false,"description":"Issues related to assertions and expectations"},{"id":1842571191,"node_id":"MDU6TGFiZWwxODQyNTcxMTkx","url":"https://api.github.com/repos/sebastianbergmann/phpunit/labels/type/deprecation","name":"type/deprecation","color":"cc0000","default":false,"description":"Something will be/is deprecated"},{"id":5111410650,"node_id":"LA_kwDOAAbWLc8AAAABMKnv2g","url":"https://api.github.com/repos/sebastianbergmann/phpunit/labels/version/9","name":"version/9","color":"888a85","default":false,"description":"Something affects PHPUnit 9"}],"state":"closed","locked":false,"assignee":{"login":"sebastianbergmann","id":25218,"node_id":"MDQ6VXNlcjI1MjE4","avatar_url":"https://avatars.githubusercontent.com/u/25218?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianbergmann","html_url":"https://github.com/sebastianbergmann","followers_url":"https://api.github.com/users/sebastianbergmann/followers","following_url":"https://api.github.com/users/sebastianbergmann/following{/other_user}","gists_url":"https://api.github.com/users/sebastianbergmann/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianbergmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianbergmann/subscriptions","organizations_url":"https://api.github.com/users/sebastianbergmann/orgs","repos_url":"https://api.github.com/users/sebastianbergmann/repos","events_url":"https://api.github.com/users/sebastianbergmann/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianbergmann/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"sebastianbergmann","id":25218,"node_id":"MDQ6VXNlcjI1MjE4","avatar_url":"https://avatars.githubusercontent.com/u/25218?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianbergmann","html_url":"https://github.com/sebastianbergmann","followers_url":"https://api.github.com/users/sebastianbergmann/followers","following_url":"https://api.github.com/users/sebastianbergmann/following{/other_user}","gists_url":"https://api.github.com/users/sebastianbergmann/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianbergmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianbergmann/subscriptions","organizations_url":"https://api.github.com/users/sebastianbergmann/orgs","repos_url":"https://api.github.com/users/sebastianbergmann/repos","events_url":"https://api.github.com/users/sebastianbergmann/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianbergmann/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":1,"created_at":"2021-03-10T07:40:12Z","updated_at":"2023-02-04T06:40:02Z","closed_at":"2023-02-04T06:40:02Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\r\n- Please do not report an issue for a version of PHPUnit that is no longer supported. A list of currently supported versions of PHPUnit is available at https://phpunit.de/supported-versions.html.\r\n- Please do not report an issue if you are using a version of PHP that is not supported by the version of PHPUnit you are using. A list that shows which version of PHP is supported by which version of PHPUnit is available at https://phpunit.de/supported-versions.html.\r\n- Please fill in this template according to your issue.\r\n- Please keep the table shown below at the top of your issue.\r\n- Please include the output of \"composer info | sort\" if you installed PHPUnit using Composer.\r\n- Please post code as text (using proper markup). Do not post screenshots of code.\r\n- Visit https://phpunit.de/support.html if you are looking for support.\r\n- Please remove this comment before submitting your issue.\r\n-->\r\n\r\n| Q                   | A\r\n| --------------------| ---------------\r\n| PHPUnit version     | 2bc4a059f3de2ab93eab26c0b82e1e33f11c4dae\r\n| PHP version         | 7.4.16\r\n| Installation Method | Git clone\r\n\r\n## Summary\r\n\r\nI am aware that using generators in count related assertions is deprecated, but there seems to be some cases where it has not been deprecated properly(?)\r\n\r\n## Current behavior\r\n\r\n### assertNotEmpty with empty generator, no warning\r\n\r\n```php\r\nself::assertNotEmpty((fn(): Generator => yield [])());\r\n#> Success\r\n```\r\n:x: _Should trigger warning as this doesn't even work._\r\n\r\n### assertNotEmpty with non-empty generator\r\n\r\n```php\r\nself::assertNotEmpty((fn(): Generator => yield from ['ok'])())\r\n#> Success\r\n```\r\n:x: _Should trigger warning._\r\n\r\n### assertEmpty with empty generator\r\n```php\r\nself::assertEmpty((fn(): Generator => yield [])());\r\n#> Failed asserting that an object is empty.\r\n```\r\nðŸ†— _Could argue that this is ok as it sort-of says that Generators are not supported._\r\n\r\n### assertCount with empty generator\r\n```php\r\nself::assertCount(0, (fn() => yield [])());\r\n#> Failed asserting that actual size 0 matches expected size 0.\r\n```\r\nâ“ Weird.\r\n\r\n### assertCount with generator where assertion fails\r\nThis is just weird and might not be relevant.\r\n```php\r\nself::assertCount(0, (fn() => yield from ['foo'])());\r\n#> Failed asserting that actual size 0 matches expected size 0.\r\n```\r\nðŸ†— _Asserting count is 1 will make this test pass and a warning will be sent._\r\n\r\n\r\n## Expected behavior\r\n\r\nWarning with the message:\r\n> Passing an argument of type Generator for the $haystack parameter is deprecated. Support for this will be removed in PHPUnit 11.\r\n\r\n\r\nRelated to #4568","closed_by":{"login":"sebastianbergmann","id":25218,"node_id":"MDQ6VXNlcjI1MjE4","avatar_url":"https://avatars.githubusercontent.com/u/25218?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianbergmann","html_url":"https://github.com/sebastianbergmann","followers_url":"https://api.github.com/users/sebastianbergmann/followers","following_url":"https://api.github.com/users/sebastianbergmann/following{/other_user}","gists_url":"https://api.github.com/users/sebastianbergmann/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianbergmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianbergmann/subscriptions","organizations_url":"https://api.github.com/users/sebastianbergmann/orgs","repos_url":"https://api.github.com/users/sebastianbergmann/repos","events_url":"https://api.github.com/users/sebastianbergmann/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianbergmann/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/4618/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/4618/timeline","performed_via_github_app":null,"state_reason":"completed"}