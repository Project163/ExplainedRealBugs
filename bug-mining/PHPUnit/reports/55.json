{"url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/314","repository_url":"https://api.github.com/repos/sebastianbergmann/phpunit","labels_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/314/labels{/name}","comments_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/314/comments","events_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/314/events","html_url":"https://github.com/sebastianbergmann/phpunit/issues/314","id":1387713,"node_id":"MDU6SXNzdWUxMzg3NzEz","number":314,"title":"processIsolation weirdness with constants in the bootstrap","user":{"login":"Tyrael","id":199149,"node_id":"MDQ6VXNlcjE5OTE0OQ==","avatar_url":"https://avatars.githubusercontent.com/u/199149?v=4","gravatar_id":"","url":"https://api.github.com/users/Tyrael","html_url":"https://github.com/Tyrael","followers_url":"https://api.github.com/users/Tyrael/followers","following_url":"https://api.github.com/users/Tyrael/following{/other_user}","gists_url":"https://api.github.com/users/Tyrael/gists{/gist_id}","starred_url":"https://api.github.com/users/Tyrael/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tyrael/subscriptions","organizations_url":"https://api.github.com/users/Tyrael/orgs","repos_url":"https://api.github.com/users/Tyrael/repos","events_url":"https://api.github.com/users/Tyrael/events{/privacy}","received_events_url":"https://api.github.com/users/Tyrael/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":12,"created_at":"2011-08-11T14:12:53Z","updated_at":"2015-10-02T04:19:10Z","closed_at":"2015-10-02T04:19:07Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"today I noticed, that if I have a constant definition in my bootstrap file, the test execution will fail with an Constant xy already defined PHP Notice.\n\nI stumbled upon this blogpost: http://css.dzone.com/news/process-isolation-phpunit-0 and I figured out, that phpunit tries to preserve the original global state for the isolated tests, but it seems that it does a little bit too much magic.\n\nWhat I also found weird, that I also have includes in my bootstrap, which contains class declarations, and it seems that that won't trigger the \"Cannot redeclare class\" fatal error, so I don't really get it how exactly does the preservation works (didn't checked the source yet).\n\nI created a github repo for the problem:\n\nhttps://github.com/Tyrael/phpunit-processIsolation-bug\n\nif you clone this repo, and run phpunit, it will fail with the Constant already defined error, if you change the processIsolation to \"false\" in the phpunit.xml.dist, then it will succeed.\n","closed_by":{"login":"sebastianbergmann","id":25218,"node_id":"MDQ6VXNlcjI1MjE4","avatar_url":"https://avatars.githubusercontent.com/u/25218?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianbergmann","html_url":"https://github.com/sebastianbergmann","followers_url":"https://api.github.com/users/sebastianbergmann/followers","following_url":"https://api.github.com/users/sebastianbergmann/following{/other_user}","gists_url":"https://api.github.com/users/sebastianbergmann/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianbergmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianbergmann/subscriptions","organizations_url":"https://api.github.com/users/sebastianbergmann/orgs","repos_url":"https://api.github.com/users/sebastianbergmann/repos","events_url":"https://api.github.com/users/sebastianbergmann/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianbergmann/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/314/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/314/timeline","performed_via_github_app":null,"state_reason":"completed"}