{"url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/3002","repository_url":"https://api.github.com/repos/sebastianbergmann/phpunit","labels_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/3002/labels{/name}","comments_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/3002/comments","events_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/3002/events","html_url":"https://github.com/sebastianbergmann/phpunit/issues/3002","id":296351699,"node_id":"MDU6SXNzdWUyOTYzNTE2OTk=","number":3002,"title":"Towards a better plugin infrastructure","user":{"login":"sebastianbergmann","id":25218,"node_id":"MDQ6VXNlcjI1MjE4","avatar_url":"https://avatars.githubusercontent.com/u/25218?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianbergmann","html_url":"https://github.com/sebastianbergmann","followers_url":"https://api.github.com/users/sebastianbergmann/followers","following_url":"https://api.github.com/users/sebastianbergmann/following{/other_user}","gists_url":"https://api.github.com/users/sebastianbergmann/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianbergmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianbergmann/subscriptions","organizations_url":"https://api.github.com/users/sebastianbergmann/orgs","repos_url":"https://api.github.com/users/sebastianbergmann/repos","events_url":"https://api.github.com/users/sebastianbergmann/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianbergmann/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":44002,"node_id":"MDU6TGFiZWw0NDAwMg==","url":"https://api.github.com/repos/sebastianbergmann/phpunit/labels/type/enhancement","name":"type/enhancement","color":"73d216","default":false,"description":"A new idea that should be implemented"}],"state":"closed","locked":false,"assignee":{"login":"sebastianbergmann","id":25218,"node_id":"MDQ6VXNlcjI1MjE4","avatar_url":"https://avatars.githubusercontent.com/u/25218?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianbergmann","html_url":"https://github.com/sebastianbergmann","followers_url":"https://api.github.com/users/sebastianbergmann/followers","following_url":"https://api.github.com/users/sebastianbergmann/following{/other_user}","gists_url":"https://api.github.com/users/sebastianbergmann/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianbergmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianbergmann/subscriptions","organizations_url":"https://api.github.com/users/sebastianbergmann/orgs","repos_url":"https://api.github.com/users/sebastianbergmann/repos","events_url":"https://api.github.com/users/sebastianbergmann/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianbergmann/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"sebastianbergmann","id":25218,"node_id":"MDQ6VXNlcjI1MjE4","avatar_url":"https://avatars.githubusercontent.com/u/25218?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianbergmann","html_url":"https://github.com/sebastianbergmann","followers_url":"https://api.github.com/users/sebastianbergmann/followers","following_url":"https://api.github.com/users/sebastianbergmann/following{/other_user}","gists_url":"https://api.github.com/users/sebastianbergmann/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianbergmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianbergmann/subscriptions","organizations_url":"https://api.github.com/users/sebastianbergmann/orgs","repos_url":"https://api.github.com/users/sebastianbergmann/repos","events_url":"https://api.github.com/users/sebastianbergmann/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianbergmann/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/sebastianbergmann/phpunit/milestones/23","html_url":"https://github.com/sebastianbergmann/phpunit/milestone/23","labels_url":"https://api.github.com/repos/sebastianbergmann/phpunit/milestones/23/labels","id":2718611,"node_id":"MDk6TWlsZXN0b25lMjcxODYxMQ==","number":23,"title":"PHPUnit 7.1","description":"","creator":{"login":"sebastianbergmann","id":25218,"node_id":"MDQ6VXNlcjI1MjE4","avatar_url":"https://avatars.githubusercontent.com/u/25218?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianbergmann","html_url":"https://github.com/sebastianbergmann","followers_url":"https://api.github.com/users/sebastianbergmann/followers","following_url":"https://api.github.com/users/sebastianbergmann/following{/other_user}","gists_url":"https://api.github.com/users/sebastianbergmann/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianbergmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianbergmann/subscriptions","organizations_url":"https://api.github.com/users/sebastianbergmann/orgs","repos_url":"https://api.github.com/users/sebastianbergmann/repos","events_url":"https://api.github.com/users/sebastianbergmann/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianbergmann/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":2,"state":"closed","created_at":"2017-08-23T15:00:16Z","updated_at":"2018-04-06T13:07:18Z","due_on":"2018-04-06T07:00:00Z","closed_at":"2018-04-06T13:07:18Z"},"comments":0,"created_at":"2018-02-12T12:02:13Z","updated_at":"2018-02-21T13:46:21Z","closed_at":"2018-02-21T13:46:21Z","author_association":"OWNER","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"It should be easier to extend PHPUnit's test runner. More importantly, it should be possible to do so without abusing the `TestListener` interface.\r\n\r\nIn a first step, two hooks should be implemented: one that is triggered before the first test is executed and one that is triggered after the last test is executed. This is simple enough to implement and has been requested a couple of times over the years.\r\n\r\nAnother possible hook could be test filtering and ordering for #2660.\r\n\r\nI currently envision the following:\r\n\r\n```php\r\nnamespace PHPUnit\\Runner;\r\n\r\ninterface Hook\r\n{\r\n}\r\n```\r\n```php\r\nnamespace PHPUnit\\Runner;\r\n\r\ninterface BeforeFirstTestHook extends Hook\r\n{\r\n    public function executeBeforeFirstTest(): void;\r\n}\r\n```\r\n```php\r\nnamespace PHPUnit\\Runner;\r\n\r\ninterface AfterLastTestHook extends Hook\r\n{\r\n    public function executeAfterLastTest(): void;\r\n}\r\n```\r\nFollowing the Interface Segregation Principle, the idea here is to avoid one big interface and instead have one interface per extension point at which extensions can hook into PHPUnit's test runner.\r\n\r\nHere is an example of an extension that uses the two hooks mentioned above:\r\n```php\r\nnamespace vendor;\r\n\r\nuse PHPUnit\\Runner\\AfterLastTestHook;\r\nuse PHPUnit\\Runner\\BeforeFirstTestHook;\r\n\r\nfinal class MyExtension implements BeforeFirstTestHook, AfterLastTestHook\r\n{\r\n    public function executeAfterLastTest(): void\r\n    {\r\n        // ...\r\n    }\r\n\r\n    public function executeBeforeFirstTest(): void\r\n    {\r\n        // ...\r\n    }\r\n}\r\n```\r\nHere is how you configure PHPUnit's test runner to use that extension:\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<phpunit xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\r\n         xsi:noNamespaceSchemaLocation=\"https://schema.phpunit.de/7.1/phpunit.xsd\">\r\n    <extensions>\r\n        <extension class=\"vendor\\MyExtension\"/>\r\n    </extensions>\r\n</phpunit>\r\n```\r\n","closed_by":{"login":"sebastianbergmann","id":25218,"node_id":"MDQ6VXNlcjI1MjE4","avatar_url":"https://avatars.githubusercontent.com/u/25218?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianbergmann","html_url":"https://github.com/sebastianbergmann","followers_url":"https://api.github.com/users/sebastianbergmann/followers","following_url":"https://api.github.com/users/sebastianbergmann/following{/other_user}","gists_url":"https://api.github.com/users/sebastianbergmann/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianbergmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianbergmann/subscriptions","organizations_url":"https://api.github.com/users/sebastianbergmann/orgs","repos_url":"https://api.github.com/users/sebastianbergmann/repos","events_url":"https://api.github.com/users/sebastianbergmann/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianbergmann/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/3002/reactions","total_count":4,"+1":3,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/3002/timeline","performed_via_github_app":null,"state_reason":"completed"}