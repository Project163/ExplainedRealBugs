{"url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/4467","repository_url":"https://api.github.com/repos/sebastianbergmann/phpunit","labels_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/4467/labels{/name}","comments_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/4467/comments","events_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/4467/events","html_url":"https://github.com/sebastianbergmann/phpunit/issues/4467","id":707434038,"node_id":"MDU6SXNzdWU3MDc0MzQwMzg=","number":4467,"title":"Convenient custom comparison of objects","user":{"login":"sebastianbergmann","id":25218,"node_id":"MDQ6VXNlcjI1MjE4","avatar_url":"https://avatars.githubusercontent.com/u/25218?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianbergmann","html_url":"https://github.com/sebastianbergmann","followers_url":"https://api.github.com/users/sebastianbergmann/followers","following_url":"https://api.github.com/users/sebastianbergmann/following{/other_user}","gists_url":"https://api.github.com/users/sebastianbergmann/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianbergmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianbergmann/subscriptions","organizations_url":"https://api.github.com/users/sebastianbergmann/orgs","repos_url":"https://api.github.com/users/sebastianbergmann/repos","events_url":"https://api.github.com/users/sebastianbergmann/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianbergmann/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":44002,"node_id":"MDU6TGFiZWw0NDAwMg==","url":"https://api.github.com/repos/sebastianbergmann/phpunit/labels/type/enhancement","name":"type/enhancement","color":"73d216","default":false,"description":"A new idea that should be implemented"},{"id":1842312450,"node_id":"MDU6TGFiZWwxODQyMzEyNDUw","url":"https://api.github.com/repos/sebastianbergmann/phpunit/labels/feature/assertion","name":"feature/assertion","color":"e9b96e","default":false,"description":"Issues related to assertions and expectations"}],"state":"closed","locked":false,"assignee":{"login":"sebastianbergmann","id":25218,"node_id":"MDQ6VXNlcjI1MjE4","avatar_url":"https://avatars.githubusercontent.com/u/25218?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianbergmann","html_url":"https://github.com/sebastianbergmann","followers_url":"https://api.github.com/users/sebastianbergmann/followers","following_url":"https://api.github.com/users/sebastianbergmann/following{/other_user}","gists_url":"https://api.github.com/users/sebastianbergmann/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianbergmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianbergmann/subscriptions","organizations_url":"https://api.github.com/users/sebastianbergmann/orgs","repos_url":"https://api.github.com/users/sebastianbergmann/repos","events_url":"https://api.github.com/users/sebastianbergmann/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianbergmann/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"sebastianbergmann","id":25218,"node_id":"MDQ6VXNlcjI1MjE4","avatar_url":"https://avatars.githubusercontent.com/u/25218?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianbergmann","html_url":"https://github.com/sebastianbergmann","followers_url":"https://api.github.com/users/sebastianbergmann/followers","following_url":"https://api.github.com/users/sebastianbergmann/following{/other_user}","gists_url":"https://api.github.com/users/sebastianbergmann/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianbergmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianbergmann/subscriptions","organizations_url":"https://api.github.com/users/sebastianbergmann/orgs","repos_url":"https://api.github.com/users/sebastianbergmann/repos","events_url":"https://api.github.com/users/sebastianbergmann/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianbergmann/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/sebastianbergmann/phpunit/milestones/39","html_url":"https://github.com/sebastianbergmann/phpunit/milestone/39","labels_url":"https://api.github.com/repos/sebastianbergmann/phpunit/milestones/39/labels","id":4791659,"node_id":"MDk6TWlsZXN0b25lNDc5MTY1OQ==","number":39,"title":"PHPUnit 9.4","description":"","creator":{"login":"sebastianbergmann","id":25218,"node_id":"MDQ6VXNlcjI1MjE4","avatar_url":"https://avatars.githubusercontent.com/u/25218?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianbergmann","html_url":"https://github.com/sebastianbergmann","followers_url":"https://api.github.com/users/sebastianbergmann/followers","following_url":"https://api.github.com/users/sebastianbergmann/following{/other_user}","gists_url":"https://api.github.com/users/sebastianbergmann/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianbergmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianbergmann/subscriptions","organizations_url":"https://api.github.com/users/sebastianbergmann/orgs","repos_url":"https://api.github.com/users/sebastianbergmann/repos","events_url":"https://api.github.com/users/sebastianbergmann/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianbergmann/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":3,"state":"closed","created_at":"2019-10-28T16:51:08Z","updated_at":"2020-10-02T03:51:06Z","due_on":"2020-10-02T07:00:00Z","closed_at":"2020-10-02T03:51:06Z"},"comments":6,"created_at":"2020-09-23T14:48:39Z","updated_at":"2021-04-09T07:36:59Z","closed_at":"2020-09-24T12:15:40Z","author_association":"OWNER","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Suggested by @spriebsch:\r\n\r\nIt is a bad practice to use `assertEquals()` (and its inverse, `assertNotEquals()`) on objects without registering a custom comparator that customizes how objects are compared. Unfortunately, though, implementing custom comparators for each and every object you want to assert in your tests is inconvenient at best and overkill at worst.\r\n\r\nThe most common use case for custom comparators are Value Objects. These objects usually have an `equals(self $other): bool` method (or a method just like that but with a different name) for comparing two instances of the Value Object's type.\r\n\r\nWe propose a new assertion method, `assertObjectEquals()`, that makes custom comparison of objects convenient for this common use case:\r\n\r\n```php\r\npublic function assertObjectEquals(object $expected, object $actual, string $method = 'equals', string $message = '')\r\n{\r\n}\r\n```\r\n\r\n* A method with name `$method` must exist on the `$actual` object\r\n* The method must accept exactly one argument\r\n* The respective parameter must have a declared type\r\n* The `$expected` object must be compatible with this declared type\r\n* The method must have a declared `bool` return type\r\n\r\nIf any of the aforementioned assumptions is not fulfilled or if `$actual->$method($expected)` returns `false` then the assertion fails.\r\n\r\nAn inverse of `assertObjectEquals()` does not make sense to us and will not be implemented.\r\n\r\n#### Example\r\n**`Email.php`**\r\n```php\r\n<?php declare(strict_types=1);\r\nfinal class Email\r\n{\r\n    private string $email;\r\n\r\n    public function __construct(string $email)\r\n    {\r\n        $this->ensureIsValidEmail($email);\r\n\r\n        $this->email = $email;\r\n    }\r\n\r\n    public function asString(): string\r\n    {\r\n        return $this->email;\r\n    }\r\n\r\n    public function equals(self $other): bool\r\n    {\r\n        return $this->asString() === $other->asString();\r\n    }\r\n\r\n    private function ensureIsValidEmail(string $email): void\r\n    {\r\n        // ...\r\n    }\r\n}\r\n```\r\n**`SomethingThatUsesEmailTest.php`**\r\n```php\r\n<?php declare(strict_types=1);\r\nuse PHPUnit\\Framework\\TestCase;\r\n\r\nfinal class SomethingThatUsesEmailTest extends TestCase\r\n{\r\n    public function testSomething(): void\r\n    {\r\n        $a = new Email('user@example.org');\r\n        $b = new Email('user@example.org');\r\n        $c = new Email('user@example.com');\r\n\r\n        // This should pass\r\n        $this->assertObjectEquals($a, $b);\r\n\r\n        // This should fail\r\n        $this->assertObjectEquals($a, $c);\r\n    }\r\n}\r\n```\r\n","closed_by":{"login":"sebastianbergmann","id":25218,"node_id":"MDQ6VXNlcjI1MjE4","avatar_url":"https://avatars.githubusercontent.com/u/25218?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianbergmann","html_url":"https://github.com/sebastianbergmann","followers_url":"https://api.github.com/users/sebastianbergmann/followers","following_url":"https://api.github.com/users/sebastianbergmann/following{/other_user}","gists_url":"https://api.github.com/users/sebastianbergmann/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianbergmann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianbergmann/subscriptions","organizations_url":"https://api.github.com/users/sebastianbergmann/orgs","repos_url":"https://api.github.com/users/sebastianbergmann/repos","events_url":"https://api.github.com/users/sebastianbergmann/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianbergmann/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/4467/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":2,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/4467/timeline","performed_via_github_app":null,"state_reason":"completed"}