{"url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/678","repository_url":"https://api.github.com/repos/sebastianbergmann/phpunit","labels_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/678/labels{/name}","comments_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/678/comments","events_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/678/events","html_url":"https://github.com/sebastianbergmann/phpunit/issues/678","id":7342952,"node_id":"MDU6SXNzdWU3MzQyOTUy","number":678,"title":"getMock should always use munged name by default","user":{"login":"splondike","id":113718,"node_id":"MDQ6VXNlcjExMzcxOA==","avatar_url":"https://avatars.githubusercontent.com/u/113718?v=4","gravatar_id":"","url":"https://api.github.com/users/splondike","html_url":"https://github.com/splondike","followers_url":"https://api.github.com/users/splondike/followers","following_url":"https://api.github.com/users/splondike/following{/other_user}","gists_url":"https://api.github.com/users/splondike/gists{/gist_id}","starred_url":"https://api.github.com/users/splondike/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/splondike/subscriptions","organizations_url":"https://api.github.com/users/splondike/orgs","repos_url":"https://api.github.com/users/splondike/repos","events_url":"https://api.github.com/users/splondike/events{/privacy}","received_events_url":"https://api.github.com/users/splondike/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2012-10-04T07:01:15Z","updated_at":"2012-10-04T08:22:22Z","closed_at":"2012-10-04T08:22:22Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"A mock created with getMock('MyClass') will register a new class called 'MyClass' if one doesn't already exist.\n\nThis caused some problems for me with the CakePHP class loader which uses class_exists to decide whether to load something. I'd forgotten to include the class I was mocking, and hence PHPUnit made one for me. This caused a test in an unrelated class to fail because the application tried to use a non-existent method on the mock object.\n\nI think it would be both more consistent and safer if PHPUnit used the munged class name in both the existing class and no existing class cases. If the user wants a specific name, they can use setMockClassName. Ideally we'd be unloading the mock classes after each test case, but I understand you can't do this in PHP.\n\nA test case:\n\n``` php\n<?php\nclass MockBleedsTest extends PHPUnit_Framework_TestCase {\n   public function testOne() {\n      $this->getMock('FakeClass');\n      $this->assertFalse(class_exists('FakeClass'));\n   }\n}\n```\n","closed_by":{"login":"edorian","id":247397,"node_id":"MDQ6VXNlcjI0NzM5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/247397?v=4","gravatar_id":"","url":"https://api.github.com/users/edorian","html_url":"https://github.com/edorian","followers_url":"https://api.github.com/users/edorian/followers","following_url":"https://api.github.com/users/edorian/following{/other_user}","gists_url":"https://api.github.com/users/edorian/gists{/gist_id}","starred_url":"https://api.github.com/users/edorian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edorian/subscriptions","organizations_url":"https://api.github.com/users/edorian/orgs","repos_url":"https://api.github.com/users/edorian/repos","events_url":"https://api.github.com/users/edorian/events{/privacy}","received_events_url":"https://api.github.com/users/edorian/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/678/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sebastianbergmann/phpunit/issues/678/timeline","performed_via_github_app":null,"state_reason":"completed"}