diff --git a/PHPUnit/Extensions/Database/DB/DataSet.php b/PHPUnit/Extensions/Database/DB/DataSet.php
index f85159d80..1ee8abb8c 100644
--- a/PHPUnit/Extensions/Database/DB/DataSet.php
+++ b/PHPUnit/Extensions/Database/DB/DataSet.php
@@ -99,7 +99,7 @@ public function __construct(PHPUnit_Extensions_Database_DB_IDatabaseConnection $
      * @param PHPUnit_Extensions_Database_DataSet_ITableMetaData $tableMetaData
      * @return unknown
      */
-    public static function buildTableSelect(PHPUnit_Extensions_Database_DataSet_ITableMetaData $tableMetaData)
+    public static function buildTableSelect(PHPUnit_Extensions_Database_DataSet_ITableMetaData $tableMetaData, PHPUnit_Extensions_Database_DB_IDatabaseConnection $databaseConnection = NULL)
     {
         if ($tableMetaData->getTableName() == '') {
             $e = new Exception("Empty Table Name");
@@ -107,16 +107,29 @@ public static function buildTableSelect(PHPUnit_Extensions_Database_DataSet_ITab
             throw $e;
         }
 
-        $columnList = implode(', ', $tableMetaData->getColumns());
+        $columns = $tableMetaData->getColumns();
+        if ($databaseConnection) {
+        	$columns = array_map(array($databaseConnection, 'quoteSchemaObject'), $columns);
+        }
+        $columnList = implode(', ', $columns);
+
+        if ($databaseConnection) {
+        	$tableName = $databaseConnection->quoteSchemaObject($tableMetaData->getTableName());
+        } else {
+        	$tableName = $tableMetaData->getTableName();
+        }
 
         $primaryKeys = $tableMetaData->getPrimaryKeys();
+        if ($databaseConnection) {
+        	$primaryKeys = array_map(array($databaseConnection, 'quoteSchemaObject'), $primaryKeys);
+        }
         if (count($primaryKeys)) {
             $orderBy = 'ORDER BY ' . implode(' ASC, ', $primaryKeys) . ' ASC';
         } else {
             $orderBy = '';
         }
 
-        return "SELECT {$columnList} FROM {$tableMetaData->getTableName()} {$orderBy}";
+        return "SELECT {$columnList} FROM {$tableName} {$orderBy}";
     }
 
     /**
diff --git a/PHPUnit/Extensions/Database/DB/DefaultDatabaseConnection.php b/PHPUnit/Extensions/Database/DB/DefaultDatabaseConnection.php
index 5ff1b9e63..ed60b7f03 100644
--- a/PHPUnit/Extensions/Database/DB/DefaultDatabaseConnection.php
+++ b/PHPUnit/Extensions/Database/DB/DefaultDatabaseConnection.php
@@ -190,7 +190,7 @@ public function getConnection()
      */
     public function getRowCount($tableName, $whereClause = NULL)
     {
-        $query = "SELECT COUNT(*) FROM {$tableName}";
+        $query = "SELECT COUNT(*) FROM ".$this->quoteSchemaObject($tableName);
 
         if (isset($whereClause)) {
             $query .= " WHERE {$whereClause}";
diff --git a/PHPUnit/Extensions/Database/DB/Table.php b/PHPUnit/Extensions/Database/DB/Table.php
index bc699ad52..cf4688215 100644
--- a/PHPUnit/Extensions/Database/DB/Table.php
+++ b/PHPUnit/Extensions/Database/DB/Table.php
@@ -76,7 +76,7 @@ public function __construct(PHPUnit_Extensions_Database_DataSet_ITableMetaData $
     {
         $this->setTableMetaData($tableMetaData);
 
-        $pdoStatement = $databaseConnection->getConnection()->prepare(PHPUnit_Extensions_Database_DB_DataSet::buildTableSelect($tableMetaData));
+        $pdoStatement = $databaseConnection->getConnection()->prepare(PHPUnit_Extensions_Database_DB_DataSet::buildTableSelect($tableMetaData, $databaseConnection));
         $pdoStatement->execute();
         $this->data = $pdoStatement->fetchAll(PDO::FETCH_ASSOC);
     }
