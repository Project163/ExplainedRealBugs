diff --git a/ChangeLog-5.7.md b/ChangeLog-5.7.md
index 63a8c8281..2e1babbc2 100644
--- a/ChangeLog-5.7.md
+++ b/ChangeLog-5.7.md
@@ -2,6 +2,12 @@
 
 All notable changes of the PHPUnit 5.7 release series are documented in this file using the [Keep a CHANGELOG](http://keepachangelog.com/) principles.
 
+## [5.7.22] - 2017-MM-DD
+
+### Fixed
+
+* Fixed [#2769](https://github.com/sebastianbergmann/phpunit/issues/2769): Usage of `setUseErrorHandler()` produces `Undefined variable` error
+
 ## [5.7.21] - 2017-06-21
 
 ### Added
@@ -171,6 +177,7 @@ All notable changes of the PHPUnit 5.7 release series are documented in this fil
 * The `--tap` and `--log-tap` commandline options have been deprecated
 * The `--self-update` and `--self-upgrade` commandline options have been deprecated (PHAR binary only)
 
+[5.7.22]: https://github.com/sebastianbergmann/phpunit/compare/5.7.21...5.7.22
 [5.7.21]: https://github.com/sebastianbergmann/phpunit/compare/5.7.20...5.7.21
 [5.7.20]: https://github.com/sebastianbergmann/phpunit/compare/5.7.19...5.7.20
 [5.7.19]: https://github.com/sebastianbergmann/phpunit/compare/5.7.18...5.7.19
diff --git a/src/Framework/TestCase.php b/src/Framework/TestCase.php
index 3548efe3b..240374782 100644
--- a/src/Framework/TestCase.php
+++ b/src/Framework/TestCase.php
@@ -860,7 +860,7 @@ public function run(PHPUnit_Framework_TestResult $result = null)
             $result->run($this);
         }
 
-        if ($this->useErrorHandler !== null) {
+        if (isset($oldErrorHandlerSetting)) {
             $result->convertErrorsToExceptions($oldErrorHandlerSetting);
         }
 
