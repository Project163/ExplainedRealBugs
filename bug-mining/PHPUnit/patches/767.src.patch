diff --git a/ChangeLog-10.3.md b/ChangeLog-10.3.md
index a01f22ccb..47036387a 100644
--- a/ChangeLog-10.3.md
+++ b/ChangeLog-10.3.md
@@ -7,6 +7,7 @@ All notable changes of the PHPUnit 10.3 release series are documented in this fi
 ### Fixed
 
 * [#5484](https://github.com/sebastianbergmann/phpunit/issues/5484): TestDox name prettifier only supports backed enumerations
+* [#5487](https://github.com/sebastianbergmann/phpunit/issues/5487): Tests are run more than once if `<testsuites>` has overlapping `<directory>`s
 
 ## [10.3.2] - 2023-08-15
 
diff --git a/src/TextUI/Configuration/Xml/TestSuiteMapper.php b/src/TextUI/Configuration/Xml/TestSuiteMapper.php
index b10bbf3d4..530ae10bc 100644
--- a/src/TextUI/Configuration/Xml/TestSuiteMapper.php
+++ b/src/TextUI/Configuration/Xml/TestSuiteMapper.php
@@ -10,6 +10,8 @@
 namespace PHPUnit\TextUI\XmlConfiguration;
 
 use const PHP_VERSION;
+use function array_merge;
+use function array_unique;
 use function explode;
 use function in_array;
 use function is_dir;
@@ -52,15 +54,14 @@ public function map(string $xmlConfigurationFile, TestSuiteCollection $configura
                     continue;
                 }
 
-                $testSuite      = TestSuiteObject::empty($testSuiteConfiguration->name());
-                $testSuiteEmpty = true;
-
                 $exclude = [];
 
                 foreach ($testSuiteConfiguration->exclude()->asArray() as $file) {
                     $exclude[] = $file->path();
                 }
 
+                $files = [];
+
                 foreach ($testSuiteConfiguration->directories() as $directory) {
                     if (!str_contains($directory->path(), '*') && !is_dir($directory->path())) {
                         throw new TestDirectoryNotFoundException($directory->path());
@@ -70,18 +71,15 @@ public function map(string $xmlConfigurationFile, TestSuiteCollection $configura
                         continue;
                     }
 
-                    $files = (new Facade)->getFilesAsArray(
-                        $directory->path(),
-                        $directory->suffix(),
-                        $directory->prefix(),
-                        $exclude,
+                    $files = array_merge(
+                        $files,
+                        (new Facade)->getFilesAsArray(
+                            $directory->path(),
+                            $directory->suffix(),
+                            $directory->prefix(),
+                            $exclude,
+                        ),
                     );
-
-                    if (!empty($files)) {
-                        $testSuite->addTestFiles($files);
-
-                        $testSuiteEmpty = false;
-                    }
                 }
 
                 foreach ($testSuiteConfiguration->files() as $file) {
@@ -93,12 +91,14 @@ public function map(string $xmlConfigurationFile, TestSuiteCollection $configura
                         continue;
                     }
 
-                    $testSuite->addTestFile($file->path());
-
-                    $testSuiteEmpty = false;
+                    $files[] = $file->path();
                 }
 
-                if (!$testSuiteEmpty) {
+                if (!empty($files)) {
+                    $testSuite = TestSuiteObject::empty($testSuiteConfiguration->name());
+
+                    $testSuite->addTestFiles(array_unique($files));
+
                     $result->addTest($testSuite);
                 }
             }
diff --git a/tests/end-to-end/regression/5487.phpt b/tests/end-to-end/regression/5487.phpt
new file mode 100644
index 000000000..c4fb7016b
--- /dev/null
+++ b/tests/end-to-end/regression/5487.phpt
@@ -0,0 +1,21 @@
+--TEST--
+https://github.com/sebastianbergmann/phpunit/issues/5487
+--FILE--
+<?php declare(strict_types=1);
+$_SERVER['argv'][] = '--do-not-cache-result';
+$_SERVER['argv'][] = __DIR__ . '/5487';
+
+require_once __DIR__ . '/../../bootstrap.php';
+
+(new PHPUnit\TextUI\Application)->run($_SERVER['argv']);
+--EXPECTF--
+PHPUnit %s by Sebastian Bergmann and contributors.
+
+Runtime: %s
+Configuration: %s
+
+..                                                                  2 / 2 (100%)
+
+Time: %s, Memory: %s
+
+OK (2 tests, 2 assertions)
diff --git a/tests/end-to-end/regression/5487/phpunit.xml b/tests/end-to-end/regression/5487/phpunit.xml
new file mode 100644
index 000000000..1509c385e
--- /dev/null
+++ b/tests/end-to-end/regression/5487/phpunit.xml
@@ -0,0 +1,11 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<phpunit xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:noNamespaceSchemaLocation="../../../../phpunit.xsd">
+    <testsuites>
+        <testsuite name="default">
+            <directory>tests</directory>
+            <directory>tests/foo</directory>
+            <directory>tests/bar</directory>
+        </testsuite>
+    </testsuites>
+</phpunit>
diff --git a/tests/end-to-end/regression/5487/tests/bar/BarTest.php b/tests/end-to-end/regression/5487/tests/bar/BarTest.php
new file mode 100644
index 000000000..0e68b778c
--- /dev/null
+++ b/tests/end-to-end/regression/5487/tests/bar/BarTest.php
@@ -0,0 +1,20 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture\Issue5487;
+
+use PHPUnit\Framework\TestCase;
+
+final class BarTest extends TestCase
+{
+    public function testOne(): void
+    {
+        $this->assertTrue(true);
+    }
+}
diff --git a/tests/end-to-end/regression/5487/tests/foo/FooTest.php b/tests/end-to-end/regression/5487/tests/foo/FooTest.php
new file mode 100644
index 000000000..a4e55f377
--- /dev/null
+++ b/tests/end-to-end/regression/5487/tests/foo/FooTest.php
@@ -0,0 +1,20 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture\Issue5487;
+
+use PHPUnit\Framework\TestCase;
+
+final class FooTest extends TestCase
+{
+    public function testOne(): void
+    {
+        $this->assertTrue(true);
+    }
+}
