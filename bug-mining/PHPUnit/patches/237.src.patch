diff --git a/PHPUnit/Util/Filter.php b/PHPUnit/Util/Filter.php
index f6dd7e494..2e23a4eac 100644
--- a/PHPUnit/Util/Filter.php
+++ b/PHPUnit/Util/Filter.php
@@ -107,7 +107,7 @@ public static function getFilteredStacktrace(Exception $e, $asString = TRUE)
         foreach ($eTrace as $frame) {
             if (isset($frame['file']) && is_file($frame['file']) &&
                 !isset($blacklist[$frame['file']]) &&
-                strpos($frame['file'], $prefix) !== 0 &&
+                ($prefix === FALSE || strpos($frame['file'], $prefix) !== 0) &&
                 $frame['file'] !== $script) {
                 if ($asString === TRUE) {
                     $filteredStacktrace .= sprintf(
