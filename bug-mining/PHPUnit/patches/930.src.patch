diff --git a/ChangeLog-11.5.md b/ChangeLog-11.5.md
index 1c1a96446..e2c7f2077 100644
--- a/ChangeLog-11.5.md
+++ b/ChangeLog-11.5.md
@@ -7,6 +7,7 @@ All notable changes of the PHPUnit 11.5 release series are documented in this fi
 ### Fixed
 
 * [#6104](https://github.com/sebastianbergmann/phpunit/issues/6104): Test with dependencies and data provider fails
+* [#6174](https://github.com/sebastianbergmann/phpunit/issues/6174): `willReturnMap()` fails with nullable parameters when their default is `null` and no argument is passed for them
 
 ## [11.5.15] - 2025-03-23
 
diff --git a/src/Framework/MockObject/Runtime/Builder/InvocationMocker.php b/src/Framework/MockObject/Runtime/Builder/InvocationMocker.php
index f605ab287..9aa5fc854 100644
--- a/src/Framework/MockObject/Runtime/Builder/InvocationMocker.php
+++ b/src/Framework/MockObject/Runtime/Builder/InvocationMocker.php
@@ -144,13 +144,13 @@ public function willReturnMap(array $valueMap): self
             $returnValue = array_pop($mapping);
 
             foreach (range(0, $numberOfParameters - 1) as $i) {
-                if (isset($mapping[$i])) {
+                if (array_key_exists($i, $mapping)) {
                     $_mapping[] = $mapping[$i];
 
                     continue;
                 }
 
-                if (isset($defaultValues[$i])) {
+                if (array_key_exists($i, $defaultValues)) {
                     $_mapping[] = $defaultValues[$i];
                 }
             }
diff --git a/tests/_files/mock-object/YetAnotherInterface.php b/tests/_files/mock-object/YetAnotherInterface.php
index 1c6cf009f..dd3d9c324 100644
--- a/tests/_files/mock-object/YetAnotherInterface.php
+++ b/tests/_files/mock-object/YetAnotherInterface.php
@@ -9,7 +9,9 @@
  */
 namespace PHPUnit\TestFixture\MockObject;
 
-interface YetAnotherInterface
+interface Issue6174
 {
-    public function doSomethingElseEntirely();
+    public function methodNullDefault(?string $param, ?string $nullDefault = null): string;
+
+    public function methodStringDefault(?string $param, ?string $stringDefault = 'something'): string;
 }
diff --git a/tests/unit/Framework/MockObject/TestDoubleTestCase.php b/tests/unit/Framework/MockObject/TestDoubleTestCase.php
index 0b321efce..461f3ac39 100644
--- a/tests/unit/Framework/MockObject/TestDoubleTestCase.php
+++ b/tests/unit/Framework/MockObject/TestDoubleTestCase.php
@@ -24,6 +24,7 @@
 use PHPUnit\TestFixture\MockObject\InterfaceWithNeverReturningMethod;
 use PHPUnit\TestFixture\MockObject\InterfaceWithPropertyWithGetHook;
 use PHPUnit\TestFixture\MockObject\InterfaceWithReturnTypeDeclaration;
+use PHPUnit\TestFixture\MockObject\Issue6174;
 use stdClass;
 
 abstract class TestDoubleTestCase extends TestCase
@@ -130,6 +131,50 @@ final public function testMethodWithDefaultParameterValuesCanBeConfiguredToRetur
         $this->assertSame(4, $double->doSomething(3));
     }
 
+    #[Ticket('https://github.com/sebastianbergmann/phpunit/issues/6174')]
+    final public function testIssue6174(): void
+    {
+        $double = $this->createTestDouble(Issue6174::class);
+
+        $double->method('methodNullDefault')->willReturnMap(
+            [
+                ['A', null, 'result'],
+            ],
+        );
+
+        $this->assertSame('result', $double->methodNullDefault('A'));
+
+        $double = $this->createTestDouble(Issue6174::class);
+
+        $double->method('methodNullDefault')->willReturnMap(
+            [
+                ['A', 'result'],
+            ],
+        );
+
+        $this->assertSame('result', $double->methodNullDefault('A'));
+
+        $double = $this->createTestDouble(Issue6174::class);
+
+        $double->method('methodStringDefault')->willReturnMap(
+            [
+                ['A', 'result'],
+            ],
+        );
+
+        $this->assertSame('result', $double->methodStringDefault('A'));
+
+        $double = $this->createTestDouble(Issue6174::class);
+
+        $double->method('methodStringDefault')->willReturnMap(
+            [
+                [null, 'result'],
+            ],
+        );
+
+        $this->assertSame('result', $double->methodStringDefault(null));
+    }
+
     final public function testMethodCanBeConfiguredToReturnValuesUsingCallback(): void
     {
         $double = $this->createTestDouble(InterfaceWithReturnTypeDeclaration::class);
