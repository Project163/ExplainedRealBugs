diff --git a/PHPUnit/Util/Diff.php b/PHPUnit/Util/Diff.php
index cff980849..d57a37542 100644
--- a/PHPUnit/Util/Diff.php
+++ b/PHPUnit/Util/Diff.php
@@ -144,10 +144,16 @@ protected static function doTextDiff($from, $to)
      */
     protected static function doDiffCommand($from, $to)
     {
-        $fromFile = tempnam('/tmp', 'expected');
-        file_put_contents($fromFile, $from);
+        if (defined('PHPUNIT_TMPDIR')) {
+            $tmpDir = PHPUNIT_TMPDIR;
+        } else {
+            $tmpDir = sys_get_temp_dir();
+        }
 
-        $toFile = tempnam('/tmp', 'actual');
+        $fromFile = tempnam($tmpDir, 'expected');
+        $toFile   = tempnam($tmpDir, 'actual');
+
+        file_put_contents($fromFile, $from);
         file_put_contents($toFile, $to);
 
         $buffer = shell_exec(
