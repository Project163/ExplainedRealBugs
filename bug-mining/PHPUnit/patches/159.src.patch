diff --git a/PHPUnit/Util/Printer.php b/PHPUnit/Util/Printer.php
index fd7591e61..eeeac3633 100644
--- a/PHPUnit/Util/Printer.php
+++ b/PHPUnit/Util/Printer.php
@@ -114,11 +114,11 @@ public function __construct($out = NULL)
     }
 
     /**
-     * Flush buffer, optionally tidy up HTML, and close output.
+     * Flush buffer, optionally tidy up HTML, and close output if it's not to a php stream
      */
     public function flush()
     {
-        if ($this->out && $this->outTarget !== 'php://stderr') {
+        if ($this->out && strncmp($this->outTarget, 'php://', 6) !== 0) {
             fclose($this->out);
         }
 
