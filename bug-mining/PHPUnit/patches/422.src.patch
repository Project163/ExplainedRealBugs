diff --git a/ChangeLog-6.4.md b/ChangeLog-6.4.md
index 8ce61d414..25693ca7e 100644
--- a/ChangeLog-6.4.md
+++ b/ChangeLog-6.4.md
@@ -7,6 +7,7 @@ All notable changes of the PHPUnit 6.4 release series are documented in this fil
 ### Fixed
 
 * Fixed [#2814](https://github.com/sebastianbergmann/phpunit/pull/2814): Incorrect signature of `expectExceptionObject()`
+* Fixed [#2844](https://github.com/sebastianbergmann/phpunit/issues/2844): The commandline option `--whitelist` has no effect
 
 ## [6.4.3] - 2017-10-16
 
diff --git a/src/TextUI/TestRunner.php b/src/TextUI/TestRunner.php
index b5d5fc68a..953dfec33 100644
--- a/src/TextUI/TestRunner.php
+++ b/src/TextUI/TestRunner.php
@@ -461,7 +461,7 @@ public function doRun(Test $suite, array $arguments = [], $exit = true)
             if (isset($arguments['configuration'])) {
                 $filterConfiguration = $arguments['configuration']->getFilterConfiguration();
 
-                if (empty($filterConfiguration['whitelist'])) {
+                if (empty($filterConfiguration['whitelist']) && !isset($arguments['whitelist'])) {
                     $this->writeMessage('Error', 'No whitelist is configured, no code coverage will be generated.');
 
                     $codeCoverageReports = 0;
diff --git a/src/Util/Configuration.php b/src/Util/Configuration.php
index 123822f06..479f5f99e 100644
--- a/src/Util/Configuration.php
+++ b/src/Util/Configuration.php
@@ -225,7 +225,18 @@ public function getFilterConfiguration()
 
         if ($tmp->length == 0) {
             return [
-                'whitelist' => []
+                'whitelist' => [
+                    'addUncoveredFilesFromWhitelist'     => $addUncoveredFilesFromWhitelist,
+                    'processUncoveredFilesFromWhitelist' => $processUncoveredFilesFromWhitelist,
+                    'include'                            => [
+                        'directory' => [],
+                        'file' => []
+                    ],
+                    'exclude' => [
+                        'directory' => [],
+                        'file' => []
+                    ]
+                ]
             ];
         }
 
