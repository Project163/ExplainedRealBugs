diff --git a/ChangeLog-6.4.md b/ChangeLog-6.4.md
index 7c34a28d8..22730e958 100644
--- a/ChangeLog-6.4.md
+++ b/ChangeLog-6.4.md
@@ -2,6 +2,12 @@
 
 All notable changes of the PHPUnit 6.4 release series are documented in this file using the [Keep a CHANGELOG](http://keepachangelog.com/) principles.
 
+## [6.4.3] - 2017-MM-DD
+
+### Fixed
+
+* Fixed [#2811](https://github.com/sebastianbergmann/phpunit/issues/2811): `expectExceptionMessage()` does not work without `expectException()`
+
 ## [6.4.2] - 2017-10-15
 
 ### Fixed
@@ -38,6 +44,7 @@ All notable changes of the PHPUnit 6.4 release series are documented in this fil
 
 * Fixed [#2750](https://github.com/sebastianbergmann/phpunit/issues/2750): Useless call to `array_map()`
 
+[6.4.3]: https://github.com/sebastianbergmann/phpunit/compare/6.4.2...6.4.3
 [6.4.2]: https://github.com/sebastianbergmann/phpunit/compare/6.4.1...6.4.2
 [6.4.1]: https://github.com/sebastianbergmann/phpunit/compare/6.4.0...6.4.1
 [6.4.0]: https://github.com/sebastianbergmann/phpunit/compare/6.3...6.4.0
diff --git a/src/Framework/TestCase.php b/src/Framework/TestCase.php
index 06b5ae244..33a396ef5 100644
--- a/src/Framework/TestCase.php
+++ b/src/Framework/TestCase.php
@@ -1069,33 +1069,15 @@ protected function runTest()
 
         try {
             $testResult = $method->invokeArgs($this, $testArguments);
-        } catch (Throwable $_e) {
-            $e = $_e;
+        } catch (Throwable $t) {
+            $exception = $t;
         }
 
-        if (isset($e)) {
-            $checkException = false;
-
-            if (!($e instanceof SkippedTestError) && \is_string($this->expectedException)) {
-                $checkException = true;
-
-                if ($e instanceof Exception) {
-                    $checkException = false;
-                }
-
-                $reflector = new ReflectionClass($this->expectedException);
-
-                if ($this->expectedException === 'PHPUnit\Framework\Exception' ||
-                    $this->expectedException === '\PHPUnit\Framework\Exception' ||
-                    $reflector->isSubclassOf('PHPUnit\Framework\Exception')) {
-                    $checkException = true;
-                }
-            }
-
-            if ($checkException) {
+        if (isset($exception)) {
+            if ($this->checkExceptionExpectations($exception)) {
                 if ($this->expectedException !== null) {
                     $this->assertThat(
-                        $e,
+                        $exception,
                         new ExceptionConstraint(
                             $this->expectedException
                         )
@@ -1104,7 +1086,7 @@ protected function runTest()
 
                 if ($this->expectedExceptionMessage !== null) {
                     $this->assertThat(
-                        $e,
+                        $exception,
                         new ExceptionMessage(
                             $this->expectedExceptionMessage
                         )
@@ -1113,7 +1095,7 @@ protected function runTest()
 
                 if ($this->expectedExceptionMessageRegExp !== null) {
                     $this->assertThat(
-                        $e,
+                        $exception,
                         new ExceptionMessageRegularExpression(
                             $this->expectedExceptionMessageRegExp
                         )
@@ -1122,7 +1104,7 @@ protected function runTest()
 
                 if ($this->expectedExceptionCode !== null) {
                     $this->assertThat(
-                        $e,
+                        $exception,
                         new ExceptionCode(
                             $this->expectedExceptionCode
                         )
@@ -1132,7 +1114,7 @@ protected function runTest()
                 return;
             }
 
-            throw $e;
+            throw $exception;
         }
 
         if ($this->expectedException !== null) {
@@ -2509,4 +2491,29 @@ private function cleanupLocaleSettings()
 
         $this->locale = [];
     }
+
+    private function checkExceptionExpectations(Throwable $throwable): bool
+    {
+        $result = false;
+
+        if ($this->expectedException !== null || $this->expectedExceptionCode !== null || $this->expectedExceptionMessage !== null || $this->expectedExceptionMessageRegExp !== null) {
+            $result = true;
+        }
+
+        if ($throwable instanceof Exception) {
+            $result = false;
+        }
+
+        if (\is_string($this->expectedException)) {
+            $reflector = new ReflectionClass($this->expectedException);
+
+            if ($this->expectedException === 'PHPUnit\Framework\Exception' ||
+                $this->expectedException === '\PHPUnit\Framework\Exception' ||
+                $reflector->isSubclassOf('PHPUnit\Framework\Exception')) {
+                $result = true;
+            }
+        }
+
+        return $result;
+    }
 }
diff --git a/tests/Regression/GitHub/2811.phpt b/tests/Regression/GitHub/2811.phpt
index a06ee6338..7d442dc21 100644
--- a/tests/Regression/GitHub/2811.phpt
+++ b/tests/Regression/GitHub/2811.phpt
@@ -17,4 +17,4 @@ PHPUnit %s by Sebastian Bergmann and contributors.
 
 Time: %s, Memory: %s
 
-OK (1 test, 2 assertions)
+OK (1 test, 1 assertion)
