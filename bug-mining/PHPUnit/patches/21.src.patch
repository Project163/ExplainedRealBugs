diff --git a/PHPUnit/TextUI/TestRunner.php b/PHPUnit/TextUI/TestRunner.php
index 7d73284b5..39a1b37c9 100644
--- a/PHPUnit/TextUI/TestRunner.php
+++ b/PHPUnit/TextUI/TestRunner.php
@@ -332,7 +332,7 @@ public function testFailed($status, PHPUnit_Framework_Test $test, PHPUnit_Framew
     protected function runFailed($message)
     {
         self::printVersionString();
-        print $message;
+        self::write($message);
         exit(self::FAILURE_EXIT);
     }
 
@@ -361,6 +361,20 @@ private function getDirectory($directory)
         }
     }
 
+    /**
+     * @param  string $buffer
+     * @access private
+     * @since  Method available since Release 3.1.0
+     */
+    private static function write($buffer)
+    {
+        if (php_sapi_name() != 'cli') {
+            $buffer = htmlentities($buffer);
+        }
+
+        print $buffer;
+    }
+
     /**
      * Returns the loader to be used.
      *
@@ -396,7 +410,7 @@ public static function setLoader(PHPUnit_Runner_TestSuiteLoader $loader)
     public static function showError($message)
     {
         self::printVersionString();
-        print $message . "\n";
+        self::write($message . "\n");
 
         exit(self::FAILURE_EXIT);
     }
@@ -409,7 +423,7 @@ public static function showError($message)
     public static function printVersionString()
     {
         if (!self::$versionStringPrinted) {
-            print PHPUnit_Runner_Version::getVersionString() . "\n\n";
+            self::write(PHPUnit_Runner_Version::getVersionString() . "\n\n");
             self::$versionStringPrinted = TRUE;
         }
     }
diff --git a/PHPUnit/Util/Printer.php b/PHPUnit/Util/Printer.php
index bcfdae7c2..0dfb94f27 100644
--- a/PHPUnit/Util/Printer.php
+++ b/PHPUnit/Util/Printer.php
@@ -118,6 +118,10 @@ public function write($buffer)
         if ($this->out !== NULL) {
             fwrite($this->out, $buffer);
         } else {
+            if (php_sapi_name() != 'cli') {
+                $buffer = htmlentities($buffer);
+            }
+
             print $buffer;
         }
     }
