diff --git a/ChangeLog-11.4.md b/ChangeLog-11.4.md
index 31198b2bf..805eb8483 100644
--- a/ChangeLog-11.4.md
+++ b/ChangeLog-11.4.md
@@ -10,6 +10,7 @@ All notable changes of the PHPUnit 11.4 release series are documented in this fi
 
 ### Fixed
 
+* [#5844](https://github.com/sebastianbergmann/phpunit/issues/5844): Error handlers that are not callable outside the scope they were registered in are not handled correctly
 * [#5982](https://github.com/sebastianbergmann/phpunit/pull/5982): Typo in exception message
 
 ## [11.4.1] - 2024-10-08
diff --git a/src/Framework/TestCase.php b/src/Framework/TestCase.php
index 94d3e62d7..a44e28c9e 100644
--- a/src/Framework/TestCase.php
+++ b/src/Framework/TestCase.php
@@ -1974,7 +1974,7 @@ private function restoreGlobalErrorExceptionHandlers(): void
      */
     private function getActiveErrorHandlers(): array
     {
-        $res = [];
+        $activeErrorHandlers = [];
 
         while (true) {
             $previousHandler = set_error_handler(static fn () => false);
@@ -1985,18 +1985,37 @@ private function getActiveErrorHandlers(): array
                 break;
             }
 
-            $res[] = $previousHandler;
+            $activeErrorHandlers[] = $previousHandler;
 
             restore_error_handler();
         }
 
-        $res = array_reverse($res);
+        $activeErrorHandlers      = array_reverse($activeErrorHandlers);
+        $invalidErrorHandlerStack = false;
+
+        foreach ($activeErrorHandlers as $handler) {
+            if (!is_callable($handler)) {
+                $invalidErrorHandlerStack = true;
+
+                continue;
+            }
 
-        foreach ($res as $handler) {
             set_error_handler($handler);
         }
 
-        return $res;
+        /** @phpstan-ignore if.alwaysFalse */
+        if ($invalidErrorHandlerStack) {
+            $message = 'At least one error handler is not callable outside the scope it was registered in';
+
+            Event\Facade::emitter()->testConsideredRisky(
+                $this->valueObjectForEvents(),
+                $message,
+            );
+
+            $this->status = TestStatus::risky($message);
+        }
+
+        return $activeErrorHandlers;
     }
 
     /**
diff --git a/tests/end-to-end/regression/5844.phpt b/tests/end-to-end/regression/5844.phpt
new file mode 100644
index 000000000..a4907d373
--- /dev/null
+++ b/tests/end-to-end/regression/5844.phpt
@@ -0,0 +1,34 @@
+--TEST--
+https://github.com/sebastianbergmann/phpunit/issues/5844
+--FILE--
+<?php declare(strict_types=1);
+$_SERVER['argv'][] = '--do-not-cache-result';
+$_SERVER['argv'][] = '--no-configuration';
+$_SERVER['argv'][] = '--debug';
+$_SERVER['argv'][] = '--bootstrap';
+$_SERVER['argv'][] = __DIR__ . '/5844/bootstrap.php';
+$_SERVER['argv'][] = __DIR__ . '/5844/Issue5844Test.php';
+
+require_once __DIR__ . '/../../bootstrap.php';
+
+(new PHPUnit\TextUI\Application)->run($_SERVER['argv']);
+--EXPECTF--
+PHPUnit Started (PHPUnit %s using %s)
+Test Runner Configured
+Bootstrap Finished (%s5844%sbootstrap.php)
+Event Facade Sealed
+Test Suite Loaded (1 test)
+Test Runner Started
+Test Suite Sorted
+Test Runner Execution Started (1 test)
+Test Suite Started (PHPUnit\TestFixture\Issue5844\Issue5844Test, 1 test)
+Test Preparation Started (PHPUnit\TestFixture\Issue5844\Issue5844Test::testOne)
+Test Considered Risky (PHPUnit\TestFixture\Issue5844\Issue5844Test::testOne)
+At least one error handler is not callable outside the scope it was registered in
+Test Prepared (PHPUnit\TestFixture\Issue5844\Issue5844Test::testOne)
+Test Passed (PHPUnit\TestFixture\Issue5844\Issue5844Test::testOne)
+Test Finished (PHPUnit\TestFixture\Issue5844\Issue5844Test::testOne)
+Test Suite Finished (PHPUnit\TestFixture\Issue5844\Issue5844Test, 1 test)
+Test Runner Execution Finished
+Test Runner Finished
+PHPUnit Finished (Shell Exit Code: 0)
diff --git a/tests/end-to-end/regression/5844/Issue5844Test.php b/tests/end-to-end/regression/5844/Issue5844Test.php
new file mode 100644
index 000000000..5fe84a202
--- /dev/null
+++ b/tests/end-to-end/regression/5844/Issue5844Test.php
@@ -0,0 +1,20 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture\Issue5844;
+
+use PHPUnit\Framework\TestCase;
+
+final class Issue5844Test extends TestCase
+{
+    public function testOne(): void
+    {
+        $this->assertTrue(true);
+    }
+}
diff --git a/tests/end-to-end/regression/5844/bootstrap.php b/tests/end-to-end/regression/5844/bootstrap.php
new file mode 100644
index 000000000..47bdc13d7
--- /dev/null
+++ b/tests/end-to-end/regression/5844/bootstrap.php
@@ -0,0 +1,26 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture\Issue5844;
+
+use function set_error_handler;
+
+final class CustomErrorHandler
+{
+    public function __construct()
+    {
+        set_error_handler([$this, 'handleError']);
+    }
+
+    private function handleError(): void
+    {
+    }
+}
+
+new CustomErrorHandler;
