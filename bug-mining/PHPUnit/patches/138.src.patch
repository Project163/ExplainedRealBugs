diff --git a/PHPUnit/Util/Log/JUnit.php b/PHPUnit/Util/Log/JUnit.php
index cd34caadf..2ba20ed6d 100644
--- a/PHPUnit/Util/Log/JUnit.php
+++ b/PHPUnit/Util/Log/JUnit.php
@@ -186,12 +186,7 @@ public function addError(PHPUnit_Framework_Test $test, Exception $e, $time)
                        PHPUnit_Util_Filter::getFilteredStacktrace($e, FALSE);
 
             $error = $this->document->createElement(
-              'error',
-              htmlspecialchars(
-                PHPUnit_Util_XML::convertToUtf8($buffer),
-                ENT_COMPAT,
-                'UTF-8'
-              )
+              'error', PHPUnit_Util_XML::prepareString($buffer)
             );
 
             $error->setAttribute('type', get_class($e));
@@ -226,12 +221,7 @@ public function addFailure(PHPUnit_Framework_Test $test, PHPUnit_Framework_Asser
                            );
 
                 $failure = $this->document->createElement(
-                  'failure',
-                  htmlspecialchars(
-                    PHPUnit_Util_XML::convertToUtf8($buffer),
-                    ENT_COMPAT,
-                    'UTF-8'
-                  )
+                  'failure', PHPUnit_Util_XML::prepareString($buffer)
                 );
 
                 $failure->setAttribute('type', get_class($e));
@@ -255,13 +245,9 @@ public function addIncompleteTest(PHPUnit_Framework_Test $test, Exception $e, $t
         if ($this->logIncompleteSkipped && $this->currentTestCase !== NULL) {
             $error = $this->document->createElement(
               'error',
-              htmlspecialchars(
-                PHPUnit_Util_XML::convertToUtf8(
-                  "Incomplete Test\n" .
-                  PHPUnit_Util_Filter::getFilteredStacktrace($e, FALSE)
-                ),
-                ENT_COMPAT,
-                'UTF-8'
+              PHPUnit_Util_XML::prepareString(
+                "Incomplete Test\n" .
+                PHPUnit_Util_Filter::getFilteredStacktrace($e, FALSE)
               )
             );
 
@@ -288,13 +274,9 @@ public function addSkippedTest(PHPUnit_Framework_Test $test, Exception $e, $time
         if ($this->logIncompleteSkipped && $this->currentTestCase !== NULL) {
             $error = $this->document->createElement(
               'error',
-              htmlspecialchars(
-                PHPUnit_Util_XML::convertToUtf8(
-                  "Skipped Test\n" .
-                  PHPUnit_Util_Filter::getFilteredStacktrace($e, FALSE)
-                ),
-                ENT_COMPAT,
-                'UTF-8'
+              PHPUnit_Util_XML::prepareString(
+                "Skipped Test\n" .
+                PHPUnit_Util_Filter::getFilteredStacktrace($e, FALSE)
               )
             );
 
diff --git a/PHPUnit/Util/XML.php b/PHPUnit/Util/XML.php
index 964b6c7e1..c63753877 100644
--- a/PHPUnit/Util/XML.php
+++ b/PHPUnit/Util/XML.php
@@ -60,6 +60,23 @@
  */
 class PHPUnit_Util_XML
 {
+    /**
+     * @param  string $string
+     * @return string
+     * @author Kore Nordmann <mail@kore-nordmann.de>
+     * @since  Method available since Release 3.4.6
+     */
+    public static function prepareString($string)
+    {
+        return preg_replace(
+          '([\\x00-\\x04\\x0b\\x0c\\x0e-\\x1f\\x7f])e',
+          'sprintf( "&#x%02x;", ord( "\\1" ) )',
+          htmlspecialchars(
+            self::convertToUtf8($string), ENT_COMPAT, 'UTF-8'
+          )
+        );
+    }
+
     /**
      * Converts a string to UTF-8 encoding.
      *
@@ -67,7 +84,7 @@ class PHPUnit_Util_XML
      * @return string
      * @since  Method available since Release 3.2.19
      */
-    public static function convertToUtf8($string)
+    protected static function convertToUtf8($string)
     {
         if (!self::isUtf8($string)) {
             if (function_exists('mb_convert_encoding')) {
@@ -87,7 +104,7 @@ public static function convertToUtf8($string)
      * @return boolean
      * @since  Method available since Release 3.3.0
      */
-    public static function isUtf8($string)
+    protected static function isUtf8($string)
     {
         $length = strlen($string);
 
