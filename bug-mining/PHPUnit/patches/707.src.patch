diff --git a/src/Framework/TestSuite.php b/src/Framework/TestSuite.php
index 6c1978139..e6d2b164b 100644
--- a/src/Framework/TestSuite.php
+++ b/src/Framework/TestSuite.php
@@ -292,7 +292,7 @@ public function count(): int
 
     public function isEmpty(): bool
     {
-        return $this->count() === 0;
+        return empty($this->tests);
     }
 
     /**
diff --git a/tests/end-to-end/regression/5138.phpt b/tests/end-to-end/regression/5138.phpt
new file mode 100644
index 000000000..f6e6b73d0
--- /dev/null
+++ b/tests/end-to-end/regression/5138.phpt
@@ -0,0 +1,31 @@
+--TEST--
+https://github.com/sebastianbergmann/phpunit/issues/5138
+--FILE--
+<?php declare(strict_types=1);
+$_SERVER['argv'][] = '--do-not-cache-result';
+$_SERVER['argv'][] = '--configuration';
+$_SERVER['argv'][] = __DIR__ . '/5138/';
+
+require_once __DIR__ . '/../../bootstrap.php';
+(new PHPUnit\TextUI\Application)->run($_SERVER['argv']);
+--EXPECTF--
+PHPUnit %s by Sebastian Bergmann and contributors.
+
+Runtime: %s
+Configuration: %s
+
+There was 1 PHPUnit error:
+
+1) PHPUnit\TestFixture\Issue5138Test::testOne
+The data provider specified for PHPUnit\TestFixture\Issue5138Test::testOne is invalid
+message
+
+%s:%d
+
+--
+
+There was 1 PHPUnit warning:
+
+1) No tests found in class "PHPUnit\TestFixture\Issue5138Test".
+
+No tests executed!
diff --git a/tests/end-to-end/regression/5138/phpunit.xml b/tests/end-to-end/regression/5138/phpunit.xml
new file mode 100644
index 000000000..1689799b6
--- /dev/null
+++ b/tests/end-to-end/regression/5138/phpunit.xml
@@ -0,0 +1,9 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<phpunit xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:noNamespaceSchemaLocation="../../../../phpunit.xsd">
+    <testsuites>
+        <testsuite name="default">
+            <directory>tests</directory>
+        </testsuite>
+    </testsuites>
+</phpunit>
diff --git a/tests/end-to-end/regression/5138/tests/Issue5138Test.php b/tests/end-to-end/regression/5138/tests/Issue5138Test.php
new file mode 100644
index 000000000..a2098c0cf
--- /dev/null
+++ b/tests/end-to-end/regression/5138/tests/Issue5138Test.php
@@ -0,0 +1,27 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture;
+
+use PHPUnit\Framework\Attributes\DataProvider;
+use PHPUnit\Framework\TestCase;
+use RuntimeException;
+
+final class Issue5138Test extends TestCase
+{
+    public static function provideData(): void
+    {
+        throw new RuntimeException('message');
+    }
+
+    #[DataProvider('provideData')]
+    public function testOne(): void
+    {
+    }
+}
