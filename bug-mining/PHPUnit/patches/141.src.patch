diff --git a/PHPUnit/Framework/TestSuite.php b/PHPUnit/Framework/TestSuite.php
index ecfbc2288..b66a01dc8 100644
--- a/PHPUnit/Framework/TestSuite.php
+++ b/PHPUnit/Framework/TestSuite.php
@@ -366,14 +366,18 @@ public function addTestFile($filename, $syntaxCheck = FALSE, $phptOptions = arra
         }
 
         PHPUnit_Util_Class::collectStart();
-        PHPUnit_Util_Fileloader::checkAndLoad($filename, $syntaxCheck);
+        $filename   = PHPUnit_Util_Fileloader::checkAndLoad($filename, $syntaxCheck);
         $newClasses = PHPUnit_Util_Class::collectEnd();
         $baseName   = str_replace('.php', '', basename($filename));
 
         foreach ($newClasses as $className) {
             if (substr($className, 0 - strlen($baseName)) == $baseName) {
-                $newClasses = array($className);
-                break;
+                $class = new ReflectionClass($className);                
+                
+                if ($class->getFileName() == $filename) {
+                    $newClasses = array($className);
+                    break;
+                }
             }
         }
 
diff --git a/PHPUnit/Util/Fileloader.php b/PHPUnit/Util/Fileloader.php
index e79048fca..6d7cd9e8c 100644
--- a/PHPUnit/Util/Fileloader.php
+++ b/PHPUnit/Util/Fileloader.php
@@ -64,6 +64,7 @@ class PHPUnit_Util_Fileloader
      *
      * @param  string  $filename
      * @param  boolean $syntaxCheck
+     * @return string
      * @throws RuntimeException
      */
     public static function checkAndLoad($filename, $syntaxCheck = FALSE)
@@ -83,6 +84,8 @@ public static function checkAndLoad($filename, $syntaxCheck = FALSE)
         }
 
         self::load($includePathFilename);
+
+        return $includePathFilename;
     }
 
     /**
