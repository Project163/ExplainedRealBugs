diff --git a/ChangeLog-12.0.md b/ChangeLog-12.0.md
index 66cc47ec4..7f42f365d 100644
--- a/ChangeLog-12.0.md
+++ b/ChangeLog-12.0.md
@@ -2,6 +2,12 @@
 
 All notable changes of the PHPUnit 12.0 release series are documented in this file using the [Keep a CHANGELOG](https://keepachangelog.com/) principles.
 
+## [12.0.9] - 2025-MM-DD
+
+### Fixed
+
+* [#6154](https://github.com/sebastianbergmann/phpunit/issues/6154): Method `with()` on test doubles yields error with static analyzer
+
 ## [12.0.8] - 2025-03-18
 
 ### Changed
@@ -104,6 +110,7 @@ All notable changes of the PHPUnit 12.0 release series are documented in this fi
 * [#5801](https://github.com/sebastianbergmann/phpunit/issues/5801): Support for targeting traits with `#[CoversClass]` and `#[UsesClass]` attributes
 * [#5978](https://github.com/sebastianbergmann/phpunit/issues/5978): Support for PHP 8.2
 
+[12.0.9]: https://github.com/sebastianbergmann/phpunit/compare/12.0.8...12.0
 [12.0.8]: https://github.com/sebastianbergmann/phpunit/compare/12.0.7...12.0.8
 [12.0.7]: https://github.com/sebastianbergmann/phpunit/compare/12.0.6...12.0.7
 [12.0.6]: https://github.com/sebastianbergmann/phpunit/compare/12.0.5...12.0.6
diff --git a/src/Framework/MockObject/Runtime/Api/Method.php b/src/Framework/MockObject/Runtime/Api/Method.php
index 35833a693..e69e530d4 100644
--- a/src/Framework/MockObject/Runtime/Api/Method.php
+++ b/src/Framework/MockObject/Runtime/Api/Method.php
@@ -10,7 +10,6 @@
 namespace PHPUnit\Framework\MockObject;
 
 use PHPUnit\Framework\Constraint\Constraint;
-use PHPUnit\Framework\MockObject\Builder\InvocationMocker;
 use PHPUnit\Framework\MockObject\Rule\AnyInvokedCount;
 use PHPUnit\Framework\MockObject\Runtime\PropertyHook;
 
@@ -23,7 +22,7 @@ trait Method
 {
     abstract public function __phpunit_getInvocationHandler(): InvocationHandler;
 
-    public function method(Constraint|PropertyHook|string $constraint): InvocationMocker
+    public function method(Constraint|PropertyHook|string $constraint): InvocationStubberImplementation
     {
         return $this
             ->__phpunit_getInvocationHandler()
diff --git a/src/Framework/MockObject/Runtime/Api/MockObjectApi.php b/src/Framework/MockObject/Runtime/Api/MockObjectApi.php
index 6589d50d2..a95772596 100644
--- a/src/Framework/MockObject/Runtime/Api/MockObjectApi.php
+++ b/src/Framework/MockObject/Runtime/Api/MockObjectApi.php
@@ -9,7 +9,7 @@
  */
 namespace PHPUnit\Framework\MockObject;
 
-use PHPUnit\Framework\MockObject\Builder\InvocationMocker as InvocationMockerBuilder;
+use PHPUnit\Framework\MockObject\InvocationStubberImplementation as InvocationMockerBuilder;
 use PHPUnit\Framework\MockObject\Rule\InvocationOrder;
 
 /**
diff --git a/src/Framework/MockObject/Runtime/Builder/Identity.php b/src/Framework/MockObject/Runtime/Builder/Identity.php
deleted file mode 100644
index 07a9d37cf..000000000
--- a/src/Framework/MockObject/Runtime/Builder/Identity.php
+++ /dev/null
@@ -1,25 +0,0 @@
-<?php declare(strict_types=1);
-/*
- * This file is part of PHPUnit.
- *
- * (c) Sebastian Bergmann <sebastian@phpunit.de>
- *
- * For the full copyright and license information, please view the LICENSE
- * file that was distributed with this source code.
- */
-namespace PHPUnit\Framework\MockObject\Builder;
-
-/**
- * @no-named-arguments Parameter names are not covered by the backward compatibility promise for PHPUnit
- *
- * @internal This class is not covered by the backward compatibility promise for PHPUnit
- */
-interface Identity
-{
-    /**
-     * Sets the identification of the expectation to $id.
-     *
-     * @note The identifier is unique per mock object.
-     */
-    public function id(string $id): self;
-}
diff --git a/src/Framework/MockObject/Runtime/Builder/MethodNameMatch.php b/src/Framework/MockObject/Runtime/Builder/MethodNameMatch.php
deleted file mode 100644
index c25e8df7c..000000000
--- a/src/Framework/MockObject/Runtime/Builder/MethodNameMatch.php
+++ /dev/null
@@ -1,26 +0,0 @@
-<?php declare(strict_types=1);
-/*
- * This file is part of PHPUnit.
- *
- * (c) Sebastian Bergmann <sebastian@phpunit.de>
- *
- * For the full copyright and license information, please view the LICENSE
- * file that was distributed with this source code.
- */
-namespace PHPUnit\Framework\MockObject\Builder;
-
-use PHPUnit\Framework\Constraint\Constraint;
-
-/**
- * @no-named-arguments Parameter names are not covered by the backward compatibility promise for PHPUnit
- *
- * @internal This class is not covered by the backward compatibility promise for PHPUnit
- */
-interface MethodNameMatch extends ParametersMatch
-{
-    /**
-     * Adds a new method name match and returns the parameter match object for
-     * further matching possibilities.
-     */
-    public function method(Constraint|string $constraint): self;
-}
diff --git a/src/Framework/MockObject/Runtime/Builder/ParametersMatch.php b/src/Framework/MockObject/Runtime/Builder/ParametersMatch.php
deleted file mode 100644
index 96493d441..000000000
--- a/src/Framework/MockObject/Runtime/Builder/ParametersMatch.php
+++ /dev/null
@@ -1,51 +0,0 @@
-<?php declare(strict_types=1);
-/*
- * This file is part of PHPUnit.
- *
- * (c) Sebastian Bergmann <sebastian@phpunit.de>
- *
- * For the full copyright and license information, please view the LICENSE
- * file that was distributed with this source code.
- */
-namespace PHPUnit\Framework\MockObject\Builder;
-
-/**
- * @no-named-arguments Parameter names are not covered by the backward compatibility promise for PHPUnit
- *
- * @internal This class is not covered by the backward compatibility promise for PHPUnit
- */
-interface ParametersMatch extends Stub
-{
-    /**
-     * Defines the expectation which must occur before the current is valid.
-     */
-    public function after(string $id): Stub;
-
-    /**
-     * Sets the parameters to match for, each parameter to this function will
-     * be part of match. To perform specific matches or constraints create a
-     * new PHPUnit\Framework\Constraint\Constraint and use it for the parameter.
-     * If the parameter value is not a constraint it will use the
-     * PHPUnit\Framework\Constraint\IsEqual for the value.
-     *
-     * Some examples:
-     * <code>
-     * // match first parameter with value 2
-     * $b->with(2);
-     * // match first parameter with value 'smock' and second identical to 42
-     * $b->with('smock', new PHPUnit\Framework\Constraint\IsEqual(42));
-     * </code>
-     */
-    public function with(mixed ...$arguments): self;
-
-    /**
-     * Sets a rule which allows any kind of parameters.
-     *
-     * Some examples:
-     * <code>
-     * // match any number of parameters
-     * $b->withAnyParameters();
-     * </code>
-     */
-    public function withAnyParameters(): self;
-}
diff --git a/src/Framework/MockObject/Runtime/Builder/Stub.php b/src/Framework/MockObject/Runtime/Builder/Stub.php
deleted file mode 100644
index fce475490..000000000
--- a/src/Framework/MockObject/Runtime/Builder/Stub.php
+++ /dev/null
@@ -1,26 +0,0 @@
-<?php declare(strict_types=1);
-/*
- * This file is part of PHPUnit.
- *
- * (c) Sebastian Bergmann <sebastian@phpunit.de>
- *
- * For the full copyright and license information, please view the LICENSE
- * file that was distributed with this source code.
- */
-namespace PHPUnit\Framework\MockObject\Builder;
-
-use PHPUnit\Framework\MockObject\Stub\Stub as BaseStub;
-
-/**
- * @no-named-arguments Parameter names are not covered by the backward compatibility promise for PHPUnit
- *
- * @internal This class is not covered by the backward compatibility promise for PHPUnit
- */
-interface Stub extends Identity
-{
-    /**
-     * Stubs the matching method with the stub object $stub. Any invocations of
-     * the matched method will now be handled by the stub instead.
-     */
-    public function will(BaseStub $stub): Identity;
-}
diff --git a/src/Framework/MockObject/Runtime/Builder/InvocationStubber.php b/src/Framework/MockObject/Runtime/Interface/InvocationStubber.php
similarity index 71%
rename from src/Framework/MockObject/Runtime/Builder/InvocationStubber.php
rename to src/Framework/MockObject/Runtime/Interface/InvocationStubber.php
index 774fef25d..d52da4df9 100644
--- a/src/Framework/MockObject/Runtime/Builder/InvocationStubber.php
+++ b/src/Framework/MockObject/Runtime/Interface/InvocationStubber.php
@@ -7,8 +7,9 @@
  * For the full copyright and license information, please view the LICENSE
  * file that was distributed with this source code.
  */
-namespace PHPUnit\Framework\MockObject\Builder;
+namespace PHPUnit\Framework\MockObject;
 
+use PHPUnit\Framework\Constraint\Constraint;
 use PHPUnit\Framework\MockObject\Stub\Stub;
 use Throwable;
 
@@ -17,7 +18,30 @@
  */
 interface InvocationStubber
 {
-    public function will(Stub $stub): Identity;
+    /**
+     * @return $this
+     */
+    public function method(Constraint|string $constraint): self;
+
+    /**
+     * @return $this
+     */
+    public function after(string $id): self;
+
+    /**
+     * @return $this
+     */
+    public function with(mixed ...$arguments): self;
+
+    /**
+     * @return $this
+     */
+    public function withAnyParameters(): self;
+
+    /**
+     * @return $this
+     */
+    public function will(Stub $stub): self;
 
     /**
      * @return $this
diff --git a/src/Framework/MockObject/Runtime/Interface/MockObject.php b/src/Framework/MockObject/Runtime/Interface/MockObject.php
index 795694dd1..0ddc46dc4 100644
--- a/src/Framework/MockObject/Runtime/Interface/MockObject.php
+++ b/src/Framework/MockObject/Runtime/Interface/MockObject.php
@@ -9,7 +9,6 @@
  */
 namespace PHPUnit\Framework\MockObject;
 
-use PHPUnit\Framework\MockObject\Builder\InvocationMocker;
 use PHPUnit\Framework\MockObject\Rule\InvocationOrder;
 
 /**
@@ -17,5 +16,5 @@
  */
 interface MockObject extends Stub
 {
-    public function expects(InvocationOrder $invocationRule): InvocationMocker;
+    public function expects(InvocationOrder $invocationRule): InvocationStubber;
 }
diff --git a/src/Framework/MockObject/Runtime/Interface/Stub.php b/src/Framework/MockObject/Runtime/Interface/Stub.php
index dbbb198a3..6321c98bb 100644
--- a/src/Framework/MockObject/Runtime/Interface/Stub.php
+++ b/src/Framework/MockObject/Runtime/Interface/Stub.php
@@ -10,7 +10,6 @@
 namespace PHPUnit\Framework\MockObject;
 
 use PHPUnit\Framework\Constraint\Constraint;
-use PHPUnit\Framework\MockObject\Builder\InvocationStubber;
 use PHPUnit\Framework\MockObject\Runtime\PropertyHook;
 
 /**
diff --git a/src/Framework/MockObject/Runtime/InvocationHandler.php b/src/Framework/MockObject/Runtime/InvocationHandler.php
index a8b6f744d..60098b9ad 100644
--- a/src/Framework/MockObject/Runtime/InvocationHandler.php
+++ b/src/Framework/MockObject/Runtime/InvocationHandler.php
@@ -11,7 +11,6 @@
 
 use function strtolower;
 use Exception;
-use PHPUnit\Framework\MockObject\Builder\InvocationMocker;
 use PHPUnit\Framework\MockObject\Rule\InvocationOrder;
 use Throwable;
 
@@ -81,12 +80,12 @@ public function registerMatcher(string $id, Matcher $matcher): void
         $this->matcherMap[$id] = $matcher;
     }
 
-    public function expects(InvocationOrder $rule): InvocationMocker
+    public function expects(InvocationOrder $rule): InvocationStubberImplementation
     {
         $matcher = new Matcher($rule);
         $this->addMatcher($matcher);
 
-        return new InvocationMocker(
+        return new InvocationStubberImplementation(
             $this,
             $matcher,
             ...$this->configurableMethods,
diff --git a/src/Framework/MockObject/Runtime/Builder/InvocationMocker.php b/src/Framework/MockObject/Runtime/InvocationStubberImplementation.php
similarity index 91%
rename from src/Framework/MockObject/Runtime/Builder/InvocationMocker.php
rename to src/Framework/MockObject/Runtime/InvocationStubberImplementation.php
index f605ab287..2503378bc 100644
--- a/src/Framework/MockObject/Runtime/Builder/InvocationMocker.php
+++ b/src/Framework/MockObject/Runtime/InvocationStubberImplementation.php
@@ -7,7 +7,7 @@
  * For the full copyright and license information, please view the LICENSE
  * file that was distributed with this source code.
  */
-namespace PHPUnit\Framework\MockObject\Builder;
+namespace PHPUnit\Framework\MockObject;
 
 use function array_flip;
 use function array_key_exists;
@@ -21,16 +21,6 @@
 use function strtolower;
 use PHPUnit\Framework\Constraint\Constraint;
 use PHPUnit\Framework\InvalidArgumentException;
-use PHPUnit\Framework\MockObject\ConfigurableMethod;
-use PHPUnit\Framework\MockObject\IncompatibleReturnValueException;
-use PHPUnit\Framework\MockObject\InvocationHandler;
-use PHPUnit\Framework\MockObject\Matcher;
-use PHPUnit\Framework\MockObject\MatcherAlreadyRegisteredException;
-use PHPUnit\Framework\MockObject\MethodCannotBeConfiguredException;
-use PHPUnit\Framework\MockObject\MethodNameAlreadyConfiguredException;
-use PHPUnit\Framework\MockObject\MethodNameNotConfiguredException;
-use PHPUnit\Framework\MockObject\MethodParametersAlreadyConfiguredException;
-use PHPUnit\Framework\MockObject\Rule;
 use PHPUnit\Framework\MockObject\Runtime\PropertyHook;
 use PHPUnit\Framework\MockObject\Stub\ConsecutiveCalls;
 use PHPUnit\Framework\MockObject\Stub\Exception;
@@ -45,8 +35,10 @@
 
 /**
  * @no-named-arguments Parameter names are not covered by the backward compatibility promise for PHPUnit
+ *
+ * @internal This class is not covered by the backward compatibility promise for PHPUnit
  */
-final class InvocationMocker implements InvocationStubber, MethodNameMatch
+final class InvocationStubberImplementation implements InvocationStubber
 {
     private readonly InvocationHandler $invocationHandler;
     private readonly Matcher $matcher;
@@ -83,7 +75,7 @@ public function id(string $id): self
     /**
      * @return $this
      */
-    public function will(Stub $stub): Identity
+    public function will(Stub $stub): self
     {
         $this->matcher->setStub($stub);
 
