diff --git a/src/TextUI/Command.php b/src/TextUI/Command.php
index 5fef96902..47b512f2c 100644
--- a/src/TextUI/Command.php
+++ b/src/TextUI/Command.php
@@ -835,21 +835,25 @@ protected function handleSelfUpdate()
 
         print 'Updating the PHPUnit PHAR ... ';
 
+        $options = array(
+            'ssl' => array(
+                'allow_self_signed' => false,
+                'cafile' => $caFile,
+                'verify_peer' => true
+            )
+        );
+
+        if (PHP_VERSION_ID < 50600) {
+            $options['ssl']['CN_match']        = 'phar.phpunit.de';
+            $options['ssl']['SNI_server_name'] = 'phar.phpunit.de';
+        }
+
         file_put_contents(
           $tempFilename,
           file_get_contents(
             $remoteFilename,
             false,
-            stream_context_create(
-              array(
-                'ssl' => array(
-                  'CN_match' => 'phar.phpunit.de',
-                  'allow_self_signed' => false,
-                  'cafile' => $caFile,
-                  'verify_peer' => true
-                )
-              )
-            )
+            stream_context_create($options)
           )
         );
 
