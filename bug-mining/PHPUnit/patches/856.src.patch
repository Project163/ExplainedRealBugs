diff --git a/ChangeLog-11.3.md b/ChangeLog-11.3.md
index 973cffa5a..82639c292 100644
--- a/ChangeLog-11.3.md
+++ b/ChangeLog-11.3.md
@@ -9,6 +9,7 @@ All notable changes of the PHPUnit 11.3 release series are documented in this fi
 * [#5869](https://github.com/sebastianbergmann/phpunit/pull/5869): `shortenArraysForExportThreshold` attribute on the `<phpunit>` element of the XML configuration file to limit the export of arrays to a specified number of elements (default: `0` / do not limit the export of arrays)
 * [#5885](https://github.com/sebastianbergmann/phpunit/pull/5885): Optionally repeat TestDox output for non-successful tests after the regular TestDox output
 * [#5890](https://github.com/sebastianbergmann/phpunit/pull/5890): Priority for hook methods
+* [#5906](https://github.com/sebastianbergmann/phpunit/issues/5906): `--extension` CLI option to register a test runner extension
 
 ### Changed
 
diff --git a/phpunit.xml b/phpunit.xml
index 862fa9baa..bb101958e 100644
--- a/phpunit.xml
+++ b/phpunit.xml
@@ -18,7 +18,8 @@
             <directory suffix=".phpt">tests/end-to-end/data-provider</directory>
             <directory suffix=".phpt">tests/end-to-end/event</directory>
             <directory suffix=".phpt">tests/end-to-end/execution-order</directory>
-            <directory suffix=".phpt">tests/end-to-end/extension</directory>
+            <directory suffix=".phpt">tests/end-to-end/extension-cli</directory>
+            <directory suffix=".phpt">tests/end-to-end/extension-xml</directory>
             <directory suffix=".phpt">tests/end-to-end/generic</directory>
             <directory suffix=".phpt">tests/end-to-end/groups-from-configuration</directory>
             <directory suffix=".phpt">tests/end-to-end/logging</directory>
diff --git a/src/TextUI/Configuration/Cli/Builder.php b/src/TextUI/Configuration/Cli/Builder.php
index acf62e7a4..996f8b395 100644
--- a/src/TextUI/Configuration/Cli/Builder.php
+++ b/src/TextUI/Configuration/Cli/Builder.php
@@ -134,6 +134,7 @@ final class Builder
         'log-events-verbose-text=',
         'version',
         'debug',
+        'extension=',
     ];
     private const SHORT_OPTIONS = 'd:c:h';
 
@@ -261,6 +262,7 @@ public function fromParameters(array $parameters): Configuration
         $printerTestDox                    = null;
         $printerTestDoxSummary             = null;
         $debug                             = false;
+        $extensions                        = [];
 
         foreach ($options[0] as $option) {
             $optionAllowedMultipleTimes = false;
@@ -937,6 +939,13 @@ public function fromParameters(array $parameters): Configuration
                 case '--debug':
                     $debug = true;
 
+                    break;
+
+                case '--extension':
+                    $extensions[] = $option[1];
+
+                    $optionAllowedMultipleTimes = true;
+
                     break;
             }
 
@@ -953,6 +962,10 @@ public function fromParameters(array $parameters): Configuration
             $coverageFilter = null;
         }
 
+        if (empty($extensions)) {
+            $extensions = null;
+        }
+
         return new Configuration(
             $options[1],
             $atLeastVersion,
@@ -1053,6 +1066,7 @@ public function fromParameters(array $parameters): Configuration
             $printerTestDox,
             $printerTestDoxSummary,
             $debug,
+            $extensions,
         );
     }
 
diff --git a/src/TextUI/Configuration/Cli/Configuration.php b/src/TextUI/Configuration/Cli/Configuration.php
index 49e2b6c62..fce5563c9 100644
--- a/src/TextUI/Configuration/Cli/Configuration.php
+++ b/src/TextUI/Configuration/Cli/Configuration.php
@@ -149,6 +149,11 @@
     private ?string $logEventsVerboseText;
     private bool $debug;
 
+    /**
+     * @var ?non-empty-list<non-empty-string>
+     */
+    private ?array $extensions;
+
     /**
      * @param list<non-empty-string>                               $arguments
      * @param ?non-empty-list<non-empty-string>                    $excludeGroups
@@ -158,8 +163,9 @@
      * @param ?non-empty-array<non-empty-string, non-empty-string> $iniSettings
      * @param ?non-empty-list<non-empty-string>                    $testSuffixes
      * @param ?non-empty-list<non-empty-string>                    $coverageFilter
+     * @param ?non-empty-list<non-empty-string>                    $extensions
      */
-    public function __construct(array $arguments, ?string $atLeastVersion, ?bool $backupGlobals, ?bool $backupStaticProperties, ?bool $beStrictAboutChangesToGlobalState, ?string $bootstrap, ?string $cacheDirectory, ?bool $cacheResult, bool $checkVersion, ?string $colors, null|int|string $columns, ?string $configurationFile, ?string $coverageClover, ?string $coverageCobertura, ?string $coverageCrap4J, ?string $coverageHtml, ?string $coveragePhp, ?string $coverageText, ?bool $coverageTextShowUncoveredFiles, ?bool $coverageTextShowOnlySummary, ?string $coverageXml, ?bool $pathCoverage, bool $warmCoverageCache, ?int $defaultTimeLimit, ?bool $disableCodeCoverageIgnore, ?bool $disallowTestOutput, ?bool $enforceTimeLimit, ?array $excludeGroups, ?int $executionOrder, ?int $executionOrderDefects, ?bool $failOnDeprecation, ?bool $failOnEmptyTestSuite, ?bool $failOnIncomplete, ?bool $failOnNotice, ?bool $failOnRisky, ?bool $failOnSkipped, ?bool $failOnWarning, ?bool $stopOnDefect, ?bool $stopOnDeprecation, ?bool $stopOnError, ?bool $stopOnFailure, ?bool $stopOnIncomplete, ?bool $stopOnNotice, ?bool $stopOnRisky, ?bool $stopOnSkipped, ?bool $stopOnWarning, ?string $filter, ?string $excludeFilter, ?string $generateBaseline, ?string $useBaseline, bool $ignoreBaseline, bool $generateConfiguration, bool $migrateConfiguration, ?array $groups, ?array $testsCovering, ?array $testsUsing, bool $help, ?string $includePath, ?array $iniSettings, ?string $junitLogfile, bool $listGroups, bool $listSuites, bool $listTestFiles, bool $listTests, ?string $listTestsXml, ?bool $noCoverage, ?bool $noExtensions, ?bool $noOutput, ?bool $noProgress, ?bool $noResults, ?bool $noLogging, ?bool $processIsolation, ?int $randomOrderSeed, ?bool $reportUselessTests, ?bool $resolveDependencies, ?bool $reverseList, ?bool $stderr, ?bool $strictCoverage, ?string $teamcityLogfile, ?string $testdoxHtmlFile, ?string $testdoxTextFile, ?array $testSuffixes, ?string $testSuite, ?string $excludeTestSuite, bool $useDefaultConfiguration, ?bool $displayDetailsOnIncompleteTests, ?bool $displayDetailsOnSkippedTests, ?bool $displayDetailsOnTestsThatTriggerDeprecations, ?bool $displayDetailsOnTestsThatTriggerErrors, ?bool $displayDetailsOnTestsThatTriggerNotices, ?bool $displayDetailsOnTestsThatTriggerWarnings, bool $version, ?array $coverageFilter, ?string $logEventsText, ?string $logEventsVerboseText, ?bool $printerTeamCity, ?bool $testdoxPrinter, ?bool $testdoxPrinterSummary, bool $debug)
+    public function __construct(array $arguments, ?string $atLeastVersion, ?bool $backupGlobals, ?bool $backupStaticProperties, ?bool $beStrictAboutChangesToGlobalState, ?string $bootstrap, ?string $cacheDirectory, ?bool $cacheResult, bool $checkVersion, ?string $colors, null|int|string $columns, ?string $configurationFile, ?string $coverageClover, ?string $coverageCobertura, ?string $coverageCrap4J, ?string $coverageHtml, ?string $coveragePhp, ?string $coverageText, ?bool $coverageTextShowUncoveredFiles, ?bool $coverageTextShowOnlySummary, ?string $coverageXml, ?bool $pathCoverage, bool $warmCoverageCache, ?int $defaultTimeLimit, ?bool $disableCodeCoverageIgnore, ?bool $disallowTestOutput, ?bool $enforceTimeLimit, ?array $excludeGroups, ?int $executionOrder, ?int $executionOrderDefects, ?bool $failOnDeprecation, ?bool $failOnEmptyTestSuite, ?bool $failOnIncomplete, ?bool $failOnNotice, ?bool $failOnRisky, ?bool $failOnSkipped, ?bool $failOnWarning, ?bool $stopOnDefect, ?bool $stopOnDeprecation, ?bool $stopOnError, ?bool $stopOnFailure, ?bool $stopOnIncomplete, ?bool $stopOnNotice, ?bool $stopOnRisky, ?bool $stopOnSkipped, ?bool $stopOnWarning, ?string $filter, ?string $excludeFilter, ?string $generateBaseline, ?string $useBaseline, bool $ignoreBaseline, bool $generateConfiguration, bool $migrateConfiguration, ?array $groups, ?array $testsCovering, ?array $testsUsing, bool $help, ?string $includePath, ?array $iniSettings, ?string $junitLogfile, bool $listGroups, bool $listSuites, bool $listTestFiles, bool $listTests, ?string $listTestsXml, ?bool $noCoverage, ?bool $noExtensions, ?bool $noOutput, ?bool $noProgress, ?bool $noResults, ?bool $noLogging, ?bool $processIsolation, ?int $randomOrderSeed, ?bool $reportUselessTests, ?bool $resolveDependencies, ?bool $reverseList, ?bool $stderr, ?bool $strictCoverage, ?string $teamcityLogfile, ?string $testdoxHtmlFile, ?string $testdoxTextFile, ?array $testSuffixes, ?string $testSuite, ?string $excludeTestSuite, bool $useDefaultConfiguration, ?bool $displayDetailsOnIncompleteTests, ?bool $displayDetailsOnSkippedTests, ?bool $displayDetailsOnTestsThatTriggerDeprecations, ?bool $displayDetailsOnTestsThatTriggerErrors, ?bool $displayDetailsOnTestsThatTriggerNotices, ?bool $displayDetailsOnTestsThatTriggerWarnings, bool $version, ?array $coverageFilter, ?string $logEventsText, ?string $logEventsVerboseText, ?bool $printerTeamCity, ?bool $testdoxPrinter, ?bool $testdoxPrinterSummary, bool $debug, ?array $extensions)
     {
         $this->arguments                                    = $arguments;
         $this->atLeastVersion                               = $atLeastVersion;
@@ -260,6 +266,7 @@ public function __construct(array $arguments, ?string $atLeastVersion, ?bool $ba
         $this->testdoxPrinter                               = $testdoxPrinter;
         $this->testdoxPrinterSummary                        = $testdoxPrinterSummary;
         $this->debug                                        = $debug;
+        $this->extensions                                   = $extensions;
     }
 
     /**
@@ -2048,4 +2055,26 @@ public function debug(): bool
     {
         return $this->debug;
     }
+
+    /**
+     * @phpstan-assert-if-true !null $this->extensions
+     */
+    public function hasExtensions(): bool
+    {
+        return $this->extensions !== null;
+    }
+
+    /**
+     * @throws Exception
+     *
+     * @return non-empty-list<non-empty-string>
+     */
+    public function extensions(): array
+    {
+        if (!$this->hasExtensions()) {
+            throw new Exception;
+        }
+
+        return $this->extensions;
+    }
 }
diff --git a/src/TextUI/Configuration/Merger.php b/src/TextUI/Configuration/Merger.php
index be2dac800..2c70c4f9c 100644
--- a/src/TextUI/Configuration/Merger.php
+++ b/src/TextUI/Configuration/Merger.php
@@ -237,6 +237,15 @@ public function merge(CliConfiguration $cliConfiguration, XmlConfiguration $xmlC
 
         $extensionBootstrappers = [];
 
+        if ($cliConfiguration->hasExtensions()) {
+            foreach ($cliConfiguration->extensions() as $extension) {
+                $extensionBootstrappers[] = [
+                    'className'  => $extension,
+                    'parameters' => [],
+                ];
+            }
+        }
+
         foreach ($xmlConfiguration->extensions() as $extension) {
             $extensionBootstrappers[] = [
                 'className'  => $extension->className(),
diff --git a/src/TextUI/Help.php b/src/TextUI/Help.php
index 39ad5483b..4caea2649 100644
--- a/src/TextUI/Help.php
+++ b/src/TextUI/Help.php
@@ -157,7 +157,8 @@ private function elements(): array
                 ['arg' => '--bootstrap <file>', 'desc' => 'A PHP script that is included before the tests run'],
                 ['arg' => '-c|--configuration <file>', 'desc' => 'Read configuration from XML file'],
                 ['arg' => '--no-configuration', 'desc' => 'Ignore default configuration file (phpunit.xml)'],
-                ['arg' => '--no-extensions', 'desc' => 'Do not load PHPUnit extensions'],
+                ['arg' => '--extension <class>', 'desc' => 'Register test runner extension with bootstrap <class>'],
+                ['arg' => '--no-extensions', 'desc' => 'Do not register test runner extensions'],
                 ['arg' => '--include-path <path(s)>', 'desc' => 'Prepend PHP\'s include_path with given path(s)'],
                 ['arg' => '-d <key[=value]>', 'desc' => 'Sets a php.ini value'],
                 ['arg' => '--cache-directory <dir>', 'desc' => 'Specify cache directory'],
diff --git a/tests/end-to-end/_files/output-cli-help-color.txt b/tests/end-to-end/_files/output-cli-help-color.txt
index b6a2dfa41..bcded7233 100644
--- a/tests/end-to-end/_files/output-cli-help-color.txt
+++ b/tests/end-to-end/_files/output-cli-help-color.txt
@@ -8,7 +8,9 @@
   [32m-c|--configuration [36m<file>[0m         [0m Read configuration from XML file
   [32m--no-configuration                [0m Ignore default configuration file
                                      (phpunit.xml)
-  [32m--no-extensions                   [0m Do not load PHPUnit extensions
+  [32m--extension [36m<class>[0m               [0m Register test runner extension with
+                                     bootstrap <class>
+  [32m--no-extensions                   [0m Do not register test runner extensions
   [32m--include-path [36m<path(s)>[0m          [0m Prepend PHP's include_path with given
                                      path(s)
   [32m-d [36m<key[=value]>[0m                  [0m Sets a php.ini value
diff --git a/tests/end-to-end/_files/output-cli-usage.txt b/tests/end-to-end/_files/output-cli-usage.txt
index 59098dbce..36a637921 100644
--- a/tests/end-to-end/_files/output-cli-usage.txt
+++ b/tests/end-to-end/_files/output-cli-usage.txt
@@ -8,7 +8,8 @@ Configuration:
   --bootstrap <file>                 A PHP script that is included before the tests run
   -c|--configuration <file>          Read configuration from XML file
   --no-configuration                 Ignore default configuration file (phpunit.xml)
-  --no-extensions                    Do not load PHPUnit extensions
+  --extension <class>                Register test runner extension with bootstrap <class>
+  --no-extensions                    Do not register test runner extensions
   --include-path <path(s)>           Prepend PHP's include_path with given path(s)
   -d <key[=value]>                   Sets a php.ini value
   --cache-directory <dir>            Specify cache directory
diff --git a/tests/end-to-end/extension-cli/_files/class-does-not-exist/phpunit.xml b/tests/end-to-end/extension-cli/_files/class-does-not-exist/phpunit.xml
new file mode 100644
index 000000000..c4d7b898f
--- /dev/null
+++ b/tests/end-to-end/extension-cli/_files/class-does-not-exist/phpunit.xml
@@ -0,0 +1,9 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<phpunit xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:noNamespaceSchemaLocation="../../../../../phpunit.xsd">
+    <testsuites>
+        <testsuite name="default">
+            <directory>tests</directory>
+        </testsuite>
+    </testsuites>
+</phpunit>
diff --git a/tests/end-to-end/extension/_files/class-does-not-exist/tests/Test.php b/tests/end-to-end/extension-cli/_files/class-does-not-exist/tests/Test.php
similarity index 100%
rename from tests/end-to-end/extension/_files/class-does-not-exist/tests/Test.php
rename to tests/end-to-end/extension-cli/_files/class-does-not-exist/tests/Test.php
diff --git a/tests/end-to-end/extension-cli/_files/class-does-not-implement-interface/phpunit.xml b/tests/end-to-end/extension-cli/_files/class-does-not-implement-interface/phpunit.xml
new file mode 100644
index 000000000..aaa950205
--- /dev/null
+++ b/tests/end-to-end/extension-cli/_files/class-does-not-implement-interface/phpunit.xml
@@ -0,0 +1,10 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<phpunit xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:noNamespaceSchemaLocation="../../../../../phpunit.xsd"
+         bootstrap="src/autoload.php">
+    <testsuites>
+        <testsuite name="default">
+            <directory>tests</directory>
+        </testsuite>
+    </testsuites>
+</phpunit>
diff --git a/tests/end-to-end/extension/_files/class-does-not-implement-interface/src/MyExtensionBootstrap.php b/tests/end-to-end/extension-cli/_files/class-does-not-implement-interface/src/MyExtensionBootstrap.php
similarity index 100%
rename from tests/end-to-end/extension/_files/class-does-not-implement-interface/src/MyExtensionBootstrap.php
rename to tests/end-to-end/extension-cli/_files/class-does-not-implement-interface/src/MyExtensionBootstrap.php
diff --git a/tests/end-to-end/extension/_files/class-does-not-implement-interface/src/autoload.php b/tests/end-to-end/extension-cli/_files/class-does-not-implement-interface/src/autoload.php
similarity index 100%
rename from tests/end-to-end/extension/_files/class-does-not-implement-interface/src/autoload.php
rename to tests/end-to-end/extension-cli/_files/class-does-not-implement-interface/src/autoload.php
diff --git a/tests/end-to-end/extension/_files/class-does-not-implement-interface/tests/Test.php b/tests/end-to-end/extension-cli/_files/class-does-not-implement-interface/tests/Test.php
similarity index 100%
rename from tests/end-to-end/extension/_files/class-does-not-implement-interface/tests/Test.php
rename to tests/end-to-end/extension-cli/_files/class-does-not-implement-interface/tests/Test.php
diff --git a/tests/end-to-end/extension-cli/_files/exception-in-extension-bootstrap-method/phpunit.xml b/tests/end-to-end/extension-cli/_files/exception-in-extension-bootstrap-method/phpunit.xml
new file mode 100644
index 000000000..aaa950205
--- /dev/null
+++ b/tests/end-to-end/extension-cli/_files/exception-in-extension-bootstrap-method/phpunit.xml
@@ -0,0 +1,10 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<phpunit xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:noNamespaceSchemaLocation="../../../../../phpunit.xsd"
+         bootstrap="src/autoload.php">
+    <testsuites>
+        <testsuite name="default">
+            <directory>tests</directory>
+        </testsuite>
+    </testsuites>
+</phpunit>
diff --git a/tests/end-to-end/extension/_files/exception-in-extension-bootstrap-method/src/MyExtensionBootstrap.php b/tests/end-to-end/extension-cli/_files/exception-in-extension-bootstrap-method/src/MyExtensionBootstrap.php
similarity index 100%
rename from tests/end-to-end/extension/_files/exception-in-extension-bootstrap-method/src/MyExtensionBootstrap.php
rename to tests/end-to-end/extension-cli/_files/exception-in-extension-bootstrap-method/src/MyExtensionBootstrap.php
diff --git a/tests/end-to-end/extension/_files/exception-in-extension-bootstrap-method/src/autoload.php b/tests/end-to-end/extension-cli/_files/exception-in-extension-bootstrap-method/src/autoload.php
similarity index 100%
rename from tests/end-to-end/extension/_files/exception-in-extension-bootstrap-method/src/autoload.php
rename to tests/end-to-end/extension-cli/_files/exception-in-extension-bootstrap-method/src/autoload.php
diff --git a/tests/end-to-end/extension/_files/exception-in-extension-bootstrap-method/tests/Test.php b/tests/end-to-end/extension-cli/_files/exception-in-extension-bootstrap-method/tests/Test.php
similarity index 100%
rename from tests/end-to-end/extension/_files/exception-in-extension-bootstrap-method/tests/Test.php
rename to tests/end-to-end/extension-cli/_files/exception-in-extension-bootstrap-method/tests/Test.php
diff --git a/tests/end-to-end/extension-cli/_files/exception-in-extension-constructor/phpunit.xml b/tests/end-to-end/extension-cli/_files/exception-in-extension-constructor/phpunit.xml
new file mode 100644
index 000000000..aaa950205
--- /dev/null
+++ b/tests/end-to-end/extension-cli/_files/exception-in-extension-constructor/phpunit.xml
@@ -0,0 +1,10 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<phpunit xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:noNamespaceSchemaLocation="../../../../../phpunit.xsd"
+         bootstrap="src/autoload.php">
+    <testsuites>
+        <testsuite name="default">
+            <directory>tests</directory>
+        </testsuite>
+    </testsuites>
+</phpunit>
diff --git a/tests/end-to-end/extension/_files/exception-in-extension-constructor/src/MyExtensionBootstrap.php b/tests/end-to-end/extension-cli/_files/exception-in-extension-constructor/src/MyExtensionBootstrap.php
similarity index 100%
rename from tests/end-to-end/extension/_files/exception-in-extension-constructor/src/MyExtensionBootstrap.php
rename to tests/end-to-end/extension-cli/_files/exception-in-extension-constructor/src/MyExtensionBootstrap.php
diff --git a/tests/end-to-end/extension/_files/exception-in-extension-constructor/src/autoload.php b/tests/end-to-end/extension-cli/_files/exception-in-extension-constructor/src/autoload.php
similarity index 100%
rename from tests/end-to-end/extension/_files/exception-in-extension-constructor/src/autoload.php
rename to tests/end-to-end/extension-cli/_files/exception-in-extension-constructor/src/autoload.php
diff --git a/tests/end-to-end/extension/_files/exception-in-extension-constructor/tests/Test.php b/tests/end-to-end/extension-cli/_files/exception-in-extension-constructor/tests/Test.php
similarity index 100%
rename from tests/end-to-end/extension/_files/exception-in-extension-constructor/tests/Test.php
rename to tests/end-to-end/extension-cli/_files/exception-in-extension-constructor/tests/Test.php
diff --git a/tests/end-to-end/extension-cli/_files/exception-in-extension-subscriber/phpunit.xml b/tests/end-to-end/extension-cli/_files/exception-in-extension-subscriber/phpunit.xml
new file mode 100644
index 000000000..aaa950205
--- /dev/null
+++ b/tests/end-to-end/extension-cli/_files/exception-in-extension-subscriber/phpunit.xml
@@ -0,0 +1,10 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<phpunit xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:noNamespaceSchemaLocation="../../../../../phpunit.xsd"
+         bootstrap="src/autoload.php">
+    <testsuites>
+        <testsuite name="default">
+            <directory>tests</directory>
+        </testsuite>
+    </testsuites>
+</phpunit>
diff --git a/tests/end-to-end/extension/_files/exception-in-extension-subscriber/src/MyExecutionFinishedSubscriber.php b/tests/end-to-end/extension-cli/_files/exception-in-extension-subscriber/src/MyExecutionFinishedSubscriber.php
similarity index 100%
rename from tests/end-to-end/extension/_files/exception-in-extension-subscriber/src/MyExecutionFinishedSubscriber.php
rename to tests/end-to-end/extension-cli/_files/exception-in-extension-subscriber/src/MyExecutionFinishedSubscriber.php
diff --git a/tests/end-to-end/extension/_files/exception-in-extension-subscriber/src/MyExtensionBootstrap.php b/tests/end-to-end/extension-cli/_files/exception-in-extension-subscriber/src/MyExtensionBootstrap.php
similarity index 100%
rename from tests/end-to-end/extension/_files/exception-in-extension-subscriber/src/MyExtensionBootstrap.php
rename to tests/end-to-end/extension-cli/_files/exception-in-extension-subscriber/src/MyExtensionBootstrap.php
diff --git a/tests/end-to-end/extension/_files/exception-in-extension-subscriber/src/autoload.php b/tests/end-to-end/extension-cli/_files/exception-in-extension-subscriber/src/autoload.php
similarity index 100%
rename from tests/end-to-end/extension/_files/exception-in-extension-subscriber/src/autoload.php
rename to tests/end-to-end/extension-cli/_files/exception-in-extension-subscriber/src/autoload.php
diff --git a/tests/end-to-end/extension/_files/exception-in-extension-subscriber/tests/Test.php b/tests/end-to-end/extension-cli/_files/exception-in-extension-subscriber/tests/Test.php
similarity index 100%
rename from tests/end-to-end/extension/_files/exception-in-extension-subscriber/tests/Test.php
rename to tests/end-to-end/extension-cli/_files/exception-in-extension-subscriber/tests/Test.php
diff --git a/tests/end-to-end/extension-cli/_files/extension-bootstrap/phpunit.xml b/tests/end-to-end/extension-cli/_files/extension-bootstrap/phpunit.xml
new file mode 100644
index 000000000..aaa950205
--- /dev/null
+++ b/tests/end-to-end/extension-cli/_files/extension-bootstrap/phpunit.xml
@@ -0,0 +1,10 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<phpunit xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:noNamespaceSchemaLocation="../../../../../phpunit.xsd"
+         bootstrap="src/autoload.php">
+    <testsuites>
+        <testsuite name="default">
+            <directory>tests</directory>
+        </testsuite>
+    </testsuites>
+</phpunit>
diff --git a/tests/end-to-end/extension/_files/extension-bootstrap/src/MyExecutionFinishedSubscriber.php b/tests/end-to-end/extension-cli/_files/extension-bootstrap/src/MyExecutionFinishedSubscriber.php
similarity index 100%
rename from tests/end-to-end/extension/_files/extension-bootstrap/src/MyExecutionFinishedSubscriber.php
rename to tests/end-to-end/extension-cli/_files/extension-bootstrap/src/MyExecutionFinishedSubscriber.php
diff --git a/tests/end-to-end/extension-cli/_files/extension-bootstrap/src/MyExtensionBootstrap.php b/tests/end-to-end/extension-cli/_files/extension-bootstrap/src/MyExtensionBootstrap.php
new file mode 100644
index 000000000..a80872588
--- /dev/null
+++ b/tests/end-to-end/extension-cli/_files/extension-bootstrap/src/MyExtensionBootstrap.php
@@ -0,0 +1,27 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture\Event\MyExtension;
+
+use PHPUnit\Runner\Extension\Extension;
+use PHPUnit\Runner\Extension\Facade;
+use PHPUnit\Runner\Extension\ParameterCollection;
+use PHPUnit\TextUI\Configuration\Configuration;
+
+final class MyExtensionBootstrap implements Extension
+{
+    public function bootstrap(Configuration $configuration, Facade $facade, ParameterCollection $parameters): void
+    {
+        $facade->registerSubscriber(
+            new MyExecutionFinishedSubscriber(
+                'the-message',
+            ),
+        );
+    }
+}
diff --git a/tests/end-to-end/extension/_files/extension-bootstrap/src/autoload.php b/tests/end-to-end/extension-cli/_files/extension-bootstrap/src/autoload.php
similarity index 100%
rename from tests/end-to-end/extension/_files/extension-bootstrap/src/autoload.php
rename to tests/end-to-end/extension-cli/_files/extension-bootstrap/src/autoload.php
diff --git a/tests/end-to-end/extension/_files/extension-bootstrap/tests/Test.php b/tests/end-to-end/extension-cli/_files/extension-bootstrap/tests/Test.php
similarity index 100%
rename from tests/end-to-end/extension/_files/extension-bootstrap/tests/Test.php
rename to tests/end-to-end/extension-cli/_files/extension-bootstrap/tests/Test.php
diff --git a/tests/end-to-end/extension-cli/bootstrap.phpt b/tests/end-to-end/extension-cli/bootstrap.phpt
new file mode 100644
index 000000000..256a9e4fd
--- /dev/null
+++ b/tests/end-to-end/extension-cli/bootstrap.phpt
@@ -0,0 +1,17 @@
+--TEST--
+A PHPUnit extension can subscribe to events
+--FILE--
+<?php declare(strict_types=1);
+$_SERVER['argv'][] = '--do-not-cache-result';
+$_SERVER['argv'][] = '--no-output';
+$_SERVER['argv'][] = '--configuration';
+$_SERVER['argv'][] = __DIR__ . '/_files/extension-bootstrap/phpunit.xml';
+$_SERVER['argv'][] = '--extension';
+$_SERVER['argv'][] = 'PHPUnit\TestFixture\Event\MyExtension\MyExtensionBootstrap';
+
+require __DIR__ . '/../../bootstrap.php';
+
+(new PHPUnit\TextUI\Application)->run($_SERVER['argv']);
+--EXPECTF--
+PHPUnit\TestFixture\Event\MyExtension\MyExecutionFinishedSubscriber::notify
+the-message
diff --git a/tests/end-to-end/extension-cli/class-does-not-exist.phpt b/tests/end-to-end/extension-cli/class-does-not-exist.phpt
new file mode 100644
index 000000000..0b9a8991c
--- /dev/null
+++ b/tests/end-to-end/extension-cli/class-does-not-exist.phpt
@@ -0,0 +1,29 @@
+--TEST--
+Test runner exits with error when configured extension class does not exit
+--FILE--
+<?php declare(strict_types=1);
+$_SERVER['argv'][] = '--do-not-cache-result';
+$_SERVER['argv'][] = '--configuration';
+$_SERVER['argv'][] = __DIR__ . '/_files/class-does-not-exist/phpunit.xml';
+$_SERVER['argv'][] = '--extension';
+$_SERVER['argv'][] = 'Does\Not\Exist';
+
+require __DIR__ . '/../../bootstrap.php';
+
+(new PHPUnit\TextUI\Application)->run($_SERVER['argv']);
+--EXPECTF--
+PHPUnit %s by Sebastian Bergmann and contributors.
+
+Runtime: %s
+Configuration: %s
+
+.                                                                   1 / 1 (100%)
+
+Time: %s, Memory: %s
+
+There was 1 PHPUnit test runner warning:
+
+1) Cannot bootstrap extension because class Does\Not\Exist does not exist
+
+WARNINGS!
+Tests: 1, Assertions: 1, Warnings: 1.
diff --git a/tests/end-to-end/extension-cli/class-does-not-implement-interface.phpt b/tests/end-to-end/extension-cli/class-does-not-implement-interface.phpt
new file mode 100644
index 000000000..f9b6a0b11
--- /dev/null
+++ b/tests/end-to-end/extension-cli/class-does-not-implement-interface.phpt
@@ -0,0 +1,29 @@
+--TEST--
+Test runner exits with error when configured extension class does not implement the interface
+--FILE--
+<?php declare(strict_types=1);
+$_SERVER['argv'][] = '--do-not-cache-result';
+$_SERVER['argv'][] = '--configuration';
+$_SERVER['argv'][] = __DIR__ . '/_files/class-does-not-implement-interface/phpunit.xml';
+$_SERVER['argv'][] = '--extension';
+$_SERVER['argv'][] = 'PHPUnit\TestFixture\Event\MyExtension\MyExtensionBootstrap';
+
+require __DIR__ . '/../../bootstrap.php';
+
+(new PHPUnit\TextUI\Application)->run($_SERVER['argv']);
+--EXPECTF--
+PHPUnit %s by Sebastian Bergmann and contributors.
+
+Runtime: %s
+Configuration: %s
+
+.                                                                   1 / 1 (100%)
+
+Time: %s, Memory: %s
+
+There was 1 PHPUnit test runner warning:
+
+1) Cannot bootstrap extension because class PHPUnit\TestFixture\Event\MyExtension\MyExtensionBootstrap does not implement interface PHPUnit\Runner\Extension\Extension
+
+WARNINGS!
+Tests: 1, Assertions: 1, Warnings: 1.
diff --git a/tests/end-to-end/extension-cli/exception-in-extension-bootstrap-method.phpt b/tests/end-to-end/extension-cli/exception-in-extension-bootstrap-method.phpt
new file mode 100644
index 000000000..7725280a7
--- /dev/null
+++ b/tests/end-to-end/extension-cli/exception-in-extension-bootstrap-method.phpt
@@ -0,0 +1,30 @@
+--TEST--
+Test runner warning is triggered when an exception is triggered in an extension's bootstrap method
+--FILE--
+<?php declare(strict_types=1);
+$_SERVER['argv'][] = '--do-not-cache-result';
+$_SERVER['argv'][] = '--configuration';
+$_SERVER['argv'][] = __DIR__ . '/_files/exception-in-extension-bootstrap-method/phpunit.xml';
+$_SERVER['argv'][] = '--extension';
+$_SERVER['argv'][] = 'PHPUnit\TestFixture\Event\MyExtension\MyExtensionBootstrap';
+
+require __DIR__ . '/../../bootstrap.php';
+
+(new PHPUnit\TextUI\Application)->run($_SERVER['argv']);
+--EXPECTF--
+PHPUnit %s by Sebastian Bergmann and contributors.
+
+Runtime: %s
+Configuration: %s
+
+.                                                                   1 / 1 (100%)
+
+Time: %s, Memory: %s
+
+There was 1 PHPUnit test runner warning:
+
+1) Bootstrapping of extension PHPUnit\TestFixture\Event\MyExtension\MyExtensionBootstrap failed: message
+%A
+
+WARNINGS!
+Tests: 1, Assertions: 1, Warnings: 1.
diff --git a/tests/end-to-end/extension-cli/exception-in-extension-constructor.phpt b/tests/end-to-end/extension-cli/exception-in-extension-constructor.phpt
new file mode 100644
index 000000000..37fe9b998
--- /dev/null
+++ b/tests/end-to-end/extension-cli/exception-in-extension-constructor.phpt
@@ -0,0 +1,30 @@
+--TEST--
+Test runner warning is triggered when an exception is triggered in an extension's bootstrap class' constructor
+--FILE--
+<?php declare(strict_types=1);
+$_SERVER['argv'][] = '--do-not-cache-result';
+$_SERVER['argv'][] = '--configuration';
+$_SERVER['argv'][] = __DIR__ . '/_files/exception-in-extension-constructor/phpunit.xml';
+$_SERVER['argv'][] = '--extension';
+$_SERVER['argv'][] = 'PHPUnit\TestFixture\Event\MyExtension\MyExtensionBootstrap';
+
+require __DIR__ . '/../../bootstrap.php';
+
+(new PHPUnit\TextUI\Application)->run($_SERVER['argv']);
+--EXPECTF--
+PHPUnit %s by Sebastian Bergmann and contributors.
+
+Runtime: %s
+Configuration: %s
+
+.                                                                   1 / 1 (100%)
+
+Time: %s, Memory: %s
+
+There was 1 PHPUnit test runner warning:
+
+1) Bootstrapping of extension PHPUnit\TestFixture\Event\MyExtension\MyExtensionBootstrap failed: message
+%A
+
+WARNINGS!
+Tests: 1, Assertions: 1, Warnings: 1.
diff --git a/tests/end-to-end/extension-cli/exception-in-extension-subscriber.phpt b/tests/end-to-end/extension-cli/exception-in-extension-subscriber.phpt
new file mode 100644
index 000000000..7013dfb52
--- /dev/null
+++ b/tests/end-to-end/extension-cli/exception-in-extension-subscriber.phpt
@@ -0,0 +1,30 @@
+--TEST--
+Test runner warning is triggered when an exception is triggered in an extension's event subscriber
+--FILE--
+<?php declare(strict_types=1);
+$_SERVER['argv'][] = '--do-not-cache-result';
+$_SERVER['argv'][] = '--configuration';
+$_SERVER['argv'][] = __DIR__ . '/_files/exception-in-extension-subscriber/phpunit.xml';
+$_SERVER['argv'][] = '--extension';
+$_SERVER['argv'][] = 'PHPUnit\TestFixture\Event\MyExtension\MyExtensionBootstrap';
+
+require __DIR__ . '/../../bootstrap.php';
+
+(new PHPUnit\TextUI\Application)->run($_SERVER['argv']);
+--EXPECTF--
+PHPUnit %s by Sebastian Bergmann and contributors.
+
+Runtime: %s
+Configuration: %s
+
+.                                                                   1 / 1 (100%)
+
+Time: %s, Memory: %s
+
+There was 1 PHPUnit test runner warning:
+
+1) Exception in third-party event subscriber: message
+%A
+
+WARNINGS!
+Tests: 1, Assertions: 1, Warnings: 1.
diff --git a/tests/end-to-end/extension/_files/class-does-not-exist/phpunit.xml b/tests/end-to-end/extension-xml/_files/class-does-not-exist/phpunit.xml
similarity index 100%
rename from tests/end-to-end/extension/_files/class-does-not-exist/phpunit.xml
rename to tests/end-to-end/extension-xml/_files/class-does-not-exist/phpunit.xml
diff --git a/tests/end-to-end/extension-xml/_files/class-does-not-exist/tests/Test.php b/tests/end-to-end/extension-xml/_files/class-does-not-exist/tests/Test.php
new file mode 100644
index 000000000..a6c86c857
--- /dev/null
+++ b/tests/end-to-end/extension-xml/_files/class-does-not-exist/tests/Test.php
@@ -0,0 +1,20 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture\Event\MyExtension;
+
+use PHPUnit\Framework\TestCase;
+
+final class Test extends TestCase
+{
+    public function testOne(): void
+    {
+        $this->assertTrue(true);
+    }
+}
diff --git a/tests/end-to-end/extension/_files/class-does-not-implement-interface/phpunit.xml b/tests/end-to-end/extension-xml/_files/class-does-not-implement-interface/phpunit.xml
similarity index 100%
rename from tests/end-to-end/extension/_files/class-does-not-implement-interface/phpunit.xml
rename to tests/end-to-end/extension-xml/_files/class-does-not-implement-interface/phpunit.xml
diff --git a/tests/end-to-end/extension-xml/_files/class-does-not-implement-interface/src/MyExtensionBootstrap.php b/tests/end-to-end/extension-xml/_files/class-does-not-implement-interface/src/MyExtensionBootstrap.php
new file mode 100644
index 000000000..0fbf797d5
--- /dev/null
+++ b/tests/end-to-end/extension-xml/_files/class-does-not-implement-interface/src/MyExtensionBootstrap.php
@@ -0,0 +1,14 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture\Event\MyExtension;
+
+final class MyExtensionBootstrap
+{
+}
diff --git a/tests/end-to-end/extension-xml/_files/class-does-not-implement-interface/src/autoload.php b/tests/end-to-end/extension-xml/_files/class-does-not-implement-interface/src/autoload.php
new file mode 100644
index 000000000..c84415b04
--- /dev/null
+++ b/tests/end-to-end/extension-xml/_files/class-does-not-implement-interface/src/autoload.php
@@ -0,0 +1,11 @@
+<?php declare(strict_types=1);
+
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+require __DIR__ . '/MyExtensionBootstrap.php';
diff --git a/tests/end-to-end/extension-xml/_files/class-does-not-implement-interface/tests/Test.php b/tests/end-to-end/extension-xml/_files/class-does-not-implement-interface/tests/Test.php
new file mode 100644
index 000000000..a6c86c857
--- /dev/null
+++ b/tests/end-to-end/extension-xml/_files/class-does-not-implement-interface/tests/Test.php
@@ -0,0 +1,20 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture\Event\MyExtension;
+
+use PHPUnit\Framework\TestCase;
+
+final class Test extends TestCase
+{
+    public function testOne(): void
+    {
+        $this->assertTrue(true);
+    }
+}
diff --git a/tests/end-to-end/extension/_files/exception-in-extension-bootstrap-method/phpunit.xml b/tests/end-to-end/extension-xml/_files/exception-in-extension-bootstrap-method/phpunit.xml
similarity index 100%
rename from tests/end-to-end/extension/_files/exception-in-extension-bootstrap-method/phpunit.xml
rename to tests/end-to-end/extension-xml/_files/exception-in-extension-bootstrap-method/phpunit.xml
diff --git a/tests/end-to-end/extension-xml/_files/exception-in-extension-bootstrap-method/src/MyExtensionBootstrap.php b/tests/end-to-end/extension-xml/_files/exception-in-extension-bootstrap-method/src/MyExtensionBootstrap.php
new file mode 100644
index 000000000..763a61a70
--- /dev/null
+++ b/tests/end-to-end/extension-xml/_files/exception-in-extension-bootstrap-method/src/MyExtensionBootstrap.php
@@ -0,0 +1,24 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture\Event\MyExtension;
+
+use PHPUnit\Runner\Extension\Extension;
+use PHPUnit\Runner\Extension\Facade;
+use PHPUnit\Runner\Extension\ParameterCollection;
+use PHPUnit\TextUI\Configuration\Configuration;
+use RuntimeException;
+
+final class MyExtensionBootstrap implements Extension
+{
+    public function bootstrap(Configuration $configuration, Facade $facade, ParameterCollection $parameters): void
+    {
+        throw new RuntimeException('message');
+    }
+}
diff --git a/tests/end-to-end/extension-xml/_files/exception-in-extension-bootstrap-method/src/autoload.php b/tests/end-to-end/extension-xml/_files/exception-in-extension-bootstrap-method/src/autoload.php
new file mode 100644
index 000000000..c84415b04
--- /dev/null
+++ b/tests/end-to-end/extension-xml/_files/exception-in-extension-bootstrap-method/src/autoload.php
@@ -0,0 +1,11 @@
+<?php declare(strict_types=1);
+
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+require __DIR__ . '/MyExtensionBootstrap.php';
diff --git a/tests/end-to-end/extension-xml/_files/exception-in-extension-bootstrap-method/tests/Test.php b/tests/end-to-end/extension-xml/_files/exception-in-extension-bootstrap-method/tests/Test.php
new file mode 100644
index 000000000..a6c86c857
--- /dev/null
+++ b/tests/end-to-end/extension-xml/_files/exception-in-extension-bootstrap-method/tests/Test.php
@@ -0,0 +1,20 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture\Event\MyExtension;
+
+use PHPUnit\Framework\TestCase;
+
+final class Test extends TestCase
+{
+    public function testOne(): void
+    {
+        $this->assertTrue(true);
+    }
+}
diff --git a/tests/end-to-end/extension/_files/exception-in-extension-constructor/phpunit-without-parameter.xml b/tests/end-to-end/extension-xml/_files/exception-in-extension-constructor/phpunit-without-parameter.xml
similarity index 100%
rename from tests/end-to-end/extension/_files/exception-in-extension-constructor/phpunit-without-parameter.xml
rename to tests/end-to-end/extension-xml/_files/exception-in-extension-constructor/phpunit-without-parameter.xml
diff --git a/tests/end-to-end/extension/_files/exception-in-extension-constructor/phpunit.xml b/tests/end-to-end/extension-xml/_files/exception-in-extension-constructor/phpunit.xml
similarity index 100%
rename from tests/end-to-end/extension/_files/exception-in-extension-constructor/phpunit.xml
rename to tests/end-to-end/extension-xml/_files/exception-in-extension-constructor/phpunit.xml
diff --git a/tests/end-to-end/extension-xml/_files/exception-in-extension-constructor/src/MyExtensionBootstrap.php b/tests/end-to-end/extension-xml/_files/exception-in-extension-constructor/src/MyExtensionBootstrap.php
new file mode 100644
index 000000000..596734060
--- /dev/null
+++ b/tests/end-to-end/extension-xml/_files/exception-in-extension-constructor/src/MyExtensionBootstrap.php
@@ -0,0 +1,28 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture\Event\MyExtension;
+
+use PHPUnit\Runner\Extension\Extension;
+use PHPUnit\Runner\Extension\Facade;
+use PHPUnit\Runner\Extension\ParameterCollection;
+use PHPUnit\TextUI\Configuration\Configuration;
+use RuntimeException;
+
+final class MyExtensionBootstrap implements Extension
+{
+    public function __construct()
+    {
+        throw new RuntimeException('message');
+    }
+
+    public function bootstrap(Configuration $configuration, Facade $facade, ParameterCollection $parameters): void
+    {
+    }
+}
diff --git a/tests/end-to-end/extension-xml/_files/exception-in-extension-constructor/src/autoload.php b/tests/end-to-end/extension-xml/_files/exception-in-extension-constructor/src/autoload.php
new file mode 100644
index 000000000..c84415b04
--- /dev/null
+++ b/tests/end-to-end/extension-xml/_files/exception-in-extension-constructor/src/autoload.php
@@ -0,0 +1,11 @@
+<?php declare(strict_types=1);
+
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+require __DIR__ . '/MyExtensionBootstrap.php';
diff --git a/tests/end-to-end/extension-xml/_files/exception-in-extension-constructor/tests/Test.php b/tests/end-to-end/extension-xml/_files/exception-in-extension-constructor/tests/Test.php
new file mode 100644
index 000000000..a6c86c857
--- /dev/null
+++ b/tests/end-to-end/extension-xml/_files/exception-in-extension-constructor/tests/Test.php
@@ -0,0 +1,20 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture\Event\MyExtension;
+
+use PHPUnit\Framework\TestCase;
+
+final class Test extends TestCase
+{
+    public function testOne(): void
+    {
+        $this->assertTrue(true);
+    }
+}
diff --git a/tests/end-to-end/extension/_files/exception-in-extension-subscriber/phpunit.xml b/tests/end-to-end/extension-xml/_files/exception-in-extension-subscriber/phpunit.xml
similarity index 100%
rename from tests/end-to-end/extension/_files/exception-in-extension-subscriber/phpunit.xml
rename to tests/end-to-end/extension-xml/_files/exception-in-extension-subscriber/phpunit.xml
diff --git a/tests/end-to-end/extension-xml/_files/exception-in-extension-subscriber/src/MyExecutionFinishedSubscriber.php b/tests/end-to-end/extension-xml/_files/exception-in-extension-subscriber/src/MyExecutionFinishedSubscriber.php
new file mode 100644
index 000000000..2c4719b88
--- /dev/null
+++ b/tests/end-to-end/extension-xml/_files/exception-in-extension-subscriber/src/MyExecutionFinishedSubscriber.php
@@ -0,0 +1,22 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture\Event\MyExtension;
+
+use PHPUnit\Event\TestRunner\ExecutionFinished;
+use PHPUnit\Event\TestRunner\ExecutionFinishedSubscriber;
+use RuntimeException;
+
+final class MyExecutionFinishedSubscriber implements ExecutionFinishedSubscriber
+{
+    public function notify(ExecutionFinished $event): void
+    {
+        throw new RuntimeException('message');
+    }
+}
diff --git a/tests/end-to-end/extension-xml/_files/exception-in-extension-subscriber/src/MyExtensionBootstrap.php b/tests/end-to-end/extension-xml/_files/exception-in-extension-subscriber/src/MyExtensionBootstrap.php
new file mode 100644
index 000000000..9c0174a96
--- /dev/null
+++ b/tests/end-to-end/extension-xml/_files/exception-in-extension-subscriber/src/MyExtensionBootstrap.php
@@ -0,0 +1,23 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture\Event\MyExtension;
+
+use PHPUnit\Runner\Extension\Extension;
+use PHPUnit\Runner\Extension\Facade;
+use PHPUnit\Runner\Extension\ParameterCollection;
+use PHPUnit\TextUI\Configuration\Configuration;
+
+final class MyExtensionBootstrap implements Extension
+{
+    public function bootstrap(Configuration $configuration, Facade $facade, ParameterCollection $parameters): void
+    {
+        $facade->registerSubscriber(new MyExecutionFinishedSubscriber);
+    }
+}
diff --git a/tests/end-to-end/extension-xml/_files/exception-in-extension-subscriber/src/autoload.php b/tests/end-to-end/extension-xml/_files/exception-in-extension-subscriber/src/autoload.php
new file mode 100644
index 000000000..98531b415
--- /dev/null
+++ b/tests/end-to-end/extension-xml/_files/exception-in-extension-subscriber/src/autoload.php
@@ -0,0 +1,13 @@
+<?php declare(strict_types=1);
+
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+require __DIR__ . '/MyExtensionBootstrap.php';
+
+require __DIR__ . '/MyExecutionFinishedSubscriber.php';
diff --git a/tests/end-to-end/extension-xml/_files/exception-in-extension-subscriber/tests/Test.php b/tests/end-to-end/extension-xml/_files/exception-in-extension-subscriber/tests/Test.php
new file mode 100644
index 000000000..a6c86c857
--- /dev/null
+++ b/tests/end-to-end/extension-xml/_files/exception-in-extension-subscriber/tests/Test.php
@@ -0,0 +1,20 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture\Event\MyExtension;
+
+use PHPUnit\Framework\TestCase;
+
+final class Test extends TestCase
+{
+    public function testOne(): void
+    {
+        $this->assertTrue(true);
+    }
+}
diff --git a/tests/end-to-end/extension/_files/extension-bootstrap/phpunit-without-parameter.xml b/tests/end-to-end/extension-xml/_files/extension-bootstrap/phpunit-without-parameter.xml
similarity index 100%
rename from tests/end-to-end/extension/_files/extension-bootstrap/phpunit-without-parameter.xml
rename to tests/end-to-end/extension-xml/_files/extension-bootstrap/phpunit-without-parameter.xml
diff --git a/tests/end-to-end/extension/_files/extension-bootstrap/phpunit.xml b/tests/end-to-end/extension-xml/_files/extension-bootstrap/phpunit.xml
similarity index 100%
rename from tests/end-to-end/extension/_files/extension-bootstrap/phpunit.xml
rename to tests/end-to-end/extension-xml/_files/extension-bootstrap/phpunit.xml
diff --git a/tests/end-to-end/extension-xml/_files/extension-bootstrap/src/MyExecutionFinishedSubscriber.php b/tests/end-to-end/extension-xml/_files/extension-bootstrap/src/MyExecutionFinishedSubscriber.php
new file mode 100644
index 000000000..7e7be9153
--- /dev/null
+++ b/tests/end-to-end/extension-xml/_files/extension-bootstrap/src/MyExecutionFinishedSubscriber.php
@@ -0,0 +1,30 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture\Event\MyExtension;
+
+use const PHP_EOL;
+use PHPUnit\Event\TestRunner\ExecutionFinished;
+use PHPUnit\Event\TestRunner\ExecutionFinishedSubscriber;
+
+final class MyExecutionFinishedSubscriber implements ExecutionFinishedSubscriber
+{
+    private readonly string $message;
+
+    public function __construct(string $message)
+    {
+        $this->message = $message;
+    }
+
+    public function notify(ExecutionFinished $event): void
+    {
+        print __METHOD__ . PHP_EOL;
+        print $this->message . PHP_EOL;
+    }
+}
diff --git a/tests/end-to-end/extension/_files/extension-bootstrap/src/MyExtensionBootstrap.php b/tests/end-to-end/extension-xml/_files/extension-bootstrap/src/MyExtensionBootstrap.php
similarity index 100%
rename from tests/end-to-end/extension/_files/extension-bootstrap/src/MyExtensionBootstrap.php
rename to tests/end-to-end/extension-xml/_files/extension-bootstrap/src/MyExtensionBootstrap.php
diff --git a/tests/end-to-end/extension-xml/_files/extension-bootstrap/src/autoload.php b/tests/end-to-end/extension-xml/_files/extension-bootstrap/src/autoload.php
new file mode 100644
index 000000000..98531b415
--- /dev/null
+++ b/tests/end-to-end/extension-xml/_files/extension-bootstrap/src/autoload.php
@@ -0,0 +1,13 @@
+<?php declare(strict_types=1);
+
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+require __DIR__ . '/MyExtensionBootstrap.php';
+
+require __DIR__ . '/MyExecutionFinishedSubscriber.php';
diff --git a/tests/end-to-end/extension-xml/_files/extension-bootstrap/tests/Test.php b/tests/end-to-end/extension-xml/_files/extension-bootstrap/tests/Test.php
new file mode 100644
index 000000000..a6c86c857
--- /dev/null
+++ b/tests/end-to-end/extension-xml/_files/extension-bootstrap/tests/Test.php
@@ -0,0 +1,20 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture\Event\MyExtension;
+
+use PHPUnit\Framework\TestCase;
+
+final class Test extends TestCase
+{
+    public function testOne(): void
+    {
+        $this->assertTrue(true);
+    }
+}
diff --git a/tests/end-to-end/extension/bootstrap-with-parameter.phpt b/tests/end-to-end/extension-xml/bootstrap-with-parameter.phpt
similarity index 100%
rename from tests/end-to-end/extension/bootstrap-with-parameter.phpt
rename to tests/end-to-end/extension-xml/bootstrap-with-parameter.phpt
diff --git a/tests/end-to-end/extension/bootstrap-without-parameter.phpt b/tests/end-to-end/extension-xml/bootstrap-without-parameter.phpt
similarity index 100%
rename from tests/end-to-end/extension/bootstrap-without-parameter.phpt
rename to tests/end-to-end/extension-xml/bootstrap-without-parameter.phpt
diff --git a/tests/end-to-end/extension/class-does-not-exist.phpt b/tests/end-to-end/extension-xml/class-does-not-exist.phpt
similarity index 100%
rename from tests/end-to-end/extension/class-does-not-exist.phpt
rename to tests/end-to-end/extension-xml/class-does-not-exist.phpt
diff --git a/tests/end-to-end/extension/class-does-not-implement-interface.phpt b/tests/end-to-end/extension-xml/class-does-not-implement-interface.phpt
similarity index 100%
rename from tests/end-to-end/extension/class-does-not-implement-interface.phpt
rename to tests/end-to-end/extension-xml/class-does-not-implement-interface.phpt
diff --git a/tests/end-to-end/extension/exception-in-extension-bootstrap-method.phpt b/tests/end-to-end/extension-xml/exception-in-extension-bootstrap-method.phpt
similarity index 100%
rename from tests/end-to-end/extension/exception-in-extension-bootstrap-method.phpt
rename to tests/end-to-end/extension-xml/exception-in-extension-bootstrap-method.phpt
diff --git a/tests/end-to-end/extension/exception-in-extension-constructor.phpt b/tests/end-to-end/extension-xml/exception-in-extension-constructor.phpt
similarity index 100%
rename from tests/end-to-end/extension/exception-in-extension-constructor.phpt
rename to tests/end-to-end/extension-xml/exception-in-extension-constructor.phpt
diff --git a/tests/end-to-end/extension/exception-in-extension-subscriber.phpt b/tests/end-to-end/extension-xml/exception-in-extension-subscriber.phpt
similarity index 100%
rename from tests/end-to-end/extension/exception-in-extension-subscriber.phpt
rename to tests/end-to-end/extension-xml/exception-in-extension-subscriber.phpt
diff --git a/tests/end-to-end/extension/phar-extension.phpt b/tests/end-to-end/extension-xml/phar-extension.phpt
similarity index 100%
rename from tests/end-to-end/extension/phar-extension.phpt
rename to tests/end-to-end/extension-xml/phar-extension.phpt
