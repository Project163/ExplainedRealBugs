diff --git a/PHPUnit/Extensions/Database/DataSet/AbstractTable.php b/PHPUnit/Extensions/Database/DataSet/AbstractTable.php
index 6fd340edd..326e111b0 100644
--- a/PHPUnit/Extensions/Database/DataSet/AbstractTable.php
+++ b/PHPUnit/Extensions/Database/DataSet/AbstractTable.php
@@ -128,6 +128,25 @@ public function getValue($row, $column)
         }
     }
 
+    /**
+     * Returns the an associative array keyed by columns for the given row.
+     *
+     * @param int $row
+     * @return array
+     */
+    public function getRow($row)
+    {
+        if (isset($this->data[$row])) {
+            return $this->data[$row];
+        } else {
+            if ($this->getRowCount() <= $row) {
+                throw new InvalidArgumentException("The given row ({$row}) does not exist in table {$this->getTableMetaData()->getTableName()}");
+            } else {
+                return NULL;
+            }
+        }
+    }
+    
     /**
      * Asserts that the given table matches this table.
      *
diff --git a/PHPUnit/Extensions/Database/DataSet/FlatXmlDataSet.php b/PHPUnit/Extensions/Database/DataSet/FlatXmlDataSet.php
index d94dc14a1..bd52b50e6 100644
--- a/PHPUnit/Extensions/Database/DataSet/FlatXmlDataSet.php
+++ b/PHPUnit/Extensions/Database/DataSet/FlatXmlDataSet.php
@@ -48,6 +48,7 @@
 require_once 'PHPUnit/Util/Filter.php';
 
 require_once 'PHPUnit/Extensions/Database/DataSet/AbstractXmlDataSet.php';
+require_once 'PHPUnit/Extensions/Database/DataSet/Persistors/FlatXml.php';
 
 PHPUnit_Util_Filter::addFileToFilter(__FILE__, 'PHPUNIT');
 
@@ -94,5 +95,17 @@ protected function getTableInfo(Array &$tableColumns, Array &$tableValues)
             }
         }
     }
+    
+    public static function write(PHPUnit_Extensions_Database_DataSet_IDataSet $dataset, $filename)
+    {
+        $pers = new PHPUnit_Extensions_Database_DataSet_Persistors_FlatXml();
+        $pers->setFileName($filename);
+        
+        try {
+            $pers->write($dataset);
+        } catch (RuntimeException $e) {
+            throw new RuntimeException(__METHOD__ . ' called with an unwritable file.');
+        }
+    }
 }
 ?>
diff --git a/PHPUnit/Extensions/Database/DataSet/IPersistable.php b/PHPUnit/Extensions/Database/DataSet/IPersistable.php
new file mode 100644
index 000000000..507fcef3d
--- /dev/null
+++ b/PHPUnit/Extensions/Database/DataSet/IPersistable.php
@@ -0,0 +1,77 @@
+<?php
+/**
+ * PHPUnit
+ *
+ * Copyright (c) 2002-2008, Sebastian Bergmann <sb@sebastian-bergmann.de>.
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ *   * Redistributions of source code must retain the above copyright
+ *     notice, this list of conditions and the following disclaimer.
+ *
+ *   * Redistributions in binary form must reproduce the above copyright
+ *     notice, this list of conditions and the following disclaimer in
+ *     the documentation and/or other materials provided with the
+ *     distribution.
+ *
+ *   * Neither the name of Sebastian Bergmann nor the names of his
+ *     contributors may be used to endorse or promote products derived
+ *     from this software without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
+ * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
+ * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
+ * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
+ * COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
+ * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
+ * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+ * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
+ * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+ * POSSIBILITY OF SUCH DAMAGE.
+ *
+ * @category   Testing
+ * @package    PHPUnit
+ * @author     Mike Lively <m@digitalsandwich.com>
+ * @copyright  2002-2008 Sebastian Bergmann <sb@sebastian-bergmann.de>
+ * @license    http://www.opensource.org/licenses/bsd-license.php  BSD License
+ * @version    SVN: $Id: AbstractDataSet.php 3142 2008-06-08 07:46:30Z sb $
+ * @link       http://www.phpunit.de/
+ * @since      File available since Release 3.2.0
+ */
+
+require_once 'PHPUnit/Framework.php';
+require_once 'PHPUnit/Util/Filter.php';
+
+require_once 'PHPUnit/Extensions/Database/DataSet/IDataSet.php';
+
+PHPUnit_Util_Filter::addFileToFilter(__FILE__, 'PHPUNIT');
+
+/**
+ * An interface for persisting datasets
+ *
+ * @category   Testing
+ * @package    PHPUnit
+ * @author     Mike Lively <m@digitalsandwich.com>
+ * @copyright  2008 Mike Lively <m@digitalsandwich.com>
+ * @license    http://www.opensource.org/licenses/bsd-license.php  BSD License
+ * @version    Release: @package_version@
+ * @link       http://www.phpunit.de/
+ * @since      Class available since Release 3.3.0
+ */
+interface PHPUnit_Extensions_Database_DataSet_IPersistable
+{
+	/**
+	 * Writes the given dataset
+	 * 
+	 * The previous dataset will be overwritten.
+	 *
+	 * @param PHPUnit_Extensions_Database_DataSet_IDataSet $dataset
+	 */
+    public function write(PHPUnit_Extensions_Database_DataSet_IDataSet $dataset);
+}
+?>
diff --git a/PHPUnit/Extensions/Database/DataSet/ITable.php b/PHPUnit/Extensions/Database/DataSet/ITable.php
index 3a0f5f906..d9c6b9378 100644
--- a/PHPUnit/Extensions/Database/DataSet/ITable.php
+++ b/PHPUnit/Extensions/Database/DataSet/ITable.php
@@ -85,6 +85,14 @@ public function getRowCount();
      * @param int $column
      */
     public function getValue($row, $column);
+    
+    /**
+     * Returns the an associative array keyed by columns for the given row.
+     *
+     * @param int $row
+     * @return array
+     */
+    public function getRow($row);
 
     /**
      * Asserts that the given table matches this table.
diff --git a/PHPUnit/Extensions/Database/DataSet/Persistors/Abstract.php b/PHPUnit/Extensions/Database/DataSet/Persistors/Abstract.php
new file mode 100644
index 000000000..20fcf4a1f
--- /dev/null
+++ b/PHPUnit/Extensions/Database/DataSet/Persistors/Abstract.php
@@ -0,0 +1,137 @@
+<?php
+/**
+ * PHPUnit
+ *
+ * Copyright (c) 2002-2008, Sebastian Bergmann <sb@sebastian-bergmann.de>.
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ *   * Redistributions of source code must retain the above copyright
+ *     notice, this list of conditions and the following disclaimer.
+ *
+ *   * Redistributions in binary form must reproduce the above copyright
+ *     notice, this list of conditions and the following disclaimer in
+ *     the documentation and/or other materials provided with the
+ *     distribution.
+ *
+ *   * Neither the name of Sebastian Bergmann nor the names of his
+ *     contributors may be used to endorse or promote products derived
+ *     from this software without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
+ * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
+ * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
+ * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
+ * COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
+ * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
+ * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+ * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
+ * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+ * POSSIBILITY OF SUCH DAMAGE.
+ *
+ * @category   Testing
+ * @package    PHPUnit
+ * @author     Mike Lively <m@digitalsandwich.com>
+ * @copyright  2002-2008 Sebastian Bergmann <sb@sebastian-bergmann.de>
+ * @license    http://www.opensource.org/licenses/bsd-license.php  BSD License
+ * @version    SVN: $Id: FlatXmlDataSet.php 3170 2008-06-08 23:16:56Z mlively $
+ * @link       http://www.phpunit.de/
+ * @since      File available since Release 3.2.0
+ */
+
+require_once 'PHPUnit/Framework.php';
+require_once 'PHPUnit/Util/Filter.php';
+
+require_once 'PHPUnit/Extensions/Database/DataSet/IPersistable.php';
+
+PHPUnit_Util_Filter::addFileToFilter(__FILE__, 'PHPUNIT');
+
+
+/**
+ * An abstract implementation of a dataset persistor.
+ * 
+ * @category   Testing
+ * @package    PHPUnit
+ * @author     Mike Lively <m@digitalsandwich.com>
+ * @copyright  2008 Mike Lively <m@digitalsandwich.com>
+ * @license    http://www.opensource.org/licenses/bsd-license.php  BSD License
+ * @version    Release: @package_version@
+ * @link       http://www.phpunit.de/
+ * @since      Class available since Release 3.2.0
+ */
+abstract class PHPUnit_Extensions_Database_DataSet_Persistors_Abstract implements PHPUnit_Extensions_Database_DataSet_IPersistable 
+{
+    public function write(PHPUnit_Extensions_Database_DataSet_IDataSet $dataset)
+    {
+        $this->saveDataSet($dataset);
+    }
+    
+    /**
+     * @param PHPUnit_Extensions_Database_DataSet_IDataSet $dataset
+     */
+    protected function saveDataSet(PHPUnit_Extensions_Database_DataSet_IDataSet $dataset)
+    {
+        $this->startDataSet($dataset);
+        foreach ($dataset as $table)
+        {
+            $this->saveTable($table);
+        }
+        $this->endDataSet($dataset);
+    }
+    
+    /**
+     * @param PHPUnit_Extensions_Database_DataSet_ITable $table
+     */
+    protected function saveTable(PHPUnit_Extensions_Database_DataSet_ITable $table)
+    {
+        $this->startTable($table);
+        for ($i = 0; $i < $table->getRowCount(); $i++)
+        {
+            $this->row($table->getRow($i), $table);
+        }
+        $this->endTable($table);
+    }
+    
+    /**
+     * Override to save the start of a dataset.
+     *
+     * @param PHPUnit_Extensions_Database_DataSet_IDataSet $dataset
+     */
+    abstract protected function startDataSet(PHPUnit_Extensions_Database_DataSet_IDataSet $dataset);
+    
+    /**
+     * Override to save the end of a dataset.
+     *
+     * @param PHPUnit_Extensions_Database_DataSet_IDataSet $dataset
+     */
+    abstract protected function endDataSet(PHPUnit_Extensions_Database_DataSet_IDataSet $dataset);
+    
+    /**
+     * Override to save the start of a table.
+     *
+     * @param PHPUnit_Extensions_Database_DataSet_ITable $table
+     */
+    abstract protected function startTable(PHPUnit_Extensions_Database_DataSet_ITable $table);
+    
+    /**
+     * Override to save the end of a table.
+     *
+     * @param PHPUnit_Extensions_Database_DataSet_ITable $table
+     */
+    abstract protected function endTable(PHPUnit_Extensions_Database_DataSet_ITable $table);
+    
+    /**
+     * Override to save a table row.
+     *
+     * @param array $row
+     * @param PHPUnit_Extensions_Database_DataSet_ITable $table
+     */
+    abstract protected function row(Array $row, PHPUnit_Extensions_Database_DataSet_ITable $table);
+}
+
+?>
diff --git a/PHPUnit/Extensions/Database/DataSet/Persistors/FlatXml.php b/PHPUnit/Extensions/Database/DataSet/Persistors/FlatXml.php
new file mode 100644
index 000000000..f27ba2467
--- /dev/null
+++ b/PHPUnit/Extensions/Database/DataSet/Persistors/FlatXml.php
@@ -0,0 +1,157 @@
+<?php
+/**
+ * PHPUnit
+ *
+ * Copyright (c) 2002-2008, Sebastian Bergmann <sb@sebastian-bergmann.de>.
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ *   * Redistributions of source code must retain the above copyright
+ *     notice, this list of conditions and the following disclaimer.
+ *
+ *   * Redistributions in binary form must reproduce the above copyright
+ *     notice, this list of conditions and the following disclaimer in
+ *     the documentation and/or other materials provided with the
+ *     distribution.
+ *
+ *   * Neither the name of Sebastian Bergmann nor the names of his
+ *     contributors may be used to endorse or promote products derived
+ *     from this software without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
+ * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
+ * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
+ * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
+ * COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
+ * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
+ * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+ * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
+ * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+ * POSSIBILITY OF SUCH DAMAGE.
+ *
+ * @category   Testing
+ * @package    PHPUnit
+ * @author     Mike Lively <m@digitalsandwich.com>
+ * @copyright  2002-2008 Sebastian Bergmann <sb@sebastian-bergmann.de>
+ * @license    http://www.opensource.org/licenses/bsd-license.php  BSD License
+ * @version    SVN: $Id: FlatXmlDataSet.php 3170 2008-06-08 23:16:56Z mlively $
+ * @link       http://www.phpunit.de/
+ * @since      File available since Release 3.2.0
+ */
+
+require_once 'PHPUnit/Framework.php';
+require_once 'PHPUnit/Util/Filter.php';
+
+require_once 'PHPUnit/Extensions/Database/DataSet/Persistors/Abstract.php';
+
+PHPUnit_Util_Filter::addFileToFilter(__FILE__, 'PHPUNIT');
+
+/**
+ * A Flat XML dataset persistor.
+ * 
+ * @category   Testing
+ * @package    PHPUnit
+ * @author     Mike Lively <m@digitalsandwich.com>
+ * @copyright  2008 Mike Lively <m@digitalsandwich.com>
+ * @license    http://www.opensource.org/licenses/bsd-license.php  BSD License
+ * @version    Release: @package_version@
+ * @link       http://www.phpunit.de/
+ * @since      Class available since Release 3.2.0
+ */
+class PHPUnit_Extensions_Database_DataSet_Persistors_FlatXml extends PHPUnit_Extensions_Database_DataSet_Persistors_Abstract
+{
+    /**
+     * @var string
+     */
+    protected $filename;
+    
+    /**
+     * @var resource
+     */
+    protected $fh;
+    
+    /**
+     * Sets the filename that this persistor will save to.
+     *
+     * @param string $filename
+     */
+    public function setFileName($filename)
+    {
+    	$this->filename = $filename;
+    }
+    
+    /**
+     * Override to save the start of a dataset.
+     *
+     * @param PHPUnit_Extensions_Database_DataSet_IDataSet $dataset
+     */
+    protected function startDataSet(PHPUnit_Extensions_Database_DataSet_IDataSet $dataset)
+    {
+        $this->fh = fopen($this->filename, 'w');
+        
+        if ($this->fh === FALSE) {
+           throw new RuntimeException("Could not open {$this->filename} for writing see " . __CLASS__ . "::setFileName()");
+        }
+        
+        fwrite($this->fh, "<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n");
+        fwrite($this->fh, "<dataset>\n");
+    }
+    
+    /**
+     * Override to save the end of a dataset.
+     *
+     * @param PHPUnit_Extensions_Database_DataSet_IDataSet $dataset
+     */
+    protected function endDataSet(PHPUnit_Extensions_Database_DataSet_IDataSet $dataset)
+    {
+        fwrite($this->fh, "</dataset>\n");
+    }
+    
+    /**
+     * Override to save the start of a table.
+     *
+     * @param PHPUnit_Extensions_Database_DataSet_ITable $table
+     */
+    protected function startTable(PHPUnit_Extensions_Database_DataSet_ITable $table)
+    {
+        if ($table->getRowCount() == 0) {
+            fwrite($this->fh, "\t<{$table->getTableMetaData()->getTableName()} />\n");
+        }
+    }
+    
+    /**
+     * Override to save the end of a table.
+     *
+     * @param PHPUnit_Extensions_Database_DataSet_ITable $table
+     */
+    protected function endTable(PHPUnit_Extensions_Database_DataSet_ITable $table)
+    {
+        //do nothing
+    }
+    
+    /**
+     * Override to save a table row.
+     *
+     * @param array $row
+     * @param PHPUnit_Extensions_Database_DataSet_ITable $table
+     */
+    protected function row(Array $row, PHPUnit_Extensions_Database_DataSet_ITable $table)
+    {
+        fwrite($this->fh, "\t<{$table->getTableMetaData()->getTableName()}\n");
+        
+        foreach ($table->getTableMetaData()->getColumns() as $columnName) {
+            if (isset($row[$columnName])) {
+                fwrite($this->fh, "\t\t{$columnName}=\"{$row[$columnName]}\"\n");
+            }
+        }
+        
+        fwrite($this->fh, "\t/>\n");
+    }
+}
+
+?>
diff --git a/PHPUnit/Extensions/Database/DataSet/Persistors/Xml.php b/PHPUnit/Extensions/Database/DataSet/Persistors/Xml.php
new file mode 100644
index 000000000..66909dee5
--- /dev/null
+++ b/PHPUnit/Extensions/Database/DataSet/Persistors/Xml.php
@@ -0,0 +1,161 @@
+<?php
+/**
+ * PHPUnit
+ *
+ * Copyright (c) 2002-2008, Sebastian Bergmann <sb@sebastian-bergmann.de>.
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ *   * Redistributions of source code must retain the above copyright
+ *     notice, this list of conditions and the following disclaimer.
+ *
+ *   * Redistributions in binary form must reproduce the above copyright
+ *     notice, this list of conditions and the following disclaimer in
+ *     the documentation and/or other materials provided with the
+ *     distribution.
+ *
+ *   * Neither the name of Sebastian Bergmann nor the names of his
+ *     contributors may be used to endorse or promote products derived
+ *     from this software without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
+ * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
+ * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
+ * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
+ * COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
+ * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
+ * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+ * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
+ * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+ * POSSIBILITY OF SUCH DAMAGE.
+ *
+ * @category   Testing
+ * @package    PHPUnit
+ * @author     Mike Lively <m@digitalsandwich.com>
+ * @copyright  2002-2008 Sebastian Bergmann <sb@sebastian-bergmann.de>
+ * @license    http://www.opensource.org/licenses/bsd-license.php  BSD License
+ * @version    SVN: $Id: FlatXmlDataSet.php 3170 2008-06-08 23:16:56Z mlively $
+ * @link       http://www.phpunit.de/
+ * @since      File available since Release 3.2.0
+ */
+
+require_once 'PHPUnit/Framework.php';
+require_once 'PHPUnit/Util/Filter.php';
+
+require_once 'PHPUnit/Extensions/Database/DataSet/Persistors/Abstract.php';
+
+PHPUnit_Util_Filter::addFileToFilter(__FILE__, 'PHPUNIT');
+
+/**
+ * A XML dataset persistor.
+ * 
+ * @category   Testing
+ * @package    PHPUnit
+ * @author     Mike Lively <m@digitalsandwich.com>
+ * @copyright  2008 Mike Lively <m@digitalsandwich.com>
+ * @license    http://www.opensource.org/licenses/bsd-license.php  BSD License
+ * @version    Release: @package_version@
+ * @link       http://www.phpunit.de/
+ * @since      Class available since Release 3.2.0
+ */
+class PHPUnit_Extensions_Database_DataSet_Persistors_Xml extends PHPUnit_Extensions_Database_DataSet_Persistors_Abstract
+{
+    /**
+     * @var string
+     */
+    protected $filename;
+    
+    /**
+     * @var resource
+     */
+    protected $fh;
+    
+    /**
+     * Sets the filename that this persistor will save to.
+     *
+     * @param string $filename
+     */
+    public function setFileName($filename)
+    {
+        $this->filename = $filename;
+    }
+    
+    /**
+     * Override to save the start of a dataset.
+     *
+     * @param PHPUnit_Extensions_Database_DataSet_IDataSet $dataset
+     */
+    protected function startDataSet(PHPUnit_Extensions_Database_DataSet_IDataSet $dataset)
+    {
+        $this->fh = fopen($this->filename, 'w');
+        
+        if ($this->fh === FALSE) {
+           throw new RuntimeException("Could not open {$this->filename} for writing see " . __CLASS__ . "::setFileName()");
+        }
+        
+        fwrite($this->fh, "<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n");
+        fwrite($this->fh, "<dataset>\n");
+    }
+    
+    /**
+     * Override to save the end of a dataset.
+     *
+     * @param PHPUnit_Extensions_Database_DataSet_IDataSet $dataset
+     */
+    protected function endDataSet(PHPUnit_Extensions_Database_DataSet_IDataSet $dataset)
+    {
+        fwrite($this->fh, "</dataset>\n");
+    }
+    
+    /**
+     * Override to save the start of a table.
+     *
+     * @param PHPUnit_Extensions_Database_DataSet_ITable $table
+     */
+    protected function startTable(PHPUnit_Extensions_Database_DataSet_ITable $table)
+    {
+    	fwrite($this->fh, "\t<table name=\"{$table->getTableMetaData()->getTableName()}\">\n");
+    	foreach ($table->getTableMetaData()->getColumns() as $columnName)
+    	{
+    		fwrite($this->fh, "\t\t<column>{$columnName}</column>\n");
+    	}
+    }
+    
+    /**
+     * Override to save the end of a table.
+     *
+     * @param PHPUnit_Extensions_Database_DataSet_ITable $table
+     */
+    protected function endTable(PHPUnit_Extensions_Database_DataSet_ITable $table)
+    {
+        fwrite($this->fh, "\t</table>\n");
+    }
+    
+    /**
+     * Override to save a table row.
+     *
+     * @param array $row
+     * @param PHPUnit_Extensions_Database_DataSet_ITable $table
+     */
+    protected function row(Array $row, PHPUnit_Extensions_Database_DataSet_ITable $table)
+    {
+        fwrite($this->fh, "\t\t<row>\n");
+        
+        foreach ($table->getTableMetaData()->getColumns() as $columnName) {
+            if (isset($row[$columnName])) {
+                fwrite($this->fh, "\t\t\t<value>{$row[$columnName]}</value>\n");
+            } else {
+                fwrite($this->fh, "\t\t\t<null />\n");
+            }
+        }
+        
+        fwrite($this->fh, "\t\t</row>\n");
+    }
+}
+
+?>
diff --git a/PHPUnit/Extensions/Database/DataSet/XmlDataSet.php b/PHPUnit/Extensions/Database/DataSet/XmlDataSet.php
index 228da4a89..bd2be956e 100644
--- a/PHPUnit/Extensions/Database/DataSet/XmlDataSet.php
+++ b/PHPUnit/Extensions/Database/DataSet/XmlDataSet.php
@@ -48,6 +48,7 @@
 require_once 'PHPUnit/Util/Filter.php';
 
 require_once 'PHPUnit/Extensions/Database/DataSet/AbstractXmlDataSet.php';
+require_once 'PHPUnit/Extensions/Database/DataSet/Persistors/Xml.php';
 
 PHPUnit_Util_Filter::addFileToFilter(__FILE__, 'PHPUNIT');
 
@@ -124,6 +125,17 @@ protected function getTableInfo(Array &$tableColumns, Array &$tableValues)
             }
         }
     }
-
+    
+    public static function write(PHPUnit_Extensions_Database_DataSet_IDataSet $dataset, $filename)
+    {
+        $pers = new PHPUnit_Extensions_Database_DataSet_Persistors_Xml();
+        $pers->setFileName($filename);
+        
+        try {
+            $pers->write($dataset);
+        } catch (RuntimeException $e) {
+            throw new RuntimeException(__METHOD__ . ' called with an unwritable file.');
+        }
+    }
 }
 ?>
diff --git a/PHPUnit/Tests/Extensions/Database/DataSet/AllTests.php b/PHPUnit/Tests/Extensions/Database/DataSet/AllTests.php
index e49d30fe4..35a7ff8c7 100644
--- a/PHPUnit/Tests/Extensions/Database/DataSet/AllTests.php
+++ b/PHPUnit/Tests/Extensions/Database/DataSet/AllTests.php
@@ -49,7 +49,7 @@
 PHPUnit_Util_Filter::addFileToFilter(__FILE__);
 
 if (!defined('PHPUnit_MAIN_METHOD')) {
-    define('PHPUnit_MAIN_METHOD', 'Extensions_Database_Operation_AllTests::main');
+    define('PHPUnit_MAIN_METHOD', 'Extensions_Database_DataSet_AllTests::main');
     chdir(dirname(dirname(__FILE__)));
 }
 
@@ -59,6 +59,7 @@
 
 require_once 'Extensions/Database/DataSet/XmlDataSetsTest.php';
 require_once 'Extensions/Database/DataSet/FilterTest.php';
+require_once 'Extensions/Database/DataSet/PersistorTest.php';
 
 /**
  *
@@ -84,8 +85,9 @@ public static function suite()
         $suite = new PHPUnit_Framework_TestSuite('PHPUnit_Extensions_Database_DataSet');
 
         $suite->addTestSuite('Extensions_Database_DataSet_XmlDataSetsTest');
-                $suite->addTestSuite('Extensions_Database_DataSet_FilterTest');
-
+        $suite->addTestSuite('Extensions_Database_DataSet_FilterTest');
+        $suite->addTestSuite('Extensions_Database_DataSet_PersistorTest');
+        
         return $suite;
     }
 }
diff --git a/PHPUnit/Tests/Extensions/Database/DataSet/PersistorTest.php b/PHPUnit/Tests/Extensions/Database/DataSet/PersistorTest.php
new file mode 100644
index 000000000..f5c4447e4
--- /dev/null
+++ b/PHPUnit/Tests/Extensions/Database/DataSet/PersistorTest.php
@@ -0,0 +1,87 @@
+<?php
+/**
+ * PHPUnit
+ *
+ * Copyright (c) 2002-2008, Sebastian Bergmann <sb@sebastian-bergmann.de>.
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ *   * Redistributions of source code must retain the above copyright
+ *     notice, this list of conditions and the following disclaimer.
+ *
+ *   * Redistributions in binary form must reproduce the above copyright
+ *     notice, this list of conditions and the following disclaimer in
+ *     the documentation and/or other materials provided with the
+ *     distribution.
+ *
+ *   * Neither the name of Sebastian Bergmann nor the names of his
+ *     contributors may be used to endorse or promote products derived
+ *     from this software without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
+ * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
+ * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
+ * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
+ * COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
+ * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
+ * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+ * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
+ * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+ * POSSIBILITY OF SUCH DAMAGE.
+ *
+ * @category   Testing
+ * @package    PHPUnit
+ * @author     Mike Lively <m@digitalsandwich.com>
+ * @copyright  2002-2008 Sebastian Bergmann <sb@sebastian-bergmann.de>
+ * @license    http://www.opensource.org/licenses/bsd-license.php  BSD License
+ * @version    SVN: $Id: FilterTest.php 3158 2008-06-08 08:33:12Z sb $
+ * @link       http://www.phpunit.de/
+ * @since      File available since Release 3.2.0
+ */
+
+require_once 'PHPUnit/Framework/TestCase.php';
+require_once 'PHPUnit/Extensions/Database/DataSet/FlatXmlDataSet.php';
+require_once 'PHPUnit/Extensions/Database/DataSet/XmlDataSet.php';
+
+/**
+ * @category   Testing
+ * @package    PHPUnit
+ * @author     Mike Lively <m@digitalsandwich.com>
+ * @copyright  2002-2008 Sebastian Bergmann <sb@sebastian-bergmann.de>
+ * @license    http://www.opensource.org/licenses/bsd-license.php  BSD License
+ * @version    SVN: $Id: FilterTest.php 3158 2008-06-08 08:33:12Z sb $
+ * @link       http://www.phpunit.de/
+ * @since      File available since Release 3.2.0
+ */
+class Extensions_Database_DataSet_PersistorTest extends PHPUnit_Framework_TestCase
+{
+    public function testFlatXml()
+    {
+        $dataSetFile = dirname(__FILE__).'/../_files/XmlDataSets/FlatXmlWriter.xml';
+        
+        $filename = dirname(__FILE__).'/'.uniqid().'.xml';
+        $dataSet = new PHPUnit_Extensions_Database_DataSet_FlatXmlDataSet($dataSetFile);
+        PHPUnit_Extensions_Database_DataSet_FlatXmlDataSet::write($dataSet, $filename);
+        
+        $this->assertXmlFileEqualsXmlFile($dataSetFile, $filename);
+        unlink($filename);
+    }
+    
+    public function testXml()
+    {
+        $dataSetFile = dirname(__FILE__).'/../_files/XmlDataSets/XmlWriter.xml';
+        
+        $filename = dirname(__FILE__).'/'.uniqid().'.xml';
+        $dataSet = new PHPUnit_Extensions_Database_DataSet_XmlDataSet($dataSetFile);
+        PHPUnit_Extensions_Database_DataSet_XmlDataSet::write($dataSet, $filename);
+        
+        $this->assertXmlFileEqualsXmlFile($dataSetFile, $filename);
+        unlink($filename);
+    }
+}
+?>
diff --git a/PHPUnit/Tests/Extensions/Database/_files/XmlDataSets/FlatXmlWriter.xml b/PHPUnit/Tests/Extensions/Database/_files/XmlDataSets/FlatXmlWriter.xml
new file mode 100644
index 000000000..ef4733229
--- /dev/null
+++ b/PHPUnit/Tests/Extensions/Database/_files/XmlDataSets/FlatXmlWriter.xml
@@ -0,0 +1,32 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<dataset>
+    <table1
+        col1="val1"
+        col2="val2"
+        col3="val3"
+    />
+    <table1
+        col1="val4"
+        col2="val5"
+        col3="val6"
+    />
+    <table1
+        col1="val7"
+        col2="val8"
+        col3="val9"
+    />
+    <emptytable />
+    <table2
+        col1="val10"
+        col2="val11"
+        col3="val12"
+    />
+    <table2
+        col1="val13"
+        col3="val14"
+    />
+    <table2
+        col1="val15"
+        col2="val16"
+    />
+</dataset>
diff --git a/PHPUnit/Tests/Extensions/Database/_files/XmlDataSets/XmlWriter.xml b/PHPUnit/Tests/Extensions/Database/_files/XmlDataSets/XmlWriter.xml
new file mode 100644
index 000000000..57ef5995d
--- /dev/null
+++ b/PHPUnit/Tests/Extensions/Database/_files/XmlDataSets/XmlWriter.xml
@@ -0,0 +1,28 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<dataset>
+    <table name="table1">
+        <column>col1</column>
+        <column>col2</column>
+        <column>col3</column>
+        <row>
+            <value>val1</value>
+            <value>val2</value>
+            <value>val3</value>
+        </row>
+        <row>
+            <value></value>
+            <null />
+            <value>val4</value>
+        </row>
+        <row>
+            <value>val5</value>
+            <value>val6</value>
+            <value>val7</value>
+        </row>
+    </table>
+    <table name="table2">
+        <column>col1</column>
+        <column>col2</column>
+        <column>col3</column>
+    </table>
+</dataset>
diff --git a/package.xml b/package.xml
index 3fe0f186a..da3bfa949 100644
--- a/package.xml
+++ b/package.xml
@@ -42,6 +42,17 @@
        </file>
       </dir>
       <dir name="DataSet">
+       <dir name="Persistors">
+        <file baseinstalldir="/" name="Abstract.php" role="php">
+         <tasks:replace from="@package_version@" to="version" type="package-info" />
+        </file>
+        <file baseinstalldir="/" name="FlatXml.php" role="php">
+         <tasks:replace from="@package_version@" to="version" type="package-info" />
+        </file>
+        <file baseinstalldir="/" name="Xml.php" role="php">
+         <tasks:replace from="@package_version@" to="version" type="package-info" />
+        </file>
+       </dir>
        <file baseinstalldir="/" name="AbstractDataSet.php" role="php">
         <tasks:replace from="@package_version@" to="version" type="package-info" />
        </file>
@@ -74,6 +85,9 @@
        <file baseinstalldir="/" name="IDataSet.php" role="php">
         <tasks:replace from="@package_version@" to="version" type="package-info" />
        </file>
+       <file baseinstalldir="/" name="IPersistable.php" role="php">
+        <tasks:replace from="@package_version@" to="version" type="package-info" />
+       </file>
        <file baseinstalldir="/" name="ITableIterator.php" role="php">
         <tasks:replace from="@package_version@" to="version" type="package-info" />
        </file>
@@ -635,6 +649,9 @@
          <file baseinstalldir="/" name="FlatXmlDataSet.xml" role="test">
           <tasks:replace from="@package_version@" to="version" type="package-info" />
          </file>
+         <file baseinstalldir="/" name="FlatXmlWriter.xml" role="test">
+          <tasks:replace from="@package_version@" to="version" type="package-info" />
+         </file>
          <file baseinstalldir="/" name="InsertOperationResult.xml" role="test">
           <tasks:replace from="@package_version@" to="version" type="package-info" />
          </file>
@@ -662,6 +679,9 @@
          <file baseinstalldir="/" name="XmlDataSet.xml" role="test">
           <tasks:replace from="@package_version@" to="version" type="package-info" />
          </file>
+         <file baseinstalldir="/" name="XmlWriter.xml" role="test">
+          <tasks:replace from="@package_version@" to="version" type="package-info" />
+         </file>
         </dir>
         <file baseinstalldir="/" name="DatabaseTestUtility.php" role="test">
          <tasks:replace from="@package_version@" to="version" type="package-info" />
@@ -674,6 +694,9 @@
          <file baseinstalldir="/" name="FilterTest.php" role="test">
           <tasks:replace from="@package_version@" to="version" type="package-info" />
          </file>
+         <file baseinstalldir="/" name="PersistorTest.php" role="test">
+          <tasks:replace from="@package_version@" to="version" type="package-info" />
+         </file>
          <file baseinstalldir="/" name="XmlDataSetsTest.php" role="test">
           <tasks:replace from="@package_version@" to="version" type="package-info" />
          </file>
