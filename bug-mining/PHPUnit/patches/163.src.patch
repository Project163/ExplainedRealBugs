diff --git a/ChangeLog.markdown b/ChangeLog.markdown
index 1eef5aed4..02a4625e2 100644
--- a/ChangeLog.markdown
+++ b/ChangeLog.markdown
@@ -12,6 +12,7 @@ PHPUnit 3.6.4
 * Fixed #328: Parsing of one line annotations did not work.
 * Fixed #407: `$_SERVER['_']` was not utilized properly to specify the PHP interpreter used for process isolation.
 * Fixed #411: Do not swallow output printed from test(ed) code by default.
+* Fixed #413: phpt test failures display double diffs
 
 PHPUnit 3.6.3
 -------------
diff --git a/PHPUnit/Framework/TestFailure.php b/PHPUnit/Framework/TestFailure.php
index 7e6ea639f..810a8af2c 100644
--- a/PHPUnit/Framework/TestFailure.php
+++ b/PHPUnit/Framework/TestFailure.php
@@ -117,16 +117,12 @@ public static function exceptionToString(Exception $e)
         if ($e instanceof PHPUnit_Framework_SelfDescribing) {
             $buffer = $e->toString();
 
-            if ($e instanceof PHPUnit_Framework_ComparisonFailure) {
-                $buffer = trim($buffer . "\n" . $e->getDiff());
-            }
-
             if ($e instanceof PHPUnit_Framework_ExpectationFailedException && $e->getComparisonFailure()) {
-                $buffer = trim($buffer . "\n" . $e->getComparisonFailure()->getDiff());
+                $buffer = $buffer . "\n" . $e->getComparisonFailure()->getDiff();
             }
 
             if (!empty($buffer)) {
-                $buffer .= "\n";
+                $buffer = trim($buffer) . "\n";
             }
         }
 
