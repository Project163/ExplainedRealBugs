diff --git a/ChangeLog-11.3.md b/ChangeLog-11.3.md
index e36f27844..4eac7c6a8 100644
--- a/ChangeLog-11.3.md
+++ b/ChangeLog-11.3.md
@@ -2,6 +2,12 @@
 
 All notable changes of the PHPUnit 11.3 release series are documented in this file using the [Keep a CHANGELOG](https://keepachangelog.com/) principles.
 
+## [11.3.5] - 2024-MM-DD
+
+### Fixed
+
+* [#5874](https://github.com/sebastianbergmann/phpunit/issues/5874): Test Stub generated by return value generator for doubled method with `static` return type declaration is not properly initialized
+
 ## [11.3.4] - 2024-09-09
 
 ### Fixed
@@ -56,6 +62,7 @@ All notable changes of the PHPUnit 11.3 release series are documented in this fi
 * [#5856](https://github.com/sebastianbergmann/phpunit/issues/5856): When the test runner is configured to fail on deprecations, notices, warnings, incomplete tests, or skipped tests then details for tests that triggered deprecations, notices, or warnings as well as tests that were marked as incomplete or skipped are always shown, respectively
 * [#5869](https://github.com/sebastianbergmann/phpunit/pull/5869): The configuration file generated using `--generate-configuration` now limits the export of arrays to 10 elements in order to improve performance
 
+[11.3.5]: https://github.com/sebastianbergmann/phpunit/compare/11.3.4...11.3
 [11.3.4]: https://github.com/sebastianbergmann/phpunit/compare/11.3.3...11.3.4
 [11.3.3]: https://github.com/sebastianbergmann/phpunit/compare/11.3.2...11.3.3
 [11.3.2]: https://github.com/sebastianbergmann/phpunit/compare/11.3.1...11.3.2
diff --git a/src/Framework/MockObject/Runtime/Api/TestDoubleState.php b/src/Framework/MockObject/Runtime/Api/TestDoubleState.php
index 5b7355f1e..b4547b2ec 100644
--- a/src/Framework/MockObject/Runtime/Api/TestDoubleState.php
+++ b/src/Framework/MockObject/Runtime/Api/TestDoubleState.php
@@ -95,4 +95,17 @@ public function wasDeprecationAlreadyEmittedFor(string $testId): bool
     {
         return isset(self::$deprecationEmittedForTest[$testId]);
     }
+
+    /**
+     * @return list<ConfigurableMethod>
+     */
+    public function configurableMethods(): array
+    {
+        return $this->configurableMethods;
+    }
+
+    public function generateReturnValues(): bool
+    {
+        return $this->generateReturnValues;
+    }
 }
diff --git a/src/Framework/MockObject/Runtime/Invocation.php b/src/Framework/MockObject/Runtime/Invocation.php
index c1efebcfa..faf34b4b3 100644
--- a/src/Framework/MockObject/Runtime/Invocation.php
+++ b/src/Framework/MockObject/Runtime/Invocation.php
@@ -129,7 +129,7 @@ public function generateReturnValue(): mixed
         return (new ReturnValueGenerator)->generate(
             $this->className,
             $this->methodName,
-            $this->object::class,
+            $this->object,
             $this->returnType,
         );
     }
diff --git a/src/Framework/MockObject/Runtime/ReturnValueGenerator.php b/src/Framework/MockObject/Runtime/ReturnValueGenerator.php
index d78112571..fbddc07d3 100644
--- a/src/Framework/MockObject/Runtime/ReturnValueGenerator.php
+++ b/src/Framework/MockObject/Runtime/ReturnValueGenerator.php
@@ -21,6 +21,7 @@
 use function substr;
 use PHPUnit\Framework\MockObject\Generator\Generator;
 use ReflectionClass;
+use ReflectionObject;
 use stdClass;
 use Throwable;
 
@@ -34,11 +35,10 @@ final class ReturnValueGenerator
     /**
      * @param class-string     $className
      * @param non-empty-string $methodName
-     * @param class-string     $stubClassName
      *
      * @throws Exception
      */
-    public function generate(string $className, string $methodName, string $stubClassName, string $returnType): mixed
+    public function generate(string $className, string $methodName, StubInternal $testStub, string $returnType): mixed
     {
         $intersection = false;
         $union        = false;
@@ -95,7 +95,7 @@ public function generate(string $className, string $methodName, string $stubClas
             }
 
             if (in_array('static', $lowerTypes, true)) {
-                return $this->newInstanceOf($stubClassName, $className, $methodName);
+                return $this->newInstanceOf($testStub, $className, $methodName);
             }
 
             if (in_array('object', $lowerTypes, true)) {
@@ -174,16 +174,26 @@ private function onlyInterfaces(array $types): bool
     }
 
     /**
-     * @param class-string     $stubClassName
      * @param class-string     $className
      * @param non-empty-string $methodName
      *
      * @throws RuntimeException
      */
-    private function newInstanceOf(string $stubClassName, string $className, string $methodName): Stub
+    private function newInstanceOf(StubInternal $testStub, string $className, string $methodName): Stub
     {
         try {
-            return (new ReflectionClass($stubClassName))->newInstanceWithoutConstructor();
+            $object    = (new ReflectionClass($testStub::class))->newInstanceWithoutConstructor();
+            $reflector = new ReflectionObject($object);
+
+            $reflector->getProperty('__phpunit_state')->setValue(
+                $object,
+                new TestDoubleState(
+                    $testStub->__phpunit_state()->configurableMethods(),
+                    $testStub->__phpunit_state()->generateReturnValues(),
+                ),
+            );
+
+            return $object;
             // @codeCoverageIgnoreStart
         } catch (Throwable $t) {
             throw new RuntimeException(
diff --git a/tests/_files/mock-object/InterfaceWithMethodThatReturnsSelf.php b/tests/_files/mock-object/InterfaceWithMethodThatReturnsSelf.php
new file mode 100644
index 000000000..794feed34
--- /dev/null
+++ b/tests/_files/mock-object/InterfaceWithMethodThatReturnsSelf.php
@@ -0,0 +1,15 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture\MockObject;
+
+interface InterfaceWithMethodThatReturnsSelf
+{
+    public function doSomething(): self;
+}
diff --git a/tests/_files/mock-object/InterfaceWithMethodThatReturnsStatic.php b/tests/_files/mock-object/InterfaceWithMethodThatReturnsStatic.php
new file mode 100644
index 000000000..fd8064948
--- /dev/null
+++ b/tests/_files/mock-object/InterfaceWithMethodThatReturnsStatic.php
@@ -0,0 +1,15 @@
+<?php declare(strict_types=1);
+/*
+ * This file is part of PHPUnit.
+ *
+ * (c) Sebastian Bergmann <sebastian@phpunit.de>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+namespace PHPUnit\TestFixture\MockObject;
+
+interface InterfaceWithMethodThatReturnsStatic
+{
+    public function doSomething(): static;
+}
diff --git a/tests/unit/Framework/MockObject/ReturnValueGeneratorTest.php b/tests/unit/Framework/MockObject/ReturnValueGeneratorTest.php
index c65c1a0af..76d830fc7 100644
--- a/tests/unit/Framework/MockObject/ReturnValueGeneratorTest.php
+++ b/tests/unit/Framework/MockObject/ReturnValueGeneratorTest.php
@@ -23,6 +23,8 @@
 use PHPUnit\TestFixture\MockObject\AnotherInterface;
 use PHPUnit\TestFixture\MockObject\AnotherInterfaceForIssue5593;
 use PHPUnit\TestFixture\MockObject\ExtendableClass;
+use PHPUnit\TestFixture\MockObject\InterfaceWithMethodThatReturnsSelf;
+use PHPUnit\TestFixture\MockObject\InterfaceWithMethodThatReturnsStatic;
 use PHPUnit\TestFixture\MockObject\YetAnotherInterface;
 use stdClass;
 
@@ -168,11 +170,24 @@ public function test_Generates_test_stub_for_intersection_of_interfaces(): void
         $this->assertInstanceOf(AnotherInterface::class, $value);
     }
 
+    public function test_Generates_new_instance_of_test_stub_for_self(): void
+    {
+        $stub = $this->createStub(InterfaceWithMethodThatReturnsSelf::class);
+
+        $returnValue = $stub->doSomething();
+
+        $this->assertNotInstanceOf($stub::class, $returnValue);
+        $this->assertNotSame($stub, $returnValue);
+    }
+
     public function test_Generates_new_instance_of_test_stub_for_static(): void
     {
-        $stubClassName = ($this->createStub(AnInterface::class))::class;
+        $stub = $this->createStub(InterfaceWithMethodThatReturnsStatic::class);
+
+        $returnValue = $stub->doSomething();
 
-        $this->assertInstanceOf($stubClassName, $this->generate('static', $stubClassName));
+        $this->assertInstanceOf($stub::class, $returnValue);
+        $this->assertNotSame($stub, $returnValue);
     }
 
     #[Ticket('https://github.com/sebastianbergmann/phpunit/issues/5593')]
@@ -241,12 +256,16 @@ public function test_Generates_test_stub_for_unknown_type(): void
         $this->assertInstanceOf(Stub::class, $this->generate('ThisDoesNotExist'));
     }
 
-    private function generate(string $typeDeclaration, string $stubClassName = 'StubClassName'): mixed
+    private function generate(string $typeDeclaration, ?StubInternal $testStub = null): mixed
     {
+        if ($testStub === null) {
+            $testStub = $this->createStub(AnInterface::class);
+        }
+
         return (new ReturnValueGenerator)->generate(
             'OriginalClassName',
             'methodName',
-            $stubClassName,
+            $testStub,
             $typeDeclaration,
         );
     }
diff --git a/tests/unit/Framework/MockObject/TestDoubleTestCase.php b/tests/unit/Framework/MockObject/TestDoubleTestCase.php
index bb9fa2554..872ee5325 100644
--- a/tests/unit/Framework/MockObject/TestDoubleTestCase.php
+++ b/tests/unit/Framework/MockObject/TestDoubleTestCase.php
@@ -313,8 +313,6 @@ public function testMethodNameCanOnlyBeConfiguredOnce(): void
     #[Ticket('https://github.com/sebastianbergmann/phpunit/issues/5874')]
     public function testDoubledMethodsCanBeCalledFromDestructorOnTestDoubleCreatedByTheReturnValueGenerator(): void
     {
-        $this->markTestIncomplete('https://github.com/sebastianbergmann/phpunit/issues/5874');
-
         $double = $this->createTestDouble(ExtendableClassCallingMethodInDestructor::class);
 
         $this->assertInstanceOf(
