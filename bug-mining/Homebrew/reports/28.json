{"url":"https://api.github.com/repos/Homebrew/brew/issues/13139","repository_url":"https://api.github.com/repos/Homebrew/brew","labels_url":"https://api.github.com/repos/Homebrew/brew/issues/13139/labels{/name}","comments_url":"https://api.github.com/repos/Homebrew/brew/issues/13139/comments","events_url":"https://api.github.com/repos/Homebrew/brew/issues/13139/events","html_url":"https://github.com/Homebrew/brew/issues/13139","id":1202674640,"node_id":"I_kwDOAyxcHc5Hr1vQ","number":13139,"title":"'brew ls --cask --versions' behavior does not match 'brew ls'","user":{"login":"JohnStarich","id":1009441,"node_id":"MDQ6VXNlcjEwMDk0NDE=","avatar_url":"https://avatars.githubusercontent.com/u/1009441?v=4","gravatar_id":"","url":"https://api.github.com/users/JohnStarich","html_url":"https://github.com/JohnStarich","followers_url":"https://api.github.com/users/JohnStarich/followers","following_url":"https://api.github.com/users/JohnStarich/following{/other_user}","gists_url":"https://api.github.com/users/JohnStarich/gists{/gist_id}","starred_url":"https://api.github.com/users/JohnStarich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JohnStarich/subscriptions","organizations_url":"https://api.github.com/users/JohnStarich/orgs","repos_url":"https://api.github.com/users/JohnStarich/repos","events_url":"https://api.github.com/users/JohnStarich/events{/privacy}","received_events_url":"https://api.github.com/users/JohnStarich/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":336921316,"node_id":"MDU6TGFiZWwzMzY5MjEzMTY=","url":"https://api.github.com/repos/Homebrew/brew/labels/help%20wanted","name":"help wanted","color":"bfd4f2","default":true,"description":"We want help addressing this"},{"id":922544989,"node_id":"MDU6TGFiZWw5MjI1NDQ5ODk=","url":"https://api.github.com/repos/Homebrew/brew/labels/outdated","name":"outdated","color":"d93f0b","default":false,"description":"PR was locked due to age"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-04-13T02:36:34Z","updated_at":"2022-05-15T00:07:44Z","closed_at":"2022-04-13T15:19:43Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### `brew config` output\r\n\r\n```shell\r\n➜ ~ brew config\r\nHOMEBREW_VERSION: 3.4.6\r\nORIGIN: https://github.com/Homebrew/brew\r\nHEAD: 56415326bb8c9eccc6e53f3997b4e062b36402af\r\nLast commit: 4 days ago\r\nCore tap ORIGIN: https://github.com/Homebrew/homebrew-core\r\nCore tap HEAD: 40b2e40ff30421b04c74359a57cc79a7b6c6e226\r\nCore tap last commit: 43 minutes ago\r\nCore tap branch: master\r\nHOMEBREW_PREFIX: /opt/homebrew\r\nHOMEBREW_CASK_OPTS: []\r\nHOMEBREW_CORE_GIT_REMOTE: https://github.com/Homebrew/homebrew-core\r\nHOMEBREW_EDITOR: nvim\r\nHOMEBREW_GITHUB_API_TOKEN: set\r\nHOMEBREW_MAKE_JOBS: 10\r\nHOMEBREW_NO_AUTO_UPDATE: set\r\nHomebrew Ruby: 2.6.8 => /System/Library/Frameworks/Ruby.framework/Versions/2.6/usr/bin/ruby\r\nCPU: 10-core 64-bit arm_firestorm_icestorm\r\nClang: 13.1.6 build 1316\r\nGit: 2.35.2 => /opt/homebrew/bin/git\r\nCurl: 7.77.0 => /usr/bin/curl\r\nmacOS: 12.2-arm64\r\nCLT: 13.3.1.0.1.1648687083\r\nXcode: N/A\r\nRosetta 2: false\r\n➜ ~\r\n```\r\n\r\n\r\n### `brew doctor` output\r\n\r\n```shell\r\n➜ ~ brew doctor\r\nPlease note that these warnings are just used to help the Homebrew maintainers\r\nwith debugging if you file an issue. If everything you use Homebrew for is\r\nworking fine: please don't worry or file an issue; just ignore this. Thanks!\r\n\r\nWarning: \"config\" scripts exist outside your system or Homebrew directories.\r\n`./configure` scripts often look for *-config scripts to determine if\r\nsoftware packages are installed, and which additional flags to use when\r\ncompiling and linking.\r\n\r\nHaving additional scripts in your path can confuse software installed via\r\nHomebrew if the config script overrides a system or Homebrew-provided\r\nscript of the same name. We found the following \"config\" scripts:\r\n  /Users/johnstarich/Library/Python/3.8/bin/powerline-config\r\n➜ ~\r\n```\r\n\r\n\r\n### Verification\r\n\r\n- [X] I ran `brew update` and am still able to reproduce my issue.\r\n- [X] I have resolved all warnings from `brew doctor` and that did not fix my problem.\r\n\r\n### What were you trying to do (and why)?\r\n\r\nI use a script to detect if certain formulae (and casks) are installed. I've just tried it on a new machine to set it up, and the current behavior confused cask detection a bit.\r\nEDIT: After further investigation, the exit code was correct but the output was wrong.\r\n\r\nThe full script I use: https://github.com/JohnStarich/dotfiles/blob/d306530c72581954e8f480c4179a555e9d9f0752/brew/install.sh#L71-L110\r\n\r\n### What happened (include all command output)?\r\n\r\nHere's a minimal example:\r\n\r\n```bash\r\n➜ ~ brew ls --versions git              # List an installed formula, succeeds.\r\ngit 2.35.2\r\n➜ ~ brew ls --versions sl               # List an uninstalled formula, fails.\r\n➜ ~ brew ls --versions blah             # List a non-existent formula, fails.\r\n\r\n➜ ~ brew ls --cask --versions qlstephen # List an installed cask, succeeds.\r\nqlstephen 1.5.1\r\n➜ ~ brew ls --cask --versions slack     # List an uninstalled cask, fails with bad output?\r\ncorelocationcli 3.2.0\r\nqlstephen 1.5.1\r\n➜ ~ brew ls --cask --versions blah      # List a non-existent formula, fails with bad output?\r\ncorelocationcli 3.2.0\r\nqlstephen 1.5.1\r\n➜ ~\r\n```\r\nSpecifically, the last 2 commands produced unexpected results when compared with the usual list.\r\n\r\n### What did you expect to happen?\r\n\r\nI expected `brew ls --cask` to behave like `brew ls` with formulae that aren't installed.\r\n\r\nIn other words `brew ls --cask --versions blah` should exit with a non-zero exit code without any output.\r\n\r\nIt has the expected behavior without the `--versions` flag. I suspect this part of the help text is not implemented for casks:\r\n```\r\n➜ ~ brew ls --help\r\n      ...\r\n      --versions                   ..., or only the specified formulae if\r\n                                   formula are provided.\r\n      ...\r\n➜ ~\r\n```\r\n\r\n### Step-by-step reproduction instructions (by running `brew` commands)\r\n\r\n```shell\r\nbrew ls --versions some-non-existent-formula\r\nvs\r\nbrew ls --cask --versions some-non-existent-formula\r\n```\r\n","closed_by":{"login":"MikeMcQuaid","id":125011,"node_id":"MDQ6VXNlcjEyNTAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/125011?v=4","gravatar_id":"","url":"https://api.github.com/users/MikeMcQuaid","html_url":"https://github.com/MikeMcQuaid","followers_url":"https://api.github.com/users/MikeMcQuaid/followers","following_url":"https://api.github.com/users/MikeMcQuaid/following{/other_user}","gists_url":"https://api.github.com/users/MikeMcQuaid/gists{/gist_id}","starred_url":"https://api.github.com/users/MikeMcQuaid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MikeMcQuaid/subscriptions","organizations_url":"https://api.github.com/users/MikeMcQuaid/orgs","repos_url":"https://api.github.com/users/MikeMcQuaid/repos","events_url":"https://api.github.com/users/MikeMcQuaid/events{/privacy}","received_events_url":"https://api.github.com/users/MikeMcQuaid/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Homebrew/brew/issues/13139/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Homebrew/brew/issues/13139/timeline","performed_via_github_app":null,"state_reason":"completed"}