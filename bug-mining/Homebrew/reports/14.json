{"url":"https://api.github.com/repos/Homebrew/brew/issues/12040","repository_url":"https://api.github.com/repos/Homebrew/brew","labels_url":"https://api.github.com/repos/Homebrew/brew/issues/12040/labels{/name}","comments_url":"https://api.github.com/repos/Homebrew/brew/issues/12040/comments","events_url":"https://api.github.com/repos/Homebrew/brew/issues/12040/events","html_url":"https://github.com/Homebrew/brew/issues/12040","id":993933808,"node_id":"MDU6SXNzdWU5OTM5MzM4MDg=","number":12040,"title":"brew test-bot error \"on_macos cannot include url\"","user":{"login":"huahaiy","id":889685,"node_id":"MDQ6VXNlcjg4OTY4NQ==","avatar_url":"https://avatars.githubusercontent.com/u/889685?v=4","gravatar_id":"","url":"https://api.github.com/users/huahaiy","html_url":"https://github.com/huahaiy","followers_url":"https://api.github.com/users/huahaiy/followers","following_url":"https://api.github.com/users/huahaiy/following{/other_user}","gists_url":"https://api.github.com/users/huahaiy/gists{/gist_id}","starred_url":"https://api.github.com/users/huahaiy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huahaiy/subscriptions","organizations_url":"https://api.github.com/users/huahaiy/orgs","repos_url":"https://api.github.com/users/huahaiy/repos","events_url":"https://api.github.com/users/huahaiy/events{/privacy}","received_events_url":"https://api.github.com/users/huahaiy/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":351931983,"node_id":"MDU6TGFiZWwzNTE5MzE5ODM=","url":"https://api.github.com/repos/Homebrew/brew/labels/in%20progress","name":"in progress","color":"ededed","default":false,"description":"Maintainers are working on this"},{"id":922544989,"node_id":"MDU6TGFiZWw5MjI1NDQ5ODk=","url":"https://api.github.com/repos/Homebrew/brew/labels/outdated","name":"outdated","color":"d93f0b","default":false,"description":"PR was locked due to age"}],"state":"closed","locked":true,"assignee":{"login":"MikeMcQuaid","id":125011,"node_id":"MDQ6VXNlcjEyNTAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/125011?v=4","gravatar_id":"","url":"https://api.github.com/users/MikeMcQuaid","html_url":"https://github.com/MikeMcQuaid","followers_url":"https://api.github.com/users/MikeMcQuaid/followers","following_url":"https://api.github.com/users/MikeMcQuaid/following{/other_user}","gists_url":"https://api.github.com/users/MikeMcQuaid/gists{/gist_id}","starred_url":"https://api.github.com/users/MikeMcQuaid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MikeMcQuaid/subscriptions","organizations_url":"https://api.github.com/users/MikeMcQuaid/orgs","repos_url":"https://api.github.com/users/MikeMcQuaid/repos","events_url":"https://api.github.com/users/MikeMcQuaid/events{/privacy}","received_events_url":"https://api.github.com/users/MikeMcQuaid/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"MikeMcQuaid","id":125011,"node_id":"MDQ6VXNlcjEyNTAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/125011?v=4","gravatar_id":"","url":"https://api.github.com/users/MikeMcQuaid","html_url":"https://github.com/MikeMcQuaid","followers_url":"https://api.github.com/users/MikeMcQuaid/followers","following_url":"https://api.github.com/users/MikeMcQuaid/following{/other_user}","gists_url":"https://api.github.com/users/MikeMcQuaid/gists{/gist_id}","starred_url":"https://api.github.com/users/MikeMcQuaid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MikeMcQuaid/subscriptions","organizations_url":"https://api.github.com/users/MikeMcQuaid/orgs","repos_url":"https://api.github.com/users/MikeMcQuaid/repos","events_url":"https://api.github.com/users/MikeMcQuaid/events{/privacy}","received_events_url":"https://api.github.com/users/MikeMcQuaid/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":2,"created_at":"2021-09-11T20:20:08Z","updated_at":"2021-10-16T00:03:42Z","closed_at":"2021-09-15T11:39:42Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### `brew config` output\r\n\r\n```shell\r\nâ¯ brew config\r\nHOMEBREW_VERSION: 3.2.11-103-gbf95782\r\nORIGIN: https://github.com/Homebrew/brew.git\r\nHEAD: bf95782ee2c9a4622c1110e8d3adf768fc4fd897\r\nLast commit: 19 hours ago\r\nCore tap ORIGIN: https://github.com/Homebrew/homebrew-core\r\nCore tap HEAD: 5ccc7bbbab9409b283c11c48faf5149c52123589\r\nCore tap last commit: 20 hours ago\r\nCore tap branch: master\r\nHOMEBREW_PREFIX: /usr/local\r\nHOMEBREW_CASK_OPTS: []\r\nHOMEBREW_DISPLAY: /private/tmp/com.apple.launchd.mYw5XPZqZF/org.xquartz:0\r\nHOMEBREW_EDITOR: vim\r\nHOMEBREW_MAKE_JOBS: 4\r\nHomebrew Ruby: 2.6.3 => /usr/local/Homebrew/Library/Homebrew/vendor/portable-ruby/2.6.3_2/bin/ruby\r\nCPU: quad-core 64-bit haswell\r\nClang: 12.0.5 build 1205\r\nGit: 2.31.1 => /usr/local/bin/git\r\nCurl: 7.64.1 => /usr/bin/curl\r\nmacOS: 11.5.2-x86_64\r\nCLT: 12.0.0.32.27\r\nXcode: 12.5.1\r\nXQuartz: 2.7.11 => /opt/X11\r\n```\r\n\r\n\r\n### `brew doctor` output\r\n\r\n```shell\r\nbrew doctor\r\nPlease note that these warnings are just used to help the Homebrew maintainers\r\nwith debugging if you file an issue. If everything you use Homebrew for is\r\nworking fine: please don't worry or file an issue; just ignore this. Thanks!\r\n\r\nWarning: Your Command Line Tools are too outdated.\r\nUpdate them from Software Update in System Preferences or run:\r\n  softwareupdate --all --install --force\r\n\r\nIf that doesn't show you any updates, run:\r\n  sudo rm -rf /Library/Developer/CommandLineTools\r\n  sudo xcode-select --install\r\n\r\nAlternatively, manually download them from:\r\n  https://developer.apple.com/download/more/.\r\nYou should download the Command Line Tools for Xcode 12.5.\r\n\r\n\r\nWarning: A newer Command Line Tools release is available.\r\nUpdate them from Software Update in System Preferences or run:\r\n  softwareupdate --all --install --force\r\n\r\nIf that doesn't show you any updates, run:\r\n  sudo rm -rf /Library/Developer/CommandLineTools\r\n  sudo xcode-select --install\r\n\r\nAlternatively, manually download them from:\r\n  https://developer.apple.com/download/more/.\r\nYou should download the Command Line Tools for Xcode 12.5.\r\n\r\n\r\nWarning: Some installed kegs have no formulae!\r\nThis means they were either deleted or installed with `brew diy`.\r\nYou should find replacements for the following formulae:\r\n  python@2\r\n  suite-sparse421\r\n  dirmngr\r\n  gmp@4\r\n  gpg-agent\r\n  qt@5.7\r\n  gitzero\r\n  isl@0.12\r\n\r\nWarning: Some installed formulae are deprecated or disabled.\r\nYou should find replacements for the following formulae:\r\n  bats\r\n  ilmbase\r\n\r\nWarning: The following directories do not exist:\r\n/usr/local/sbin\r\n\r\nYou should create these directories and change their ownership to your user.\r\n  sudo mkdir -p /usr/local/sbin\r\n  sudo chown -R $(whoami) /usr/local/sbin\r\n\r\nWarning: Unbrewed dylibs were found in /usr/local/lib.\r\nIf you didn't put them there on purpose they could cause problems when\r\nbuilding Homebrew formulae, and may need to be deleted.\r\n\r\nUnexpected dylibs:\r\n  /usr/local/lib/libtcl8.6.dylib\r\n  /usr/local/lib/libtk8.6.dylib\r\n\r\nWarning: Unbrewed header files were found in /usr/local/include.\r\nIf you didn't put them there on purpose they could cause problems when\r\nbuilding Homebrew formulae, and may need to be deleted.\r\n\r\nUnexpected header files:\r\n  /usr/local/include/fakemysql.h\r\n  /usr/local/include/fakepq.h\r\n  /usr/local/include/fakesql.h\r\n  /usr/local/include/itcl.h\r\n  /usr/local/include/itcl2TclOO.h\r\n  /usr/local/include/itclDecls.h\r\n  /usr/local/include/itclInt.h\r\n  /usr/local/include/itclIntDecls.h\r\n  /usr/local/include/itclMigrate2TclCore.h\r\n  /usr/local/include/itclTclIntStubsFcn.h\r\n  /usr/local/include/mysqlStubs.h\r\n  /usr/local/include/odbcStubs.h\r\n  /usr/local/include/pqStubs.h\r\n  /usr/local/include/tcl.h\r\n  /usr/local/include/tclDecls.h\r\n  /usr/local/include/tclOO.h\r\n  /usr/local/include/tclOODecls.h\r\n  /usr/local/include/tclPlatDecls.h\r\n  /usr/local/include/tclThread.h\r\n  /usr/local/include/tclTomMath.h\r\n  /usr/local/include/tclTomMathDecls.h\r\n  /usr/local/include/tdbc.h\r\n  /usr/local/include/tdbcDecls.h\r\n  /usr/local/include/tdbcInt.h\r\n  /usr/local/include/tk.h\r\n  /usr/local/include/tkDecls.h\r\n  /usr/local/include/tkPlatDecls.h\r\n\r\nWarning: Unbrewed '.pc' files were found in /usr/local/lib/pkgconfig.\r\nIf you didn't put them there on purpose they could cause problems when\r\nbuilding Homebrew formulae, and may need to be deleted.\r\n\r\nUnexpected '.pc' files:\r\n  /usr/local/lib/pkgconfig/tcl.pc\r\n  /usr/local/lib/pkgconfig/tk.pc\r\n\r\nWarning: Unbrewed static libraries were found in /usr/local/lib.\r\nIf you didn't put them there on purpose they could cause problems when\r\nbuilding Homebrew formulae, and may need to be deleted.\r\n\r\nUnexpected static libraries:\r\n  /usr/local/lib/libtclstub8.6.a\r\n  /usr/local/lib/libtkstub8.6.a\r\n\r\nWarning: You have unlinked kegs in your Cellar.\r\nLeaving kegs unlinked can lead to build-trouble and cause formulae that depend on\r\nthose kegs to fail to run properly once built. Run `brew link` on these:\r\n  ctags\r\n  python@2\r\n  pyqt@5\r\n  imath\r\n  suite-sparse421\r\n  openexr\r\n  libsigc++@2\r\n  qt@5.7\r\n  unbound\r\nError: formulae require at least a URL\r\nPlease report this issue:\r\n  https://docs.brew.sh/Troubleshooting\r\n/usr/local/Homebrew/Library/Homebrew/formula.rb:274:in `determine_active_spec'\r\n/usr/local/Homebrew/Library/Homebrew/formula.rb:209:in `initialize'\r\n/usr/local/Homebrew/Library/Homebrew/formulary.rb:181:in `new'\r\n/usr/local/Homebrew/Library/Homebrew/formulary.rb:181:in `get_formula'\r\n/usr/local/Homebrew/Library/Homebrew/formulary.rb:340:in `get_formula'\r\n/usr/local/Homebrew/Library/Homebrew/formulary.rb:414:in `factory'\r\n/usr/local/Homebrew/Library/Homebrew/formulary.rb:480:in `from_keg'\r\n/usr/local/Homebrew/Library/Homebrew/formulary.rb:453:in `from_rack'\r\n/usr/local/Homebrew/Library/Homebrew/diagnostic.rb:778:in `block in check_for_unreadable_installed_formula'\r\n/usr/local/Homebrew/Library/Homebrew/diagnostic.rb:777:in `each'\r\n/usr/local/Homebrew/Library/Homebrew/diagnostic.rb:777:in `check_for_unreadable_installed_formula'\r\n/usr/local/Homebrew/Library/Homebrew/cmd/doctor.rb:64:in `block in doctor'\r\n/usr/local/Homebrew/Library/Homebrew/cmd/doctor.rb:57:in `each'\r\n/usr/local/Homebrew/Library/Homebrew/cmd/doctor.rb:57:in `doctor'\r\n/usr/local/Homebrew/Library/Homebrew/brew.rb:129:in `<main>'\r\n```\r\n\r\n\r\n### \r\n\r\n- [X] I ran `brew update` and am still able to reproduce my issue.\r\n- [X] I have resolved all warnings from `brew doctor` and that did not fix my problem.\r\n\r\n### What were you trying to do (and why)?\r\n\r\nI have a formula, github test-bot checking its syntax wrongly produces an error, and people in discussions suggest me to file a bug report here. See https://github.com/Homebrew/discussions/discussions/2119#discussioncomment-1309353\r\n\r\n\r\n### What happened (include all command output)?\r\n\r\nbrew test-bot --only-tap-syntax\r\n  shell: /usr/bin/bash -e {0}\r\n==> Using Homebrew/homebrew-test-bot 239af84 (Merge pull request #660 from carlocab/git)\r\n==> Using Homebrew/brew 3.2.11-103-gbf95782ee (Merge pull request #12019 from valrus/services-plist-add-process-type)\r\n==> Using Homebrew/linuxbrew-core a55e1a81ac4 (wangle: update 2021.09.06.00 bottle.)\r\n==> Testing huahaiy/homebrew-brew 26a8f99 (update):\r\n\r\n==> Running TapSyntax#run!\r\n==> brew readall --aliases huahaiy/brew\r\n==> brew style huahaiy/brew\r\n==> FAILED\r\nFormula/datalevin.rb:10:5: C: on_macos cannot include url. Only depends_on, patch, resource, deprecate!, disable!, conflicts_with, keg_only, and ignore_missing_libraries are allowed.\r\n    url \"https://github.com/juji-io/datalevin/releases/download/0.5.8/dtlv-0.5.8-macos-latest-amd64.zip\"\r\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\nFormula/datalevin.rb:11:5: C: on_macos cannot include sha256. Only depends_on, patch, resource, deprecate!, disable!, conflicts_with, keg_only, and ignore_missing_libraries are allowed.\r\n    sha256 \"d051099a857083ec7a3fbfa11bf8262c0537d6d96acd12bcdadfecc21ef9b369\"\r\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\nFormula/datalevin.rb:15:5: C: on_linux cannot include url. Only depends_on, patch, resource, deprecate!, disable!, conflicts_with, keg_only, and ignore_missing_libraries are allowed.\r\n    url \"https://github.com/juji-io/datalevin/releases/download/0.5.8/dtlv-0.5.8-ubuntu-latest-amd64.zip\"\r\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\nFormula/datalevin.rb:16:5: C: on_linux cannot include sha256. Only depends_on, patch, resource, deprecate!, disable!, conflicts_with, keg_only, and ignore_missing_libraries are allowed.\r\n    sha256 \"aa966a9906acdc0e80768b5744f093978f44176fb3c4d55ff9e0b9cea58ef638\"\r\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n\r\n1 file inspected, 4 offenses detected\r\nError: `on_macos` cannot include `url`. Only `depends_on`, `patch`, `resource`, `deprecate!`, `disable!`, `conflicts_with`, `keg_only`, and `ignore_missing_libraries` are allowed.\r\nError: `on_macos` cannot include `sha256`. Only `depends_on`, `patch`, `resource`, `deprecate!`, `disable!`, `conflicts_with`, `keg_only`, and `ignore_missing_libraries` are allowed.\r\nError: `on_linux` cannot include `url`. Only `depends_on`, `patch`, `resource`, `deprecate!`, `disable!`, `conflicts_with`, `keg_only`, and `ignore_missing_libraries` are allowed.\r\nError: `on_linux` cannot include `sha256`. Only `depends_on`, `patch`, `resource`, `deprecate!`, `disable!`, `conflicts_with`, `keg_only`, and `ignore_missing_libraries` are allowed.\r\n\r\n==> brew audit --tap=huahaiy/brew --except=version\r\nError: 1 failed step!\r\nbrew style huahaiy/brew\r\nError: Process completed with exit code 1.\r\n\r\n### What did you expect to happen?\r\n\r\nNo error.\r\n\r\n### Step-by-step reproduction instructions (by running `brew` commands)\r\n\r\n```shell\r\nbrew style huahaiy/brew\r\nInspecting 1 file\r\nC\r\n\r\nOffenses:\r\n\r\n/usr/local/Homebrew/Library/Taps/huahaiy/homebrew-brew/Formula/datalevin.rb:10:5: C: on_linux cannot include url. Only depends_on, patch, resource, deprecate!, disable!, conflicts_with, keg_only, and ignore_missing_libraries are allowed.\r\n    url \"https://github.com/juji-io/datalevin/releases/download/0.5.8/dtlv-0.5.8-ubuntu-latest-amd64.zip\"\r\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n/usr/local/Homebrew/Library/Taps/huahaiy/homebrew-brew/Formula/datalevin.rb:11:5: C: on_linux cannot include sha256. Only depends_on, patch, resource, deprecate!, disable!, conflicts_with, keg_only, and ignore_missing_libraries are allowed.\r\n    sha256 \"aa966a9906acdc0e80768b5744f093978f44176fb3c4d55ff9e0b9cea58ef638\"\r\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n\r\n1 file inspected, 2 offenses detected\r\n```\r\n","closed_by":{"login":"MikeMcQuaid","id":125011,"node_id":"MDQ6VXNlcjEyNTAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/125011?v=4","gravatar_id":"","url":"https://api.github.com/users/MikeMcQuaid","html_url":"https://github.com/MikeMcQuaid","followers_url":"https://api.github.com/users/MikeMcQuaid/followers","following_url":"https://api.github.com/users/MikeMcQuaid/following{/other_user}","gists_url":"https://api.github.com/users/MikeMcQuaid/gists{/gist_id}","starred_url":"https://api.github.com/users/MikeMcQuaid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MikeMcQuaid/subscriptions","organizations_url":"https://api.github.com/users/MikeMcQuaid/orgs","repos_url":"https://api.github.com/users/MikeMcQuaid/repos","events_url":"https://api.github.com/users/MikeMcQuaid/events{/privacy}","received_events_url":"https://api.github.com/users/MikeMcQuaid/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Homebrew/brew/issues/12040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Homebrew/brew/issues/12040/timeline","performed_via_github_app":null,"state_reason":"completed"}