{"url":"https://api.github.com/repos/Homebrew/brew/issues/13559","repository_url":"https://api.github.com/repos/Homebrew/brew","labels_url":"https://api.github.com/repos/Homebrew/brew/issues/13559/labels{/name}","comments_url":"https://api.github.com/repos/Homebrew/brew/issues/13559/comments","events_url":"https://api.github.com/repos/Homebrew/brew/issues/13559/events","html_url":"https://github.com/Homebrew/brew/issues/13559","id":1305280803,"node_id":"I_kwDOAyxcHc5NzQEj","number":13559,"title":"ruby not found even though installed","user":{"login":"xrisk","id":10669859,"node_id":"MDQ6VXNlcjEwNjY5ODU5","avatar_url":"https://avatars.githubusercontent.com/u/10669859?v=4","gravatar_id":"","url":"https://api.github.com/users/xrisk","html_url":"https://github.com/xrisk","followers_url":"https://api.github.com/users/xrisk/followers","following_url":"https://api.github.com/users/xrisk/following{/other_user}","gists_url":"https://api.github.com/users/xrisk/gists{/gist_id}","starred_url":"https://api.github.com/users/xrisk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xrisk/subscriptions","organizations_url":"https://api.github.com/users/xrisk/orgs","repos_url":"https://api.github.com/users/xrisk/repos","events_url":"https://api.github.com/users/xrisk/events{/privacy}","received_events_url":"https://api.github.com/users/xrisk/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":922544989,"node_id":"MDU6TGFiZWw5MjI1NDQ5ODk=","url":"https://api.github.com/repos/Homebrew/brew/labels/outdated","name":"outdated","color":"d93f0b","default":false,"description":"PR was locked due to age"}],"state":"closed","locked":true,"assignee":{"login":"MikeMcQuaid","id":125011,"node_id":"MDQ6VXNlcjEyNTAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/125011?v=4","gravatar_id":"","url":"https://api.github.com/users/MikeMcQuaid","html_url":"https://github.com/MikeMcQuaid","followers_url":"https://api.github.com/users/MikeMcQuaid/followers","following_url":"https://api.github.com/users/MikeMcQuaid/following{/other_user}","gists_url":"https://api.github.com/users/MikeMcQuaid/gists{/gist_id}","starred_url":"https://api.github.com/users/MikeMcQuaid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MikeMcQuaid/subscriptions","organizations_url":"https://api.github.com/users/MikeMcQuaid/orgs","repos_url":"https://api.github.com/users/MikeMcQuaid/repos","events_url":"https://api.github.com/users/MikeMcQuaid/events{/privacy}","received_events_url":"https://api.github.com/users/MikeMcQuaid/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"MikeMcQuaid","id":125011,"node_id":"MDQ6VXNlcjEyNTAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/125011?v=4","gravatar_id":"","url":"https://api.github.com/users/MikeMcQuaid","html_url":"https://github.com/MikeMcQuaid","followers_url":"https://api.github.com/users/MikeMcQuaid/followers","following_url":"https://api.github.com/users/MikeMcQuaid/following{/other_user}","gists_url":"https://api.github.com/users/MikeMcQuaid/gists{/gist_id}","starred_url":"https://api.github.com/users/MikeMcQuaid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MikeMcQuaid/subscriptions","organizations_url":"https://api.github.com/users/MikeMcQuaid/orgs","repos_url":"https://api.github.com/users/MikeMcQuaid/repos","events_url":"https://api.github.com/users/MikeMcQuaid/events{/privacy}","received_events_url":"https://api.github.com/users/MikeMcQuaid/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":5,"created_at":"2022-07-14T20:56:42Z","updated_at":"2022-08-16T00:08:04Z","closed_at":"2022-07-16T02:17:54Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### `brew config` output\r\n\r\n```shell\r\nHOMEBREW_VERSION: 3.5.4-74-g8dc46a7-dirty\r\nORIGIN: https://github.com/Homebrew/brew\r\nHEAD: 8dc46a7c477929185cba8ca0de5f9c843b3e9385\r\nLast commit: 11 hours ago\r\nCore tap ORIGIN: https://github.com/Homebrew/homebrew-core\r\nCore tap HEAD: 6cc609694248185bf05737c2e8860b79a6040cb4\r\nCore tap last commit: 12 hours ago\r\nCore tap branch: master\r\nHOMEBREW_PREFIX: /home/xrisk/homebrew\r\nHOMEBREW_REPOSITORY: /home/xrisk/homebrew\r\nHOMEBREW_CELLAR: /home/xrisk/homebrew/Cellar\r\nHOMEBREW_CASK_OPTS: []\r\nHOMEBREW_DISPLAY: :0\r\nHOMEBREW_MAKE_JOBS: 4\r\nHomebrew Ruby: 2.6.8 => /home/xrisk/.rbenv/versions/2.6.8/bin/ruby\r\nCPU: quad-core 64-bit arm\r\nClang: N/A\r\nGit: 2.34.1 => /bin/git\r\nCurl: 7.81.0 => /bin/curl\r\nKernel: Linux 5.15.0-41-generic aarch64 GNU/Linux\r\nOS: Ubuntu 22.04 LTS (jammy)\r\nHost glibc: 2.35\r\n/usr/bin/gcc: 11.2.0\r\n/usr/bin/ruby: N/A\r\nglibc: N/A\r\ngcc@5: N/A\r\nxorg: N/A\r\n```\r\n\r\n\r\n### `brew doctor` output\r\n\r\n```shell\r\nWarning: \"config\" scripts exist outside your system or Homebrew directories.\r\n`./configure` scripts often look for *-config scripts to determine if\r\nsoftware packages are installed, and which additional flags to use when\r\ncompiling and linking.\r\n\r\nHaving additional scripts in your path can confuse software installed via\r\nHomebrew if the config script overrides a system or Homebrew-provided\r\nscript of the same name. We found the following \"config\" scripts:\r\n  /home/xrisk/.pyenv/shims/python3-config\r\n  /home/xrisk/.pyenv/shims/python3.10-config\r\n  /home/xrisk/.pyenv/shims/python-config\r\n\r\nWarning: You have uncommitted modifications to Homebrew/brew.\r\nIf this is a surprise to you, then you should stash these modifications.\r\nStashing returns Homebrew to a pristine state but can be undone\r\nshould you later need to do so for some reason.\r\n  cd /home/xrisk/homebrew && git stash && git clean -d -f\r\n\r\nUncommitted files:\r\n   M Library/Homebrew/utils/ruby.sh\r\n   M Library/Homebrew/utils/ruby_check_version_script.rb\r\n\r\nWarning: Your Homebrew's prefix is not /home/linuxbrew/.linuxbrew.\r\nSome of Homebrew's bottles (binary packages) can only be used with the default\r\nprefix (/home/linuxbrew/.linuxbrew).\r\nYou will encounter build failures with some formulae.\r\nPlease create pull requests instead of asking for help on Homebrew's GitHub,\r\nTwitter or any other official channels. You are responsible for resolving\r\nany issues you experience while you are running this\r\nunsupported configuration.\r\n\r\n\r\nWarning: Your CPU architecture (arm64) is not supported. We only support\r\nx86_64 CPU architectures. You will be unable to use binary packages (bottles).\r\nYou will encounter build failures with some formulae.\r\nPlease create pull requests instead of asking for help on Homebrew's GitHub,\r\nTwitter or any other official channels. You are responsible for resolving\r\nany issues you experience while you are running this\r\nunsupported configuration.\r\n```\r\n\r\n\r\n### Verification\r\n\r\n- [X] I ran `brew update` and am still able to reproduce my issue.\r\n- [X] I have resolved all warnings from `brew doctor` and that did not fix my problem.\r\n\r\n### What were you trying to do (and why)?\r\n\r\nUse homebrew commands\r\n\r\n### What happened (include all command output)?\r\n\r\nTyping any brew command gives:\r\n\r\n```\r\n+ echo 'Failed to install Homebrew Portable Ruby and cannot find another Ruby 2.6.8!\r\nIf there'\\''s no Homebrew Portable Ruby available for your processor:\r\n- install Ruby 2.6.8 with your system package manager (or rbenv/ruby-build)\r\n- make it first in your PATH\r\n- try again\r\n'\r\nFailed to install Homebrew Portable Ruby and cannot find another Ruby 2.6.8!\r\nIf there's no Homebrew Portable Ruby available for your processor:\r\n- install Ruby 2.6.8 with your system package manager (or rbenv/ruby-build)\r\n- make it first in your PATH\r\n- try again\r\n```\r\n\r\n```\r\nxrisk@rishav-ubuntu:~/tmp$ ruby --version\r\nruby 2.6.8p205 (2021-07-07 revision 67951) [aarch64-linux]\r\n```\r\n\r\nThrough tracing the script execution, I find that the call to the version detection script is: `/home/xrisk/.rbenv/shims/ruby --enable-frozen-string-literal --disable=gems,did_you_mean,rubyopt /home/xrisk/tmp/homebrew/Library/Homebrew/utils/ruby_check_version_script.rb 2.6.8`\r\n\r\nManually running this command gives\r\n\r\n```\r\n/home/xrisk/tmp/homebrew/Library/Homebrew/utils/ruby_check_version_script.rb:22:in `<main>': undefined method `present?' for nil:NilClass (NoMethodError)\r\n```\r\n\r\nfrom these lines: https://github.com/Homebrew/brew/blob/8dc46a7c477929185cba8ca0de5f9c843b3e9385/Library/Homebrew/utils/ruby_check_version_script.rb#L20-L21\r\n\r\nI am assuming that .present? is only available on Homebrew’s ENV and not the native Ruby version. Please correct me if I’m wrong.\r\n\r\n### What did you expect to happen?\r\n\r\nHomebrew to use the Ruby on the path.\r\n\r\n### Step-by-step reproduction instructions (by running `brew` commands)\r\n\r\n```\r\nxrisk@rishav-ubuntu:~/tmp$ git clone https://github.com/Homebrew/brew homebrew\r\nCloning into 'homebrew'...\r\nremote: Enumerating objects: 211920, done.\r\nremote: Counting objects: 100% (108/108), done.\r\nremote: Compressing objects: 100% (60/60), done.\r\nremote: Total 211920 (delta 53), reused 83 (delta 36), pack-reused 211812\r\nReceiving objects: 100% (211920/211920), 58.67 MiB | 2.80 MiB/s, done.\r\nResolving deltas: 100% (155938/155938), done.\r\nxrisk@rishav-ubuntu:~/tmp$ eval \"$(homebrew/bin/brew shellenv)\"\r\nxrisk@rishav-ubuntu:~/tmp$ brew update --force\r\n==> Homebrew has enabled anonymous aggregate formula and cask analytics.\r\nRead the analytics documentation (and how to opt-out) here:\r\n  https://docs.brew.sh/Analytics\r\nNo analytics have been recorded yet (nor will be during this `brew` run).\r\n\r\n==> Homebrew is run entirely by unpaid volunteers. Please consider donating:\r\n  https://github.com/Homebrew/brew#donations\r\n==> Tapping homebrew/core\r\nCloning into '/home/xrisk/tmp/homebrew/Library/Taps/homebrew/homebrew-core'...\r\nremote: Enumerating objects: 1228550, done.\r\nremote: Counting objects: 100% (69/69), done.\r\nremote: Compressing objects: 100% (37/37), done.\r\nremote: Total 1228550 (delta 39), reused 59 (delta 32), pack-reused 1228481\r\nReceiving objects: 100% (1228550/1228550), 493.48 MiB | 3.04 MiB/s, done.\r\nResolving deltas: 100% (847866/847866), done.\r\nTapped 3 commands and 6188 formulae (6,530 files, 541.2MB).\r\nAlready up-to-date.\r\nxrisk@rishav-ubuntu:~/tmp$ brew\r\nExample usage:\r\n  brew search TEXT|/REGEX/\r\n  brew info [FORMULA|CASK...]\r\n  brew install FORMULA|CASK...\r\n  brew update\r\n  brew upgrade [FORMULA|CASK...]\r\n  brew uninstall FORMULA|CASK...\r\n  brew list [FORMULA|CASK...]\r\n\r\nTroubleshooting:\r\n  brew config\r\n  brew doctor\r\n  brew install --verbose --debug FORMULA|CASK\r\n\r\nContributing:\r\n  brew create URL [--no-fetch]\r\n  brew edit [FORMULA|CASK...]\r\n\r\nFurther help:\r\n  brew commands\r\n  brew help [COMMAND]\r\n  man brew\r\n  https://docs.brew.sh\r\nxrisk@rishav-ubuntu:~/tmp$ brew developer on \r\nxrisk@rishav-ubuntu:~/tmp$ brew\r\nExample usage:\r\n  brew search TEXT|/REGEX/\r\n  brew info [FORMULA|CASK...]\r\n  brew install FORMULA|CASK...\r\n  brew update\r\n  brew upgrade [FORMULA|CASK...]\r\n  brew uninstall FORMULA|CASK...\r\n  brew list [FORMULA|CASK...]\r\n\r\nTroubleshooting:\r\n  brew config\r\n  brew doctor\r\n  brew install --verbose --debug FORMULA|CASK\r\n\r\nContributing:\r\n  brew create URL [--no-fetch]\r\n  brew edit [FORMULA|CASK...]\r\n\r\nFurther help:\r\n  brew commands\r\n  brew help [COMMAND]\r\n  man brew\r\n  https://docs.brew.sh\r\nxrisk@rishav-ubuntu:~/tmp$ brew update\r\nAlready up-to-date.\r\nxrisk@rishav-ubuntu:~/tmp$ brew\r\nError: No Homebrew ruby 2.6.8_1 available for aarch64 processors!\r\nError: Failed to install Homebrew Portable Ruby and cannot find another Ruby 2.6.8!\r\nIf there's no Homebrew Portable Ruby available for your processor:\r\n- install Ruby 2.6.8 with your system package manager (or rbenv/ruby-build)\r\n- make it first in your PATH\r\n- try again\r\n\r\n```\r\n\r\n","closed_by":{"login":"MikeMcQuaid","id":125011,"node_id":"MDQ6VXNlcjEyNTAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/125011?v=4","gravatar_id":"","url":"https://api.github.com/users/MikeMcQuaid","html_url":"https://github.com/MikeMcQuaid","followers_url":"https://api.github.com/users/MikeMcQuaid/followers","following_url":"https://api.github.com/users/MikeMcQuaid/following{/other_user}","gists_url":"https://api.github.com/users/MikeMcQuaid/gists{/gist_id}","starred_url":"https://api.github.com/users/MikeMcQuaid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MikeMcQuaid/subscriptions","organizations_url":"https://api.github.com/users/MikeMcQuaid/orgs","repos_url":"https://api.github.com/users/MikeMcQuaid/repos","events_url":"https://api.github.com/users/MikeMcQuaid/events{/privacy}","received_events_url":"https://api.github.com/users/MikeMcQuaid/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Homebrew/brew/issues/13559/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Homebrew/brew/issues/13559/timeline","performed_via_github_app":null,"state_reason":"completed"}