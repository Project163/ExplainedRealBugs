{"url":"https://api.github.com/repos/Homebrew/brew/issues/12716","repository_url":"https://api.github.com/repos/Homebrew/brew","labels_url":"https://api.github.com/repos/Homebrew/brew/issues/12716/labels{/name}","comments_url":"https://api.github.com/repos/Homebrew/brew/issues/12716/comments","events_url":"https://api.github.com/repos/Homebrew/brew/issues/12716/events","html_url":"https://github.com/Homebrew/brew/issues/12716","id":1101929643,"node_id":"I_kwDOAyxcHc5Brhyr","number":12716,"title":"`brew install` silently ignores pins","user":{"login":"treuherz","id":1574403,"node_id":"MDQ6VXNlcjE1NzQ0MDM=","avatar_url":"https://avatars.githubusercontent.com/u/1574403?v=4","gravatar_id":"","url":"https://api.github.com/users/treuherz","html_url":"https://github.com/treuherz","followers_url":"https://api.github.com/users/treuherz/followers","following_url":"https://api.github.com/users/treuherz/following{/other_user}","gists_url":"https://api.github.com/users/treuherz/gists{/gist_id}","starred_url":"https://api.github.com/users/treuherz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/treuherz/subscriptions","organizations_url":"https://api.github.com/users/treuherz/orgs","repos_url":"https://api.github.com/users/treuherz/repos","events_url":"https://api.github.com/users/treuherz/events{/privacy}","received_events_url":"https://api.github.com/users/treuherz/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":922544989,"node_id":"MDU6TGFiZWw5MjI1NDQ5ODk=","url":"https://api.github.com/repos/Homebrew/brew/labels/outdated","name":"outdated","color":"d93f0b","default":false,"description":"PR was locked due to age"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-01-13T15:21:30Z","updated_at":"2022-02-13T00:04:41Z","closed_at":"2022-01-13T17:06:38Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### `brew config` output\n\n```shell\nHOMEBREW_VERSION: 3.3.10\r\nORIGIN: https://github.com/Homebrew/brew\r\nHEAD: 385892f3d27dcab0f5a1cb47c3927d9d65ed007c\r\nLast commit: 2 days ago\r\nCore tap ORIGIN: https://github.com/Homebrew/homebrew-core\r\nCore tap HEAD: 531c5269263353310a326f8a7f0c8b0fff94aebd\r\nCore tap last commit: 33 minutes ago\r\nCore tap branch: master\r\nHOMEBREW_PREFIX: /usr/local\r\nHOMEBREW_CASK_OPTS: []\r\nHOMEBREW_CORE_GIT_REMOTE: https://github.com/Homebrew/homebrew-core\r\nHOMEBREW_EDITOR: nvim\r\nHOMEBREW_MAKE_JOBS: 12\r\nHomebrew Ruby: 2.6.8 => /System/Library/Frameworks/Ruby.framework/Versions/2.6/usr/bin/ruby\r\nCPU: dodeca-core 64-bit kabylake\r\nClang: 13.0.0 build 1300\r\nGit: 2.34.1 => /usr/local/bin/git\r\nCurl: 7.77.0 => /usr/bin/curl\r\nmacOS: 12.0.1-x86_64\r\nCLT: 13.2.0.0.1.1638488800\r\nXcode: N/A\n```\n\n\n### `brew doctor` output\n\n```shell\n[Don't think this is relevant]\r\n\r\nWarning: \"config\" scripts exist outside your system or Homebrew directories.\r\n`./configure` scripts often look for *-config scripts to determine if\r\nsoftware packages are installed, and which additional flags to use when\r\ncompiling and linking.\r\n\r\nHaving additional scripts in your path can confuse software installed via\r\nHomebrew if the config script overrides a system or Homebrew-provided\r\nscript of the same name. We found the following \"config\" scripts:\r\n  /Users/et/.local/bin/pre-commit-validate-config\n```\n\n\n### Verification\n\n- [X] I ran `brew update` and am still able to reproduce my issue.\n- [X] I have resolved all warnings from `brew doctor` and that did not fix my problem.\n\n### What were you trying to do (and why)?\n\nI have a pin on the `go` formula at v1.17.2. The latest version is v1.17.5. I ran `brew install go`, expecting it to fail or prompt me due to the pin.\n\n### What happened (include all command output)?\n\n`brew upgrade`, as expected, doesn't upgrade due to the pin\r\n\r\n<details>\r\n<summary>`brew upgrade` output</summary>\r\n\r\n```\r\nâ¯ brew upgrade\r\nError: Not upgrading 1 pinned package:\r\ngo 1.17.5\r\n==> No packages to upgrade\r\n```\r\n\r\n</details>\r\n\r\n\r\n`brew install` ignores the pin and installs the latest version without warning or confirmation\r\n<details>\r\n<summary>`brew install go` output</summary>\r\n\r\n```\r\nâ¯ brew install go\r\ngo 1.17.2 is already installed but outdated (so it will be upgraded).\r\n==> Downloading https://ghcr.io/v2/homebrew/core/go/manifests/1.17.5\r\nAlready downloaded: /Users/et/Library/Caches/Homebrew/downloads/cf2744615eff3cbc7dea57d7f18a41c54c00c2aabe5a6d633f733718a5c0133c--go-1.17.5.bottle_manifest.json\r\n==> Downloading https://ghcr.io/v2/homebrew/core/go/blobs/sha256:7f516d52e4d009e7508fb708ed527674ba8ca447b259a4103a97bf78798309a9\r\n==> Downloading from https://pkg-containers.githubusercontent.com/ghcr1/blobs/sha256:7f516d52e4d009e7508fb708ed527674ba8ca447b259a4103a97\r\n######################################################################## 100.0%\r\n==> Upgrading go\r\n  1.17.2 -> 1.17.5\r\n\r\n==> Pouring go--1.17.5.monterey.bottle.tar.gz\r\nðŸº  /usr/local/Cellar/go/1.17.5: 10,825 files, 565.8MB\r\n==> Running `brew cleanup go`...\r\nDisable this behaviour by setting HOMEBREW_NO_INSTALL_CLEANUP.\r\nHide these hints with HOMEBREW_NO_ENV_HINTS (see `man brew`).\r\nWarning: Skipping (old) /usr/local/Cellar/go/1.17.2 due to it being pinned\r\n```\r\n\r\n</details>\r\n\r\nWhen I run `brew info go` I can see that the pin is still present. This in particular is what make this look like a bug to me.\r\n\r\n<details>\r\n<summary>`brew info go` output</summary>\r\n\r\n```\r\nâ¯ brew info go\r\ngo: stable 1.17.5 (bottled), HEAD [pinned at 1.17.2]\r\nOpen source programming language to build simple/reliable/efficient software\r\nhttps://go.dev/\r\n/usr/local/Cellar/go/1.17.2 (10,814 files, 565.8MB)\r\n  Poured from bottle on 2021-11-23 at 12:31:58\r\n/usr/local/Cellar/go/1.17.5 (10,825 files, 565.8MB) *\r\n  Poured from bottle on 2022-01-13 at 13:37:36\r\nFrom: https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/go.rb\r\nLicense: BSD-3-Clause\r\n==> Options\r\n--HEAD\r\n\tInstall HEAD version\r\n==> Analytics\r\ninstall: 105,860 (30 days), 310,841 (90 days), 1,342,076 (365 days)\r\ninstall-on-request: 85,846 (30 days), 246,196 (90 days), 1,088,199 (365 days)\r\nbuild-error: 274 (30 days)\r\n```\r\n\r\n</details>\n\n### What did you expect to happen?\n\nAt least one of \r\n\r\n* `brew install` prints a warning about the pin\r\n* `brew install` requires confirmation to override the pin\r\n* `brew install` removes or updates the pin on override, so that we're not left with a pin that doesn't match the installed version\n\n### Step-by-step reproduction instructions (by running `brew` commands)\n\n```shell\n`brew install formula`\r\n`brew pin formula`\r\n_Wait for upgraded version_\r\n`brew install formula`\n```\n","closed_by":{"login":"carlocab","id":30379873,"node_id":"MDQ6VXNlcjMwMzc5ODcz","avatar_url":"https://avatars.githubusercontent.com/u/30379873?v=4","gravatar_id":"","url":"https://api.github.com/users/carlocab","html_url":"https://github.com/carlocab","followers_url":"https://api.github.com/users/carlocab/followers","following_url":"https://api.github.com/users/carlocab/following{/other_user}","gists_url":"https://api.github.com/users/carlocab/gists{/gist_id}","starred_url":"https://api.github.com/users/carlocab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/carlocab/subscriptions","organizations_url":"https://api.github.com/users/carlocab/orgs","repos_url":"https://api.github.com/users/carlocab/repos","events_url":"https://api.github.com/users/carlocab/events{/privacy}","received_events_url":"https://api.github.com/users/carlocab/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Homebrew/brew/issues/12716/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Homebrew/brew/issues/12716/timeline","performed_via_github_app":null,"state_reason":"completed"}