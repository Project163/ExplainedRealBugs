{"url":"https://api.github.com/repos/Homebrew/brew/issues/13760","repository_url":"https://api.github.com/repos/Homebrew/brew","labels_url":"https://api.github.com/repos/Homebrew/brew/issues/13760/labels{/name}","comments_url":"https://api.github.com/repos/Homebrew/brew/issues/13760/comments","events_url":"https://api.github.com/repos/Homebrew/brew/issues/13760/events","html_url":"https://github.com/Homebrew/brew/issues/13760","id":1351454341,"node_id":"I_kwDOAyxcHc5QjY6F","number":13760,"title":"Error: maximum tree depth (10) exceeded calculating gcc@5 dependency tree!","user":{"login":"dsklyut","id":5291,"node_id":"MDQ6VXNlcjUyOTE=","avatar_url":"https://avatars.githubusercontent.com/u/5291?v=4","gravatar_id":"","url":"https://api.github.com/users/dsklyut","html_url":"https://github.com/dsklyut","followers_url":"https://api.github.com/users/dsklyut/followers","following_url":"https://api.github.com/users/dsklyut/following{/other_user}","gists_url":"https://api.github.com/users/dsklyut/gists{/gist_id}","starred_url":"https://api.github.com/users/dsklyut/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dsklyut/subscriptions","organizations_url":"https://api.github.com/users/dsklyut/orgs","repos_url":"https://api.github.com/users/dsklyut/repos","events_url":"https://api.github.com/users/dsklyut/events{/privacy}","received_events_url":"https://api.github.com/users/dsklyut/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":922544989,"node_id":"MDU6TGFiZWw5MjI1NDQ5ODk=","url":"https://api.github.com/repos/Homebrew/brew/labels/outdated","name":"outdated","color":"d93f0b","default":false,"description":"PR was locked due to age"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":16,"created_at":"2022-08-25T21:10:24Z","updated_at":"2022-09-30T00:14:48Z","closed_at":"2022-08-26T08:08:37Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### `brew config` output\n\n```shell\nHOMEBREW_VERSION: 3.5.10-49-gb2ddb34\r\nORIGIN: https://github.com/Homebrew/brew\r\nHEAD: b2ddb341a0489834dbbfcb57544d87c4089926c1\r\nLast commit: 5 hours ago\r\nCore tap ORIGIN: https://github.com/Homebrew/homebrew-core\r\nCore tap HEAD: df7d60056bc310daabb1b45757aaf63fd0eaaca8\r\nCore tap last commit: 4 hours ago\r\nCore tap branch: master\r\nHOMEBREW_PREFIX: /home/linuxbrew/.linuxbrew\r\nHOMEBREW_CASK_OPTS: []\r\nHOMEBREW_CURLRC: set\r\nHOMEBREW_CURL_VERBOSE: set\r\nHOMEBREW_EDITOR: vi\r\nHOMEBREW_FORCE_BREWED_CA_CERTIFICATES: set\r\nHOMEBREW_FORCE_BREWED_CURL: set\r\nHOMEBREW_FORCE_BREWED_GIT: set\r\nHOMEBREW_FORCE_VENDOR_RUBY: set\r\nHOMEBREW_MAKE_JOBS: 18\r\nHOMEBREW_NO_ANALYTICS: set\r\nHOMEBREW_NO_ENV_HINTS: set\r\nHomebrew Ruby: 2.6.8 => /home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/vendor/portable-ruby/2.6.8_1/bin/ruby\r\nCPU: 18-core 64-bit haswell\r\nClang: N/A\r\nGit: 2.37.2 => /home/linuxbrew/.linuxbrew/opt/git/bin/git\r\nCurl: 7.84.0 => /home/linuxbrew/.linuxbrew/opt/curl/bin/curl\r\nKernel: Linux 3.10.0-862.6.3.el7.x86_64 x86_64 GNU/Linux\r\nOS: Red Hat Enterprise Linux Server release 7.5 (Maipo)\r\nHost glibc: 2.17\r\n/usr/bin/gcc: 4.8.5\r\n/usr/bin/ruby: N/A\r\nError: maximum tree depth (10) exceeded calculating gcc@5 dependency tree!\n```\n\n\n### `brew doctor` output\n\n```shell\nYour system is ready to brew.\n```\n\n\n### Verification\n\n- [X] I ran `brew update` and am still able to reproduce my issue.\n- [X] I have resolved all warnings from `brew doctor` and that did not fix my problem.\n\n### What were you trying to do (and why)?\n\nbrew install / deps / config fails with this exception.\r\n`Error: maximum tree depth (10) exceeded calculating gcc@5 dependency tree!`\r\n\r\n\n\n### What happened (include all command output)?\n\n```\r\n└─▪ brew deps --tree git --debug\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/git.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/glibc.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/linux-headers@5.15.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/rsync.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/lz4.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/shims/shared/git --version\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/openssl@1.1.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/popt.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/xxhash.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/zstd.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/zlib.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/ca-certificates.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/cmake.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/xz.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/glibc@2.13.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/ncurses.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/linux-headers@4.4.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/pkg-config.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/gpatch.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/gcc@5.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/gmp.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/isl@0.18.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/libmpc.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/mpfr.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/binutils.rb\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb (Formulary::FormulaLoader): loading /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/m4.rb\r\nError: maximum tree depth (10) exceeded calculating gcc@5 dependency tree!\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/extend/os/linux/dependency_collector.rb:63:in `block in init_global_dep_tree_if_needed!'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/extend/os/linux/dependency_collector.rb:51:in `each'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/extend/os/linux/dependency_collector.rb:51:in `init_global_dep_tree_if_needed!'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/dependency_collector.rb:32:in `initialize'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/software_spec.rb:41:in `new'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/software_spec.rb:41:in `initialize'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/formula.rb:2935:in `new'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/formula.rb:2935:in `stable'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/formula.rb:2838:in `url'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/git.rb:4:in `<class:Git>'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/git.rb:1:in `block in load_formula'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/formulary.rb:90:in `module_eval'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/formulary.rb:90:in `block in load_formula'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/formulary.rb:102:in `load_formula'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/formulary.rb:122:in `load_formula_from_path'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/formulary.rb:320:in `load_file'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/formulary.rb:310:in `klass'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/formulary.rb:305:in `get_formula'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/formulary.rb:551:in `factory'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/cli/parser.rb:626:in `block in formulae'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/cli/parser.rb:622:in `map'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/cli/parser.rb:622:in `formulae'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/cli/parser.rb:307:in `parse'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/cmd/deps.rb:80:in `deps'\r\n/home/linuxbrew/.linuxbrew/Homebrew/Library/Homebrew/brew.rb:93:in `<main>'\r\n\r\n```\n\n### What did you expect to happen?\n\nNot to fail with an exception.\r\n\r\nLooking at the code in Library/Homebrew/extend/os/linux/dependency_collector.rb\r\nmaximum_tree_depth = 10 is described as an \"arbitrary\" number... \r\nI bumped it to 15 and so far everything is working.\r\n```\r\n    global_deps.each do |global_dep_name|\r\n      # This is an arbitrary number picked based on testing the current tree\r\n      # depth and just to ensure that this doesn't loop indefinitely if we\r\n      # introduce a circular dependency by mistake.\r\n      maximum_tree_depth = 10\r\n```\r\n\r\n\n\n### Step-by-step reproduction instructions (by running `brew` commands)\n\n```shell\nI reset my homebrew install on RHEL release 7.5 (Maipo) machine completely.\r\nAnd noticed this error trying to install git\r\n\r\nbrew install git \r\n\r\nfailed with: Error: maximum tree depth (10) exceeded calculating gcc@5 dependency tree!\n```\n","closed_by":{"login":"MikeMcQuaid","id":125011,"node_id":"MDQ6VXNlcjEyNTAxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/125011?v=4","gravatar_id":"","url":"https://api.github.com/users/MikeMcQuaid","html_url":"https://github.com/MikeMcQuaid","followers_url":"https://api.github.com/users/MikeMcQuaid/followers","following_url":"https://api.github.com/users/MikeMcQuaid/following{/other_user}","gists_url":"https://api.github.com/users/MikeMcQuaid/gists{/gist_id}","starred_url":"https://api.github.com/users/MikeMcQuaid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MikeMcQuaid/subscriptions","organizations_url":"https://api.github.com/users/MikeMcQuaid/orgs","repos_url":"https://api.github.com/users/MikeMcQuaid/repos","events_url":"https://api.github.com/users/MikeMcQuaid/events{/privacy}","received_events_url":"https://api.github.com/users/MikeMcQuaid/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Homebrew/brew/issues/13760/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Homebrew/brew/issues/13760/timeline","performed_via_github_app":null,"state_reason":"completed"}