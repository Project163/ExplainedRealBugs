diff --git a/changelog/4177.bugfix.rst b/changelog/4177.bugfix.rst
new file mode 100644
index 000000000..b26ad4bad
--- /dev/null
+++ b/changelog/4177.bugfix.rst
@@ -0,0 +1 @@
+Pin ``setuptools>=40.0`` to support ``py_modules`` in ``setup.cfg``
diff --git a/pyproject.toml b/pyproject.toml
index c83bd853d..d17b936c1 100644
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -1,7 +1,7 @@
 [build-system]
 requires = [
   # sync with setup.py until we discard non-pep-517/518
-  "setuptools>=30.3",
+  "setuptools>=40.0",
   "setuptools-scm",
   "wheel",
 ]
diff --git a/setup.py b/setup.py
index 6bab5312d..ac0739455 100644
--- a/setup.py
+++ b/setup.py
@@ -26,7 +26,7 @@ if "_PYTEST_SETUP_SKIP_PLUGGY_DEP" not in os.environ:
 def main():
     setup(
         use_scm_version={"write_to": "src/_pytest/_version.py"},
-        setup_requires=["setuptools-scm", "setuptools>=30.3"],
+        setup_requires=["setuptools-scm", "setuptools>=40.0"],
         package_dir={"": "src"},
         install_requires=INSTALL_REQUIRES,
     )
