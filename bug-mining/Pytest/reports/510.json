{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/13478","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13478/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13478/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13478/events","html_url":"https://github.com/pytest-dev/pytest/issues/13478","id":3112569408,"node_id":"I_kwDOAjwLdc65hgpA","number":13478,"title":"Crash with `console_output_style=times` and skipping tests","user":{"login":"pjonsson","id":2082449,"node_id":"MDQ6VXNlcjIwODI0NDk=","avatar_url":"https://avatars.githubusercontent.com/u/2082449?v=4","gravatar_id":"","url":"https://api.github.com/users/pjonsson","html_url":"https://github.com/pjonsson","followers_url":"https://api.github.com/users/pjonsson/followers","following_url":"https://api.github.com/users/pjonsson/following{/other_user}","gists_url":"https://api.github.com/users/pjonsson/gists{/gist_id}","starred_url":"https://api.github.com/users/pjonsson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pjonsson/subscriptions","organizations_url":"https://api.github.com/users/pjonsson/orgs","repos_url":"https://api.github.com/users/pjonsson/repos","events_url":"https://api.github.com/users/pjonsson/events{/privacy}","received_events_url":"https://api.github.com/users/pjonsson/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":224849193,"node_id":"MDU6TGFiZWwyMjQ4NDkxOTM=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/type:%20bug","name":"type: bug","color":"fc2929","default":false,"description":"problem that needs to be addressed"},{"id":224853076,"node_id":"MDU6TGFiZWwyMjQ4NTMwNzY=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/topic:%20reporting","name":"topic: reporting","color":"fef2c0","default":false,"description":"related to terminal output and user-facing messages and errors"},{"id":8716736983,"node_id":"LA_kwDOAjwLdc8AAAACB47Z1w","url":"https://api.github.com/repos/pytest-dev/pytest/labels/backport%208.4.x","name":"backport 8.4.x","color":"fbca04","default":false,"description":"apply to PRs at any point; backports the changes to the 8.4.x branch"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2025-06-03T06:17:40Z","updated_at":"2025-09-08T11:39:52Z","closed_at":"2025-07-01T21:15:07Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\nThanks for submitting an issue!\n\nQuick check-list while reporting bugs:\n-->\nRunning `uv run pytest -o console_output_style=times tests/test_repro.py tests/test_repro_skip.py` gives me the following backtrace:\n```\ntests/test_repro.py .\nINTERNALERROR> Traceback (most recent call last):\nINTERNALERROR>   File \"/code/.venv/lib/python3.12/site-packages/_pytest/main.py\", line 289, in wrap_session\nINTERNALERROR>     session.exitstatus = doit(config, session) or 0\nINTERNALERROR>                          ^^^^^^^^^^^^^^^^^^^^^\nINTERNALERROR>   File \"/code/.venv/lib/python3.12/site-packages/_pytest/main.py\", line 343, in _main\nINTERNALERROR>     config.hook.pytest_runtestloop(session=session)\nINTERNALERROR>   File \"/code/.venv/lib/python3.12/site-packages/pluggy/_hooks.py\", line 512, in __call__\nINTERNALERROR>     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\nINTERNALERROR>            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nINTERNALERROR>   File \"/code/.venv/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\nINTERNALERROR>     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\nINTERNALERROR>            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nINTERNALERROR>   File \"/code/.venv/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\nINTERNALERROR>     raise exception\nINTERNALERROR>   File \"/code/.venv/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\nINTERNALERROR>     teardown.throw(exception)\nINTERNALERROR>   File \"/code/.venv/lib/python3.12/site-packages/_pytest/logging.py\", line 801, in pytest_runtestloop\nINTERNALERROR>     return (yield)  # Run all the tests.\nINTERNALERROR>             ^^^^^\nINTERNALERROR>   File \"/code/.venv/lib/python3.12/site-packages/pluggy/_callers.py\", line 152, in _multicall\nINTERNALERROR>     teardown.send(result)\nINTERNALERROR>   File \"/code/.venv/lib/python3.12/site-packages/_pytest/terminal.py\", line 693, in pytest_runtestloop\nINTERNALERROR>     self._write_progress_information_filling_space()\nINTERNALERROR>   File \"/code/.venv/lib/python3.12/site-packages/_pytest/terminal.py\", line 758, in _write_progress_information_filling_space\nINTERNALERROR>     msg = self._get_progress_information_message()\nINTERNALERROR>           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nINTERNALERROR>   File \"/code/.venv/lib/python3.12/site-packages/_pytest/terminal.py\", line 734, in _get_progress_information_message\nINTERNALERROR>     return format_node_duration(sum(r.duration for r in not_reported))\nINTERNALERROR>                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nINTERNALERROR>   File \"/code/.venv/lib/python3.12/site-packages/_pytest/terminal.py\", line 734, in <genexpr>\nINTERNALERROR>     return format_node_duration(sum(r.duration for r in not_reported))\nINTERNALERROR>                                     ^^^^^^^^^^\nINTERNALERROR> AttributeError: 'CollectReport' object has no attribute 'duration'. Did you mean: 'location'?\n\n========================= 1 passed, 1 skipped in 0.01s =========================\n```\nRunning either of them separately works:\n```\n$ uv run pytest -o console_output_style=times tests/test_repro.py\n============================= test session starts ==============================\nplatform linux -- Python 3.12.3, pytest-8.4.0, pluggy-1.6.0\nrootdir: /code\nconfigfile: pyproject.toml\nplugins: pytest_httpserver-1.1.3, cov-6.1.1, hypothesis-6.133.2\ncollected 1 item\n\ntests/test_repro.py .                                                   265.2us\n\n============================== 1 passed in 0.06s ===============================\n$  uv run pytest -o console_output_style=times tests/test_repro_skip.py\n============================= test session starts ==============================\nplatform linux -- Python 3.12.3, pytest-8.4.0, pluggy-1.6.0\nrootdir: /code\nconfigfile: pyproject.toml\nplugins: pytest_httpserver-1.1.3, cov-6.1.1, hypothesis-6.133.2\ncollected 0 items / 2 skipped\n\n============================== 2 skipped in 0.06s ==============================\n```\nThis is the content of `test_repro.py`:\n```python\ndef test_hello() -> None:\n    pass\n```\nand this is the content of `test_repro_skip.py`:\n```python\nimport pytest\n\nname = pytest.importorskip(\"fakepackage\")\n```\nThe other `console_output_style`s do not give a backtrace for me.\n\nPytest 8.4.0 on Ubuntu 24.04.\n\n```\n$ uv pip list\nUsing Python 3.12.3 environment at: /env\nPackage                       Version\n----------------------------- -------------------------------\naccessible-pygments           0.0.5\naffine                        2.4.0\nalabaster                     1.0.0\nalembic                       1.16.1\nantimeridian                  0.4.1\nastroid                       3.3.10\nasttokens                     3.0.0\nattrs                         25.3.0\nautodocsumm                   0.2.14\nbabel                         2.17.0\nbeautifulsoup4                4.13.4\nbleach                        6.2.0\nboto3                         1.38.25\nboto3-stubs                   1.38.25\nbotocore                      1.38.25\nbotocore-stubs                1.38.25\nbottleneck                    1.5.0\ncachetools                    6.0.0\ncertifi                       2025.4.26\ncffi                          1.17.1\ncftime                        1.6.4.post1\ncharset-normalizer            3.4.2\nciso8601                      2.3.2\nclick                         8.2.1\nclick-plugins                 1.1.1\ncligj                         0.7.2\ncloudpickle                   3.1.1\ncommonmark                    0.9.1\ncoverage                      7.8.2\ncryptography                  45.0.3\ndask                          2025.5.1\ndatacube                      1.9.5.dev13+g9e14c18c.d20250603\ndc-tests-io                   1.0\ndcio-example                  1.1\ndecorator                     5.2.1\ndefusedxml                    0.7.1\ndeprecat                      2.1.3\ndill                          0.4.0\ndistributed                   2025.5.1\ndocutils                      0.21.2\nexecuting                     2.2.0\nfastjsonschema                2.21.1\nfsspec                        2025.5.1\ngeoalchemy2                   0.17.1\ngreenlet                      3.2.2\nhypothesis                    6.131.30\nidna                          3.10\nimagesize                     1.4.1\niniconfig                     2.1.0\nipython                       9.2.0\nipython-pygments-lexers       1.1.1\nisort                         6.0.1\njedi                          0.19.2\njinja2                        3.1.6\njmespath                      1.0.1\njsonschema                    4.24.0\njsonschema-specifications     2025.4.1\njupyter-client                8.6.3\njupyter-core                  5.8.1\njupyterlab-pygments           0.3.0\nlark                          1.2.2\nlocket                        1.0.0\nmako                          1.3.10\nmarkupsafe                    3.0.2\nmatplotlib-inline             0.1.7\nmccabe                        0.7.0\nmistune                       3.1.3\nmoto                          5.1.5\nmsgpack                       1.1.0\nmypy                          1.15.0\nmypy-extensions               1.1.0\nnbclient                      0.10.2\nnbconvert                     7.16.6\nnbformat                      5.10.4\nnbsphinx                      0.9.7\nnetcdf4                       1.7.2\nnumpy                         2.2.6\nodc-geo                       0.4.10\npackaging                     25.0\npandas                        2.2.3\npandas-stubs                  2.2.3.250527\npandocfilters                 1.5.1\nparso                         0.8.4\npartd                         1.4.2\npexpect                       4.9.0\npip                           25.1.1\nplatformdirs                  4.3.8\npluggy                        1.6.0\nprompt-toolkit                3.0.51\npsutil                        7.0.0\npsycopg2                      2.9.10\nptyprocess                    0.7.0\npure-eval                     0.2.3\npycparser                     2.22\npydata-sphinx-theme           0.16.1\npygments                      2.19.1\npylint                        3.3.7\npyparsing                     3.2.3\npyproj                        3.7.1\npytest                        8.3.5\npytest-cov                    6.1.1\npytest-httpserver             1.1.3\npython-dateutil               2.9.0.post0\npytz                          2025.2\npyyaml                        6.0.2\npyzmq                         26.4.0\nrasterio                      1.4.3\nrecommonmark                  0.7.1\nreferencing                   0.36.2\nrequests                      2.32.3\nresponses                     0.25.7\nrpds-py                       0.25.1\nruamel-yaml                   0.18.11\nruamel-yaml-clib              0.2.12\nruff                          0.11.11\ns3transfer                    0.13.0\nsetuptools                    80.9.0\nshapely                       2.1.1\nsix                           1.17.0\nsnowballstemmer               3.0.1\nsortedcontainers              2.4.0\nsoupsieve                     2.7\nsphinx                        8.1.3\nsphinx-autodoc-typehints      3.0.1\nsphinx-click                  6.0.0\nsphinx-design                 0.6.1\nsphinxcontrib-applehelp       2.0.0\nsphinxcontrib-devhelp         2.0.0\nsphinxcontrib-htmlhelp        2.1.0\nsphinxcontrib-jsmath          1.0.1\nsphinxcontrib-qthelp          2.0.0\nsphinxcontrib-serializinghtml 2.0.0\nsqlalchemy                    2.0.41\nstack-data                    0.6.3\ntblib                         3.1.0\ntinycss2                      1.4.0\ntomlkit                       0.13.2\ntoolz                         1.0.0\ntornado                       6.5.1\ntraitlets                     5.14.3\ntypes-affine                  0.1.0\ntypes-awscrt                  0.27.2\ntypes-cachetools              6.0.0.20250525\ntypes-cffi                    1.17.0.20250523\ntypes-jsonschema              4.24.0.20250528\ntypes-psutil                  7.0.0.20250516\ntypes-pyopenssl               24.1.0.20240722\ntypes-python-dateutil         2.9.0.20250516\ntypes-pytz                    2025.2.0.20250516\ntypes-pyyaml                  6.0.12.20250516\ntypes-redis                   4.6.0.20241004\ntypes-s3transfer              0.13.0\ntypes-setuptools              80.9.0.20250529\ntyping-extensions             4.13.2\ntzdata                        2025.2\nurllib3                       2.4.0\nwcwidth                       0.2.13\nwebencodings                  0.5.1\nwerkzeug                      3.1.3\nwrapt                         1.17.2\nxarray                        2025.4.0\nxmltodict                     0.14.2\nzict                          3.0.0\n```\n\n- [X] a detailed description of the bug or problem you are having\n- [X] output of `pip list` from the virtual environment you are using\n- [X] pytest and operating system versions\n- [X] minimal example if possible\n","closed_by":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/13478/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13478/timeline","performed_via_github_app":null,"state_reason":"completed"}