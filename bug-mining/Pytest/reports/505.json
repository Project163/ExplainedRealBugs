{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/13480","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13480/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13480/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13480/events","html_url":"https://github.com/pytest-dev/pytest/issues/13480","id":3113076567,"node_id":"I_kwDOAjwLdc65jcdX","number":13480,"title":"pytest's test suite fails if run with `-Wdefault`","user":{"login":"mgorny","id":110765,"node_id":"MDQ6VXNlcjExMDc2NQ==","avatar_url":"https://avatars.githubusercontent.com/u/110765?v=4","gravatar_id":"","url":"https://api.github.com/users/mgorny","html_url":"https://github.com/mgorny","followers_url":"https://api.github.com/users/mgorny/followers","following_url":"https://api.github.com/users/mgorny/following{/other_user}","gists_url":"https://api.github.com/users/mgorny/gists{/gist_id}","starred_url":"https://api.github.com/users/mgorny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgorny/subscriptions","organizations_url":"https://api.github.com/users/mgorny/orgs","repos_url":"https://api.github.com/users/mgorny/repos","events_url":"https://api.github.com/users/mgorny/events{/privacy}","received_events_url":"https://api.github.com/users/mgorny/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2025-06-03T08:58:15Z","updated_at":"2025-06-18T08:27:53Z","closed_at":"2025-06-18T08:27:53Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"- [x] a detailed description of the bug or problem you are having\n- [x] output of `pip list` from the virtual environment you are using\n- [x] pytest and operating system versions\n- [x] minimal example if possible\n\n## Description, reproducer and traceback\n\nWhen the pytest's test suite is run with explicit `-Wdefault`, a few tests fail:\n\n```pytb\n$ tox -e py313 -- -Wdefault\n.pkg: _optional_hooks> python /usr/lib/python3.14/site-packages/pyproject_api/_backend.py True setuptools.build_meta\n.pkg: get_requires_for_build_sdist> python /usr/lib/python3.14/site-packages/pyproject_api/_backend.py True setuptools.build_meta\n.pkg: get_requires_for_build_editable> python /usr/lib/python3.14/site-packages/pyproject_api/_backend.py True setuptools.build_meta\n.pkg: build_sdist> python /usr/lib/python3.14/site-packages/pyproject_api/_backend.py True setuptools.build_meta\npy313: install_package> python -I -m pip install --force-reinstall --no-deps /tmp/pytest/.tox/.tmp/package/2/pytest-8.5.0.dev1+g80dfa2db8.tar.gz\npy313: commands[0]> pytest -Wdefault\n========================================================= test session starts =========================================================\nplatform linux -- Python 3.13.3, pytest-8.5.0.dev1+g80dfa2db8, pluggy-1.6.0\ncachedir: .tox/py313/.pytest_cache\nrootdir: /tmp/pytest\nconfigfile: pyproject.toml\ntestpaths: testing\nplugins: hypothesis-6.133.2\ncollected 3913 items                                                                                                                  \n\ntesting/_py/test_local.py .................................................................ss..............s.................x. [  2%]\n....Xs.....................................sssssss............................x...                                              [  4%]\ntesting/acceptance_test.py .....                                                                                                [  4%]\ntesting/code/test_code.py .................                                                                                     [  5%]\ntesting/code/test_excinfo.py .................s.......s........................................................................ [  7%]\n............................................................                                                                    [  9%]\ntesting/code/test_source.py .......................................................                                             [ 10%]\ntesting/deprecated_test.py ..........                                                                                           [ 10%]\ntesting/freeze/tests/test_doctest.txt .                                                                                         [ 10%]\ntesting/freeze/tests/test_trivial.py ..                                                                                         [ 11%]\ntesting/io/test_pprint.py ......................................                                                                [ 11%]\ntesting/io/test_saferepr.py .............                                                                                       [ 12%]\ntesting/io/test_terminalwriter.py .................................................                                             [ 13%]\ntesting/io/test_wcwidth.py .................                                                                                    [ 14%]\ntesting/logging/test_fixture.py ...................                                                                             [ 14%]\ntesting/logging/test_formatter.py ....                                                                                          [ 14%]\ntesting/logging/test_reporting.py ..                                                                                            [ 14%]\ntesting/python/approx.py .sss..sssss............................s............sssssss................ss..........                [ 16%]\ntesting/python/collect.py ..                                                                                                    [ 16%]\ntesting/python/fixtures.py ....s......                                                                                          [ 17%]\ntesting/python/integration.py ....                                                                                              [ 17%]\ntesting/python/metafunc.py ...........................................                                                          [ 18%]\ntesting/python/raises.py ...........................                                                                            [ 19%]\ntesting/python/raises_group.py .............s.............                                                                      [ 19%]\ntesting/test_argcomplete.py ..                                                                                                  [ 19%]\ntesting/test_assertion.py .........................................................................                             [ 21%]\ntesting/test_assertrewrite.py ................................................                                                  [ 22%]\ntesting/test_capture.py .............................................................s..                                        [ 24%]\ntesting/test_collection.py ..                                                                                                   [ 24%]\ntesting/test_compat.py ..........                                                                                               [ 24%]\ntesting/test_config.py .............................................................                                            [ 26%]\ntesting/test_conftest.py ...........                                                                                            [ 26%]\ntesting/test_debugging.py .                                                                                                     [ 26%]\ntesting/test_doctest.py .............                                                                                           [ 27%]\ntesting/test_entry_points.py .                                                                                                  [ 27%]\ntesting/test_faulthandler.py ...                                                                                                [ 27%]\ntesting/test_findpaths.py ..............s...                                                                                    [ 27%]\ntesting/test_helpconfig.py .                                                                                                    [ 27%]\ntesting/test_junitxml.py .........                                                                                              [ 27%]\ntesting/test_legacypath.py ....                                                                                                 [ 27%]\ntesting/test_main.py .....                                                                                                      [ 28%]\ntesting/test_mark.py ..............                                                                                             [ 28%]\ntesting/test_mark_expression.py ............................................................................................... [ 30%]\n.............................................                                                                                   [ 32%]\ntesting/test_monkeypatch.py ...............................                                                                     [ 32%]\ntesting/test_nodes.py ....                                                                                                      [ 32%]\ntesting/test_parseopt.py .............................                                                                          [ 33%]\ntesting/test_pastebin.py .....                                                                                                  [ 33%]\ntesting/test_pluginmanager.py .........                                                                                         [ 34%]\ntesting/test_pytester.py .....................                                                                                  [ 34%]\ntesting/test_recwarn.py .........................................................                                               [ 36%]\ntesting/test_runner.py ...............                                                                                          [ 36%]\ntesting/test_scope.py ....                                                                                                      [ 36%]\ntesting/test_skipping.py .                                                                                                      [ 36%]\ntesting/test_stash.py .                                                                                                         [ 36%]\ntesting/test_terminal.py .................................................                                                      [ 37%]\ntesting/test_tmpdir.py ...s...............                                                                                      [ 38%]\ntesting/test_warning_types.py .............                                                                                     [ 38%]\ntesting/test_warnings.py .                                                                                                      [ 38%]\ntesting/acceptance_test.py ..................................................s...x.........................s...                 [ 40%]\ntesting/code/test_excinfo.py .............sssssssss.......                                                                      [ 41%]\ntesting/deprecated_test.py ....                                                                                                 [ 41%]\ntesting/examples/test_issue519.py .                                                                                             [ 41%]\ntesting/logging/test_fixture.py ........                                                                                        [ 41%]\ntesting/logging/test_reporting.py ..................................................                                            [ 43%]\ntesting/python/approx.py .                                                                                                      [ 43%]\ntesting/python/collect.py ...............................................................................                       [ 45%]\ntesting/python/fixtures.py ...........................................................................x........................ [ 47%]\n.................................................................................s.........                                     [ 50%]\ntesting/python/integration.py ................                                                                                  [ 50%]\ntesting/python/metafunc.py .....................................................................                                [ 52%]\ntesting/python/raises.py ....                                                                                                   [ 52%]\ntesting/python/raises_group.py ..                                                                                               [ 52%]\ntesting/python/show_fixtures_per_test.py ........                                                                               [ 52%]\ntesting/test_assertion.py ...........................................................................                           [ 54%]\ntesting/test_assertrewrite.py ...................................................................                               [ 56%]\ntesting/test_cacheprovider.py .........................................................                                         [ 57%]\ntesting/test_capture.py ......x.....................................                                                            [ 58%]\ntesting/test_collect_imported_tests.py ...                                                                                      [ 58%]\ntesting/test_collection.py ................x............................................s................s...                   [ 61%]\ntesting/test_config.py ..................x..................................................................................... [ 63%]\n..............................................                                                                                  [ 64%]\ntesting/test_conftest.py .............s.............................                                                            [ 65%]\ntesting/test_debugging.py .............                                                                                         [ 66%]\ntesting/test_doctest.py ................................................................x...................................... [ 68%]\n.........................                                                                                                       [ 69%]\ntesting/test_error_diffs.py ............                                                                                        [ 69%]\ntesting/test_faulthandler.py ...                                                                                                [ 69%]\ntesting/test_helpconfig.py ........                                                                                             [ 70%]\ntesting/test_junitxml.py ..................................................................................................s... [ 72%]\ns........................                                                                                                       [ 73%]\ntesting/test_legacypath.py ..........                                                                                           [ 73%]\ntesting/test_link_resolve.py .                                                                                                  [ 73%]\ntesting/test_main.py ..............                                                                                             [ 74%]\ntesting/test_mark.py ......................................................................x...................                 [ 76%]\ntesting/test_monkeypatch.py ...s                                                                                                [ 76%]\ntesting/test_nodes.py ....                                                                                                      [ 76%]\ntesting/test_parseopt.py .                                                                                                      [ 76%]\ntesting/test_pastebin.py ...                                                                                                    [ 76%]\ntesting/test_pathlib.py ............................................................s.......................................... [ 79%]\n........                                                                                                                        [ 79%]\ntesting/test_pluginmanager.py ....s............                                                                                 [ 79%]\ntesting/test_pytester.py x........................                                                                              [ 80%]\ntesting/test_python_path.py ......                                                                                              [ 80%]\ntesting/test_recwarn.py .....                                                                                                   [ 80%]\ntesting/test_reports.py ..................                                                                                      [ 81%]\ntesting/test_runner.py ........................x...........................                                                     [ 82%]\ntesting/test_runner_xunit.py .............                                                                                      [ 82%]\ntesting/test_session.py ..........................                                                                              [ 83%]\ntesting/test_setuponly.py ..........................                                                                            [ 84%]\ntesting/test_setupplan.py ...                                                                                                   [ 84%]\ntesting/test_skipping.py .........................................................................................              [ 86%]\ntesting/test_stepwise.py ..................                                                                                     [ 87%]\ntesting/test_terminal.py ...................................................s.................................................. [ 89%]\n...........ssss......s...............................                                                                           [ 91%]\ntesting/test_threadexception.py ......F.                                                                                        [ 91%]\ntesting/test_tmpdir.py ....................                                                                                     [ 91%]\ntesting/test_unittest.py ......................sssssss.................................s............                            [ 93%]\ntesting/test_unraisableexception.py ......F...                                                                                  [ 93%]\ntesting/test_warning_types.py .                                                                                                 [ 93%]\ntesting/test_warnings.py .....F.............sss..........                                                                       [ 94%]\ntesting/acceptance_test.py .....                                                                                                [ 94%]\ntesting/python/collect.py .                                                                                                     [ 94%]\ntesting/python/fixtures.py ..                                                                                                   [ 94%]\ntesting/test_assertion.py ............                                                                                          [ 95%]\ntesting/test_assertrewrite.py ..........                                                                                        [ 95%]\ntesting/test_capture.py ........................s                                                                               [ 96%]\ntesting/test_collection.py ...                                                                                                  [ 96%]\ntesting/test_config.py ..                                                                                                       [ 96%]\ntesting/test_debugging.py sssssssssss.ssssssssssssssss.sssss....ssss.sss                                                        [ 97%]\ntesting/test_faulthandler.py ..s.                                                                                               [ 97%]\ntesting/test_helpconfig.py ..                                                                                                   [ 97%]\ntesting/test_legacypath.py .                                                                                                    [ 97%]\ntesting/test_meta.py ....................................................................                                       [ 99%]\ntesting/test_pytester.py ....s                                                                                                  [ 99%]\ntesting/test_recwarn.py .                                                                                                       [ 99%]\ntesting/test_reports.py .                                                                                                       [ 99%]\ntesting/test_terminal.py ss..                                                                                                   [ 99%]\ntesting/test_unittest.py s.                                                                                                     [ 99%]\ntesting/test_unraisableexception.py .                                                                                           [ 99%]\ntesting/test_warnings.py ..........                                                                                             [100%]\n\n============================================================== FAILURES ===============================================================\n___________________________________________ test_unhandled_thread_exception_after_teardown ____________________________________________\n\npytester = <Pytester PosixPath('/tmp/pytest-of-mgorny/pytest-19/test_unhandled_thread_exception_after_teardown0')>\n\n    def test_unhandled_thread_exception_after_teardown(pytester: Pytester) -> None:\n        pytester.makepyfile(\n            test_it=\"\"\"\n            import threading\n            import pytest\n    \n            def thread():\n                def oops():\n                    raise ValueError(\"Oops\")\n    \n                t = threading.Thread(target=oops, name=\"MyThread\")\n                t.start()\n                t.join()\n    \n            def test_it(request):\n                request.config.add_cleanup(thread)\n            \"\"\"\n        )\n    \n        result = pytester.runpytest()\n    \n        # TODO: should be a test failure or error\n>       assert result.ret == pytest.ExitCode.INTERNAL_ERROR\nE       AssertionError: assert <ExitCode.OK: 0> == <ExitCode.INTERNAL_ERROR: 3>\nE        +  where <ExitCode.OK: 0> = <RunResult ret=0 len(stdout.lines)=8 len(stderr.lines)=0 duration=0.46s>.ret\nE        +  and   <ExitCode.INTERNAL_ERROR: 3> = <enum 'ExitCode'>.INTERNAL_ERROR\nE        +    where <enum 'ExitCode'> = pytest.ExitCode\n\n/tmp/pytest/testing/test_threadexception.py:217: AssertionError\n-------------------------------------------------------- Captured stdout call ---------------------------------------------------------\n============================= test session starts ==============================\nplatform linux -- Python 3.13.3, pytest-8.5.0.dev1+g80dfa2db8, pluggy-1.6.0\nrootdir: /tmp/pytest-of-mgorny/pytest-19/test_unhandled_thread_exception_after_teardown0\ncollected 1 item\n\ntest_it.py .                                                             [100%]\n\n============================== 1 passed in 0.00s ===============================\n______________________________________________________ test_refcycle_unraisable _______________________________________________________\n\npytester = <Pytester PosixPath('/tmp/pytest-of-mgorny/pytest-19/test_refcycle_unraisable0')>\n\n    def test_refcycle_unraisable(pytester: Pytester) -> None:\n        # see: https://github.com/pytest-dev/pytest/issues/10404\n        pytester.makepyfile(\n            test_it=\"\"\"\n            import pytest\n    \n            class BrokenDel:\n                def __init__(self):\n                    self.self = self  # make a reference cycle\n    \n                def __del__(self):\n                    raise ValueError(\"del is broken\")\n    \n            def test_it():\n                BrokenDel()\n            \"\"\"\n        )\n    \n        with _disable_gc():\n            result = pytester.runpytest()\n    \n        # TODO: should be a test failure or error\n>       assert result.ret == pytest.ExitCode.INTERNAL_ERROR\nE       AssertionError: assert <ExitCode.OK: 0> == <ExitCode.INTERNAL_ERROR: 3>\nE        +  where <ExitCode.OK: 0> = <RunResult ret=0 len(stdout.lines)=8 len(stderr.lines)=0 duration=0.46s>.ret\nE        +  and   <ExitCode.INTERNAL_ERROR: 3> = <enum 'ExitCode'>.INTERNAL_ERROR\nE        +    where <enum 'ExitCode'> = pytest.ExitCode\n\n/tmp/pytest/testing/test_unraisableexception.py:263: AssertionError\n-------------------------------------------------------- Captured stdout call ---------------------------------------------------------\n============================= test session starts ==============================\nplatform linux -- Python 3.13.3, pytest-8.5.0.dev1+g80dfa2db8, pluggy-1.6.0\nrootdir: /tmp/pytest-of-mgorny/pytest-19/test_refcycle_unraisable0\ncollected 1 item\n\ntest_it.py .                                                             [100%]\n\n============================== 1 passed in 0.00s ===============================\n___________________________________________________ test_works_with_filterwarnings ____________________________________________________\n\npytester = <Pytester PosixPath('/tmp/pytest-of-mgorny/pytest-19/test_works_with_filterwarnings0')>\n\n    def test_works_with_filterwarnings(pytester: Pytester) -> None:\n        \"\"\"Ensure our warnings capture does not mess with pre-installed filters (#2430).\"\"\"\n        pytester.makepyfile(\n            \"\"\"\n            import warnings\n    \n            class MyWarning(Warning):\n                pass\n    \n            warnings.filterwarnings(\"error\", category=MyWarning)\n    \n            class TestWarnings(object):\n                def test_my_warning(self):\n                    try:\n                        warnings.warn(MyWarning(\"warn!\"))\n                        assert False\n                    except MyWarning:\n                        assert True\n        \"\"\"\n        )\n        result = pytester.runpytest()\n>       result.stdout.fnmatch_lines([\"*== 1 passed in *\"])\nE       Failed: nomatch: '*== 1 passed in *'\nE           and: '============================= test session starts =============================='\nE           and: 'platform linux -- Python 3.13.3, pytest-8.5.0.dev1+g80dfa2db8, pluggy-1.6.0'\nE           and: 'rootdir: /tmp/pytest-of-mgorny/pytest-19/test_works_with_filterwarnings0'\nE           and: 'collected 1 item'\nE           and: ''\nE           and: 'test_works_with_filterwarnings.py F                                      [100%]'\nE           and: ''\nE           and: '=================================== FAILURES ==================================='\nE           and: '_________________________ TestWarnings.test_my_warning _________________________'\nE           and: ''\nE           and: 'self = <test_works_with_filterwarnings.TestWarnings object at 0x7f982a93a710>'\nE           and: ''\nE           and: '    def test_my_warning(self):'\nE           and: '        try:'\nE           and: '            warnings.warn(MyWarning(\"warn!\"))'\nE           and: '>           assert False'\nE           and: 'E           assert False'\nE           and: ''\nE           and: 'test_works_with_filterwarnings.py:12: AssertionError'\nE           and: '=============================== warnings summary ==============================='\nE           and: 'test_works_with_filterwarnings.py::TestWarnings::test_my_warning'\nE           and: '  /tmp/pytest-of-mgorny/pytest-19/test_works_with_filterwarnings0/test_works_with_filterwarnings.py:11: MyWarning: warn!'\nE           and: '    warnings.warn(MyWarning(\"warn!\"))'\nE           and: ''\nE           and: '-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html'\nE           and: '=========================== short test summary info ============================'\nE           and: 'FAILED test_works_with_filterwarnings.py::TestWarnings::test_my_warning - ass...'\nE           and: '========================= 1 failed, 1 warning in 0.00s ========================='\nE       remains unmatched: '*== 1 passed in *'\n\n/tmp/pytest/testing/test_warnings.py:173: Failed\n-------------------------------------------------------- Captured stdout call ---------------------------------------------------------\n============================= test session starts ==============================\nplatform linux -- Python 3.13.3, pytest-8.5.0.dev1+g80dfa2db8, pluggy-1.6.0\nrootdir: /tmp/pytest-of-mgorny/pytest-19/test_works_with_filterwarnings0\ncollected 1 item\n\ntest_works_with_filterwarnings.py F                                      [100%]\n\n=================================== FAILURES ===================================\n_________________________ TestWarnings.test_my_warning _________________________\n\nself = <test_works_with_filterwarnings.TestWarnings object at 0x7f982a93a710>\n\n    def test_my_warning(self):\n        try:\n            warnings.warn(MyWarning(\"warn!\"))\n>           assert False\nE           assert False\n\ntest_works_with_filterwarnings.py:12: AssertionError\n=============================== warnings summary ===============================\ntest_works_with_filterwarnings.py::TestWarnings::test_my_warning\n  /tmp/pytest-of-mgorny/pytest-19/test_works_with_filterwarnings0/test_works_with_filterwarnings.py:11: MyWarning: warn!\n    warnings.warn(MyWarning(\"warn!\"))\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED test_works_with_filterwarnings.py::TestWarnings::test_my_warning - ass...\n========================= 1 failed, 1 warning in 0.00s =========================\n========================================================== warnings summary ===========================================================\ntesting/test_collection.py::TestNodeKeywords::test_duplicates_handled_correctly\n  /tmp/pytest-of-mgorny/pytest-19/test_duplicates_handled_correctly0/test_duplicates_handled_correctly.py:2: PytestUnknownMarkWarning: Unknown pytest.mark.kw - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html\n    pytestmark = pytest.mark.kw\n\ntesting/test_collection.py::TestNodeKeywords::test_duplicates_handled_correctly\n  /tmp/pytest-of-mgorny/pytest-19/test_duplicates_handled_correctly0/test_duplicates_handled_correctly.py:4: PytestUnknownMarkWarning: Unknown pytest.mark.kw - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html\n    pytestmark = pytest.mark.kw\n\ntesting/test_pathlib.py::TestImportPath::test_no_meta_path_found[True]\n  <frozen importlib._bootstrap>:1249: ImportWarning: sys.meta_path is empty\n\ntesting/test_threadexception.py::test_unhandled_thread_exception_after_teardown\n  /tmp/pytest/.tox/py313/lib/python3.13/site-packages/_pytest/threadexception.py:58: PytestUnhandledThreadExceptionWarning: Exception in thread MyThread\n  \n  Traceback (most recent call last):\n    File \"/usr/lib/python3.13/threading.py\", line 1041, in _bootstrap_inner\n      self.run()\n      ~~~~~~~~^^\n    File \"/usr/lib/python3.13/threading.py\", line 992, in run\n      self._target(*self._args, **self._kwargs)\n      ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    File \"/tmp/pytest-of-mgorny/pytest-19/test_unhandled_thread_exception_after_teardown0/test_it.py\", line 6, in oops\n      raise ValueError(\"Oops\")\n  ValueError: Oops\n  \n  Enable tracemalloc to get traceback where the object was allocated.\n  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.\n    warnings.warn(pytest.PytestUnhandledThreadExceptionWarning(msg))\n\ntesting/test_unraisableexception.py::test_refcycle_unraisable\n  /tmp/pytest/.tox/py313/lib/python3.13/site-packages/_pytest/unraisableexception.py:65: PytestUnraisableExceptionWarning: Exception ignored in: <function BrokenDel.__del__ at 0x7f982da9ce00>\n  \n  Traceback (most recent call last):\n    File \"/tmp/pytest-of-mgorny/pytest-19/test_refcycle_unraisable0/test_it.py\", line 8, in __del__\n      raise ValueError(\"del is broken\")\n  ValueError: del is broken\n  \n  Enable tracemalloc to get traceback where the object was allocated.\n  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.\n    warnings.warn(pytest.PytestUnraisableExceptionWarning(msg))\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=============================================================== XPASSES ===============================================================\n======================================================= short test summary info =======================================================\nFAILED testing/test_threadexception.py::test_unhandled_thread_exception_after_teardown - AssertionError: assert <ExitCode.OK: 0> == <ExitCode.INTERNAL_ERROR: 3>\nFAILED testing/test_unraisableexception.py::test_refcycle_unraisable - AssertionError: assert <ExitCode.OK: 0> == <ExitCode.INTERNAL_ERROR: 3>\nFAILED testing/test_warnings.py::test_works_with_filterwarnings - Failed: nomatch: '*== 1 passed in *'\nXPASS testing/_py/test_local.py::TestLocalPath::test_make_numbered_dir_multiprocess_safe - #11603\n===================== 3 failed, 3780 passed, 118 skipped, 11 xfailed, 1 xpassed, 5 warnings in 1266.05s (0:21:06) =====================\n/tmp/pytest/.tox/py313/lib/python3.13/site-packages/_pytest/pathlib.py:96: PytestWarning: (rm_rf) error removing /tmp/pytest-of-mgorny/garbage-ab8a2c0b-0bbc-4d3c-a495-b55743aa671e/popen-gw4\n<class 'OSError'>: [Errno 39] Directory not empty: '/tmp/pytest-of-mgorny/garbage-ab8a2c0b-0bbc-4d3c-a495-b55743aa671e/popen-gw4'\n  warnings.warn(\n/tmp/pytest/.tox/py313/lib/python3.13/site-packages/_pytest/pathlib.py:96: PytestWarning: (rm_rf) error removing /tmp/pytest-of-mgorny/garbage-ab8a2c0b-0bbc-4d3c-a495-b55743aa671e\n<class 'OSError'>: [Errno 39] Directory not empty: '/tmp/pytest-of-mgorny/garbage-ab8a2c0b-0bbc-4d3c-a495-b55743aa671e'\n  warnings.warn(\n/tmp/pytest/.tox/py313/lib/python3.13/site-packages/_pytest/pathlib.py:96: PytestWarning: (rm_rf) error removing /tmp/pytest-of-mgorny/garbage-3f9c18e9-d729-4c3b-b5fc-592558e89708/popen-gw3\n<class 'OSError'>: [Errno 39] Directory not empty: '/tmp/pytest-of-mgorny/garbage-3f9c18e9-d729-4c3b-b5fc-592558e89708/popen-gw3'\n  warnings.warn(\n/tmp/pytest/.tox/py313/lib/python3.13/site-packages/_pytest/pathlib.py:96: PytestWarning: (rm_rf) error removing /tmp/pytest-of-mgorny/garbage-3f9c18e9-d729-4c3b-b5fc-592558e89708\n<class 'OSError'>: [Errno 39] Directory not empty: '/tmp/pytest-of-mgorny/garbage-3f9c18e9-d729-4c3b-b5fc-592558e89708'\n  warnings.warn(\n/tmp/pytest/.tox/py313/lib/python3.13/site-packages/_pytest/pathlib.py:96: PytestWarning: (rm_rf) error removing /tmp/pytest-of-mgorny/garbage-dd098764-abed-44a3-bf67-26226790a709/popen-gw4\n<class 'OSError'>: [Errno 39] Directory not empty: '/tmp/pytest-of-mgorny/garbage-dd098764-abed-44a3-bf67-26226790a709/popen-gw4'\n  warnings.warn(\n/tmp/pytest/.tox/py313/lib/python3.13/site-packages/_pytest/pathlib.py:96: PytestWarning: (rm_rf) error removing /tmp/pytest-of-mgorny/garbage-dd098764-abed-44a3-bf67-26226790a709\n<class 'OSError'>: [Errno 39] Directory not empty: '/tmp/pytest-of-mgorny/garbage-dd098764-abed-44a3-bf67-26226790a709'\n  warnings.warn(\npy313: exit 1 (1267.07 seconds) /tmp/pytest> pytest -Wdefault pid=588370\n  py313: FAIL code 1 (1275.37=setup[8.30]+cmd[1267.07] seconds)\n  evaluation failed :( (1275.65 seconds)\n```\n\n## pip list\n\n```\n$ .tox/py313/bin/pip list\nPackage            Version\n------------------ ---------------------\nargcomplete        3.6.2\nattrs              25.3.0\ncertifi            2025.4.26\ncharset-normalizer 3.4.2\nelementpath        5.0.1\nhypothesis         6.133.2\nidna               3.10\niniconfig          2.1.0\nmock               5.2.0\npackaging          25.0\npip                25.1.1\npluggy             1.6.0\nPygments           2.19.1\npytest             8.5.0.dev1+g80dfa2db8\nrequests           2.32.3\nsetuptools         80.9.0\nsortedcontainers   2.4.0\nurllib3            2.4.0\nxmlschema          4.0.1\n```\n\nReproduced with 80dfa2db8e6157bf706c2f2656ba0fd7bc13195a and 8.4.0.","closed_by":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/13480/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13480/timeline","performed_via_github_app":null,"state_reason":"completed"}