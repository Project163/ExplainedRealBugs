{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/3974","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/3974/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/3974/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/3974/events","html_url":"https://github.com/pytest-dev/pytest/issues/3974","id":359816012,"node_id":"MDU6SXNzdWUzNTk4MTYwMTI=","number":3974,"title":"Confusion between message and match parameters in pytest.raises","user":{"login":"rth","id":630936,"node_id":"MDQ6VXNlcjYzMDkzNg==","avatar_url":"https://avatars.githubusercontent.com/u/630936?v=4","gravatar_id":"","url":"https://api.github.com/users/rth","html_url":"https://github.com/rth","followers_url":"https://api.github.com/users/rth/followers","following_url":"https://api.github.com/users/rth/following{/other_user}","gists_url":"https://api.github.com/users/rth/gists{/gist_id}","starred_url":"https://api.github.com/users/rth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rth/subscriptions","organizations_url":"https://api.github.com/users/rth/orgs","repos_url":"https://api.github.com/users/rth/repos","events_url":"https://api.github.com/users/rth/events{/privacy}","received_events_url":"https://api.github.com/users/rth/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":240739369,"node_id":"MDU6TGFiZWwyNDA3MzkzNjk=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/type:%20backward%20compatibility","name":"type: backward compatibility","color":"f7c6c7","default":false,"description":"might present some backward compatibility issues which should be carefully noted in the changelog"},{"id":659419768,"node_id":"MDU6TGFiZWw2NTk0MTk3Njg=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/type:%20deprecation","name":"type: deprecation","color":"e99695","default":false,"description":"feature that will be removed in the future"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":55,"created_at":"2018-09-13T09:31:42Z","updated_at":"2019-07-18T18:53:14Z","closed_at":"2018-12-13T15:58:23Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"After analyzing several code bases, it appears there is frequent confusion by users between the `match` and `message` parameters in `pytest.raises` (and consequentially `pytest.warns`). \r\n\r\nIn most cases, users probably would want `match` but use `message` by accident, because is it visually similar and the naming does not differentiate their functionality enough. As a result the written test produces false positive which is quite dangerous.\r\n\r\nFor instance, here are instances of such errors in popular open-source projects,\r\n - https://github.com/pandas-dev/pandas/pull/22681#discussion_r217181448\r\n - https://github.com/scipy/scipy/pull/9264\r\n - https://github.com/scikit-learn/scikit-learn/pull/12001\r\n\r\nthe fact that these cases ended up in the code despite fairly thorough review is telling.\r\n\r\nThere was also an earlier issue illustrating this confusion in https://github.com/pytest-dev/pytest/issues/3350\r\n\r\nSearching on github for `\"pytest.raises(ValueError, message=\"` for instance, also shows [a number of examples](https://github.com/search?p=3&q=%22pytest.raises%28ValueError%2C+message%22&type=Code\") that meant to use `\"match\"` instead of `\"message\"` (though sometimes it's hard to tell).\r\n\r\nOne possibility could be to deprecate the `message` parameter and rename it to something more explicit. I saw there were some deprecations related to the use of `node.warn` in 3.8, not sure if that's related. However, following the same logic even if `pytest.raises(ValueError('expected message'))` worked it would still not address all the existing code that currently uses the `message` parameter incorrectly.\r\n\r\n--- \r\n\r\nEDIT by @nicoddemus \r\n\r\nThe `message` parameter has been deprecated and will be removed in pytest 5.0, please see the docs for an alternative which provides the same functionality:\r\n\r\nhttps://docs.pytest.org/en/latest/deprecations.html#raises-message-deprecated","closed_by":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/3974/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/3974/timeline","performed_via_github_app":null,"state_reason":"completed"}