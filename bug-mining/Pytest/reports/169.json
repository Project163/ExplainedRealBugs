{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/6183","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/6183/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/6183/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/6183/events","html_url":"https://github.com/pytest-dev/pytest/issues/6183","id":522337343,"node_id":"MDU6SXNzdWU1MjIzMzczNDM=","number":6183,"title":"Raise an exception when `\"request\"` is used as a parametrization argument ","user":{"login":"nikoskaragiannakis","id":10605673,"node_id":"MDQ6VXNlcjEwNjA1Njcz","avatar_url":"https://avatars.githubusercontent.com/u/10605673?v=4","gravatar_id":"","url":"https://api.github.com/users/nikoskaragiannakis","html_url":"https://github.com/nikoskaragiannakis","followers_url":"https://api.github.com/users/nikoskaragiannakis/followers","following_url":"https://api.github.com/users/nikoskaragiannakis/following{/other_user}","gists_url":"https://api.github.com/users/nikoskaragiannakis/gists{/gist_id}","starred_url":"https://api.github.com/users/nikoskaragiannakis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nikoskaragiannakis/subscriptions","organizations_url":"https://api.github.com/users/nikoskaragiannakis/orgs","repos_url":"https://api.github.com/users/nikoskaragiannakis/repos","events_url":"https://api.github.com/users/nikoskaragiannakis/events{/privacy}","received_events_url":"https://api.github.com/users/nikoskaragiannakis/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-11-13T16:36:41Z","updated_at":"2019-11-13T23:36:24Z","closed_at":"2019-11-13T23:36:24Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I just found, accidentally, that this\r\n```python\r\n@pytest.mark.parametrize('request, expected', [(1, 1)])\r\ndef test_foo(request, expected):\r\n    assert request == expected\r\n```\r\nwould raise an error\r\n```\r\n...\r\n    def get_direct_param_fixture_func(request):\r\n>       return request.param\r\nE       AttributeError: 'int' object has no attribute 'param'\r\n```\r\n\r\nWouldn't it be helpful if there was a helpful exception raised here https://github.com/pytest-dev/pytest/blob/master/src/_pytest/fixtures.py#L881-L882?\r\n\r\nFor example, if \r\n```python\r\n            if argname != \"request\":\r\n                fixturedef.addfinalizer(functools.partial(self.finish, request=request))\r\n            else:\r\n                raise ValueError('`request` cannot be use as a parametrization name')\r\n```\r\n(or a better message) in the case of the initial example gives\r\n```\r\nself = <FixtureDef name='request' scope='function' baseid=''>\r\nrequest = <SubRequest 'request' for <Function 'test_foo[1-1]'>>\r\n\r\n    def execute(self, request):\r\n        # get required arguments and register our own finish()\r\n        # with their finalization\r\n        for argname in self.argnames:\r\n            fixturedef = request._get_active_fixturedef(argname)\r\n            if argname != \"request\":\r\n                fixturedef.addfinalizer(functools.partial(self.finish, request=request))\r\n            else:\r\n>               raise ValueError('`request` cannot be use as a parametrization name')\r\nE               ValueError: `request` cannot be use as a parametrization name\r\n```\r\n\r\nThe pytest version i'm using is 3.10.0","closed_by":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/6183/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/6183/timeline","performed_via_github_app":null,"state_reason":"completed"}