{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/12383","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12383/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12383/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12383/events","html_url":"https://github.com/pytest-dev/pytest/issues/12383","id":2320396312,"node_id":"I_kwDOAjwLdc6KTnAY","number":12383,"title":"`pytest_ignore_collect` documentation is misleading","user":{"login":"mgorny","id":110765,"node_id":"MDQ6VXNlcjExMDc2NQ==","avatar_url":"https://avatars.githubusercontent.com/u/110765?v=4","gravatar_id":"","url":"https://api.github.com/users/mgorny","html_url":"https://github.com/mgorny","followers_url":"https://api.github.com/users/mgorny/followers","following_url":"https://api.github.com/users/mgorny/following{/other_user}","gists_url":"https://api.github.com/users/mgorny/gists{/gist_id}","starred_url":"https://api.github.com/users/mgorny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mgorny/subscriptions","organizations_url":"https://api.github.com/users/mgorny/orgs","repos_url":"https://api.github.com/users/mgorny/repos","events_url":"https://api.github.com/users/mgorny/events{/privacy}","received_events_url":"https://api.github.com/users/mgorny/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2024-05-28T08:00:47Z","updated_at":"2024-05-28T18:50:56Z","closed_at":"2024-05-28T16:47:01Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I'm reporting this as a bug because I've hit this multiple times in the wild in a variety of packages implementing `pytest_ignore_collect` in `conftest.py`.\r\n\r\nThe documentation for `pytest_ignore_collect` states:\r\n\r\n> Return True to prevent considering this path for collection.\r\n>\r\n> This hook is consulted for all files and directories prior to calling more specific hooks.\r\n>\r\n> Stops at first non-None result, see [firstresult: stop at first non-None result](https://pytest.org/en/latest/how-to/writing_hook_functions.html#firstresult).\r\n(https://pytest.org/en/latest/reference/reference.html#std-hook-pytest_ignore_collect)\r\n\r\nWhile this isn't incorrect, it's misleading. A lot of implementations I've seen assume they're supposed to return `False` for paths that are not to be ignored. In fact, I didn't realize that returning `None` was the right thing to do, unless I've found this bit in the changelog:\r\n\r\n> If after updating to this version you see that your norecursedirs setting is not being respected, it means that a conftest or a plugin you use has a bad pytest_ignore_collect implementation. Most likely, your hook returns False for paths it does not want to ignore, which ends the processing and doesn’t allow other plugins, including pytest itself, to ignore the path. The fix is to return None instead of False for paths your hook doesn’t want to ignore.\r\n(https://pytest.org/en/latest/changelog.html#id141)\r\n\r\nCould you please improve the documentation for `pytest_ignore_collect` to make it clear that normally `True` or `None` should be returned? This is especially problematic since returning `False` makes `--ignore` silently ignored.","closed_by":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/12383/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12383/timeline","performed_via_github_app":null,"state_reason":"completed"}