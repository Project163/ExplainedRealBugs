[{"id":13453914305,"node_id":"MEE_lADOAjwLdc6PEyA0zwAAAAMh6nDB","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/13453914305","actor":{"login":"criemen","id":70492,"node_id":"MDQ6VXNlcjcwNDky","avatar_url":"https://avatars.githubusercontent.com/u/70492?v=4","gravatar_id":"","url":"https://api.github.com/users/criemen","html_url":"https://github.com/criemen","followers_url":"https://api.github.com/users/criemen/followers","following_url":"https://api.github.com/users/criemen/following{/other_user}","gists_url":"https://api.github.com/users/criemen/gists{/gist_id}","starred_url":"https://api.github.com/users/criemen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/criemen/subscriptions","organizations_url":"https://api.github.com/users/criemen/orgs","repos_url":"https://api.github.com/users/criemen/repos","events_url":"https://api.github.com/users/criemen/events{/privacy}","received_events_url":"https://api.github.com/users/criemen/received_events","type":"User","user_view_type":"public","site_admin":true},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-07-10T10:41:45Z","performed_via_github_app":null},{"id":13453914322,"node_id":"SE_lADOAjwLdc6PEyA0zwAAAAMh6nDS","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/13453914322","actor":{"login":"criemen","id":70492,"node_id":"MDQ6VXNlcjcwNDky","avatar_url":"https://avatars.githubusercontent.com/u/70492?v=4","gravatar_id":"","url":"https://api.github.com/users/criemen","html_url":"https://github.com/criemen","followers_url":"https://api.github.com/users/criemen/followers","following_url":"https://api.github.com/users/criemen/following{/other_user}","gists_url":"https://api.github.com/users/criemen/gists{/gist_id}","starred_url":"https://api.github.com/users/criemen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/criemen/subscriptions","organizations_url":"https://api.github.com/users/criemen/orgs","repos_url":"https://api.github.com/users/criemen/repos","events_url":"https://api.github.com/users/criemen/events{/privacy}","received_events_url":"https://api.github.com/users/criemen/received_events","type":"User","user_view_type":"public","site_admin":true},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-07-10T10:41:45Z","performed_via_github_app":null},{"id":13591117461,"node_id":"LE_lADOAjwLdc6PEyA0zwAAAAMqF_6V","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/13591117461","actor":{"login":"Zac-HD","id":12229877,"node_id":"MDQ6VXNlcjEyMjI5ODc3","avatar_url":"https://avatars.githubusercontent.com/u/12229877?v=4","gravatar_id":"","url":"https://api.github.com/users/Zac-HD","html_url":"https://github.com/Zac-HD","followers_url":"https://api.github.com/users/Zac-HD/followers","following_url":"https://api.github.com/users/Zac-HD/following{/other_user}","gists_url":"https://api.github.com/users/Zac-HD/gists{/gist_id}","starred_url":"https://api.github.com/users/Zac-HD/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zac-HD/subscriptions","organizations_url":"https://api.github.com/users/Zac-HD/orgs","repos_url":"https://api.github.com/users/Zac-HD/repos","events_url":"https://api.github.com/users/Zac-HD/events{/privacy}","received_events_url":"https://api.github.com/users/Zac-HD/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-07-21T03:52:16Z","label":{"name":"topic: collection","color":"006b75"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/2241450157","html_url":"https://github.com/pytest-dev/pytest/issues/12592#issuecomment-2241450157","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12592","id":2241450157,"node_id":"IC_kwDOAjwLdc6FmdCt","user":{"login":"Zac-HD","id":12229877,"node_id":"MDQ6VXNlcjEyMjI5ODc3","avatar_url":"https://avatars.githubusercontent.com/u/12229877?v=4","gravatar_id":"","url":"https://api.github.com/users/Zac-HD","html_url":"https://github.com/Zac-HD","followers_url":"https://api.github.com/users/Zac-HD/followers","following_url":"https://api.github.com/users/Zac-HD/following{/other_user}","gists_url":"https://api.github.com/users/Zac-HD/gists{/gist_id}","starred_url":"https://api.github.com/users/Zac-HD/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zac-HD/subscriptions","organizations_url":"https://api.github.com/users/Zac-HD/orgs","repos_url":"https://api.github.com/users/Zac-HD/repos","events_url":"https://api.github.com/users/Zac-HD/events{/privacy}","received_events_url":"https://api.github.com/users/Zac-HD/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-21T03:53:24Z","updated_at":"2024-07-21T03:53:24Z","body":"Feels like this might be an upstream issue; we should try to get a reproducer using stdlib code only.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/2241450157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Zac-HD","id":12229877,"node_id":"MDQ6VXNlcjEyMjI5ODc3","avatar_url":"https://avatars.githubusercontent.com/u/12229877?v=4","gravatar_id":"","url":"https://api.github.com/users/Zac-HD","html_url":"https://github.com/Zac-HD","followers_url":"https://api.github.com/users/Zac-HD/followers","following_url":"https://api.github.com/users/Zac-HD/following{/other_user}","gists_url":"https://api.github.com/users/Zac-HD/gists{/gist_id}","starred_url":"https://api.github.com/users/Zac-HD/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zac-HD/subscriptions","organizations_url":"https://api.github.com/users/Zac-HD/orgs","repos_url":"https://api.github.com/users/Zac-HD/repos","events_url":"https://api.github.com/users/Zac-HD/events{/privacy}","received_events_url":"https://api.github.com/users/Zac-HD/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":14075666322,"node_id":"REFE_lADOAjwLdc6PEyA0zwAAAANG-Z-S","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/14075666322","actor":{"login":"dongfangtianyu","id":7629022,"node_id":"MDQ6VXNlcjc2MjkwMjI=","avatar_url":"https://avatars.githubusercontent.com/u/7629022?v=4","gravatar_id":"","url":"https://api.github.com/users/dongfangtianyu","html_url":"https://github.com/dongfangtianyu","followers_url":"https://api.github.com/users/dongfangtianyu/followers","following_url":"https://api.github.com/users/dongfangtianyu/following{/other_user}","gists_url":"https://api.github.com/users/dongfangtianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/dongfangtianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongfangtianyu/subscriptions","organizations_url":"https://api.github.com/users/dongfangtianyu/orgs","repos_url":"https://api.github.com/users/dongfangtianyu/repos","events_url":"https://api.github.com/users/dongfangtianyu/events{/privacy}","received_events_url":"https://api.github.com/users/dongfangtianyu/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"f9fef2756f04785dec629351bf878daa95122f70","commit_url":"https://api.github.com/repos/dongfangtianyu/pytest/commits/f9fef2756f04785dec629351bf878daa95122f70","created_at":"2024-08-30T05:56:23Z","performed_via_github_app":null},{"id":14076076157,"node_id":"REFE_lADOAjwLdc6PEyA0zwAAAANG_-B9","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/14076076157","actor":{"login":"dongfangtianyu","id":7629022,"node_id":"MDQ6VXNlcjc2MjkwMjI=","avatar_url":"https://avatars.githubusercontent.com/u/7629022?v=4","gravatar_id":"","url":"https://api.github.com/users/dongfangtianyu","html_url":"https://github.com/dongfangtianyu","followers_url":"https://api.github.com/users/dongfangtianyu/followers","following_url":"https://api.github.com/users/dongfangtianyu/following{/other_user}","gists_url":"https://api.github.com/users/dongfangtianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/dongfangtianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongfangtianyu/subscriptions","organizations_url":"https://api.github.com/users/dongfangtianyu/orgs","repos_url":"https://api.github.com/users/dongfangtianyu/repos","events_url":"https://api.github.com/users/dongfangtianyu/events{/privacy}","received_events_url":"https://api.github.com/users/dongfangtianyu/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"098e5a61c058ceb16393aa55bf877acc84a28be7","commit_url":"https://api.github.com/repos/dongfangtianyu/pytest/commits/098e5a61c058ceb16393aa55bf877acc84a28be7","created_at":"2024-08-30T06:40:59Z","performed_via_github_app":null},{"actor":{"login":"dongfangtianyu","id":7629022,"node_id":"MDQ6VXNlcjc2MjkwMjI=","avatar_url":"https://avatars.githubusercontent.com/u/7629022?v=4","gravatar_id":"","url":"https://api.github.com/users/dongfangtianyu","html_url":"https://github.com/dongfangtianyu","followers_url":"https://api.github.com/users/dongfangtianyu/followers","following_url":"https://api.github.com/users/dongfangtianyu/following{/other_user}","gists_url":"https://api.github.com/users/dongfangtianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/dongfangtianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongfangtianyu/subscriptions","organizations_url":"https://api.github.com/users/dongfangtianyu/orgs","repos_url":"https://api.github.com/users/dongfangtianyu/repos","events_url":"https://api.github.com/users/dongfangtianyu/events{/privacy}","received_events_url":"https://api.github.com/users/dongfangtianyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-30T07:27:06Z","updated_at":"2024-08-30T07:27:06Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/12752","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12752/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12752/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12752/events","html_url":"https://github.com/pytest-dev/pytest/pull/12752","id":2496455296,"node_id":"PR_kwDOAjwLdc557vWi","number":12752,"title":"Fixed the issue of  causes ``KeyError`` when using the parameter ``--import-mode=importlib`` in pytest>=8.2 . (#12592)","user":{"login":"dongfangtianyu","id":7629022,"node_id":"MDQ6VXNlcjc2MjkwMjI=","avatar_url":"https://avatars.githubusercontent.com/u/7629022?v=4","gravatar_id":"","url":"https://api.github.com/users/dongfangtianyu","html_url":"https://github.com/dongfangtianyu","followers_url":"https://api.github.com/users/dongfangtianyu/followers","following_url":"https://api.github.com/users/dongfangtianyu/following{/other_user}","gists_url":"https://api.github.com/users/dongfangtianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/dongfangtianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongfangtianyu/subscriptions","organizations_url":"https://api.github.com/users/dongfangtianyu/orgs","repos_url":"https://api.github.com/users/dongfangtianyu/repos","events_url":"https://api.github.com/users/dongfangtianyu/events{/privacy}","received_events_url":"https://api.github.com/users/dongfangtianyu/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":7102695956,"node_id":"LA_kwDOAjwLdc8AAAABp1qKFA","url":"https://api.github.com/repos/pytest-dev/pytest/labels/bot:chronographer:provided","name":"bot:chronographer:provided","color":"ededed","default":false,"description":"(automation) changelog entry is part of PR"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2024-08-30T07:27:06Z","updated_at":"2024-12-13T07:13:04Z","closed_at":"2024-09-26T01:08:42Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":37489525,"node_id":"MDEwOlJlcG9zaXRvcnkzNzQ4OTUyNQ==","name":"pytest","full_name":"pytest-dev/pytest","private":false,"owner":{"login":"pytest-dev","id":8897583,"node_id":"MDEyOk9yZ2FuaXphdGlvbjg4OTc1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8897583?v=4","gravatar_id":"","url":"https://api.github.com/users/pytest-dev","html_url":"https://github.com/pytest-dev","followers_url":"https://api.github.com/users/pytest-dev/followers","following_url":"https://api.github.com/users/pytest-dev/following{/other_user}","gists_url":"https://api.github.com/users/pytest-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/pytest-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pytest-dev/subscriptions","organizations_url":"https://api.github.com/users/pytest-dev/orgs","repos_url":"https://api.github.com/users/pytest-dev/repos","events_url":"https://api.github.com/users/pytest-dev/events{/privacy}","received_events_url":"https://api.github.com/users/pytest-dev/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/pytest-dev/pytest","description":"The pytest framework makes it easy to write small tests, yet scales to support complex functional testing","fork":false,"url":"https://api.github.com/repos/pytest-dev/pytest","forks_url":"https://api.github.com/repos/pytest-dev/pytest/forks","keys_url":"https://api.github.com/repos/pytest-dev/pytest/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pytest-dev/pytest/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pytest-dev/pytest/teams","hooks_url":"https://api.github.com/repos/pytest-dev/pytest/hooks","issue_events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/events{/number}","events_url":"https://api.github.com/repos/pytest-dev/pytest/events","assignees_url":"https://api.github.com/repos/pytest-dev/pytest/assignees{/user}","branches_url":"https://api.github.com/repos/pytest-dev/pytest/branches{/branch}","tags_url":"https://api.github.com/repos/pytest-dev/pytest/tags","blobs_url":"https://api.github.com/repos/pytest-dev/pytest/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pytest-dev/pytest/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pytest-dev/pytest/git/refs{/sha}","trees_url":"https://api.github.com/repos/pytest-dev/pytest/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pytest-dev/pytest/statuses/{sha}","languages_url":"https://api.github.com/repos/pytest-dev/pytest/languages","stargazers_url":"https://api.github.com/repos/pytest-dev/pytest/stargazers","contributors_url":"https://api.github.com/repos/pytest-dev/pytest/contributors","subscribers_url":"https://api.github.com/repos/pytest-dev/pytest/subscribers","subscription_url":"https://api.github.com/repos/pytest-dev/pytest/subscription","commits_url":"https://api.github.com/repos/pytest-dev/pytest/commits{/sha}","git_commits_url":"https://api.github.com/repos/pytest-dev/pytest/git/commits{/sha}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/comments{/number}","issue_comment_url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments{/number}","contents_url":"https://api.github.com/repos/pytest-dev/pytest/contents/{+path}","compare_url":"https://api.github.com/repos/pytest-dev/pytest/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pytest-dev/pytest/merges","archive_url":"https://api.github.com/repos/pytest-dev/pytest/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pytest-dev/pytest/downloads","issues_url":"https://api.github.com/repos/pytest-dev/pytest/issues{/number}","pulls_url":"https://api.github.com/repos/pytest-dev/pytest/pulls{/number}","milestones_url":"https://api.github.com/repos/pytest-dev/pytest/milestones{/number}","notifications_url":"https://api.github.com/repos/pytest-dev/pytest/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pytest-dev/pytest/labels{/name}","releases_url":"https://api.github.com/repos/pytest-dev/pytest/releases{/id}","deployments_url":"https://api.github.com/repos/pytest-dev/pytest/deployments","created_at":"2015-06-15T20:28:27Z","updated_at":"2025-11-09T16:32:44Z","pushed_at":"2025-11-09T09:33:29Z","git_url":"git://github.com/pytest-dev/pytest.git","ssh_url":"git@github.com:pytest-dev/pytest.git","clone_url":"https://github.com/pytest-dev/pytest.git","svn_url":"https://github.com/pytest-dev/pytest","homepage":"https://pytest.org","size":37842,"stargazers_count":13254,"watchers_count":13254,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":2933,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":953,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","python","test","testing","unit-testing"],"visibility":"public","forks":2933,"open_issues":953,"watchers":13254,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/pytest-dev/pytest/pulls/12752","html_url":"https://github.com/pytest-dev/pytest/pull/12752","diff_url":"https://github.com/pytest-dev/pytest/pull/12752.diff","patch_url":"https://github.com/pytest-dev/pytest/pull/12752.patch","merged_at":"2024-09-26T01:08:42Z"},"body":"closes #12592\r\n\r\n\r\n\r\n**Reproduction Steps:**\r\n\r\n1. Create a **namespace package** in a **non-root directory** and include a test file.\r\n\r\n2. Create a **directory with the same name** in that location.\r\n\r\n   \r\n\r\n**Directory Structure:**\r\n\r\n```\r\n>tree ./a\r\na\r\n└── b\r\n    └── c\r\n        ├── c\r\n        └── test_demo.py\r\n```\r\n\r\n\r\n**Execution Results：**\r\n```\r\n>pytest --import-mode=importlib\r\n\r\n==================== test session starts ===================\r\nplatform win32 -- Python 3.12.0, pytest-8.3.2, pluggy-1.5.0\r\nrootdir: D:\\app\r\nplugins: allure-pytest-2.13.5\r\ncollected 0 items / 1 error\r\n\r\n========================== ERRORS ==========================\r\n____________ ERROR collecting a/b/c/test_demo.py ____________\r\n<frozen importlib._bootstrap_external>:1533: in find_spec\r\n    ???\r\n<frozen importlib._bootstrap_external>:1334: in __init__\r\n    ???\r\n<frozen importlib._bootstrap_external>:1350: in _get_parent_path\r\n    ???\r\nE   KeyError: 'a.b'\r\n\r\n=================== short test summary info =================\r\nERROR a/b/c/test_demo.py - KeyError: 'a.b'\r\n!!!!!!!!!! Interrupted: 1 error during collection !!!!!!!!!!!\r\n========================= 1 error in 0.10s ===================\r\n```\r\n\r\n\r\n\r\nThrough tracing, it was discovered that the error occurs during the second call to `pathlib._import_module_using_spec`.\r\n\r\n```\r\n_import_module_using_spec  # Import module\r\n -> _import_module_using_spec # Import parent module\r\n   -> PathFinder.find_spec\r\n     -> _NamespacePath.__init__\r\n       -> NamespacePath._get_parent_path\r\n         -> sys.modules[parent_module_name]  # Retrieve ancestor module from sys.modules\r\n           -> KeyError\r\n```\r\n\r\n---\r\n\r\nThis is the entire call process when the exception occurs.\r\n\r\nIn simple terms, when executing `PathFinder.find_spec('a.b.c', ['/app/a/b/c'])`:\r\n\r\n1. Python assumes that we are trying to import a module named `c` (the tail module).\r\n\r\n2. At this point, there happens to be a directory `c` in `/app/a/b/c`, which is then treated as a namespace.\r\n\r\n3. According to convention, its parent module `a.b` should already exist in `sys.modules`, and it is accessed directly using the item method.\r\n\r\n4. However, when pytest uses the `importlib` mode, it doesn't follow this convention, leading to a `KeyError`.\r\n\r\n\r\n\r\n\r\nSo, **from the observable behavior, it seems to be an upstream issue**.\r\n\r\n**However, from a deeper perspective, there might also be a problem with pytest's handling of parent module imports**.\r\n\r\nI noticed that `_import_module_using_spec` attempts to follow the convention of importing the parent module, but the error occurs precisely during this process:  \r\nhttps://github.com/pytest-dev/pytest/blob/main/src/_pytest/pathlib.py#L634-L656\r\n\r\n\r\nI searched for the usage of 'importlib', and the example provided in the Python documentation can import of any module or namespace package in this case:  \r\nhttps://docs.python.org/3/library/importlib.html#approximating-importlib-import-module.\r\n\r\n\r\nUnlike `_import_module_using_spec`, the example function in the documentation **first ensures that the necessary parent modules are present in `sys.modules`, and then imports the target module (or target namespace package)**.\r\n\r\n---\r\n\r\nBased on this, I attempted to modify the execution process in `_import_module_using_spec`, moving the **import of the parent module** to **after `insert_missing_modules()`** to avoid a `KeyError` due to `sys.modules` not being ready.\r\n\r\nFrom the test results, it works quite well, but I'm not sure if there are potential flaws or better solutions (in fact, I've tried and discarded many solutions).\r\n\r\nWelcome any further suggestions.\r\n\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/12752/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12752/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":14091354989,"node_id":"REFE_lADOAjwLdc6PEyA0zwAAAANH6QNt","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/14091354989","actor":{"login":"dongfangtianyu","id":7629022,"node_id":"MDQ6VXNlcjc2MjkwMjI=","avatar_url":"https://avatars.githubusercontent.com/u/7629022?v=4","gravatar_id":"","url":"https://api.github.com/users/dongfangtianyu","html_url":"https://github.com/dongfangtianyu","followers_url":"https://api.github.com/users/dongfangtianyu/followers","following_url":"https://api.github.com/users/dongfangtianyu/following{/other_user}","gists_url":"https://api.github.com/users/dongfangtianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/dongfangtianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongfangtianyu/subscriptions","organizations_url":"https://api.github.com/users/dongfangtianyu/orgs","repos_url":"https://api.github.com/users/dongfangtianyu/repos","events_url":"https://api.github.com/users/dongfangtianyu/events{/privacy}","received_events_url":"https://api.github.com/users/dongfangtianyu/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"f741433d3d011e0ef2ceea5bf622da8bf5e71e60","commit_url":"https://api.github.com/repos/dongfangtianyu/pytest/commits/f741433d3d011e0ef2ceea5bf622da8bf5e71e60","created_at":"2024-08-31T09:32:24Z","performed_via_github_app":null},{"id":14109763410,"node_id":"REFE_lADOAjwLdc6PEyA0zwAAAANJAedS","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/14109763410","actor":{"login":"dongfangtianyu","id":7629022,"node_id":"MDQ6VXNlcjc2MjkwMjI=","avatar_url":"https://avatars.githubusercontent.com/u/7629022?v=4","gravatar_id":"","url":"https://api.github.com/users/dongfangtianyu","html_url":"https://github.com/dongfangtianyu","followers_url":"https://api.github.com/users/dongfangtianyu/followers","following_url":"https://api.github.com/users/dongfangtianyu/following{/other_user}","gists_url":"https://api.github.com/users/dongfangtianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/dongfangtianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongfangtianyu/subscriptions","organizations_url":"https://api.github.com/users/dongfangtianyu/orgs","repos_url":"https://api.github.com/users/dongfangtianyu/repos","events_url":"https://api.github.com/users/dongfangtianyu/events{/privacy}","received_events_url":"https://api.github.com/users/dongfangtianyu/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"7108bb91723a2d3e4c5f0e62fbf46afc030450de","commit_url":"https://api.github.com/repos/dongfangtianyu/pytest/commits/7108bb91723a2d3e4c5f0e62fbf46afc030450de","created_at":"2024-09-03T06:20:03Z","performed_via_github_app":null},{"id":14407691924,"node_id":"CE_lADOAjwLdc6PEyA0zwAAAANaw-6U","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/14407691924","actor":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2024-09-26T01:08:44Z","state_reason":null,"performed_via_github_app":null},{"id":14407691928,"node_id":"CE_lADOAjwLdc6PEyA0zwAAAANaw-6Y","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/14407691928","actor":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"6486c3f3a858a0c8043f5c3f7c24297b82a0abe4","commit_url":"https://api.github.com/repos/pytest-dev/pytest/commits/6486c3f3a858a0c8043f5c3f7c24297b82a0abe4","created_at":"2024-09-26T01:08:44Z","state_reason":null,"performed_via_github_app":null},{"id":14407694081,"node_id":"REFE_lADOAjwLdc6PEyA0zwAAAANaw_cB","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/14407694081","actor":{"login":"patchback[bot]","id":45432694,"node_id":"MDM6Qm90NDU0MzI2OTQ=","avatar_url":"https://avatars.githubusercontent.com/in/21488?v=4","gravatar_id":"","url":"https://api.github.com/users/patchback%5Bbot%5D","html_url":"https://github.com/apps/patchback","followers_url":"https://api.github.com/users/patchback%5Bbot%5D/followers","following_url":"https://api.github.com/users/patchback%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/patchback%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/patchback%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/patchback%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/patchback%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/patchback%5Bbot%5D/repos","events_url":"https://api.github.com/users/patchback%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/patchback%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"6b8827d7a39fac0f850e377c7e3c17f368c5b65a","commit_url":"https://api.github.com/repos/pytest-dev/pytest/commits/6b8827d7a39fac0f850e377c7e3c17f368c5b65a","created_at":"2024-09-26T01:09:08Z","performed_via_github_app":null},{"actor":{"login":"patchback[bot]","id":45432694,"node_id":"MDM6Qm90NDU0MzI2OTQ=","avatar_url":"https://avatars.githubusercontent.com/in/21488?v=4","gravatar_id":"","url":"https://api.github.com/users/patchback%5Bbot%5D","html_url":"https://github.com/apps/patchback","followers_url":"https://api.github.com/users/patchback%5Bbot%5D/followers","following_url":"https://api.github.com/users/patchback%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/patchback%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/patchback%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/patchback%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/patchback%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/patchback%5Bbot%5D/repos","events_url":"https://api.github.com/users/patchback%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/patchback%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2024-09-26T01:09:09Z","updated_at":"2024-09-26T01:09:09Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/12843","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12843/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12843/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12843/events","html_url":"https://github.com/pytest-dev/pytest/pull/12843","id":2549261657,"node_id":"PR_kwDOAjwLdc58uch2","number":12843,"title":"[PR #12752/6486c3f3 backport][8.3.x] Fixed the issue of  causes ``KeyError`` when using the parameter ``--import-mode=importlib`` in pytest>=8.2 . (#12592)","user":{"login":"patchback[bot]","id":45432694,"node_id":"MDM6Qm90NDU0MzI2OTQ=","avatar_url":"https://avatars.githubusercontent.com/in/21488?v=4","gravatar_id":"","url":"https://api.github.com/users/patchback%5Bbot%5D","html_url":"https://github.com/apps/patchback","followers_url":"https://api.github.com/users/patchback%5Bbot%5D/followers","following_url":"https://api.github.com/users/patchback%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/patchback%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/patchback%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/patchback%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/patchback%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/patchback%5Bbot%5D/repos","events_url":"https://api.github.com/users/patchback%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/patchback%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2024-09-26T01:09:08Z","updated_at":"2024-09-26T01:26:02Z","closed_at":"2024-09-26T01:26:02Z","author_association":"NONE","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":37489525,"node_id":"MDEwOlJlcG9zaXRvcnkzNzQ4OTUyNQ==","name":"pytest","full_name":"pytest-dev/pytest","private":false,"owner":{"login":"pytest-dev","id":8897583,"node_id":"MDEyOk9yZ2FuaXphdGlvbjg4OTc1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8897583?v=4","gravatar_id":"","url":"https://api.github.com/users/pytest-dev","html_url":"https://github.com/pytest-dev","followers_url":"https://api.github.com/users/pytest-dev/followers","following_url":"https://api.github.com/users/pytest-dev/following{/other_user}","gists_url":"https://api.github.com/users/pytest-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/pytest-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pytest-dev/subscriptions","organizations_url":"https://api.github.com/users/pytest-dev/orgs","repos_url":"https://api.github.com/users/pytest-dev/repos","events_url":"https://api.github.com/users/pytest-dev/events{/privacy}","received_events_url":"https://api.github.com/users/pytest-dev/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/pytest-dev/pytest","description":"The pytest framework makes it easy to write small tests, yet scales to support complex functional testing","fork":false,"url":"https://api.github.com/repos/pytest-dev/pytest","forks_url":"https://api.github.com/repos/pytest-dev/pytest/forks","keys_url":"https://api.github.com/repos/pytest-dev/pytest/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pytest-dev/pytest/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pytest-dev/pytest/teams","hooks_url":"https://api.github.com/repos/pytest-dev/pytest/hooks","issue_events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/events{/number}","events_url":"https://api.github.com/repos/pytest-dev/pytest/events","assignees_url":"https://api.github.com/repos/pytest-dev/pytest/assignees{/user}","branches_url":"https://api.github.com/repos/pytest-dev/pytest/branches{/branch}","tags_url":"https://api.github.com/repos/pytest-dev/pytest/tags","blobs_url":"https://api.github.com/repos/pytest-dev/pytest/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pytest-dev/pytest/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pytest-dev/pytest/git/refs{/sha}","trees_url":"https://api.github.com/repos/pytest-dev/pytest/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pytest-dev/pytest/statuses/{sha}","languages_url":"https://api.github.com/repos/pytest-dev/pytest/languages","stargazers_url":"https://api.github.com/repos/pytest-dev/pytest/stargazers","contributors_url":"https://api.github.com/repos/pytest-dev/pytest/contributors","subscribers_url":"https://api.github.com/repos/pytest-dev/pytest/subscribers","subscription_url":"https://api.github.com/repos/pytest-dev/pytest/subscription","commits_url":"https://api.github.com/repos/pytest-dev/pytest/commits{/sha}","git_commits_url":"https://api.github.com/repos/pytest-dev/pytest/git/commits{/sha}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/comments{/number}","issue_comment_url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments{/number}","contents_url":"https://api.github.com/repos/pytest-dev/pytest/contents/{+path}","compare_url":"https://api.github.com/repos/pytest-dev/pytest/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pytest-dev/pytest/merges","archive_url":"https://api.github.com/repos/pytest-dev/pytest/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pytest-dev/pytest/downloads","issues_url":"https://api.github.com/repos/pytest-dev/pytest/issues{/number}","pulls_url":"https://api.github.com/repos/pytest-dev/pytest/pulls{/number}","milestones_url":"https://api.github.com/repos/pytest-dev/pytest/milestones{/number}","notifications_url":"https://api.github.com/repos/pytest-dev/pytest/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pytest-dev/pytest/labels{/name}","releases_url":"https://api.github.com/repos/pytest-dev/pytest/releases{/id}","deployments_url":"https://api.github.com/repos/pytest-dev/pytest/deployments","created_at":"2015-06-15T20:28:27Z","updated_at":"2025-11-09T16:32:44Z","pushed_at":"2025-11-09T09:33:29Z","git_url":"git://github.com/pytest-dev/pytest.git","ssh_url":"git@github.com:pytest-dev/pytest.git","clone_url":"https://github.com/pytest-dev/pytest.git","svn_url":"https://github.com/pytest-dev/pytest","homepage":"https://pytest.org","size":37842,"stargazers_count":13254,"watchers_count":13254,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":2933,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":953,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","python","test","testing","unit-testing"],"visibility":"public","forks":2933,"open_issues":953,"watchers":13254,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/pytest-dev/pytest/pulls/12843","html_url":"https://github.com/pytest-dev/pytest/pull/12843","diff_url":"https://github.com/pytest-dev/pytest/pull/12843.diff","patch_url":"https://github.com/pytest-dev/pytest/pull/12843.patch","merged_at":"2024-09-26T01:26:02Z"},"body":"**This is a backport of PR #12752 as merged into main (6486c3f3a858a0c8043f5c3f7c24297b82a0abe4).**\n\ncloses #12592\r\n\r\n\r\n\r\n**Reproduction Steps:**\r\n\r\n1. Create a **namespace package** in a **non-root directory** and include a test file.\r\n\r\n2. Create a **directory with the same name** in that location.\r\n\r\n   \r\n\r\n**Directory Structure:**\r\n\r\n```\r\n>tree ./a\r\na\r\n└── b\r\n    └── c\r\n        ├── c\r\n        └── test_demo.py\r\n```\r\n\r\n\r\n**Execution Results：**\r\n```\r\n>pytest --import-mode=importlib\r\n\r\n==================== test session starts ===================\r\nplatform win32 -- Python 3.12.0, pytest-8.3.2, pluggy-1.5.0\r\nrootdir: D:\\app\r\nplugins: allure-pytest-2.13.5\r\ncollected 0 items / 1 error\r\n\r\n========================== ERRORS ==========================\r\n____________ ERROR collecting a/b/c/test_demo.py ____________\r\n<frozen importlib._bootstrap_external>:1533: in find_spec\r\n    ???\r\n<frozen importlib._bootstrap_external>:1334: in __init__\r\n    ???\r\n<frozen importlib._bootstrap_external>:1350: in _get_parent_path\r\n    ???\r\nE   KeyError: 'a.b'\r\n\r\n=================== short test summary info =================\r\nERROR a/b/c/test_demo.py - KeyError: 'a.b'\r\n!!!!!!!!!! Interrupted: 1 error during collection !!!!!!!!!!!\r\n========================= 1 error in 0.10s ===================\r\n```\r\n\r\n\r\n\r\nThrough tracing, it was discovered that the error occurs during the second call to `pathlib._import_module_using_spec`.\r\n\r\n```\r\n_import_module_using_spec  # Import module\r\n -> _import_module_using_spec # Import parent module\r\n   -> PathFinder.find_spec\r\n     -> _NamespacePath.__init__\r\n       -> NamespacePath._get_parent_path\r\n         -> sys.modules[parent_module_name]  # Retrieve ancestor module from sys.modules\r\n           -> KeyError\r\n```\r\n\r\n---\r\n\r\nThis is the entire call process when the exception occurs.\r\n\r\nIn simple terms, when executing `PathFinder.find_spec('a.b.c', ['/app/a/b/c'])`:\r\n\r\n1. Python assumes that we are trying to import a module named `c` (the tail module).\r\n\r\n2. At this point, there happens to be a directory `c` in `/app/a/b/c`, which is then treated as a namespace.\r\n\r\n3. According to convention, its parent module `a.b` should already exist in `sys.modules`, and it is accessed directly using the item method.\r\n\r\n4. However, when pytest uses the `importlib` mode, it doesn't follow this convention, leading to a `KeyError`.\r\n\r\n\r\n\r\n\r\nSo, **from the observable behavior, it seems to be an upstream issue**.\r\n\r\n**However, from a deeper perspective, there might also be a problem with pytest's handling of parent module imports**.\r\n\r\nI noticed that `_import_module_using_spec` attempts to follow the convention of importing the parent module, but the error occurs precisely during this process:  \r\nhttps://github.com/pytest-dev/pytest/blob/main/src/_pytest/pathlib.py#L634-L656\r\n\r\n\r\nI searched for the usage of 'importlib', and the example provided in the Python documentation can import of any module or namespace package in this case:  \r\nhttps://docs.python.org/3/library/importlib.html#approximating-importlib-import-module.\r\n\r\n\r\nUnlike `_import_module_using_spec`, the example function in the documentation **first ensures that the necessary parent modules are present in `sys.modules`, and then imports the target module (or target namespace package)**.\r\n\r\n---\r\n\r\nBased on this, I attempted to modify the execution process in `_import_module_using_spec`, moving the **import of the parent module** to **after `insert_missing_modules()`** to avoid a `KeyError` due to `sys.modules` not being ready.\r\n\r\nFrom the test results, it works quite well, but I'm not sure if there are potential flaws or better solutions (in fact, I've tried and discarded many solutions).\r\n\r\nWelcome any further suggestions.\r\n\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/12843/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12843/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":14407786354,"node_id":"REFE_lADOAjwLdc6PEyA0zwAAAANaxV9y","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/14407786354","actor":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"3d3ec5724c6f76bc07d0631ec8061f26f9ecac4c","commit_url":"https://api.github.com/repos/pytest-dev/pytest/commits/3d3ec5724c6f76bc07d0631ec8061f26f9ecac4c","created_at":"2024-09-26T01:26:03Z","performed_via_github_app":null},{"id":14409659006,"node_id":"REFE_lADOAjwLdc6PEyA0zwAAAANa4fJ-","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/14409659006","actor":{"login":"HelloBroBro","id":78026225,"node_id":"MDQ6VXNlcjc4MDI2MjI1","avatar_url":"https://avatars.githubusercontent.com/u/78026225?v=4","gravatar_id":"","url":"https://api.github.com/users/HelloBroBro","html_url":"https://github.com/HelloBroBro","followers_url":"https://api.github.com/users/HelloBroBro/followers","following_url":"https://api.github.com/users/HelloBroBro/following{/other_user}","gists_url":"https://api.github.com/users/HelloBroBro/gists{/gist_id}","starred_url":"https://api.github.com/users/HelloBroBro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HelloBroBro/subscriptions","organizations_url":"https://api.github.com/users/HelloBroBro/orgs","repos_url":"https://api.github.com/users/HelloBroBro/repos","events_url":"https://api.github.com/users/HelloBroBro/events{/privacy}","received_events_url":"https://api.github.com/users/HelloBroBro/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"6486c3f3a858a0c8043f5c3f7c24297b82a0abe4","commit_url":"https://api.github.com/repos/HelloBroBro/pytest/commits/6486c3f3a858a0c8043f5c3f7c24297b82a0abe4","created_at":"2024-09-26T05:01:18Z","performed_via_github_app":null},{"actor":{"login":"valeriupredoi","id":28983971,"node_id":"MDQ6VXNlcjI4OTgzOTcx","avatar_url":"https://avatars.githubusercontent.com/u/28983971?v=4","gravatar_id":"","url":"https://api.github.com/users/valeriupredoi","html_url":"https://github.com/valeriupredoi","followers_url":"https://api.github.com/users/valeriupredoi/followers","following_url":"https://api.github.com/users/valeriupredoi/following{/other_user}","gists_url":"https://api.github.com/users/valeriupredoi/gists{/gist_id}","starred_url":"https://api.github.com/users/valeriupredoi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/valeriupredoi/subscriptions","organizations_url":"https://api.github.com/users/valeriupredoi/orgs","repos_url":"https://api.github.com/users/valeriupredoi/repos","events_url":"https://api.github.com/users/valeriupredoi/events{/privacy}","received_events_url":"https://api.github.com/users/valeriupredoi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-02T16:12:02Z","updated_at":"2024-12-02T16:12:02Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/ESMValGroup/ESMValTool/issues/3834","repository_url":"https://api.github.com/repos/ESMValGroup/ESMValTool","labels_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/issues/3834/labels{/name}","comments_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/issues/3834/comments","events_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/issues/3834/events","html_url":"https://github.com/ESMValGroup/ESMValTool/pull/3834","id":2712479734,"node_id":"PR_kwDOBMaKjc6DxRpI","number":3834,"title":"Add init files in package-like diagnostic directories to comply with `pytest >=8.3.4`","user":{"login":"valeriupredoi","id":28983971,"node_id":"MDQ6VXNlcjI4OTgzOTcx","avatar_url":"https://avatars.githubusercontent.com/u/28983971?v=4","gravatar_id":"","url":"https://api.github.com/users/valeriupredoi","html_url":"https://github.com/valeriupredoi","followers_url":"https://api.github.com/users/valeriupredoi/followers","following_url":"https://api.github.com/users/valeriupredoi/following{/other_user}","gists_url":"https://api.github.com/users/valeriupredoi/gists{/gist_id}","starred_url":"https://api.github.com/users/valeriupredoi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/valeriupredoi/subscriptions","organizations_url":"https://api.github.com/users/valeriupredoi/orgs","repos_url":"https://api.github.com/users/valeriupredoi/repos","events_url":"https://api.github.com/users/valeriupredoi/events{/privacy}","received_events_url":"https://api.github.com/users/valeriupredoi/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2425372113,"node_id":"MDU6TGFiZWwyNDI1MzcyMTEz","url":"https://api.github.com/repos/ESMValGroup/ESMValTool/labels/testing","name":"testing","color":"f7b756","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2024-12-02T16:12:01Z","updated_at":"2024-12-02T16:59:09Z","closed_at":"2024-12-02T16:59:07Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":80120461,"node_id":"MDEwOlJlcG9zaXRvcnk4MDEyMDQ2MQ==","name":"ESMValTool","full_name":"ESMValGroup/ESMValTool","private":false,"owner":{"login":"ESMValGroup","id":24584460,"node_id":"MDEyOk9yZ2FuaXphdGlvbjI0NTg0NDYw","avatar_url":"https://avatars.githubusercontent.com/u/24584460?v=4","gravatar_id":"","url":"https://api.github.com/users/ESMValGroup","html_url":"https://github.com/ESMValGroup","followers_url":"https://api.github.com/users/ESMValGroup/followers","following_url":"https://api.github.com/users/ESMValGroup/following{/other_user}","gists_url":"https://api.github.com/users/ESMValGroup/gists{/gist_id}","starred_url":"https://api.github.com/users/ESMValGroup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ESMValGroup/subscriptions","organizations_url":"https://api.github.com/users/ESMValGroup/orgs","repos_url":"https://api.github.com/users/ESMValGroup/repos","events_url":"https://api.github.com/users/ESMValGroup/events{/privacy}","received_events_url":"https://api.github.com/users/ESMValGroup/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/ESMValGroup/ESMValTool","description":"ESMValTool: A community diagnostic and performance metrics tool for routine evaluation of Earth system models in CMIP ","fork":false,"url":"https://api.github.com/repos/ESMValGroup/ESMValTool","forks_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/forks","keys_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/teams","hooks_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/hooks","issue_events_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/issues/events{/number}","events_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/events","assignees_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/assignees{/user}","branches_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/branches{/branch}","tags_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/tags","blobs_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/git/refs{/sha}","trees_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/statuses/{sha}","languages_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/languages","stargazers_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/stargazers","contributors_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/contributors","subscribers_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/subscribers","subscription_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/subscription","commits_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/commits{/sha}","git_commits_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/git/commits{/sha}","comments_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/comments{/number}","issue_comment_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/issues/comments{/number}","contents_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/contents/{+path}","compare_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/merges","archive_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/downloads","issues_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/issues{/number}","pulls_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/pulls{/number}","milestones_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/milestones{/number}","notifications_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/labels{/name}","releases_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/releases{/id}","deployments_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/deployments","created_at":"2017-01-26T14:15:37Z","updated_at":"2025-11-05T18:46:00Z","pushed_at":"2025-11-07T14:57:38Z","git_url":"git://github.com/ESMValGroup/ESMValTool.git","ssh_url":"git@github.com:ESMValGroup/ESMValTool.git","clone_url":"https://github.com/ESMValGroup/ESMValTool.git","svn_url":"https://github.com/ESMValGroup/ESMValTool","homepage":"https://www.esmvaltool.org","size":244349,"stargazers_count":255,"watchers_count":255,"language":"NCL","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":142,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":213,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":142,"open_issues":213,"watchers":255,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/ESMValGroup/ESMValTool/pulls/3834","html_url":"https://github.com/ESMValGroup/ESMValTool/pull/3834","diff_url":"https://github.com/ESMValGroup/ESMValTool/pull/3834.diff","patch_url":"https://github.com/ESMValGroup/ESMValTool/pull/3834.patch","merged_at":"2024-12-02T16:59:07Z"},"body":"<!--\r\n    Thank you for contributing to our project!\r\n\r\n    Please do not delete this text completely, but read the text below and keep\r\n    items that seem relevant. If in doubt, just keep everything and add your\r\n    own text at the top, a reviewer will update the checklist for you.\r\n\r\n    While the checklist is intended to be filled in by the technical and scientific\r\n    reviewers, it is the responsibility of the author of the pull request to make\r\n    sure all items on it are properly implemented.\r\n-->\r\n\r\n## Description\r\n\r\n<!--\r\n    Please describe your changes here, especially focusing on why this pull request makes\r\n    ESMValTool better and what problem it solves.\r\n\r\n    Before you start, please read our contribution guidelines: https://docs.esmvaltool.org/en/latest/community/\r\n\r\n    Please fill in the GitHub issue that is closed by this pull request, e.g. Closes #1903\r\n-->\r\n\r\n[Nightly tests](https://github.com/ESMValGroup/ESMValTool/actions/runs/12110754511/job/33791985130) are failing because our environment moved to use the latest `pytest==8.3.4` since a day or so ago. This version complains about package-level imports from subdirs that are not package-like ie don't have at least an empty `__init__.py` file inside, and have scripts (modules) that bear the same name as the parent directory, see https://github.com/pytest-dev/pytest/issues/12592  and release notes https://github.com/pytest-dev/pytest/releases - in fairness, I think this is a side-effect of that bug fix on the Pytest side, but a package-like structure is aqlways useful to have, since our imports are now package-level.\r\n\r\n* * *\r\n\r\n## Before you get started\r\n\r\n<!--\r\n    Please discuss your idea with the development team before getting started,\r\n    to avoid disappointment or unnecessary work later. The way to do this is\r\n    to open a new issue on GitHub.\r\n-->\r\n\r\n\r\n## Checklist\r\n\r\nIt is the responsibility of the author to make sure the pull request is ready to review. The icons indicate whether the item will be subject to the [🛠 Technical][1] or [🧪 Scientific][2] review.\r\n\r\n<!-- The next two lines turn the 🛠 and 🧪 below into hyperlinks -->\r\n[1]: https://docs.esmvaltool.org/en/latest/community/review.html#technical-review\r\n[2]: https://docs.esmvaltool.org/en/latest/community/review.html#scientific-review\r\n\r\n- [x] [🛠][1] This pull request has a [descriptive title](https://docs.esmvaltool.org/en/latest/community/code_documentation.html#pull-request-title)\r\n- [x] [🛠][1] Code is written according to the [code quality guidelines](https://docs.esmvaltool.org/en/latest/community/code_documentation.html#code-quality)\r\n- [x] [🛠][1] Any changed dependencies have been [added or removed correctly](https://docs.esmvaltool.org/en/latest/community/code_documentation.html#dependencies)\r\n- [x] [🛠][1] All [checks below this pull request](https://docs.esmvaltool.org/en/latest/community/code_documentation.html#pull-request-checks) were successful\r\n","reactions":{"url":"https://api.github.com/repos/ESMValGroup/ESMValTool/issues/3834/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ESMValGroup/ESMValTool/issues/3834/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/2512039696","html_url":"https://github.com/pytest-dev/pytest/issues/12592#issuecomment-2512039696","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12592","id":2512039696,"node_id":"IC_kwDOAjwLdc6Vuq8Q","user":{"login":"valeriupredoi","id":28983971,"node_id":"MDQ6VXNlcjI4OTgzOTcx","avatar_url":"https://avatars.githubusercontent.com/u/28983971?v=4","gravatar_id":"","url":"https://api.github.com/users/valeriupredoi","html_url":"https://github.com/valeriupredoi","followers_url":"https://api.github.com/users/valeriupredoi/followers","following_url":"https://api.github.com/users/valeriupredoi/following{/other_user}","gists_url":"https://api.github.com/users/valeriupredoi/gists{/gist_id}","starred_url":"https://api.github.com/users/valeriupredoi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/valeriupredoi/subscriptions","organizations_url":"https://api.github.com/users/valeriupredoi/orgs","repos_url":"https://api.github.com/users/valeriupredoi/repos","events_url":"https://api.github.com/users/valeriupredoi/events{/privacy}","received_events_url":"https://api.github.com/users/valeriupredoi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-02T16:23:15Z","updated_at":"2024-12-02T16:37:03Z","body":"cheers for fixing this, folks! I noticed a side-effect of this though: if pytest is running a test on a module that imports e.g.\r\n\r\n```\r\nfrom cow.moo.farm import udder\r\n```\r\n\r\n**and** there is an `/cow/moo/moo.py`, so module `moo.py` is in a dir identically called `moo` **and** there is no `__init__.py` in `/moo` then the test fails with an `ImportError` - not a biggie since IMHO since one uses package-level imports, then there must be init files all over the place where modules live, it's all good, but just wanted to let you know if yous get some others complaining about it :beer: ","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/2512039696/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"valeriupredoi","id":28983971,"node_id":"MDQ6VXNlcjI4OTgzOTcx","avatar_url":"https://avatars.githubusercontent.com/u/28983971?v=4","gravatar_id":"","url":"https://api.github.com/users/valeriupredoi","html_url":"https://github.com/valeriupredoi","followers_url":"https://api.github.com/users/valeriupredoi/followers","following_url":"https://api.github.com/users/valeriupredoi/following{/other_user}","gists_url":"https://api.github.com/users/valeriupredoi/gists{/gist_id}","starred_url":"https://api.github.com/users/valeriupredoi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/valeriupredoi/subscriptions","organizations_url":"https://api.github.com/users/valeriupredoi/orgs","repos_url":"https://api.github.com/users/valeriupredoi/repos","events_url":"https://api.github.com/users/valeriupredoi/events{/privacy}","received_events_url":"https://api.github.com/users/valeriupredoi/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/2515100428","html_url":"https://github.com/pytest-dev/pytest/issues/12592#issuecomment-2515100428","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12592","id":2515100428,"node_id":"IC_kwDOAjwLdc6V6WMM","user":{"login":"michael-christen","id":2636212,"node_id":"MDQ6VXNlcjI2MzYyMTI=","avatar_url":"https://avatars.githubusercontent.com/u/2636212?v=4","gravatar_id":"","url":"https://api.github.com/users/michael-christen","html_url":"https://github.com/michael-christen","followers_url":"https://api.github.com/users/michael-christen/followers","following_url":"https://api.github.com/users/michael-christen/following{/other_user}","gists_url":"https://api.github.com/users/michael-christen/gists{/gist_id}","starred_url":"https://api.github.com/users/michael-christen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/michael-christen/subscriptions","organizations_url":"https://api.github.com/users/michael-christen/orgs","repos_url":"https://api.github.com/users/michael-christen/repos","events_url":"https://api.github.com/users/michael-christen/events{/privacy}","received_events_url":"https://api.github.com/users/michael-christen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-03T16:56:16Z","updated_at":"2024-12-03T16:56:16Z","body":"Seeing a similar issue as https://github.com/pytest-dev/pytest/issues/12592#issuecomment-2512039696\r\n\r\nPerhaps it's my misunderstanding of [namespace packages](https://packaging.python.org/en/latest/guides/packaging-namespace-packages/#native-namespace-packages), but I typically don't have any `__init__.py` files in my repo. And I'm seeing an `AttributeError` for my module now:\r\n\r\n```\r\n AttributeError: module 'third_party.my_protobuf_utils.my_protobuf_utils' has no attribute '_read_varint'\r\n```","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/2515100428/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"michael-christen","id":2636212,"node_id":"MDQ6VXNlcjI2MzYyMTI=","avatar_url":"https://avatars.githubusercontent.com/u/2636212?v=4","gravatar_id":"","url":"https://api.github.com/users/michael-christen","html_url":"https://github.com/michael-christen","followers_url":"https://api.github.com/users/michael-christen/followers","following_url":"https://api.github.com/users/michael-christen/following{/other_user}","gists_url":"https://api.github.com/users/michael-christen/gists{/gist_id}","starred_url":"https://api.github.com/users/michael-christen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/michael-christen/subscriptions","organizations_url":"https://api.github.com/users/michael-christen/orgs","repos_url":"https://api.github.com/users/michael-christen/repos","events_url":"https://api.github.com/users/michael-christen/events{/privacy}","received_events_url":"https://api.github.com/users/michael-christen/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"michael-christen","id":2636212,"node_id":"MDQ6VXNlcjI2MzYyMTI=","avatar_url":"https://avatars.githubusercontent.com/u/2636212?v=4","gravatar_id":"","url":"https://api.github.com/users/michael-christen","html_url":"https://github.com/michael-christen","followers_url":"https://api.github.com/users/michael-christen/followers","following_url":"https://api.github.com/users/michael-christen/following{/other_user}","gists_url":"https://api.github.com/users/michael-christen/gists{/gist_id}","starred_url":"https://api.github.com/users/michael-christen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/michael-christen/subscriptions","organizations_url":"https://api.github.com/users/michael-christen/orgs","repos_url":"https://api.github.com/users/michael-christen/repos","events_url":"https://api.github.com/users/michael-christen/events{/privacy}","received_events_url":"https://api.github.com/users/michael-christen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-03T16:56:39Z","updated_at":"2024-12-03T16:56:39Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/michael-christen/toolbox/issues/171","repository_url":"https://api.github.com/repos/michael-christen/toolbox","labels_url":"https://api.github.com/repos/michael-christen/toolbox/issues/171/labels{/name}","comments_url":"https://api.github.com/repos/michael-christen/toolbox/issues/171/comments","events_url":"https://api.github.com/repos/michael-christen/toolbox/issues/171/events","html_url":"https://github.com/michael-christen/toolbox/pull/171","id":2712288302,"node_id":"PR_kwDOByY7Y86Dwy8l","number":171,"title":"Automatically Upgrade Dependencies","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2024-12-02T15:15:08Z","updated_at":"2024-12-04T08:06:07Z","closed_at":"2024-12-04T08:05:20Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"repository":{"id":119946083,"node_id":"MDEwOlJlcG9zaXRvcnkxMTk5NDYwODM=","name":"toolbox","full_name":"michael-christen/toolbox","private":false,"owner":{"login":"michael-christen","id":2636212,"node_id":"MDQ6VXNlcjI2MzYyMTI=","avatar_url":"https://avatars.githubusercontent.com/u/2636212?v=4","gravatar_id":"","url":"https://api.github.com/users/michael-christen","html_url":"https://github.com/michael-christen","followers_url":"https://api.github.com/users/michael-christen/followers","following_url":"https://api.github.com/users/michael-christen/following{/other_user}","gists_url":"https://api.github.com/users/michael-christen/gists{/gist_id}","starred_url":"https://api.github.com/users/michael-christen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/michael-christen/subscriptions","organizations_url":"https://api.github.com/users/michael-christen/orgs","repos_url":"https://api.github.com/users/michael-christen/repos","events_url":"https://api.github.com/users/michael-christen/events{/privacy}","received_events_url":"https://api.github.com/users/michael-christen/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/michael-christen/toolbox","description":"My very own monorepo","fork":false,"url":"https://api.github.com/repos/michael-christen/toolbox","forks_url":"https://api.github.com/repos/michael-christen/toolbox/forks","keys_url":"https://api.github.com/repos/michael-christen/toolbox/keys{/key_id}","collaborators_url":"https://api.github.com/repos/michael-christen/toolbox/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/michael-christen/toolbox/teams","hooks_url":"https://api.github.com/repos/michael-christen/toolbox/hooks","issue_events_url":"https://api.github.com/repos/michael-christen/toolbox/issues/events{/number}","events_url":"https://api.github.com/repos/michael-christen/toolbox/events","assignees_url":"https://api.github.com/repos/michael-christen/toolbox/assignees{/user}","branches_url":"https://api.github.com/repos/michael-christen/toolbox/branches{/branch}","tags_url":"https://api.github.com/repos/michael-christen/toolbox/tags","blobs_url":"https://api.github.com/repos/michael-christen/toolbox/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/michael-christen/toolbox/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/michael-christen/toolbox/git/refs{/sha}","trees_url":"https://api.github.com/repos/michael-christen/toolbox/git/trees{/sha}","statuses_url":"https://api.github.com/repos/michael-christen/toolbox/statuses/{sha}","languages_url":"https://api.github.com/repos/michael-christen/toolbox/languages","stargazers_url":"https://api.github.com/repos/michael-christen/toolbox/stargazers","contributors_url":"https://api.github.com/repos/michael-christen/toolbox/contributors","subscribers_url":"https://api.github.com/repos/michael-christen/toolbox/subscribers","subscription_url":"https://api.github.com/repos/michael-christen/toolbox/subscription","commits_url":"https://api.github.com/repos/michael-christen/toolbox/commits{/sha}","git_commits_url":"https://api.github.com/repos/michael-christen/toolbox/git/commits{/sha}","comments_url":"https://api.github.com/repos/michael-christen/toolbox/comments{/number}","issue_comment_url":"https://api.github.com/repos/michael-christen/toolbox/issues/comments{/number}","contents_url":"https://api.github.com/repos/michael-christen/toolbox/contents/{+path}","compare_url":"https://api.github.com/repos/michael-christen/toolbox/compare/{base}...{head}","merges_url":"https://api.github.com/repos/michael-christen/toolbox/merges","archive_url":"https://api.github.com/repos/michael-christen/toolbox/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/michael-christen/toolbox/downloads","issues_url":"https://api.github.com/repos/michael-christen/toolbox/issues{/number}","pulls_url":"https://api.github.com/repos/michael-christen/toolbox/pulls{/number}","milestones_url":"https://api.github.com/repos/michael-christen/toolbox/milestones{/number}","notifications_url":"https://api.github.com/repos/michael-christen/toolbox/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/michael-christen/toolbox/labels{/name}","releases_url":"https://api.github.com/repos/michael-christen/toolbox/releases{/id}","deployments_url":"https://api.github.com/repos/michael-christen/toolbox/deployments","created_at":"2018-02-02T07:09:11Z","updated_at":"2025-11-01T20:37:43Z","pushed_at":"2025-11-01T20:40:25Z","git_url":"git://github.com/michael-christen/toolbox.git","ssh_url":"git@github.com:michael-christen/toolbox.git","clone_url":"https://github.com/michael-christen/toolbox.git","svn_url":"https://github.com/michael-christen/toolbox","homepage":"https://michael-christen.github.io/toolbox/","size":17060,"stargazers_count":4,"watchers_count":4,"language":"Starlark","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":false,"forks_count":1,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":77,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["bazel","embedded","monorepo"],"visibility":"public","forks":1,"open_issues":77,"watchers":4,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/michael-christen/toolbox/pulls/171","html_url":"https://github.com/michael-christen/toolbox/pull/171","diff_url":"https://github.com/michael-christen/toolbox/pull/171.diff","patch_url":"https://github.com/michael-christen/toolbox/pull/171.patch","merged_at":"2024-12-04T08:05:20Z"},"body":"Automatically Upgrade Dependencies - by upgrade-dependencies.yml\r\n\r\nThe new version of pytest introduced an issue with files named the same as their module: https://github.com/pytest-dev/pytest/issues/12592#issuecomment-2515100428","reactions":{"url":"https://api.github.com/repos/michael-christen/toolbox/issues/171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/michael-christen/toolbox/issues/171/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":15520887073,"node_id":"REFE_lADOAjwLdc6PEyA0zwAAAAOdHfEh","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/15520887073","actor":{"login":"michael-christen","id":2636212,"node_id":"MDQ6VXNlcjI2MzYyMTI=","avatar_url":"https://avatars.githubusercontent.com/u/2636212?v=4","gravatar_id":"","url":"https://api.github.com/users/michael-christen","html_url":"https://github.com/michael-christen","followers_url":"https://api.github.com/users/michael-christen/followers","following_url":"https://api.github.com/users/michael-christen/following{/other_user}","gists_url":"https://api.github.com/users/michael-christen/gists{/gist_id}","starred_url":"https://api.github.com/users/michael-christen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/michael-christen/subscriptions","organizations_url":"https://api.github.com/users/michael-christen/orgs","repos_url":"https://api.github.com/users/michael-christen/repos","events_url":"https://api.github.com/users/michael-christen/events{/privacy}","received_events_url":"https://api.github.com/users/michael-christen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"fd980911e43eef13b1248fd19cc6fd1a8a62abc6","commit_url":"https://api.github.com/repos/michael-christen/toolbox/commits/fd980911e43eef13b1248fd19cc6fd1a8a62abc6","created_at":"2024-12-04T08:05:22Z","performed_via_github_app":null},{"actor":{"login":"dongfangtianyu","id":7629022,"node_id":"MDQ6VXNlcjc2MjkwMjI=","avatar_url":"https://avatars.githubusercontent.com/u/7629022?v=4","gravatar_id":"","url":"https://api.github.com/users/dongfangtianyu","html_url":"https://github.com/dongfangtianyu","followers_url":"https://api.github.com/users/dongfangtianyu/followers","following_url":"https://api.github.com/users/dongfangtianyu/following{/other_user}","gists_url":"https://api.github.com/users/dongfangtianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/dongfangtianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongfangtianyu/subscriptions","organizations_url":"https://api.github.com/users/dongfangtianyu/orgs","repos_url":"https://api.github.com/users/dongfangtianyu/repos","events_url":"https://api.github.com/users/dongfangtianyu/events{/privacy}","received_events_url":"https://api.github.com/users/dongfangtianyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-11T13:33:48Z","updated_at":"2024-12-11T13:33:48Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/13050","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13050/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13050/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13050/events","html_url":"https://github.com/pytest-dev/pytest/issues/13050","id":2732516644,"node_id":"I_kwDOAjwLdc6i3uUk","number":13050,"title":"Class Paths Have Strange Behavior on 8.3.4","user":{"login":"ilan-gold","id":43999641,"node_id":"MDQ6VXNlcjQzOTk5NjQx","avatar_url":"https://avatars.githubusercontent.com/u/43999641?v=4","gravatar_id":"","url":"https://api.github.com/users/ilan-gold","html_url":"https://github.com/ilan-gold","followers_url":"https://api.github.com/users/ilan-gold/followers","following_url":"https://api.github.com/users/ilan-gold/following{/other_user}","gists_url":"https://api.github.com/users/ilan-gold/gists{/gist_id}","starred_url":"https://api.github.com/users/ilan-gold/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilan-gold/subscriptions","organizations_url":"https://api.github.com/users/ilan-gold/orgs","repos_url":"https://api.github.com/users/ilan-gold/repos","events_url":"https://api.github.com/users/ilan-gold/events{/privacy}","received_events_url":"https://api.github.com/users/ilan-gold/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":240511492,"node_id":"MDU6TGFiZWwyNDA1MTE0OTI=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/topic:%20collection","name":"topic: collection","color":"006b75","default":false,"description":"related to the collection phase"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2024-12-11T10:32:06Z","updated_at":"2025-01-09T12:46:26Z","closed_at":null,"author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":37489525,"node_id":"MDEwOlJlcG9zaXRvcnkzNzQ4OTUyNQ==","name":"pytest","full_name":"pytest-dev/pytest","private":false,"owner":{"login":"pytest-dev","id":8897583,"node_id":"MDEyOk9yZ2FuaXphdGlvbjg4OTc1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8897583?v=4","gravatar_id":"","url":"https://api.github.com/users/pytest-dev","html_url":"https://github.com/pytest-dev","followers_url":"https://api.github.com/users/pytest-dev/followers","following_url":"https://api.github.com/users/pytest-dev/following{/other_user}","gists_url":"https://api.github.com/users/pytest-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/pytest-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pytest-dev/subscriptions","organizations_url":"https://api.github.com/users/pytest-dev/orgs","repos_url":"https://api.github.com/users/pytest-dev/repos","events_url":"https://api.github.com/users/pytest-dev/events{/privacy}","received_events_url":"https://api.github.com/users/pytest-dev/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/pytest-dev/pytest","description":"The pytest framework makes it easy to write small tests, yet scales to support complex functional testing","fork":false,"url":"https://api.github.com/repos/pytest-dev/pytest","forks_url":"https://api.github.com/repos/pytest-dev/pytest/forks","keys_url":"https://api.github.com/repos/pytest-dev/pytest/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pytest-dev/pytest/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pytest-dev/pytest/teams","hooks_url":"https://api.github.com/repos/pytest-dev/pytest/hooks","issue_events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/events{/number}","events_url":"https://api.github.com/repos/pytest-dev/pytest/events","assignees_url":"https://api.github.com/repos/pytest-dev/pytest/assignees{/user}","branches_url":"https://api.github.com/repos/pytest-dev/pytest/branches{/branch}","tags_url":"https://api.github.com/repos/pytest-dev/pytest/tags","blobs_url":"https://api.github.com/repos/pytest-dev/pytest/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pytest-dev/pytest/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pytest-dev/pytest/git/refs{/sha}","trees_url":"https://api.github.com/repos/pytest-dev/pytest/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pytest-dev/pytest/statuses/{sha}","languages_url":"https://api.github.com/repos/pytest-dev/pytest/languages","stargazers_url":"https://api.github.com/repos/pytest-dev/pytest/stargazers","contributors_url":"https://api.github.com/repos/pytest-dev/pytest/contributors","subscribers_url":"https://api.github.com/repos/pytest-dev/pytest/subscribers","subscription_url":"https://api.github.com/repos/pytest-dev/pytest/subscription","commits_url":"https://api.github.com/repos/pytest-dev/pytest/commits{/sha}","git_commits_url":"https://api.github.com/repos/pytest-dev/pytest/git/commits{/sha}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/comments{/number}","issue_comment_url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments{/number}","contents_url":"https://api.github.com/repos/pytest-dev/pytest/contents/{+path}","compare_url":"https://api.github.com/repos/pytest-dev/pytest/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pytest-dev/pytest/merges","archive_url":"https://api.github.com/repos/pytest-dev/pytest/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pytest-dev/pytest/downloads","issues_url":"https://api.github.com/repos/pytest-dev/pytest/issues{/number}","pulls_url":"https://api.github.com/repos/pytest-dev/pytest/pulls{/number}","milestones_url":"https://api.github.com/repos/pytest-dev/pytest/milestones{/number}","notifications_url":"https://api.github.com/repos/pytest-dev/pytest/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pytest-dev/pytest/labels{/name}","releases_url":"https://api.github.com/repos/pytest-dev/pytest/releases{/id}","deployments_url":"https://api.github.com/repos/pytest-dev/pytest/deployments","created_at":"2015-06-15T20:28:27Z","updated_at":"2025-11-09T16:32:44Z","pushed_at":"2025-11-09T09:33:29Z","git_url":"git://github.com/pytest-dev/pytest.git","ssh_url":"git@github.com:pytest-dev/pytest.git","clone_url":"https://github.com/pytest-dev/pytest.git","svn_url":"https://github.com/pytest-dev/pytest","homepage":"https://pytest.org","size":37842,"stargazers_count":13254,"watchers_count":13254,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":2933,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":953,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","python","test","testing","unit-testing"],"visibility":"public","forks":2933,"open_issues":953,"watchers":13254,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"<!--\r\nThanks for submitting an issue!\r\n\r\nQuick check-list while reporting bugs:\r\n-->\r\n\r\nHello! We are having an issue in our repo where 8.3.4 pytest (but not 8.3.3) caused our classes to have [strange behavior at runtime](https://github.com/scverse/anndata/issues/1787) with errors like:\r\n\r\n```python\r\n        if (dest_type, src_type, modifiers) not in self.write:\r\n>           raise IORegistryError._from_write_parts(dest_type, src_type, modifiers)\r\nE           anndata._io.specs.registry.IORegistryError: No method registered for writing <class 'opt.hostedtoolcache.Python.3_12_7.x64.lib.python3_12.site-packages.anndata._core.views.AwkwardArrayView'> into <class 'h5py._hl.group.Group'>\r\nE           Error raised while writing key 'awk_2d_ragged' of <class 'h5py._hl.group.Group'> to /obsm\r\n```\r\nwhen in reality, the `AwkwardArrayView` is in the `self.write` dictionary, but as\r\n`<class 'anndata._core.views.AwkwardArrayView'>`:\r\n\r\n<img width=\"905\" alt=\"Screenshot 2024-12-11 at 11 34 41\" src=\"https://github.com/user-attachments/assets/d0c634f8-b79c-49e9-93c6-254d291f11c5\">\r\n\r\n(This screenshot is from my attempt to [fix the issue](https://github.com/scverse/anndata/pull/1785) where I printed out the contents of `self.write`)\r\n\r\nAlso weirdly I cannot reproduce this locally.   I have tried creating a local reproducer with an `src/package/__init__.py` file for a dummy package like:\r\n\r\n```python\r\nd = {}\r\n\r\nclass Foo():\r\n    pass\r\n\r\nd[Foo] = True\r\n\r\ndef check(typ: type) -> bool:\r\n    return d[typ]\r\n\r\n__all__ = [\"Foo\", \"check\"]\r\n```\r\nwith a single `pytest`\r\n```python\r\nfrom package import Foo, check\r\n\r\ndef test_check():\r\n    f = Foo()\r\n    assert check(type(f))\r\n```\r\nBut this seems to work when I run `pytest` instead of throwing a `KeyError`.  I will continue to try to dig but I wanted to report.\r\n\r\nSee also my various attempted to [fix the issue](https://github.com/scverse/anndata/pull/1785)\r\n\r\nPython Env:\r\n\r\n<details>\r\nanndata           0.11.1.dev18+g6594d93\r\nanyio             4.6.2.post1\r\narray-api-compat  1.9.1\r\nasciitree         0.3.3\r\nscikit-learn      1.5.2\r\nscipy             1.14.1\r\nseaborn           0.13.2\r\nsession-info      1.0.0\r\nsetuptools        75.6.0\r\nsetuptools-scm    8.1.0\r\nsix               1.16.0\r\nsniffio           1.3.1\r\nsortedcontainers  2.4.0\r\nstatsmodels       0.14.4\r\nstdlib-list       0.11.0\r\ntblib             3.0.0\r\ntextual           0.88.1\r\nthreadpoolctl     3.5.0\r\ntoolz             1.0.0\r\ntornado           6.4.2\r\ntowncrier         24.8.0\r\ntqdm              4.67.1\r\ntyping-extensions 4.12.2\r\ntzdata            2024.2\r\nuc-micro-py       1.0.3\r\numap-learn        0.5.7\r\nurllib3           2.2.3\r\nuv                0.5.5\r\nzarr              2.18.3\r\nzict              3.0.0\r\n</details>\r\n\r\nCompute Env:\r\n\r\n<details>\r\nStarting: Initialize job\r\nAgent name: 'Azure Pipelines 5'\r\nAgent machine name: 'fv-az360-809'\r\nCurrent agent version: '4.248.0'\r\nDownloading task: PublishPipelineMetadata (0.248.1)\r\nChecking job knob settings.\r\n   Knob: DockerActionRetries = true Source: $(VSTSAGENT_DOCKER_ACTION_RETRIES) \r\n   Knob: AgentToolsDirectory = /opt/hostedtoolcache Source: ${AGENT_TOOLSDIRECTORY} \r\n   Knob: UseGitLongPaths = true Source: $(USE_GIT_LONG_PATHS) \r\n   Knob: AgentPerflog = /home/vsts/perflog Source: ${VSTS_AGENT_PERFLOG} \r\n   Knob: EnableIssueSourceValidation = true Source: $(ENABLE_ISSUE_SOURCE_VALIDATION) \r\n   Knob: AgentEnablePipelineArtifactLargeChunkSize = true Source: $(AGENT_ENABLE_PIPELINEARTIFACT_LARGE_CHUNK_SIZE) \r\n   Knob: ContinueAfterCancelProcessTreeKillAttempt = true Source: $(VSTSAGENT_CONTINUE_AFTER_CANCEL_PROCESSTREEKILL_ATTEMPT) \r\n   Knob: ProcessHandlerSecureArguments = false Source: $(AZP_75787_ENABLE_NEW_LOGIC) \r\n   Knob: ProcessHandlerSecureArguments = false Source: $(AZP_75787_ENABLE_NEW_LOGIC_LOG) \r\n   Knob: ProcessHandlerTelemetry = true Source: $(AZP_75787_ENABLE_COLLECT) \r\n   Knob: UseNewNodeHandlerTelemetry = True Source: $(DistributedTask.Agent.USENEWNODEHANDLERTELEMETRY) \r\n   Knob: ProcessHandlerEnableNewLogic = true Source: $(AZP_75787_ENABLE_NEW_PH_LOGIC) \r\n   Knob: EnableResourceMonitorDebugOutput = true Source: $(AZP_ENABLE_RESOURCE_MONITOR_DEBUG_OUTPUT) \r\n   Knob: EnableResourceUtilizationWarnings = true Source: $(AZP_ENABLE_RESOURCE_UTILIZATION_WARNINGS) \r\n   Knob: IgnoreVSTSTaskLib = true Source: $(AZP_AGENT_IGNORE_VSTSTASKLIB) \r\n   Knob: FailJobWhenAgentDies = true Source: $(FAIL_JOB_WHEN_AGENT_DIES) \r\n   Knob: CheckForTaskDeprecation = true Source: $(AZP_AGENT_CHECK_FOR_TASK_DEPRECATION) \r\n   Knob: CheckIfTaskNodeRunnerIsDeprecated246 = True Source: $(DistributedTask.Agent.CheckIfTaskNodeRunnerIsDeprecated246) \r\n   Knob: UseNode20ToStartContainer = True Source: $(DistributedTask.Agent.UseNode20ToStartContainer) \r\n   Knob: LogTaskNameInUserAgent = true Source: $(AZP_AGENT_LOG_TASKNAME_IN_USERAGENT) \r\n   Knob: UseFetchFilterInCheckoutTask = true Source: $(AGENT_USE_FETCH_FILTER_IN_CHECKOUT_TASK) \r\n   Knob: Rosetta2Warning = true Source: $(ROSETTA2_WARNING) \r\n   Knob: AddForceCredentialsToGitCheckout = True Source: $(DistributedTask.Agent.AddForceCredentialsToGitCheckout) \r\nFinished checking job knob settings.\r\nStart tracking orphan processes.\r\nFinishing: Initialize job\r\n</details>\r\n\r\n- [x] a detailed description of the bug or problem you are having\r\n- [x] output of `pip list` from the virtual environment you are using\r\n- [x] pytest and operating system versions\r\n- [x] minimal example if possible (attempted)","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/13050/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13050/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/2536023858","html_url":"https://github.com/pytest-dev/pytest/issues/12592#issuecomment-2536023858","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12592","id":2536023858,"node_id":"IC_kwDOAjwLdc6XKKcy","user":{"login":"dongfangtianyu","id":7629022,"node_id":"MDQ6VXNlcjc2MjkwMjI=","avatar_url":"https://avatars.githubusercontent.com/u/7629022?v=4","gravatar_id":"","url":"https://api.github.com/users/dongfangtianyu","html_url":"https://github.com/dongfangtianyu","followers_url":"https://api.github.com/users/dongfangtianyu/followers","following_url":"https://api.github.com/users/dongfangtianyu/following{/other_user}","gists_url":"https://api.github.com/users/dongfangtianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/dongfangtianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongfangtianyu/subscriptions","organizations_url":"https://api.github.com/users/dongfangtianyu/orgs","repos_url":"https://api.github.com/users/dongfangtianyu/repos","events_url":"https://api.github.com/users/dongfangtianyu/events{/privacy}","received_events_url":"https://api.github.com/users/dongfangtianyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-11T13:41:15Z","updated_at":"2024-12-12T03:49:21Z","body":"Hi, @valeriupredoi @michael-christen \r\nSorry for seeing these messages so late. Can you please provide a simple reproducible example?\r\n\r\n----\r\n\r\nI tried to reproduce an example, Is it the same as this?  Please feel free to provide additional examples\r\n\r\nhttps://github.com/dongfangtianyu/pytest_importlib_issue\r\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/2536023858/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dongfangtianyu","id":7629022,"node_id":"MDQ6VXNlcjc2MjkwMjI=","avatar_url":"https://avatars.githubusercontent.com/u/7629022?v=4","gravatar_id":"","url":"https://api.github.com/users/dongfangtianyu","html_url":"https://github.com/dongfangtianyu","followers_url":"https://api.github.com/users/dongfangtianyu/followers","following_url":"https://api.github.com/users/dongfangtianyu/following{/other_user}","gists_url":"https://api.github.com/users/dongfangtianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/dongfangtianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongfangtianyu/subscriptions","organizations_url":"https://api.github.com/users/dongfangtianyu/orgs","repos_url":"https://api.github.com/users/dongfangtianyu/repos","events_url":"https://api.github.com/users/dongfangtianyu/events{/privacy}","received_events_url":"https://api.github.com/users/dongfangtianyu/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":15618915852,"node_id":"MEE_lADOAjwLdc6PEyA0zwAAAAOi9b4M","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/15618915852","actor":{"login":"michael-christen","id":2636212,"node_id":"MDQ6VXNlcjI2MzYyMTI=","avatar_url":"https://avatars.githubusercontent.com/u/2636212?v=4","gravatar_id":"","url":"https://api.github.com/users/michael-christen","html_url":"https://github.com/michael-christen","followers_url":"https://api.github.com/users/michael-christen/followers","following_url":"https://api.github.com/users/michael-christen/following{/other_user}","gists_url":"https://api.github.com/users/michael-christen/gists{/gist_id}","starred_url":"https://api.github.com/users/michael-christen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/michael-christen/subscriptions","organizations_url":"https://api.github.com/users/michael-christen/orgs","repos_url":"https://api.github.com/users/michael-christen/repos","events_url":"https://api.github.com/users/michael-christen/events{/privacy}","received_events_url":"https://api.github.com/users/michael-christen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-12-11T13:41:17Z","performed_via_github_app":null},{"id":15618915870,"node_id":"SE_lADOAjwLdc6PEyA0zwAAAAOi9b4e","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/15618915870","actor":{"login":"michael-christen","id":2636212,"node_id":"MDQ6VXNlcjI2MzYyMTI=","avatar_url":"https://avatars.githubusercontent.com/u/2636212?v=4","gravatar_id":"","url":"https://api.github.com/users/michael-christen","html_url":"https://github.com/michael-christen","followers_url":"https://api.github.com/users/michael-christen/followers","following_url":"https://api.github.com/users/michael-christen/following{/other_user}","gists_url":"https://api.github.com/users/michael-christen/gists{/gist_id}","starred_url":"https://api.github.com/users/michael-christen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/michael-christen/subscriptions","organizations_url":"https://api.github.com/users/michael-christen/orgs","repos_url":"https://api.github.com/users/michael-christen/repos","events_url":"https://api.github.com/users/michael-christen/events{/privacy}","received_events_url":"https://api.github.com/users/michael-christen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-12-11T13:41:17Z","performed_via_github_app":null},{"id":15618915893,"node_id":"MEE_lADOAjwLdc6PEyA0zwAAAAOi9b41","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/15618915893","actor":{"login":"valeriupredoi","id":28983971,"node_id":"MDQ6VXNlcjI4OTgzOTcx","avatar_url":"https://avatars.githubusercontent.com/u/28983971?v=4","gravatar_id":"","url":"https://api.github.com/users/valeriupredoi","html_url":"https://github.com/valeriupredoi","followers_url":"https://api.github.com/users/valeriupredoi/followers","following_url":"https://api.github.com/users/valeriupredoi/following{/other_user}","gists_url":"https://api.github.com/users/valeriupredoi/gists{/gist_id}","starred_url":"https://api.github.com/users/valeriupredoi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/valeriupredoi/subscriptions","organizations_url":"https://api.github.com/users/valeriupredoi/orgs","repos_url":"https://api.github.com/users/valeriupredoi/repos","events_url":"https://api.github.com/users/valeriupredoi/events{/privacy}","received_events_url":"https://api.github.com/users/valeriupredoi/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-12-11T13:41:17Z","performed_via_github_app":null},{"id":15618915907,"node_id":"SE_lADOAjwLdc6PEyA0zwAAAAOi9b5D","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/15618915907","actor":{"login":"valeriupredoi","id":28983971,"node_id":"MDQ6VXNlcjI4OTgzOTcx","avatar_url":"https://avatars.githubusercontent.com/u/28983971?v=4","gravatar_id":"","url":"https://api.github.com/users/valeriupredoi","html_url":"https://github.com/valeriupredoi","followers_url":"https://api.github.com/users/valeriupredoi/followers","following_url":"https://api.github.com/users/valeriupredoi/following{/other_user}","gists_url":"https://api.github.com/users/valeriupredoi/gists{/gist_id}","starred_url":"https://api.github.com/users/valeriupredoi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/valeriupredoi/subscriptions","organizations_url":"https://api.github.com/users/valeriupredoi/orgs","repos_url":"https://api.github.com/users/valeriupredoi/repos","events_url":"https://api.github.com/users/valeriupredoi/events{/privacy}","received_events_url":"https://api.github.com/users/valeriupredoi/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-12-11T13:41:17Z","performed_via_github_app":null},{"actor":{"login":"dongfangtianyu","id":7629022,"node_id":"MDQ6VXNlcjc2MjkwMjI=","avatar_url":"https://avatars.githubusercontent.com/u/7629022?v=4","gravatar_id":"","url":"https://api.github.com/users/dongfangtianyu","html_url":"https://github.com/dongfangtianyu","followers_url":"https://api.github.com/users/dongfangtianyu/followers","following_url":"https://api.github.com/users/dongfangtianyu/following{/other_user}","gists_url":"https://api.github.com/users/dongfangtianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/dongfangtianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongfangtianyu/subscriptions","organizations_url":"https://api.github.com/users/dongfangtianyu/orgs","repos_url":"https://api.github.com/users/dongfangtianyu/repos","events_url":"https://api.github.com/users/dongfangtianyu/events{/privacy}","received_events_url":"https://api.github.com/users/dongfangtianyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-12T11:02:47Z","updated_at":"2024-12-12T11:02:47Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/13053","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13053/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13053/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13053/events","html_url":"https://github.com/pytest-dev/pytest/pull/13053","id":2735575555,"node_id":"PR_kwDOAjwLdc6FADRk","number":13053,"title":"fix: Resolved an `ImportError` crash when using `--import-mode=importlib`","user":{"login":"dongfangtianyu","id":7629022,"node_id":"MDQ6VXNlcjc2MjkwMjI=","avatar_url":"https://avatars.githubusercontent.com/u/7629022?v=4","gravatar_id":"","url":"https://api.github.com/users/dongfangtianyu","html_url":"https://github.com/dongfangtianyu","followers_url":"https://api.github.com/users/dongfangtianyu/followers","following_url":"https://api.github.com/users/dongfangtianyu/following{/other_user}","gists_url":"https://api.github.com/users/dongfangtianyu/gists{/gist_id}","starred_url":"https://api.github.com/users/dongfangtianyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongfangtianyu/subscriptions","organizations_url":"https://api.github.com/users/dongfangtianyu/orgs","repos_url":"https://api.github.com/users/dongfangtianyu/repos","events_url":"https://api.github.com/users/dongfangtianyu/events{/privacy}","received_events_url":"https://api.github.com/users/dongfangtianyu/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":7102695956,"node_id":"LA_kwDOAjwLdc8AAAABp1qKFA","url":"https://api.github.com/repos/pytest-dev/pytest/labels/bot:chronographer:provided","name":"bot:chronographer:provided","color":"ededed","default":false,"description":"(automation) changelog entry is part of PR"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2024-12-12T11:02:46Z","updated_at":"2024-12-13T07:12:54Z","closed_at":"2024-12-12T14:47:06Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":37489525,"node_id":"MDEwOlJlcG9zaXRvcnkzNzQ4OTUyNQ==","name":"pytest","full_name":"pytest-dev/pytest","private":false,"owner":{"login":"pytest-dev","id":8897583,"node_id":"MDEyOk9yZ2FuaXphdGlvbjg4OTc1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8897583?v=4","gravatar_id":"","url":"https://api.github.com/users/pytest-dev","html_url":"https://github.com/pytest-dev","followers_url":"https://api.github.com/users/pytest-dev/followers","following_url":"https://api.github.com/users/pytest-dev/following{/other_user}","gists_url":"https://api.github.com/users/pytest-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/pytest-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pytest-dev/subscriptions","organizations_url":"https://api.github.com/users/pytest-dev/orgs","repos_url":"https://api.github.com/users/pytest-dev/repos","events_url":"https://api.github.com/users/pytest-dev/events{/privacy}","received_events_url":"https://api.github.com/users/pytest-dev/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/pytest-dev/pytest","description":"The pytest framework makes it easy to write small tests, yet scales to support complex functional testing","fork":false,"url":"https://api.github.com/repos/pytest-dev/pytest","forks_url":"https://api.github.com/repos/pytest-dev/pytest/forks","keys_url":"https://api.github.com/repos/pytest-dev/pytest/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pytest-dev/pytest/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pytest-dev/pytest/teams","hooks_url":"https://api.github.com/repos/pytest-dev/pytest/hooks","issue_events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/events{/number}","events_url":"https://api.github.com/repos/pytest-dev/pytest/events","assignees_url":"https://api.github.com/repos/pytest-dev/pytest/assignees{/user}","branches_url":"https://api.github.com/repos/pytest-dev/pytest/branches{/branch}","tags_url":"https://api.github.com/repos/pytest-dev/pytest/tags","blobs_url":"https://api.github.com/repos/pytest-dev/pytest/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pytest-dev/pytest/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pytest-dev/pytest/git/refs{/sha}","trees_url":"https://api.github.com/repos/pytest-dev/pytest/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pytest-dev/pytest/statuses/{sha}","languages_url":"https://api.github.com/repos/pytest-dev/pytest/languages","stargazers_url":"https://api.github.com/repos/pytest-dev/pytest/stargazers","contributors_url":"https://api.github.com/repos/pytest-dev/pytest/contributors","subscribers_url":"https://api.github.com/repos/pytest-dev/pytest/subscribers","subscription_url":"https://api.github.com/repos/pytest-dev/pytest/subscription","commits_url":"https://api.github.com/repos/pytest-dev/pytest/commits{/sha}","git_commits_url":"https://api.github.com/repos/pytest-dev/pytest/git/commits{/sha}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/comments{/number}","issue_comment_url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments{/number}","contents_url":"https://api.github.com/repos/pytest-dev/pytest/contents/{+path}","compare_url":"https://api.github.com/repos/pytest-dev/pytest/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pytest-dev/pytest/merges","archive_url":"https://api.github.com/repos/pytest-dev/pytest/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pytest-dev/pytest/downloads","issues_url":"https://api.github.com/repos/pytest-dev/pytest/issues{/number}","pulls_url":"https://api.github.com/repos/pytest-dev/pytest/pulls{/number}","milestones_url":"https://api.github.com/repos/pytest-dev/pytest/milestones{/number}","notifications_url":"https://api.github.com/repos/pytest-dev/pytest/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pytest-dev/pytest/labels{/name}","releases_url":"https://api.github.com/repos/pytest-dev/pytest/releases{/id}","deployments_url":"https://api.github.com/repos/pytest-dev/pytest/deployments","created_at":"2015-06-15T20:28:27Z","updated_at":"2025-11-09T16:32:44Z","pushed_at":"2025-11-09T09:33:29Z","git_url":"git://github.com/pytest-dev/pytest.git","ssh_url":"git@github.com:pytest-dev/pytest.git","clone_url":"https://github.com/pytest-dev/pytest.git","svn_url":"https://github.com/pytest-dev/pytest","homepage":"https://pytest.org","size":37842,"stargazers_count":13254,"watchers_count":13254,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":2933,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":953,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","python","test","testing","unit-testing"],"visibility":"public","forks":2933,"open_issues":953,"watchers":13254,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/pytest-dev/pytest/pulls/13053","html_url":"https://github.com/pytest-dev/pytest/pull/13053","diff_url":"https://github.com/pytest-dev/pytest/pull/13053.diff","patch_url":"https://github.com/pytest-dev/pytest/pull/13053.patch","merged_at":"2024-12-12T14:47:06Z"},"body":"\r\n<!--\r\nThanks for submitting a PR, your contribution is really appreciated!\r\n\r\nHere is a quick checklist that should be present in PRs.\r\n\r\n- [ ] Include documentation when adding new features.\r\n- [ ] Include new tests or update existing tests when applicable.\r\n- [X] Allow maintainers to push and squash when merging my commits. Please uncheck this if you prefer to squash the commits yourself.\r\n\r\nIf this change fixes an issue, please:\r\n\r\n- [ ] Add text like ``closes #XYZW`` to the PR description and/or commits (where ``XYZW`` is the issue number). See the [github docs](https://help.github.com/en/github/managing-your-work-on-github/linking-a-pull-request-to-an-issue#linking-a-pull-request-to-an-issue-using-a-keyword) for more information.\r\n\r\nUnless your change is trivial or a small documentation fix (e.g., a typo or reword of a small section) please:\r\n\r\n- [ ] Create a new changelog file in the `changelog` folder, with a name like `<ISSUE NUMBER>.<TYPE>.rst`. See [changelog/README.rst](https://github.com/pytest-dev/pytest/blob/main/changelog/README.rst) for details.\r\n\r\n  Write sentences in the **past or present tense**, examples:\r\n\r\n  * *Improved verbose diff output with sequences.*\r\n  * *Terminal summary statistics now use multiple colors.*\r\n\r\n  Also make sure to end the sentence with a `.`.\r\n\r\n- [ ] Add yourself to `AUTHORS` in alphabetical order.\r\n-->\r\n\r\n\r\n\r\nRegression in #12716  \r\n\r\nIn short: `PathFinder.find_spec` received the argument `/cow/moo` but loaded `/cow/moo/moo.py` instead.  \r\n\r\n**Trigger conditions:**  \r\n1. `/cow/moo/moo.py` exists (a file and directory with the same name).  \r\n2. `/cow/moo/test_moo.py` exists (test case resides in the directory).  \r\n\r\nWhen pytest loads test files in `importlib` mode, it continues recursive loading upward:  \r\n- When loading `cow.moo`, it should return a namespace but unexpectedly returns a module.  \r\n- When loading `cow.moo.moo`, it should return a module but unexpectedly returns a namespace.  \r\n\r\n**Complete example:** [[GitHub repository](https://github.com/dongfangtianyu/pytest_importlib_issue)](https://github.com/dongfangtianyu/pytest_importlib_issue)  \r\n- `main.py`: Reproduces the error.  \r\n- `debug.py`: Demonstrates the behavior of `PathFinder.find_spec`.  \r\n\r\n**Context:**\r\nhttps://github.com/pytest-dev/pytest/issues/12592#issuecomment-2512039696\r\nhttps://github.com/pytest-dev/pytest/issues/12592#issuecomment-2515100428\r\n","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/13053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13053/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":15635994458,"node_id":"REFE_lADOAjwLdc6PEyA0zwAAAAOj-lda","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/15635994458","actor":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"28e1e25a6782513db8a2963bd5ed5a9d66682f86","commit_url":"https://api.github.com/repos/pytest-dev/pytest/commits/28e1e25a6782513db8a2963bd5ed5a9d66682f86","created_at":"2024-12-12T14:47:07Z","performed_via_github_app":null},{"id":15635996836,"node_id":"REFE_lADOAjwLdc6PEyA0zwAAAAOj-mCk","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/15635996836","actor":{"login":"patchback[bot]","id":45432694,"node_id":"MDM6Qm90NDU0MzI2OTQ=","avatar_url":"https://avatars.githubusercontent.com/in/21488?v=4","gravatar_id":"","url":"https://api.github.com/users/patchback%5Bbot%5D","html_url":"https://github.com/apps/patchback","followers_url":"https://api.github.com/users/patchback%5Bbot%5D/followers","following_url":"https://api.github.com/users/patchback%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/patchback%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/patchback%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/patchback%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/patchback%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/patchback%5Bbot%5D/repos","events_url":"https://api.github.com/users/patchback%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/patchback%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"1c9e8a38f6e219309434f184411189db9c7c350a","commit_url":"https://api.github.com/repos/pytest-dev/pytest/commits/1c9e8a38f6e219309434f184411189db9c7c350a","created_at":"2024-12-12T14:47:18Z","performed_via_github_app":null},{"actor":{"login":"patchback[bot]","id":45432694,"node_id":"MDM6Qm90NDU0MzI2OTQ=","avatar_url":"https://avatars.githubusercontent.com/in/21488?v=4","gravatar_id":"","url":"https://api.github.com/users/patchback%5Bbot%5D","html_url":"https://github.com/apps/patchback","followers_url":"https://api.github.com/users/patchback%5Bbot%5D/followers","following_url":"https://api.github.com/users/patchback%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/patchback%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/patchback%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/patchback%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/patchback%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/patchback%5Bbot%5D/repos","events_url":"https://api.github.com/users/patchback%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/patchback%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2024-12-12T14:47:20Z","updated_at":"2024-12-12T14:47:20Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/13054","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13054/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13054/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13054/events","html_url":"https://github.com/pytest-dev/pytest/pull/13054","id":2736120809,"node_id":"PR_kwDOAjwLdc6FB77T","number":13054,"title":"[PR #13053/28e1e25a backport][8.3.x] fix: Resolved an `ImportError` crash when using `--import-mode=importlib`","user":{"login":"patchback[bot]","id":45432694,"node_id":"MDM6Qm90NDU0MzI2OTQ=","avatar_url":"https://avatars.githubusercontent.com/in/21488?v=4","gravatar_id":"","url":"https://api.github.com/users/patchback%5Bbot%5D","html_url":"https://github.com/apps/patchback","followers_url":"https://api.github.com/users/patchback%5Bbot%5D/followers","following_url":"https://api.github.com/users/patchback%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/patchback%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/patchback%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/patchback%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/patchback%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/patchback%5Bbot%5D/repos","events_url":"https://api.github.com/users/patchback%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/patchback%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2024-12-12T14:47:18Z","updated_at":"2024-12-12T16:08:38Z","closed_at":"2024-12-12T16:08:37Z","author_association":"NONE","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":37489525,"node_id":"MDEwOlJlcG9zaXRvcnkzNzQ4OTUyNQ==","name":"pytest","full_name":"pytest-dev/pytest","private":false,"owner":{"login":"pytest-dev","id":8897583,"node_id":"MDEyOk9yZ2FuaXphdGlvbjg4OTc1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8897583?v=4","gravatar_id":"","url":"https://api.github.com/users/pytest-dev","html_url":"https://github.com/pytest-dev","followers_url":"https://api.github.com/users/pytest-dev/followers","following_url":"https://api.github.com/users/pytest-dev/following{/other_user}","gists_url":"https://api.github.com/users/pytest-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/pytest-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pytest-dev/subscriptions","organizations_url":"https://api.github.com/users/pytest-dev/orgs","repos_url":"https://api.github.com/users/pytest-dev/repos","events_url":"https://api.github.com/users/pytest-dev/events{/privacy}","received_events_url":"https://api.github.com/users/pytest-dev/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/pytest-dev/pytest","description":"The pytest framework makes it easy to write small tests, yet scales to support complex functional testing","fork":false,"url":"https://api.github.com/repos/pytest-dev/pytest","forks_url":"https://api.github.com/repos/pytest-dev/pytest/forks","keys_url":"https://api.github.com/repos/pytest-dev/pytest/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pytest-dev/pytest/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pytest-dev/pytest/teams","hooks_url":"https://api.github.com/repos/pytest-dev/pytest/hooks","issue_events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/events{/number}","events_url":"https://api.github.com/repos/pytest-dev/pytest/events","assignees_url":"https://api.github.com/repos/pytest-dev/pytest/assignees{/user}","branches_url":"https://api.github.com/repos/pytest-dev/pytest/branches{/branch}","tags_url":"https://api.github.com/repos/pytest-dev/pytest/tags","blobs_url":"https://api.github.com/repos/pytest-dev/pytest/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pytest-dev/pytest/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pytest-dev/pytest/git/refs{/sha}","trees_url":"https://api.github.com/repos/pytest-dev/pytest/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pytest-dev/pytest/statuses/{sha}","languages_url":"https://api.github.com/repos/pytest-dev/pytest/languages","stargazers_url":"https://api.github.com/repos/pytest-dev/pytest/stargazers","contributors_url":"https://api.github.com/repos/pytest-dev/pytest/contributors","subscribers_url":"https://api.github.com/repos/pytest-dev/pytest/subscribers","subscription_url":"https://api.github.com/repos/pytest-dev/pytest/subscription","commits_url":"https://api.github.com/repos/pytest-dev/pytest/commits{/sha}","git_commits_url":"https://api.github.com/repos/pytest-dev/pytest/git/commits{/sha}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/comments{/number}","issue_comment_url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments{/number}","contents_url":"https://api.github.com/repos/pytest-dev/pytest/contents/{+path}","compare_url":"https://api.github.com/repos/pytest-dev/pytest/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pytest-dev/pytest/merges","archive_url":"https://api.github.com/repos/pytest-dev/pytest/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pytest-dev/pytest/downloads","issues_url":"https://api.github.com/repos/pytest-dev/pytest/issues{/number}","pulls_url":"https://api.github.com/repos/pytest-dev/pytest/pulls{/number}","milestones_url":"https://api.github.com/repos/pytest-dev/pytest/milestones{/number}","notifications_url":"https://api.github.com/repos/pytest-dev/pytest/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pytest-dev/pytest/labels{/name}","releases_url":"https://api.github.com/repos/pytest-dev/pytest/releases{/id}","deployments_url":"https://api.github.com/repos/pytest-dev/pytest/deployments","created_at":"2015-06-15T20:28:27Z","updated_at":"2025-11-09T16:32:44Z","pushed_at":"2025-11-09T09:33:29Z","git_url":"git://github.com/pytest-dev/pytest.git","ssh_url":"git@github.com:pytest-dev/pytest.git","clone_url":"https://github.com/pytest-dev/pytest.git","svn_url":"https://github.com/pytest-dev/pytest","homepage":"https://pytest.org","size":37842,"stargazers_count":13254,"watchers_count":13254,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":2933,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":953,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","python","test","testing","unit-testing"],"visibility":"public","forks":2933,"open_issues":953,"watchers":13254,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/pytest-dev/pytest/pulls/13054","html_url":"https://github.com/pytest-dev/pytest/pull/13054","diff_url":"https://github.com/pytest-dev/pytest/pull/13054.diff","patch_url":"https://github.com/pytest-dev/pytest/pull/13054.patch","merged_at":"2024-12-12T16:08:37Z"},"body":"**This is a backport of PR #13053 as merged into main (28e1e25a6782513db8a2963bd5ed5a9d66682f86).**\n\n\r\n<!--\r\nThanks for submitting a PR, your contribution is really appreciated!\r\n\r\nHere is a quick checklist that should be present in PRs.\r\n\r\n- [ ] Include documentation when adding new features.\r\n- [ ] Include new tests or update existing tests when applicable.\r\n- [X] Allow maintainers to push and squash when merging my commits. Please uncheck this if you prefer to squash the commits yourself.\r\n\r\nIf this change fixes an issue, please:\r\n\r\n- [ ] Add text like ``closes #XYZW`` to the PR description and/or commits (where ``XYZW`` is the issue number). See the [github docs](https://help.github.com/en/github/managing-your-work-on-github/linking-a-pull-request-to-an-issue#linking-a-pull-request-to-an-issue-using-a-keyword) for more information.\r\n\r\nUnless your change is trivial or a small documentation fix (e.g., a typo or reword of a small section) please:\r\n\r\n- [ ] Create a new changelog file in the `changelog` folder, with a name like `<ISSUE NUMBER>.<TYPE>.rst`. See [changelog/README.rst](https://github.com/pytest-dev/pytest/blob/main/changelog/README.rst) for details.\r\n\r\n  Write sentences in the **past or present tense**, examples:\r\n\r\n  * *Improved verbose diff output with sequences.*\r\n  * *Terminal summary statistics now use multiple colors.*\r\n\r\n  Also make sure to end the sentence with a `.`.\r\n\r\n- [ ] Add yourself to `AUTHORS` in alphabetical order.\r\n-->\r\n\r\n\r\n\r\nRegression in #12716  \r\n\r\nIn short: `PathFinder.find_spec` received the argument `/cow/moo` but loaded `/cow/moo/moo.py` instead.  \r\n\r\n**Trigger conditions:**  \r\n1. `/cow/moo/moo.py` exists (a file and directory with the same name).  \r\n2. `/cow/moo/test_moo.py` exists (test case resides in the directory).  \r\n\r\nWhen pytest loads test files in `importlib` mode, it continues recursive loading upward:  \r\n- When loading `cow.moo`, it should return a namespace but unexpectedly returns a module.  \r\n- When loading `cow.moo.moo`, it should return a module but unexpectedly returns a namespace.  \r\n\r\n**Complete example:** [[GitHub repository](https://github.com/dongfangtianyu/pytest_importlib_issue)](https://github.com/dongfangtianyu/pytest_importlib_issue)  \r\n- `main.py`: Reproduces the error.  \r\n- `debug.py`: Demonstrates the behavior of `PathFinder.find_spec`.  \r\n\r\n**Context:**\r\nhttps://github.com/pytest-dev/pytest/issues/12592#issuecomment-2512039696\r\nhttps://github.com/pytest-dev/pytest/issues/12592#issuecomment-2515100428\r\n","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/13054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/13054/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"}]