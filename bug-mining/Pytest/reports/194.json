{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/6951","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/6951/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/6951/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/6951/events","html_url":"https://github.com/pytest-dev/pytest/issues/6951","id":585558990,"node_id":"MDU6SXNzdWU1ODU1NTg5OTA=","number":6951,"title":"pytest >= 5.4.0 raises INTERNALERROR AttributeError with pytest-sugar installed","user":{"login":"DomKennedy","id":10784275,"node_id":"MDQ6VXNlcjEwNzg0Mjc1","avatar_url":"https://avatars.githubusercontent.com/u/10784275?v=4","gravatar_id":"","url":"https://api.github.com/users/DomKennedy","html_url":"https://github.com/DomKennedy","followers_url":"https://api.github.com/users/DomKennedy/followers","following_url":"https://api.github.com/users/DomKennedy/following{/other_user}","gists_url":"https://api.github.com/users/DomKennedy/gists{/gist_id}","starred_url":"https://api.github.com/users/DomKennedy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomKennedy/subscriptions","organizations_url":"https://api.github.com/users/DomKennedy/orgs","repos_url":"https://api.github.com/users/DomKennedy/repos","events_url":"https://api.github.com/users/DomKennedy/events{/privacy}","received_events_url":"https://api.github.com/users/DomKennedy/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":224849193,"node_id":"MDU6TGFiZWwyMjQ4NDkxOTM=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/type:%20bug","name":"type: bug","color":"fc2929","default":false,"description":"problem that needs to be addressed"},{"id":315571544,"node_id":"MDU6TGFiZWwzMTU1NzE1NDQ=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/type:%20regression","name":"type: regression","color":"f7c6c7","default":false,"description":"indicates a problem that was introduced in a release which was working previously"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-03-21T19:00:29Z","updated_at":"2020-03-30T19:51:07Z","closed_at":"2020-03-30T19:51:07Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"With both 5.4.0 and 5.4.1, running `pytest` in the following environment:\r\n\r\n<details>\r\n```\r\n$ pip list\r\nPackage            Version\r\n------------------ -------\r\napipkg             1.5    \r\nattrs              19.3.0 \r\ncoverage           5.0.4  \r\nexecnet            1.7.1  \r\nimportlib-metadata 1.5.0  \r\nmore-itertools     8.2.0  \r\npackaging          20.3   \r\npip                20.0.2 \r\npluggy             0.13.1 \r\npy                 1.8.1  \r\npyparsing          2.4.6  \r\npytest             5.4.1  \r\npytest-cov         2.8.1  \r\npytest-forked      1.1.3  \r\npytest-html        2.1.1  \r\npytest-metadata    1.8.0  \r\npytest-sugar       0.9.2  \r\npytest-xdist       1.31.0 \r\nsetuptools         46.0.0 \r\nsix                1.14.0 \r\ntermcolor          1.1.0  \r\nwcwidth            0.1.8  \r\nwheel              0.34.2 \r\nzipp               3.1.0  \r\n```\r\n\r\n</details>\r\n\r\nRaises the following error:\r\n\r\n```\r\nINTERNALERROR> Traceback (most recent call last):\r\nINTERNALERROR>   File \"~/foo/.venv/lib/python3.6/site-packages/_pytest/main.py\", line 187, in wrap_session\r\nINTERNALERROR>     config._do_configure()\r\n:INTERNALERROR>   File \"~/foo/.venv/lib/python3.6/site-packages/_pytest/config/__init__.py\", line 820, in _do_configure\r\nINTERNALERROR>     self.hook.pytest_configure.call_historic(kwargs=dict(config=self))\r\nINTERNALERROR>   File \"~/foo/.venv/lib/python3.6/site-packages/pluggy/hooks.py\", line 308, in call_historic\r\nINTERNALERROR>     res = self._hookexec(self, self.get_hookimpls(), kwargs)\r\nINTERNALERROR>   File \"~/foo/.venv/lib/python3.6/site-packages/pluggy/manager.py\", line 93, in _hookexec\r\nINTERNALERROR>     return self._inner_hookexec(hook, methods, kwargs)\r\nINTERNALERROR>   File \"~/foo/.venv/lib/python3.6/site-packages/pluggy/manager.py\", line 87, in <lambda>\r\nINTERNALERROR>     firstresult=hook.spec.opts.get(\"firstresult\") if hook.spec else False,\r\nINTERNALERROR>   File \"/~foo/.venv/lib/python3.6/site-packages/pluggy/callers.py\", line 208, in _multicall\r\nINTERNALERROR>     return outcome.get_result()\r\nINTERNALERROR>   File \"~/foo/.venv/lib/python3.6/site-packages/pluggy/callers.py\", line 80, in get_result\r\nINTERNALERROR>     raise ex[1].with_traceback(ex[2])\r\nINTERNALERROR>   File \"~/foo/.venv/lib/python3.6/site-packages/pluggy/callers.py\", line 187, in _multicall\r\nINTERNALERROR>     res = hook_impl.function(*args)\r\nINTERNALERROR>   File \"~/foo/.venv/lib/python3.6/site-packages/pytest_sugar.py\", line 171, in pytest_configure\r\nINTERNALERROR>     sugar_reporter = SugarTerminalReporter(standard_reporter)\r\nINTERNALERROR>   File \"~/foo/.venv/lib/python3.6/site-packages/pytest_sugar.py\", line 209, in __init__\r\nINTERNALERROR>    self.writer = self._tw\r\nINTERNALERROR> AttributeError: can't set attribute\r\n```\r\n\r\nNote that the above environment is the result of installing the following requirements into a clean virtualenv:\r\n\r\n```\r\npytest\r\npytest-cov\r\npytest-forked\r\npytest-html\r\npytest-metadata\r\npytest-sugar\r\npytest-xdist\r\n```\r\n\r\nUninstalling `pytest-sugar` fixes the issue, as does downgrading `pytest` to 5.3.5.\r\n\r\nI've experienced this error with python 3.6.8 on Ubuntu 18.04, and python 3.7.3 on macOS Catalina.","closed_by":{"login":"RonnyPfannschmidt","id":156838,"node_id":"MDQ6VXNlcjE1NjgzOA==","avatar_url":"https://avatars.githubusercontent.com/u/156838?v=4","gravatar_id":"","url":"https://api.github.com/users/RonnyPfannschmidt","html_url":"https://github.com/RonnyPfannschmidt","followers_url":"https://api.github.com/users/RonnyPfannschmidt/followers","following_url":"https://api.github.com/users/RonnyPfannschmidt/following{/other_user}","gists_url":"https://api.github.com/users/RonnyPfannschmidt/gists{/gist_id}","starred_url":"https://api.github.com/users/RonnyPfannschmidt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RonnyPfannschmidt/subscriptions","organizations_url":"https://api.github.com/users/RonnyPfannschmidt/orgs","repos_url":"https://api.github.com/users/RonnyPfannschmidt/repos","events_url":"https://api.github.com/users/RonnyPfannschmidt/events{/privacy}","received_events_url":"https://api.github.com/users/RonnyPfannschmidt/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/6951/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/6951/timeline","performed_via_github_app":null,"state_reason":"completed"}