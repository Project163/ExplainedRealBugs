[{"id":1364663481,"node_id":"MDEyOkxhYmVsZWRFdmVudDEzNjQ2NjM0ODE=","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/1364663481","actor":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2017-11-29T23:53:14Z","label":{"name":"topic: fixtures","color":"5319e7"},"performed_via_github_app":null},{"id":1364663482,"node_id":"MDEyOkxhYmVsZWRFdmVudDEzNjQ2NjM0ODI=","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/1364663482","actor":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2017-11-29T23:53:14Z","label":{"name":"type: bug","color":"fc2929"},"performed_via_github_app":null},{"id":1364663591,"node_id":"MDEzOkFzc2lnbmVkRXZlbnQxMzY0NjYzNTkx","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/1364663591","actor":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"assigned","commit_id":null,"commit_url":null,"created_at":"2017-11-29T23:53:19Z","assignee":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"performed_via_github_app":null},{"actor":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-29T23:53:47Z","updated_at":"2017-11-29T23:53:47Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/2968","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/2968/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/2968/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/2968/events","html_url":"https://github.com/pytest-dev/pytest/issues/2968","id":277544452,"node_id":"MDU6SXNzdWUyNzc1NDQ0NTI=","number":2968,"title":"Memory usage in 3.3.0","user":{"login":"mplanchard","id":6752481,"node_id":"MDQ6VXNlcjY3NTI0ODE=","avatar_url":"https://avatars.githubusercontent.com/u/6752481?v=4","gravatar_id":"","url":"https://api.github.com/users/mplanchard","html_url":"https://github.com/mplanchard","followers_url":"https://api.github.com/users/mplanchard/followers","following_url":"https://api.github.com/users/mplanchard/following{/other_user}","gists_url":"https://api.github.com/users/mplanchard/gists{/gist_id}","starred_url":"https://api.github.com/users/mplanchard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mplanchard/subscriptions","organizations_url":"https://api.github.com/users/mplanchard/orgs","repos_url":"https://api.github.com/users/mplanchard/repos","events_url":"https://api.github.com/users/mplanchard/events{/privacy}","received_events_url":"https://api.github.com/users/mplanchard/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":265779499,"node_id":"MDU6TGFiZWwyNjU3Nzk0OTk=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/status:%20critical","name":"status: critical","color":"e11d21","default":false,"description":"grave problem or usability issue that affects lots of users"},{"id":315571544,"node_id":"MDU6TGFiZWwzMTU1NzE1NDQ=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/type:%20regression","name":"type: regression","color":"f7c6c7","default":false,"description":"indicates a problem that was introduced in a release which was working previously"},{"id":763820991,"node_id":"MDU6TGFiZWw3NjM4MjA5OTE=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/plugin:%20logging","name":"plugin: logging","color":"ff5432","default":false,"description":"related to the logging builtin plugin"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":22,"created_at":"2017-11-28T21:29:29Z","updated_at":"2017-11-30T15:07:13Z","closed_at":"2017-11-30T15:07:13Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":37489525,"node_id":"MDEwOlJlcG9zaXRvcnkzNzQ4OTUyNQ==","name":"pytest","full_name":"pytest-dev/pytest","private":false,"owner":{"login":"pytest-dev","id":8897583,"node_id":"MDEyOk9yZ2FuaXphdGlvbjg4OTc1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8897583?v=4","gravatar_id":"","url":"https://api.github.com/users/pytest-dev","html_url":"https://github.com/pytest-dev","followers_url":"https://api.github.com/users/pytest-dev/followers","following_url":"https://api.github.com/users/pytest-dev/following{/other_user}","gists_url":"https://api.github.com/users/pytest-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/pytest-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pytest-dev/subscriptions","organizations_url":"https://api.github.com/users/pytest-dev/orgs","repos_url":"https://api.github.com/users/pytest-dev/repos","events_url":"https://api.github.com/users/pytest-dev/events{/privacy}","received_events_url":"https://api.github.com/users/pytest-dev/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/pytest-dev/pytest","description":"The pytest framework makes it easy to write small tests, yet scales to support complex functional testing","fork":false,"url":"https://api.github.com/repos/pytest-dev/pytest","forks_url":"https://api.github.com/repos/pytest-dev/pytest/forks","keys_url":"https://api.github.com/repos/pytest-dev/pytest/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pytest-dev/pytest/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pytest-dev/pytest/teams","hooks_url":"https://api.github.com/repos/pytest-dev/pytest/hooks","issue_events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/events{/number}","events_url":"https://api.github.com/repos/pytest-dev/pytest/events","assignees_url":"https://api.github.com/repos/pytest-dev/pytest/assignees{/user}","branches_url":"https://api.github.com/repos/pytest-dev/pytest/branches{/branch}","tags_url":"https://api.github.com/repos/pytest-dev/pytest/tags","blobs_url":"https://api.github.com/repos/pytest-dev/pytest/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pytest-dev/pytest/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pytest-dev/pytest/git/refs{/sha}","trees_url":"https://api.github.com/repos/pytest-dev/pytest/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pytest-dev/pytest/statuses/{sha}","languages_url":"https://api.github.com/repos/pytest-dev/pytest/languages","stargazers_url":"https://api.github.com/repos/pytest-dev/pytest/stargazers","contributors_url":"https://api.github.com/repos/pytest-dev/pytest/contributors","subscribers_url":"https://api.github.com/repos/pytest-dev/pytest/subscribers","subscription_url":"https://api.github.com/repos/pytest-dev/pytest/subscription","commits_url":"https://api.github.com/repos/pytest-dev/pytest/commits{/sha}","git_commits_url":"https://api.github.com/repos/pytest-dev/pytest/git/commits{/sha}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/comments{/number}","issue_comment_url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments{/number}","contents_url":"https://api.github.com/repos/pytest-dev/pytest/contents/{+path}","compare_url":"https://api.github.com/repos/pytest-dev/pytest/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pytest-dev/pytest/merges","archive_url":"https://api.github.com/repos/pytest-dev/pytest/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pytest-dev/pytest/downloads","issues_url":"https://api.github.com/repos/pytest-dev/pytest/issues{/number}","pulls_url":"https://api.github.com/repos/pytest-dev/pytest/pulls{/number}","milestones_url":"https://api.github.com/repos/pytest-dev/pytest/milestones{/number}","notifications_url":"https://api.github.com/repos/pytest-dev/pytest/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pytest-dev/pytest/labels{/name}","releases_url":"https://api.github.com/repos/pytest-dev/pytest/releases{/id}","deployments_url":"https://api.github.com/repos/pytest-dev/pytest/deployments","created_at":"2015-06-15T20:28:27Z","updated_at":"2025-11-09T16:32:44Z","pushed_at":"2025-11-09T09:33:29Z","git_url":"git://github.com/pytest-dev/pytest.git","ssh_url":"git@github.com:pytest-dev/pytest.git","clone_url":"https://github.com/pytest-dev/pytest.git","svn_url":"https://github.com/pytest-dev/pytest","homepage":"https://pytest.org","size":37842,"stargazers_count":13254,"watchers_count":13254,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":2933,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":953,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","python","test","testing","unit-testing"],"visibility":"public","forks":2933,"open_issues":953,"watchers":13254,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"## Bug Description\r\n\r\n**TL;DR: memory usage seems to have increased several fold in 3.3.0. With the default log capturing enabled, memory usage has the potential to increase to ludicrous levels.**\r\n\r\nI was troubleshooting issues with tests hanging on our CI server and massive swap utilization, and I found it to be due to an upgrade to pytest 3.3.0. Running our test suite with 3.3.0 quickly consumed all of the memory and began swapping. \r\n\r\nLooking at the changelog, the capturing of log output seemed to be the most likely cause. Our application uses SQLAlchemy, which has verbose logging, and has rather verbose logging itself, so I attempted to disable log capturing via both of the options specified [here](https://docs.pytest.org/en/latest/logging.html), and while the first seemed to decrease the *massive* consumption of virtual memory seen with the default options, neither was able to reduce memory utilization enough for our test suite to run.\r\n\r\nI have collected the memory utilization of various configurations below. For all of the 3.3.0 runs, the CI server began swapping and the test suite hung, although some configurations resulted in more virtual memory consumption than others. \r\n\r\nIn all cases, regardless of attempting to disable log capturing, the virtual memory output jumped significantly when hitting tests that produced a large amount of log output. However, even prior to hitting those tests, virtual memory utilization was around twice that of its peak in version 3.2.5.\r\n\r\nThe tests were running in a python:3.5.2 docker container, via an Ubuntu 16.04 OS. The system has 2 GB of RAM and 2 GB of swap space. In all cases, pytest was invoked via  tox, with the command `coverage run --source <project directory> -m py.test {posargs}`\r\n\r\npytest version | additional options | peak virtual memory consumed | peak resident memory consumed | test suite completed\r\n-----------|----------|----------|----------|------\r\n3.2.5 | none | 2685 MB | 243 MB | yes\r\n3.3.0 | none | 11.9 GB !!! | 418 MB | no\r\n3.3.0 | `addopts=-p no:logging` | 9105 MB | 366 MB | no\r\n3.3.0 | `--no-print-logs` | 12.2 GB !!! | 431 MB | no\r\n3.3.0 | `addopts=-p no:logging` and `--no-print-logs` | 12.2 GB !!! | 415 MB | no\r\n\r\npytest is not included in the pip output below, since its version varied by test. All other packages remained consistent between tests. Some private distributions have been redacted.\r\n\r\nWe have had to pin our version of pytest to `<3.3.0` for the moment. Is there anything else I can try to reduce the base memory footprint of version 3.3.0? \r\n\r\nI'm happy to gather more data as needed.\r\n\r\nThanks!\r\n\r\n## Pip List\r\n\r\naiohttp (2.2.5)\r\nalembic (0.9.5)\r\namqp (2.2.2)\r\naniso8601 (1.3.0)\r\napipkg (1.4)\r\napispec (0.25.4)\r\nappnope (0.1.0)\r\nasn1crypto (0.23.0)\r\nastroid (1.5.3)\r\nasync-timeout (2.0.0)\r\nattrs (17.3.0)\r\nautopep8 (1.3.3)\r\nBabel (2.5.1)\r\nbilliard (3.5.0.3)\r\nbleach (2.1.1)\r\ncelery (4.1.0)\r\ncertifi (2017.7.27.1)\r\ncffi (1.11.2)\r\nchardet (3.0.4)\r\nclick (6.7)\r\ncoverage (4.4.2)\r\ncryptography (2.1.1)\r\ndebtcollector (1.18.0)\r\ndecorator (4.1.2)\r\ndill (0.2.7.1)\r\ndocutils (0.14)\r\nentrypoints (0.2.3)\r\nexecnet (1.5.0)\r\nflake8 (3.5.0)\r\nflasgger (0.8.0)\r\nFlask (0.12.2)\r\nFlask-RESTful (0.3.6)\r\nFlask-Script (2.0.6)\r\nfrozendict (1.2)\r\nhtml5lib (1.0b10)\r\nhttplib2 (0.10.3)\r\nidna (2.6)\r\nipdb (0.10.3)\r\nipykernel (4.6.1)\r\nipython (6.2.1)\r\nipython-genutils (0.2.0)\r\nipywidgets (7.0.5)\r\niso8601 (0.1.12)\r\nisort (4.2.15)\r\nitsdangerous (0.24)\r\njedi (0.11.0)\r\nJinja2 (2.9.6)\r\njsonschema (2.6.0)\r\njupyter (1.0.0)\r\njupyter-client (5.1.0)\r\njupyter-console (5.2.0)\r\njupyter-core (4.4.0)\r\nkeystoneauth1 (3.2.0)\r\nkombu (4.1.0)\r\nlazy-object-proxy (1.3.1)\r\nloggly-python-handler (1.0.0)\r\nMako (1.0.7)\r\nMarkupSafe (1.0)\r\nmarshmallow (2.13.6)\r\nmarshmallow-sqlalchemy (0.13.1)\r\nmccabe (0.6.1)\r\nmistune (0.7.4)\r\nmonotonic (1.3)\r\nmsgpack-python (0.4.8)\r\nmultidict (3.2.0)\r\nmypy (0.550)\r\nmysqlclient (1.3.12)\r\nnbconvert (5.3.1)\r\nnbformat (4.4.0)\r\nnetaddr (0.7.19)\r\nnetifaces (0.10.6)\r\nnotebook (5.2.1)\r\noslo.config (4.13.1)\r\noslo.i18n (3.18.0)\r\noslo.policy (1.28.1)\r\noslo.serialization (2.21.1)\r\noslo.utils (3.30.0)\r\npandocfilters (1.4.2)\r\nparso (0.1.0)\r\npasslib (1.7.1)\r\npbr (3.1.1)\r\npexpect (4.2.1)\r\npickleshare (0.7.4)\r\npika (0.11.0)\r\npip (9.0.1)\r\npluggy (0.6.0)\r\npositional (1.2.1)\r\nprompt-toolkit (1.0.15)\r\npsutil (5.4.1)\r\npsycopg2 (2.7.3.1)\r\nptyprocess (0.5.2)\r\npy (1.5.2)\r\npycodestyle (2.3.1)\r\npycparser (2.18)\r\npydecor (1.1.3)\r\npydocstyle (2.1.1)\r\npyflakes (1.6.0)\r\nPygments (2.2.0)\r\nPyJWT (1.5.3)\r\npylint (1.7.4)\r\npymongo (3.5.1)\r\npyparsing (2.2.0)\r\npyrabbit (1.1.0)\r\npytest-aiohttp (0.1.3)\r\npytest-cov (2.5.1)\r\npytest-forked (0.2)\r\npytest-xdist (1.20.1)\r\npython-dateutil (2.6.1)\r\npython-editor (1.0.3)\r\npython-keystoneclient (3.13.0)\r\npython-memcached (1.58)\r\npytz (2017.2)\r\nPyYAML (3.12)\r\npyzmq (16.0.3)\r\nqtconsole (4.3.1)\r\nredis (2.10.6)\r\nrequests (2.18.4)\r\nrequests-futures (0.9.7)\r\nrestructuredtext-lint (1.1.2)\r\nrfc3986 (1.1.0)\r\nsetuptools (20.10.1)\r\nsimplegeneric (0.8.1)\r\nsimplejson (3.11.1)\r\nsix (1.11.0)\r\nsnowballstemmer (1.2.1)\r\nSQLAlchemy (1.1.14)\r\nSQLAlchemy-Utils (0.32.18)\r\nstevedore (1.27.1)\r\nstripe (1.67.0)\r\nterminado (0.8.1)\r\ntestpath (0.3.1)\r\ntornado (4.5.2)\r\ntox (2.9.1)\r\ntraitlets (4.3.2)\r\ntyped-ast (1.1.0)\r\ntyping (3.6.2)\r\nurllib3 (1.22)\r\nvine (1.1.4)\r\nvirtualenv (15.1.0)\r\nwcwidth (0.1.7)\r\nwebargs (1.8.1)\r\nwebencodings (0.5.1)\r\nWerkzeug (0.12.2)\r\nwidgetsnbextension (3.0.8)\r\nwrapt (1.10.11)\r\nyarl (0.13.0)\r\n\r\n## Submission Checklist\r\n\r\nThanks for submitting an issue!\r\n\r\nHere's a quick checklist in what to include:\r\n\r\n- [x] Include a detailed description of the bug or suggestion\r\n- [x] `pip list` of the virtual environment you are using\r\n- [x] pytest and operating system versions\r\n- [x] Minimal example if possible\r\n","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/2968/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/2968/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"id":1386566626,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDEzODY1NjY2MjY=","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/1386566626","actor":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"c3f63ac1432044271b15c4ef7959000a7a0d9bfe","commit_url":"https://api.github.com/repos/nicoddemus/pytest/commits/c3f63ac1432044271b15c4ef7959000a7a0d9bfe","created_at":"2017-12-13T21:49:29Z","performed_via_github_app":null},{"actor":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-13T21:57:30Z","updated_at":"2017-12-13T21:57:30Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/3030","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/3030/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/3030/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/3030/events","html_url":"https://github.com/pytest-dev/pytest/pull/3030","id":281910934,"node_id":"MDExOlB1bGxSZXF1ZXN0MTU4MjE1ODYy","number":3030,"title":"Fix memory leak caused by fixture values never been garbage collected","user":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-12-13T21:57:29Z","updated_at":"2017-12-14T21:20:38Z","closed_at":"2017-12-14T21:20:35Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":37489525,"node_id":"MDEwOlJlcG9zaXRvcnkzNzQ4OTUyNQ==","name":"pytest","full_name":"pytest-dev/pytest","private":false,"owner":{"login":"pytest-dev","id":8897583,"node_id":"MDEyOk9yZ2FuaXphdGlvbjg4OTc1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8897583?v=4","gravatar_id":"","url":"https://api.github.com/users/pytest-dev","html_url":"https://github.com/pytest-dev","followers_url":"https://api.github.com/users/pytest-dev/followers","following_url":"https://api.github.com/users/pytest-dev/following{/other_user}","gists_url":"https://api.github.com/users/pytest-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/pytest-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pytest-dev/subscriptions","organizations_url":"https://api.github.com/users/pytest-dev/orgs","repos_url":"https://api.github.com/users/pytest-dev/repos","events_url":"https://api.github.com/users/pytest-dev/events{/privacy}","received_events_url":"https://api.github.com/users/pytest-dev/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/pytest-dev/pytest","description":"The pytest framework makes it easy to write small tests, yet scales to support complex functional testing","fork":false,"url":"https://api.github.com/repos/pytest-dev/pytest","forks_url":"https://api.github.com/repos/pytest-dev/pytest/forks","keys_url":"https://api.github.com/repos/pytest-dev/pytest/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pytest-dev/pytest/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pytest-dev/pytest/teams","hooks_url":"https://api.github.com/repos/pytest-dev/pytest/hooks","issue_events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/events{/number}","events_url":"https://api.github.com/repos/pytest-dev/pytest/events","assignees_url":"https://api.github.com/repos/pytest-dev/pytest/assignees{/user}","branches_url":"https://api.github.com/repos/pytest-dev/pytest/branches{/branch}","tags_url":"https://api.github.com/repos/pytest-dev/pytest/tags","blobs_url":"https://api.github.com/repos/pytest-dev/pytest/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pytest-dev/pytest/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pytest-dev/pytest/git/refs{/sha}","trees_url":"https://api.github.com/repos/pytest-dev/pytest/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pytest-dev/pytest/statuses/{sha}","languages_url":"https://api.github.com/repos/pytest-dev/pytest/languages","stargazers_url":"https://api.github.com/repos/pytest-dev/pytest/stargazers","contributors_url":"https://api.github.com/repos/pytest-dev/pytest/contributors","subscribers_url":"https://api.github.com/repos/pytest-dev/pytest/subscribers","subscription_url":"https://api.github.com/repos/pytest-dev/pytest/subscription","commits_url":"https://api.github.com/repos/pytest-dev/pytest/commits{/sha}","git_commits_url":"https://api.github.com/repos/pytest-dev/pytest/git/commits{/sha}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/comments{/number}","issue_comment_url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments{/number}","contents_url":"https://api.github.com/repos/pytest-dev/pytest/contents/{+path}","compare_url":"https://api.github.com/repos/pytest-dev/pytest/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pytest-dev/pytest/merges","archive_url":"https://api.github.com/repos/pytest-dev/pytest/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pytest-dev/pytest/downloads","issues_url":"https://api.github.com/repos/pytest-dev/pytest/issues{/number}","pulls_url":"https://api.github.com/repos/pytest-dev/pytest/pulls{/number}","milestones_url":"https://api.github.com/repos/pytest-dev/pytest/milestones{/number}","notifications_url":"https://api.github.com/repos/pytest-dev/pytest/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pytest-dev/pytest/labels{/name}","releases_url":"https://api.github.com/repos/pytest-dev/pytest/releases{/id}","deployments_url":"https://api.github.com/repos/pytest-dev/pytest/deployments","created_at":"2015-06-15T20:28:27Z","updated_at":"2025-11-09T16:32:44Z","pushed_at":"2025-11-09T09:33:29Z","git_url":"git://github.com/pytest-dev/pytest.git","ssh_url":"git@github.com:pytest-dev/pytest.git","clone_url":"https://github.com/pytest-dev/pytest.git","svn_url":"https://github.com/pytest-dev/pytest","homepage":"https://pytest.org","size":37842,"stargazers_count":13254,"watchers_count":13254,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":2933,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":953,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","python","test","testing","unit-testing"],"visibility":"public","forks":2933,"open_issues":953,"watchers":13254,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/pytest-dev/pytest/pulls/3030","html_url":"https://github.com/pytest-dev/pytest/pull/3030","diff_url":"https://github.com/pytest-dev/pytest/pull/3030.diff","patch_url":"https://github.com/pytest-dev/pytest/pull/3030.patch","merged_at":"2017-12-14T21:20:35Z"},"body":"The leak was caused by the (unused) `FixtureRequest._fixture_values`\r\ncache.\r\n\r\nThis was introduced because the `partial` object (created to call\r\nFixtureDef.finish() bound with the Request) is kept alive\r\nthrough the entire session when a function-scoped fixture depends\r\non a session-scoped (or higher) fixture because of the nested\r\n`addfinalizer` calls.\r\n\r\nFixtureDef.finish() started receiving a request object in order to\r\nobtain the proper hook proxy object (#2127), but this does not seem\r\nuseful at all in practice because `pytest_fixture_post_finalizer`\r\nwill be called with the `request` object of the moment the fixture value\r\nwas *created*, not the request object active when the fixture value\r\nis being destroyed. We should probably deprecate/remove the request\r\nparameter from `pytest_fixture_post_finalizer`.\r\n\r\nFix #2981\r\n","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/3030/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/3030/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/351668474","html_url":"https://github.com/pytest-dev/pytest/issues/2981#issuecomment-351668474","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/2981","id":351668474,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MTY2ODQ3NA==","user":{"login":"JacobSMoller","id":13047162,"node_id":"MDQ6VXNlcjEzMDQ3MTYy","avatar_url":"https://avatars.githubusercontent.com/u/13047162?v=4","gravatar_id":"","url":"https://api.github.com/users/JacobSMoller","html_url":"https://github.com/JacobSMoller","followers_url":"https://api.github.com/users/JacobSMoller/followers","following_url":"https://api.github.com/users/JacobSMoller/following{/other_user}","gists_url":"https://api.github.com/users/JacobSMoller/gists{/gist_id}","starred_url":"https://api.github.com/users/JacobSMoller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JacobSMoller/subscriptions","organizations_url":"https://api.github.com/users/JacobSMoller/orgs","repos_url":"https://api.github.com/users/JacobSMoller/repos","events_url":"https://api.github.com/users/JacobSMoller/events{/privacy}","received_events_url":"https://api.github.com/users/JacobSMoller/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-14T10:17:48Z","updated_at":"2017-12-14T10:18:05Z","body":"Just ran the fix from #3030 locally, this also fixes an issue we encountered where our connections to postgresql were not closed, resulting in:\r\n(psycopg2.OperationalError) FATAL:  remaining connection slots are reserved for non-replication superuser connections and\r\n(psycopg2.OperationalError) FATAL:  sorry, too many clients already\r\nIf the test role was a superuser.  \r\n\r\nJust for anyone else coming across this issue. \r\n\r\nThanks @nicoddemus and the rest of the pytest team for all the work you do. ðŸŽŠ ","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/351668474/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"JacobSMoller","id":13047162,"node_id":"MDQ6VXNlcjEzMDQ3MTYy","avatar_url":"https://avatars.githubusercontent.com/u/13047162?v=4","gravatar_id":"","url":"https://api.github.com/users/JacobSMoller","html_url":"https://github.com/JacobSMoller","followers_url":"https://api.github.com/users/JacobSMoller/followers","following_url":"https://api.github.com/users/JacobSMoller/following{/other_user}","gists_url":"https://api.github.com/users/JacobSMoller/gists{/gist_id}","starred_url":"https://api.github.com/users/JacobSMoller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JacobSMoller/subscriptions","organizations_url":"https://api.github.com/users/JacobSMoller/orgs","repos_url":"https://api.github.com/users/JacobSMoller/repos","events_url":"https://api.github.com/users/JacobSMoller/events{/privacy}","received_events_url":"https://api.github.com/users/JacobSMoller/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1387375322,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTM4NzM3NTMyMg==","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/1387375322","actor":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2017-12-14T10:17:48Z","performed_via_github_app":null},{"id":1387375323,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDEzODczNzUzMjM=","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/1387375323","actor":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2017-12-14T10:17:48Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/351680356","html_url":"https://github.com/pytest-dev/pytest/issues/2981#issuecomment-351680356","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/2981","id":351680356,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MTY4MDM1Ng==","user":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-14T11:07:09Z","updated_at":"2017-12-14T11:07:09Z","body":"Thanks @JacobSMoller for testing the PR! ðŸ‘ ðŸ˜ \r\n\r\nGlad this fixed your problem, but I would recommend regardless to explicitly close your connections and do not rely on the garbage collector for that.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/351680356/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1387459279,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTM4NzQ1OTI3OQ==","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/1387459279","actor":{"login":"JacobSMoller","id":13047162,"node_id":"MDQ6VXNlcjEzMDQ3MTYy","avatar_url":"https://avatars.githubusercontent.com/u/13047162?v=4","gravatar_id":"","url":"https://api.github.com/users/JacobSMoller","html_url":"https://github.com/JacobSMoller","followers_url":"https://api.github.com/users/JacobSMoller/followers","following_url":"https://api.github.com/users/JacobSMoller/following{/other_user}","gists_url":"https://api.github.com/users/JacobSMoller/gists{/gist_id}","starred_url":"https://api.github.com/users/JacobSMoller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JacobSMoller/subscriptions","organizations_url":"https://api.github.com/users/JacobSMoller/orgs","repos_url":"https://api.github.com/users/JacobSMoller/repos","events_url":"https://api.github.com/users/JacobSMoller/events{/privacy}","received_events_url":"https://api.github.com/users/JacobSMoller/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2017-12-14T11:07:09Z","performed_via_github_app":null},{"id":1387459280,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDEzODc0NTkyODA=","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/1387459280","actor":{"login":"JacobSMoller","id":13047162,"node_id":"MDQ6VXNlcjEzMDQ3MTYy","avatar_url":"https://avatars.githubusercontent.com/u/13047162?v=4","gravatar_id":"","url":"https://api.github.com/users/JacobSMoller","html_url":"https://github.com/JacobSMoller","followers_url":"https://api.github.com/users/JacobSMoller/followers","following_url":"https://api.github.com/users/JacobSMoller/following{/other_user}","gists_url":"https://api.github.com/users/JacobSMoller/gists{/gist_id}","starred_url":"https://api.github.com/users/JacobSMoller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JacobSMoller/subscriptions","organizations_url":"https://api.github.com/users/JacobSMoller/orgs","repos_url":"https://api.github.com/users/JacobSMoller/repos","events_url":"https://api.github.com/users/JacobSMoller/events{/privacy}","received_events_url":"https://api.github.com/users/JacobSMoller/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2017-12-14T11:07:09Z","performed_via_github_app":null},{"id":1388540453,"node_id":"MDExOkNsb3NlZEV2ZW50MTM4ODU0MDQ1Mw==","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/1388540453","actor":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2017-12-14T21:20:35Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/355610018","html_url":"https://github.com/pytest-dev/pytest/issues/2981#issuecomment-355610018","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/2981","id":355610018,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NTYxMDAxOA==","user":{"login":"mplanchard","id":6752481,"node_id":"MDQ6VXNlcjY3NTI0ODE=","avatar_url":"https://avatars.githubusercontent.com/u/6752481?v=4","gravatar_id":"","url":"https://api.github.com/users/mplanchard","html_url":"https://github.com/mplanchard","followers_url":"https://api.github.com/users/mplanchard/followers","following_url":"https://api.github.com/users/mplanchard/following{/other_user}","gists_url":"https://api.github.com/users/mplanchard/gists{/gist_id}","starred_url":"https://api.github.com/users/mplanchard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mplanchard/subscriptions","organizations_url":"https://api.github.com/users/mplanchard/orgs","repos_url":"https://api.github.com/users/mplanchard/repos","events_url":"https://api.github.com/users/mplanchard/events{/privacy}","received_events_url":"https://api.github.com/users/mplanchard/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-05T17:11:12Z","updated_at":"2018-01-05T17:11:12Z","body":"@nicoddemus just wanted to say thanks for your work on this! We'll be upgrading immediately and will let you know if we run into any issues.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/355610018/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mplanchard","id":6752481,"node_id":"MDQ6VXNlcjY3NTI0ODE=","avatar_url":"https://avatars.githubusercontent.com/u/6752481?v=4","gravatar_id":"","url":"https://api.github.com/users/mplanchard","html_url":"https://github.com/mplanchard","followers_url":"https://api.github.com/users/mplanchard/followers","following_url":"https://api.github.com/users/mplanchard/following{/other_user}","gists_url":"https://api.github.com/users/mplanchard/gists{/gist_id}","starred_url":"https://api.github.com/users/mplanchard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mplanchard/subscriptions","organizations_url":"https://api.github.com/users/mplanchard/orgs","repos_url":"https://api.github.com/users/mplanchard/repos","events_url":"https://api.github.com/users/mplanchard/events{/privacy}","received_events_url":"https://api.github.com/users/mplanchard/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1411639736,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MTQxMTYzOTczNg==","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/1411639736","actor":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2018-01-05T17:11:12Z","performed_via_github_app":null},{"id":1411639737,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDE0MTE2Mzk3Mzc=","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/1411639737","actor":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2018-01-05T17:11:12Z","performed_via_github_app":null},{"actor":{"login":"pytestbot","id":12873537,"node_id":"MDQ6VXNlcjEyODczNTM3","avatar_url":"https://avatars.githubusercontent.com/u/12873537?v=4","gravatar_id":"","url":"https://api.github.com/users/pytestbot","html_url":"https://github.com/pytestbot","followers_url":"https://api.github.com/users/pytestbot/followers","following_url":"https://api.github.com/users/pytestbot/following{/other_user}","gists_url":"https://api.github.com/users/pytestbot/gists{/gist_id}","starred_url":"https://api.github.com/users/pytestbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pytestbot/subscriptions","organizations_url":"https://api.github.com/users/pytestbot/orgs","repos_url":"https://api.github.com/users/pytestbot/repos","events_url":"https://api.github.com/users/pytestbot/events{/privacy}","received_events_url":"https://api.github.com/users/pytestbot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-07-09T12:54:09Z","updated_at":"2018-07-09T12:54:09Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/3673","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/3673/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/3673/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/3673/events","html_url":"https://github.com/pytest-dev/pytest/issues/3673","id":339435623,"node_id":"MDU6SXNzdWUzMzk0MzU2MjM=","number":3673,"title":"fixture called by fixtures keep the first context ","user":{"login":"ggens","id":630434,"node_id":"MDQ6VXNlcjYzMDQzNA==","avatar_url":"https://avatars.githubusercontent.com/u/630434?v=4","gravatar_id":"","url":"https://api.github.com/users/ggens","html_url":"https://github.com/ggens","followers_url":"https://api.github.com/users/ggens/followers","following_url":"https://api.github.com/users/ggens/following{/other_user}","gists_url":"https://api.github.com/users/ggens/gists{/gist_id}","starred_url":"https://api.github.com/users/ggens/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggens/subscriptions","organizations_url":"https://api.github.com/users/ggens/orgs","repos_url":"https://api.github.com/users/ggens/repos","events_url":"https://api.github.com/users/ggens/events{/privacy}","received_events_url":"https://api.github.com/users/ggens/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":224849844,"node_id":"MDU6TGFiZWwyMjQ4NDk4NDQ=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/type:%20proposal","name":"type: proposal","color":"006b75","default":false,"description":"proposal for a new feature, often to gather opinions or design the API around the new feature"},{"id":604021555,"node_id":"MDU6TGFiZWw2MDQwMjE1NTU=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/topic:%20fixtures","name":"topic: fixtures","color":"5319e7","default":false,"description":"anything involving fixtures directly or indirectly"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2018-07-09T12:49:40Z","updated_at":"2018-07-09T22:43:02Z","closed_at":"2018-07-09T18:03:21Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":37489525,"node_id":"MDEwOlJlcG9zaXRvcnkzNzQ4OTUyNQ==","name":"pytest","full_name":"pytest-dev/pytest","private":false,"owner":{"login":"pytest-dev","id":8897583,"node_id":"MDEyOk9yZ2FuaXphdGlvbjg4OTc1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8897583?v=4","gravatar_id":"","url":"https://api.github.com/users/pytest-dev","html_url":"https://github.com/pytest-dev","followers_url":"https://api.github.com/users/pytest-dev/followers","following_url":"https://api.github.com/users/pytest-dev/following{/other_user}","gists_url":"https://api.github.com/users/pytest-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/pytest-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pytest-dev/subscriptions","organizations_url":"https://api.github.com/users/pytest-dev/orgs","repos_url":"https://api.github.com/users/pytest-dev/repos","events_url":"https://api.github.com/users/pytest-dev/events{/privacy}","received_events_url":"https://api.github.com/users/pytest-dev/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/pytest-dev/pytest","description":"The pytest framework makes it easy to write small tests, yet scales to support complex functional testing","fork":false,"url":"https://api.github.com/repos/pytest-dev/pytest","forks_url":"https://api.github.com/repos/pytest-dev/pytest/forks","keys_url":"https://api.github.com/repos/pytest-dev/pytest/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pytest-dev/pytest/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pytest-dev/pytest/teams","hooks_url":"https://api.github.com/repos/pytest-dev/pytest/hooks","issue_events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/events{/number}","events_url":"https://api.github.com/repos/pytest-dev/pytest/events","assignees_url":"https://api.github.com/repos/pytest-dev/pytest/assignees{/user}","branches_url":"https://api.github.com/repos/pytest-dev/pytest/branches{/branch}","tags_url":"https://api.github.com/repos/pytest-dev/pytest/tags","blobs_url":"https://api.github.com/repos/pytest-dev/pytest/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pytest-dev/pytest/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pytest-dev/pytest/git/refs{/sha}","trees_url":"https://api.github.com/repos/pytest-dev/pytest/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pytest-dev/pytest/statuses/{sha}","languages_url":"https://api.github.com/repos/pytest-dev/pytest/languages","stargazers_url":"https://api.github.com/repos/pytest-dev/pytest/stargazers","contributors_url":"https://api.github.com/repos/pytest-dev/pytest/contributors","subscribers_url":"https://api.github.com/repos/pytest-dev/pytest/subscribers","subscription_url":"https://api.github.com/repos/pytest-dev/pytest/subscription","commits_url":"https://api.github.com/repos/pytest-dev/pytest/commits{/sha}","git_commits_url":"https://api.github.com/repos/pytest-dev/pytest/git/commits{/sha}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/comments{/number}","issue_comment_url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments{/number}","contents_url":"https://api.github.com/repos/pytest-dev/pytest/contents/{+path}","compare_url":"https://api.github.com/repos/pytest-dev/pytest/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pytest-dev/pytest/merges","archive_url":"https://api.github.com/repos/pytest-dev/pytest/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pytest-dev/pytest/downloads","issues_url":"https://api.github.com/repos/pytest-dev/pytest/issues{/number}","pulls_url":"https://api.github.com/repos/pytest-dev/pytest/pulls{/number}","milestones_url":"https://api.github.com/repos/pytest-dev/pytest/milestones{/number}","notifications_url":"https://api.github.com/repos/pytest-dev/pytest/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pytest-dev/pytest/labels{/name}","releases_url":"https://api.github.com/repos/pytest-dev/pytest/releases{/id}","deployments_url":"https://api.github.com/repos/pytest-dev/pytest/deployments","created_at":"2015-06-15T20:28:27Z","updated_at":"2025-11-09T16:32:44Z","pushed_at":"2025-11-09T09:33:29Z","git_url":"git://github.com/pytest-dev/pytest.git","ssh_url":"git@github.com:pytest-dev/pytest.git","clone_url":"https://github.com/pytest-dev/pytest.git","svn_url":"https://github.com/pytest-dev/pytest","homepage":"https://pytest.org","size":37842,"stargazers_count":13254,"watchers_count":13254,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":2933,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":953,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","python","test","testing","unit-testing"],"visibility":"public","forks":2933,"open_issues":953,"watchers":13254,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"Hi,\r\nIn the same test after a first call, fixture save context and not executed a second time.\r\n\r\nlet's me show you issue by this exemple as below:\r\n```python\r\nimport pytest\r\n\r\n@pytest.fixture(name=\"deep_fixture\")\r\ndef fixture(request):\r\n    fixture_parent = request._parent_request.fixturename\r\n    if fixture_parent == \"fixture_1\":\r\n        return \"deep_fixture_1\"\r\n    if fixture_parent == \"fixture_2\":\r\n        return \"deep_fixture_2\"\r\n\r\n@pytest.fixture(name=\"fixture_1\")\r\ndef fixture_parent_1(request, deep_fixture):\r\n    assert deep_fixture == \"deep_fixture_1\"\r\n\r\n@pytest.fixture(name=\"fixture_2\")\r\ndef fixture_parent_2(request, deep_fixture):\r\n    assert deep_fixture == \"deep_fixture_2\"\r\n\r\ndef test_fixure_in_fixture(fixture_1 ,fixture_2):\r\n    pass\r\n```\r\nI'd the result:\r\n```console\r\n    @pytest.fixture(name=\"fixture_2\")\r\n    def fixture_parent_2(request, deep_fixture):\r\n>       assert deep_fixture == \"deep_fixture_2\"\r\nE       AssertionError: assert 'deep_fixture_1' == 'deep_fixture_2'\r\nE         - deep_fixture_1\r\nE         ?              ^\r\nE         + deep_fixture_2\r\nE         ?    \r\n```","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/3673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/3673/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"}]