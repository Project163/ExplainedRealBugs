{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/5965","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/5965/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/5965/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/5965/events","html_url":"https://github.com/pytest-dev/pytest/issues/5965","id":507385896,"node_id":"MDU6SXNzdWU1MDczODU4OTY=","number":5965,"title":"File path not correct when using drive with subst in Windows","user":{"login":"fabioz","id":117621,"node_id":"MDQ6VXNlcjExNzYyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/117621?v=4","gravatar_id":"","url":"https://api.github.com/users/fabioz","html_url":"https://github.com/fabioz","followers_url":"https://api.github.com/users/fabioz/followers","following_url":"https://api.github.com/users/fabioz/following{/other_user}","gists_url":"https://api.github.com/users/fabioz/gists{/gist_id}","starred_url":"https://api.github.com/users/fabioz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fabioz/subscriptions","organizations_url":"https://api.github.com/users/fabioz/orgs","repos_url":"https://api.github.com/users/fabioz/repos","events_url":"https://api.github.com/users/fabioz/events{/privacy}","received_events_url":"https://api.github.com/users/fabioz/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":240541592,"node_id":"MDU6TGFiZWwyNDA1NDE1OTI=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/platform:%20windows","name":"platform: windows","color":"fbca04","default":false,"description":"windows platform-specific problem"},{"id":315571544,"node_id":"MDU6TGFiZWwzMTU1NzE1NDQ=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/type:%20regression","name":"type: regression","color":"f7c6c7","default":false,"description":"indicates a problem that was introduced in a release which was working previously"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2019-10-15T17:37:06Z","updated_at":"2020-06-08T13:56:41Z","closed_at":"2020-06-08T13:56:41Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"To reproduce the issue, let's say you have a file structure such as:\r\n\r\n`c:\\temp\\somedir\\test_it.py`\r\n\r\nwith the contents:\r\n\r\n```\r\ndef test_it():\r\n    raise AssertionError(__file__)\r\n```\r\n\r\nthen, do a subst for the `c:\\temp\\somedir` to `T:`\r\n\r\ni.e.:\r\n\r\n`subst t: c:\\temp\\somedir`\r\n\r\nThen go to `T:` and run the test:\r\n\r\n```\r\ncd /D T:\r\npython -m pytest test_it.py \r\n```\r\n\r\n\r\nThe output I have when running it with `pytest 5.2.1` is:\r\n\r\n\r\n```\r\n c:\\bin\\Python37-32\\python.exe -m pytest test_it.py\r\n================================ test session starts ================================ \r\nplatform win32 -- Python 3.7.4, pytest-5.2.1, py-1.8.0, pluggy-0.13.0\r\nrootdir: C:\\temp\\somedir\r\ncollected 1 item\r\n\r\ntest_it.py F                                                                   [100%]\r\n\r\n===================================== FAILURES ====================================== \r\n______________________________________ test_it ______________________________________\r\n\r\n    def test_it():\r\n>       raise AssertionError(__file__)\r\nE       AssertionError: C:\\temp\\somedir\\test_it.py\r\n\r\nC:\\temp\\somedir\\test_it.py:3: AssertionError\r\n================================= 1 failed in 0.03s =================================\r\n```\r\n\r\n\r\nwhereas on `pytest 5.0.1` it was correct (as shown below)\r\n\r\n\r\n```\r\nc:\\bin\\Python37-32\\python.exe -m pytest test_it.py\r\n================================ test session starts ================================ \r\nplatform win32 -- Python 3.7.4, pytest-5.0.1, py-1.8.0, pluggy-0.13.0\r\nrootdir: T:\\\r\ncollected 1 item\r\n\r\ntest_it.py F                                                                   [100%]\r\n\r\n===================================== FAILURES ====================================== \r\n______________________________________ test_it ______________________________________\r\n\r\n    def test_it():\r\n>       raise AssertionError(__file__)\r\nE       AssertionError: T:\\test_it.py\r\n\r\ntest_it.py:3: AssertionError\r\n============================= 1 failed in 0.04 seconds ==============================\r\n```\r\n\r\n- [x] output of `pip list` from the virtual environment you are using\r\n\r\n```\r\nc:\\bin\\Python37-32\\python.exe -m pip list\r\nPackage            Version\r\n------------------ ----------\r\nastroid            2.3.1\r\natomicwrites       1.3.0\r\nattrs              19.3.0\r\ncertifi            2019.9.11\r\ncolorama           0.4.1\r\nimportlib-metadata 0.23\r\nisort              4.3.21\r\nlazy-object-proxy  1.4.2\r\nmccabe             0.6.1\r\nmore-itertools     7.2.0\r\npackaging          19.2\r\npip                19.2.3\r\npipenv             2018.11.26\r\npluggy             0.13.0\r\npy                 1.8.0\r\npylint             2.4.2\r\npyparsing          2.4.2\r\npytest             5.2.1\r\nsetuptools         40.8.0\r\nsix                1.12.0\r\ntyped-ast          1.4.0\r\nvirtualenv         16.7.5\r\nvirtualenv-clone   0.5.3\r\nwcwidth            0.1.7\r\nwrapt              1.11.2\r\nzipp               0.6.0\r\n```\r\n\r\n- [x] pytest and operating system versions\r\n\r\nPytest 5.2.1 has this issue. The regression was introduced in pytest 5.1.0 (i.e.: it works properly in pytest 5.0.1)\r\n\r\nOS: Windows 10\r\n\r\n\r\n","closed_by":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/5965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/5965/timeline","performed_via_github_app":null,"state_reason":"completed"}