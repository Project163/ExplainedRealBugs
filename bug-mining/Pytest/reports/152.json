{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/5626","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/5626/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/5626/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/5626/events","html_url":"https://github.com/pytest-dev/pytest/issues/5626","id":469897312,"node_id":"MDU6SXNzdWU0Njk4OTczMTI=","number":5626,"title":"pytest.PytestWarning: open() missing required argument 'flags' (pos 2)","user":{"login":"blueyed","id":9766,"node_id":"MDQ6VXNlcjk3NjY=","avatar_url":"https://avatars.githubusercontent.com/u/9766?v=4","gravatar_id":"","url":"https://api.github.com/users/blueyed","html_url":"https://github.com/blueyed","followers_url":"https://api.github.com/users/blueyed/followers","following_url":"https://api.github.com/users/blueyed/following{/other_user}","gists_url":"https://api.github.com/users/blueyed/gists{/gist_id}","starred_url":"https://api.github.com/users/blueyed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blueyed/subscriptions","organizations_url":"https://api.github.com/users/blueyed/orgs","repos_url":"https://api.github.com/users/blueyed/repos","events_url":"https://api.github.com/users/blueyed/events{/privacy}","received_events_url":"https://api.github.com/users/blueyed/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":224849193,"node_id":"MDU6TGFiZWwyMjQ4NDkxOTM=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/type:%20bug","name":"type: bug","color":"fc2929","default":false,"description":"problem that needs to be addressed"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2019-07-18T17:28:40Z","updated_at":"2019-08-02T13:23:17Z","closed_at":"2019-08-02T13:23:17Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"`force_writable_and_retry` might call `open` with missing args:\r\n\r\n```\r\n% COLUMNS=80 p --lf --pdb --tb=short --showlocals\r\n============================= test session starts ==============================\r\nplatform linux -- Python 3.7.3, pytest-4.6.1.dev186+gc9923a3a5, py-1.8.0, pluggy-0.12.0\r\nhypothesis profile 'default' -> database=DirectoryBasedExampleDatabase('…/Vcs/pytest/.hypothesis/examples')\r\nrootdir: …/Vcs/pytest, inifile: tox.ini, testpaths: testing\r\nplugins: hypothesis-4.23.8\r\ncollected 975 items / 287 deselected / 688 selected\r\nrun-last-failure: rerun previous 688 failures (skipped 150 files)\r\n\r\ntesting/acceptance_test.py E\r\n>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> traceback >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n/usr/lib/python3.7/shutil.py:423: in _rmtree_safe_fd\r\n    dirfd = os.open(entry.name, os.O_RDONLY, dir_fd=topfd)\r\nE   PermissionError: [Errno 13] Permission denied: '.pytest_cache'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\nsrc/_pytest/pathlib.py:68: in force_writable_and_retry\r\n    function(str(p))\r\nE   TypeError: open() missing required argument 'flags' (pos 2)\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n/usr/lib/python3.7/shutil.py:491: in rmtree\r\n    _rmtree_safe_fd(fd, path, onerror)\r\n/usr/lib/python3.7/shutil.py:429: in _rmtree_safe_fd\r\n    _rmtree_safe_fd(dirfd, fullname, onerror)\r\n/usr/lib/python3.7/shutil.py:425: in _rmtree_safe_fd\r\n    onerror(os.open, fullname, sys.exc_info())\r\nE   pytest.PytestWarning: (rm_rf) error removing /tmp/pytest-of-user/garbage-6af7e2cc-af3d-4612-8e51-ba8b1e27ff9f/test_cache_failure_warns0/.pytest_cache: open() missing required argument 'flags' (pos 2)\r\n>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> entering PDB >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\r\n\r\n>>>>>>>>>>>>>>>>>> PDB post_mortem (IO-capturing turned off) >>>>>>>>>>>>>>>>>>>\r\n[32] > …/Vcs/pytest/src/_pytest/pathlib.py(70)force_writable_and_retry()\r\n-> warnings.warn(PytestWarning(\"(rm_rf) error removing {}: {}\".format(p, e)))\r\n   6 frames hidden (try 'help hidden_frames')\r\n(Pdb++) l\r\n 65             chmod_w(p)\r\n 66             try:\r\n 67                 # retry the function that failed\r\n 68                 function(str(p))\r\n 69             except Exception as e:\r\n 70  ->             warnings.warn(PytestWarning(\"(rm_rf) error removing {}: {}\".format(p, e)))\r\n 71\r\n 72         shutil.rmtree(str(path), onerror=force_writable_and_retry)\r\n 73\r\n 74\r\n 75     def find_prefixed(root, prefix):\r\n(Pdb++) p\r\nPosixPath('/tmp/pytest-of-user/garbage-6af7e2cc-af3d-4612-8e51-ba8b1e27ff9f/test_cache_failure_warns0/.pytest_cache')\r\n(Pdb++) function\r\n<built-in function open>\r\n(Pdb++) excinfo\r\n(<class 'PermissionError'>, PermissionError(13, 'Permission denied'), <traceback object at 0x7fc214c2dd08>)\r\n```\r\n","closed_by":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/5626/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/5626/timeline","performed_via_github_app":null,"state_reason":"completed"}