[{"id":3786015828,"node_id":"MDEyOkxhYmVsZWRFdmVudDM3ODYwMTU4Mjg=","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/3786015828","actor":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-09-20T11:24:02Z","label":{"name":"topic: collection","color":"006b75"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/695796946","html_url":"https://github.com/pytest-dev/pytest/issues/7777#issuecomment-695796946","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/7777","id":695796946,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NTc5Njk0Ng==","user":{"login":"RonnyPfannschmidt","id":156838,"node_id":"MDQ6VXNlcjE1NjgzOA==","avatar_url":"https://avatars.githubusercontent.com/u/156838?v=4","gravatar_id":"","url":"https://api.github.com/users/RonnyPfannschmidt","html_url":"https://github.com/RonnyPfannschmidt","followers_url":"https://api.github.com/users/RonnyPfannschmidt/followers","following_url":"https://api.github.com/users/RonnyPfannschmidt/following{/other_user}","gists_url":"https://api.github.com/users/RonnyPfannschmidt/gists{/gist_id}","starred_url":"https://api.github.com/users/RonnyPfannschmidt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RonnyPfannschmidt/subscriptions","organizations_url":"https://api.github.com/users/RonnyPfannschmidt/orgs","repos_url":"https://api.github.com/users/RonnyPfannschmidt/repos","events_url":"https://api.github.com/users/RonnyPfannschmidt/events{/privacy}","received_events_url":"https://api.github.com/users/RonnyPfannschmidt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-20T15:00:53Z","updated_at":"2020-09-20T15:00:53Z","body":"I'd like to have a more detailed discussion about structuring the collection tree, we accrued a mess that requires some decomposition to begin with ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/695796946/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"RonnyPfannschmidt","id":156838,"node_id":"MDQ6VXNlcjE1NjgzOA==","avatar_url":"https://avatars.githubusercontent.com/u/156838?v=4","gravatar_id":"","url":"https://api.github.com/users/RonnyPfannschmidt","html_url":"https://github.com/RonnyPfannschmidt","followers_url":"https://api.github.com/users/RonnyPfannschmidt/followers","following_url":"https://api.github.com/users/RonnyPfannschmidt/following{/other_user}","gists_url":"https://api.github.com/users/RonnyPfannschmidt/gists{/gist_id}","starred_url":"https://api.github.com/users/RonnyPfannschmidt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RonnyPfannschmidt/subscriptions","organizations_url":"https://api.github.com/users/RonnyPfannschmidt/orgs","repos_url":"https://api.github.com/users/RonnyPfannschmidt/repos","events_url":"https://api.github.com/users/RonnyPfannschmidt/events{/privacy}","received_events_url":"https://api.github.com/users/RonnyPfannschmidt/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/699498215","html_url":"https://github.com/pytest-dev/pytest/issues/7777#issuecomment-699498215","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/7777","id":699498215,"node_id":"MDEyOklzc3VlQ29tbWVudDY5OTQ5ODIxNQ==","user":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-26T13:51:35Z","updated_at":"2020-09-26T13:51:35Z","body":"Thanks @bluetech for putting up this detailed description.\r\n\r\nIndeed the Package node was not thought through before being included, and I'm at fault for not giving the attention it deserved at the time.\r\n\r\n> Evidently the nesting is not super important, otherwise we would have heard loud complaints by now (though there are some issues about this). But the nesting does have an effect on how package-scope fixtures are applied - reuse from super-package or not?\r\n\r\nI think packages should be nested, just like the other nodes. I'm surprised that no one noticed this inconsistency before (including myself). Then package-scoped fixtures follow the normal rules that other fixtures follow.\r\n\r\nThe question about namespace packages unfortunately is not that simple. Besides being a pain to detect at runtime (at least that I recall the discussions around that subject), we need to wonder how they would be represented given that in the same namespace package, sub-packages might be located in completely different directories, and the collection tree is directory-based. In other words, in your example if we collect `a/b/c` as a namespace package, what happens if some other `c/foo` package exists in a directory outside of the collection root `a`?\r\n\r\nI think however we can postpone what to do with namespace packages to some other time, and focus on natural packages (those with `__init__.py`) instead for now.\r\n\r\n> I'd like to have a more detailed discussion about structuring the collection tree, we accrued a mess that requires some decomposition to begin with\r\n\r\nGood idea @RonnyPfannschmidt. You want to do that here or somewhere else? I think here is fine IMHO. \r\n\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/699498215/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3810790356,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzgxMDc5MDM1Ng==","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/3810790356","actor":{"login":"RonnyPfannschmidt","id":156838,"node_id":"MDQ6VXNlcjE1NjgzOA==","avatar_url":"https://avatars.githubusercontent.com/u/156838?v=4","gravatar_id":"","url":"https://api.github.com/users/RonnyPfannschmidt","html_url":"https://github.com/RonnyPfannschmidt","followers_url":"https://api.github.com/users/RonnyPfannschmidt/followers","following_url":"https://api.github.com/users/RonnyPfannschmidt/following{/other_user}","gists_url":"https://api.github.com/users/RonnyPfannschmidt/gists{/gist_id}","starred_url":"https://api.github.com/users/RonnyPfannschmidt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RonnyPfannschmidt/subscriptions","organizations_url":"https://api.github.com/users/RonnyPfannschmidt/orgs","repos_url":"https://api.github.com/users/RonnyPfannschmidt/repos","events_url":"https://api.github.com/users/RonnyPfannschmidt/events{/privacy}","received_events_url":"https://api.github.com/users/RonnyPfannschmidt/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-09-26T13:51:36Z","performed_via_github_app":null},{"id":3810790359,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM4MTA3OTAzNTk=","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/3810790359","actor":{"login":"RonnyPfannschmidt","id":156838,"node_id":"MDQ6VXNlcjE1NjgzOA==","avatar_url":"https://avatars.githubusercontent.com/u/156838?v=4","gravatar_id":"","url":"https://api.github.com/users/RonnyPfannschmidt","html_url":"https://github.com/RonnyPfannschmidt","followers_url":"https://api.github.com/users/RonnyPfannschmidt/followers","following_url":"https://api.github.com/users/RonnyPfannschmidt/following{/other_user}","gists_url":"https://api.github.com/users/RonnyPfannschmidt/gists{/gist_id}","starred_url":"https://api.github.com/users/RonnyPfannschmidt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RonnyPfannschmidt/subscriptions","organizations_url":"https://api.github.com/users/RonnyPfannschmidt/orgs","repos_url":"https://api.github.com/users/RonnyPfannschmidt/repos","events_url":"https://api.github.com/users/RonnyPfannschmidt/events{/privacy}","received_events_url":"https://api.github.com/users/RonnyPfannschmidt/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-09-26T13:51:36Z","performed_via_github_app":null},{"id":3810790363,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzgxMDc5MDM2Mw==","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/3810790363","actor":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-09-26T13:51:36Z","performed_via_github_app":null},{"id":3810790365,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM4MTA3OTAzNjU=","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/3810790365","actor":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-09-26T13:51:36Z","performed_via_github_app":null},{"actor":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-29T07:54:18Z","updated_at":"2020-12-29T07:54:18Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/8189","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/8189/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/8189/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/8189/events","html_url":"https://github.com/pytest-dev/pytest/issues/8189","id":773975189,"node_id":"MDU6SXNzdWU3NzM5NzUxODk=","number":8189,"title":"Package scoped fixture will not execute teardown ","user":{"login":"hennadii-demchenko","id":2227305,"node_id":"MDQ6VXNlcjIyMjczMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2227305?v=4","gravatar_id":"","url":"https://api.github.com/users/hennadii-demchenko","html_url":"https://github.com/hennadii-demchenko","followers_url":"https://api.github.com/users/hennadii-demchenko/followers","following_url":"https://api.github.com/users/hennadii-demchenko/following{/other_user}","gists_url":"https://api.github.com/users/hennadii-demchenko/gists{/gist_id}","starred_url":"https://api.github.com/users/hennadii-demchenko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hennadii-demchenko/subscriptions","organizations_url":"https://api.github.com/users/hennadii-demchenko/orgs","repos_url":"https://api.github.com/users/hennadii-demchenko/repos","events_url":"https://api.github.com/users/hennadii-demchenko/events{/privacy}","received_events_url":"https://api.github.com/users/hennadii-demchenko/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":224849193,"node_id":"MDU6TGFiZWwyMjQ4NDkxOTM=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/type:%20bug","name":"type: bug","color":"fc2929","default":false,"description":"problem that needs to be addressed"},{"id":224849196,"node_id":"MDU6TGFiZWwyMjQ4NDkxOTY=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/status:%20help%20wanted","name":"status: help wanted","color":"159818","default":false,"description":"developers would like help from experts on this topic"},{"id":604021555,"node_id":"MDU6TGFiZWw2MDQwMjE1NTU=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/topic:%20fixtures","name":"topic: fixtures","color":"5319e7","default":false,"description":"anything involving fixtures directly or indirectly"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":21,"created_at":"2020-12-23T18:27:45Z","updated_at":"2024-06-13T14:19:12Z","closed_at":null,"author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":37489525,"node_id":"MDEwOlJlcG9zaXRvcnkzNzQ4OTUyNQ==","name":"pytest","full_name":"pytest-dev/pytest","private":false,"owner":{"login":"pytest-dev","id":8897583,"node_id":"MDEyOk9yZ2FuaXphdGlvbjg4OTc1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8897583?v=4","gravatar_id":"","url":"https://api.github.com/users/pytest-dev","html_url":"https://github.com/pytest-dev","followers_url":"https://api.github.com/users/pytest-dev/followers","following_url":"https://api.github.com/users/pytest-dev/following{/other_user}","gists_url":"https://api.github.com/users/pytest-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/pytest-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pytest-dev/subscriptions","organizations_url":"https://api.github.com/users/pytest-dev/orgs","repos_url":"https://api.github.com/users/pytest-dev/repos","events_url":"https://api.github.com/users/pytest-dev/events{/privacy}","received_events_url":"https://api.github.com/users/pytest-dev/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/pytest-dev/pytest","description":"The pytest framework makes it easy to write small tests, yet scales to support complex functional testing","fork":false,"url":"https://api.github.com/repos/pytest-dev/pytest","forks_url":"https://api.github.com/repos/pytest-dev/pytest/forks","keys_url":"https://api.github.com/repos/pytest-dev/pytest/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pytest-dev/pytest/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pytest-dev/pytest/teams","hooks_url":"https://api.github.com/repos/pytest-dev/pytest/hooks","issue_events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/events{/number}","events_url":"https://api.github.com/repos/pytest-dev/pytest/events","assignees_url":"https://api.github.com/repos/pytest-dev/pytest/assignees{/user}","branches_url":"https://api.github.com/repos/pytest-dev/pytest/branches{/branch}","tags_url":"https://api.github.com/repos/pytest-dev/pytest/tags","blobs_url":"https://api.github.com/repos/pytest-dev/pytest/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pytest-dev/pytest/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pytest-dev/pytest/git/refs{/sha}","trees_url":"https://api.github.com/repos/pytest-dev/pytest/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pytest-dev/pytest/statuses/{sha}","languages_url":"https://api.github.com/repos/pytest-dev/pytest/languages","stargazers_url":"https://api.github.com/repos/pytest-dev/pytest/stargazers","contributors_url":"https://api.github.com/repos/pytest-dev/pytest/contributors","subscribers_url":"https://api.github.com/repos/pytest-dev/pytest/subscribers","subscription_url":"https://api.github.com/repos/pytest-dev/pytest/subscription","commits_url":"https://api.github.com/repos/pytest-dev/pytest/commits{/sha}","git_commits_url":"https://api.github.com/repos/pytest-dev/pytest/git/commits{/sha}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/comments{/number}","issue_comment_url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments{/number}","contents_url":"https://api.github.com/repos/pytest-dev/pytest/contents/{+path}","compare_url":"https://api.github.com/repos/pytest-dev/pytest/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pytest-dev/pytest/merges","archive_url":"https://api.github.com/repos/pytest-dev/pytest/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pytest-dev/pytest/downloads","issues_url":"https://api.github.com/repos/pytest-dev/pytest/issues{/number}","pulls_url":"https://api.github.com/repos/pytest-dev/pytest/pulls{/number}","milestones_url":"https://api.github.com/repos/pytest-dev/pytest/milestones{/number}","notifications_url":"https://api.github.com/repos/pytest-dev/pytest/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pytest-dev/pytest/labels{/name}","releases_url":"https://api.github.com/repos/pytest-dev/pytest/releases{/id}","deployments_url":"https://api.github.com/repos/pytest-dev/pytest/deployments","created_at":"2015-06-15T20:28:27Z","updated_at":"2025-11-09T16:32:44Z","pushed_at":"2025-11-09T09:33:29Z","git_url":"git://github.com/pytest-dev/pytest.git","ssh_url":"git@github.com:pytest-dev/pytest.git","clone_url":"https://github.com/pytest-dev/pytest.git","svn_url":"https://github.com/pytest-dev/pytest","homepage":"https://pytest.org","size":37842,"stargazers_count":13254,"watchers_count":13254,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":2933,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":953,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","python","test","testing","unit-testing"],"visibility":"public","forks":2933,"open_issues":953,"watchers":13254,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"I am experiencing a weird issue:\r\n'package' scoped fixture will not execute teardown after last test in package is completed if afformentioned fixture is defined outside of package\r\n\r\n**Environment**\r\n```\r\n~ python --version\r\nPython 3.8.5\r\n\r\n~ pip freeze\r\nallure-pytest==2.8.24\r\nallure-python-commons==2.8.24\r\nassertpy==1.1\r\nattrdict==2.0.1\r\nattrs==20.3.0\r\nbcrypt==3.2.0\r\ncffi==1.14.4\r\ncryptography==3.2.1\r\ncycler==0.10.0\r\nfuture==0.18.2\r\niniconfig==1.1.1\r\nkiwisolver==1.3.1\r\nmatplotlib==3.3.3\r\nmininet==2.3.0.dev6\r\nmore-itertools==8.6.0\r\nnumpy==1.19.4\r\npackaging==20.7\r\nparamiko==2.7.2\r\npexpect==4.8.0\r\npexpect-serial==0.1.0\r\nPillow==8.0.1\r\npluggy==0.13.1\r\nptyprocess==0.6.0\r\npy==1.9.0\r\npycparser==2.20\r\nPyNaCl==1.4.0\r\npyparsing==2.4.7\r\nPypubsub==4.0.3\r\npyserial==3.5\r\npytest==6.2.1\r\npytest-dependency==0.5.1\r\npytest-logger==0.5.1\r\npytest-sugar==0.9.4\r\npython-dateutil==2.8.1\r\nPyYAML==5.3.1\r\nsingleton-decorator==1.0.0\r\nsix==1.15.0\r\ntermcolor==1.1.0\r\ntoml==0.10.2\r\nwcwidth==0.2.5\r\n\r\n~ uname -a \r\n5.4.0-58-generic #64-Ubuntu SMP Wed Dec 9 08:16:25 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\r\n```\r\n\r\n**Example to reproduce**\r\n```\r\n~ tree test\r\ntest\r\n├── __init__.py\r\n├── conftest.py\r\n├── sub1\r\n│   └── __init__.py\r\n│   └── test_foo.py\r\n└── sub2\r\n    └── __init__.py\r\n    └── test_bar.py\r\n2 directories, 3 files\r\n\r\n~ cat test/conftest.py\r\nimport pytest\r\n\r\n@pytest.fixture(scope='package')\r\ndef package_scoped():\r\n    print('setup')\r\n    yield\r\n    print('teardown')\r\n\r\n~ cat test/sub1/test_foo.py\r\ndef test_foo(package_scoped): pass\r\n\r\n~ cat test/sub2/test_bar.py\r\ndef test_foo(package_scoped): pass\r\n```\r\n\r\n**Result**\r\n```\r\n~ pytest test --setup-plan -p no:sugar\r\n=============== test session starts ===============\r\nplatform linux -- Python 3.8.5, pytest-6.2.1, py-1.9.0, pluggy-0.13.1\r\nrootdir: /home/hdemchenko/git/uns\r\nplugins: dependency-0.5.1, logger-0.5.1, allure-pytest-2.8.24\r\ncollected 2 items\r\n\r\ntest/sub1/test_foo.py\r\n  SETUP    P package_scoped\r\n        test/sub1/test_foo.py::test_foo (fixtures used: package_scoped)\r\ntest/sub2/test_bar.py\r\n        test/sub2/test_bar.py::test_foo (fixtures used: package_scoped)\r\n  TEARDOWN P package_scoped\r\n\r\n=============== no tests ran in 0.01s ===============\r\n```\r\n\r\nIf I create two conftest files in each package with the package scoped fixture I intend to use then I can see it behaving as I was expecting.\r\nExample:\r\n```\r\n~ mv test/conftest.py test/sub1/\r\n~ cp test/sub1/conftest.py test/sub2/\r\n~ pytest test --setup-plan -p no:sugar\r\n=============== test session starts ===============\r\nplatform linux -- Python 3.8.5, pytest-6.2.1, py-1.9.0, pluggy-0.13.1\r\nrootdir: /home/hdemchenko/git/uns\r\nplugins: dependency-0.5.1, logger-0.5.1, allure-pytest-2.8.24\r\ncollected 2 items\r\n\r\ntest/sub1/test_foo.py\r\n  SETUP    P package_scoped\r\n        test/sub1/test_foo.py::test_foo (fixtures used: package_scoped)\r\n  TEARDOWN P package_scoped\r\ntest/sub2/test_bar.py\r\n  SETUP    P package_scoped\r\n        test/sub2/test_bar.py::test_foo (fixtures used: package_scoped)\r\n  TEARDOWN P package_scoped\r\n\r\n=============== no tests ran in 0.01s ===============\r\n```","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/8189/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/8189/timeline","performed_via_github_app":null,"state_reason":"reopened"}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1089441454","html_url":"https://github.com/pytest-dev/pytest/issues/7777#issuecomment-1089441454","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/7777","id":1089441454,"node_id":"IC_kwDOAjwLdc5A746u","user":{"login":"MarximusMaximus","id":94208961,"node_id":"U_kgDOBZ2DwQ","avatar_url":"https://avatars.githubusercontent.com/u/94208961?v=4","gravatar_id":"","url":"https://api.github.com/users/MarximusMaximus","html_url":"https://github.com/MarximusMaximus","followers_url":"https://api.github.com/users/MarximusMaximus/followers","following_url":"https://api.github.com/users/MarximusMaximus/following{/other_user}","gists_url":"https://api.github.com/users/MarximusMaximus/gists{/gist_id}","starred_url":"https://api.github.com/users/MarximusMaximus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MarximusMaximus/subscriptions","organizations_url":"https://api.github.com/users/MarximusMaximus/orgs","repos_url":"https://api.github.com/users/MarximusMaximus/repos","events_url":"https://api.github.com/users/MarximusMaximus/events{/privacy}","received_events_url":"https://api.github.com/users/MarximusMaximus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T22:23:10Z","updated_at":"2022-04-05T22:23:10Z","body":"Found this issue while trying to figure out why my nested test packages all report as top level packages. I, for one, if I went through the trouble to nest them, I want them to be nested when reported. Is there a way to force that to happen right now for my situation as a workaround? I've tried so many things that I'm at a loss.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1089441454/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MarximusMaximus","id":94208961,"node_id":"U_kgDOBZ2DwQ","avatar_url":"https://avatars.githubusercontent.com/u/94208961?v=4","gravatar_id":"","url":"https://api.github.com/users/MarximusMaximus","html_url":"https://github.com/MarximusMaximus","followers_url":"https://api.github.com/users/MarximusMaximus/followers","following_url":"https://api.github.com/users/MarximusMaximus/following{/other_user}","gists_url":"https://api.github.com/users/MarximusMaximus/gists{/gist_id}","starred_url":"https://api.github.com/users/MarximusMaximus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MarximusMaximus/subscriptions","organizations_url":"https://api.github.com/users/MarximusMaximus/orgs","repos_url":"https://api.github.com/users/MarximusMaximus/repos","events_url":"https://api.github.com/users/MarximusMaximus/events{/privacy}","received_events_url":"https://api.github.com/users/MarximusMaximus/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1112715877","html_url":"https://github.com/pytest-dev/pytest/issues/7777#issuecomment-1112715877","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/7777","id":1112715877,"node_id":"IC_kwDOAjwLdc5CUrJl","user":{"login":"MarximusMaximus","id":94208961,"node_id":"U_kgDOBZ2DwQ","avatar_url":"https://avatars.githubusercontent.com/u/94208961?v=4","gravatar_id":"","url":"https://api.github.com/users/MarximusMaximus","html_url":"https://github.com/MarximusMaximus","followers_url":"https://api.github.com/users/MarximusMaximus/followers","following_url":"https://api.github.com/users/MarximusMaximus/following{/other_user}","gists_url":"https://api.github.com/users/MarximusMaximus/gists{/gist_id}","starred_url":"https://api.github.com/users/MarximusMaximus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MarximusMaximus/subscriptions","organizations_url":"https://api.github.com/users/MarximusMaximus/orgs","repos_url":"https://api.github.com/users/MarximusMaximus/repos","events_url":"https://api.github.com/users/MarximusMaximus/events{/privacy}","received_events_url":"https://api.github.com/users/MarximusMaximus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-28T22:35:02Z","updated_at":"2022-04-28T22:35:02Z","body":"> Found this issue while trying to figure out why my nested test packages all report as top level packages. I, for one, if I went through the trouble to nest them, I want them to be nested when reported. Is there a way to force that to happen right now for my situation as a workaround? I've tried so many things that I'm at a loss.\r\n\r\nOk, so I wrote a plugin as a workaround for what I needed since I couldn't find anything else. Code is MIT license.\r\nPyPI: https://pypi.org/project/pytest-prefer-nested-dup-tests/\r\ngithub: https://github.com/MarximusMaximus/pytest-prefer-nested-dup-tests\r\n\r\nHopefully it's useful to other people!","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1112715877/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MarximusMaximus","id":94208961,"node_id":"U_kgDOBZ2DwQ","avatar_url":"https://avatars.githubusercontent.com/u/94208961?v=4","gravatar_id":"","url":"https://api.github.com/users/MarximusMaximus","html_url":"https://github.com/MarximusMaximus","followers_url":"https://api.github.com/users/MarximusMaximus/followers","following_url":"https://api.github.com/users/MarximusMaximus/following{/other_user}","gists_url":"https://api.github.com/users/MarximusMaximus/gists{/gist_id}","starred_url":"https://api.github.com/users/MarximusMaximus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MarximusMaximus/subscriptions","organizations_url":"https://api.github.com/users/MarximusMaximus/orgs","repos_url":"https://api.github.com/users/MarximusMaximus/repos","events_url":"https://api.github.com/users/MarximusMaximus/events{/privacy}","received_events_url":"https://api.github.com/users/MarximusMaximus/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1555963294","html_url":"https://github.com/pytest-dev/pytest/issues/7777#issuecomment-1555963294","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/7777","id":1555963294,"node_id":"IC_kwDOAjwLdc5cvh2e","user":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T18:04:22Z","updated_at":"2023-05-20T18:04:22Z","body":"### Possible Plan\r\n\r\nLooked at this again.\r\n\r\nThe main trouble here stems from the fact that we have two recursive collectors -- `Session` and `Package` -- which step on each other toes in unexpected ways, and it's very hard to fix.\r\n\r\nI'm increasingly convinced that we shouldn't have *any* recursive collector. *Huh*? Well, if you think about it, we already have a concept to handle the recursion for us -- the collection tree. The collectors are already recursively expanded on their own, that is, a `Collector` can collect other `Collector`s, which are then collected themselves, etc. until we get only `Item`s (for reference, see [`Session.genitems`](https://github.com/pytest-dev/pytest/blob/9fa82598a96ce28013630a45ef4af0074f73f944/src/_pytest/main.py#L823-L836), which is literally implemented with simple recursion).\r\n\r\nWhat does it mean in practice? At a high level:\r\n\r\n- Introduce a new `Directory` collector node.\r\n- Remove recursion (filesystem walking) from `Session` and `Package`.\r\n- A directory is collected like this: if the directory contains an `__init__.py` file, create a `Package`, otherwise a `Directory`.\r\n- `Session` collects directories from the collection arguments (paths given on the command line/`testpaths`).\r\n- `Package` and `Directory` collect like this: scan their directory: if the entry is a file, collect it like today; if it's a directory, collect it like as above.\r\n\r\nThis looks like this:\r\n\r\n```\r\n<Session>\r\n    <Package a>\r\n        <Package b>\r\n            <Directory c>\r\n                <Package d>\r\n                    <Module test_d.py>\r\n                        <Function test_d>\r\n                <Module test_c.py>\r\n                    <Function test_c>\r\n            <Module test_b.py>\r\n                <Function test_b>\r\n        <Package b2>\r\n            <Module test_b2.py>\r\n                <Function test_b2>\r\n        <Module test_a.py>\r\n            <Function test_a>\r\n```\r\n\r\nSome points:\r\n\r\n- `<Directory c>` is what I call a \"graft\" - a non-package directory inside of a package directory. There are two options: nest it under `<Package b>`, or nest it directly under `Session` as an independent sub-tree. This mostly has implications for `package` scope fixtures.\r\n\r\n- Seems like in very old versions of `pytest` there existed a `Directory` node, but it was removed in 6dac77433eb139247f94ac07c6caf6784b341a70. It's too hard to try and figure out why unfortunately.\r\n\r\n- One thing I need to think about is *file* collection arguments (i.e. `pytest foo/bar/test_it.py`). We need to have collection nodes for `foo` and `foo/bar` in this case (be they `Directory`s or `Package`s), but ignore irrelevant paths (e.g. `foo/test_baz.py`). This is currently handled by `Session`, but can't be under the new scheme (I think. Maybe the \"matchnodes\" mechanism is good enough for this).\r\n\r\n- This will have to go in a major release as a breaking change.\r\n\r\nI have a very simple POC implementation, but there are a bunch of details to figure out. Interested to hear opinions. I vaguely remember @RonnyPfannschmidt mentioned a `Directory` node, but I can't find it and might be misremembering.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1555963294/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":9294798039,"node_id":"MEE_lADOAjwLdc4qBtuwzwAAAAIqA1zX","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/9294798039","actor":{"login":"RonnyPfannschmidt","id":156838,"node_id":"MDQ6VXNlcjE1NjgzOA==","avatar_url":"https://avatars.githubusercontent.com/u/156838?v=4","gravatar_id":"","url":"https://api.github.com/users/RonnyPfannschmidt","html_url":"https://github.com/RonnyPfannschmidt","followers_url":"https://api.github.com/users/RonnyPfannschmidt/followers","following_url":"https://api.github.com/users/RonnyPfannschmidt/following{/other_user}","gists_url":"https://api.github.com/users/RonnyPfannschmidt/gists{/gist_id}","starred_url":"https://api.github.com/users/RonnyPfannschmidt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RonnyPfannschmidt/subscriptions","organizations_url":"https://api.github.com/users/RonnyPfannschmidt/orgs","repos_url":"https://api.github.com/users/RonnyPfannschmidt/repos","events_url":"https://api.github.com/users/RonnyPfannschmidt/events{/privacy}","received_events_url":"https://api.github.com/users/RonnyPfannschmidt/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-05-20T18:04:22Z","performed_via_github_app":null},{"id":9294798043,"node_id":"SE_lADOAjwLdc4qBtuwzwAAAAIqA1zb","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/9294798043","actor":{"login":"RonnyPfannschmidt","id":156838,"node_id":"MDQ6VXNlcjE1NjgzOA==","avatar_url":"https://avatars.githubusercontent.com/u/156838?v=4","gravatar_id":"","url":"https://api.github.com/users/RonnyPfannschmidt","html_url":"https://github.com/RonnyPfannschmidt","followers_url":"https://api.github.com/users/RonnyPfannschmidt/followers","following_url":"https://api.github.com/users/RonnyPfannschmidt/following{/other_user}","gists_url":"https://api.github.com/users/RonnyPfannschmidt/gists{/gist_id}","starred_url":"https://api.github.com/users/RonnyPfannschmidt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RonnyPfannschmidt/subscriptions","organizations_url":"https://api.github.com/users/RonnyPfannschmidt/orgs","repos_url":"https://api.github.com/users/RonnyPfannschmidt/repos","events_url":"https://api.github.com/users/RonnyPfannschmidt/events{/privacy}","received_events_url":"https://api.github.com/users/RonnyPfannschmidt/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-05-20T18:04:22Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1555964280","html_url":"https://github.com/pytest-dev/pytest/issues/7777#issuecomment-1555964280","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/7777","id":1555964280,"node_id":"IC_kwDOAjwLdc5cviF4","user":{"login":"RonnyPfannschmidt","id":156838,"node_id":"MDQ6VXNlcjE1NjgzOA==","avatar_url":"https://avatars.githubusercontent.com/u/156838?v=4","gravatar_id":"","url":"https://api.github.com/users/RonnyPfannschmidt","html_url":"https://github.com/RonnyPfannschmidt","followers_url":"https://api.github.com/users/RonnyPfannschmidt/followers","following_url":"https://api.github.com/users/RonnyPfannschmidt/following{/other_user}","gists_url":"https://api.github.com/users/RonnyPfannschmidt/gists{/gist_id}","starred_url":"https://api.github.com/users/RonnyPfannschmidt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RonnyPfannschmidt/subscriptions","organizations_url":"https://api.github.com/users/RonnyPfannschmidt/orgs","repos_url":"https://api.github.com/users/RonnyPfannschmidt/repos","events_url":"https://api.github.com/users/RonnyPfannschmidt/events{/privacy}","received_events_url":"https://api.github.com/users/RonnyPfannschmidt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T18:09:57Z","updated_at":"2023-05-20T18:09:57Z","body":"It's been more than a decade, that directory node existed\n\nIt was undone for good reasons, but I think it is reasonable to reintroduce it ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1555964280/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"RonnyPfannschmidt","id":156838,"node_id":"MDQ6VXNlcjE1NjgzOA==","avatar_url":"https://avatars.githubusercontent.com/u/156838?v=4","gravatar_id":"","url":"https://api.github.com/users/RonnyPfannschmidt","html_url":"https://github.com/RonnyPfannschmidt","followers_url":"https://api.github.com/users/RonnyPfannschmidt/followers","following_url":"https://api.github.com/users/RonnyPfannschmidt/following{/other_user}","gists_url":"https://api.github.com/users/RonnyPfannschmidt/gists{/gist_id}","starred_url":"https://api.github.com/users/RonnyPfannschmidt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RonnyPfannschmidt/subscriptions","organizations_url":"https://api.github.com/users/RonnyPfannschmidt/orgs","repos_url":"https://api.github.com/users/RonnyPfannschmidt/repos","events_url":"https://api.github.com/users/RonnyPfannschmidt/events{/privacy}","received_events_url":"https://api.github.com/users/RonnyPfannschmidt/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1555966541","html_url":"https://github.com/pytest-dev/pytest/issues/7777#issuecomment-1555966541","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/7777","id":1555966541,"node_id":"IC_kwDOAjwLdc5cvipN","user":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T18:22:49Z","updated_at":"2023-05-20T18:22:49Z","body":"> It was undone for good reasons\r\n\r\nDo you remember what they were? I do suspect there is some issue here; the Directory solution is pretty natural and harmonious with the entire collection tree concept, that I'm sure it's been tried. If there's something fundamental I'm sure I'll run into it eventually but sooner is better than later :)","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1555966541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1555968040","html_url":"https://github.com/pytest-dev/pytest/issues/7777#issuecomment-1555968040","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/7777","id":1555968040,"node_id":"IC_kwDOAjwLdc5cvjAo","user":{"login":"RonnyPfannschmidt","id":156838,"node_id":"MDQ6VXNlcjE1NjgzOA==","avatar_url":"https://avatars.githubusercontent.com/u/156838?v=4","gravatar_id":"","url":"https://api.github.com/users/RonnyPfannschmidt","html_url":"https://github.com/RonnyPfannschmidt","followers_url":"https://api.github.com/users/RonnyPfannschmidt/followers","following_url":"https://api.github.com/users/RonnyPfannschmidt/following{/other_user}","gists_url":"https://api.github.com/users/RonnyPfannschmidt/gists{/gist_id}","starred_url":"https://api.github.com/users/RonnyPfannschmidt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RonnyPfannschmidt/subscriptions","organizations_url":"https://api.github.com/users/RonnyPfannschmidt/orgs","repos_url":"https://api.github.com/users/RonnyPfannschmidt/repos","events_url":"https://api.github.com/users/RonnyPfannschmidt/events{/privacy}","received_events_url":"https://api.github.com/users/RonnyPfannschmidt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T18:31:57Z","updated_at":"2023-05-20T18:31:57Z","body":"Pytest prior to the refactoring back then had no concept of separation of test running and test execution\n\nTests where executed as found\n\nWhile changing the details, it was simpler to do collect towards if there where only files and session ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1555968040/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"RonnyPfannschmidt","id":156838,"node_id":"MDQ6VXNlcjE1NjgzOA==","avatar_url":"https://avatars.githubusercontent.com/u/156838?v=4","gravatar_id":"","url":"https://api.github.com/users/RonnyPfannschmidt","html_url":"https://github.com/RonnyPfannschmidt","followers_url":"https://api.github.com/users/RonnyPfannschmidt/followers","following_url":"https://api.github.com/users/RonnyPfannschmidt/following{/other_user}","gists_url":"https://api.github.com/users/RonnyPfannschmidt/gists{/gist_id}","starred_url":"https://api.github.com/users/RonnyPfannschmidt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RonnyPfannschmidt/subscriptions","organizations_url":"https://api.github.com/users/RonnyPfannschmidt/orgs","repos_url":"https://api.github.com/users/RonnyPfannschmidt/repos","events_url":"https://api.github.com/users/RonnyPfannschmidt/events{/privacy}","received_events_url":"https://api.github.com/users/RonnyPfannschmidt/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1556060396","html_url":"https://github.com/pytest-dev/pytest/issues/7777#issuecomment-1556060396","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/7777","id":1556060396,"node_id":"IC_kwDOAjwLdc5cv5js","user":{"login":"MarximusMaximus","id":94208961,"node_id":"U_kgDOBZ2DwQ","avatar_url":"https://avatars.githubusercontent.com/u/94208961?v=4","gravatar_id":"","url":"https://api.github.com/users/MarximusMaximus","html_url":"https://github.com/MarximusMaximus","followers_url":"https://api.github.com/users/MarximusMaximus/followers","following_url":"https://api.github.com/users/MarximusMaximus/following{/other_user}","gists_url":"https://api.github.com/users/MarximusMaximus/gists{/gist_id}","starred_url":"https://api.github.com/users/MarximusMaximus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MarximusMaximus/subscriptions","organizations_url":"https://api.github.com/users/MarximusMaximus/orgs","repos_url":"https://api.github.com/users/MarximusMaximus/repos","events_url":"https://api.github.com/users/MarximusMaximus/events{/privacy}","received_events_url":"https://api.github.com/users/MarximusMaximus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-21T01:42:08Z","updated_at":"2023-05-21T01:42:08Z","body":"Suggestion regarding the design above: Directory nodes wrap Packages that are not inside other Packages, such as:\r\n\r\n```\r\n<Session>\r\n    <Directory a>\r\n        <Package a>\r\n            <Package b>\r\n                <Directory c>\r\n                    <Package d>\r\n                        <Module test_d.py>\r\n                            <Function test_d>\r\n                    <Module test_c.py>\r\n                        <Function test_c>\r\n                <Module test_b.py>\r\n                    <Function test_b>\r\n            <Package b2>\r\n                <Module test_b2.py>\r\n                    <Function test_b2>\r\n            <Module test_a.py>\r\n                <Function test_a>\r\n    <Directory z>\r\n        <Package z>\r\n            ...\r\n        <Module z>\r\n            ...\r\n     <Directory y>\r\n        <Directory y2>\r\n            <Module y3> (single explicit file path case: ./y/y2/y3.py)\r\n```\r\n\r\nI feel like this (1) makes it clear that a session can be multiple directories (since it can already be multiple \"top level\" packages, this is roughly equivalent), and (2) Should(tm) make it easier to track file system scoping b/c it Should(tm) only need to find the closest parent Directory node.\r\n\r\nNOTE: The suggestion implies that we would SKIP Directory Nodes for sub-packages and modules BUT include directory nodes for \"grafted sub-packages\". In other words, (I think) only add a Directory Node if the directory lacks an __init__.py (grafted case) OR does not have a parent package (top level packages).","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1556060396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MarximusMaximus","id":94208961,"node_id":"U_kgDOBZ2DwQ","avatar_url":"https://avatars.githubusercontent.com/u/94208961?v=4","gravatar_id":"","url":"https://api.github.com/users/MarximusMaximus","html_url":"https://github.com/MarximusMaximus","followers_url":"https://api.github.com/users/MarximusMaximus/followers","following_url":"https://api.github.com/users/MarximusMaximus/following{/other_user}","gists_url":"https://api.github.com/users/MarximusMaximus/gists{/gist_id}","starred_url":"https://api.github.com/users/MarximusMaximus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MarximusMaximus/subscriptions","organizations_url":"https://api.github.com/users/MarximusMaximus/orgs","repos_url":"https://api.github.com/users/MarximusMaximus/repos","events_url":"https://api.github.com/users/MarximusMaximus/events{/privacy}","received_events_url":"https://api.github.com/users/MarximusMaximus/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1556139511","html_url":"https://github.com/pytest-dev/pytest/issues/7777#issuecomment-1556139511","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/7777","id":1556139511,"node_id":"IC_kwDOAjwLdc5cwM33","user":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-21T10:14:15Z","updated_at":"2023-05-21T10:14:15Z","body":"@MarximusMaximus right. I'm not entirely sure how it would look like exactly, but that's the basic idea - `Directory` is a non-package directory, and `Package` is a yes-package directory (really the `__init__.py` file); and we mirror the filesystem hierarchy with either `Directory` or `Package` nodes.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1556139511/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":9295731006,"node_id":"MEE_lADOAjwLdc4qBtuwzwAAAAIqEZk-","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/9295731006","actor":{"login":"MarximusMaximus","id":94208961,"node_id":"U_kgDOBZ2DwQ","avatar_url":"https://avatars.githubusercontent.com/u/94208961?v=4","gravatar_id":"","url":"https://api.github.com/users/MarximusMaximus","html_url":"https://github.com/MarximusMaximus","followers_url":"https://api.github.com/users/MarximusMaximus/followers","following_url":"https://api.github.com/users/MarximusMaximus/following{/other_user}","gists_url":"https://api.github.com/users/MarximusMaximus/gists{/gist_id}","starred_url":"https://api.github.com/users/MarximusMaximus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MarximusMaximus/subscriptions","organizations_url":"https://api.github.com/users/MarximusMaximus/orgs","repos_url":"https://api.github.com/users/MarximusMaximus/repos","events_url":"https://api.github.com/users/MarximusMaximus/events{/privacy}","received_events_url":"https://api.github.com/users/MarximusMaximus/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-05-21T10:14:15Z","performed_via_github_app":null},{"id":9295731009,"node_id":"SE_lADOAjwLdc4qBtuwzwAAAAIqEZlB","url":"https://api.github.com/repos/pytest-dev/pytest/issues/events/9295731009","actor":{"login":"MarximusMaximus","id":94208961,"node_id":"U_kgDOBZ2DwQ","avatar_url":"https://avatars.githubusercontent.com/u/94208961?v=4","gravatar_id":"","url":"https://api.github.com/users/MarximusMaximus","html_url":"https://github.com/MarximusMaximus","followers_url":"https://api.github.com/users/MarximusMaximus/followers","following_url":"https://api.github.com/users/MarximusMaximus/following{/other_user}","gists_url":"https://api.github.com/users/MarximusMaximus/gists{/gist_id}","starred_url":"https://api.github.com/users/MarximusMaximus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MarximusMaximus/subscriptions","organizations_url":"https://api.github.com/users/MarximusMaximus/orgs","repos_url":"https://api.github.com/users/MarximusMaximus/repos","events_url":"https://api.github.com/users/MarximusMaximus/events{/privacy}","received_events_url":"https://api.github.com/users/MarximusMaximus/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-05-21T10:14:15Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1565589720","html_url":"https://github.com/pytest-dev/pytest/issues/7777#issuecomment-1565589720","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/7777","id":1565589720,"node_id":"IC_kwDOAjwLdc5dUQDY","user":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-27T16:43:16Z","updated_at":"2023-05-27T16:43:16Z","body":"In case I get hit by a bus, my WIP branch is here: https://github.com/bluetech/pytest/commits/pkg-collect\r\n\r\nIt seems viable for sure, but very delicate.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1565589720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1575652688","html_url":"https://github.com/pytest-dev/pytest/issues/7777#issuecomment-1575652688","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/7777","id":1575652688,"node_id":"IC_kwDOAjwLdc5d6o1Q","user":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-04T17:42:30Z","updated_at":"2023-06-24T16:23:36Z","body":"### `Package` should not be a `Module`\r\n\r\n*This comment was extracted to #11137*","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1575652688/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1577095352","html_url":"https://github.com/pytest-dev/pytest/issues/7777#issuecomment-1577095352","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/7777","id":1577095352,"node_id":"IC_kwDOAjwLdc5eAJC4","user":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-05T16:16:26Z","updated_at":"2023-06-05T16:16:26Z","body":"### `pytest_collect_directory` hook\r\n\r\nAfter the changes proposed in this issue, all of `Session`, `Package` and `Directory` would need to collect directories. It basically looks like this:\r\n\r\n```py\r\nif (path / \"__init__.py\").is_file:\r\n    return Package.from_parent(parent, path=path)\r\nelse:\r\n    return Directory.from_parent(parent, path=path)\r\n```\r\n\r\nI don't like that this logic is hardcoded, and repeated in 3 places.\r\n\r\nI propose to add a new hook, `pytest_collect_directory`, similar to the existing `pytest_collect_file`, but for directories. There will be 2 implementations:\r\n\r\n1. An implementation in `main.py` will create `Directory` nodes.\r\n2. An implementation in `pytest.py` will create `Package` nodes, if the directory has an `__init__.py` file.\r\n\r\nThis has the following benefits:\r\n\r\n1. Avoids the repetition.\r\n2. Decouples the `python` plugin - now `main` doesn't need to know about `Package` anymore, the `python` plugin plugs `Package` itself.\r\n3. Plugins can invent new features involving directories. For example, a `YamlDirectory` which collects files based on some manifest, or a virtual filesystem, etc.\r\n\r\nOne question is whether the hook should be `firstresult` or not. The `pytest_collect_file` hook is not, which means multiple plugins can generate multiple nodes for a single file. But `firstresult=False` creates an issue for `pytest_collect_directory` -- `main` doesn't want to create a `Directory` if a `Package` is created. So I'm going to define `pytest_collect_directory` as `firstresult=True`, which means only one plugin creates a node for a directory.\r\n\r\n### POC\r\n\r\nThis is currently implemented as part of the bigger change here:\r\nhttps://github.com/bluetech/pytest/commits/pkg-collect\r\nThis branch doesn't pass all tests yet, but I don't foresee issues with `pytest_collect_directory` in particular.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1577095352/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1577109597","html_url":"https://github.com/pytest-dev/pytest/issues/7777#issuecomment-1577109597","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/7777","id":1577109597,"node_id":"IC_kwDOAjwLdc5eAMhd","user":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-05T16:26:40Z","updated_at":"2023-06-05T16:26:40Z","body":"Amusingly I just realized that `pytest_collect_directory` already existed up to pytest 6.0, but was removed because it was broken: [deprecation doc](https://github.com/pytest-dev/pytest/blob/85c5bd26b6d94dca423c2c0c54717750eac81cae/doc/en/deprecations.rst#pytest-collect-directory-hook), [deprecation issue](https://github.com/pytest-dev/pytest/issues/571), [deprecation pr](https://github.com/pytest-dev/pytest/pull/6847), [removal pr](https://github.com/pytest-dev/pytest/pull/7660). So I propose to bring it back, with a different definition (py.path -> pathlib, returns the node instead of just being called??), but this time it will actually work and be useful :)","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1577109597/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1595814645","html_url":"https://github.com/pytest-dev/pytest/issues/7777#issuecomment-1595814645","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/7777","id":1595814645,"node_id":"IC_kwDOAjwLdc5fHjL1","user":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-17T17:39:11Z","updated_at":"2023-06-17T17:39:11Z","body":"After a lot of tinkering with obscure pytest behaviors (`keepduplicates`, conftest exceptions, eek), I managed to make the branch pass all tests. I'll now be working on preparing it for submission (split commits, update docs, add tests, add changelogs, finding relevant issues etc.). I'll be proposing it for pytest 8.0.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1595814645/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1595817292","html_url":"https://github.com/pytest-dev/pytest/issues/7777#issuecomment-1595817292","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/7777","id":1595817292,"node_id":"IC_kwDOAjwLdc5fHj1M","user":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-17T17:53:30Z","updated_at":"2023-06-17T17:53:30Z","body":"### Abstract `Directory` node, parent of `Dir` and `Package`\r\n\r\nOne change I've made from the initial proposal is to add an abstract `nodes.Directory` node, which is analogous to `nodes.File` for files, and renamed the concrete `Directory` node to `Dir` to avoid the naming conflict.\r\n\r\nReminder: `nodes.File` is the parent of `python.Module`, but also used for [non-Python tests](https://docs.pytest.org/en/7.3.x/example/nonpython.html), like `YamlFile` etc.\r\n\r\nSince now we have a proper collector hierarchy mirroring the filesystem hierarchy, I've decided to add an abstract `nodes.Directory`, which is a parent of the concrete `python.Package` (directories with `__init__.py`) and `main.Dir` (directories without `__init__.py`).\r\n\r\nI think it's nice because:\r\n\r\n1. Plugins can invent their own `Directory` nodes, like they can for `File`s.\r\n\r\n2. It further decouples the python plugin, now can replace explicit checks for `python.Package` (where it stands for \"a directory\") to `nodes.Directory`.\r\n\r\n3. We can replace the `package` scope, which is tied to `python.Package`, with a `directory` scope which works for any `Directory`. Why not allow non-`Package` directories to have directory-level fixtures? (This will be follow up work if we think it's a good idea).\r\n\r\n4. I think it would be good to tighten `pytest_collect_directory` return type to `nodes.Directory`, to make clear the expectations from this hook. (Side note: would also be good to make `pytest_collect_file` need to return `nodes.File` instead of an arbitrary `Collector`...).","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1595817292/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-21T06:14:37Z","updated_at":"2023-06-21T06:14:37Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/11126","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/11126/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/11126/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/11126/events","html_url":"https://github.com/pytest-dev/pytest/issues/11126","id":1766830151,"node_id":"I_kwDOAjwLdc5pT7BH","number":11126,"title":"7.4 and 8.0 release planning","user":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/pytest-dev/pytest/milestones/35","html_url":"https://github.com/pytest-dev/pytest/milestone/35","labels_url":"https://api.github.com/repos/pytest-dev/pytest/milestones/35/labels","id":5503484,"node_id":"MDk6TWlsZXN0b25lNTUwMzQ4NA==","number":35,"title":"8.0","description":"","creator":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":11,"state":"closed","created_at":"2020-06-05T11:56:50Z","updated_at":"2024-04-14T12:35:09Z","due_on":null,"closed_at":"2024-04-14T12:35:09Z"},"comments":11,"created_at":"2023-06-21T06:14:36Z","updated_at":"2024-01-27T22:45:13Z","closed_at":"2024-01-27T22:45:13Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":37489525,"node_id":"MDEwOlJlcG9zaXRvcnkzNzQ4OTUyNQ==","name":"pytest","full_name":"pytest-dev/pytest","private":false,"owner":{"login":"pytest-dev","id":8897583,"node_id":"MDEyOk9yZ2FuaXphdGlvbjg4OTc1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8897583?v=4","gravatar_id":"","url":"https://api.github.com/users/pytest-dev","html_url":"https://github.com/pytest-dev","followers_url":"https://api.github.com/users/pytest-dev/followers","following_url":"https://api.github.com/users/pytest-dev/following{/other_user}","gists_url":"https://api.github.com/users/pytest-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/pytest-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pytest-dev/subscriptions","organizations_url":"https://api.github.com/users/pytest-dev/orgs","repos_url":"https://api.github.com/users/pytest-dev/repos","events_url":"https://api.github.com/users/pytest-dev/events{/privacy}","received_events_url":"https://api.github.com/users/pytest-dev/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/pytest-dev/pytest","description":"The pytest framework makes it easy to write small tests, yet scales to support complex functional testing","fork":false,"url":"https://api.github.com/repos/pytest-dev/pytest","forks_url":"https://api.github.com/repos/pytest-dev/pytest/forks","keys_url":"https://api.github.com/repos/pytest-dev/pytest/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pytest-dev/pytest/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pytest-dev/pytest/teams","hooks_url":"https://api.github.com/repos/pytest-dev/pytest/hooks","issue_events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/events{/number}","events_url":"https://api.github.com/repos/pytest-dev/pytest/events","assignees_url":"https://api.github.com/repos/pytest-dev/pytest/assignees{/user}","branches_url":"https://api.github.com/repos/pytest-dev/pytest/branches{/branch}","tags_url":"https://api.github.com/repos/pytest-dev/pytest/tags","blobs_url":"https://api.github.com/repos/pytest-dev/pytest/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pytest-dev/pytest/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pytest-dev/pytest/git/refs{/sha}","trees_url":"https://api.github.com/repos/pytest-dev/pytest/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pytest-dev/pytest/statuses/{sha}","languages_url":"https://api.github.com/repos/pytest-dev/pytest/languages","stargazers_url":"https://api.github.com/repos/pytest-dev/pytest/stargazers","contributors_url":"https://api.github.com/repos/pytest-dev/pytest/contributors","subscribers_url":"https://api.github.com/repos/pytest-dev/pytest/subscribers","subscription_url":"https://api.github.com/repos/pytest-dev/pytest/subscription","commits_url":"https://api.github.com/repos/pytest-dev/pytest/commits{/sha}","git_commits_url":"https://api.github.com/repos/pytest-dev/pytest/git/commits{/sha}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/comments{/number}","issue_comment_url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments{/number}","contents_url":"https://api.github.com/repos/pytest-dev/pytest/contents/{+path}","compare_url":"https://api.github.com/repos/pytest-dev/pytest/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pytest-dev/pytest/merges","archive_url":"https://api.github.com/repos/pytest-dev/pytest/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pytest-dev/pytest/downloads","issues_url":"https://api.github.com/repos/pytest-dev/pytest/issues{/number}","pulls_url":"https://api.github.com/repos/pytest-dev/pytest/pulls{/number}","milestones_url":"https://api.github.com/repos/pytest-dev/pytest/milestones{/number}","notifications_url":"https://api.github.com/repos/pytest-dev/pytest/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pytest-dev/pytest/labels{/name}","releases_url":"https://api.github.com/repos/pytest-dev/pytest/releases{/id}","deployments_url":"https://api.github.com/repos/pytest-dev/pytest/deployments","created_at":"2015-06-15T20:28:27Z","updated_at":"2025-11-09T16:32:44Z","pushed_at":"2025-11-09T09:33:29Z","git_url":"git://github.com/pytest-dev/pytest.git","ssh_url":"git@github.com:pytest-dev/pytest.git","clone_url":"https://github.com/pytest-dev/pytest.git","svn_url":"https://github.com/pytest-dev/pytest","homepage":"https://pytest.org","size":37842,"stargazers_count":13254,"watchers_count":13254,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":2933,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":953,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","python","test","testing","unit-testing"],"visibility":"public","forks":2933,"open_issues":953,"watchers":13254,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"I have some pending breaking changes to pytest, that can't really go through a deprecation cycle. Things like:\r\n\r\n- Changing collection of `__init__.py` to collect just the module, not the entire package (#11042)\r\n- Changing `Package` to not be a `Module` (https://github.com/pytest-dev/pytest/issues/7777#issuecomment-1575652688)\r\n- Adding the `Directory`/`Dir` nodes (https://github.com/pytest-dev/pytest/issues/7777#issuecomment-1555963294)\r\n\r\nI'd like to include these changes in the next major release, 8.0.\r\n\r\nBut before that, I suggest we release 7.4 with what we have already.\r\n\r\nI can manage these releases.\r\n\r\nProposal:\r\n- [x] Release 7.4 this weekend\r\n- [x] Change main to be 8.*\r\n- [x] Work on the planned features until they're done (1-2 months hopefully)\r\n- [x] Branch 8.0.x, release 8.0.0-rc1\r\n- [x] Wait ~1 month for testing/feedback\r\n- Release 8.0.0","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/11126/reactions","total_count":9,"+1":5,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":3,"rocket":0,"eyes":1},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/11126/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"actor":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-24T16:23:11Z","updated_at":"2023-06-24T16:23:11Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/11137","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/11137/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/11137/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/11137/events","html_url":"https://github.com/pytest-dev/pytest/issues/11137","id":1772813436,"node_id":"I_kwDOAjwLdc5pqvx8","number":11137,"title":"`Package` should not be a `Module`/`File`","user":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":224849844,"node_id":"MDU6TGFiZWwyMjQ4NDk4NDQ=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/type:%20proposal","name":"type: proposal","color":"006b75","default":false,"description":"proposal for a new feature, often to gather opinions or design the API around the new feature"},{"id":240511492,"node_id":"MDU6TGFiZWwyNDA1MTE0OTI=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/topic:%20collection","name":"topic: collection","color":"006b75","default":false,"description":"related to the collection phase"},{"id":240739369,"node_id":"MDU6TGFiZWwyNDA3MzkzNjk=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/type:%20backward%20compatibility","name":"type: backward compatibility","color":"f7c6c7","default":false,"description":"might present some backward compatibility issues which should be carefully noted in the changelog"}],"state":"closed","locked":false,"assignee":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/pytest-dev/pytest/milestones/35","html_url":"https://github.com/pytest-dev/pytest/milestone/35","labels_url":"https://api.github.com/repos/pytest-dev/pytest/milestones/35/labels","id":5503484,"node_id":"MDk6TWlsZXN0b25lNTUwMzQ4NA==","number":35,"title":"8.0","description":"","creator":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":11,"state":"closed","created_at":"2020-06-05T11:56:50Z","updated_at":"2024-04-14T12:35:09Z","due_on":null,"closed_at":"2024-04-14T12:35:09Z"},"comments":0,"created_at":"2023-06-24T16:23:10Z","updated_at":"2023-07-28T20:15:10Z","closed_at":"2023-07-28T20:15:10Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":37489525,"node_id":"MDEwOlJlcG9zaXRvcnkzNzQ4OTUyNQ==","name":"pytest","full_name":"pytest-dev/pytest","private":false,"owner":{"login":"pytest-dev","id":8897583,"node_id":"MDEyOk9yZ2FuaXphdGlvbjg4OTc1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8897583?v=4","gravatar_id":"","url":"https://api.github.com/users/pytest-dev","html_url":"https://github.com/pytest-dev","followers_url":"https://api.github.com/users/pytest-dev/followers","following_url":"https://api.github.com/users/pytest-dev/following{/other_user}","gists_url":"https://api.github.com/users/pytest-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/pytest-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pytest-dev/subscriptions","organizations_url":"https://api.github.com/users/pytest-dev/orgs","repos_url":"https://api.github.com/users/pytest-dev/repos","events_url":"https://api.github.com/users/pytest-dev/events{/privacy}","received_events_url":"https://api.github.com/users/pytest-dev/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/pytest-dev/pytest","description":"The pytest framework makes it easy to write small tests, yet scales to support complex functional testing","fork":false,"url":"https://api.github.com/repos/pytest-dev/pytest","forks_url":"https://api.github.com/repos/pytest-dev/pytest/forks","keys_url":"https://api.github.com/repos/pytest-dev/pytest/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pytest-dev/pytest/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pytest-dev/pytest/teams","hooks_url":"https://api.github.com/repos/pytest-dev/pytest/hooks","issue_events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/events{/number}","events_url":"https://api.github.com/repos/pytest-dev/pytest/events","assignees_url":"https://api.github.com/repos/pytest-dev/pytest/assignees{/user}","branches_url":"https://api.github.com/repos/pytest-dev/pytest/branches{/branch}","tags_url":"https://api.github.com/repos/pytest-dev/pytest/tags","blobs_url":"https://api.github.com/repos/pytest-dev/pytest/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pytest-dev/pytest/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pytest-dev/pytest/git/refs{/sha}","trees_url":"https://api.github.com/repos/pytest-dev/pytest/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pytest-dev/pytest/statuses/{sha}","languages_url":"https://api.github.com/repos/pytest-dev/pytest/languages","stargazers_url":"https://api.github.com/repos/pytest-dev/pytest/stargazers","contributors_url":"https://api.github.com/repos/pytest-dev/pytest/contributors","subscribers_url":"https://api.github.com/repos/pytest-dev/pytest/subscribers","subscription_url":"https://api.github.com/repos/pytest-dev/pytest/subscription","commits_url":"https://api.github.com/repos/pytest-dev/pytest/commits{/sha}","git_commits_url":"https://api.github.com/repos/pytest-dev/pytest/git/commits{/sha}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/comments{/number}","issue_comment_url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments{/number}","contents_url":"https://api.github.com/repos/pytest-dev/pytest/contents/{+path}","compare_url":"https://api.github.com/repos/pytest-dev/pytest/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pytest-dev/pytest/merges","archive_url":"https://api.github.com/repos/pytest-dev/pytest/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pytest-dev/pytest/downloads","issues_url":"https://api.github.com/repos/pytest-dev/pytest/issues{/number}","pulls_url":"https://api.github.com/repos/pytest-dev/pytest/pulls{/number}","milestones_url":"https://api.github.com/repos/pytest-dev/pytest/milestones{/number}","notifications_url":"https://api.github.com/repos/pytest-dev/pytest/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pytest-dev/pytest/labels{/name}","releases_url":"https://api.github.com/repos/pytest-dev/pytest/releases{/id}","deployments_url":"https://api.github.com/repos/pytest-dev/pytest/deployments","created_at":"2015-06-15T20:28:27Z","updated_at":"2025-11-09T16:32:44Z","pushed_at":"2025-11-09T09:33:29Z","git_url":"git://github.com/pytest-dev/pytest.git","ssh_url":"git@github.com:pytest-dev/pytest.git","clone_url":"https://github.com/pytest-dev/pytest.git","svn_url":"https://github.com/pytest-dev/pytest","homepage":"https://pytest.org","size":37842,"stargazers_count":13254,"watchers_count":13254,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":2933,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":953,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","python","test","testing","unit-testing"],"visibility":"public","forks":2933,"open_issues":953,"watchers":13254,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"*Note: this issue is extracted verbatim from https://github.com/pytest-dev/pytest/issues/7777#issuecomment-1575652688 so I can refer to it separately*\r\n\r\n`Package` is currently a subclass of a `Module`, with `package.path` being the `__init__.py` file.\r\n\r\nWhile technically in terms of the Python data model this [is correct](https://docs.python.org/3/glossary.html#term-package), I'm pretty convinced this was the wrong decision in pytest:\r\n\r\n`Package` is a `Module` with path `__init__.py`, but it doesn't actually act as a `Module` behaviorally, it overrides everything that `Module` does and doesn't call `super()` on anything.\r\n\r\n`Module` is a `nodes.File`, which makes `Package` a `nodes.File`, but it doesn't act as a file.\r\n\r\nThe previous points can be rephrased as: `Package` breaks Liskov substitution -- any code dealing with `File` or `Module` generically probably doesn't want `Package`.\r\n\r\n`Package` is a `Module` with path `__init__.py`, but it actually collects a \"real\" (non-`Package`) `Module` for the `__init__.py` file (if permitted by `python_files` glob). This is very confusing.\r\n\r\n`Package` and `__init__.py` necessitates several special-casings because of these points:\r\n\r\n- https://github.com/pytest-dev/pytest/blob/24534cdd29d74e302e86db1a719c99e024d7903e/src/_pytest/cacheprovider.py#L275-L278\r\n- https://github.com/pytest-dev/pytest/blob/24534cdd29d74e302e86db1a719c99e024d7903e/src/_pytest/main.py#L805-L818\r\n- https://github.com/pytest-dev/pytest/blob/24534cdd29d74e302e86db1a719c99e024d7903e/src/_pytest/fixtures.py#L123\r\n- https://github.com/pytest-dev/pytest/blob/24534cdd29d74e302e86db1a719c99e024d7903e/src/_pytest/python.py#L229-L231\r\n- https://github.com/pytest-dev/pytest/blob/24534cdd29d74e302e86db1a719c99e024d7903e/src/_pytest/python.py#L750-L761\r\n\r\n### Proposed solution\r\n\r\nAs part of the breaking `Package` changes discussed previously in this issue, also make these changes\r\n\r\n- `Package` no longer inherits from `Module` (or `File` by extension), just from `FSCollector`.\r\n- `Package.path` is the package directory, not the `__init__.py` file.\r\n- Collecting `pkg/__init__.py` collects the `__init__.py` file as a module (file), doesn't collect the entire package.\r\n\r\nThis also matches the new `Directory` node, which is the non-`Package` directory collector. `Directory` will inherit just from `FSCollector` and its `path` will be the directory. It will be much better if they are as similar to each other as possible.\r\n\r\n### Complication\r\n\r\nCurrently `Package`  has a `setup()` method which imports the `__init__.py`' and runs its `setup_module` function and registers `teardown_module` finalizer (in effectively the package scope). If we want to stop having `Package` as a `Module` it becomes a bit less natural to implement.\r\n\r\nThis functionality has some issues:\r\n- It is undocumented.\r\n- It doesn't match `unittest` which doesn't have package functionality\r\n- The names `setup_module` and `teardown_module` conflict with the \"real\" `__init__.py` `Module` setup/teardown; i.e., these methods are executed twice, if the `__init__.py` is included in the glob. It would have been better to call them `setup_package`/`teardown_package` (this is how nose [calls them](https://nose.readthedocs.io/en/latest/writing_tests.html#test-packages)).\r\n\r\nIt is tempting to just remove it, but it will probably cause some breakage (particularly the `__init__.py` importing part), so for now I plan to keep it in an ad-hoc manner.\r\n\r\n### POC\r\n\r\nI have an initial implementation of this change here, with all tests passing:\r\nhttps://github.com/bluetech/pytest/commits/pkg-mod","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/11137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/11137/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"actor":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-24T17:10:07Z","updated_at":"2023-06-24T17:10:07Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/11138","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/11138/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/11138/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/11138/events","html_url":"https://github.com/pytest-dev/pytest/pull/11138","id":1772826972,"node_id":"PR_kwDOAjwLdc5T0h3_","number":11138,"title":"python: change `Package` to no longer be a `Module`/`File`","user":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/pytest-dev/pytest/milestones/35","html_url":"https://github.com/pytest-dev/pytest/milestone/35","labels_url":"https://api.github.com/repos/pytest-dev/pytest/milestones/35/labels","id":5503484,"node_id":"MDk6TWlsZXN0b25lNTUwMzQ4NA==","number":35,"title":"8.0","description":"","creator":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":11,"state":"closed","created_at":"2020-06-05T11:56:50Z","updated_at":"2024-04-14T12:35:09Z","due_on":null,"closed_at":"2024-04-14T12:35:09Z"},"comments":6,"created_at":"2023-06-24T16:49:18Z","updated_at":"2024-05-01T15:58:52Z","closed_at":"2023-07-28T20:15:09Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":37489525,"node_id":"MDEwOlJlcG9zaXRvcnkzNzQ4OTUyNQ==","name":"pytest","full_name":"pytest-dev/pytest","private":false,"owner":{"login":"pytest-dev","id":8897583,"node_id":"MDEyOk9yZ2FuaXphdGlvbjg4OTc1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/8897583?v=4","gravatar_id":"","url":"https://api.github.com/users/pytest-dev","html_url":"https://github.com/pytest-dev","followers_url":"https://api.github.com/users/pytest-dev/followers","following_url":"https://api.github.com/users/pytest-dev/following{/other_user}","gists_url":"https://api.github.com/users/pytest-dev/gists{/gist_id}","starred_url":"https://api.github.com/users/pytest-dev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pytest-dev/subscriptions","organizations_url":"https://api.github.com/users/pytest-dev/orgs","repos_url":"https://api.github.com/users/pytest-dev/repos","events_url":"https://api.github.com/users/pytest-dev/events{/privacy}","received_events_url":"https://api.github.com/users/pytest-dev/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/pytest-dev/pytest","description":"The pytest framework makes it easy to write small tests, yet scales to support complex functional testing","fork":false,"url":"https://api.github.com/repos/pytest-dev/pytest","forks_url":"https://api.github.com/repos/pytest-dev/pytest/forks","keys_url":"https://api.github.com/repos/pytest-dev/pytest/keys{/key_id}","collaborators_url":"https://api.github.com/repos/pytest-dev/pytest/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/pytest-dev/pytest/teams","hooks_url":"https://api.github.com/repos/pytest-dev/pytest/hooks","issue_events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/events{/number}","events_url":"https://api.github.com/repos/pytest-dev/pytest/events","assignees_url":"https://api.github.com/repos/pytest-dev/pytest/assignees{/user}","branches_url":"https://api.github.com/repos/pytest-dev/pytest/branches{/branch}","tags_url":"https://api.github.com/repos/pytest-dev/pytest/tags","blobs_url":"https://api.github.com/repos/pytest-dev/pytest/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/pytest-dev/pytest/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/pytest-dev/pytest/git/refs{/sha}","trees_url":"https://api.github.com/repos/pytest-dev/pytest/git/trees{/sha}","statuses_url":"https://api.github.com/repos/pytest-dev/pytest/statuses/{sha}","languages_url":"https://api.github.com/repos/pytest-dev/pytest/languages","stargazers_url":"https://api.github.com/repos/pytest-dev/pytest/stargazers","contributors_url":"https://api.github.com/repos/pytest-dev/pytest/contributors","subscribers_url":"https://api.github.com/repos/pytest-dev/pytest/subscribers","subscription_url":"https://api.github.com/repos/pytest-dev/pytest/subscription","commits_url":"https://api.github.com/repos/pytest-dev/pytest/commits{/sha}","git_commits_url":"https://api.github.com/repos/pytest-dev/pytest/git/commits{/sha}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/comments{/number}","issue_comment_url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments{/number}","contents_url":"https://api.github.com/repos/pytest-dev/pytest/contents/{+path}","compare_url":"https://api.github.com/repos/pytest-dev/pytest/compare/{base}...{head}","merges_url":"https://api.github.com/repos/pytest-dev/pytest/merges","archive_url":"https://api.github.com/repos/pytest-dev/pytest/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/pytest-dev/pytest/downloads","issues_url":"https://api.github.com/repos/pytest-dev/pytest/issues{/number}","pulls_url":"https://api.github.com/repos/pytest-dev/pytest/pulls{/number}","milestones_url":"https://api.github.com/repos/pytest-dev/pytest/milestones{/number}","notifications_url":"https://api.github.com/repos/pytest-dev/pytest/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/pytest-dev/pytest/labels{/name}","releases_url":"https://api.github.com/repos/pytest-dev/pytest/releases{/id}","deployments_url":"https://api.github.com/repos/pytest-dev/pytest/deployments","created_at":"2015-06-15T20:28:27Z","updated_at":"2025-11-09T16:32:44Z","pushed_at":"2025-11-09T09:33:29Z","git_url":"git://github.com/pytest-dev/pytest.git","ssh_url":"git@github.com:pytest-dev/pytest.git","clone_url":"https://github.com/pytest-dev/pytest.git","svn_url":"https://github.com/pytest-dev/pytest","homepage":"https://pytest.org","size":37842,"stargazers_count":13254,"watchers_count":13254,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":2933,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":953,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["hacktoberfest","python","test","testing","unit-testing"],"visibility":"public","forks":2933,"open_issues":953,"watchers":13254,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/pytest-dev/pytest/pulls/11138","html_url":"https://github.com/pytest-dev/pytest/pull/11138","diff_url":"https://github.com/pytest-dev/pytest/pull/11138.diff","patch_url":"https://github.com/pytest-dev/pytest/pull/11138.patch","merged_at":"2023-07-28T20:15:09Z"},"body":"Fix #11137.\r\n\r\nI'll leave detailed notes on the changes below to hopefully make them easier to understand.","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/11138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/11138/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1614226844","html_url":"https://github.com/pytest-dev/pytest/issues/7777#issuecomment-1614226844","issue_url":"https://api.github.com/repos/pytest-dev/pytest/issues/7777","id":1614226844,"node_id":"IC_kwDOAjwLdc5gNyWc","user":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-06-30T07:09:01Z","updated_at":"2023-06-30T07:09:01Z","body":"### Order of files vs. directories in collection\r\n\r\nPreviously, files in a directory were collected before sub-directories in the directory. That is, given a filesystem tree\r\n\r\n```\r\ntop/\r\n├── aaa\r\n│   └── test_aaa.py\r\n├── test_a.py\r\n├── test_b\r\n│   └── test_b.py\r\n├── test_c.py\r\n└── zzz\r\n    └── test_zzz.py\r\n```\r\n\r\nwould collect as\r\n\r\n```\r\n<Module top/test_a.py>\r\n  <Function test_it>\r\n<Module top/test_c.py>\r\n  <Function test_it>\r\n<Module top/aaa/test_aaa.py>\r\n  <Function test_it>\r\n<Module top/test_b/test_b.py>\r\n  <Function test_it>\r\n<Module top/zzz/test_zzz.py>\r\n  <Function test_it>\r\n```\r\n\r\nAfter my changes, the order that naturally flows from the code is that files and sub-directories are orderer jointly, that is the tree is\r\n\r\n```\r\n<Dir pytest>\r\n  <Dir top>\r\n    <Dir aaa>\r\n      <Module test_aaa.py>\r\n        <Function test_it>\r\n    <Module test_a.py>\r\n      <Function test_it>\r\n    <Dir test_b>\r\n      <Module test_b.py>\r\n        <Function test_it>\r\n    <Module test_c.py>\r\n      <Function test_it>\r\n    <Dir zzz>\r\n      <Module test_zzz.py>\r\n        <Function test_it>\r\n```\r\n\r\nFor now I am keeping the joint ordering, but let me know if you think ordering files before subdirs is better.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/comments/1614226844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false}}]