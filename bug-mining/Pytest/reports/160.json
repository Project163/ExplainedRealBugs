{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/5806","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/5806/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/5806/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/5806/events","html_url":"https://github.com/pytest-dev/pytest/issues/5806","id":487639167,"node_id":"MDU6SXNzdWU0ODc2MzkxNjc=","number":5806,"title":"Lexer \"python3\" in --pastebin feature causes HTTP errors","user":{"login":"goerz","id":112306,"node_id":"MDQ6VXNlcjExMjMwNg==","avatar_url":"https://avatars.githubusercontent.com/u/112306?v=4","gravatar_id":"","url":"https://api.github.com/users/goerz","html_url":"https://github.com/goerz","followers_url":"https://api.github.com/users/goerz/followers","following_url":"https://api.github.com/users/goerz/following{/other_user}","gists_url":"https://api.github.com/users/goerz/gists{/gist_id}","starred_url":"https://api.github.com/users/goerz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/goerz/subscriptions","organizations_url":"https://api.github.com/users/goerz/orgs","repos_url":"https://api.github.com/users/goerz/repos","events_url":"https://api.github.com/users/goerz/events{/privacy}","received_events_url":"https://api.github.com/users/goerz/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"goerz","id":112306,"node_id":"MDQ6VXNlcjExMjMwNg==","avatar_url":"https://avatars.githubusercontent.com/u/112306?v=4","gravatar_id":"","url":"https://api.github.com/users/goerz","html_url":"https://github.com/goerz","followers_url":"https://api.github.com/users/goerz/followers","following_url":"https://api.github.com/users/goerz/following{/other_user}","gists_url":"https://api.github.com/users/goerz/gists{/gist_id}","starred_url":"https://api.github.com/users/goerz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/goerz/subscriptions","organizations_url":"https://api.github.com/users/goerz/orgs","repos_url":"https://api.github.com/users/goerz/repos","events_url":"https://api.github.com/users/goerz/events{/privacy}","received_events_url":"https://api.github.com/users/goerz/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"goerz","id":112306,"node_id":"MDQ6VXNlcjExMjMwNg==","avatar_url":"https://avatars.githubusercontent.com/u/112306?v=4","gravatar_id":"","url":"https://api.github.com/users/goerz","html_url":"https://github.com/goerz","followers_url":"https://api.github.com/users/goerz/followers","following_url":"https://api.github.com/users/goerz/following{/other_user}","gists_url":"https://api.github.com/users/goerz/gists{/gist_id}","starred_url":"https://api.github.com/users/goerz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/goerz/subscriptions","organizations_url":"https://api.github.com/users/goerz/orgs","repos_url":"https://api.github.com/users/goerz/repos","events_url":"https://api.github.com/users/goerz/events{/privacy}","received_events_url":"https://api.github.com/users/goerz/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":3,"created_at":"2019-08-30T19:31:06Z","updated_at":"2019-09-13T04:02:17Z","closed_at":"2019-09-13T04:02:16Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"The `--pastebin` option currently submits the output of `pytest` to `bpaste.net` using `lexer=python3`: https://github.com/pytest-dev/pytest/blob/d47b9d04d4cf824150caef46c9c888779c1b3f58/src/_pytest/pastebin.py#L68-L73\r\n\r\nFor some `contents`, this will raise a \"HTTP Error 400: Bad Request\".\r\n\r\nAs an example:\r\n~~~\r\n>>> from urllib.request import urlopen\r\n>>> with open(\"data.txt\", \"rb\") as in_fh:\r\n...     data = in_fh.read()\r\n>>> url = \"https://bpaste.net\"\r\n>>> urlopen(url, data=data)\r\nHTTPError: Bad Request\r\n~~~\r\nwith the attached [data.txt](https://github.com/pytest-dev/pytest/files/3561212/data.txt).\r\n\r\nThis is the underlying cause for the problems mentioned in #5764.\r\n\r\nThe call goes through fine if `lexer` is changed from `python3` to `text`. This would seem like the right thing to do in any case: the console output of a `pytest` run that is being uploaded is not Python code, but arbitrary text.\r\n","closed_by":{"login":"Zac-HD","id":12229877,"node_id":"MDQ6VXNlcjEyMjI5ODc3","avatar_url":"https://avatars.githubusercontent.com/u/12229877?v=4","gravatar_id":"","url":"https://api.github.com/users/Zac-HD","html_url":"https://github.com/Zac-HD","followers_url":"https://api.github.com/users/Zac-HD/followers","following_url":"https://api.github.com/users/Zac-HD/following{/other_user}","gists_url":"https://api.github.com/users/Zac-HD/gists{/gist_id}","starred_url":"https://api.github.com/users/Zac-HD/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zac-HD/subscriptions","organizations_url":"https://api.github.com/users/Zac-HD/orgs","repos_url":"https://api.github.com/users/Zac-HD/repos","events_url":"https://api.github.com/users/Zac-HD/events{/privacy}","received_events_url":"https://api.github.com/users/Zac-HD/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/5806/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/5806/timeline","performed_via_github_app":null,"state_reason":"completed"}