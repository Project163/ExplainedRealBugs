{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/4243","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/4243/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/4243/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/4243/events","html_url":"https://github.com/pytest-dev/pytest/issues/4243","id":374240363,"node_id":"MDU6SXNzdWUzNzQyNDAzNjM=","number":4243,"title":"TypeError: warn() takes at most 3 arguments (4 given), with pytest 3.9.2","user":{"login":"andy-maier","id":8939758,"node_id":"MDQ6VXNlcjg5Mzk3NTg=","avatar_url":"https://avatars.githubusercontent.com/u/8939758?v=4","gravatar_id":"","url":"https://api.github.com/users/andy-maier","html_url":"https://github.com/andy-maier","followers_url":"https://api.github.com/users/andy-maier/followers","following_url":"https://api.github.com/users/andy-maier/following{/other_user}","gists_url":"https://api.github.com/users/andy-maier/gists{/gist_id}","starred_url":"https://api.github.com/users/andy-maier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andy-maier/subscriptions","organizations_url":"https://api.github.com/users/andy-maier/orgs","repos_url":"https://api.github.com/users/andy-maier/repos","events_url":"https://api.github.com/users/andy-maier/events{/privacy}","received_events_url":"https://api.github.com/users/andy-maier/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":224849193,"node_id":"MDU6TGFiZWwyMjQ4NDkxOTM=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/type:%20bug","name":"type: bug","color":"fc2929","default":false,"description":"problem that needs to be addressed"},{"id":315571544,"node_id":"MDU6TGFiZWwzMTU1NzE1NDQ=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/type:%20regression","name":"type: regression","color":"f7c6c7","default":false,"description":"indicates a problem that was introduced in a release which was working previously"},{"id":615327396,"node_id":"MDU6TGFiZWw2MTUzMjczOTY=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/plugin:%20warnings","name":"plugin: warnings","color":"fef2c0","default":false,"description":"related to the warnings builtin plugin"}],"state":"closed","locked":false,"assignee":{"login":"RonnyPfannschmidt","id":156838,"node_id":"MDQ6VXNlcjE1NjgzOA==","avatar_url":"https://avatars.githubusercontent.com/u/156838?v=4","gravatar_id":"","url":"https://api.github.com/users/RonnyPfannschmidt","html_url":"https://github.com/RonnyPfannschmidt","followers_url":"https://api.github.com/users/RonnyPfannschmidt/followers","following_url":"https://api.github.com/users/RonnyPfannschmidt/following{/other_user}","gists_url":"https://api.github.com/users/RonnyPfannschmidt/gists{/gist_id}","starred_url":"https://api.github.com/users/RonnyPfannschmidt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RonnyPfannschmidt/subscriptions","organizations_url":"https://api.github.com/users/RonnyPfannschmidt/orgs","repos_url":"https://api.github.com/users/RonnyPfannschmidt/repos","events_url":"https://api.github.com/users/RonnyPfannschmidt/events{/privacy}","received_events_url":"https://api.github.com/users/RonnyPfannschmidt/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"RonnyPfannschmidt","id":156838,"node_id":"MDQ6VXNlcjE1NjgzOA==","avatar_url":"https://avatars.githubusercontent.com/u/156838?v=4","gravatar_id":"","url":"https://api.github.com/users/RonnyPfannschmidt","html_url":"https://github.com/RonnyPfannschmidt","followers_url":"https://api.github.com/users/RonnyPfannschmidt/followers","following_url":"https://api.github.com/users/RonnyPfannschmidt/following{/other_user}","gists_url":"https://api.github.com/users/RonnyPfannschmidt/gists{/gist_id}","starred_url":"https://api.github.com/users/RonnyPfannschmidt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RonnyPfannschmidt/subscriptions","organizations_url":"https://api.github.com/users/RonnyPfannschmidt/orgs","repos_url":"https://api.github.com/users/RonnyPfannschmidt/repos","events_url":"https://api.github.com/users/RonnyPfannschmidt/events{/privacy}","received_events_url":"https://api.github.com/users/RonnyPfannschmidt/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":3,"created_at":"2018-10-26T06:11:44Z","updated_at":"2018-10-26T11:28:32Z","closed_at":"2018-10-26T11:09:37Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Since pytest 3.9.2, the following TypeError is raised from within `pytest.warns()`:\r\n\r\n```\r\n/Users/maiera/virtualenvs/pywbem27/lib/python2.7/site-packages/_pytest/recwarn.py:172: TypeError\r\n___________________________________ TestCreateConnection.test_namespace_slashes_set ____________________________________\r\n\r\nself = <test_cim_operations.TestCreateConnection object at 0x11649ecd0>\r\n\r\n    def test_namespace_slashes_set(self):  # pylint: disable=no-self-use\r\n        \"\"\"Test stripping of leading and trailing slashes in default namespace\r\n        of wbem connection when setting the attribute\"\"\"\r\n        conn = WBEMConnection('http://localhost', None,\r\n                              default_namespace=None)\r\n        with pytest.warns(DeprecationWarning):\r\n>           conn.default_namespace = '//root/blah//'\r\n\r\ntestsuite/test_cim_operations.py:130: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\npywbem/cim_operations.py:740: in default_namespace\r\n    \"deprecated\", DeprecationWarning, 2)\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nargs = ('Setting the WBEMConnection.default_namespace property is deprecated', <type 'exceptions.DeprecationWarning'>, 2)\r\nkwargs = {'stacklevel': 2}\r\nf_globals = {'AUTO_GENERATE_SFCB_UEP_HEADER': True, 'CIMClass': <class 'pywbem.cim_obj.CIMClass'>, 'CIMClassName': <class 'pywbem.cim_obj.CIMClassName'>, 'CIMDateTime': <class 'pywbem.cim_types.CIMDateTime'>, ...}\r\n\r\n    def warn(*args, **kwargs):\r\n        kwargs.setdefault(\"stacklevel\", 1)\r\n        kwargs[\"stacklevel\"] += 1\r\n    \r\n        # emulate resetting the warn registry\r\n        f_globals = sys._getframe(kwargs[\"stacklevel\"] - 1).f_globals\r\n        if \"__warningregistry__\" in f_globals:\r\n            orig = f_globals[\"__warningregistry__\"]\r\n            f_globals[\"__warningregistry__\"] = None\r\n            try:\r\n                return self._saved_warn(*args, **kwargs)\r\n            finally:\r\n                f_globals[\"__warningregistry__\"] = orig\r\n        else:\r\n>           return self._saved_warn(*args, **kwargs)\r\nE           TypeError: warn() takes at most 3 arguments (4 given)\r\n\r\n/Users/maiera/virtualenvs/pywbem27/lib/python2.7/site-packages/_pytest/recwarn.py:172: TypeError\r\n```\r\n\r\nThis is with all dependent Python packages being on the latest available package level, as of today.\r\n\r\nWhen I reinstall pytest==3.9.1, the TypeError is not raised and the tests succeed as before.\r\n\r\nWe'll exclude pytest!=3.9.2 for the time being\r\n\r\n- [x] Include a detailed description of the bug or suggestion\r\n   see above\r\n- [x] `pip list` of the virtual environment you are using\r\n```\r\nPackage                            Version       Location\r\n---------------------------------- ------------- --------------------------------\r\nalabaster                          0.7.12\r\nastroid                            1.6.5\r\natomicwrites                       1.2.1\r\nattrs                              18.2.0\r\nBabel                              2.6.0\r\nbackports-abc                      0.5\r\nbackports.functools-lru-cache      1.5\r\nbackports.shutil-get-terminal-size 1.0.0\r\nbleach                             3.0.2\r\ncertifi                            2018.10.15\r\nchardet                            3.0.4\r\nconfigparser                       3.5.0\r\ncoverage                           4.0.3\r\ndecorator                          4.3.0\r\ndefusedxml                         0.5.0\r\ndistro                             1.3.0\r\ndocutils                           0.14\r\nentrypoints                        0.2.3\r\nenum34                             1.1.6\r\nflake8                             3.6.0\r\nfuncsigs                           1.0.2\r\nfunctools32                        3.2.3.post2\r\nfuture                             0.17.0\r\nfutures                            3.2.0\r\ngitdb2                             2.0.5\r\nGitPython                          2.1.11\r\nhttpretty                          0.9.5\r\nidna                               2.7\r\nimagesize                          1.1.0\r\nipaddress                          1.0.22\r\nipykernel                          4.10.0\r\nipython                            5.8.0\r\nipython-genutils                   0.2.0\r\nipywidgets                         7.4.2\r\nisort                              4.3.4\r\nJinja2                             2.10\r\njsonschema                         2.6.0\r\njupyter                            1.0.0\r\njupyter-client                     5.2.3\r\njupyter-console                    5.2.0\r\njupyter-core                       4.4.0\r\nlazy-object-proxy                  1.3.1\r\nlinecache2                         1.0.0\r\nlxml                               4.2.5\r\nM2Crypto                           0.30.1\r\nMarkupSafe                         1.0\r\nmccabe                             0.6.1\r\nmistune                            0.8.4\r\nmock                               2.0.0\r\nmore-itertools                     4.3.0\r\nnbconvert                          5.4.0\r\nnbformat                           4.4.0\r\nnose                               1.3.7\r\nnotebook                           5.7.0\r\nnumpy                              1.13.3\r\npackaging                          18.0\r\npandocfilters                      1.4.2\r\npathlib2                           2.3.2\r\npbr                                5.1.0\r\npexpect                            4.6.0\r\npickleshare                        0.7.5\r\npip                                18.1\r\npkginfo                            1.4.2\r\npluggy                             0.8.0\r\nply                                3.11\r\nprometheus-client                  0.4.2\r\nprompt-toolkit                     1.0.15\r\nptyprocess                         0.6.0\r\npy                                 1.5.2\r\npycodestyle                        2.4.0\r\npyflakes                           2.0.0\r\nPygments                           2.2.0\r\npylint                             1.9.3\r\npyparsing                          2.2.2\r\npytest                             3.9.2\r\npytest-cov                         2.5.1\r\npython-coveralls                   2.9.1\r\npython-dateutil                    2.7.4\r\npytz                               2018.6\r\npywbem                             0.12.1.dev133 /home/travis/build/pywbem/pywbem\r\nPyYAML                             3.13\r\npyzmq                              17.1.2\r\nqtconsole                          4.4.2\r\nreadme-renderer                    23.0\r\nrequests                           2.20.0\r\nrequests-toolbelt                  0.8.0\r\nscandir                            1.9.0\r\nSend2Trash                         1.5.0\r\nsetuptools                         40.4.3\r\nsimplegeneric                      0.8.1\r\nsingledispatch                     3.4.0.3\r\nsix                                1.11.0\r\nsmmap2                             2.0.5\r\nsnowballstemmer                    1.2.1\r\nSphinx                             1.8.1\r\nsphinx-git                         10.1.1\r\nsphinxcontrib-websupport           1.1.0\r\nterminado                          0.8.1\r\ntestfixtures                       5.4.0\r\ntestpath                           0.4.2\r\ntornado                            4.5.3\r\ntqdm                               4.28.1\r\ntraceback2                         1.4.0\r\ntraitlets                          4.3.2\r\ntwine                              1.12.1\r\ntyping                             3.6.6\r\nunittest2                          1.1.0\r\nurllib3                            1.24\r\nwcwidth                            0.1.7\r\nwebencodings                       0.5.1\r\nwheel                              0.32.2\r\nwidgetsnbextension                 3.4.2\r\nwrapt                              1.10.11\r\nyamlordereddictloader              0.4.0         \r\n```\r\n- [x] pytest and operating system versions\r\n   * MacOS High Sierra, but happens also on Ubuntu 16.04 (Travis) and Windows (Appveyor)\r\n   * Python 2.7.15 (on mac), Python 3.4 (on Travis)\r\n- [x] Minimal example if possible\r\n   The following is a simple version of the code that caused the TypeError to be raised, and I verified that it reproduces the issue with pytest==3.9.2 (and that it succeeds with pytest==3.9.1):\r\n\r\n```\r\n#!/usr/bin/env python\r\n\r\nimport pytest\r\nimport warnings\r\n\r\ndef issue_warning():\r\n   warnings.warn(\r\n        \"Setting the xyz property is deprecated\",\r\n        DeprecationWarning, 2)\r\n\r\ndef test_warn():\r\n    with pytest.warns(DeprecationWarning):\r\n        issue_warning()\r\n```\r\n","closed_by":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/4243/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/4243/timeline","performed_via_github_app":null,"state_reason":"completed"}