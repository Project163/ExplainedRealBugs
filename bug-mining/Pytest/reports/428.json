{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/12275","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12275/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12275/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12275/events","html_url":"https://github.com/pytest-dev/pytest/issues/12275","id":2270349886,"node_id":"I_kwDOAjwLdc6HUso-","number":12275,"title":"v8.2.0 raises `Can't instantiate abstract class` when a test class implements an abstract class","user":{"login":"MartinBraquet","id":25173236,"node_id":"MDQ6VXNlcjI1MTczMjM2","avatar_url":"https://avatars.githubusercontent.com/u/25173236?v=4","gravatar_id":"","url":"https://api.github.com/users/MartinBraquet","html_url":"https://github.com/MartinBraquet","followers_url":"https://api.github.com/users/MartinBraquet/followers","following_url":"https://api.github.com/users/MartinBraquet/following{/other_user}","gists_url":"https://api.github.com/users/MartinBraquet/gists{/gist_id}","starred_url":"https://api.github.com/users/MartinBraquet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MartinBraquet/subscriptions","organizations_url":"https://api.github.com/users/MartinBraquet/orgs","repos_url":"https://api.github.com/users/MartinBraquet/repos","events_url":"https://api.github.com/users/MartinBraquet/events{/privacy}","received_events_url":"https://api.github.com/users/MartinBraquet/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":224849193,"node_id":"MDU6TGFiZWwyMjQ4NDkxOTM=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/type:%20bug","name":"type: bug","color":"fc2929","default":false,"description":"problem that needs to be addressed"},{"id":315571544,"node_id":"MDU6TGFiZWwzMTU1NzE1NDQ=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/type:%20regression","name":"type: regression","color":"f7c6c7","default":false,"description":"indicates a problem that was introduced in a release which was working previously"},{"id":346031262,"node_id":"MDU6TGFiZWwzNDYwMzEyNjI=","url":"https://api.github.com/repos/pytest-dev/pytest/labels/plugin:%20unittest","name":"plugin: unittest","color":"006b75","default":false,"description":"related to the unittest integration builtin plugin"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2024-04-30T02:13:55Z","updated_at":"2024-05-13T17:29:02Z","closed_at":"2024-05-13T17:22:11Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Before, we could have a test class inheriting from an ABC (and unittest.TestCase), now it errors because pytest is trying to instantiate the ABC itself. Running pytest should only instantiate the child test class (which indeed implements all the abstract methods of its ABC parent).\r\nThis issue does not appear in v8.1.2 and was likely introduced in https://github.com/pytest-dev/pytest/pull/12089.\r\n\r\nMinimal example:\r\n```python\r\nfrom abc import ABC, abstractmethod\r\nfrom unittest import TestCase\r\n\r\n\r\nclass Base(TestCase, ABC):\r\n    @abstractmethod\r\n    def foo(self): ...\r\n\r\n\r\nclass Tests(Base):\r\n\r\n    def foo(self): ...\r\n\r\n    def test(self): ...\r\n```\r\n\r\nOutput:\r\n\r\n```\r\n(test) tests ðŸ”¥pytest test.py    \r\n============================================================================= test session starts ==============================================================================\r\nplatform darwin -- Python 3.9.19, pytest-8.2.0, pluggy-1.5.0\r\nrootdir: ...\r\nconfigfile: pytest.ini\r\nplugins: env-1.1.3\r\ncollected 1 item / 1 error                                                                                                                                                     \r\n\r\n==================================================================================== ERRORS ====================================================================================\r\n________________________________________________________________ ERROR collecting test.py ________________________________________________________________\r\n/Users/martin/miniconda3/envs/test/lib/python3.9/site-packages/_pytest/runner.py:341: in from_call\r\n    result: Optional[TResult] = func()\r\n/Users/martin/miniconda3/envs/test/lib/python3.9/site-packages/_pytest/runner.py:389: in collect\r\n    return list(collector.collect())\r\n/Users/martin/miniconda3/envs/test/lib/python3.9/site-packages/_pytest/unittest.py:90: in collect\r\n    self.session._fixturemanager.parsefactories(self.newinstance(), self.nodeid)\r\n/Users/martin/miniconda3/envs/test/lib/python3.9/site-packages/_pytest/unittest.py:75: in newinstance\r\n    return self.obj(\"runTest\")\r\nE   TypeError: Can't instantiate abstract class Base with abstract method foo\r\n=========================================================================== short test summary info ============================================================================\r\nERROR test.py::Base - TypeError: Can't instantiate abstract class Base with abstract method foo\r\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! Interrupted: 1 error during collection !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n=============================================================================== 1 error in 0.04s ===============================================================================\r\n```\r\n\r\npip list:\r\n\r\n```\r\nPackage        Version\r\n-------------- -------\r\nexceptiongroup 1.2.1\r\niniconfig      2.0.0\r\npackaging      24.0\r\npip            23.3.1\r\npluggy         1.5.0\r\npytest         8.2.0\r\npytest-env     1.1.3\r\nsetuptools     68.2.2\r\ntomli          2.0.1\r\nwheel          0.41.2\r\n```\r\nThanks for your work in general, it's a great package.","closed_by":{"login":"bluetech","id":1223550,"node_id":"MDQ6VXNlcjEyMjM1NTA=","avatar_url":"https://avatars.githubusercontent.com/u/1223550?v=4","gravatar_id":"","url":"https://api.github.com/users/bluetech","html_url":"https://github.com/bluetech","followers_url":"https://api.github.com/users/bluetech/followers","following_url":"https://api.github.com/users/bluetech/following{/other_user}","gists_url":"https://api.github.com/users/bluetech/gists{/gist_id}","starred_url":"https://api.github.com/users/bluetech/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluetech/subscriptions","organizations_url":"https://api.github.com/users/bluetech/orgs","repos_url":"https://api.github.com/users/bluetech/repos","events_url":"https://api.github.com/users/bluetech/events{/privacy}","received_events_url":"https://api.github.com/users/bluetech/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/12275/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/12275/timeline","performed_via_github_app":null,"state_reason":"completed"}