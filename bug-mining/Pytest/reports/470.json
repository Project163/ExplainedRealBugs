{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/9353","repository_url":"https://api.github.com/repos/pytest-dev/pytest","labels_url":"https://api.github.com/repos/pytest-dev/pytest/issues/9353/labels{/name}","comments_url":"https://api.github.com/repos/pytest-dev/pytest/issues/9353/comments","events_url":"https://api.github.com/repos/pytest-dev/pytest/issues/9353/events","html_url":"https://github.com/pytest-dev/pytest/issues/9353","id":1066948716,"node_id":"I_kwDOAjwLdc4_mFhs","number":9353,"title":"pytest.approx considers boolean numeric types","user":{"login":"The-Compiler","id":625793,"node_id":"MDQ6VXNlcjYyNTc5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/625793?v=4","gravatar_id":"","url":"https://api.github.com/users/The-Compiler","html_url":"https://github.com/The-Compiler","followers_url":"https://api.github.com/users/The-Compiler/followers","following_url":"https://api.github.com/users/The-Compiler/following{/other_user}","gists_url":"https://api.github.com/users/The-Compiler/gists{/gist_id}","starred_url":"https://api.github.com/users/The-Compiler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/The-Compiler/subscriptions","organizations_url":"https://api.github.com/users/The-Compiler/orgs","repos_url":"https://api.github.com/users/The-Compiler/repos","events_url":"https://api.github.com/users/The-Compiler/events{/privacy}","received_events_url":"https://api.github.com/users/The-Compiler/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1087456003,"node_id":"MDU6TGFiZWwxMDg3NDU2MDAz","url":"https://api.github.com/repos/pytest-dev/pytest/labels/topic:%20approx","name":"topic: approx","color":"11d6a1","default":false,"description":"related to pytest.approx function"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-11-30T08:41:32Z","updated_at":"2024-11-29T17:30:49Z","closed_at":"2024-11-29T17:30:49Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"From [the docs](https://docs.pytest.org/en/6.2.x/reference.html#pytest-approx):\r\n\r\n> You can also use `approx` to compare nonnumeric types, or dicts and sequences containing nonnumeric types, in which case it falls back to strict equality. This can be useful for comparing dicts and sequences that can contain optional values:\r\n>\r\n> ```python\r\n> >>> {\"required\": 1.0000005, \"optional\": None} == approx({\"required\": 1, \"optional\": None})\r\n> True\r\n> >>> [None, 1.0000005] == approx([None,1])\r\n> True\r\n> >>> [\"foo\", 1.0000005] == approx([None,1])\r\n> False\r\n> ```\r\n\r\nHowever, that seems to treat booleans as numerical values too:\r\n\r\n```python\r\nimport pytest\r\n\r\ndef test_approx():\r\n    d = {\"value\": 0.3, \"active\": True}\r\n    expected = {\"value\": 0.1 + 0.2, \"active\": False}\r\n    assert d == pytest.approx(expected)\r\n```\r\n\r\nresults in:\r\n\r\n```python\r\nAssertionError: assert {'active': True, 'value': 0.3} == approx({'value': 0.30000000000000004 ± 3.0e-07, 'active': False ± 1.0e-12})\r\n```\r\n\r\n(on Python 3.9.7 and pytest 6.2.5). Note the `False ± 1.0e-12`. While this is *technically* correct, it doesn't seem like a very reasonable way of comparing booleans.\r\n\r\ncc @jvansanten who seems to have implemented this originally in #7710.","closed_by":{"login":"nicoddemus","id":1085180,"node_id":"MDQ6VXNlcjEwODUxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1085180?v=4","gravatar_id":"","url":"https://api.github.com/users/nicoddemus","html_url":"https://github.com/nicoddemus","followers_url":"https://api.github.com/users/nicoddemus/followers","following_url":"https://api.github.com/users/nicoddemus/following{/other_user}","gists_url":"https://api.github.com/users/nicoddemus/gists{/gist_id}","starred_url":"https://api.github.com/users/nicoddemus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicoddemus/subscriptions","organizations_url":"https://api.github.com/users/nicoddemus/orgs","repos_url":"https://api.github.com/users/nicoddemus/repos","events_url":"https://api.github.com/users/nicoddemus/events{/privacy}","received_events_url":"https://api.github.com/users/nicoddemus/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pytest-dev/pytest/issues/9353/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pytest-dev/pytest/issues/9353/timeline","performed_via_github_app":null,"state_reason":"completed"}