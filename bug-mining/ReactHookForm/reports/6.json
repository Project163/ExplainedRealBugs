{"url":"https://api.github.com/repos/react-hook-form/react-hook-form/issues/555","repository_url":"https://api.github.com/repos/react-hook-form/react-hook-form","labels_url":"https://api.github.com/repos/react-hook-form/react-hook-form/issues/555/labels{/name}","comments_url":"https://api.github.com/repos/react-hook-form/react-hook-form/issues/555/comments","events_url":"https://api.github.com/repos/react-hook-form/react-hook-form/issues/555/events","html_url":"https://github.com/react-hook-form/react-hook-form/issues/555","id":527569257,"node_id":"MDU6SXNzdWU1Mjc1NjkyNTc=","number":555,"title":"Problem watching complex custom fields","user":{"login":"GProst","id":18051055,"node_id":"MDQ6VXNlcjE4MDUxMDU1","avatar_url":"https://avatars.githubusercontent.com/u/18051055?v=4","gravatar_id":"","url":"https://api.github.com/users/GProst","html_url":"https://github.com/GProst","followers_url":"https://api.github.com/users/GProst/followers","following_url":"https://api.github.com/users/GProst/following{/other_user}","gists_url":"https://api.github.com/users/GProst/gists{/gist_id}","starred_url":"https://api.github.com/users/GProst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GProst/subscriptions","organizations_url":"https://api.github.com/users/GProst/orgs","repos_url":"https://api.github.com/users/GProst/repos","events_url":"https://api.github.com/users/GProst/events{/privacy}","received_events_url":"https://api.github.com/users/GProst/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2019-11-23T15:15:42Z","updated_at":"2022-10-16T06:06:05Z","closed_at":"2019-11-25T01:46:07Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I'm trying to implement a single source of truth via react-hook-form for my dynamic form.\r\nLet's say there is a dynamic array of objects (`animals`) with props `name` and `type`, so the fields will have the following names: `animals[index].name` and `animals[index].type`. And `type` is a custom field.\r\nI watch all the animals using `watch('animals')`, animals can be added and removed dynamically and I have a few animals defined initially.\r\n\r\nThe problem appears when I try to register a custom field that has nested props, i.e. `register({name: 'animals[0].type'})`. It doesn't matter if I have `defaultValues` suppled to the `watch` method or not I have the following error:\r\n```\r\nUncaught TypeError: Cannot convert undefined or null to object\r\n```\r\n\r\nOne possible workaround that I figured out is to manually set initial value right after the field was registered, i.e. `setValue('animals[0].type', 'Cat')`. But this makes the form dirty and it's not the behavior I want for the initial fields.\r\n\r\nThe second issue is that even if I put `type: 'custom'` it won't re-render component after `setValue` is called. I believe this is only when it's a complex field (with nested props) and when you watch not all fields.\r\n\r\n**Expected behavior**\r\n1. `watch` method should either use `defaultValues` provided as the second argument when trying to resolve values for complex custom fields or just use `undefined` if `defaultValues` wasn't provided\r\n2. `setValue` should trigger re-render if a field was registered with `type: 'custom'` prop even if it's a complex custom field.\r\n\r\nP.S. Thank you for your great work on this library!","closed_by":{"login":"bluebill1049","id":10513364,"node_id":"MDQ6VXNlcjEwNTEzMzY0","avatar_url":"https://avatars.githubusercontent.com/u/10513364?v=4","gravatar_id":"","url":"https://api.github.com/users/bluebill1049","html_url":"https://github.com/bluebill1049","followers_url":"https://api.github.com/users/bluebill1049/followers","following_url":"https://api.github.com/users/bluebill1049/following{/other_user}","gists_url":"https://api.github.com/users/bluebill1049/gists{/gist_id}","starred_url":"https://api.github.com/users/bluebill1049/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluebill1049/subscriptions","organizations_url":"https://api.github.com/users/bluebill1049/orgs","repos_url":"https://api.github.com/users/bluebill1049/repos","events_url":"https://api.github.com/users/bluebill1049/events{/privacy}","received_events_url":"https://api.github.com/users/bluebill1049/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/react-hook-form/react-hook-form/issues/555/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/react-hook-form/react-hook-form/issues/555/timeline","performed_via_github_app":null,"state_reason":"completed"}