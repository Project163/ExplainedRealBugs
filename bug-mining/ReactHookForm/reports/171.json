{"url":"https://api.github.com/repos/react-hook-form/react-hook-form/issues/2938","repository_url":"https://api.github.com/repos/react-hook-form/react-hook-form","labels_url":"https://api.github.com/repos/react-hook-form/react-hook-form/issues/2938/labels{/name}","comments_url":"https://api.github.com/repos/react-hook-form/react-hook-form/issues/2938/comments","events_url":"https://api.github.com/repos/react-hook-form/react-hook-form/issues/2938/events","html_url":"https://github.com/react-hook-form/react-hook-form/issues/2938","id":703570482,"node_id":"MDU6SXNzdWU3MDM1NzA0ODI=","number":2938,"title":"Errors do not disappear when corrected for fields inside a composite value","user":{"login":"NotWhatUHadInMind","id":9998520,"node_id":"MDQ6VXNlcjk5OTg1MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9998520?v=4","gravatar_id":"","url":"https://api.github.com/users/NotWhatUHadInMind","html_url":"https://github.com/NotWhatUHadInMind","followers_url":"https://api.github.com/users/NotWhatUHadInMind/followers","following_url":"https://api.github.com/users/NotWhatUHadInMind/following{/other_user}","gists_url":"https://api.github.com/users/NotWhatUHadInMind/gists{/gist_id}","starred_url":"https://api.github.com/users/NotWhatUHadInMind/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NotWhatUHadInMind/subscriptions","organizations_url":"https://api.github.com/users/NotWhatUHadInMind/orgs","repos_url":"https://api.github.com/users/NotWhatUHadInMind/repos","events_url":"https://api.github.com/users/NotWhatUHadInMind/events{/privacy}","received_events_url":"https://api.github.com/users/NotWhatUHadInMind/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1260145696,"node_id":"MDU6TGFiZWwxMjYwMTQ1Njk2","url":"https://api.github.com/repos/react-hook-form/react-hook-form/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-09-17T13:05:48Z","updated_at":"2022-10-14T06:21:18Z","closed_at":"2020-09-18T02:44:28Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Describe the bug**\r\nI am trying to use a custom input, which returns a composite object as a value, and utilize it using the Controller component.\r\nThe value is set correctly, but I also have some yup validation rules for this object, and here comes the problem.\r\n\r\nIf this value object has at least two fields, and both fields have got validation errors, \r\nwhen I correct one of the fields I don't get the error immediately removed, only on the next change.\r\n\r\n**Codesandbox link (Required)**\r\nhttps://codesandbox.io/s/react-hook-form-composite-object-validation-0i50o\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior (in the sandbox):\r\n\r\n1. Press submit button (to get two errors for both User object fields)\r\n2. Type one symbol into the First Name input\r\n3. The error that the first name is required is still there!\r\n4. Type second one, the error disappears\r\n\r\nIf you remove the second field (lastName) from the validation rules, \r\nso you don't have more than one error for the composite object fields anymore, \r\nthe error finely disappears after the first input.\r\n\r\n**Expected behavior**\r\nErrors for nested object fields should disappear as soon as they are corrected.\r\n\r\n**Additional context**\r\nTested on versions 6.5.3 and 6.8.2.\r\n\r\n**Note**\r\nI have looked into the source code of the library and found out, that the issue might be somewhere around the [isSameError](https://github.com/react-hook-form/react-hook-form/blob/master/src/utils/isSameError.ts) function, which is called from [shouldRenderBasedOnError](https://github.com/react-hook-form/react-hook-form/blob/master/src/logic/shouldRenderBasedOnError.ts).\r\nIn the case of composite object value, it receives nested error object, but it does not seem that the isSameError function can handle that.\r\nExample of isSameError arguments from one of my debugging sessions (when I corrected startTimeInMills field):\r\n```\r\npreviousError: {\r\n  \"startTimeInMills\": {\r\n    \"message\": \"Required\",\r\n    \"type\": \"required\"\r\n  },\r\n  \"endTimeInMills\": {\r\n    \"message\": \"Required\",\r\n    \"type\": \"required\"\r\n  }\r\n}\r\n\r\nerror: {\r\n  \"endTimeInMills\": {\r\n    \"message\": \"Required\",\r\n    \"type\": \"required\"\r\n  }\r\n}\r\n```\r\nisSameError gives me true.","closed_by":{"login":"bluebill1049","id":10513364,"node_id":"MDQ6VXNlcjEwNTEzMzY0","avatar_url":"https://avatars.githubusercontent.com/u/10513364?v=4","gravatar_id":"","url":"https://api.github.com/users/bluebill1049","html_url":"https://github.com/bluebill1049","followers_url":"https://api.github.com/users/bluebill1049/followers","following_url":"https://api.github.com/users/bluebill1049/following{/other_user}","gists_url":"https://api.github.com/users/bluebill1049/gists{/gist_id}","starred_url":"https://api.github.com/users/bluebill1049/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluebill1049/subscriptions","organizations_url":"https://api.github.com/users/bluebill1049/orgs","repos_url":"https://api.github.com/users/bluebill1049/repos","events_url":"https://api.github.com/users/bluebill1049/events{/privacy}","received_events_url":"https://api.github.com/users/bluebill1049/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/react-hook-form/react-hook-form/issues/2938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/react-hook-form/react-hook-form/issues/2938/timeline","performed_via_github_app":null,"state_reason":"completed"}