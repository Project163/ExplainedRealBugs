diff --git a/src/logic/generateId.ts b/src/logic/generateId.ts
index ba0a48dc..6f918a9f 100644
--- a/src/logic/generateId.ts
+++ b/src/logic/generateId.ts
@@ -1,5 +1,9 @@
+import isTypeUndefined from '../utils/isTypeUndefined';
+
 export default () => {
-  const d = performance.now() * 1000;
+  const d = isTypeUndefined(performance)
+    ? Date.now()
+    : performance.now() * 1000;
   return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
     const r = (Math.random() * 16 + d) % 16 | 0;
     return (c == 'x' ? r : (r & 0x3) | 0x8).toString(16);
diff --git a/src/useForm.ts b/src/useForm.ts
index 6ce3ae06..50b24a37 100644
--- a/src/useForm.ts
+++ b/src/useForm.ts
@@ -23,13 +23,14 @@ import isSameError from './utils/isSameError';
 import isUndefined from './utils/isUndefined';
 import onDomRemove from './utils/onDomRemove';
 import omitObject from './utils/omitObject';
+import isTypeUndefined from './utils/isTypeUndefined';
 import get from './utils/get';
 import set from './utils/set';
 import unset from './utils/unset';
 import isMultipleSelect from './utils/isMultipleSelect';
 import modeChecker from './utils/validationModeChecker';
 import isNullOrUndefined from './utils/isNullOrUndefined';
-import { EVENTS, UNDEFINED, VALIDATION_MODE } from './constants';
+import { EVENTS, VALIDATION_MODE } from './constants';
 import { FormContextValues } from './contextTypes';
 import {
   DeepPartial,
@@ -89,9 +90,9 @@ export function useForm<FormValues extends FieldValues = FieldValues>({
   const fieldArrayNamesRef = useRef<Set<string>>(new Set());
   const [, render] = useState();
   const { isOnBlur, isOnSubmit } = useRef(modeChecker(mode)).current;
-  const isWindowUndefined = typeof window === UNDEFINED;
+  const isWindowUndefined = isTypeUndefined(window);
   const isWeb =
-    typeof document !== UNDEFINED &&
+    !isTypeUndefined(document) &&
     !isWindowUndefined &&
     !isUndefined(window.HTMLElement);
   const isProxyEnabled = isWeb && 'Proxy' in window;
diff --git a/src/utils/isTypeUndefined.ts b/src/utils/isTypeUndefined.ts
new file mode 100644
index 00000000..5e2cdaf0
--- /dev/null
+++ b/src/utils/isTypeUndefined.ts
@@ -0,0 +1,3 @@
+import { UNDEFINED } from '../constants';
+
+export default (data: any) => typeof data === UNDEFINED;
