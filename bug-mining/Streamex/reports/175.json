{"url":"https://api.github.com/repos/amaembo/streamex/issues/82","repository_url":"https://api.github.com/repos/amaembo/streamex","labels_url":"https://api.github.com/repos/amaembo/streamex/issues/82/labels{/name}","comments_url":"https://api.github.com/repos/amaembo/streamex/issues/82/comments","events_url":"https://api.github.com/repos/amaembo/streamex/issues/82/events","html_url":"https://github.com/amaembo/streamex/issues/82","id":140137979,"node_id":"MDU6SXNzdWUxNDAxMzc5Nzk=","number":82,"title":"Implement Emitter class which can easen non-trivial stream source creation","user":{"login":"amaembo","id":5114450,"node_id":"MDQ6VXNlcjUxMTQ0NTA=","avatar_url":"https://avatars.githubusercontent.com/u/5114450?v=4","gravatar_id":"","url":"https://api.github.com/users/amaembo","html_url":"https://github.com/amaembo","followers_url":"https://api.github.com/users/amaembo/followers","following_url":"https://api.github.com/users/amaembo/following{/other_user}","gists_url":"https://api.github.com/users/amaembo/gists{/gist_id}","starred_url":"https://api.github.com/users/amaembo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amaembo/subscriptions","organizations_url":"https://api.github.com/users/amaembo/orgs","repos_url":"https://api.github.com/users/amaembo/repos","events_url":"https://api.github.com/users/amaembo/events{/privacy}","received_events_url":"https://api.github.com/users/amaembo/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":198134866,"node_id":"MDU6TGFiZWwxOTgxMzQ4NjY=","url":"https://api.github.com/repos/amaembo/streamex/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/amaembo/streamex/milestones/11","html_url":"https://github.com/amaembo/streamex/milestone/11","labels_url":"https://api.github.com/repos/amaembo/streamex/milestones/11/labels","id":1616939,"node_id":"MDk6TWlsZXN0b25lMTYxNjkzOQ==","number":11,"title":"0.6.0","description":null,"creator":{"login":"amaembo","id":5114450,"node_id":"MDQ6VXNlcjUxMTQ0NTA=","avatar_url":"https://avatars.githubusercontent.com/u/5114450?v=4","gravatar_id":"","url":"https://api.github.com/users/amaembo","html_url":"https://github.com/amaembo","followers_url":"https://api.github.com/users/amaembo/followers","following_url":"https://api.github.com/users/amaembo/following{/other_user}","gists_url":"https://api.github.com/users/amaembo/gists{/gist_id}","starred_url":"https://api.github.com/users/amaembo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amaembo/subscriptions","organizations_url":"https://api.github.com/users/amaembo/orgs","repos_url":"https://api.github.com/users/amaembo/repos","events_url":"https://api.github.com/users/amaembo/events{/privacy}","received_events_url":"https://api.github.com/users/amaembo/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":10,"state":"closed","created_at":"2016-03-02T04:10:46Z","updated_at":"2016-03-31T05:33:32Z","due_on":null,"closed_at":"2016-03-31T05:33:32Z"},"comments":0,"created_at":"2016-03-11T09:40:51Z","updated_at":"2016-03-23T05:27:13Z","closed_at":"2016-03-23T05:27:07Z","author_association":"OWNER","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"There's an idea to implement a values emitter which can help creating the stream with non-trivial emission/termination strategy.\n\nGenerate the [Collatz sequence](https://en.wikipedia.org/wiki/Collatz_conjecture):\n\n```\npublic static Emitter<Integer> collatz(int start) {\n    return action -> {\n        action.accept(start);\n        return start == 1 ? null : collatz(start % 2 == 0 ? start / 2 : start * 3 + 1);\n    };\n}\n```\n\nUsage example:\n\n```\ncollatz(17).stream().toList();\n```\n\nGenerate a series of dice rolls representing the complete [Craps round](https://en.wikipedia.org/wiki/Craps):\n\n```\npublic static Emitter<Integer> crapsEmitter(IntSupplier dice, int point) {\n    return action -> {\n        int roll = dice.getAsInt();\n        action.accept(roll);\n        return roll == 7 || (point == 0 && (roll > 10 || roll < 4))\n                || (point != 0 && roll == point) ? null : crapsEmitter(dice,\n                point == 0 ? roll : point);\n    };\n}\n```\n\nUsage example:\n\n```\nRandom r = new Random();\nIntSupplier dice = () -> r.nextInt(6) + r.nextInt(6) + 2;\ncrapsEmitter(dice, 0).stream().forEach(System.out::println);\n```\n\nRead only ints from the specified `Scanner` leaving it in the known state:\n\n```\npublic static Emitter<Integer> scannerInts(Scanner sc) {\n    return sc.hasNextInt() ? action -> {\n        action.accept(sc.nextInt());\n        return scannerInts(sc);\n    } : null;\n}\n```\n\nIt's also easy to reimplement Stream.generate with emitter:\n\n```\npublic static <T> Emitter<T> generate(Supplier<T> supplier) {\n    return action -> {\n            action.accept(supplier.get());\n            return generate(supplier);\n    };\n}\n```\n\nOr `Stream.iterate` (even three-args form, see #79):\n\n```\npublic static <T> Emitter<T> iterate(T seed, Predicate<? super T> test, UnaryOperator<T> op) {\n    return test.test(seed) ? action -> {\n        action.accept(seed);\n        return iterate(op.apply(seed), test, op);\n    } : null;\n}\n```\n\nWhile such implementation add some overhead, it shows that the feature is quite powerful.\n\nIt's possible to implement this for primitive streams as well, though it should be tested whether `Emitter` overhead is not so significant compared to boxing overhead.\n- [x] Implementation\n- [x] JavaDoc\n- [x] Tests\n- [x] Changes\n- [x] Cheatsheet\n","closed_by":{"login":"amaembo","id":5114450,"node_id":"MDQ6VXNlcjUxMTQ0NTA=","avatar_url":"https://avatars.githubusercontent.com/u/5114450?v=4","gravatar_id":"","url":"https://api.github.com/users/amaembo","html_url":"https://github.com/amaembo","followers_url":"https://api.github.com/users/amaembo/followers","following_url":"https://api.github.com/users/amaembo/following{/other_user}","gists_url":"https://api.github.com/users/amaembo/gists{/gist_id}","starred_url":"https://api.github.com/users/amaembo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amaembo/subscriptions","organizations_url":"https://api.github.com/users/amaembo/orgs","repos_url":"https://api.github.com/users/amaembo/repos","events_url":"https://api.github.com/users/amaembo/events{/privacy}","received_events_url":"https://api.github.com/users/amaembo/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/amaembo/streamex/issues/82/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/amaembo/streamex/issues/82/timeline","performed_via_github_app":null,"state_reason":"completed"}