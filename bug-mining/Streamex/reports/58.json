{"url":"https://api.github.com/repos/amaembo/streamex/issues/32","repository_url":"https://api.github.com/repos/amaembo/streamex","labels_url":"https://api.github.com/repos/amaembo/streamex/issues/32/labels{/name}","comments_url":"https://api.github.com/repos/amaembo/streamex/issues/32/comments","events_url":"https://api.github.com/repos/amaembo/streamex/issues/32/events","html_url":"https://github.com/amaembo/streamex/issues/32","id":120326467,"node_id":"MDU6SXNzdWUxMjAzMjY0Njc=","number":32,"title":"New collector which collapses nested items","user":{"login":"amaembo","id":5114450,"node_id":"MDQ6VXNlcjUxMTQ0NTA=","avatar_url":"https://avatars.githubusercontent.com/u/5114450?v=4","gravatar_id":"","url":"https://api.github.com/users/amaembo","html_url":"https://github.com/amaembo","followers_url":"https://api.github.com/users/amaembo/followers","following_url":"https://api.github.com/users/amaembo/following{/other_user}","gists_url":"https://api.github.com/users/amaembo/gists{/gist_id}","starred_url":"https://api.github.com/users/amaembo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amaembo/subscriptions","organizations_url":"https://api.github.com/users/amaembo/orgs","repos_url":"https://api.github.com/users/amaembo/repos","events_url":"https://api.github.com/users/amaembo/events{/privacy}","received_events_url":"https://api.github.com/users/amaembo/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":198134866,"node_id":"MDU6TGFiZWwxOTgxMzQ4NjY=","url":"https://api.github.com/repos/amaembo/streamex/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/amaembo/streamex/milestones/6","html_url":"https://github.com/amaembo/streamex/milestone/6","labels_url":"https://api.github.com/repos/amaembo/streamex/milestones/6/labels","id":1436648,"node_id":"MDk6TWlsZXN0b25lMTQzNjY0OA==","number":6,"title":"0.5.1","description":null,"creator":{"login":"amaembo","id":5114450,"node_id":"MDQ6VXNlcjUxMTQ0NTA=","avatar_url":"https://avatars.githubusercontent.com/u/5114450?v=4","gravatar_id":"","url":"https://api.github.com/users/amaembo","html_url":"https://github.com/amaembo","followers_url":"https://api.github.com/users/amaembo/followers","following_url":"https://api.github.com/users/amaembo/following{/other_user}","gists_url":"https://api.github.com/users/amaembo/gists{/gist_id}","starred_url":"https://api.github.com/users/amaembo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amaembo/subscriptions","organizations_url":"https://api.github.com/users/amaembo/orgs","repos_url":"https://api.github.com/users/amaembo/repos","events_url":"https://api.github.com/users/amaembo/events{/privacy}","received_events_url":"https://api.github.com/users/amaembo/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":7,"state":"closed","created_at":"2015-12-01T04:44:27Z","updated_at":"2015-12-17T11:33:12Z","due_on":null,"closed_at":"2015-12-17T11:33:12Z"},"comments":2,"created_at":"2015-12-04T03:47:11Z","updated_at":"2015-12-15T05:14:07Z","closed_at":"2015-12-15T05:10:35Z","author_association":"OWNER","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"A new collector could be developed which is able to collect input elements to the sorted list removing elements which are considered to be the parts of another element. Elements have well-defined order (either natural order or specified by user-supplied comparator). Also user must supply a `BiPredicate<E, E> isPartOf` which accepts `(child, parent)` pair and returns true when `child` is a part of `parent`. The following invariants must hold:\n- for every A, B: `B isPartOf A => B > A` (every parent precedes its children according to the elements order)\n- for every A, B, C: `C isPartOf A && C > B && B > A => B isPartOf A` (all children immediately follow their parent according to the elements order)\n\nThe following signatures are proposed:\n\n```\nclass MoreCollectors {\n    public static <E> Collector<E, ?, List<E>> collapseNested(\n                        Comparator<? super E> comparator,\n                        BiPredicate<? super E, ? super E> isPartOf) {...}\n    public static <E extends Comparable<? super E>> Collector<E, ?, List<E>> collapseNested(\n                        BiPredicate<? super E, ? super E> isPartOf) {...}\n}\n```\n\n---\n\nFinal solution is to drop the comparator/comparable (assuming the stream is already properly sorted), rename the method to `dominators()` and swap the `BiPredicate` arguments. The `BiPredicate` transitivity is the only non-trivial requirement which must be held for correct processing in both sequential and parallel modes. Non-sorted inputs also could be used to solve some interesting problems. For example, this core leaves only numbers which are bigger than any preceding number:\n\n```\nstreamOfIntegers.collect(MoreCollectors.dominators((a, b) -> a >= b));\n```\n\nRelated to #29 \n- [x] Draft implementation\n- [x] Investigate possible ready solutions (if any) in other libraries (Apache Commons, Guava) to check whether there are best practices for such problem (nothing found which exactly matches given problem; Guava [RangeSet](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/RangeSet.html) is probably the closest thing, but still different).\n- [x] Unit tests\n- [x] Benchmark, compare with naive solution which sorts the whole input according to comparator, then processes the adjacent elements.\n- [x] JavaDoc\n- [x] CHANGES\n- [x] CHEATSHEET\n","closed_by":{"login":"amaembo","id":5114450,"node_id":"MDQ6VXNlcjUxMTQ0NTA=","avatar_url":"https://avatars.githubusercontent.com/u/5114450?v=4","gravatar_id":"","url":"https://api.github.com/users/amaembo","html_url":"https://github.com/amaembo","followers_url":"https://api.github.com/users/amaembo/followers","following_url":"https://api.github.com/users/amaembo/following{/other_user}","gists_url":"https://api.github.com/users/amaembo/gists{/gist_id}","starred_url":"https://api.github.com/users/amaembo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amaembo/subscriptions","organizations_url":"https://api.github.com/users/amaembo/orgs","repos_url":"https://api.github.com/users/amaembo/repos","events_url":"https://api.github.com/users/amaembo/events{/privacy}","received_events_url":"https://api.github.com/users/amaembo/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/amaembo/streamex/issues/32/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/amaembo/streamex/issues/32/timeline","performed_via_github_app":null,"state_reason":"completed"}