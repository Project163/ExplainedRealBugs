{"url":"https://api.github.com/repos/amaembo/streamex/issues/141","repository_url":"https://api.github.com/repos/amaembo/streamex","labels_url":"https://api.github.com/repos/amaembo/streamex/issues/141/labels{/name}","comments_url":"https://api.github.com/repos/amaembo/streamex/issues/141/comments","events_url":"https://api.github.com/repos/amaembo/streamex/issues/141/events","html_url":"https://github.com/amaembo/streamex/issues/141","id":197688164,"node_id":"MDU6SXNzdWUxOTc2ODgxNjQ=","number":141,"title":"add flatArray() shortcut","user":{"login":"mmariotti","id":7235289,"node_id":"MDQ6VXNlcjcyMzUyODk=","avatar_url":"https://avatars.githubusercontent.com/u/7235289?v=4","gravatar_id":"","url":"https://api.github.com/users/mmariotti","html_url":"https://github.com/mmariotti","followers_url":"https://api.github.com/users/mmariotti/followers","following_url":"https://api.github.com/users/mmariotti/following{/other_user}","gists_url":"https://api.github.com/users/mmariotti/gists{/gist_id}","starred_url":"https://api.github.com/users/mmariotti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmariotti/subscriptions","organizations_url":"https://api.github.com/users/mmariotti/orgs","repos_url":"https://api.github.com/users/mmariotti/repos","events_url":"https://api.github.com/users/mmariotti/events{/privacy}","received_events_url":"https://api.github.com/users/mmariotti/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":198134866,"node_id":"MDU6TGFiZWwxOTgxMzQ4NjY=","url":"https://api.github.com/repos/amaembo/streamex/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/amaembo/streamex/milestones/16","html_url":"https://github.com/amaembo/streamex/milestone/16","labels_url":"https://api.github.com/repos/amaembo/streamex/milestones/16/labels","id":2195606,"node_id":"MDk6TWlsZXN0b25lMjE5NTYwNg==","number":16,"title":"0.6.5","description":null,"creator":{"login":"amaembo","id":5114450,"node_id":"MDQ6VXNlcjUxMTQ0NTA=","avatar_url":"https://avatars.githubusercontent.com/u/5114450?v=4","gravatar_id":"","url":"https://api.github.com/users/amaembo","html_url":"https://github.com/amaembo","followers_url":"https://api.github.com/users/amaembo/followers","following_url":"https://api.github.com/users/amaembo/following{/other_user}","gists_url":"https://api.github.com/users/amaembo/gists{/gist_id}","starred_url":"https://api.github.com/users/amaembo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amaembo/subscriptions","organizations_url":"https://api.github.com/users/amaembo/orgs","repos_url":"https://api.github.com/users/amaembo/repos","events_url":"https://api.github.com/users/amaembo/events{/privacy}","received_events_url":"https://api.github.com/users/amaembo/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":3,"state":"closed","created_at":"2016-12-14T03:03:54Z","updated_at":"2017-01-22T13:09:28Z","due_on":null,"closed_at":"2017-01-22T13:09:28Z"},"comments":2,"created_at":"2016-12-27T11:16:05Z","updated_at":"2016-12-29T10:42:12Z","closed_at":"2016-12-28T13:52:43Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Hello, \r\nsometimes I need to flatMap an array, that can possibly be null.\r\nThis scenario is not so common, but it is encountered. \r\nA trivial (but meaningful) example is when working with Files, because `File.listFiles()` states:\r\n> If this abstract pathname does not denote a directory, then this method returns null. Otherwise an array of File objects is returned, one for each file or directory in the directory.\r\n\r\nSo, to flat file structure (single level) you have to:\r\n\r\n```\r\n// specific approach: null-check is based on doc statement\r\n.flatMap(x -> x.isDirectory() ? Arrays.stream(x.listFiles()) : null)\r\n```\r\nOR\r\n```\r\n// specific approach: same as before, but using only method references\r\n.filter(File::isDirectory) \r\n.map(File::listFiles)\r\n.flatMap(Arrays::stream)\r\n```\r\nOR\r\n```\r\n// generic approach: preemptive null pruning (sub-optimal time consuming?)\r\n.map(File::listFiles) \r\n.nonNull()\r\n.flatMap(Arrays::stream)\r\n```\r\n\r\nBecause of this, I suggest to add the `AbstractStreamEx.flatArray` just like the  `AbstractStreamEx.flatCollection`:\r\n```\r\npublic <R> StreamEx<R> flatArray(Function<? super T, ? extends R[]> mapper) {\r\n\treturn flatMap(t -> {\r\n\t\tR[] a = mapper.apply(t);\r\n\t\treturn a == null ? null : Arrays.stream(a);\r\n\t});\r\n}\r\n```\r\n\r\nThank you!","closed_by":{"login":"amaembo","id":5114450,"node_id":"MDQ6VXNlcjUxMTQ0NTA=","avatar_url":"https://avatars.githubusercontent.com/u/5114450?v=4","gravatar_id":"","url":"https://api.github.com/users/amaembo","html_url":"https://github.com/amaembo","followers_url":"https://api.github.com/users/amaembo/followers","following_url":"https://api.github.com/users/amaembo/following{/other_user}","gists_url":"https://api.github.com/users/amaembo/gists{/gist_id}","starred_url":"https://api.github.com/users/amaembo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amaembo/subscriptions","organizations_url":"https://api.github.com/users/amaembo/orgs","repos_url":"https://api.github.com/users/amaembo/repos","events_url":"https://api.github.com/users/amaembo/events{/privacy}","received_events_url":"https://api.github.com/users/amaembo/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/amaembo/streamex/issues/141/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/amaembo/streamex/issues/141/timeline","performed_via_github_app":null,"state_reason":"completed"}