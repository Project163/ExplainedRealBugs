diff --git a/src/main/java/one/util/streamex/HeadTailSpliterator.java b/src/main/java/one/util/streamex/HeadTailSpliterator.java
index 13680a4..eaabaa0 100644
--- a/src/main/java/one/util/streamex/HeadTailSpliterator.java
+++ b/src/main/java/one/util/streamex/HeadTailSpliterator.java
@@ -91,8 +91,14 @@ import static one.util.streamex.StreamExInternals.*;
             source = null;
             mapper = null;
             emptyMapper = null;
-            context.combine(stream);
-            target = stream == null ? Spliterators.emptySpliterator() : stream.spliterator();
+            if(stream == null) {
+                target = Spliterators.emptySpliterator();
+            } else {
+                StreamContext ctx = StreamContext.of(stream);
+                if(ctx.closeHandler != null)
+                    context.onClose(ctx.closeHandler);
+                target = stream.spliterator();
+            }
         }
         return true;
     }
diff --git a/src/main/java/one/util/streamex/StreamContext.java b/src/main/java/one/util/streamex/StreamContext.java
index f8dc9de..f64c0ba 100644
--- a/src/main/java/one/util/streamex/StreamContext.java
+++ b/src/main/java/one/util/streamex/StreamContext.java
@@ -102,7 +102,7 @@ import static one.util.streamex.StreamExInternals.*;
         }
     }
 
-    private Runnable compose(Runnable r1, Runnable r2) {
+    private static Runnable compose(Runnable r1, Runnable r2) {
         return () -> {
             try {
                 r1.run();
diff --git a/src/main/java/one/util/streamex/StreamExInternals.java b/src/main/java/one/util/streamex/StreamExInternals.java
index bd1f3cc..bcb8854 100644
--- a/src/main/java/one/util/streamex/StreamExInternals.java
+++ b/src/main/java/one/util/streamex/StreamExInternals.java
@@ -1063,9 +1063,7 @@ import java.util.stream.Stream;
         return (T) NONE;
     }
     
-    static <T extends BaseStream<?, ?>> boolean mustCloseStream(BaseStream<?, ?> target) {
-        if(target == null)
-            return false;
+    static boolean mustCloseStream(BaseStream<?, ?> target) {
         try {
             if (SOURCE_STAGE != null && SOURCE_CLOSE_ACTION != null
                 && SOURCE_CLOSE_ACTION.get(SOURCE_STAGE.get(target)) == null)
diff --git a/src/test/java/one/util/streamex/BaseStreamExTest.java b/src/test/java/one/util/streamex/BaseStreamExTest.java
index 3901c50..4400f17 100644
--- a/src/test/java/one/util/streamex/BaseStreamExTest.java
+++ b/src/test/java/one/util/streamex/BaseStreamExTest.java
@@ -21,6 +21,7 @@ import java.util.ArrayList;
 import java.util.Arrays;
 import java.util.List;
 import java.util.Spliterator;
+import java.util.concurrent.atomic.AtomicBoolean;
 import java.util.function.Function;
 import java.util.stream.Stream;
 
@@ -78,11 +79,12 @@ public class BaseStreamExTest {
     
     @Test
     public void testCloseException() {
+        AtomicBoolean flag = new AtomicBoolean();
         Function<String, Runnable> ex = str -> () -> {throw new IllegalStateException(str);};
         StreamEx<Integer> stream = StreamEx.of(Stream.of(1,2,3).onClose(ex.apply("Orig stream")))
             .onClose(ex.apply("StreamEx"))
             .map(x -> x*2)
-            .onClose(ex.apply("After map"))
+            .onClose(() -> flag.set(true))
             .pairMap((a, b) -> a+b)
             .onClose(ex.apply("After pairMap"))
             .append(4)
@@ -95,9 +97,10 @@ public class BaseStreamExTest {
         }
         catch(IllegalStateException e) {
             assertEquals("Orig stream", e.getMessage());
-            assertEquals(Arrays.asList("StreamEx", "After map", "After pairMap", "After append", "Prepended Stream",
+            assertEquals(Arrays.asList("StreamEx", "After pairMap", "After append", "Prepended Stream",
                 "Prepended StreamEx"), StreamEx.of(e.getSuppressed()).map(IllegalStateException.class::cast).map(
                 Throwable::getMessage).toList());
+            assertTrue(flag.get());
             return;
         }
         fail("No exception");
diff --git a/src/test/java/one/util/streamex/LongStreamExTest.java b/src/test/java/one/util/streamex/LongStreamExTest.java
index b321024..777b8f9 100644
--- a/src/test/java/one/util/streamex/LongStreamExTest.java
+++ b/src/test/java/one/util/streamex/LongStreamExTest.java
@@ -15,6 +15,7 @@
  */
 package one.util.streamex;
 
+import java.util.ArrayList;
 import java.util.Arrays;
 import java.util.List;
 import java.util.Map;
@@ -233,6 +234,13 @@ public class LongStreamExTest {
         assertFalse(LongStreamEx.of(1).noneMatch(x -> true));
         assertTrue(LongStreamEx.of(1).noneMatch(x -> false));
     }
+    
+    @Test
+    public void testForEach() {
+        List<Long> list = new ArrayList<>();
+        LongStreamEx.of(1).forEach(list::add);
+        assertEquals(Arrays.asList(1L), list);
+    }
 
     @Test
     public void testFlatMap() {
diff --git a/src/test/java/one/util/streamex/StreamExTest.java b/src/test/java/one/util/streamex/StreamExTest.java
index f69e48b..9716fda 100644
--- a/src/test/java/one/util/streamex/StreamExTest.java
+++ b/src/test/java/one/util/streamex/StreamExTest.java
@@ -453,6 +453,11 @@ public class StreamExTest {
         assertSame(s, s.prepend(new ArrayList<>()));
         assertSame(s, s.prepend(Stream.empty()));
         assertNotSame(s, s.prepend(new ConcurrentLinkedQueue<>()));
+        
+        assertTrue(StreamEx.of("a", "b").prepend(Stream.of("c").parallel()).isParallel());
+        assertTrue(StreamEx.of("a", "b").parallel().prepend(Stream.of("c").parallel()).isParallel());
+        assertTrue(StreamEx.of("a", "b").parallel().prepend(Stream.of("c")).isParallel());
+        assertFalse(StreamEx.of("a", "b").prepend(Stream.of("c")).isParallel());
     }
     
     @Test
