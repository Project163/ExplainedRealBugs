diff --git a/src/main/java/one/util/streamex/PairSpliterator.java b/src/main/java/one/util/streamex/PairSpliterator.java
index e5d05a7..a21732e 100644
--- a/src/main/java/one/util/streamex/PairSpliterator.java
+++ b/src/main/java/one/util/streamex/PairSpliterator.java
@@ -41,6 +41,8 @@ import static one.util.streamex.StreamExInternals.*;
     static final int MODE_PAIRS = 0;
     static final int MODE_MAP_FIRST = 1;
     static final int MODE_MAP_LAST = 2;
+    static final int MODE_MAP_FIRST_OR_ELSE = 3;
+    static final int MODE_MAP_LAST_OR_ELSE = 4;
     
     private static Sink<?> EMPTY = new Sink<>(null);
     // Common lock for all the derived spliterators
@@ -126,7 +128,7 @@ import static one.util.streamex.StreamExInternals.*;
             sink.other = other;
             other.other = sink;
             other.push(headTail, null, true);
-            if(mode == MODE_MAP_FIRST)
+            if(mode == MODE_MAP_FIRST || mode == MODE_MAP_FIRST_OR_ELSE)
                 this.left = sink;
             else
                 this.right = sink;
@@ -194,6 +196,14 @@ import static one.util.streamex.StreamExInternals.*;
             this.mapper = (BiFunction<? super T, ? super T, ? extends R>) m;
         }
 
+        @SuppressWarnings("unchecked")
+        PSOfRef(Function<? super T, ? extends R> boundMapper, Function<? super T, ? extends R> elseMapper, Spliterator<T> source, boolean first) {
+            super(source, first ? MODE_MAP_FIRST_OR_ELSE : MODE_MAP_LAST_OR_ELSE, (T)HEAD_TAIL);
+            this.mapper = first ? 
+                ((a, b) -> a == HEAD_TAIL ? boundMapper.apply(b) : elseMapper.apply(b)) :
+                ((a, b) -> b == HEAD_TAIL ? boundMapper.apply(a) : elseMapper.apply(a));
+        }
+
         @Override
         public void accept(T t) {
             cur = t;
diff --git a/src/main/java/one/util/streamex/StreamEx.java b/src/main/java/one/util/streamex/StreamEx.java
index 3a62d9e..a4899b0 100644
--- a/src/main/java/one/util/streamex/StreamEx.java
+++ b/src/main/java/one/util/streamex/StreamEx.java
@@ -188,6 +188,11 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
         return supply(new PairSpliterator.PSOfRef<>(mapper, spliterator(), true));
     }
 
+    public <R> StreamEx<R> mapFirstOrElse(Function<? super T, ? extends R> firstMapper,
+            Function<? super T, ? extends R> notFirstMapper) {
+        return new StreamEx<>(new PairSpliterator.PSOfRef<>(firstMapper, notFirstMapper, spliterator(), true), context);
+    }
+
     /**
      * Returns a stream where the last element is the replaced with the result
      * of applying the given function while the other elements are left intact.
@@ -207,6 +212,11 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
         return supply(new PairSpliterator.PSOfRef<>(mapper, spliterator(), false));
     }
 
+    public <R> StreamEx<R> mapLastOrElse(Function<? super T, ? extends R> notLastMapper,
+            Function<? super T, ? extends R> lastMapper) {
+        return new StreamEx<>(new PairSpliterator.PSOfRef<>(lastMapper, notLastMapper, spliterator(), false), context);
+    }
+
     /**
      * Creates a new {@code EntryStream} populated from entries of maps produced
      * by supplied mapper function which is applied to the every element of this
diff --git a/src/test/java/one/util/streamex/StreamExTest.java b/src/test/java/one/util/streamex/StreamExTest.java
index 7a369ad..99dcba2 100644
--- a/src/test/java/one/util/streamex/StreamExTest.java
+++ b/src/test/java/one/util/streamex/StreamExTest.java
@@ -1563,7 +1563,21 @@ public class StreamExTest {
         streamEx(asList("red", "green", "blue", "orange")::stream, s -> assertEquals("red, green, blue, or orange", s
                 .get().mapLast("or "::concat).joining(", ")));
     }
+    
+    @Test
+    public void testMapFirstOrElse() {
+        streamEx(() -> StreamEx.split("testString", ""), s -> assertEquals("Teststring", s
+                .get().mapFirstOrElse(String::toUpperCase, String::toLowerCase).joining()));
+    }
 
+    @Test
+    public void testMapLastOrElse() {
+        streamEx(asList("red", "green", "blue", "orange")::stream, s -> assertEquals("red, green, blue, or orange!", s
+            .get().mapLastOrElse(str -> str + ", ", str -> "or " + str + "!").joining()));
+        streamEx(asList("red", "green", "blue", "orange")::stream, s -> assertEquals("|- red\n|- green\n|- blue\n\\- orange",
+            s.get().mapLastOrElse("|- "::concat, "\\- "::concat).joining("\n")));
+    }
+    
     @Test
     public void testSplit() {
         assertFalse(StreamEx.split("str", "abcd").spliterator().getClass().getSimpleName().endsWith(
@@ -1639,6 +1653,9 @@ public class StreamExTest {
         Map<Integer, List<Integer>> expected = Collections
                 .singletonMap(0, IntStreamEx.range(0, 10000).boxed().toList());
         streamEx(() -> IntStreamEx.range(10000).boxed(), s -> assertEquals(expected, s.get().withFirst().grouping()));
+        
+        streamEx(() -> StreamEx.of(5, 10, 13, 12, 11), s -> assertEquals(asList("5+0", "5+5", "5+8", "5+7", "5+6"), s
+                .get().withFirst((a, b) -> a + "+" + (b - a)).toList()));
     }
 
     @Test
