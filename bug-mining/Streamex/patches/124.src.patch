diff --git a/src/main/java/one/util/streamex/AbstractStreamEx.java b/src/main/java/one/util/streamex/AbstractStreamEx.java
index 48d22e2..e553f6e 100644
--- a/src/main/java/one/util/streamex/AbstractStreamEx.java
+++ b/src/main/java/one/util/streamex/AbstractStreamEx.java
@@ -101,29 +101,19 @@ import static one.util.streamex.StreamExInternals.*;
         }
     }
 
-    AbstractStreamEx(Stream<T> stream, ExecutionStrategy strategy) {
-        super(stream, strategy);
+    AbstractStreamEx(Stream<T> stream, StreamContext context) {
+        super(stream, context);
     }
 
-    AbstractStreamEx(Spliterator<T> spliterator, ExecutionStrategy strategy) {
-        super(spliterator, strategy);
+    AbstractStreamEx(Spliterator<T> spliterator, StreamContext context) {
+        super(spliterator, context);
     }
     
     @Override
     final Stream<T> createStream() {
-        return StreamSupport.stream(spliterator, strategy.parallel);
+        return StreamSupport.stream(spliterator, context.parallel);
     }
 
-    final <R> Stream<R> delegateBase(Spliterator<R> spliterator) {
-        return forwardClose(StreamSupport.stream(spliterator, isParallel()));
-    }
-
-    final S delegate(Spliterator<T> spliterator) {
-        if(mustClose())
-            return supply(forwardClose(StreamSupport.stream(spliterator, isParallel())));
-        return supply(spliterator);
-    }
-    
     final S callWhile(Predicate<? super T> predicate, int methodId) {
         try {
             return supply((Stream<T>) JDK9_METHODS[IDX_STREAM][methodId].invokeExact(stream(), predicate));
@@ -149,8 +139,8 @@ import static one.util.streamex.StreamExInternals.*;
     }
 
     <R, A> R rawCollect(Collector<? super T, A, R> collector) {
-        if(strategy.fjp != null)
-            return strategy.terminate(collector, stream()::collect);
+        if(context.fjp != null)
+            return context.terminate(collector, stream()::collect);
         return stream().collect(collector);
     }
 
@@ -164,9 +154,8 @@ import static one.util.streamex.StreamExInternals.*;
             result = (Spliterator<T>) right;
         else
             result = new TailConcatSpliterator<>(left, right);
-        if(!mustClose() && !mustCloseStream(other))
-            return supply(result);
-        return supply(StreamExInternals.delegateClose(forwardClose(StreamSupport.stream(result, isParallel())), other));
+        context = context.combine(other);
+        return supply(result);
     }
 
     @SuppressWarnings("unchecked")
@@ -179,9 +168,8 @@ import static one.util.streamex.StreamExInternals.*;
             result = (Spliterator<T>) left;
         else
             result = new TailConcatSpliterator<>(left, right);
-        if(!mustClose() && !mustCloseStream(other))
-            return supply(result);
-        return supply(StreamExInternals.delegateClose(forwardClose(StreamSupport.stream(result, isParallel())), other));
+        context = context.combine(other);
+        return supply(result);
     }
 
     abstract S supply(Stream<T> stream);
@@ -230,42 +218,42 @@ import static one.util.streamex.StreamExInternals.*;
 
     @Override
     public <R> StreamEx<R> flatMap(Function<? super T, ? extends Stream<? extends R>> mapper) {
-        return new StreamEx<>(stream().flatMap(mapper), strategy);
+        return new StreamEx<>(stream().flatMap(mapper), context);
     }
 
     @Override
     public <R> StreamEx<R> map(Function<? super T, ? extends R> mapper) {
-        return new StreamEx<>(stream().map(mapper), strategy);
+        return new StreamEx<>(stream().map(mapper), context);
     }
 
     @Override
     public IntStreamEx mapToInt(ToIntFunction<? super T> mapper) {
-        return new IntStreamEx(stream().mapToInt(mapper), strategy);
+        return new IntStreamEx(stream().mapToInt(mapper), context);
     }
 
     @Override
     public LongStreamEx mapToLong(ToLongFunction<? super T> mapper) {
-        return new LongStreamEx(stream().mapToLong(mapper), strategy);
+        return new LongStreamEx(stream().mapToLong(mapper), context);
     }
 
     @Override
     public DoubleStreamEx mapToDouble(ToDoubleFunction<? super T> mapper) {
-        return new DoubleStreamEx(stream().mapToDouble(mapper), strategy);
+        return new DoubleStreamEx(stream().mapToDouble(mapper), context);
     }
 
     @Override
     public IntStreamEx flatMapToInt(Function<? super T, ? extends IntStream> mapper) {
-        return new IntStreamEx(stream().flatMapToInt(mapper), strategy);
+        return new IntStreamEx(stream().flatMapToInt(mapper), context);
     }
 
     @Override
     public LongStreamEx flatMapToLong(Function<? super T, ? extends LongStream> mapper) {
-        return new LongStreamEx(stream().flatMapToLong(mapper), strategy);
+        return new LongStreamEx(stream().flatMapToLong(mapper), context);
     }
 
     @Override
     public DoubleStreamEx flatMapToDouble(Function<? super T, ? extends DoubleStream> mapper) {
-        return new DoubleStreamEx(stream().flatMapToDouble(mapper), strategy);
+        return new DoubleStreamEx(stream().flatMapToDouble(mapper), context);
     }
 
     @Override
@@ -326,8 +314,8 @@ import static one.util.streamex.StreamExInternals.*;
         if (spliterator != null && !isParallel()) {
             spliterator().forEachRemaining(action);
         } else {
-            if(strategy.fjp != null)
-                strategy.terminate(() -> {
+            if(context.fjp != null)
+                context.terminate(() -> {
                     stream().forEach(action);
                     return null;
                 });
@@ -342,8 +330,8 @@ import static one.util.streamex.StreamExInternals.*;
         if (spliterator != null && !isParallel()) {
             spliterator().forEachRemaining(action);
         } else {
-            if(strategy.fjp != null)
-                strategy.terminate(() -> {
+            if(context.fjp != null)
+                context.terminate(() -> {
                     stream().forEachOrdered(action);
                     return null;
                 });
@@ -360,36 +348,36 @@ import static one.util.streamex.StreamExInternals.*;
 
     @Override
     public <A> A[] toArray(IntFunction<A[]> generator) {
-        if(strategy.fjp != null)
-            return strategy.terminate(generator, stream()::toArray);
+        if(context.fjp != null)
+            return context.terminate(generator, stream()::toArray);
         return stream().toArray(generator);
     }
 
     @Override
     public T reduce(T identity, BinaryOperator<T> accumulator) {
-        if(strategy.fjp != null)
-            return strategy.terminate(() -> stream().reduce(identity, accumulator));
+        if(context.fjp != null)
+            return context.terminate(() -> stream().reduce(identity, accumulator));
         return stream().reduce(identity, accumulator);
     }
 
     @Override
     public Optional<T> reduce(BinaryOperator<T> accumulator) {
-        if(strategy.fjp != null)
-            return strategy.terminate(accumulator, stream()::reduce);
+        if(context.fjp != null)
+            return context.terminate(accumulator, stream()::reduce);
         return stream().reduce(accumulator);
     }
 
     @Override
     public <U> U reduce(U identity, BiFunction<U, ? super T, U> accumulator, BinaryOperator<U> combiner) {
-        if(strategy.fjp != null)
-            return strategy.terminate(() -> stream().reduce(identity, accumulator, combiner));
+        if(context.fjp != null)
+            return context.terminate(() -> stream().reduce(identity, accumulator, combiner));
         return stream().reduce(identity, accumulator, combiner);
     }
 
     @Override
     public <R> R collect(Supplier<R> supplier, BiConsumer<R, ? super T> accumulator, BiConsumer<R, R> combiner) {
-        if(strategy.fjp != null)
-            return strategy.terminate(() -> stream().collect(supplier, accumulator, combiner));
+        if(context.fjp != null)
+            return context.terminate(() -> stream().collect(supplier, accumulator, combiner));
         return stream().collect(supplier, accumulator, combiner);
     }
 
@@ -435,7 +423,7 @@ import static one.util.streamex.StreamExInternals.*;
                 spltr = new OrderedCancellableSpliterator<>(spliterator, collector.supplier(), acc, combiner, finished);
             }
             return collector.finisher().apply(
-                new StreamEx<>(StreamSupport.stream(spltr, true), strategy).findFirst().get());
+                new StreamEx<>(StreamSupport.stream(spltr, true), context).findFirst().get());
         }
         return rawCollect(collector);
     }
@@ -452,22 +440,22 @@ import static one.util.streamex.StreamExInternals.*;
 
     @Override
     public long count() {
-        if(strategy.fjp != null)
-            return strategy.terminate(stream()::count);
+        if(context.fjp != null)
+            return context.terminate(stream()::count);
         return stream().count();
     }
 
     @Override
     public boolean anyMatch(Predicate<? super T> predicate) {
-        if(strategy.fjp != null)
-            return strategy.terminate(predicate, stream()::anyMatch);
+        if(context.fjp != null)
+            return context.terminate(predicate, stream()::anyMatch);
         return stream().anyMatch(predicate);
     }
 
     @Override
     public boolean allMatch(Predicate<? super T> predicate) {
-        if(strategy.fjp != null)
-            return strategy.terminate(predicate, stream()::allMatch);
+        if(context.fjp != null)
+            return context.terminate(predicate, stream()::allMatch);
         return stream().allMatch(predicate);
     }
 
@@ -478,15 +466,15 @@ import static one.util.streamex.StreamExInternals.*;
 
     @Override
     public Optional<T> findFirst() {
-        if(strategy.fjp != null)
-            return strategy.terminate(stream()::findFirst);
+        if(context.fjp != null)
+            return context.terminate(stream()::findFirst);
         return stream().findFirst();
     }
 
     @Override
     public Optional<T> findAny() {
-        if(strategy.fjp != null)
-            return strategy.terminate(stream()::findAny);
+        if(context.fjp != null)
+            return context.terminate(stream()::findAny);
         return stream().findAny();
     }
 
@@ -1135,8 +1123,8 @@ import static one.util.streamex.StreamExInternals.*;
      * @see #toList()
      */
     public <R> R toListAndThen(Function<List<T>, R> finisher) {
-        if(strategy.fjp != null)
-            return strategy.terminate(() -> finisher.apply(toList()));
+        if(context.fjp != null)
+            return context.terminate(() -> finisher.apply(toList()));
         return finisher.apply(toList());
     }
 
@@ -1565,7 +1553,7 @@ import static one.util.streamex.StreamExInternals.*;
      * @since 0.3.2
      */
     public S skipOrdered(long n) {
-        return delegate((isParallel() ? StreamSupport.stream(spliterator(), false) : stream()).skip(n).spliterator());
+        return supply((isParallel() ? StreamSupport.stream(spliterator(), false) : stream()).skip(n).spliterator());
     }
 
     /**
@@ -1593,7 +1581,7 @@ import static one.util.streamex.StreamExInternals.*;
         if (JDK9_METHODS != null) {
             return callWhile(predicate, IDX_TAKE_WHILE);
         }
-        return delegate(new AbstractStreamEx.TDOfRef<>(spliterator(), false, predicate));
+        return supply(new AbstractStreamEx.TDOfRef<>(spliterator(), false, predicate));
     }
 
     /**
@@ -1622,6 +1610,6 @@ import static one.util.streamex.StreamExInternals.*;
         if (JDK9_METHODS != null) {
             return callWhile(predicate, IDX_DROP_WHILE);
         }
-        return delegate(new AbstractStreamEx.TDOfRef<>(spliterator(), true, predicate));
+        return supply(new AbstractStreamEx.TDOfRef<>(spliterator(), true, predicate));
     }
 }
diff --git a/src/main/java/one/util/streamex/BaseStreamEx.java b/src/main/java/one/util/streamex/BaseStreamEx.java
index f6db668..0ddab46 100644
--- a/src/main/java/one/util/streamex/BaseStreamEx.java
+++ b/src/main/java/one/util/streamex/BaseStreamEx.java
@@ -28,21 +28,21 @@ import java.util.stream.BaseStream;
 
     private S stream;
     SPLTR spliterator;
-    ExecutionStrategy strategy;
+    StreamContext context;
     
-    BaseStreamEx(S stream, ExecutionStrategy strategy) {
+    BaseStreamEx(S stream, StreamContext context) {
         this.stream = stream;
-        this.strategy = strategy;
+        this.context = context;
     }
 
-    BaseStreamEx(SPLTR spliterator, ExecutionStrategy strategy) {
+    BaseStreamEx(SPLTR spliterator, StreamContext context) {
         this.spliterator = spliterator;
-        this.strategy = strategy;
+        this.context = context;
     }
     
     abstract S createStream();
 
-    S stream() {
+    final S stream() {
         if(stream != null)
             return stream;
         if(spliterator == null)
@@ -51,14 +51,6 @@ import java.util.stream.BaseStream;
         spliterator = null;
         return stream;
     }
-    
-    <B extends BaseStream<?, ?>> B forwardClose(B proxy) {
-        return StreamExInternals.delegateClose(proxy, stream);
-    }
-
-    boolean mustClose() {
-        return StreamExInternals.mustCloseStream(stream);
-    }
 
     @SuppressWarnings("unchecked")
     @Override
@@ -75,13 +67,13 @@ import java.util.stream.BaseStream;
 
     @Override
     public boolean isParallel() {
-        return strategy.parallel;
+        return context.parallel;
     }
 
     @SuppressWarnings("unchecked")
     @Override
     public S sequential() {
-        strategy = ExecutionStrategy.SEQUENTIAL;
+        context = context.sequential();
         if(stream != null)
             stream = stream.sequential();
         return (S) this;
@@ -98,7 +90,7 @@ import java.util.stream.BaseStream;
     @SuppressWarnings("unchecked")
     @Override
     public S parallel() {
-        strategy = ExecutionStrategy.PARALLEL;
+        context = context.parallel();
         if(stream != null)
             stream = stream.parallel();
         return (S)this;
@@ -125,7 +117,7 @@ import java.util.stream.BaseStream;
      */
     @SuppressWarnings("unchecked")
     public S parallel(ForkJoinPool fjp) {
-        strategy = new ExecutionStrategy(fjp);
+        context = context.parallel(fjp);
         return (S) this;
     }
 
@@ -139,15 +131,12 @@ import java.util.stream.BaseStream;
     @SuppressWarnings("unchecked")
     @Override
     public S onClose(Runnable closeHandler) {
-        stream = stream().onClose(closeHandler);
+        context = context.onClose(closeHandler);
         return (S) this;
     }
 
     @Override
     public void close() {
-        if(stream != null)
-            stream.close();
+        context.close();
     }
-
-    
 }
diff --git a/src/main/java/one/util/streamex/DoubleStreamEx.java b/src/main/java/one/util/streamex/DoubleStreamEx.java
index 57588e2..ad6824c 100644
--- a/src/main/java/one/util/streamex/DoubleStreamEx.java
+++ b/src/main/java/one/util/streamex/DoubleStreamEx.java
@@ -106,12 +106,12 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
         }
     }
 
-    DoubleStreamEx(DoubleStream stream, ExecutionStrategy strategy) {
-        super(stream, strategy);
+    DoubleStreamEx(DoubleStream stream, StreamContext context) {
+        super(stream, context);
     }
 
-    DoubleStreamEx(Spliterator.OfDouble spliterator, ExecutionStrategy strategy) {
-        super(spliterator, strategy);
+    DoubleStreamEx(Spliterator.OfDouble spliterator, StreamContext context) {
+        super(spliterator, context);
     }
 
     @Override
@@ -119,16 +119,18 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
         return StreamSupport.doubleStream(spliterator, isParallel());
     }
 
+    private static DoubleStreamEx seq(DoubleStream stream) {
+        return new DoubleStreamEx(stream, StreamContext.SEQUENTIAL);
+    }
+
     final DoubleStreamEx delegate(Spliterator.OfDouble spliterator) {
-        if(!mustClose())
-            return new DoubleStreamEx(spliterator, strategy);
-        return new DoubleStreamEx(forwardClose(StreamSupport.doubleStream(spliterator, isParallel())), strategy);
+        return new DoubleStreamEx(spliterator, context);
     }
 
     final DoubleStreamEx callWhile(DoublePredicate predicate, int methodId) {
         try {
             return new DoubleStreamEx(
-                (DoubleStream) JDK9_METHODS[IDX_DOUBLE_STREAM][methodId].invokeExact(stream(), predicate), strategy);
+                (DoubleStream) JDK9_METHODS[IDX_DOUBLE_STREAM][methodId].invokeExact(stream(), predicate), context);
         } catch (Error | RuntimeException e) {
             throw e;
         } catch (Throwable e) {
@@ -148,7 +150,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
 
     @Override
     public DoubleStreamEx filter(DoublePredicate predicate) {
-        return new DoubleStreamEx(stream().filter(predicate), strategy);
+        return new DoubleStreamEx(stream().filter(predicate), context);
     }
 
     /**
@@ -228,7 +230,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
 
     @Override
     public DoubleStreamEx map(DoubleUnaryOperator mapper) {
-        return new DoubleStreamEx(stream().map(mapper), strategy);
+        return new DoubleStreamEx(stream().map(mapper), context);
     }
 
     /**
@@ -272,17 +274,17 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
 
     @Override
     public <U> StreamEx<U> mapToObj(DoubleFunction<? extends U> mapper) {
-        return new StreamEx<>(stream().mapToObj(mapper), strategy);
+        return new StreamEx<>(stream().mapToObj(mapper), context);
     }
 
     @Override
     public IntStreamEx mapToInt(DoubleToIntFunction mapper) {
-        return new IntStreamEx(stream().mapToInt(mapper), strategy);
+        return new IntStreamEx(stream().mapToInt(mapper), context);
     }
 
     @Override
     public LongStreamEx mapToLong(DoubleToLongFunction mapper) {
-        return new LongStreamEx(stream().mapToLong(mapper), strategy);
+        return new LongStreamEx(stream().mapToLong(mapper), context);
     }
 
     /**
@@ -305,12 +307,12 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
     public <K, V> EntryStream<K, V> mapToEntry(DoubleFunction<? extends K> keyMapper,
             DoubleFunction<? extends V> valueMapper) {
         return new EntryStream<>(stream().mapToObj(
-            t -> new AbstractMap.SimpleImmutableEntry<>(keyMapper.apply(t), valueMapper.apply(t))), strategy);
+            t -> new AbstractMap.SimpleImmutableEntry<>(keyMapper.apply(t), valueMapper.apply(t))), context);
     }
 
     @Override
     public DoubleStreamEx flatMap(DoubleFunction<? extends DoubleStream> mapper) {
-        return new DoubleStreamEx(stream().flatMap(mapper), strategy);
+        return new DoubleStreamEx(stream().flatMap(mapper), context);
     }
 
     /**
@@ -329,7 +331,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
      * @since 0.3.0
      */
     public IntStreamEx flatMapToInt(DoubleFunction<? extends IntStream> mapper) {
-        return new IntStreamEx(stream().mapToObj(mapper).flatMapToInt(Function.identity()), strategy);
+        return new IntStreamEx(stream().mapToObj(mapper).flatMapToInt(Function.identity()), context);
     }
 
     /**
@@ -348,7 +350,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
      * @since 0.3.0
      */
     public LongStreamEx flatMapToLong(DoubleFunction<? extends LongStream> mapper) {
-        return new LongStreamEx(stream().mapToObj(mapper).flatMapToLong(Function.identity()), strategy);
+        return new LongStreamEx(stream().mapToObj(mapper).flatMapToLong(Function.identity()), context);
     }
 
     /**
@@ -368,17 +370,17 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
      * @since 0.3.0
      */
     public <R> StreamEx<R> flatMapToObj(DoubleFunction<? extends Stream<R>> mapper) {
-        return new StreamEx<>(stream().mapToObj(mapper).flatMap(Function.identity()), strategy);
+        return new StreamEx<>(stream().mapToObj(mapper).flatMap(Function.identity()), context);
     }
 
     @Override
     public DoubleStreamEx distinct() {
-        return new DoubleStreamEx(stream().distinct(), strategy);
+        return new DoubleStreamEx(stream().distinct(), context);
     }
 
     @Override
     public DoubleStreamEx sorted() {
-        return new DoubleStreamEx(stream().sorted(), strategy);
+        return new DoubleStreamEx(stream().sorted(), context);
     }
 
     /**
@@ -401,7 +403,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
      * @return the new stream
      */
     public DoubleStreamEx sorted(Comparator<Double> comparator) {
-        return new DoubleStreamEx(stream().boxed().sorted(comparator).mapToDouble(Double::doubleValue), strategy);
+        return new DoubleStreamEx(stream().boxed().sorted(comparator).mapToDouble(Double::doubleValue), context);
     }
 
     /**
@@ -511,17 +513,17 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
 
     @Override
     public DoubleStreamEx peek(DoubleConsumer action) {
-        return new DoubleStreamEx(stream().peek(action), strategy);
+        return new DoubleStreamEx(stream().peek(action), context);
     }
 
     @Override
     public DoubleStreamEx limit(long maxSize) {
-        return new DoubleStreamEx(stream().limit(maxSize), strategy);
+        return new DoubleStreamEx(stream().limit(maxSize), context);
     }
 
     @Override
     public DoubleStreamEx skip(long n) {
-        return new DoubleStreamEx(stream().skip(n), strategy);
+        return new DoubleStreamEx(stream().skip(n), context);
     }
 
     /**
@@ -567,8 +569,8 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
         if (spliterator != null && !isParallel()) {
             spliterator().forEachRemaining(action);
         } else {
-            if(strategy.fjp != null)
-                strategy.terminate(() -> {
+            if(context.fjp != null)
+                context.terminate(() -> {
                     stream().forEach(action);
                     return null;
                 });
@@ -583,8 +585,8 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
         if (spliterator != null && !isParallel()) {
             spliterator().forEachRemaining(action);
         } else {
-            if(strategy.fjp != null)
-                strategy.terminate(() -> {
+            if(context.fjp != null)
+                context.terminate(() -> {
                     stream().forEachOrdered(action);
                     return null;
                 });
@@ -596,8 +598,8 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
 
     @Override
     public double[] toArray() {
-        if(strategy.fjp != null)
-            return strategy.terminate(stream()::toArray);
+        if(context.fjp != null)
+            return context.terminate(stream()::toArray);
         return stream().toArray();
     }
 
@@ -629,15 +631,15 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
 
     @Override
     public double reduce(double identity, DoubleBinaryOperator op) {
-        if(strategy.fjp != null)
-            return strategy.terminate(() -> stream().reduce(identity, op));
+        if(context.fjp != null)
+            return context.terminate(() -> stream().reduce(identity, op));
         return stream().reduce(identity, op);
     }
 
     @Override
     public OptionalDouble reduce(DoubleBinaryOperator op) {
-        if(strategy.fjp != null)
-            return strategy.terminate(op, stream()::reduce);
+        if(context.fjp != null)
+            return context.terminate(op, stream()::reduce);
         return stream().reduce(op);
     }
 
@@ -811,8 +813,8 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
      */
     @Override
     public <R> R collect(Supplier<R> supplier, ObjDoubleConsumer<R> accumulator, BiConsumer<R, R> combiner) {
-        if(strategy.fjp != null)
-            return strategy.terminate(() -> stream().collect(supplier, accumulator, combiner));
+        if(context.fjp != null)
+            return context.terminate(() -> stream().collect(supplier, accumulator, combiner));
         return stream().collect(supplier, accumulator, combiner);
     }
 
@@ -848,8 +850,8 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
 
     @Override
     public double sum() {
-        if(strategy.fjp != null)
-            return strategy.terminate(stream()::sum);
+        if(context.fjp != null)
+            return context.terminate(stream()::sum);
         return stream().sum();
     }
 
@@ -1110,15 +1112,15 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
 
     @Override
     public long count() {
-        if(strategy.fjp != null)
-            return strategy.terminate(stream()::count);
+        if(context.fjp != null)
+            return context.terminate(stream()::count);
         return stream().count();
     }
 
     @Override
     public OptionalDouble average() {
-        if(strategy.fjp != null)
-            return strategy.terminate(stream()::average);
+        if(context.fjp != null)
+            return context.terminate(stream()::average);
         return stream().average();
     }
 
@@ -1129,15 +1131,15 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
 
     @Override
     public boolean anyMatch(DoublePredicate predicate) {
-        if(strategy.fjp != null)
-            return strategy.terminate(predicate, stream()::anyMatch);
+        if(context.fjp != null)
+            return context.terminate(predicate, stream()::anyMatch);
         return stream().anyMatch(predicate);
     }
 
     @Override
     public boolean allMatch(DoublePredicate predicate) {
-        if(strategy.fjp != null)
-            return strategy.terminate(predicate, stream()::allMatch);
+        if(context.fjp != null)
+            return context.terminate(predicate, stream()::allMatch);
         return stream().allMatch(predicate);
     }
 
@@ -1148,8 +1150,8 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
 
     @Override
     public OptionalDouble findFirst() {
-        if(strategy.fjp != null)
-            return strategy.terminate(stream()::findFirst);
+        if(context.fjp != null)
+            return context.terminate(stream()::findFirst);
         return stream().findFirst();
     }
 
@@ -1176,8 +1178,8 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
 
     @Override
     public OptionalDouble findAny() {
-        if(strategy.fjp != null)
-            return strategy.terminate(stream()::findAny);
+        if(context.fjp != null)
+            return context.terminate(stream()::findAny);
         return stream().findAny();
     }
 
@@ -1234,7 +1236,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
 
     @Override
     public StreamEx<Double> boxed() {
-        return new StreamEx<>(stream().boxed(), strategy);
+        return new StreamEx<>(stream().boxed(), context);
     }
 
     @Override
@@ -1271,7 +1273,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
     public DoubleStreamEx append(double... values) {
         if (values.length == 0)
             return this;
-        return new DoubleStreamEx(DoubleStream.concat(stream(), DoubleStream.of(values)), strategy);
+        return new DoubleStreamEx(DoubleStream.concat(stream(), DoubleStream.of(values)), context);
     }
 
     /**
@@ -1286,7 +1288,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
      * @see DoubleStream#concat(DoubleStream, DoubleStream)
      */
     public DoubleStreamEx append(DoubleStream other) {
-        return new DoubleStreamEx(DoubleStream.concat(stream(), other), strategy.combine(other));
+        return new DoubleStreamEx(DoubleStream.concat(stream(), other), context.combine(other));
     }
 
     /**
@@ -1303,7 +1305,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
     public DoubleStreamEx prepend(double... values) {
         if (values.length == 0)
             return this;
-        return new DoubleStreamEx(DoubleStream.concat(DoubleStream.of(values), stream()), strategy);
+        return new DoubleStreamEx(DoubleStream.concat(DoubleStream.of(values), stream()), context);
     }
 
     /**
@@ -1318,7 +1320,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
      * @see DoubleStream#concat(DoubleStream, DoubleStream)
      */
     public DoubleStreamEx prepend(DoubleStream other) {
-        return new DoubleStreamEx(DoubleStream.concat(other, stream()), strategy.combine(other));
+        return new DoubleStreamEx(DoubleStream.concat(other, stream()), context.combine(other));
     }
 
     /**
@@ -1497,7 +1499,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
      * @since 0.5.0
      */
     public static DoubleStreamEx of(Double[] array) {
-        return of(Arrays.stream(array).mapToDouble(Double::doubleValue));
+        return seq(Arrays.stream(array).mapToDouble(Double::doubleValue));
     }
 
     /**
@@ -1541,7 +1543,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
      */
     public static DoubleStreamEx of(DoubleStream stream) {
         return stream instanceof DoubleStreamEx ? (DoubleStreamEx) stream : new DoubleStreamEx(stream,
-                ExecutionStrategy.of(stream));
+                StreamContext.of(stream));
     }
 
     /**
@@ -1553,7 +1555,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
      * @since 0.3.4
      */
     public static DoubleStreamEx of(Spliterator.OfDouble spliterator) {
-        return new DoubleStreamEx(spliterator, ExecutionStrategy.SEQUENTIAL);
+        return new DoubleStreamEx(spliterator, StreamContext.SEQUENTIAL);
     }
 
     /**
@@ -1599,7 +1601,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
      * @see Collection#stream()
      */
     public static DoubleStreamEx of(Collection<Double> collection) {
-        return of(collection.stream().mapToDouble(Double::doubleValue));
+        return seq(collection.stream().mapToDouble(Double::doubleValue));
     }
 
     /**
@@ -1616,7 +1618,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
      * @see Random#doubles()
      */
     public static DoubleStreamEx of(Random random) {
-        return of(random.doubles());
+        return seq(random.doubles());
     }
 
     /**
@@ -1634,7 +1636,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
      * @see Random#doubles(long)
      */
     public static DoubleStreamEx of(Random random, long streamSize) {
-        return of(random.doubles(streamSize));
+        return seq(random.doubles(streamSize));
     }
 
     /**
@@ -1650,7 +1652,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
      * @see Random#doubles(double, double)
      */
     public static DoubleStreamEx of(Random random, double randomNumberOrigin, double randomNumberBound) {
-        return of(random.doubles(randomNumberOrigin, randomNumberBound));
+        return seq(random.doubles(randomNumberOrigin, randomNumberBound));
     }
 
     /**
@@ -1668,7 +1670,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
      * @see Random#doubles(long, double, double)
      */
     public static DoubleStreamEx of(Random random, long streamSize, double randomNumberOrigin, double randomNumberBound) {
-        return of(random.doubles(streamSize, randomNumberOrigin, randomNumberBound));
+        return seq(random.doubles(streamSize, randomNumberOrigin, randomNumberBound));
     }
 
     /**
@@ -1690,7 +1692,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
      * @see DoubleStream#iterate(double, DoubleUnaryOperator)
      */
     public static DoubleStreamEx iterate(final double seed, final DoubleUnaryOperator f) {
-        return of(DoubleStream.iterate(seed, f));
+        return seq(DoubleStream.iterate(seed, f));
     }
 
     /**
@@ -1703,7 +1705,7 @@ public class DoubleStreamEx extends BaseStreamEx<Double, DoubleStream, Spliterat
      * @see DoubleStream#generate(DoubleSupplier)
      */
     public static DoubleStreamEx generate(DoubleSupplier s) {
-        return of(DoubleStream.generate(s));
+        return seq(DoubleStream.generate(s));
     }
 
     /**
diff --git a/src/main/java/one/util/streamex/EntryStream.java b/src/main/java/one/util/streamex/EntryStream.java
index 99afc85..4e91b29 100644
--- a/src/main/java/one/util/streamex/EntryStream.java
+++ b/src/main/java/one/util/streamex/EntryStream.java
@@ -63,23 +63,23 @@ import static one.util.streamex.StreamExInternals.*;
  */
 public class EntryStream<K, V> extends AbstractStreamEx<Entry<K, V>, EntryStream<K, V>> {
     @SuppressWarnings("unchecked")
-    EntryStream(Stream<? extends Entry<K, V>> stream, ExecutionStrategy strategy) {
-        super((Stream<Entry<K, V>>) stream, strategy);
+    EntryStream(Stream<? extends Entry<K, V>> stream, StreamContext context) {
+        super((Stream<Entry<K, V>>) stream, context);
     }
 
     @SuppressWarnings("unchecked")
-    EntryStream(Spliterator<? extends Entry<K, V>> spliterator, ExecutionStrategy strategy) {
-        super((Spliterator<Entry<K, V>>) spliterator, strategy);
+    EntryStream(Spliterator<? extends Entry<K, V>> spliterator, StreamContext context) {
+        super((Spliterator<Entry<K, V>>) spliterator, context);
     }
 
     @Override
     EntryStream<K, V> supply(Stream<Map.Entry<K, V>> stream) {
-        return new EntryStream<>(stream, strategy);
+        return new EntryStream<>(stream, context);
     }
 
     @Override
     EntryStream<K, V> supply(Spliterator<Entry<K, V>> spliterator) {
-        return new EntryStream<>(spliterator, strategy);
+        return new EntryStream<>(spliterator, context);
     }
 
     static <K, V> Consumer<? super Entry<K, V>> toConsumer(BiConsumer<? super K, ? super V> action) {
@@ -163,7 +163,7 @@ public class EntryStream<K, V> extends AbstractStreamEx<Entry<K, V>, EntryStream
      * @return the new stream
      */
     public <KK> EntryStream<KK, V> flatMapKeys(Function<? super K, ? extends Stream<? extends KK>> mapper) {
-        return new EntryStream<>(stream().flatMap(e -> withValue(mapper.apply(e.getKey()), e.getValue())), strategy);
+        return new EntryStream<>(stream().flatMap(e -> withValue(mapper.apply(e.getKey()), e.getValue())), context);
     }
 
     /**
@@ -189,7 +189,7 @@ public class EntryStream<K, V> extends AbstractStreamEx<Entry<K, V>, EntryStream
      */
     public <KK> EntryStream<KK, V> flatMapToKey(BiFunction<? super K, ? super V, ? extends Stream<? extends KK>> mapper) {
         return new EntryStream<>(
-                stream().flatMap(e -> withValue(mapper.apply(e.getKey(), e.getValue()), e.getValue())), strategy);
+                stream().flatMap(e -> withValue(mapper.apply(e.getKey(), e.getValue()), e.getValue())), context);
     }
 
     /**
@@ -214,7 +214,7 @@ public class EntryStream<K, V> extends AbstractStreamEx<Entry<K, V>, EntryStream
      * @return the new stream
      */
     public <VV> EntryStream<K, VV> flatMapValues(Function<? super V, ? extends Stream<? extends VV>> mapper) {
-        return new EntryStream<>(stream().flatMap(e -> withKey(e.getKey(), mapper.apply(e.getValue()))), strategy);
+        return new EntryStream<>(stream().flatMap(e -> withKey(e.getKey(), mapper.apply(e.getValue()))), context);
     }
 
     /**
@@ -241,7 +241,7 @@ public class EntryStream<K, V> extends AbstractStreamEx<Entry<K, V>, EntryStream
     public <VV> EntryStream<K, VV> flatMapToValue(
             BiFunction<? super K, ? super V, ? extends Stream<? extends VV>> mapper) {
         return new EntryStream<>(
-            stream().flatMap(e -> withKey(e.getKey(), mapper.apply(e.getKey(), e.getValue()))), strategy);
+            stream().flatMap(e -> withKey(e.getKey(), mapper.apply(e.getKey(), e.getValue()))), context);
     }
 
     /**
@@ -480,7 +480,7 @@ public class EntryStream<K, V> extends AbstractStreamEx<Entry<K, V>, EntryStream
      */
     public <KK> EntryStream<KK, V> mapKeys(Function<? super K, ? extends KK> keyMapper) {
         return new EntryStream<>(stream().map(
-            e -> new SimpleImmutableEntry<>(keyMapper.apply(e.getKey()), e.getValue())), strategy);
+            e -> new SimpleImmutableEntry<>(keyMapper.apply(e.getKey()), e.getValue())), context);
     }
 
     /**
@@ -498,7 +498,7 @@ public class EntryStream<K, V> extends AbstractStreamEx<Entry<K, V>, EntryStream
      */
     public <VV> EntryStream<K, VV> mapValues(Function<? super V, ? extends VV> valueMapper) {
         return new EntryStream<>(
-            stream().map(e -> new SimpleImmutableEntry<>(e.getKey(), valueMapper.apply(e.getValue()))), strategy);
+            stream().map(e -> new SimpleImmutableEntry<>(e.getKey(), valueMapper.apply(e.getValue()))), context);
     }
 
     /**
@@ -534,7 +534,7 @@ public class EntryStream<K, V> extends AbstractStreamEx<Entry<K, V>, EntryStream
      */
     public <KK> EntryStream<KK, V> mapToKey(BiFunction<? super K, ? super V, ? extends KK> keyMapper) {
         return new EntryStream<>(stream().map(
-            e -> new SimpleImmutableEntry<>(keyMapper.apply(e.getKey(), e.getValue()), e.getValue())), strategy);
+            e -> new SimpleImmutableEntry<>(keyMapper.apply(e.getKey(), e.getValue()), e.getValue())), context);
     }
 
     /**
@@ -553,7 +553,7 @@ public class EntryStream<K, V> extends AbstractStreamEx<Entry<K, V>, EntryStream
      */
     public <VV> EntryStream<K, VV> mapToValue(BiFunction<? super K, ? super V, ? extends VV> valueMapper) {
         return new EntryStream<>(stream().map(
-            e -> new SimpleImmutableEntry<>(e.getKey(), valueMapper.apply(e.getKey(), e.getValue()))), strategy);
+            e -> new SimpleImmutableEntry<>(e.getKey(), valueMapper.apply(e.getKey(), e.getValue()))), context);
     }
 
     /**
@@ -567,7 +567,7 @@ public class EntryStream<K, V> extends AbstractStreamEx<Entry<K, V>, EntryStream
      * @return the new stream
      */
     public EntryStream<V, K> invert() {
-        return new EntryStream<>(stream().map(e -> new SimpleImmutableEntry<>(e.getValue(), e.getKey())), strategy);
+        return new EntryStream<>(stream().map(e -> new SimpleImmutableEntry<>(e.getValue(), e.getKey())), context);
     }
 
     /**
@@ -1085,7 +1085,7 @@ public class EntryStream<K, V> extends AbstractStreamEx<Entry<K, V>, EntryStream
      * @return the wrapped stream
      */
     public static <K, V> EntryStream<K, V> of(Stream<? extends Entry<K, V>> stream) {
-        return new EntryStream<>(unwrap(stream), ExecutionStrategy.of(stream));
+        return new EntryStream<>(unwrap(stream), StreamContext.of(stream));
     }
 
     /**
diff --git a/src/main/java/one/util/streamex/ExecutionStrategy.java b/src/main/java/one/util/streamex/ExecutionStrategy.java
deleted file mode 100644
index 4aa6c1e..0000000
--- a/src/main/java/one/util/streamex/ExecutionStrategy.java
+++ /dev/null
@@ -1,62 +0,0 @@
-/*
- * Copyright 2015, 2016 Tagir Valeev
- * 
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- * 
- *     http://www.apache.org/licenses/LICENSE-2.0
- * 
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package one.util.streamex;
-
-import java.util.concurrent.ForkJoinPool;
-import java.util.function.Function;
-import java.util.function.Supplier;
-import java.util.stream.BaseStream;
-
-/**
- * @author Tagir Valeev
- */
-/*package*/class ExecutionStrategy {
-    static final ExecutionStrategy SEQUENTIAL = new ExecutionStrategy(false);
-    static final ExecutionStrategy PARALLEL = new ExecutionStrategy(true);
-    
-    final boolean parallel;
-    final ForkJoinPool fjp;
-
-    private ExecutionStrategy(boolean parallel) {
-        this.parallel = parallel;
-        this.fjp = null;
-    }
-    
-    ExecutionStrategy(ForkJoinPool fjp) {
-        this.parallel = true;
-        this.fjp = fjp;
-    }
-
-    public <T> T terminate(Supplier<T> terminalOperation) {
-        return fjp.submit(terminalOperation::get).join();
-    }
-
-    public <T, U> T terminate(U value, Function<U, T> terminalOperation) {
-        return fjp.submit(() -> terminalOperation.apply(value)).join();
-    }
-
-    public ExecutionStrategy combine(BaseStream<?,?> other) {
-        if(other.isParallel() && !parallel)
-            return PARALLEL;
-        return this;
-    }
-    
-    public static ExecutionStrategy of(BaseStream<?,?> stream) {
-        if(stream instanceof BaseStreamEx)
-            return ((BaseStreamEx<?,?,?>)stream).strategy;
-        return stream.isParallel() ? PARALLEL : SEQUENTIAL;
-    }
-}
diff --git a/src/main/java/one/util/streamex/HeadTailSpliterator.java b/src/main/java/one/util/streamex/HeadTailSpliterator.java
index f17d077..13680a4 100644
--- a/src/main/java/one/util/streamex/HeadTailSpliterator.java
+++ b/src/main/java/one/util/streamex/HeadTailSpliterator.java
@@ -21,7 +21,6 @@ import java.util.Spliterators.AbstractSpliterator;
 import java.util.function.BiFunction;
 import java.util.function.Consumer;
 import java.util.function.Supplier;
-import java.util.stream.BaseStream;
 import java.util.stream.Stream;
 
 import one.util.streamex.StreamExInternals.TailSpliterator;
@@ -36,7 +35,7 @@ import static one.util.streamex.StreamExInternals.*;
     private Supplier<? extends Stream<U>> emptyMapper;
     private Spliterator<U> target;
     private boolean finished;
-    BaseStream<?, ?> owner;
+    StreamContext context;
     
     HeadTailSpliterator(Spliterator<T> source, BiFunction<? super T, ? super StreamEx<T>, ? extends Stream<U>> mapper,
             Supplier<? extends Stream<U>> emptyMapper) {
@@ -92,7 +91,7 @@ import static one.util.streamex.StreamExInternals.*;
             source = null;
             mapper = null;
             emptyMapper = null;
-            delegateClose(owner, stream);
+            context.combine(stream);
             target = stream == null ? Spliterators.emptySpliterator() : stream.spliterator();
         }
         return true;
diff --git a/src/main/java/one/util/streamex/IntStreamEx.java b/src/main/java/one/util/streamex/IntStreamEx.java
index 62c5153..e427c90 100644
--- a/src/main/java/one/util/streamex/IntStreamEx.java
+++ b/src/main/java/one/util/streamex/IntStreamEx.java
@@ -112,29 +112,31 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
         }
     }
 
-    IntStreamEx(IntStream stream, ExecutionStrategy strategy) {
-        super(stream, strategy);
+    IntStreamEx(IntStream stream, StreamContext context) {
+        super(stream, context);
     }
 
-    IntStreamEx(Spliterator.OfInt spliterator, ExecutionStrategy strategy) {
-        super(spliterator, strategy);
+    IntStreamEx(Spliterator.OfInt spliterator, StreamContext context) {
+        super(spliterator, context);
     }
     
     @Override
     IntStream createStream() {
-        return StreamSupport.intStream(spliterator, strategy.parallel);
+        return StreamSupport.intStream(spliterator, context.parallel);
+    }
+
+    private static IntStreamEx seq(IntStream stream) {
+        return new IntStreamEx(stream, StreamContext.SEQUENTIAL);
     }
 
     final IntStreamEx delegate(Spliterator.OfInt spliterator) {
-        if(!mustClose())
-            return new IntStreamEx(spliterator, strategy);
-        return new IntStreamEx(forwardClose(StreamSupport.intStream(spliterator, isParallel())), strategy);
+        return new IntStreamEx(spliterator, context);
     }
 
     final IntStreamEx callWhile(IntPredicate predicate, int methodId) {
         try {
             return new IntStreamEx(
-                (IntStream) JDK9_METHODS[IDX_INT_STREAM][methodId].invokeExact(stream(), predicate), strategy);
+                (IntStream) JDK9_METHODS[IDX_INT_STREAM][methodId].invokeExact(stream(), predicate), context);
         } catch (Error | RuntimeException e) {
             throw e;
         } catch (Throwable e) {
@@ -142,7 +144,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
         }
     }
 
-    <A> A collectSized(Supplier<A> supplier, ObjIntConsumer<A> accumulator, BiConsumer<A, A> combiner,
+    final <A> A collectSized(Supplier<A> supplier, ObjIntConsumer<A> accumulator, BiConsumer<A, A> combiner,
             IntFunction<A> sizedSupplier, ObjIntConsumer<A> sizedAccumulator) {
         if (isParallel())
             return collect(supplier, accumulator, combiner);
@@ -171,7 +173,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
 
     @Override
     public IntStreamEx filter(IntPredicate predicate) {
-        return new IntStreamEx(stream().filter(predicate), strategy);
+        return new IntStreamEx(stream().filter(predicate), context);
     }
 
     /**
@@ -280,22 +282,22 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
 
     @Override
     public IntStreamEx map(IntUnaryOperator mapper) {
-        return new IntStreamEx(stream().map(mapper), strategy);
+        return new IntStreamEx(stream().map(mapper), context);
     }
 
     @Override
     public <U> StreamEx<U> mapToObj(IntFunction<? extends U> mapper) {
-        return new StreamEx<>(stream().mapToObj(mapper), strategy);
+        return new StreamEx<>(stream().mapToObj(mapper), context);
     }
 
     @Override
     public LongStreamEx mapToLong(IntToLongFunction mapper) {
-        return new LongStreamEx(stream().mapToLong(mapper), strategy);
+        return new LongStreamEx(stream().mapToLong(mapper), context);
     }
 
     @Override
     public DoubleStreamEx mapToDouble(IntToDoubleFunction mapper) {
-        return new DoubleStreamEx(stream().mapToDouble(mapper), strategy);
+        return new DoubleStreamEx(stream().mapToDouble(mapper), context);
     }
 
     /**
@@ -317,12 +319,12 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      */
     public <K, V> EntryStream<K, V> mapToEntry(IntFunction<? extends K> keyMapper, IntFunction<? extends V> valueMapper) {
         return new EntryStream<>(stream().mapToObj(
-            t -> new AbstractMap.SimpleImmutableEntry<>(keyMapper.apply(t), valueMapper.apply(t))), strategy);
+            t -> new AbstractMap.SimpleImmutableEntry<>(keyMapper.apply(t), valueMapper.apply(t))), context);
     }
 
     @Override
     public IntStreamEx flatMap(IntFunction<? extends IntStream> mapper) {
-        return new IntStreamEx(stream().flatMap(mapper), strategy);
+        return new IntStreamEx(stream().flatMap(mapper), context);
     }
 
     /**
@@ -341,7 +343,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @since 0.3.0
      */
     public LongStreamEx flatMapToLong(IntFunction<? extends LongStream> mapper) {
-        return new LongStreamEx(stream().mapToObj(mapper).flatMapToLong(Function.identity()), strategy);
+        return new LongStreamEx(stream().mapToObj(mapper).flatMapToLong(Function.identity()), context);
     }
 
     /**
@@ -360,7 +362,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @since 0.3.0
      */
     public DoubleStreamEx flatMapToDouble(IntFunction<? extends DoubleStream> mapper) {
-        return new DoubleStreamEx(stream().mapToObj(mapper).flatMapToDouble(Function.identity()), strategy);
+        return new DoubleStreamEx(stream().mapToObj(mapper).flatMapToDouble(Function.identity()), context);
     }
 
     /**
@@ -380,17 +382,17 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @since 0.3.0
      */
     public <R> StreamEx<R> flatMapToObj(IntFunction<? extends Stream<R>> mapper) {
-        return new StreamEx<>(stream().mapToObj(mapper).flatMap(Function.identity()), strategy);
+        return new StreamEx<>(stream().mapToObj(mapper).flatMap(Function.identity()), context);
     }
 
     @Override
     public IntStreamEx distinct() {
-        return new IntStreamEx(stream().distinct(), strategy);
+        return new IntStreamEx(stream().distinct(), context);
     }
 
     @Override
     public IntStreamEx sorted() {
-        return new IntStreamEx(stream().sorted(), strategy);
+        return new IntStreamEx(stream().sorted(), context);
     }
 
     /**
@@ -413,7 +415,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @return the new stream
      */
     public IntStreamEx sorted(Comparator<Integer> comparator) {
-        return new IntStreamEx(stream().boxed().sorted(comparator).mapToInt(Integer::intValue), strategy);
+        return new IntStreamEx(stream().boxed().sorted(comparator).mapToInt(Integer::intValue), context);
     }
 
     /**
@@ -522,17 +524,17 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
 
     @Override
     public IntStreamEx peek(IntConsumer action) {
-        return new IntStreamEx(stream().peek(action), strategy);
+        return new IntStreamEx(stream().peek(action), context);
     }
 
     @Override
     public IntStreamEx limit(long maxSize) {
-        return new IntStreamEx(stream().limit(maxSize), strategy);
+        return new IntStreamEx(stream().limit(maxSize), context);
     }
 
     @Override
     public IntStreamEx skip(long n) {
-        return new IntStreamEx(stream().skip(n), strategy);
+        return new IntStreamEx(stream().skip(n), context);
     }
 
     /**
@@ -577,8 +579,8 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
         if (spliterator != null && !isParallel()) {
             spliterator().forEachRemaining(action);
         } else {
-            if(strategy.fjp != null)
-                strategy.terminate(() -> {
+            if(context.fjp != null)
+                context.terminate(() -> {
                     stream().forEach(action);
                     return null;
                 });
@@ -593,8 +595,8 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
         if (spliterator != null && !isParallel()) {
             spliterator().forEachRemaining(action);
         } else {
-            if(strategy.fjp != null)
-                strategy.terminate(() -> {
+            if(context.fjp != null)
+                context.terminate(() -> {
                     stream().forEachOrdered(action);
                     return null;
                 });
@@ -606,8 +608,8 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
 
     @Override
     public int[] toArray() {
-        if(strategy.fjp != null)
-            return strategy.terminate(stream()::toArray);
+        if(context.fjp != null)
+            return context.terminate(stream()::toArray);
         return stream().toArray();
     }
 
@@ -672,15 +674,15 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
 
     @Override
     public int reduce(int identity, IntBinaryOperator op) {
-        if(strategy.fjp != null)
-            return strategy.terminate(() -> stream().reduce(identity, op));
+        if(context.fjp != null)
+            return context.terminate(() -> stream().reduce(identity, op));
         return stream().reduce(identity, op);
     }
 
     @Override
     public OptionalInt reduce(IntBinaryOperator op) {
-        if(strategy.fjp != null)
-            return strategy.terminate(op, stream()::reduce);
+        if(context.fjp != null)
+            return context.terminate(op, stream()::reduce);
         return stream().reduce(op);
     }
 
@@ -854,8 +856,8 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      */
     @Override
     public <R> R collect(Supplier<R> supplier, ObjIntConsumer<R> accumulator, BiConsumer<R, R> combiner) {
-        if(strategy.fjp != null)
-            return strategy.terminate(() -> stream().collect(supplier, accumulator, combiner));
+        if(context.fjp != null)
+            return context.terminate(() -> stream().collect(supplier, accumulator, combiner));
         return stream().collect(supplier, accumulator, combiner);
     }
 
@@ -1149,15 +1151,15 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
 
     @Override
     public long count() {
-        if(strategy.fjp != null)
-            return strategy.terminate(stream()::count);
+        if(context.fjp != null)
+            return context.terminate(stream()::count);
         return stream().count();
     }
 
     @Override
     public OptionalDouble average() {
-        if(strategy.fjp != null)
-            return strategy.terminate(stream()::average);
+        if(context.fjp != null)
+            return context.terminate(stream()::average);
         return stream().average();
     }
 
@@ -1168,15 +1170,15 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
 
     @Override
     public boolean anyMatch(IntPredicate predicate) {
-        if(strategy.fjp != null)
-            return strategy.terminate(predicate, stream()::anyMatch);
+        if(context.fjp != null)
+            return context.terminate(predicate, stream()::anyMatch);
         return stream().anyMatch(predicate);
     }
 
     @Override
     public boolean allMatch(IntPredicate predicate) {
-        if(strategy.fjp != null)
-            return strategy.terminate(predicate, stream()::allMatch);
+        if(context.fjp != null)
+            return context.terminate(predicate, stream()::allMatch);
         return stream().allMatch(predicate);
     }
 
@@ -1187,8 +1189,8 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
 
     @Override
     public OptionalInt findFirst() {
-        if(strategy.fjp != null)
-            return strategy.terminate(stream()::findFirst);
+        if(context.fjp != null)
+            return context.terminate(stream()::findFirst);
         return stream().findFirst();
     }
 
@@ -1215,8 +1217,8 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
 
     @Override
     public OptionalInt findAny() {
-        if(strategy.fjp != null)
-            return strategy.terminate(stream()::findAny);
+        if(context.fjp != null)
+            return context.terminate(stream()::findAny);
         return stream().findAny();
     }
 
@@ -1292,17 +1294,17 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
 
     @Override
     public LongStreamEx asLongStream() {
-        return new LongStreamEx(stream().asLongStream(), strategy);
+        return new LongStreamEx(stream().asLongStream(), context);
     }
 
     @Override
     public DoubleStreamEx asDoubleStream() {
-        return new DoubleStreamEx(stream().asDoubleStream(), strategy);
+        return new DoubleStreamEx(stream().asDoubleStream(), context);
     }
 
     @Override
     public StreamEx<Integer> boxed() {
-        return new StreamEx<>(stream().boxed(), strategy);
+        return new StreamEx<>(stream().boxed(), context);
     }
 
     @Override
@@ -1339,7 +1341,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
     public IntStreamEx append(int... values) {
         if (values.length == 0)
             return this;
-        return new IntStreamEx(IntStream.concat(stream(), IntStream.of(values)), strategy);
+        return new IntStreamEx(IntStream.concat(stream(), IntStream.of(values)), context);
     }
 
     /**
@@ -1354,7 +1356,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @see IntStream#concat(IntStream, IntStream)
      */
     public IntStreamEx append(IntStream other) {
-        return new IntStreamEx(IntStream.concat(stream(), other), strategy.combine(other));
+        return new IntStreamEx(IntStream.concat(stream(), other), context.combine(other));
     }
 
     /**
@@ -1371,7 +1373,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
     public IntStreamEx prepend(int... values) {
         if (values.length == 0)
             return this;
-        return new IntStreamEx(IntStream.concat(IntStream.of(values), stream()), strategy);
+        return new IntStreamEx(IntStream.concat(IntStream.of(values), stream()), context);
     }
 
     /**
@@ -1386,7 +1388,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @see IntStream#concat(IntStream, IntStream)
      */
     public IntStreamEx prepend(IntStream other) {
-        return new IntStreamEx(IntStream.concat(other, stream()), strategy.combine(other));
+        return new IntStreamEx(IntStream.concat(other, stream()), context.combine(other));
     }
 
     /**
@@ -1809,7 +1811,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @since 0.5.0
      */
     public static IntStreamEx of(Integer[] array) {
-        return of(Arrays.stream(array).mapToInt(Integer::intValue));
+        return seq(Arrays.stream(array).mapToInt(Integer::intValue));
     }
 
     /**
@@ -1842,7 +1844,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @since 0.1.1
      */
     public static <T> IntStreamEx ofIndices(List<T> list, Predicate<T> predicate) {
-        return of(IntStream.range(0, list.size()).filter(i -> predicate.test(list.get(i))));
+        return seq(IntStream.range(0, list.size()).filter(i -> predicate.test(list.get(i))));
     }
 
     /**
@@ -1870,7 +1872,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @since 0.1.1
      */
     public static <T> IntStreamEx ofIndices(T[] array, Predicate<T> predicate) {
-        return of(IntStream.range(0, array.length).filter(i -> predicate.test(array[i])));
+        return seq(IntStream.range(0, array.length).filter(i -> predicate.test(array[i])));
     }
 
     /**
@@ -1896,7 +1898,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @since 0.1.1
      */
     public static IntStreamEx ofIndices(int[] array, IntPredicate predicate) {
-        return of(IntStream.range(0, array.length).filter(i -> predicate.test(array[i])));
+        return seq(IntStream.range(0, array.length).filter(i -> predicate.test(array[i])));
     }
 
     /**
@@ -1922,7 +1924,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @since 0.1.1
      */
     public static IntStreamEx ofIndices(long[] array, LongPredicate predicate) {
-        return of(IntStream.range(0, array.length).filter(i -> predicate.test(array[i])));
+        return seq(IntStream.range(0, array.length).filter(i -> predicate.test(array[i])));
     }
 
     /**
@@ -1948,9 +1950,9 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @since 0.1.1
      */
     public static IntStreamEx ofIndices(double[] array, DoublePredicate predicate) {
-        return of(IntStream.range(0, array.length).filter(i -> predicate.test(array[i])));
+        return seq(IntStream.range(0, array.length).filter(i -> predicate.test(array[i])));
     }
-
+    
     /**
      * Returns an {@code IntStreamEx} object which wraps given {@link IntStream}
      * 
@@ -1959,7 +1961,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @since 0.0.8
      */
     public static IntStreamEx of(IntStream stream) {
-        return stream instanceof IntStreamEx ? (IntStreamEx) stream : new IntStreamEx(stream, ExecutionStrategy.of(stream));
+        return stream instanceof IntStreamEx ? (IntStreamEx) stream : new IntStreamEx(stream, StreamContext.of(stream));
     }
 
     /**
@@ -1971,7 +1973,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @since 0.3.4
      */
     public static IntStreamEx of(Spliterator.OfInt spliterator) {
-        return new IntStreamEx(spliterator, ExecutionStrategy.SEQUENTIAL);
+        return new IntStreamEx(spliterator, StreamContext.SEQUENTIAL);
     }
 
     /**
@@ -2025,7 +2027,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @see BitSet#stream()
      */
     public static IntStreamEx of(BitSet bitSet) {
-        return of(bitSet.stream());
+        return seq(bitSet.stream());
     }
 
     /**
@@ -2037,7 +2039,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @see Collection#stream()
      */
     public static IntStreamEx of(Collection<Integer> collection) {
-        return of(collection.stream().mapToInt(Integer::intValue));
+        return seq(collection.stream().mapToInt(Integer::intValue));
     }
 
     /**
@@ -2053,7 +2055,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @see Random#ints()
      */
     public static IntStreamEx of(Random random) {
-        return of(random.ints());
+        return seq(random.ints());
     }
 
     /**
@@ -2070,7 +2072,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @see Random#ints(long)
      */
     public static IntStreamEx of(Random random, long streamSize) {
-        return of(random.ints(streamSize));
+        return seq(random.ints(streamSize));
     }
 
     /**
@@ -2085,7 +2087,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @see Random#ints(long, int, int)
      */
     public static IntStreamEx of(Random random, int randomNumberOrigin, int randomNumberBound) {
-        return of(random.ints(randomNumberOrigin, randomNumberBound));
+        return seq(random.ints(randomNumberOrigin, randomNumberBound));
     }
 
     /**
@@ -2101,7 +2103,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @see Random#ints(long, int, int)
      */
     public static IntStreamEx of(Random random, long streamSize, int randomNumberOrigin, int randomNumberBound) {
-        return of(random.ints(streamSize, randomNumberOrigin, randomNumberBound));
+        return seq(random.ints(streamSize, randomNumberOrigin, randomNumberBound));
     }
 
     /**
@@ -2164,7 +2166,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @see IntStream#iterate(int, IntUnaryOperator)
      */
     public static IntStreamEx iterate(final int seed, final IntUnaryOperator f) {
-        return of(IntStream.iterate(seed, f));
+        return seq(IntStream.iterate(seed, f));
     }
 
     /**
@@ -2177,7 +2179,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @see IntStream#generate(IntSupplier)
      */
     public static IntStreamEx generate(IntSupplier s) {
-        return of(IntStream.generate(s));
+        return seq(IntStream.generate(s));
     }
 
     /**
@@ -2191,7 +2193,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @since 0.1.1
      */
     public static IntStreamEx range(int endExclusive) {
-        return of(IntStream.range(0, endExclusive));
+        return seq(IntStream.range(0, endExclusive));
     }
 
     /**
@@ -2206,7 +2208,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @see IntStream#range(int, int)
      */
     public static IntStreamEx range(int startInclusive, int endExclusive) {
-        return of(IntStream.range(startInclusive, endExclusive));
+        return seq(IntStream.range(startInclusive, endExclusive));
     }
 
     /**
@@ -2245,7 +2247,7 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
      * @see IntStream#rangeClosed(int, int)
      */
     public static IntStreamEx rangeClosed(int startInclusive, int endInclusive) {
-        return of(IntStream.rangeClosed(startInclusive, endInclusive));
+        return seq(IntStream.rangeClosed(startInclusive, endInclusive));
     }
 
     /**
@@ -2275,18 +2277,18 @@ public class IntStreamEx extends BaseStreamEx<Integer, IntStream, Spliterator.Of
         if (step == 0)
             throw new IllegalArgumentException("step = 0");
         if (step == 1)
-            return of(IntStream.rangeClosed(startInclusive, endInclusive));
+            return seq(IntStream.rangeClosed(startInclusive, endInclusive));
         if (step == -1) {
             // Handled specially as number of elements can exceed
             // Integer.MAX_VALUE
             int sum = endInclusive + startInclusive;
-            return of(IntStream.rangeClosed(endInclusive, startInclusive).map(x -> sum - x));
+            return seq(IntStream.rangeClosed(endInclusive, startInclusive).map(x -> sum - x));
         }
         if (endInclusive > startInclusive ^ step > 0)
             return empty();
         int limit = (endInclusive - startInclusive) * Integer.signum(step);
         limit = Integer.divideUnsigned(limit, Math.abs(step));
-        return of(IntStream.rangeClosed(0, limit).map(x -> x * step + startInclusive));
+        return seq(IntStream.rangeClosed(0, limit).map(x -> x * step + startInclusive));
     }
 
     /**
diff --git a/src/main/java/one/util/streamex/LongStreamEx.java b/src/main/java/one/util/streamex/LongStreamEx.java
index 2d6fe14..dd51731 100644
--- a/src/main/java/one/util/streamex/LongStreamEx.java
+++ b/src/main/java/one/util/streamex/LongStreamEx.java
@@ -106,12 +106,12 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
         }
     }
 
-    LongStreamEx(LongStream stream, ExecutionStrategy strategy) {
-        super(stream, strategy);
+    LongStreamEx(LongStream stream, StreamContext context) {
+        super(stream, context);
     }
 
-    LongStreamEx(Spliterator.OfLong spliterator, ExecutionStrategy strategy) {
-        super(spliterator, strategy);
+    LongStreamEx(Spliterator.OfLong spliterator, StreamContext context) {
+        super(spliterator, context);
     }
 
     @Override
@@ -119,16 +119,18 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
         return StreamSupport.longStream(spliterator, isParallel());
     }
 
+    private static LongStreamEx seq(LongStream stream) {
+        return new LongStreamEx(stream, StreamContext.SEQUENTIAL);
+    }
+
     final LongStreamEx delegate(Spliterator.OfLong spliterator) {
-        if(!mustClose())
-            return new LongStreamEx(spliterator, strategy);
-        return new LongStreamEx(forwardClose(StreamSupport.longStream(spliterator, isParallel())), strategy);
+        return new LongStreamEx(spliterator, context);
     }
 
     final LongStreamEx callWhile(LongPredicate predicate, int methodId) {
         try {
             return new LongStreamEx(
-                (LongStream) JDK9_METHODS[IDX_LONG_STREAM][methodId].invokeExact(stream(), predicate), strategy);
+                (LongStream) JDK9_METHODS[IDX_LONG_STREAM][methodId].invokeExact(stream(), predicate), context);
         } catch (Error | RuntimeException e) {
             throw e;
         } catch (Throwable e) {
@@ -148,7 +150,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
 
     @Override
     public LongStreamEx filter(LongPredicate predicate) {
-        return new LongStreamEx(stream().filter(predicate), strategy);
+        return new LongStreamEx(stream().filter(predicate), context);
     }
 
     /**
@@ -257,7 +259,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
 
     @Override
     public LongStreamEx map(LongUnaryOperator mapper) {
-        return new LongStreamEx(stream().map(mapper), strategy);
+        return new LongStreamEx(stream().map(mapper), context);
     }
 
     /**
@@ -300,17 +302,17 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
 
     @Override
     public <U> StreamEx<U> mapToObj(LongFunction<? extends U> mapper) {
-        return new StreamEx<>(stream().mapToObj(mapper), strategy);
+        return new StreamEx<>(stream().mapToObj(mapper), context);
     }
 
     @Override
     public IntStreamEx mapToInt(LongToIntFunction mapper) {
-        return new IntStreamEx(stream().mapToInt(mapper), strategy);
+        return new IntStreamEx(stream().mapToInt(mapper), context);
     }
 
     @Override
     public DoubleStreamEx mapToDouble(LongToDoubleFunction mapper) {
-        return new DoubleStreamEx(stream().mapToDouble(mapper), strategy);
+        return new DoubleStreamEx(stream().mapToDouble(mapper), context);
     }
 
     /**
@@ -333,12 +335,12 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
     public <K, V> EntryStream<K, V> mapToEntry(LongFunction<? extends K> keyMapper,
             LongFunction<? extends V> valueMapper) {
         return new EntryStream<>(stream().mapToObj(
-            t -> new AbstractMap.SimpleImmutableEntry<>(keyMapper.apply(t), valueMapper.apply(t))), strategy);
+            t -> new AbstractMap.SimpleImmutableEntry<>(keyMapper.apply(t), valueMapper.apply(t))), context);
     }
 
     @Override
     public LongStreamEx flatMap(LongFunction<? extends LongStream> mapper) {
-        return new LongStreamEx(stream().flatMap(mapper), strategy);
+        return new LongStreamEx(stream().flatMap(mapper), context);
     }
 
     /**
@@ -357,7 +359,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      * @since 0.3.0
      */
     public IntStreamEx flatMapToInt(LongFunction<? extends IntStream> mapper) {
-        return new IntStreamEx(stream().mapToObj(mapper).flatMapToInt(Function.identity()), strategy);
+        return new IntStreamEx(stream().mapToObj(mapper).flatMapToInt(Function.identity()), context);
     }
 
     /**
@@ -376,7 +378,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      * @since 0.3.0
      */
     public DoubleStreamEx flatMapToDouble(LongFunction<? extends DoubleStream> mapper) {
-        return new DoubleStreamEx(stream().mapToObj(mapper).flatMapToDouble(Function.identity()), strategy);
+        return new DoubleStreamEx(stream().mapToObj(mapper).flatMapToDouble(Function.identity()), context);
     }
 
     /**
@@ -396,17 +398,17 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      * @since 0.3.0
      */
     public <R> StreamEx<R> flatMapToObj(LongFunction<? extends Stream<R>> mapper) {
-        return new StreamEx<>(stream().mapToObj(mapper).flatMap(Function.identity()), strategy);
+        return new StreamEx<>(stream().mapToObj(mapper).flatMap(Function.identity()), context);
     }
 
     @Override
     public LongStreamEx distinct() {
-        return new LongStreamEx(stream().distinct(), strategy);
+        return new LongStreamEx(stream().distinct(), context);
     }
 
     @Override
     public LongStreamEx sorted() {
-        return new LongStreamEx(stream().sorted(), strategy);
+        return new LongStreamEx(stream().sorted(), context);
     }
 
     /**
@@ -429,7 +431,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      * @return the new stream
      */
     public LongStreamEx sorted(Comparator<Long> comparator) {
-        return new LongStreamEx(stream().boxed().sorted(comparator).mapToLong(Long::longValue), strategy);
+        return new LongStreamEx(stream().boxed().sorted(comparator).mapToLong(Long::longValue), context);
     }
 
     /**
@@ -538,17 +540,17 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
 
     @Override
     public LongStreamEx peek(LongConsumer action) {
-        return new LongStreamEx(stream().peek(action), strategy);
+        return new LongStreamEx(stream().peek(action), context);
     }
 
     @Override
     public LongStreamEx limit(long maxSize) {
-        return new LongStreamEx(stream().limit(maxSize), strategy);
+        return new LongStreamEx(stream().limit(maxSize), context);
     }
 
     @Override
     public LongStreamEx skip(long n) {
-        return new LongStreamEx(stream().skip(n), strategy);
+        return new LongStreamEx(stream().skip(n), context);
     }
 
     /**
@@ -594,8 +596,8 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
         if (spliterator != null && !isParallel()) {
             spliterator().forEachRemaining(action);
         } else {
-            if(strategy.fjp != null)
-                strategy.terminate(() -> {
+            if(context.fjp != null)
+                context.terminate(() -> {
                     stream().forEach(action);
                     return null;
                 });
@@ -610,8 +612,8 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
         if (spliterator != null && !isParallel()) {
             spliterator().forEachRemaining(action);
         } else {
-            if(strategy.fjp != null)
-                strategy.terminate(() -> {
+            if(context.fjp != null)
+                context.terminate(() -> {
                     stream().forEachOrdered(action);
                     return null;
                 });
@@ -623,22 +625,22 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
 
     @Override
     public long[] toArray() {
-        if(strategy.fjp != null)
-            return strategy.terminate(stream()::toArray);
+        if(context.fjp != null)
+            return context.terminate(stream()::toArray);
         return stream().toArray();
     }
 
     @Override
     public long reduce(long identity, LongBinaryOperator op) {
-        if(strategy.fjp != null)
-            return strategy.terminate(() -> stream().reduce(identity, op));
+        if(context.fjp != null)
+            return context.terminate(() -> stream().reduce(identity, op));
         return stream().reduce(identity, op);
     }
 
     @Override
     public OptionalLong reduce(LongBinaryOperator op) {
-        if(strategy.fjp != null)
-            return strategy.terminate(op, stream()::reduce);
+        if(context.fjp != null)
+            return context.terminate(op, stream()::reduce);
         return stream().reduce(op);
     }
 
@@ -812,8 +814,8 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      */
     @Override
     public <R> R collect(Supplier<R> supplier, ObjLongConsumer<R> accumulator, BiConsumer<R, R> combiner) {
-        if(strategy.fjp != null)
-            return strategy.terminate(() -> stream().collect(supplier, accumulator, combiner));
+        if(context.fjp != null)
+            return context.terminate(() -> stream().collect(supplier, accumulator, combiner));
         return stream().collect(supplier, accumulator, combiner);
     }
 
@@ -1110,15 +1112,15 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
 
     @Override
     public long count() {
-        if(strategy.fjp != null)
-            return strategy.terminate(stream()::count);
+        if(context.fjp != null)
+            return context.terminate(stream()::count);
         return stream().count();
     }
 
     @Override
     public OptionalDouble average() {
-        if(strategy.fjp != null)
-            return strategy.terminate(stream()::average);
+        if(context.fjp != null)
+            return context.terminate(stream()::average);
         return stream().average();
     }
 
@@ -1129,15 +1131,15 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
 
     @Override
     public boolean anyMatch(LongPredicate predicate) {
-        if(strategy.fjp != null)
-            return strategy.terminate(predicate, stream()::anyMatch);
+        if(context.fjp != null)
+            return context.terminate(predicate, stream()::anyMatch);
         return stream().anyMatch(predicate);
     }
 
     @Override
     public boolean allMatch(LongPredicate predicate) {
-        if(strategy.fjp != null)
-            return strategy.terminate(predicate, stream()::allMatch);
+        if(context.fjp != null)
+            return context.terminate(predicate, stream()::allMatch);
         return stream().allMatch(predicate);
     }
 
@@ -1148,8 +1150,8 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
 
     @Override
     public OptionalLong findFirst() {
-        if(strategy.fjp != null)
-            return strategy.terminate(stream()::findFirst);
+        if(context.fjp != null)
+            return context.terminate(stream()::findFirst);
         return stream().findFirst();
     }
 
@@ -1176,8 +1178,8 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
 
     @Override
     public OptionalLong findAny() {
-        if(strategy.fjp != null)
-            return strategy.terminate(stream()::findAny);
+        if(context.fjp != null)
+            return context.terminate(stream()::findAny);
         return stream().findAny();
     }
 
@@ -1253,12 +1255,12 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
 
     @Override
     public DoubleStreamEx asDoubleStream() {
-        return new DoubleStreamEx(stream().asDoubleStream(), strategy);
+        return new DoubleStreamEx(stream().asDoubleStream(), context);
     }
 
     @Override
     public StreamEx<Long> boxed() {
-        return new StreamEx<>(stream().boxed(), strategy);
+        return new StreamEx<>(stream().boxed(), context);
     }
 
     @Override
@@ -1295,7 +1297,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
     public LongStreamEx append(long... values) {
         if (values.length == 0)
             return this;
-        return new LongStreamEx(LongStream.concat(stream(), LongStream.of(values)), strategy);
+        return new LongStreamEx(LongStream.concat(stream(), LongStream.of(values)), context);
     }
 
     /**
@@ -1310,7 +1312,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      * @see LongStream#concat(LongStream, LongStream)
      */
     public LongStreamEx append(LongStream other) {
-        return new LongStreamEx(LongStream.concat(stream(), other), strategy.combine(other));
+        return new LongStreamEx(LongStream.concat(stream(), other), context.combine(other));
     }
 
     /**
@@ -1327,7 +1329,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
     public LongStreamEx prepend(long... values) {
         if (values.length == 0)
             return this;
-        return new LongStreamEx(LongStream.concat(LongStream.of(values), stream()), strategy);
+        return new LongStreamEx(LongStream.concat(LongStream.of(values), stream()), context);
     }
 
     /**
@@ -1342,7 +1344,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      * @see LongStream#concat(LongStream, LongStream)
      */
     public LongStreamEx prepend(LongStream other) {
-        return new LongStreamEx(LongStream.concat(other, stream()), strategy.combine(other));
+        return new LongStreamEx(LongStream.concat(other, stream()), context.combine(other));
     }
 
     /**
@@ -1521,7 +1523,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      * @since 0.5.0
      */
     public static LongStreamEx of(Long[] array) {
-        return of(Arrays.stream(array).mapToLong(Long::longValue));
+        return seq(Arrays.stream(array).mapToLong(Long::longValue));
     }
 
     /**
@@ -1533,7 +1535,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      * @since 0.0.8
      */
     public static LongStreamEx of(LongStream stream) {
-        return stream instanceof LongStreamEx ? (LongStreamEx) stream : new LongStreamEx(stream, ExecutionStrategy
+        return stream instanceof LongStreamEx ? (LongStreamEx) stream : new LongStreamEx(stream, StreamContext
                 .of(stream));
     }
 
@@ -1546,7 +1548,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      * @since 0.3.4
      */
     public static LongStreamEx of(Spliterator.OfLong spliterator) {
-        return new LongStreamEx(spliterator, ExecutionStrategy.SEQUENTIAL);
+        return new LongStreamEx(spliterator, StreamContext.SEQUENTIAL);
     }
 
     /**
@@ -1592,7 +1594,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      * @see Collection#stream()
      */
     public static LongStreamEx of(Collection<Long> collection) {
-        return of(collection.stream().mapToLong(Long::longValue));
+        return seq(collection.stream().mapToLong(Long::longValue));
     }
 
     /**
@@ -1608,7 +1610,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      * @see Random#longs()
      */
     public static LongStreamEx of(Random random) {
-        return of(random.longs());
+        return seq(random.longs());
     }
 
     /**
@@ -1625,7 +1627,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      * @see Random#longs(long)
      */
     public static LongStreamEx of(Random random, long streamSize) {
-        return of(random.longs(streamSize));
+        return seq(random.longs(streamSize));
     }
 
     /**
@@ -1640,7 +1642,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      * @see Random#longs(long, long, long)
      */
     public static LongStreamEx of(Random random, long randomNumberOrigin, long randomNumberBound) {
-        return of(random.longs(randomNumberOrigin, randomNumberBound));
+        return seq(random.longs(randomNumberOrigin, randomNumberBound));
     }
 
     /**
@@ -1656,7 +1658,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      * @see Random#longs(long, long, long)
      */
     public static LongStreamEx of(Random random, long streamSize, long randomNumberOrigin, long randomNumberBound) {
-        return of(random.longs(streamSize, randomNumberOrigin, randomNumberBound));
+        return seq(random.longs(streamSize, randomNumberOrigin, randomNumberBound));
     }
 
     /**
@@ -1678,7 +1680,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      * @see LongStream#iterate(long, LongUnaryOperator)
      */
     public static LongStreamEx iterate(final long seed, final LongUnaryOperator f) {
-        return of(LongStream.iterate(seed, f));
+        return seq(LongStream.iterate(seed, f));
     }
 
     /**
@@ -1691,7 +1693,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      * @see LongStream#generate(LongSupplier)
      */
     public static LongStreamEx generate(LongSupplier s) {
-        return of(LongStream.generate(s));
+        return seq(LongStream.generate(s));
     }
 
     /**
@@ -1705,7 +1707,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      * @since 0.1.1
      */
     public static LongStreamEx range(long endExclusive) {
-        return of(LongStream.range(0, endExclusive));
+        return seq(LongStream.range(0, endExclusive));
     }
 
     /**
@@ -1720,7 +1722,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      * @see LongStream#range(long, long)
      */
     public static LongStreamEx range(long startInclusive, long endExclusive) {
-        return of(LongStream.range(startInclusive, endExclusive));
+        return seq(LongStream.range(startInclusive, endExclusive));
     }
 
     /**
@@ -1759,7 +1761,7 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
      * @see LongStream#rangeClosed(long, long)
      */
     public static LongStreamEx rangeClosed(long startInclusive, long endInclusive) {
-        return of(LongStream.rangeClosed(startInclusive, endInclusive));
+        return seq(LongStream.rangeClosed(startInclusive, endInclusive));
     }
 
     /**
@@ -1789,18 +1791,18 @@ public class LongStreamEx extends BaseStreamEx<Long, LongStream, Spliterator.OfL
         if (step == 0)
             throw new IllegalArgumentException("step = 0");
         if (step == 1)
-            return of(LongStream.rangeClosed(startInclusive, endInclusive));
+            return seq(LongStream.rangeClosed(startInclusive, endInclusive));
         if (step == -1) {
             // Handled specially as number of elements can exceed
             // Long.MAX_VALUE
             long sum = endInclusive + startInclusive;
-            return of(LongStream.rangeClosed(endInclusive, startInclusive).map(x -> sum - x));
+            return seq(LongStream.rangeClosed(endInclusive, startInclusive).map(x -> sum - x));
         }
         if ((endInclusive > startInclusive ^ step > 0) || endInclusive == startInclusive)
             return empty();
         long limit = (endInclusive - startInclusive) * Long.signum(step);
         limit = Long.divideUnsigned(limit, Math.abs(step));
-        return of(LongStream.rangeClosed(0, limit).map(x -> x * step + startInclusive));
+        return seq(LongStream.rangeClosed(0, limit).map(x -> x * step + startInclusive));
     }
 
     /**
diff --git a/src/main/java/one/util/streamex/StreamContext.java b/src/main/java/one/util/streamex/StreamContext.java
new file mode 100644
index 0000000..f8dc9de
--- /dev/null
+++ b/src/main/java/one/util/streamex/StreamContext.java
@@ -0,0 +1,140 @@
+/*
+ * Copyright 2015, 2016 Tagir Valeev
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ * 
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ * 
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package one.util.streamex;
+
+import java.util.concurrent.ForkJoinPool;
+import java.util.function.Function;
+import java.util.function.Supplier;
+import java.util.stream.BaseStream;
+
+import static one.util.streamex.StreamExInternals.*;
+
+/**
+ * This class controls stream execution mode (parallel/sequential), custom FJP
+ * and close handlers.
+ * 
+ * Fields are package-private and mutable, but it's forbidden to change them
+ * from outside of this class.
+ * 
+ * For performance reasons shared objects SEQUENTIAL and PARALLEL are used: then
+ * have no custom FJP and no close handler. If custom FJP or close handler is
+ * requested for shared object, a new object is created, otherwise the current
+ * one is modified.
+ * 
+ * @author Tagir Valeev
+ */
+/* package */class StreamContext {
+    static final StreamContext SEQUENTIAL = new StreamContext(false);
+    static final StreamContext PARALLEL = new StreamContext(true);
+
+    boolean parallel;
+    ForkJoinPool fjp;
+    Runnable closeHandler;
+
+    private StreamContext(boolean parallel) {
+        this.parallel = parallel;
+    }
+
+    <T> T terminate(Supplier<T> terminalOperation) {
+        return fjp.submit(terminalOperation::get).join();
+    }
+
+    <T, U> T terminate(U value, Function<U, T> terminalOperation) {
+        return fjp.submit(() -> terminalOperation.apply(value)).join();
+    }
+
+    StreamContext parallel() {
+        if (this == SEQUENTIAL)
+            return PARALLEL;
+        this.parallel = true;
+        this.fjp = null;
+        return this;
+    }
+
+    StreamContext sequential() {
+        if (this == PARALLEL)
+            return SEQUENTIAL;
+        this.parallel = false;
+        this.fjp = null;
+        return this;
+    }
+
+    StreamContext parallel(ForkJoinPool fjp) {
+        StreamContext context = detach();
+        context.parallel = true;
+        context.fjp = fjp;
+        return context;
+    }
+
+    StreamContext detach() {
+        if (this == PARALLEL || this == SEQUENTIAL)
+            return new StreamContext(parallel);
+        return this;
+    }
+
+    StreamContext onClose(Runnable r) {
+        StreamContext context = detach();
+        if (context.closeHandler == null)
+            context.closeHandler = r;
+        else
+            context.closeHandler = compose(context.closeHandler, r);
+        return context;
+    }
+
+    void close() {
+        if (closeHandler != null) {
+            Runnable r = closeHandler;
+            closeHandler = null;
+            r.run();
+        }
+    }
+
+    private Runnable compose(Runnable r1, Runnable r2) {
+        return () -> {
+            try {
+                r1.run();
+            } catch (Throwable t1) {
+                try {
+                    r2.run();
+                } catch (Throwable t2) {
+                    t1.addSuppressed(t2);
+                }
+                throw t1;
+            }
+            r2.run();
+        };
+    }
+
+    StreamContext combine(BaseStream<?, ?> other) {
+        if (other == null)
+            return this;
+        StreamContext otherStrategy = of(other);
+        StreamContext result = this;
+        if (other.isParallel() && !parallel)
+            result = parallel();
+        if (otherStrategy.closeHandler != null)
+            result = result.onClose(otherStrategy.closeHandler);
+        return result;
+    }
+
+    static StreamContext of(BaseStream<?, ?> stream) {
+        if (stream instanceof BaseStreamEx)
+            return ((BaseStreamEx<?, ?, ?>) stream).context;
+        if (mustCloseStream(stream))
+            return new StreamContext(stream.isParallel()).onClose(stream::close);
+        return stream.isParallel() ? PARALLEL : SEQUENTIAL;
+    }
+}
diff --git a/src/main/java/one/util/streamex/StreamEx.java b/src/main/java/one/util/streamex/StreamEx.java
index 816af0e..37fcb7a 100644
--- a/src/main/java/one/util/streamex/StreamEx.java
+++ b/src/main/java/one/util/streamex/StreamEx.java
@@ -77,28 +77,28 @@ import static one.util.streamex.StreamExInternals.*;
  */
 public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
 
-    StreamEx(Stream<T> stream, ExecutionStrategy strategy) {
-        super(stream, strategy);
+    StreamEx(Stream<T> stream, StreamContext context) {
+        super(stream, context);
     }
 
-    StreamEx(Spliterator<T> spliterator, ExecutionStrategy strategy) {
-        super(spliterator, strategy);
+    StreamEx(Spliterator<T> spliterator, StreamContext context) {
+        super(spliterator, context);
     }
     
     @Override
     StreamEx<T> supply(Stream<T> stream) {
-        return new StreamEx<>(stream, strategy);
+        return new StreamEx<>(stream, context);
     }
 
     @Override
     StreamEx<T> supply(Spliterator<T> spliterator) {
-        return new StreamEx<>(spliterator, strategy);
+        return new StreamEx<>(spliterator, context);
     }
 
     final <R> StreamEx<R> collapseInternal(BiPredicate<? super T, ? super T> collapsible, Function<T, R> mapper,
             BiFunction<R, T, R> accumulator, BinaryOperator<R> combiner) {
         CollapseSpliterator<T, R> spliterator = new CollapseSpliterator<>(collapsible, mapper, accumulator, combiner, spliterator());
-        return mustClose() ? new StreamEx<>(delegateBase(spliterator), strategy) : new StreamEx<>(spliterator, strategy);
+        return new StreamEx<>(spliterator, context);
     }
 
     /**
@@ -133,7 +133,7 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
      * @return the new stream
      */
     public <V> EntryStream<T, V> mapToEntry(Function<? super T, ? extends V> valueMapper) {
-        return new EntryStream<>(stream().map(e -> new SimpleImmutableEntry<>(e, valueMapper.apply(e))), strategy);
+        return new EntryStream<>(stream().map(e -> new SimpleImmutableEntry<>(e, valueMapper.apply(e))), context);
     }
 
     /**
@@ -156,7 +156,7 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
     public <K, V> EntryStream<K, V> mapToEntry(Function<? super T, ? extends K> keyMapper,
             Function<? super T, ? extends V> valueMapper) {
         return new EntryStream<>(
-            stream().map(e -> new SimpleImmutableEntry<>(keyMapper.apply(e), valueMapper.apply(e))), strategy);
+            stream().map(e -> new SimpleImmutableEntry<>(keyMapper.apply(e), valueMapper.apply(e))), context);
     }
 
     /**
@@ -176,7 +176,7 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
      * @since 0.4.1
      */
     public StreamEx<T> mapFirst(Function<? super T, ? extends T> mapper) {
-        return delegate(new PairSpliterator.PSOfRef<>(mapper, spliterator(), true));
+        return supply(new PairSpliterator.PSOfRef<>(mapper, spliterator(), true));
     }
 
     /**
@@ -195,7 +195,7 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
      * @since 0.4.1
      */
     public StreamEx<T> mapLast(Function<? super T, ? extends T> mapper) {
-        return delegate(new PairSpliterator.PSOfRef<>(mapper, spliterator(), false));
+        return supply(new PairSpliterator.PSOfRef<>(mapper, spliterator(), false));
     }
 
     /**
@@ -220,7 +220,7 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
         return new EntryStream<>(stream().flatMap(e -> {
             Map<K, V> s = mapper.apply(e);
             return s == null ? null : s.entrySet().stream();
-        }), strategy);
+        }), context);
     }
 
     /**
@@ -246,11 +246,10 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
     @SuppressWarnings("unchecked")
     public <V> EntryStream<T, V> cross(V... other) {
         if (other.length == 0)
-            return mustClose() ? new EntryStream<>(delegateBase(Spliterators.emptySpliterator()), strategy)
-                    : new EntryStream<>(Spliterators.emptySpliterator(), strategy);
+            return new EntryStream<>(Spliterators.emptySpliterator(), context);
         if (other.length == 1)
             return mapToEntry(e -> other[0]);
-        return new EntryStream<>(stream().flatMap(a -> EntryStream.withKey(a, Arrays.stream(other))), strategy);
+        return new EntryStream<>(stream().flatMap(a -> EntryStream.withKey(a, Arrays.stream(other))), context);
     }
 
     /**
@@ -275,9 +274,8 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
      */
     public <V> EntryStream<T, V> cross(Collection<? extends V> other) {
         if (other.isEmpty())
-            return mustClose() ? new EntryStream<>(delegateBase(Spliterators.emptySpliterator()), strategy)
-                    : new EntryStream<>(Spliterators.emptySpliterator(), strategy);
-        return new EntryStream<>(stream().flatMap(a -> EntryStream.withKey(a, other.stream())), strategy);
+            return new EntryStream<>(Spliterators.emptySpliterator(), context);
+        return new EntryStream<>(stream().flatMap(a -> EntryStream.withKey(a, other.stream())), context);
     }
 
     /**
@@ -299,7 +297,7 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
      * @since 0.2.3
      */
     public <V> EntryStream<T, V> cross(Function<? super T, ? extends Stream<? extends V>> mapper) {
-        return new EntryStream<>(stream().flatMap(a -> EntryStream.withKey(a, mapper.apply(a))), strategy);
+        return new EntryStream<>(stream().flatMap(a -> EntryStream.withKey(a, mapper.apply(a))), context);
     }
 
     /**
@@ -1058,7 +1056,7 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
             result = Spliterators.emptySpliterator();
         else
             result = new DistinctSpliterator<>(spliterator, atLeast);
-        return delegate(result);
+        return supply(result);
     }
 
     /**
@@ -1080,9 +1078,8 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
      * @since 0.2.1
      */
     public <R> StreamEx<R> pairMap(BiFunction<? super T, ? super T, ? extends R> mapper) {
-        PSOfRef<T, R> spliterator = new PairSpliterator.PSOfRef<T, R>(mapper, spliterator());
-        return mustClose() ? new StreamEx<>(delegateBase(spliterator), strategy)
-                : new StreamEx<>(spliterator, strategy);
+        PSOfRef<T, R> spliterator = new PairSpliterator.PSOfRef<>(mapper, spliterator());
+        return new StreamEx<>(spliterator, context);
     }
 
     /**
@@ -1236,7 +1233,7 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
         }, (e1, e2) -> {
             e1.b += e2.b;
             return e1;
-        }), strategy);
+        }), context);
     }
 
     /**
@@ -1343,7 +1340,7 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
      */
     public <R> StreamEx<R> withFirst(BiFunction<? super T, ? super T, ? extends R> mapper) {
         WithFirstSpliterator<T, R> spliterator = new WithFirstSpliterator<>(spliterator(), mapper);
-        return mustClose() ? new StreamEx<>(delegateBase(spliterator), strategy) : new StreamEx<>(spliterator, strategy);
+        return new StreamEx<>(spliterator, context);
     }
 
     /**
@@ -1367,7 +1364,7 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
      */
     public EntryStream<T, T> withFirst() {
         WithFirstSpliterator<T, Entry<T, T>> spliterator = new WithFirstSpliterator<>(spliterator(), AbstractMap.SimpleImmutableEntry<T, T>::new);
-        return mustClose() ? new EntryStream<>(delegateBase(spliterator), strategy) : new EntryStream<>(spliterator, strategy);
+        return new EntryStream<>(spliterator, context);
     }
 
     /**
@@ -1483,9 +1480,8 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
     public <R> StreamEx<R> headTail(BiFunction<? super T, ? super StreamEx<T>, ? extends Stream<R>> mapper,
             Supplier<? extends Stream<R>> supplier) {
         HeadTailSpliterator<T, R> spliterator = new HeadTailSpliterator<>(spliterator(), mapper, supplier);
-        Stream<R> delegate = delegateBase(spliterator);
-        spliterator.owner = delegate;
-        return new StreamEx<>(delegate, strategy);
+        spliterator.context = context = context.detach();
+        return new StreamEx<>(spliterator, context);
     }
 
     /**
@@ -1566,7 +1562,7 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
      * @return the wrapped stream
      */
     public static <T> StreamEx<T> of(Stream<T> stream) {
-        return new StreamEx<>(unwrap(stream), ExecutionStrategy.of(stream));
+        return new StreamEx<>(unwrap(stream), StreamContext.of(stream));
     }
 
     /**
@@ -1579,7 +1575,7 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
      * @since 0.3.4
      */
     public static <T> StreamEx<T> of(Spliterator<T> spliterator) {
-        return new StreamEx<>(spliterator, ExecutionStrategy.SEQUENTIAL);
+        return new StreamEx<>(spliterator, StreamContext.SEQUENTIAL);
     }
 
     /**
@@ -2018,7 +2014,7 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
      * @see Stream#iterate(Object, UnaryOperator)
      */
     public static <T> StreamEx<T> iterate(final T seed, final UnaryOperator<T> f) {
-        return of(Stream.iterate(seed, f));
+        return new StreamEx<>(Stream.iterate(seed, f), StreamContext.SEQUENTIAL);
     }
 
     /**
@@ -2032,7 +2028,7 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
      * @see Stream#generate(Supplier)
      */
     public static <T> StreamEx<T> generate(Supplier<T> s) {
-        return of(Stream.generate(s));
+        return new StreamEx<>(Stream.generate(s), StreamContext.SEQUENTIAL);
     }
 
     /**
diff --git a/src/main/java/one/util/streamex/StreamExInternals.java b/src/main/java/one/util/streamex/StreamExInternals.java
index f95b615..bd1f3cc 100644
--- a/src/main/java/one/util/streamex/StreamExInternals.java
+++ b/src/main/java/one/util/streamex/StreamExInternals.java
@@ -1066,9 +1066,6 @@ import java.util.stream.Stream;
     static <T extends BaseStream<?, ?>> boolean mustCloseStream(BaseStream<?, ?> target) {
         if(target == null)
             return false;
-        if (target instanceof BaseStreamEx) {
-            return ((BaseStreamEx<?,?,?>)target).mustClose();
-        }
         try {
             if (SOURCE_STAGE != null && SOURCE_CLOSE_ACTION != null
                 && SOURCE_CLOSE_ACTION.get(SOURCE_STAGE.get(target)) == null)
@@ -1078,22 +1075,4 @@ import java.util.stream.Stream;
         }
         return true;
     }
-
-    /**
-     * Close target when proxy is closed. May omit close handler registration if
-     * target has no close handlers registered.
-     * 
-     * @param proxy stream where close handler should be registered
-     * @param target target stream which must be closed
-     * @return proxy (to chain calls)
-     */
-    static <T extends BaseStream<?, ?>> T delegateClose(T proxy, BaseStream<?, ?> target) {
-        if (mustCloseStream(target)) {
-            if (target instanceof BaseStreamEx)
-                ((BaseStreamEx<?,?,?>)target).forwardClose(proxy);
-            else
-                proxy.onClose(target::close);
-        }
-        return proxy;
-    }
 }
diff --git a/src/test/java/one/util/streamex/BaseStreamExTest.java b/src/test/java/one/util/streamex/BaseStreamExTest.java
index 2ab6563..3901c50 100644
--- a/src/test/java/one/util/streamex/BaseStreamExTest.java
+++ b/src/test/java/one/util/streamex/BaseStreamExTest.java
@@ -17,8 +17,12 @@ package one.util.streamex;
 
 import static org.junit.Assert.*;
 
+import java.util.ArrayList;
 import java.util.Arrays;
+import java.util.List;
 import java.util.Spliterator;
+import java.util.function.Function;
+import java.util.stream.Stream;
 
 import org.junit.Test;
 
@@ -41,4 +45,61 @@ public class BaseStreamExTest {
         s.spliterator();
         s.spliterator();
     }
+    
+    @Test(expected = IllegalStateException.class)
+    public void testStreamConsumed() {
+        StreamEx<Integer> s = StreamEx.of(1, 2, 3);
+        s.spliterator();
+        s.count();
+    }
+    
+    @Test
+    public void testClose() {
+        List<String> closeHandlers = new ArrayList<>();
+        StreamEx<Integer> stream = StreamEx.of(Stream.of(1,2,3).onClose(() -> closeHandlers.add("Orig stream")))
+            .onClose(() -> closeHandlers.add("StreamEx"))
+            .map(x -> x*2)
+            .onClose(() -> closeHandlers.add("After map"))
+            .pairMap((a, b) -> a+b)
+            .onClose(() -> closeHandlers.add("After pairMap"))
+            .append(4)
+            .onClose(() -> closeHandlers.add("After append"))
+            .prepend(Stream.of(5).onClose(() -> closeHandlers.add("Prepended Stream")))
+            .prepend(StreamEx.of(6).onClose(() -> closeHandlers.add("Prepended StreamEx")));
+        assertEquals(Arrays.asList(6, 5, 6, 10, 4), stream.toList());
+        assertTrue(closeHandlers.isEmpty());
+        stream.close();
+        assertEquals(Arrays.asList("Orig stream", "StreamEx", "After map", "After pairMap", "After append",
+            "Prepended Stream", "Prepended StreamEx"), closeHandlers);
+        closeHandlers.clear();
+        stream.close();
+        assertTrue(closeHandlers.isEmpty());
+    }
+    
+    @Test
+    public void testCloseException() {
+        Function<String, Runnable> ex = str -> () -> {throw new IllegalStateException(str);};
+        StreamEx<Integer> stream = StreamEx.of(Stream.of(1,2,3).onClose(ex.apply("Orig stream")))
+            .onClose(ex.apply("StreamEx"))
+            .map(x -> x*2)
+            .onClose(ex.apply("After map"))
+            .pairMap((a, b) -> a+b)
+            .onClose(ex.apply("After pairMap"))
+            .append(4)
+            .onClose(ex.apply("After append"))
+            .prepend(Stream.of(5).onClose(ex.apply("Prepended Stream")))
+            .prepend(StreamEx.of(6).onClose(ex.apply("Prepended StreamEx")));
+        assertEquals(Arrays.asList(6, 5, 6, 10, 4), stream.toList());
+        try {
+            stream.close();
+        }
+        catch(IllegalStateException e) {
+            assertEquals("Orig stream", e.getMessage());
+            assertEquals(Arrays.asList("StreamEx", "After map", "After pairMap", "After append", "Prepended Stream",
+                "Prepended StreamEx"), StreamEx.of(e.getSuppressed()).map(IllegalStateException.class::cast).map(
+                Throwable::getMessage).toList());
+            return;
+        }
+        fail("No exception");
+    }
 }
