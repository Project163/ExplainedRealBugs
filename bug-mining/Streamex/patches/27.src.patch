diff --git a/src/main/java/one/util/streamex/MoreCollectors.java b/src/main/java/one/util/streamex/MoreCollectors.java
index 74431cf..6810272 100644
--- a/src/main/java/one/util/streamex/MoreCollectors.java
+++ b/src/main/java/one/util/streamex/MoreCollectors.java
@@ -49,6 +49,7 @@ import java.util.stream.Collector.Characteristics;
 import java.util.stream.Collectors;
 import java.util.stream.Stream;
 
+import one.util.streamex.StreamExInternals.ObjIntBox;
 import static one.util.streamex.StreamExInternals.*;
 
 /**
@@ -1409,4 +1410,38 @@ public final class MoreCollectors {
             return acc1;
         }, PrimitiveBox::asLong, acc -> acc.b && acc.l == 0, UNORDERED_CHARACTERISTICS);
     }
+    
+    public static Collector<CharSequence, ?, String> commonPrefix() {
+        BiConsumer<ObjIntBox<CharSequence>, CharSequence> accumulator = (acc, t) -> {
+            if(acc.b == -1) {
+                acc.a = t;
+                acc.b = t.length();
+            } else if(acc.b > 0) {
+                if(t.length() < acc.b)
+                    acc.b = t.length();
+                for(int i=0; i<acc.b; i++) {
+                    if(acc.a.charAt(i) != t.charAt(i)) {
+                        if(i > 0 && Character.isHighSurrogate(t.charAt(i-1))
+                                && (Character.isLowSurrogate(t.charAt(i)) || Character.isLowSurrogate(acc.a.charAt(i))))
+                                i--;
+                        acc.b = i;
+                        break;
+                    }
+                }
+            }
+        };
+        return new CancellableCollectorImpl<CharSequence, ObjIntBox<CharSequence>, String>(
+                () -> new ObjIntBox<>(null, -1), 
+                accumulator, 
+                (acc1, acc2) -> {
+                    if (acc1.b == -1)
+                        return acc2;
+                    if (acc2.b != -1)
+                        accumulator.accept(acc1, acc2.a.subSequence(0, acc2.b));
+                    return acc1;
+                }, 
+                acc -> acc.a == null ? "" : acc.a.subSequence(0, acc.b).toString(), 
+                acc -> acc.b == 0,
+                UNORDERED_CHARACTERISTICS);
+    }
 }
diff --git a/src/test/java/one/util/streamex/MoreCollectorsTest.java b/src/test/java/one/util/streamex/MoreCollectorsTest.java
index 0c294ca..4020895 100644
--- a/src/test/java/one/util/streamex/MoreCollectorsTest.java
+++ b/src/test/java/one/util/streamex/MoreCollectorsTest.java
@@ -579,4 +579,26 @@ public class MoreCollectorsTest {
             assertTrue(catched);
         }
     }
+    
+    @Test
+    public void testCommonPrefix() {
+        checkCollectorEmpty("prefix", "", MoreCollectors.commonPrefix());
+        List<String> input = Arrays.asList("abcdef", "abcdefg", "abcdfgfg", "abcefgh", "abcdfg");
+        checkShortCircuitCollector("prefix", "abc", input.size(), input::stream, MoreCollectors.commonPrefix());
+        List<String> input2 = Arrays.asList("abcdef", "abcdefg", "dabcdfgfg", "abcefgh", "abcdfg");
+        checkShortCircuitCollector("prefix", "", 3, input2::stream, MoreCollectors.commonPrefix());
+        List<String> inputHalf = new ArrayList<>();
+        inputHalf.addAll(Collections.nCopies(1000, "abc"));
+        inputHalf.addAll(Collections.nCopies(1000, "def"));
+        checkShortCircuitCollector("prefix", "", 1001, inputHalf::stream, MoreCollectors.commonPrefix());
+        List<String> inputSurrogate = Arrays.asList("abc\ud801\udc2f", "abc\ud801\udc2f", "abc\ud801\udc14");
+        checkShortCircuitCollector("prefix", "abc", inputSurrogate.size(), inputSurrogate::stream,
+            MoreCollectors.commonPrefix());
+        List<String> inputSurrogateBad = Arrays.asList("abc\ud801x", "abc\ud801y", "abc\ud801z");
+        checkShortCircuitCollector("prefix", "abc\ud801", inputSurrogateBad.size(), inputSurrogateBad::stream,
+            MoreCollectors.commonPrefix());
+        List<String> inputSurrogateMix = Arrays.asList("abc\ud801\udc2f", "abc\ud801x", "abc\ud801\udc14");
+        checkShortCircuitCollector("prefix", "abc", inputSurrogateMix.size(), inputSurrogateMix::stream,
+            MoreCollectors.commonPrefix());
+    }
 }
