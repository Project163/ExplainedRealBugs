diff --git a/src/main/java/one/util/streamex/CharSpliterator.java b/src/main/java/one/util/streamex/CharSpliterator.java
index 6e65e07..489a9d8 100644
--- a/src/main/java/one/util/streamex/CharSpliterator.java
+++ b/src/main/java/one/util/streamex/CharSpliterator.java
@@ -28,22 +28,28 @@ import java.util.function.Consumer;
     private final int fence;
     private int nEmpty;
     private String next;
+    private final boolean trimEmpty;
     
-    CharSpliterator(CharSequence source, char delimiter) {
-        this(source, delimiter, 0, source.length());
+    CharSpliterator(CharSequence source, char delimiter, boolean trimEmpty) {
+        this(source, delimiter, 0, source.length(), trimEmpty, 0, null);
     }
 
-    CharSpliterator(CharSequence source, char delimiter, int pos, int fence) {
+    private CharSpliterator(CharSequence source, char delimiter, int pos, int fence, boolean trimEmpty, int nEmpty, String next) {
         this.source = source;
         this.delimiter = delimiter;
         this.pos = pos;
         this.fence = fence;
+        this.trimEmpty = trimEmpty;
+        this.nEmpty = nEmpty;
+        this.next = next;
     }
     
     private int next(int pos) {
+        if(pos == fence)
+            return pos;
         if(source instanceof String) {
             int nextPos = ((String)source).indexOf(delimiter, pos);
-            return nextPos == -1 || nextPos > fence ? fence : nextPos;
+            return nextPos == -1 ? fence : nextPos;
         }
         while(pos < fence) {
             if(source.charAt(pos) == delimiter)
@@ -65,25 +71,21 @@ import java.util.function.Consumer;
             next = null;
             return true;
         }
-        if(pos == fence) {
+        if(pos > fence) {
             return false;
         }
         int nextPos = next(pos);
-        while(nextPos == pos && nextPos != fence) {
-            nEmpty++;
-            nextPos = next(++pos);
+        if(trimEmpty) {
+            while(nextPos == pos && nextPos != fence) {
+                nEmpty++;
+                nextPos = next(++pos);
+            }
         }
         String str = source.subSequence(pos, nextPos).toString();
-        if(nextPos == fence) {
-            pos = fence;
-            if(fence == source.length()) {
-                if(nEmpty > 0 && str.isEmpty()) {
-                    nEmpty = 0; // discard empty strings at the end
-                    return false;
-                }
-            }
-        } else {
-            pos = nextPos+1;
+        pos = nextPos+1;
+        if (trimEmpty && nextPos == fence && str.isEmpty()) {
+            nEmpty = 0; // discard empty strings at the end
+            return false;
         }
         if(nEmpty > 0) {
             next = str;
@@ -96,8 +98,30 @@ import java.util.function.Consumer;
 
     @Override
     public Spliterator<String> trySplit() {
-        // TODO Auto-generated method stub
-        return null;
+        int mid = (pos+fence) >>> 1;
+        int nextPos = next(mid);
+        if(nextPos == fence)
+            return null;
+        Spliterator<String> prefix;
+        if(trimEmpty && nextPos == mid) {
+            while(nextPos < fence && source.charAt(nextPos) == delimiter)
+                nextPos++;
+            if(nextPos == fence) {
+                prefix = new CharSpliterator(source, delimiter, pos, mid, true, nEmpty, next);
+                nEmpty = 0;
+                pos = nextPos + 1;
+            } else {
+                prefix = new CharSpliterator(source, delimiter, pos, mid, false, nEmpty, next);
+                nEmpty = nextPos-mid-1;
+                pos = nextPos;
+            }
+        } else {
+            prefix = new CharSpliterator(source, delimiter, pos, nextPos, false, nEmpty, next);
+            nEmpty = 0;
+            pos = nextPos + 1;
+        }
+        next = null;
+        return prefix;
     }
 
     @Override
diff --git a/src/main/java/one/util/streamex/StreamEx.java b/src/main/java/one/util/streamex/StreamEx.java
index 6dc5546..47cefa5 100644
--- a/src/main/java/one/util/streamex/StreamEx.java
+++ b/src/main/java/one/util/streamex/StreamEx.java
@@ -1854,9 +1854,15 @@ public class StreamEx<T> extends AbstractStreamEx<T, StreamEx<T>> {
     }
 
     public static StreamEx<String> split(CharSequence str, char delimiter) {
-        return of(new CharSpliterator(str, delimiter));
+        return split(str, delimiter, true);
     }
 
+    public static StreamEx<String> split(CharSequence str, char delimiter, boolean trimEmpty) {
+        if(str.length() == 0)
+            return of("");
+        return of(new CharSpliterator(str, delimiter, trimEmpty));
+    }
+    
     /**
      * Returns an infinite sequential ordered {@code StreamEx} produced by
      * iterative application of a function {@code f} to an initial element
diff --git a/src/test/java/one/util/streamex/CharSpliteratorTest.java b/src/test/java/one/util/streamex/CharSpliteratorTest.java
new file mode 100644
index 0000000..1f47375
--- /dev/null
+++ b/src/test/java/one/util/streamex/CharSpliteratorTest.java
@@ -0,0 +1,47 @@
+/*
+ * Copyright 2015 Tagir Valeev
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ * 
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ * 
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package one.util.streamex;
+
+import static one.util.streamex.TestHelpers.*;
+
+import java.util.Arrays;
+import java.util.Random;
+
+import org.junit.Test;
+
+/**
+ * @author Tagir Valeev
+ */
+public class CharSpliteratorTest {
+    @Test
+    public void testSpliterator() {
+        // Empty string is processed differently by CharSpliterator, but this is fixed in StreamEx.split
+        checkSpliterator("split", Arrays.asList(), () -> new CharSpliterator("", ',', true));
+        checkSpliterator("split", Arrays.asList(""), () -> new CharSpliterator("", ',', false));
+        Random r = new Random(1);
+        String[] inputs = {
+                ",", "abcd,e,f,gh,,,i,j,kl,,,,,,", ",","abcdasdfgsdfgsdfgsdfgsdfgsdgdfsgs","abcdasdfgsdfgsdfgsdfgsdfgsdgdfsgs,",
+                "abcdasdfgs,dfgsdfgsdfgsdfgsdgdfsgs","abcd,e,f,gh,,,i,j,kl,,,,,,x","abcd,e,f,gh,,,i,j,kl,,,,,,x,",
+                IntStreamEx.of(r, 0, 3).limit(r.nextInt(1000)).elements(new int[] {',', 'a', 'b'}).charsToString()
+        };
+        for(String input : inputs) {
+            checkSpliterator(input, Arrays.asList(input.split(",")),
+                () -> new CharSpliterator(input, ',', true));
+            checkSpliterator(input, Arrays.asList(input.split(",", -1)),
+                () -> new CharSpliterator(input, ',', false));
+        }
+    }
+}
diff --git a/src/test/java/one/util/streamex/StreamExTest.java b/src/test/java/one/util/streamex/StreamExTest.java
index 287878f..ea611aa 100644
--- a/src/test/java/one/util/streamex/StreamExTest.java
+++ b/src/test/java/one/util/streamex/StreamExTest.java
@@ -1539,10 +1539,23 @@ public class StreamExTest {
             assertEquals(s.toString(), "abcd", s.get().joining("|"));
         }
         for(StreamExSupplier<String> s : streamEx(() -> StreamEx.split("", ','))) {
-            assertEquals(s.toString(), 0, s.get().count());
+            assertEquals(s.toString(), Arrays.asList(""), s.get().toList());
         }
         for(StreamExSupplier<String> s : streamEx(() -> StreamEx.split(",,,,,,,,,", ','))) {
             assertEquals(s.toString(), 0, s.get().count());
         }
+        Random r = new Random(1);
+        for(int i=0; i<10; i++) {
+            StringBuilder source = new StringBuilder(IntStreamEx.of(r, 0, 3).limit(r.nextInt(10000))
+                    .elements(new int[] { ',', 'a', 'b' }).charsToString());
+            String[] expected = source.toString().split(",");
+            for (StreamExSupplier<String> s : streamEx(() -> StreamEx.split(source, ','))) {
+                assertArrayEquals(s.toString(), expected, s.get().toArray(String[]::new));
+            }
+            expected = source.toString().split(",", -1);
+            for (StreamExSupplier<String> s : streamEx(() -> StreamEx.split(source, ',', false))) {
+                assertArrayEquals(s.toString(), expected, s.get().toArray(String[]::new));
+            }
+        }
     }
 }
