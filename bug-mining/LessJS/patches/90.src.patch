diff --git a/lib/less/extend-visitor.js b/lib/less/extend-visitor.js
index 0b1e5947..1cd53622 100644
--- a/lib/less/extend-visitor.js
+++ b/lib/less/extend-visitor.js
@@ -233,6 +233,7 @@
             //
             var haystackSelectorIndex, hackstackSelector, hackstackElementIndex, haystackElement,
                 targetCombinator, i,
+                extendVisitor = this,
                 needleElements = extend.selector.elements,
                 potentialMatches = [], potentialMatch, matches = [];
 
@@ -261,7 +262,7 @@
                         }
 
                         // if we don't match, null our match to indicate failure
-                        if (needleElements[potentialMatch.matched].value !== haystackElement.value ||
+                        if (!extendVisitor.isElementValuesEqual(needleElements[potentialMatch.matched].value, haystackElement.value) ||
                             (potentialMatch.matched > 0 && needleElements[potentialMatch.matched].combinator.value !== targetCombinator)) {
                             potentialMatch = null;
                         } else {
@@ -294,6 +295,26 @@
             }
             return matches;
         },
+        isElementValuesEqual: function(elementValue1, elementValue2) {
+            if (typeof elementValue1 === "string" || typeof elementValue2 === "string") {
+                return elementValue1 === elementValue2;
+            }
+            if (elementValue1 instanceof tree.Attribute) {
+                if (elementValue1.op !== elementValue2.op || elementValue1.key !== elementValue2.key) {
+                    return false;
+                }
+                if (!elementValue1.value || !elementValue2.value) {
+                    if (elementValue1.value || elementValue2.value) {
+                        return false;
+                    }
+                    return true;
+                }
+                elementValue1 = elementValue1.value.value || elementValue1.value;
+                elementValue2 = elementValue2.value.value || elementValue2.value;
+                return elementValue1 === elementValue2;
+            }
+            return false;
+        },
         extendSelector:function (matches, selectorPath, replacementSelector) {
 
             //for a set of matches, replace each match with the replacement selector
diff --git a/test/css/extend-selector.css b/test/css/extend-selector.css
index 294bfdb7..dc03d1cd 100644
--- a/test/css/extend-selector.css
+++ b/test/css/extend-selector.css
@@ -58,3 +58,15 @@ div.ext7,
 .c.rep_ace + .rep_ace .c {
   prop: copy-paste-replace;
 }
+.attributes [data="test"],
+.attributes .attributes .attribute-test {
+  extend: attributes;
+}
+.attributes [data],
+.attributes .attributes .attribute-test2 {
+  extend: attributes2;
+}
+.attributes [data="test3"],
+.attributes .attributes .attribute-test {
+  extend: attributes2;
+}
diff --git a/test/less/extend-selector.less b/test/less/extend-selector.less
index e6ae32b3..7d6f044c 100644
--- a/test/less/extend-selector.less
+++ b/test/less/extend-selector.less
@@ -60,3 +60,25 @@ div.ext5,
   }
 }
 .rep_ace:extend(.replace all) {}
+
+.attributes {
+  [data="test"] {
+    extend: attributes;
+  }
+  .attribute-test {
+    &:extend([data="test"] all);
+  }
+  [data] {
+    extend: attributes2;
+  }
+  .attribute-test2 {
+    &:extend([data] all); //you could argue it should match [data="test"]... not for now though...
+  }
+  @attr-data: "test3";
+  [data=@{attr-data}] {
+    extend: attributes2;
+  }
+  .attribute-test {
+    &:extend([data="test3"] all);
+  }
+}
\ No newline at end of file
