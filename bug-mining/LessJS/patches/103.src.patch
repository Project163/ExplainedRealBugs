diff --git a/lib/less/extend-visitor.js b/lib/less/extend-visitor.js
index 8fb793d8..9e66c089 100644
--- a/lib/less/extend-visitor.js
+++ b/lib/less/extend-visitor.js
@@ -363,7 +363,7 @@
                 }
                 currentSelectorPathIndex = match.endPathIndex;
                 currentSelectorPathElementIndex = match.endPathElementIndex;
-                if (currentSelectorPathElementIndex >= selector.elements.length) {
+                if (currentSelectorPathElementIndex >= selectorPath[currentSelectorPathIndex].elements.length) {
                     currentSelectorPathElementIndex = 0;
                     currentSelectorPathIndex++;
                 }
diff --git a/test/css/extend-selector.css b/test/css/extend-selector.css
index 4a525746..da47254b 100644
--- a/test/css/extend-selector.css
+++ b/test/css/extend-selector.css
@@ -70,3 +70,11 @@ div.ext7,
 .attributes .attributes .attribute-test {
   extend: attributes2;
 }
+.header .header-nav,
+.footer .footer-nav {
+  background: red;
+}
+.header .header-nav:before,
+.footer .footer-nav:before {
+  background: blue;
+}
diff --git a/test/less/extend-selector.less b/test/less/extend-selector.less
index 7d6f044c..c7588ee0 100644
--- a/test/less/extend-selector.less
+++ b/test/less/extend-selector.less
@@ -81,4 +81,19 @@ div.ext5,
   .attribute-test {
     &:extend([data="test3"] all);
   }
+}
+
+.header {
+  .header-nav {
+    background: red;
+    &:before {
+      background: blue;
+    }
+  }
+}
+
+.footer {
+  .footer-nav {
+    &:extend( .header .header-nav all );
+  }
 }
\ No newline at end of file
