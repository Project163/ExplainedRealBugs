{"url":"https://api.github.com/repos/less/less.js/issues/3646","repository_url":"https://api.github.com/repos/less/less.js","labels_url":"https://api.github.com/repos/less/less.js/issues/3646/labels{/name}","comments_url":"https://api.github.com/repos/less/less.js/issues/3646/comments","events_url":"https://api.github.com/repos/less/less.js/issues/3646/events","html_url":"https://github.com/less/less.js/issues/3646","id":983086271,"node_id":"MDU6SXNzdWU5ODMwODYyNzE=","number":3646,"title":"Error thrown on compiling using a sourcemap and autoprefix in Node v14","user":{"login":"coreyoss","id":56559979,"node_id":"MDQ6VXNlcjU2NTU5OTc5","avatar_url":"https://avatars.githubusercontent.com/u/56559979?v=4","gravatar_id":"","url":"https://api.github.com/users/coreyoss","html_url":"https://github.com/coreyoss","followers_url":"https://api.github.com/users/coreyoss/followers","following_url":"https://api.github.com/users/coreyoss/following{/other_user}","gists_url":"https://api.github.com/users/coreyoss/gists{/gist_id}","starred_url":"https://api.github.com/users/coreyoss/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coreyoss/subscriptions","organizations_url":"https://api.github.com/users/coreyoss/orgs","repos_url":"https://api.github.com/users/coreyoss/repos","events_url":"https://api.github.com/users/coreyoss/events{/privacy}","received_events_url":"https://api.github.com/users/coreyoss/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2103265,"node_id":"MDU6TGFiZWwyMTAzMjY1","url":"https://api.github.com/repos/less/less.js/labels/bug","name":"bug","color":"e10c02","default":true,"description":null},{"id":725032973,"node_id":"MDU6TGFiZWw3MjUwMzI5NzM=","url":"https://api.github.com/repos/less/less.js/labels/good%20first%20issue","name":"good first issue","color":"FFF608","default":true,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2021-08-30T18:38:34Z","updated_at":"2021-11-11T11:22:02Z","closed_at":"2021-11-11T11:22:02Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Hello,\r\n\r\nI recently upgraded to Node v4.17.5 and it seems a newly added exception there is breaking my Less build.\r\n\r\nI'm using less v4.1.1 and less-plugin-autoprefix v2.0.0. To recreate the issue I've -\r\n1. Installed the above packages globally\r\n2. Created a less file (test.less) with the following content -\r\n```\r\np {\r\n    color: blue;\r\n}\r\n```\r\n3. On the command line, run -\r\n`lessc test.less test.css --source-map=test.css.map --autoprefix='defaults'`\r\n\r\nOn running this, I get the errors -\r\n```\r\ninternal/fs/utils.js:793\r\n  throw new ERR_INVALID_ARG_TYPE(\r\n  ^\r\n\r\nTypeError [ERR_INVALID_ARG_TYPE]: The \"data\" argument must be of type string or an instance of Buffer, TypedArray, or DataView. Received an instance of SourceMapGenerator\r\n    at writeFile (fs.js:1487:5)\r\n    at go$writeFile (/usr/lib/node_modules/less/node_modules/graceful-fs/graceful-fs.js:138:14)\r\n    at Object.writeFile (/usr/lib/node_modules/less/node_modules/graceful-fs/graceful-fs.js:135:12)\r\n    at writeSourceMap (/usr/lib/node_modules/less/bin/lessc:183:10)\r\n    at writeSourceMapIfNeeded (/usr/lib/node_modules/less/bin/lessc:207:7)\r\n    at /usr/lib/node_modules/less/bin/lessc:299:11\r\n    at /usr/lib/node_modules/less/bin/lessc:237:11\r\n    at /usr/lib/node_modules/less/node_modules/graceful-fs/graceful-fs.js:143:16\r\n    at /usr/lib/node_modules/less/node_modules/graceful-fs/graceful-fs.js:61:14\r\n    at FSReqCallback.oncomplete (fs.js:180:23) {\r\n  code: 'ERR_INVALID_ARG_TYPE'\r\n}\r\n```\r\n\r\nInterestingly, I don't get the error if I exclude the sourcemap or the autoprefix. Eg. `lessc test.less test.css --source-map=test.css.map` works and so does `lessc test.less test.css --autoprefix='defaults'`.\r\n\r\nI downgraded to Node v12.22.5 and this works fine.\r\n\r\nAny help in resolving this would be appreciated!\r\n\r\nThanks,\r\nCorey","closed_by":{"login":"iChenLei","id":14012511,"node_id":"MDQ6VXNlcjE0MDEyNTEx","avatar_url":"https://avatars.githubusercontent.com/u/14012511?v=4","gravatar_id":"","url":"https://api.github.com/users/iChenLei","html_url":"https://github.com/iChenLei","followers_url":"https://api.github.com/users/iChenLei/followers","following_url":"https://api.github.com/users/iChenLei/following{/other_user}","gists_url":"https://api.github.com/users/iChenLei/gists{/gist_id}","starred_url":"https://api.github.com/users/iChenLei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iChenLei/subscriptions","organizations_url":"https://api.github.com/users/iChenLei/orgs","repos_url":"https://api.github.com/users/iChenLei/repos","events_url":"https://api.github.com/users/iChenLei/events{/privacy}","received_events_url":"https://api.github.com/users/iChenLei/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/less/less.js/issues/3646/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/less/less.js/issues/3646/timeline","performed_via_github_app":null,"state_reason":"completed"}