diff --git a/NOTICE b/NOTICE
index f1910d315..39dca8fb3 100644
--- a/NOTICE
+++ b/NOTICE
@@ -8,7 +8,7 @@
 =========================================================================
 
 Apache Derby
-Copyright 2004-2015 The Apache Software Foundation
+Copyright 2004-2018 The Apache Software Foundation
 
 This product includes software developed by
 The Apache Software Foundation (http://www.apache.org/).
@@ -42,18 +42,6 @@ http://www.itl.nist.gov/div897/ctg/sql_form.htm
 
 
 
-=========================================================================
-
-
-Derby uses the  SerialBlob and SerialClob implementations from the Apache
-Harmony project. The following notice covers the Harmony sources:
-
-Portions of Harmony were originally developed by
-Intel Corporation and are licensed to the Apache Software
-Foundation under the "Software Grant and Corporate Contribution
-License Agreement", informally known as the "Intel Harmony CLA".
-
-
 =========================================================================
 
 
diff --git a/build.xml b/build.xml
index bb54462be..edf4c752d 100644
--- a/build.xml
+++ b/build.xml
@@ -397,7 +397,7 @@
     <taskdef
       name="writeAndCheckinReleaseProperties"
       classname="org.apache.derbyPreBuild.ReleaseProperties"
-      classpath="${out.build.dir}"
+      classpath="${out.build.dir}:${derby.shared.src.dir}"
     />
 
     <property name="releasePropertyFile" value="${properties.dir}/release.properties"/>
@@ -2132,7 +2132,7 @@
 
     <java classname="org.apache.derbyBuild.maintversion2props">
         <classpath path="${out.build.dir}"/>
-        <arg value="${out.engine.dir}/org/apache/derby/info/DBMS.properties"/>
+        <arg value="${out.engine.dir}/org/apache/derby/info/engine/info.properties"/>
         <arg value="${snapshot.dir}/maintversion.properties"/>
     </java>
     <property file="${snapshot.dir}/maintversion.properties"/>
diff --git a/java/build/org/apache/derbyBuild/maintversion2props.java b/java/build/org/apache/derbyBuild/maintversion2props.java
index 89ff853d1..3a87564f9 100644
--- a/java/build/org/apache/derbyBuild/maintversion2props.java
+++ b/java/build/org/apache/derbyBuild/maintversion2props.java
@@ -43,14 +43,14 @@ public class maintversion2props
         InputStream is = new FileInputStream(args[0]);
         Properties p = new Properties();
         p.load(is);
-	String maint = "";
-        if (args[0].indexOf("DBMS") > 0)
-        {
-          maint = p.getProperty("derby.version.maint");
-        } else if (args[0].indexOf("release") > 0)
+
+	    String maint = "";
+        maint = p.getProperty("derby.version.maint");
+        if (maint == null)
         { 
-          maint = p.getProperty("maint");
+            maint = p.getProperty("maint");
         }
+        
         Properties p2 = new Properties();
         p2.setProperty("interim", Integer.toString(Integer.parseInt(maint) / 1000000));
         p2.setProperty("point", Integer.toString(Integer.parseInt(maint) % 1000000));
diff --git a/java/build/org/apache/derbyPreBuild/ReleaseProperties.java b/java/build/org/apache/derbyPreBuild/ReleaseProperties.java
index b65e41434..e6808ec42 100644
--- a/java/build/org/apache/derbyPreBuild/ReleaseProperties.java
+++ b/java/build/org/apache/derbyPreBuild/ReleaseProperties.java
@@ -144,7 +144,6 @@ public class ReleaseProperties extends Task
 
         try {
             int     drdaMaintID = readDRDAMaintID( target );
-            System.out.println( "XXX ReleaseProperties. drda maint id = " + drdaMaintID );
             
             VersionID versionID = new VersionID( _releaseID );
             if ( _bump ) { versionID.bump(); }
diff --git a/java/build/org/apache/derbyPreBuild/build.xml b/java/build/org/apache/derbyPreBuild/build.xml
index e0c4aeda2..dbcb961ac 100644
--- a/java/build/org/apache/derbyPreBuild/build.xml
+++ b/java/build/org/apache/derbyPreBuild/build.xml
@@ -32,6 +32,29 @@
   <target name="build" depends="compile"/>
 
   <target name="compile">
+
+    <!-- Needed by ReleaseProperties -->
+    <javac
+      source="${min.version}"
+      target="${min.version}"
+      nowarn="on"
+      debug="true"
+      depend="${depend}"
+      deprecation="${deprecation}"
+      optimize="${optimize}"
+      proceed="${proceed}"
+      verbose="${verbose}"
+      srcdir="${derby.shared.src.dir}"
+      destdir="${out.shared.dir}"
+      includeantruntime="false"
+      includes="org/apache/derby/shared/common/info/PropertyNames.java"
+    >
+      <classpath>
+        <pathelement path="${ant.core.lib}"/>
+      </classpath>
+      <compilerarg value="-Xlint:unchecked"/>
+    </javac>
+
     <javac
       source="${min.version}"
       target="${min.version}"
@@ -44,12 +67,15 @@
       verbose="${verbose}"
       srcdir="${derby.build.src.dir}"
       destdir="${out.build.dir}"
-      includeantruntime="false">
-      <include name="org/apache/derbyPreBuild/** ../engine/org/apache/derby/iapi/services/info/PropertyNames.java"/>
+      includeantruntime="false"
+      includes="org/apache/derbyPreBuild/*.java"
+    >
       <classpath>
         <pathelement path="${ant.core.lib}"/>
+        <pathelement path="${out.shared.dir}"/>
       </classpath>
       <compilerarg value="-Xlint:unchecked"/>
     </javac>
+
   </target>
 </project>
diff --git a/java/demo/build.xml b/java/demo/build.xml
index 6c089fdf9..f0780a194 100644
--- a/java/demo/build.xml
+++ b/java/demo/build.xml
@@ -46,9 +46,8 @@
       proceed="${proceed}"
       verbose="${verbose}"
       destdir="${out.demo.dir}"
-      srcdir="${derby.demo.src.dir}/nserverdemo"
-      includes="nserverdemo/**"
-      excludes="nserverdemo/Simple*">
+      srcdir="${derby.demo.src.dir}"
+      includes="nserverdemo/**">
       <compilerarg value="-Xlint:unchecked"/>
       <compilerarg value="-Xlint:deprecation"/>
       <classpath>
diff --git a/java/org.apache.derby.client/module-info.java b/java/org.apache.derby.client/module-info.java
index 3f64837a4..7a0b04d0c 100644
--- a/java/org.apache.derby.client/module-info.java
+++ b/java/org.apache.derby.client/module-info.java
@@ -35,7 +35,7 @@
  *  module supports JNDI lookup of DataSources.</li>
  * </ul>
  * 
- * <p><b>Module Diagram:</b</p>
+ * <p><b>Module Diagram:</b></p>
  *
  * <div style="text-align:center;">
  *   <img
diff --git a/java/org.apache.derby.commons/module-info.java b/java/org.apache.derby.commons/module-info.java
index aaecd8af6..a854bb997 100644
--- a/java/org.apache.derby.commons/module-info.java
+++ b/java/org.apache.derby.commons/module-info.java
@@ -24,7 +24,7 @@
  * All configurations need this utility module.
  * </p>
  * 
- * <p><b>Module Diagram:</b</p>
+ * <p><b>Module Diagram:</b></p>
  *
  * <div style="text-align:center;">
  *   <img
diff --git a/java/org.apache.derby.engine/module-info.java b/java/org.apache.derby.engine/module-info.java
index 7f1852a91..10ecec33b 100644
--- a/java/org.apache.derby.engine/module-info.java
+++ b/java/org.apache.derby.engine/module-info.java
@@ -44,7 +44,7 @@
  *  module supports JNDI lookup of DataSources and LDAP authenticators.</li>
  * </ul>
  *
- * <p><b>Module Diagram:</b</p>
+ * <p><b>Module Diagram:</b></p>
  *
  * <div style="text-align:center;">
  *   <img
diff --git a/java/org.apache.derby.optionaltools/module-info.java b/java/org.apache.derby.optionaltools/module-info.java
index 61a5302ee..efd055b33 100644
--- a/java/org.apache.derby.optionaltools/module-info.java
+++ b/java/org.apache.derby.optionaltools/module-info.java
@@ -46,7 +46,7 @@
  *  the embedded driver.</li>
  * </ul>
  * 
- * <p><b>Module Diagram:</b</p>
+ * <p><b>Module Diagram:</b></p>
  *
  * <div style="text-align:center;">
  *   <img
diff --git a/java/org.apache.derby.runner/module-info.java b/java/org.apache.derby.runner/module-info.java
index b4a3383b3..ebf941a82 100644
--- a/java/org.apache.derby.runner/module-info.java
+++ b/java/org.apache.derby.runner/module-info.java
@@ -32,7 +32,7 @@
  *  module supports JNDI lookup of LDAP authenticators.</li>
  * </ul>
  * 
- * <p><b>Module Diagram:</b</p>
+ * <p><b>Module Diagram:</b></p>
  *
  * <div style="text-align:center;">
  *   <img
diff --git a/java/org.apache.derby.server/module-info.java b/java/org.apache.derby.server/module-info.java
index b9bd25d46..9236d7453 100644
--- a/java/org.apache.derby.server/module-info.java
+++ b/java/org.apache.derby.server/module-info.java
@@ -27,7 +27,7 @@
  * configuration to provide their extra functionality.
  * </p>
  * 
- * <p><b>Module Diagram:</b</p>
+ * <p><b>Module Diagram:</b></p>
  *
  * <div style="text-align:center;">
  *   <img
diff --git a/java/org.apache.derby.tests/module-info.java b/java/org.apache.derby.tests/module-info.java
index d72ab7a7d..d80dcfb03 100644
--- a/java/org.apache.derby.tests/module-info.java
+++ b/java/org.apache.derby.tests/module-info.java
@@ -24,7 +24,7 @@
  * The Derby tests exercise all of the modules.
  * </p>
  * 
- * <p><b>Module Diagram:</b</p>
+ * <p><b>Module Diagram:</b></p>
  *
  * <div style="text-align:center;">
  *   <img
diff --git a/java/org.apache.derby.tools/module-info.java b/java/org.apache.derby.tools/module-info.java
index 9c08ad1c6..1287086b6 100644
--- a/java/org.apache.derby.tools/module-info.java
+++ b/java/org.apache.derby.tools/module-info.java
@@ -42,7 +42,7 @@
  *  the embedded driver.</li>
  * </ul>
  * 
- * <p><b>Module Diagram:</b</p>
+ * <p><b>Module Diagram:</b></p>
  *
  * <div style="text-align:center;">
  *   <img
diff --git a/maven2/README.txt b/maven2/README.txt
index 57e06300a..a3c86f228 100644
--- a/maven2/README.txt
+++ b/maven2/README.txt
@@ -47,7 +47,7 @@ Description of the required steps:
       o The Derby release version.
         The version must be specified in all POMs. Compile and execute the
         Java program SetDerbyVersion, found in the 'maven2' directory, i.e.:
-            javac SetDerbyVersion && java -cp . SetDerbyVersion
+            javac SetDerbyVersion && java -cp .:../jars/insane/derbyshared.jar:../jars/insane/derby.jar SetDerbyVersion
 
         Alternatively, use search and replace (i.e. Perl or sed) - make sure
         you don't replace version tags that aren't supposed to be modified.
diff --git a/maven2/SetDerbyVersion.java b/maven2/SetDerbyVersion.java
index 8f662b60d..303198d0c 100644
--- a/maven2/SetDerbyVersion.java
+++ b/maven2/SetDerbyVersion.java
@@ -31,7 +31,7 @@ import java.net.URL;
 import java.net.URLClassLoader;
 import java.sql.Connection;
 import java.sql.DatabaseMetaData;
-import java.sql.Driver;
+import java.sql.DriverManager;
 import java.util.ArrayList;
 import java.util.List;
 
@@ -63,6 +63,7 @@ public class SetDerbyVersion {
     private static final File INSANE = new File(REL_JAR_PATH, "insane");
     /** List of required jar files the Maven 2 Derby artifacts. */
     private static final String[] JARS = new String[] {
+        "derbyshared.jar",
         "derby.jar",
         "derby.war",
         "derbynet.jar",
@@ -193,31 +194,9 @@ public class SetDerbyVersion {
         // The class loader used for the Derby jars.
         URLClassLoader cl = new URLClassLoader(URLS, null);
 
-        // Extra sanity check for the sanity...
-        try {
-            Class.forName(
-                    "org.apache.derby.shared.common.sanity.SanityManager",
-                    true ,cl);
-            if (PREFIX == INSANE) {
-                warn("Found SanityManager in INSANE build. Aborting.");
-                return false;
-            }
-        } catch (ClassNotFoundException cnfe) {
-            if (PREFIX == SANE) {
-                warn("Unable to load SanityManager in SANE build. Aborting.");
-                return false;
-            }
-        }
-
         // Fire up Derby to get the version string.
-        Class driverClass =
-                Class.forName("org.apache.derby.jdbc.EmbeddedDriver", true, cl);
-        Driver driver = (Driver)driverClass.newInstance();
-        Connection con = driver.connect(JDBC_URL, null);
+        Connection con = DriverManager.getConnection(JDBC_URL);
         DatabaseMetaData meta = con.getMetaData();
-        con.close();
-        // Delete the derby.log file.
-        new File("derby.log").delete();
 
         // I.e.: 10.6.0.0 alpha - (882129M)
         String fullVersion = meta.getDatabaseProductVersion();
@@ -241,6 +220,11 @@ public class SetDerbyVersion {
                 return false;
             }
         }
+        
+        con.close();
+        // Delete the derby.log file.
+        new File("derby.log").delete();
+
         return true;
     }
 
diff --git a/maven2/commons/pom.xml b/maven2/commons/pom.xml
new file mode 100644
index 000000000..e97c4b688
--- /dev/null
+++ b/maven2/commons/pom.xml
@@ -0,0 +1,61 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+  Licensed to the Apache Software Foundation (ASF) under one
+  or more contributor license agreements.  See the NOTICE file
+  distributed with this work for additional information
+  regarding copyright ownership.  The ASF licenses this file
+  to you under the Apache License, Version 2.0 (the
+  "License"); you may not use this file except in compliance
+  with the License.  You may obtain a copy of the License at
+
+  http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing,
+  software distributed under the License is distributed on an
+  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+  KIND, either express or implied.  See the License for the
+  specific language governing permissions and limitations
+  under the License.
+  -->
+<project
+    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"
+    xmlns="http://maven.apache.org/POM/4.0.0"
+    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
+  <modelVersion>4.0.0</modelVersion>
+  <groupId>org.apache.derby</groupId>
+  <parent>
+    <groupId>org.apache.derby</groupId>
+    <artifactId>derby-project</artifactId>
+    <version>ALPHA_VERSION</version>
+  </parent>
+  <artifactId>derbyshared</artifactId>
+  <name>Apache Derby Shared Code</name>
+  <description>The code which is shared across all Derby configurations.</description>
+  <url>http://db.apache.org/derby/</url>
+
+  <build>
+    <plugins>
+        <plugin>
+            <artifactId>maven-antrun-plugin</artifactId>
+            <executions>
+                <execution>
+                    <phase>package</phase>
+                    <configuration>
+                        <tasks>
+
+                <copy file="${basedir}/../../jars/${sanity}/derbyshared.jar"
+                      tofile="${basedir}/target/${project.build.finalName}.jar"
+                      overwrite="true"/>
+
+                        </tasks>
+                    </configuration>
+                    <goals>
+                        <goal>run</goal>
+                    </goals>
+                </execution>
+            </executions>
+        </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/tools/release/build.xml b/tools/release/build.xml
index a2cba170f..00abc76cb 100644
--- a/tools/release/build.xml
+++ b/tools/release/build.xml
@@ -86,8 +86,8 @@
     <mkdir dir="${release.dir}"/>
 
     <java classname="org.apache.derbyBuild.maintversion2props">
-        <classpath path="${out.dir}"/>
-        <arg value="${out.dir}/org/apache/derby/info/DBMS.properties"/>
+        <classpath path="${out.build.dir}"/>
+        <arg value="${out.engine.dir}/org/apache/derby/info/engine/info.properties"/>
         <arg value="${release.dir}/maintversion.properties"/>
     </java>
 	
@@ -208,13 +208,13 @@
                   prefix="${derby.bin}/demo/programs/simple"/>
       <zipfileset dir="${basedir}/classes" includes="SimpleNetwork*.class"
                   prefix="${derby.bin}/demo/programs/nserverdemo"/>
-      <zipfileset dir="${basedir}/classes/nserverdemo" includes="*.class"
+      <zipfileset dir="${basedir}/classes/demo/nserverdemo" includes="*.class"
                   prefix="${derby.bin}/demo/programs/nserverdemo"/>
       <zipfileset dir="${generated.toursdb.dir}" includes="toursdb/**,toursdb.jar"
                   prefix="${derby.bin}/demo/databases"/>
       <zipfileset dir="${basedir}/classes" includes="Wwd*.class"
                   prefix="${derby.bin}/demo/programs/workingwithderby"/>
-      <zipfileset dir="${basedir}/classes/org/apache/derbyDemo" includes="vtis/**"
+      <zipfileset dir="${basedir}/classes/demo/org/apache/derbyDemo" includes="vtis/**"
                   prefix="${derby.bin}/demo/programs/vtis/org/apache/derbyDemo"/>
 
       <!-- docs -->
@@ -229,7 +229,7 @@
 	          excludes="derby_core_plugin*,derbyTesting.jar"/>
       <!-- test -->
       <zipfileset dir="${basedir}/jars/insane" prefix="${derby.bin}/test" includes="derbyTesting.jar"/>
-      <zipfileset dir="${basedir}/java/testing" prefix="${derby.bin}/test" 
+      <zipfileset dir="${basedir}/java/${module.name.tests}" prefix="${derby.bin}/test" 
                   includes="README.htm"/>
     </zip>
   </target>
@@ -271,13 +271,13 @@
                   prefix="${derby.bin}/demo/programs/simplemobile"/>
       <tarfileset dir="${basedir}/classes" includes="SimpleNetwork*.class"
                   prefix="${derby.bin}/demo/programs/nserverdemo"/>
-      <tarfileset dir="${basedir}/classes/nserverdemo" includes="*.class"
+      <tarfileset dir="${basedir}/classes/demo/nserverdemo" includes="*.class"
                   prefix="${derby.bin}/demo/programs/nserverdemo"/>
       <tarfileset dir="${generated.toursdb.dir}" includes="toursdb/**,toursdb.jar"
                   prefix="${derby.bin}/demo/databases"/>
       <tarfileset dir="${basedir}/classes" includes="Wwd*.class"
                   prefix="${derby.bin}/demo/programs/workingwithderby"/>
-      <tarfileset dir="${basedir}/classes/org/apache/derbyDemo" includes="vtis/**"
+      <tarfileset dir="${basedir}/classes/demo/org/apache/derbyDemo" includes="vtis/**"
                   prefix="${derby.bin}/demo/programs/vtis/org/apache/derbyDemo"/>
       <!-- docs -->
       <tarfileset dir="${docs.root}/out" includes="**/*.html,**/*.jpg,**/*.gif,**/*.css"
@@ -291,7 +291,7 @@
 	              excludes="derby_core_plugin*,derbyTesting.jar"/>
       <!-- test -->
       <tarfileset dir="${basedir}/jars/insane" prefix="${derby.bin}/test" includes="derbyTesting.jar"/>
-      <tarfileset dir="${basedir}/java/testing" prefix="${derby.bin}/test" 
+      <tarfileset dir="${basedir}/java/${module.name.tests}" prefix="${derby.bin}/test" 
                   includes="README.htm"/>
     </tar>
   </target>
@@ -306,7 +306,7 @@
       <zipfileset dir="${basedir}/jars/insane" prefix="${derby.lib}/lib" includes="derby*.*"
 	              excludes="derby_core_plugin*,derbyTesting.jar"/>
       <zipfileset dir="${basedir}/jars/insane" prefix="${derby.lib}/test" includes="derbyTesting.jar"/>
-      <zipfileset dir="${basedir}/java/testing" prefix="${derby.lib}/test" 
+      <zipfileset dir="${basedir}/java/${module.name.tests}" prefix="${derby.lib}/test" 
                   includes="README.htm"/>
     </zip>
   </target>
@@ -318,7 +318,7 @@
       <tarfileset dir="${basedir}/jars/insane" prefix="${derby.lib}/lib" includes="derby*.*"
 	              excludes="derby_core_plugin*,derbyTesting.jar"/>
       <tarfileset dir="${basedir}/jars/insane" prefix="${derby.lib}/test" includes="derbyTesting.jar"/>
-      <tarfileset dir="${basedir}/java/testing" prefix="${derby.lib}/test" 
+      <tarfileset dir="${basedir}/java/${module.name.tests}" prefix="${derby.lib}/test" 
                   includes="README.htm"/>
     </tar>
   </target>
@@ -333,7 +333,7 @@
       <zipfileset dir="${basedir}/jars/sane" prefix="${derby.lib-debug}/lib" includes="derby*.*"
 	              excludes="derby_core_plugin*,derbyTesting.jar"/>
       <zipfileset dir="${basedir}/jars/sane" prefix="${derby.lib-debug}/test" includes="derbyTesting.jar"/>
-      <zipfileset dir="${basedir}/java/testing" prefix="${derby.lib-debug}/test" 
+      <zipfileset dir="${basedir}/java/${module.name.tests}" prefix="${derby.lib-debug}/test" 
                   includes="README.htm"/>
     </zip>
   </target>
@@ -345,7 +345,7 @@
       <tarfileset dir="${basedir}/jars/sane" prefix="${derby.lib-debug}/lib" includes="derby*.*"
 	              excludes="derby_core_plugin*,derbyTesting.jar"/>
       <tarfileset dir="${basedir}/jars/sane" prefix="${derby.lib-debug}/test" includes="derbyTesting.jar"/>
-      <tarfileset dir="${basedir}/java/testing" prefix="${derby.lib-debug}/test" 
+      <tarfileset dir="${basedir}/java/${module.name.tests}" prefix="${derby.lib-debug}/test" 
                   includes="README.htm"/>
     </tar>
   </target>
@@ -491,7 +491,7 @@
       <entry key="maint" type="int" operation="+" value="1" pattern="0000000"/>
     </propertyfile>
     <java classname="org.apache.derbyBuild.maintversion2props">
-      <classpath path="${out.dir}"/>
+      <classpath path="${out.build.dir}"/>
       <arg value="${basedir}/tools/ant/properties/release.properties"/>
       <arg value="${basedir}/tools/release/maintversion.properties"/>
     </java>
