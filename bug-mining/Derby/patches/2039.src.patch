diff --git a/java/drda/org/apache/derby/drda/server.policy b/java/drda/org/apache/derby/drda/server.policy
index 4bbf7e9a8..710a974e3 100644
--- a/java/drda/org/apache/derby/drda/server.policy
+++ b/java/drda/org/apache/derby/drda/server.policy
@@ -89,6 +89,9 @@ grant codeBase "${derby.install.url}derby.jar"
   permission org.apache.derby.security.SystemPermission "engine", "monitor";
   permission org.apache.derby.security.SystemPermission "server", "monitor";
 
+  // getProtectionDomain is an optional permission needed for printing classpath
+  // information to derby.log
+  permission java.lang.RuntimePermission "getProtectionDomain";
 };
 
 grant codeBase "${derby.install.url}derbynet.jar"
diff --git a/java/drda/org/apache/derby/drda/template.policy b/java/drda/org/apache/derby/drda/template.policy
index d079f68c4..7074c59ee 100644
--- a/java/drda/org/apache/derby/drda/template.policy
+++ b/java/drda/org/apache/derby/drda/template.policy
@@ -76,6 +76,10 @@ grant codeBase "${derby.install.url}derby.jar"
 //
   permission javax.management.MBeanTrustPermission "register";
 
+  // getProtectionDomain is an optional permission needed for printing classpath
+  // information to derby.log
+  permission java.lang.RuntimePermission "getProtectionDomain";
+
 };
 
 grant codeBase "${derby.install.url}derbynet.jar"
diff --git a/java/engine/org/apache/derby/impl/store/raw/data/BaseDataFileFactory.java b/java/engine/org/apache/derby/impl/store/raw/data/BaseDataFileFactory.java
index ee23ed156..21ec95d99 100644
--- a/java/engine/org/apache/derby/impl/store/raw/data/BaseDataFileFactory.java
+++ b/java/engine/org/apache/derby/impl/store/raw/data/BaseDataFileFactory.java
@@ -91,8 +91,13 @@ import java.util.Enumeration;
 
 import java.io.File;
 import java.io.IOException;
+import java.io.UnsupportedEncodingException;
+
+import java.net.URL;
+import java.net.URLDecoder;
 
 import java.security.AccessController;
+import java.security.CodeSource;
 import java.security.PrivilegedAction;
 import java.security.PrivilegedExceptionAction;
 import java.security.PrivilegedActionException;
@@ -137,6 +142,10 @@ public class BaseDataFileFactory
 	private     LogFactory	    logFactory;
 
 	private     ProductVersionHolder jbmsVersion;
+	
+	private     String          jvmVersion;
+	
+	private     String          jarCPath;
 
 	private     RawStoreFactory	rawStoreFactory; // associated raw store factory
 
@@ -261,6 +270,10 @@ public class BaseDataFileFactory
     {
 
 		jbmsVersion = Monitor.getMonitor().getEngineVersion();
+		
+		jvmVersion = buildJvmVersion();
+		
+		jarCPath = jarClassPath(getClass());
 
 		dataDirectory = startParams.getProperty(PersistentService.ROOT);
 
@@ -360,9 +373,10 @@ public class BaseDataFileFactory
 			   MessageService.getTextMessage(MessageId.STORE_BOOT_MSG,
                                              jbmsVersion,
                                              identifier,
-                                             dataDirectory + " " + readOnlyMsg,
                                              // cast to Object so we get object hash code
-                                             (Object) this.getClass().getClassLoader()
+                                             (Object) this.getClass().getClassLoader(),
+                                             dataDirectory + " " + readOnlyMsg 
+                                             +"\nLoaded from " + jarCPath + "\n" +jvmVersion
                                              ));
 
         if (logBootTrace)
@@ -2144,8 +2158,70 @@ public class BaseDataFileFactory
         containerEncrypter.removeOldVersionOfContainers(inRecovery);
         containerEncrypter = null;
     }
-
-
+ 
+    
+    /**
+     * Return a jar file by asking the class's 
+     * class loader for the location where the class was loaded from. 
+     * If no value, it returns null
+     * @param cls the Class to ask to print the class name of an object
+     *
+     * @return the ClassPath of a jar file
+     **/
+    private static String jarClassPath(final Class cls)
+    {
+        return (String)AccessController.doPrivileged( new PrivilegedAction()
+        {
+          public Object run()
+          {
+              CodeSource cs = null;
+              try {
+                  cs = cls.getProtectionDomain().getCodeSource();
+              }
+              catch (SecurityException se) {
+                  return se.getMessage();
+              }
+  
+              if ( cs == null )
+                  return null;        
+      
+              URL result = cs.getLocation ();
+      
+              return result.toString();
+          }
+        });
+    }
+    
+    
+    /**
+     * Return values of system properties that identify the JVM. 
+     * Will catch SecurityExceptions and note them for displaying information.
+     * @return the Java system property value from the JVM or a string capturing a
+     * security exception.
+     */
+    private static String buildJvmVersion () {
+        return (String)AccessController.doPrivileged( new PrivilegedAction()
+        {
+           public Object run()
+           {      
+             String jvmversion = "";
+             try {
+                 String currentProp  = PropertyUtil.getSystemProperty("java.vendor");
+                 if ( currentProp != null)
+                     jvmversion = "java.vendor=" + currentProp;
+                 if ((currentProp = PropertyUtil.getSystemProperty("java.runtime.version")) != null)
+                     jvmversion += "\njava.runtime.version=" + currentProp;
+                 if ((currentProp = PropertyUtil.getSystemProperty("java.fullversion")) != null)
+                     jvmversion += "\njava.fullversion=" + currentProp ;         
+              }
+              catch (SecurityException se) {
+                   return se.getMessage();
+              }
+              return jvmversion;
+            }
+        });
+    } // end of buildjvmVersion
+        
 	/**
 		Returns the encryption block size used by the algorithm at time of
 		creation of an encrypted database
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/GetCurrentPropertiesTest.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/GetCurrentPropertiesTest.policy
index e24bce8e4..78649866e 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/GetCurrentPropertiesTest.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/GetCurrentPropertiesTest.policy
@@ -59,6 +59,10 @@ grant codeBase "${derbyTesting.codejar}derby.jar" {
   permission java.lang.RuntimePermission "createClassLoader";
   permission java.security.SecurityPermission "getPolicy";
   
+  // getProtectionDomain is an optional permission needed for printing classpath
+  // information to derby.log
+  permission java.lang.RuntimePermission "getProtectionDomain";
+
   permission java.io.FilePermission "${derby.system.home}${/}derby.properties", "read";
   permission java.io.FilePermission "${derby.system.home}${/}derby.log", "read, write, delete";
   // [DERBY-2000] The write permission was added to allow creation of the
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NetworkServerControlApiTest.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NetworkServerControlApiTest.policy
index 6ba703df1..6a747ce94 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NetworkServerControlApiTest.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NetworkServerControlApiTest.policy
@@ -59,6 +59,10 @@ grant codeBase "${derbyTesting.codejar}derby.jar" {
   permission java.lang.RuntimePermission "createClassLoader";
   permission java.security.SecurityPermission "getPolicy";
   
+  // getProtectionDomain is an optional permission needed for printing classpath
+  // information to derby.log
+  permission java.lang.RuntimePermission "getProtectionDomain";
+
   permission java.io.FilePermission "${derby.system.home}${/}derby.properties", "read";
   permission java.io.FilePermission "${derby.system.home}${/}derby.log", "read, write, delete";
   // [DERBY-2000] The write permission was added to allow creation of the
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/RuntimeInfoTest.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/RuntimeInfoTest.policy
index 1e2497ec0..5d4113215 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/RuntimeInfoTest.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/RuntimeInfoTest.policy
@@ -62,6 +62,10 @@ permission java.util.PropertyPermission "derby.storage.jvmInstanceId",
 
   permission java.lang.RuntimePermission "createClassLoader";
 
+  // getProtectionDomain is an optional permission needed for printing classpath
+  // information to derby.log
+  permission java.lang.RuntimePermission "getProtectionDomain";
+
   // permissions so that we can set the context class loader to
   // null for daemon threads to avoid class loader leak.
   // DERBY-3745
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/ServerPropertiesTest.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/ServerPropertiesTest.policy
index ae6d88277..b47531fa8 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/ServerPropertiesTest.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/ServerPropertiesTest.policy
@@ -58,6 +58,10 @@ grant codeBase "${derbyTesting.codejar}derby.jar" {
 
   permission java.lang.RuntimePermission "createClassLoader";
   permission java.security.SecurityPermission "getPolicy";
+
+  // getProectionDomain is an optional permission needed for printing classpath
+  // information to derby.log
+  permission java.lang.RuntimePermission "getProtectionDomain";
   
   permission java.io.FilePermission "${derby.system.home}${/}derby.properties", "read";
   permission java.io.FilePermission "${derby.system.home}${/}derby.log", "read, write, delete";
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/SysinfoTest.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/SysinfoTest.policy
index 9ff74ee31..4a0389851 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/SysinfoTest.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/SysinfoTest.policy
@@ -61,6 +61,10 @@ grant codeBase "${derbyTesting.codejar}derby.jar" {
 
   permission java.lang.RuntimePermission "createClassLoader";
 
+  // getProtectionDomain is an optional permission needed for printing classpath
+  // information to derby.log
+  permission java.lang.RuntimePermission "getProtectionDomain";
+
   // permissions so that we can set the context class loader to
   // null for daemon threads to avoid class loader leak.
   // DERBY-3745
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/LDAPTests.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/LDAPTests.policy
index 3ed6c4e20..f16024d48 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/LDAPTests.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/LDAPTests.policy
@@ -49,7 +49,7 @@
 //
 grant codeBase "${derbyTesting.codejar}derby.jar" {
   permission java.util.PropertyPermission "derby.*", "read";
-permission java.util.PropertyPermission "derby.storage.jvmInstanceId", 
+  permission java.util.PropertyPermission "derby.storage.jvmInstanceId", 
       "write"; 
   permission java.util.PropertyPermission "java.class.path", "read";//sysinfo
   permission java.util.PropertyPermission "java.runtime.version", "read";//sysinfo
@@ -62,6 +62,10 @@ permission java.util.PropertyPermission "derby.storage.jvmInstanceId",
   permission java.lang.RuntimePermission "createClassLoader";
   permission java.security.SecurityPermission "getPolicy";
   
+  // getProtectionDomain is an optional permission needed for printing classpath 
+  // information to derby.log
+  permission java.lang.RuntimePermission "getProtectionDomain";
+  
   permission java.io.FilePermission "${derby.system.home}${/}derby.properties", "read";
   permission java.io.FilePermission "${derby.system.home}${/}derby.log", "read, write, delete";
   // [DERBY-2000] The write permission was added to allow creation of the
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.initial.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.initial.policy
index afc99c576..25ab67ab9 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.initial.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.initial.policy
@@ -30,6 +30,9 @@ grant codeBase "${derbyTesting.codejar}derby.jar"
   permission java.io.FilePermission "${derby.system.home}","read";
   permission java.io.FilePermission "${derby.system.home}${/}-", "read,write,delete";
 
+// getProtectionDomain is an optional permission needed for printing classpath information
+// to derby.log
+  permission java.lang.RuntimePermission "getProtectionDomain";
 //
 // This permission lets a DBA reload this policy file while the server
 // is still running.
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.modified.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.modified.policy
index 99e13daba..ed144d12e 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.modified.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.modified.policy
@@ -30,6 +30,9 @@ grant codeBase "${derbyTesting.codejar}derby.jar"
   permission java.io.FilePermission "${derby.system.home}","read";
   permission java.io.FilePermission "${derby.system.home}${/}-", "read,write,delete";
 
+// getProtectionDomain is an optional permission needed for printing classpath
+// information to derby.log
+  permission java.lang.RuntimePermission "getProtectionDomain";
 //
 // This permission lets a DBA reload this policy file while the server
 // is still running.
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.unreloadable.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.unreloadable.policy
index aec38d4b7..e60cc59ba 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.unreloadable.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.unreloadable.policy
@@ -58,6 +58,10 @@ permission java.util.PropertyPermission "derby.storage.jvmInstanceId",
 
   permission java.lang.RuntimePermission "createClassLoader";
 
+  // getProtectionDomain is an optional permission needed for printing classpath 
+  // information to derby.log
+  permission java.lang.RuntimePermission "getProtectionDomain";
+
   //
   // This permission deliberately omitted.
   //
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/unit/fillLog.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/unit/fillLog.policy
index 300e19ee5..974ef423e 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/unit/fillLog.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/unit/fillLog.policy
@@ -1,5 +1,5 @@
 //
-// *  Derby - Class org.apache.derbyTesting.functionTests.tests.lang.SimpleTest
+// *  Derby - Class org.apache.derbyTesting.functionTests.tests.unit.fillLog.policy
 // *  
 // * Licensed to the Apache Software Foundation (ASF) under one
 // * or more contributor license agreements.  See the NOTICE file
diff --git a/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy b/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
index a16fdd33e..934fa26af 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
@@ -47,7 +47,7 @@
 //
 grant codeBase "${derbyTesting.codejar}derby.jar" {
   permission java.util.PropertyPermission "derby.*", "read";
-permission java.util.PropertyPermission "derby.storage.jvmInstanceId", 
+  permission java.util.PropertyPermission "derby.storage.jvmInstanceId", 
       "write"; 
   // The next two properties are used to determine if the VM is 32 or 64 bit.
   permission java.util.PropertyPermission "sun.arch.data.model", "read";
@@ -62,6 +62,10 @@ permission java.util.PropertyPermission "derby.storage.jvmInstanceId",
 
   permission java.lang.RuntimePermission "createClassLoader";
 
+  // getProtectionDomain is an optional permission needed for printing classpath
+  // information to derby.log
+  permission java.lang.RuntimePermission "getProtectionDomain";
+
   // permissions so that we can set the context class loader to
   // null for daemon threads to avoid class loader leak.
   // DERBY-3745
diff --git a/java/testing/org/apache/derbyTesting/functionTests/util/nwsvr.policy b/java/testing/org/apache/derbyTesting/functionTests/util/nwsvr.policy
index 2ad7f320f..4bb5f5f3d 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/util/nwsvr.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/util/nwsvr.policy
@@ -32,6 +32,10 @@ permission java.util.PropertyPermission "derby.storage.jvmInstanceId",
 
 permission java.lang.RuntimePermission "createClassLoader";
 
+// getProectionDomain is an optional permission needed to printing classpath 
+// information to derby.log
+permission java.lang.RuntimePermission "getProtectionDomain";
+
 // These permissions are needed to load the JCE for encryption with JDK131.
 // JDK14 has the JCE  preloaded
 permission java.security.SecurityPermission "createAccessControlContext";
diff --git a/java/testing/org/apache/derbyTesting/unitTests/junit/AssertFailureTest.policy b/java/testing/org/apache/derbyTesting/unitTests/junit/AssertFailureTest.policy
index 1710e1519..406b006f5 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/junit/AssertFailureTest.policy
+++ b/java/testing/org/apache/derbyTesting/unitTests/junit/AssertFailureTest.policy
@@ -97,6 +97,10 @@ grant codeBase "${derbyTesting.codejar}derby.jar" {
   permission java.lang.RuntimePermission "getStackTrace";
   permission java.lang.RuntimePermission "modifyThreadGroup";
 //-----------------------------------------------------------------------------
+
+// getProtectionDomain is an optional permission needed for printing classpath 
+// information to derby.log
+  permission java.lang.RuntimePermission "getProtectionDomain";
 };
 
 
diff --git a/java/testing/org/apache/derbyTesting/unitTests/junit/SystemPrivilegesPermissionTest.policy b/java/testing/org/apache/derbyTesting/unitTests/junit/SystemPrivilegesPermissionTest.policy
index 8b2de6b5f..4f8e3df2e 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/junit/SystemPrivilegesPermissionTest.policy
+++ b/java/testing/org/apache/derbyTesting/unitTests/junit/SystemPrivilegesPermissionTest.policy
@@ -99,6 +99,10 @@ grant codeBase "${derbyTesting.codejar}derby.jar" {
   // Because this unit test involves some relative and absolute sample paths,
   // we liberally grant read access to all files.
   permission java.io.FilePermission "<<ALL FILES>>", "read";
+  
+  // getProtectionDomain is an optional permission needed for printing classpath 
+  // information to derby.log
+  permission java.lang.RuntimePermission "getProtectionDomain";
 };
 
 //
diff --git a/java/testing/org/apache/derbyTesting/unitTests/junit/SystemPrivilegesPermissionTest1.policy b/java/testing/org/apache/derbyTesting/unitTests/junit/SystemPrivilegesPermissionTest1.policy
index 1ed33fa2e..c662909dc 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/junit/SystemPrivilegesPermissionTest1.policy
+++ b/java/testing/org/apache/derbyTesting/unitTests/junit/SystemPrivilegesPermissionTest1.policy
@@ -79,6 +79,10 @@ grant codeBase "${derbyTesting.codejar}derby.jar" {
   // Because this unit test involves some relative and absolute sample paths,
   // we liberally grant read access to all files.
   permission java.io.FilePermission "<<ALL FILES>>", "read";
+
+  // getProtectionDomain is an optional permission needed for printing classpath 
+  // information to derby.log
+  permission java.lang.RuntimePermission "getProtectionDomain";
 };
 
 //
