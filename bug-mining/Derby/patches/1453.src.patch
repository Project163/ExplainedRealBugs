diff --git a/java/client/org/apache/derby/client/am/Blob.java b/java/client/org/apache/derby/client/am/Blob.java
index 227d1b9aa..d3f1ef44f 100644
--- a/java/client/org/apache/derby/client/am/Blob.java
+++ b/java/client/org/apache/derby/client/am/Blob.java
@@ -30,9 +30,7 @@ import org.apache.derby.shared.common.reference.SQLState;
 
 public class Blob extends Lob implements java.sql.Blob {
     
-    //This boolean variable indicates whether the Blob object has
-    //been invalidated by calling free() on it
-    private boolean isValid = true;
+    
     
     //-----------------------------state------------------------------------------
 
@@ -608,11 +606,12 @@ public class Blob extends Lob implements java.sql.Blob {
         throws SQLException {
         
         //calling free() on a already freed object is treated as a no-op
-        if (!isValid) return;
+        if (!isValid_) return;
         
         //now that free has been called the Blob object is no longer
         //valid
-        isValid = false;
+        
+        isValid_ = false;
         try {            
             synchronized (agent_.connection_) {
                 if (agent_.loggingEnabled()) {
@@ -736,18 +735,7 @@ public class Blob extends Lob implements java.sql.Blob {
         return true;
     }
     
-    /**
-     * Checks is isValid is true. If it is not true throws 
-     * a SQLException stating that a method has been called on
-     * an invalid LOB object
-     *
-     * @throws SQLException if isValid is not true
-     */
-    private void checkValidity() throws SQLException{
-        if(!isValid)
-            throw new SqlException(null,new ClientMessageId(SQLState.LOB_OBJECT_INVALID))
-                                                  .getSQLException();
-    }
+    
     
 
     /**
diff --git a/java/client/org/apache/derby/client/am/Clob.java b/java/client/org/apache/derby/client/am/Clob.java
index a6467b89a..480b9a9cd 100644
--- a/java/client/org/apache/derby/client/am/Clob.java
+++ b/java/client/org/apache/derby/client/am/Clob.java
@@ -48,16 +48,17 @@ public class Clob extends Lob implements java.sql.Clob {
 
     protected String encoding_ = "UNICODE";
 
-    //This boolean variable indicates whether the Clob object has
-    //been invalidated by calling free() on it
-    private boolean isValid = true;
+ 
 
+    
+    
     //---------------------constructors/finalizer---------------------------------
     public Clob(Agent agent, String string) {
 
         this(agent,
              false);
 
+                
         string_ = string;
         setSqlLength(string_.length());
         dataType_ |= STRING;
@@ -240,6 +241,7 @@ public class Clob extends Lob implements java.sql.Clob {
         }
     }
 
+    
   /**
    * Returns a copy of the specified substring
    * in the <code>CLOB</code> value
@@ -816,11 +818,11 @@ public class Clob extends Lob implements java.sql.Clob {
         throws SQLException {
 
         //calling free() on a already freed object is treated as a no-op
-        if (!isValid) return;
+        if (!isValid_) return;
 
         //now that free has been called the Blob object is no longer
         //valid
-        isValid = false;
+        isValid_ = false;
 
         try {
             synchronized (agent_.connection_) {
@@ -1021,18 +1023,7 @@ public class Clob extends Lob implements java.sql.Clob {
     }
 
 
-    /*
-     * Checks is isValid is true. If it is not true throws
-     * a SQLException stating that a method has been called on
-     * an invalid LOB object
-     *
-     * throws SQLException if isvalid is not true.
-     */
-    private void checkValidity() throws SQLException{
-        if(!isValid)
-            throw new SqlException(null,new ClientMessageId(SQLState.LOB_OBJECT_INVALID))
-                                                  .getSQLException();
-    }
+
 
     /**
      * Materialize the stream used for input to the database.
diff --git a/java/client/org/apache/derby/client/am/Connection.java b/java/client/org/apache/derby/client/am/Connection.java
index 20ffcb9fb..65f273caa 100644
--- a/java/client/org/apache/derby/client/am/Connection.java
+++ b/java/client/org/apache/derby/client/am/Connection.java
@@ -117,6 +117,8 @@ public abstract class Connection implements java.sql.Connection,
     private boolean accumulated440ForMessageProcFailure_ = false;
     private boolean accumulated444ForMessageProcFailure_ = false;
 
+    private int transactionID_ = 0;
+    
     //---------------------XA-----------------------------------------------------
 
     protected boolean isXAConnection_ = false; // Indicates an XA connection
@@ -559,7 +561,7 @@ public abstract class Connection implements java.sql.Connection,
             // internal code will call commitX which will ignore the commit request
             // while in a Global transaction
             checkForInvalidXAStateOnCommitOrRollback();
-            flowCommit();
+            flowCommit();            
         }
         catch ( SqlException se )
         {
@@ -1103,6 +1105,14 @@ public abstract class Connection implements java.sql.Connection,
         }
     }
   
+    /**
+     * Returns the ID of the active transaction for this connection.
+     * @return the ID of the active transaction
+     */
+    public int getTransactionID(){
+    	return transactionID_;
+    }
+    
     /**
      * Returns the current schema (the schema that would be used for
      * compilation. This is not part of the java.sql.Connection interface, and
@@ -1973,6 +1983,7 @@ public abstract class Connection implements java.sql.Connection,
             listener.completeLocalCommit(i);
         }
         inUnitOfWork_ = false;
+        transactionID_++;
     }
 
     public abstract void writeLocalRollback_() throws SqlException;
@@ -1989,6 +2000,7 @@ public abstract class Connection implements java.sql.Connection,
             listener.completeLocalRollback(i);
         }
         inUnitOfWork_ = false;
+        transactionID_++;
     }
     
     /**
diff --git a/java/client/org/apache/derby/client/am/Lob.java b/java/client/org/apache/derby/client/am/Lob.java
index f01adabfd..d334ecb5b 100644
--- a/java/client/org/apache/derby/client/am/Lob.java
+++ b/java/client/org/apache/derby/client/am/Lob.java
@@ -53,6 +53,12 @@ public abstract class Lob implements UnitOfWorkListener {
     private long sqlLength_;// length of the LOB value, as defined by the server
     private boolean lengthObtained_;
     
+    /**
+     * This boolean variable indicates whether the Lob object has been
+     * invalidated by calling free() on it
+     */
+    protected boolean isValid_ = true;
+    
     final private boolean willBeLayerBStreamed_;
     
         
@@ -66,6 +72,11 @@ public abstract class Lob implements UnitOfWorkListener {
     //limit imposed.
     private long updateCount;
 
+    /**
+     * This integer identifies which transaction the Lob is associated with
+     */
+    private int transactionID_;
+    
     //-----------------------------messageId------------------------------------------
     final static protected ClientMessageId LOB_OBJECT_LENGTH_UNKNOWN_YET =
         new ClientMessageId( SQLState.LOB_OBJECT_LENGTH_UNKNOWN_YET );
@@ -77,6 +88,7 @@ public abstract class Lob implements UnitOfWorkListener {
         agent_ = agent;
         lengthObtained_ = false;
         willBeLayerBStreamed_ = willBeLayerBStreamed;
+        transactionID_ = agent_.connection_.getTransactionID();
     }
 
     protected void finalize() throws java.lang.Throwable {
@@ -98,7 +110,7 @@ public abstract class Lob implements UnitOfWorkListener {
      */
     long sqlLength() throws SqlException 
     {
-        if (lengthObtained_) return sqlLength_;
+    	if (lengthObtained_) return sqlLength_;
         
         if (isLocator()) {
             sqlLength_ = getLocatorLength();
@@ -373,4 +385,28 @@ public abstract class Lob implements UnitOfWorkListener {
         //valid
         sqlLength();
     }
+    
+    /**
+     * Checks is isValid is true and whether the transaction that
+     * created the Lob is still active. If any of which is not true throws 
+     * a SQLException stating that a method has been called on
+     * an invalid LOB object
+     *
+     * @throws SQLException if isValid is not true
+     */
+    protected void checkValidity() throws SQLException{
+    	
+    	/**
+    	 * If there isn't an open connection, the Lob is invalid.
+    	 */
+    	try{
+    		agent_.connection_.checkForClosedConnection();
+    	}catch(SqlException se){
+    		throw se.getSQLException();
+    	}
+    	
+        if(!isValid_ || transactionID_ != agent_.connection_.getTransactionID())
+            throw new SqlException(null,new ClientMessageId(SQLState.LOB_OBJECT_INVALID))
+                                                  .getSQLException();
+    }
 }
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/BlobClob4BlobTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/BlobClob4BlobTest.java
index 7b8982174..03ed76cb4 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/BlobClob4BlobTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/BlobClob4BlobTest.java
@@ -1359,6 +1359,14 @@ public class BlobClob4BlobTest extends BaseJDBCTestCase {
             if (clobLength == 26)
                 shortClob = rs.getClob(1);
         }
+        
+        /**
+         * We call it before the commit(); to cache the result
+         * DERBY-3574
+         */
+        clob.length();
+        shortClob.length();
+        
         rs.close();
         stmt.close();
         commit();
