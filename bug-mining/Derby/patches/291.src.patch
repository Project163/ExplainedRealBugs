diff --git a/java/engine/org/apache/derby/impl/store/raw/RawStore.java b/java/engine/org/apache/derby/impl/store/raw/RawStore.java
index 1be90ad0f..994c46ee0 100644
--- a/java/engine/org/apache/derby/impl/store/raw/RawStore.java
+++ b/java/engine/org/apache/derby/impl/store/raw/RawStore.java
@@ -83,6 +83,8 @@ import java.net.MalformedURLException;
 import java.net.URL;
 
 import java.security.PrivilegedExceptionAction;
+import java.lang.SecurityException;
+
 
 /**
 	A Raw store that implements the RawStoreFactory module by delegating all the
@@ -1546,7 +1548,14 @@ public final class RawStore implements RawStoreFactory, ModuleControl, ModuleSup
         {
             return (String) AccessController.doPrivileged( this);
         }
-        catch( PrivilegedActionException pae) { return null;} // does not throw an exception
+        catch( PrivilegedActionException pae) { 
+            return null;
+        } // does not throw an exception
+        catch(SecurityException se) {
+            // there are no permission to get canonical path 
+            // just return null.
+            return null;
+        }
         finally
         {
             actionStorageFile = null;
@@ -1563,7 +1572,14 @@ public final class RawStore implements RawStoreFactory, ModuleControl, ModuleSup
         {
             return (String) AccessController.doPrivileged( this);
         }
-        catch( PrivilegedActionException pae) { return null;} // does not throw an exception
+        catch( PrivilegedActionException pae) { 
+            return null;
+        } // does not throw an exception
+        catch(SecurityException se) { 
+            // there are no permission to get canonical path 
+            // just return null.
+            return null;
+        }
         finally
         {
             actionRegularFile = null;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/store/encryptionKey_app.properties b/java/testing/org/apache/derbyTesting/functionTests/tests/store/encryptionKey_app.properties
index 05d219a3b..1e52324ce 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/store/encryptionKey_app.properties
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/store/encryptionKey_app.properties
@@ -6,5 +6,4 @@ derby.optimizer.noTimeout=true
 ij.showNoConnectionsAtStart=true
 ij.showNoCountForSelect=true
 runwithjdk13=false
-
-
+useextdirs=true
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/store/logDevice_app.properties b/java/testing/org/apache/derbyTesting/functionTests/tests/store/logDevice_app.properties
index 1e9a5cb8f..34b967012 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/store/logDevice_app.properties
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/store/logDevice_app.properties
@@ -20,4 +20,6 @@ ij.dataSource.databaseName=wombat
 ij.dataSource.createDatabase=create
 ij.dataSource.connectionAttributes=logDevice=extinout/wierdlog
 
+# Test fails with security manager due to bug DEBRY-1066
+noSecurityManager=true
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/store/rollForwardBackup_app.properties b/java/testing/org/apache/derbyTesting/functionTests/tests/store/rollForwardBackup_app.properties
index 2e0c3001c..b22c3701b 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/store/rollForwardBackup_app.properties
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/store/rollForwardBackup_app.properties
@@ -12,3 +12,5 @@
 
 useextdirs=true
 usedefaults=true
+# Test fails with security manager due to bug DEBRY-1066
+noSecurityManager=true
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/storetests/st_1_app.properties b/java/testing/org/apache/derbyTesting/functionTests/tests/storetests/st_1_app.properties
index 876c027e0..d1c3432a3 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/storetests/st_1_app.properties
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/storetests/st_1_app.properties
@@ -1,3 +1,3 @@
 usedefaults=true
-
+useextdirs=true
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy b/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
index 53b86b358..f71abc49c 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
@@ -39,7 +39,7 @@ grant codeBase "${derbyTesting.codejar}derby.jar" {
 
   // Import/export and other support files from these locations in tests
   permission java.io.FilePermission "${user.dir}${/}extin${/}-", "read";
-  permission java.io.FilePermission "${user.dir}${/}extinout${/}-", "read, write";
+  permission java.io.FilePermission "${user.dir}${/}extinout${/}-", "read,  write, delete";
   permission java.io.FilePermission "${user.dir}${/}extout${/}-", "write";
   permission java.io.FilePermission "${user.dir}${/}extinout", "read,write";
   
