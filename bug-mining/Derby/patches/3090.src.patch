diff --git a/java/engine/org/apache/derby/impl/store/raw/data/BaseDataFileFactory.java b/java/engine/org/apache/derby/impl/store/raw/data/BaseDataFileFactory.java
index 4171a26d6..cfc3d0958 100644
--- a/java/engine/org/apache/derby/impl/store/raw/data/BaseDataFileFactory.java
+++ b/java/engine/org/apache/derby/impl/store/raw/data/BaseDataFileFactory.java
@@ -23,7 +23,7 @@ package org.apache.derby.impl.store.raw.data;
 
 
 import org.apache.derby.iapi.reference.MessageId;
-
+import org.apache.derby.iapi.security.SecurityUtil;
 import org.apache.derby.iapi.services.info.ProductVersionHolder;
 
 import org.apache.derby.database.Database;
@@ -232,6 +232,8 @@ public class BaseDataFileFactory
 
 	public BaseDataFileFactory() 
     {
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
 	}
 
 	/*
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/NoDBInternalsPermissionTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/NoDBInternalsPermissionTest.java
index 2c81e425c..319d86ac0 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/NoDBInternalsPermissionTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/NoDBInternalsPermissionTest.java
@@ -34,6 +34,7 @@ import org.apache.derbyTesting.junit.TestConfiguration;
 import org.apache.derby.iapi.services.context.ContextService;
 import org.apache.derby.impl.jdbc.EmbedConnection;
 import org.apache.derby.impl.services.jce.JCECipherFactoryBuilder;
+import org.apache.derby.impl.store.raw.data.BaseDataFileFactory;
 
 /**
  * <p>
@@ -158,4 +159,20 @@ public class NoDBInternalsPermissionTest extends GeneratedColumnsHelper
         }
         catch (AccessControlException e) { println( "Caught an AccessControlException" ); }
     }
+
+    /**
+     * <p>
+     * Verify that you need usederbyinternals permission to boot a BaseDataFileFactory.
+     * See DERBY-6636.
+     * </p>
+     */
+    public  void    test_004_BasDataFileFactory()
+        throws Exception
+    {
+        try {
+            BaseDataFileFactory bdff = new BaseDataFileFactory();
+            fail( "Should have raised an AccessControlException" );
+        }
+        catch (AccessControlException e) { println( "Caught an AccessControlException" ); }
+    }
 }
