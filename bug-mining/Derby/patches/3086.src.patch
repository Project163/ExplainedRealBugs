diff --git a/java/drda/org/apache/derby/drda/server.policy b/java/drda/org/apache/derby/drda/server.policy
index 2b7683dc9..30c321cb5 100644
--- a/java/drda/org/apache/derby/drda/server.policy
+++ b/java/drda/org/apache/derby/drda/server.policy
@@ -141,6 +141,7 @@ grant codeBase "${derby.install.url}derbynet.jar"
   //
   permission org.apache.derby.security.SystemPermission "server",
       "control,monitor";
+  permission org.apache.derby.security.SystemPermission "engine", "usederbyinternals";
 
   // Needed by sysinfo. The file permission is needed to check the existence of
   // jars on the classpath. You can limit this permission to just the locations
diff --git a/java/drda/org/apache/derby/drda/template.policy b/java/drda/org/apache/derby/drda/template.policy
index 3b82e0120..633156421 100644
--- a/java/drda/org/apache/derby/drda/template.policy
+++ b/java/drda/org/apache/derby/drda/template.policy
@@ -131,6 +131,9 @@ grant codeBase "${derby.install.url}derbynet.jar"
   permission java.util.PropertyPermission "derby.__serverStartedFromCmdLine",
       "read, write";
 
+  // Needed to start the monitoring MBeans
+  permission org.apache.derby.security.SystemPermission "engine", "usederbyinternals";
+
   // JMX: Uncomment this permission to allow the ping operation of the
   //      NetworkServerMBean to connect to the Network Server.
   //
diff --git a/java/drda/org/apache/derby/impl/drda/DRDAConnThread.java b/java/drda/org/apache/derby/impl/drda/DRDAConnThread.java
index e458680e7..f1002056a 100644
--- a/java/drda/org/apache/derby/impl/drda/DRDAConnThread.java
+++ b/java/drda/org/apache/derby/impl/drda/DRDAConnThread.java
@@ -29,6 +29,8 @@ import java.io.ObjectInputStream;
 import java.io.OutputStream;
 import java.io.UnsupportedEncodingException;
 import java.math.BigDecimal;
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.sql.CallableStatement;
 import java.sql.Connection;
 import java.sql.DataTruncation;
@@ -60,6 +62,7 @@ import org.apache.derby.iapi.reference.DRDAConstants;
 import org.apache.derby.iapi.reference.Property;
 import org.apache.derby.iapi.reference.SQLState;
 import org.apache.derby.iapi.services.info.JVMInfo;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.shared.common.sanity.SanityManager;
 import org.apache.derby.iapi.services.stream.HeaderPrintWriter;
@@ -9286,9 +9289,9 @@ class DRDAConnThread extends Thread {
             // 
             // if monitor is never setup by any ModuleControl, getMonitor
             // returns null and no Derby database has been booted. 
-            if (Monitor.getMonitor() != null) {
+            if (getMonitor() != null) {
                 databaseObj = (org.apache.derby.iapi.db.Database)
-                    Monitor.findService(Property.DATABASE_MODULE, dbName);
+                    findService(Property.DATABASE_MODULE, dbName);
             }
 
             if (databaseObj == null)
@@ -9298,7 +9301,7 @@ class DRDAConnThread extends Thread {
 
                 // now try to find it again
                 databaseObj = (org.apache.derby.iapi.db.Database)
-                    Monitor.findService(Property.DATABASE_MODULE, dbName);
+                    findService(Property.DATABASE_MODULE, dbName);
             }
 
             // If database still could not be found, it means the database
@@ -9502,4 +9505,41 @@ class DRDAConnThread extends Thread {
             }
         }
     }
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged service lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object findService( final String factoryInterface, final String serviceName )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.findService( factoryInterface, serviceName );
+                 }
+             }
+             );
+    }
+    
 }
diff --git a/java/drda/org/apache/derby/impl/drda/NetworkServerControlImpl.java b/java/drda/org/apache/derby/impl/drda/NetworkServerControlImpl.java
index 88ab3eb5e..d34d83ca4 100644
--- a/java/drda/org/apache/derby/impl/drda/NetworkServerControlImpl.java
+++ b/java/drda/org/apache/derby/impl/drda/NetworkServerControlImpl.java
@@ -821,7 +821,7 @@ public final class NetworkServerControlImpl {
         // This way we know that once we can connect to the network server,
         // the MBeans will be available.
         ManagementService mgmtService = ((ManagementService)
-                Monitor.getSystemModule(Module.JMX));
+                getSystemModule(Module.JMX));
 
         final Object versionMBean = mgmtService.registerMBean(
                            new Version(
@@ -1189,7 +1189,7 @@ public final class NetworkServerControlImpl {
         // get the system's authentication service
         final AuthenticationService auth
             = ((AuthenticationService)
-               Monitor.findService(AuthenticationService.MODULE,
+               findService(AuthenticationService.MODULE,
                                    "authentication"));
 
         // authenticate user
@@ -4170,4 +4170,41 @@ public final class NetworkServerControlImpl {
         }
         return myPVH;
     }
+    
+    /**
+     * Privileged module lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object getSystemModule( final String factoryInterface )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.getSystemModule( factoryInterface );
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged service lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object findService( final String factoryInterface, final String serviceName )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.findService( factoryInterface, serviceName );
+                 }
+             }
+             );
+    }
+    
 }
diff --git a/java/engine/org/apache/derby/iapi/jdbc/DRDAServerStarter.java b/java/engine/org/apache/derby/iapi/jdbc/DRDAServerStarter.java
index c988ad2f5..8b8303324 100644
--- a/java/engine/org/apache/derby/iapi/jdbc/DRDAServerStarter.java
+++ b/java/engine/org/apache/derby/iapi/jdbc/DRDAServerStarter.java
@@ -24,6 +24,7 @@ package org.apache.derby.iapi.jdbc;
 import org.apache.derby.shared.common.sanity.SanityManager;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.iapi.services.monitor.ModuleControl;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.reference.MessageId;
 import org.apache.derby.iapi.reference.Property;
 import java.io.PrintWriter;
@@ -216,7 +217,7 @@ public final class DRDAServerStarter implements ModuleControl, Runnable
                      userArg, passwordArg});
             }
 
-            serverThread = Monitor.getMonitor().getDaemonThread( this, "NetworkServerStarter", false);
+            serverThread = getMonitor().getDaemonThread( this, "NetworkServerStarter", false);
             serverThread.start();
         }
         catch( Exception e)
@@ -289,4 +290,22 @@ public final class DRDAServerStarter implements ModuleControl, Runnable
 		consoleWriter = null;
 		
     } // end of stop
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
 }
diff --git a/java/engine/org/apache/derby/iapi/jdbc/JDBCBoot.java b/java/engine/org/apache/derby/iapi/jdbc/JDBCBoot.java
index 541ccb123..b46cab0ab 100644
--- a/java/engine/org/apache/derby/iapi/jdbc/JDBCBoot.java
+++ b/java/engine/org/apache/derby/iapi/jdbc/JDBCBoot.java
@@ -22,6 +22,8 @@
 package org.apache.derby.iapi.jdbc;
 
 import java.io.PrintWriter;
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.util.Properties;
 import org.apache.derby.iapi.error.StandardException;
 import org.apache.derby.iapi.reference.MessageId;
@@ -53,7 +55,7 @@ public class JDBCBoot {
 		no current JDBC driver that is handling the required protocol.
 
 	*/
-	public void boot(String protocol, PrintWriter logging) {
+	public void boot(String protocol, final PrintWriter logging) {
 
 		if (org.apache.derby.jdbc.InternalDriver.activeDriver() == null)
 		{
@@ -64,27 +66,47 @@ public class JDBCBoot {
 			addProperty("derby.service.jdbc", "org.apache.derby.jdbc.InternalDriver");
 			addProperty("derby.service.authentication", AuthenticationService.MODULE);
 
-			Monitor.startMonitor(bootProperties, logging);
-
-            /* The network server starter module is started differently from other modules because
-             * 1. its start is conditional, depending on a system property, and PropertyUtil.getSystemProperty
-             *    does not work until the Monitor has started,
-             * 2. we do not want the server to try to field requests before Derby has booted, and
-             * 3. if the module fails to start we want to log a message to the error log and continue as
-             *    an embedded database.
-             */
-            if( Boolean.valueOf(PropertyUtil.getSystemProperty(Property.START_DRDA)).booleanValue())
-            {
-                try
-                {
-                    Monitor.startSystemModule( NETWORK_SERVER_AUTOSTART_CLASS_NAME);
-                }
-                catch( StandardException se)
-                {
-                    Monitor.logTextMessage( MessageId.CONN_NETWORK_SERVER_START_EXCEPTION,
-                                            se.getMessage());
-                }
-            }
+			boot( bootProperties, logging);
 		}
 	}
+    
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  void    boot( final Properties props, final PrintWriter logging )
+    {
+        AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     Monitor.startMonitor(props, logging);
+
+                     /* The network server starter module is started differently from other modules because
+                      * 1. its start is conditional, depending on a system property, and PropertyUtil.getSystemProperty
+                      *    does not work until the Monitor has started,
+                      * 2. we do not want the server to try to field requests before Derby has booted, and
+                      * 3. if the module fails to start we want to log a message to the error log and continue as
+                      *    an embedded database.
+                      */
+                     if( Boolean.valueOf(PropertyUtil.getSystemProperty(Property.START_DRDA)).booleanValue())
+                     {
+                         try
+                         {
+                             Monitor.startSystemModule( NETWORK_SERVER_AUTOSTART_CLASS_NAME);
+                         }
+                         catch( StandardException se)
+                         {
+                             Monitor.logTextMessage( MessageId.CONN_NETWORK_SERVER_START_EXCEPTION,
+                                                     se.getMessage());
+                         }
+                     }
+                     
+                     return null;
+                 }
+             }
+             );
+    }
 }
diff --git a/java/engine/org/apache/derby/iapi/services/context/SystemContext.java b/java/engine/org/apache/derby/iapi/services/context/SystemContext.java
index 5086781a6..82dd4aae4 100644
--- a/java/engine/org/apache/derby/iapi/services/context/SystemContext.java
+++ b/java/engine/org/apache/derby/iapi/services/context/SystemContext.java
@@ -21,8 +21,12 @@
 
 package org.apache.derby.iapi.services.context;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
+
 import org.apache.derby.iapi.error.ShutdownException;
 import org.apache.derby.iapi.error.StandardException;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.iapi.error.ExceptionSeverity;
 /**
@@ -73,10 +77,27 @@ final class SystemContext extends ContextImpl
 
 		} finally {
 			// we need this to happen even if we fail to print out a notice
-			Monitor.getMonitor().shutdown();
+			getMonitor().shutdown();
 		}
 
 	}
 
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
 }
 
diff --git a/java/engine/org/apache/derby/iapi/services/monitor/Monitor.java b/java/engine/org/apache/derby/iapi/services/monitor/Monitor.java
index 86215f51c..08bf96805 100644
--- a/java/engine/org/apache/derby/iapi/services/monitor/Monitor.java
+++ b/java/engine/org/apache/derby/iapi/services/monitor/Monitor.java
@@ -30,6 +30,7 @@ import org.apache.derby.iapi.reference.Attribute;
 import org.apache.derby.iapi.reference.EngineType;
 import org.apache.derby.iapi.reference.Property;
 import org.apache.derby.iapi.reference.SQLState;
+import org.apache.derby.iapi.security.SecurityUtil;
 import org.apache.derby.iapi.services.i18n.MessageService;
 import org.apache.derby.iapi.services.info.ProductVersionHolder;
 import org.apache.derby.iapi.services.loader.InstanceGetter;
@@ -283,6 +284,9 @@ public class Monitor {
 
     @SuppressWarnings("ResultOfObjectAllocationIgnored")
 	public static void startMonitor(Properties bootProperties, PrintWriter logging) {
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+        
         try {
             new org.apache.derby.impl.services.monitor.FileMonitor(bootProperties, logging);
         } catch (AccessControlException e) {
@@ -296,6 +300,9 @@ public class Monitor {
 	*/
 	public static boolean setMonitor(ModuleFactory theMonitor) {
 
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+        
 		synchronized (syncMe) {
 			if (active)
 				return false;
@@ -307,6 +314,9 @@ public class Monitor {
 	}
 
 	public static void clearMonitor() {
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+        
 		// the monitor reference needs to remain valid
 		// as there are some accesses to getMonitor()
 		// after the system has been shutdown.
@@ -319,9 +329,15 @@ public class Monitor {
 		Get the monitor.
 	*/
 	public static ModuleFactory getMonitor() {
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+        
 		return monitor;
 	}
 	public static ModuleFactory getMonitorLite() {
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+        
 		synchronized (syncMe) {
 			if (active && monitor != null)
 				return monitor;
@@ -343,6 +359,9 @@ public class Monitor {
 		Return the name of the service that the passed in module lives in.
 	*/
 	public static String getServiceName(Object serviceModule) {
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+        
 		return monitor.getServiceName(serviceModule);
 	}
 
@@ -363,8 +382,11 @@ public class Monitor {
 		@see ModuleControl#boot
 	*/
 	public static Object startSystemModule(String factoryInterface)
-		throws StandardException {
+        throws StandardException {
 
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+        
 		Object module = monitor.startModule(false, (Object) null, factoryInterface, (String) null, (Properties) null);
 		
 		if (SanityManager.DEBUG) {
@@ -381,6 +403,9 @@ public class Monitor {
 	*/
 	public static Object findSystemModule(String factoryInterface) throws StandardException
 	{
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+        
 		Object module = getMonitor().findModule((Object) null,
 									  factoryInterface, (String) null);
 		if (module == null)
@@ -395,6 +420,9 @@ public class Monitor {
      */
     public static Object getSystemModule(String factoryInterface)
     {
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+        
         ModuleFactory monitor = getMonitor();
         if (monitor == null)
             return null;
@@ -426,6 +454,9 @@ public class Monitor {
 		String factoryInterface, Properties properties)
 		throws StandardException {
 
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+        
 		Object module = monitor.startModule(create, serviceModule, factoryInterface,
 						(String) null, properties);
 
@@ -458,6 +489,9 @@ public class Monitor {
 		String factoryInterface, String identifier, Properties properties)
 		throws StandardException {
 
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+        
 		Object module = monitor.startModule(create, serviceModule, factoryInterface, identifier, properties);
 		
 		if (SanityManager.DEBUG) {
@@ -477,6 +511,9 @@ public class Monitor {
 	*/
 	public static Object findServiceModule(Object serviceModule, String factoryInterface)
 		throws StandardException {
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+        
 		Object module = getMonitor().findModule(serviceModule, factoryInterface, (String) null);
 		if (module == null)
 			throw Monitor.missingImplementation(factoryInterface);
@@ -484,6 +521,9 @@ public class Monitor {
 	}
 	public static Object getServiceModule(Object serviceModule, String factoryInterface)
 	{
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+        
 		Object module = getMonitor().findModule(serviceModule, factoryInterface, (String) null);
 		return module;
 	}
@@ -508,6 +548,9 @@ public class Monitor {
 
 	*/
 	public static Object findService(String factoryInterface, String serviceName) {
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+        
 		return monitor.findService(factoryInterface, serviceName);
 	}
 
@@ -545,6 +588,9 @@ public class Monitor {
 												 Properties properties) 
 		throws StandardException {
 
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+        
 		if (SanityManager.DEBUG) {
 			SanityManager.ASSERT(serviceName != null, "serviceName is null");
 		}
@@ -565,6 +611,9 @@ public class Monitor {
 	public static Object startNonPersistentService(String factoryInterface, String serviceName, Properties properties)
 		throws StandardException {
 
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+        
 		if (SanityManager.DEBUG) {
 			SanityManager.ASSERT(factoryInterface != null, "serviceName is null");
 			SanityManager.ASSERT(serviceName != null, "serviceName is null");
@@ -590,6 +639,9 @@ public class Monitor {
 	public static Object createPersistentService(String factoryInterface, String serviceName, Properties properties) 
 		throws StandardException {
 
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+        
 		if (SanityManager.DEBUG) {
 			SanityManager.ASSERT(factoryInterface != null, "serviceName is null");
 			SanityManager.ASSERT(serviceName != null, "serviceName is null");
@@ -600,6 +652,9 @@ public class Monitor {
     public static void removePersistentService(String name)
         throws StandardException
     {
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+        
         // For now we only allow dropping in-memory databases.
         // This is mostly due to the fact that the current implementation for
         // the on-disk back end doesn't handle logDevice when dropping.
@@ -642,6 +697,7 @@ public class Monitor {
 	*/
 	public static Object newInstanceFromIdentifier(int identifier) 
 		throws StandardException {
+        
 		return monitor.newInstanceFromIdentifier(identifier);
 	}
 
@@ -711,6 +767,9 @@ public class Monitor {
 	 */
 	public static boolean isFullUpgrade(Properties startParams, String oldVersionInfo) throws StandardException {
 
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+        
 		boolean fullUpgrade = Boolean.valueOf(startParams.getProperty(org.apache.derby.iapi.reference.Attribute.UPGRADE_ATTR)).booleanValue();
 
 		ProductVersionHolder engineVersion = Monitor.getMonitor().getEngineVersion();
diff --git a/java/engine/org/apache/derby/iapi/services/property/PropertyUtil.java b/java/engine/org/apache/derby/iapi/services/property/PropertyUtil.java
index 7ae313d39..a8d29da3b 100644
--- a/java/engine/org/apache/derby/iapi/services/property/PropertyUtil.java
+++ b/java/engine/org/apache/derby/iapi/services/property/PropertyUtil.java
@@ -34,6 +34,8 @@ import org.apache.derby.iapi.util.IdUtil;
 
 import java.util.Properties;
 import java.io.Serializable;
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.util.Dictionary;
 import java.util.Enumeration;
 
@@ -102,7 +104,7 @@ public class PropertyUtil {
 		boolean dbOnly = isDBOnly(set);
 
 		if (!dbOnly) {
-			if (Monitor.getMonitor().getJVMProperty(key) != null) {
+			if (getMonitor().getJVMProperty(key) != null) {
 				return SET_IN_JVM;
 			}
 		}
@@ -177,7 +179,7 @@ public class PropertyUtil {
 	*/
 	public static String getSystemProperty(String key, String defaultValue) {
 
-		ModuleFactory monitor = Monitor.getMonitorLite();
+		ModuleFactory monitor = getMonitorLite();
 
 		String value = monitor.getJVMProperty(key);
 
@@ -241,7 +243,7 @@ public class PropertyUtil {
 			Serializable value;
 
 			if (!dbOnly) {
-				value = Monitor.getMonitor().getJVMProperty(key);
+				value = getMonitor().getJVMProperty(key);
 				if (value != null)
 					return value;
 			}
@@ -264,7 +266,7 @@ public class PropertyUtil {
 			String value;
 
 			if (!dbOnly) {
-				value = Monitor.getMonitor().getJVMProperty(key);
+				value = getMonitor().getJVMProperty(key);
 				if (value != null)
 					return value;
 			}
@@ -319,7 +321,7 @@ public class PropertyUtil {
                 (value != null ? value.trim() : value)).booleanValue();
 
 		if (!dbOnly) {
-			value = Monitor.getMonitor().getJVMProperty(key);
+			value = getMonitor().getJVMProperty(key);
 			if (value != null)
 				return value;
 		}
@@ -634,7 +636,7 @@ public class PropertyUtil {
 	 */
 	private static boolean systemPropertiesExistsBuiltinUser(String username)
 	{
-		ModuleFactory monitor = Monitor.getMonitorLite();
+		ModuleFactory monitor = getMonitorLite();
 
 		try {
 			Properties JVMProperties = System.getProperties();
@@ -682,5 +684,43 @@ public class PropertyUtil {
 
 		return false;
 	}
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitorLite()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitorLite();
+                 }
+             }
+             );
+    }
+
 }
 
diff --git a/java/engine/org/apache/derby/iapi/sql/dictionary/ConglomerateDescriptor.java b/java/engine/org/apache/derby/iapi/sql/dictionary/ConglomerateDescriptor.java
index 5ba80c227..2236dd29b 100644
--- a/java/engine/org/apache/derby/iapi/sql/dictionary/ConglomerateDescriptor.java
+++ b/java/engine/org/apache/derby/iapi/sql/dictionary/ConglomerateDescriptor.java
@@ -109,7 +109,7 @@ public final class ConglomerateDescriptor extends UniqueTupleDescriptor
 		this.forConstraint = forConstraint;
 		if (uuid == null)
 		{
-			UUIDFactory uuidFactory = Monitor.getMonitor().getUUIDFactory();
+			UUIDFactory uuidFactory = DataDescriptorGenerator.getMonitor().getUUIDFactory();
 			uuid = uuidFactory.createUUID();
 		}
 		this.uuid = uuid;
diff --git a/java/engine/org/apache/derby/iapi/sql/dictionary/DataDescriptorGenerator.java b/java/engine/org/apache/derby/iapi/sql/dictionary/DataDescriptorGenerator.java
index 91db9fbfd..6827e150b 100644
--- a/java/engine/org/apache/derby/iapi/sql/dictionary/DataDescriptorGenerator.java
+++ b/java/engine/org/apache/derby/iapi/sql/dictionary/DataDescriptorGenerator.java
@@ -21,12 +21,15 @@
 
 package org.apache.derby.iapi.sql.dictionary;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.sql.Timestamp;
 import org.apache.derby.catalog.ReferencedColumns;
 import org.apache.derby.catalog.UUID;
 import org.apache.derby.catalog.types.ReferencedColumnsDescriptorImpl;
 import org.apache.derby.iapi.error.StandardException;
 import org.apache.derby.iapi.services.io.FormatableBitSet;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.shared.common.sanity.SanityManager;
 import org.apache.derby.iapi.services.uuid.UUIDFactory;
@@ -409,7 +412,7 @@ public class DataDescriptorGenerator
 	protected UUIDFactory getUUIDFactory()
 	{
 		if (uuidf == null)
-			uuidf = Monitor.getMonitor().getUUIDFactory();
+			uuidf = getMonitor().getUUIDFactory();
 		return uuidf;
 	}
 
@@ -598,4 +601,23 @@ public class DataDescriptorGenerator
                 grantee,
                 grantable);
     }
+    
+    /**
+     * Privileged Monitor lookup. Must be package private so that user code
+     * can't call this entry point.
+     */
+    static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
 }
diff --git a/java/engine/org/apache/derby/iapi/sql/dictionary/SPSDescriptor.java b/java/engine/org/apache/derby/iapi/sql/dictionary/SPSDescriptor.java
index d093e47e6..de50d29bf 100644
--- a/java/engine/org/apache/derby/iapi/sql/dictionary/SPSDescriptor.java
+++ b/java/engine/org/apache/derby/iapi/sql/dictionary/SPSDescriptor.java
@@ -1148,7 +1148,7 @@ public class SPSDescriptor extends UniqueSQLObjectDescriptor
 	{
 		if (uuidFactory == null)
 		{
-			uuidFactory = Monitor.getMonitor().getUUIDFactory();
+			uuidFactory = DataDescriptorGenerator.getMonitor().getUUIDFactory();
 		}
 		return uuidFactory.recreateUUID(idString);
 	}
diff --git a/java/engine/org/apache/derby/iapi/types/DataValueFactoryImpl.java b/java/engine/org/apache/derby/iapi/types/DataValueFactoryImpl.java
index 8b01728e7..52acadad8 100644
--- a/java/engine/org/apache/derby/iapi/types/DataValueFactoryImpl.java
+++ b/java/engine/org/apache/derby/iapi/types/DataValueFactoryImpl.java
@@ -76,7 +76,7 @@ public final class DataValueFactoryImpl implements DataValueFactory, ModuleContr
     	 */
     	public void boot(boolean create, Properties properties) throws StandardException {
     		
-    		ModuleFactory monitor = Monitor.getMonitor();
+    		ModuleFactory monitor = getMonitor();
     		//The Locale on monitor has already been set by the boot code in
     		//BasicDatabase so we can simply do a get here.
     		//This Locale will be either the Locale obtained from the territory
@@ -1161,22 +1161,34 @@ public final class DataValueFactoryImpl implements DataValueFactory, ModuleContr
      */
     static  Context    getContext( final String contextID )
     {
-        if ( System.getSecurityManager() == null )
-        {
-            return ContextService.getContext( contextID );
-        }
-        else
-        {
-            return AccessController.doPrivileged
-                (
-                 new PrivilegedAction<Context>()
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Context>()
+             {
+                 public Context run()
                  {
-                     public Context run()
-                     {
-                         return ContextService.getContext( contextID );
-                     }
+                     return ContextService.getContext( contextID );
                  }
-                 );
-        }
+             }
+             );
     }
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
 }
diff --git a/java/engine/org/apache/derby/impl/db/BasicDatabase.java b/java/engine/org/apache/derby/impl/db/BasicDatabase.java
index 1edad4274..e5b4eaf94 100644
--- a/java/engine/org/apache/derby/impl/db/BasicDatabase.java
+++ b/java/engine/org/apache/derby/impl/db/BasicDatabase.java
@@ -149,7 +149,7 @@ public class BasicDatabase implements ModuleControl, ModuleSupportable, Property
 		throws StandardException
 	{
 
-		ModuleFactory monitor = Monitor.getMonitor();
+		ModuleFactory monitor = getMonitor();
 		if (create)
 		{
 			if (startParams.getProperty(Property.CREATE_WITH_NO_LOG) == null)
@@ -177,7 +177,7 @@ public class BasicDatabase implements ModuleControl, ModuleSupportable, Property
 		// registered types (DECIMAL) are there before logical undo recovery 
         // might need them.
 		DataValueFactory dvf = (DataValueFactory) 
-            Monitor.bootServiceModule(
+            bootServiceModule(
                 create, 
                 this,
 				org.apache.derby.iapi.reference.ClassName.DataValueFactory, 
@@ -202,15 +202,15 @@ public class BasicDatabase implements ModuleControl, ModuleSupportable, Property
 		bootClassFactory(create, allParams);
         
         dd = (DataDictionary)
-            Monitor.bootServiceModule(create, this,
+            bootServiceModule(create, this,
                     DataDictionary.MODULE, allParams);
 
 		lcf = (LanguageConnectionFactory) 
-            Monitor.bootServiceModule(
+            bootServiceModule(
                 create, this, LanguageConnectionFactory.MODULE, allParams);
 
 		lf = (LanguageFactory) 
-            Monitor.bootServiceModule(
+            bootServiceModule(
                 create, this, LanguageFactory.MODULE, allParams);
 
 		bootResourceAdapter(create, allParams);
@@ -595,7 +595,7 @@ public class BasicDatabase implements ModuleControl, ModuleSupportable, Property
 			// no property defined in the Transaction set
 			// this could be an upgrade, see if it's stored in the service set
 
-			UUIDFactory	uuidFactory  = Monitor.getMonitor().getUUIDFactory();
+			UUIDFactory	uuidFactory  = getMonitor().getUUIDFactory();
 
 			
 			upgradeID = startParams.getProperty(DataDictionary.DATABASE_ID);
@@ -745,7 +745,7 @@ public class BasicDatabase implements ModuleControl, ModuleSupportable, Property
 			IdUtil.parseDbClassPath(classpath);
 
 			startParams.put(Property.BOOT_DB_CLASSPATH, classpath);
-			cfDB = (ClassFactory) Monitor.bootServiceModule(create, this,
+			cfDB = (ClassFactory) bootServiceModule(create, this,
 					org.apache.derby.iapi.reference.Module.ClassFactory, startParams);
 	}
 
@@ -763,18 +763,18 @@ public class BasicDatabase implements ModuleControl, ModuleSupportable, Property
 
 	protected AuthenticationService bootAuthenticationService(boolean create, Properties props) throws StandardException {
 		return (AuthenticationService)
-				Monitor.bootServiceModule(create, this, AuthenticationService.MODULE, props);
+				bootServiceModule(create, this, AuthenticationService.MODULE, props);
 	}
 
 	protected void bootValidation(boolean create, Properties startParams)
 		throws StandardException {
-		pf = (PropertyFactory) Monitor.bootServiceModule(create, this,
+		pf = (PropertyFactory) bootServiceModule(create, this,
 			org.apache.derby.iapi.reference.Module.PropertyFactory, startParams);
 	}
 
 	protected void bootStore(boolean create, Properties startParams)
 		throws StandardException {
-		af = (AccessFactory) Monitor.bootServiceModule(create, this, AccessFactory.MODULE, startParams);
+		af = (AccessFactory) bootServiceModule(create, this, AccessFactory.MODULE, startParams);
 	}
 
     /**
@@ -808,7 +808,7 @@ public class BasicDatabase implements ModuleControl, ModuleSupportable, Property
 		try
 		{
 			resourceAdapter = 
-				Monitor.bootServiceModule(create, this,
+				bootServiceModule(create, this,
 										 org.apache.derby.iapi.reference.Module.ResourceAdapter,
 										 allParams);
 		}
@@ -891,7 +891,7 @@ public class BasicDatabase implements ModuleControl, ModuleSupportable, Property
     private StorageFactory  getStorageFactory()
         throws StandardException
     {
-        DataFactory dataFactory = (DataFactory) Monitor.findServiceModule( this, DataFactory.MODULE );
+        DataFactory dataFactory = (DataFactory) findServiceModule( this, DataFactory.MODULE );
 
         return dataFactory.getStorageFactory();
     }
@@ -948,22 +948,88 @@ public class BasicDatabase implements ModuleControl, ModuleSupportable, Property
      */
     private  static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
+                 {
+                     return ContextService.getFactory();
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
+    
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object bootServiceModule
+        (
+         final boolean create, final Object serviceModule,
+         final String factoryInterface, final Properties properties
+         )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.bootServiceModule( create, serviceModule, factoryInterface, properties );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
         {
-            return ContextService.getFactory();
+            throw StandardException.plainWrapException( pae );
         }
-        else
-        {
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object findServiceModule( final Object serviceModule, final String factoryInterface)
+        throws StandardException
+    {
+        try {
             return AccessController.doPrivileged
                 (
-                 new PrivilegedAction<ContextService>()
+                 new PrivilegedExceptionAction<Object>()
                  {
-                     public ContextService run()
+                     public Object run()
+                         throws StandardException
                      {
-                         return ContextService.getFactory();
+                         return Monitor.findServiceModule( serviceModule, factoryInterface );
                      }
                  }
                  );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
         }
     }
 
diff --git a/java/engine/org/apache/derby/impl/db/DatabaseContextImpl.java b/java/engine/org/apache/derby/impl/db/DatabaseContextImpl.java
index c512f1b48..02663237f 100644
--- a/java/engine/org/apache/derby/impl/db/DatabaseContextImpl.java
+++ b/java/engine/org/apache/derby/impl/db/DatabaseContextImpl.java
@@ -25,6 +25,7 @@ import org.apache.derby.iapi.services.context.ContextImpl;
 import org.apache.derby.iapi.services.context.ContextManager;
 import org.apache.derby.iapi.services.context.ContextService;
 import org.apache.derby.iapi.sql.dictionary.DataDictionary;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.iapi.db.Database;
 import org.apache.derby.iapi.db.DatabaseContext;
@@ -76,7 +77,7 @@ final class DatabaseContextImpl extends ContextImpl implements DatabaseContext
 		    getContextService().notifyAllActiveThreads(this);
             // This may be called multiple times, but is short-circuited
             // in the monitor.
-		    Monitor.getMonitor().shutdown(db);
+		    getMonitor().shutdown(db);
         }
 	}
 
@@ -99,23 +100,34 @@ final class DatabaseContextImpl extends ContextImpl implements DatabaseContext
      */
     private  static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
-        {
-            return ContextService.getFactory();
-        }
-        else
-        {
-            return AccessController.doPrivileged
-                (
-                 new PrivilegedAction<ContextService>()
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
                  {
-                     public ContextService run()
-                     {
-                         return ContextService.getFactory();
-                     }
+                     return ContextService.getFactory();
                  }
-                 );
-        }
+             }
+             );
+    }
+
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
     }
 
 }
diff --git a/java/engine/org/apache/derby/impl/db/SlaveDatabase.java b/java/engine/org/apache/derby/impl/db/SlaveDatabase.java
index d0e9d4d91..ae1992664 100644
--- a/java/engine/org/apache/derby/impl/db/SlaveDatabase.java
+++ b/java/engine/org/apache/derby/impl/db/SlaveDatabase.java
@@ -36,6 +36,8 @@ import org.apache.derby.iapi.sql.conn.LanguageConnectionContext;
 import org.apache.derby.jdbc.InternalDriver;
 
 import java.security.PrivilegedAction;
+import java.security.PrivilegedExceptionAction;
+import java.security.PrivilegedActionException;
 import java.security.AccessController;
 
 import java.sql.SQLException;
@@ -396,7 +398,7 @@ public class SlaveDatabase extends BasicDatabase {
         }
 
         try {
-            slaveFac = (SlaveFactory)Monitor.
+            slaveFac = (SlaveFactory)
                 findServiceModule(this, SlaveFactory.MODULE);
             return true;
         } catch (StandardException se) {
@@ -456,22 +458,40 @@ public class SlaveDatabase extends BasicDatabase {
      */
     private  static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
-        {
-            return ContextService.getFactory();
-        }
-        else
-        {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
+                 {
+                     return ContextService.getFactory();
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object findServiceModule( final Object serviceModule, final String factoryInterface)
+        throws StandardException
+    {
+        try {
             return AccessController.doPrivileged
                 (
-                 new PrivilegedAction<ContextService>()
+                 new PrivilegedExceptionAction<Object>()
                  {
-                     public ContextService run()
+                     public Object run()
+                         throws StandardException
                      {
-                         return ContextService.getFactory();
+                         return Monitor.findServiceModule( serviceModule, factoryInterface );
                      }
                  }
                  );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
         }
     }
 
diff --git a/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java b/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java
index 8320cebd0..2178c765a 100644
--- a/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java
+++ b/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java
@@ -30,6 +30,7 @@ import org.apache.derby.iapi.reference.SQLState;
 
 import org.apache.derby.iapi.services.context.ContextManager;
 import org.apache.derby.iapi.services.memory.LowMemory;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.shared.common.sanity.SanityManager;
 import org.apache.derby.iapi.services.property.PropertyUtil;
@@ -55,8 +56,12 @@ import org.apache.derby.iapi.store.replication.master.MasterFactory;
 import org.apache.derby.iapi.store.replication.slave.SlaveFactory;
 import java.io.IOException;
 
-import java.security.Permission;
 import java.security.AccessControlException;
+import java.security.AccessController;
+import java.security.Permission;
+import java.security.PrivilegedAction;
+import java.security.PrivilegedExceptionAction;
+import java.security.PrivilegedActionException;
 
 /* can't import due to name overlap:
 import java.sql.Connection;
@@ -259,7 +264,7 @@ public class EmbedConnection implements EngineConnection
             boolean shutdown = isTrue(info, Attribute.SHUTDOWN_ATTR);
 
 			// see if database is already booted
-			Database database = (Database) Monitor.findService(Property.DATABASE_MODULE, tr.getDBName());
+			Database database = (Database) findService(Property.DATABASE_MODULE, tr.getDBName());
 
             // encryption, re-encryption and decryption are not allowed on an already booted database.
             // see DERBY-5969.
@@ -617,7 +622,7 @@ public class EmbedConnection implements EngineConnection
                 // may cause a number of errors to be thrown. Try to make the
                 // shutdown/drop as clean as possible.
                 sleep(500L);
-                Monitor.removePersistentService(dbName);
+                removePersistentService(dbName);
                 // Generate the drop database exception here, as this is the
                 // only place it will be thrown.
                 StandardException se = StandardException.newException(
@@ -1341,8 +1346,8 @@ public class EmbedConnection implements EngineConnection
         throws SQLException
     {
         try {
-            String  leftCanonical = Monitor.getMonitor().getCanonicalServiceName( leftDBName );
-            String  rightCanonical = Monitor.getMonitor().getCanonicalServiceName( rightDBName );
+            String  leftCanonical = getMonitor().getCanonicalServiceName( leftDBName );
+            String  rightCanonical = getMonitor().getCanonicalServiceName( rightDBName );
 
             if ( leftCanonical == null ) { return false; }
             else { return leftCanonical.equals( rightCanonical ); }
@@ -2638,7 +2643,7 @@ public class EmbedConnection implements EngineConnection
 		//checkDatabaseCreatePrivileges(user, dbname);
 
 		try {
-			if (Monitor.createPersistentService(Property.DATABASE_MODULE, dbname, info) == null) 
+			if (createPersistentService(Property.DATABASE_MODULE, dbname, info) == null) 
 			{
 				// service already exists, create a warning
 				addWarning(SQLWarningFactory.newSQLWarning(SQLState.DATABASE_EXISTS, dbname));
@@ -2654,7 +2659,7 @@ public class EmbedConnection implements EngineConnection
 		// and they shouldn't be interested in these JDBC attributes.
 		info.clear();
 
-		return (Database) Monitor.findService(Property.DATABASE_MODULE, dbname);
+		return (Database) findService(Property.DATABASE_MODULE, dbname);
 	}
 
     /**
@@ -2800,7 +2805,7 @@ public class EmbedConnection implements EngineConnection
 			}
 			
 			// try to start the service if it doesn't already exist
-			if (!Monitor.startPersistentService(dbname, info)) {
+			if (!startPersistentService(dbname, info)) {
 				// a false indicates the monitor cannot handle a service
 				// of the type indicated by the protocol within the name.
 				// If that's the case then we are the wrong driver
@@ -2813,7 +2818,7 @@ public class EmbedConnection implements EngineConnection
 			// and they shouldn't be interested in these JDBC attributes.
 			info.clear();
 
-			Database database = (Database) Monitor.findService(Property.DATABASE_MODULE, dbname);
+			Database database = (Database) findService(Property.DATABASE_MODULE, dbname);
 			tr.setDatabase(database);
 
 		} catch (StandardException mse) {
@@ -3969,4 +3974,122 @@ public class EmbedConnection implements EngineConnection
         throw Util.notImplemented();
     }
     
+    /////////////////////////////////////////////////////////////////////////
+    //
+    //  SECURITY
+    //
+    /////////////////////////////////////////////////////////////////////////
+
+    /**
+     * Privileged Monitor lookup. Must be package private so that user code
+     * can't call this entry point.
+     */
+    static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged service lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object findService( final String factoryInterface, final String serviceName )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.findService( factoryInterface, serviceName );
+                 }
+             }
+             );
+    }
+    
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  boolean startPersistentService( final String serviceName, final Properties properties ) 
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Boolean>()
+                 {
+                     public Boolean run()
+                         throws StandardException
+                     {
+                         return Monitor.startPersistentService( serviceName, properties );
+                     }
+                 }
+                 ).booleanValue();
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object createPersistentService( final String factoryInterface, final String serviceName, final Properties properties ) 
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.createPersistentService( factoryInterface, serviceName, properties );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
+    /**
+     * Privileged shutdown. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  void removePersistentService( final String name )
+        throws StandardException
+    {
+        try {
+            AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         Monitor.removePersistentService( name );
+                         return null;
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
 }
diff --git a/java/engine/org/apache/derby/impl/jdbc/EmbedDatabaseMetaData.java b/java/engine/org/apache/derby/impl/jdbc/EmbedDatabaseMetaData.java
index 971554bd1..71c0761fc 100644
--- a/java/engine/org/apache/derby/impl/jdbc/EmbedDatabaseMetaData.java
+++ b/java/engine/org/apache/derby/impl/jdbc/EmbedDatabaseMetaData.java
@@ -275,7 +275,7 @@ public class EmbedDatabaseMetaData extends ConnectionChild
      * @return database product name
      */
 	public String getDatabaseProductName() {
-		return Monitor.getMonitor().getEngineVersion().getProductName();
+		return EmbedConnection.getMonitor().getEngineVersion().getProductName();
 	}
 
     /**
@@ -284,7 +284,7 @@ public class EmbedDatabaseMetaData extends ConnectionChild
      * @return database version
      */
 	public String getDatabaseProductVersion() {
-		ProductVersionHolder myPVH = Monitor.getMonitor().getEngineVersion();
+		ProductVersionHolder myPVH = EmbedConnection.getMonitor().getEngineVersion();
 
 		return myPVH.getVersionBuildString(true);
 	}
@@ -3271,7 +3271,7 @@ public class EmbedDatabaseMetaData extends ConnectionChild
 	*/
 	public int getDatabaseMajorVersion()
 	{
-		ProductVersionHolder pvh = Monitor.getMonitor().getEngineVersion();
+		ProductVersionHolder pvh = EmbedConnection.getMonitor().getEngineVersion();
 		if (pvh == null)
 		{
 		  return -1;
@@ -3288,7 +3288,7 @@ public class EmbedDatabaseMetaData extends ConnectionChild
 	*/
 	public int getDatabaseMinorVersion()
 	{
-		ProductVersionHolder pvh = Monitor.getMonitor().getEngineVersion();
+		ProductVersionHolder pvh = EmbedConnection.getMonitor().getEngineVersion();
 		if (pvh == null)
 		{
 		  return -1;
diff --git a/java/engine/org/apache/derby/impl/jdbc/LOBStreamControl.java b/java/engine/org/apache/derby/impl/jdbc/LOBStreamControl.java
index 58f01b46e..d3e1062eb 100644
--- a/java/engine/org/apache/derby/impl/jdbc/LOBStreamControl.java
+++ b/java/engine/org/apache/derby/impl/jdbc/LOBStreamControl.java
@@ -93,9 +93,9 @@ final class LOBStreamControl {
 
     private void init(byte [] b, long len)
             throws IOException, StandardException {
-        Object monitor = Monitor.findService(
+        Object monitor = findService(
                 Property.DATABASE_MODULE, conn.getDBName());
-        final DataFactory df = (DataFactory) Monitor.findServiceModule(
+        final DataFactory df = (DataFactory) findServiceModule(
                 monitor, DataFactory.MODULE);
         try {
             AccessController.doPrivileged (new PrivilegedExceptionAction<Object>() {
@@ -623,4 +623,47 @@ final class LOBStreamControl {
     long getUpdateCount() {
         return updateCount;
     }
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object findServiceModule( final Object serviceModule, final String factoryInterface)
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.findServiceModule( serviceModule, factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
+    /**
+     * Privileged service lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object findService( final String factoryInterface, final String serviceName )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.findService( factoryInterface, serviceName );
+                 }
+             }
+             );
+    }
+    
 }
diff --git a/java/engine/org/apache/derby/impl/jdbc/authentication/AuthenticationServiceBase.java b/java/engine/org/apache/derby/impl/jdbc/authentication/AuthenticationServiceBase.java
index 46889b8a6..60236f2e0 100644
--- a/java/engine/org/apache/derby/impl/jdbc/authentication/AuthenticationServiceBase.java
+++ b/java/engine/org/apache/derby/impl/jdbc/authentication/AuthenticationServiceBase.java
@@ -190,12 +190,12 @@ public abstract class AuthenticationServiceBase
 			// at boot stage.
 			//
 			store = (AccessFactory)
-				Monitor.getServiceModule(this, AccessFactory.MODULE);
+				getServiceModule(this, AccessFactory.MODULE);
 			// register to be notified upon db properties changes
 			// _only_ if we're on a database context of course :)
 
 			PropertyFactory pf = (PropertyFactory)
-				Monitor.getServiceModule(this, org.apache.derby.iapi.reference.Module.PropertyFactory);
+				getServiceModule(this, org.apache.derby.iapi.reference.Module.PropertyFactory);
 			if (pf != null)
 				pf.addPropertySetNotification(this);
 
@@ -335,7 +335,7 @@ public abstract class AuthenticationServiceBase
     protected   String  getServiceName()
     {
         if ( store == null ) { return null; }
-        else { return Monitor.getServiceName( store ); }
+        else { return getServiceName( store ); }
     }
 
 	public String getDatabaseProperty(String key) {
@@ -827,23 +827,16 @@ public abstract class AuthenticationServiceBase
      */
     private  static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
-        {
-            return ContextService.getFactory();
-        }
-        else
-        {
-            return AccessController.doPrivileged
-                (
-                 new PrivilegedAction<ContextService>()
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
                  {
-                     public ContextService run()
-                     {
-                         return ContextService.getFactory();
-                     }
+                     return ContextService.getFactory();
                  }
-                 );
-        }
+             }
+             );
     }
 
     /**
@@ -852,23 +845,52 @@ public abstract class AuthenticationServiceBase
      */
     private  static  Context    getContext( final String contextID )
     {
-        if ( System.getSecurityManager() == null )
-        {
-            return ContextService.getContext( contextID );
-        }
-        else
-        {
-            return AccessController.doPrivileged
-                (
-                 new PrivilegedAction<Context>()
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Context>()
+             {
+                 public Context run()
                  {
-                     public Context run()
-                     {
-                         return ContextService.getContext( contextID );
-                     }
+                     return ContextService.getContext( contextID );
                  }
-                 );
-        }
+             }
+             );
+    }
+
+    /**
+     * Privileged service name lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  String getServiceName( final Object serviceModule )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<String>()
+             {
+                 public String run()
+                 {
+                     return Monitor.getServiceName( serviceModule );
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged module lookup. Must be package protected so that user code
+     * can't call this entry point.
+     */
+    static  Object getServiceModule( final Object serviceModule, final String factoryInterface )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.getServiceModule( serviceModule, factoryInterface );
+                 }
+             }
+             );
     }
 
 }
diff --git a/java/engine/org/apache/derby/impl/jdbc/authentication/NativeAuthenticationServiceImpl.java b/java/engine/org/apache/derby/impl/jdbc/authentication/NativeAuthenticationServiceImpl.java
index a5b5657c3..2ee122765 100644
--- a/java/engine/org/apache/derby/impl/jdbc/authentication/NativeAuthenticationServiceImpl.java
+++ b/java/engine/org/apache/derby/impl/jdbc/authentication/NativeAuthenticationServiceImpl.java
@@ -22,8 +22,10 @@
 package org.apache.derby.impl.jdbc.authentication;
 
 import java.util.Properties;
+import java.security.AccessController;
 import java.security.MessageDigest;
 import java.security.NoSuchAlgorithmException;
+import java.security.PrivilegedAction;
 import java.sql.Connection;
 import java.sql.SQLException;
 import java.sql.SQLWarning;
@@ -42,6 +44,7 @@ import org.apache.derby.iapi.reference.SQLState;
 import org.apache.derby.authentication.UserAuthenticator;
 import org.apache.derby.iapi.error.SQLWarningFactory;
 import org.apache.derby.iapi.error.StandardException;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.iapi.services.property.PropertyUtil;
 import org.apache.derby.shared.common.sanity.SanityManager;
@@ -205,7 +208,7 @@ public final class NativeAuthenticationServiceImpl
         if ( _credentialsDB != null )
         {
             // make sure that it is a well-formed database name
-            if ( Monitor.getMonitor().getCanonicalServiceName( _credentialsDB ) == null )
+            if ( getMonitor().getCanonicalServiceName( _credentialsDB ) == null )
             {
                 throw StandardException.newException( SQLState.BAD_CREDENTIALS_DB_NAME, _credentialsDB );
             }
@@ -339,7 +342,7 @@ public final class NativeAuthenticationServiceImpl
     private boolean authenticatingInThisDatabase( String userVisibleDatabaseName )
         throws StandardException
     {
-        return authenticatingInThisService( Monitor.getMonitor().getCanonicalServiceName( userVisibleDatabaseName ) );
+        return authenticatingInThisService( getMonitor().getCanonicalServiceName( userVisibleDatabaseName ) );
     }
 
     /**
@@ -364,7 +367,7 @@ public final class NativeAuthenticationServiceImpl
     {
         String  canonicalCredentialsDBName = getCanonicalServiceName( _credentialsDB );
 
-        String canonicalDB = Monitor.getMonitor().getCanonicalServiceName( canonicalDatabaseName );
+        String canonicalDB = getMonitor().getCanonicalServiceName( canonicalDatabaseName );
 
         if ( canonicalCredentialsDBName == null ) { return false; }
         else { return canonicalCredentialsDBName.equals( canonicalDatabaseName ); }
@@ -381,7 +384,7 @@ public final class NativeAuthenticationServiceImpl
     private String  getCanonicalServiceName( String rawName )
         throws StandardException
     {
-        return Monitor.getMonitor().getCanonicalServiceName( rawName );
+        return getMonitor().getCanonicalServiceName( rawName );
     }
 
     ///////////////////////////////////////////////////////////////////////////////////
@@ -493,7 +496,7 @@ public final class NativeAuthenticationServiceImpl
         //
         // we expect to find a data dictionary
         //
-        DataDictionary      dd = (DataDictionary) Monitor.getServiceModule( this, DataDictionary.MODULE );        
+        DataDictionary      dd = (DataDictionary) AuthenticationServiceBase.getServiceModule( this, DataDictionary.MODULE );        
         UserDescriptor      userDescriptor = dd.getUser( userName );
         
         if ( userDescriptor == null )
@@ -566,4 +569,41 @@ public final class NativeAuthenticationServiceImpl
         return true;
     }
     
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  String  getServiceName( final Object serviceModule )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<String>()
+             {
+                 public String run()
+                 {
+                     return Monitor.getServiceName( serviceModule );
+                 }
+             }
+             );
+    }
+
 }
diff --git a/java/engine/org/apache/derby/impl/services/bytecode/BCJava.java b/java/engine/org/apache/derby/impl/services/bytecode/BCJava.java
index 9cb787bfd..b72172977 100644
--- a/java/engine/org/apache/derby/impl/services/bytecode/BCJava.java
+++ b/java/engine/org/apache/derby/impl/services/bytecode/BCJava.java
@@ -42,6 +42,9 @@ import org.apache.derby.shared.common.sanity.SanityManager;
 
 import org.apache.derby.iapi.services.classfile.VMDescriptor;
 
+import java.security.AccessController;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.util.Properties;
 import java.util.Hashtable;
 
@@ -160,8 +163,7 @@ public class BCJava implements JavaFactory, CacheableFactory, ModuleControl {
 	 */
 	public void boot(boolean create, Properties properties) throws StandardException {
 
-		CacheFactory cf =
-			(CacheFactory) Monitor.startSystemModule(org.apache.derby.iapi.reference.Module.CacheFactory);
+        CacheFactory cf = (CacheFactory) startSystemModule( org.apache.derby.iapi.reference.Module.CacheFactory );
 
 		/*
 		** The initial and maximum cache sizes are based on experiments
@@ -319,4 +321,31 @@ public class BCJava implements JavaFactory, CacheableFactory, ModuleControl {
 		}
 		return BCExpr.vm_void;
 	}
+
+    
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object  startSystemModule( final String factoryInterface )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.startSystemModule( factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
 }
diff --git a/java/engine/org/apache/derby/impl/services/cache/ConcurrentCache.java b/java/engine/org/apache/derby/impl/services/cache/ConcurrentCache.java
index aed664b20..309f8582c 100644
--- a/java/engine/org/apache/derby/impl/services/cache/ConcurrentCache.java
+++ b/java/engine/org/apache/derby/impl/services/cache/ConcurrentCache.java
@@ -21,6 +21,8 @@
 
 package org.apache.derby.impl.services.cache;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.util.ArrayList;
 import java.util.Collection;
 import java.util.concurrent.ConcurrentHashMap;
@@ -716,7 +718,7 @@ final class ConcurrentCache implements CacheManager {
         }
 
         ManagementService managementService =
-                (ManagementService) Monitor.getSystemModule(Module.JMX);
+                (ManagementService) getSystemModule(Module.JMX);
 
         if (managementService != null) {
             mbean = managementService.registerMBean(
@@ -731,7 +733,7 @@ final class ConcurrentCache implements CacheManager {
     public void deregisterMBean() {
         if (mbean != null) {
             ManagementService managementService =
-                (ManagementService) Monitor.getSystemModule(Module.JMX);
+                (ManagementService) getSystemModule(Module.JMX);
             if (managementService != null) {
                 managementService.unregisterMBean(mbean);
             }
@@ -799,4 +801,23 @@ final class ConcurrentCache implements CacheManager {
     long getUsedEntries() {
         return cache.size();
     }
+    
+    /**
+     * Privileged module lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object getSystemModule( final String factoryInterface )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.getSystemModule( factoryInterface );
+                 }
+             }
+             );
+    }
+
 }
diff --git a/java/engine/org/apache/derby/impl/services/daemon/BasicDaemon.java b/java/engine/org/apache/derby/impl/services/daemon/BasicDaemon.java
index 198be8189..ade73821a 100644
--- a/java/engine/org/apache/derby/impl/services/daemon/BasicDaemon.java
+++ b/java/engine/org/apache/derby/impl/services/daemon/BasicDaemon.java
@@ -728,7 +728,7 @@ public class BasicDaemon implements DaemonService, Runnable
 		}
 		else
 		{
-			ModuleFactory mf = Monitor.getMonitor();
+			ModuleFactory mf = getMonitor();
             setThreadPriority(mf, Thread.MIN_PRIORITY);
 			Thread.yield();
             setThreadPriority(mf, oldPriority);
@@ -752,4 +752,23 @@ public class BasicDaemon implements DaemonService, Runnable
             });
         }
     }
+    
+    /**
+     * Privileged Monitor lookup. Must be package private so that user code
+     * can't call this entry point.
+     */
+    static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
 }
diff --git a/java/engine/org/apache/derby/impl/services/daemon/IndexStatisticsDaemonImpl.java b/java/engine/org/apache/derby/impl/services/daemon/IndexStatisticsDaemonImpl.java
index ff321621f..963715442 100644
--- a/java/engine/org/apache/derby/impl/services/daemon/IndexStatisticsDaemonImpl.java
+++ b/java/engine/org/apache/derby/impl/services/daemon/IndexStatisticsDaemonImpl.java
@@ -282,7 +282,7 @@ public class IndexStatisticsDaemonImpl
                 if (runningThread == null) {
                     //DERBY-5582. Make sure the thread is in the derby group
                     // to avoid potential security manager issues
-                    runningThread = Monitor.getMonitor().getDaemonThread(this, "index-stat-thread", false);
+                    runningThread = BasicDaemon.getMonitor().getDaemonThread(this, "index-stat-thread", false);
                     runningThread.start();
                 }
             }
diff --git a/java/engine/org/apache/derby/impl/services/daemon/SingleThreadDaemonFactory.java b/java/engine/org/apache/derby/impl/services/daemon/SingleThreadDaemonFactory.java
index 39ad56e49..239b957c8 100644
--- a/java/engine/org/apache/derby/impl/services/daemon/SingleThreadDaemonFactory.java
+++ b/java/engine/org/apache/derby/impl/services/daemon/SingleThreadDaemonFactory.java
@@ -49,7 +49,7 @@ public class SingleThreadDaemonFactory implements DaemonFactory
 	{
 		BasicDaemon daemon = new BasicDaemon(contextService);
 
-		final Thread daemonThread = Monitor.getMonitor().getDaemonThread(daemon, name, false);
+		final Thread daemonThread = BasicDaemon.getMonitor().getDaemonThread(daemon, name, false);
 		// DERBY-3745.  setContextClassLoader for thread to null to avoid
 		// leaking class loaders.
 		try {
diff --git a/java/engine/org/apache/derby/impl/services/jmx/JMXManagementService.java b/java/engine/org/apache/derby/impl/services/jmx/JMXManagementService.java
index 21b89a289..70a904461 100644
--- a/java/engine/org/apache/derby/impl/services/jmx/JMXManagementService.java
+++ b/java/engine/org/apache/derby/impl/services/jmx/JMXManagementService.java
@@ -43,6 +43,7 @@ import org.apache.derby.iapi.reference.Property;
 import org.apache.derby.iapi.services.info.Version;
 import org.apache.derby.iapi.services.jmx.ManagementService;
 import org.apache.derby.iapi.services.monitor.ModuleControl;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.iapi.services.property.PropertyUtil;
 import org.apache.derby.mbeans.ManagementMBean;
@@ -113,7 +114,7 @@ public final class JMXManagementService implements ManagementService, ModuleCont
         registeredMbeans = new HashMap<ObjectName,StandardMBean>();
         
         systemIdentifier =
-            Monitor.getMonitor().getUUIDFactory().createUUID().toString();
+            getMonitor().getUUIDFactory().createUUID().toString();
         
         findServer();
              
@@ -124,7 +125,7 @@ public final class JMXManagementService implements ManagementService, ModuleCont
         
         registerMBean(
                 new Version(
-                        Monitor.getMonitor().getEngineVersion(),
+                        getMonitor().getEngineVersion(),
                         SystemPermission.ENGINE),
                 VersionMBean.class,
                 "type=Version,jar=derby.jar");
@@ -429,4 +430,23 @@ public final class JMXManagementService implements ManagementService, ModuleCont
     public String quotePropertyValue(String value) {
         return ObjectName.quote(value);
     }
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
 }
diff --git a/java/engine/org/apache/derby/impl/services/monitor/BaseMonitor.java b/java/engine/org/apache/derby/impl/services/monitor/BaseMonitor.java
index 6cf279953..707c00a2c 100644
--- a/java/engine/org/apache/derby/impl/services/monitor/BaseMonitor.java
+++ b/java/engine/org/apache/derby/impl/services/monitor/BaseMonitor.java
@@ -201,7 +201,6 @@ abstract class BaseMonitor
 		(services.get(0)).shutdown();
 
 		stopContextService();
-		Monitor.clearMonitor();
 	}
 
 	/**
@@ -245,8 +244,7 @@ abstract class BaseMonitor
 
 		// if monitor is already set then the system is already
 		// booted or in the process of booting or shutting down.
-		if (!Monitor.setMonitor(this))
-			return;
+		if ( setMonitor( this ) ) { return; }
 
 		MessageService.setFinder(this);
 
@@ -2088,23 +2086,16 @@ nextModule:
      */
     private  static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
-        {
-            return ContextService.getFactory();
-        }
-        else
-        {
-            return AccessController.doPrivileged
-                (
-                 new PrivilegedAction<ContextService>()
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
                  {
-                     public ContextService run()
-                     {
-                         return ContextService.getFactory();
-                     }
+                     return ContextService.getFactory();
                  }
-                 );
-        }
+             }
+             );
     }    
 
     /**
@@ -2113,27 +2104,40 @@ nextModule:
      */
     private  static  void    stopContextService()
     {
-        if ( System.getSecurityManager() == null )
-        {
-            ContextService.stop();
-        }
-        else
-        {
-            AccessController.doPrivileged
-                (
-                 new PrivilegedAction<Object>()
+        AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
                  {
-                     public Object run()
-                     {
-                         ContextService.stop();
-                         return null;
-                     }
+                     ContextService.stop();
+                     Monitor.clearMonitor();
+                     return null;
                  }
-                 );
-        }
+             }
+             );
     }    
 
-	/**
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point. Returns true if the system is
+     * already booted or in the process of shutting down.
+     */
+    private  static  boolean    setMonitor( final BaseMonitor baseMonitor )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Boolean>()
+             {
+                 public Boolean run()
+                 {
+                     return !Monitor.setMonitor( baseMonitor );
+                 }
+             }
+             ).booleanValue();
+    }
+
+    /**
 		Initialize the monitor wrt the current environemnt.
 		Returns false if the monitor cannot be initialized, true otherwise.
 	*/
diff --git a/java/engine/org/apache/derby/impl/services/monitor/StorageFactoryService.java b/java/engine/org/apache/derby/impl/services/monitor/StorageFactoryService.java
index 53e9d03ff..a96a51038 100644
--- a/java/engine/org/apache/derby/impl/services/monitor/StorageFactoryService.java
+++ b/java/engine/org/apache/derby/impl/services/monitor/StorageFactoryService.java
@@ -26,6 +26,7 @@ import org.apache.derby.iapi.reference.SQLState;
 
 import org.apache.derby.iapi.services.i18n.MessageService;
 
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.iapi.services.monitor.PersistentService;
 import org.apache.derby.shared.common.sanity.SanityManager;
@@ -87,7 +88,7 @@ final class StorageFactoryService implements PersistentService
         this.subSubProtocol = subSubProtocol;
         this.storageFactoryClass = storageFactoryClass;
 
-        Object monitorEnv = Monitor.getMonitor().getEnvironment();
+        Object monitorEnv = getMonitor().getEnvironment();
 		if (monitorEnv instanceof File)
         {
             final File relativeRoot = (File) monitorEnv;
@@ -1046,6 +1047,24 @@ final class StorageFactoryService implements PersistentService
         }
     }
     
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
     final class DirectoryList implements Enumeration, PrivilegedAction<DirectoryList>
     {
         private String[] contents;
diff --git a/java/engine/org/apache/derby/impl/services/reflect/DatabaseClasses.java b/java/engine/org/apache/derby/impl/services/reflect/DatabaseClasses.java
index 73657c520..801be6f3f 100644
--- a/java/engine/org/apache/derby/impl/services/reflect/DatabaseClasses.java
+++ b/java/engine/org/apache/derby/impl/services/reflect/DatabaseClasses.java
@@ -26,6 +26,7 @@ import java.io.FileOutputStream;
 import java.io.IOException;
 import java.io.ObjectStreamClass;
 import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.security.PrivilegedActionException;
 import java.security.PrivilegedExceptionAction;
 import java.util.Properties;
@@ -38,6 +39,7 @@ import org.apache.derby.iapi.services.loader.ClassFactory;
 import org.apache.derby.iapi.services.loader.ClassInspector;
 import org.apache.derby.iapi.services.loader.GeneratedClass;
 import org.apache.derby.iapi.services.monitor.ModuleControl;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.shared.common.sanity.SanityManager;
 import org.apache.derby.iapi.services.stream.HeaderPrintWriter;
@@ -168,7 +170,7 @@ abstract class DatabaseClasses
         int lastDot = fullyQualifiedName.lastIndexOf((int)'.');
         String filename = fullyQualifiedName.substring(lastDot+1,fullyQualifiedName.length()).concat(".class");
 
-		Object env = Monitor.getMonitor().getEnvironment();
+		Object env = getMonitor().getEnvironment();
 		File dir = env instanceof File ? (File) env : null;
 
         final File classFile = new File(dir, filename);
@@ -304,4 +306,23 @@ abstract class DatabaseClasses
 	*/
 
 	abstract LoadedGeneratedClass loadGeneratedClassFromData(String fullyQualifiedName, ByteArray classDump); 
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
 }
diff --git a/java/engine/org/apache/derby/impl/services/reflect/UpdateLoader.java b/java/engine/org/apache/derby/impl/services/reflect/UpdateLoader.java
index 87eed30dd..267cd59ea 100644
--- a/java/engine/org/apache/derby/impl/services/reflect/UpdateLoader.java
+++ b/java/engine/org/apache/derby/impl/services/reflect/UpdateLoader.java
@@ -102,7 +102,7 @@ final class UpdateLoader implements LockOwner {
 
         this.normalizeToUpper = normalizeToUpper;
 		this.parent = parent;
-		lf = (LockFactory) Monitor.getServiceModule(parent, Module.LockFactory);
+		lf = (LockFactory) getServiceModule(parent, Module.LockFactory);
 		compat = (lf != null) ? lf.createCompatibilitySpace(this) : null;
 
 		if (verbose) {
@@ -434,24 +434,36 @@ final class UpdateLoader implements LockOwner {
      */
     private  static  Context    getContextOrNull( final String contextID )
     {
-        if ( System.getSecurityManager() == null )
-        {
-            return ContextService.getContextOrNull( contextID );
-        }
-        else
-        {
-            return AccessController.doPrivileged
-                (
-                 new PrivilegedAction<Context>()
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Context>()
+             {
+                 public Context run()
                  {
-                     public Context run()
-                     {
-                         return ContextService.getContextOrNull( contextID );
-                     }
+                     return ContextService.getContextOrNull( contextID );
                  }
-                 );
-        }
+             }
+             );
     }
+    
+    /**
+     * Privileged module lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object getServiceModule( final Object serviceModule, final String factoryInterface )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.getServiceModule( serviceModule, factoryInterface );
+                 }
+             }
+             );
+    }
+
 }
 
 
diff --git a/java/engine/org/apache/derby/impl/services/stream/SingleStream.java b/java/engine/org/apache/derby/impl/services/stream/SingleStream.java
index 441b0a80a..87e2f6a1d 100644
--- a/java/engine/org/apache/derby/impl/services/stream/SingleStream.java
+++ b/java/engine/org/apache/derby/impl/services/stream/SingleStream.java
@@ -26,6 +26,7 @@ import org.apache.derby.iapi.services.stream.HeaderPrintWriter;
 import org.apache.derby.iapi.services.stream.PrintWriterGetHeader;
 
 import org.apache.derby.iapi.services.monitor.ModuleControl;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 
 import org.apache.derby.iapi.reference.Property;
@@ -38,6 +39,9 @@ import java.io.OutputStream;
 import java.io.File;
 import java.io.Writer;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
+
 import java.util.Properties;
 
 import java.lang.reflect.Method;
@@ -189,7 +193,7 @@ implements InfoStreams, ModuleControl, java.security.PrivilegedAction<HeaderPrin
 
 		// See if this needs to be made relative to something ...
 		if (!streamFile.isAbsolute()) {
-			Object monitorEnv = Monitor.getMonitor().getEnvironment();
+			Object monitorEnv = getMonitor().getEnvironment();
 			if (monitorEnv instanceof File)
 				streamFile = new File((File) monitorEnv, fileName);
 		}
@@ -400,5 +404,24 @@ implements InfoStreams, ModuleControl, java.security.PrivilegedAction<HeaderPrin
         // SECURITY PERMISSION - OP4, OP5
         return PBmakeFileHPW(PBfileName, PBheader);
     }
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
 }
 
diff --git a/java/engine/org/apache/derby/impl/services/uuid/BasicUUIDFactory.java b/java/engine/org/apache/derby/impl/services/uuid/BasicUUIDFactory.java
index 586679964..972f522b1 100644
--- a/java/engine/org/apache/derby/impl/services/uuid/BasicUUIDFactory.java
+++ b/java/engine/org/apache/derby/impl/services/uuid/BasicUUIDFactory.java
@@ -21,6 +21,10 @@
 
 package org.apache.derby.impl.services.uuid;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
+
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.catalog.UUID;
 import org.apache.derby.iapi.services.uuid.UUIDFactory;
@@ -66,7 +70,7 @@ public final class BasicUUIDFactory
 	private long timemillis;
 
 	public BasicUUIDFactory() {
-		Object env = Monitor.getMonitor().getEnvironment();
+		Object env = getMonitor().getEnvironment();
 		if (env != null) {
 			String s = env.toString();
 			if (s != null)
@@ -154,5 +158,24 @@ public final class BasicUUIDFactory
 		timemillis = System.currentTimeMillis();
 		currentValue = INITIAL_VALUE;
 	}
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
 }
 
diff --git a/java/engine/org/apache/derby/impl/sql/GenericLanguageFactory.java b/java/engine/org/apache/derby/impl/sql/GenericLanguageFactory.java
index 6fddcc869..4ffcc7e1f 100644
--- a/java/engine/org/apache/derby/impl/sql/GenericLanguageFactory.java
+++ b/java/engine/org/apache/derby/impl/sql/GenericLanguageFactory.java
@@ -39,6 +39,9 @@ import org.apache.derby.iapi.services.loader.ClassInspector;
 
 import org.apache.derby.iapi.services.io.FormatIdUtil;
 
+import java.security.AccessController;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.util.Properties;
 
 /**
@@ -69,7 +72,7 @@ public class GenericLanguageFactory implements LanguageFactory, ModuleControl
 	 */
 	public void boot(boolean create, Properties startParams) throws StandardException 
 	{		
-		LanguageConnectionFactory lcf = (LanguageConnectionFactory)  Monitor.findServiceModule(this, LanguageConnectionFactory.MODULE);
+		LanguageConnectionFactory lcf = (LanguageConnectionFactory)  findServiceModule(this, LanguageConnectionFactory.MODULE);
 		PropertyFactory pf = lcf.getPropertyFactory();
 		if (pf != null)
 			pf.addPropertySetNotification(new LanguageDbPropertySetter());
@@ -140,4 +143,29 @@ public class GenericLanguageFactory implements LanguageFactory, ModuleControl
 	** when we make putResultSets available for users'
 	** server-side JDBC methods.
 	*/
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object findServiceModule( final Object serviceModule, final String factoryInterface)
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.findServiceModule( serviceModule, factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
 }
diff --git a/java/engine/org/apache/derby/impl/sql/GenericPreparedStatement.java b/java/engine/org/apache/derby/impl/sql/GenericPreparedStatement.java
index 69a6c2f3b..95593f3bb 100644
--- a/java/engine/org/apache/derby/impl/sql/GenericPreparedStatement.java
+++ b/java/engine/org/apache/derby/impl/sql/GenericPreparedStatement.java
@@ -38,6 +38,7 @@ import org.apache.derby.iapi.services.context.ContextManager;
 import org.apache.derby.iapi.services.context.ContextService;
 import org.apache.derby.iapi.services.io.ArrayUtil;
 import org.apache.derby.iapi.services.loader.GeneratedClass;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.shared.common.sanity.SanityManager;
 import org.apache.derby.iapi.services.stream.HeaderPrintWriter;
@@ -182,7 +183,7 @@ public class GenericPreparedStatement
 	GenericPreparedStatement() {
 		/* Get the UUID for this prepared statement */
 		UUIDFactory uuidFactory = 
-			Monitor.getMonitor().getUUIDFactory();
+			getMonitor().getUUIDFactory();
 
 		UUIDValue = uuidFactory.createUUID();
 		UUIDString = UUIDValue.toString();
@@ -1401,23 +1402,35 @@ recompileOutOfDatePlan:
      */
     private  static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
-        {
-            return ContextService.getFactory();
-        }
-        else
-        {
-            return AccessController.doPrivileged
-                (
-                 new PrivilegedAction<ContextService>()
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
                  {
-                     public ContextService run()
-                     {
-                         return ContextService.getFactory();
-                     }
+                     return ContextService.getFactory();
                  }
-                 );
-        }
+             }
+             );
+    }
+
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
     }
 
 }
diff --git a/java/engine/org/apache/derby/impl/sql/catalog/DD_Version.java b/java/engine/org/apache/derby/impl/sql/catalog/DD_Version.java
index 77e530df5..8e4634a4e 100644
--- a/java/engine/org/apache/derby/impl/sql/catalog/DD_Version.java
+++ b/java/engine/org/apache/derby/impl/sql/catalog/DD_Version.java
@@ -40,6 +40,9 @@ import org.apache.derby.iapi.util.IdUtil;
 import java.io.IOException;
 import java.io.ObjectInput;
 import java.io.ObjectOutput;
+import java.security.AccessController;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.util.HashSet;
 import java.util.Properties;
 
@@ -192,7 +195,7 @@ public	class DD_Version implements	Formatable
 
 		} else {
            
-			if (Monitor.isFullUpgrade(startParams, dictionaryVersion.toString())) {
+			if (isFullUpgrade(startParams, dictionaryVersion.toString())) {
 				performMajorUpgrade = true;
 			} else {
 				softUpgradeRun = true;
@@ -724,7 +727,7 @@ public	class DD_Version implements	Formatable
 	 */
 	private int getJBMSMinorVersionNumber() 
 	{
-		ProductVersionHolder jbmsVersion = Monitor.getMonitor().getEngineVersion();
+		ProductVersionHolder jbmsVersion = DataDictionaryImpl.getMonitor().getEngineVersion();
 
 		return jbmsVersion.getMinorVersion()*100 +jbmsVersion.getMaintVersion() + (jbmsVersion.isBeta() ? 0 : 1) + 2;
 	}
@@ -815,4 +818,29 @@ public	class DD_Version implements	Formatable
 		return true;
 	}
 
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  boolean isFullUpgrade( final Properties startParams, final String oldVersionInfo )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Boolean>()
+                 {
+                     public Boolean run()
+                         throws StandardException
+                     {
+                         return Monitor.isFullUpgrade( startParams, oldVersionInfo );
+                     }
+                 }
+                 ).booleanValue();
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
 }
diff --git a/java/engine/org/apache/derby/impl/sql/catalog/DataDictionaryImpl.java b/java/engine/org/apache/derby/impl/sql/catalog/DataDictionaryImpl.java
index 81b11fad4..cb63d1802 100644
--- a/java/engine/org/apache/derby/impl/sql/catalog/DataDictionaryImpl.java
+++ b/java/engine/org/apache/derby/impl/sql/catalog/DataDictionaryImpl.java
@@ -24,7 +24,9 @@ package org.apache.derby.impl.sql.catalog;
 import java.io.File;
 import java.io.IOException;
 import java.io.InputStream;
+import java.security.PrivilegedActionException;
 import java.security.PrivilegedAction;
+import java.security.PrivilegedExceptionAction;
 import java.security.AccessController;
 import java.security.MessageDigest;
 import java.security.NoSuchAlgorithmException;
@@ -75,6 +77,7 @@ import org.apache.derby.iapi.services.locks.LockFactory;
 import org.apache.derby.iapi.services.locks.ShExLockable;
 import org.apache.derby.iapi.services.locks.ShExQual;
 import org.apache.derby.iapi.services.monitor.ModuleControl;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.ModuleSupportable;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.iapi.services.property.PropertyUtil;
@@ -517,7 +520,7 @@ public final class	DataDictionaryImpl
 
 		startupParameters = startParams;
 
-		uuidFactory = Monitor.getMonitor().getUUIDFactory();
+		uuidFactory = getMonitor().getUUIDFactory();
 
 		engineType = Monitor.getEngineType( startParams );
 
@@ -534,11 +537,11 @@ public final class	DataDictionaryImpl
 		// REMIND: actually, we're supposed to get the DataValueFactory
 		// out of the connection context...this is a bit of a shortcut.
 		// We get the DataValueFactory early in order to help bootstrap the system catalogs.
-		LanguageConnectionFactory langConnFactory = (LanguageConnectionFactory) Monitor.bootServiceModule(
+		LanguageConnectionFactory langConnFactory = (LanguageConnectionFactory) bootServiceModule(
 			create, this, LanguageConnectionFactory.MODULE, startParams);
 
 		dvf = langConnFactory.getDataValueFactory();
-		exFactory = (ExecutionFactory) Monitor.bootServiceModule(
+		exFactory = (ExecutionFactory) bootServiceModule(
 														create, this,
 														ExecutionFactory.MODULE,
 														startParams);
@@ -662,7 +665,7 @@ public final class	DataDictionaryImpl
 		 * Get the table descriptor cache.
 		 */
 		CacheFactory cf =
-				(CacheFactory) Monitor.startSystemModule(org.apache.derby.iapi.reference.Module.CacheFactory);
+				(CacheFactory) startSystemModule(org.apache.derby.iapi.reference.Module.CacheFactory);
 		OIDTdCache =
 			cf.newCacheManager(this,
 				"TableDescriptorOIDCache",
@@ -694,7 +697,7 @@ public final class	DataDictionaryImpl
 		cacheCoordinator = new ShExLockable();
 
 		/* Get AccessFactory in order to transaction stuff */
-		af = (AccessFactory)  Monitor.findServiceModule(this, AccessFactory.MODULE);
+		af = (AccessFactory)  findServiceModule(this, AccessFactory.MODULE);
 
 		/* Get the lock factory */
 		lockFactory = af.getLockFactory();
@@ -931,7 +934,7 @@ public final class	DataDictionaryImpl
         if( permissionsCache == null)
         {
             CacheFactory cf =
-              (CacheFactory) Monitor.startSystemModule(org.apache.derby.iapi.reference.Module.CacheFactory);
+              (CacheFactory) startSystemModule(org.apache.derby.iapi.reference.Module.CacheFactory);
             LanguageConnectionContext lcc = getLCC();
             TransactionController tc = lcc.getTransactionExecute();
             permissionsCacheSize = PropertyUtil.getServiceInt( tc,
@@ -14578,22 +14581,115 @@ public final class	DataDictionaryImpl
      */
     private  static  Context    getContext( final String contextID )
     {
-        if ( System.getSecurityManager() == null )
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Context>()
+             {
+                 public Context run()
+                 {
+                     return ContextService.getContext( contextID );
+                 }
+             }
+             );
+    }
+    
+    /**
+     * Privileged Monitor lookup. Must be package private so that user code
+     * can't call this entry point.
+     */
+    static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
+    
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object  startSystemModule( final String factoryInterface )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.startSystemModule( factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
         {
-            return ContextService.getContext( contextID );
+            throw StandardException.plainWrapException( pae );
         }
-        else
+    }
+
+    
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object bootServiceModule
+        (
+         final boolean create, final Object serviceModule,
+         final String factoryInterface, final Properties properties
+         )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.bootServiceModule( create, serviceModule, factoryInterface, properties );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
         {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object findServiceModule( final Object serviceModule, final String factoryInterface)
+        throws StandardException
+    {
+        try {
             return AccessController.doPrivileged
                 (
-                 new PrivilegedAction<Context>()
+                 new PrivilegedExceptionAction<Object>()
                  {
-                     public Context run()
+                     public Object run()
+                         throws StandardException
                      {
-                         return ContextService.getContext( contextID );
+                         return Monitor.findServiceModule( serviceModule, factoryInterface );
                      }
                  }
                  );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
         }
     }
+    
 }
diff --git a/java/engine/org/apache/derby/impl/sql/catalog/DropDependencyFilter.java b/java/engine/org/apache/derby/impl/sql/catalog/DropDependencyFilter.java
index 69631883a..eb8d5307e 100644
--- a/java/engine/org/apache/derby/impl/sql/catalog/DropDependencyFilter.java
+++ b/java/engine/org/apache/derby/impl/sql/catalog/DropDependencyFilter.java
@@ -140,7 +140,7 @@ public class DropDependencyFilter implements TupleFilter
 	{
 		if ( uuidFactory == null )
 		{
-			uuidFactory = Monitor.getMonitor().getUUIDFactory();
+			uuidFactory = DataDictionaryImpl.getMonitor().getUUIDFactory();
 		}
 		return	uuidFactory;
 	}
diff --git a/java/engine/org/apache/derby/impl/sql/compile/ConstraintDefinitionNode.java b/java/engine/org/apache/derby/impl/sql/compile/ConstraintDefinitionNode.java
index b2baf42e2..07dfe9a6f 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/ConstraintDefinitionNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/ConstraintDefinitionNode.java
@@ -21,11 +21,14 @@
 
 package	org.apache.derby.impl.sql.compile;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.util.Properties;
 import org.apache.derby.catalog.UUID;
 import org.apache.derby.iapi.error.StandardException;
 import org.apache.derby.iapi.reference.SQLState;
 import org.apache.derby.iapi.services.context.ContextManager;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.shared.common.sanity.SanityManager;
 import org.apache.derby.iapi.services.uuid.UUIDFactory;
@@ -497,7 +500,7 @@ public class ConstraintDefinitionNode extends TableElementNode
 	{
 		if ( uuidFactory == null )
 		{
-			uuidFactory = Monitor.getMonitor().getUUIDFactory();
+			uuidFactory = getMonitor().getUUIDFactory();
 		}
 		return	uuidFactory;
 	}
@@ -539,4 +542,23 @@ public class ConstraintDefinitionNode extends TableElementNode
 
         constraintText = sb.toString();
     }
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
 }
diff --git a/java/engine/org/apache/derby/impl/sql/conn/GenericLanguageConnectionFactory.java b/java/engine/org/apache/derby/impl/sql/conn/GenericLanguageConnectionFactory.java
index d78b0fb08..0c30ee632 100644
--- a/java/engine/org/apache/derby/impl/sql/conn/GenericLanguageConnectionFactory.java
+++ b/java/engine/org/apache/derby/impl/sql/conn/GenericLanguageConnectionFactory.java
@@ -54,6 +54,7 @@ import org.apache.derby.shared.common.sanity.SanityManager;
 
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.iapi.services.monitor.ModuleControl;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.ModuleSupportable;
 import org.apache.derby.iapi.services.context.ContextManager;
 
@@ -69,6 +70,10 @@ import org.apache.derby.iapi.reference.SQLState;
 import org.apache.derby.iapi.reference.Property;
 import org.apache.derby.iapi.reference.EngineType;
 
+import java.security.AccessController;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedAction;
+import java.security.PrivilegedExceptionAction;
 import java.util.Properties;
 import java.util.Dictionary;
 import java.io.Serializable;
@@ -286,26 +291,26 @@ public class GenericLanguageConnectionFactory
 		//booted DVF (DVF got booted by BasicDatabase's boot method. 
 		//BasicDatabase also set the correct Locale in the DVF. There after,
 		//DVF with correct Locale is available to rest of the Derby code.
-		dvf = (DataValueFactory) Monitor.bootServiceModule(create, this, org.apache.derby.iapi.reference.ClassName.DataValueFactory, startParams);
-		javaFactory = (JavaFactory) Monitor.startSystemModule(org.apache.derby.iapi.reference.Module.JavaFactory);
-		uuidFactory = Monitor.getMonitor().getUUIDFactory();
-		classFactory = (ClassFactory) Monitor.getServiceModule(this, org.apache.derby.iapi.reference.Module.ClassFactory);
+		dvf = (DataValueFactory) bootServiceModule(create, this, org.apache.derby.iapi.reference.ClassName.DataValueFactory, startParams);
+		javaFactory = (JavaFactory) startSystemModule(org.apache.derby.iapi.reference.Module.JavaFactory);
+		uuidFactory = getMonitor().getUUIDFactory();
+		classFactory = (ClassFactory) getServiceModule(this, org.apache.derby.iapi.reference.Module.ClassFactory);
 		if (classFactory == null)
- 			classFactory = (ClassFactory) Monitor.findSystemModule(org.apache.derby.iapi.reference.Module.ClassFactory);
+ 			classFactory = (ClassFactory) findSystemModule(org.apache.derby.iapi.reference.Module.ClassFactory);
 
 		//set the property validation module needed to do propertySetCallBack
 		//register and property validation
 		setValidation();
 
-		ef = (ExecutionFactory) Monitor.bootServiceModule(create, this, ExecutionFactory.MODULE, startParams);
-		of = (OptimizerFactory) Monitor.bootServiceModule(create, this, OptimizerFactory.MODULE, startParams);
+		ef = (ExecutionFactory) bootServiceModule(create, this, ExecutionFactory.MODULE, startParams);
+		of = (OptimizerFactory) bootServiceModule(create, this, OptimizerFactory.MODULE, startParams);
 		tcf =
-		   (TypeCompilerFactory) Monitor.startSystemModule(TypeCompilerFactory.MODULE);
+		   (TypeCompilerFactory) startSystemModule(TypeCompilerFactory.MODULE);
 
 		// If the system supports statement caching boot the CacheFactory module.
 		int cacheSize = statementCacheSize(startParams);
 		if (cacheSize > 0) {
-			CacheFactory cacheFactory = (CacheFactory) Monitor.startSystemModule(org.apache.derby.iapi.reference.Module.CacheFactory);
+			CacheFactory cacheFactory = (CacheFactory) startSystemModule(org.apache.derby.iapi.reference.Module.CacheFactory);
 			singleStatementCache = cacheFactory.newCacheManager(this,
 												"StatementCache",
 												cacheSize/4,
@@ -314,7 +319,7 @@ public class GenericLanguageConnectionFactory
             // Start a management bean for the statement cache to allow
             // monitoring through JMX, if it is available and enabled.
             DataFactory df = (DataFactory)
-                    Monitor.findServiceModule(this, DataFactory.MODULE);
+                    findServiceModule(this, DataFactory.MODULE);
             singleStatementCache.registerMBean(df.getRootDirectory());
 		}
 
@@ -413,7 +418,7 @@ public class GenericLanguageConnectionFactory
 	}
 
 	protected void setValidation() throws StandardException {
-		pf = (PropertyFactory) Monitor.findServiceModule(this,
+		pf = (PropertyFactory) findServiceModule(this,
 			org.apache.derby.iapi.reference.Module.PropertyFactory);
 		pf.addPropertySetNotification(this);
 	}
@@ -435,4 +440,148 @@ public class GenericLanguageConnectionFactory
 	{
 		return nextLCCInstanceNumber++;
 	}
+    
+    /**
+     * Privileged Monitor lookup. Must be package private so that user code
+     * can't call this entry point.
+     */
+    static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
+    
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object  startSystemModule( final String factoryInterface )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.startSystemModule( factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
+    
+    /**
+     * Privileged lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object  findSystemModule( final String factoryInterface )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.findSystemModule( factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
+    
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object bootServiceModule
+        (
+         final boolean create, final Object serviceModule,
+         final String factoryInterface, final Properties properties
+         )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.bootServiceModule( create, serviceModule, factoryInterface, properties );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object findServiceModule( final Object serviceModule, final String factoryInterface)
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.findServiceModule( serviceModule, factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
+    /**
+     * Privileged module lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object getServiceModule( final Object serviceModule, final String factoryInterface )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.getServiceModule( serviceModule, factoryInterface );
+                 }
+             }
+             );
+    }
+
 }
diff --git a/java/engine/org/apache/derby/impl/sql/conn/GenericStatementContext.java b/java/engine/org/apache/derby/impl/sql/conn/GenericStatementContext.java
index c43bb85ae..b71eb04b2 100644
--- a/java/engine/org/apache/derby/impl/sql/conn/GenericStatementContext.java
+++ b/java/engine/org/apache/derby/impl/sql/conn/GenericStatementContext.java
@@ -188,7 +188,7 @@ final class GenericStatementContext
     }
 
     private static TimerFactory getTimerFactory() {
-        return Monitor.getMonitor().getTimerFactory();
+        return GenericLanguageConnectionFactory.getMonitor().getTimerFactory();
     }
 
 	// StatementContext Interface
diff --git a/java/engine/org/apache/derby/impl/sql/execute/BaseActivation.java b/java/engine/org/apache/derby/impl/sql/execute/BaseActivation.java
index e0ffb3163..6d3950d79 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/BaseActivation.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/BaseActivation.java
@@ -21,6 +21,8 @@
 
 package org.apache.derby.impl.sql.execute;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.sql.Connection;
 import java.sql.SQLException;
 import java.sql.SQLWarning;
@@ -44,6 +46,7 @@ import org.apache.derby.iapi.services.io.FormatableBitSet;
 import org.apache.derby.iapi.services.loader.GeneratedByteCode;
 import org.apache.derby.iapi.services.loader.GeneratedClass;
 import org.apache.derby.iapi.services.loader.GeneratedMethod;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.iapi.services.property.PropertyUtil;
 import org.apache.derby.iapi.services.uuid.UUIDFactory;
@@ -254,7 +257,7 @@ public abstract class BaseActivation implements CursorActivation, GeneratedByteC
 
 		/* Get the UUID for this activation */
 		UUIDFactory uuidFactory =
-			Monitor.getMonitor().getUUIDFactory();
+			getMonitor().getUUIDFactory();
 
 		UUIDValue = uuidFactory.createUUID();
 		UUIDString = UUIDValue.toString();
@@ -1901,4 +1904,23 @@ public abstract class BaseActivation implements CursorActivation, GeneratedByteC
 							 LanguageConnectionContext lcc)
 			throws StandardException {
 	}
+    
+    /**
+     * Privileged Monitor lookup. Must be package private so that user code
+     * can't call this entry point.
+     */
+    static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
 }
diff --git a/java/engine/org/apache/derby/impl/sql/execute/GenericExecutionFactory.java b/java/engine/org/apache/derby/impl/sql/execute/GenericExecutionFactory.java
index b6b661a63..f4780763c 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/GenericExecutionFactory.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/GenericExecutionFactory.java
@@ -56,6 +56,9 @@ import org.apache.derby.iapi.services.loader.GeneratedMethod;
 import org.apache.derby.iapi.services.context.ContextManager;
 import org.apache.derby.catalog.UUID;
 import org.apache.derby.iapi.services.io.FormatableBitSet;
+import java.security.AccessController;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.util.Properties;
 import java.util.Vector;
 
@@ -154,7 +157,7 @@ public class GenericExecutionFactory
                     throws StandardException {
         if (rssFactory == null) {
             rssFactory = (ResultSetStatisticsFactory)
-                Monitor.bootServiceModule(
+                bootServiceModule(
                                     false,
                                     this,
                                     ResultSetStatisticsFactory.MODULE,
@@ -370,7 +373,7 @@ private XPLAINFactoryIF xplainFactory;
                    throws StandardException {
        if (xplainFactory == null) {
            xplainFactory = (XPLAINFactoryIF)
-               Monitor.bootServiceModule(
+               bootServiceModule(
                                    false,
                                    this,
                                    XPLAINFactoryIF.MODULE,
@@ -379,4 +382,34 @@ private XPLAINFactoryIF xplainFactory;
        return xplainFactory;
    }
 
+    
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object bootServiceModule
+        (
+         final boolean create, final Object serviceModule,
+         final String factoryInterface, final Properties properties
+         )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.bootServiceModule( create, serviceModule, factoryInterface, properties );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
 }
diff --git a/java/engine/org/apache/derby/impl/sql/execute/JarUtil.java b/java/engine/org/apache/derby/impl/sql/execute/JarUtil.java
index eb16bac48..cbbaaf0d2 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/JarUtil.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/JarUtil.java
@@ -144,7 +144,7 @@ public class JarUtil
         try {
             notifyLoader(false);
             dd.invalidateAllSPSPlans();
-            UUID id = Monitor.getMonitor().getUUIDFactory().createUUID();
+            UUID id = BaseActivation.getMonitor().getUUIDFactory().createUUID();
             final String jarExternalName = JarUtil.mkExternalName(
                 id, schemaName, sqlName, fr.getSeparatorChar());
 
diff --git a/java/engine/org/apache/derby/impl/store/access/PropertyConglomerate.java b/java/engine/org/apache/derby/impl/store/access/PropertyConglomerate.java
index 238df486e..82d5637f5 100644
--- a/java/engine/org/apache/derby/impl/store/access/PropertyConglomerate.java
+++ b/java/engine/org/apache/derby/impl/store/access/PropertyConglomerate.java
@@ -53,6 +53,9 @@ import org.apache.derby.iapi.store.raw.RawStoreFactory;
 import org.apache.derby.iapi.types.DataValueDescriptor;
 
 import java.io.Serializable;
+import java.security.AccessController;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.util.Dictionary;
 import java.util.Enumeration;
 import java.util.Hashtable;
@@ -450,7 +453,7 @@ class PropertyConglomerate
 			AccessFactory af = ((TransactionManager)tc).getAccessManager();
 
 			RawStoreFactory rsf = (RawStoreFactory)
-				Monitor.findServiceModule(af, RawStoreFactory.MODULE);
+				findServiceModule(af, RawStoreFactory.MODULE);
 
 			// remove secret key from properties list if possible
 			serviceProperties.remove(Attribute.BOOT_PASSWORD);
@@ -781,6 +784,31 @@ class PropertyConglomerate
 		Object csGroup = cs.getOwner();
 		return lf.isLockHeld(cs, csGroup, cachedLock, ShExQual.EX);
 	}
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object findServiceModule( final Object serviceModule, final String factoryInterface)
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.findServiceModule( serviceModule, factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
 }
 
 /**
diff --git a/java/engine/org/apache/derby/impl/store/access/RAMAccessManager.java b/java/engine/org/apache/derby/impl/store/access/RAMAccessManager.java
index 6acae540d..6abbd0446 100644
--- a/java/engine/org/apache/derby/impl/store/access/RAMAccessManager.java
+++ b/java/engine/org/apache/derby/impl/store/access/RAMAccessManager.java
@@ -35,6 +35,7 @@ import org.apache.derby.iapi.services.context.ContextService;
 import org.apache.derby.iapi.services.daemon.Serviceable;
 import org.apache.derby.iapi.services.locks.LockFactory;
 import org.apache.derby.iapi.services.monitor.ModuleControl;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.iapi.services.monitor.PersistentService;
 import org.apache.derby.iapi.services.property.PropertySetCallback;
@@ -68,6 +69,8 @@ import org.apache.derby.iapi.reference.SQLState;
 import org.apache.derby.iapi.reference.Attribute;
 
 import java.security.PrivilegedAction;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.security.AccessController;
 import java.util.Dictionary;
 import java.util.Enumeration;
@@ -436,7 +439,7 @@ public abstract class RAMAccessManager
     {
         // Get a cache factory to create the conglomerate cache.
 		CacheFactory cf = 
-            (CacheFactory) Monitor.startSystemModule(
+            (CacheFactory) startSystemModule(
                  org.apache.derby.iapi.reference.Module.CacheFactory);
 
         // Now create the conglomerate cache.
@@ -642,7 +645,7 @@ public abstract class RAMAccessManager
 
 		try {
 			factory = 
-               (MethodFactory) Monitor.bootServiceModule(
+               (MethodFactory) bootServiceModule(
                     false, this, MethodFactory.MODULE, 
                     impltype, conglomProperties);
 		} catch (StandardException se) {
@@ -866,12 +869,12 @@ public abstract class RAMAccessManager
         rawstore.createDataWarningFile();
 
         //creating readme in log directory
-        LogFactory logFactory =(LogFactory) Monitor.findServiceModule(this, rawstore.getLogFactoryModule());
+        LogFactory logFactory =(LogFactory) findServiceModule(this, rawstore.getLogFactoryModule());
         logFactory.createDataWarningFile();
 
         //creating readme in root database directory
-        DataFactory dataFactory =(DataFactory) Monitor.findServiceModule(this, rawstore.getDataFactoryModule());
-        PersistentService ps = Monitor.getMonitor().getServiceType(rawstore);
+        DataFactory dataFactory =(DataFactory) findServiceModule(this, rawstore.getDataFactoryModule());
+        PersistentService ps = getMonitor().getServiceType(rawstore);
         ps.createDataWarningFile(dataFactory.getStorageFactory());
     }
 	
@@ -1035,7 +1038,7 @@ public abstract class RAMAccessManager
 
         // Access depends on a Raw Store implementations.  Load it.
         //
-        rawstore = (RawStoreFactory) Monitor.bootServiceModule(
+        rawstore = (RawStoreFactory) bootServiceModule(
             create, this, RawStoreFactory.MODULE, serviceProperties);
 
 		// Note: we also boot this module here since we may start Derby
@@ -1044,7 +1047,7 @@ public abstract class RAMAccessManager
 		// /protocol/Database/Storage/Access/Interface/T_AccessFactory.java)
 		// If this module has already been booted by the JDBC layer, this will 
 		// have no effect at all.
-		Monitor.bootServiceModule(
+		bootServiceModule(
             create, this, org.apache.derby.iapi.reference.Module.PropertyFactory, 
             startParams);
 
@@ -1160,7 +1163,7 @@ public abstract class RAMAccessManager
 
         // set up the property validation
         pf = (PropertyFactory) 
-            Monitor.findServiceModule(
+            findServiceModule(
                 this, org.apache.derby.iapi.reference.Module.PropertyFactory);
 
         // set up the transaction properties.  On J9, over NFS, runing on a
@@ -1308,22 +1311,144 @@ public abstract class RAMAccessManager
      */
     private  static  Context    getContext( final String contextID )
     {
-        if ( System.getSecurityManager() == null )
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Context>()
+             {
+                 public Context run()
+                 {
+                     return ContextService.getContext( contextID );
+                 }
+             }
+             );
+    }
+
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
+    
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object  startSystemModule( final String factoryInterface )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.startSystemModule( factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
         {
-            return ContextService.getContext( contextID );
+            throw StandardException.plainWrapException( pae );
         }
-        else
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object bootServiceModule
+        (
+         final boolean create, final Object serviceModule,
+         final String factoryInterface, final Properties properties
+         )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.bootServiceModule( create, serviceModule, factoryInterface, properties );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object bootServiceModule
+        (
+         final boolean create, final Object serviceModule,
+         final String factoryInterface, final String identifier, final Properties properties
+         )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.bootServiceModule( create, serviceModule, factoryInterface, identifier, properties );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
         {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object findServiceModule( final Object serviceModule, final String factoryInterface)
+        throws StandardException
+    {
+        try {
             return AccessController.doPrivileged
                 (
-                 new PrivilegedAction<Context>()
+                 new PrivilegedExceptionAction<Object>()
                  {
-                     public Context run()
+                     public Object run()
+                         throws StandardException
                      {
-                         return ContextService.getContext( contextID );
+                         return Monitor.findServiceModule( serviceModule, factoryInterface );
                      }
                  }
                  );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
         }
     }
 
diff --git a/java/engine/org/apache/derby/impl/store/access/btree/index/B2IFactory.java b/java/engine/org/apache/derby/impl/store/access/btree/index/B2IFactory.java
index 40e2a252a..5d3c792e1 100644
--- a/java/engine/org/apache/derby/impl/store/access/btree/index/B2IFactory.java
+++ b/java/engine/org/apache/derby/impl/store/access/btree/index/B2IFactory.java
@@ -21,11 +21,14 @@
 
 package org.apache.derby.impl.store.access.btree.index;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.util.Properties;
 
 import org.apache.derby.iapi.reference.SQLState;
 
 import org.apache.derby.iapi.services.monitor.ModuleControl;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.shared.common.sanity.SanityManager;
 
@@ -322,7 +325,7 @@ public class B2IFactory implements ConglomerateFactory, ModuleControl
 	{
 		// Find the UUID factory.
 		UUIDFactory uuidFactory = 
-            Monitor.getMonitor().getUUIDFactory();
+            getMonitor().getUUIDFactory();
 
 		// Make a UUID that identifies this conglomerate's format.
 		formatUUID = uuidFactory.recreateUUID(FORMATUUIDSTRING);
@@ -331,4 +334,23 @@ public class B2IFactory implements ConglomerateFactory, ModuleControl
 	public void	stop()
 	{
 	}
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
 }
diff --git a/java/engine/org/apache/derby/impl/store/access/heap/HeapConglomerateFactory.java b/java/engine/org/apache/derby/impl/store/access/heap/HeapConglomerateFactory.java
index 480d74734..d6fb2334c 100644
--- a/java/engine/org/apache/derby/impl/store/access/heap/HeapConglomerateFactory.java
+++ b/java/engine/org/apache/derby/impl/store/access/heap/HeapConglomerateFactory.java
@@ -24,6 +24,7 @@ package org.apache.derby.impl.store.access.heap;
 import org.apache.derby.iapi.reference.SQLState;
 
 import org.apache.derby.iapi.services.monitor.ModuleControl;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.ModuleSupportable;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.shared.common.sanity.SanityManager;
@@ -50,6 +51,8 @@ import org.apache.derby.iapi.services.uuid.UUIDFactory;
 
 import org.apache.derby.catalog.UUID;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.util.Properties;
 
 // For JavaDoc references (i.e. @see)
@@ -309,7 +312,7 @@ public class HeapConglomerateFactory implements ConglomerateFactory, ModuleContr
 	{
 		// Find the UUID factory.
 		UUIDFactory uuidFactory = 
-            Monitor.getMonitor().getUUIDFactory();
+            getMonitor().getUUIDFactory();
 		
 		// Make a UUID that identifies this conglomerate's format.
 		formatUUID = uuidFactory.recreateUUID(FORMATUUIDSTRING);
@@ -326,5 +329,24 @@ public class HeapConglomerateFactory implements ConglomerateFactory, ModuleContr
 	public HeapConglomerateFactory()
 	{
 	}
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
 }
 
diff --git a/java/engine/org/apache/derby/impl/store/access/sort/ExternalSortFactory.java b/java/engine/org/apache/derby/impl/store/access/sort/ExternalSortFactory.java
index c89d6bccb..a05834279 100644
--- a/java/engine/org/apache/derby/impl/store/access/sort/ExternalSortFactory.java
+++ b/java/engine/org/apache/derby/impl/store/access/sort/ExternalSortFactory.java
@@ -21,9 +21,12 @@
 
 package org.apache.derby.impl.store.access.sort;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.util.Properties;
 
 import org.apache.derby.iapi.services.monitor.ModuleControl;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.ModuleSupportable;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.iapi.services.property.PropertyUtil;
@@ -356,7 +359,7 @@ public class ExternalSortFactory implements
 		throws StandardException
 	{
 		// Find the UUID factory.
-		UUIDFactory uuidFactory = Monitor.getMonitor().getUUIDFactory();
+		UUIDFactory uuidFactory = getMonitor().getUUIDFactory();
 
 		// Make a UUID that identifies this sort's format.
 		formatUUID = uuidFactory.recreateUUID(FORMATUUIDSTRING);
@@ -387,4 +390,23 @@ public class ExternalSortFactory implements
 	{
 	}
 
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
 }
diff --git a/java/engine/org/apache/derby/impl/store/raw/RawStore.java b/java/engine/org/apache/derby/impl/store/raw/RawStore.java
index f343aaac0..389e401c0 100644
--- a/java/engine/org/apache/derby/impl/store/raw/RawStore.java
+++ b/java/engine/org/apache/derby/impl/store/raw/RawStore.java
@@ -33,6 +33,7 @@ import org.apache.derby.iapi.services.locks.CompatibilitySpace;
 import org.apache.derby.iapi.services.locks.LockFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.iapi.services.monitor.ModuleControl;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.ModuleSupportable;
 import org.apache.derby.iapi.services.monitor.PersistentService;
 import org.apache.derby.shared.common.sanity.SanityManager;
@@ -70,6 +71,7 @@ import org.apache.derby.iapi.reference.Property;
 import java.security.AccessController;
 import java.security.PrivilegedAction;
 import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.security.SecureRandom;
 
 import java.util.Date;
@@ -181,14 +183,14 @@ public final class RawStore implements RawStoreFactory, ModuleControl, ModuleSup
         }
 
 		DaemonFactory daemonFactory =
-			(DaemonFactory)Monitor.startSystemModule(org.apache.derby.iapi.reference.Module.DaemonFactory);
+			(DaemonFactory)startSystemModule(org.apache.derby.iapi.reference.Module.DaemonFactory);
 		rawStoreDaemon = daemonFactory.createNewDaemon("rawStoreDaemon");
 		xactFactory = (TransactionFactory)
-					Monitor.bootServiceModule(
+					bootServiceModule(
 						create, this, getTransactionFactoryModule(), properties);
 
 		dataFactory = (DataFactory)
-					Monitor.bootServiceModule(
+					bootServiceModule(
 					  create, this, getDataFactoryModule(), properties);
 		storageFactory = dataFactory.getStorageFactory();
 
@@ -231,7 +233,7 @@ public final class RawStore implements RawStoreFactory, ModuleControl, ModuleSup
         }
         
 		// log factory is booted by the data factory
-		logFactory =(LogFactory) Monitor.findServiceModule(this, getLogFactoryModule());
+		logFactory =(LogFactory) findServiceModule(this, getLogFactoryModule());
 
 		// if this is a restore from backup, restore the jar files.
 		if(restoreFromBackup !=null)
@@ -328,7 +330,7 @@ public final class RawStore implements RawStoreFactory, ModuleControl, ModuleSup
             // Can now start slave replication by booting the
             // SlaveFactory service
             slaveFactory = (SlaveFactory) 
-                Monitor.bootServiceModule(create, this,
+                bootServiceModule(create, this,
                                           getSlaveFactoryModule(),
                                           properties);
             slaveFactory.startSlave(this, logFactory);
@@ -528,7 +530,7 @@ public final class RawStore implements RawStoreFactory, ModuleControl, ModuleSup
                                      replicationMode);
 
         MasterFactory masterFactory = (MasterFactory)
-            Monitor.bootServiceModule(true, this, getMasterFactoryModule(),
+            bootServiceModule(true, this, getMasterFactoryModule(),
                                       replicationProps);
         masterFactory.startMaster(this, dataFactory, logFactory,
                 host, port, dbmaster);
@@ -552,7 +554,7 @@ public final class RawStore implements RawStoreFactory, ModuleControl, ModuleSup
 
         try {
             masterFactory = (MasterFactory) 
-                Monitor.findServiceModule(this, getMasterFactoryModule());
+                findServiceModule(this, getMasterFactoryModule());
         }
         catch (StandardException se) {
             throw StandardException.newException(
@@ -575,7 +577,7 @@ public final class RawStore implements RawStoreFactory, ModuleControl, ModuleSup
 
         try {
             masterFactory = (MasterFactory) 
-                Monitor.findServiceModule(this, getMasterFactoryModule());
+                findServiceModule(this, getMasterFactoryModule());
         }
         catch (StandardException se) {
             throw StandardException.newException
@@ -874,9 +876,9 @@ public final class RawStore implements RawStoreFactory, ModuleControl, ModuleSup
             
             try 
             {
-                String name = Monitor.getMonitor().getServiceName(this);
+                String name = getServiceName(this);
                 PersistentService ps = 
-                    Monitor.getMonitor().getServiceType(this);
+                    getMonitor().getServiceType(this);
                 String fullName = ps.getCanonicalServiceName(name);
                 Properties prop = 
                     ps.getServiceProperties(fullName, (Properties)null);
@@ -1297,8 +1299,8 @@ public final class RawStore implements RawStoreFactory, ModuleControl, ModuleSup
             // for encrypted database, and this takes precedence over the
             // value specified by the user.
 
-            String name = Monitor.getMonitor().getServiceName(this);
-            PersistentService ps = Monitor.getMonitor().getServiceType(this);
+            String name = getServiceName(this);
+            PersistentService ps = getMonitor().getServiceType(this);
             String canonicalName = ps.getCanonicalServiceName(name);
             Properties serviceprops = ps.getServiceProperties(canonicalName,
                                                               (Properties)null);
@@ -1346,7 +1348,7 @@ public final class RawStore implements RawStoreFactory, ModuleControl, ModuleSup
             // properties.
 
             CipherFactoryBuilder cb = (CipherFactoryBuilder)
-                Monitor.startSystemModule(org.apache.derby.iapi.reference.Module.CipherFactoryBuilder);
+                startSystemModule(org.apache.derby.iapi.reference.Module.CipherFactoryBuilder);
 
             // create instance of the cipher factory with the
             // specified encryption properties.
@@ -2859,22 +2861,132 @@ public final class RawStore implements RawStoreFactory, ModuleControl, ModuleSup
      */
     private  static  Context    getContextOrNull( final String contextID )
     {
-        if ( System.getSecurityManager() == null )
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Context>()
+             {
+                 public Context run()
+                 {
+                     return ContextService.getContextOrNull( contextID );
+                 }
+             }
+             );
+    }
+
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
+
+    /**
+     * Privileged service name lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  String getServiceName( final Object serviceModule )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<String>()
+             {
+                 public String run()
+                 {
+                     return Monitor.getServiceName( serviceModule );
+                 }
+             }
+             );
+    }
+    
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object  startSystemModule( final String factoryInterface )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.startSystemModule( factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
         {
-            return ContextService.getContextOrNull( contextID );
+            throw StandardException.plainWrapException( pae );
         }
-        else
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object bootServiceModule
+        (
+         final boolean create, final Object serviceModule,
+         final String factoryInterface, final Properties properties
+         )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.bootServiceModule( create, serviceModule, factoryInterface, properties );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
         {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object findServiceModule( final Object serviceModule, final String factoryInterface)
+        throws StandardException
+    {
+        try {
             return AccessController.doPrivileged
                 (
-                 new PrivilegedAction<Context>()
+                 new PrivilegedExceptionAction<Object>()
                  {
-                     public Context run()
+                     public Object run()
+                         throws StandardException
                      {
-                         return ContextService.getContextOrNull( contextID );
+                         return Monitor.findServiceModule( serviceModule, factoryInterface );
                      }
                  }
                  );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
         }
     }
 
diff --git a/java/engine/org/apache/derby/impl/store/raw/data/BaseDataFileFactory.java b/java/engine/org/apache/derby/impl/store/raw/data/BaseDataFileFactory.java
index 9cf9aa90a..4171a26d6 100644
--- a/java/engine/org/apache/derby/impl/store/raw/data/BaseDataFileFactory.java
+++ b/java/engine/org/apache/derby/impl/store/raw/data/BaseDataFileFactory.java
@@ -35,6 +35,7 @@ import org.apache.derby.iapi.services.context.ContextManager;
 import org.apache.derby.iapi.services.daemon.DaemonService;
 import org.apache.derby.iapi.services.daemon.Serviceable;
 import org.apache.derby.iapi.services.monitor.ModuleControl;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.ModuleSupportable;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.iapi.services.monitor.PersistentService;
@@ -257,7 +258,7 @@ public class BaseDataFileFactory
         throws StandardException 
     {
 
-		jbmsVersion = Monitor.getMonitor().getEngineVersion();
+		jbmsVersion = getMonitor().getEngineVersion();
 		
 		jvmVersion = buildJvmVersion();
 		
@@ -267,11 +268,11 @@ public class BaseDataFileFactory
 
 		dataDirectory = startParams.getProperty(PersistentService.ROOT);
 
-		UUIDFactory uf = Monitor.getMonitor().getUUIDFactory();
+		UUIDFactory uf = getMonitor().getUUIDFactory();
 
 		identifier = uf.createUUID();
 
-        PersistentService ps = Monitor.getMonitor().getServiceType(this);
+        PersistentService ps = getMonitor().getServiceType(this);
 
         try
         {
@@ -415,7 +416,7 @@ public class BaseDataFileFactory
 
 
 		CacheFactory cf = (CacheFactory) 
-            Monitor.startSystemModule(
+            startSystemModule(
                 org.apache.derby.iapi.reference.Module.CacheFactory);
 
         // Initialize the page cache
@@ -1747,7 +1748,7 @@ public class BaseDataFileFactory
         }
 
 		logFactory = (LogFactory)
-			Monitor.bootServiceModule(
+			bootServiceModule(
                 create, this, 
                 rawStoreFactory.getLogFactoryModule(), startParams);
 	}
@@ -1762,7 +1763,7 @@ public class BaseDataFileFactory
         try
         {
             PersistentService ps = 
-                Monitor.getMonitor().getServiceProvider(type);
+                getMonitor().getServiceProvider(type);
             return ps != null && ps.hasStorageFactory();
         }
         catch (StandardException se)
@@ -2930,4 +2931,78 @@ public class BaseDataFileFactory
 		}
         return null;
     } // end of run
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
+    
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object  startSystemModule( final String factoryInterface )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.startSystemModule( factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object bootServiceModule
+        (
+         final boolean create, final Object serviceModule,
+         final String factoryInterface, final Properties properties
+         )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.bootServiceModule( create, serviceModule, factoryInterface, properties );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
 }
diff --git a/java/engine/org/apache/derby/impl/store/raw/data/D_DiagnosticUtil.java b/java/engine/org/apache/derby/impl/store/raw/data/D_DiagnosticUtil.java
index 8666c26ae..f86c737f4 100644
--- a/java/engine/org/apache/derby/impl/store/raw/data/D_DiagnosticUtil.java
+++ b/java/engine/org/apache/derby/impl/store/raw/data/D_DiagnosticUtil.java
@@ -21,6 +21,11 @@
 
 package org.apache.derby.impl.store.raw.data;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
+
 import org.apache.derby.iapi.services.context.ContextService;
 import org.apache.derby.iapi.services.diag.Diagnosticable;
 import org.apache.derby.iapi.services.diag.DiagnosticUtil;
@@ -82,19 +87,19 @@ public class D_DiagnosticUtil
     {
         Object   store_module = null;
 
-		Object db = Monitor.findService(Property.DATABASE_MODULE, db_name);
+		Object db = findService(Property.DATABASE_MODULE, db_name);
 
         // RESOLVE (mikem) - find a single way to find the current 
         // AccessFactory that works both for ij and unit tests.
         if (db == null)
         {
             // maybe it is a module test - try this hack:
-            store_module = Monitor.findService(AccessFactory.MODULE, db_name);
+            store_module = findService(AccessFactory.MODULE, db_name);
         }
         else
         {
             // Find the AccessFactory
-            store_module = Monitor.findServiceModule(db, AccessFactory.MODULE);
+            store_module = findServiceModule(db, AccessFactory.MODULE);
         }
 
         return(store_module);
@@ -241,7 +246,7 @@ public class D_DiagnosticUtil
 			Object module = getModuleFromDbName(db_name);
 
 			RawStoreFactory store_module = (RawStoreFactory)
-				Monitor.findServiceModule(module, RawStoreFactory.MODULE);
+				findServiceModule(module, RawStoreFactory.MODULE);
 
 			xact = store_module.startInternalTransaction
                 (FileContainer.getContextService().getCurrentContextManager());
@@ -325,7 +330,7 @@ public class D_DiagnosticUtil
 
         // Find the AccessFactory
         store_module = (AccessFactory) 
-            Monitor.getServiceModule(module, AccessFactory.MODULE);
+            getServiceModule(module, AccessFactory.MODULE);
 
         if (store_module != null)
         {
@@ -402,7 +407,7 @@ public class D_DiagnosticUtil
 
         // Find the AccessFactory
         store_module = (AccessFactory) 
-            Monitor.getServiceModule(module, AccessFactory.MODULE);
+            getServiceModule(module, AccessFactory.MODULE);
 
         if (store_module != null)
         {
@@ -435,4 +440,65 @@ public class D_DiagnosticUtil
         return(container_id);
     }
 
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object findServiceModule( final Object serviceModule, final String factoryInterface)
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.findServiceModule( serviceModule, factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
+    /**
+     * Privileged module lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object getServiceModule( final Object serviceModule, final String factoryInterface )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.getServiceModule( serviceModule, factoryInterface );
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged service lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object findService( final String factoryInterface, final String serviceName )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.findService( factoryInterface, serviceName );
+                 }
+             }
+             );
+    }
+    
 }
diff --git a/java/engine/org/apache/derby/impl/store/raw/data/FileContainer.java b/java/engine/org/apache/derby/impl/store/raw/data/FileContainer.java
index 68aaad83e..a024a7e80 100644
--- a/java/engine/org/apache/derby/impl/store/raw/data/FileContainer.java
+++ b/java/engine/org/apache/derby/impl/store/raw/data/FileContainer.java
@@ -1153,7 +1153,7 @@ abstract class FileContainer
 	{
 		// Need a TransactionController to get database/service wide properties.
 		AccessFactory af = (AccessFactory)
-			Monitor.getServiceModule(dataFactory, AccessFactory.MODULE);
+			getServiceModule(dataFactory, AccessFactory.MODULE);
 
 		// RESOLVE: sku defectid 2014
 		TransactionController tc = 
@@ -3557,22 +3557,33 @@ abstract class FileContainer
      */
     static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
-        {
-            return ContextService.getFactory();
-        }
-        else
-        {
-            return AccessController.doPrivileged
-                (
-                 new PrivilegedAction<ContextService>()
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
                  {
-                     public ContextService run()
-                     {
-                         return ContextService.getFactory();
-                     }
+                     return ContextService.getFactory();
                  }
-                 );
-        }
+             }
+             );
     }
+    /**
+     * Privileged module lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object getServiceModule( final Object serviceModule, final String factoryInterface )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.getServiceModule( serviceModule, factoryInterface );
+                 }
+             }
+             );
+    }
+
 }
diff --git a/java/engine/org/apache/derby/impl/store/raw/data/StreamFileContainer.java b/java/engine/org/apache/derby/impl/store/raw/data/StreamFileContainer.java
index a490aa479..bca757faf 100644
--- a/java/engine/org/apache/derby/impl/store/raw/data/StreamFileContainer.java
+++ b/java/engine/org/apache/derby/impl/store/raw/data/StreamFileContainer.java
@@ -404,7 +404,7 @@ class StreamFileContainer implements TypedFormat, PrivilegedExceptionAction<Obje
     {
 
 		AccessFactory af = (AccessFactory)
-			Monitor.getServiceModule(dataFactory, AccessFactory.MODULE);
+			getServiceModule(dataFactory, AccessFactory.MODULE);
 
 		TransactionController tc = 
             (af == null) ? 
@@ -1204,23 +1204,34 @@ class StreamFileContainer implements TypedFormat, PrivilegedExceptionAction<Obje
      */
     private  static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
-        {
-            return ContextService.getFactory();
-        }
-        else
-        {
-            return AccessController.doPrivileged
-                (
-                 new PrivilegedAction<ContextService>()
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
                  {
-                     public ContextService run()
-                     {
-                         return ContextService.getFactory();
-                     }
+                     return ContextService.getFactory();
                  }
-                 );
-        }
+             }
+             );
+    }
+
+    /**
+     * Privileged module lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object getServiceModule( final Object serviceModule, final String factoryInterface )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.getServiceModule( serviceModule, factoryInterface );
+                 }
+             }
+             );
     }
 
 }
diff --git a/java/engine/org/apache/derby/impl/store/raw/log/LogToFile.java b/java/engine/org/apache/derby/impl/store/raw/log/LogToFile.java
index 4b0b05b4c..2d4285bb0 100644
--- a/java/engine/org/apache/derby/impl/store/raw/log/LogToFile.java
+++ b/java/engine/org/apache/derby/impl/store/raw/log/LogToFile.java
@@ -35,6 +35,7 @@ import org.apache.derby.iapi.services.context.ContextManager;
 import org.apache.derby.iapi.services.context.ContextService;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.iapi.services.monitor.ModuleControl;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.ModuleSupportable;
 import org.apache.derby.iapi.services.monitor.PersistentService;
 import org.apache.derby.shared.common.sanity.SanityManager;
@@ -90,6 +91,7 @@ import java.net.MalformedURLException;
 import java.net.URL;
 import java.security.AccessController;
 import java.security.PrivilegedAction;
+import java.security.PrivilegedExceptionAction;
 import java.security.PrivilegedActionException;
 
 import java.util.Properties;
@@ -2670,7 +2672,7 @@ public final class LogToFile implements LogFactory, ModuleControl, ModuleSupport
 
 		if (upgradeNeeded)
 		{
-			if (Monitor.isFullUpgrade(startParams,
+			if (isFullUpgrade(startParams,
 				ProductVersionHolder.simpleVersionString(onDiskMajorVersion, onDiskMinorVersion, onDiskBeta))) {
 
 				onDiskMajorVersion = jbmsVersion.getMajorVersion();
@@ -3212,7 +3214,7 @@ public final class LogToFile implements LogFactory, ModuleControl, ModuleSupport
 												   LOG_BUFFER_SIZE_MIN, 
 												   LOG_BUFFER_SIZE_MAX, 
 												   DEFAULT_LOG_BUFFER_SIZE);
-		jbmsVersion = Monitor.getMonitor().getEngineVersion();
+		jbmsVersion = getMonitor().getEngineVersion();
 
 		
 		String logArchiveMode = 
@@ -3491,14 +3493,14 @@ public final class LogToFile implements LogFactory, ModuleControl, ModuleSupport
     {
         if( logDevice == null)
         {
-            DataFactory df = (DataFactory) Monitor.findServiceModule( this, DataFactory.MODULE);
+            DataFactory df = (DataFactory) findServiceModule( this, DataFactory.MODULE);
             logStorageFactory = (WritableStorageFactory) df.getStorageFactory();
         }
         else
         {
             try
             {
-                PersistentService ps = Monitor.getMonitor().getServiceType(this);
+                PersistentService ps = getMonitor().getServiceType(this);
                 logStorageFactory = (WritableStorageFactory) ps.getStorageFactoryInstance( false, logDevice, null, null);
             }
             catch( IOException ioe)
@@ -3704,7 +3706,7 @@ public final class LogToFile implements LogFactory, ModuleControl, ModuleSupport
 
 		// check to see if checkpointInterval and logSwitchInterval has changed
 		AccessFactory af = 
-            (AccessFactory)Monitor.getServiceModule(this, AccessFactory.MODULE);
+            (AccessFactory)getServiceModule(this, AccessFactory.MODULE);
 
 		try
 		{
@@ -4951,7 +4953,7 @@ public final class LogToFile implements LogFactory, ModuleControl, ModuleSupport
 		{
 			logArchived = true;
 			AccessFactory af = 
-            (AccessFactory)Monitor.getServiceModule(this, AccessFactory.MODULE);
+            (AccessFactory)getServiceModule(this, AccessFactory.MODULE);
 
 			if (af != null)
 			{
@@ -4967,7 +4969,7 @@ public final class LogToFile implements LogFactory, ModuleControl, ModuleSupport
 	public void disableLogArchiveMode() throws StandardException
 	{
 		AccessFactory af = 
-            (AccessFactory)Monitor.getServiceModule(this, AccessFactory.MODULE);
+            (AccessFactory)getServiceModule(this, AccessFactory.MODULE);
 		if (af != null)
 		{
 			TransactionController tc = null;
@@ -5962,23 +5964,104 @@ public final class LogToFile implements LogFactory, ModuleControl, ModuleSupport
      */
     private  static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
-        {
-            return ContextService.getFactory();
-        }
-        else
-        {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
+                 {
+                     return ContextService.getFactory();
+                 }
+             }
+             );
+    }
+
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object findServiceModule( final Object serviceModule, final String factoryInterface)
+        throws StandardException
+    {
+        try {
             return AccessController.doPrivileged
                 (
-                 new PrivilegedAction<ContextService>()
+                 new PrivilegedExceptionAction<Object>()
                  {
-                     public ContextService run()
+                     public Object run()
+                         throws StandardException
                      {
-                         return ContextService.getFactory();
+                         return Monitor.findServiceModule( serviceModule, factoryInterface );
                      }
                  }
                  );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
         }
     }
 
+    /**
+     * Privileged module lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object getServiceModule( final Object serviceModule, final String factoryInterface )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.getServiceModule( serviceModule, factoryInterface );
+                 }
+             }
+             );
+    }
+    
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  boolean isFullUpgrade( final Properties startParams, final String oldVersionInfo )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Boolean>()
+                 {
+                     public Boolean run()
+                         throws StandardException
+                     {
+                         return Monitor.isFullUpgrade( startParams, oldVersionInfo );
+                     }
+                 }
+                 ).booleanValue();
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
 }
+
+
diff --git a/java/engine/org/apache/derby/impl/store/raw/xact/XactFactory.java b/java/engine/org/apache/derby/impl/store/raw/xact/XactFactory.java
index a2319a6ff..84e731892 100644
--- a/java/engine/org/apache/derby/impl/store/raw/xact/XactFactory.java
+++ b/java/engine/org/apache/derby/impl/store/raw/xact/XactFactory.java
@@ -31,6 +31,7 @@ import org.apache.derby.iapi.services.daemon.Serviceable;
 import org.apache.derby.iapi.services.locks.CompatibilitySpace;
 import org.apache.derby.iapi.services.locks.LockFactory;
 import org.apache.derby.iapi.services.monitor.ModuleControl;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.ModuleSupportable;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.shared.common.sanity.SanityManager;
@@ -60,7 +61,9 @@ import org.apache.derby.iapi.error.StandardException;
 
 import org.apache.derby.iapi.util.InterruptStatus;
 
+import java.security.PrivilegedExceptionAction;
 import java.security.PrivilegedAction;
+import java.security.PrivilegedActionException;
 import java.security.AccessController;
 import java.util.Properties;
 import java.util.concurrent.atomic.AtomicLong;
@@ -121,11 +124,11 @@ public class XactFactory implements TransactionFactory, ModuleControl, ModuleSup
 		throws StandardException
 	{
 
-		uuidFactory = Monitor.getMonitor().getUUIDFactory();
+		uuidFactory = getMonitor().getUUIDFactory();
 
         /*
         dataValueFactory =  (DataValueFactory)
-            Monitor.findServiceModule(
+            findServiceModule(
                 this,
                 org.apache.derby.iapi.reference.ClassName.DataValueFactory);
         */
@@ -133,7 +136,7 @@ public class XactFactory implements TransactionFactory, ModuleControl, ModuleSup
             // happen in the unit tests.  Usually it is booted before store
             // booting is called.
             dataValueFactory = (DataValueFactory) 
-                Monitor.bootServiceModule(
+                bootServiceModule(
                     create, 
                     this,
                     org.apache.derby.iapi.reference.ClassName.DataValueFactory, 
@@ -143,7 +146,7 @@ public class XactFactory implements TransactionFactory, ModuleControl, ModuleSup
 		contextFactory = getContextService();
 
 		lockFactory = 
-            (LockFactory) Monitor.bootServiceModule(false, this,
+            (LockFactory) bootServiceModule(false, this,
 				org.apache.derby.iapi.reference.Module.LockFactory, properties);
 
 		
@@ -862,10 +865,10 @@ public class XactFactory implements TransactionFactory, ModuleControl, ModuleSup
 
 		// now its ok to look for the log and data factory
 		// log factory is booted by the data factory
-		logFactory = (LogFactory) Monitor.findServiceModule(this, rsf.getLogFactoryModule());
+		logFactory = (LogFactory) findServiceModule(this, rsf.getLogFactoryModule());
 
 		// data factory is booted by the raw store implementation
-		dataFactory = (DataFactory) Monitor.findServiceModule(this, rsf.getDataFactoryModule());
+		dataFactory = (DataFactory) findServiceModule(this, rsf.getDataFactoryModule());
 	}
 
 	/**
@@ -1170,22 +1173,88 @@ public class XactFactory implements TransactionFactory, ModuleControl, ModuleSup
      */
     private static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
+                 {
+                     return ContextService.getFactory();
+                 }
+             }
+             );
+    }
+
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object bootServiceModule
+        (
+         final boolean create, final Object serviceModule,
+         final String factoryInterface, final Properties properties
+         )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.bootServiceModule( create, serviceModule, factoryInterface, properties );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
         {
-            return ContextService.getFactory();
+            throw StandardException.plainWrapException( pae );
         }
-        else
-        {
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object findServiceModule( final Object serviceModule, final String factoryInterface)
+        throws StandardException
+    {
+        try {
             return AccessController.doPrivileged
                 (
-                 new PrivilegedAction<ContextService>()
+                 new PrivilegedExceptionAction<Object>()
                  {
-                     public ContextService run()
+                     public Object run()
+                         throws StandardException
                      {
-                         return ContextService.getFactory();
+                         return Monitor.findServiceModule( serviceModule, factoryInterface );
                      }
                  }
                  );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
         }
     }
 
diff --git a/java/engine/org/apache/derby/jdbc/BasicEmbeddedDataSource40.java b/java/engine/org/apache/derby/jdbc/BasicEmbeddedDataSource40.java
index f6ef20528..578d466c0 100644
--- a/java/engine/org/apache/derby/jdbc/BasicEmbeddedDataSource40.java
+++ b/java/engine/org/apache/derby/jdbc/BasicEmbeddedDataSource40.java
@@ -22,6 +22,8 @@
 package org.apache.derby.jdbc;
 
 import java.io.PrintWriter;
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.sql.Connection;
 import java.sql.Driver;
 import java.sql.DriverManager;
@@ -37,6 +39,7 @@ import org.apache.derby.iapi.reference.MessageId;
 import org.apache.derby.iapi.reference.Property;
 import org.apache.derby.iapi.reference.SQLState;
 import org.apache.derby.iapi.services.i18n.MessageService;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.impl.jdbc.Util;
 
@@ -856,9 +859,9 @@ public class BasicEmbeddedDataSource40
                     // if monitor is never setup by any ModuleControl,
                     // getMonitor returns null and no Derby database
                     // has been booted.
-                    if (Monitor.getMonitor() != null) {
+                    if (getMonitor() != null) {
                         database = (Database)
-                            Monitor.findService(Property.DATABASE_MODULE,
+                            findService(Property.DATABASE_MODULE,
                                                 dbName);
                     }
 
@@ -874,7 +877,7 @@ public class BasicEmbeddedDataSource40
 
                         // now try to find it again
                         database = (Database)
-                            Monitor.findService(Property.DATABASE_MODULE,
+                            findService(Property.DATABASE_MODULE,
                                                 dbName);
                     }
 
@@ -924,4 +927,47 @@ public class BasicEmbeddedDataSource40
             ( SQLState.NOT_IMPLEMENTED, "getParentLogger" );
     }
 
+    ////////////////////////////////////////////////////////////////////
+    //
+    // SECURITY
+    //
+    ////////////////////////////////////////////////////////////////////
+
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged service lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object findService( final String factoryInterface, final String serviceName )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.findService( factoryInterface, serviceName );
+                 }
+             }
+             );
+    }
+    
 }
diff --git a/java/engine/org/apache/derby/jdbc/InternalDriver.java b/java/engine/org/apache/derby/jdbc/InternalDriver.java
index bd9e38e9c..cfd059ce8 100644
--- a/java/engine/org/apache/derby/jdbc/InternalDriver.java
+++ b/java/engine/org/apache/derby/jdbc/InternalDriver.java
@@ -68,6 +68,7 @@ import org.apache.derby.iapi.services.i18n.MessageService;
 import org.apache.derby.iapi.services.io.FormatableProperties;
 import org.apache.derby.iapi.services.jmx.ManagementService;
 import org.apache.derby.iapi.services.monitor.ModuleControl;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.iapi.sql.ResultColumnDescriptor;
 import org.apache.derby.iapi.sql.ResultSet;
@@ -141,7 +142,7 @@ public class InternalDriver implements ModuleControl, Driver {
 		active = true;
         
         mbean = ((ManagementService)
-           Monitor.getSystemModule(Module.JMX)).registerMBean(
+           getSystemModule(Module.JMX)).registerMBean(
                    new JDBC(this),
                    JDBCMBean.class,
                    "type=JDBC");
@@ -158,7 +159,7 @@ public class InternalDriver implements ModuleControl, Driver {
 		}
         
         ((ManagementService)
-                Monitor.getSystemModule(Module.JMX)).unregisterMBean(
+                getSystemModule(Module.JMX)).unregisterMBean(
                         mbean);
 
 		active = false;
@@ -291,7 +292,7 @@ public class InternalDriver implements ModuleControl, Driver {
 					//final String user = IdUtil.getUserNameFromURLProps(finfo);
 					//checkShutdownPrivileges(user);
 
-					Monitor.getMonitor().shutdown();
+					getMonitor().shutdown();
 
 					throw Util.generateCsSQLException(
                                          SQLState.CLOUDSCAPE_SYSTEM_SHUTDOWN);
@@ -465,11 +466,11 @@ public class InternalDriver implements ModuleControl, Driver {
     }
 
 	public int getMajorVersion() {
-		return Monitor.getMonitor().getEngineVersion().getMajorVersion();
+		return getMonitor().getEngineVersion().getMajorVersion();
 	}
 	
 	public int getMinorVersion() {
-		return Monitor.getMonitor().getEngineVersion().getMinorVersion();
+		return getMonitor().getEngineVersion().getMinorVersion();
 	}
 
 	public boolean jdbcCompliant() {
@@ -632,7 +633,7 @@ public class InternalDriver implements ModuleControl, Driver {
 		//
 		if (this.authenticationService == null) {
 			this.authenticationService = (AuthenticationService)
-				Monitor.findService(AuthenticationService.MODULE,
+				findService(AuthenticationService.MODULE,
 									"authentication"
 								   );
 		}
@@ -904,7 +905,7 @@ public class InternalDriver implements ModuleControl, Driver {
                 optionsNoDB[attrIndex].description = MessageService.getTextMessage(connStringAttributes[i][1]);
             }
 
-            optionsNoDB[0].choices = Monitor.getMonitor().getServiceList(Property.DATABASE_MODULE);
+            optionsNoDB[0].choices = getMonitor().getServiceList(Property.DATABASE_MODULE);
             // since database name is not stored in FormatableProperties, we
             // assign here explicitly
             optionsNoDB[0].value = dbname;
@@ -974,24 +975,72 @@ public class InternalDriver implements ModuleControl, Driver {
      */
     private  static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
-        {
-            return ContextService.getFactory();
-        }
-        else
-        {
-            return AccessController.doPrivileged
-                (
-                 new PrivilegedAction<ContextService>()
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
                  {
-                     public ContextService run()
-                     {
-                         return ContextService.getFactory();
-                     }
+                     return ContextService.getFactory();
                  }
-                 );
-        }
+             }
+             );
     }
 
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
 
+    
+    /**
+     * Privileged module lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object getSystemModule( final String factoryInterface )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.getSystemModule( factoryInterface );
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged service lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object findService( final String factoryInterface, final String serviceName )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.findService( factoryInterface, serviceName );
+                 }
+             }
+             );
+    }
+    
 }
diff --git a/java/engine/org/apache/derby/jdbc/ResourceAdapterImpl.java b/java/engine/org/apache/derby/jdbc/ResourceAdapterImpl.java
index 8674470d6..d0a5df43a 100644
--- a/java/engine/org/apache/derby/jdbc/ResourceAdapterImpl.java
+++ b/java/engine/org/apache/derby/jdbc/ResourceAdapterImpl.java
@@ -36,6 +36,9 @@ import org.apache.derby.iapi.store.access.xa.XAResourceManager;
 import org.apache.derby.iapi.store.access.xa.XAXactId;
 
 
+import java.security.AccessController;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.util.Properties;
 import java.util.Hashtable;
 import java.util.Enumeration;
@@ -66,7 +69,7 @@ public class ResourceAdapterImpl
         connectionTable = new Hashtable<XAXactId, XATransactionState>();
 
 		AccessFactory af = 
-			(AccessFactory)Monitor.findServiceModule(this, AccessFactory.MODULE);
+			(AccessFactory)findServiceModule(this, AccessFactory.MODULE);
 
 		rm = (XAResourceManager) af.getXAResourceManager();
 
@@ -142,4 +145,29 @@ public class ResourceAdapterImpl
 	{
 		return rm;
 	}
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object findServiceModule( final Object serviceModule, final String factoryInterface)
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.findServiceModule( serviceModule, factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
 }
diff --git a/java/engine/org/apache/derby/jdbc/XATransactionState.java b/java/engine/org/apache/derby/jdbc/XATransactionState.java
index ce77df1de..e8b34f9a0 100644
--- a/java/engine/org/apache/derby/jdbc/XATransactionState.java
+++ b/java/engine/org/apache/derby/jdbc/XATransactionState.java
@@ -22,8 +22,11 @@
 package org.apache.derby.jdbc;
 
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.sql.SQLException;
 import java.util.TimerTask;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.iapi.services.timer.TimerFactory;
 import org.apache.derby.impl.jdbc.EmbedConnection;
@@ -121,7 +124,7 @@ final class XATransactionState extends ContextImpl {
     }
 
     private static TimerFactory getTimerFactory() {
-        return Monitor.getMonitor().getTimerFactory();
+        return getMonitor().getTimerFactory();
     }
 
 	XATransactionState(ContextManager cm, EmbedConnection conn, 
@@ -432,4 +435,23 @@ final class XATransactionState extends ContextImpl {
             creatingResource.returnConnectionToResource(this, xid);
         }
     }
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
 }
diff --git a/java/engine/org/apache/derby/mbeans/Management.java b/java/engine/org/apache/derby/mbeans/Management.java
index f6e637f7d..456b5bfa1 100644
--- a/java/engine/org/apache/derby/mbeans/Management.java
+++ b/java/engine/org/apache/derby/mbeans/Management.java
@@ -21,6 +21,9 @@
 
 package org.apache.derby.mbeans;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
+
 import org.apache.derby.iapi.reference.Module;
 import org.apache.derby.iapi.services.monitor.Monitor;
 
@@ -39,7 +42,7 @@ public class Management implements ManagementMBean {
     
     private ManagementMBean getManagementService() {
         return (ManagementMBean)
-             Monitor.getSystemModule(Module.JMX);
+             getSystemModule(Module.JMX);
     }
     
     /**
@@ -84,4 +87,23 @@ public class Management implements ManagementMBean {
              return null;
         return mgmtService.getSystemIdentifier();
     }
+    
+    /**
+     * Privileged module lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object getSystemModule( final String factoryInterface )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.getSystemModule( factoryInterface );
+                 }
+             }
+             );
+    }
+
 }
diff --git a/java/optional/org/apache/derby/optional/lucene/LuceneSupport.java b/java/optional/org/apache/derby/optional/lucene/LuceneSupport.java
index 5791fe55d..2f4df2022 100644
--- a/java/optional/org/apache/derby/optional/lucene/LuceneSupport.java
+++ b/java/optional/org/apache/derby/optional/lucene/LuceneSupport.java
@@ -1860,9 +1860,9 @@ public class LuceneSupport implements OptionalTool
         throws SQLException
     {
         try {
-            Object monitor = Monitor.findService
+            Object monitor = findService
                 ( Property.DATABASE_MODULE, ((EmbedConnection) conn).getDBName() ) ;
-            return (DataFactory) Monitor.findServiceModule( monitor, DataFactory.MODULE );
+            return (DataFactory) findServiceModule( monitor, DataFactory.MODULE );
         }
         catch (StandardException se) { throw wrap( se ); }
     }
@@ -1876,4 +1876,47 @@ public class LuceneSupport implements OptionalTool
 		return ConnectionUtil.getCurrentLCC().getLanguageConnectionFactory().getClassFactory();
 	}
 	
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object findServiceModule( final Object serviceModule, final String factoryInterface)
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.findServiceModule( serviceModule, factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
+    /**
+     * Privileged service lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object findService( final String factoryInterface, final String serviceName )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.findService( factoryInterface, serviceName );
+                 }
+             }
+             );
+    }
+    
 }
diff --git a/java/storeless/org/apache/derby/impl/storeless/StorelessDatabase.java b/java/storeless/org/apache/derby/impl/storeless/StorelessDatabase.java
index 99fd95a0d..593755889 100644
--- a/java/storeless/org/apache/derby/impl/storeless/StorelessDatabase.java
+++ b/java/storeless/org/apache/derby/impl/storeless/StorelessDatabase.java
@@ -20,12 +20,15 @@
  */
 package org.apache.derby.impl.storeless;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.util.Properties;
 
 import org.apache.derby.catalog.UUID;
 import org.apache.derby.iapi.error.StandardException;
 import org.apache.derby.iapi.reference.EngineType;
 import org.apache.derby.iapi.services.context.ContextManager;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.iapi.store.access.TransactionController;
 import org.apache.derby.impl.db.BasicDatabase;
@@ -58,7 +61,7 @@ public class StorelessDatabase extends BasicDatabase {
 	
 	protected	UUID	makeDatabaseID(boolean create, Properties startParams)
 	{
-		return Monitor.getMonitor().getUUIDFactory().createUUID();
+		return getMonitor().getUUIDFactory().createUUID();
 	}
 	
 	protected Properties getAllDatabaseProperties()
@@ -77,4 +80,23 @@ public class StorelessDatabase extends BasicDatabase {
 	{
 		return true;
 	}
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
 }
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/GetCurrentPropertiesTest.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/GetCurrentPropertiesTest.policy
index 8e6dc1858..a9535b5e9 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/GetCurrentPropertiesTest.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/GetCurrentPropertiesTest.policy
@@ -101,6 +101,7 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar" {
   permission java.util.PropertyPermission "java.class.path", "read";//sysinfo
   permission java.util.PropertyPermission "java.runtime.version", "read";//sysinfo
   permission java.util.PropertyPermission "java.fullversion", "read";//sysinfo
+  permission org.apache.derby.security.SystemPermission "engine", "usederbyinternals";
   
   // accept is needed for the server accepting connections
   // connect is needed for ping command (which is in the server jar)
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NetworkServerControlApiTest.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NetworkServerControlApiTest.policy
index 4ef1ad340..69c52cdda 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NetworkServerControlApiTest.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NetworkServerControlApiTest.policy
@@ -97,6 +97,7 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar" {
   permission java.util.PropertyPermission "java.class.path", "read";//sysinfo
   permission java.util.PropertyPermission "java.runtime.version", "read";//sysinfo
   permission java.util.PropertyPermission "java.fullversion", "read";//sysinfo
+  permission org.apache.derby.security.SystemPermission "engine", "usederbyinternals";
   
   // accept is needed for the server accepting connections
   // connect is needed for ping command (which is in the server jar)
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/RuntimeInfoTest.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/RuntimeInfoTest.policy
index 2a16d4214..6b08ee1be 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/RuntimeInfoTest.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/RuntimeInfoTest.policy
@@ -140,6 +140,7 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar" {
   permission java.util.PropertyPermission "java.class.path", "read";//sysinfo
   permission java.util.PropertyPermission "java.runtime.version", "read";//sysinfo
   permission java.util.PropertyPermission "java.fullversion", "read";//sysinfo
+  permission org.apache.derby.security.SystemPermission "engine", "usederbyinternals";
   
   // accept is needed for the server accepting connections
   // connect is needed for ping command (which is in the server jar)
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/SecureServerTest.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/SecureServerTest.policy
index 049dd9ee5..c910fe454 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/SecureServerTest.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/SecureServerTest.policy
@@ -154,6 +154,7 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar" {
   permission java.util.PropertyPermission "java.runtime.version", "read";//sysinfo
   permission java.util.PropertyPermission "java.fullversion", "read";//sysinfo
   permission java.util.PropertyPermission "derby.__serverStartedFromCmdLine", "write";
+  permission org.apache.derby.security.SystemPermission "engine", "usederbyinternals";
   
   // accept is needed for the server accepting connections
   // connect is needed for ping command (which is in the server jar)
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/ServerPropertiesTest.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/ServerPropertiesTest.policy
index 197a66807..b3a92b3c2 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/ServerPropertiesTest.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/ServerPropertiesTest.policy
@@ -105,6 +105,7 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar" {
   permission java.util.PropertyPermission "java.class.path", "read";//sysinfo
   permission java.util.PropertyPermission "java.runtime.version", "read, write";//sysinfo
   permission java.util.PropertyPermission "java.fullversion", "read, write";//sysinfo
+  permission org.apache.derby.security.SystemPermission "engine", "usederbyinternals";
   
   // accept is needed for the server accepting connections
   // connect is needed for ping command (which is in the server jar)
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/SysinfoTest.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/SysinfoTest.policy
index 4acdcc747..4ca0e8805 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/SysinfoTest.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/SysinfoTest.policy
@@ -135,6 +135,7 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar" {
   permission java.util.PropertyPermission "java.class.path", "read";//sysinfo
   permission java.util.PropertyPermission "java.runtime.version", "read";//sysinfo
   permission java.util.PropertyPermission "java.fullversion", "read";//sysinfo
+  permission org.apache.derby.security.SystemPermission "engine", "usederbyinternals";
   
   // accept is needed for the server accepting connections
   // connect is needed for ping command (which is in the server jar)
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/engine/noDeregisterPermission.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/engine/noDeregisterPermission.policy
index 495fee6d3..2facb37a7 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/engine/noDeregisterPermission.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/engine/noDeregisterPermission.policy
@@ -134,6 +134,7 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar" {
   permission java.util.PropertyPermission "java.runtime.version", "read";//sysinfo
   permission java.util.PropertyPermission "java.fullversion", "read";//sysinfo
   permission java.util.PropertyPermission "derby.__serverStartedFromCmdLine", "write";
+  permission org.apache.derby.security.SystemPermission "engine", "usederbyinternals";
   
   // accept is needed for the server accepting connections
   // connect is needed for ping command (which is in the server jar)
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbc4/noAbortPermission.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbc4/noAbortPermission.policy
index 6a80e8261..84b106576 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbc4/noAbortPermission.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbc4/noAbortPermission.policy
@@ -124,6 +124,7 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar" {
   permission java.util.PropertyPermission "java.class.path", "read";//sysinfo
   permission java.util.PropertyPermission "java.runtime.version", "read";//sysinfo
   permission java.util.PropertyPermission "java.fullversion", "read";//sysinfo
+  permission org.apache.derby.security.SystemPermission "engine", "usederbyinternals";
   
   // accept is needed for the server accepting connections
   // connect is needed for ping command (which is in the server jar)
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/LDAPTests.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/LDAPTests.policy
index 7c2fe4d12..5606d1201 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/LDAPTests.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/LDAPTests.policy
@@ -126,6 +126,7 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar" {
   permission java.util.PropertyPermission "java.class.path", "read";//sysinfo
   permission java.util.PropertyPermission "java.runtime.version", "read";//sysinfo
   permission java.util.PropertyPermission "java.fullversion", "read";//sysinfo
+  permission org.apache.derby.security.SystemPermission "engine", "usederbyinternals";
   
   // accept is needed for the server accepting connections
   // connect is needed for ping command (which is in the server jar)
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.initial.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.initial.policy
index cfcaa12b2..9c03547d6 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.initial.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.initial.policy
@@ -62,6 +62,7 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar"
 //
   permission java.net.SocketPermission "${derbyTesting.serverhost}:*", "accept, connect, resolve"; 
   permission java.net.SocketPermission "localhost:*", "accept, connect, resolve"; 
+  permission org.apache.derby.security.SystemPermission "engine", "usederbyinternals";
 };
 
 grant codeBase "${derbyTesting.testjar}derbyTesting.jar"
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.modified.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.modified.policy
index 107ba354c..a7a2dca6d 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.modified.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.modified.policy
@@ -62,6 +62,7 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar"
 //
   permission java.net.SocketPermission "${derbyTesting.serverhost}:*", "accept, connect, resolve"; 
   permission java.net.SocketPermission "localhost:*", "accept, connect, resolve"; 
+  permission org.apache.derby.security.SystemPermission "engine", "usederbyinternals";
 };
 
 grant codeBase "${derbyTesting.testjar}derbyTesting.jar"
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.unreloadable.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.unreloadable.policy
index f44ea84c2..5fb5f2ddf 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.unreloadable.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SecurityPolicyReloadingTest.unreloadable.policy
@@ -97,6 +97,7 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar" {
   permission java.util.PropertyPermission "java.class.path", "read";//sysinfo
   permission java.util.PropertyPermission "java.runtime.version", "read";//sysinfo
   permission java.util.PropertyPermission "java.fullversion", "read";//sysinfo
+  permission org.apache.derby.security.SystemPermission "engine", "usederbyinternals";
   
   // accept is needed for the server accepting connections
   // connect is needed for ping command (which is in the server jar)
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/luceneSupport.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/luceneSupport.policy
index 63bb749fe..dc70ed1a1 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/luceneSupport.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/luceneSupport.policy
@@ -151,6 +151,7 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar" {
   permission java.util.PropertyPermission "java.runtime.version", "read";//sysinfo
   permission java.util.PropertyPermission "java.fullversion", "read";//sysinfo
   permission java.util.PropertyPermission "derby.__serverStartedFromCmdLine", "write";
+  permission org.apache.derby.security.SystemPermission "engine", "usederbyinternals";
   
   // accept is needed for the server accepting connections
   // connect is needed for ping command (which is in the server jar)
@@ -453,6 +454,7 @@ grant codeBase "${derbyTesting.ppcodeclasses}" {
 //
 grant codeBase "${derbyTesting.codejar}derbyoptionaltools.jar" {
   permission java.util.PropertyPermission "derby.system.home", "read";
+  permission org.apache.derby.security.SystemPermission "engine", "usederbyinternals";
 
   // all databases under derby.system.home 
   permission java.io.FilePermission "${derby.system.home}${/}lucenesupportpermsdb${/}LUCENE", "read,write,delete";
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/resultSetReader.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/resultSetReader.policy
index fd78c7e21..98cf19fc4 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/resultSetReader.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/resultSetReader.policy
@@ -138,6 +138,7 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar" {
   permission java.util.PropertyPermission "java.runtime.version", "read";//sysinfo
   permission java.util.PropertyPermission "java.fullversion", "read";//sysinfo
   permission java.util.PropertyPermission "derby.__serverStartedFromCmdLine", "write";
+  permission org.apache.derby.security.SystemPermission "engine", "usederbyinternals";
   
   // accept is needed for the server accepting connections
   // connect is needed for ping command (which is in the server jar)
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/store/Derby3980DeadlockTest.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/store/Derby3980DeadlockTest.policy
index a85dcbb92..8e52b6a4e 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/store/Derby3980DeadlockTest.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/store/Derby3980DeadlockTest.policy
@@ -138,6 +138,7 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar" {
   permission java.util.PropertyPermission "java.class.path", "read";//sysinfo
   permission java.util.PropertyPermission "java.runtime.version", "read";//sysinfo
   permission java.util.PropertyPermission "java.fullversion", "read";//sysinfo
+  permission org.apache.derby.security.SystemPermission "engine", "usederbyinternals";
   
   // accept is needed for the server accepting connections
   // connect is needed for ping command (which is in the server jar)
diff --git a/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy b/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
index a98011baa..e79c00512 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
@@ -151,6 +151,7 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar" {
   permission java.util.PropertyPermission "java.runtime.version", "read";//sysinfo
   permission java.util.PropertyPermission "java.fullversion", "read";//sysinfo
   permission java.util.PropertyPermission "derby.__serverStartedFromCmdLine", "write";
+  permission org.apache.derby.security.SystemPermission "engine", "usederbyinternals";
   
   // accept is needed for the server accepting connections
   // connect is needed for ping command (which is in the server jar)
diff --git a/java/testing/org/apache/derbyTesting/unitTests/crypto/T_Cipher.java b/java/testing/org/apache/derbyTesting/unitTests/crypto/T_Cipher.java
index b11670e45..4dc4832ed 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/crypto/T_Cipher.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/crypto/T_Cipher.java
@@ -32,6 +32,9 @@ import org.apache.derby.iapi.error.StandardException;
 
 import java.security.AccessController;
 import java.security.Key;
+import java.security.AccessController;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.security.PrivilegedAction;
 
 import java.io.File;
@@ -206,7 +209,7 @@ public class T_Cipher extends T_Generic
         REPORT("encryption provider used : " + provider);
 
         CipherFactoryBuilder cb =  (CipherFactoryBuilder)
-            Monitor.startSystemModule(org.apache.derby.iapi.reference.Module.CipherFactoryBuilder);
+            startSystemModule(org.apache.derby.iapi.reference.Module.CipherFactoryBuilder);
 
         factory = cb.createCipherFactory(true, props, false);
 
@@ -618,4 +621,30 @@ public class T_Cipher extends T_Generic
 		    }
 	    });
 	}
+    
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object  startSystemModule( final String factoryInterface )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.startSystemModule( factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
 }
diff --git a/java/testing/org/apache/derbyTesting/unitTests/harness/BasicUnitTestManager.java b/java/testing/org/apache/derbyTesting/unitTests/harness/BasicUnitTestManager.java
index 6a4379e07..e02bf369d 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/harness/BasicUnitTestManager.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/harness/BasicUnitTestManager.java
@@ -23,12 +23,15 @@ package org.apache.derbyTesting.unitTests.harness;
 
 import org.apache.derby.iapi.services.context.ContextManager;
 import org.apache.derby.iapi.services.context.ContextService;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.ModuleControl;
 import org.apache.derby.iapi.error.StandardException;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.shared.common.sanity.SanityManager;
 import org.apache.derby.iapi.services.stream.HeaderPrintWriter;
 import java.security.PrivilegedAction;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.security.AccessController;
 import java.util.Date;
 import java.util.Enumeration;
@@ -84,7 +87,7 @@ public class BasicUnitTestManager implements UnitTestManager, ModuleControl
 			findTests(System.getProperties(), startParams);
 		} catch (SecurityException se) {
 		}
-		findTests(Monitor.getMonitor().getApplicationProperties(), startParams);
+		findTests(getMonitor().getApplicationProperties(), startParams);
 
 		if ( !alreadyRun )
 		{
@@ -98,7 +101,7 @@ public class BasicUnitTestManager implements UnitTestManager, ModuleControl
 			System.out.println("Shutting down due to unit test failure.");
 			output.printlnWithHeader("Shutting down due to unit test failure, see log for more information.");
 
-			Monitor.getMonitor().shutdown();
+			getMonitor().shutdown();
 		}
 	}
 
@@ -130,7 +133,7 @@ public class BasicUnitTestManager implements UnitTestManager, ModuleControl
 
 				try {
 					Object unitTest =
-						Monitor.bootServiceModule(false, this, unitTestClass,
+						bootServiceModule(false, this, unitTestClass,
 												  startParams);
 					if (unitTest instanceof UnitTest) {
 						registerTest((UnitTest) unitTest, unitTestClass);
@@ -294,22 +297,63 @@ public class BasicUnitTestManager implements UnitTestManager, ModuleControl
      */
     private  static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
-        {
-            return ContextService.getFactory();
-        }
-        else
-        {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
+                 {
+                     return ContextService.getFactory();
+                 }
+             }
+             );
+    }
+
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object bootServiceModule
+        (
+         final boolean create, final Object serviceModule,
+         final String factoryInterface, final Properties properties
+         )
+        throws StandardException
+    {
+        try {
             return AccessController.doPrivileged
                 (
-                 new PrivilegedAction<ContextService>()
+                 new PrivilegedExceptionAction<Object>()
                  {
-                     public ContextService run()
+                     public Object run()
+                         throws StandardException
                      {
-                         return ContextService.getFactory();
+                         return Monitor.bootServiceModule( create, serviceModule, factoryInterface, properties );
                      }
                  }
                  );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
         }
     }
 
diff --git a/java/testing/org/apache/derbyTesting/unitTests/harness/UnitTestMain.java b/java/testing/org/apache/derbyTesting/unitTests/harness/UnitTestMain.java
index 924cd1955..24a238b73 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/harness/UnitTestMain.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/harness/UnitTestMain.java
@@ -22,6 +22,8 @@
 package org.apache.derbyTesting.unitTests.harness;
 
 import java.io.PrintWriter;
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.util.Properties;
 import org.apache.derby.iapi.services.monitor.Monitor;
 
@@ -40,12 +42,25 @@ public class UnitTestMain  {
 
 	public static void main(String args[]) {
 
+        AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     Properties bootProperties = new Properties();
 
-		Properties bootProperties = new Properties();
+                     // request that a unit test manager service is started
+                     bootProperties.put("derby.service.unitTestManager", UnitTestManager.MODULE);
+                     Monitor.startMonitor(bootProperties, new PrintWriter(System.err, true));
+                     
+                     return null;
+                 }
+             }
+             );
 
-		// request that a unit test manager service is started
-		bootProperties.put("derby.service.unitTestManager", UnitTestManager.MODULE);
 
-        Monitor.startMonitor(bootProperties, new PrintWriter(System.err, true));
 	}
+
+    
 }
diff --git a/java/testing/org/apache/derbyTesting/unitTests/services/T_CacheService.java b/java/testing/org/apache/derbyTesting/unitTests/services/T_CacheService.java
index 1cc6a2e31..520fdf53d 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/services/T_CacheService.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/services/T_CacheService.java
@@ -21,6 +21,10 @@
 
 package org.apache.derbyTesting.unitTests.services;
 
+import java.security.AccessController;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
+
 import org.apache.derbyTesting.unitTests.harness.T_Generic;
 import org.apache.derbyTesting.unitTests.harness.T_Fail;
 
@@ -47,8 +51,8 @@ public class T_CacheService extends T_Generic implements CacheableFactory {
 
 		DaemonFactory df;
 		try {
-			cf = (CacheFactory) Monitor.startSystemModule(getModuleToTestProtocolName());
-			df = (DaemonFactory) Monitor.startSystemModule(org.apache.derby.iapi.reference.Module.DaemonFactory);
+			cf = (CacheFactory) startSystemModule(getModuleToTestProtocolName());
+			df = (DaemonFactory) startSystemModule(org.apache.derby.iapi.reference.Module.DaemonFactory);
 		} catch (StandardException mse) {
 			throw T_Fail.exceptionFail(mse);
 		}
@@ -338,4 +342,30 @@ public class T_CacheService extends T_Generic implements CacheableFactory {
 
 		return entry;
 	}
+    
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object  startSystemModule( final String factoryInterface )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.startSystemModule( factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
 }
diff --git a/java/testing/org/apache/derbyTesting/unitTests/services/T_DaemonService.java b/java/testing/org/apache/derbyTesting/unitTests/services/T_DaemonService.java
index 5ddc41a8c..221fb9e22 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/services/T_DaemonService.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/services/T_DaemonService.java
@@ -28,6 +28,9 @@ import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.iapi.error.StandardException;
 import org.apache.derby.iapi.services.daemon.*;
 
+import java.security.AccessController;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.util.Random;
 import java.util.Vector;
 /**
@@ -68,7 +71,7 @@ public class T_DaemonService extends T_MultiThreadedIterations
 
 		DaemonFactory daemonFactory;
 		try {
-			daemonFactory = (DaemonFactory)Monitor.startSystemModule(org.apache.derby.iapi.reference.Module.DaemonFactory);
+			daemonFactory = (DaemonFactory)startSystemModule(org.apache.derby.iapi.reference.Module.DaemonFactory);
 		} catch (StandardException mse) {
 			throw T_Fail.exceptionFail(mse);
 		}
@@ -321,4 +324,30 @@ public class T_DaemonService extends T_MultiThreadedIterations
 		}	
 	}
 
+    
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object  startSystemModule( final String factoryInterface )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.startSystemModule( factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
 }
diff --git a/java/testing/org/apache/derbyTesting/unitTests/services/T_LockFactory.java b/java/testing/org/apache/derbyTesting/unitTests/services/T_LockFactory.java
index 60282d413..2a7543007 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/services/T_LockFactory.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/services/T_LockFactory.java
@@ -21,6 +21,10 @@
 
 package org.apache.derbyTesting.unitTests.services;
 
+import java.security.AccessController;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
+
 import org.apache.derbyTesting.unitTests.harness.T_MultiIterations;
 import org.apache.derbyTesting.unitTests.harness.T_Fail;
 
@@ -67,7 +71,7 @@ public class T_LockFactory extends T_MultiIterations
 	protected  void setupTest() throws T_Fail {
 
 		try {
-			lf = (LockFactory) Monitor.startSystemModule(getModuleToTestProtocolName());
+			lf = (LockFactory) startSystemModule(getModuleToTestProtocolName());
 		} catch (StandardException mse) {
 			throw T_Fail.exceptionFail(mse);
 		}
@@ -714,6 +718,32 @@ public class T_LockFactory extends T_MultiIterations
 			throw T_Fail.testFailMsg("Expected lock count (" + expect + "), got (" + got + ")");
 	}
 
+    
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object  startSystemModule( final String factoryInterface )
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.startSystemModule( factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
 }
 
 
diff --git a/java/testing/org/apache/derbyTesting/unitTests/services/T_UUIDFactory.java b/java/testing/org/apache/derbyTesting/unitTests/services/T_UUIDFactory.java
index 32350ed3e..5e42ce87d 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/services/T_UUIDFactory.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/services/T_UUIDFactory.java
@@ -21,11 +21,15 @@
 
 package org.apache.derbyTesting.unitTests.services;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
+
 import org.apache.derbyTesting.unitTests.harness.T_Generic;
 import org.apache.derbyTesting.unitTests.harness.T_Fail;
 
 import  org.apache.derby.catalog.UUID;
 
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.iapi.error.StandardException;
 
@@ -60,7 +64,7 @@ public class T_UUIDFactory extends T_Generic {
 	*/
 	protected void runTests() throws T_Fail {
 
-		factory = Monitor.getMonitor().getUUIDFactory();
+		factory = getMonitor().getUUIDFactory();
 		if (factory == null) {
 			throw T_Fail.testFailMsg(getModuleToTestProtocolName() + " module not started.");
 		}
@@ -152,4 +156,23 @@ public class T_UUIDFactory extends T_Generic {
 			resultSoFar =  false;
 		}
 	}
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
 }
diff --git a/java/testing/org/apache/derbyTesting/unitTests/store/T_AccessFactory.java b/java/testing/org/apache/derbyTesting/unitTests/store/T_AccessFactory.java
index fc462b780..37f61a2c8 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/store/T_AccessFactory.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/store/T_AccessFactory.java
@@ -46,6 +46,8 @@ import org.apache.derby.iapi.reference.Property;
 import org.apache.derby.iapi.reference.SQLState;
 import org.apache.derby.iapi.services.io.FormatableBitSet;
 import org.apache.derby.iapi.services.i18n.MessageService;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.security.PrivilegedAction;
 import java.security.AccessController;
 import java.io.Serializable;
@@ -103,7 +105,7 @@ public class T_AccessFactory extends T_Generic
 		startParams = T_Util.setEncryptionParam(startParams);
 
 		try {
-			store = (AccessFactory) Monitor.createPersistentService(
+			store = (AccessFactory) createPersistentService(
 				getModuleToTestProtocolName(), testService, startParams);
 		} catch (StandardException mse) {
 			throw T_Fail.exceptionFail(mse);
@@ -186,7 +188,7 @@ public class T_AccessFactory extends T_Generic
     {
         // flush and empty cache to make sure rereading stuff works.
         RawStoreFactory rawstore = 
-            (RawStoreFactory) Monitor.findServiceModule(
+            (RawStoreFactory) findServiceModule(
                 this.store, RawStoreFactory.MODULE);
 
         rawstore.checkpoint();
@@ -4376,22 +4378,65 @@ public class T_AccessFactory extends T_Generic
      */
     private  static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
+                 {
+                     return ContextService.getFactory();
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object findServiceModule( final Object serviceModule, final String factoryInterface)
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.findServiceModule( serviceModule, factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
         {
-            return ContextService.getFactory();
+            throw StandardException.plainWrapException( pae );
         }
-        else
-        {
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object createPersistentService( final String factoryInterface, final String serviceName, final Properties properties ) 
+        throws StandardException
+    {
+        try {
             return AccessController.doPrivileged
                 (
-                 new PrivilegedAction<ContextService>()
+                 new PrivilegedExceptionAction<Object>()
                  {
-                     public ContextService run()
+                     public Object run()
+                         throws StandardException
                      {
-                         return ContextService.getFactory();
+                         return Monitor.createPersistentService( factoryInterface, serviceName, properties );
                      }
                  }
                  );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
         }
     }
 
diff --git a/java/testing/org/apache/derbyTesting/unitTests/store/T_FileSystemData.java b/java/testing/org/apache/derbyTesting/unitTests/store/T_FileSystemData.java
index d02775a49..017b8ba19 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/store/T_FileSystemData.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/store/T_FileSystemData.java
@@ -42,8 +42,9 @@ import org.apache.derby.iapi.store.raw.data.RawContainerHandle;
 
 import org.apache.derby.iapi.store.access.conglomerate.LogicalUndo;
 import org.apache.derby.iapi.reference.Property;
-
 import java.io.*;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.security.PrivilegedAction;
 import java.security.AccessController;
 import java.util.Properties;
@@ -126,7 +127,7 @@ public class T_FileSystemData extends T_MultiThreadedIterations {
 		startParams.put(Property.DELETE_ON_CREATE, Boolean.TRUE.toString());
 
 		try {
-			factory = (RawStoreFactory) Monitor.createPersistentService(getModuleToTestProtocolName(),
+			factory = (RawStoreFactory) createPersistentService(getModuleToTestProtocolName(),
 								testService, startParams);
 			if (factory == null) {
 				throw T_Fail.testFailMsg(getModuleToTestProtocolName() + " service not started.");
@@ -1133,4 +1134,29 @@ public class T_FileSystemData extends T_MultiThreadedIterations {
         }
     }
 
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object createPersistentService( final String factoryInterface, final String serviceName, final Properties properties ) 
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.createPersistentService( factoryInterface, serviceName, properties );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
 }
diff --git a/java/testing/org/apache/derbyTesting/unitTests/store/T_Heap.java b/java/testing/org/apache/derbyTesting/unitTests/store/T_Heap.java
index 0cbfc7cbd..f8eb66b3a 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/store/T_Heap.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/store/T_Heap.java
@@ -47,6 +47,8 @@ import org.apache.derby.iapi.store.access.TransactionController;
 import org.apache.derby.iapi.reference.Property;
 
 import java.security.PrivilegedAction;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.security.AccessController;
 import java.util.Properties;
 
@@ -84,7 +86,7 @@ public class T_Heap extends T_Generic
 		startParams = T_Util.setEncryptionParam(startParams);
 
 		try {
-			store = (AccessFactory) Monitor.createPersistentService(getModuleToTestProtocolName(),
+			store = (AccessFactory) createPersistentService(getModuleToTestProtocolName(),
 			testService, startParams);
 		} catch (StandardException mse) {
 			throw T_Fail.exceptionFail(mse);
@@ -154,22 +156,40 @@ public class T_Heap extends T_Generic
      */
     private  static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
-        {
-            return ContextService.getFactory();
-        }
-        else
-        {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
+                 {
+                     return ContextService.getFactory();
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object createPersistentService( final String factoryInterface, final String serviceName, final Properties properties ) 
+        throws StandardException
+    {
+        try {
             return AccessController.doPrivileged
                 (
-                 new PrivilegedAction<ContextService>()
+                 new PrivilegedExceptionAction<Object>()
                  {
-                     public ContextService run()
+                     public Object run()
+                         throws StandardException
                      {
-                         return ContextService.getFactory();
+                         return Monitor.createPersistentService( factoryInterface, serviceName, properties );
                      }
                  }
                  );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
         }
     }
 
diff --git a/java/testing/org/apache/derbyTesting/unitTests/store/T_RawStoreFactory.java b/java/testing/org/apache/derbyTesting/unitTests/store/T_RawStoreFactory.java
index f4a21ea87..bd444484f 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/store/T_RawStoreFactory.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/store/T_RawStoreFactory.java
@@ -31,6 +31,7 @@ import org.apache.derbyTesting.unitTests.harness.T_Fail;
 import org.apache.derby.iapi.services.context.ContextService;
 import org.apache.derby.iapi.services.context.ContextManager;
 import org.apache.derby.iapi.services.locks.*;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.shared.common.sanity.SanityManager;
 import org.apache.derby.iapi.services.uuid.UUIDFactory;
@@ -60,6 +61,8 @@ import org.apache.derby.iapi.services.io.FormatableBitSet;
 
 import java.io.*;
 import java.security.PrivilegedAction;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.security.AccessController;
 import java.util.Properties;
 
@@ -158,7 +161,7 @@ public class T_RawStoreFactory extends T_MultiThreadedIterations {
 
 		try {
 
-			factory = (RawStoreFactory) Monitor.createPersistentService(getModuleToTestProtocolName(),
+			factory = (RawStoreFactory) createPersistentService(getModuleToTestProtocolName(),
 								getTestService(), startParams);
 
 			if (factory == null) {
@@ -170,7 +173,7 @@ public class T_RawStoreFactory extends T_MultiThreadedIterations {
 				throw T_Fail.testFailMsg("LockFactory.MODULE not found");
 			}
 
-			uuidfactory = Monitor.getMonitor().getUUIDFactory();
+			uuidfactory = getMonitor().getUUIDFactory();
 
 		} catch (StandardException mse) {
 			throw T_Fail.exceptionFail(mse);
@@ -7642,22 +7645,59 @@ public class T_RawStoreFactory extends T_MultiThreadedIterations {
      */
     private  static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
-        {
-            return ContextService.getFactory();
-        }
-        else
-        {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
+                 {
+                     return ContextService.getFactory();
+                 }
+             }
+             );
+    }
+
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object createPersistentService( final String factoryInterface, final String serviceName, final Properties properties ) 
+        throws StandardException
+    {
+        try {
             return AccessController.doPrivileged
                 (
-                 new PrivilegedAction<ContextService>()
+                 new PrivilegedExceptionAction<Object>()
                  {
-                     public ContextService run()
+                     public Object run()
+                         throws StandardException
                      {
-                         return ContextService.getFactory();
+                         return Monitor.createPersistentService( factoryInterface, serviceName, properties );
                      }
                  }
                  );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
         }
     }
 
diff --git a/java/testing/org/apache/derbyTesting/unitTests/store/T_RecoverBadLog.java b/java/testing/org/apache/derbyTesting/unitTests/store/T_RecoverBadLog.java
index ce5bd5475..f92c957d9 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/store/T_RecoverBadLog.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/store/T_RecoverBadLog.java
@@ -53,6 +53,8 @@ import java.io.RandomAccessFile;
 import java.io.File;
 import java.security.PrivilegedAction;
 import java.security.AccessController;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.util.Properties;
 
 
@@ -260,7 +262,7 @@ public class T_RecoverBadLog extends T_Generic {
 				// remove the service directory to ensure a clean run
 				startParams.put(Property.DELETE_ON_CREATE, Boolean.TRUE.toString());
 
-				factory = (RawStoreFactory) Monitor.createPersistentService(getModuleToTestProtocolName(),
+				factory = (RawStoreFactory) createPersistentService(getModuleToTestProtocolName(),
 															  testService,
 															  startParams);
 				// create a database with nothing
@@ -316,11 +318,11 @@ public class T_RecoverBadLog extends T_Generic {
 					throw T_Fail.exceptionFail(ioe);
 				}
 
-				if (!Monitor.startPersistentService(testService, startParams))
+				if (!startPersistentService(testService, startParams))
 					throw T_Fail.testFailMsg("Monitor didn't know how to restart service: " + testService);
 
 				factory = (RawStoreFactory) Monitor.findService(getModuleToTestProtocolName(), testService);
-				logFactory =(LogToFile) Monitor.findServiceModule(factory, factory.getLogFactoryModule());
+				logFactory =(LogToFile) findServiceModule(factory, factory.getLogFactoryModule());
 				
 			}
 		} catch (StandardException mse) {
@@ -1836,22 +1838,90 @@ public class T_RecoverBadLog extends T_Generic {
      */
     private  static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
+                 {
+                     return ContextService.getFactory();
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object findServiceModule( final Object serviceModule, final String factoryInterface)
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.findServiceModule( serviceModule, factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
         {
-            return ContextService.getFactory();
+            throw StandardException.plainWrapException( pae );
         }
-        else
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  boolean startPersistentService( final String serviceName, final Properties properties ) 
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Boolean>()
+                 {
+                     public Boolean run()
+                         throws StandardException
+                     {
+                         return Monitor.startPersistentService( serviceName, properties );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
         {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object createPersistentService( final String factoryInterface, final String serviceName, final Properties properties ) 
+        throws StandardException
+    {
+        try {
             return AccessController.doPrivileged
                 (
-                 new PrivilegedAction<ContextService>()
+                 new PrivilegedExceptionAction<Object>()
                  {
-                     public ContextService run()
+                     public Object run()
+                         throws StandardException
                      {
-                         return ContextService.getFactory();
+                         return Monitor.createPersistentService( factoryInterface, serviceName, properties );
                      }
                  }
                  );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
         }
     }
 
diff --git a/java/testing/org/apache/derbyTesting/unitTests/store/T_RecoverFullLog.java b/java/testing/org/apache/derbyTesting/unitTests/store/T_RecoverFullLog.java
index 5678d2fde..c7cafc15e 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/store/T_RecoverFullLog.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/store/T_RecoverFullLog.java
@@ -52,6 +52,8 @@ import java.io.IOException;
 import java.io.RandomAccessFile;
 import java.io.File;
 import java.security.PrivilegedAction;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.security.AccessController;
 import java.util.Properties;
 
@@ -193,7 +195,7 @@ public class T_RecoverFullLog extends T_Generic {
 				// remove the service directory to ensure a clean run
 				startParams.put(Property.DELETE_ON_CREATE, Boolean.TRUE.toString());
 
-				factory = (RawStoreFactory) Monitor.createPersistentService(getModuleToTestProtocolName(),
+				factory = (RawStoreFactory) createPersistentService(getModuleToTestProtocolName(),
 																  testService,
 																  startParams);
 				// create a database with nothing
@@ -247,9 +249,9 @@ public class T_RecoverFullLog extends T_Generic {
 					System.setProperty(LogToFile.TEST_RECORD_TO_FILL_LOG, "10");
 				}
 
-				if (!Monitor.startPersistentService(testService, startParams))
+				if (!startPersistentService(testService, startParams))
 					throw T_Fail.testFailMsg("Monitor didn't know how to restart service: " + testService);
-				factory = (RawStoreFactory) Monitor.findService(getModuleToTestProtocolName(), testService);
+				factory = (RawStoreFactory) findService(getModuleToTestProtocolName(), testService);
 
 				if (recoveryFail)
 				{
@@ -871,26 +873,87 @@ public class T_RecoverFullLog extends T_Generic {
      */
     private  static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
+                 {
+                     return ContextService.getFactory();
+                 }
+             }
+             );
+    }
+
+
+    /**
+     * Privileged service lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object findService( final String factoryInterface, final String serviceName )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.findService( factoryInterface, serviceName );
+                 }
+             }
+             );
+    }
+    
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  boolean startPersistentService( final String serviceName, final Properties properties ) 
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Boolean>()
+                 {
+                     public Boolean run()
+                         throws StandardException
+                     {
+                         return Monitor.startPersistentService( serviceName, properties );
+                     }
+                 }
+                 ).booleanValue();
+        } catch (PrivilegedActionException pae)
         {
-            return ContextService.getFactory();
+            throw StandardException.plainWrapException( pae );
         }
-        else
-        {
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object createPersistentService( final String factoryInterface, final String serviceName, final Properties properties ) 
+        throws StandardException
+    {
+        try {
             return AccessController.doPrivileged
                 (
-                 new PrivilegedAction<ContextService>()
+                 new PrivilegedExceptionAction<Object>()
                  {
-                     public ContextService run()
+                     public Object run()
+                         throws StandardException
                      {
-                         return ContextService.getFactory();
+                         return Monitor.createPersistentService( factoryInterface, serviceName, properties );
                      }
                  }
                  );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
         }
     }
 
-
 }
 
 
diff --git a/java/testing/org/apache/derbyTesting/unitTests/store/T_Recovery.java b/java/testing/org/apache/derbyTesting/unitTests/store/T_Recovery.java
index 932e1f021..49341617e 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/store/T_Recovery.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/store/T_Recovery.java
@@ -34,6 +34,7 @@ import org.apache.derby.iapi.services.context.ContextService;
 import org.apache.derby.iapi.services.context.ContextManager;
 import org.apache.derby.iapi.services.locks.*;
 import org.apache.derby.iapi.services.property.PropertyUtil;
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.shared.common.sanity.SanityManager;
 
@@ -60,6 +61,8 @@ import org.apache.derby.iapi.services.io.FormatableBitSet;
 
 import java.io.*;
 import java.security.PrivilegedAction;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.security.AccessController;
 import java.util.Properties;
 
@@ -168,7 +171,7 @@ public class T_Recovery extends T_Generic {
 
 		try {
 
-			uuidfactory = Monitor.getMonitor().getUUIDFactory();
+			uuidfactory = getMonitor().getUUIDFactory();
 			if (uuidfactory == null) {
 				throw T_Fail.testFailMsg("UUIDFactory.MODULE not found");
 			}
@@ -180,9 +183,9 @@ public class T_Recovery extends T_Generic {
 
 			if (testRecovery)
 			{
-				if (!Monitor.startPersistentService(testService, startParams))
+				if (!startPersistentService(testService, startParams))
 					throw T_Fail.testFailMsg("Monitor didn't know how to restart service: " + testService);
-				factory = (RawStoreFactory) Monitor.findService(getModuleToTestProtocolName(), testService);
+				factory = (RawStoreFactory) findService(getModuleToTestProtocolName(), testService);
 
 			}
 			else					// setup
@@ -202,7 +205,7 @@ public class T_Recovery extends T_Generic {
 				// keep all log files for diagnostics
 				startParams.put(RawStoreFactory.KEEP_TRANSACTION_LOG, "true");
 
-				factory = (RawStoreFactory) Monitor.createPersistentService(getModuleToTestProtocolName(),
+				factory = (RawStoreFactory) createPersistentService(getModuleToTestProtocolName(),
 																  testService,
 																  startParams);
 			}
@@ -4094,22 +4097,102 @@ public class T_Recovery extends T_Generic {
      */
     private  static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
+                 {
+                     return ContextService.getFactory();
+                 }
+             }
+             );
+    }
+
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged service lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private static  Object findService( final String factoryInterface, final String serviceName )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Object>()
+             {
+                 public Object run()
+                 {
+                     return Monitor.findService( factoryInterface, serviceName );
+                 }
+             }
+             );
+    }
+    
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  boolean startPersistentService( final String serviceName, final Properties properties ) 
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Boolean>()
+                 {
+                     public Boolean run()
+                         throws StandardException
+                     {
+                         return Monitor.startPersistentService( serviceName, properties );
+                     }
+                 }
+                 ).booleanValue();
+        } catch (PrivilegedActionException pae)
         {
-            return ContextService.getFactory();
+            throw StandardException.plainWrapException( pae );
         }
-        else
-        {
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object createPersistentService( final String factoryInterface, final String serviceName, final Properties properties ) 
+        throws StandardException
+    {
+        try {
             return AccessController.doPrivileged
                 (
-                 new PrivilegedAction<ContextService>()
+                 new PrivilegedExceptionAction<Object>()
                  {
-                     public ContextService run()
+                     public Object run()
+                         throws StandardException
                      {
-                         return ContextService.getFactory();
+                         return Monitor.createPersistentService( factoryInterface, serviceName, properties );
                      }
                  }
                  );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
         }
     }
 
diff --git a/java/testing/org/apache/derbyTesting/unitTests/store/T_SortController.java b/java/testing/org/apache/derbyTesting/unitTests/store/T_SortController.java
index d9b49ab5d..d0caec9a0 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/store/T_SortController.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/store/T_SortController.java
@@ -46,6 +46,8 @@ import org.apache.derby.iapi.types.SQLInteger;
 
 import java.security.AccessController;
 import java.security.PrivilegedAction;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.util.Properties;
 import java.util.Vector;
 import java.util.StringTokenizer;
@@ -134,7 +136,7 @@ public class T_SortController extends T_Generic
 		int failcount = 0;
 
 		try {
-			store = (AccessFactory) Monitor.createPersistentService(getModuleToTestProtocolName(), 
+			store = (AccessFactory) createPersistentService(getModuleToTestProtocolName(), 
 				testService + tail, startParams);
 		} catch (StandardException mse) {
 			throw T_Fail.exceptionFail(mse);
@@ -864,6 +866,31 @@ public class T_SortController extends T_Generic
         }
     }
 
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object createPersistentService( final String factoryInterface, final String serviceName, final Properties properties ) 
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.createPersistentService( factoryInterface, serviceName, properties );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
+        }
+    }
+
 }
 
 
diff --git a/java/testing/org/apache/derbyTesting/unitTests/store/T_StreamFile.java b/java/testing/org/apache/derbyTesting/unitTests/store/T_StreamFile.java
index feabed14d..b8e2edb7c 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/store/T_StreamFile.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/store/T_StreamFile.java
@@ -51,6 +51,8 @@ import org.apache.derby.iapi.services.io.DynamicByteArrayOutputStream;
 
 import java.io.*;
 import java.security.PrivilegedAction;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.security.AccessController;
 import java.util.Properties;
 
@@ -129,7 +131,7 @@ public class T_StreamFile extends T_MultiThreadedIterations {
 		startParams = T_Util.setEncryptionParam(startParams);
 
 		try {
-			factory = (RawStoreFactory) Monitor.createPersistentService(getModuleToTestProtocolName(),
+			factory = (RawStoreFactory) createPersistentService(getModuleToTestProtocolName(),
 								testService, startParams);
 			if (factory == null) {
 				throw T_Fail.testFailMsg(getModuleToTestProtocolName() + " service not started.");
@@ -398,22 +400,40 @@ public class T_StreamFile extends T_MultiThreadedIterations {
      */
     private  static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
-        {
-            return ContextService.getFactory();
-        }
-        else
-        {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
+                 {
+                     return ContextService.getFactory();
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object createPersistentService( final String factoryInterface, final String serviceName, final Properties properties ) 
+        throws StandardException
+    {
+        try {
             return AccessController.doPrivileged
                 (
-                 new PrivilegedAction<ContextService>()
+                 new PrivilegedExceptionAction<Object>()
                  {
-                     public ContextService run()
+                     public Object run()
+                         throws StandardException
                      {
-                         return ContextService.getFactory();
+                         return Monitor.createPersistentService( factoryInterface, serviceName, properties );
                      }
                  }
                  );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
         }
     }
 
diff --git a/java/testing/org/apache/derbyTesting/unitTests/store/T_XA.java b/java/testing/org/apache/derbyTesting/unitTests/store/T_XA.java
index d9a4d5571..7654919da 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/store/T_XA.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/store/T_XA.java
@@ -42,6 +42,8 @@ import org.apache.derby.iapi.services.io.FormatIdUtil;
 
 import org.apache.derby.iapi.error.StandardException; 
 
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.security.PrivilegedAction;
 import java.security.AccessController;
 import java.util.Properties; 
@@ -113,7 +115,7 @@ public class T_XA extends T_Generic
 		startParams = T_Util.setEncryptionParam(startParams);
 
 		try {
-			store = (AccessFactory) Monitor.createPersistentService(
+			store = (AccessFactory) createPersistentService(
 				getModuleToTestProtocolName(), testService, startParams);
 		} catch (StandardException mse) {
 			throw T_Fail.exceptionFail(mse);
@@ -1189,25 +1191,42 @@ public class T_XA extends T_Generic
      */
     static  ContextService    getContextService()
     {
-        if ( System.getSecurityManager() == null )
-        {
-            return ContextService.getFactory();
-        }
-        else
-        {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ContextService>()
+             {
+                 public ContextService run()
+                 {
+                     return ContextService.getFactory();
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object createPersistentService( final String factoryInterface, final String serviceName, final Properties properties ) 
+        throws StandardException
+    {
+        try {
             return AccessController.doPrivileged
                 (
-                 new PrivilegedAction<ContextService>()
+                 new PrivilegedExceptionAction<Object>()
                  {
-                     public ContextService run()
+                     public Object run()
+                         throws StandardException
                      {
-                         return ContextService.getFactory();
+                         return Monitor.createPersistentService( factoryInterface, serviceName, properties );
                      }
                  }
                  );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
         }
     }
-
 }
 
 class commit_method
@@ -1313,4 +1332,5 @@ class commit_method
                 cm, xid);
         }
     }
+
 }
diff --git a/java/testing/org/apache/derbyTesting/unitTests/store/T_b2i.java b/java/testing/org/apache/derbyTesting/unitTests/store/T_b2i.java
index be95caeb9..83d092176 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/store/T_b2i.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/store/T_b2i.java
@@ -71,6 +71,8 @@ import org.apache.derby.iapi.types.SQLChar;
 
 import java.security.PrivilegedAction;
 import java.security.AccessController;
+import java.security.PrivilegedActionException;
+import java.security.PrivilegedExceptionAction;
 import java.util.Properties;
 
 
@@ -111,7 +113,7 @@ public class T_b2i extends T_MultiIterations
 
 
 		try {
-			store_module = Monitor.createPersistentService(
+			store_module = createPersistentService(
 				getModuleToTestProtocolName(), testService, startParams);
 			
 			contextService = getContextService();
@@ -1624,7 +1626,7 @@ public class T_b2i extends T_MultiIterations
 
         // flush and empty cache to make sure rereading stuff works.
         RawStoreFactory rawstore = 
-            (RawStoreFactory) Monitor.findServiceModule(
+            (RawStoreFactory) findServiceModule(
                 this.store_module, RawStoreFactory.MODULE);
 
         rawstore.idle();
@@ -5137,22 +5139,65 @@ public class T_b2i extends T_MultiIterations
      */
     private  static  Context    getContextOrNull( final String contextID )
     {
-        if ( System.getSecurityManager() == null )
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<Context>()
+             {
+                 public Context run()
+                 {
+                     return ContextService.getContextOrNull( contextID );
+                 }
+             }
+             );
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object findServiceModule( final Object serviceModule, final String factoryInterface)
+        throws StandardException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<Object>()
+                 {
+                     public Object run()
+                         throws StandardException
+                     {
+                         return Monitor.findServiceModule( serviceModule, factoryInterface );
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
         {
-            return ContextService.getContextOrNull( contextID );
+            throw StandardException.plainWrapException( pae );
         }
-        else
-        {
+    }
+
+    /**
+     * Privileged startup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  Object createPersistentService( final String factoryInterface, final String serviceName, final Properties properties ) 
+        throws StandardException
+    {
+        try {
             return AccessController.doPrivileged
                 (
-                 new PrivilegedAction<Context>()
+                 new PrivilegedExceptionAction<Object>()
                  {
-                     public Context run()
+                     public Object run()
+                         throws StandardException
                      {
-                         return ContextService.getContextOrNull( contextID );
+                         return Monitor.createPersistentService( factoryInterface, serviceName, properties );
                      }
                  }
                  );
+        } catch (PrivilegedActionException pae)
+        {
+            throw StandardException.plainWrapException( pae );
         }
     }
 
diff --git a/java/testing/org/apache/derbyTesting/unitTests/util/MsgTrace.java b/java/testing/org/apache/derbyTesting/unitTests/util/MsgTrace.java
index 19ec84eb9..77fad8fc7 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/util/MsgTrace.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/util/MsgTrace.java
@@ -21,6 +21,10 @@
 
 package org.apache.derbyTesting.unitTests.util;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
+
+import org.apache.derby.iapi.services.monitor.ModuleFactory;
 import org.apache.derby.iapi.services.monitor.Monitor;
 import org.apache.derby.shared.common.sanity.SanityManager;
 import org.apache.derby.iapi.services.stream.HeaderPrintWriter;
@@ -52,7 +56,7 @@ public class MsgTrace implements Runnable {
 
 	private MsgTrace() {
 
-		output = Monitor.getMonitor().getSystemStreams().stream();
+		output = getMonitor().getSystemStreams().stream();
 
 		bombDelay = PropertyUtil.getSystemInt(DELAY_PARAM_NAME, 30 * 60); // 30 minutes default
 		bombDelay *= 1000;
@@ -87,4 +91,23 @@ public class MsgTrace implements Runnable {
 
 		System.exit(1);
 	}
+    
+    /**
+     * Privileged Monitor lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+    private  static  ModuleFactory  getMonitor()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<ModuleFactory>()
+             {
+                 public ModuleFactory run()
+                 {
+                     return Monitor.getMonitor();
+                 }
+             }
+             );
+    }
+
 }
