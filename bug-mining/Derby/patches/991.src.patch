diff --git a/java/client/org/apache/derby/client/am/PreparedStatement.java b/java/client/org/apache/derby/client/am/PreparedStatement.java
index 0c56ebae6..489dbfaf8 100644
--- a/java/client/org/apache/derby/client/am/PreparedStatement.java
+++ b/java/client/org/apache/derby/client/am/PreparedStatement.java
@@ -1488,6 +1488,7 @@ public class PreparedStatement extends Statement
                             Object x,
                             int targetJdbcType,
                             int scale) throws SqlException {
+        checkForValidParameterIndex(parameterIndex);
         checkForValidScale(scale);
 
         // JDBC 4.0 requires us to throw SQLFeatureNotSupportedException for
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/ij2.out b/java/testing/org/apache/derbyTesting/functionTests/master/ij2.out
index 5672ed294..075ae1c7f 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/ij2.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/ij2.out
@@ -91,6 +91,25 @@ IJ ERROR: Using clause had no results
 ij> -- note that the using part was, however, executed...
 drop table s;
 0 rows inserted/updated/deleted
+ij> -- DERBY-2558: Verify that we get a reasonable message when the 'dimension'
+-- of the 'using-set' does not match the 'dimension' of the prepared statement:
+create table t2558 (i int);
+0 rows inserted/updated/deleted
+ij> insert into t2558 values (3), (4);
+2 rows inserted/updated/deleted
+ij> -- First two statements below should fail. Third one should work.
+execute 'select * from t2558 where i = ?' using 'values (3,4)';
+IJ WARNING: Autocommit may close using result set
+ERROR XCL13: The parameter position '2' is out of range.  The number of parameters for this prepared  statement is '1'.
+ij> execute 'select * from t2558 where i in (?,?,?)' using 'values (3,4)';
+IJ WARNING: Autocommit may close using result set
+ERROR 07000: At least one parameter to the current statement is uninitialized.
+ij> execute 'select * from t2558 where i = ? or i = ?' using 'values (3,4)';
+IJ WARNING: Autocommit may close using result set
+I          
+-----------
+3          
+4          
 ij> -- bug 5926 - make sure the using clause result set got closed
 drop table t;
 0 rows inserted/updated/deleted
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/PrepareStatementTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/PrepareStatementTest.java
index 76a38287f..21ef4f4eb 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/PrepareStatementTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/PrepareStatementTest.java
@@ -288,6 +288,29 @@ public class PrepareStatementTest extends BaseJDBCTestCase
             assertSQLState("07000", e);
         }
         pSt.close();
+
+        // Some test cases for DERBY-2558, involving validation of the
+        // parameterIndex argument to the 4-argument overload of setObject
+        //
+        pSt = prepareStatement("create table d2558 (i int)");
+        assertUpdateCount(pSt, 0);
+        pSt.close();
+        pSt = prepareStatement("insert into d2558 values (3), (4)");
+        assertUpdateCount(pSt, 2);
+        pSt.close();
+        pSt = prepareStatement("select * from d2558 where i = ?");
+        pSt.setObject(1,new Integer(3),java.sql.Types.INTEGER,0);
+        try {
+            // There's only 1 parameter marker, so this should fail:
+            pSt.setObject(2,new Integer(4), java.sql.Types.INTEGER,0);
+            rs = pSt.executeQuery();
+            rs.close();
+            fail("Exception expected above!");
+        } catch (SQLException e) {
+            assertSQLState("XCL13", e);
+        }
+        pSt.close();
+
     }
 
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/tools/ij2.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/tools/ij2.sql
index 48248a562..9a8e53777 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/tools/ij2.sql
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/tools/ij2.sql
@@ -67,6 +67,15 @@ execute 'select * from t where i=?' using 'create table s (i int)';
 -- note that the using part was, however, executed...
 drop table s;
 
+-- DERBY-2558: Verify that we get a reasonable message when the 'dimension'
+-- of the 'using-set' does not match the 'dimension' of the prepared statement:
+create table t2558 (i int);
+insert into t2558 values (3), (4);
+-- First two statements below should fail. Third one should work.
+execute 'select * from t2558 where i = ?' using 'values (3,4)';
+execute 'select * from t2558 where i in (?,?,?)' using 'values (3,4)';
+execute 'select * from t2558 where i = ? or i = ?' using 'values (3,4)';
+
 -- bug 5926 - make sure the using clause result set got closed
 drop table t;
 create table t(c1 int);
