diff --git a/java/engine/org/apache/derby/iapi/services/monitor/ModuleFactory.java b/java/engine/org/apache/derby/iapi/services/monitor/ModuleFactory.java
index 849068e19..f2d8e6a34 100644
--- a/java/engine/org/apache/derby/iapi/services/monitor/ModuleFactory.java
+++ b/java/engine/org/apache/derby/iapi/services/monitor/ModuleFactory.java
@@ -289,11 +289,14 @@ public interface ModuleFactory
 	*/
 	public Thread getDaemonThread(Runnable task, String name, boolean setMinPriority);
 
-	/**
-		Set the priority of the current thread.
-		If the current thread was not returned by getDaemonThread() then no action is taken.
-	*/
-	public void setThreadPriority(int priority);
+    /**
+     * Check if a thread is a daemon thread created by {@link #getDaemonThread}.
+     *
+     * @param thread the thread to check
+     * @return {@code true} if {@code thread} was created by
+     *   {@code getDaemonThread()}, {@code false} otherwise.
+     */
+    public boolean isDaemonThread(Thread thread);
 
 	public ProductVersionHolder getEngineVersion();
 
diff --git a/java/engine/org/apache/derby/impl/services/daemon/BasicDaemon.java b/java/engine/org/apache/derby/impl/services/daemon/BasicDaemon.java
index 2719248ef..198be8189 100644
--- a/java/engine/org/apache/derby/impl/services/daemon/BasicDaemon.java
+++ b/java/engine/org/apache/derby/impl/services/daemon/BasicDaemon.java
@@ -31,6 +31,8 @@ import org.apache.derby.shared.common.sanity.SanityManager;
 
 import org.apache.derby.iapi.error.StandardException;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.util.Vector;
 import java.util.List;
 import org.apache.derby.iapi.util.InterruptStatus;
@@ -727,20 +729,27 @@ public class BasicDaemon implements DaemonService, Runnable
 		else
 		{
 			ModuleFactory mf = Monitor.getMonitor();
-			if (mf != null)
-				mf.setThreadPriority(Thread.MIN_PRIORITY);
+            setThreadPriority(mf, Thread.MIN_PRIORITY);
 			Thread.yield();
-			if (mf != null)
-				mf.setThreadPriority(oldPriority);
+            setThreadPriority(mf, oldPriority);
 		}
 	}
-}
-
-
-
-
-
-
-
-
 
+    /**
+     * Change the priority of the current thread, but only if it was created
+     * by {@link ModuleFactory#getDaemonThread}.
+     */
+    private static void setThreadPriority(
+            ModuleFactory mf, final int priority) {
+        final Thread t = Thread.currentThread();
+        if (mf != null && mf.isDaemonThread(t)) {
+            AccessController.doPrivileged(new PrivilegedAction<Void>() {
+                @Override
+                public Void run() {
+                    t.setPriority(priority);
+                    return null;
+                }
+            });
+        }
+    }
+}
diff --git a/java/engine/org/apache/derby/impl/services/monitor/BaseMonitor.java b/java/engine/org/apache/derby/impl/services/monitor/BaseMonitor.java
index e0accb8a9..02b1829e3 100644
--- a/java/engine/org/apache/derby/impl/services/monitor/BaseMonitor.java
+++ b/java/engine/org/apache/derby/impl/services/monitor/BaseMonitor.java
@@ -2075,14 +2075,10 @@ nextModule:
 
 	}
 
-	public void setThreadPriority(int priority) {
-
-		Thread t = Thread.currentThread();
-
-		if (t.getThreadGroup() == daemonGroup) {
-			t.setPriority(priority);
-		}
-	}
+    @Override
+    public final boolean isDaemonThread(Thread thread) {
+        return thread.getThreadGroup() == daemonGroup;
+    }
 
 	/**
 		Initialize the monitor wrt the current environemnt.
diff --git a/java/engine/org/apache/derby/impl/services/monitor/FileMonitor.java b/java/engine/org/apache/derby/impl/services/monitor/FileMonitor.java
index fb6efbf6e..5baf3b253 100644
--- a/java/engine/org/apache/derby/impl/services/monitor/FileMonitor.java
+++ b/java/engine/org/apache/derby/impl/services/monitor/FileMonitor.java
@@ -38,7 +38,6 @@ import org.apache.derby.iapi.services.info.ProductGenusNames;
 import org.apache.derby.iapi.services.info.ProductVersionHolder;
 import org.apache.derby.iapi.services.io.FileUtil;
 import org.apache.derby.shared.common.reference.MessageId;
-import org.apache.derby.shared.common.sanity.SanityManager;
 
 /**
 	Implementation of the monitor that uses the class loader
@@ -298,15 +297,6 @@ public final class FileMonitor extends BaseMonitor
         });
     }
 
-	public final void setThreadPriority(final int priority) {
-        AccessController.doPrivileged(new PrivilegedAction<Object>() {
-            public Object run() {
-                FileMonitor.super.setThreadPriority(priority);
-                return null;
-            }
-        });
-	}
-
 	final InputStream applicationPropertiesStream()
 	  throws IOException {
 		try {
