diff --git a/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy b/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
index 1dee8ec45..998df8659 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
@@ -413,6 +413,13 @@ grant codeBase "${derbyTesting.antjunit}" {
     permission java.io.FilePermission "${user.dir}${/}*", "write";
 };
 
+// Starting with Ant 1.9.3, write permission has to be granted to ant.jar
+// as well so that Ant's JUnit runner can write test results to a file.
+// Only needed when running the tests under Ant. See DERBY-6685.
+grant codeBase "${derbyTesting.ant}" {
+    permission java.io.FilePermission "${user.dir}${/}*", "write";
+};
+
 // functionTests.tests.lang.RoutineSecurityTest requires this grant
 // to check to see if permissions are granted through generated code
 // through this mechanism.
diff --git a/java/testing/org/apache/derbyTesting/junit/SecurityManagerSetup.java b/java/testing/org/apache/derbyTesting/junit/SecurityManagerSetup.java
index 116b9d7a5..fe8d1c202 100644
--- a/java/testing/org/apache/derbyTesting/junit/SecurityManagerSetup.java
+++ b/java/testing/org/apache/derbyTesting/junit/SecurityManagerSetup.java
@@ -353,6 +353,11 @@ public final class SecurityManagerSetup extends TestSetup {
         if (antjunit != null)
             classPathSet.setProperty("derbyTesting.antjunit", antjunit.toExternalForm());
 
+        URL ant = getURL("org.apache.tools.ant.Task");
+        if (ant != null) {
+            classPathSet.setProperty("derbyTesting.ant", ant.toExternalForm());
+        }
+
         // variables for lucene jar files
         URL luceneCore = getURL( "org.apache.lucene.store.FSDirectory" );
         if ( luceneCore != null )
