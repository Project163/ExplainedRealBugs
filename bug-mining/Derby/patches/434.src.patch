diff --git a/java/testing/org/apache/derbyTesting/functionTests/harness/RunTest.java b/java/testing/org/apache/derbyTesting/functionTests/harness/RunTest.java
index ab482196e..f7a9432ee 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/harness/RunTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/harness/RunTest.java
@@ -275,8 +275,12 @@ public class RunTest
 	    sb.append(startTime + " ***");
 	    System.out.println(sb.toString());
 	    pwDiff.println(sb.toString());
-	    
-        // Run the Server if needed
+
+ 	    // before going further, get the policy file copied and if
+ 	    // needed, modify it with the test's policy file
+ 	    composePolicyFile();
+     
+            // Run the Server if needed
 	    if ((driverName != null) && (!skiptest) )
 	    {
             System.out.println("Initialize for framework: "+ framework );
@@ -2229,7 +2233,7 @@ clp.list(System.out);
                         +"="+encryptionAlgorithm+"\"");
         }
         jvm.setD(jvmProps);
-        
+       
         // set security properties
         if (!runWithoutSecurityManager)
             jvm.setSecurityProps();
@@ -2310,9 +2314,43 @@ clp.list(System.out);
         return sCmd;
     }
 
+    public static void composePolicyFile() throws ClassNotFoundException
+    {
+        try{
+            //DERBY-892: allow for test-specific policy additions
+
+            // first get the default policy file
+            String default_policy = "util/derby_tests.policy";
+            File userDirHandle = new File(userdir);
+            CopySuppFiles.copyFiles(userDirHandle, default_policy);
+
+            // now get the test specific policy file and append
+            InputStream newpolicy =
+                loadTestResource("tests/" + testDirName + "/" + testBase + ".policy");
+            if (newpolicy != null)
+            {
+                File oldpolicy = new File(runDir,"derby_tests.policy");
+                //if (oldpolicy.exists()) System.out.println("Appending to derby_tests.policy");
+                BufferedReader policyadd = new BufferedReader(new InputStreamReader(newpolicy, "UTF-8"));
+                FileWriter policyfw = new FileWriter(oldpolicy.getPath(), true);
+                PrintWriter policypw = new PrintWriter( new BufferedWriter(policyfw, 10000), true );
+                String str = "";
+                while ( (str = policyadd.readLine()) != null ) { policypw.println(str); }
+                policypw.close();
+                policyadd.close();
+                policypw= null;
+                newpolicy = null;
+            }
+        } catch (IOException ie) {
+            System.out.println("Exception trying to create policy file: ");
+            ie.printStackTrace(); 
+        }
+    }
+
     private static void execTestProcess(String[] testCmd)
         throws Exception
     {
+    	composePolicyFile();
         
         // Execute the process and handle the results
     	Process pr = null;
@@ -2435,6 +2473,7 @@ clp.list(System.out);
     	
     	// Install a security manager within this JVM for this test.
     	boolean installedSecurityManager = installSecurityManager();
+    	composePolicyFile();
     	if (testType.equals("sql"))
     	{
     	    String[] ijarg = new String[3];
diff --git a/java/testing/org/apache/derbyTesting/functionTests/harness/jvm.java b/java/testing/org/apache/derbyTesting/functionTests/harness/jvm.java
index b63cba890..908cc7e2e 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/harness/jvm.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/harness/jvm.java
@@ -340,8 +340,6 @@ public abstract class jvm {
 		String policyFile = System.getProperty("serverPolicyFile");
 		if (policyFile == null)
 		{
-				File userDirHandle = new File(userDir);
-				CopySuppFiles.copyFiles(userDirHandle,DEFAULT_POLICY);
 				policyFile = userDir + baseName(DEFAULT_POLICY);
 		}
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NSinSameJVM.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NSinSameJVM.policy
new file mode 100644
index 000000000..f5ad557be
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NSinSameJVM.policy
@@ -0,0 +1,14 @@
+//
+// test specific permissions for test:
+// derbynet/NSinSameJVM.java
+//
+grant codeBase "${derbyTesting.codeclasses}" {
+  // this test uses port 2000
+  permission java.net.SocketPermission "0.0.0.0:20000", "connect";
+};
+
+grant codeBase "${derbyTesting.codejar}/derbynet.jar" {
+  // this test uses port 2000
+  permission java.net.SocketPermission "0.0.0.0:20000", "connect";
+};
+
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/OutBufferedStream.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/OutBufferedStream.policy
new file mode 100644
index 000000000..551b99c09
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/OutBufferedStream.policy
@@ -0,0 +1,13 @@
+//
+// test specific permissions for test:
+// lang/OutBufferedStream.java
+//
+grant codeBase "${derbyTesting.codejar}derbyTesting.jar" {
+  permission java.lang.RuntimePermission "setIO";
+  
+};
+
+grant codeBase "${derbyTesting.codeclasses}" {
+  permission java.lang.RuntimePermission "setIO";
+  
+};
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/build.xml b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/build.xml
index cbfef6b66..fa4cc2afc 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/build.xml
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/build.xml
@@ -99,7 +99,7 @@
   <target name="copyfiles">
     <copy todir="${out.dir}/${derby.testing.functest.dir}/tests/derbynet">
       <fileset dir="${derby.testing.src.dir}/${derby.testing.functest.dir}/tests/derbynet" 
-        includes="*.inc,*.properties,*.sql,*.tests"/>
+        includes="*.inc,*.policy,*.properties,*.sql,*.tests"/>
     </copy>
   </target> 
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/dataSourcePermissions_net.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/dataSourcePermissions_net.policy
new file mode 100644
index 000000000..ed6834cce
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/dataSourcePermissions_net.policy
@@ -0,0 +1,13 @@
+//
+// test specific permissions for test:
+// lang/dataSourcePermissions_net.java
+//
+grant codeBase "${derbyTesting.codejar}derbyTesting.jar" {
+  permission java.lang.RuntimePermission "setIO";
+  
+};
+
+grant codeBase "${derbyTesting.codeclasses}" {
+  permission java.lang.RuntimePermission "setIO";
+  
+};
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/getCurrentProperties.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/getCurrentProperties.policy
new file mode 100644
index 000000000..41f4ac4da
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/getCurrentProperties.policy
@@ -0,0 +1,9 @@
+//
+// test specific permissions for test:
+// derbynet/getCurrentProperties.java
+//
+grant codeBase "${derbyTesting.codejar}/derbynet.jar" {
+  // tracing files default to derby.system.home, need write permission
+  permission java.io.FilePermission "${derby.system.home}${/}*", "write";  
+};
+
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/sysinfo.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/sysinfo.policy
new file mode 100644
index 000000000..5d65cc5ef
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/sysinfo.policy
@@ -0,0 +1,28 @@
+//
+// test specific permissions for test:
+// derbynet/sysinfo.java
+//
+grant codeBase "${derbyTesting.codejar}/derbyTesting.jar" {
+  //client side: test execs another jvm with relative path
+  permission java.io.FilePermission "<<ALL FILES>>", "execute";
+};
+
+// See DERBY-622
+grant codeBase "${derbyTesting.codejar}/derby.jar" {
+  permission java.io.FilePermission "${derbyTesting.codedir}${/}*", "read";
+};
+
+grant codeBase "${derbyTesting.codejar}/derbynet.jar" {
+  permission java.io.FilePermission "${derbyTesting.codedir}${/}*", "read";
+};
+
+grant codeBase "${derbyTesting.codejar}/derbytools.jar" {
+  permission java.io.FilePermission "${derbyTesting.codedir}${/}*", "read";
+};
+
+grant codeBase "${derbyTesting.codeclasses}" {
+  permission java.io.FilePermission "${derbyTesting.codedir}", "read";
+  permission java.io.FilePermission "${derbyTesting.codeclasses}${/}*", "read";
+  //client side: test execs another jvm with relative path
+  permission java.io.FilePermission "<<ALL FILES>>", "execute";
+};
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/sysinfo_app.properties b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/sysinfo_app.properties
index ee4b2bcbe..e69de29bb 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/sysinfo_app.properties
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/sysinfo_app.properties
@@ -1,9 +0,0 @@
-usedefaults=true
-
-#exclude with SecurityManager
-# test execs another jvm with a relative path that means
-# the permission FilePermission("<<ALL FILES>>","execute")
-# would be required. Don't want to grant such a wide permission
-# to the testing jar.
-noSecurityManager=true
-
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/sysinfo_withproperties.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/sysinfo_withproperties.policy
new file mode 100644
index 000000000..c2c2edb4b
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/sysinfo_withproperties.policy
@@ -0,0 +1,28 @@
+//
+// test specific permissions for test:
+// derbynet/sysinfo_withproperties.java
+//
+grant codeBase "${derbyTesting.codejar}/derbyTesting.jar" {
+  //client side: test execs another jvm with relative path
+  permission java.io.FilePermission "<<ALL FILES>>", "execute";
+};
+
+// See DERBY-622
+grant codeBase "${derbyTesting.codejar}/derby.jar" {
+  permission java.io.FilePermission "${derbyTesting.codedir}${/}*", "read";
+};
+
+grant codeBase "${derbyTesting.codejar}/derbynet.jar" {
+  permission java.io.FilePermission "${derbyTesting.codedir}${/}*", "read";
+};
+
+grant codeBase "${derbyTesting.codejar}/derbytools.jar" {
+  permission java.io.FilePermission "${derbyTesting.codedir}${/}*", "read";
+};
+
+grant codeBase "${derbyTesting.codeclasses}" {
+  permission java.io.FilePermission "${derbyTesting.codedir}", "read";
+  permission java.io.FilePermission "${derbyTesting.codeclasses}${/}*", "read";
+  //client side: test execs another jvm with relative path
+  permission java.io.FilePermission "<<ALL FILES>>", "execute";
+};
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/sysinfo_withproperties_app.properties b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/sysinfo_withproperties_app.properties
index ee4b2bcbe..e69de29bb 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/sysinfo_withproperties_app.properties
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/sysinfo_withproperties_app.properties
@@ -1,9 +0,0 @@
-usedefaults=true
-
-#exclude with SecurityManager
-# test execs another jvm with a relative path that means
-# the permission FilePermission("<<ALL FILES>>","execute")
-# would be required. Don't want to grant such a wide permission
-# to the testing jar.
-noSecurityManager=true
-
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testSecMec.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testSecMec.policy
new file mode 100644
index 000000000..e15632f1e
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testSecMec.policy
@@ -0,0 +1,13 @@
+//
+// test specific permissions for test:
+// lang/testSecMec.java
+//
+grant codeBase "${derbyTesting.codejar}derbyTesting.jar" {
+  permission java.lang.RuntimePermission "setIO";
+  
+};
+
+grant codeBase "${derbyTesting.codeclasses}" {
+  permission java.lang.RuntimePermission "setIO";
+  
+};
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/build.xml b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/build.xml
index 286099f58..92b8af751 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/build.xml
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/build.xml
@@ -145,7 +145,7 @@
   <target name="copyfiles">
     <copy todir="${out.dir}/${derby.testing.functest.dir}/tests/jdbcapi">
       <fileset dir="${derby.testing.src.dir}/${derby.testing.functest.dir}/tests/jdbcapi" 
-        includes="*.gif,*.properties,*.sql,*.utf"/>
+        includes="*.gif,*.properties,*.sql,*.utf,*.policy"/>
     </copy>
   </target> 
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/secureUsers1.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/secureUsers1.policy
new file mode 100644
index 000000000..9ecebc0bf
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/secureUsers1.policy
@@ -0,0 +1,21 @@
+//
+// test specific permissions for test:
+// jdbcapi/secureUsers1.sql
+//
+grant codeBase "${derbyTesting.codeclasses}" {
+  // sane=true
+  permission java.io.FilePermission "${user.dir}${/}CloudLDAP.out", "write"; 
+};
+
+grant codeBase "${derbyTesting.codejar}/derby.jar" {
+  permission java.io.FilePermission "${user.dir}${/}CloudLDAP.out", "write"; 
+};
+  
+grant codeBase "${derbyTesting.codejar}/derbynet.jar" {
+  permission java.io.FilePermission "${user.dir}${/}CloudLDAP.out", "write"; 
+};
+  
+grant codeBase "${derbyTesting.codejar}/derbytools.jar" {
+  permission java.io.FilePermission "${user.dir}${/}CloudLDAP.out", "write"; 
+};
+
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/build.xml b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/build.xml
index 9c307b5bf..f5ad1a4d1 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/build.xml
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/build.xml
@@ -129,7 +129,7 @@
   <target name="copyfiles">
     <copy todir="${out.dir}/${derby.testing.functest.dir}/tests/lang">
       <fileset dir="${derby.testing.src.dir}/${derby.testing.functest.dir}/tests/lang" 
-        includesfile="${derby.testing.src.dir}/${derby.testing.functest.dir}/tests/lang/copyfiles.ant"/>  
+        includes="*.sql,*.properties,*.subsql,*.policy,*.jar,xmlTestFiles/*"/>  
     </copy>
   </target> 
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/copyfiles.ant b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/copyfiles.ant
index 40a545637..e69de29bb 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/copyfiles.ant
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/copyfiles.ant
@@ -1,257 +0,0 @@
-db2Compatibility_app.properties
-DB2IsolationLevels.sql
-LOB.sql
-LOBDB2compatibility.sql
-LOBDB2compatibility_derby.properties
-LockTableQuery.subsql
-AggregateClassLoading_app.properties
-aggbuiltin.sql
-aggbuiltin_app.properties
-aggregate.sql
-aggregateOptimization.sql
-aggregateOptimization_app.properties
-aggregateOptimization_derby.properties
-altertable.sql
-altertable_derby.properties
-arithmetic.sql
-authorize.sql
-authorize_app.properties
-authorize_derby.properties
-autoincrement.sql
-autoincrement_app.properties
-bit.sql
-bit2.sql
-big.sql
-big_derby.properties
-case.sql
-cast.sql
-cast_app.properties
-checkConstraint.sql
-closed_app.properties
-columnDefaults.sql
-columnDefaults_app.properties
-comparisons.sql
-comparisons_app.properties
-compressTable.sql
-compressTable_app.properties
-compressTable_derby.properties
-connect.sql
-connect_app.properties
-connect_derby.properties
-consistencyChecker.sql
-constantExpression.sql
-createTestProcedures.subsql
-currentSchema.sql
-currentSchema_app.properties
-currentof_derby.properties
-cursorerrors.sql
-cursorerrors_app.properties
-cursorerrors_derby.properties
-datetime.sql
-db2Compatibility.sql
-dbManagerLimits_app.properties
-dcl.sql
-dcl_app.properties
-dcl_emc1.jar
-dcl_emc2.jar
-dcl_emc2l.jar
-dcl_emc2s.jar
-dcl_emc2sm.jar
-dcl_emcaddon.jar
-dcl_readOnly.sql
-ddlTableLockMode.sql
-ddlTableLockMode_app.properties
-deadlockMode_derby.properties
-deadlockMode_sed.properties
-declareGlobalTempTableJava_derby.properties
-declareGlobalTempTableJavaJDBC30_app.properties
-default_app.properties
-default_derby.properties
-delete.sql
-depend.sql
-derived.sql
-desc_index.sql
-desc_index_app.properties
-distinct.minisql
-distinct.sql
-distinct.subsql
-distinctElimination.sql
-distinctElimination_derby.properties
-distinctFiltering.sql
-distinct_app.properties
-distinct_derby.properties
-dropTable.sql
-dynamicLikeOptimization.sql
-dynamicLikeOptimization_app.properties
-dynamicLikeOptimization_derby.properties
-ejbql.sql
-ejbql_app.properties
-ejbql_nonSPS.sql
-emptyStatistics_derby.properties
-emptyStatistics.sql
-errorCode.sql
-errorCode_app.properties
-errorStream.sql
-errorStream_app.properties
-fk_nonSPS.sql
-fk_nonSPS_derby.properties
-floattypes.sql
-floattypes_app.properties
-forupdate.sql
-functions.sql
-functions_app.properties
-GetPropertyInfoTest_app.properties
-groupBy.sql
-holdCursorJavaReflection_app.properties
-holdCursorJava_app.properties
-holdCursorIJ.sql
-holdCursorIJ_app.properties
-identifier.sql
-implicitConversions.sql
-implicitConversions_app.properties
-implicitConversions_derby.properties
-inbetween.sql
-inbetween_derby.properties
-infostreams.sql
-infostreams_derby.properties
-innerjoin.sql
-insert.sql
-insert_sed.properties
-intersect.sql
-isolationLevels.sql
-joinDeadlock.sql
-joinDeadlock.sql1
-joinDeadlock.sql2
-joinDeadlock_app.properties
-joinDeadlock_derby.properties
-joins.sql
-joins_app.properties
-largeCodeGen_app.properties
-langUnitTests.sql
-langUnitTests_derby.properties
-LOBDB2compatibility_app.properties
-lockTable.sql
-lockTable_app.properties
-lockTable_derby.properties
-logop.sql
-logStream_app.properties
-lojreorder.sql
-longStringColumn_derby.properties
-maxMemPerTab_app.properties
-maxMemPerTab_derby.properties
-miscerrors.sql
-modifyColumn.sql
-nestedCommit.sql
-nestedCommit_app.properties
-nonreserved.sql
-nulls.sql
-openScans.sql
-openScans_derby.properties
-optimizerOverrides.sql
-orderby.sql
-orderbyElimination.sql
-orderbyElimination_derby.properties
-outerjoin.sql
-outparams_app.properties
-paramij.sql
-partdml.sql
-partdml_app.properties
-positionedDelUpd.sql
-precedence.sql
-predicatePushdown.sql
-predicatePushdown_derby.properties
-predicatesIntoViews.sql
-predicatesIntoViews_derby.properties
-primarykey.sql
-procedure_app.properties
-procedure_derby.properties
-procedureJdbc30_app.properties
-refActions.sql
-refActions1.sql
-refActions2.sql
-refActions3.sql
-refActions4.sql
-refActions4_derby.properties
-refActions5.sql
-refActions5_derby.properties
-refActions6.sql
-refActions_derby.properties
-releaseCompileLocks.sql
-releaseCompileLocks_app.properties
-renameIndex.sql
-renameIndex_derby.properties
-renameTable.sql
-renameTable_derby.properties
-reopenScan.sql
-repeat_app.properties
-repeat_derby.properties
-schemas.sql
-scrollCursors1.sql
-scrollCursors1_sed.properties
-scrollCursors3.sql
-scrollCursors3_app.properties
-select.sql
-selectivity.sql
-selectivity_app.properties
-selectivity_derby.properties
-simpleScroll.sql
-specjPlans.sql
-specjPlans_app.properties
-staleplans.sql
-staleplans_app.properties
-staleplans_derby.properties
-stmtCacheAliases.subsql
-stmtCacheAliasesRemove.subsql
-stmtCache0.sql
-stmtCache0_derby.properties
-stmtCache1.sql
-stmtCache1_app.properties
-stmtCache1_derby.properties
-stmtCache3_derby.properties
-stringtypes.sql
-subquery.sql
-subquery2.sql
-subquery2_derby.properties
-subqueryFlattening.sql
-subqueryFlattening_derby.properties
-subquery_derby.properties
-supersimple.sql
-supersimple_app.properties
-supersimple_derby.properties
-syscat.sql
-syscat_app.properties
-synonym.sql
-tempRestrictions.sql
-triggerBeforeTrig.sql
-triggerGeneral.sql
-triggerGeneral_app.properties
-triggerGeneral_derby.properties
-triggerRecursion.sql
-triggerRecursion_derby.properties
-triggerRefClause.sql
-triggerRefClause_app.properties
-triggerStream_app.properties
-triggerStream_derby.properties
-unaryArithmeticDynamicParameter_app.properties
-ungroupedAggregatesNegative.sql
-union.sql
-unlimited.sql
-unlimited2.sql
-update.sql
-updateCursor_derby.properties
-updatableResultSet_app.properties
-updatableResultSet_sed.properties
-valuesclause.sql
-views.sql
-wisc_setup.sql
-wisconsin_app.properties
-wisconsin_derby.properties
-wisconsin_sed.properties
-xml_general.sql
-xmlBinding_app.properties
-xmlTestFiles/*
-grantRevoke.java
-grantRevoke_app.properties
-grantRevoke_derby.properties
-grantRevokeDDL.sql
-grantRevokeDDL_app.properties
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/errorStream.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/errorStream.policy
new file mode 100644
index 000000000..fedf9eaf8
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/errorStream.policy
@@ -0,0 +1,13 @@
+//
+// test specific permissions for test:
+// lang/errorStream.java
+//
+grant codeBase "${derbyTesting.codejar}derbyTesting.jar" {
+  permission java.lang.RuntimePermission "setIO";
+  
+};
+
+grant codeBase "${derbyTesting.codeclasses}" {
+  permission java.lang.RuntimePermission "setIO";
+  
+};
diff --git a/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy b/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
index cf94f32f9..f9b77817b 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
@@ -26,9 +26,10 @@ grant codeBase "${derbyTesting.codejar}derby.jar" {
   permission java.util.PropertyPermission "derby.*", "read";
   permission java.util.PropertyPermission "java.class.path", "read";//sysinfo
   
-  // for unit tests
-  permission java.util.PropertyPermission "derbyTesting.unittest.*", "read";
-  
+  // unit tests (e.g. store/T_RecoverFullLog) set this property 
+  // (called from derbyTesting.jar through code in derby.jar)
+  permission java.util.PropertyPermission "derbyTesting.unittest.*", "write";
+
   permission java.lang.RuntimePermission "createClassLoader";
   
   permission java.io.FilePermission "${derby.system.home}${/}derby.properties", "read";
@@ -44,16 +45,6 @@ grant codeBase "${derbyTesting.codejar}derby.jar" {
   permission java.io.FilePermission "${user.dir}${/}extout${/}-", "write";
   permission java.io.FilePermission "${user.dir}${/}extinout", "read,write";
   
-  // unit tests (e.g. store/T_RecoverFullLog) set this property 
-  // (called from derbyTesting.jar through code in derby.jar)
-  permission java.util.PropertyPermission "derbyTesting.unittest.*", "write";
-
-  // BUG DERBY-622 derbynet/sysinfo.java
-  permission java.io.FilePermission "${derbyTesting.codedir}${/}*", "read";
-  
-  // sane=true, jdbcapi/secureUsers1.sql
-  permission java.io.FilePermission "${user.dir}${/}CloudLDAP.out", "write"; 
-  
   // These permissions are needed to load the JCE for encryption with Sun and IBM JDK131.
   // JDK14 has the JCE  preloaded
   permission java.security.SecurityPermission "insertProvider.SunJCE";
@@ -74,20 +65,6 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar" {
   permission java.net.SocketPermission "${derbyTesting.clienthost}", "accept,connect";
   permission java.net.SocketPermission "${derbyTesting.serverhost}", "accept,connect";
   
-  // derbynet/NSinSameJVM uses this addres for its serverControl 
-  permission java.net.SocketPermission "0.0.0.0:20000", "connect";
-  
-    
-  // tracing files default to derby.system.home, derbynet/getCurrentProperties.java 
-  permission java.io.FilePermission "${derby.system.home}${/}*", "write";  
-  
-  // BUG DERBY-622 derbynet/sysinfo.java
-  permission java.io.FilePermission "${derbyTesting.codedir}${/}*", "read";
-  
-  // sane=true, jdbcapi/secureUsers1.sql
-  permission java.io.FilePermission "${user.dir}${/}CloudLDAP.out", "write"; 
-
-
 };
 
 //
@@ -108,17 +85,12 @@ grant codeBase "${derbyTesting.codejar}derbytools.jar" {
   // Access all properties using System.getProperties
   permission java.util.PropertyPermission "*", "read, write";
   
-  // BUG DERBY-622 derbynet/sysinfo.java
-  permission java.io.FilePermission "${derbyTesting.codedir}${/}*", "read";
-
   // Read all files under ${user.dir}
   permission java.io.FilePermission "${user.dir}${/}-", "read";
   
   // ij needs permission to read the sql files in this jar
   permission java.io.FilePermission "${derbyTesting.codedir}${/}derbyTesting.jar", "read";
   
-  // sane=true, jdbcapi/secureUsers1.sql
-  permission java.io.FilePermission "${user.dir}${/}CloudLDAP.out", "write"; 
 };
 
 //
@@ -137,19 +109,12 @@ grant codeBase "${derbyTesting.codejar}derbyTesting.jar" {
   // the security manager.
   permission java.lang.RuntimePermission "setSecurityManager";
   
-  // lang/errorStream.java
-  permission java.lang.RuntimePermission "setIO";
-  
 };
 
 //
 // super-set of the jar permissions for running out of the classes directory
 //
 grant codeBase "${derbyTesting.codeclasses}" {
-  // BUG DERBY-622 derbynet/sysinfo.java
-  permission java.io.FilePermission "${derbyTesting.codedir}${/}*", "read";
-  permission java.io.FilePermission "${derbyTesting.codedir}", "read";
-  
   // Access all properties using System.getProperties
   permission java.util.PropertyPermission "*", "read, write";
   
@@ -167,9 +132,6 @@ grant codeBase "${derbyTesting.codeclasses}" {
   permission java.net.SocketPermission "${derbyTesting.clienthost}", "accept,connect";
   permission java.net.SocketPermission "${derbyTesting.serverhost}", "connect,resolve";
   
-  // derbynet/NSinSameJVM uses this addres for its serverControl 
-  permission java.net.SocketPermission "0.0.0.0:20000", "connect";
-  
   // Access all files under ${user.dir}to write the test directory structure
   // Also covers extin, extout and extinout locations
   permission java.io.FilePermission "${user.dir}${/}-", "read,write,delete"; 
@@ -178,17 +140,11 @@ grant codeBase "${derbyTesting.codeclasses}" {
   // the security manager.
   permission java.lang.RuntimePermission "setSecurityManager";
     
-  // sane=true, jdbcapi/secureUsers1.sql
-  permission java.io.FilePermission "${user.dir}${/}CloudLDAP.out", "write"; 
-  
   // These permissions are needed to load the JCE for encryption with Sun and IBM JDK131.
   // JDK14 has the JCE  preloaded
   permission java.security.SecurityPermission "insertProvider.SunJCE";
   permission java.security.SecurityPermission "insertProvider.IBMJCE";
-  
-  // lang/errorStream.java
-  permission java.lang.RuntimePermission "setIO";
-  
+
 };
 
 // JUnit jar file tries to read junit.properties in the user's
@@ -203,5 +159,3 @@ grant {
     permission java.util.PropertyPermission "user.home", "read";
     permission java.io.FilePermission "${user.home}${/}junit.properties", "read";
 };
-
-
