diff --git a/java/engine/org/apache/derby/impl/services/jce/JCECipherFactory.java b/java/engine/org/apache/derby/impl/services/jce/JCECipherFactory.java
index 62fb55d40..28e878171 100644
--- a/java/engine/org/apache/derby/impl/services/jce/JCECipherFactory.java
+++ b/java/engine/org/apache/derby/impl/services/jce/JCECipherFactory.java
@@ -21,6 +21,7 @@
 
 package org.apache.derby.impl.services.jce;
 
+import org.apache.derby.iapi.security.SecurityUtil;
 import org.apache.derby.iapi.services.crypto.CipherFactory;
 import org.apache.derby.iapi.services.crypto.CipherProvider;
 
@@ -60,7 +61,7 @@ import org.apache.derby.io.StorageRandomAccessFile;
 
 	@see CipherFactory
  */
-public final class JCECipherFactory implements CipherFactory
+final class JCECipherFactory implements CipherFactory
 {
     private final static String MESSAGE_DIGEST = "MD5";
 
@@ -116,11 +117,14 @@ public final class JCECipherFactory implements CipherFactory
      *                  For example to reencrypt the database with 
      *                  a new password.
      */
-    public JCECipherFactory(boolean create, 
+    JCECipherFactory(boolean create, 
                             Properties props,
                             boolean newAttributes) 
         throws StandardException
     {
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+
         init(create, props, newAttributes);
     }
     
diff --git a/java/engine/org/apache/derby/impl/services/jce/JCECipherFactoryBuilder.java b/java/engine/org/apache/derby/impl/services/jce/JCECipherFactoryBuilder.java
index 82e6fa0fd..f14528c23 100644
--- a/java/engine/org/apache/derby/impl/services/jce/JCECipherFactoryBuilder.java
+++ b/java/engine/org/apache/derby/impl/services/jce/JCECipherFactoryBuilder.java
@@ -1,6 +1,6 @@
 /*
 
-   Derby - Class org.apache.derby.iapi.services.crypto.JCECipherFactoryBuilder
+   Derby - Class org.apache.derby.impl.services.jce.JCECipherFactoryBuilder
 
    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/NoDBInternalsPermissionTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/NoDBInternalsPermissionTest.java
index 97fbc38a0..2c81e425c 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/NoDBInternalsPermissionTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/NoDBInternalsPermissionTest.java
@@ -33,6 +33,7 @@ import org.apache.derbyTesting.junit.TestConfiguration;
 
 import org.apache.derby.iapi.services.context.ContextService;
 import org.apache.derby.impl.jdbc.EmbedConnection;
+import org.apache.derby.impl.services.jce.JCECipherFactoryBuilder;
 
 /**
  * <p>
@@ -140,4 +141,21 @@ public class NoDBInternalsPermissionTest extends GeneratedColumnsHelper
         }
         catch (AccessControlException e) { println( "Caught an AccessControlException" ); }
     }
+
+    /**
+     * <p>
+     * Verify that you need usederbyinternals permission to create a cipher factory.
+     * See DERBY-6630.
+     * </p>
+     */
+    public  void    test_003_JCECipherFactory()
+        throws Exception
+    {
+        try {
+            JCECipherFactoryBuilder builder = new JCECipherFactoryBuilder();
+            builder.createCipherFactory( true, null, true );
+            fail( "Should have raised an AccessControlException" );
+        }
+        catch (AccessControlException e) { println( "Caught an AccessControlException" ); }
+    }
 }
