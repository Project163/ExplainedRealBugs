diff --git a/java/engine/org/apache/derby/iapi/sql/dictionary/DataDictionary.java b/java/engine/org/apache/derby/iapi/sql/dictionary/DataDictionary.java
index ebbb11f6b..c935ae148 100644
--- a/java/engine/org/apache/derby/iapi/sql/dictionary/DataDictionary.java
+++ b/java/engine/org/apache/derby/iapi/sql/dictionary/DataDictionary.java
@@ -217,6 +217,13 @@ public interface DataDictionary
 	public static final int COMPILE_ONLY_MODE = 0;
 	public static final int DDL_MODE = 1;
 
+	/**
+	 * Clear the DataDictionary caches, including the sequence caches if requested..
+	 *
+	 * @exception StandardException Standard Derby error policy
+	 */
+	public void clearCaches( boolean clearSequenceCaches ) throws StandardException;
+
 	/**
 	 * Clear all of the DataDictionary caches.
 	 *
diff --git a/java/engine/org/apache/derby/impl/sql/catalog/DataDictionaryImpl.java b/java/engine/org/apache/derby/impl/sql/catalog/DataDictionaryImpl.java
index 17c66b666..3fa449b4f 100644
--- a/java/engine/org/apache/derby/impl/sql/catalog/DataDictionaryImpl.java
+++ b/java/engine/org/apache/derby/impl/sql/catalog/DataDictionaryImpl.java
@@ -1310,8 +1310,10 @@ public final class	DataDictionaryImpl
 						/* Switch the caching mode to DDL */
 						setCacheMode(DataDictionary.DDL_MODE);
 	
-						/* Clear out all the caches */
-						clearCaches();
+						// Until we implement ALTER SEQUENCE, there should be no need
+                        // to clear the sequence cache. Always clearing the sequence cache
+                        // here gives rise to DERBY-6137.
+						clearCaches( false );
 					}
 		
 					/* Keep track of the number of DDL users */
@@ -9121,12 +9123,22 @@ public final class	DataDictionaryImpl
 	 * @exception StandardException Standard Derby error policy
 	 */
 	public void clearCaches() throws StandardException
+	{
+        clearCaches( true );
+    }
+    
+	/**
+	 * Clear the DataDictionary caches, including the sequence caches if requested..
+	 *
+	 * @exception StandardException Standard Derby error policy
+	 */
+	public void clearCaches( boolean clearSequenceCaches ) throws StandardException
 	{
 		nameTdCache.cleanAll();
 		nameTdCache.ageOut();
 		OIDTdCache.cleanAll();
 		OIDTdCache.ageOut();
-        clearSequenceCaches();
+        if ( clearSequenceCaches ) { clearSequenceCaches(); }
 		if (spsNameCache != null)
 		{
 			//System.out.println("CLEARING SPS CACHE");
diff --git a/java/engine/org/apache/derby/impl/sql/execute/DropSequenceConstantAction.java b/java/engine/org/apache/derby/impl/sql/execute/DropSequenceConstantAction.java
index 26c7429cf..94bc32b10 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/DropSequenceConstantAction.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/DropSequenceConstantAction.java
@@ -91,6 +91,7 @@ class DropSequenceConstantAction extends DDLConstantAction {
         ** the transaction.
         */
         dd.startWriting(lcc);
+        dd.clearSequenceCaches();
 
         SequenceDescriptor sequenceDescriptor = dd.getSequenceDescriptor(schemaDescriptor, sequenceName);
 
@@ -101,6 +102,5 @@ class DropSequenceConstantAction extends DDLConstantAction {
         }
 
         sequenceDescriptor.drop(lcc);
-
     }
 }
diff --git a/java/storeless/org/apache/derby/impl/storeless/EmptyDictionary.java b/java/storeless/org/apache/derby/impl/storeless/EmptyDictionary.java
index f3f1cdd4a..91d0b6d97 100644
--- a/java/storeless/org/apache/derby/impl/storeless/EmptyDictionary.java
+++ b/java/storeless/org/apache/derby/impl/storeless/EmptyDictionary.java
@@ -78,6 +78,8 @@ import org.apache.derby.iapi.types.RowLocation;
  */
 public class EmptyDictionary implements DataDictionary, ModuleSupportable {
 
+	public void clearCaches( boolean clearSequenceCaches ) {}
+    
 	public void clearCaches() throws StandardException {
 		// Auto-generated method stub
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SequenceTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SequenceTest.java
index cbda0b163..50d7e63a6 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SequenceTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/SequenceTest.java
@@ -556,4 +556,82 @@ public class SequenceTest extends GeneratedColumnsHelper {
         goodStatement( conn, "create table t_5254( cycle int, minvalue int, maxvalue int )" );
         goodStatement( conn, "drop table t_5254" );
     }
+    
+    /**
+     * Verify that trigger recompilation doesn't choke trying to create
+     * two nested writable transactions.
+     */
+    public void test_16_6137() throws Exception
+    {
+        Connection conn = openUserConnection( TEST_DBO );
+
+        goodStatement( conn, "call syscs_util.syscs_set_database_property( 'derby.language.sequence.preallocator', '2' )" );
+        goodStatement( conn, "create table t_6137( rateID int generated always as identity primary key, amount decimal( 5,2 ) )" );
+        goodStatement( conn, "create table t_history_6137( changeID int primary key, amount decimal( 5,2 ) )" );
+        goodStatement( conn, "create sequence seq_6137 start with 1" );
+        goodStatement
+            (
+             conn,
+             "create trigger trg_t_6137_hist_del\n" +
+             "after delete on t_6137\n" +
+             "referencing old row as old\n" +
+             "for each row\n" +
+             " insert into t_history_6137 ( changeID, amount ) values (( next value for seq_6137 ), old.amount )\n"
+             );
+        goodStatement( conn, "insert into t_6137( amount ) values ( 30.04 ), ( 60.04 ), ( 90.04 )" );
+
+        // invalidate the stored statements so that the trigger will have to be recompiled
+        goodStatement( conn, "call syscs_util.syscs_invalidate_stored_statements()" );
+
+        // put the sequence in the cache
+        assertResults
+            (
+             conn,
+             "values next value for seq_6137",
+             new String[][]
+             {
+                 { "1" },
+             },
+             true
+             );
+
+        // verify that the trigger recompiles and fires correctly
+        goodStatement( conn, "delete from t_6137 where rateID = 1" );
+        goodStatement( conn, "delete from t_6137 where rateID = 2" );
+        assertResults
+            (
+             conn,
+             "select * from t_history_6137 order by changeID",
+             new String[][]
+             {
+                 { "2", "30.04" },
+                 { "3", "60.04" },
+             },
+             true
+             );
+
+        // verify current value of sequence
+        String  peekAtSequence = "values syscs_util.syscs_peek_at_sequence('" + TEST_DBO + "', 'SEQ_6137')";
+        assertResults
+            (
+             conn,
+             peekAtSequence,
+             new String[][]
+             {
+                 { "4" },
+             },
+             true
+             );
+
+        // tidy up
+        goodStatement( conn, "drop trigger trg_t_6137_hist_del" );
+        goodStatement( conn, "drop table t_history_6137" );
+        goodStatement( conn, "drop table t_6137" );
+        goodStatement( conn, "drop sequence seq_6137 restrict" );
+        goodStatement( conn, "call syscs_util.syscs_set_database_property( 'derby.language.sequence.preallocator', null )" );
+
+        // verify that the uncleared cache does not leave a phantom sequence hanging around
+        expectExecutionError( conn, MISSING_OBJECT, peekAtSequence );
+        expectCompilationError( conn, OBJECT_DOES_NOT_EXIST, "values next value for seq_6137" );
+    }
 }
