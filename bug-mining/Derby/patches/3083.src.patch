diff --git a/java/engine/org/apache/derby/impl/services/reflect/ReflectClassesJava2.java b/java/engine/org/apache/derby/impl/services/reflect/ReflectClassesJava2.java
index 044ee1ae5..65c968b05 100644
--- a/java/engine/org/apache/derby/impl/services/reflect/ReflectClassesJava2.java
+++ b/java/engine/org/apache/derby/impl/services/reflect/ReflectClassesJava2.java
@@ -20,10 +20,12 @@
  */
 
 package org.apache.derby.impl.services.reflect;
+
+import org.apache.derby.iapi.sql.compile.CodeGeneration;
 import org.apache.derby.iapi.util.ByteArray;
 
 /**
-	Relfect loader with Privileged block for Java 2 security. 
+	Reflect loader with Privileged block for Java 2 security. 
 */
 
 public class ReflectClassesJava2 extends DatabaseClasses
@@ -58,6 +60,20 @@ public class ReflectClassesJava2 extends DatabaseClasses
 			}
 		}
 
+        // Generated class. Make sure that it lives in the org.apache.derby.exe package
+        int     lastDot = fullyQualifiedName.lastIndexOf( "." );
+        String  actualPackage;
+        if ( lastDot < 0 ) { actualPackage = ""; }
+        else
+        {
+            actualPackage = fullyQualifiedName.substring( 0, lastDot + 1 );
+        }
+
+        if ( !CodeGeneration.GENERATED_PACKAGE_PREFIX.equals( actualPackage ) )
+        {
+            throw new IllegalArgumentException( fullyQualifiedName );
+        }
+        
 		action = 1;
 		return ((ReflectLoaderJava2) java.security.AccessController.doPrivileged(this)).loadGeneratedClass(fullyQualifiedName, classDump);
 	}
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/_Suite.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/_Suite.java
index ac01af559..7433c8966 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/_Suite.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/_Suite.java
@@ -260,6 +260,7 @@ public class _Suite extends BaseTestCase  {
         suite.addTest(ConsistencyCheckerTest.suite());
         suite.addTest(Derby5866TriggerOrderTest.suite());
         suite.addTest(NoDBInternalsPermissionTest.suite());
+        suite.addTest(ClassLoadingTest.suite());
         return suite;
 	}
 }
