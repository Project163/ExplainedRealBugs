diff --git a/java/engine/org/apache/derby/impl/sql/compile/FromBaseTable.java b/java/engine/org/apache/derby/impl/sql/compile/FromBaseTable.java
index a410210fd..0ae4fd6b9 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/FromBaseTable.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/FromBaseTable.java
@@ -3085,8 +3085,33 @@ public class FromBaseTable extends FromTable
 	{
 		return getTrulyTheBestAccessPath().getCostEstimate();
 	}
-
-	private void generateMaxSpecialResultSet
+	
+        /* helper method used by generateMaxSpecialResultSet and
+         * generateDistinctScan to return the name of the index if the 
+         * conglomerate is an index. 
+         * @param cd   Conglomerate for which we need to push the index name
+         * @param mb   Associated MethodBuilder
+         * @throws StandardException
+         */
+        private void pushIndexName(ConglomerateDescriptor cd, MethodBuilder mb) 
+          throws StandardException
+        {
+            if (cd.isConstraint()) {
+                DataDictionary dd = getDataDictionary();
+                ConstraintDescriptor constraintDesc = 
+                    dd.getConstraintDescriptor(tableDescriptor, cd.getUUID());
+                mb.push(constraintDesc.getConstraintName());
+            } else if (cd.isIndex())  {
+                mb.push(cd.getConglomerateName());
+            } else {
+             // If the conglomerate is the base table itself, make sure we push null.
+             //  Before the fix for DERBY-578, we would push the base table name 
+             //  and  this was just plain wrong and would cause statistics information to be incorrect.
+              mb.pushNull("java.lang.String");
+            }
+        }
+	
+        private void generateMaxSpecialResultSet
 	(
 		ExpressionClassBuilder	acb,
 		MethodBuilder mb
@@ -3106,7 +3131,8 @@ public class FromBaseTable extends FromTable
 		**		resultSetNumber,			
 		**		resultRowAllocator,			
 		**		conglomereNumber,			
-		**		tableName,			
+		**		tableName,
+		**		optimizeroverride			
 		**		indexName,			
 		**		colRefItem,			
 		**		lockMode,			
@@ -3132,7 +3158,7 @@ public class FromBaseTable extends FromTable
 			mb.push(org.apache.derby.iapi.util.PropertyUtil.sortProperties(tableProperties));
 		else
 			mb.pushNull("java.lang.String");
-		mb.push(cd.getConglomerateName());
+                pushIndexName(cd, mb);
 		mb.push(colRefItem);
 		mb.push(getTrulyTheBestAccessPath().getLockMode());
 		mb.push(tableLockGranularity);
@@ -3167,7 +3193,8 @@ public class FromBaseTable extends FromTable
 		**		resultSetNumber,			
 		**		resultRowAllocator,			
 		**		conglomereNumber,			
-		**		tableName,			
+		**		tableName,
+		**		optimizeroverride			
 		**		indexName,			
 		**		colRefItem,			
 		**		lockMode,			
@@ -3226,7 +3253,7 @@ public class FromBaseTable extends FromTable
 			mb.push(org.apache.derby.iapi.util.PropertyUtil.sortProperties(tableProperties));
 		else
 			mb.pushNull("java.lang.String");
-		mb.push(cd.getConglomerateName());
+		pushIndexName(cd, mb);
 		mb.push(cd.isConstraint());
 		mb.push(colRefItem);
 		mb.push(getTrulyTheBestAccessPath().getLockMode());
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/distinct.out b/java/testing/org/apache/derbyTesting/functionTests/master/distinct.out
index d86eaf67b..6f22c1e3c 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/distinct.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/distinct.out
@@ -2614,7 +2614,7 @@ End Compilation Timestamp : null
 Begin Execution Timestamp : null
 End Execution Timestamp : null
 Statement Execution Plan Text: 
-Distinct Scan ResultSet for NAMES using index xxxxFILTERED-UUIDxxxx at read committed isolation level using instantaneous share row locking: 
+Distinct Scan ResultSet for NAMES at read committed isolation level using instantaneous share row locking: 
 Number of opens = 1
 Hash table size = 3
 Distinct column is column number 1
@@ -2633,10 +2633,8 @@ scan information:
 	Number of rows visited=6
 	Scan type=heap
 	start position:
-	None
-	stop position:
-	None
-	scan qualifiers:
+null	stop position:
+null	scan qualifiers:
 None
 	next qualifiers:
 None
@@ -2681,7 +2679,7 @@ projection = true
 	restriction time (milliseconds) = 0
 	projection time (milliseconds) = 0
 Source result set:
-	Distinct Scan ResultSet for NAMES using index xxxxFILTERED-UUIDxxxx at read committed isolation level using instantaneous share row locking: 
+	Distinct Scan ResultSet for NAMES at read committed isolation level using instantaneous share row locking: 
 	Number of opens = 1
 	Hash table size = 6
 	Distinct columns are column numbers (0,1)
@@ -2700,10 +2698,8 @@ Source result set:
 		Number of rows visited=6
 		Scan type=heap
 		start position:
-	None
-		stop position:
-	None
-		scan qualifiers:
+null		stop position:
+null		scan qualifiers:
 None
 		next qualifiers:
 None
@@ -2784,6 +2780,14 @@ ij> call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(0);
 0 rows inserted/updated/deleted
 ij> drop table names;
 0 rows inserted/updated/deleted
+ij> -- bug 578. 
+declare global temporary table session.ztemp
+( orderID varchar( 50 ) )
+not logged;
+0 rows inserted/updated/deleted
+ij> select orderID from session.ztemp group by orderID;
+ORDERID                                           
+--------------------------------------------------
 ij> -- reset autocommit
 autocommit on;
 ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/distinctElimination.out b/java/testing/org/apache/derbyTesting/functionTests/master/distinctElimination.out
index a794bf8c9..5c684273d 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/distinctElimination.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/distinctElimination.out
@@ -134,7 +134,7 @@ End Compilation Timestamp : null
 Begin Execution Timestamp : null
 End Execution Timestamp : null
 Statement Execution Plan Text: 
-Distinct Scan ResultSet for ONE using index xxxxFILTERED-UUIDxxxx at serializable isolation level using share table locking: 
+Distinct Scan ResultSet for ONE at serializable isolation level using share table locking: 
 Number of opens = 1
 Hash table size = 1
 Distinct column is column number 1
@@ -153,10 +153,8 @@ scan information:
 	Number of rows visited=8
 	Scan type=heap
 	start position:
-	None
-	stop position:
-	None
-	scan qualifiers:
+null	stop position:
+null	scan qualifiers:
 None
 	next qualifiers:
 None
@@ -219,7 +217,7 @@ insert mode: normal
 Rows inserted = 3
 Indexes updated = 0
 Execute Time = 0
-	Distinct Scan ResultSet for TWO using index xxxxFILTERED-UUIDxxxx at serializable isolation level using share table locking: 
+	Distinct Scan ResultSet for TWO at serializable isolation level using share table locking: 
 	Number of opens = 1
 	Hash table size = 3
 	Distinct columns are column numbers (1,2)
@@ -238,10 +236,8 @@ Execute Time = 0
 		Number of rows visited=9
 		Scan type=heap
 		start position:
-	None
-		stop position:
-	None
-		scan qualifiers:
+null		stop position:
+null		scan qualifiers:
 None
 		next qualifiers:
 None
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/j9_13/distinct.out b/java/testing/org/apache/derbyTesting/functionTests/master/j9_13/distinct.out
index efb76d83b..623913924 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/j9_13/distinct.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/j9_13/distinct.out
@@ -2614,7 +2614,7 @@ End Compilation Timestamp : null
 Begin Execution Timestamp : null
 End Execution Timestamp : null
 Statement Execution Plan Text: 
-Distinct Scan ResultSet for NAMES using index xxxxFILTERED-UUIDxxxx at read committed isolation level using instantaneous share row locking: 
+Distinct Scan ResultSet for NAMES at read committed isolation level using instantaneous share row locking: 
 Number of opens = 1
 Hash table size = 3
 Distinct column is column number 1
@@ -2633,10 +2633,8 @@ scan information:
 	Number of rows visited=6
 	Scan type=heap
 	start position:
-	None
-	stop position:
-	None
-	scan qualifiers:
+null	stop position:
+null	scan qualifiers:
 None
 	next qualifiers:
 None
@@ -2681,7 +2679,7 @@ projection = true
 	restriction time (milliseconds) = 0
 	projection time (milliseconds) = 0
 Source result set:
-	Distinct Scan ResultSet for NAMES using index xxxxFILTERED-UUIDxxxx at read committed isolation level using instantaneous share row locking: 
+	Distinct Scan ResultSet for NAMES at read committed isolation level using instantaneous share row locking: 
 	Number of opens = 1
 	Hash table size = 6
 	Distinct columns are column numbers (0,1)
@@ -2700,10 +2698,8 @@ Source result set:
 		Number of rows visited=6
 		Scan type=heap
 		start position:
-	None
-		stop position:
-	None
-		scan qualifiers:
+null		stop position:
+null		scan qualifiers:
 None
 		next qualifiers:
 None
@@ -2784,6 +2780,14 @@ ij> call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(0);
 0 rows inserted/updated/deleted
 ij> drop table names;
 0 rows inserted/updated/deleted
+ij> -- bug 578. 
+declare global temporary table session.ztemp
+( orderID varchar( 50 ) )
+not logged;
+0 rows inserted/updated/deleted
+ij> select orderID from session.ztemp group by orderID;
+ORDERID                                           
+--------------------------------------------------
 ij> -- reset autocommit
 autocommit on;
 ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/j9_22/distinct.out b/java/testing/org/apache/derbyTesting/functionTests/master/j9_22/distinct.out
index d86eaf67b..68ecb5ac4 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/j9_22/distinct.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/j9_22/distinct.out
@@ -2784,6 +2784,14 @@ ij> call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(0);
 0 rows inserted/updated/deleted
 ij> drop table names;
 0 rows inserted/updated/deleted
+ij> -- bug 578. 
+declare global temporary table session.ztemp
+( orderID varchar( 50 ) )
+not logged;
+0 rows inserted/updated/deleted
+ij> select orderID from session.ztemp group by orderID;
+ORDERID                                           
+--------------------------------------------------
 ij> -- reset autocommit
 autocommit on;
 ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/predicatePushdown.out b/java/testing/org/apache/derbyTesting/functionTests/master/predicatePushdown.out
index 7ef6925b0..cd103d08f 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/predicatePushdown.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/predicatePushdown.out
@@ -9052,7 +9052,7 @@ Source result set:
 			next time (milliseconds) = 0
 			close time (milliseconds) = 0
 		Left result set:
-			Distinct Scan ResultSet for T1 using index xxxxFILTERED-UUIDxxxx at read committed isolation level using instantaneous share row locking: 
+			Distinct Scan ResultSet for T1 at read committed isolation level using instantaneous share row locking: 
 			Number of opens = 1
 			Hash table size = 5
 			Distinct columns are column numbers (0,1)
@@ -9071,10 +9071,8 @@ Source result set:
 				Number of rows visited=5
 				Scan type=heap
 				start position:
-	None
-				stop position:
-	None
-				scan qualifiers:
+null				stop position:
+null				scan qualifiers:
 None
 				next qualifiers:
 None
@@ -9092,7 +9090,7 @@ None
 				restriction time (milliseconds) = 0
 				projection time (milliseconds) = 0
 			Source result set:
-				Distinct Scan ResultSet for T3 using index xxxxFILTERED-UUIDxxxx at read committed isolation level using instantaneous share row locking: 
+				Distinct Scan ResultSet for T3 at read committed isolation level using instantaneous share row locking: 
 				Number of opens = 5
 				Hash table size = 99
 				Distinct columns are column numbers (0,1)
@@ -9111,10 +9109,8 @@ None
 					Number of rows visited=54579
 					Scan type=heap
 					start position:
-	None
-					stop position:
-	None
-					scan qualifiers:
+null					stop position:
+null					scan qualifiers:
 None
 					next qualifiers:
 None
@@ -9219,7 +9215,7 @@ Source result set:
 					next time (milliseconds) = 0
 					close time (milliseconds) = 0
 				Left result set:
-					Distinct Scan ResultSet for T2 using index xxxxFILTERED-UUIDxxxx at read committed isolation level using instantaneous share row locking: 
+					Distinct Scan ResultSet for T2 at read committed isolation level using instantaneous share row locking: 
 					Number of opens = 1
 					Hash table size = 5
 					Distinct columns are column numbers (0,1)
@@ -9238,15 +9234,13 @@ Source result set:
 						Number of rows visited=5
 						Scan type=heap
 						start position:
-	None
-						stop position:
-	None
-						scan qualifiers:
+null						stop position:
+null						scan qualifiers:
 None
 						next qualifiers:
 None
 				Right result set:
-					Distinct Scan ResultSet for T1 using index xxxxFILTERED-UUIDxxxx at read committed isolation level using instantaneous share row locking: 
+					Distinct Scan ResultSet for T1 at read committed isolation level using instantaneous share row locking: 
 					Number of opens = 5
 					Hash table size = 5
 					Distinct columns are column numbers (0,1)
@@ -9265,10 +9259,8 @@ None
 						Number of rows visited=5
 						Scan type=heap
 						start position:
-	None
-						stop position:
-	None
-						scan qualifiers:
+null						stop position:
+null						scan qualifiers:
 None
 						next qualifiers:
 None
@@ -9286,7 +9278,7 @@ None
 					restriction time (milliseconds) = 0
 					projection time (milliseconds) = 0
 				Source result set:
-					Distinct Scan ResultSet for T3 using index xxxxFILTERED-UUIDxxxx at read committed isolation level using instantaneous share row locking: 
+					Distinct Scan ResultSet for T3 at read committed isolation level using instantaneous share row locking: 
 					Number of opens = 25
 					Hash table size = 99
 					Distinct columns are column numbers (0,1)
@@ -9305,10 +9297,8 @@ None
 						Number of rows visited=54579
 						Scan type=heap
 						start position:
-	None
-						stop position:
-	None
-						scan qualifiers:
+null						stop position:
+null						scan qualifiers:
 None
 						next qualifiers:
 None
@@ -9326,7 +9316,7 @@ None
 				restriction time (milliseconds) = 0
 				projection time (milliseconds) = 0
 			Source result set:
-				Distinct Scan ResultSet for T4 using index xxxxFILTERED-UUIDxxxx at read committed isolation level using instantaneous share row locking: 
+				Distinct Scan ResultSet for T4 at read committed isolation level using instantaneous share row locking: 
 				Number of opens = 20
 				Hash table size = 92
 				Distinct columns are column numbers (0,1)
@@ -9345,10 +9335,8 @@ None
 					Number of rows visited=48812
 					Scan type=heap
 					start position:
-	None
-					stop position:
-	None
-					scan qualifiers:
+null					stop position:
+null					scan qualifiers:
 None
 					next qualifiers:
 None
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/subquery.out b/java/testing/org/apache/derbyTesting/functionTests/master/subquery.out
index b56000b98..ad8216685 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/subquery.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/subquery.out
@@ -959,7 +959,7 @@ Source result set:
 			next time (milliseconds) = 0
 			close time (milliseconds) = 0
 		Left result set:
-			Distinct Scan ResultSet for T1 using index xxxxFILTERED-UUIDxxxx at read committed isolation level using instantaneous share row locking: 
+			Distinct Scan ResultSet for T1 at read committed isolation level using instantaneous share row locking: 
 			Number of opens = 1
 			Hash table size = 5
 			Distinct columns are column numbers (0,1)
@@ -978,10 +978,8 @@ Source result set:
 				Number of rows visited=5
 				Scan type=heap
 				start position:
-	None
-				stop position:
-	None
-				scan qualifiers:
+null				stop position:
+null				scan qualifiers:
 None
 				next qualifiers:
 None
@@ -999,7 +997,7 @@ None
 				restriction time (milliseconds) = 0
 				projection time (milliseconds) = 0
 			Source result set:
-				Distinct Scan ResultSet for T3 using index xxxxFILTERED-UUIDxxxx at read committed isolation level using instantaneous share row locking: 
+				Distinct Scan ResultSet for T3 at read committed isolation level using instantaneous share row locking: 
 				Number of opens = 5
 				Hash table size = 9
 				Distinct columns are column numbers (0,1)
@@ -1018,10 +1016,8 @@ None
 					Number of rows visited=9
 					Scan type=heap
 					start position:
-	None
-					stop position:
-	None
-					scan qualifiers:
+null					stop position:
+null					scan qualifiers:
 None
 					next qualifiers:
 None
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/distinct.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/distinct.sql
index 35d66254f..c76a9a0df 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/distinct.sql
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/distinct.sql
@@ -377,5 +377,12 @@ call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(0);
 
 drop table names;
 
+-- bug 578. 
+declare global temporary table session.ztemp
+( orderID varchar( 50 ) )
+not logged;
+
+select orderID from session.ztemp group by orderID;
+
 -- reset autocommit
 autocommit on;
diff --git a/java/tools/org/apache/derby/impl/tools/ij/xaHelper.java b/java/tools/org/apache/derby/impl/tools/ij/xaHelper.java
index 65be98bbd..8c0fc6eec 100644
--- a/java/tools/org/apache/derby/impl/tools/ij/xaHelper.java
+++ b/java/tools/org/apache/derby/impl/tools/ij/xaHelper.java
@@ -64,6 +64,9 @@ class xaHelper implements xaAbstractHelper
 	  
 	public void setFramework(String fm)
 	{
+                if (fm == null) {
+                    return;
+                }
 		framework = fm.toUpperCase(Locale.ENGLISH);
 		if (framework.endsWith("NET") ||
 			framework.equals("DB2JCC"))
