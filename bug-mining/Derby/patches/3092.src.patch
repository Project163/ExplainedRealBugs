diff --git a/java/engine/org/apache/derby/impl/jdbc/ConnectionChild.java b/java/engine/org/apache/derby/impl/jdbc/ConnectionChild.java
index f57210b66..d10f89e78 100644
--- a/java/engine/org/apache/derby/impl/jdbc/ConnectionChild.java
+++ b/java/engine/org/apache/derby/impl/jdbc/ConnectionChild.java
@@ -22,8 +22,11 @@
 package org.apache.derby.impl.jdbc;
 
 import org.apache.derby.jdbc.InternalDriver;
+import org.apache.derby.iapi.sql.conn.LanguageConnectionContext;
 import org.apache.derby.iapi.util.InterruptStatus;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.sql.SQLException;
 
 /**
@@ -153,12 +156,30 @@ abstract class ConnectionChild {
         boolean pushStack, EmbedConnection ec) {
 
         if (pushStack) {
-            InterruptStatus.restoreIntrFlagIfSeen(ec.getLanguageConnection());
+            InterruptStatus.restoreIntrFlagIfSeen( getLanguageConnectionContext( ec ) );
         } else {
             // no lcc if connection is closed:
             InterruptStatus.restoreIntrFlagIfSeen();
         }
     }
+    
+	/**
+	  *	Gets the LanguageConnectionContext for this connection.
+	  */
+	static LanguageConnectionContext	getLanguageConnectionContext( final EmbedConnection conn )
+	{
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<LanguageConnectionContext>()
+             {
+                 public LanguageConnectionContext run()
+                 {
+                     return conn.getLanguageConnection();
+                 }
+             }
+             );
+	}
+
 }
 
 
diff --git a/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java b/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java
index 2178c765a..f880e6a57 100644
--- a/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java
+++ b/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java
@@ -473,7 +473,7 @@ public class EmbedConnection implements EngineConnection
                 isFailoverMasterBoot) {
 
                 if (!usingNoneAuth &&
-                    getLanguageConnection().usesSqlAuthorization()) {
+                    privilegedGetLCC().usesSqlAuthorization()) {
                     // a failure here leaves database booted, but no
                     // operation has taken place and the connection is
                     // rejected.
@@ -498,7 +498,7 @@ public class EmbedConnection implements EngineConnection
 				// restricted to the database owner if authentication
 				// and sqlAuthorization is on.
 				if (!usingNoneAuth &&
-						getLanguageConnection().usesSqlAuthorization()) {
+						privilegedGetLCC().usesSqlAuthorization()) {
 					int operation;
 					if (isTwoPhaseCryptoBoot) {
                         if (isTrue(savedInfo, Attribute.DECRYPT_DATABASE)) {
@@ -590,7 +590,7 @@ public class EmbedConnection implements EngineConnection
 			// now we have the database connection, we can shut down
 			if (shutdown) {
 				if (!usingNoneAuth &&
-						getLanguageConnection().usesSqlAuthorization()) {
+						privilegedGetLCC().usesSqlAuthorization()) {
 					// DERBY-2264: Only allow database owner to shut down if
 					// authentication and sqlAuthorization is on.
 					checkIsDBOwner(OP_SHUTDOWN);
@@ -601,7 +601,7 @@ public class EmbedConnection implements EngineConnection
             // Drop the database at this point, if that is requested.
             if (dropDatabase) {
                 if (!usingNoneAuth &&
-                        getLanguageConnection().usesSqlAuthorization()) {
+                        privilegedGetLCC().usesSqlAuthorization()) {
                     // Only the database owner is allowed to drop the database.
                     // NOTE: Reusing the message for shutdown, as drop database
                     //       includes a shutdown. May want to change this later
@@ -632,9 +632,9 @@ public class EmbedConnection implements EngineConnection
             }
 
 			// Raise a warning in sqlAuthorization mode if authentication is not ON
-			if (usingNoneAuth && getLanguageConnection().usesSqlAuthorization())
+			if (usingNoneAuth && privilegedGetLCC().usesSqlAuthorization())
 				addWarning(SQLWarningFactory.newSQLWarning(SQLState.SQL_AUTHORIZATION_WITH_NO_AUTHENTICATION));
-            InterruptStatus.restoreIntrFlagIfSeen(getLanguageConnection());
+            InterruptStatus.restoreIntrFlagIfSeen(privilegedGetLCC());
 		}
         catch (OutOfMemoryError noMemory)
 		{
@@ -934,7 +934,7 @@ public class EmbedConnection implements EngineConnection
         // If authorization is turned on, we need to check if this
         // user is database owner.
         if (!usingNoneAuth &&
-            getLanguageConnection().usesSqlAuthorization()) {
+            privilegedGetLCC().usesSqlAuthorization()) {
             checkIsDBOwner(OP_REPLICATION);
         }
         // TODO: If system privileges is turned on, we need to check
@@ -978,7 +978,7 @@ public class EmbedConnection implements EngineConnection
         // If authorization is turned on, we need to check if this
         // user is database owner.
         if (!usingNoneAuth &&
-            getLanguageConnection().usesSqlAuthorization()) {
+            privilegedGetLCC().usesSqlAuthorization()) {
             checkIsDBOwner(OP_REPLICATION);
         }
         // TODO: If system privileges is turned on, we need to check
@@ -1103,7 +1103,7 @@ public class EmbedConnection implements EngineConnection
         // If authorization is turned on, we need to check if this
         // user is database owner.
         if (!usingNoneAuth &&
-            getLanguageConnection().usesSqlAuthorization()) {
+            privilegedGetLCC().usesSqlAuthorization()) {
             checkIsDBOwner(OP_REPLICATION);
         }
         // TODO: If system privileges is turned on, we need to check
@@ -1420,7 +1420,7 @@ public class EmbedConnection implements EngineConnection
 	 */
 	private void checkIsDBOwner(int operation) throws SQLException
 	{
-		final LanguageConnectionContext lcc = getLanguageConnection();
+		final LanguageConnectionContext lcc = privilegedGetLCC();
         final String actualId = lcc.getSessionUserId();
 		final String dbOwnerId = lcc.getDataDictionary().
 			getAuthorizationDatabaseOwner();
@@ -1925,7 +1925,7 @@ public class EmbedConnection implements EngineConnection
 			{
 		    	getTR().commit();
 		    	clearLOBMapping();
-                InterruptStatus.restoreIntrFlagIfSeen(getLanguageConnection());
+                InterruptStatus.restoreIntrFlagIfSeen(privilegedGetLCC());
 			}
             catch (Throwable t)
 			{
@@ -1962,7 +1962,7 @@ public class EmbedConnection implements EngineConnection
 			{
 		    	getTR().rollback();
 		    	clearLOBMapping();
-                InterruptStatus.restoreIntrFlagIfSeen(getLanguageConnection());
+                InterruptStatus.restoreIntrFlagIfSeen(privilegedGetLCC());
 			} catch (Throwable t) {
 				throw handleException(t);
 			}
@@ -2154,7 +2154,7 @@ public class EmbedConnection implements EngineConnection
 		{
                         setupContextStack();
 			try {
-                LanguageConnectionContext lcc = getLanguageConnection();
+                LanguageConnectionContext lcc = privilegedGetLCC();
                 lcc.setReadOnly(readOnly);
                 InterruptStatus.restoreIntrFlagIfSeen(lcc);
 			} catch (StandardException e) {
@@ -2174,7 +2174,7 @@ public class EmbedConnection implements EngineConnection
     public final boolean isReadOnly() throws SQLException
 	{
 		checkIfClosed();
-		return getLanguageConnection().isReadOnly();
+		return privilegedGetLCC().isReadOnly();
 	}
 
     /**
@@ -2250,7 +2250,7 @@ public class EmbedConnection implements EngineConnection
 		{
             setupContextStack();
 			try {
-                LanguageConnectionContext lcc = getLanguageConnection();
+                LanguageConnectionContext lcc = privilegedGetLCC();
                 lcc.setIsolationLevel(iLevel);
                 InterruptStatus.restoreIntrFlagIfSeen(lcc);
 			} catch (StandardException e) {
@@ -2270,7 +2270,7 @@ public class EmbedConnection implements EngineConnection
      */
     public final int getTransactionIsolation() throws SQLException {
         checkIfClosed();
-		return TransactionControl.jdbcIsolationLevel( getLanguageConnection().getCurrentIsolationLevel() );
+		return TransactionControl.jdbcIsolationLevel( privilegedGetLCC().getCurrentIsolationLevel() );
 	}
 
     /**
@@ -2361,10 +2361,13 @@ public class EmbedConnection implements EngineConnection
 
 	public final LanguageConnectionContext getLanguageConnection() {
 
+        // Verify that we have permission to execute this method.
+        SecurityUtil.checkDerbyInternalsPrivilege();
+
 		if (SanityManager.DEBUG)
 			SanityManager.ASSERT(!isClosed() || isAborting(), "connection is closed");
 
-		return getTR().getLcc();
+		return privilegedGetLCC();
 	}
 
     /**
@@ -2525,7 +2528,7 @@ public class EmbedConnection implements EngineConnection
             {
                 getTR().commit();
                 clearLOBMapping();
-                InterruptStatus.restoreIntrFlagIfSeen(getLanguageConnection());
+                InterruptStatus.restoreIntrFlagIfSeen(privilegedGetLCC());
             } 
             catch (Throwable t)
             {
@@ -2558,7 +2561,7 @@ public class EmbedConnection implements EngineConnection
             {
                 getTR().commit();
                 clearLOBMapping();
-                InterruptStatus.restoreIntrFlagIfSeen(getLanguageConnection());
+                InterruptStatus.restoreIntrFlagIfSeen(privilegedGetLCC());
             } 
             catch (Throwable t)
             {
@@ -2878,7 +2881,7 @@ public class EmbedConnection implements EngineConnection
                 // Restore here, cf. comment in
                 // EmbedDatabaseMetaData#getPreparedQuery:
                 InterruptStatus.
-                    restoreIntrFlagIfSeen(getLanguageConnection());
+                    restoreIntrFlagIfSeen(privilegedGetLCC());
 			    restoreContextStack();
 			}
 			return s;
@@ -2965,7 +2968,7 @@ public class EmbedConnection implements EngineConnection
 	}
 
 	public void setDrdaID(String drdaID) {
-		getLanguageConnection().setDrdaID(drdaID);
+		privilegedGetLCC().setDrdaID(drdaID);
 	}
 
     /** @see EngineConnection#isInGlobalTransaction() */
@@ -2986,7 +2989,7 @@ public class EmbedConnection implements EngineConnection
 		{
 			setupContextStack();
 			try {
-                LanguageConnectionContext lcc = getLanguageConnection();
+                LanguageConnectionContext lcc = privilegedGetLCC();
                 lcc.resetFromPool();
                 InterruptStatus.restoreIntrFlagIfSeen(lcc);
 			} catch (StandardException t) {
@@ -3028,7 +3031,7 @@ public class EmbedConnection implements EngineConnection
             setupContextStack();
 			try
 			{
-                LanguageConnectionContext lcc = getLanguageConnection();
+                LanguageConnectionContext lcc = privilegedGetLCC();
 				XATransactionController tc = 
                     (XATransactionController)lcc.getTransactionExecute();
 
@@ -3080,7 +3083,7 @@ public class EmbedConnection implements EngineConnection
             setupContextStack();
 			try
 			{
-                LanguageConnectionContext lcc = getLanguageConnection();
+                LanguageConnectionContext lcc = privilegedGetLCC();
                 lcc.xaCommit(onePhase);
                 InterruptStatus.restoreIntrFlagIfSeen(lcc);
 			} catch (StandardException t)
@@ -3106,7 +3109,7 @@ public class EmbedConnection implements EngineConnection
             setupContextStack();
 			try
 			{
-                LanguageConnectionContext lcc = getLanguageConnection();
+                LanguageConnectionContext lcc = privilegedGetLCC();
                 lcc.xaRollback();
                 InterruptStatus.restoreIntrFlagIfSeen(lcc);
 			} catch (StandardException t)
@@ -3176,7 +3179,7 @@ public class EmbedConnection implements EngineConnection
 		
 		synchronized(getConnectionSynchronization())
 		{
-			getLanguageConnection().setPrepareIsolationLevel(level);
+			privilegedGetLCC().setPrepareIsolationLevel(level);
 		}
 	}
 
@@ -3185,7 +3188,7 @@ public class EmbedConnection implements EngineConnection
 	 */
 	public int getPrepareIsolation()
 	{
-		return getLanguageConnection().getPrepareIsolationLevel();
+		return privilegedGetLCC().getPrepareIsolationLevel();
 	}
 
 	/**
@@ -3232,7 +3235,7 @@ public class EmbedConnection implements EngineConnection
         if ( connString == null )
         {
             
-            LanguageConnectionContext lcc = getLanguageConnection();
+            LanguageConnectionContext lcc = privilegedGetLCC();
 
             connString = 
               this.getClass().getName() + "@" + this.hashCode() + " " +
@@ -3415,7 +3418,7 @@ public class EmbedConnection implements EngineConnection
 
     /** Cancels the current running statement. */
     public void cancelRunningStatement() {
-        getLanguageConnection().getStatementContext().cancel();
+        privilegedGetLCC().getStatementContext().cancel();
     }
 
     /**
@@ -3426,7 +3429,7 @@ public class EmbedConnection implements EngineConnection
      * @return the current schema name
      */
     public String getCurrentSchemaName() {
-        return getLanguageConnection().getCurrentSchemaName();
+        return privilegedGetLCC().getCurrentSchemaName();
     }
     
     
@@ -3565,7 +3568,7 @@ public class EmbedConnection implements EngineConnection
                 // Need to cast and get the name because JDBC3 spec
                 // doesn't support names for unnamed savepoints but
                 // Derby keeps names for named & unnamed savepoints.
-                getLanguageConnection().internalRollbackToSavepoint(
+                privilegedGetLCC().internalRollbackToSavepoint(
                     ((EmbedSavepoint)savepoint).getInternalName(),
                     true, savepoint);
             } catch (StandardException e) {
@@ -3596,7 +3599,7 @@ public class EmbedConnection implements EngineConnection
                 // Need to cast and get the name because JDBC3 spec
                 // doesn't support names for unnamed savepoints but
                 // Derby keeps name for named & unnamed savepoints.
-                getLanguageConnection().releaseSavePoint(
+                privilegedGetLCC().releaseSavePoint(
                     ((EmbedSavepoint)savepoint).getInternalName(), savepoint);
             } catch (StandardException e) {
                 throw handleException(e);
@@ -3615,7 +3618,7 @@ public class EmbedConnection implements EngineConnection
 
         //Bug 4507 - savepoint not allowed inside trigger
         StatementContext stmtCtxt =
-            getLanguageConnection().getStatementContext();
+            privilegedGetLCC().getStatementContext();
         if (stmtCtxt!= null && stmtCtxt.inTrigger()) {
             throw newSQLException(SQLState.NO_SAVEPOINT_IN_TRIGGER);
         }
@@ -3656,7 +3659,7 @@ public class EmbedConnection implements EngineConnection
 		{
             setupContextStack();
 			try {
-                LanguageConnectionContext lcc = getLanguageConnection();
+                LanguageConnectionContext lcc = privilegedGetLCC();
                 return lcc.getCurrentSchemaName();
 			} finally {
 				restoreContextStack();
@@ -4092,4 +4095,21 @@ public class EmbedConnection implements EngineConnection
         }
     }
 
+    /**
+     * Private, privileged lookup of the lcc..
+     */
+    private LanguageConnectionContext privilegedGetLCC()
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<LanguageConnectionContext>()
+             {
+                 public LanguageConnectionContext run()
+                 {
+                     return getTR().getLcc();
+                 }
+             }
+             );
+    }
+    
 }
diff --git a/java/engine/org/apache/derby/impl/jdbc/EmbedConnectionContext.java b/java/engine/org/apache/derby/impl/jdbc/EmbedConnectionContext.java
index db51946f2..6d41edba9 100644
--- a/java/engine/org/apache/derby/impl/jdbc/EmbedConnectionContext.java
+++ b/java/engine/org/apache/derby/impl/jdbc/EmbedConnectionContext.java
@@ -29,8 +29,11 @@ import org.apache.derby.iapi.sql.conn.StatementContext;
 import org.apache.derby.iapi.jdbc.ConnectionContext;
 import org.apache.derby.iapi.error.StandardException;
 import org.apache.derby.iapi.sql.ResultSet;
+import org.apache.derby.iapi.sql.conn.LanguageConnectionContext;
 
 import org.apache.derby.iapi.error.ExceptionSeverity;
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.sql.SQLException;
 import java.util.Vector;
 import java.util.Enumeration;
@@ -108,7 +111,7 @@ class EmbedConnectionContext extends ContextImpl
 			throw Util.noCurrentConnection();
 
 		if (!internal) {
-			StatementContext sc = conn.getLanguageConnection().getStatementContext();
+			StatementContext sc = privilegedGetLCC( conn ).getStatementContext();
 			if ((sc == null) || (sc.getSQLAllowed() < org.apache.derby.catalog.types.RoutineAliasInfo.MODIFIES_SQL_DATA))
 				throw Util.noCurrentConnection();
 		}
@@ -154,4 +157,21 @@ class EmbedConnectionContext extends ContextImpl
         // we don't have one since the dynamic result will be inaccessible.
         return EmbedStatement.processDynamicResult(conn, resultSet, null) != null;
     }
+    
+    /**
+     * Private, privileged lookup of the lcc..
+     */
+    private LanguageConnectionContext privilegedGetLCC( final EmbedConnection conn )
+    {
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<LanguageConnectionContext>()
+             {
+                 public LanguageConnectionContext run()
+                 {
+                     return conn.getLanguageConnection();
+                 }
+             }
+             );
+    }
 }
diff --git a/java/engine/org/apache/derby/impl/jdbc/EmbedDatabaseMetaData.java b/java/engine/org/apache/derby/impl/jdbc/EmbedDatabaseMetaData.java
index 71c0761fc..5125fb1b5 100644
--- a/java/engine/org/apache/derby/impl/jdbc/EmbedDatabaseMetaData.java
+++ b/java/engine/org/apache/derby/impl/jdbc/EmbedDatabaseMetaData.java
@@ -42,6 +42,8 @@ import org.apache.derby.iapi.reference.Limits;
 
 import java.util.Properties;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.sql.DatabaseMetaData;
 import java.sql.Connection;
 import java.sql.PreparedStatement;
@@ -3814,7 +3816,16 @@ public class EmbedDatabaseMetaData extends ConnectionChild
 	  */
 	private	LanguageConnectionContext	getLanguageConnectionContext()
 	{
-		return getEmbedConnection().getLanguageConnection();
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<LanguageConnectionContext>()
+             {
+                 public LanguageConnectionContext run()
+                 {
+                     return getEmbedConnection().getLanguageConnection();
+                 }
+             }
+             );
 	}
 
 	/*
diff --git a/java/engine/org/apache/derby/impl/jdbc/EmbedResultSet.java b/java/engine/org/apache/derby/impl/jdbc/EmbedResultSet.java
index 6701def48..223e5ed51 100644
--- a/java/engine/org/apache/derby/impl/jdbc/EmbedResultSet.java
+++ b/java/engine/org/apache/derby/impl/jdbc/EmbedResultSet.java
@@ -79,6 +79,9 @@ import java.sql.Ref;
 import java.sql.RowId;
 import java.sql.SQLXML;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
+
 import java.util.Arrays;
 import java.util.Calendar;
 import java.util.Map;
@@ -273,7 +276,7 @@ public class EmbedResultSet extends ConnectionChild
 		if (concurrencyOfThisResultSet == java.sql.ResultSet.CONCUR_UPDATABLE)
 		{
             final int columnCount = resultDescription.getColumnCount();
-            final ExecutionFactory factory = conn.getLanguageConnection().
+            final ExecutionFactory factory = getLanguageConnectionContext( conn ).
             getLanguageConnectionFactory().getExecutionFactory();
             
 			try{
@@ -418,7 +421,7 @@ public class EmbedResultSet extends ConnectionChild
 
 					setupContextStack();
 		    try {
-				LanguageConnectionContext lcc = getEmbedConnection().getLanguageConnection();
+				LanguageConnectionContext lcc = getLanguageConnectionContext( getEmbedConnection() );
 				final ExecRow newRow;
 		    try {
 
@@ -588,7 +591,7 @@ public class EmbedResultSet extends ConnectionChild
             
 			try	{
                 LanguageConnectionContext lcc =
-                    getEmbedConnection().getLanguageConnection();
+                    getLanguageConnectionContext( getEmbedConnection() );
 
 				try	{
 					theResults.close(); 
@@ -3843,7 +3846,7 @@ public class EmbedResultSet extends ConnectionChild
         synchronized (getConnectionSynchronization()) {
             checksBeforeInsert();
             setupContextStack();
-            LanguageConnectionContext lcc = getEmbedConnection().getLanguageConnection();
+            LanguageConnectionContext lcc = getLanguageConnectionContext( getEmbedConnection() );
             StatementContext statementContext = null;
             try {
                 /*
@@ -3963,7 +3966,7 @@ public class EmbedResultSet extends ConnectionChild
         checkNotOnInsertRow();
         
         setupContextStack();
-        LanguageConnectionContext lcc = getEmbedConnection().getLanguageConnection();
+        LanguageConnectionContext lcc = getLanguageConnectionContext( getEmbedConnection() );
         StatementContext statementContext = null;
         try {
             if (currentRowHasBeenUpdated == false) //nothing got updated on this row 
@@ -4066,7 +4069,7 @@ public class EmbedResultSet extends ConnectionChild
 
             setupContextStack();
             
-            LanguageConnectionContext lcc = getEmbedConnection().getLanguageConnection();
+            LanguageConnectionContext lcc = getLanguageConnectionContext( getEmbedConnection() );
             StatementContext statementContext = null;
             
             //now construct the delete where current of sql
@@ -4221,8 +4224,8 @@ public class EmbedResultSet extends ConnectionChild
 					updateRow.setColumn(i, 
 						resultDescription.getColumnDescriptor(i).getType().getNull());
 				}
-                InterruptStatus.restoreIntrFlagIfSeen(
-                    getEmbedConnection().getLanguageConnection());
+                InterruptStatus.restoreIntrFlagIfSeen
+                    ( getLanguageConnectionContext( getEmbedConnection() ) );
 			} catch (Throwable ex) {
 				handleException(ex);
 			} finally {
@@ -4355,7 +4358,7 @@ public class EmbedResultSet extends ConnectionChild
 			try {
 
 				StringDataValue dvd = (StringDataValue)getColumn(columnIndex);
-                LanguageConnectionContext lcc = ec.getLanguageConnection();
+                LanguageConnectionContext lcc = getLanguageConnectionContext( ec );
 
                 if (wasNull = dvd.isNull()) {
                     InterruptStatus.restoreIntrFlagIfSeen();
@@ -4806,7 +4809,7 @@ public class EmbedResultSet extends ConnectionChild
 			setupContextStack();
 
             LanguageConnectionContext lcc =
-                getEmbedConnection().getLanguageConnection();
+                getLanguageConnectionContext( getEmbedConnection() );
 
             try {
 				try {
diff --git a/java/engine/org/apache/derby/impl/jdbc/EmbedSavepoint.java b/java/engine/org/apache/derby/impl/jdbc/EmbedSavepoint.java
index aa9b846f5..ec554d465 100644
--- a/java/engine/org/apache/derby/impl/jdbc/EmbedSavepoint.java
+++ b/java/engine/org/apache/derby/impl/jdbc/EmbedSavepoint.java
@@ -21,10 +21,13 @@
 
 package org.apache.derby.impl.jdbc;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.sql.SQLException;
 import java.sql.Savepoint;
 import org.apache.derby.iapi.error.StandardException;
 import org.apache.derby.iapi.reference.SQLState;
+import org.apache.derby.iapi.sql.conn.LanguageConnectionContext;
 
 /**
  * This class implements the Savepoint interface from JDBC 3.0.
@@ -65,15 +68,15 @@ final class EmbedSavepoint extends ConnectionChild
    		super(conn);
    		if (name == null) //this is an unnamed savepoint
    		{
-				//Generating a unique internal name for unnamed savepoints
-				savepointName = "i." + conn.getLanguageConnection().getUniqueSavepointName();
-				savepointID = conn.getLanguageConnection().getUniqueSavepointID();
+            //Generating a unique internal name for unnamed savepoints
+            savepointName = "i." + getLanguageConnectionContext( conn ).getUniqueSavepointName();
+            savepointID = getLanguageConnectionContext( conn ).getUniqueSavepointID();
    		} else
    		{
 				savepointName = "e." + name;
 				savepointID = -1;
    		}
-   		conn.getLanguageConnection().languageSetSavePoint(savepointName, this);
+   		getLanguageConnectionContext( conn ).languageSetSavePoint(savepointName, this);
     }
 
 	/**
@@ -115,7 +118,11 @@ final class EmbedSavepoint extends ConnectionChild
     //bug 4468 - verify that savepoint rollback/release is for a savepoint from
     //the current connection
     boolean sameConnection(EmbedConnection con) {
-   		return (getEmbedConnection().getLanguageConnection() == con.getLanguageConnection());
+   		return
+            (
+             getLanguageConnectionContext( getEmbedConnection() ) ==
+             getLanguageConnectionContext( con )
+             );
     }
-}
 
+}
diff --git a/java/engine/org/apache/derby/impl/jdbc/EmbedStatement.java b/java/engine/org/apache/derby/impl/jdbc/EmbedStatement.java
index ee18b5a5c..5321f8980 100644
--- a/java/engine/org/apache/derby/impl/jdbc/EmbedStatement.java
+++ b/java/engine/org/apache/derby/impl/jdbc/EmbedStatement.java
@@ -33,6 +33,8 @@ import org.apache.derby.iapi.sql.conn.LanguageConnectionContext;
 import org.apache.derby.iapi.error.StandardException;
 import org.apache.derby.iapi.jdbc.EngineStatement;
 
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.sql.SQLException;
 import java.sql.SQLWarning;
 import java.sql.Statement;
@@ -123,7 +125,7 @@ public class EmbedStatement extends ConnectionChild
 		this.resultSetConcurrency = resultSetConcurrency;
 		this.resultSetHoldability = resultSetHoldability;
 
-		lcc = getEmbedConnection().getLanguageConnection();
+		lcc = getLanguageConnectionContext( getEmbedConnection() );
 		applicationConnection = getEmbedConnection().getApplicationConnection();
         applicationStatement = this;
 	}
diff --git a/java/engine/org/apache/derby/jdbc/EmbedPooledConnection.java b/java/engine/org/apache/derby/jdbc/EmbedPooledConnection.java
index 5c913c263..fbd895785 100644
--- a/java/engine/org/apache/derby/jdbc/EmbedPooledConnection.java
+++ b/java/engine/org/apache/derby/jdbc/EmbedPooledConnection.java
@@ -37,6 +37,8 @@ import org.apache.derby.impl.jdbc.EmbedCallableStatement;
 
 
 import java.sql.Connection;
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.sql.ResultSet;
 import java.sql.SQLException;
 import java.sql.Statement;
@@ -402,7 +404,7 @@ class EmbedPooledConnection implements javax.sql.PooledConnection, BrokeredConne
 	 */
 	public boolean isIsolationLevelSetUsingSQLorJDBC() throws SQLException {
 		if (realConnection != null)
-			return realConnection.getLanguageConnection().isIsolationLevelSetUsingSQLorJDBC();
+			return getLanguageConnectionContext( realConnection ).isIsolationLevelSetUsingSQLorJDBC();
 		else
 			return false;
 	}
@@ -414,7 +416,7 @@ class EmbedPooledConnection implements javax.sql.PooledConnection, BrokeredConne
 		and the end of a global transaction.
 	*/
 	public void resetIsolationLevelFlag() throws SQLException {
-		realConnection.getLanguageConnection().resetIsolationLevelFlagUsedForSQLandJDBC();
+		getLanguageConnectionContext( realConnection ).resetIsolationLevelFlagUsedForSQLandJDBC();
 	}
 
     /** @see BrokeredConnectionControl#isInGlobalTransaction() */
@@ -646,4 +648,21 @@ class EmbedPooledConnection implements javax.sql.PooledConnection, BrokeredConne
             statementEventListeners.add(listener);
         }
     }
+    
+	/**
+	  *	Gets the LanguageConnectionContext for this connection.
+	  */
+	private static LanguageConnectionContext	getLanguageConnectionContext( final EmbedConnection conn )
+	{
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<LanguageConnectionContext>()
+             {
+                 public LanguageConnectionContext run()
+                 {
+                     return conn.getLanguageConnection();
+                 }
+             }
+             );
+	}
 }
diff --git a/java/engine/org/apache/derby/jdbc/EmbedXAResource.java b/java/engine/org/apache/derby/jdbc/EmbedXAResource.java
index 9e8edfd06..467113a74 100644
--- a/java/engine/org/apache/derby/jdbc/EmbedXAResource.java
+++ b/java/engine/org/apache/derby/jdbc/EmbedXAResource.java
@@ -21,6 +21,8 @@
 
 package org.apache.derby.jdbc;
 
+import java.security.PrivilegedExceptionAction;
+import java.security.PrivilegedActionException;
 import java.security.PrivilegedAction;
 import java.security.AccessController;
 import java.sql.ResultSet;
@@ -46,6 +48,7 @@ import org.apache.derby.iapi.store.access.xa.XAResourceManager;
 import org.apache.derby.iapi.store.access.xa.XAXactId;
 import org.apache.derby.impl.jdbc.EmbedConnection;
 import org.apache.derby.impl.jdbc.TransactionResourceImpl;
+import org.apache.derby.impl.jdbc.Util;
 import org.apache.derby.shared.common.sanity.SanityManager;
 import org.apache.derby.iapi.services.property.PropertyUtil;
 import org.apache.derby.iapi.reference.Property;
@@ -545,7 +548,7 @@ class EmbedXAResource implements XAResource {
      */
     private long getDefaultXATransactionTimeout() throws XAException {
         try {
-            LanguageConnectionContext lcc = con.getLanguageConnection();
+            LanguageConnectionContext lcc = getLanguageConnectionContext( con );
             TransactionController tc = lcc.getTransactionExecute();
 
             long timeoutMillis = 1000 * (long) PropertyUtil.getServiceInt(
@@ -658,7 +661,7 @@ class EmbedXAResource implements XAResource {
                     con.realConnection.setHoldability(
                             ResultSet.CLOSE_CURSORS_AT_COMMIT);
                     
-                    con.realConnection.getLanguageConnection().
+                    getLanguageConnectionContext( con.realConnection ).
                             getTransactionExecute().
                             createXATransactionFromLocalTransaction(
                                                 xid_im.getFormatId(),
@@ -970,4 +973,46 @@ class EmbedXAResource implements XAResource {
              );
     }
 
+	/**
+	  *	Gets the LanguageConnectionContext for this connection.
+	  */
+	private	LanguageConnectionContext	getLanguageConnectionContext( final EmbedConnection conn )
+	{
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<LanguageConnectionContext>()
+             {
+                 public LanguageConnectionContext run()
+                 {
+                     return conn.getLanguageConnection();
+                 }
+             }
+             );
+	}
+
+    /**
+     * Privileged LCC lookup. Must be private so that user code
+     * can't call this entry point.
+     */
+	private	LanguageConnectionContext	getLanguageConnectionContext( final EmbedPooledConnection conn )
+        throws SQLException
+    {
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<LanguageConnectionContext>()
+                 {
+                     public LanguageConnectionContext run()
+                         throws SQLException
+                     {
+                         return conn.getLanguageConnection();
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            throw Util.javaException( pae );
+        }
+    }
+
 }
diff --git a/java/engine/org/apache/derby/jdbc/InternalDriver.java b/java/engine/org/apache/derby/jdbc/InternalDriver.java
index cfd059ce8..40caec02b 100644
--- a/java/engine/org/apache/derby/jdbc/InternalDriver.java
+++ b/java/engine/org/apache/derby/jdbc/InternalDriver.java
@@ -24,6 +24,8 @@ package org.apache.derby.jdbc;
 
 import java.security.AccessController;
 import java.security.AccessControlException;
+import java.security.PrivilegedExceptionAction;
+import java.security.PrivilegedActionException;
 import java.security.Permission;
 import java.security.PrivilegedAction;
 import java.sql.CallableStatement;
@@ -645,9 +647,35 @@ public class InternalDriver implements ModuleControl, Driver {
 		Methods to be overloaded in sub-implementations such as
 		a tracing driver.
 	 */
-    EmbedConnection getNewEmbedConnection(String url, Properties info)
-            throws SQLException {
-        return new EmbedConnection(this, url, info);
+    EmbedConnection getNewEmbedConnection( final String url, final Properties info)
+        throws SQLException
+    {
+        final   InternalDriver  myself = this;
+
+        try {
+            return AccessController.doPrivileged
+                (
+                 new PrivilegedExceptionAction<EmbedConnection>()
+                 {
+                     public EmbedConnection run()
+                         throws SQLException
+                     {
+                         return new EmbedConnection(myself, url, info);
+                     }
+                 }
+                 );
+        } catch (PrivilegedActionException pae)
+        {
+            Throwable   cause = pae.getCause();
+            if ( (cause != null) && (cause instanceof SQLException) )
+            {
+                throw (SQLException) cause;
+            }
+            else
+            {
+                throw Util.javaException( pae );
+            }
+        }
     }
 
 	private ConnectionContext getConnectionContext() {
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/NoDBInternalsPermissionTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/NoDBInternalsPermissionTest.java
index 319d86ac0..43e290954 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/NoDBInternalsPermissionTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/NoDBInternalsPermissionTest.java
@@ -166,7 +166,7 @@ public class NoDBInternalsPermissionTest extends GeneratedColumnsHelper
      * See DERBY-6636.
      * </p>
      */
-    public  void    test_004_BasDataFileFactory()
+    public  void    test_004_BaseDataFileFactory()
         throws Exception
     {
         try {
@@ -175,4 +175,21 @@ public class NoDBInternalsPermissionTest extends GeneratedColumnsHelper
         }
         catch (AccessControlException e) { println( "Caught an AccessControlException" ); }
     }
+
+    /**
+     * <p>
+     * Verify that you need usederbyinternals permission to get the LCC from a Connection.
+     * See DERBY-6751.
+     * </p>
+     */
+    public  void    test_005_EmbedConnection_getLCC()
+        throws Exception
+    {
+        try {
+            Connection  conn = getConnection();
+            ((EmbedConnection) conn).getLanguageConnection();
+            fail( "Should have raised an AccessControlException" );
+        }
+        catch (AccessControlException e) { println( "Caught an AccessControlException" ); }
+    }
 }
diff --git a/java/testing/org/apache/derbyTesting/junit/BaseJDBCTestCase.java b/java/testing/org/apache/derbyTesting/junit/BaseJDBCTestCase.java
index f288d8040..9f3b23273 100644
--- a/java/testing/org/apache/derbyTesting/junit/BaseJDBCTestCase.java
+++ b/java/testing/org/apache/derbyTesting/junit/BaseJDBCTestCase.java
@@ -29,6 +29,8 @@ import java.io.PrintStream;
 import java.io.Reader;
 import java.io.UnsupportedEncodingException;
 import java.lang.reflect.Method;
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.security.PrivilegedActionException;
 import java.net.URL;
 import java.sql.*;
@@ -39,6 +41,7 @@ import java.util.List;
 import junit.framework.AssertionFailedError;
 import junit.framework.Test;
 
+import org.apache.derby.iapi.sql.conn.LanguageConnectionContext;
 import org.apache.derby.iapi.sql.execute.RunTimeStatistics;
 import org.apache.derby.impl.jdbc.EmbedConnection;
 import org.apache.derby.tools.ij;
@@ -1564,13 +1567,14 @@ public abstract class BaseJDBCTestCase
      * @throws SQLException
      */
     public static void checkEstimatedRowCount(Connection conn, double expectedCount) throws SQLException {
-	if (! (conn instanceof EmbedConnection))
-	    return;
+        if (! (conn instanceof EmbedConnection))
+	    { return; }
 	
-	EmbedConnection econn = (EmbedConnection) conn;
-	RunTimeStatistics rts = econn.getLanguageConnection().getRunTimeStatisticsObject();
-	assertNotNull(" RuntimeStatistics is null. Did you call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1)?",rts);
-	assertEquals((long) expectedCount, (long) rts.getEstimatedRowCount());
+        EmbedConnection econn = (EmbedConnection) conn;
+        LanguageConnectionContext   lcc = (LanguageConnectionContext) getLanguageConnectionContext( econn );
+        RunTimeStatistics rts = lcc.getRunTimeStatisticsObject();
+        assertNotNull(" RuntimeStatistics is null. Did you call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1)?",rts);
+        assertEquals((long) expectedCount, (long) rts.getEstimatedRowCount());
 	}
 
     /**
@@ -1831,6 +1835,29 @@ public abstract class BaseJDBCTestCase
         ps.close();
     }
     
+	/**
+	  * Gets the LanguageConnectionContext for this connection. You might think that
+      * this method could take an EmbedConnection as its argument and return a
+      * LanguageConnectionContext. That, however, makes the compatibility tests blow up.
+      * With those stronger types, the test lookup machinery in junit.framework.TestSuite
+      * can't resolve the signature of this private method. That is because the engine jar is
+      * not on the client-only classpath used by the compatibility tests. Now you know.
+	  */
+	private static Object	getLanguageConnectionContext( Connection conn )
+	{
+        final EmbedConnection   econn = (EmbedConnection) conn;
+        return AccessController.doPrivileged
+            (
+             new PrivilegedAction<LanguageConnectionContext>()
+             {
+                 public LanguageConnectionContext run()
+                 {
+                     return econn.getLanguageConnection();
+                 }
+             }
+             );
+	}
+
 
 } // End class BaseJDBCTestCase
 
