diff --git a/java/engine/org/apache/derby/impl/sql/GenericPreparedStatement.java b/java/engine/org/apache/derby/impl/sql/GenericPreparedStatement.java
index 6423bc060..56a8c8130 100644
--- a/java/engine/org/apache/derby/impl/sql/GenericPreparedStatement.java
+++ b/java/engine/org/apache/derby/impl/sql/GenericPreparedStatement.java
@@ -135,7 +135,7 @@ public class GenericPreparedStatement
 	private int inUseCount;
 
 	// true if the statement is being compiled.
-	boolean compilingStatement;
+    private boolean compilingStatement;
 
     /** True if the statement was invalidated while it was being compiled. */
     boolean invalidatedWhileCompiling;
@@ -226,6 +226,29 @@ public class GenericPreparedStatement
         return isValid && (activationClass != null) && !compilingStatement;
     }
 
+    /** Check if this statement is currently being compiled. */
+    final synchronized boolean isCompiling() {
+        return compilingStatement;
+    }
+
+    /**
+     * Signal that the statement is about to be compiled. This will block
+     * others from attempting to compile it.
+     */
+    final synchronized void beginCompiling() {
+        compilingStatement = true;
+        setActivationClass(null);
+    }
+
+    /**
+     * Signal that we're done compiling the statement and unblock others
+     * that are waiting for the compilation to finish.
+     */
+    final synchronized void endCompiling() {
+        compilingStatement = false;
+        notifyAll();
+    }
+
 	public void rePrepare(LanguageConnectionContext lcc) 
 		throws StandardException {
 		if (!upToDate()) {
@@ -835,7 +858,7 @@ recompileOutOfDatePlan:
 			isValid = false;
 
 			// block compiles while we are invalidating
-			compilingStatement = true;
+            beginCompiling();
 		}
 
 		try {
@@ -870,10 +893,7 @@ recompileOutOfDatePlan:
 				}
 			}
 		} finally {
-			synchronized (this) {
-				compilingStatement = false;
-				notifyAll();
-			}
+            endCompiling();
 		}
 	}
 
diff --git a/java/engine/org/apache/derby/impl/sql/GenericStatement.java b/java/engine/org/apache/derby/impl/sql/GenericStatement.java
index b7fb7da82..b5b828b72 100644
--- a/java/engine/org/apache/derby/impl/sql/GenericStatement.java
+++ b/java/engine/org/apache/derby/impl/sql/GenericStatement.java
@@ -266,7 +266,7 @@ public class GenericStatement
 					return preparedStmt;
 				}
 
-				if (!preparedStmt.compilingStatement) {
+                if (!preparedStmt.isCompiling()) {
 					break;
 				}
 
@@ -277,8 +277,7 @@ public class GenericStatement
 				}
 			}
 
-			preparedStmt.compilingStatement = true;
-			preparedStmt.setActivationClass(null);
+            preparedStmt.beginCompiling();
 		}
 
 		try {
@@ -633,10 +632,7 @@ public class GenericStatement
 		}
 		finally
 		{
-			synchronized (preparedStmt) {
-				preparedStmt.compilingStatement = false;
-				preparedStmt.notifyAll();
-			}
+            preparedStmt.endCompiling();
 		}
 
 		lcc.commitNestedTransaction();
