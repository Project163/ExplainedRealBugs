diff --git a/java/build/org/apache/derbyBuild/lastgoodjarcontents/insane.derbyTesting.jar.lastcontents b/java/build/org/apache/derbyBuild/lastgoodjarcontents/insane.derbyTesting.jar.lastcontents
index fd3b14490..31c1548af 100644
--- a/java/build/org/apache/derbyBuild/lastgoodjarcontents/insane.derbyTesting.jar.lastcontents
+++ b/java/build/org/apache/derbyBuild/lastgoodjarcontents/insane.derbyTesting.jar.lastcontents
@@ -501,6 +501,7 @@ org.apache.derbyTesting.functionTests.tests.largedata.BlobImplT.class
 org.apache.derbyTesting.functionTests.tests.largedata.ClobImplT.class
 org.apache.derbyTesting.functionTests.tests.largedata.Derby5624Test.class
 org.apache.derbyTesting.functionTests.tests.largedata.Derby6317Test.class
+org.apache.derbyTesting.functionTests.tests.largedata.Derby6884Test.class
 org.apache.derbyTesting.functionTests.tests.largedata.LobLimitsClientTest.class
 org.apache.derbyTesting.functionTests.tests.largedata.LobLimitsLiteTest.class
 org.apache.derbyTesting.functionTests.tests.largedata.LobLimitsTest.class
diff --git a/java/build/org/apache/derbyBuild/lastgoodjarcontents/sane.derbyTesting.jar.lastcontents b/java/build/org/apache/derbyBuild/lastgoodjarcontents/sane.derbyTesting.jar.lastcontents
index fd3b14490..31c1548af 100644
--- a/java/build/org/apache/derbyBuild/lastgoodjarcontents/sane.derbyTesting.jar.lastcontents
+++ b/java/build/org/apache/derbyBuild/lastgoodjarcontents/sane.derbyTesting.jar.lastcontents
@@ -501,6 +501,7 @@ org.apache.derbyTesting.functionTests.tests.largedata.BlobImplT.class
 org.apache.derbyTesting.functionTests.tests.largedata.ClobImplT.class
 org.apache.derbyTesting.functionTests.tests.largedata.Derby5624Test.class
 org.apache.derbyTesting.functionTests.tests.largedata.Derby6317Test.class
+org.apache.derbyTesting.functionTests.tests.largedata.Derby6884Test.class
 org.apache.derbyTesting.functionTests.tests.largedata.LobLimitsClientTest.class
 org.apache.derbyTesting.functionTests.tests.largedata.LobLimitsLiteTest.class
 org.apache.derbyTesting.functionTests.tests.largedata.LobLimitsTest.class
diff --git a/java/engine/org/apache/derby/impl/load/ImportLobFile.java b/java/engine/org/apache/derby/impl/load/ImportLobFile.java
index 7a31a82d3..b3343c5f2 100644
--- a/java/engine/org/apache/derby/impl/load/ImportLobFile.java
+++ b/java/engine/org/apache/derby/impl/load/ImportLobFile.java
@@ -128,10 +128,10 @@ class ImportLobFile
      * @param length  length of the the data.
      * @exception  IOException  on any I/O error.     
      */
-    public String getString(int offset, int length) throws IOException {
+    public String getString(long offset, int length) throws IOException {
         lobInputStream.seek(offset);
         lobLimitIn.clearLimit();
-        lobLimitIn.setLimit((int) length);
+        lobLimitIn.setLimit(length);
         
         // wrap a reader on top of the stream, so that calls 
         // to read the clob data from the file can read the 
diff --git a/java/engine/org/apache/derby/impl/load/ImportReadData.java b/java/engine/org/apache/derby/impl/load/ImportReadData.java
index d42a52099..f6083523c 100644
--- a/java/engine/org/apache/derby/impl/load/ImportReadData.java
+++ b/java/engine/org/apache/derby/impl/load/ImportReadData.java
@@ -108,7 +108,7 @@ final class ImportReadData implements java.security.PrivilegedExceptionAction<Ob
   // variables realted to reading lob data from files.
   private ImportLobFile[] lobFileHandles; // lob file handle object 
   private String lobFileName; // current file name
-  private int lobOffset; // offset of the current large object
+  private long lobOffset; // offset of the current large object
   private int lobLength; //length of the current large object
 
 
@@ -1037,7 +1037,7 @@ final class ImportReadData implements java.security.PrivilegedExceptionAction<Ob
         lobLength = Integer.parseInt(lobLocationStr.substring(
                                      lengthIndex + 1, 
                                      lobLocationStr.length() -1));
-        lobOffset = Integer.parseInt(lobLocationStr.substring(
+        lobOffset = Long.parseLong(lobLocationStr.substring(
                                      offsetIndex+1, 
                                      lengthIndex));
         lobFileName = lobLocationStr.substring(0 , offsetIndex);
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/largedata/Derby6884Test.java b/java/testing/org/apache/derbyTesting/functionTests/tests/largedata/Derby6884Test.java
new file mode 100644
index 000000000..ebcd23010
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/largedata/Derby6884Test.java
@@ -0,0 +1,156 @@
+package org.apache.derbyTesting.functionTests.tests.largedata;
+
+import java.sql.Connection;
+import java.sql.PreparedStatement;
+import java.sql.SQLException;
+import java.sql.Statement;
+import junit.framework.Test;
+import java.io.IOException;
+import java.io.InputStream;
+import java.io.Reader;
+import org.apache.derbyTesting.functionTests.tests.tools.ImportExportBaseTest;
+import org.apache.derbyTesting.functionTests.util.streams.LoopingAlphabetReader;
+import org.apache.derbyTesting.functionTests.util.streams.LoopingAlphabetStream;
+import org.apache.derbyTesting.junit.BaseJDBCTestCase;
+import org.apache.derbyTesting.junit.BaseTestSuite;
+import org.apache.derbyTesting.junit.CleanDatabaseTestSetup;
+import org.apache.derbyTesting.junit.SupportFilesSetup;
+import org.apache.derbyTesting.junit.RuntimeStatisticsParser;
+import org.apache.derbyTesting.junit.SQLUtilities;
+
+
+/*
+Class org.apache.derbyTesting.functionTests.tests.largedata.Derby6884Test
+
+
+Licensed to the Apache Software Foundation (ASF) under one or more
+contributor license agreements.  See the NOTICE file distributed with
+this work for additional information regarding copyright ownership.
+The ASF licenses this file to you under the Apache License, Version 2.0
+(the "License"); you may not use this file except in compliance with
+the License.  You may obtain a copy of the License at
+
+   http://www.apache.org/licenses/LICENSE-2.0
+
+Unless required by applicable law or agreed to in writing, software
+distributed under the License is distributed on an "AS IS" BASIS,
+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+See the License for the specific language governing permissions and
+limitations under the License.
+
+*/
+
+
+public class Derby6884Test extends ImportExportBaseTest
+{
+    String fileName6884;
+    String lobFile6884;
+
+    public Derby6884Test(String name) 
+    {
+        super(name);
+        fileName6884 = (SupportFilesSetup.getReadWrite("table-data")).getPath();
+        lobFile6884 = (SupportFilesSetup.getReadWrite("lob-data")).getPath();
+    }
+
+    public static Test suite() 
+    {
+        BaseTestSuite suite = new BaseTestSuite("Derby6884Test");
+        suite.addTest(baseSuite("Derby6884Test:embedded"));
+        return suite;
+    }
+    
+    /*
+     * DERBY-6884: external file behaviors when the file contains more than
+     * Integer.MAX_VALUE bytes of data.
+     */
+    public void testDerby6884ImportLargeExtfileClob()
+        throws SQLException
+    {
+        Statement s  = createStatement();
+        PreparedStatement ps = prepareStatement(
+                     "insert into DERBY_6884_TESTCLOB values(? , ?)" );
+        int id = 1;
+        long byteCount = 0;
+        int clobSize = 0;
+        while ( byteCount < Integer.MAX_VALUE ) {
+            ps.setInt(1 , id++);
+            clobSize = ( 10000 * 1024 ) + ( 1024 * id );
+            byteCount += clobSize;
+            Reader reader = new LoopingAlphabetReader(clobSize);
+            ps.setCharacterStream(2, reader, clobSize);
+            ps.executeUpdate();
+        }
+        ps.setInt(1 , id++);
+        Reader reader = new LoopingAlphabetReader(clobSize);
+        ps.setCharacterStream(2, reader, clobSize);
+        ps.executeUpdate();
+
+        commit();
+        doExportTableLobsToExtFile("APP", "DERBY_6884_TESTCLOB", fileName6884, 
+                                   null, null , null, lobFile6884);
+        s.execute("TRUNCATE TABLE DERBY_6884_TESTCLOB");
+        doImportTableLobsFromExtFile("APP", "DERBY_6884_TESTCLOB",
+                                   fileName6884, null, null, null, 0);
+        SupportFilesSetup.deleteFile(fileName6884);
+        SupportFilesSetup.deleteFile(lobFile6884);
+    }
+
+    /*
+     * Same as the prior test, but with BLOB column, not CLOB column.
+     */
+    public void testDerby6884ImportLargeExtfileBlob()
+        throws SQLException
+    {
+        Statement s  = createStatement();
+        PreparedStatement ps = prepareStatement(
+                     "insert into DERBY_6884_TESTBLOB values(? , ?)" );
+        int id = 1;
+        long byteCount = 0;
+        int blobSize = 0;
+        while ( byteCount < Integer.MAX_VALUE ) {
+            ps.setInt(1 , id++);
+            blobSize = ( 50000 * 1024 ) + ( 1024 * id );
+            byteCount += blobSize;
+            InputStream stream = new LoopingAlphabetStream(blobSize);
+            ps.setBinaryStream(2, stream, blobSize);
+            ps.executeUpdate();
+        }
+        ps.setInt(1 , id++);
+        InputStream stream = new LoopingAlphabetStream(blobSize);
+        ps.setBinaryStream(2, stream, blobSize);
+        ps.executeUpdate();
+
+        commit();
+        doExportTableLobsToExtFile("APP", "DERBY_6884_TESTBLOB", fileName6884, 
+                                   null, null , null, lobFile6884);
+        s.execute("TRUNCATE TABLE DERBY_6884_TESTBLOB");
+        doImportTableLobsFromExtFile("APP", "DERBY_6884_TESTBLOB",
+                                   fileName6884, null, null, null, 0);
+        SupportFilesSetup.deleteFile(fileName6884);
+        SupportFilesSetup.deleteFile(lobFile6884);
+    }
+
+
+    protected static Test baseSuite(String name) 
+    {
+        BaseTestSuite suite = new BaseTestSuite(name);
+        suite.addTestSuite(Derby6884Test.class);
+        Test test = suite;
+        test = new SupportFilesSetup(test);
+        return new CleanDatabaseTestSetup(test)
+        {
+            protected void decorateSQL(Statement stmt) throws SQLException
+            {
+                Connection conn = stmt.getConnection();
+
+                stmt.execute("CREATE TABLE DERBY_6884_TESTBLOB" +
+                              "(id BIGINT, content BLOB)");
+                stmt.execute("CREATE TABLE DERBY_6884_TESTCLOB" +
+                              "(id BIGINT, content CLOB)");
+
+                conn.commit();
+            }
+        };
+    }
+}
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/largedata/_Suite.java b/java/testing/org/apache/derbyTesting/functionTests/tests/largedata/_Suite.java
index 119dd6eca..652819c93 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/largedata/_Suite.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/largedata/_Suite.java
@@ -50,6 +50,7 @@ public class _Suite extends BaseJDBCTestCase {
         suite.addTest(LobLimitsLiteTest.suite());
         suite.addTest(LobLimitsTest.suite());
         suite.addTest(LobLimitsClientTest.suite());
+        suite.addTest(Derby6884Test.suite());
         return suite;
     }
 }
