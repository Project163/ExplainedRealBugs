diff --git a/java/engine/org/apache/derby/impl/sql/compile/ResultColumnList.java b/java/engine/org/apache/derby/impl/sql/compile/ResultColumnList.java
index caa5a5855..b4291cc22 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/ResultColumnList.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/ResultColumnList.java
@@ -1647,6 +1647,15 @@ public class ResultColumnList extends QueryTreeNodeVector
 	 * Copy the types and lengths for this RCL (the target)
 	 * to another RCL (the source).  
 	 * This is useful when adding a NormalizeResultSetNode.
+	 * It is called on the NormalizeResultSetNode to copy 
+	 * the types from the insert or update ResultColumnList (sourceRCL).
+	 * The type of the underlying expression should not be changed 
+	 * (DERBY-3310)
+	 * because that same expression is pointed to by the child result set's
+	 * result column list.  Only NormalizeResultSetNode should have a 
+	 * type that is different than its expresssion. See Army's write up
+	 * attached to DERBY-3310 for a detailed analysis of the role of 
+	 * copyTypesAndLengthsToSource.
 	 *
 	 * @param sourceRCL	The source RCL
 	 */
@@ -1659,7 +1668,6 @@ public class ResultColumnList extends QueryTreeNodeVector
 			ResultColumn sourceRC = (ResultColumn) sourceRCL.elementAt(index);
 			ResultColumn resultColumn = (ResultColumn) elementAt(index);
 			sourceRC.setType(resultColumn.getTypeServices());
-			sourceRC.getExpression().setType(resultColumn.getTypeServices());
 		}
 	}
 		
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/insert.out b/java/testing/org/apache/derbyTesting/functionTests/master/insert.out
index 044cbac23..e757c7ad7 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/insert.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/insert.out
@@ -791,4 +791,29 @@ ij> select count(*) from POLICY_STATEMENTS;
 356        
 ij> drop table POLICY_STATEMENTS;
 0 rows inserted/updated/deleted
+ij> -- DERBY-3310 type conversions in insert
+
+create table  U (SNAME varchar(32000), TNAME Varchar(32000), C1 bigint);
+0 rows inserted/updated/deleted
+ij> insert into U(SNAME, TNAME, C1) select distinct SCHEMANAME, TABLENAME, 2
+ from SYS.SYSTABLES T join  SYS.SYSSCHEMAS S on T.SCHEMAID = S.SCHEMAID where TABLENAME = 'U';
+1 row inserted/updated/deleted
+ij> select * from U;
+SNAME                                                                                                                           |TNAME                                                                                                                           |C1                  
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+APP                                                                                                                             |U                                                                                                                               |2                   
+ij> drop table  U;
+0 rows inserted/updated/deleted
+ij> create table d3310 (x bigint);
+0 rows inserted/updated/deleted
+ij> insert into d3310 select distinct * from (values 2.0, 2.1, 2.2) v;
+3 rows inserted/updated/deleted
+ij> select * from d3310;
+X                   
+--------------------
+2                   
+2                   
+2                   
+ij> drop table d3310;
+0 rows inserted/updated/deleted
 ij> 
\ No newline at end of file
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/insert.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/insert.sql
index 0997a11e2..031e6518a 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/insert.sql
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/insert.sql
@@ -622,3 +622,22 @@ INSERT INTO POLICY_STATEMENTS VALUES
 select count(*) from POLICY_STATEMENTS;
 
 drop table POLICY_STATEMENTS;
+
+-- DERBY-3310 type conversions in insert
+
+create table  U (SNAME varchar(32000), TNAME Varchar(32000), C1 bigint);
+insert into U(SNAME, TNAME, C1) select distinct SCHEMANAME, TABLENAME, 2
+ from SYS.SYSTABLES T join  SYS.SYSSCHEMAS S on T.SCHEMAID = S.SCHEMAID where TABLENAME = 'U';
+select * from U;
+drop table  U;
+
+create table d3310 (x bigint);
+insert into d3310 select distinct * from (values 2.0, 2.1, 2.2) v;
+select * from d3310;
+drop table d3310;
+
+
+
+
+
+
