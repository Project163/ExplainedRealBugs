diff --git a/java/drda/org/apache/derby/impl/drda/NetworkServerControlImpl.java b/java/drda/org/apache/derby/impl/drda/NetworkServerControlImpl.java
index ce64e5132..c08c961bf 100644
--- a/java/drda/org/apache/derby/impl/drda/NetworkServerControlImpl.java
+++ b/java/drda/org/apache/derby/impl/drda/NetworkServerControlImpl.java
@@ -1261,13 +1261,19 @@ public final class NetworkServerControlImpl {
         String user = null;
         String password = null;
 
-            
-            writeCommandHeader(COMMAND_TESTCONNECTION);
-            writeLDString(database);
-            writeLDString(user);
-            writeLDString(password);
-            send();
-            readResult();
+            try {
+                writeCommandHeader(COMMAND_TESTCONNECTION);
+                writeLDString(database);
+                writeLDString(user);
+                writeLDString(password);
+                send();
+                readResult();
+            } catch (IOException ioe) {
+                consolePropertyMessage("DRDA_NoIO.S",
+                        new String [] {hostArg, 
+                        (new Integer(portNumber)).toString(), 
+                        ioe.getMessage()}); 
+            }
     }
 
 
@@ -3553,7 +3559,7 @@ public final class NetworkServerControlImpl {
      */
     private boolean isMsgProperty(String msg)
     {
-        if (msg.startsWith(DRDA_MSG_PREFIX))
+        if (msg != null && msg.startsWith(DRDA_MSG_PREFIX))
             return true;
         else
             return false;
