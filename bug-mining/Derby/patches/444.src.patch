diff --git a/java/testing/README.htm b/java/testing/README.htm
index d0d5ef4f8..61c062824 100644
--- a/java/testing/README.htm
+++ b/java/testing/README.htm
@@ -1552,89 +1552,134 @@ class: </p>
  cellspacing="3">
   <col width="994"> <tbody>
     <tr>
-      <td width="994"> <ul><li>runwith&lt;jvm&gt; - See above section <a
- href="#skipping">4.10</a><br><br>
-<li>framework - specifies which framework to run with. For example:<br>
+      <td width="994">
+      <ul>
+        <li>runwith&lt;jvm&gt; - See above section <a href="#skipping">4.10</a><br>
+          <br>
+        </li>
+        <li>framework - specifies which framework to run with. For
+example:<br>
 java -Dframework=DerbyNetClient
-org.apache.derbyTesting.functionTests.RunTest <br><br>
+org.apache.derbyTesting.functionTests.RunTest <br>
+          <br>
 lang/supersimple.sql<br>
-<li>verbose - Shows more detailed output if set to "true". For example:<br>
-<small>java -Dverbose=true
-org.apache.derbyTesting.functionTests.RunTest lang/arithmetic.sql</small><br><br>
-<li>keepfiles - Indicates to not clean up any of the files if the test
-passed if set to "true".<br><br>
-<li>testSpecialProps - sets additional properties. Several can be set using
+        </li>
+        <li>verbose - Shows more detailed output if set to "true". For
+example:<br>
+          <small>java -Dverbose=true
+org.apache.derbyTesting.functionTests.RunTest lang/arithmetic.sql</small><br>
+          <br>
+        </li>
+        <li>keepfiles - Indicates to not clean up any of the files if
+the test
+passed if set to "true".<br>
+          <br>
+        </li>
+        <li>testSpecialProps - sets additional properties. Several can
+be set using
 '^' as separator: <br>
- -DtestSpecialProps=&lt;prop-1&gt;=&lt;value-1&gt;^
+-DtestSpecialProps=&lt;prop-1&gt;=&lt;value-1&gt;^
 ... ^&lt;prop-n&gt;=&lt;value-n&gt;. For example:<br>
-<small>java -DTestSpecialProps=derby.infolog.append=true
+          <small>java -DTestSpecialProps=derby.infolog.append=true
 org.apache.derbyTesting.functionTests.RunTest lang/arithmetic.sql</small>
-<br><br>
-<li>jvmflags - sets specific jvm properties for the jvm used in the
+          <br>
+          <br>
+        </li>
+        <li>jvmflags - sets specific jvm properties for the jvm used in
+the
 test harness, for instance initial memory, and heap size, or properties
 normally passed on with a -D. For instance: <br>
-<small>java -Djvmflags=ms32M -mx128M
-org.apache.derbyTesting.functionTests.RunTest lang/streamingColumn.java</small <br><br>
-<li>excludeJCC -
-&nbsp;&nbsp;&nbsp; See above section <a href="#skipping">4.10</a><br><br>
-<li>useprocess - (default=true) Controls whether RunTest runs the test in a 
-separate VM or in a thread in harness VM. Also does not create
+          <small>java -Djvmflags=ms32M -mx128M
+org.apache.derbyTesting.functionTests.RunTest lang/streamingColumn.java</small><br>
+          <br>
+        </li>
+        <li>excludeJCC -
+&nbsp;&nbsp;&nbsp; See above section <a href="#skipping">4.10</a><br>
+          <br>
+        </li>
+        <li>useprocess - (default=true) Controls whether RunTest runs
+the test in a separate VM or in a thread in harness VM. Also does not
+create
 subdirectories for each test and thus will
 attempt to reuse databases with the same name. It is
-potentially useful for debugging tests. Unit tests are not (yet) runnable with
-"useprocess=false". <br><br>
-<li>startServer - allows for Network Server tests to start and shutdown
+potentially useful for debugging tests. Unit tests are not (yet)
+runnable with
+"useprocess=false". <br>
+          <br>
+        </li>
+        <li>startServer - allows for Network Server tests to start and
+shutdown
 Network Server from the test itself. Default is true - i.e. the
-&nbsp;&nbsp;&nbsp;&nbsp; test harness will start Network Server.<br><br>
-<li>noSecurityManager  disable the client JVM from installing a
-SecurityManager. See section 4.13<br><br>
-<li>hostName - allows for running Network Server on a remote host. See
-section <a href="#hostName">4.14</a>.<br><br>
-<li>derbyTesting.encoding - allows for running the harness with a different
-encoding. Only supported with jdk15. Example: <br><br>
+&nbsp;&nbsp;&nbsp;&nbsp; test harness will start Network Server.<br>
+          <br>
+        </li>
+        <li>noSecurityManager  disable the client JVM from installing
+a
+SecurityManager. See section <a href="#security">4.13</a></li>
+        <li>
+          <p>derbyTesting.replacePolicyFile - replace or append the
+contents of the default policy file derby_tests.policy. default is
+false, i.e. append. See section <a href="README.htm#security">4.13</a>
+          </p>
+        </li>
+        <li>
+          <p>hostName - allows for running Network Server on a remote
+host. See
+section <a href="#hostName">4.14</a>.</p>
+        </li>
+        <li>derbyTesting.encoding - allows for running the harness with
+a different
+encoding. Only supported with jdk15. Example: <br>
+          <br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<small> java
 -DderbyTesting.encoding=UTF-16
 org.apache.derbyTesting.functionTests.harness.RunTest
-jdbcapi/resultset.java</small><br><br>
-<li>generateUTF8Out - copies the test .out into UTF-8 encoding. See section
-      <a href="#4.15_Encoding_issues">4.15</a>.<br><br>
-<li>derbyTesting.jar.path -
-
-      This property is required to run upgrade tests. Set this property
-      to point to the location of jar files from a previous release from
-      which we need to test upgrade. This property needs to be set only if
-      the source files will not be available when running tests. In this case,
-      the jars can be copied to any location with the following relative path
-      ${jar_location}/{majorversion.minorversion}. The property should be set
-      as follows:<br>
-<br>
-      derbyTesting.jar.path=${jar_location}<br>
-<br>
-      If the test is run on the machine where the source files from svn have
-      been built, then it is not required to set this property. The jars checked
-      into svn will be used. If the tests are being run in a location where the
-      jars from the previous release are available in a different location
-      than where the source files for the upgrade tests have been built, the
-      following property needs to be set on the command line for RunSuite or
-      RunTest where the tests are being run:<br>
-<br>
-      -Djvmflags=-DderbyTesting.jar.path={path_to_derby_jars}<br>
-<br>
-      where {path_to_derby_jars} points to a directory where the jars for the
-      previous Derby release being tested for upgrade reside in a subdirectory
-      named according to the major.minor version. For example:<br>
-<br>
-      If the Derby 10.1 jars for upgrade testing reside in
-      /opt/testing/derby/10.1 then the command line needed for the upgrade
-      tests to complete would include the following:<br>
-<br>
-      <small>java -Djvmflags=-DderbyTesting.jar.path=/opt/testing/derby org.apache.derbyTesting.functionTests.harness.RunSuite upgrade</small><br>
-<br> 
-      Please note that if you change the value of derbyTesting.jar.path
-      you will need to remove the file <small>org/apache/derbyTesting/functionTests/tests/upgradeTests/Upgrade_10_1_10_2.properties</small>
-      from your output directory and run 'ant all' for the updated value of
-      the property to be written into that generated file.<br>
-</ul>
+jdbcapi/resultset.java</small><br>
+          <br>
+        </li>
+        <li>generateUTF8Out - copies the test .out into UTF-8 encoding.
+See section <a href="#4.15_Encoding_issues">4.15</a>.<br>
+          <br>
+        </li>
+        <li>derbyTesting.jar.path - This property is required to run
+upgrade tests. Set this property to point to the location of jar files
+from a previous release from which we need to test upgrade. This
+property needs to be set only if the source files will not be available
+when running tests. In this case, the jars can be copied to any
+location with the following relative path
+${jar_location}/{majorversion.minorversion}. The property should be set
+as follows:<br>
+          <br>
+derbyTesting.jar.path=${jar_location}<br>
+          <br>
+If the test is run on the machine where the source files from svn have
+been built, then it is not required to set this property. The jars
+checked into svn will be used. If the tests are being run in a location
+where the jars from the previous release are available in a different
+location than where the source files for the upgrade tests have been
+built, the following property needs to be set on the command line for
+RunSuite or RunTest where the tests are being run:<br>
+          <br>
+-Djvmflags=-DderbyTesting.jar.path={path_to_derby_jars}<br>
+          <br>
+where {path_to_derby_jars} points to a directory where the jars for the
+previous Derby release being tested for upgrade reside in a
+subdirectory named according to the major.minor version. For example:<br>
+          <br>
+If the Derby 10.1 jars for upgrade testing reside in
+/opt/testing/derby/10.1 then the command line needed for the upgrade
+tests to complete would include the following:<br>
+          <br>
+          <small>java
+-Djvmflags=-DderbyTesting.jar.path=/opt/testing/derby
+org.apache.derbyTesting.functionTests.harness.RunSuite upgrade</small><br>
+          <br>
+Please note that if you change the value of derbyTesting.jar.path you
+will need to remove the file <small>org/apache/derbyTesting/functionTests/tests/upgradeTests/Upgrade_10_1_10_2.properties</small>
+from your output directory and run 'ant all' for the updated value of
+the property to be written into that generated file.<br>
+        </li>
+      </ul>
       </td>
     </tr>
   </tbody>
@@ -1644,11 +1689,32 @@ jdbcapi/resultset.java</small><br><br>
 default</h3>
 <p>By default the tests install the standard Java SecurityManager
 using the system property java.security.manager and use a policy file
-derby_tests.policy. This file is sourced
+derby_tests.policy. The default file is sourced
 at<br>
 ${derby.source}/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy</p>
 <p>During a test run this policy file is copied into ${user.dir} and
-used from there.</p>
+used from there.<br>
+Optionally a test-specific or suite-specific policy file may be
+appended or used instead. The name of the policy file remains
+derby_tests.policy. <br>
+</p>
+<p>A test_specific policy file has the same name as the test, has
+extension .policy, and is located in the same location as the test. For
+instance,
+${derby.source}/java/testing/org/apache/derbyTesting/functionTests/tests/lang/errorStream.policy
+is the test-specific policy file for the test errorStream.java. A
+suite-specific policy file has the same name as the suite, has
+extension .policy, and is located in the
+${derby.source}/java/testing/org/apache/derbyTesting/functionTests/suites
+directory.<br>
+</p>
+<p>By default, a test-specific and/or suite-specific policy file is
+appended to the default policy file (derby_tests.policy). However, if a
+test's _app.properties or suite's .properties file contains the
+property derbyTesting.replacePolicyFile=true, then the file
+derby_tests.policy will be overwritten with the contents of the test-
+or suite-specific policy file.<br>
+</p>
 <p>There are two environments for the installation of the
 SecurityManager.</p>
 <ul>
@@ -1861,7 +1927,8 @@ fashion. Tests that need to be run in this fashion can use the result
 of
 the TestUtil.getHostName() method instead.</li>
   <li>Tests can only use the ping option of the NetworkServerControl
-class.<br>
+class.</li>
+  <li>Tests cannot be dependent on test- or suite-specific policy files.<br>
   </li>
 </ol>
 New .exclude files for the current frameworks (i.e.
diff --git a/java/testing/org/apache/derbyTesting/functionTests/harness/RunTest.java b/java/testing/org/apache/derbyTesting/functionTests/harness/RunTest.java
index dfd3d524e..b4efbeadb 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/harness/RunTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/harness/RunTest.java
@@ -126,6 +126,7 @@ public class RunTest
 	static boolean startServer=true; // should test harness start the server
 	static String hostName; // needs to be settable for ipv testing, localhost otherwise.)
 	static String testEncoding; // Encoding used for child jvm and to read the test output
+	static boolean replacePolicyFile=false; // property used to see if we need to replace the default policy file or append to it.
 
 	// Other test variables for directories, files, output
 	static String scriptName = ""; // testname as passed in
@@ -277,13 +278,13 @@ public class RunTest
 	    System.out.println(sb.toString());
 	    pwDiff.println(sb.toString());
 
- 	    // before going further, get the policy file copied and if
- 	    // needed, modify it with the test's policy file
- 	    composePolicyFile();
-     
             // Run the Server if needed
 	    if ((driverName != null) && (!skiptest) )
 	    {
+            // before going further, get the policy file copied and if
+            // needed, modify it with the test's policy file
+            composePolicyFile();
+     
             System.out.println("Initialize for framework: "+ framework );
             if (jvmnet && framework.startsWith("DerbyNet"))
             {
@@ -1008,6 +1009,12 @@ public class RunTest
             addSkiptestReason("derbyTesting.encoding can only be used with jdk15, skipping test");
         }
 		
+        String replace_policy = sp.getProperty("derbyTesting.replacePolicyFile");
+        if ((replace_policy != null) && (replace_policy.equals("true")))
+            replacePolicyFile=true;
+        else
+            replacePolicyFile=false;
+        
         javaCmd = sp.getProperty("javaCmd");
         bootcp = sp.getProperty("bootcp");
         jvmflags = sp.getProperty("jvmflags");
@@ -1647,7 +1654,18 @@ clp.list(System.out);
 	                    ap.put("file.encoding",testEncoding);	
 	            }
 	        }
-	        
+	       
+	        if(!replacePolicyFile) 
+	        {
+	            String replace_policy = ap.getProperty("derbyTesting.replacePolicyFile");
+	            if (replace_policy != null && replace_policy.equals("true"))
+	                replacePolicyFile = true;
+	            else
+	                replacePolicyFile = false;
+
+	        }
+
+ 
 	        if (NetServer.isJCCConnection(framework)
 	        		|| "true".equalsIgnoreCase(ap.getProperty("noSecurityManager")))
 	        	runWithoutSecurityManager = true;
@@ -1960,6 +1978,9 @@ clp.list(System.out);
             status = tempMasterFile.delete();
             UTF8OutFile = new File(outDir, UTF8OutName);
             status = UTF8OutFile.delete();
+            File defaultPolicyFile = new File(userdir, "derby_tests.policy");
+            if (defaultPolicyFile.exists())
+            status = defaultPolicyFile.delete();
             if (deleteBaseDir)
             {
                 if (useCommonDB == false) 
@@ -2160,6 +2181,8 @@ clp.list(System.out);
 	    String systemHome, String scriptPath)
 	    throws FileNotFoundException, IOException, Exception
 	{
+    	composePolicyFile();
+        
 	    //System.out.println("testType: " + testType);
 	    String ij = "";
         // Create the test command line
@@ -2324,20 +2347,53 @@ clp.list(System.out);
     public static void composePolicyFile() throws ClassNotFoundException
     {
         try{
-            //DERBY-892: allow for test-specific policy additions
-
-            // first get the default policy file
+            //DERBY-892: allow for test- and suite-specific policy additions
+            
+            // this is the default policy file
             String default_policy = "util/derby_tests.policy";
-            File userDirHandle = new File(userdir);
-            CopySuppFiles.copyFiles(userDirHandle, default_policy);
+            
+            // if the property replacePolicyFile is set (in the 
+            // test specific _app.properties file, or at the command line)
+            // do not use the default policy file at all, otherwise, append
+            if (!replacePolicyFile)
+            {
+            	File userDirHandle = new File(userdir);
+            	CopySuppFiles.copyFiles(userDirHandle, default_policy);
+            }
+            // see if there is a suite specific policy file and append or replace
+            if ((isSuiteRun) && (suiteName!=null)) 
+            {
+                InputStream newpolicy = loadTestResource("suites/" + 
+                    suiteName.substring(0,suiteName.indexOf(':')) + 
+                    ".policy");
+                writePolicyFile(newpolicy);
+            }
 
-            // now get the test specific policy file and append
+            // if we are running with useprocess=false, we need some special
+            // properties (setSecurityManager, setIO)
+            if (!useprocess) 
+            {
+                InputStream newpolicy = loadTestResource("util/" + "useprocessfalse.policy");
+                writePolicyFile(newpolicy);
+            }
+            
+            // now get the test specific policy file and append or replace
             InputStream newpolicy =
                 loadTestResource("tests/" + testDirName + "/" + testBase + ".policy");
+            writePolicyFile(newpolicy);
+        } catch (IOException ie) {
+            System.out.println("Exception trying to create policy file: ");
+            ie.printStackTrace(); 
+        }
+    }
+
+    public static void writePolicyFile(InputStream newpolicy)
+    {
+        try{
             if (newpolicy != null)
             {
                 File oldpolicy = new File(runDir,"derby_tests.policy");
-                //if (oldpolicy.exists()) System.out.println("Appending to derby_tests.policy");
+                if (verbose && oldpolicy.exists()) System.out.println("Appending to derby_tests.policy");
                 BufferedReader policyadd = new BufferedReader(new InputStreamReader(newpolicy, "UTF-8"));
                 FileWriter policyfw = new FileWriter(oldpolicy.getPath(), true);
                 PrintWriter policypw = new PrintWriter( new BufferedWriter(policyfw, 10000), true );
@@ -2357,8 +2413,6 @@ clp.list(System.out);
     private static void execTestProcess(String[] testCmd)
         throws Exception
     {
-    	composePolicyFile();
-        
         // Execute the process and handle the results
     	Process pr = null;
     	try
@@ -2479,8 +2533,8 @@ clp.list(System.out);
     	PrintStream ps = new PrintStream(new FileOutputStream(pathStr), true);
     	
     	// Install a security manager within this JVM for this test.
-    	boolean installedSecurityManager = installSecurityManager();
     	composePolicyFile();
+    	boolean installedSecurityManager = installSecurityManager();
     	if (testType.equals("sql"))
     	{
     	    String[] ijarg = new String[3];
diff --git a/java/testing/org/apache/derbyTesting/functionTests/harness/jvm.java b/java/testing/org/apache/derbyTesting/functionTests/harness/jvm.java
index 908cc7e2e..ac9b84351 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/harness/jvm.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/harness/jvm.java
@@ -110,7 +110,7 @@ public abstract class jvm {
     String hostName;
 
 	// security defaults relative to WS
-	// not used if jvmargs serverPolicyFile or serverCodeBase are set
+	// not used if jvmargs serverCodeBase are set
 	private static String DEFAULT_POLICY="util/derby_tests.policy";
 	private static String DEFAULT_CODEBASE="/classes";
 
@@ -337,11 +337,7 @@ public abstract class jvm {
 			D = new Vector();
 		
 		String userDir = System.getProperty("user.dir");
-		String policyFile = System.getProperty("serverPolicyFile");
-		if (policyFile == null)
-		{
-				policyFile = userDir + baseName(DEFAULT_POLICY);
-		}
+		String policyFile = userDir + baseName(DEFAULT_POLICY);
 
 		String serverCodeBase = System.getProperty("serverCodeBase");
 		boolean[] isJar = new boolean[1];
@@ -357,11 +353,10 @@ public abstract class jvm {
 		File pf = new File(policyFile);
 		File cb = new File(serverCodeBase);
 
-		if (policyFile.toLowerCase().equals("none") || 
-			(!pf.exists()))
+		if (!pf.exists())
 		{
 			System.out.println("WARNING: Running without Security manager." +
-							   "serverPolicy(" + policyFile + 
+							   "policy File (" + policyFile + 
 							   ") or serverCodeBase(" +  serverCodeBase + 
 							   ") not available");
 		return D;
@@ -393,8 +388,8 @@ public abstract class jvm {
 	}
 
 	/** Get the base file name from a resource name string
-	 * @param resourceName (e.g. /org/apache/derbyTesting/functionTests/util/nwsvr.policy)
-	 * @return short name (e.g. nwsvr.policy)
+	 * @param resourceName (e.g. /org/apache/derbyTesting/functionTests/util/derby_tests.policy)
+	 * @return short name (e.g. derby_tests.policy)
 	 */
 	private static String baseName(String resourceName)
 	{
diff --git a/java/testing/org/apache/derbyTesting/functionTests/suites/build.xml b/java/testing/org/apache/derbyTesting/functionTests/suites/build.xml
index 8dde06090..bfa05df00 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/suites/build.xml
+++ b/java/testing/org/apache/derbyTesting/functionTests/suites/build.xml
@@ -24,7 +24,7 @@
 
   <target name="copyfiles">
     <copy todir="${out.dir}/${derby.testing.suites.dir}">
-      <fileset dir="${derby.testing.src.dir}/${derby.testing.functest.dir}/suites" includes="*.runall,*.properties,*.exclude"/>
+      <fileset dir="${derby.testing.src.dir}/${derby.testing.functest.dir}/suites" includes="*.runall,*.properties,*.exclude,*.policy"/>
     </copy>
   </target>
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/util/build.xml b/java/testing/org/apache/derbyTesting/functionTests/util/build.xml
index 692014d32..249e335f3 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/util/build.xml
+++ b/java/testing/org/apache/derbyTesting/functionTests/util/build.xml
@@ -96,7 +96,7 @@
   <target name="copyfiles">
     <copy todir="${out.dir}/${derby.testing.functest.dir}/util">
       <fileset dir="${derby.testing.src.dir}/${derby.testing.functest.dir}/util" 
-        includesfile="${derby.testing.src.dir}/${derby.testing.functest.dir}/util/copyfiles.ant"/>  
+        includes="*.sql,*.properties,*.policy"/>
     </copy>
   </target>
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/util/copyfiles.ant b/java/testing/org/apache/derbyTesting/functionTests/util/copyfiles.ant
deleted file mode 100644
index 2eac0b423..000000000
--- a/java/testing/org/apache/derbyTesting/functionTests/util/copyfiles.ant
+++ /dev/null
@@ -1,3 +0,0 @@
-nwsvr.policy
-derby_tests.policy
-testRoutines.sql
diff --git a/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy b/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
index f45f51085..651bd2a8a 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
@@ -104,12 +104,6 @@ grant codeBase "${derbyTesting.codejar}derbyTesting.jar" {
   
   // Access all files under ${user.dir}to write the test directory structure
   permission java.io.FilePermission "${user.dir}${/}-", "read,write,delete"; 
- 
-  // When running with useprocess=false need to install and uninstall
-  // the security manager and allow setIO to change the system err and out
-  // streams. Currently the nist suite runs with useprocess=false.
-  permission java.lang.RuntimePermission "setSecurityManager";
-  permission java.lang.RuntimePermission "setIO"; 
 };
 
 //
@@ -136,12 +130,6 @@ grant codeBase "${derbyTesting.codeclasses}" {
   // Access all files under ${user.dir}to write the test directory structure
   // Also covers extin, extout and extinout locations
   permission java.io.FilePermission "${user.dir}${/}-", "read,write,delete"; 
-  
-  // When running with useprocess=false need to install and uninstall
-  // the security manager and allow setIO to change the system err and out
-  // streams. Currently the nist suite runs with useprocess=false.
-  permission java.lang.RuntimePermission "setSecurityManager";
-  permission java.lang.RuntimePermission "setIO"; 
     
   // These permissions are needed to load the JCE for encryption with Sun and IBM JDK131.
   // JDK14 has the JCE  preloaded
