diff --git a/java/engine/org/apache/derby/impl/sql/execute/AnyResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/AnyResultSet.java
index 371783e49..417f9384d 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/AnyResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/AnyResultSet.java
@@ -155,6 +155,9 @@ public class AnyResultSet extends NoPutResultSetImpl
 	 */
 	public ExecRow	getNextRowCore() throws StandardException 
 	{
+		if( isXplainOnlyMode() )
+			return null;
+
 	    ExecRow candidateRow = null;
 		ExecRow secondRow = null;
 	    ExecRow result = null;
diff --git a/java/engine/org/apache/derby/impl/sql/execute/BasicNoPutResultSetImpl.java b/java/engine/org/apache/derby/impl/sql/execute/BasicNoPutResultSetImpl.java
index 3652d1348..180bf38e7 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/BasicNoPutResultSetImpl.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/BasicNoPutResultSetImpl.java
@@ -145,6 +145,13 @@ implements NoPutResultSet
 		return activation;
 	}
 
+	protected final boolean isXplainOnlyMode()
+	{
+		LanguageConnectionContext lcc = getLanguageConnectionContext();
+		return
+		  (lcc.getRunTimeStatisticsMode() && lcc.getXplainOnlyMode());
+	}
+
 	// NoPutResultSet interface
 
 	/**
@@ -256,12 +263,7 @@ implements NoPutResultSet
 		attachStatementContext();
 
 		try {
-			LanguageConnectionContext lcc = getLanguageConnectionContext();
-			if(lcc.getRunTimeStatisticsMode() && lcc.getXplainOnlyMode()) {
-				// do nothing
-			} else {
-				openCore();
-			}
+			openCore();
 
 		} catch (StandardException se) {
 			activation.checkStatementValidity();
@@ -463,8 +465,8 @@ implements NoPutResultSet
 	 */
 	public final ExecRow	getNextRow() throws StandardException 
 	{
-		LanguageConnectionContext lcc = getLanguageConnectionContext();
-		if(lcc.getRunTimeStatisticsMode() && lcc.getXplainOnlyMode()){
+		if( isXplainOnlyMode() )
+		{
 			// return null to indicate no results available and 
 			// to bypass the execution
 			return null;
diff --git a/java/engine/org/apache/derby/impl/sql/execute/BulkTableScanResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/BulkTableScanResultSet.java
index 694391b06..6fc94efd9 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/BulkTableScanResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/BulkTableScanResultSet.java
@@ -286,6 +286,9 @@ class BulkTableScanResultSet extends TableScanResultSet
 	 */
 	public ExecRow getNextRowCore() throws StandardException
 	{
+		if( isXplainOnlyMode() )
+			return null;
+
 	    ExecRow result = null;
             
         checkCancellationFlag();
diff --git a/java/engine/org/apache/derby/impl/sql/execute/CurrentOfResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/CurrentOfResultSet.java
index 697efd772..a0f1d0a9b 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/CurrentOfResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/CurrentOfResultSet.java
@@ -100,6 +100,9 @@ class CurrentOfResultSet extends NoPutResultSetImpl
      */
 	public ExecRow	getNextRowCore() throws StandardException {
 
+		if( isXplainOnlyMode() )
+			return null;
+
 		if ( isOpen ) {
 	        if ( ! next ) {
 	            next = true;
diff --git a/java/engine/org/apache/derby/impl/sql/execute/DependentResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/DependentResultSet.java
index dc0a4b0a9..781266991 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/DependentResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/DependentResultSet.java
@@ -337,6 +337,9 @@ class DependentResultSet extends ScanResultSet implements CursorResultSet
 	public ExecRow	getNextRowCore() throws StandardException 
 	{
 		
+		if( isXplainOnlyMode() )
+			return null;
+
 		beginTime = getCurrentTimeMillis();
 		if (searchRow == null)
 		{
diff --git a/java/engine/org/apache/derby/impl/sql/execute/DistinctScalarAggregateResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/DistinctScalarAggregateResultSet.java
index 1f4ababcf..9351840ce 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/DistinctScalarAggregateResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/DistinctScalarAggregateResultSet.java
@@ -170,6 +170,9 @@ class DistinctScalarAggregateResultSet extends ScalarAggregateResultSet
 	 */
 	public ExecRow	getNextRowCore() throws StandardException 
 	{
+		if( isXplainOnlyMode() )
+			return null;
+
 	    ExecIndexRow execIndexRow = null;
 	    ExecIndexRow aggResult = null;
 		boolean	cloneArg = true;
diff --git a/java/engine/org/apache/derby/impl/sql/execute/DistinctScanResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/DistinctScanResultSet.java
index d7e567621..bc28a98c7 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/DistinctScanResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/DistinctScanResultSet.java
@@ -96,6 +96,9 @@ class DistinctScanResultSet extends HashScanResultSet
 	 */
 	public ExecRow getNextRowCore() throws StandardException
 	{
+		if( isXplainOnlyMode() )
+			return null;
+
 	    ExecRow result = null;
 
 		beginTime = getCurrentTimeMillis();
diff --git a/java/engine/org/apache/derby/impl/sql/execute/GroupedAggregateResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/GroupedAggregateResultSet.java
index affc8e6b8..7d543305e 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/GroupedAggregateResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/GroupedAggregateResultSet.java
@@ -359,6 +359,9 @@ class GroupedAggregateResultSet extends GenericAggregateResultSet
 	 */
 	public ExecRow	getNextRowCore() throws StandardException 
 	{
+		if( isXplainOnlyMode() )
+			return null;
+
 		if (!isOpen)
 		{
 			return null;
diff --git a/java/engine/org/apache/derby/impl/sql/execute/HashScanResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/HashScanResultSet.java
index a2f291bc4..e4de77726 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/HashScanResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/HashScanResultSet.java
@@ -360,6 +360,9 @@ public class HashScanResultSet extends ScanResultSet
 	 */
 	public ExecRow getNextRowCore() throws StandardException
 	{
+		if( isXplainOnlyMode() )
+			return null;
+
 	    ExecRow result = null;
 		DataValueDescriptor[] columns = null;
 
diff --git a/java/engine/org/apache/derby/impl/sql/execute/HashTableResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/HashTableResultSet.java
index 75d89d683..5fd8f9f6e 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/HashTableResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/HashTableResultSet.java
@@ -298,6 +298,9 @@ class HashTableResultSet extends NoPutResultSetImpl
 	 * @return the next row in the result
 	 */
 	public ExecRow	getNextRowCore() throws StandardException {
+		if( isXplainOnlyMode() )
+			return null;
+
 	    ExecRow result = null;
 		DataValueDescriptor[] columns = null;
 
diff --git a/java/engine/org/apache/derby/impl/sql/execute/IndexRowToBaseRowResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/IndexRowToBaseRowResultSet.java
index 3b13a0b77..bcf0c6760 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/IndexRowToBaseRowResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/IndexRowToBaseRowResultSet.java
@@ -300,6 +300,8 @@ class IndexRowToBaseRowResultSet extends NoPutResultSetImpl
 	 * @return the next row in the result
 	 */
 	public ExecRow	getNextRowCore() throws StandardException {
+		if( isXplainOnlyMode() )
+			return null;
 
 	    ExecRow sourceRow = null;
 		ExecRow retval = null;
diff --git a/java/engine/org/apache/derby/impl/sql/execute/LastIndexKeyResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/LastIndexKeyResultSet.java
index 7451b027e..76277d817 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/LastIndexKeyResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/LastIndexKeyResultSet.java
@@ -201,6 +201,9 @@ class LastIndexKeyResultSet extends ScanResultSet
 	 */
 	public ExecRow getNextRowCore() throws StandardException
 	{
+		if( isXplainOnlyMode() )
+			return null;
+
 		if (returnedRow || !isOpen)
 		{
 		    clearCurrentRow();
diff --git a/java/engine/org/apache/derby/impl/sql/execute/MaterializedResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/MaterializedResultSet.java
index da8979eca..7a4427b9c 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/MaterializedResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/MaterializedResultSet.java
@@ -176,6 +176,9 @@ class MaterializedResultSet extends NoPutResultSetImpl
 	 */
 	public ExecRow	getNextRowCore() throws StandardException
 	{
+		if( isXplainOnlyMode() )
+			return null;
+
 		ExecRow result = null;
 
 		beginTime = getCurrentTimeMillis();
diff --git a/java/engine/org/apache/derby/impl/sql/execute/MergeJoinResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/MergeJoinResultSet.java
index 34cd51f29..b1cc3d445 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/MergeJoinResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/MergeJoinResultSet.java
@@ -116,6 +116,9 @@ class MergeJoinResultSet extends JoinResultSet
 	 */
 	public ExecRow	getNextRowCore() throws StandardException
 	{
+		if( isXplainOnlyMode() )
+			return null;
+
 		beginTime = getCurrentTimeMillis();
 		if (! isOpen)
 			throw StandardException.newException(SQLState.LANG_RESULT_SET_NOT_OPEN, "next");
diff --git a/java/engine/org/apache/derby/impl/sql/execute/MultiProbeTableScanResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/MultiProbeTableScanResultSet.java
index 0071ed982..9fff0accf 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/MultiProbeTableScanResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/MultiProbeTableScanResultSet.java
@@ -416,6 +416,9 @@ class MultiProbeTableScanResultSet extends TableScanResultSet
      */
     public ExecRow getNextRowCore() throws StandardException
     {
+		if( isXplainOnlyMode() )
+			return null;
+
         checkCancellationFlag();
 
         // Step 1.
diff --git a/java/engine/org/apache/derby/impl/sql/execute/NestedLoopJoinResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/NestedLoopJoinResultSet.java
index 4dca3e310..2305d0ccf 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/NestedLoopJoinResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/NestedLoopJoinResultSet.java
@@ -74,6 +74,9 @@ class NestedLoopJoinResultSet extends JoinResultSet
 	 */
 	public ExecRow	getNextRowCore() throws StandardException
 	{
+		if( isXplainOnlyMode() )
+			return null;
+
 	    ExecRow result = null;
 		boolean haveRow = false;
 	    boolean restrict = false;
diff --git a/java/engine/org/apache/derby/impl/sql/execute/NestedLoopLeftOuterJoinResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/NestedLoopLeftOuterJoinResultSet.java
index d7a291042..fd378bddb 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/NestedLoopLeftOuterJoinResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/NestedLoopLeftOuterJoinResultSet.java
@@ -68,6 +68,9 @@ class NestedLoopLeftOuterJoinResultSet extends NestedLoopJoinResultSet
 	 */
 	public ExecRow	getNextRowCore() throws StandardException
 	{
+		if( isXplainOnlyMode() )
+			return null;
+
 	    ExecRow result = null;
 		boolean haveRow = false;
 	    boolean restrict = false;
diff --git a/java/engine/org/apache/derby/impl/sql/execute/NormalizeResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/NormalizeResultSet.java
index 14526b808..eb0284541 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/NormalizeResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/NormalizeResultSet.java
@@ -175,6 +175,9 @@ class NormalizeResultSet extends NoPutResultSetImpl
 	 */
 	public ExecRow	getNextRowCore() throws StandardException
 	{
+		if( isXplainOnlyMode() )
+			return null;
+
 		ExecRow		sourceRow = null;
 		ExecRow		result = null;
 
diff --git a/java/engine/org/apache/derby/impl/sql/execute/OnceResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/OnceResultSet.java
index e2d5adca3..30ab97d30 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/OnceResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/OnceResultSet.java
@@ -161,6 +161,9 @@ public class OnceResultSet extends NoPutResultSetImpl
 	 */
 	public ExecRow	getNextRowCore() throws StandardException 
 	{
+		if( isXplainOnlyMode() )
+			return null;
+
 	    ExecRow candidateRow = null;
 		ExecRow secondRow = null;
 	    ExecRow result = null;
diff --git a/java/engine/org/apache/derby/impl/sql/execute/ProjectRestrictResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/ProjectRestrictResultSet.java
index 3c8239d50..0894c24e2 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/ProjectRestrictResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/ProjectRestrictResultSet.java
@@ -242,6 +242,8 @@ class ProjectRestrictResultSet extends NoPutResultSetImpl
 	 * @return the next row in the result
 	 */
 	public ExecRow	getNextRowCore() throws StandardException {
+		if( isXplainOnlyMode() )
+			return null;
 
 	    ExecRow candidateRow = null;
 	    ExecRow result = null;
diff --git a/java/engine/org/apache/derby/impl/sql/execute/RowCountResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/RowCountResultSet.java
index 19637f37c..cea00aa4d 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/RowCountResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/RowCountResultSet.java
@@ -180,6 +180,8 @@ class RowCountResultSet extends NoPutResultSetImpl
      * @return the next row in the result
      */
     public ExecRow  getNextRowCore() throws StandardException {
+	if( isXplainOnlyMode() )
+		return null;
 
         ExecRow result = null;
 
diff --git a/java/engine/org/apache/derby/impl/sql/execute/RowResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/RowResultSet.java
index 86da6468b..2ea39e283 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/RowResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/RowResultSet.java
@@ -131,6 +131,8 @@ class RowResultSet extends NoPutResultSetImpl
 	 * @exception StandardException thrown on failure.
      */
 	public ExecRow	getNextRowCore() throws StandardException {
+		if( isXplainOnlyMode() )
+			return null;
 
 		currentRow = null;
 		beginTime = getCurrentTimeMillis();
diff --git a/java/engine/org/apache/derby/impl/sql/execute/ScalarAggregateResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/ScalarAggregateResultSet.java
index d8b2e1669..db4123487 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/ScalarAggregateResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/ScalarAggregateResultSet.java
@@ -152,6 +152,9 @@ class ScalarAggregateResultSet extends GenericAggregateResultSet
 	 */
 	public ExecRow	getNextRowCore() throws StandardException 
 	{
+		if( isXplainOnlyMode() )
+			return null;
+
 		if (nextSatisfied)
 		{
 			clearCurrentRow();
diff --git a/java/engine/org/apache/derby/impl/sql/execute/ScrollInsensitiveResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/ScrollInsensitiveResultSet.java
index 3574eb4c2..71cb3fc9d 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/ScrollInsensitiveResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/ScrollInsensitiveResultSet.java
@@ -499,6 +499,9 @@ public class ScrollInsensitiveResultSet extends NoPutResultSetImpl
 	 */
 	public ExecRow	getNextRowCore() throws StandardException
 	{
+		if( isXplainOnlyMode() )
+			return null;
+
 		ExecRow result = null;
 
 		beginTime = getCurrentTimeMillis();
diff --git a/java/engine/org/apache/derby/impl/sql/execute/SetOpResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/SetOpResultSet.java
index 81b7aaa5c..b9b578b84 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/SetOpResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/SetOpResultSet.java
@@ -135,6 +135,9 @@ class SetOpResultSet extends NoPutResultSetImpl
 	 */
 	public ExecRow	getNextRowCore() throws StandardException
     {
+		if( isXplainOnlyMode() )
+			return null;
+
 		beginTime = getCurrentTimeMillis();
 	    if ( isOpen )
         {
diff --git a/java/engine/org/apache/derby/impl/sql/execute/SortResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/SortResultSet.java
index f6852f303..166018f2f 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/SortResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/SortResultSet.java
@@ -332,6 +332,9 @@ class SortResultSet extends NoPutResultSetImpl
 	 */
 	public ExecRow	getNextRowCore() throws StandardException 
 	{
+		if( isXplainOnlyMode() )
+			return null;
+
 		if (!isOpen)
 		{
 			return null;
diff --git a/java/engine/org/apache/derby/impl/sql/execute/TableScanResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/TableScanResultSet.java
index 01c24130f..7f68b6d74 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/TableScanResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/TableScanResultSet.java
@@ -453,6 +453,9 @@ class TableScanResultSet extends ScanResultSet
 	 */
 	public ExecRow getNextRowCore() throws StandardException
 	{
+		if( isXplainOnlyMode() )
+			return null;
+
         checkCancellationFlag();
             
 		if (currentRow == null || scanRepositioned)
diff --git a/java/engine/org/apache/derby/impl/sql/execute/UnionResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/UnionResultSet.java
index 82d32c625..f3305550d 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/UnionResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/UnionResultSet.java
@@ -115,6 +115,9 @@ class UnionResultSet extends NoPutResultSetImpl
  	 *	@exception StandardException thrown on failure
 	 */
 	public ExecRow	getNextRowCore() throws StandardException {
+		if( isXplainOnlyMode() )
+			return null;
+
 	    ExecRow result = null;
 
 		beginTime = getCurrentTimeMillis();
diff --git a/java/engine/org/apache/derby/impl/sql/execute/VTIResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/VTIResultSet.java
index 8f49d827b..ce5010db3 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/VTIResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/VTIResultSet.java
@@ -400,6 +400,9 @@ class VTIResultSet extends NoPutResultSetImpl
      */
 	public ExecRow	getNextRowCore() throws StandardException 
 	{
+		if( isXplainOnlyMode() )
+			return null;
+
 	    ExecRow result = null;
 
 		beginTime = getCurrentTimeMillis();
diff --git a/java/engine/org/apache/derby/impl/sql/execute/WindowResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/WindowResultSet.java
index c0e7fc9ad..f728d54f9 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/WindowResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/WindowResultSet.java
@@ -175,6 +175,9 @@ class WindowResultSet extends NoPutResultSetImpl
      */
     public ExecRow getNextRowCore() throws StandardException
     {
+		if( isXplainOnlyMode() )
+			return null;
+
         ExecRow sourceRow = null;
         ExecRow retval = null;
         boolean restrict = false;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/xplain.out b/java/testing/org/apache/derbyTesting/functionTests/master/xplain.out
new file mode 100644
index 000000000..649fb070c
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/xplain.out
@@ -0,0 +1,105 @@
+ij> --
+--   Licensed to the Apache Software Foundation (ASF) under one or more
+--   contributor license agreements.  See the NOTICE file distributed with
+--   this work for additional information regarding copyright ownership.
+--   The ASF licenses this file to You under the Apache License, Version 2.0
+--   (the "License"); you may not use this file except in compliance with
+--   the License.  You may obtain a copy of the License at
+--
+--      http://www.apache.org/licenses/LICENSE-2.0
+--
+--   Unless required by applicable law or agreed to in writing, software
+--   distributed under the License is distributed on an "AS IS" BASIS,
+--   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+--   See the License for the specific language governing permissions and
+--   limitations under the License.
+--
+create table derby6216( a int, status varchar(10));
+0 rows inserted/updated/deleted
+ij> insert into derby6216 values (1, 'ACTIVE'), (2, 'IDLE');
+2 rows inserted/updated/deleted
+ij> call syscs_util.syscs_set_runtimestatistics(1);
+0 rows inserted/updated/deleted
+ij> call syscs_util.syscs_set_xplain_schema('STATS');
+0 rows inserted/updated/deleted
+ij> call syscs_util.syscs_set_xplain_mode(1);
+0 rows inserted/updated/deleted
+ij> select a from derby6216 where status != 'IDLE';
+A          
+-----------
+ij> call syscs_util.syscs_set_xplain_mode(0);
+0 rows inserted/updated/deleted
+ij> call syscs_util.syscs_set_runtimestatistics(0);
+0 rows inserted/updated/deleted
+ij> call syscs_util.syscs_set_xplain_schema('');
+0 rows inserted/updated/deleted
+ij> select stmt_text from stats.sysxplain_statements;
+STMT_TEXT                                                                                                                       
+--------------------------------------------------------------------------------------------------------------------------------
+select a from derby6216 where status != 'IDLE'                                                                                  
+ij> select st.stmt_text, rs.op_identifier
+       from stats.sysxplain_statements st
+       join stats.sysxplain_resultsets rs
+         on st.stmt_id = rs.stmt_id
+       order by st.stmt_text,rs.op_identifier;
+STMT_TEXT                                                                                                                       |OP_IDENTIFIER                                                                                                                   
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+select a from derby6216 where status != 'IDLE'                                                                                  |PROJECTION                                                                                                                      
+select a from derby6216 where status != 'IDLE'                                                                                  |TABLESCAN                                                                                                                       
+ij> select st.stmt_text, sp.no_visited_pages, sp.no_visited_rows 
+    from stats.sysxplain_scan_props sp, 
+         stats.sysxplain_resultsets rs, 
+         stats.sysxplain_statements st 
+    where st.stmt_id = rs.stmt_id and 
+          rs.scan_rs_id = sp.scan_rs_id and 
+          rs.op_identifier = 'TABLESCAN' and 
+          sp.scan_object_name = 'DERBY6216';
+STMT_TEXT                                                                                                                       |NO_VISITED&|NO_VISITED&
+--------------------------------------------------------------------------------------------------------------------------------------------------------
+select a from derby6216 where status != 'IDLE'                                                                                  |0          |0          
+ij> drop table stats.sysxplain_statements;
+0 rows inserted/updated/deleted
+ij> drop table stats.sysxplain_resultsets;
+0 rows inserted/updated/deleted
+ij> drop table stats.sysxplain_scan_props;
+0 rows inserted/updated/deleted
+ij> drop table stats.sysxplain_sort_props;
+0 rows inserted/updated/deleted
+ij> call syscs_util.syscs_set_runtimestatistics(1);
+0 rows inserted/updated/deleted
+ij> call syscs_util.syscs_set_xplain_schema('STATS');
+0 rows inserted/updated/deleted
+ij> call syscs_util.syscs_set_xplain_mode(1);
+0 rows inserted/updated/deleted
+ij> select sql_text from syscs_diag.transaction_table where status != 'IDLE';
+SQL_TEXT                                                                                                                        
+--------------------------------------------------------------------------------------------------------------------------------
+ij> call syscs_util.syscs_set_xplain_mode(0);
+0 rows inserted/updated/deleted
+ij> call syscs_util.syscs_set_runtimestatistics(0);
+0 rows inserted/updated/deleted
+ij> call syscs_util.syscs_set_xplain_schema('');
+0 rows inserted/updated/deleted
+ij> select stmt_text from stats.sysxplain_statements;
+STMT_TEXT                                                                                                                       
+--------------------------------------------------------------------------------------------------------------------------------
+select sql_text from syscs_diag.transaction_table where status != 'IDLE'                                                        
+ij> select st.stmt_text, rs.op_identifier, rs.op_details, rs.returned_rows
+       from stats.sysxplain_statements st
+       join stats.sysxplain_resultsets rs
+         on st.stmt_id = rs.stmt_id
+       order by st.stmt_text,rs.op_identifier;
+STMT_TEXT                                                                                                                       |OP_IDENTIFIER                                                                                                                   |OP_DETAILS                                                                                                                      |RETURNED_R&
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+select sql_text from syscs_diag.transaction_table where status != 'IDLE'                                                        |PROJECT-FILTER                                                                                                                  |2;                                                                                                                              |0          
+select sql_text from syscs_diag.transaction_table where status != 'IDLE'                                                        |PROJECTION                                                                                                                      |3;                                                                                                                              |0          
+select sql_text from syscs_diag.transaction_table where status != 'IDLE'                                                        |VTI                                                                                                                             |org.apache.derby.diag.TransactionTable, (1)                                                                                     |0          
+ij> select count(*) from stats.sysxplain_scan_props;
+1          
+-----------
+0          
+ij> select count(*) from stats.sysxplain_sort_props;
+1          
+-----------
+0          
+ij> 
\ No newline at end of file
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/LangScripts.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/LangScripts.java
index e88591310..46cb6a340 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/LangScripts.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/LangScripts.java
@@ -92,6 +92,7 @@ public final class LangScripts extends ScriptTestCase {
         "union",
         "update",
         "valuesclause",
+        "xplain",
         };
     
     /**
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/XplainStatisticsTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/XplainStatisticsTest.java
index 051b72753..73e688573 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/XplainStatisticsTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/XplainStatisticsTest.java
@@ -71,7 +71,7 @@ import org.w3c.dom.NodeList;
  *
  * FIXME -- some general to-do items that I don't want to forget:
  * - should resultSetNumber be its own column in sysxplain_resultsets?
- * - need tests of xplain-only mode
+ * - need MORE tests of xplain-only mode
  * - need a test of external sorting/merging
  * - need to cross-check the result set types, and verify that they're
  *   all tested at least once
@@ -509,6 +509,18 @@ public class XplainStatisticsTest extends BaseJDBCTestCase {
         s.execute("call syscs_util.syscs_set_statistics_timing(1)");
     }
     
+    private static void enableXplainOnlyMode(Statement s)
+            throws SQLException
+    {
+        s.execute("call syscs_util.syscs_set_xplain_mode(1)");
+    }
+    
+    private static void clearXplainOnlyMode(Statement s)
+            throws SQLException
+    {
+        s.execute("call syscs_util.syscs_set_xplain_mode(0)");
+    }
+    
     /**
      * 
      * @param s
@@ -548,6 +560,7 @@ public class XplainStatisticsTest extends BaseJDBCTestCase {
     					null);
     		}
     	} 
+        s.execute("call syscs_util.syscs_set_xplain_schema('')");
     }
 
     private static void verifyXplainUnset(Statement s)
@@ -613,6 +626,32 @@ public class XplainStatisticsTest extends BaseJDBCTestCase {
         rs.close();
     }
     
+    private void dumpStatements(Statement s)
+        throws SQLException
+    {
+        ResultSet rs;
+        rs = s.executeQuery("select * from xpltest.sysxplain_statements");
+        while (rs.next())
+        {
+            System.out.println(
+                    rs.getString("stmt_id")+","+
+                    rs.getString("stmt_name")+","+
+                    rs.getString("stmt_type")+","+
+                    rs.getString("stmt_text")+","+
+                    rs.getString("jvm_id")+","+
+                    rs.getString("os_identifier")+","+
+                    rs.getString("xplain_mode")+","+
+                    rs.getString("xplain_time")+","+
+                    rs.getString("xplain_thread_id")+","+
+                    rs.getString("transaction_id")+","+
+                    rs.getString("session_id")+","+
+                    rs.getString("database_name")+","+
+                    rs.getString("drda_id")+","+
+                    rs.getString("timing_id"));
+        }
+        rs.close();
+    }
+    
     /**
      * Added by DERBY-4587
      * Returns the stmt_id for this particular statement
@@ -1034,6 +1073,298 @@ public class XplainStatisticsTest extends BaseJDBCTestCase {
         }
     }
     
+    private String getStmtIDByName(Statement s, String sName)
+			throws SQLException
+    {
+    	ResultSet rs;
+        String stmt_id = "?";
+        rs = s.executeQuery( 
+    		"select stmt_id from XPLTEST.sysxplain_statements "+
+		"where stmt_name='"+sName+"'"); 
+        if( rs.next() )
+	{
+            stmt_id = rs.getString(1); 
+	    //System.out.println("Found statemnt id " + stmt_id);
+	}
+        rs.close();
+        return stmt_id;
+    }
+    public void testSimpleXplainOnly() throws Exception
+    {
+        Statement s = createStatement();
+        ResultSet rs;
+
+        enableXplainStyle(s);
+        enableXplainOnlyMode(s);
+	s.setCursorName("1");
+        JDBC.assertEmpty(s.executeQuery(
+        	"SELECT country from countries "+
+	         "WHERE region = 'Central America'" ));
+        clearXplainOnlyMode(s);
+        disableXplainStyle(s);
+
+	// dumpStatements(s);
+        // dumpResultSets(s);
+	// There should be 1 statement captured with stmt_id='1'.
+	// It should have a PROJECTION and a TABLESCAN; the TABLESCAN should be
+	// on the COUNTRIES table.
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select count(*) from xpltest.sysxplain_statements"), "1");
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select count(*) from xpltest.sysxplain_statements "+
+	    "where stmt_name='1'"), "1");
+	String stmt_id = getStmtIDByName( s, "1" );
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select count(*) from xpltest.sysxplain_resultsets "+
+	    "where stmt_id='"+stmt_id+"'"), "2");
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select count(*) from xpltest.sysxplain_resultsets "+
+	    "where stmt_id='"+stmt_id+"' and op_identifier='PROJECTION'"), "1");
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select count(*) from xpltest.sysxplain_resultsets "+
+	    "where stmt_id='"+stmt_id+"' and op_identifier='TABLESCAN'"), "1");
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select op_details from xpltest.sysxplain_resultsets "+
+	    "where stmt_id='"+stmt_id+"' and op_identifier='TABLESCAN'"),
+	    "T: COUNTRIES");
+
+        enableXplainStyle(s);
+        enableXplainOnlyMode(s);
+	s.setCursorName("2");
+        JDBC.assertEmpty(s.executeQuery(
+            "select sql_text from syscs_diag.transaction_table " +
+	    "where status != 'IDLE'" ));
+        clearXplainOnlyMode(s);
+        disableXplainStyle(s);
+
+	//dumpStatements(s);
+        //dumpResultSets(s);
+
+	// This statement should have three result sets:
+	// - PROJECTION (select sql_text)
+	// - PROJECT-FILTER (where status != IDLE)
+	// - VTI (syscs_diag.transaction_table)
+	//
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select count(*) from xpltest.sysxplain_statements"), "1");
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select count(*) from xpltest.sysxplain_statements "+
+	    "where stmt_name='2'"), "1");
+	stmt_id = getStmtIDByName( s, "2" );
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select count(*) from xpltest.sysxplain_resultsets "+
+	    "where stmt_id='"+stmt_id+"' and op_identifier='PROJECTION'"), "1");
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select count(*) from xpltest.sysxplain_resultsets "+
+	    "where stmt_id='"+stmt_id+"' and "+
+	    "      op_identifier='PROJECT-FILTER'"), "1");
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select count(*) from xpltest.sysxplain_resultsets "+
+	    "where stmt_id='"+stmt_id+"' and op_identifier='VTI'"), "1");
+
+        String selectStatement = 
+            "select region, count(country) from app.countries group by region";
+        enableXplainStyle(s);
+        enableXplainOnlyMode(s);
+	s.setCursorName("3");
+        JDBC.assertEmpty(s.executeQuery(selectStatement));
+
+        clearXplainOnlyMode(s);
+        disableXplainStyle(s);
+	//dumpStatements(s);
+        //dumpResultSets(s);
+
+        // This statement is executed as a PROJECTION with a child GROUPBY
+        // with a child PROJECTION with a child TABLESCAN. The TABLESCAN
+        // has a corresponding SCAN_PROPS row, the GROUPBY has a
+        // corresponding SORT_PROPS row. But since we're XPLAIN-ONLY, none
+	// of the actual processing did anything.
+        //
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select count(*) from xpltest.sysxplain_resultsets"), "4");
+        JDBC.assertFullResultSet(s.executeQuery(
+                    "select op_identifier from xpltest.sysxplain_resultsets " +
+                    "order by op_identifier"),
+            new String[][] {
+                {"GROUPBY"},{"PROJECTION"},{"PROJECTION"},{"TABLESCAN"} } );
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select count(*) from xpltest.sysxplain_resultsets " +
+            "where scan_rs_id is not null"), "1");
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select count(*) from xpltest.sysxplain_resultsets " +
+            "where sort_rs_id is not null"), "1");
+        JDBC.assertFullResultSet(s.executeQuery(
+                    "select s.stmt_text, rs.op_identifier," +
+                    " srt.no_input_rows, srt.no_output_rows " +
+                    " from xpltest.sysxplain_sort_props srt, " +
+                    " xpltest.sysxplain_resultsets rs, " +
+                    " xpltest.sysxplain_statements s " +
+                    " where rs.stmt_id = s.stmt_id and " +
+                    " rs.sort_rs_id = srt.sort_rs_id"),
+            new String[][] {
+                {selectStatement, "GROUPBY", "0", "0"} } );
+
+        JDBC.assertUnorderedResultSet(s.executeQuery(
+                    "select srt.sort_type, srt.no_input_rows, " +
+                    " srt.no_output_rows, srt.no_merge_runs, " +
+                    " srt.merge_run_details, srt.eliminate_duplicates, " +
+                    " srt.in_sort_order, srt.distinct_aggregate " +
+                    "from xpltest.sysxplain_sort_props srt " +
+                    "join xpltest.sysxplain_resultsets rs " +
+                    "on srt.sort_rs_id = rs.sort_rs_id " +
+                    "where rs.op_identifier='GROUPBY'"),
+                new String[][] {
+                    {"IN","0","0",null, null, null,"N","N"} } );
+    }
+
+    public void testXplainOnlyExecutePrepared() throws Exception
+    {
+        Statement s = createStatement();
+        ResultSet rs;
+
+        String selectStatement = 
+            "select region, count(country) from app.countries group by region";
+        PreparedStatement ps = prepareStatement( selectStatement );
+        enableXplainStyle(s);
+        enableXplainOnlyMode(s);
+        JDBC.assertEmpty(ps.executeQuery());
+        clearXplainOnlyMode(s);
+        disableXplainStyle(s);
+	//dumpStatements(s);
+        //dumpResultSets(s);
+
+        // This statement is executed as a PROJECTION with a child GROUPBY
+        // with a child PROJECTION with a child TABLESCAN. The TABLESCAN
+        // has a corresponding SCAN_PROPS row, the GROUPBY has a
+        // corresponding SORT_PROPS row. But since we're XPLAIN-ONLY, none
+	// of the actual processing did anything.
+        //
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select count(*) from xpltest.sysxplain_resultsets"), "4");
+        JDBC.assertFullResultSet(s.executeQuery(
+                    "select op_identifier from xpltest.sysxplain_resultsets " +
+                    "order by op_identifier"),
+            new String[][] {
+                {"GROUPBY"},{"PROJECTION"},{"PROJECTION"},{"TABLESCAN"} } );
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select count(*) from xpltest.sysxplain_resultsets " +
+            "where scan_rs_id is not null"), "1");
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select count(*) from xpltest.sysxplain_resultsets " +
+            "where sort_rs_id is not null"), "1");
+        JDBC.assertFullResultSet(s.executeQuery(
+                    "select s.stmt_text, rs.op_identifier," +
+                    " srt.no_input_rows, srt.no_output_rows " +
+                    " from xpltest.sysxplain_sort_props srt, " +
+                    " xpltest.sysxplain_resultsets rs, " +
+                    " xpltest.sysxplain_statements s " +
+                    " where rs.stmt_id = s.stmt_id and " +
+                    " rs.sort_rs_id = srt.sort_rs_id"),
+            new String[][] {
+                {selectStatement, "GROUPBY", "0", "0"} } );
+
+        JDBC.assertUnorderedResultSet(s.executeQuery(
+                    "select srt.sort_type, srt.no_input_rows, " +
+                    " srt.no_output_rows, srt.no_merge_runs, " +
+                    " srt.merge_run_details, srt.eliminate_duplicates, " +
+                    " srt.in_sort_order, srt.distinct_aggregate " +
+                    "from xpltest.sysxplain_sort_props srt " +
+                    "join xpltest.sysxplain_resultsets rs " +
+                    "on srt.sort_rs_id = rs.sort_rs_id " +
+                    "where rs.op_identifier='GROUPBY'"),
+                new String[][] {
+                    {"IN","0","0",null, null, null,"N","N"} } );
+
+	
+	// Since now we're not in XplainOnly mode, the prepared statement
+	// returns the expected normal result set.
+
+        JDBC.assertUnorderedResultSet(ps.executeQuery(),
+            new String[][] { 
+                {"Africa", "19"}, {"Asia", "15"},
+                {"Australia and New Zealand", "2"}, {"Caribbean", "10"},
+                {"Central America", "6"}, {"Central Asia", "4"},
+                {"Europe", "29"}, {"Middle East", "7"},
+                {"North Africa", "5"}, {"North America", "3"},
+                {"Pacific Islands", "3"}, {"South America", "11"} } );
+
+	// And then back to empty again:
+        enableXplainStyle(s);
+        enableXplainOnlyMode(s);
+        JDBC.assertEmpty(ps.executeQuery());
+        clearXplainOnlyMode(s);
+        disableXplainStyle(s);
+    }
+    
+    public void testXplainOnlyPrepared() throws Exception
+    {
+        Statement s = createStatement();
+        ResultSet rs;
+
+        String selectStatement = 
+            "select region, count(country) from app.countries group by region";
+
+        // Try preparing the statement while we're in xplain-only mode, then
+        // execute it normally.
+
+        enableXplainStyle(s);
+        enableXplainOnlyMode(s);
+        PreparedStatement ps2 = prepareStatement( selectStatement );
+        clearXplainOnlyMode(s);
+        JDBC.assertUnorderedResultSet(ps2.executeQuery(),
+            new String[][] { 
+                {"Africa", "19"}, {"Asia", "15"},
+                {"Australia and New Zealand", "2"}, {"Caribbean", "10"},
+                {"Central America", "6"}, {"Central Asia", "4"},
+                {"Europe", "29"}, {"Middle East", "7"},
+                {"North Africa", "5"}, {"North America", "3"},
+                {"Pacific Islands", "3"}, {"South America", "11"} } );
+        disableXplainStyle(s);
+	//dumpStatements(s);
+        //dumpResultSets(s);
+
+        // This statement is executed as a PROJECTION with a child GROUPBY
+        // with a child PROJECTION with a child TABLESCAN. The TABLESCAN
+        // has a corresponding SCAN_PROPS row, the GROUPBY has a
+        // corresponding SORT_PROPS row. But since we're XPLAIN-ONLY, none
+	// of the actual processing did anything.
+        //
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select count(*) from xpltest.sysxplain_resultsets"), "4");
+        JDBC.assertFullResultSet(s.executeQuery(
+                    "select op_identifier from xpltest.sysxplain_resultsets " +
+                    "order by op_identifier"),
+            new String[][] {
+                {"GROUPBY"},{"PROJECTION"},{"PROJECTION"},{"TABLESCAN"} } );
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select count(*) from xpltest.sysxplain_resultsets " +
+            "where scan_rs_id is not null"), "1");
+        JDBC.assertSingleValueResultSet(s.executeQuery(
+            "select count(*) from xpltest.sysxplain_resultsets " +
+            "where sort_rs_id is not null"), "1");
+        JDBC.assertFullResultSet(s.executeQuery(
+                    "select s.stmt_text, rs.op_identifier," +
+                    " srt.no_input_rows, srt.no_output_rows " +
+                    " from xpltest.sysxplain_sort_props srt, " +
+                    " xpltest.sysxplain_resultsets rs, " +
+                    " xpltest.sysxplain_statements s " +
+                    " where rs.stmt_id = s.stmt_id and " +
+                    " rs.sort_rs_id = srt.sort_rs_id"),
+            new String[][] {
+                {selectStatement, "GROUPBY", "114", "12"} } );
+
+        JDBC.assertUnorderedResultSet(s.executeQuery(
+                    "select srt.sort_type, srt.no_input_rows, " +
+                    " srt.no_output_rows, srt.no_merge_runs, " +
+                    " srt.merge_run_details, srt.eliminate_duplicates, " +
+                    " srt.in_sort_order, srt.distinct_aggregate " +
+                    "from xpltest.sysxplain_sort_props srt " +
+                    "join xpltest.sysxplain_resultsets rs " +
+                    "on srt.sort_rs_id = rs.sort_rs_id " +
+                    "where rs.op_identifier='GROUPBY'"),
+                new String[][] {
+                    {"IN","114","12",null, null, null,"N","N"} } );
+    }
     
     
     /**
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/xplain.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/xplain.sql
new file mode 100644
index 000000000..9b57e604f
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/xplain.sql
@@ -0,0 +1,60 @@
+--
+--   Licensed to the Apache Software Foundation (ASF) under one or more
+--   contributor license agreements.  See the NOTICE file distributed with
+--   this work for additional information regarding copyright ownership.
+--   The ASF licenses this file to You under the Apache License, Version 2.0
+--   (the "License"); you may not use this file except in compliance with
+--   the License.  You may obtain a copy of the License at
+--
+--      http://www.apache.org/licenses/LICENSE-2.0
+--
+--   Unless required by applicable law or agreed to in writing, software
+--   distributed under the License is distributed on an "AS IS" BASIS,
+--   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+--   See the License for the specific language governing permissions and
+--   limitations under the License.
+--
+create table derby6216( a int, status varchar(10));
+insert into derby6216 values (1, 'ACTIVE'), (2, 'IDLE');
+call syscs_util.syscs_set_runtimestatistics(1); 
+call syscs_util.syscs_set_xplain_schema('STATS'); 
+call syscs_util.syscs_set_xplain_mode(1); 
+select a from derby6216 where status != 'IDLE'; 
+call syscs_util.syscs_set_xplain_mode(0); 
+call syscs_util.syscs_set_runtimestatistics(0); 
+call syscs_util.syscs_set_xplain_schema(''); 
+select stmt_text from stats.sysxplain_statements;
+select st.stmt_text, rs.op_identifier
+       from stats.sysxplain_statements st
+       join stats.sysxplain_resultsets rs
+         on st.stmt_id = rs.stmt_id
+       order by st.stmt_text,rs.op_identifier;
+select st.stmt_text, sp.no_visited_pages, sp.no_visited_rows 
+    from stats.sysxplain_scan_props sp, 
+         stats.sysxplain_resultsets rs, 
+         stats.sysxplain_statements st 
+    where st.stmt_id = rs.stmt_id and 
+          rs.scan_rs_id = sp.scan_rs_id and 
+          rs.op_identifier = 'TABLESCAN' and 
+          sp.scan_object_name = 'DERBY6216';
+
+drop table stats.sysxplain_statements;
+drop table stats.sysxplain_resultsets;
+drop table stats.sysxplain_scan_props;
+drop table stats.sysxplain_sort_props;
+
+call syscs_util.syscs_set_runtimestatistics(1); 
+call syscs_util.syscs_set_xplain_schema('STATS'); 
+call syscs_util.syscs_set_xplain_mode(1); 
+select sql_text from syscs_diag.transaction_table where status != 'IDLE'; 
+call syscs_util.syscs_set_xplain_mode(0); 
+call syscs_util.syscs_set_runtimestatistics(0); 
+call syscs_util.syscs_set_xplain_schema(''); 
+select stmt_text from stats.sysxplain_statements;
+select st.stmt_text, rs.op_identifier, rs.op_details, rs.returned_rows
+       from stats.sysxplain_statements st
+       join stats.sysxplain_resultsets rs
+         on st.stmt_id = rs.stmt_id
+       order by st.stmt_text,rs.op_identifier;
+select count(*) from stats.sysxplain_scan_props;
+select count(*) from stats.sysxplain_sort_props;
