diff --git a/java/testing/org/apache/derbyTesting/unitTests/junit/MissingPermissionsTest.java b/java/testing/org/apache/derbyTesting/unitTests/junit/MissingPermissionsTest.java
index 1cd3dedbf..9eb087f15 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/junit/MissingPermissionsTest.java
+++ b/java/testing/org/apache/derbyTesting/unitTests/junit/MissingPermissionsTest.java
@@ -22,7 +22,6 @@
 package org.apache.derbyTesting.unitTests.junit;
 
 import java.io.BufferedReader;
-import java.io.File;
 import java.io.FileNotFoundException;
 import java.io.FileReader;
 import java.io.IOException;
@@ -205,14 +204,16 @@ public class MissingPermissionsTest extends BaseJDBCTestCase {
         // The command runs ij with a security manager whose policy
         // lacks the permissions to create derby.system.home.
         final List<String> args = new ArrayList<String>();
-        final String codeJarUrl = "file:" + getDerbyJarPath();
         args.add("-Djava.security.manager");
-        args.add("-Djava.security.policy==extin/MissingPermissionsTest2.policy");
-        args.add("-DderbyTesting.codejar=" + codeJarUrl);
+        args.add("-Djava.security.policy=extin/MissingPermissionsTest2.policy");
+        args.add("-DderbyTesting.codejar="
+                    + getSystemProperty("derbyTesting.codejar"));
+        args.add("-DderbyTesting.testjar="
+                    + getSystemProperty("derbyTesting.testjar"));
+        args.add("-DderbyTesting.antjunit="
+                    + getSystemProperty("derbyTesting.antjunit"));
         args.add("-Dderby.system.home=system/nested");
         args.add("-Dij.connection.test=jdbc:derby:wombat;create=true");
-        args.add("-classpath");
-        args.add(getClassPath());
         args.add("org.apache.derby.tools.ij");
         final String[] argArray = args.toArray(new String[0]);
 
@@ -302,27 +303,4 @@ public class MissingPermissionsTest extends BaseJDBCTestCase {
                 return new BufferedReader(new FileReader(file));
             }});
     }
-
-
-    private static String getClassPath() throws PrivilegedActionException {
-        return AccessController.doPrivileged(
-                new PrivilegedExceptionAction<String>() {
-            @Override
-            public String run() {
-                return System.getProperty("java.class.path");
-            }});
-    }
-
-    private static String getDerbyJarPath() throws PrivilegedActionException {
-        final String classpath = getClassPath();
-        final String[] classpathEntries = classpath.split(File.pathSeparator);
-
-        for (String s: classpathEntries) {
-            int i = s.indexOf("derby.jar");
-            if (i >= 0) {
-                return s.substring(0, i);
-            }
-        }
-        return null;
-    }
 }
diff --git a/java/testing/org/apache/derbyTesting/unitTests/junit/MissingPermissionsTest.policy b/java/testing/org/apache/derbyTesting/unitTests/junit/MissingPermissionsTest.policy
index 2d3bd3268..f271a7bf5 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/junit/MissingPermissionsTest.policy
+++ b/java/testing/org/apache/derbyTesting/unitTests/junit/MissingPermissionsTest.policy
@@ -126,3 +126,27 @@ grant codeBase "${derbyTesting.testjar}derbyTesting.jar" {
   // **** Needed by this test
   permission java.io.FilePermission "<<ALL FILES>>", "read,write,delete";
 };
+
+// JUnit jar file tries to read junit.properties in the user's
+// home directory and seems to require permission to read the
+// property user.home as well.
+// junit.swingui.TestRunner writes to .junitsession on exit.
+grant codeBase "${derbyTesting.junit}" {
+    permission java.util.PropertyPermission "user.home", "read";
+    permission java.io.FilePermission "${user.home}${/}junit.properties", "read";
+    permission java.io.FilePermission "${user.home}${/}.junitsession", "write";
+
+    // This permission is needed when running the tests using ant 1.7
+    permission java.io.FilePermission "${user.dir}${/}*", "write";
+};
+
+// Ant's junit runner requires setOut to redirect the System output streams
+// to the forked JVM used when running junit tests inside Ant. Ant requires
+// forking the JVM if you want to run tests in a different directory than the
+// current one.
+grant codeBase "${derbyTesting.antjunit}" {
+    permission java.lang.RuntimePermission "setIO";
+
+    // This permission is needed when running the tests using ant 1.7
+    permission java.io.FilePermission "${user.dir}${/}*", "write";
+};
diff --git a/java/testing/org/apache/derbyTesting/unitTests/junit/MissingPermissionsTest1.policy b/java/testing/org/apache/derbyTesting/unitTests/junit/MissingPermissionsTest1.policy
index f3bc47c41..5ccfb92f5 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/junit/MissingPermissionsTest1.policy
+++ b/java/testing/org/apache/derbyTesting/unitTests/junit/MissingPermissionsTest1.policy
@@ -128,3 +128,27 @@ grant codeBase "${derbyTesting.testjar}derbyTesting.jar" {
   // **** Needed by this test
   permission java.io.FilePermission "<<ALL FILES>>", "read,write,delete";
 };
+
+// JUnit jar file tries to read junit.properties in the user's
+// home directory and seems to require permission to read the
+// property user.home as well.
+// junit.swingui.TestRunner writes to .junitsession on exit.
+grant codeBase "${derbyTesting.junit}" {
+    permission java.util.PropertyPermission "user.home", "read";
+    permission java.io.FilePermission "${user.home}${/}junit.properties", "read";
+    permission java.io.FilePermission "${user.home}${/}.junitsession", "write";
+
+    // This permission is needed when running the tests using ant 1.7
+    permission java.io.FilePermission "${user.dir}${/}*", "write";
+};
+
+// Ant's junit runner requires setOut to redirect the System output streams
+// to the forked JVM used when running junit tests inside Ant. Ant requires
+// forking the JVM if you want to run tests in a different directory than the
+// current one.
+grant codeBase "${derbyTesting.antjunit}" {
+    permission java.lang.RuntimePermission "setIO";
+
+    // This permission is needed when running the tests using ant 1.7
+    permission java.io.FilePermission "${user.dir}${/}*", "write";
+};
diff --git a/java/testing/org/apache/derbyTesting/unitTests/junit/MissingPermissionsTest2.policy b/java/testing/org/apache/derbyTesting/unitTests/junit/MissingPermissionsTest2.policy
index 214ebed8a..62463bc83 100644
--- a/java/testing/org/apache/derbyTesting/unitTests/junit/MissingPermissionsTest2.policy
+++ b/java/testing/org/apache/derbyTesting/unitTests/junit/MissingPermissionsTest2.policy
@@ -134,3 +134,27 @@ grant codeBase "${derbyTesting.codejar}derbytools.jar"
   permission java.io.FilePermission "java.runtime.version", "read";
   permission java.io.FilePermission "java.fullversion", "read";
 };
+
+// JUnit jar file tries to read junit.properties in the user's
+// home directory and seems to require permission to read the
+// property user.home as well.
+// junit.swingui.TestRunner writes to .junitsession on exit.
+grant codeBase "${derbyTesting.junit}" {
+    permission java.util.PropertyPermission "user.home", "read";
+    permission java.io.FilePermission "${user.home}${/}junit.properties", "read";
+    permission java.io.FilePermission "${user.home}${/}.junitsession", "write";
+
+    // This permission is needed when running the tests using ant 1.7
+    permission java.io.FilePermission "${user.dir}${/}*", "write";
+};
+
+// Ant's junit runner requires setOut to redirect the System output streams
+// to the forked JVM used when running junit tests inside Ant. Ant requires
+// forking the JVM if you want to run tests in a different directory than the
+// current one.
+grant codeBase "${derbyTesting.antjunit}" {
+    permission java.lang.RuntimePermission "setIO";
+
+    // This permission is needed when running the tests using ant 1.7
+    permission java.io.FilePermission "${user.dir}${/}*", "write";
+};
