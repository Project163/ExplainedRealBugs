diff --git a/java/engine/org/apache/derby/iapi/types/SqlXmlUtil.java b/java/engine/org/apache/derby/iapi/types/SqlXmlUtil.java
index d537b2c92..680d41bd4 100644
--- a/java/engine/org/apache/derby/iapi/types/SqlXmlUtil.java
+++ b/java/engine/org/apache/derby/iapi/types/SqlXmlUtil.java
@@ -198,6 +198,13 @@ public class SqlXmlUtil
             dBF.setValidating(false);
             dBF.setNamespaceAware(true);
 
+            if ( System.getSecurityManager() == null )
+            {
+                dBF.setFeature( XMLConstants.FEATURE_SECURE_PROCESSING, true );
+                dBF.setFeature(
+                 "http://xml.org/sax/features/external-general-entities", false );
+            }
+
             // Load document builder that can be used for parsing XML.
             dBuilder = dBF.newDocumentBuilder();
             dBuilder.setErrorHandler(new XMLErrorHandler());
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/XMLXXETest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/XMLXXETest.java
index 668e36717..f85417ed0 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/XMLXXETest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/XMLXXETest.java
@@ -119,15 +119,10 @@ public final class XMLXXETest extends BaseJDBCTestCase {
 
 	s.execute( stmt );
 
-	// XXX: The next result is wrong. The expected behavior is that the
-	// query should be rejected as a security violation. See DERBY-6807
-	// for more details; when that issue is resolved, this test will need
-	// to be changed.
-
         JDBC.assertSingleValueResultSet(
                 s.executeQuery(
 	            "SELECT XMLSERIALIZE(xml_col AS CLOB) FROM xml_data"),
-	            "<yolo>HelloWorld</yolo>");
+	            "<yolo/>");
 
         password.delete();
     }
