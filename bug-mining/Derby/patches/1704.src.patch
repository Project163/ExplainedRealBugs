diff --git a/java/drda/org/apache/derby/impl/drda/DssTrace.java b/java/drda/org/apache/derby/impl/drda/DssTrace.java
index 4489c6ed4..92d200461 100644
--- a/java/drda/org/apache/derby/impl/drda/DssTrace.java
+++ b/java/drda/org/apache/derby/impl/drda/DssTrace.java
@@ -21,6 +21,7 @@
 package org.apache.derby.impl.drda;
 
 import java.io.File;
+import java.io.FileNotFoundException;
 import java.io.IOException;
 import java.io.PrintWriter;
 import java.security.AccessController;
@@ -173,33 +174,57 @@ public class DssTrace
     synchronized (comBufferSync) {
         // Only start the trace if it is off.
         if (comBufferTraceOn == false) {
-            try {
-                // Attempt to make the trace directory if it does not exist.
-                // If we can't create the directory the exception will occur 
-                // when trying to create the trace file.
-                final File traceDirectory = new File(fileName).getParentFile();
-                if (traceDirectory != null) {
-                    AccessController.doPrivileged(
-                            new PrivilegedAction() {
-                                public Object run() {
-                                    traceDirectory.mkdirs();
-                                    return null;
-                                }
-                            });
-
-                }
-                // The writer will be buffered for effeciency.
-                comBufferWriter =  ((PrintWriter)AccessController.doPrivileged(
+            // Make up to two attempts to create the trace file.
+            // First just try to make it. Then if we get a FileNotFoundException
+            // try making the directory and then retry the create.
+            // We don't try making the directory first because it would require
+            // extra permissions if the directory already exists. DERBY-4128
+            for (int attempt=0; attempt <2; attempt++) {
+                try {             	
+                    // The writer will be buffered for effeciency.
+                    comBufferWriter =  ((PrintWriter)AccessController.doPrivileged(
                             new PrivilegedExceptionAction() {
                                 public Object run() throws SecurityException, IOException {
                                     return new  PrintWriter (new java.io.BufferedWriter (new java.io.FileWriter (fileName), 4096));
                                 }
                             }));
-            } catch (PrivilegedActionException pae) {
-               throw  pae.getException();
-               
-            }
-          
+                } catch (PrivilegedActionException pae) {
+                    Exception e = pae.getException();
+                    // If we got a FileNotFoundException on the first attempt,
+                    // it is likely that the directory did not exist. 
+                    //We will try to make it.
+                    if (attempt == 0 && (e instanceof FileNotFoundException)) {
+                        final File traceDirectory = new File(fileName).getParentFile();
+                        if (traceDirectory != null) {
+                            AccessController.doPrivileged(
+                                    new PrivilegedAction() {
+                                        public Object run() {
+                                            // DERBY-4128: First try to create the
+                                            // directory with mkdir(), as that doesn't
+                                            // require read permission for the parent
+                                            // directory. It will only succeed if the
+                                            // parent directory exists. If mkdir()
+                                            // fails, retry with mkdirs(), which will
+                                            // create the parent directories as needed,
+                                            // but which also requires that read
+                                            // permission for the parent directory
+                                            // has been granted.
+                                            boolean created = traceDirectory.mkdir();
+                                            if (!created) {
+                                                traceDirectory.mkdirs();
+                                            }
+                                            return null;
+                                        }
+                                    });
+
+                        }
+                    } else {
+                        // This is our second attempt or we got some other exception besides
+                        // FileNotFoundException. Just throw the exception.
+                        throw e;
+                    }
+                }
+        	}
           // Turn on the trace flag.
           comBufferTraceOn = true;
           // initialize the codepoint name table if it is null.
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/GetCurrentPropertiesTest.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/GetCurrentPropertiesTest.policy
index ca75ae2a2..25f917431 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/GetCurrentPropertiesTest.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/GetCurrentPropertiesTest.policy
@@ -98,8 +98,8 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar" {
   permission java.net.SocketPermission "${derbyTesting.serverhost}", "accept,connect";
 
   // For testPropertiesAfterConnection and testPropertiesTraceOn
-  permission java.io.FilePermission "${derby.system.home}", "read";
   permission java.io.FilePermission "${derby.system.home}${/}-", "write"; 
+
 };
 
 //
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NetworkServerControlApiTest.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NetworkServerControlApiTest.policy
index f2132cb45..30f0f6391 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NetworkServerControlApiTest.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NetworkServerControlApiTest.policy
@@ -93,8 +93,7 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar" {
   permission java.net.SocketPermission "${derbyTesting.clienthost}", "accept,connect";
   permission java.net.SocketPermission "${derbyTesting.serverhost}", "accept,connect";
     //tracing testing. NetworkServerControlApiTest
-    permission java.io.FilePermission "${derby.system.home}", "read";
-    permission java.io.FilePermission "${derby.system.home}${/}-", "read,write";
+    permission java.io.FilePermission "${derby.system.home}${/}-", "write";
 };
 
 //
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/ServerPropertiesTest.policy b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/ServerPropertiesTest.policy
index f853b74ef..a883d4eae 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/ServerPropertiesTest.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/ServerPropertiesTest.policy
@@ -98,7 +98,6 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar" {
   permission java.net.SocketPermission "${derbyTesting.serverhost}", "accept,connect";
 
   // for testToggleTrace:
-  permission java.io.FilePermission "${derby.system.home}", "read,write";
   permission java.io.FilePermission "${derby.system.home}${/}-", "write"; 
 };
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy b/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
index 3ef8ba501..e20af888b 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
+++ b/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy
@@ -142,8 +142,8 @@ grant codeBase "${derbyTesting.codejar}derbynet.jar" {
   permission java.net.SocketPermission "${derbyTesting.clienthost}", "accept,connect";
   permission java.net.SocketPermission "${derbyTesting.serverhost}", "accept,connect";
   // Need to be able to write to trace file for NetworkServerControlApiTest
+  permission java.io.FilePermission "${user.dir}${/}system${/}trace", "write"; 
   permission java.io.FilePermission "${user.dir}${/}system${/}trace${/}-", "write"; 
-  permission java.io.FilePermission "${user.dir}${/}system${/}trace", "read,write";
     // Needed for NetworkServerMBean access (see JMX section above)
   permission org.apache.derby.security.SystemPermission "server", "control,monitor";
   
