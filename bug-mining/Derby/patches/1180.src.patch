diff --git a/java/drda/org/apache/derby/impl/drda/DRDAConnThread.java b/java/drda/org/apache/derby/impl/drda/DRDAConnThread.java
index 51328830a..bcae24eaa 100644
--- a/java/drda/org/apache/derby/impl/drda/DRDAConnThread.java
+++ b/java/drda/org/apache/derby/impl/drda/DRDAConnThread.java
@@ -1261,7 +1261,7 @@ class DRDAConnThread extends Thread {
         if ((database.securityMechanism == CodePoint.SECMEC_USRSSBPWD) &&
             (database.dbName.indexOf(Attribute.PASSWORD_ATTR) == -1))
         {
-            p.put(Attribute.CLIENT_SECURITY_MECHANISM,
+            p.put(Attribute.DRDA_SECMEC,
                   String.valueOf(database.securityMechanism));
             p.put(Attribute.DRDA_SECTKN_IN,
                   DecryptionManager.toHexString(database.secTokenIn, 0,
diff --git a/java/engine/org/apache/derby/iapi/reference/Attribute.java b/java/engine/org/apache/derby/iapi/reference/Attribute.java
index 2ed1c6575..f9ed5d93d 100644
--- a/java/engine/org/apache/derby/iapi/reference/Attribute.java
+++ b/java/engine/org/apache/derby/iapi/reference/Attribute.java
@@ -237,6 +237,15 @@ public interface Attribute {
      */
     String DRDA_SECTKN_IN = "drdaSecTokenIn";
     String DRDA_SECTKN_OUT = "drdaSecTokenOut";
+    /**
+     * Internal attribute which holds the value of the securityMechanism
+     * attribute specified by the client. Used for passing information about
+     * which security mechanism to use from the network server to the embedded
+     * driver. Use another name than "securityMechanism" in order to prevent
+     * confusion if an attempt is made to establish an embedded connection with
+     * securityMechanism specified (see DERBY-3025).
+     */
+    String DRDA_SECMEC = "drdaSecMec";
 
 	/**
 	 * Internal attribute. Used to always allow soft upgrade for
diff --git a/java/engine/org/apache/derby/impl/jdbc/authentication/BasicAuthenticationServiceImpl.java b/java/engine/org/apache/derby/impl/jdbc/authentication/BasicAuthenticationServiceImpl.java
index 25236ddfe..e9b4d5093 100644
--- a/java/engine/org/apache/derby/impl/jdbc/authentication/BasicAuthenticationServiceImpl.java
+++ b/java/engine/org/apache/derby/impl/jdbc/authentication/BasicAuthenticationServiceImpl.java
@@ -176,7 +176,7 @@ public final class BasicAuthenticationServiceImpl
         // assess the substitute password to be legitimate for Derby's
         // BUILTIN authentication scheme/provider.
         if ((clientSecurityMechanism =
-                info.getProperty(Attribute.CLIENT_SECURITY_MECHANISM)) != null)
+                info.getProperty(Attribute.DRDA_SECMEC)) != null)
         {
             secMec = Integer.parseInt(clientSecurityMechanism);
         }
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NSSecurityMechanismTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NSSecurityMechanismTest.java
index 9b0e0642d..767f6d35e 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NSSecurityMechanismTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NSSecurityMechanismTest.java
@@ -41,6 +41,7 @@ import javax.sql.PooledConnection;
 import org.apache.derby.drda.NetworkServerControl;
 
 import org.apache.derbyTesting.junit.BaseJDBCTestCase;
+import org.apache.derbyTesting.junit.DatabasePropertyTestSetup;
 import org.apache.derbyTesting.junit.J2EEDataSource;
 import org.apache.derbyTesting.junit.JDBCDataSource;
 import org.apache.derbyTesting.junit.NetworkServerTestSetup;
@@ -173,9 +174,20 @@ public class NSSecurityMechanismTest extends BaseJDBCTestCase
     public static Test suite() 
     {
         TestSuite suite = new TestSuite("NSSecurityMechanismTest");
-        suite.addTest(new NSSecurityMechanismTest(
+
+        TestSuite clientSuite =
+            new TestSuite("NSSecurityMechanismTest - client");
+        clientSuite.addTest(new NSSecurityMechanismTest(
             "testNetworkServerSecurityMechanism"));
-        return TestConfiguration.clientServerDecorator((suite));
+        suite.addTest(TestConfiguration.clientServerDecorator(clientSuite));
+
+        // Test case for embedded mode. Enable builtin authentication.
+        suite.addTest(
+            DatabasePropertyTestSetup.builtinAuthentication(
+                new NSSecurityMechanismTest("testSecurityMechanismOnEmbedded"),
+                new String[] { "calvin" }, "pw"));
+
+        return suite;
     }
     
     public void tearDown() throws Exception {
@@ -368,7 +380,22 @@ public class NSSecurityMechanismTest extends BaseJDBCTestCase
             }
         }
     }
-    
+
+    /**
+     * Test that securityMechanism=8 is ignored by the embedded driver
+     * (DERBY-3025).
+     */
+    public void testSecurityMechanismOnEmbedded() throws SQLException {
+        DataSource ds = JDBCDataSource.getDataSource();
+        JDBCDataSource.setBeanProperty(
+            ds, "connectionAttributes", "securityMechanism=8");
+
+        // DERBY-3025: NullPointerException or AssertFailure was thrown here
+        Connection c = ds.getConnection("calvin", "calvinpw");
+
+        c.close();
+    }
+
     // returns a boolean true if the security mechanism is not supported
     // so the loop in which this is called can be continued without
     // causing unnecessary/impossible tests to be run
