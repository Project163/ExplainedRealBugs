diff --git a/java/engine/org/apache/derby/impl/sql/compile/AlterTableNode.java b/java/engine/org/apache/derby/impl/sql/compile/AlterTableNode.java
index b8576805f..48f41c9b2 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/AlterTableNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/AlterTableNode.java
@@ -352,6 +352,12 @@ public String statementToString()
                         //
 
                         if ( cdn.hasGenerationClause() && ( cdn.getType() == null ) ) { continue; }
+
+                        if ( cdn.getType() == null )
+                        {
+                            throw StandardException.newException
+                                ( SQLState.LANG_NEEDS_DATATYPE, cdn.getColumnName() );
+                        }
                         
 						if (cdn.getType().getTypeId().isStringTypeId()) {
 							//we found what we are looking for. Set the 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/AlterTableTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/AlterTableTest.java
index 2f46156ed..200c763da 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/AlterTableTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/AlterTableTest.java
@@ -130,6 +130,10 @@ public final class AlterTableTest extends BaseJDBCTestCase {
         assertStatementError("X0Y32", st,
                 "alter table t0 add column c1 int");
 
+        // add a column without a datatype (DERBY-5160)
+        assertStatementError("42XA9", st,
+                "alter table t0 add column y");
+
         // alter a system table
         assertStatementError("42X62", st,
                 "alter table sys.systables add column c1 int");
