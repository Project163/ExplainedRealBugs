diff --git a/java/engine/org/apache/derby/impl/io/DirStorageFactory.java b/java/engine/org/apache/derby/impl/io/DirStorageFactory.java
index 4fa7c01f0..bc3162a8d 100644
--- a/java/engine/org/apache/derby/impl/io/DirStorageFactory.java
+++ b/java/engine/org/apache/derby/impl/io/DirStorageFactory.java
@@ -187,7 +187,11 @@ public class DirStorageFactory extends BaseStorageFactory
             else if( home != null && dataDirectory.startsWith( home))
                 databaseRoot = dataDirectoryFile;
             else
+            {
                 databaseRoot = new File( home, dataDirectory);
+                if (home != null)
+                    dataDirectory = home + getSeparator() +  dataDirectory;
+            }
             canonicalName = databaseRoot.getCanonicalPath();
             createTempDir();
             separatedDataDirectory = dataDirectory + getSeparator();
diff --git a/java/engine/org/apache/derby/impl/io/DirStorageFactory4.java b/java/engine/org/apache/derby/impl/io/DirStorageFactory4.java
index 2194adf79..552b437a3 100644
--- a/java/engine/org/apache/derby/impl/io/DirStorageFactory4.java
+++ b/java/engine/org/apache/derby/impl/io/DirStorageFactory4.java
@@ -53,14 +53,9 @@ public class DirStorageFactory4 extends DirStorageFactory
      */
     StorageFile newPersistentFile( String path)
     {
-        String dir = dataDirectory;
-        if (canonicalName != null && path != null && home != null && 
-                !path.startsWith(home)) {
-            dir = canonicalName;
-        }
         if( path == null)
-            return new DirFile4(dir, rwsOK);
-        return new DirFile4(dir, path, rwsOK);
+            return new DirFile4(dataDirectory, rwsOK);
+        return new DirFile4(dataDirectory, path, rwsOK);
     }
 
     /**
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/GetPropertyInfoTest.out b/java/testing/org/apache/derbyTesting/functionTests/master/GetPropertyInfoTest.out
index 6b5c86ceb..5cfcb7fd0 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/GetPropertyInfoTest.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/GetPropertyInfoTest.out
@@ -1,36 +1,36 @@
 Test GetPropertyInfoTest starting
-databaseName: EncryptedDB
-encryptionProvider: null
-encryptionAlgorithm: null
-encryptionKeyLength: null
-encryptionKey: null
-territory: null
-user: null
-logDevice: null
-rollForwardRecoveryFrom: null
-createFrom: null
-restoreFrom: null
-bootPassword: 
-password: 
-shutdown: false
-create: true
-dataEncryption: true
-upgrade: false
-databaseName: 
-encryptionProvider: null
-encryptionAlgorithm: null
-encryptionKeyLength: null
-encryptionKey: null
-territory: null
-user: null
-logDevice: null
-rollForwardRecoveryFrom: null
-createFrom: null
-restoreFrom: null
-bootPassword: ****
-password: 
-shutdown: false
-create: true
-dataEncryption: true
-upgrade: false
+databaseName - value: EncryptedDB - description: database identity - required false
+encryptionProvider - value: null - description: cryptographic service provider - required false - choices null 
+encryptionAlgorithm - value: null - description: cryptographic algorithm - required false - choices null 
+encryptionKeyLength - value: null - description: cryptographic key length - required false - choices null 
+encryptionKey - value: null - description: external cryptographic key - required false - choices null 
+territory - value: null - description: territory for the database - required false - choices null 
+user - value: null - description: user name - required false - choices null 
+logDevice - value: null - description: log directory path - required false - choices null 
+rollForwardRecoveryFrom - value: null - description: backup path for rollforward recovery - required false - choices null 
+createFrom - value: null - description: J029 :  - required false - choices null 
+restoreFrom - value: null - description: J030 :  - required false - choices null 
+bootPassword - value:  - description: secret cryptographic key - required false - choices null 
+password - value:  - description: user password - required false - choices null 
+shutdown - value: false - description: shut down Derby - required false     - choices [0] : false     - choices [1] : true
+create - value: true - description: create database - required false     - choices [0] : false     - choices [1] : true
+dataEncryption - value: true - description: encrypt database on disk - required false     - choices [0] : false     - choices [1] : true
+upgrade - value: false - description: upgrade database - required false     - choices [0] : false     - choices [1] : true
+databaseName - value:  - description: database identity - required false     - choices [0] : EncryptedDB
+encryptionProvider - value: null - description: cryptographic service provider - required false - choices null 
+encryptionAlgorithm - value: null - description: cryptographic algorithm - required false - choices null 
+encryptionKeyLength - value: null - description: cryptographic key length - required false - choices null 
+encryptionKey - value: null - description: external cryptographic key - required false - choices null 
+territory - value: null - description: territory for the database - required false - choices null 
+user - value: null - description: user name - required false - choices null 
+logDevice - value: null - description: log directory path - required false - choices null 
+rollForwardRecoveryFrom - value: null - description: backup path for rollforward recovery - required false - choices null 
+createFrom - value: null - description: J029 :  - required false - choices null 
+restoreFrom - value: null - description: J030 :  - required false - choices null 
+bootPassword - value: **** - description: secret cryptographic key - required false - choices null 
+password - value:  - description: user password - required false - choices null 
+shutdown - value: false - description: shut down Derby - required false     - choices [0] : false     - choices [1] : true
+create - value: true - description: create database - required false     - choices [0] : false     - choices [1] : true
+dataEncryption - value: true - description: encrypt database on disk - required false     - choices [0] : false     - choices [1] : true
+upgrade - value: false - description: upgrade database - required false     - choices [0] : false     - choices [1] : true
 Test GetPropertyInfoTest finished
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/GetPropertyInfoTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/GetPropertyInfoTest.java
index dce9ebe4c..8c70884fe 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/GetPropertyInfoTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/GetPropertyInfoTest.java
@@ -73,7 +73,22 @@ public class GetPropertyInfoTest
 
 				for (int j = 0; j < attributes.length; j++)
 				{
-					System.out.println(attributes[j].name + ": " + attributes[j].value);
+					System.out.print(attributes[j].name + " - value: " + attributes[j].value);
+					// Also check on the other PropertyInfo fields
+					String[] choices = attributes[j].choices;
+					System.out.print(" - description: " 
+						+ attributes[j].description +
+						" - required " + attributes[j].required);
+					if (choices != null)
+					{
+						for (int k = 0; k < choices.length; k++)
+						{
+							System.out.print("     - choices [" + k + "] : " + choices[k]);
+						}
+						System.out.print("\n");
+					}
+					else
+						System.out.print(" - choices null \n");
 				}
 
 				// Now set bootPassword and call getPropertyInfo again.  
@@ -121,8 +136,24 @@ public class GetPropertyInfoTest
 
 				for (int j = 0; j < attributes.length; j++)
 				{
-					System.out.println(attributes[j].name + ": " + attributes[j].value);
+					System.out.print(attributes[j].name + " - value: " + attributes[j].value);
+					// Also check on the other PropertyInfo fields
+					String[] choices = attributes[j].choices;
+					System.out.print(" - description: " 
+						+ attributes[j].description +
+						" - required " + attributes[j].required);
+					if (choices != null)
+					{
+						for (int k = 0; k < choices.length; k++)
+						{
+							System.out.print("     - choices [" + k + "] : " + choices[k]);
+						}
+						System.out.print("\n");
+					}
+					else
+						System.out.print(" - choices null \n");
 				}
+
 				// Now set database name and call getPropertyInfo again.  
 				// This time attribute length should be zero, sice we pass all
 				// minimum required properties. 
