diff --git a/java/client/org/apache/derby/client/am/ClientResultSet.java b/java/client/org/apache/derby/client/am/ClientResultSet.java
index b34591ff3..1fdbbad3e 100644
--- a/java/client/org/apache/derby/client/am/ClientResultSet.java
+++ b/java/client/org/apache/derby/client/am/ClientResultSet.java
@@ -139,6 +139,7 @@ public abstract class ClientResultSet implements ResultSet,
     // and getter methods cannot be called.
     // Also, if a cursor is exhausted (+100), the cursor position is invalid.
     private boolean isValidCursorPosition_ = false;
+    private boolean savedIsValidCursorPosition_ = false;
 
     public boolean cursorHold_;
 
@@ -378,7 +379,6 @@ public abstract class ClientResultSet implements ResultSet,
         // else
         //   fetch the next rowset from the server
         else {
-
             // These flags will only be used for dynamic cursors where we don't know the row count
             // and can't keep track of the absolute position of the cursor.
             isAfterLast_ = false;
@@ -3802,9 +3802,21 @@ public abstract class ClientResultSet implements ResultSet,
                 checkForUpdatableResultSet("moveToInsertRow");
 
                 resetUpdatedColumnsForInsert();
-
+                
+                // Note that even though we navigate "away" from the current row
+                // we do not clean up the current row (i.e. release locators), so
+                // locators will still be valid when returning to the current row.
+                // See DERBY-6228.
                 isOnInsertRow_ = true;
                 isOnCurrentRow_ = false;
+
+                // It is possible to navigate from a row for which 
+                // isValidCursorPosition_==false to the insert row. By
+                // saving the old value here we can restore it when leaving
+                // the insert row. This is important since attempting to 
+                // release locators for a non-valid cursor position will trigger 
+                // an error on the server. See DERBY-6228.
+                savedIsValidCursorPosition_ = isValidCursorPosition_;
                 isValidCursorPosition_ = true;
             }
         }
@@ -3847,7 +3859,8 @@ public abstract class ClientResultSet implements ResultSet,
             if (currentRowInRowset_ > 0) {
                 updateColumnInfoFromCache();
             }
-            isValidCursorPosition_ = true;
+            // Restore the old value when leaving the insert row. See DERBY-6228.
+            isValidCursorPosition_ = savedIsValidCursorPosition_;
         }
         if (isValidCursorPosition_) {
             // isOnInsertRow must be false here.
@@ -5450,7 +5463,6 @@ public abstract class ClientResultSet implements ResultSet,
     private final int checkRowsetSqlca(int row) throws SqlException {
         int sqlcode = 0;
         if (!isRowsetCursor_ || rowsetSqlca_ == null || rowsetSqlca_[row] == null) {
-            warnings_ = null;    // clear any previous warnings
             return sqlcode;
         }
 
diff --git a/java/client/org/apache/derby/client/am/LOBStateTracker.java b/java/client/org/apache/derby/client/am/LOBStateTracker.java
index 6625d8f9d..d8d773008 100644
--- a/java/client/org/apache/derby/client/am/LOBStateTracker.java
+++ b/java/client/org/apache/derby/client/am/LOBStateTracker.java
@@ -104,7 +104,9 @@ class LOBStateTracker {
      */
     void checkCurrentRow(Cursor cursor)
             throws SqlException {
-        if (this.doRelease) {
+        // If we are on a delete hole, there are no locators to release, and 
+        // trying to release them will cause an error. See DERBY-6228.
+        if (this.doRelease && !cursor.getIsUpdateDeleteHole()) {
             CallableLocatorProcedures procs = cursor.getLocatorProcedures();
             for (int i=0; i < this.columns.length; i++) {
                 // Note the conversion from 1-based to 0-based index when
diff --git a/java/client/org/apache/derby/client/am/Sqlca.java b/java/client/org/apache/derby/client/am/Sqlca.java
index 7d84093a1..60be24535 100644
--- a/java/client/org/apache/derby/client/am/Sqlca.java
+++ b/java/client/org/apache/derby/client/am/Sqlca.java
@@ -270,7 +270,10 @@ public abstract class Sqlca {
         synchronized (connection_) {
             try {
                 cs = connection_.prepareMessageProc("call SYSIBM.SQLCAMESSAGE(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");
-
+                // Cannot let this statement commit the transaction. Otherwise, 
+                // calling getWarnings while navigating a ResultSet will 
+                // release and invalidate locators used by the cursor.
+                cs.isAutoCommittableStatement_ = false;
                 String errmc = null;
                 String sqlState = null;
 
diff --git a/java/client/org/apache/derby/client/net/NetResultSetReply.java b/java/client/org/apache/derby/client/net/NetResultSetReply.java
index b55a742f3..410357bae 100644
--- a/java/client/org/apache/derby/client/net/NetResultSetReply.java
+++ b/java/client/org/apache/derby/client/net/NetResultSetReply.java
@@ -126,6 +126,10 @@ class NetResultSetReply extends NetStatementReply
                 }
 
                 peekCP = peekCodePoint();
+                if (peekCP == CodePoint.SQLCARD) {
+                    NetSqlca netSqlca = parseSQLCARD(((ClientResultSet) resultSetI).rowsetSqlca_);
+                    resultSetI.completeSqlca(netSqlca);
+                }
                 if (peekCP == CodePoint.RDBUPDRM) {
                     parseRDBUPDRM();
                     peekCP = peekCodePoint();
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/ConcurrencyTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/ConcurrencyTest.java
index e0bddc128..b30d90d39 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/ConcurrencyTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/ConcurrencyTest.java
@@ -421,11 +421,12 @@ public class ConcurrencyTest extends SURBaseTest {
             ps2.executeUpdate();
             con2.commit();
             
-            ps2 = con2.prepareStatement("insert into t1 values(?,?,?,?)");
+            ps2 = con2.prepareStatement("insert into t1 values(?,?,?,?,?)");
             ps2.setInt(1, firstKey);
             ps2.setInt(2, -1);
             ps2.setInt(3, -1);
             ps2.setString(4, "UPDATED TUPLE");
+            ps2.setString(5, "UPDATED CLOB");
             assertEquals("Expected one record to be inserted", 1, 
                          ps2.executeUpdate());
             println("T4: Inserted record (" + firstKey + ",-1,-1)" );
@@ -505,11 +506,12 @@ public class ConcurrencyTest extends SURBaseTest {
             con2.commit();
             println("T3: commit");
             
-            ps2 = con2.prepareStatement("insert into t1 values(?,?,?,?)");
+            ps2 = con2.prepareStatement("insert into t1 values(?,?,?,?,?)");
             ps2.setInt(1, firstKey);
             ps2.setInt(2, valA);
             ps2.setInt(3, valB);
             ps2.setString(4, "UPDATE TUPLE " + firstKey);
+            ps2.setString(5, "UPDATED CLOB " + firstKey);
             assertEquals("Expected one record to be inserted", 1, 
                          ps2.executeUpdate());
             println("T4: Inserted record (" + firstKey + "," + valA + "," + 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/HoldabilityTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/HoldabilityTest.java
index d90179a02..86f40af1a 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/HoldabilityTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/HoldabilityTest.java
@@ -473,7 +473,7 @@ public class HoldabilityTest extends SURBaseTest {
         
         // Now reinsert the tuples:
         PreparedStatement ps = 
-            prepareStatement("insert into t1 values (?,?,?,?)");
+            prepareStatement("insert into t1 values (?,?,?,?,?)");
         
         for (int i=0; i<recordCount*2; i++) {
             int recordId = i + recordCount + 1000;
@@ -481,6 +481,7 @@ public class HoldabilityTest extends SURBaseTest {
             ps.setInt(2, recordId);
             ps.setInt(3, recordId *2 + 17);
             ps.setString(4, "m" + recordId);
+            ps.setString(5, "c"+recordId);
             ps.addBatch();
         }
         ps.executeBatch();
@@ -544,7 +545,7 @@ public class HoldabilityTest extends SURBaseTest {
         
         // Now reinsert the tuples:
         PreparedStatement ps = 
-            prepareStatement("insert into t1 values (?,?,?,?)");
+            prepareStatement("insert into t1 values (?,?,?,?,?)");
         
         for (int i=0; i<recordCount*2; i++) {
             int recordId = i + recordCount + 1000;
@@ -552,6 +553,7 @@ public class HoldabilityTest extends SURBaseTest {
             ps.setInt(2, recordId);
             ps.setInt(3, recordId *2 + 17);
             ps.setString(4, "m" + recordId);
+            ps.setString(5, "c" + recordId);
             ps.addBatch();
         }
         ps.executeBatch();
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/SURBaseTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/SURBaseTest.java
index 3062f87f5..3b1068b7f 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/SURBaseTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/SURBaseTest.java
@@ -66,8 +66,8 @@ abstract public class SURBaseTest extends BaseJDBCTestCase {
         int b = rs.getInt(3);
         int sum = a + id + 17;
         println("Reading tuple:(" + id + "," + a  + "," + b + ",'" + 
-                rs.getString(4) + "')");
-        assertEquals("Expecting b==id+a+17", b, sum);
+                rs.getString(4) + "', '"+rs.getString(5)+"'");
+        assertEquals("Expecting b==id+a+17", sum, b);
     }
     
     /**
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/SURDataModelSetup.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/SURDataModelSetup.java
index 7fa40ab98..deff07af8 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/SURDataModelSetup.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/SURDataModelSetup.java
@@ -79,13 +79,14 @@ public class SURDataModelSetup extends BaseJDBCTestSetup
         
         /** Populate with data */
         PreparedStatement ps = con.
-            prepareStatement("insert into t1 values (?,?,?,?)");
+            prepareStatement("insert into t1 values (?,?,?,?,?)");
         
         for (int i=0; i<records; i++) {
             ps.setInt(1, i);
             ps.setInt(2, i);
             ps.setInt(3, i*2 + 17);
             ps.setString(4, "Tuple " +i);
+            ps.setString(5, "C-tuple "+i);
             ps.addBatch();
         }
         ps.executeBatch();
@@ -204,8 +205,8 @@ public class SURDataModelSetup extends BaseJDBCTestSetup
          */
         public String getCreateTableStatement() {
             return hasPrimaryKey() 
-                ? "create table t1 (id int primary key, a int, b int, c varchar(5000))"
-                : "create table t1 (id int, a int, b int, c varchar(5000))";
+                ? "create table t1 (id int primary key, a int, b int, c varchar(5000), d clob)"
+                : "create table t1 (id int, a int, b int, c varchar(5000), d clob)";
         }
 
         /**
