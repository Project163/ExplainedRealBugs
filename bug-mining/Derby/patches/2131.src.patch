diff --git a/java/client/org/apache/derby/client/am/ColumnMetaData.java b/java/client/org/apache/derby/client/am/ColumnMetaData.java
index 84b5261ef..5d28c3f61 100644
--- a/java/client/org/apache/derby/client/am/ColumnMetaData.java
+++ b/java/client/org/apache/derby/client/am/ColumnMetaData.java
@@ -318,7 +318,7 @@ public class ColumnMetaData implements java.sql.ResultSetMetaData {
             case Types.TIME:
                 return 8;
             case Types.TIMESTAMP:
-                return 26;
+                return 29;
             case Types.JAVA_OBJECT:
                 return JDBC30Translation.DEFAULT_COLUMN_DISPLAY_SIZE;
             case Types.BINARY:
@@ -452,7 +452,7 @@ public class ColumnMetaData implements java.sql.ResultSetMetaData {
             case Types.TIME:
                 return 8;
             case Types.TIMESTAMP:
-                return 26;
+                return 29;
             case Types.JAVA_OBJECT:
                 return JDBC30Translation.UNKNOWN_PRECISION;
             default:
@@ -472,15 +472,6 @@ public class ColumnMetaData implements java.sql.ResultSetMetaData {
             checkForClosedStatement();
             checkForValidColumnIndex(column);
 
-            // We get the scale from the SQLDA as returned by DERBY, but DERBY does not return the ANSI-defined
-            // value of scale 6 for TIMESTAMP.
-            //
-            //   The JDBC drivers should hardcode this info as a short/near term solution.
-            //
-            if (types_[column - 1] == Types.TIMESTAMP) {
-                return 6;
-            }
-
             return sqlScale_[column - 1];
         }
         catch ( SqlException e )
diff --git a/java/engine/org/apache/derby/iapi/reference/DRDAConstants.java b/java/engine/org/apache/derby/iapi/reference/DRDAConstants.java
index 589d9bf79..3a50cfac1 100644
--- a/java/engine/org/apache/derby/iapi/reference/DRDAConstants.java
+++ b/java/engine/org/apache/derby/iapi/reference/DRDAConstants.java
@@ -228,7 +228,7 @@ public	interface	DRDAConstants
     // nanoseconds precision: yyyy-mm-dd-hh.mm.ss.ffffff
     // In contrast, JDBC supports full nanoseconds precision: yyyy-mm-dd-hh.mm.ss.fffffffff
     //
-    public   static final int DRDA_TIMESTAMP_LENGTH = 26;
+    public   static final int DRDA_TIMESTAMP_LENGTH = 29;
     public   static final int JDBC_TIMESTAMP_LENGTH = 29;
 
     // Values for the EXTDTA stream status byte.
diff --git a/java/engine/org/apache/derby/iapi/types/DataTypeUtilities.java b/java/engine/org/apache/derby/iapi/types/DataTypeUtilities.java
index 616fb3565..e75234966 100644
--- a/java/engine/org/apache/derby/iapi/types/DataTypeUtilities.java
+++ b/java/engine/org/apache/derby/iapi/types/DataTypeUtilities.java
@@ -156,7 +156,7 @@ public abstract class DataTypeUtilities  {
 		switch (typeId)
 		{
 			case Types.TIMESTAMP:
-				size = 26;
+				size = 29;
 				break;
 			case Types.DATE:
 				size = 10;
diff --git a/java/engine/org/apache/derby/iapi/types/TypeId.java b/java/engine/org/apache/derby/iapi/types/TypeId.java
index ac58cae2d..7918197d3 100644
--- a/java/engine/org/apache/derby/iapi/types/TypeId.java
+++ b/java/engine/org/apache/derby/iapi/types/TypeId.java
@@ -119,16 +119,16 @@ public final class TypeId
         public static final int DATE_MAXWIDTH           = 10;	// yyyy-mm-dd
         public static final int TIME_MAXWIDTH           = 8;	// hh:mm:ss
 
-        // I believe that the following is wrong. The format of java.sql.Timestamp.toString()
+        // The format of java.sql.Timestamp.toString()
         // is yyyy-mm-dd hh:mm:ss.fffffffff
-        public static final int TIMESTAMP_MAXWIDTH      = DRDAConstants.DRDA_TIMESTAMP_LENGTH;	// yyyy-mm-dd hh:mm:ss.ffffff
+        public static final int TIMESTAMP_MAXWIDTH      = DRDAConstants.DRDA_TIMESTAMP_LENGTH;	// yyyy-mm-dd hh:mm:ss.fffffffff
 
         // Scale DOES exist for time values.  For a TIMESTAMP value,
-        // it's 6 ('ffffff'); for a TIME value, it's 0 (because there
+        // it's 9 ('fffffffff'); for a TIME value, it's 0 (because there
         // are no fractional seconds).  Note that date values do
         // not have a scale.
         public static final int TIME_SCALE           = 0;
-        public static final int TIMESTAMP_SCALE      = 6;
+        public static final int TIMESTAMP_SCALE      = 9;
 
         /* These define all the type names for SQL92 and JDBC 
          * NOTE: boolean is SQL3
diff --git a/java/engine/org/apache/derby/impl/jdbc/metadata.properties b/java/engine/org/apache/derby/impl/jdbc/metadata.properties
index 48dd665a9..da8471e51 100644
--- a/java/engine/org/apache/derby/impl/jdbc/metadata.properties
+++ b/java/engine/org/apache/derby/impl/jdbc/metadata.properties
@@ -800,8 +800,8 @@ getTypeInfo=\
 			1,FALSE,2,TRUE,FALSE,FALSE,0,0,10),\
 		('TIME',92,8,'TIME''','''',CAST (NULL AS CHAR), \
 			1,FALSE,2,TRUE,FALSE,FALSE,0,0,10),\
-		('TIMESTAMP',93,26,'TIMESTAMP''','''',CAST (NULL AS CHAR), \
-			1,FALSE,2,TRUE,FALSE,FALSE,0,6,10),\
+		('TIMESTAMP',93,29,'TIMESTAMP''','''',CAST (NULL AS CHAR), \
+			1,FALSE,2,TRUE,FALSE,FALSE,0,9,10),\
 		('OBJECT',2000,CAST (NULL AS INTEGER),CAST (NULL AS CHAR),CAST (NULL AS CHAR),CAST (NULL AS CHAR), \
 			1,FALSE,2,TRUE,FALSE,FALSE,CAST (NULL AS INTEGER),CAST (NULL AS INTEGER),CAST (NULL AS INTEGER)),\
 		('BLOB',2004,2147483647,CAST (NULL AS CHAR),CAST (NULL AS CHAR),'length', \
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/aggbuiltin.out b/java/testing/org/apache/derbyTesting/functionTests/master/aggbuiltin.out
index 590df9f4f..e8b78e2e0 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/aggbuiltin.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/aggbuiltin.out
@@ -1899,9 +1899,9 @@ ij> select max(t) from empty;
 --------
 NULL    
 ij> select max(ts) from empty;
-1                         
---------------------------
-NULL                      
+1                            
+-----------------------------
+NULL                         
 ij> select max(b) from empty;
 1   
 ----
@@ -1952,8 +1952,8 @@ ij> select max(t) from empty group by t;
 1       
 --------
 ij> select max(ts) from empty group by ts;
-1                         
---------------------------
+1                            
+-----------------------------
 ij> select max(b) from empty group by b;
 1   
 ----
@@ -2012,9 +2012,9 @@ ij> select max(t) from t;
 12:55:55
 WARNING 01003: Null values were eliminated from the argument of a column function.
 ij> select max(ts) from t;
-1                         
---------------------------
-1992-01-01 12:55:55.0     
+1                            
+-----------------------------
+1992-01-01 12:55:55.0        
 WARNING 01003: Null values were eliminated from the argument of a column function.
 ij> select max(b) from t;
 1   
@@ -2095,11 +2095,11 @@ ij> select max(t) from t group by t;
 NULL    
 WARNING 01003: Null values were eliminated from the argument of a column function.
 ij> select max(ts) from t group by ts;
-1                         
---------------------------
-1992-01-01 12:30:30.0     
-1992-01-01 12:55:55.0     
-NULL                      
+1                            
+-----------------------------
+1992-01-01 12:30:30.0        
+1992-01-01 12:55:55.0        
+NULL                         
 WARNING 01003: Null values were eliminated from the argument of a column function.
 ij> select max(b) from t group by b;
 1   
@@ -2152,9 +2152,9 @@ ij> select max(time('12:30:30')) from t;
 --------
 12:30:30
 ij> select max(timestamp('1999-06-06 12:30:30')) from t;
-1                         
---------------------------
-1999-06-06 12:30:30.0     
+1                            
+-----------------------------
+1999-06-06 12:30:30.0        
 ij> select max(1) from t group by i;
 1          
 -----------
@@ -2198,11 +2198,11 @@ ij> select max(time('12:30:30')) from t group by t;
 12:30:30
 12:30:30
 ij> select max(timestamp('1999-06-06 12:30:30')) from t group by ts;
-1                         
---------------------------
-1999-06-06 12:30:30.0     
-1999-06-06 12:30:30.0     
-1999-06-06 12:30:30.0     
+1                            
+-----------------------------
+1999-06-06 12:30:30.0        
+1999-06-06 12:30:30.0        
+1999-06-06 12:30:30.0        
 ij> -- multicolumn grouping
 select max(i), max(dt), max(b) from t group by i, dt, b;
 1          |2         |3   
@@ -2430,9 +2430,9 @@ ij> select min(t) from empty;
 --------
 NULL    
 ij> select min(ts) from empty;
-1                         
---------------------------
-NULL                      
+1                            
+-----------------------------
+NULL                         
 ij> select min(b) from empty;
 1   
 ----
@@ -2483,8 +2483,8 @@ ij> select min(t) from empty group by t;
 1       
 --------
 ij> select min(ts) from empty group by ts;
-1                         
---------------------------
+1                            
+-----------------------------
 ij> select min(b) from empty group by b;
 1   
 ----
@@ -2543,9 +2543,9 @@ ij> select min(t) from t;
 12:30:30
 WARNING 01003: Null values were eliminated from the argument of a column function.
 ij> select min(ts) from t;
-1                         
---------------------------
-1992-01-01 12:30:30.0     
+1                            
+-----------------------------
+1992-01-01 12:30:30.0        
 WARNING 01003: Null values were eliminated from the argument of a column function.
 ij> select min(b) from t;
 1   
@@ -2626,11 +2626,11 @@ ij> select min(t) from t group by t;
 NULL    
 WARNING 01003: Null values were eliminated from the argument of a column function.
 ij> select min(ts) from t group by ts;
-1                         
---------------------------
-1992-01-01 12:30:30.0     
-1992-01-01 12:55:55.0     
-NULL                      
+1                            
+-----------------------------
+1992-01-01 12:30:30.0        
+1992-01-01 12:55:55.0        
+NULL                         
 WARNING 01003: Null values were eliminated from the argument of a column function.
 ij> select min(b) from t group by b;
 1   
@@ -2683,9 +2683,9 @@ ij> select min(time('12:30:30')) from t;
 --------
 12:30:30
 ij> select min(timestamp('1999-06-06 12:30:30')) from t;
-1                         
---------------------------
-1999-06-06 12:30:30.0     
+1                            
+-----------------------------
+1999-06-06 12:30:30.0        
 ij> select min(1) from t group by i;
 1          
 -----------
@@ -2729,11 +2729,11 @@ ij> select min(time('12:30:30')) from t group by t;
 12:30:30
 12:30:30
 ij> select min(timestamp('1999-06-06 12:30:30')) from t group by ts;
-1                         
---------------------------
-1999-06-06 12:30:30.0     
-1999-06-06 12:30:30.0     
-1999-06-06 12:30:30.0     
+1                            
+-----------------------------
+1999-06-06 12:30:30.0        
+1999-06-06 12:30:30.0        
+1999-06-06 12:30:30.0        
 ij> -- multicolumn grouping
 select min(i), min(dt), min(b) from t group by i, dt, b;
 1          |2         |3   
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/cast.out b/java/testing/org/apache/derbyTesting/functionTests/master/cast.out
index 73282f706..850c4961c 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/cast.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/cast.out
@@ -636,9 +636,9 @@ ij> values (cast ('1999-09-09' as date));
 ij> values (cast ('TIMESTAMP''1999-09-09 11:11:11''' as timestamp));
 ERROR 22007: The syntax of the string representation of a datetime value is incorrect.
 ij> values (cast ('1999-09-09 11:11:11' as timestamp));
-1                         
---------------------------
-1999-09-09 11:11:11.0     
+1                            
+-----------------------------
+1999-09-09 11:11:11.0        
 ij> ------------------
 --date/time ->other
 ------------------
@@ -710,9 +710,9 @@ ij> values (cast (TIMESTAMP('1999-09-09 11:11:11' )as time));
 --------
 11:11:11
 ij> values (cast (TIMESTAMP('1999-09-09 11:11:11' )as timestamp));
-1                         
---------------------------
-1999-09-09 11:11:11.0     
+1                            
+-----------------------------
+1999-09-09 11:11:11.0        
 ij> --bad
 values (cast (TIMESTAMP('1999-09-09 11:11:11' )as int));
 ERROR 42846: Cannot convert types 'TIMESTAMP' to 'INTEGER'.
@@ -863,10 +863,10 @@ ij> select cast(t as time) from tab1;
 11:11:11
 NULL    
 ij> select cast(ts as timestamp) from tab1;
-1                         
---------------------------
-1990-11-11 11:11:11.0     
-NULL                      
+1                            
+-----------------------------
+1990-11-11 11:11:11.0        
+NULL                         
 ij> select cast(dc as dec) from tab1;
 1     
 ------
@@ -952,8 +952,8 @@ ij> select cast(c as time) from tab1;
 --------
 ERROR 22007: The syntax of the string representation of a datetime value is incorrect.
 ij> select cast(c as timestamp) from tab1;
-1                         
---------------------------
+1                            
+-----------------------------
 ERROR 22007: The syntax of the string representation of a datetime value is incorrect.
 ij> select cast(c as dec) from tab1;
 1     
@@ -1055,22 +1055,22 @@ ij> insert into t1 (lvc) values cast(null as long varchar);
 1 row inserted/updated/deleted
 ij> -- expect 10 rows of nulls
 select * from t1;
-BT  |BTV |C                             |D                     |I          |R            |S     |DC                 |NUM                |DT        |T       |TS                        |V                             |LVC                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
+BT  |BTV |C                             |D                     |I          |R            |S     |DC                 |NUM                |DT        |T       |TS                           |V                             |LVC                                                                                                                             
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
 ij> -- make sure casting works correctly on nulls
 select cast (bt as char(1) for bit data) from t1;
 1   
@@ -1243,22 +1243,22 @@ NULL
 NULL    
 NULL    
 ij> select cast (ts as timestamp) from t1;
-1                         
---------------------------
-NULL                      
-NULL                      
-NULL                      
-NULL                      
-NULL                      
-NULL                      
-NULL                      
-NULL                      
-NULL                      
-NULL                      
-NULL                      
-NULL                      
-NULL                      
-NULL                      
+1                            
+-----------------------------
+NULL                         
+NULL                         
+NULL                         
+NULL                         
+NULL                         
+NULL                         
+NULL                         
+NULL                         
+NULL                         
+NULL                         
+NULL                         
+NULL                         
+NULL                         
+NULL                         
 ij> select cast (v as varchar(30)) from t1;
 1                             
 ------------------------------
@@ -1341,21 +1341,21 @@ ij> execute q15 using 'values char(654321)';
 ij> execute q16 using 'values char(987654)';
 1 row inserted/updated/deleted
 ij> select * from t1;
-BT  |BTV |C                             |D                     |I          |R            |S     |DC                 |NUM                |DT        |T       |TS                        |V                             |LVC                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-aa  |NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|aa  |NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|123456                        |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |123456.78             |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |4321       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |12321 |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |123456             |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |123456             |NULL               |NULL      |NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |9876-05-04|NULL    |NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |01:02:34|NULL                      |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |9876-05-04 01:02:34.0     |NULL                          |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |654321                        |NULL                                                                                                                            
-NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                      |NULL                          |987654                                                                                                                          
+BT  |BTV |C                             |D                     |I          |R            |S     |DC                 |NUM                |DT        |T       |TS                           |V                             |LVC                                                                                                                             
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+aa  |NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|aa  |NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|123456                        |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |123456.78             |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |4321       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |12321 |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |123456             |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |123456             |NULL               |NULL      |NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |9876-05-04|NULL    |NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |01:02:34|NULL                         |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |9876-05-04 01:02:34.0        |NULL                          |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |654321                        |NULL                                                                                                                            
+NULL|NULL|NULL                          |NULL                  |NULL       |NULL         |NULL  |NULL               |NULL               |NULL      |NULL    |NULL                         |NULL                          |987654                                                                                                                          
 ij> -- clean up t1
 delete from t1;
 13 rows inserted/updated/deleted
@@ -1497,9 +1497,9 @@ values (cast ('08.08.08' as TIME));
 --------
 08:08:08
 ij> values (cast ('2001-01-01-08.08.08.123456' as TIMESTAMP));
-1                         
---------------------------
-2001-01-01 08:08:08.123456
+1                            
+-----------------------------
+2001-01-01 08:08:08.123456   
 ij> -- char, varchar
 values (char('abcde', 5));
 1    
@@ -1524,15 +1524,15 @@ ij> insert into t1 values ('2003-09-10', '16:44:02', '2003-09-08 12:20:30.123456
 ij> insert into t1 values ('2005-09-10', '18.44.02', '2004-09-08-12.20.30.123456', 'cba', 'c');
 1 row inserted/updated/deleted
 ij> select char(c5), char(c6), char(c7), char(c8), char(c9) from t1;
-1         |2       |3                         |4    |5    
-----------------------------------------------------------
-2003-09-10|16:44:02|2003-09-08 12:20:30.123456|abc  |abcde
-2005-09-10|18:44:02|2004-09-08 12:20:30.123456|cba  |c    
+1         |2       |3                            |4    |5    
+-------------------------------------------------------------
+2003-09-10|16:44:02|2003-09-08 12:20:30.123456   |abc  |abcde
+2005-09-10|18:44:02|2004-09-08 12:20:30.123456   |cba  |c    
 ij> select varchar(c5), varchar(c6), varchar(c7), varchar(c8), varchar(c9) from t1;
-1         |2       |3                         |4    |5    
-----------------------------------------------------------
-2003-09-10|16:44:02|2003-09-08 12:20:30.123456|abc  |abcde
-2005-09-10|18:44:02|2004-09-08 12:20:30.123456|cba  |c    
+1         |2       |3                            |4    |5    
+-------------------------------------------------------------
+2003-09-10|16:44:02|2003-09-08 12:20:30.123456   |abc  |abcde
+2005-09-10|18:44:02|2004-09-08 12:20:30.123456   |cba  |c    
 ij> select char(c8, 10), varchar(c9, 9) from t1;
 1         |2        
 --------------------
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/compressTable.out b/java/testing/org/apache/derbyTesting/functionTests/master/compressTable.out
index e939ebc13..29b80656e 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/compressTable.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/compressTable.out
@@ -1231,21 +1231,21 @@ ij> -- end derby-1854 test case.
 create table derby737table1 (c1 int, c2 int);
 0 rows inserted/updated/deleted
 ij> select * from sys.sysstatistics;
-STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP         |&|VALID|COLCOUNT   |STATISTICS     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP            |&|VALID|COLCOUNT   |STATISTICS     
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 ij> -- create index on the table when the table is empty. No statistics will be
 --  generated for that index
 create index t1i1 on derby737table1(c1);
 0 rows inserted/updated/deleted
 ij> select * from sys.sysstatistics;
-STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP         |&|VALID|COLCOUNT   |STATISTICS     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP            |&|VALID|COLCOUNT   |STATISTICS     
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 ij> -- the insert above will not add a row into sys.sysstatistics for index t1i1
 insert into derby737table1 values(1,1);
 1 row inserted/updated/deleted
 ij> select * from sys.sysstatistics;
-STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP         |&|VALID|COLCOUNT   |STATISTICS     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP            |&|VALID|COLCOUNT   |STATISTICS     
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 ij> -- now compress the table and as part of the compress, Derby should generate
 --  statistics for all the indexes provided the table is not empty
 call syscs_util.syscs_compress_table('APP','DERBY737TABLE1',1);
@@ -1253,8 +1253,8 @@ call syscs_util.syscs_compress_table('APP','DERBY737TABLE1',1);
 ij> -- Will find statistics for index t1i1 on derby737table1 because compress
 --  table created it.
 select * from sys.sysstatistics;
-STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP         |&|VALID|COLCOUNT   |STATISTICS     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP            |&|VALID|COLCOUNT   |STATISTICS     
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 xxxxFILTERED-UUIDxxxx|xxxxFILTERED-UUIDxxxx|xxxxFILTERED-UUIDxxxx|xxxxxxFILTERED-TIMESTAMPxxxxx|I|true |1          |numunique= 1 n&
 ij> drop table derby737table1;
 0 rows inserted/updated/deleted
@@ -1264,50 +1264,50 @@ create table derby737table2 (c1 int, c2 int);
 ij> insert into derby737table2 values(1,1),(2,2);
 2 rows inserted/updated/deleted
 ij> select * from sys.sysstatistics;
-STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP         |&|VALID|COLCOUNT   |STATISTICS     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP            |&|VALID|COLCOUNT   |STATISTICS     
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 ij> -- since there is data in derby737table2 when index is getting created, 
 --   statistics will be created for that index 
 create index t2i1 on derby737table2(c1);
 0 rows inserted/updated/deleted
 ij> select * from sys.sysstatistics;
-STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP         |&|VALID|COLCOUNT   |STATISTICS     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP            |&|VALID|COLCOUNT   |STATISTICS     
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 xxxxFILTERED-UUIDxxxx|xxxxFILTERED-UUIDxxxx|xxxxFILTERED-UUIDxxxx|xxxxxxFILTERED-TIMESTAMPxxxxx|I|true |1          |numunique= 2 n&
 ij> -- deleting all the rows in table will not drop the index statistics
 delete from derby737table2;
 2 rows inserted/updated/deleted
 ij> select * from sys.sysstatistics;
-STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP         |&|VALID|COLCOUNT   |STATISTICS     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP            |&|VALID|COLCOUNT   |STATISTICS     
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 xxxxFILTERED-UUIDxxxx|xxxxFILTERED-UUIDxxxx|xxxxFILTERED-UUIDxxxx|xxxxxxFILTERED-TIMESTAMPxxxxx|I|true |1          |numunique= 2 n&
 ij> -- dropping index will drop the index statistics, if they exist
 drop index t2i1;
 0 rows inserted/updated/deleted
 ij> select * from sys.sysstatistics;
-STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP         |&|VALID|COLCOUNT   |STATISTICS     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP            |&|VALID|COLCOUNT   |STATISTICS     
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 ij> -- Next Test : Male sure that compress table will drop the existing statistics
 --  and will not recreate them if the table is empty
 insert into derby737table2 values(1,1),(2,2);
 2 rows inserted/updated/deleted
 ij> select * from sys.sysstatistics;
-STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP         |&|VALID|COLCOUNT   |STATISTICS     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP            |&|VALID|COLCOUNT   |STATISTICS     
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 ij> -- since there is data in derby737table2 when index is getting created, 
 --   statistics will be created for that index 
 create index t2i1 on derby737table2(c1);
 0 rows inserted/updated/deleted
 ij> select * from sys.sysstatistics;
-STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP         |&|VALID|COLCOUNT   |STATISTICS     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP            |&|VALID|COLCOUNT   |STATISTICS     
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 xxxxFILTERED-UUIDxxxx|xxxxFILTERED-UUIDxxxx|xxxxFILTERED-UUIDxxxx|xxxxxxFILTERED-TIMESTAMPxxxxx|I|true |1          |numunique= 2 n&
 ij> -- deleting all the rows in table will not drop the index statistics
 delete from derby737table2;
 2 rows inserted/updated/deleted
 ij> select * from sys.sysstatistics;
-STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP         |&|VALID|COLCOUNT   |STATISTICS     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP            |&|VALID|COLCOUNT   |STATISTICS     
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 xxxxFILTERED-UUIDxxxx|xxxxFILTERED-UUIDxxxx|xxxxFILTERED-UUIDxxxx|xxxxxxFILTERED-TIMESTAMPxxxxx|I|true |1          |numunique= 2 n&
 ij> -- now compress the table and as part of the compress, Derby should drop
 --  statistics for all the indexes and should not recreate them if the
@@ -1315,8 +1315,8 @@ ij> -- now compress the table and as part of the compress, Derby should drop
 call syscs_util.syscs_compress_table('APP','DERBY737TABLE2',1);
 0 rows inserted/updated/deleted
 ij> select * from sys.sysstatistics;
-STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP         |&|VALID|COLCOUNT   |STATISTICS     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+STATID                              |REFERENCEID                         |TABLEID                             |CREATIONTIMESTAMP            |&|VALID|COLCOUNT   |STATISTICS     
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 ij> --end derby-737 related test cases.
 -- DERBY-2057
 -- Use non-zero args other than 1s.
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/implicitConversions.out b/java/testing/org/apache/derbyTesting/functionTests/master/implicitConversions.out
index 245f1ec14..e3d24e759 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/implicitConversions.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/implicitConversions.out
@@ -202,27 +202,27 @@ ij> values cast('11:11:11' as varchar(8)), time('12:12:12');
 ij> values cast('11:11:11' as long varchar), time('12:12:12');
 ERROR 42X61: Types 'LONG VARCHAR' and 'TIME' are not UNION compatible.
 ij> values timestamp('1996-09-09 12:12:12.5'), '1996-08-08 11:11:11.1';
-1                         
---------------------------
-1996-09-09 12:12:12.5     
-1996-08-08 11:11:11.1     
+1                            
+-----------------------------
+1996-09-09 12:12:12.5        
+1996-08-08 11:11:11.1        
 ij> values timestamp('1996-09-09 12:12:12.5'), cast('1996-08-08 11:11:11.1' as varchar(30));
-1                         
---------------------------
-1996-09-09 12:12:12.5     
-1996-08-08 11:11:11.1     
+1                            
+-----------------------------
+1996-09-09 12:12:12.5        
+1996-08-08 11:11:11.1        
 ij> values timestamp('1996-09-09 12:12:12.5'), cast('1996-08-08 11:11:11.1' as long varchar);
 ERROR 42X61: Types 'TIMESTAMP' and 'LONG VARCHAR' are not UNION compatible.
 ij> values '1996-08-08 11:11:11.1', timestamp('1996-09-09 12:12:12.5');
-1                         
---------------------------
-1996-08-08 11:11:11.1     
-1996-09-09 12:12:12.5     
+1                            
+-----------------------------
+1996-08-08 11:11:11.1        
+1996-09-09 12:12:12.5        
 ij> values cast('1996-08-08 11:11:11.1' as varchar(30)), timestamp('1996-09-09 12:12:12.5');
-1                         
---------------------------
-1996-08-08 11:11:11.1     
-1996-09-09 12:12:12.5     
+1                            
+-----------------------------
+1996-08-08 11:11:11.1        
+1996-09-09 12:12:12.5        
 ij> values cast('1996-08-08 11:11:11.1' as long varchar), timestamp('1996-09-09 12:12:12.5');
 ERROR 42X61: Types 'LONG VARCHAR' and 'TIMESTAMP' are not UNION compatible.
 ij> -- comparisons at the language level
@@ -2228,8 +2228,8 @@ ij> select b, c_b, bv, vc_bv, lbv, vc_lbv, dt, c_dt from all1, all_c1;
 B   |C_B     |BV  |VC_BV           |LBV                                                                                                                             |VC_LBV          |DT        |C_DT      
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 ij> select tm, c_tm, tms, c_tms, c, c_c from all1, all_c1;
-TM      |C_TM            |TMS                       |C_TMS                |C   |C_C                           
---------------------------------------------------------------------------------------------------------------
+TM      |C_TM            |TMS                          |C_TMS                |C   |C_C                           
+-----------------------------------------------------------------------------------------------------------------
 ij> select vc, vc_vc, lvc, c_lvc from all1, all_c1;
 VC  |VC_VC                         |LVC                                                                                                                             |C_LVC                         
 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
@@ -2251,8 +2251,8 @@ ij> select b, c_b, bv, vc_bv, lbv, vc_lbv, dt, c_dt from all1, all_c1;
 B   |C_B     |BV  |VC_BV           |LBV                                                                                                                             |VC_LBV          |DT        |C_DT      
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 ij> select tm, c_tm, tms, c_tms, c, c_c from all1, all_c1;
-TM      |C_TM            |TMS                       |C_TMS                |C   |C_C                           
---------------------------------------------------------------------------------------------------------------
+TM      |C_TM            |TMS                          |C_TMS                |C   |C_C                           
+-----------------------------------------------------------------------------------------------------------------
 ij> select vc, vc_vc, lvc, c_lvc from all1, all_c1;
 VC  |VC_VC                         |LVC                                                                                                                             |C_LVC                         
 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
@@ -2275,9 +2275,9 @@ ij> alter table all1 add column vc30 varchar(30) ;
 ij> alter table all1 add column lvc2 long varchar ;
 0 rows inserted/updated/deleted
 ij> select * from all1;
-SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                       |C   |VC  |LVC                                                                                                                             |C30                           |VC30                          |LVC2                                                                                                                            
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-2     |3          |4                   |5.5          |6.6                   |7.7    |8.8    |0020|0020|0020                                                                                                                            |1996-09-09|12:12:12|1996-09-09 12:12:12.5     |1   |2   |33333333                                                                                                                        |NULL                          |NULL                          |NULL                                                                                                                            
+SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                          |C   |VC  |LVC                                                                                                                             |C30                           |VC30                          |LVC2                                                                                                                            
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+2     |3          |4                   |5.5          |6.6                   |7.7    |8.8    |0020|0020|0020                                                                                                                            |1996-09-09|12:12:12|1996-09-09 12:12:12.5        |1   |2   |33333333                                                                                                                        |NULL                          |NULL                          |NULL                                                                                                                            
 ij> update all1 set si = '11';
 ERROR 42821: Columns of type 'SMALLINT' cannot hold values of type 'CHAR'. 
 ij> update all1 set i = '11';
@@ -2307,9 +2307,9 @@ ij> update all1 set tms = '1990-01-01 08:08:08.6';
 ij> update all1 set lvc = '44444444';
 1 row inserted/updated/deleted
 ij> select * from all1;
-SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                       |C   |VC  |LVC                                                                                                                             |C30                           |VC30                          |LVC2                                                                                                                            
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-2     |3          |4                   |5.5          |6.6                   |7.7    |8.8    |2120|21  |21                                                                                                                              |1900-01-01|08:08:08|1990-01-01 08:08:08.6     |1   |2   |44444444                                                                                                                        |NULL                          |NULL                          |NULL                                                                                                                            
+SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                          |C   |VC  |LVC                                                                                                                             |C30                           |VC30                          |LVC2                                                                                                                            
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+2     |3          |4                   |5.5          |6.6                   |7.7    |8.8    |2120|21  |21                                                                                                                              |1900-01-01|08:08:08|1990-01-01 08:08:08.6        |1   |2   |44444444                                                                                                                        |NULL                          |NULL                          |NULL                                                                                                                            
 ij> select c30, vc30, lvc2 from all1;
 C30                           |VC30                          |LVC2                                                                                                                            
 ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
@@ -2635,13 +2635,13 @@ ij> values 'a', time('11:11:11');
 --------
 ERROR 22007: The syntax of the string representation of a datetime value is incorrect.
 ij> values timestamp('1996-09-09 11:11:11.5'), 'a';
-1                         
---------------------------
-1996-09-09 11:11:11.5     
+1                            
+-----------------------------
+1996-09-09 11:11:11.5        
 ERROR 22007: The syntax of the string representation of a datetime value is incorrect.
 ij> values 'a', timestamp('1996-09-09 11:11:11.5');
-1                         
---------------------------
+1                            
+-----------------------------
 ERROR 22007: The syntax of the string representation of a datetime value is incorrect.
 ij> -- comparisons at the language level
 select si from all1 where cast(1 as smallint) = 'a';
@@ -3871,26 +3871,26 @@ where b.si = a.lvc;
 ERROR 42818: Comparisons between 'SMALLINT' and 'LONG VARCHAR (UCS_BASIC)' are not supported. Types must be comparable. String types must also have matching collation. If collation does not match, a possible solution is to cast operands to force them to the default collation (e.g. SELECT tablename FROM sys.systables WHERE CAST(tablename AS VARCHAR(128)) = 'T1')
 ij> select * from all1 a, all1 b 
 where a.dt = b.c;
-SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                       |C   |VC  |LVC                                                                                                                             |SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                       |C   |VC  |LVC                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                          |C   |VC  |LVC                                                                                                                             |SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                          |C   |VC  |LVC                                                                                                                             
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 ERROR 22007: The syntax of the string representation of a datetime value is incorrect.
 ij> select * from all1 a, all1 b 
 where a.dt = b.vc;
-SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                       |C   |VC  |LVC                                                                                                                             |SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                       |C   |VC  |LVC                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                          |C   |VC  |LVC                                                                                                                             |SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                          |C   |VC  |LVC                                                                                                                             
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 ERROR 22007: The syntax of the string representation of a datetime value is incorrect.
 ij> select * from all1 a, all1 b 
 where a.dt = b.lvc;
 ERROR 42818: Comparisons between 'DATE' and 'LONG VARCHAR (UCS_BASIC)' are not supported. Types must be comparable. String types must also have matching collation. If collation does not match, a possible solution is to cast operands to force them to the default collation (e.g. SELECT tablename FROM sys.systables WHERE CAST(tablename AS VARCHAR(128)) = 'T1')
 ij> select * from all1 a, all1 b 
 where b.dt = a.c;
-SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                       |C   |VC  |LVC                                                                                                                             |SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                       |C   |VC  |LVC                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                          |C   |VC  |LVC                                                                                                                             |SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                          |C   |VC  |LVC                                                                                                                             
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 ERROR 22007: The syntax of the string representation of a datetime value is incorrect.
 ij> select * from all1 a, all1 b 
 where b.dt = a.vc;
-SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                       |C   |VC  |LVC                                                                                                                             |SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                       |C   |VC  |LVC                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                          |C   |VC  |LVC                                                                                                                             |SI    |I          |LI                  |R            |DP                    |DC     |NUM    |B   |BV  |LBV                                                                                                                             |DT        |TM      |TMS                          |C   |VC  |LVC                                                                                                                             
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 ERROR 22007: The syntax of the string representation of a datetime value is incorrect.
 ij> select * from all1 a, all1 b 
 where b.dt = a.lvc;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/insert.out b/java/testing/org/apache/derbyTesting/functionTests/master/insert.out
index e757c7ad7..477c344e6 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/insert.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/insert.out
@@ -376,10 +376,10 @@ ij> insert into i3 values (null, null, null, null, null, null, null, null, null)
 ij> insert into i4 select * from i3;
 2 rows inserted/updated/deleted
 ij> select * from i4;
-B   |BV  |LBV                                                                                                                             |C         |CV        |LVC                                                                                                                             |DT        |T       |TS                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-11  |22  |25                                                                                                                              |3         |4         |5                                                                                                                               |1990-10-10|11:11:11|1990-11-11 11:11:11.0     
-NULL|NULL|NULL                                                                                                                            |NULL      |NULL      |NULL                                                                                                                            |NULL      |NULL    |NULL                      
+B   |BV  |LBV                                                                                                                             |C         |CV        |LVC                                                                                                                             |DT        |T       |TS                           
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+11  |22  |25                                                                                                                              |3         |4         |5                                                                                                                               |1990-10-10|11:11:11|1990-11-11 11:11:11.0        
+NULL|NULL|NULL                                                                                                                            |NULL      |NULL      |NULL                                                                                                                            |NULL      |NULL    |NULL                         
 ij> delete from i4;
 2 rows inserted/updated/deleted
 ij> create table tab2 (
@@ -398,10 +398,10 @@ ij> insert into tab2 values (null, null, null, null, null, null);
 ij> insert into i4 (c, cv, lvc, dt, t, ts) select c, cv, lvc, dt, t, ts from tab2;
 2 rows inserted/updated/deleted
 ij> select * from i4;
-B   |BV  |LBV                                                                                                                             |C         |CV        |LVC                                                                                                                             |DT        |T       |TS                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-NULL|NULL|NULL                                                                                                                            |3         |4         |5                                                                                                                               |1990-10-10|11:11:11|1990-11-11 11:11:11.0     
-NULL|NULL|NULL                                                                                                                            |NULL      |NULL      |NULL                                                                                                                            |NULL      |NULL    |NULL                      
+B   |BV  |LBV                                                                                                                             |C         |CV        |LVC                                                                                                                             |DT        |T       |TS                           
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+NULL|NULL|NULL                                                                                                                            |3         |4         |5                                                                                                                               |1990-10-10|11:11:11|1990-11-11 11:11:11.0        
+NULL|NULL|NULL                                                                                                                            |NULL      |NULL      |NULL                                                                                                                            |NULL      |NULL    |NULL                         
 ij> -- drop the tables
 drop table t1;
 0 rows inserted/updated/deleted
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/nonreserved.out b/java/testing/org/apache/derbyTesting/functionTests/master/nonreserved.out
index a28912561..fd752cda5 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/nonreserved.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/nonreserved.out
@@ -181,29 +181,29 @@ create table timestamp (timestamp timestamp);
 ij> insert into timestamp(timestamp) values (timestamp('2002-05-22 16:17:34.144'));
 1 row inserted/updated/deleted
 ij> select timestamp from timestamp;
-TIMESTAMP                 
---------------------------
-2002-05-22 16:17:34.144   
+TIMESTAMP                    
+-----------------------------
+2002-05-22 16:17:34.144      
 ij> select timestamp( '2003-05-22 16:17:34.144'), timestamp "2003-05-22 16:17:34.144" from timestamp;
-1                         |2003-05-22 16:17:34.144   
------------------------------------------------------
-2003-05-22 16:17:34.144   |2002-05-22 16:17:34.144   
+1                            |2003-05-22 16:17:34.144      
+-----------------------------------------------------------
+2003-05-22 16:17:34.144      |2002-05-22 16:17:34.144      
 ij> select timestamp timestamp from timestamp;
-TIMESTAMP                 
---------------------------
-2002-05-22 16:17:34.144   
+TIMESTAMP                    
+-----------------------------
+2002-05-22 16:17:34.144      
 ij> select timestamp as timestamp from timestamp;
-TIMESTAMP                 
---------------------------
-2002-05-22 16:17:34.144   
+TIMESTAMP                    
+-----------------------------
+2002-05-22 16:17:34.144      
 ij> select timestamp.timestamp as timestamp from timestamp timestamp;
-TIMESTAMP                 
---------------------------
-2002-05-22 16:17:34.144   
+TIMESTAMP                    
+-----------------------------
+2002-05-22 16:17:34.144      
 ij> select timestamp.timestamp as timestamp from timestamp as timestamp;
-TIMESTAMP                 
---------------------------
-2002-05-22 16:17:34.144   
+TIMESTAMP                    
+-----------------------------
+2002-05-22 16:17:34.144      
 ij> delete from timestamp where timestamp = timestamp('2002-05-22 16:17:34.144');
 1 row inserted/updated/deleted
 ij> create index timestamp on timestamp(timestamp);
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/orderby.out b/java/testing/org/apache/derbyTesting/functionTests/master/orderby.out
index 18619e3df..5dbef7f94 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/orderby.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/orderby.out
@@ -680,12 +680,12 @@ D         |C
 1992-01-01|theend    
 1992-01-01|NULL      
 ij> select ts,t from missed order by ts desc, t;
-TS                        |T       
------------------------------------
-1997-02-04 12:02:00.001   |20:01:01
-1997-02-04 12:02:00.001   |20:01:01
-1993-02-04 12:02:00.001   |23:01:01
-1993-02-04 12:02:00.001   |23:01:01
+TS                           |T       
+--------------------------------------
+1997-02-04 12:02:00.001      |20:01:01
+1997-02-04 12:02:00.001      |20:01:01
+1993-02-04 12:02:00.001      |23:01:01
+1993-02-04 12:02:00.001      |23:01:01
 ij> select l from missed order by l;
 L                   
 --------------------
@@ -792,10 +792,10 @@ ij> insert into tab1 values (1, cast(1 as int), cast(1 as smallint), cast(1 as b
 ij> insert into tab1 values (2, cast(2 as int), cast(2 as smallint), cast(2 as bigint), '2', '2', '2', cast(2.2 as double precision), cast(2.2 as real), '1995-02-02', '12:12:12', '1996-02-02 12:10:10.1', cast(2.2 as decimal(2,1)));
 1 row inserted/updated/deleted
 ij> select * from tab1 order by 1;
-I          |TN         |S          |L          |C         |V         |LVC       |D                     |R            |DT        |T       |TS                        |DC  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-1          |1          |1          |1          |1         |1         |1         |1.1                   |1.1          |1996-01-01|11:11:11|1996-01-01 11:10:10.1     |1.1 
-2          |2          |2          |2          |2         |2         |2         |2.2                   |2.2          |1995-02-02|12:12:12|1996-02-02 12:10:10.1     |2.2 
+I          |TN         |S          |L          |C         |V         |LVC       |D                     |R            |DT        |T       |TS                           |DC  
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+1          |1          |1          |1          |1         |1         |1         |1.1                   |1.1          |1996-01-01|11:11:11|1996-01-01 11:10:10.1        |1.1 
+2          |2          |2          |2          |2         |2         |2         |2.2                   |2.2          |1995-02-02|12:12:12|1996-02-02 12:10:10.1        |2.2 
 ij> rollback;
 ij> -- bug 2769 (correlation columns, group by and order by)
 create table bug2769(c1 int, c2 int);
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/specjPlans.out b/java/testing/org/apache/derbyTesting/functionTests/master/specjPlans.out
index bae0cc4d8..4d9f239f7 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/specjPlans.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/specjPlans.out
@@ -655,8 +655,8 @@ call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1);
 ij> maximumdisplaywidth 3500;
 ij> SELECT T1.O_STATUS, T1.O_SHIP_DATE, T1.O_ENTRY_DATE, T1.O_TOTAL, T1.O_DISCOUNT, T1.O_OL_CNT, T1.O_C_ID, T1.O_ID 
  FROM O_ORDERS  T1 WHERE o_c_id = 0 FOR UPDATE ;
-O_STATUS   |O_SHIP_DA&|O_ENTRY_DATE              |O_TOTAL    |O_DIS&|O_OL_CNT   |O_C_ID     |O_ID       
---------------------------------------------------------------------------------------------------------
+O_STATUS   |O_SHIP_DA&|O_ENTRY_DATE                 |O_TOTAL    |O_DIS&|O_OL_CNT   |O_C_ID     |O_ID       
+-----------------------------------------------------------------------------------------------------------
 ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
 ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
@@ -815,8 +815,8 @@ Source result set:
 					Negate comparison result: false
 ij> SELECT T1.WO_NUMBER, T1.WO_O_ID, T1.WO_OL_ID, T1.WO_STATUS, T1.WO_ORIG_QTY, T1.WO_COMP_QTY, T1.WO_ASSEMBLY_ID, 
  T1.WO_DUE_DATE, T1.WO_START_DATE FROM M_WORKORDER  T1 WHERE T1.WO_NUMBER = 1 FOR UPDATE;
-WO_NUMBER  |WO_O_ID    |WO_OL_ID   |WO_STATUS  |WO_ORIG_QTY|WO_COMP_QTY|WO_ASSEMBLY_ID |WO_DUE_DA&|WO_START_DATE             
------------------------------------------------------------------------------------------------------------------------------
+WO_NUMBER  |WO_O_ID    |WO_OL_ID   |WO_STATUS  |WO_ORIG_QTY|WO_COMP_QTY|WO_ASSEMBLY_ID |WO_DUE_DA&|WO_START_DATE                
+--------------------------------------------------------------------------------------------------------------------------------
 ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
 ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
@@ -1871,8 +1871,8 @@ Columns accessed from heap = {2, 3, 4, 5}
 		qualifiers:
 			None
 ij> SELECT T1.O_STATUS, T1.O_SHIP_DATE, T1.O_ENTRY_DATE, T1.O_TOTAL, T1.O_DISCOUNT, T1.O_OL_CNT, T1.O_C_ID, T1.O_ID FROM O_ORDERS  T1 WHERE T1.O_ID = 1 FOR UPDATE;
-O_STATUS   |O_SHIP_DA&|O_ENTRY_DATE              |O_TOTAL    |O_DIS&|O_OL_CNT   |O_C_ID     |O_ID       
---------------------------------------------------------------------------------------------------------
+O_STATUS   |O_SHIP_DA&|O_ENTRY_DATE                 |O_TOTAL    |O_DIS&|O_OL_CNT   |O_C_ID     |O_ID       
+-----------------------------------------------------------------------------------------------------------
 ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
 ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/triggerRefClause.out b/java/testing/org/apache/derbyTesting/functionTests/master/triggerRefClause.out
index 723c571d4..ad5615b2c 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/triggerRefClause.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/triggerRefClause.out
@@ -140,12 +140,12 @@ ij> insert into allTypes1 values (0, 10, 100, 1000000,
 					  X'12af', X'0F0F', X'1234', 111.11, 222.2);
 1 row inserted/updated/deleted
 ij> select * from allTypes1;
-I          |TN    |S     |L                   |C         |V                                                 |LVC                                                                                                                             |D                     |R            |F                     |DT        |T       |TS                        |B   |BV  |LBV                                                                                                                             |DC     |N         
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+I          |TN    |S     |L                   |C         |V                                                 |LVC                                                                                                                             |D                     |R            |F                     |DT        |T       |TS                           |B   |BV  |LBV                                                                                                                             |DC     |N         
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 0          |10    |100   |1000000             |duplicate |this is duplicated                                |also duplicated                                                                                                                 |200.0                 |200.0        |200.0                 |1992-01-01|12:30:30|xxxxxxFILTERED-TIMESTAMPxxxxx|12af|0f0f|1234                                                                                                                            |111.11 |222.2000  
 ij> select * from allTypes2;
-I          |TN    |S     |L                   |C         |V                                                 |LVC                                                                                                                             |D                     |R            |F                     |DT        |T       |TS                        |B   |BV  |LBV                                                                                                                             |DC     |N         
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+I          |TN    |S     |L                   |C         |V                                                 |LVC                                                                                                                             |D                     |R            |F                     |DT        |T       |TS                           |B   |BV  |LBV                                                                                                                             |DC     |N         
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 0          |10    |100   |1000000             |duplicate |this is duplicated                                |also duplicated                                                                                                                 |200.0                 |200.0        |200.0                 |1992-01-01|12:30:30|xxxxxxFILTERED-TIMESTAMPxxxxx|12af|0f0f|1234                                                                                                                            |111.11 |222.2000  
 ij> commit;
 ij> drop trigger t1;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/DatabaseMetaDataTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/DatabaseMetaDataTest.java
index c65a7b290..349b20a0b 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/DatabaseMetaDataTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/DatabaseMetaDataTest.java
@@ -21,6 +21,7 @@
  */
 package org.apache.derbyTesting.functionTests.tests.jdbcapi;
 
+import java.lang.reflect.Method;
 import java.io.IOException;
 import java.math.BigDecimal;
 //import java.lang.reflect.Constructor;
@@ -2185,7 +2186,7 @@ public class DatabaseMetaDataTest extends BaseJDBCTestCase {
                 precision = 8;
                 break;
             case Types.TIMESTAMP:
-                precision = 26;
+                precision = 29;
                 break;
                                 
             case Types.DECIMAL:
@@ -2363,7 +2364,7 @@ public class DatabaseMetaDataTest extends BaseJDBCTestCase {
             maxScale = 31; // Max Scale for Decimal & Numeric is 31: Derby-2262
             break;
             case Types.TIMESTAMP:
-                maxScale = 6;
+                maxScale = 9;
                 break;
             case Types.SMALLINT:
             case Types.INTEGER:
@@ -4524,7 +4525,7 @@ public class DatabaseMetaDataTest extends BaseJDBCTestCase {
                 {null,"APP","GETPCTEST1","I","1","8","DOUBLE","52","8",null,"2","1",null,null,"8",null,null,"9","YES","genid","12","8"},                
                 {null,"APP","GETPCTEST1","K","1","91","DATE","10","6","0","10","1",null,null,"9","1",null,"10","YES","genid","12","9"},                
                 {null,"APP","GETPCTEST1","L","1","92","TIME","8","6","0","10","1",null,null,"9","2",null,"11","YES","genid","12","10"},                
-                {null,"APP","GETPCTEST1","T","1","93","TIMESTAMP","26","16","6","10","1",null,null,"9","3",null,"12","YES","genid","12","11"},                
+                {null,"APP","GETPCTEST1","T","1","93","TIMESTAMP","29","16","9","10","1",null,null,"9","3",null,"12","YES","genid","12","11"},                
                 {null,"APP","GETPCTEST2","PA","1","4","INTEGER","10","4","0","10","1",null,null,"4",null,null,"1","YES","genid","2","0"},
                 {null,"APP","GETPCTEST2","PB","1","-5","BIGINT","19","40","0","10","1",null,null,"-5",null,null,"2","YES","genid","2","1"},
                 {null,"APP","GETPCTEST3A","STRING1","1","12","VARCHAR","5","10",null,null,"1",null,null,"12",null,"10","1","YES","genid","2","0"}, 
@@ -4776,6 +4777,85 @@ public class DatabaseMetaDataTest extends BaseJDBCTestCase {
         return rss;        
     }
 
+    /**
+     * Test DatabaseMetaData.getFunctionColumns()
+     */
+    public void testGetFunctionColumns() throws Exception
+    {
+        // this method is supported in database meta data only from 10.2 onward
+
+        boolean supportsBoolean = true;
+        Version dataVersion = getDataVersion( getConnection() );
+        if ( dataVersion.compareTo( new Version( 10, 7, 0, 0 ) ) < 0 ) { supportsBoolean = false; }
+        
+        if ( dataVersion.compareTo( new Version( 10, 2, 0, 0 ) ) < 0 ) { return; }
+
+        DatabaseMetaData dmd = getDMD();
+        Statement s = createStatement();
+        getConnection().setAutoCommit(false);
+        
+        s.execute("create function f_gfc_1 (" +
+                "a VARCHAR(3), b NUMERIC, c SMALLINT, " +
+                "e CHAR(3), f INTEGER, g BIGINT, h FLOAT, i DOUBLE PRECISION, " +
+                "k DATE, l TIME, T TIMESTAMP ) returns int "+
+                "language java external name " +
+                "'org.apache.derbyTesting.BlahBlah.blah'" +
+        " parameter style java"); 
+
+        if ( supportsBoolean )
+        {
+            s.execute("create function f_gfc_2 ( a boolean) returns boolean "+
+                      "language java external name " +
+                      "'org.apache.derbyTesting.functionTests.BlahBlah.blah'" +
+                      " parameter style java");
+        }
+
+        // We have to use reflection to get the getFunctionColumns() method.
+        // That is because we compile this test to run on old versions of the
+        // vm whose DatabaseMetaData doesn't include this method, even though
+        // our actual drivers do.
+        Method gfcMethod = dmd.getClass().getMethod
+            ( "getFunctionColumns", new Class[] { String.class, String.class, String.class, String.class, } );
+        
+        ResultSet rs = (ResultSet) gfcMethod.invoke( dmd, new String[] { null, "%", "F_GFC_%", "%" } );
+
+        String[][] expRS = new String[][]
+            {
+                {null,"APP","F_GFC_1","","4","4","INTEGER","10","4","0","10","1",null,null,"0","YES","genid","11","-1"},                
+                {null,"APP","F_GFC_1","A","1","12","VARCHAR","3","6",null,null,"1",null,"6","1","YES","genid","11","0"},
+                {null,"APP","F_GFC_1","B","1","2","NUMERIC","5","14","0","10","1",null,null,"2","YES","genid","11","1"},
+                {null,"APP","F_GFC_1","C","1","5","SMALLINT","5","2","0","10","1",null,null,"3","YES","genid","11","2"},
+                {null,"APP","F_GFC_1","E","1","1","CHAR","3","6",null,null,"1",null,"6","4","YES","genid","11","3"},
+                {null,"APP","F_GFC_1","F","1","4","INTEGER","10","4","0","10","1",null,null,"5","YES","genid","11","4"},                
+                {null,"APP","F_GFC_1","G","1","-5","BIGINT","19","40","0","10","1",null,null,"6","YES","genid","11","5"},                
+                {null,"APP","F_GFC_1","H","1","8","DOUBLE","52","8",null,"2","1",null,null,"7","YES","genid","11","6"},                
+                {null,"APP","F_GFC_1","I","1","8","DOUBLE","52","8",null,"2","1",null,null,"8","YES","genid","11","7"},                
+                {null,"APP","F_GFC_1","K","1","91","DATE","10","6","0","10","1",null,null,"9","YES","genid","11","8"},                
+                {null,"APP","F_GFC_1","L","1","92","TIME","8","6","0","10","1",null,null,"10","YES","genid","11","9"},                
+                {null,"APP","F_GFC_1","T","1","93","TIMESTAMP","29","16","9","10","1",null,null,"11","YES","genid","11","10"},                
+            };
+        if ( supportsBoolean )
+        {
+            expRS = appendArray
+                (
+                 expRS,
+                 new String[][]
+                 {
+                     {null,"APP","F_GFC_2","","4","16","BOOLEAN","1","1",null,null,"1",null,null,"0","YES","genid","1","-1"},
+                     {null,"APP","F_GFC_2","A","1","16","BOOLEAN","1","1",null,null,"1",null,null,"1","YES","genid","1","0"},
+                 }
+                 );
+        }
+
+        int rowcount = 0;
+
+        assertResults( rs, expRS, true );
+        
+        if ( supportsBoolean ) { s.execute("drop function f_gfc_2"); }
+        s.execute("drop function f_gfc_1");
+        commit();
+    }
+
     public void testBugFixes() throws SQLException {
         
         Statement s = createStatement();
@@ -4918,4 +4998,42 @@ public class DatabaseMetaDataTest extends BaseJDBCTestCase {
         }
     }
 
+    /**
+     * Assert that the ResultSet returns the desired rows.
+     */
+    private void assertResults( ResultSet rs, String[][] rows, boolean trimResults )
+        throws Exception
+    {
+        int     actualColumnCount = rs.getMetaData().getColumnCount();
+        int     rowCount = rows.length;
+
+        for ( int i = 0; i < rowCount; i++ )
+        {
+            String[]    row = rows[ i ];
+            int             columnCount = row.length;
+
+            assertTrue( rs.next() );
+            assertEquals( columnCount, actualColumnCount );
+
+            for ( int j = 0; j < columnCount; j++ )
+            {
+                String  expectedValue =  row[ j ];
+                //println( "XXX (row, column ) ( " + i + ", " +  j + " ) should be " + expectedValue );
+                String  actualValue = null;
+                int         column = j+1;
+
+                actualValue = rs.getString( column );
+                if ( rs.wasNull() ) { actualValue = null; }
+
+                if ( (actualValue != null) && trimResults ) { actualValue = actualValue.trim(); }
+                
+                assertEquals( (expectedValue == null), rs.wasNull() );
+                
+                if ( expectedValue == null )    { assertNull( actualValue ); }
+                else if ( "genid".equals( expectedValue ) ) { assertTrue( actualValue.startsWith( "SQL" ) ); }
+                else { assertEquals(expectedValue, actualValue); }
+            }
+        }
+    }
+
 }
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/ParameterMetaDataJdbc30Test.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/ParameterMetaDataJdbc30Test.java
index d467bbfe1..65e5432c4 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/ParameterMetaDataJdbc30Test.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/ParameterMetaDataJdbc30Test.java
@@ -31,6 +31,7 @@ import java.sql.PreparedStatement;
 import java.sql.ResultSet;
 import java.sql.Statement;
 import java.sql.SQLException;
+import java.sql.Timestamp;
 import java.sql.Types;
 import java.math.BigDecimal;
 
@@ -645,6 +646,43 @@ public class ParameterMetaDataJdbc30Test extends BaseJDBCTestCase {
        		stmt.execute("DROP PROCEDURE PMDC");
             stmt.close();
 	}
+
+	/**
+         * test ParameterMetaData for Java procedures with TIMESTAMP parameters
+	 *
+	 * @exception SQLException if error occurs
+         */
+    public void testParameterMetadataWithTimestampParameters () throws SQLException
+    {
+        Statement stmt = createStatement();
+        stmt.execute("CREATE PROCEDURE PMDT(IN pmdI_1 TIMESTAMP, INOUT pmdI_2 TIMESTAMP, OUT pmdI_3 TIMESTAMP) language java parameter style java external name 'org.apache.derbyTesting.functionTests.tests.jdbcapi.ParameterMetaDataJdbc30Test.dummyString'");
+        CallableStatement cs = prepareCall("CALL PMDT(?, ?, ?)");
+        // parameter 1 is input only	
+        cs.setTimestamp(1, new Timestamp( 0L ) );
+        // parameter 2 is input and output
+        Object x = new Timestamp( 2L );
+        cs.setObject(2,x, Types.CHAR);
+        cs.registerOutParameter(2,Types.TIMESTAMP);
+        //parameter 3 is output only
+        cs.registerOutParameter(3,Types.TIMESTAMP);
+        //verify the meta data for the parameters
+        ParameterMetaData paramMetaData = cs.getParameterMetaData();
+        assertEquals("Unexpected parameter count", 3, paramMetaData.getParameterCount());
+        
+        //expected values to be stored in a 2dim. array
+        String parameterMetaDataArray0 [][] = {
+            //isNullable, isSigned, getPrecision, getScale, getParameterType, getParameterTypeName, getParameterClassName, getParameterMode
+            {"PARAMETER_NULLABLE", "false", "29", "9", "93", "TIMESTAMP", "java.sql.Timestamp", "PARAMETER_MODE_IN"},
+            {"PARAMETER_NULLABLE", "false", "29", "9", "93", "TIMESTAMP", "java.sql.Timestamp", "PARAMETER_MODE_IN_OUT"},
+            {"PARAMETER_NULLABLE", "false", "29", "9", "93", "TIMESTAMP", "java.sql.Timestamp", "PARAMETER_MODE_OUT"}};
+        
+        testParameterMetaData(cs.getParameterMetaData(), parameterMetaDataArray0);
+        
+        cs.close();
+        stmt.execute("DROP PROCEDURE PMDT");
+        stmt.close();
+    }
+    
 	/**
          *  test ParameterMetaData for Java procedures with DECIMAL parameters
 	 *
@@ -914,6 +952,13 @@ public class ParameterMetaDataJdbc30Test extends BaseJDBCTestCase {
         public static void dummyString (String in_param, String in_param2, String[] in_param3, String[] in_param4) {
         }
 	
+	/**
+     * Java method for procedure PMDT which tests ParameterMetaData for Java procedures 
+     * with TIMESTAMP parameters.  
+     */
+    public static void dummyString (Timestamp in_param1, Timestamp[] inout_param2, Timestamp[] out_param3) {}
+
+	
 	/**
          * Java method for procedure PMDD which tests ParameterMetaData for Java procedures
 	 * with DECIMAL parameters. 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/PrepStmtMetaDataTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/PrepStmtMetaDataTest.java
index d77ab9610..fb2de3315 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/PrepStmtMetaDataTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/PrepStmtMetaDataTest.java
@@ -329,12 +329,12 @@ public class PrepStmtMetaDataTest extends BaseJDBCTestCase {
         
         // COLUMN 16 TIMESTAMP
         assertEquals("java.sql.Timestamp", rsmd.getColumnClassName(16));
-        assertEquals(26, rsmd.getColumnDisplaySize(16));
+        assertEquals(29, rsmd.getColumnDisplaySize(16));
         assertEquals("TIMESTAMPCOL", rsmd.getColumnLabel(16));
         assertEquals(java.sql.Types.TIMESTAMP,rsmd.getColumnType(16));
         assertEquals("TIMESTAMP", rsmd.getColumnTypeName(16));
-        assertEquals(26,rsmd.getPrecision(16));
-        assertEquals(6, rsmd.getScale(16));
+        assertEquals(29,rsmd.getPrecision(16));
+        assertEquals(9, rsmd.getScale(16));
 
         // COLUMN 17 BLOB
         assertEquals("java.sql.Blob", rsmd.getColumnClassName(17));
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/ResultSetMiscTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/ResultSetMiscTest.java
index a4e60fcfc..98b189f85 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/ResultSetMiscTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/ResultSetMiscTest.java
@@ -200,7 +200,7 @@ public class ResultSetMiscTest extends BaseJDBCTestCase {
         assertFalse(met.isCurrency(7));
         assertEquals(ResultSetMetaData.columnNullable, met.isNullable(7));
         assertFalse(met.isSigned(7));
-        assertEquals(26, met.getColumnDisplaySize(7));
+        assertEquals(29, met.getColumnDisplaySize(7));
         assertEquals("TS", met.getColumnLabel(7));
         assertEquals("TS", met.getColumnName(7));
         // beetle 5323
@@ -208,8 +208,8 @@ public class ResultSetMiscTest extends BaseJDBCTestCase {
         assertEquals("APP", met.getSchemaName(7));
         assertEquals("", met.getCatalogName(7));
         assertEquals(java.sql.Types.TIMESTAMP, met.getColumnType(7));
-        assertEquals(26, met.getPrecision(7));
-        assertEquals(6, met.getScale(7));
+        assertEquals(29, met.getPrecision(7));
+        assertEquals(9, met.getScale(7));
         assertEquals("TIMESTAMP", met.getColumnTypeName(7));
         // DERBY-142 client incorrectly returns true. Enable on client
         // once DERBY-142 is fixed
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/CoalesceTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/CoalesceTest.java
index 624e74869..bb9a7db6c 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/CoalesceTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/CoalesceTest.java
@@ -339,7 +339,7 @@ public class CoalesceTest extends BaseJDBCTestCase
                 "COL1(datatype : TIME, precision : 8, scale : 0) null 15:30:20 15:30:20 null ",
                 "COL1(datatype : TIME, precision : 8, scale : 0) null 15:30:20 15:30:20 15:30:20 ",
                 "COL1(datatype : TIME, precision : 8, scale : 0) null 15:30:20 15:30:20 15:30:20 ",
-                "COL1(datatype : TIMESTAMP, precision : 26, scale : 6) null 2000-01-01 15:30:20.0 2000-01-01 15:30:20.0 null ",
+                "COL1(datatype : TIMESTAMP, precision : 29, scale : 9) null 2000-01-01 15:30:20.0 2000-01-01 15:30:20.0 null ",
                 "", "",
                 "COL1(datatype : BLOB, precision : 1024, scale : 0) null null null null "
         };
@@ -525,11 +525,11 @@ public class CoalesceTest extends BaseJDBCTestCase
                 "COL1(datatype : TIME, precision : 8, scale : 0) null 15:30:20 15:30:20 null ",
                 "COL1(datatype : TIME, precision : 8, scale : 0) null 15:30:20 15:30:20 null ",
                 "","","","","","","","","","","","","","","","",
-                "COL1(datatype : TIMESTAMP, precision : 26, scale : 6) null 2000-01-01 15:30:20.0 2000-01-01 15:30:20.0 null ",
-                "COL1(datatype : TIMESTAMP, precision : 26, scale : 6) null 2000-01-01 15:30:20.0 2000-01-01 15:30:20.0 null ",
+                "COL1(datatype : TIMESTAMP, precision : 29, scale : 9) null 2000-01-01 15:30:20.0 2000-01-01 15:30:20.0 null ",
+                "COL1(datatype : TIMESTAMP, precision : 29, scale : 9) null 2000-01-01 15:30:20.0 2000-01-01 15:30:20.0 null ",
                 "","","","","","","","","","","","","","","","",
-                "COL1(datatype : TIMESTAMP, precision : 26, scale : 6) null 2000-01-01 15:30:20.0 2000-01-01 15:30:20.0 null ",
-                "COL1(datatype : TIMESTAMP, precision : 26, scale : 6) null 2000-01-01 15:30:20.0 2000-01-01 15:30:20.0 null ",
+                "COL1(datatype : TIMESTAMP, precision : 29, scale : 9) null 2000-01-01 15:30:20.0 2000-01-01 15:30:20.0 null ",
+                "COL1(datatype : TIMESTAMP, precision : 29, scale : 9) null 2000-01-01 15:30:20.0 2000-01-01 15:30:20.0 null ",
                 "","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",
                 "COL1(datatype : BLOB, precision : 1024, scale : 0) null null null null ",
                 "COL1(datatype : BLOB, precision : 1024, scale : 0) null null null null "
@@ -681,9 +681,9 @@ public class CoalesceTest extends BaseJDBCTestCase
         s.executeUpdate("insert into tH values(null, null, null)");
         s.executeUpdate("insert into tH values(timestamp('1992-01-01 12:30:30'), '1992-01-01 12:30:31', '1992-01-01 12:30:32')");
 
-        String expectedValue = "COL1(datatype : TIMESTAMP, precision : 26, scale : 6) null 1992-01-01 12:30:30.0 ";
-        String expectedValue1 = "COL1(datatype : TIMESTAMP, precision : 26, scale : 6) null 1992-01-01 12:30:31.0 ";
-        String expectedValue2 = "COL1(datatype : TIMESTAMP, precision : 26, scale : 6) null 1992-01-01 12:30:32.0 ";
+        String expectedValue = "COL1(datatype : TIMESTAMP, precision : 29, scale : 9) null 1992-01-01 12:30:30.0 ";
+        String expectedValue1 = "COL1(datatype : TIMESTAMP, precision : 29, scale : 9) null 1992-01-01 12:30:31.0 ";
+        String expectedValue2 = "COL1(datatype : TIMESTAMP, precision : 29, scale : 9) null 1992-01-01 12:30:32.0 ";
 
         dumpRS(s.executeQuery("select coalesce(timestampCol,timestampCol) from tH"), expectedValue);
         dumpRS(s.executeQuery("select value(timestampCol,timestampCol) from tH"), expectedValue);
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/TableFunctionTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/TableFunctionTest.java
index 7581a580a..42324bce3 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/TableFunctionTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/TableFunctionTest.java
@@ -788,9 +788,9 @@ public class TableFunctionTest extends BaseJDBCTestCase
             FUNCTION_RESULT_COLUMN,
             JDBC_TYPE_TIMESTAMP,
             "TIMESTAMP",
-            new Integer( 26 ),     // PRECISION
+            new Integer( 29 ),     // PRECISION
             new Integer( 16 ),         // LENGTH
-            new Integer( 6 ),       // SCALE
+            new Integer( 9 ),       // SCALE
             RADIX_INTEGER,    // RADIX
             ALLOWS_NULLS,
             EMPTY_REMARKS,
