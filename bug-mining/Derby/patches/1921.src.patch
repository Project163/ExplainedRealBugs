diff --git a/java/engine/org/apache/derby/impl/sql/compile/sqlgrammar.jj b/java/engine/org/apache/derby/impl/sql/compile/sqlgrammar.jj
index 1950c853b..6e4f432dc 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/sqlgrammar.jj
+++ b/java/engine/org/apache/derby/impl/sql/compile/sqlgrammar.jj
@@ -1254,6 +1254,49 @@ public class SQLParser
 	}
 
 
+
+    /**
+     * Determine if we are seeing an offsetClause or the identifier OFFSET
+     * (Derby does not make it a reserved word).  "n" must be an integer
+     * literal or a dynamic parameter specification.
+     *
+     * @return true if it is an offsetClause.
+     */
+    private boolean seeingOffsetClause()
+    {
+        int nesting = 0;
+
+        // Token number, i == 1: OFFSET
+        int i = 2;
+
+        int tokKind = getToken(i).kind;
+
+        // check for integer literal or ? followed by ROW(S)
+        if (tokKind == PLUS_SIGN ||
+            tokKind == MINUS_SIGN) {
+
+            tokKind = getToken(++i).kind;
+
+            if (tokKind == EXACT_NUMERIC) {
+
+                tokKind = getToken(++i).kind;
+
+                return (tokKind == ROW ||
+                        tokKind == ROWS);
+            }
+        } else if (tokKind == EXACT_NUMERIC ||
+                   tokKind == QUESTION_MARK) {
+
+            tokKind = getToken(++i).kind;
+
+            return (tokKind == ROW ||
+                    tokKind == ROWS);
+        }
+
+        return false;
+    }
+
+
 	/**
 	 * Determine whether the next sequence of tokens can be the beginning
 	 * of a rowValueConstructorList. A rowValueConstructorList is a comma-
@@ -14495,10 +14538,7 @@ nonReservedKeyword()  :
 	|	tok = <OFF>
 	|	LOOKAHEAD({
 			getToken(1).kind == OFFSET &&
-			!(getToken(2).kind == PLUS_SIGN ||
-			  getToken(2).kind == MINUS_SIGN ||
-			  getToken(2).kind == EXACT_NUMERIC ||
-			  getToken(2).kind == QUESTION_MARK)
+			!seeingOffsetClause()
 		})
 		tok = <OFFSET>
 	|	tok = <OLD>
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/OffsetFetchNextTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/OffsetFetchNextTest.java
index 1df0e0ce2..0090f5e35 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/OffsetFetchNextTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/OffsetFetchNextTest.java
@@ -115,6 +115,9 @@ public class OffsetFetchNextTest extends BaseJDBCTestCase {
         assertStatementError(LANG_INVALID_ROW_COUNT_OFFSET, st,
                              "select * from t1 offset -1 rows");
 
+        assertStatementError(LANG_SYNTAX_ERROR, st,
+                             "select * from t1 offset -? rows");
+
         assertStatementError(LANG_INVALID_ROW_COUNT_FIRST, st,
                              "select * from t1 fetch first 0 rows only");
 
@@ -139,12 +142,35 @@ public class OffsetFetchNextTest extends BaseJDBCTestCase {
     public void testNewKeywordNonReserved()
             throws Exception
     {
-        prepareStatement("select a,b as OFFSET from t1 OFFSET 0 rows");
+        setAutoCommit(false);
+        prepareStatement("select a,b as offset from t1 offset 0 rows");
 
         // Column and table correlation name usage
-        prepareStatement("select a,b from t1 AS OFFSET");
+        prepareStatement("select a,b from t1 as offset");
+
+        prepareStatement("select a,b offset from t1 offset");
+        prepareStatement("select a,b offset from t1 offset +2 rows");
+        prepareStatement("select a offset,b from t1 offset ? rows");
+        prepareStatement("select offset.a, offset.b offset from t1 as offset offset ? rows");
+
+        // DERBY-4562
+        Statement s = createStatement();
+        s.executeUpdate("create table t4562(i int, offset int)");
+        ResultSet rs = s.executeQuery(
+            "select * from t4562 where i > 0 and offset + i < 0 offset 2 rows");
+        rs.next();
+
+        rs = s.executeQuery(
+            "select * from t4562 where i > 0 and offset - i < 0 offset 2 rows");
+        rs.next();
 
-        prepareStatement("select a,b OFFSET from t1 OFFSET");
+        rs = s.executeQuery(
+            "select * from t4562 where i > 0 and offset * i < 0 offset 2 rows");
+        rs.next();
+
+        rs.close();
+
+        rollback();
     }
 
 
