diff --git a/java/client/org/apache/derby/jdbc/ClientBaseDataSource.java b/java/client/org/apache/derby/jdbc/ClientBaseDataSource.java
index ba67eea92..0d898037d 100644
--- a/java/client/org/apache/derby/jdbc/ClientBaseDataSource.java
+++ b/java/client/org/apache/derby/jdbc/ClientBaseDataSource.java
@@ -31,6 +31,7 @@ import java.lang.reflect.Field;
 import java.lang.reflect.InvocationTargetException;
 import java.lang.reflect.Method;
 import java.lang.reflect.Modifier;
+import java.sql.SQLException;
 
 import javax.naming.RefAddr;
 import javax.naming.Referenceable;
@@ -799,15 +800,24 @@ public abstract class ClientBaseDataSource implements Serializable, Referenceabl
      * Any attributes that can be set using a property of this DataSource implementation
      * (e.g user, password) should not be set in connectionAttributes. Conflicting
      * settings in connectionAttributes and properties of the DataSource will lead to
-     * unexpected behaviour. 
+     * unexpected behaviour. Specifically, databaseName attribute cannot be set using 
+     * this method. (DERBY-1130). databaseName has to be set using the DataSource 
+     * property.
      *
      * @param prop set to the list of Cloudscape connection attributes separated by semi-colons.   E.g., to specify an
      *             encryption bootPassword of "x8hhk2adf", and set upgrade to true, do the following: <PRE>
      *             ds.setConnectionAttributes("bootPassword=x8hhk2adf;upgrade=true"); </PRE> See Derby documentation for
      *             complete list.
+     * @throws SQLException if we attempt to set databaseName property in the connection attributes
      */
-    public final void setConnectionAttributes(String prop) {
+    public final void setConnectionAttributes(String prop) throws SQLException {
         connectionAttributes = prop;
+        
+        try {
+        	updateDataSourceValues(tokenizeAttributes(prop, null));
+        }  catch(SqlException se) {
+        	throw se.getSQLException();
+        }
     }
 
     /**
@@ -885,11 +895,17 @@ public abstract class ClientBaseDataSource implements Serializable, Referenceabl
      * The dataSource keeps individual fields for the values that are relevant to the client. These need to be updated
      * when set connection attributes is called.
      */
-    void updateDataSourceValues(Properties prop) {
+    void updateDataSourceValues(Properties prop) throws SqlException {
         if (prop == null) {
             return;
         }
         
+        if (prop.containsKey(Attribute.DBNAME_ATTR)) {
+        	throw new SqlException(null, 
+                    new ClientMessageId(SQLState.ATTRIBUTE_NOT_ALLOWED),
+					Attribute.DBNAME_ATTR);
+        }
+        
         if (prop.containsKey(Attribute.USERNAME_ATTR)) {
             setUser(getUser(prop));
         }
diff --git a/java/client/org/apache/derby/jdbc/ClientDataSource.java b/java/client/org/apache/derby/jdbc/ClientDataSource.java
index 11241cb95..9f43ea6c2 100644
--- a/java/client/org/apache/derby/jdbc/ClientDataSource.java
+++ b/java/client/org/apache/derby/jdbc/ClientDataSource.java
@@ -182,7 +182,6 @@ public class ClientDataSource extends ClientBaseDataSource implements DataSource
         try
         {
             LogWriter dncLogWriter = super.computeDncLogWriterForNewConnection("_sds");
-            updateDataSourceValues(tokenizeAttributes(getConnectionAttributes(), null));
             return ClientDriver.getFactory().newNetConnection
                     ((NetLogWriter) dncLogWriter, user,
                     password, this, -1, false);
diff --git a/java/engine/org/apache/derby/loc/messages_en.properties b/java/engine/org/apache/derby/loc/messages_en.properties
index 0d140c9e5..b389a4e68 100644
--- a/java/engine/org/apache/derby/loc/messages_en.properties
+++ b/java/engine/org/apache/derby/loc/messages_en.properties
@@ -1281,6 +1281,7 @@ XJ212.S=Invalid attribute syntax: {0}
 XJ213.C=The traceLevel connection property does not have a valid format for a number.
 XJ214.S=An IO Error occurred when calling free() on a CLOB or BLOB.
 XJ215.S=You cannot invoke other Clob/Blob methods after calling free.
+XJ216.S={0} attribute cannot be set using the DataSource method setConnectionAttributes. 
 
 #XN - Network level messages
 XN001.S=Connection reset is not allowed when inside a unit of work.
diff --git a/java/shared/org/apache/derby/shared/common/reference/SQLState.java b/java/shared/org/apache/derby/shared/common/reference/SQLState.java
index dd51855c2..f7d4987c1 100644
--- a/java/shared/org/apache/derby/shared/common/reference/SQLState.java
+++ b/java/shared/org/apache/derby/shared/common/reference/SQLState.java
@@ -1490,6 +1490,7 @@ public interface SQLState {
     String TRACELEVEL_FORMAT_INVALID = "XJ213.C";
     String IO_ERROR_UPON_LOB_FREE = "XJ214.S";
     String LOB_OBJECT_INVALID = "XJ215.S";
+    String ATTRIBUTE_NOT_ALLOWED = "XJ216.S";
     
     //XN - Network-level messages
     String NET_CONNECTION_RESET_NOT_ALLOWED_IN_UNIT_OF_WORK         = "XN001.S";
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/checkDataSource.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/checkDataSource.out
index e44b59f9b..3f039b830 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/checkDataSource.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/checkDataSource.out
@@ -555,4 +555,41 @@ Expected XA error code: -9
 acxs 3
 testing jira 95 for DataSource; ok - expected exception: XCY00
 testing jira 95 for XADataSource; ok - expected exception: XCY00
+DataSource - EMPTY
+  getConnection() - 08001:Required property databaseName not set.
+  getConnection(null, null) - 08001:Required property databaseName not set.
+  getConnection(fred, null) - 08001:Required property databaseName not set.
+  getConnection(fred, wilma) - 08001:Required property databaseName not set.
+  getConnection(null, wilma) - 08001:Required property databaseName not set.
+  getConnection(null, databaseName=wombat) - 08001:Required property databaseName not set.
+  getConnection(fred, databaseName=wombat) - 08001:Required property databaseName not set.
+  getConnection(fred, databaseName=wombat;password=wilma) - 08001:Required property databaseName not set.
+  getConnection(fred, databaseName=wombat;password=betty) - 08001:Required property databaseName not set.
+DataSource - connectionAttributes=databaseName=wombat
+Expected exception - databaseName attribute cannot be set using the DataSource method setConnectionAttributes. 
+ConnectionPoolDataSource - EMPTY
+  getPooledConnection() - 08001:Required property databaseName not set.
+  getPooledConnection(null, null) - 08001:Required property databaseName not set.
+  getPooledConnection(fred, null) - 08001:Required property databaseName not set.
+  getPooledConnection(fred, wilma) - 08001:Required property databaseName not set.
+  getPooledConnection(null, wilma) - 08001:Required property databaseName not set.
+  getPooledConnection(null, databaseName=wombat) - 08001:Required property databaseName not set.
+  getPooledConnection(fred, databaseName=wombat) - 08001:Required property databaseName not set.
+  getPooledConnection(fred, databaseName=wombat;password=wilma) - 08001:Required property databaseName not set.
+  getPooledConnection(fred, databaseName=wombat;password=betty) - 08001:Required property databaseName not set.
+ConnectionPoolDataSource - connectionAttributes=databaseName=wombat
+Expected exception - databaseName attribute cannot be set using the DataSource method setConnectionAttributes. 
+XADataSource - EMPTY
+  getXAConnection() - 08001:Required property databaseName not set.
+  getXAConnection(null, null) - 08001:Required property databaseName not set.
+  getXAConnection(fred, null) - 08001:Required property databaseName not set.
+  getXAConnection(fred, wilma) - 08001:Required property databaseName not set.
+  getXAConnection(null, wilma) - 08001:Required property databaseName not set.
+  getXAConnection(null, databaseName=wombat) - 08001:Required property databaseName not set.
+  getXAConnection(fred, databaseName=wombat) - 08001:Required property databaseName not set.
+  getXAConnection(fred, databaseName=wombat;password=wilma) - 08001:Required property databaseName not set.
+  getXAConnection(fred, databaseName=wombat;password=betty) - 08001:Required property databaseName not set.
+XADataSource - connectionAttributes=databaseName=wombat
+Expected exception - databaseName attribute cannot be set using the DataSource method setConnectionAttributes. 
+Checked class declared as: javax.sql.DataSource
 Completed checkDataSource
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/checkDataSource30.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/checkDataSource30.out
index 9e0e82deb..e8530201d 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/checkDataSource30.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/checkDataSource30.out
@@ -672,6 +672,42 @@ Expected XA error code: -9
 acxs 3
 testing jira 95 for DataSource; ok - expected exception: XCY00
 testing jira 95 for XADataSource; ok - expected exception: XCY00
+DataSource - EMPTY
+  getConnection() - 08001:Required property databaseName not set.
+  getConnection(null, null) - 08001:Required property databaseName not set.
+  getConnection(fred, null) - 08001:Required property databaseName not set.
+  getConnection(fred, wilma) - 08001:Required property databaseName not set.
+  getConnection(null, wilma) - 08001:Required property databaseName not set.
+  getConnection(null, databaseName=wombat) - 08001:Required property databaseName not set.
+  getConnection(fred, databaseName=wombat) - 08001:Required property databaseName not set.
+  getConnection(fred, databaseName=wombat;password=wilma) - 08001:Required property databaseName not set.
+  getConnection(fred, databaseName=wombat;password=betty) - 08001:Required property databaseName not set.
+DataSource - connectionAttributes=databaseName=wombat
+Expected exception - databaseName attribute cannot be set using the DataSource method setConnectionAttributes. 
+ConnectionPoolDataSource - EMPTY
+  getPooledConnection() - 08001:Required property databaseName not set.
+  getPooledConnection(null, null) - 08001:Required property databaseName not set.
+  getPooledConnection(fred, null) - 08001:Required property databaseName not set.
+  getPooledConnection(fred, wilma) - 08001:Required property databaseName not set.
+  getPooledConnection(null, wilma) - 08001:Required property databaseName not set.
+  getPooledConnection(null, databaseName=wombat) - 08001:Required property databaseName not set.
+  getPooledConnection(fred, databaseName=wombat) - 08001:Required property databaseName not set.
+  getPooledConnection(fred, databaseName=wombat;password=wilma) - 08001:Required property databaseName not set.
+  getPooledConnection(fred, databaseName=wombat;password=betty) - 08001:Required property databaseName not set.
+ConnectionPoolDataSource - connectionAttributes=databaseName=wombat
+Expected exception - databaseName attribute cannot be set using the DataSource method setConnectionAttributes. 
+XADataSource - EMPTY
+  getXAConnection() - 08001:Required property databaseName not set.
+  getXAConnection(null, null) - 08001:Required property databaseName not set.
+  getXAConnection(fred, null) - 08001:Required property databaseName not set.
+  getXAConnection(fred, wilma) - 08001:Required property databaseName not set.
+  getXAConnection(null, wilma) - 08001:Required property databaseName not set.
+  getXAConnection(null, databaseName=wombat) - 08001:Required property databaseName not set.
+  getXAConnection(fred, databaseName=wombat) - 08001:Required property databaseName not set.
+  getXAConnection(fred, databaseName=wombat;password=wilma) - 08001:Required property databaseName not set.
+  getXAConnection(fred, databaseName=wombat;password=betty) - 08001:Required property databaseName not set.
+XADataSource - connectionAttributes=databaseName=wombat
+Expected exception - databaseName attribute cannot be set using the DataSource method setConnectionAttributes. 
 START XA HOLDABILITY TEST
 By default, autocommit is true for a connection
 Default holdability for a connection is HOLD_CURSORS_OVER_COMMIT
@@ -740,4 +776,5 @@ PASS: No lock timeout occurs for READ_UNCOMMITTED
 Get a new connection with XAConnection.getConnection()
 Isolation level should be reset to READ_COMMITTED
 PASS: Expected lock timeout for READ_COMMITTED
+Checked class declared as: javax.sql.DataSource
 Completed checkDataSource30
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/checkDataSource.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/checkDataSource.java
index 37bb9be47..ce1c6bd36 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/checkDataSource.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/checkDataSource.java
@@ -47,6 +47,10 @@ import javax.transaction.xa.Xid;
 import org.apache.derby.jdbc.EmbeddedConnectionPoolDataSource;
 import org.apache.derby.jdbc.EmbeddedDataSource;
 import org.apache.derby.jdbc.EmbeddedXADataSource;
+import org.apache.derby.jdbc.ClientConnectionPoolDataSource;
+import org.apache.derby.jdbc.ClientDataSource;
+import org.apache.derby.jdbc.ClientXADataSource;
+
 import org.apache.derby.tools.JDBCDisplayUtil;
 import org.apache.derby.tools.ij;
 import org.apache.derbyTesting.functionTests.util.SecurityCheck;
@@ -686,10 +690,12 @@ public class checkDataSource
 		} catch (Exception e) {
 				System.out.println("; wrong, unexpected exception: " + e.toString());
 		}
-		// skip testDSRequestAuthentication for  client because of these 
-		// two issues:
-		// DERBY-1130 : Client should not allow databaseName to be set with
-		// setConnectionAttributes
+		
+		// DERBY-1130 - Client should not allow databaseName to be set with setConnectionAttributes
+		if (TestUtil.isDerbyNetClientFramework())
+			testClientDSConnectionAttributes();
+		
+		// skip testDSRequestAuthentication for  client because of this issue: 
 		// DERBY-1131 : Deprecate  Derby DataSource property attributesAsPassword
 		if (TestUtil.isDerbyNetClientFramework())
 			return;
@@ -1383,6 +1389,53 @@ public class checkDataSource
 		xads.setDatabaseName(null);
 	}
 
+	/**
+	 * Check that database name cannot be set using setConnectionAttributes 
+	 * for Derby client data sources. This method tests DERBY-1130.
+	 * 
+	 * @throws SQLException
+	 */
+	private static void testClientDSConnectionAttributes() throws SQLException {
+
+		ClientDataSource ds = new ClientDataSource();
+
+		System.out.println("DataSource - EMPTY");
+		dsConnectionRequests(ds);
+
+		System.out.println("DataSource - connectionAttributes=databaseName=wombat");
+		try{ 
+			ds.setConnectionAttributes("databaseName=wombat");
+		} catch (SQLException sqle) {
+			System.out.println("Expected exception - " + sqle.getMessage());
+		}
+		
+		
+		// now with ConnectionPoolDataSource
+		ClientConnectionPoolDataSource cpds = new ClientConnectionPoolDataSource();
+		System.out.println("ConnectionPoolDataSource - EMPTY");
+		dsConnectionRequests((ConnectionPoolDataSource)cpds);
+
+		System.out.println("ConnectionPoolDataSource - connectionAttributes=databaseName=wombat");
+		try {
+			cpds.setConnectionAttributes("databaseName=wombat");
+		} catch (SQLException sqle) {
+			System.out.println("Expected exception - " + sqle.getMessage());
+		}
+		
+		// now with XADataSource
+		ClientXADataSource xads = new ClientXADataSource();
+		System.out.println("XADataSource - EMPTY");
+		dsConnectionRequests((XADataSource) xads);
+
+		System.out.println("XADataSource - connectionAttributes=databaseName=wombat");
+		try {
+			xads.setConnectionAttributes("databaseName=wombat");
+		} catch (SQLException sqle) {
+			System.out.println("Expected exception - " + sqle.getMessage());
+		}
+		
+	}
+	
 	private static void dsConnectionRequests(DataSource ds) {
 		
 		SecurityCheck.inspect(ds, "javax.sql.DataSource");
