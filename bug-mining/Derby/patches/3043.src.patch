diff --git a/java/engine/org/apache/derby/impl/sql/compile/ColumnReference.java b/java/engine/org/apache/derby/impl/sql/compile/ColumnReference.java
index 1ae405a24..cdd9fa848 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/ColumnReference.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/ColumnReference.java
@@ -387,7 +387,7 @@ public class ColumnReference extends ValueNode
 	 * @exception StandardException		Thrown on error
 	 */
     @Override
-    ValueNode bindExpression(FromList fromList,
+    ColumnReference bindExpression(FromList fromList,
                              SubqueryList subqueryList,
                              List<AggregateNode> aggregates)
             throws StandardException
diff --git a/java/engine/org/apache/derby/impl/sql/compile/FromList.java b/java/engine/org/apache/derby/impl/sql/compile/FromList.java
index 7c05410aa..9ce9be522 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/FromList.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/FromList.java
@@ -622,7 +622,8 @@ class FromList extends    QueryTreeNodeVector<ResultSetNode>
 	 *
 	 * @param columnReference	The ColumnReference describing the column to bind
 	 *
-	 * @return	ResultColumn	The matching ResultColumn
+     * @return ResultColumn     The matching ResultColumn, or {@code null} if
+     *                          there is no matching column
 	 *
 	 * @exception StandardException		Thrown on error
 	 */
diff --git a/java/engine/org/apache/derby/impl/sql/compile/MergeNode.java b/java/engine/org/apache/derby/impl/sql/compile/MergeNode.java
index f3ae58d03..a48ce6cd6 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/MergeNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/MergeNode.java
@@ -942,9 +942,11 @@ public final class MergeNode extends DMLModStatementNode
     {
         if ( cr.getTableName() == null )
         {
-            ResultColumn    rc = _leftJoinFromList.bindColumnReference( cr );
+            cr = cr.bindExpression(
+                    _leftJoinFromList,
+                    new SubqueryList(getContextManager()),
+                    new ArrayList<AggregateNode>());
             TableName       tableName = cr.getQualifiedTableName();
-            if ( tableName == null ) { tableName = new TableName( null, rc.getTableName(), getContextManager() ); }
             cr = new ColumnReference( cr.getColumnName(), tableName, getContextManager() );
         }
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/MergeStatementTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/MergeStatementTest.java
index 7b6f72e4d..38368e5dc 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/MergeStatementTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/MergeStatementTest.java
@@ -324,6 +324,13 @@ public class MergeStatementTest extends GeneratedColumnsHelper
               "when matched then delete\n"
               );
 
+        // Variant of the above, where no table name is specified in the
+        // column reference that is out of scope. Used to fail with a
+        // NullPointerException (DERBY-6703).
+        expectCompilationError(dboConnection, COLUMN_OUT_OF_SCOPE,
+                "merge into t1 using t2 on no_such_column " +
+                "when matched then delete");
+
         //
         // The matching refinement clauses can only mention columns in the
         // source and target tables.
