diff --git a/java/engine/org/apache/derby/impl/sql/compile/InsertNode.java b/java/engine/org/apache/derby/impl/sql/compile/InsertNode.java
index 72fe17ee5..e8010207a 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/InsertNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/InsertNode.java
@@ -295,8 +295,18 @@ public final class InsertNode extends DMLModStatementNode
 				" on return from RS.bindExpressions()");
 		}
 
-		/* Replace any DEFAULTs with the associated tree */
-		resultSet.replaceDefaults(targetTableDescriptor, targetColumnList);
+        /* Replace any DEFAULTs with the associated tree, or flag DEFAULTs if
+         * not allowed (inside top level set operator nodes). Subqueries are
+         * checked for illegal DEFAULTs elsewhere.
+         */
+        boolean isTableConstructor =
+            (resultSet instanceof UnionNode &&
+             ((UnionNode)resultSet).tableConstructor()) ||
+            resultSet instanceof RowResultSetNode;
+
+        resultSet.replaceOrForbidDefaults(targetTableDescriptor,
+                                          targetColumnList,
+                                          isTableConstructor);
 
 		/* Bind the expressions now that the result columns are bound 
 		 * NOTE: This will be the 2nd time for those underlying ResultSets
diff --git a/java/engine/org/apache/derby/impl/sql/compile/ResultColumnList.java b/java/engine/org/apache/derby/impl/sql/compile/ResultColumnList.java
index 6e4c355da..9b3509ad7 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/ResultColumnList.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/ResultColumnList.java
@@ -3864,14 +3864,18 @@ public class ResultColumnList extends QueryTreeNodeVector
 	}
 
 	/**
-	 * Replace any DEFAULTs with the associated tree for the default.
+	 * Replace any DEFAULTs with the associated tree for the default if
+	 * allowed, or flag.
 	 *
 	 * @param ttd	The TableDescriptor for the target table.
 	 * @param tcl	The RCL for the target table.
+     * @param allowDefaults true if allowed
 	 *
 	 * @exception StandardException		Thrown on error
 	 */
-	void replaceDefaults(TableDescriptor ttd, ResultColumnList tcl) 
+	void replaceOrForbidDefaults(TableDescriptor ttd,
+                                 ResultColumnList tcl,
+                                 boolean allowDefaults)
 		throws StandardException
 	{
 		int size = size();
@@ -3882,6 +3886,11 @@ public class ResultColumnList extends QueryTreeNodeVector
 
 			if (rc.isDefaultColumn())
 			{
+                if (!allowDefaults) {
+                    throw StandardException.newException(
+                        SQLState.LANG_INVALID_USE_OF_DEFAULT);
+                }
+
 				//				DefaultNode defaultNode = (DefaultNode) rc.getExpression();
 				// Get ColumnDescriptor by name or by position?
 				ColumnDescriptor cd;
diff --git a/java/engine/org/apache/derby/impl/sql/compile/ResultSetNode.java b/java/engine/org/apache/derby/impl/sql/compile/ResultSetNode.java
index e0697f04d..3358c6d2c 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/ResultSetNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/ResultSetNode.java
@@ -1763,19 +1763,28 @@ public abstract class ResultSetNode extends QueryTreeNode
 		return false;
 	}
 
-	/**
-	 * Replace any DEFAULTs with the associated tree for the default.
-	 *
-	 * @param ttd	The TableDescriptor for the target table.
-	 * @param tcl	The RCL for the target table.
-	 *
-	 * @exception StandardException		Thrown on error
-	 */
-	void replaceDefaults(TableDescriptor ttd, ResultColumnList tcl) 
-		throws StandardException
-	{
-		// Only subclasses with something to do override this.
-	}
+    /**
+     * Replace any DEFAULTs with the associated tree for the default if
+     * allowed, or flag (when inside top level set operator nodes). Subqueries
+     * are checked for illegal DEFAULTs elsewhere.
+     *
+     * @param ttd   The TableDescriptor for the target table.
+     * @param tcl   The RCL for the target table.
+     * @param allowDefaults true if allowed
+     *
+     * @exception StandardException         Thrown on error
+     */
+    void replaceOrForbidDefaults(TableDescriptor ttd,
+                                 ResultColumnList tcl,
+                                 boolean allowDefaults)
+        throws StandardException
+    {
+        if (SanityManager.DEBUG) {
+            SanityManager.THROWASSERT(
+                "replaceOrForbidDefaults() not expected to be called for " +
+                this.getClass().getName());
+        }
+    }
 
 	/**
 	 * Is it possible to do a distinct scan on this ResultSet tree.
diff --git a/java/engine/org/apache/derby/impl/sql/compile/RowResultSetNode.java b/java/engine/org/apache/derby/impl/sql/compile/RowResultSetNode.java
index f1a4021a5..87a1d3f4b 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/RowResultSetNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/RowResultSetNode.java
@@ -853,17 +853,14 @@ public class RowResultSetNode extends FromTable
 	}
 
 	/**
-	 * Replace any DEFAULTs with the associated tree for the default.
-	 *
-	 * @param ttd	The TableDescriptor for the target table.
-	 * @param tcl	The RCL for the target table.
-	 *
-	 * @exception StandardException		Thrown on error
+     * {@inheritDoc}
 	 */
-	void replaceDefaults(TableDescriptor ttd, ResultColumnList tcl) 
+	void replaceOrForbidDefaults(TableDescriptor ttd,
+                                 ResultColumnList tcl,
+                                 boolean allowDefaults)
 		throws StandardException
 	{
-		resultColumns.replaceDefaults(ttd, tcl);
+		resultColumns.replaceOrForbidDefaults(ttd, tcl, allowDefaults);
 	}
 
 	/**
diff --git a/java/engine/org/apache/derby/impl/sql/compile/SelectNode.java b/java/engine/org/apache/derby/impl/sql/compile/SelectNode.java
index b62832b1a..df0c23183 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/SelectNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/SelectNode.java
@@ -2423,4 +2423,16 @@ public class SelectNode extends ResultSetNode
 				clauseName);
 		}
 	}
+
+    /**
+     * {@inheritDoc}
+     *
+     * A no-op for SelectNode.
+     */
+    void replaceOrForbidDefaults(TableDescriptor ttd,
+                                 ResultColumnList tcl,
+                                 boolean allowDefaults)
+        throws StandardException
+    {
+    }
 }
diff --git a/java/engine/org/apache/derby/impl/sql/compile/SetOperatorNode.java b/java/engine/org/apache/derby/impl/sql/compile/SetOperatorNode.java
index 1f9cac2a2..7024e994a 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/SetOperatorNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/SetOperatorNode.java
@@ -686,7 +686,20 @@ abstract class SetOperatorNode extends TableOperatorNode
 		}			
 	}
 
-	/**
+    /**
+     * {@inheritDoc}
+     */
+    void replaceOrForbidDefaults(TableDescriptor ttd,
+                                 ResultColumnList tcl,
+                                 boolean allowDefaults)
+        throws StandardException
+    {
+        leftResultSet.replaceOrForbidDefaults(ttd, tcl, allowDefaults);
+        rightResultSet.replaceOrForbidDefaults(ttd, tcl, allowDefaults);
+    }
+
+
+    /**
 	 * Get the parameter types from the given RowResultSetNode into the
 	 * given array of types.  If an array position is already filled in,
 	 * don't clobber it.
diff --git a/java/engine/org/apache/derby/impl/sql/compile/SingleChildResultSetNode.java b/java/engine/org/apache/derby/impl/sql/compile/SingleChildResultSetNode.java
index 14fe4f6b7..0b818d7ce 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/SingleChildResultSetNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/SingleChildResultSetNode.java
@@ -554,20 +554,6 @@ abstract class SingleChildResultSetNode extends FromTable
 		return ! (resultColumns.allExpressionsAreColumns(childResult));
 	}
 
-	/**
-	 * Replace any DEFAULTs with the associated tree for the default.
-	 *
-	 * @param ttd	The TableDescriptor for the target table.
-	 * @param tcl	The RCL for the target table.
-	 *
-	 * @exception StandardException		Thrown on error
-	 */
-	void replaceDefaults(TableDescriptor ttd, ResultColumnList tcl) 
-		throws StandardException
-	{
-		childResult.replaceDefaults(ttd, tcl);
-	}
-
 	/**
 	 * @see ResultSetNode#adjustForSortElimination
 	 */
diff --git a/java/engine/org/apache/derby/impl/sql/compile/TableOperatorNode.java b/java/engine/org/apache/derby/impl/sql/compile/TableOperatorNode.java
index d06378c37..2cdf2fded 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/TableOperatorNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/TableOperatorNode.java
@@ -928,21 +928,6 @@ abstract class TableOperatorNode extends FromTable
 		rightResultSet.decrementLevel(decrement);
 	}
 
-	/**
-	 * Replace any DEFAULTs with the associated tree for the default.
-	 *
-	 * @param ttd	The TableDescriptor for the target table.
-	 * @param tcl	The RCL for the target table.
-	 *
-	 * @exception StandardException		Thrown on error
-	 */
-	void replaceDefaults(TableDescriptor ttd, ResultColumnList tcl) 
-		throws StandardException
-	{
-		leftResultSet.replaceDefaults(ttd, tcl);
-		rightResultSet.replaceDefaults(ttd, tcl);
-	}
-
 	/**
 	 * @see ResultSetNode#adjustForSortElimination
 	 */
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/ColumnDefaultsTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/ColumnDefaultsTest.java
index 08b6bdf8b..1bc2d623a 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/ColumnDefaultsTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/ColumnDefaultsTest.java
@@ -144,7 +144,19 @@ public final class ColumnDefaultsTest extends BaseJDBCTestCase {
         
         assertStatementError("42802", st,
             " insert into neg values (default, 1)");
-        
+
+
+        // DERBY-4426
+        assertStatementError("42Y85", st,
+            " insert into neg values (default) union values (default)");
+
+        assertStatementError("42Y85", st,
+            " insert into neg values (default) except values (default)");
+
+        // Make sure sub-queries are inspected for illegal DEFAULT also.
+        assertStatementError("42Y85", st,
+            " insert into neg select * from (values default) t");
+
         st.executeUpdate( " drop table neg");
         
         st.executeUpdate( "drop function asdf");
@@ -402,7 +414,21 @@ public final class ColumnDefaultsTest extends BaseJDBCTestCase {
         };
         
         JDBC.assertFullResultSet(rs, expRS, true);
-        
+
+        // DERBY-4426: make sure we don't forbid inside a multi-value table
+        // constructor since this is represented as a UnionNode
+        st.executeUpdate( "delete from t7");
+        st.executeUpdate( "insert into t7 values 1, default");
+        rs = st.executeQuery( " select * from t7");
+
+        expRS = new String [][]
+        {
+            {"1"},
+            {"10"}
+        };
+
+        JDBC.assertFullResultSet(rs, expRS, true);
+
         st.executeUpdate( " drop table t1");
         
         st.executeUpdate( " drop table t7");
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/GeneratedColumnsHelper.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/GeneratedColumnsHelper.java
index 7dc1cd11d..e89eecc75 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/GeneratedColumnsHelper.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/GeneratedColumnsHelper.java
@@ -87,7 +87,8 @@ public class GeneratedColumnsHelper extends BaseJDBCTestCase
     protected static  final   String  CASCADED_COLUMN_DROP_WARNING = "01009";
     protected static  final   String  CONSTRAINT_DROPPED_WARNING = "01500";
     protected static  final   String  TRIGGER_DROPPED_WARNING = "01502";
-    
+    protected static  final   String  LANG_INVALID_USE_OF_DEFAULT = "42Y85";
+
     ///////////////////////////////////////////////////////////////////////////////////
     //
     // STATE
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/GeneratedColumnsTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/GeneratedColumnsTest.java
index faafbe91b..3d46b2ce0 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/GeneratedColumnsTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/GeneratedColumnsTest.java
@@ -233,6 +233,43 @@ public class GeneratedColumnsTest extends GeneratedColumnsHelper
         rollback();
     }
 
+
+    /**
+     * Test for DERBY-4426
+     */
+    public void testDerby_4426() throws SQLException {
+
+        Statement s = createStatement();
+        ResultSet rs = null;
+        setAutoCommit(false);
+
+        s.execute("create table t(a int, b generated always as (-a))");
+        s.execute("insert into t(b,a) values (default,1)");
+
+        // Wrong use of default
+        expectCompilationError
+            (
+             LANG_INVALID_USE_OF_DEFAULT,
+             "insert into t(b,a) values (default,3) intersect " +
+             "                   values (default,3)"
+             );
+
+        expectCompilationError
+            (
+             LANG_INVALID_USE_OF_DEFAULT,
+             "insert into t(a,b) values (3,default) except values (3,default)"
+             );
+
+        expectCompilationError
+            (
+             LANG_INVALID_USE_OF_DEFAULT,
+             "insert into t values (3,default) union values (3,default)"
+             );
+
+
+        rollback();
+    }
+
     /**
      * <p>
      * Test that the stored system procedures and functions are non-deterministic. If you want
