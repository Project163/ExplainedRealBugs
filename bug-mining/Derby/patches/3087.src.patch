diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/memorydb/Derby6662Test.java b/java/testing/org/apache/derbyTesting/functionTests/tests/memorydb/Derby6662Test.java
index 79247b8b6..9a06f6ea5 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/memorydb/Derby6662Test.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/memorydb/Derby6662Test.java
@@ -41,6 +41,7 @@ public class Derby6662Test extends BaseJDBCTestCase {
     protected void tearDown() throws Exception
     {
       super.tearDown();
+      dropInMemoryDb();
     }
     
     public void testDatabaseMetaDataCalls() throws SQLException
@@ -50,6 +51,22 @@ public class Derby6662Test extends BaseJDBCTestCase {
         assertFalse(dmd.usesLocalFiles());
     }
     
+    public void testOptionalToolMetaData() throws SQLException
+    {
+        Connection conn = obtainConnection();
+        // register the database metadata wrapper
+        goodStatement( conn, "call syscs_util.syscs_register_tool" +
+            "('databaseMetaData', true)");
+        // run the routines
+        assertResults(conn,"values usesLocalFiles()",
+             new String[][]{ { "false" }},false);
+        assertResults(conn,"values usesLocalFilePerTable()",
+             new String[][]{ { "false" }},false);
+        // unregister the database metadata wrapper
+        goodStatement( conn, "call syscs_util.syscs_register_tool" +
+            "('databaseMetaData', false)");
+    }
+    
     private DatabaseMetaData getDMD() throws SQLException
     {
         return obtainConnection().getMetaData();
