diff --git a/java/engine/org/apache/derby/iapi/sql/dictionary/DataDictionary.java b/java/engine/org/apache/derby/iapi/sql/dictionary/DataDictionary.java
index 4e342856d..1f0d50bf2 100644
--- a/java/engine/org/apache/derby/iapi/sql/dictionary/DataDictionary.java
+++ b/java/engine/org/apache/derby/iapi/sql/dictionary/DataDictionary.java
@@ -1969,4 +1969,14 @@ public interface DataDictionary
 	public boolean existsGrantToAuthid(String authId,
 									   TransactionController tc)
 				throws StandardException;
+
+	
+	/**
+	 * Drop and recreate metadata stored prepared statements.
+	 * 
+     * @param tc the xact
+	 * @throws StandardException
+	 */
+	public void updateMetadataSPSes(TransactionController tc) throws StandardException;
+	
 }
diff --git a/java/engine/org/apache/derby/impl/sql/catalog/DD_Version.java b/java/engine/org/apache/derby/impl/sql/catalog/DD_Version.java
index e9e7e76d9..2e0d50467 100644
--- a/java/engine/org/apache/derby/impl/sql/catalog/DD_Version.java
+++ b/java/engine/org/apache/derby/impl/sql/catalog/DD_Version.java
@@ -340,8 +340,7 @@ public	class DD_Version implements	Formatable
 		//Drop and recreate the stored versions of the JDBC database metadata queries
 		//This is to make sure that we have the stored versions of JDBC database
 		//metadata queries matching with this release of the engine.
-		dropJDBCMetadataSPSes(tc, false);
-		bootingDictionary.createSystemSps(tc);
+		bootingDictionary.updateMetadataSPSes(tc);
 
 		/*
 		 * OLD Cloudscape 5.1 upgrade code, Derby does not support
@@ -450,7 +449,15 @@ public	class DD_Version implements	Formatable
 		boolean isReadOnly = bootingDictionary.af.isReadOnly();
 
 		if (!isReadOnly) {
-			bootingDictionary.clearSPSPlans();
+			// Once a database is version 10.5 we will start updating metadata SPSes
+			// on any version change,up or down.  This will ensure that metadata queries 
+			// match the version we are using.  We don't want to do this for lower 
+			// database versions because on reverting to the previous version the 
+			// SPSes won't be restored.
+			if (fromVersion.majorVersionNumber >= DataDictionary.DD_VERSION_DERBY_10_5)
+				bootingDictionary.updateMetadataSPSes(tc);
+			else
+				bootingDictionary.clearSPSPlans();
 
 			DD_Version lastRun;
 			
@@ -485,49 +492,7 @@ public	class DD_Version implements	Formatable
 
 		bootingDictionary.clearCaches();
 	}
-
-	/**
-	 * Drop all jdbc metadata spses.  This
-	 * it to ensure that we don't have any problems
-	 * with old metadata queries that have outdated
-	 * query text (the plans are always cleared out
-	 * on upgrade time).
-	 *
-	 * @param tc the xact
-	 * @param removeSYSIBMonly if <code>true</code>, remove stored
-	 * prepared statements in the SYSIBM schema only; otherwise,
-	 * remove stored prepared statements in all system schemas
-	 * (including SYSIBM)
-	 *
-	 * @exception StandardException  Standard Derby error policy.
-	 */
-	protected void dropJDBCMetadataSPSes(TransactionController tc, boolean removeSYSIBMonly)
-		throws StandardException
-	{
-		for (java.util.Iterator it = bootingDictionary.getAllSPSDescriptors().iterator(); it.hasNext(); )
-		{
-			SPSDescriptor spsd = (SPSDescriptor) it.next();
-			SchemaDescriptor sd = spsd.getSchemaDescriptor();
-			// need to compare the name, old SYSIBM is not built-in
-			boolean isSYSIBM = sd.getSchemaName().equals(SchemaDescriptor.IBM_SYSTEM_SCHEMA_NAME);
-
-			// don't drop statements in non-system schemas
-			if (!sd.isSystemSchema() && !isSYSIBM) {
-				continue;
-			}
-
-			// don't drop statements outside the SYSIBM schema if
-			// we're told not to
-			if (removeSYSIBMonly && !isSYSIBM) {
-				continue;
-			}
-
-			bootingDictionary.dropSPSDescriptor(spsd, tc);
-			bootingDictionary.dropDependentsStoredDependencies(spsd.getUUID(),
-															   tc);
-		}
-	}
-
+	
 	/**
  	 * Make a catalog.
 	 *	@param	tc	TransactionController
diff --git a/java/engine/org/apache/derby/impl/sql/catalog/DataDictionaryImpl.java b/java/engine/org/apache/derby/impl/sql/catalog/DataDictionaryImpl.java
index ec090e69d..4e0e93b05 100644
--- a/java/engine/org/apache/derby/impl/sql/catalog/DataDictionaryImpl.java
+++ b/java/engine/org/apache/derby/impl/sql/catalog/DataDictionaryImpl.java
@@ -12295,4 +12295,42 @@ public final class	DataDictionaryImpl
 				 GRANTEE_COL_NUM_IN_GRANTEE_ALIAS_GRANTOR_INDEX) ||
 			 existsRoleGrantByGrantee(authId, tc));
 	}
+
+
+	/**
+	 * Remove metadata stored prepared statements.
+	 * @param tc the xact
+	 * 
+	 *
+	 */
+	private void dropJDBCMetadataSPSes(TransactionController tc) throws StandardException
+	{
+		for (java.util.Iterator it = getAllSPSDescriptors().iterator(); it.hasNext(); )
+		{
+			SPSDescriptor spsd = (SPSDescriptor) it.next();
+			SchemaDescriptor sd = spsd.getSchemaDescriptor();
+
+			// don't drop statements in non-system schemas
+			if (!sd.isSystemSchema()) {
+				continue;
+			}
+
+			dropSPSDescriptor(spsd, tc);
+			dropDependentsStoredDependencies(spsd.getUUID(),                                                                                                              tc);
+
+		}
+	}
+
+
+	/**
+	 * Drop and recreate metadata stored prepared statements.
+	 * 
+	 * @param tc the xact
+	 * @throws StandardException
+	 */
+	public void updateMetadataSPSes(TransactionController tc) throws StandardException {
+		dropJDBCMetadataSPSes(tc);
+		createSystemSps(tc);		
+	}
+
 }
diff --git a/java/storeless/org/apache/derby/impl/storeless/EmptyDictionary.java b/java/storeless/org/apache/derby/impl/storeless/EmptyDictionary.java
index 09980750a..52558fa57 100644
--- a/java/storeless/org/apache/derby/impl/storeless/EmptyDictionary.java
+++ b/java/storeless/org/apache/derby/impl/storeless/EmptyDictionary.java
@@ -814,4 +814,8 @@ public class EmptyDictionary implements DataDictionary, ModuleSupportable {
         // TODO Auto-generated method stub
         return null;
     }
+
+	public void updateMetadataSPSes(TransactionController tc) throws StandardException {
+		// TODO Auto-generated method stub		
+	}
 }
