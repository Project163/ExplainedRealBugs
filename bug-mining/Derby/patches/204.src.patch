diff --git a/java/drda/org/apache/derby/impl/drda/TestProto.java b/java/drda/org/apache/derby/impl/drda/TestProto.java
index 1129345a6..93eadc431 100644
--- a/java/drda/org/apache/derby/impl/drda/TestProto.java
+++ b/java/drda/org/apache/derby/impl/drda/TestProto.java
@@ -107,6 +107,7 @@ public class TestProto {
 	private static final int WRITE_ENCODED_LDSTRING = 53;
 	private static final int CHECK_SQLCARD = 54;
 	private static final int MORE_DATA = 55;
+	private static final int COMPLETE_TEST = 56;
 
 	private static final String MULTIVAL_START = "MULTIVALSTART";
 	private static final String MULTIVAL_SEP = "SEP";
@@ -175,7 +176,21 @@ public class TestProto {
 	{
 		String prev_filename = current_filename;
 		current_filename = filename;
-		FileReader fr = new FileReader(filename);
+        	String hostName=getHostName();
+		FileReader fr;
+                if (!hostName.equals("localhost")) 
+		{
+			// if we're not on localhost, we must also be starting
+			// the server remotely, and useprocess=false, so, the location may
+			// be different.
+			String userdir =  System.getProperty("user.dir");
+			String sep =  System.getProperty("file.separator");
+			fr = new FileReader(userdir + sep + ".." + sep + filename);
+		}
+		else
+		{
+			fr = new FileReader(filename);
+		}
 		tkn = new StreamTokenizer(fr);
 		int val;
 		while ( (val = tkn.nextToken()) != StreamTokenizer.TT_EOF)
@@ -198,13 +213,14 @@ public class TestProto {
 	 */
 	private void getConnection() 
 	{
+        String hostName=getHostName();
 		try {
-            monitorSocket = new Socket("localhost",1527);
+            monitorSocket = new Socket(hostName,1527);
         } catch (UnknownHostException e) {
-            System.err.println("Don't know about host: localhost");
+            System.err.println("Don't know about host: " + hostName);
             System.exit(1);
         } catch (IOException e) {
-            System.err.println("Couldn't get I/O for the connection to: localhost");
+            System.err.println("Couldn't get I/O for the connection to: " + hostName);
             System.exit(1);
         }
         try
@@ -214,7 +230,7 @@ public class TestProto {
 		}
 		catch (IOException e)
         {
-            System.err.println("Couldn't get I/O for the connection to: localhost");
+            System.err.println("Couldn't get I/O for the connection to: " + hostName);
             System.exit(1);
         }
 	}
@@ -240,6 +256,13 @@ public class TestProto {
 		reader.initialize(monitorIs);
 		writer.reset(null);
 	}
+	/**
+	 * finish by cleaning up the last connection
+	 */
+	private void completeTest()
+	{
+		closeConnection();
+	}
 	/**
 	 * Initialize hashtable for commands and set up a table to translate from
 	 * the codepoint name to the codepoint value
@@ -301,6 +324,7 @@ public class TestProto {
 		commandTable.put("writeencodedldstring", new Integer(WRITE_ENCODED_LDSTRING));
 		commandTable.put("checksqlcard", new Integer(CHECK_SQLCARD));
 		commandTable.put("moredata", new Integer(MORE_DATA));
+		commandTable.put("completetest", new Integer(COMPLETE_TEST));
 		
 		Integer key;
 		for (Enumeration e = codePointNameTable.keys(); e.hasMoreElements(); )
@@ -471,6 +495,9 @@ public class TestProto {
 			case CHECK_SQLCARD:
 				checkSQLCARD(getInt(), getString());
 				break;
+			case COMPLETE_TEST:
+				completeTest();
+				break;
 			case END_TEST:
 				// print that we passed the test if we haven't failed
 				if (failed == false)
@@ -957,4 +984,12 @@ public class TestProto {
 		// skip the rest of the SQLCARD
 		reader.skipBytes();
 	}
+
+	private static String getHostName()
+	{
+		String hostName = (System.getProperty("hostName"));
+		if (hostName == null)
+			hostName="localhost";
+		return hostName;
+	}
 }
diff --git a/java/testing/README.htm b/java/testing/README.htm
index c2aa3ec02..b1aea5df9 100644
--- a/java/testing/README.htm
+++ b/java/testing/README.htm
@@ -1,681 +1,931 @@
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
-<HTML>
-<HEAD>
-	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
-	<TITLE>readme.htm</TITLE>
-	<META NAME="GENERATOR" CONTENT="OpenOffice.org 1.1.4  (Win32)">
-	<META NAME="CREATED" CONTENT="20051031;9095275">
-	<META NAME="CHANGED" CONTENT="20051031;9274086">
-</HEAD>
-<BODY LANG="en-US" DIR="LTR">
-<H1><A NAME="mozTocId934928"></A>Derby Functional Tests</H1>
-<H2><A NAME="mozTocId504000"></A>Package: org.apache.derbyTesting<!--mozToc h1 1 h2 2 h3 3 h4 4 h5 5 h6 6--></H2>
-<P><FONT SIZE=2>created by myrna@golux.com<BR>last updated on
-04/18/2005 by: m.v.lunteren@gmail.com</FONT></P>
-<UL>
-	<LI><P STYLE="margin-bottom: 0in"><A HREF="#intro">1. Introduction</A>
-		</P>
-	<LI><P STYLE="margin-bottom: 0in"><A HREF="#quickstart">2.
-	Quickstart</A> 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in"><A HREF="#2.1_running_with_derby_classes_">2.1
-	running tests</A></P>
-	<LI><P STYLE="margin-bottom: 0in"><A HREF="#building_derbyTesting__running_with">2.2
-	building derbyTesting package</A></P>
-	<LI><P STYLE="margin-bottom: 0in"><A HREF="#run">3. More details on
-	running the derby functional tests</A> 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in"><A HREF="#run1">3.1 Running 1 test</A>
-		</P>
-	<LI><P STYLE="margin-bottom: 0in"><A HREF="#run2">3.2 Running suites
-	of tests</A> 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in"><A HREF="#overview">4. Harness
-	internals for developers</A> 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in"><A HREF="#ov1">4.1 Test types</A> 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in"><A HREF="#ov2">4.2 Supporting
-	files for tests</A> 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in"><A HREF="#ov3">4.3
-	&lt;testname&gt;_app.properties</A> 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in"><A HREF="#ov4">4.4
-	&lt;testname&gt;_derby.properties</A> 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in"><A HREF="#ov5">4.5 tmp files, out
-	files, master files, and canons</A> 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in"><A HREF="#ov6">4.6 Masking and
-	comparing</A> 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in"><A HREF="#Adding_a_new_test">4.7
-	Adding a new test</A> 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in"><A HREF="#4.8_Suites_and_Adding_a_new_suite">4.8
-	Suites and adding a new suite</A> 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in"><A HREF="#ov9">4.9 Running with a
-	new jvm</A> 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in"><A HREF="#skipping">4.10 Skipping
-	a test</A> 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in"><A HREF="#frameworks">4.11
-	Frameworks</A> 
-	</P>
-	<LI><P><A HREF="#props">4.12 Some test harness properties</A> 
-	</P>
-	<LI><P><A HREF="#security">4.13 SecuirtyManager testing by default</A></P>
-    <li><a href="./org/apache/derbyTesting/functionTests/tests/junitTests/compatibility/README.html">5. Compatibility Tests</a> </li>
-</UL>
-<P><BR><BR>
-</P>
-<H2><A NAME="intro"></A>1. Introduction</H2>
-<P>This document describes functionality of the derby functional
+<html>
+<head>
+  <meta http-equiv="CONTENT-TYPE"
+ content="text/html; charset=windows-1252">
+  <title>readme.htm</title>
+  <meta name="GENERATOR" content="OpenOffice.org 1.1.4  (Win32)">
+  <meta name="CREATED" content="20051031;9095275">
+  <meta name="CHANGED" content="20051031;9274086">
+</head>
+<body dir="ltr" lang="en-US">
+<h1><a name="mozTocId934928"></a>Derby Functional Tests</h1>
+<h2><a name="mozTocId504000"></a>Package: org.apache.derbyTesting<!--mozToc h1 1 h2 2 h3 3 h4 4 h5 5 h6 6--></h2>
+<p><font size="2">created by myrna@golux.com<br>
+last updated on
+04/18/2005 by: m.v.lunteren@gmail.com</font></p>
+<ul>
+  <li>
+    <p style="margin-bottom: 0in;"><a href="#intro">1. Introduction</a>
+    </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;"><a href="#quickstart">2. Quickstart</a>
+    </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;"><a
+ href="#2.1_running_with_derby_classes_">2.1 running tests</a></p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;"><a
+ href="#building_derbyTesting__running_with">2.2 building derbyTesting
+package</a></p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;"><a href="#run">3. More details on
+running the derby functional tests</a> </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;"><a href="#run1">3.1 Running 1 test</a>
+    </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;"><a href="#run2">3.2 Running suites
+of tests</a> </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;"><a href="#overview">4. Harness
+internals for developers</a> </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;"><a href="#ov1">4.1 Test types</a> </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;"><a href="#ov2">4.2 Supporting files
+for tests</a> </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;"><a href="#ov3">4.3
+&lt;testname&gt;_app.properties</a> </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;"><a href="#ov4">4.4
+&lt;testname&gt;_derby.properties</a> </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;"><a href="#ov5">4.5 tmp files, out
+files, master files, and canons</a> </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;"><a href="#ov6">4.6 Masking and
+comparing</a> </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;"><a href="#Adding_a_new_test">4.7
+Adding a new test</a> </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;"><a
+ href="#4.8_Suites_and_Adding_a_new_suite">4.8 Suites and adding a new
+suite</a> </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;"><a href="#ov9">4.9 Running with a
+new jvm</a> </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;"><a href="#skipping">4.10 Skipping a
+test</a> </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;"><a href="#frameworks">4.11 Frameworks</a>
+    </p>
+  </li>
+  <li>
+    <p><a href="#props">4.12 Some test harness properties</a> </p>
+  </li>
+  <li>
+    <p><a href="#security">4.13 SecurityManager testing by default</a></p>
+  </li>
+  <li><a href="#hostName">4.14 Testing with Network Server on a remote
+host</a></li>
+  <li>
+    <p><a
+ href="./org/apache/derbyTesting/functionTests/tests/junitTests/compatibility/README.html">5.
+Compatibility Tests</a></p>
+  </li>
+</ul>
+<p><br>
+<br>
+</p>
+<h2><a name="intro"></a>1. Introduction</h2>
+<p>This document describes functionality of the derby functional
 testing package org.apache.derbyTesting. This package is based on the
 functional tests in use at IBM for testing the Cloudscape product
-before its contribution to ASF.</P>
-<P>In the following, instructions are geared towards a unix
+before its contribution to ASF.</p>
+<p>In the following, instructions are geared towards a unix
 environment. For other environments, some details may need to be
 adjusted. For instance, the document may refer to $ANT_HOME, for DOS,
-this would be %ANT_HOME%.</P>
-<P>In the following the top directory under which the subversion tree
+this would be %ANT_HOME%.</p>
+<p>In the following the top directory under which the subversion tree
 is placed is referred to as ${derby.source} - see also the derby
-<A HREF="http://svn.apache.org/repos/asf/db/derby/code/trunk/BUILDING.txt">BUILDING.txt</A>.</P>
-<P>The version of the classes and supporting files of the
+<a
+ href="http://svn.apache.org/repos/asf/db/derby/code/trunk/BUILDING.txt">BUILDING.txt</a>.</p>
+<p>The version of the classes and supporting files of the
 derbyTesting package have to match the version of the classes of the
 derby package. Thus you either need to build all jars yourself, or
 get all jar files from the Derby site at the same time when
-available. 
-</P>
-<H2><A NAME="mozTocId191589"></A><A NAME="quickstart"></A>2.
-QuickStart</H2>
-<H3><A NAME="2.1_running_with_derby_classes_"></A>2.1 running tests</H3>
-<P>The derbyTesting package enables you to run 1 test or a suite of
-tests. Before you can run, you need to setup your environment:</P>
-<UL>
-	<LI><P>Obtain a jdk or jre (based on jdk 1.3.1 specification <A HREF="#Note1:"><FONT SIZE=1>See
-	Note1</FONT></A> or higher). Add the bin directory to your $PATH.
-	Currently supported are:</P>
-</UL>
-<TABLE BORDER=1 CELLPADDING=2 CELLSPACING=2>
-	<TR>
-		<TD>
-			<P>&nbsp;&nbsp;&nbsp; <FONT SIZE=2>jdk131 - Sun HotSpot
-			jdk1.3.1</FONT><BR>&nbsp;&nbsp;&nbsp; <FONT SIZE=2>jdk141 - Sun
-			HotSpot jdk1.4.1</FONT><BR>&nbsp;&nbsp;&nbsp; <FONT SIZE=2>jdk142
-			- Sun HotSpot jdk1.4.2</FONT><BR>&nbsp;&nbsp;&nbsp; <FONT SIZE=2>jdk15
-			- Sun HotSpot jdk1.5</FONT><BR>&nbsp;&nbsp;&nbsp; <FONT SIZE=2>ibm131
-			- IBM Classic jdk1.3.1</FONT><BR>&nbsp;&nbsp;&nbsp; <FONT SIZE=2>ibm141
-			- IBM Classic jdk1.4.1</FONT><BR>&nbsp;&nbsp;&nbsp; <FONT SIZE=2>ibm142
-			- IBM Classic jdk1.4.2</FONT><BR>&nbsp;&nbsp;&nbsp; <FONT SIZE=2>j9_13
-			- WCTME jvm (available with IBM Websphere Studio Device Developer,
-			5.6), version 2.1</FONT><BR>&nbsp;&nbsp;&nbsp; <FONT SIZE=2>j9_22
-			- WCTME jvm (available with IBM Websphere Client Technology Micro
-			Edition, 5.7), version 2.2</FONT><BR>&nbsp;&nbsp;&nbsp;
-			<FONT SIZE=2>j9_foundation - WCTME jvm (available with IBM
-			Websphere Client Technology Micro Edition, 5.7), version 2.2,
-			foundation library </FONT>
-			</P>
-		</TD>
-	</TR>
-</TABLE>
-<UL>
-	<LI><P STYLE="margin-bottom: 0in">cd into a directory that does not
-	have any colons or spaces in it.</P>
-	<LI><P STYLE="margin-bottom: 0in">set $CLASSPATH to include the
-	following jars: 
-	</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in"><FONT SIZE=2>jakarta-oro-2.0.8.jar</FONT>
-		&nbsp;&nbsp;&nbsp; <FONT SIZE=2>oromatcher, obtain from
-		<A HREF="http://jakarta.apache.org/oro/index.html">http://jakarta.apache.org/oro/index.html</A>,
-		or follow this link for <A HREF="http://apache.roweboat.net/jakarta/oro/source/jakarta-oro-2.0.8.zip">zip</A>
-		file, or <A HREF="http://apache.roweboat.net/jakarta/oro/source/jakarta-oro-2.0.8.tar.gz">tar</A>.gz)</FONT></P>
-		<LI><P STYLE="margin-bottom: 0in"><FONT SIZE=2>derbyTesting.jar</FONT></P>
-		<P STYLE="margin-bottom: 0in">&nbsp;&nbsp;&nbsp;&nbsp; <FONT SIZE=2>test
-		files and classes</FONT></P>
-		<LI><P STYLE="margin-bottom: 0in"><FONT SIZE=2>derby.jar<BR></FONT>&nbsp;&nbsp;&nbsp;
-		<FONT SIZE=2>main derby package classes</FONT></P>
-		<LI><P STYLE="margin-bottom: 0in"><FONT SIZE=2>derbytools.jar<BR></FONT>&nbsp;&nbsp;&nbsp;
-		<FONT SIZE=2>derby tools classes for tools like ij and dblook</FONT></P>
-		<LI><P STYLE="margin-bottom: 0in"><FONT SIZE=2>derbynet.jar<BR></FONT>&nbsp;&nbsp;&nbsp;
-		<FONT SIZE=2>derby network server classes</FONT></P>
-		<LI><P STYLE="margin-bottom: 0in"><FONT SIZE=2>derbyclient.jar<BR></FONT>&nbsp;&nbsp;&nbsp;
-		<FONT SIZE=2>derby client classes</FONT></P>
-		<LI><P STYLE="margin-bottom: 0in"><FONT SIZE=2>
-                db2jcc.jar and db2jcc_license_c.jar
-		<BR><FONT SIZE=2>IBM
-		Universal JDBC Driver classes. (See IBM <A HREF="http://www-106.ibm.com/developerworks/db2/downloads/jcc/">developerworks</A>
-		for download)</FONT>
-                <BR><b>These jars are optional.  The tests using the IBM 
-                Universal JDBC driver are not run
-                 if these jar files are not present in your classpath</b>
-                </FONT>&nbsp;&nbsp;&nbsp; 
-		<LI><P><FONT SIZE=2>derbyLocale_*.jar</FONT> <BR>&nbsp;&nbsp;&nbsp;
-		<FONT SIZE=2>locale files holding translated messages.</FONT></P>
-        <li><P><FONT SIZE=2>junit.jar &nbsp;&nbsp;&nbsp;</li>
-        <BR>&nbsp;&nbsp;&nbsp; assertion-based test machinery.</FONT></p>
-	</UL>
-</UL>
-<P>For example:</P>
-<DL>
-	<DD>
-	<TABLE BORDER=1 CELLPADDING=2 CELLSPACING=2>
-		<TR>
-			<TD>
-				<P><FONT SIZE=2>(note that $jardir is only a convenience variable
-				and that the set CLASSPATH command below has carriage returns for
-				formatting reasons):<BR>set jardir=/local/derbyjar<BR>set
-				CLASSPATH=&quot;$jardir/derby.jar:$jardir/derbytools.jar:$jardir/derbynet.jar:$jardir/derbyclient.jar:<BR>$jardir/derbyTesting.jar:/local/derby/tools/java/jakarta-oro-2.0.8.jar:<BR>$jardir/derbyLocale_de_DE.jar:$jardir/derbyLocale_es.jar:$jardir/derbyLocale_fr.jar:<BR>$jardir/derbyLocale_it.jar:$jardir/derbyLocale_ja_JP.jar:$jardir/derbyLocale_ko_KR.jar:<BR>$jardir/derbyLocale_pt_BR.jar:$jardir/derbyLocale_zh_CN.jar:$jardir/derbyLocale_zh_TW.jar:<BR>$CLASSPATH</FONT><BR><FONT SIZE=2>set
-				PATH=/local/jdk141/bin:$PATH</FONT></P>
-			</TD>
-		</TR>
-	</TABLE>
-</DL>
-<P>To run 1 test: 
-</P>
-<TABLE BORDER=1 CELLPADDING=2 CELLSPACING=2>
-	<TR>
-		<TD>
-			<P>syntax:<BR>&nbsp;&nbsp;&nbsp; <FONT SIZE=2>java
-			-D&lt;testproperty&gt;
-			org.apache.derbyTesting.functionTests.harness.RunTest
-			&lt;testdir&gt;/&lt;testname&gt;</FONT><BR><FONT SIZE=2>where </FONT>
-			</P>
-			<UL>
-				<LI><P STYLE="margin-bottom: 0in">&nbsp;&nbsp; <FONT SIZE=2>&lt;testproperty&gt;
-				are test specific properties, such as 'framework' for the RunTest
-				class. </FONT>
-				</P>
-				<LI><P STYLE="margin-bottom: 0in">&nbsp;&nbsp; <FONT SIZE=2>&lt;testdir&gt;
-				is one of the directories under functionTests/tests where the
-				actual test is located</FONT> 
-				</P>
-				<LI><P>&nbsp;&nbsp; <FONT SIZE=2>&lt;testname&gt; is the actual
-				name of the test</FONT> 
-				</P>
-			</UL>
-			<P><FONT SIZE=2>examples:<BR>to run the test supersimple against
-			the embedded driver:<BR></FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT SIZE=2>java
-			org.apache.derbyTesting.functionTests.harness.RunTest
-			lang/supersimple.sql<BR><BR>To run a test with network server,
-			using the derbyclient driver, add -Dframework=DerbyNetClient to
-			the run. The test harness will to start network server at port
-			1527 or connect to a running one, run the test, and stop network
-			server thereafter.<BR>for example:<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
-			java -Dframework=DerbyNetClient
-			org.apache.derbyTesting.functionTests.harness.RunTest
-			lang/supersimple.sql</FONT></P>
-		</TD>
-	</TR>
-</TABLE>
-<P>A successful run will have a .pass file, and the output to the
+available. </p>
+<h2><a name="mozTocId191589"></a><a name="quickstart"></a>2.
+QuickStart</h2>
+<h3><a name="2.1_running_with_derby_classes_"></a>2.1 running tests</h3>
+<p>The derbyTesting package enables you to run 1 test or a suite of
+tests. Before you can run, you need to setup your environment:</p>
+<ul>
+  <li>
+    <p>Obtain a jdk or jre (based on jdk 1.3.1 specification <a
+ href="#Note1:"><font size="1">See Note1</font></a> or higher). Add the
+bin directory to your $PATH. Currently supported are:</p>
+  </li>
+</ul>
+<table border="1" cellpadding="2" cellspacing="2">
+  <tbody>
+    <tr>
+      <td>
+      <p>&nbsp;&nbsp;&nbsp; <font size="2">jdk131 - Sun HotSpot
+jdk1.3.1</font><br>
+&nbsp;&nbsp;&nbsp; <font size="2">jdk141 - Sun HotSpot jdk1.4.1</font><br>
+&nbsp;&nbsp;&nbsp; <font size="2">jdk142 - Sun HotSpot jdk1.4.2</font><br>
+&nbsp;&nbsp;&nbsp; <font size="2">jdk15 - Sun HotSpot jdk1.5</font><br>
+&nbsp;&nbsp;&nbsp; <font size="2">ibm131 - IBM Classic jdk1.3.1</font><br>
+&nbsp;&nbsp;&nbsp; <font size="2">ibm141 - IBM Classic jdk1.4.1</font><br>
+&nbsp;&nbsp;&nbsp; <font size="2">ibm142 - IBM Classic jdk1.4.2</font><br>
+&nbsp;&nbsp;&nbsp; <font size="2">j9_13 - WCTME jvm (available with
+IBM Websphere Studio Device Developer, 5.6), version 2.1</font><br>
+&nbsp;&nbsp;&nbsp; <font size="2">j9_22 - WCTME jvm (available with
+IBM Websphere Client Technology Micro Edition, 5.7), version 2.2</font><br>
+&nbsp;&nbsp;&nbsp; <font size="2">j9_foundation - WCTME jvm (available
+with IBM Websphere Client Technology Micro Edition, 5.7), version 2.2,
+foundation library </font> </p>
+      </td>
+    </tr>
+  </tbody>
+</table>
+<ul>
+  <li>
+    <p style="margin-bottom: 0in;">cd into a directory that does not
+have any colons or spaces in it.</p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">set $CLASSPATH to include the
+following jars: </p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;"><font size="2">jakarta-oro-2.0.8.jar</font>
+&nbsp;&nbsp;&nbsp; <font size="2">oromatcher, obtain from <a
+ href="http://jakarta.apache.org/oro/index.html">http://jakarta.apache.org/oro/index.html</a>,
+or follow this link for <a
+ href="http://apache.roweboat.net/jakarta/oro/source/jakarta-oro-2.0.8.zip">zip</a>
+file, or <a
+ href="http://apache.roweboat.net/jakarta/oro/source/jakarta-oro-2.0.8.tar.gz">tar</a>.gz)</font></p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;"><font size="2">derbyTesting.jar</font></p>
+        <p style="margin-bottom: 0in;">&nbsp;&nbsp;&nbsp;&nbsp; <font
+ size="2">test files and classes</font></p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;"><font size="2">derby.jar<br>
+        </font>&nbsp;&nbsp;&nbsp; <font size="2">main derby package
+classes</font></p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;"><font size="2">derbytools.jar<br>
+        </font>&nbsp;&nbsp;&nbsp; <font size="2">derby tools classes
+for tools like ij and dblook</font></p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;"><font size="2">derbynet.jar<br>
+        </font>&nbsp;&nbsp;&nbsp; <font size="2">derby network server
+classes</font></p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;"><font size="2">derbyclient.jar<br>
+        </font>&nbsp;&nbsp;&nbsp; <font size="2">derby client classes</font></p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;"><font size="2"> db2jcc.jar and
+db2jcc_license_c.jar <br>
+        <font size="2">IBM Universal JDBC Driver classes. (See IBM <a
+ href="http://www-106.ibm.com/developerworks/db2/downloads/jcc/">developerworks</a>
+for download)</font> <br>
+        <b>These jars are optional. The tests using the IBM Universal
+JDBC driver are not run if these jar files are not present in your
+classpath</b> </font>&nbsp;&nbsp;&nbsp; </p>
+      </li>
+      <li>
+        <p><font size="2">derbyLocale_*.jar</font> <br>
+&nbsp;&nbsp;&nbsp; <font size="2">locale files holding translated
+messages.</font></p>
+      </li>
+      <li>
+        <p><font size="2">junit.jar &nbsp;&nbsp;&nbsp; <br>
+&nbsp;&nbsp;&nbsp; assertion-based test machinery.</font></p>
+      </li>
+    </ul>
+  </li>
+</ul>
+<p>For example:</p>
+<dl>
+  <dd>
+    <table border="1" cellpadding="2" cellspacing="2">
+      <tbody>
+        <tr>
+          <td>
+          <p><font size="2">(note that $jardir is only a convenience
+variable and that the set CLASSPATH command below has carriage returns
+for formatting reasons):<br>
+set jardir=/local/derbyjar<br>
+set
+CLASSPATH="$jardir/derby.jar:$jardir/derbytools.jar:$jardir/derbynet.jar:$jardir/derbyclient.jar:<br>
+$jardir/derbyTesting.jar:/local/derby/tools/java/jakarta-oro-2.0.8.jar:<br>
+$jardir/derbyLocale_de_DE.jar:$jardir/derbyLocale_es.jar:$jardir/derbyLocale_fr.jar:<br>
+$jardir/derbyLocale_it.jar:$jardir/derbyLocale_ja_JP.jar:$jardir/derbyLocale_ko_KR.jar:<br>
+$jardir/derbyLocale_pt_BR.jar:$jardir/derbyLocale_zh_CN.jar:$jardir/derbyLocale_zh_TW.jar:<br>
+$CLASSPATH</font><br>
+          <font size="2">set PATH=/local/jdk141/bin:$PATH</font></p>
+          </td>
+        </tr>
+      </tbody>
+    </table>
+  </dd>
+</dl>
+<p>To run 1 test: </p>
+<table border="1" cellpadding="2" cellspacing="2">
+  <tbody>
+    <tr>
+      <td>
+      <p>syntax:<br>
+&nbsp;&nbsp;&nbsp; <font size="2">java -D&lt;testproperty&gt;
+org.apache.derbyTesting.functionTests.harness.RunTest
+&lt;testdir&gt;/&lt;testname&gt;</font><br>
+      <font size="2">where </font> </p>
+      <ul>
+        <li>
+          <p style="margin-bottom: 0in;">&nbsp;&nbsp; <font size="2">&lt;testproperty&gt;
+are test specific properties, such as 'framework' for the RunTest
+class. </font> </p>
+        </li>
+        <li>
+          <p style="margin-bottom: 0in;">&nbsp;&nbsp; <font size="2">&lt;testdir&gt;
+is one of the directories under functionTests/tests where the actual
+test is located</font> </p>
+        </li>
+        <li>
+          <p>&nbsp;&nbsp; <font size="2">&lt;testname&gt; is the
+actual name of the test</font> </p>
+        </li>
+      </ul>
+      <p><font size="2">examples:<br>
+to run the test supersimple against the embedded driver:<br>
+      </font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font size="2">java
+org.apache.derbyTesting.functionTests.harness.RunTest
+lang/supersimple.sql<br>
+      <br>
+To run a test with network server, using the derbyclient driver, add
+-Dframework=DerbyNetClient to the run. The test harness will to start
+network server at port 1527 or connect to a running one, run the test,
+and stop network server thereafter.<br>
+for example:<br>
+&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; java -Dframework=DerbyNetClient
+org.apache.derbyTesting.functionTests.harness.RunTest
+lang/supersimple.sql</font></p>
+      </td>
+    </tr>
+  </tbody>
+</table>
+<p>A successful run will have a .pass file, and the output to the
 console will show no difference between expected and actual test
 result. A failed test run will have at least a .fail file and the
 output to the console will show the difference between expected and
-actual result.</P>
-<P>To run a suite: 
-</P>
-<TABLE BORDER=1 CELLPADDING=2 CELLSPACING=2>
-	<TR>
-		<TD>
-			<P>syntax:<BR>&nbsp; <FONT SIZE=2>java -D&lt;testproperty&gt;
-			org.apache.derbyTesting.functionTests.harness.RunSuite&nbsp;
-			&lt;testsuite&gt;</FONT><BR><FONT SIZE=2>where </FONT>
-			</P>
-			<UL>
-				<LI><P STYLE="margin-bottom: 0in">&nbsp;&nbsp; <FONT SIZE=2>&lt;testproperty&gt;
-				are test specific properties, such as 'verbose' for the RunSuite
-				class. </FONT>
-				</P>
-				<LI><P>&nbsp;&nbsp; <FONT SIZE=2>&lt;testsuite&gt; is one of the
-				suites under org/apache/derbyTesting/suites</FONT> 
-				</P>
-			</UL>
-			<P><FONT SIZE=2>for example for running&nbsp; the suite
-			derbylang:<BR></FONT>&nbsp;&nbsp; <FONT SIZE=2>java -Dverbose=true
-			org.apache.derbyTesting.functionTests.harness.RunSuite derbylang</FONT></P>
-		</TD>
-	</TR>
-</TABLE>
-<P>Each suite run should be started in a clean directory. The test
+actual result.</p>
+<p>To run a suite: </p>
+<table border="1" cellpadding="2" cellspacing="2">
+  <tbody>
+    <tr>
+      <td>
+      <p>syntax:<br>
+&nbsp; <font size="2">java -D&lt;testproperty&gt;
+org.apache.derbyTesting.functionTests.harness.RunSuite&nbsp;
+&lt;testsuite&gt;</font><br>
+      <font size="2">where </font> </p>
+      <ul>
+        <li>
+          <p style="margin-bottom: 0in;">&nbsp;&nbsp; <font size="2">&lt;testproperty&gt;
+are test specific properties, such as 'verbose' for the RunSuite class.
+          </font> </p>
+        </li>
+        <li>
+          <p>&nbsp;&nbsp; <font size="2">&lt;testsuite&gt; is one of
+the suites under org/apache/derbyTesting/suites</font> </p>
+        </li>
+      </ul>
+      <p><font size="2">for example for running&nbsp; the suite
+derbylang:<br>
+      </font>&nbsp;&nbsp; <font size="2">java -Dverbose=true
+org.apache.derbyTesting.functionTests.harness.RunSuite derbylang</font></p>
+      </td>
+    </tr>
+  </tbody>
+</table>
+<p>Each suite run should be started in a clean directory. The test
 output directory will not be emptied out before testing is begun,
 although individual test files and result files will be cleaned out
-and overwritten.&nbsp; 
-</P>
-<P>To run a suite with J2ME/CDC/Foundation: 
-</P>
-<TABLE BORDER=1 CELLPADDING=2 CELLSPACING=2>
-	<TR>
-		<TD>
-			<P><FONT SIZE=2>(note that the command below has carriage returns
-			for formatting reasons):<BR>syntax:<BR></FONT>&nbsp; <FONT SIZE=2>&lt;java&gt;
-			-Xbootclasspath/a:$jardir/&lt;jdbc_jar&gt;
-			-Dbootcp=$jardir/&lt;jdbc_jar&gt;
-			<BR>-Dij.dataSource=org.apache.derby.jdbc.EmbeddedSimpleDataSource
-			<BR>-Djvmflags=&quot;-Dij.dataSource=org.apache.derby.jdbc.EmbeddedSimpleDataSource&quot;
-			<BR>org.apache.derbyTesting.functionTests.harness.RunSuite&nbsp;
-			&lt;testsuite&gt;</FONT><BR><FONT SIZE=2>where </FONT>
-			</P>
-			<UL>
-				<LI><P STYLE="margin-bottom: 0in">&nbsp;&nbsp; <FONT SIZE=2>&lt;java&gt;
-				is the jvm with any jvm flags. For testing with CDC/Foundation
-				Profile using j9 jvm from IBM, this will be 'j9 -jcl:foun10'. </FONT>
-				</P>
-				<LI><P STYLE="margin-bottom: 0in">&nbsp;&nbsp; <FONT SIZE=2>&lt;jdbc_jar&gt;
-				is the jar file which implements the JDBC API for CDC/Foundation
-				Profile (JSR169). </FONT>
-				</P>
-				<LI><P>&nbsp;&nbsp; <FONT SIZE=2>&lt;testsuite&gt; is one of the
-				suites under org/apache/derbyTesting/suites</FONT> 
-				</P>
-			</UL>
-			<P><FONT SIZE=2>for example for running&nbsp; the suite
-			derbyall:<BR></FONT>&nbsp;&nbsp; <FONT SIZE=2>j9 -jcl:foun10
-			-Xbootclasspath/a:$jardir/jdbc.jar -Dbootcp=$jardir/jdbc.jar
-			<BR>-Dij.dataSource=org.apache.derby.jdbc.EmbeddedSimpleDataSource
-			<BR>-Djvmflags=&quot;-Dij.dataSource=org.apache.derby.jdbc.EmbeddedSimpleDataSource&quot;
-			<BR>org.apache.derbyTesting.functionTests.harness.RunSuite
-			derbyall</FONT></P>
-		</TD>
-	</TR>
-</TABLE>
-<P>The suites provided are: 
-</P>
-<UL>
-	<LI><P STYLE="margin-bottom: 0in">derbylang: 
-	</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">basic functionality of&nbsp;
-		language implementation in derby. 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">Mostly .sql type tests. 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">tested on a variety of hardware
-		takes from 1.15m to 2.00 hours</P>
-	</UL>
-	<LI><P STYLE="margin-bottom: 0in">derbynetclientmats 
-	</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">basic network server tests using
-		the derby client</P>
-		<LI><P STYLE="margin-bottom: 0in">variety of tests, including some
-		from derbylang suite 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">tested on a variety of hardware
-		takes from 15 to 30 minutes 
-		</P>
-	</UL>
-	<LI><P STYLE="margin-bottom: 0in">derbynetmats 
-	</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">basic network server tests using
-		the IBM Universal JDBC driver</P>
-		<LI><P STYLE="margin-bottom: 0in">variety of tests, including some
-		from derbylang suite 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">tested on a variety of hardware
-		takes from 15 to 30 minutes 
-		</P>
-	</UL>
-	<LI><P STYLE="margin-bottom: 0in">derbynetautostart 
-	</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">tests network server
-		functionality without requiring network server framework</P>
-	</UL>
-	<LI><P STYLE="margin-bottom: 0in">propertyinfo 
-	</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">runs test to get property
-		information</P>
-	</UL>
-	<LI><P STYLE="margin-bottom: 0in">storeall 
-	</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">tests for storage area 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">includes: 
-		</P>
-		<UL>
-			<LI><P STYLE="margin-bottom: 0in">storemats: most basic quick
-			verification tests.</P>
-			<LI><P STYLE="margin-bottom: 0in">storemore: more extensive
-			storage tests 
-			</P>
-			<LI><P STYLE="margin-bottom: 0in">storetests: set of store tests
-			grouped together because they do not each need to create a new
-			database 
-			</P>
-		</UL>
-		<LI><P STYLE="margin-bottom: 0in">tested on a variety of hardware
-		takes from 25 to 50 minutes</P>
-	</UL>
-	<LI><P STYLE="margin-bottom: 0in">xa 
-	</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">tests the xa implementation.
-		There is both a storage and language element to these tests 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">tested on a variety of hardware
-		takes from 2 to 4 minutes</P>
-	</UL>
-	<LI><P STYLE="margin-bottom: 0in">storeunit 
-	</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">tests store-related unit tests.
-		Runs from 8 to 15 minutes</P>
-	</UL>
-	<LI><P STYLE="margin-bottom: 0in">unit 
-	</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">tests 4 general functionality
-		unit tests. runs from 5 to 10 minutes</P>
-	</UL>
-	<LI><P STYLE="margin-bottom: 0in">jdbcapi 
-	</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">tests implementation of jdbc api
-		such as Connection class implementation, Metadata etc. 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">takes from 20 to 40 minutes</P>
-	</UL>
-	<LI><P STYLE="margin-bottom: 0in">jdbc20</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">tests implementation of features
-		from the jdbc 20 specification 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">takes 2 to 5 minutes</P>
-	</UL>
-	<LI><P STYLE="margin-bottom: 0in">jdk14 
-	</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">tests implementation of features
-		from the jdk14 specification 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">takes 2 to 5 minutes</P>
-	</UL>
-	<LI><P STYLE="margin-bottom: 0in">demo, simpledemo</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">tests the SimpleApp example 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">simpledemo runs SimpleApp itself
-		- and thus has a different default resource package name (namely,
-		no package) than all the other tests. Hence it needed its own
-		suite.properties file. 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">takes 30 to 1 minute 
-		</P>
-	</UL>
-	<LI><P STYLE="margin-bottom: 0in">nist 
-	</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">test obtained from the NIST SQL
-		suite v 6.0 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">takes 5 to 10 minutes</P>
-	</UL>
-	<LI><P STYLE="margin-bottom: 0in">encryptionAll 
-	</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">takes 30 to 55 minutes 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">runs a few encryption tests plus
-		the following encryption tests suites</P>
-		<UL>
-			<LI><P STYLE="margin-bottom: 0in">encryption 
-			</P>
-			<UL>
-				<LI><P STYLE="margin-bottom: 0in">runs the storemats, sysinfo and
-				multi suites in encryption scheme DESede</P>
-				<LI><P STYLE="margin-bottom: 0in">takes 25 to 40 minutes 
-				</P>
-			</UL>
-			<LI><P STYLE="margin-bottom: 0in">encryptionAES - tests AES
-			encryption scheme</P>
-			<LI><P STYLE="margin-bottom: 0in">encryptionBlowfish - tests
-			Blowfish encryption scheme</P>
-			<LI><P STYLE="margin-bottom: 0in">encryptionCFB - tests CFB
-			encryption scheme</P>
-			<LI><P STYLE="margin-bottom: 0in">encryptionDES - tests DES
-			encryption scheme</P>
-			<LI><P STYLE="margin-bottom: 0in">encryptionECB - tests ECB
-			encryption scheme</P>
-			<LI><P STYLE="margin-bottom: 0in">encryptionOFB - tests OFB
-			encryption scheme 
-			</P>
-		</UL>
-	</UL>
-	<LI><P STYLE="margin-bottom: 0in">multi 
-	</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">runs a simple test case with 10
-		threads 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">runs for 10 minutes, then shuts
-		down all threads</P>
-	</UL>
-	<LI><P STYLE="margin-bottom: 0in">derbytools</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">tests for dblook, ij, and
-		import/export utilities 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">takes 5 to 10 minutes</P>
-	</UL>
-	<LI><P STYLE="margin-bottom: 0in">i18nTest 
-	</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">tests that characters outside
-		simple ascii scope do not result in errors. 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">takes 5 to 10 minutes</P>
-	</UL>
-	<LI><P STYLE="margin-bottom: 0in">derbyall 
-	</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">contains all suites typically run
-		by all developers</P>
-		<LI><P STYLE="margin-bottom: 0in">tested on a variety of hardware
-		takes from 3.00 - 6.00 hours 
-		</P>
-	</UL>
-	<LI><P STYLE="margin-bottom: 0in">largeData</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">Contains tests that deal with
-		large amounts of data and thus require more machine resources.&nbsp;
-		This suite is NOT run as part of 'derbyall' because the tests it
-		contains require either 1) more machine resources than what the
-		typical Derby developer might have, and/or 2) a significant amount
-		of time to run, and thus shouldn't be run every night.</P>
-		<LI><P STYLE="margin-bottom: 0in">As tests are added to this quite,
-		it could require more and more time to run (several minutes to
-		several hours to several days), which is why it is NOT included as
-		part of the derbyall suite.</P>
-	</UL>
-	<LI><P><A HREF="#Note2:"><FONT SIZE=2>See Note2</FONT></A></P>
-</UL>
-<P>A successful run with all tests passing will have no *.fail files
+and overwritten.&nbsp; </p>
+<p>To run a suite with J2ME/CDC/Foundation: </p>
+<table border="1" cellpadding="2" cellspacing="2">
+  <tbody>
+    <tr>
+      <td>
+      <p><font size="2">(note that the command below has carriage
+returns for formatting reasons):<br>
+syntax:<br>
+      </font>&nbsp; <font size="2">&lt;java&gt;
+-Xbootclasspath/a:$jardir/&lt;jdbc_jar&gt;
+-Dbootcp=$jardir/&lt;jdbc_jar&gt; <br>
+-Dij.dataSource=org.apache.derby.jdbc.EmbeddedSimpleDataSource <br>
+-Djvmflags="-Dij.dataSource=org.apache.derby.jdbc.EmbeddedSimpleDataSource"
+      <br>
+org.apache.derbyTesting.functionTests.harness.RunSuite&nbsp;
+&lt;testsuite&gt;</font><br>
+      <font size="2">where </font> </p>
+      <ul>
+        <li>
+          <p style="margin-bottom: 0in;">&nbsp;&nbsp; <font size="2">&lt;java&gt;
+is the jvm with any jvm flags. For testing with CDC/Foundation Profile
+using j9 jvm from IBM, this will be 'j9 -jcl:foun10'. </font> </p>
+        </li>
+        <li>
+          <p style="margin-bottom: 0in;">&nbsp;&nbsp; <font size="2">&lt;jdbc_jar&gt;
+is the jar file which implements the JDBC API for CDC/Foundation
+Profile (JSR169). </font> </p>
+        </li>
+        <li>
+          <p>&nbsp;&nbsp; <font size="2">&lt;testsuite&gt; is one of
+the suites under org/apache/derbyTesting/suites</font> </p>
+        </li>
+      </ul>
+      <p><font size="2">for example for running&nbsp; the suite
+derbyall:<br>
+      </font>&nbsp;&nbsp; <font size="2">j9 -jcl:foun10
+-Xbootclasspath/a:$jardir/jdbc.jar -Dbootcp=$jardir/jdbc.jar <br>
+-Dij.dataSource=org.apache.derby.jdbc.EmbeddedSimpleDataSource <br>
+-Djvmflags="-Dij.dataSource=org.apache.derby.jdbc.EmbeddedSimpleDataSource"
+      <br>
+org.apache.derbyTesting.functionTests.harness.RunSuite derbyall</font></p>
+      </td>
+    </tr>
+  </tbody>
+</table>
+<p>The suites provided are: </p>
+<ul>
+  <li>
+    <p style="margin-bottom: 0in;">derbylang: </p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">basic functionality of&nbsp;
+language implementation in derby. </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">Mostly .sql type tests. </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">tested on a variety of hardware
+takes from 1.15m to 2.00 hours</p>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">derbynetclientmats </p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">basic network server tests using
+the derby client</p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">variety of tests, including some
+from derbylang suite </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">tested on a variety of hardware
+takes from 15 to 30 minutes </p>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">derbynetmats </p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">basic network server tests using
+the IBM Universal JDBC driver</p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">variety of tests, including some
+from derbylang suite </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">tested on a variety of hardware
+takes from 15 to 30 minutes </p>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">derbynetautostart </p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">tests network server
+functionality without requiring network server framework</p>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">propertyinfo </p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">runs test to get property
+information</p>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">storeall </p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">tests for storage area </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">includes: </p>
+        <ul>
+          <li>
+            <p style="margin-bottom: 0in;">storemats: most basic quick
+verification tests.</p>
+          </li>
+          <li>
+            <p style="margin-bottom: 0in;">storemore: more extensive
+storage tests </p>
+          </li>
+          <li>
+            <p style="margin-bottom: 0in;">storetests: set of store
+tests grouped together because they do not each need to create a new
+database </p>
+          </li>
+        </ul>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">tested on a variety of hardware
+takes from 25 to 50 minutes</p>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">xa </p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">tests the xa implementation.
+There is both a storage and language element to these tests </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">tested on a variety of hardware
+takes from 2 to 4 minutes</p>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">storeunit </p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">tests store-related unit tests.
+Runs from 8 to 15 minutes</p>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">unit </p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">tests 4 general functionality
+unit tests. runs from 5 to 10 minutes</p>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">jdbcapi </p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">tests implementation of jdbc api
+such as Connection class implementation, Metadata etc. </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">takes from 20 to 40 minutes</p>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">jdbc20</p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">tests implementation of features
+from the jdbc 20 specification </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">takes 2 to 5 minutes</p>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">jdk14 </p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">tests implementation of features
+from the jdk14 specification </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">takes 2 to 5 minutes</p>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">demo, simpledemo</p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">tests the SimpleApp example </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">simpledemo runs SimpleApp itself
+- and thus has a different default resource package name (namely, no
+package) than all the other tests. Hence it needed its own
+suite.properties file. </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">takes 30 to 1 minute </p>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">nist </p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">test obtained from the NIST SQL
+suite v 6.0 </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">takes 5 to 10 minutes</p>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">encryptionAll </p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">takes 30 to 55 minutes </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">runs a few encryption tests plus
+the following encryption tests suites</p>
+        <ul>
+          <li>
+            <p style="margin-bottom: 0in;">encryption </p>
+            <ul>
+              <li>
+                <p style="margin-bottom: 0in;">runs the storemats,
+sysinfo and multi suites in encryption scheme DESede</p>
+              </li>
+              <li>
+                <p style="margin-bottom: 0in;">takes 25 to 40 minutes </p>
+              </li>
+            </ul>
+          </li>
+          <li>
+            <p style="margin-bottom: 0in;">encryptionAES - tests AES
+encryption scheme</p>
+          </li>
+          <li>
+            <p style="margin-bottom: 0in;">encryptionBlowfish - tests
+Blowfish encryption scheme</p>
+          </li>
+          <li>
+            <p style="margin-bottom: 0in;">encryptionCFB - tests CFB
+encryption scheme</p>
+          </li>
+          <li>
+            <p style="margin-bottom: 0in;">encryptionDES - tests DES
+encryption scheme</p>
+          </li>
+          <li>
+            <p style="margin-bottom: 0in;">encryptionECB - tests ECB
+encryption scheme</p>
+          </li>
+          <li>
+            <p style="margin-bottom: 0in;">encryptionOFB - tests OFB
+encryption scheme </p>
+          </li>
+        </ul>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">multi </p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">runs a simple test case with 10
+threads </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">runs for 10 minutes, then shuts
+down all threads</p>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">derbytools</p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">tests for dblook, ij, and
+import/export utilities </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">takes 5 to 10 minutes</p>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">i18nTest </p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">tests that characters outside
+simple ascii scope do not result in errors. </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">takes 5 to 10 minutes</p>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">derbyall </p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">contains all suites typically
+run by all developers</p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">tested on a variety of hardware
+takes from 3.00 - 6.00 hours </p>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">largeData</p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">Contains tests that deal with
+large amounts of data and thus require more machine resources.&nbsp;
+This suite is NOT run as part of 'derbyall' because the tests it
+contains require either 1) more machine resources than what the typical
+Derby developer might have, and/or 2) a significant amount of time to
+run, and thus shouldn't be run every night.</p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">As tests are added to this
+quite, it could require more and more time to run (several minutes to
+several hours to several days), which is why it is NOT included as part
+of the derbyall suite.</p>
+      </li>
+    </ul>
+  </li>
+  <li>
+    <p><a href="#Note2:"><font size="2">See Note2</font></a></p>
+  </li>
+</ul>
+<p>A successful run with all tests passing will have no *.fail files
 created, the &lt;testsuite&gt;_fail.txt file will be empty, and the
 &lt;testsuite&gt;_report.txt file will show no failures in the
-Summary results section. 
-</P>
-<TABLE BORDER=1 CELLPADDING=2 CELLSPACING=2>
-	<TR>
-		<TD>
-			<P><FONT SIZE=2>-------snippet from derbylang_report.txt
-			-----<BR>-----------------------------------------------------------<BR>Summary
-			results:<BR><BR>Test Run Started: 2004-11-10 11:27:55.0<BR>Test
-			Run Duration: 00:04:09<BR><BR>129 Tests Run<BR>100% Pass (129
-			tests passed)<BR>&nbsp;0% Fail (0 tests failed)<BR>0 Suites
-			skipped</FONT></P>
-		</TD>
-	</TR>
-</TABLE>
-<P><BR><BR>
-</P>
-<H3><A NAME="building_derbyTesting__running_with"></A>2.2 building
-derbyTesting package</H3>
-<P>To build the derbyTesting package:</P>
-<UL>
-	<LI><P>follow all the steps in the derby <A HREF="http://svn.apache.org/repos/asf/db/derby/code/trunk/BUILDING.txt">BUILDING.txt</A>.
-		</P>
-</UL>
-<P>This is some typical output for the ant build process.</P>
-<TABLE BORDER=1 CELLPADDING=2 CELLSPACING=2>
-	<TR>
-		<TD>
-			<P><FONT SIZE=2>&gt; cd /local/derby/java/testing<BR>&gt;
-			ant.ksh<BR>Searching for build.xml ...<BR>Buildfile:
-			/local/derby/java/testing/build.xml<BR><BR>compile:<BR>&nbsp;&nbsp;&nbsp;
-			[javac] Compiling 30 source files to /local/derby/classes<BR>...<BR>&nbsp;&nbsp;&nbsp;&nbsp;
-			[copy] Copying 1 file to
-			/local/derby/classes/org/apache/derbyTesting/funct<BR>ionTests<BR><BR>BUILD
-			SUCCESSFUL<BR>Total time: 10 minutes 3 seconds</FONT></P>
-		</TD>
-	</TR>
-</TABLE>
-<P>Building using the ant all target places all files, that is,
+Summary results section. </p>
+<table border="1" cellpadding="2" cellspacing="2">
+  <tbody>
+    <tr>
+      <td>
+      <p><font size="2">-------snippet from derbylang_report.txt -----<br>
+-----------------------------------------------------------<br>
+Summary results:<br>
+      <br>
+Test Run Started: 2004-11-10 11:27:55.0<br>
+Test Run Duration: 00:04:09<br>
+      <br>
+129 Tests Run<br>
+100% Pass (129 tests passed)<br>
+&nbsp;0% Fail (0 tests failed)<br>
+0 Suites skipped</font></p>
+      </td>
+    </tr>
+  </tbody>
+</table>
+<p><br>
+<br>
+</p>
+<h3><a name="building_derbyTesting__running_with"></a>2.2 building
+derbyTesting package</h3>
+<p>To build the derbyTesting package:</p>
+<ul>
+  <li>
+    <p>follow all the steps in the derby <a
+ href="http://svn.apache.org/repos/asf/db/derby/code/trunk/BUILDING.txt">BUILDING.txt</a>.
+    </p>
+  </li>
+</ul>
+<p>This is some typical output for the ant build process.</p>
+<table border="1" cellpadding="2" cellspacing="2">
+  <tbody>
+    <tr>
+      <td>
+      <p><font size="2">&gt; cd /local/derby/java/testing<br>
+&gt; ant.ksh<br>
+Searching for build.xml ...<br>
+Buildfile: /local/derby/java/testing/build.xml<br>
+      <br>
+compile:<br>
+&nbsp;&nbsp;&nbsp; [javac] Compiling 30 source files to
+/local/derby/classes<br>
+...<br>
+&nbsp;&nbsp;&nbsp;&nbsp; [copy] Copying 1 file to
+/local/derby/classes/org/apache/derbyTesting/funct<br>
+ionTests<br>
+      <br>
+BUILD SUCCESSFUL<br>
+Total time: 10 minutes 3 seconds</font></p>
+      </td>
+    </tr>
+  </tbody>
+</table>
+<p>Building using the ant all target places all files, that is,
 classes, but also supporting files such as expected output (*.out),
 sql test files (*.sql), properties files and any data files used in
 individual tests into the classes directory so they can all be found
-using the CLASSPATH. 
-</P>
-<P>Once you have built the derbyTesting package, you can make a
+using the CLASSPATH. </p>
+<p>Once you have built the derbyTesting package, you can make a
 derbyTesting.jar using the jar build target at the
-${derby.source}level. 
-</P>
-<P>This will look something like: 
-</P>
-<TABLE BORDER=1 CELLPADDING=2 CELLSPACING=2>
-	<TR>
-		<TD>
-			<P><FONT SIZE=2>c:&gt; ant derbytestingjar<BR>Searching for
-			build.xml ...<BR>Buildfile: C:\derby\build.xml<BR><BR>initjars:<BR>&nbsp;&nbsp;&nbsp;
-			[mkdir] Created dir: C:\derby\jars\<BR>&nbsp;&nbsp;&nbsp; [mkdir]
-			Created dir: C:\derby\jars\lists<BR>&nbsp;&nbsp;&nbsp;&nbsp;
-			[echo] Revision number set to exported<BR>&nbsp;&nbsp;&nbsp;&nbsp;
-			[echo] .<BR><BR>derbytestingjar:<BR>&nbsp;&nbsp;&nbsp;&nbsp;
-			[echo] Beginning derbytesting.jar build<BR>.....<BR>BUILD
-			SUCCESSFULL</FONT></P>
-		</TD>
-	</TR>
-</TABLE>
-<P><BR><BR>
-</P>
-<H2><A NAME="mozTocId582299"></A><A NAME="run"></A>3. More details on
-running the derby functional tests</H2>
-<P>The functional tests are run using a class called 'RunTest'. This
+${derby.source}level. </p>
+<p>This will look something like: </p>
+<table border="1" cellpadding="2" cellspacing="2">
+  <tbody>
+    <tr>
+      <td>
+      <p><font size="2">c:&gt; ant derbytestingjar<br>
+Searching for build.xml ...<br>
+Buildfile: C:\derby\build.xml<br>
+      <br>
+initjars:<br>
+&nbsp;&nbsp;&nbsp; [mkdir] Created dir: C:\derby\jars\<br>
+&nbsp;&nbsp;&nbsp; [mkdir] Created dir: C:\derby\jars\lists<br>
+&nbsp;&nbsp;&nbsp;&nbsp; [echo] Revision number set to exported<br>
+&nbsp;&nbsp;&nbsp;&nbsp; [echo] .<br>
+      <br>
+derbytestingjar:<br>
+&nbsp;&nbsp;&nbsp;&nbsp; [echo] Beginning derbytesting.jar build<br>
+.....<br>
+BUILD SUCCESSFULL</font></p>
+      </td>
+    </tr>
+  </tbody>
+</table>
+<p><br>
+<br>
+</p>
+<h2><a name="mozTocId582299"></a><a name="run"></a>3. More details on
+running the derby functional tests</h2>
+<p>The functional tests are run using a class called 'RunTest'. This
 class calls a number of other classes. A group of tests, called a
-'suite' is executed using a class called 'RunSuite'.</P>
-<H3><A NAME="mozTocId595945"></A><A NAME="run1"></A>3.1 Running 1
-test</H3>
-<P>See section 2.1 for the basic steps to run 1 test. 
-</P>
-<P>To pass on system level properties to the test harness, use the
+'suite' is executed using a class called 'RunSuite'.</p>
+<h3><a name="mozTocId595945"></a><a name="run1"></a>3.1 Running 1
+test</h3>
+<p>See section 2.1 for the basic steps to run 1 test. </p>
+<p>To pass on system level properties to the test harness, use the
 test harness property -DtestSpecialProps. For example, to ensure
-extra information is appended to the log:&nbsp;</P>
-<TABLE BORDER=1 CELLPADDING=2 CELLSPACING=2>
-	<TR>
-		<TD>
-			<P><FONT SIZE=2>java -Dframework=DerbyNetClient
-			-DtestSpecialProps=derby.infolog.append=true&nbsp;
-			org.apache.derbyTesting.functionTests.harness.RunTest
-			lang/supersimple.sql</FONT></P>
-		</TD>
-	</TR>
-</TABLE>
-<P><BR>Tests will be executed in the current directory. When running
+extra information is appended to the log:&nbsp;</p>
+<table border="1" cellpadding="2" cellspacing="2">
+  <tbody>
+    <tr>
+      <td>
+      <p><font size="2">java -Dframework=DerbyNetClient
+-DtestSpecialProps=derby.infolog.append=true&nbsp;
+org.apache.derbyTesting.functionTests.harness.RunTest
+lang/supersimple.sql</font></p>
+      </td>
+    </tr>
+  </tbody>
+</table>
+<p><br>
+Tests will be executed in the current directory. When running
 a test using the network server and derby client, i.e.
 -Dframework=DerbyNetClient, the test will run in a subdirectory
-(automatically created) 'DerbyNetClient'. 
-</P>
-<P>The test will normally create the following:</P>
-<UL>
-	<LI><P STYLE="margin-bottom: 0in">a database. The default name is
-	'wombat'. However, the name may be different depending on certain
-	properties passed in to the test harness. 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">a .out file: the final result file
-		</P>
-	<LI><P STYLE="margin-bottom: 0in">a .tmp file; the initial result
-	file, before any modification to prevent irrelevant differences has
-	been applied (before 'masking'). 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">a .diff file; the differences
-	between the .out and the master file with expected output it is
-	compared to. 
-	</P>
-	<LI><P>a .pass or .fail file. This file lists the test if it passes
-	under .pass, and under .fail if the output in .out is different from
-	the expected output in the master. 
-	</P>
-</UL>
-<P>possibly created:</P>
-<UL>
-	<LI><P STYLE="margin-bottom: 0in">additional files used in a
-	specific test may get copied over to the test directory. These
-	normally do not get cleaned up. 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">.tmpstr file is created for
-	network server tests and is a possibly massaged copy of the master
-	file the output needs to be compared with. 
-	</P>
-	<LI><P>.err and .out files in network server database files for any
-	additional error output. 
-	</P>
-</UL>
-<P>When the test is successful, cleanup will occur unless the test
+(automatically created) 'DerbyNetClient'. </p>
+<p>The test will normally create the following:</p>
+<ul>
+  <li>
+    <p style="margin-bottom: 0in;">a database. The default name is
+'wombat'. However, the name may be different depending on certain
+properties passed in to the test harness. </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">a .out file: the final result file </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">a .tmp file; the initial result
+file, before any modification to prevent irrelevant differences has
+been applied (before 'masking'). </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">a .diff file; the differences
+between the .out and the master file with expected output it is
+compared to. </p>
+  </li>
+  <li>
+    <p>a .pass or .fail file. This file lists the test if it passes
+under .pass, and under .fail if the output in .out is different from
+the expected output in the master. </p>
+  </li>
+</ul>
+<p>possibly created:</p>
+<ul>
+  <li>
+    <p style="margin-bottom: 0in;">additional files used in a specific
+test may get copied over to the test directory. These normally do not
+get cleaned up. </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">.tmpstr file is created for network
+server tests and is a possibly massaged copy of the master file the
+output needs to be compared with. </p>
+  </li>
+  <li>
+    <p>.err and .out files in network server database files for any
+additional error output. </p>
+  </li>
+</ul>
+<p>When the test is successful, cleanup will occur unless the test
 harness property -Dkeepfiles=true is used. Cleanup will attempt to
-cleanup all files except for .pass. <FONT SIZE=2><BR><A HREF="#Note3:">See
-Note3.</A></FONT> 
-</P>
-<P>A successful run (this example is from a dos environment) would
-look for instance like: 
-</P>
-<TABLE BORDER=1 CELLPADDING=2 CELLSPACING=2>
-	<TR>
-		<TD>
-			<P><FONT SIZE=2>c:&gt; derbyTesting.functionTests.harness.RunTest
-			lang/supersimple.sql<BR>C:\derby\run2<BR>supersimple<BR>-- listing
-			properties
-			--<BR>derby.locks.deadlockTimeout=3<BR>derby.locks.waitTimeout=3<BR>***
-			Start: supersimple jdk1.4.2_03 2004-11-10 16:51:02 ***<BR>The test
-			should be running...<BR>MasterFileName =
-			master/supersimple.out<BR>*** End:&nbsp;&nbsp; supersimple
-			jdk1.4.2_03 2004-11-10 16:51:25 ***</FONT></P>
-		</TD>
-	</TR>
-</TABLE>
-<P><BR><BR>
-</P>
-<P>A Test Failure shows the diff, creates a .fail file, does not
+cleanup all files except for .pass. <font size="2"><br>
+<a href="#Note3:">See
+Note3.</a></font> </p>
+<p>A successful run (this example is from a dos environment) would
+look for instance like: </p>
+<table border="1" cellpadding="2" cellspacing="2">
+  <tbody>
+    <tr>
+      <td>
+      <p><font size="2">c:&gt;
+derbyTesting.functionTests.harness.RunTest lang/supersimple.sql<br>
+C:\derby\run2<br>
+supersimple<br>
+-- listing properties --<br>
+derby.locks.deadlockTimeout=3<br>
+derby.locks.waitTimeout=3<br>
+*** Start: supersimple jdk1.4.2_03 2004-11-10 16:51:02 ***<br>
+The test should be running...<br>
+MasterFileName = master/supersimple.out<br>
+*** End:&nbsp;&nbsp; supersimple jdk1.4.2_03 2004-11-10 16:51:25 ***</font></p>
+      </td>
+    </tr>
+  </tbody>
+</table>
+<p><br>
+<br>
+</p>
+<p>A Test Failure shows the diff, creates a .fail file, does not
 create a .pass file, and does not cleanup any files upon completion.
-The output might look like this:</P>
-<TABLE BORDER=1 CELLPADDING=2 CELLSPACING=2>
-	<TR>
-		<TD>
-			<P>&nbsp;<FONT SIZE=2>c:&gt;
-			derbyTesting.functionTests.harness.RunTest
-			lang/supersimple.sql<BR>C:\derby\run2<BR>supersimple<BR>-- listing
-			properties
-			--<BR>derby.locks.deadlockTimeout=3<BR>derby.locks.waitTimeout=3<BR>***
-			Start: supersimple jdk1.4.2_03 2004-11-10 16:54:39 ***<BR>The test
-			should be running...<BR>MasterFileName = master/supersimple.out<BR>10
-			del<BR>&lt; 10<BR>10a10<BR>&gt; 1<BR>Test Failed.<BR>*** End:&nbsp;&nbsp;
-			supersimple jdk1.4.2_03 2004-11-10 16:55:02 ***</FONT></P>
-		</TD>
-	</TR>
-</TABLE>
-<P><BR><BR>
-</P>
-<H3><A NAME="mozTocId368566"></A><A NAME="run2"></A>3.2 Running a
-suite of tests</H3>
-<P>See section 2.1 for a basic explanation on how to run a suite of
-tests.</P>
-<P>Tests will be run in a subdirectory with the name of the test
+The output might look like this:</p>
+<table border="1" cellpadding="2" cellspacing="2">
+  <tbody>
+    <tr>
+      <td>
+      <p>&nbsp;<font size="2">c:&gt;
+derbyTesting.functionTests.harness.RunTest lang/supersimple.sql<br>
+C:\derby\run2<br>
+supersimple<br>
+-- listing properties --<br>
+derby.locks.deadlockTimeout=3<br>
+derby.locks.waitTimeout=3<br>
+*** Start: supersimple jdk1.4.2_03 2004-11-10 16:54:39 ***<br>
+The test should be running...<br>
+MasterFileName = master/supersimple.out<br>
+10 del<br>
+&lt; 10<br>
+10a10<br>
+&gt; 1<br>
+Test Failed.<br>
+*** End:&nbsp;&nbsp; supersimple jdk1.4.2_03 2004-11-10 16:55:02 ***</font></p>
+      </td>
+    </tr>
+  </tbody>
+</table>
+<p><br>
+<br>
+</p>
+<h3><a name="mozTocId368566"></a><a name="run2"></a>3.2 Running a
+suite of tests</h3>
+<p>See section 2.1 for a basic explanation on how to run a suite of
+tests.</p>
+<p>Tests will be run in a subdirectory with the name of the test
 suite under the current directory. Eg. for derbylang suite, a
 directory derbylang will be created. While the tests are run,
 information about the run is inserted into a &lt;testsuite&gt;.sum
@@ -684,172 +934,206 @@ file. When all tests have completed summary files are created
 created as well as a &lt;testsuite&gt;_report.txt with additional
 details. Some of the information is duplicate. Also, a .skip file
 will be created holding a list of the tests that were skipped (for
-more details on this, see the section on <A HREF="#skipping">skipping
-tests</A>). 
-</P>
-<P>RunSuite does not empty the top level directory before running.
+more details on this, see the section on <a href="#skipping">skipping
+tests</a>). </p>
+<p>RunSuite does not empty the top level directory before running.
 Thus, if another suite was run in the same directory at an earlier
 time, the resulting summary files might contain results for more than
 the current run. Therefore it is important to run each suite in a
-clean directory. 
-</P>
-<P>Sample output from RunSuite:</P>
-<TABLE BORDER=1 CELLPADDING=2 CELLSPACING=2>
-	<TR>
-		<TD>
-			<P><FONT SIZE=1>c:&gt; $ java
-			org.apache.derbyTesting.functionTests.harness.RunSuite
-			derbylang<BR>Top suite: derbylang<BR>Suite to run:
-			derbylang:derbylang<BR>Now do RunList<BR>Now run the suite's
-			tests<BR>Run the tests...<BR>Execute command: java -DjavaCmd=java
-			-Doutputdir=C:\derbyt1\derbylang\derbylang
-			-Dtopsuitedir=C:\derbyt1\derbylang
-			-Dtoprepo<BR>rtdir=C:\derbyt1\derbylang -Drundir=C:\derbyt1
-			-Dsuitename=derbylang:derbylang -Dtopsuitename=derbylang
-			org.apache.derbyTesting.functionTests.harness.RunTest
-			lang/altertable.sql<BR>Execute command: java -DjavaCmd=java
-			-Doutputdir=C:\derbyt1\derbylang\derbylang
-			-Dtopsuitedir=C:\derbyt1\derbylang
-			-Dtopreportdir=C:\derbyt1\derbylang -Drundir=C:\derbyt1
-			-Dsuitename=derbylang:derbylang -Dtopsuitename=derbylang
-			org.apache.derbyTesting.functionTests.harness.RunTest
-			lang/arithmetic.sql<BR>...(.more tests)....<BR>Generated report:
-			derbylang_report.txt</FONT></P>
-		</TD>
-	</TR>
-</TABLE>
-<P>This output does not show whether the tests passed or failed. The
+clean directory. </p>
+<p>Sample output from RunSuite:</p>
+<table border="1" cellpadding="2" cellspacing="2">
+  <tbody>
+    <tr>
+      <td>
+      <p><font size="1">c:&gt; $ java
+org.apache.derbyTesting.functionTests.harness.RunSuite derbylang<br>
+Top suite: derbylang<br>
+Suite to run: derbylang:derbylang<br>
+Now do RunList<br>
+Now run the suite's tests<br>
+Run the tests...<br>
+Execute command: java -DjavaCmd=java
+-Doutputdir=C:\derbyt1\derbylang\derbylang
+-Dtopsuitedir=C:\derbyt1\derbylang -Dtoprepo<br>
+rtdir=C:\derbyt1\derbylang -Drundir=C:\derbyt1
+-Dsuitename=derbylang:derbylang -Dtopsuitename=derbylang
+org.apache.derbyTesting.functionTests.harness.RunTest
+lang/altertable.sql<br>
+Execute command: java -DjavaCmd=java
+-Doutputdir=C:\derbyt1\derbylang\derbylang
+-Dtopsuitedir=C:\derbyt1\derbylang -Dtopreportdir=C:\derbyt1\derbylang
+-Drundir=C:\derbyt1 -Dsuitename=derbylang:derbylang
+-Dtopsuitename=derbylang
+org.apache.derbyTesting.functionTests.harness.RunTest
+lang/arithmetic.sql<br>
+...(.more tests)....<br>
+Generated report: derbylang_report.txt</font></p>
+      </td>
+    </tr>
+  </tbody>
+</table>
+<p>This output does not show whether the tests passed or failed. The
 Summary section in &lt;testsuite&gt;_report.txt shows the statistics
 of the passed vs. failed tests, the summary &lt;testsuite&gt;_*.txt
-files list the tests that passed and failed. 
-</P>
-<P><BR><BR>
-</P>
-<H2><A NAME="mozTocId635355"></A><A NAME="overview"></A>4. Harness
-internals for developers</H2>
-<P>The following is intended for people who have the subversion tree
-available and want to add or modify tests. 
-</P>
-<P>The test harness executing one test basically does the following
-in sequence: 
-</P>
-<UL>
-	<LI><P STYLE="margin-bottom: 0in">identify test to run 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">identify properties to run with 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">copy needed support files 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">find the expected output 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">if network server, start network
-	server 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">run the test, creating the
-	database 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">if network server, shutdown the
-	server 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">modify the output based on Sed
-	class and _sed.properties file for the test 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">compare expected output with
-	actual output 
-	</P>
-	<LI><P>if pass, cleanup. 
-	</P>
-</UL>
-<P><BR><BR>
-</P>
-<H3><A NAME="mozTocId344499"></A><A NAME="ov1"></A>4.1 Test types</H3>
-<P>The test harness recognizes, or will recognize tests with the
-following extensions:</P>
-<UL>
-	<LI><P STYLE="margin-bottom: 0in">&nbsp;.java&nbsp;&nbsp;&nbsp;
-	tests that run in a separate jvm. 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">&nbsp;.sql &nbsp;&nbsp;&nbsp;
-	tests that run using ij 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">&nbsp;.sql2 &nbsp;&nbsp;&nbsp;
-	related to .sql 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">&nbsp;.multi &nbsp;&nbsp;&nbsp;
-	multi threaded tests. There is currently only 1 test being run. The
-	multi test functions a little differently from .java and .sql* tests
-	in that RunTest starts a separate harness class called MultiTest to
-	control the details of the run. Also, the actual test files live
-	under org/apache/derbyTesting/functionTests/multiTests, rather than
-	org/apache/derbyTesting/functionTests/tests. 
-	</P>
-	<LI><P>&nbsp;.unit &nbsp;&nbsp;&nbsp; unit tests. The unit tests
-	actually refer to &lt;testname&gt;_derby.properties files under
-	org/apache/derbyTesting/functionTests/tests/unit that activate the
-	actual unit test harness and tests under
-	org/apache/derbyTesting/unitTests. These tests test more underlying
-	functionality than the (rest of the) functionTests, which are more
-	geared toward how end-users might use functionality.</P>
-</UL>
-<P><BR><BR>
-</P>
-<H3><A NAME="mozTocId809770"></A><A NAME="ov2"></A>4.2 Supporting
-files for tests</H3>
-<P>Various additional files may be used by a test, for instance, to
+files list the tests that passed and failed. </p>
+<p><br>
+<br>
+</p>
+<h2><a name="mozTocId635355"></a><a name="overview"></a>4. Harness
+internals for developers</h2>
+<p>The following is intended for people who have the subversion tree
+available and want to add or modify tests. </p>
+<p>The test harness executing one test basically does the following
+in sequence: </p>
+<ul>
+  <li>
+    <p style="margin-bottom: 0in;">identify test to run </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">identify properties to run with </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">copy needed support files </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">find the expected output </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">if network server, start network
+server </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">run the test, creating the database </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">if network server, shutdown the
+server </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">modify the output based on Sed class
+and _sed.properties file for the test </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">compare expected output with actual
+output </p>
+  </li>
+  <li>
+    <p>if pass, cleanup. </p>
+  </li>
+</ul>
+<p><br>
+<br>
+</p>
+<h3><a name="mozTocId344499"></a><a name="ov1"></a>4.1 Test types</h3>
+<p>The test harness recognizes, or will recognize tests with the
+following extensions:</p>
+<ul>
+  <li>
+    <p style="margin-bottom: 0in;">&nbsp;.java&nbsp;&nbsp;&nbsp; tests
+that run in a separate jvm. </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">&nbsp;.sql &nbsp;&nbsp;&nbsp; tests
+that run using ij </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">&nbsp;.sql2 &nbsp;&nbsp;&nbsp;
+related to .sql </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">&nbsp;.multi &nbsp;&nbsp;&nbsp;
+multi threaded tests. There is currently only 1 test being run. The
+multi test functions a little differently from .java and .sql* tests in
+that RunTest starts a separate harness class called MultiTest to
+control the details of the run. Also, the actual test files live under
+org/apache/derbyTesting/functionTests/multiTests, rather than
+org/apache/derbyTesting/functionTests/tests. </p>
+  </li>
+  <li>
+    <p>&nbsp;.unit &nbsp;&nbsp;&nbsp; unit tests. The unit tests
+actually refer to &lt;testname&gt;_derby.properties files under
+org/apache/derbyTesting/functionTests/tests/unit that activate the
+actual unit test harness and tests under
+org/apache/derbyTesting/unitTests. These tests test more underlying
+functionality than the (rest of the) functionTests, which are more
+geared toward how end-users might use functionality.</p>
+  </li>
+</ul>
+<p><br>
+<br>
+</p>
+<h3><a name="mozTocId809770"></a><a name="ov2"></a>4.2 Supporting
+files for tests</h3>
+<p>Various additional files may be used by a test, for instance, to
 create large data values, to test using of jar files and the like.
 Any files that need to be accessed by a particular test that are not
 accessed from the classpath need to be listed under supportfiles= in
-the &lt;testname&gt;_app.properties file.<BR>Tests can refer to
+the &lt;testname&gt;_app.properties file.<br>
+Tests can refer to
 classes without being in the classpath, and sql tests can use the ij
 command 'run resource ' to execute additional .sql files without
-changes to the _app.properties files. 
-</P>
-<P>For example, in the file
-(org/apache/derbyTesting/functionTests/tests/)tools/dblook_test_app.properties:<BR>&nbsp;&nbsp;&nbsp;
-<FONT SIZE=2>supportfiles=tools/dblook_makeDB.sql,tools/dblook_test.jar</FONT></P>
-<H3><A NAME="mozTocId427577"></A><A NAME="ov3"></A>4.3
-&lt;testname&gt;_app.properties</H3>
-<P>Every test directory has a default_app.properties. This file is
+changes to the _app.properties files. </p>
+<p>For example, in the file
+(org/apache/derbyTesting/functionTests/tests/)tools/dblook_test_app.properties:<br>
+&nbsp;&nbsp;&nbsp;
+<font size="2">supportfiles=tools/dblook_makeDB.sql,tools/dblook_test.jar</font></p>
+<h3><a name="mozTocId427577"></a><a name="ov3"></a>4.3
+&lt;testname&gt;_app.properties</h3>
+<p>Every test directory has a default_app.properties. This file is
 for system level properties generic to all the tests in that test
-directory. 
-</P>
-<P>If a test requires different system level properties, a test
+directory. </p>
+<p>If a test requires different system level properties, a test
 specific properties file can be created to overwrite the defaults.
 The test specific properties file needs to have a name starting with
-the test file name, followed with _app.properties</P>
-<P>For example, for the test tools/dblook_test.java, there is a
-properties file called tools/dblook_test_app.properties</P>
-<H3><A NAME="mozTocId715566"></A><A NAME="ov4"></A>4.4
-&lt;testname&gt;_derby.properties</H3>
-<P>Every test directory has a default_derby.properties. This file is
+the test file name, followed with _app.properties</p>
+<p>For example, for the test tools/dblook_test.java, there is a
+properties file called tools/dblook_test_app.properties</p>
+<h3><a name="mozTocId715566"></a><a name="ov4"></a>4.4
+&lt;testname&gt;_derby.properties</h3>
+<p>Every test directory has a default_derby.properties. This file is
 for derby specific properties common to all the tests in that test
-directory.<BR>If a test requires different derby properties, a test
+directory.<br>
+If a test requires different derby properties, a test
 specific properties file can be created to overwrite the defaults.
 The test specific properties file needs to have a name starting with
-the test file name, followed with _derby.properties</P>
-<H3><A NAME="mozTocId874096"></A><A NAME="ov5"></A>4.5 tmp files, out
-files, master files, and canons</H3>
-<P>The test's output will be put into a file testname.tmp. Then the
+the test file name, followed with _derby.properties</p>
+<h3><a name="mozTocId874096"></a><a name="ov5"></a>4.5 tmp files, out
+files, master files, and canons</h3>
+<p>The test's output will be put into a file testname.tmp. Then the
 output is modified if masking is required and the result is put into
-a .out file.<BR>The expected output is found by examining the
-following directories, based on certain input</P>
-<UL>
-	<LI><P STYLE="margin-bottom: 0in">functionTests/master/framework/jcc_version/jvmcode
-		</P>
-	<LI><P STYLE="margin-bottom: 0in">functionTests/master/framework/jcc_version/earlier_jvmcode
-		</P>
-	<LI><P STYLE="margin-bottom: 0in">functionTests/master/framework/jcc_version
-		</P>
-	<LI><P STYLE="margin-bottom: 0in">functionTests/master/framework/jvmcode
-		</P>
-	<LI><P STYLE="margin-bottom: 0in">functionTests/master/framework/earlier_jvmcode
-		</P>
-	<LI><P STYLE="margin-bottom: 0in">functionTests/master/jvmcode 
-	</P>
-	<LI><P>functionTests/master 
-	</P>
-</UL>
-<P>For example, if we are running a test and the flag
+a .out file.<br>
+The expected output is found by examining the
+following directories, based on certain input</p>
+<ul>
+  <li>
+    <p style="margin-bottom: 0in;">functionTests/master/framework/jcc_version/jvmcode
+    </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">functionTests/master/framework/jcc_version/earlier_jvmcode
+    </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">functionTests/master/framework/jcc_version
+    </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">functionTests/master/framework/jvmcode
+    </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">functionTests/master/framework/earlier_jvmcode
+    </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">functionTests/master/jvmcode </p>
+  </li>
+  <li>
+    <p>functionTests/master </p>
+  </li>
+</ul>
+<p>For example, if we are running a test and the flag
 -Dframework=DerbyNet is used, to use network server and the IBM
 Universal JDBC Driver ('jcc'), and the jvm we are using is Sun's jdk
 142, and the jcc version is 2.4 (not available at time of writing)
@@ -857,244 +1141,284 @@ then the search for the master to compare with starts in the
 functionTests/derbynet/jcc2.4/jdk14 directory. If a .out file with
 the same name as the test is found in that directory, that master is
 taken. If there is no such file in that directory, search continues
-in the directory functionTests/derbynet/jcc2.4/jdk13 if it exists.</P>
-<P>If there is no file there, nor for any other jcc directory, it
+in the directory functionTests/derbynet/jcc2.4/jdk13 if it exists.</p>
+<p>If there is no file there, nor for any other jcc directory, it
 will continue to derbynet/jdk14, and the search is continued for
-earlier jvm versions.<BR>If we are not running network server, the
-DerbyNet and jcc_version directories are not traversed.</P>
-<P>The version details do not go into the subversion level, i.e.
-running with jdk141 or jdk142 is expected to have the same behavior. 
-</P>
-<P>This functionality supports dealing with minor differences in
+earlier jvm versions.<br>
+If we are not running network server, the
+DerbyNet and jcc_version directories are not traversed.</p>
+<p>The version details do not go into the subversion level, i.e.
+running with jdk141 or jdk142 is expected to have the same behavior. </p>
+<p>This functionality supports dealing with minor differences in
 behavior caused by minor differences in behavior in the underlying
 jvms, jcc versions, differences between results returned through
 network server vs. embedded and minor differences between a debug and
-non debug (jar) build. 
-</P>
-<P>However, having a large number of these files means a maintenance
+non debug (jar) build. </p>
+<p>However, having a large number of these files means a maintenance
 problem. Every time test output changes due to modifications to derby
 or to the test, all output files in all directories need to be
 updated accordingly. If at all possible, irrelevant differences
 should be masked out, or the test should be written so that the
-output does not reflect such items. 
-</P>
-<P>Suggestions to minimize canons: 
-</P>
-<UL>
-	<LI><P STYLE="margin-bottom: 0in">create test specific masking 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">ensure test data has a specific
-	correct returned order; or an order by should be added to a query 
-	</P>
-	<LI><P>when writing java tests, ensure only pertinent output is
-	reflected. 
-	</P>
-</UL>
-<P><BR><BR>
-</P>
-<H3><A NAME="mozTocId68107"></A><A NAME="ov6"></A>4.6 Masking and
-comparing</H3>
-<P>Tests often fail because of unimportant differences, such as
+output does not reflect such items. </p>
+<p>Suggestions to minimize canons: </p>
+<ul>
+  <li>
+    <p style="margin-bottom: 0in;">create test specific masking </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">ensure test data has a specific
+correct returned order; or an order by should be added to a query </p>
+  </li>
+  <li>
+    <p>when writing java tests, ensure only pertinent output is
+reflected. </p>
+  </li>
+</ul>
+<p><br>
+<br>
+</p>
+<h3><a name="mozTocId68107"></a><a name="ov6"></a>4.6 Masking and
+comparing</h3>
+<p>Tests often fail because of unimportant differences, such as
 process ids, statement ids, timestamps. The derby functional test
-harness provides for masking of these differences at 2 levels:</P>
-<OL>
-	<LI><P STYLE="margin-bottom: 0in">overall level. Masking required in
-	all, or many tests can be achieved using the class Sed in the test
-	harness directory. This class can either delete a reference present
-	in the .tmp file from the .out file, or replace it with a generic
-	string. 
-	</P>
-	<LI><P>test specific level. To make masking for only one test, a
-	(testname)_sed.properties file can be created which allows to either
-	remove a string from the output or to replace it. 
-	</P>
-</OL>
-<P>The diff is executed between the final resulting output and the
-master file found.</P>
-<H3><A NAME="Adding_a_new_test"></A>4.7&nbsp; Adding a new test</H3>
-<P>To add a new test: 
-</P>
-<UL>
-	<LI><P STYLE="margin-bottom: 0in">create the test file (e.g.
-	newfunctest.java or newfunctest.sql) in the appropriate tests
-	subdirectory 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">list any files needed that are not
-	.sql or .java files in a supportfiles entry in a test specific
-	_app.properties file. e.g. newfunctest_app.properties:&nbsp;
-	supportfiles=xyz.jar</P>
-	<LI><P STYLE="margin-bottom: 0in">list any specific derby properties
-	in a test specific _derby.properties file. 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">add the properties files to the
-	copyfiles.ant file in the test specific directory 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">run the test. The first time
-	around, the test will fail because no master file will be found. 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">if the output is correct, copy it
-	to the master directory. Note that there is no copyfiles.ant file
-	needed for the master directory, all .out files are automatically
-	copied. 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">run the test again. Investigate if
-	any differences need to be masked out using a test specific
-	sed.properties file (e.g. newfunctest_sed.properties). If so, ensure
-	this is added to copyfiles.ant. 
-	</P>
-	<LI><P STYLE="margin-bottom: 0in">add the test to a specific
-	suites/*.xml file, maintaining proper xml syntax. 
-	</P>
-	<LI><P>run the suite, and correct any problems found. 
-	</P>
-</UL>
-<P><BR><BR>
-</P>
-<H3><A NAME="4.8_Suites_and_Adding_a_new_suite"></A>4.8 Suites and
-Adding a new suite</H3>
-<P>A suite constitutes of a &lt;suitename&gt;.properties file and/or
+harness provides for masking of these differences at 2 levels:</p>
+<ol>
+  <li>
+    <p style="margin-bottom: 0in;">overall level. Masking required in
+all, or many tests can be achieved using the class Sed in the test
+harness directory. This class can either delete a reference present in
+the .tmp file from the .out file, or replace it with a generic string. </p>
+  </li>
+  <li>
+    <p>test specific level. To make masking for only one test, a
+(testname)_sed.properties file can be created which allows to either
+remove a string from the output or to replace it. </p>
+  </li>
+</ol>
+<p>The diff is executed between the final resulting output and the
+master file found.</p>
+<h3><a name="Adding_a_new_test"></a>4.7&nbsp; Adding a new test</h3>
+<p>To add a new test: </p>
+<ul>
+  <li>
+    <p style="margin-bottom: 0in;">create the test file (e.g.
+newfunctest.java or newfunctest.sql) in the appropriate tests
+subdirectory </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">list any files needed that are not
+.sql or .java files in a supportfiles entry in a test specific
+_app.properties file. e.g. newfunctest_app.properties:&nbsp;
+supportfiles=xyz.jar</p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">list any specific derby properties
+in a test specific _derby.properties file. </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">add the properties files to the
+copyfiles.ant file in the test specific directory </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">run the test. The first time around,
+the test will fail because no master file will be found. </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">if the output is correct, copy it to
+the master directory. Note that there is no copyfiles.ant file needed
+for the master directory, all .out files are automatically copied. </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">run the test again. Investigate if
+any differences need to be masked out using a test specific
+sed.properties file (e.g. newfunctest_sed.properties). If so, ensure
+this is added to copyfiles.ant. </p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">add the test to a specific
+suites/*.xml file, maintaining proper xml syntax. </p>
+  </li>
+  <li>
+    <p>run the suite, and correct any problems found. </p>
+  </li>
+</ul>
+<p><br>
+<br>
+</p>
+<h3><a name="4.8_Suites_and_Adding_a_new_suite"></a>4.8 Suites and
+Adding a new suite</h3>
+<p>A suite constitutes of a &lt;suitename&gt;.properties file and/or
 a &lt;suitename&gt;.runall file in the
 org/apache/derbyTesting/functionTests/suites directory. The
 .properties files hold references to other .properties files, or
-.runall files, the .runall files are the actual lists of tests. 
-</P>
-<P>The lowest level suite always needs to have a .runall file. 
-</P>
-<P>For example, the derbyall suite is only a derbyall.properties file
-that refers to other suites in the 'suites' property: 
-</P>
-<TABLE BORDER=1 CELLPADDING=2 CELLSPACING=2>
-	<TR>
-		<TD>
-			<P><FONT SIZE=2>-----------------------derbyall.properties---------------<BR>suites=derbylang
-			derbynetclientmats derbynetmats storeall xa
-			derbytools<BR>derby.debug.true=enableBtreeConsistencyCheck<BR>derby.stream.error.logSeverityLevel=0</FONT></P>
-		</TD>
-	</TR>
-</TABLE>
-<P>The derbylang suite is only a derbylang.runall, which lists the
+.runall files, the .runall files are the actual lists of tests. </p>
+<p>The lowest level suite always needs to have a .runall file. </p>
+<p>For example, the derbyall suite is only a derbyall.properties file
+that refers to other suites in the 'suites' property: </p>
+<table border="1" cellpadding="2" cellspacing="2">
+  <tbody>
+    <tr>
+      <td>
+      <p><font size="2">-----------------------derbyall.properties---------------<br>
+suites=derbylang derbynetclientmats derbynetmats storeall xa derbytools<br>
+derby.debug.true=enableBtreeConsistencyCheck<br>
+derby.stream.error.logSeverityLevel=0</font></p>
+      </td>
+    </tr>
+  </tbody>
+</table>
+<p>The derbylang suite is only a derbylang.runall, which lists the
 tests. The derbynetclientmats suite has both a .runall and a
 .properties file, so some additional properties can be specified that
-are true for all tests in that suite. 
-</P>
-<TABLE BORDER=1 CELLPADDING=2 CELLSPACING=2>
-	<TR>
-		<TD>
-			<P><FONT SIZE=2>------------------derbynetclientmats.properties-----------------<BR>framework=DerbyNetClient<BR>suites=derbynetclientmats
-			derbynetmats<BR>jdk12test=true<BR>runwithj9=false<BR>timeout=60</FONT></P>
-		</TD>
-	</TR>
-</TABLE>
-<P>To add a suite, you need to create at least a &lt;suite&gt;.runall
+are true for all tests in that suite. </p>
+<table border="1" cellpadding="2" cellspacing="2">
+  <tbody>
+    <tr>
+      <td>
+      <p><font size="2">------------------derbynetclientmats.properties-----------------<br>
+framework=DerbyNetClient<br>
+suites=derbynetclientmats derbynetmats<br>
+jdk12test=true<br>
+runwithj9=false<br>
+timeout=60</font></p>
+      </td>
+    </tr>
+  </tbody>
+</table>
+<p>To add a suite, you need to create at least a &lt;suite&gt;.runall
 file, which lists the actual tests, or a properties file that refers
 to other suites that do have a .runall file. The suite should be
 added into the directory
-${derby.source}/java/testing/org/apache/derbyTesting/functionTests/suites.</P>
-<H3><A NAME="4.9_Running_with_a_new_jvm_"></A><A NAME="ov9"></A>4.9
-Running with a new jvm</H3>
-<P>Currently, the supported jvms are: 
-</P>
-<TABLE BORDER=1 CELLPADDING=2 CELLSPACING=2>
-	<TR>
-		<TD>
-			<P>&nbsp;&nbsp;&nbsp; <FONT SIZE=2>jdk131 - Sun HotSpot jdk1.3.1 -
-			class: jdk13</FONT><BR>&nbsp;&nbsp;&nbsp; <FONT SIZE=2>jdk141 -
-			Sun HotSpot jdk1.4.1 - class jdk14</FONT><BR>&nbsp;&nbsp;&nbsp;
-			<FONT SIZE=2>jdk142 - Sun HotSpot jdk1.4.2 - class jdk14</FONT><BR>&nbsp;&nbsp;&nbsp;
-			<FONT SIZE=2>jdk15 - Sun HotSpot jdk1.5 - class jdk15</FONT><BR>&nbsp;&nbsp;&nbsp;
-			<FONT SIZE=2>ibm131 - IBM Classic jdk1.3.1&nbsp; - class ibm13</FONT><BR>&nbsp;&nbsp;&nbsp;
-			<FONT SIZE=2>ibm141 - IBM Classic jdk1.4.1 - class ibm14</FONT><BR>&nbsp;&nbsp;&nbsp;
-			<FONT SIZE=2>ibm142 - IBM Classic jdk1.4.1 - class ibm14</FONT><BR>&nbsp;&nbsp;&nbsp;
-			<FONT SIZE=2>j9_13 - WCTME jvm (available with IBM Websphere
-			Studio Device Developer, 5.6), version 2.1 - class j9_13</FONT><BR>&nbsp;&nbsp;&nbsp;
-			<FONT SIZE=2>j9_22 - WCTME jvm (available with IBM Websphere
-			Client Technology Micro Edition, 5.7), version 2.2 - class
-			j9_22</FONT><BR>&nbsp;&nbsp;&nbsp; <FONT SIZE=2>j9_foundation -
-			WCTME jvm (available with IBM Websphere Client Technology Micro
-			Edition, 5.7), version 2.2, foundation library - class
-			j9_foundation</FONT></P>
-		</TD>
-	</TR>
-</TABLE>
-<P>The classes above are subclasses of
+${derby.source}/java/testing/org/apache/derbyTesting/functionTests/suites.</p>
+<h3><a name="4.9_Running_with_a_new_jvm_"></a><a name="ov9"></a>4.9
+Running with a new jvm</h3>
+<p>Currently, the supported jvms are: </p>
+<table border="1" cellpadding="2" cellspacing="2">
+  <tbody>
+    <tr>
+      <td>
+      <p>&nbsp;&nbsp;&nbsp; <font size="2">jdk131 - Sun HotSpot
+jdk1.3.1 - class: jdk13</font><br>
+&nbsp;&nbsp;&nbsp; <font size="2">jdk141 - Sun HotSpot jdk1.4.1 -
+class jdk14</font><br>
+&nbsp;&nbsp;&nbsp; <font size="2">jdk142 - Sun HotSpot jdk1.4.2 -
+class jdk14</font><br>
+&nbsp;&nbsp;&nbsp; <font size="2">jdk15 - Sun HotSpot jdk1.5 - class
+jdk15</font><br>
+&nbsp;&nbsp;&nbsp; <font size="2">ibm131 - IBM Classic jdk1.3.1&nbsp;
+- class ibm13</font><br>
+&nbsp;&nbsp;&nbsp; <font size="2">ibm141 - IBM Classic jdk1.4.1 -
+class ibm14</font><br>
+&nbsp;&nbsp;&nbsp; <font size="2">ibm142 - IBM Classic jdk1.4.1 -
+class ibm14</font><br>
+&nbsp;&nbsp;&nbsp; <font size="2">j9_13 - WCTME jvm (available with
+IBM Websphere Studio Device Developer, 5.6), version 2.1 - class j9_13</font><br>
+&nbsp;&nbsp;&nbsp; <font size="2">j9_22 - WCTME jvm (available with
+IBM Websphere Client Technology Micro Edition, 5.7), version 2.2 -
+class j9_22</font><br>
+&nbsp;&nbsp;&nbsp; <font size="2">j9_foundation - WCTME jvm (available
+with IBM Websphere Client Technology Micro Edition, 5.7), version 2.2,
+foundation library - class j9_foundation</font></p>
+      </td>
+    </tr>
+  </tbody>
+</table>
+<p>The classes above are subclasses of
 org.apache.derbyTesting.functionTests.harness.jvm. The name at the
-front is just a convention.</P>
-<P>To run a test with a jvm that does not have a matching class under
-org.apache.derbyTesting.functionTests.harness, do the following:</P>
-<UL>
-	<LI><P STYLE="margin-bottom: 0in">just run the tests as if there is
-	a jvm class. The harness will default to using the jdk14 class.
-	Unlikely, but possibly there are no differences</P>
-	<LI><P STYLE="margin-bottom: 0in">if there are failures showing that
-	cannot be explained any other way but genuine, acceptable jvm
-	differences, do the following: 
-	</P>
-	<UL>
-		<LI><P STYLE="margin-bottom: 0in">create a subclass of
-		org.apache.derbyTesting.functionTests.harness.jvm. In this class,
-		specify any jvm specific property settings required 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">compile the new jvm class and run
-		the tests 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">create a new canon directory for
-		any additional canons that need to be created. 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">in rare occasions, other harness
-		changes may be required 
-		</P>
-		<LI><P STYLE="margin-bottom: 0in">for any tests that should not run
-		with this environment, add a line in the testname_app.properties
-		file indicating this. For instance to add a line for a jvm called
-		jdk29, it would be like this: runwithjdk29=false. Note that the
-		versioning does not currently extend past 2 digits. For j9 jvms,
-		versioning does not apply currently. For all j9 versions, use
-		runwithj9=false. For j9_foundation, use runwithfoundation=false. 
-		</P>
-		<LI><P>Add code in RunTest.java to switch to the new jvm based on
-		values for system and vendor properties 
-		</P>
-	</UL>
-</UL>
-<P><BR><BR>
-</P>
-<H3><A NAME="skipping"></A>4.10 Skipping a test</H3>
-<P>There are 2 skipping mechanisms in place for different kinds of
-skipping of a test.</P>
-<P>Some tests are written to test specific functionality only
+front is just a convention.</p>
+<p>To run a test with a jvm that does not have a matching class under
+org.apache.derbyTesting.functionTests.harness, do the following:</p>
+<ul>
+  <li>
+    <p style="margin-bottom: 0in;">just run the tests as if there is a
+jvm class. The harness will default to using the jdk14 class. Unlikely,
+but possibly there are no differences</p>
+  </li>
+  <li>
+    <p style="margin-bottom: 0in;">if there are failures showing that
+cannot be explained any other way but genuine, acceptable jvm
+differences, do the following: </p>
+    <ul>
+      <li>
+        <p style="margin-bottom: 0in;">create a subclass of
+org.apache.derbyTesting.functionTests.harness.jvm. In this class,
+specify any jvm specific property settings required </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">compile the new jvm class and
+run the tests </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">create a new canon directory for
+any additional canons that need to be created. </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">in rare occasions, other harness
+changes may be required </p>
+      </li>
+      <li>
+        <p style="margin-bottom: 0in;">for any tests that should not
+run with this environment, add a line in the testname_app.properties
+file indicating this. For instance to add a line for a jvm called
+jdk29, it would be like this: runwithjdk29=false. Note that the
+versioning does not currently extend past 2 digits. For j9 jvms,
+versioning does not apply currently. For all j9 versions, use
+runwithj9=false. For j9_foundation, use runwithfoundation=false. </p>
+      </li>
+      <li>
+        <p>Add code in RunTest.java to switch to the new jvm based on
+values for system and vendor properties </p>
+      </li>
+    </ul>
+  </li>
+</ul>
+<p><br>
+<br>
+</p>
+<h3><a name="skipping"></a>4.10 Skipping a test</h3>
+<p>There are 2 skipping mechanisms in place for different kinds of
+skipping of a test.</p>
+<p>Some tests are written to test specific functionality only
 available with for instance certain jvms, or, with network server,
 certain versions of the IBM Universal Driver. To control this,
 properties can be set for each test, for instance, if a test should
 not be run when using an ibm jvm, set runwithibmjvm=false. If a test
 should be run with Sun Hotspot jvm version 14, then set
-runwithjdk14=true.<BR>The skip setting does not go into the
+runwithjdk14=true.<br>
+The skip setting does not go into the
 subversion level, i.e. setting runwithjdk141=false has no effect, and
 setting runwithjdk14 affects runs with jdk141 as well as
-jdk142.<BR>Other skip reasons are encryption protocols specific to a
-certain jvm. 
-</P>
-<P>The property for skipping a test based on the version of the IBM
-Universal Driver is &quot;excludeJCC&quot;.&nbsp; The keywords
-&quot;<B>at-or-before</B>&quot; and &quot;<B>at-or-after</B>&quot;
+jdk142.<br>
+Other skip reasons are encryption protocols specific to a
+certain jvm. </p>
+<p>The property for skipping a test based on the version of the IBM
+Universal Driver is "excludeJCC".&nbsp; The keywords
+"<b>at-or-before</b>" and "<b>at-or-after</b>"
 can be used to specify which range of JCC versions should be
 excluded.&nbsp; If neither of these keywords is provided, the default
-is &quot;<B>at-or-before</B>&quot;.&nbsp; For example:</P>
-<P>To skip a test when running with any version of the IBM Universal
-Driver that is 2.4 or earlier:<BR>excludeJCC=at-or-before:2.4<BR><BR>To
+is "<b>at-or-before</b>".&nbsp; For example:</p>
+<p>To skip a test when running with any version of the IBM Universal
+Driver that is 2.4 or earlier:<br>
+excludeJCC=at-or-before:2.4<br>
+<br>
+To
 skip a test when running with any version of the IBM Universal Driver
-that is 2.0 or later:<BR>excludeJCC=at-or-after:2.0</P>
-<P>You can also specify an (optional) jvm clause to further tune the
-exclusion criteria.&nbsp; This clause starts with the &quot;<B>,when</B>&quot;
+that is 2.0 or later:<br>
+excludeJCC=at-or-after:2.0</p>
+<p>You can also specify an (optional) jvm clause to further tune the
+exclusion criteria.&nbsp; This clause starts with the "<b>,when</b>"
 tag and is followed by a three-part jvm version.&nbsp; In this case,
 a test will only be skipped if BOTH the JCC clause AND the jvm clause
-are true. For example:</P>
-<P>To skip a test when running with any version of the IBM Universal
+are true. For example:</p>
+<p>To skip a test when running with any version of the IBM Universal
 Driver that is 2.4 or later, but ONLY if the jvm is 1.3 or
-earlier:<BR>excludeJCC=at-or-after:2.4,when-at-or-before:jdk1.3.1</P>
-<P>To skip a test when running with any version of the IBM Universal
+earlier:<br>
+excludeJCC=at-or-after:2.4,when-at-or-before:jdk1.3.1</p>
+<p>To skip a test when running with any version of the IBM Universal
 Driver that is 2.0 or earlier, but ONLY if the jvm is 1.5 or
-later:<BR>excludeJCC=at-or-before:2.0,when-at-or-after:jdk1.5.1</P>
-<P>Another skipping mechanism works on entire 'frameworks'. Currently
+later:<br>
+excludeJCC=at-or-before:2.0,when-at-or-after:jdk1.5.1</p>
+<p>Another skipping mechanism works on entire 'frameworks'. Currently
 there are only 3 supported in the harness, embedded, network server
 with the derbyclient driver ('DerbyNetClient') and network server
 with the IBM Universal JDBC Driver ('DerbyNet'). In the suites
@@ -1104,119 +1428,279 @@ warning message show up for every test run. In this
 'framework'.exclude file tests can be placed that for some reason
 need to be excluded from running with that framework. This mechanism
 enables adding of suites to a framework run even if a few of the
-tests are not appropriate for that particular framework.</P>
-<P>Note that at this time, only skipped suites show up in the .skip
-result file. This still needs to be corrected.</P>
-<P><BR><BR>
-</P>
-<H3><A NAME="frameworks"></A>4.11 Frameworks</H3>
-<P>Currently, there are two frameworks used for network
+tests are not appropriate for that particular framework.</p>
+<p>Note that at this time, only skipped suites show up in the .skip
+result file. This still needs to be corrected.</p>
+<p><br>
+<br>
+</p>
+<h3><a name="frameworks"></a>4.11 Frameworks</h3>
+<p>Currently, there are two frameworks used for network
 server,&nbsp;DerbyNetClient, which uses the derby Client driver, and
-DerbyNet, which uses the IBM Universal JDBC Driver. <BR>Setting the
+DerbyNet, which uses the IBM Universal JDBC Driver. <br>
+Setting the
 framework property will invoke the test harness class NetServer which
 has the actual configuration (driver name, portnumber etc.) used for
-the individual frameworks. <A HREF="#Note3:"><FONT SIZE=2>See
-Note4.</FONT></A><BR>Setting this framework also causes the search
+the individual frameworks. <a href="#Note3:"><font size="2">See
+Note4.</font></a><br>
+Setting this framework also causes the search
 for expected output to include appropriate DerbyNetClient or&nbsp;
 DerbyNet and jcc version specific subdirectories under the master
-directory.</P>
-<P><BR><BR>
-</P>
-<H3><A NAME="props"></A>4.12 Some test harness properties</H3>
-<P>For a complete set, refer to comments in RunTest.java, but here
+directory.</p>
+<p><br>
+<br>
+</p>
+<h3><a name="props"></a>4.12 Some test harness properties</h3>
+<p>For a complete set, refer to comments in RunTest.java, but here
 are some valuable test properties which can be passed to the RunTest
-class: 
-</P>
-<TABLE WIDTH=1006 BORDER=1 CELLPADDING=2 CELLSPACING=3>
-	<COL WIDTH=994>
-	<TR>
-		<TD WIDTH=994>
-			<P>runwith&lt;jvm&gt;<BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; See
-			above section <A HREF="#skipping">4.10</A><BR>framework<BR>&nbsp;&nbsp;&nbsp;
-			specifies which framework to run with. For example:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-			java -Dframework=DerbyNetClient
-			org.apache.derbyTesting.functionTests.RunTest
-			<BR>lang/supersimple.sql<BR>verbose<BR>&nbsp;&nbsp;&nbsp; Shows
-			more detailed output. For example:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-			java -Dverbose=true org.apache.derbyTesting.functionTests.RunTest
-			lang/arithmetic.sql<BR>keepfiles<BR>&nbsp; &nbsp; Indicates to not
-			clean up any of the files if the test passed.<BR>&nbsp;&nbsp; &nbsp;
-			&nbsp;&nbsp; java -Dkeepfiles=true
-			org.apache.derbyTesting.functionTests.RunTest
-			lang/arithmetic.sql<BR>testSpecialProps<BR>&nbsp;&nbsp;&nbsp; sets
-			additional properties. Several can be set using '^' as separator:
-			<BR>&nbsp;&nbsp;&nbsp; -DtestSpecialProps=&lt;prop-1&gt;=&lt;value-1&gt;^
-			... ^&lt;prop-n&gt;=&lt;value-n&gt;<BR>&nbsp;&nbsp; &nbsp; &nbsp;
-			&nbsp; java -DTestSpecialProps=derby.infolog.append=true
-			org.apache.derbyTesting.functionTests.RunTest lang/arithmetic.sql
-			<BR>jvmflags<BR>&nbsp;&nbsp;&nbsp; sets specific jvm properties
-			for the jvm used in the test harness, for instance initial memory,
-			and heap size, or properties normally passed on with a -D. For
-			instance: <BR>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; java
-			-Djvmflags=ms32M -mx128M
-			org.apache.derbyTesting.functionTests.RunTest
-			lang/streamingColumn.java <BR>excludeJCC<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-			See above section <A HREF="#skipping">4.10</A><BR>useprocess<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-			(default=true) Controls whether RunTest runs the test in a
-			separate VM or in a <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-			thread in harness VM. It is potentially useful for debugging
-			tests. Unit tests are <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-			not (yet) runnable with &quot;useprocess=false&quot;, though. 
-			</P>
-			<P>noSecurityManager &ndash; disable the client JVM from
-			installing a SecurityManager. See section 4.13</P>
-			<P><BR>
-			</P>
-		</TD>
-	</TR>
-</TABLE>
-<H3><A NAME="security"></A><BR>4.13 SecurityManager testing by
-default</H3>
-<P>By default the tests install the standard Java SecurityManager
+class: </p>
+<table style="width: 791px; height: 632px;" border="1" cellpadding="2"
+ cellspacing="3">
+  <col width="994"> <tbody>
+    <tr>
+      <td width="994"> &lt;&gt;runwith&lt;jvm&gt;<br>
+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; See above section <a
+ href="#skipping">4.10</a><br>
+framework<br>
+&nbsp;&nbsp;&nbsp; specifies which framework to run with. For example:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; java
+-Dframework=DerbyNetClient
+org.apache.derbyTesting.functionTests.RunTest <br>
+lang/supersimple.sql<br>
+verbose<br>
+&nbsp;&nbsp;&nbsp; Shows more detailed output. For example:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; java -Dverbose=true
+org.apache.derbyTesting.functionTests.RunTest lang/arithmetic.sql<br>
+keepfiles<br>
+&nbsp; &nbsp; Indicates to not clean up any of the files if the test
+passed.<br>
+&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; java -Dkeepfiles=true
+org.apache.derbyTesting.functionTests.RunTest lang/arithmetic.sql<br>
+testSpecialProps<br>
+&nbsp;&nbsp;&nbsp; sets additional properties. Several can be set using
+'^' as separator: <br>
+&nbsp;&nbsp;&nbsp; -DtestSpecialProps=&lt;prop-1&gt;=&lt;value-1&gt;^
+... ^&lt;prop-n&gt;=&lt;value-n&gt;<br>
+&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; java
+-DTestSpecialProps=derby.infolog.append=true
+org.apache.derbyTesting.functionTests.RunTest lang/arithmetic.sql <br>
+jvmflags<br>
+&nbsp;&nbsp;&nbsp; sets specific jvm properties for the jvm used in the
+test harness, for instance initial memory, and heap size, or properties
+      <br>
+&nbsp;&nbsp;&nbsp; normally passed on with a -D. For instance: <br>
+&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; java -Djvmflags=ms32M -mx128M
+org.apache.derbyTesting.functionTests.RunTest lang/streamingColumn.java
+      <br>
+excludeJCC<br>
+&nbsp;&nbsp;&nbsp; See above section <a href="#skipping">4.10</a><br>
+useprocess<br>
+&nbsp;&nbsp;&nbsp; (default=true) Controls
+whether RunTest runs the test in a separate VM or in a thread in
+harness VM. It is
+potentially<br>
+&nbsp; &nbsp;&nbsp; useful for debugging tests. Unit tests are not
+(yet) runnable with
+"useprocess=false", though.<br>
+startServer - allows for Network Server tests to start and shutdown
+Network Server from the test itself. Default is true - i.e. the <br>
+&nbsp;&nbsp;&nbsp;&nbsp; test harness will start Network Server.<br>
+noSecurityManager  disable the client JVM from installing a
+SecurityManager. See section 4.13<br>
+hostName - allows for running Network Server on a remote host. See
+section <a href="#hostName">4.14</a>.<br>
+      </td>
+    </tr>
+  </tbody>
+</table>
+<h3><a name="security"></a><br>
+4.13 SecurityManager testing by
+default</h3>
+<p>By default the tests install the standard Java SecurityManager
 using the system property java.security.manager and use a policy file
 derby_tests.policy. This file is sourced
-at<BR>${derby.source}/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy</P>
-<P>During a test run this policy file is copied into ${user.dir} and
-used from there.</P>
-<P>There are three environments for the installation of the
-SecurityManager.</P>
-<UL>
-	<LI><P>Server JVM for the network client tests. Always uses a
-	SecurityManager.</P>
-	<LI><P>Client side JVM for all tests when useProcess not false.
-	Installs a SecurityManager unless:</P>
-	<LI><P><FONT FACE="Courier New"><FONT SIZE=2><FONT COLOR="#000000">noSecurityManager=</FONT><FONT COLOR="#2a00ff">true
-	</FONT><FONT SIZE=3><FONT FACE="Times New Roman, serif"><FONT COLOR="#000000">in
-	the test's _app.properties file.Used to disable individual tests
-	that cannot run under the security manager, or if the test has a
-	functional requirement not to run with the SecurityManager. Ideally,
-	few tests will have this property set. Initially a number of tests
-	have this set to allow the remaining tests to be running with the
-	SecuirtyManager, the disabled tests need to be investigated.</FONT></FONT></FONT></FONT></FONT></P>
-	<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Client
-	JDBC driver is DB2's Universal driver for JDBC. Currently does not
-	install a SecurityManager, no technical reasons, just has not been
-	done.</FONT></FONT></FONT></P>
-	<LI><P>Client side JVM for all tests when useProcess is false (e.g.
-	nist suite). Currently does not install a SecurityManager, no
-	technical reasons, just has not been done yet.</P>
-</UL>
-<H2>Notes</H2>
-<P STYLE="margin-bottom: 0in"><A NAME="Note1:"></A><FONT SIZE=2>Note1:</FONT></P>
-<P STYLE="margin-left: 0.42in; margin-bottom: 0in"><FONT SIZE=2>A
+at<br>
+${derby.source}/java/testing/org/apache/derbyTesting/functionTests/util/derby_tests.policy</p>
+<p>During a test run this policy file is copied into ${user.dir} and
+used from there.</p>
+<p>There are three environments for the installation of the
+SecurityManager.</p>
+<ul>
+  <li>
+    <p>Server JVM for the network client tests. Always uses a
+SecurityManager.</p>
+  </li>
+  <li>
+    <p>Client side JVM for all tests when useProcess not false.
+Installs a SecurityManager unless:</p>
+  </li>
+  <li>
+    <p><font face="Courier New"><font size="2"><font color="#000000">noSecurityManager=</font><font
+ color="#2a00ff">true </font><font size="3"><font
+ face="Times New Roman, serif"><font color="#000000">in the test's
+_app.properties file.Used to disable individual tests that cannot run
+under the security manager, or if the test has a functional requirement
+not to run with the SecurityManager. Ideally, few tests will have this
+property set. Initially a number of tests have this set to allow the
+remaining tests to be running with the SecuirtyManager, the disabled
+tests need to be investigated.</font></font></font></font></font></p>
+  </li>
+  <li>
+    <p><font color="#000000"><font face="Times New Roman, serif"><font
+ size="3">Client JDBC driver is DB2's Universal driver for JDBC.
+Currently does not install a SecurityManager, no technical reasons,
+just has not been done.</font></font></font></p>
+  </li>
+  <li>
+    <p>Client side JVM for all tests when useProcess is false (e.g.
+nist suite). Currently does not install a SecurityManager, no technical
+reasons, just has not been done yet.</p>
+  </li>
+</ul>
+<h3><a name="hostName"></a><br>
+4.14 Testing with Network Server on a remote host</h3>
+By default the network server is assumed not to be running, and the
+test harness will start Network Server for each test - unless the test
+has been qualified explicitly with the property startServer to
+false when the test itself is assumed to be starting Network Server.
+(This can be set either in a test's property file or with the -D on the
+commandline). Thus, by default Network Server is started and shutdown
+in the subdirectory for the framework created for each test, and the
+databases are created in that directory (e.g. ./DerbyNetClient/wombat).<br>
+However, to enable testing against a Network Server running on a remote
+machine - which is for instance needed to test on IPV6 machines - one
+can use the property hostName. This is not a pre-set value in any
+suite, some manual steps are required to run tests this way.<br>
+<ol>
+  <li>extract and/or copy the derby_tests.policy from the
+derbyTesting.jar or a supporting branch (after 10.1) to the location on
+the host where you want to run the NetworkServer</li>
+  <li>modify the derby_test.policy to reflect access from the machine
+where you want to run the tests (i.e. the client). This means that in
+each location where 'localhost' is listed, you should add a line
+reflecting your client machine's IP address or hostname.</li>
+  <li>Set up the classpath for Network Server to include derbynet.jar
+and derbyTesting.jar.<br>
+  </li>
+  <li>start Network Server like so when using compiled classes for it:</li>
+</ol>
+<table
+ style="width: 751px; height: 72px; text-align: left; margin-right: auto; margin-left: 40px;"
+ border="1" cellpadding="2" cellspacing="2">
+  <tbody>
+    <tr>
+      <td style="vertical-align: top;">java -Djava.security.manager
+-Djava.security.policy=derby_tests.policy
+-Dcsinfo.codeclasses=file:/derby/classes/
+-Dcsinfo.codedir=/derby/classes -Dcsinfo.serverhost=localhost
+-Dcsinfo.trustedhost=localhost -Dcsinfo.codejar=file://unused/
+org.apache.derby.drda.NetworkServerControl -h 0.0.0.0 start<br>
+      <small>where /derbyt/classes is the directory where either the
+classes, can be found</small><br>
+      </td>
+    </tr>
+  </tbody>
+</table>
+<div style="text-align: left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+or like so when using jars:<br>
+<table
+ style="width: 751px; height: 72px; text-align: left; margin-right: auto; margin-left: 40px;"
+ border="1" cellpadding="2" cellspacing="2">
+  <tbody>
+    <tr>
+      <td style="vertical-align: top;">java
+-Dderby.system.home=/home/derbytst/ns -Djava.security.manager
+-Djava.security.policy=/home/derbytst/ns/derby_tests.policy
+-Dcsinfo.codejar=file:/derby/tstbld/
+-Dcsinfo.codedir=/derby/tstbld -Dcsinfo.serverhost=localhost
+-Dcsinfo.trustedhost=localhost -Dcsinfo.codeclasses=file://unused/
+org.apache.derby.drda.NetworkServerControl -h 0.0.0.0 start<br>
+      <small>where /derbyt/tstbld&nbsp; is the directory where
+derbynet.jar is found and home/derbytst/ns is the directory where your
+derby.properties, derby_tests.policy file are and where you want to
+have derby.log and any databases go. </small><br>
+      </td>
+    </tr>
+  </tbody>
+</table>
+<br>
+&nbsp;&nbsp;&nbsp; 5.&nbsp; start
+runsuite like so for the Network Server Client:</div>
+<table
+ style="width: 786px; height: 31px; text-align: left; margin-right: auto; margin-left: 40px;"
+ border="1" cellpadding="2" cellspacing="2">
+  <tbody>
+    <tr>
+      <td style="vertical-align: top;">java
+-DhostName=favorite.remotehost.com
+org.apache.derbyTesting.functionTests.harness.RunSuite
+derbynetclientmats<br>
+      </td>
+    </tr>
+  </tbody>
+</table>
+<br>
+RunTest can pick up the property in a similar way. You can set
+-Dframework as usual. You can also run derbynetmats with jcc. Tests in
+the derbynet(client)mats suite have been modified to run against a
+remote server as much as possible.<br>
+<br>
+When the test harness encounters the -DhostName, and the value is not
+null and not localhost, it switches to use useprocess=false and
+startServer=false.&nbsp; This has a number of implications:<br>
+<ol>
+  <li>the test harness, or individual tests cannot start and stop
+Network Server. <br>
+  </li>
+  <li>the tests cannot check derby.log, nor data files created on the
+server by import/export or dblook utilities.<br>
+  </li>
+  <li>the database location is the same for each test
+(useprocess=false), and thus tests run this way need to be diligent
+about cleaning up after or will cause failures in later tests. The
+.java
+tests can use the TestUtil.cleanUp method to drop any database object
+without any output being reflected. Test writers need to ensure that
+the objects are in fact getting dropped or the test needs to be
+excluded from running remotely.<br>
+  </li>
+  <li>tests cannot use a mix of Network Server and local connections to
+the same database.</li>
+  <li>tests should not use 'localhost' or they cannot be run in this
+fashion. Tests that need to be run in this fashion can use the result
+of
+the TestUtil.getHostName() method instead.</li>
+  <li>because of the usage of useprocess=false, the location of test
+files is slightly different. The extin, extinout directories are one
+directory up. A number of tests have been modified to correctly locate
+these directories for supporting files.</li>
+  <li>you can only use the ping option of the NetworkServerControl
+class.<br>
+  </li>
+</ol>
+New .exclude files for the current frameworks (i.e.
+DerbyNetRemote.exclude and DerbyNetClientRemote.exclude) have been
+created to skip some tests that cannot be run against a remote server
+because of those implications. <br>
+<br>
+<h2>Notes</h2>
+<p style="margin-bottom: 0in;"><a name="Note1:"></a><font size="2">Note1:</font></p>
+<p style="margin-left: 0.42in; margin-bottom: 0in;"><font size="2">A
 number of tests require packages that are optional with jdk13, but
 included with later jvms: jdbc20ext.jar and jta1_2.jar. When running
 with jdk131, these need to be downloaded separately &amp; placed in
-the jre/lib/ext directory of your jvm installation.</FONT></P>
-<P STYLE="margin-bottom: 0in"><A NAME="Note2:"></A><FONT SIZE=2><BR>Note2:</FONT></P>
-<P STYLE="margin-left: 0.42in; margin-bottom: 0in"><FONT SIZE=2>There
+the jre/lib/ext directory of your jvm installation.</font></p>
+<p style="margin-bottom: 0in;"><a name="Note2:"></a><font size="2"><br>
+Note2:</font></p>
+<p style="margin-left: 0.42in; margin-bottom: 0in;"><font size="2">There
 is one more suite included: the j9derbynetmats suite is a
 modification of the derbynetmats suite. It is available to test the
 network server with the jvm available with IBM's WCTME (Workplace
 Client Technology, Micro Edition; formerly WSDD), and will be run at
 IBM. Note that the setup for running the j9derbynetmats tests is very
 specific to the test harness, not even using the WCTME files in their
-normal location.</FONT> <FONT SIZE=2><BR>The j9derbynetmats suite is
+normal location.</font> <font size="2"><br>
+The j9derbynetmats suite is
 included to serve as an example of splitting the network server
 process to run with a different jvm than the test client. The
 j9derbynetmats suite will run with another jvm as client (as defined
@@ -1224,24 +1708,27 @@ in the suite properties), but start up network server with the 'j9'
 jvm files (the reference to 'j9' is based on the executable, j9.exe),
 based on the property 'serverJvm'. Running this suite requires
 providing the property&nbsp; bootcp, which is&nbsp; interpreted from
-the test harness class j9_13. See also section on adding a new <A HREF="#ov9">jvm
-setup</A>. </FONT>
-</P>
-<P STYLE="margin-bottom: 0in"><A NAME="Note3:"></A><BR><FONT SIZE=2>Note3:</FONT></P>
-<P STYLE="margin-left: 0.42in; margin-bottom: 0in">O<FONT SIZE=2>ccasionally,
+the test harness class j9_13. See also section on adding a new <a
+ href="#ov9">jvm
+setup</a>. </font>
+</p>
+<p style="margin-bottom: 0in;"><a name="Note3:"></a><br>
+<font size="2">Note3:</font></p>
+<p style="margin-left: 0.42in; margin-bottom: 0in;">O<font size="2">ccasionally,
 cleanup is unsuccessful. This does not constitute a problem in any
 way, as the harness for most suites starts with a clean database, and
 clean copies of all files. However, you will see something like this
-in the output:</FONT><BR><FONT SIZE=2>Warning: Cleanup failed on
-baseDir: /local/myrun1/DerbyNet/supersimple.</FONT></P>
-<P STYLE="margin-bottom: 0in"><A NAME="Note4:_"></A><BR><FONT SIZE=2>Note4:
-</FONT>
-</P>
-<P STYLE="margin-left: 0.42in; margin-bottom: 0in"><FONT SIZE=2>NetServer
+in the output:</font><br>
+<font size="2">Warning: Cleanup failed on
+baseDir: /local/myrun1/DerbyNet/supersimple.</font></p>
+<p style="margin-bottom: 0in;"><a name="Note4:_"></a><br>
+<font size="2">Note4:
+</font></p>
+<p style="margin-left: 0.42in; margin-bottom: 0in;"><font size="2">NetServer
 also has a configuration for connecting to DB2 via jcc - the IBM
 Universal Driver - and via the older DB2 driver. But there are
-currently no tests to exercise these settings.</FONT></P>
-<P STYLE="margin-bottom: 0in"><BR>
-</P>
-</BODY>
-</HTML>
+currently no tests to exercise these settings.</font></p>
+<p style="margin-bottom: 0in;"><br>
+</p>
+</body>
+</html>
diff --git a/java/testing/org/apache/derbyTesting/functionTests/harness/NetServer.java b/java/testing/org/apache/derbyTesting/functionTests/harness/NetServer.java
index ba938f3b1..db153e289 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/harness/NetServer.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/harness/NetServer.java
@@ -31,6 +31,7 @@ import java.lang.reflect.Method;
 import java.lang.reflect.Constructor;
 import java.net.ConnectException;
 import java.net.Socket;
+import org.apache.derbyTesting.functionTests.util.TestUtil;
 
 public class NetServer
 {
@@ -41,6 +42,7 @@ public class NetServer
     String javaCmd;
     String jvmflags;
     String framework;
+    static String hostName;
     
     Object[] frameworkInfo;
     int port;
@@ -67,13 +69,15 @@ public class NetServer
 
     
     static {
+    	hostName=TestUtil.getHostName();
 	m =  new Hashtable();
 	// Hashtable is keyed on framework name and has 
 	// an array of the framework prefix, suffix, driver, port  and 
 	// String[] command arguments to start the server
 	// String[] Command arguments to stop the server
+	String url = "jdbc:derby:net://" + hostName + ":1527/";
 	m.put("DerbyNet", new Object[]
-	    {"jdbc:derby:net://localhost:1527/",                 //prefix
+	    {url,                 //prefix
 	     "",                                            // suffix
 	     "com.ibm.db2.jcc.DB2Driver",                   //driver
 	     "1527",                                        // port
@@ -83,8 +87,9 @@ public class NetServer
 			   "shutdown"},
 	     null});                                        //shutdown2
 
+	url = "jdbc:derby://" + hostName + ":1527/";  
 	m.put("DerbyNetClient", new Object[]
-	    {"jdbc:derby://localhost:1527/",                 //prefix
+	    {url,                 //prefix
 	     "",                                            // suffix
 	     "org.apache.derby.jdbc.ClientDriver",           //driver
 	     "1527",                                        // port
@@ -94,8 +99,9 @@ public class NetServer
 			   "shutdown"},
 	     null});                                        //shutdown2
 
+	url = "jdbc:db2://" + hostName + ":50000/";
 	m.put("DB2jcc", new Object[]
-	    {"jdbc:db2://localhost:50000/",                //prefix
+	    {url,                //prefix
 	     "",                                            //suffix
 	     "com.ibm.db2.jcc.DB2Driver",                   //driver
 	     "50000",                                       //port
@@ -113,8 +119,8 @@ public class NetServer
 	     null});
     }
 
-    public NetServer(File homeDir, String jvmName, String clPath, String
-		     javaCmd, String jvmflags, String framework, boolean startServer) 
+    public NetServer(File homeDir, String jvmName, String clPath, String 
+   	     javaCmd, String jvmflags, String framework, boolean startServer)
 	throws Exception
     {
 	this.homeDir = homeDir;
@@ -132,7 +138,7 @@ public class NetServer
     }
     public void start() throws Exception
     {
-	  if (! startServer)
+      if (! startServer)
 	  {
 		System.out.println("startServer = false. Bypass server startup");
 		return;
@@ -221,7 +227,7 @@ public class NetServer
  			}
  			else	
  			{
- 				Socket s = new Socket("localhost", this.port);
+ 				Socket s = new Socket(hostName, this.port);
  				s.close();
 				break;
  			}
diff --git a/java/testing/org/apache/derbyTesting/functionTests/harness/RunClass.java b/java/testing/org/apache/derbyTesting/functionTests/harness/RunClass.java
index 46de749f9..3323e5457 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/harness/RunClass.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/harness/RunClass.java
@@ -30,16 +30,14 @@ public class RunClass implements Runnable
 	/**
 		param args the arguments to pass into ij
 	*/
-	public RunClass(Class theClass, Method methodToCall, Object args[])
+	public RunClass(Method methodToCall, Object args[])
 	{
 		mainMethod = methodToCall;
 		arguments=args;	
-		testClass = theClass;
 	}
 
 	Object arguments[];
 	Method mainMethod;
-	Class testClass;
 
 	public void run()
 	{
@@ -47,15 +45,14 @@ public class RunClass implements Runnable
         {
 		    try
 		    {
-			    mainMethod.invoke(testClass.newInstance(), arguments);				
-		    }
-		    catch (InstantiationException ie)
-		    {
-		        System.out.println("Class could not be instantiated: " + ie);
-		        System.exit(1);
+			    // we're invoking the test class's main method - which is always static
+			    // thus we can pass null, an underlying object argument would be 
+			    // ignored anyway. 
+			    mainMethod.invoke(null, arguments);
 		    }
 		    catch (IllegalAccessException iae)
 		    {
+			iae.printStackTrace();
 		        System.out.println("RunClass: " + iae + " make sure the test class is public.");
 		        System.exit(1);
 		    }
diff --git a/java/testing/org/apache/derbyTesting/functionTests/harness/RunList.java b/java/testing/org/apache/derbyTesting/functionTests/harness/RunList.java
index 3880254c9..b785b9b5d 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/harness/RunList.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/harness/RunList.java
@@ -119,6 +119,7 @@ public class RunList
 	static Properties suiteProperties;
 	static Properties specialProperties; // for testSpecialProps
 	static BufferedReader runlistFile;
+	static String hostName;
 
     static String [] clientExclusionKeywords = new String [] {
         "at-or-before:", "at-or-after:", "when-at-or-before:jdk",
@@ -419,6 +420,8 @@ public class RunList
             jvmProps.addElement("serverJvm=" + serverJvm);
         if ( (serverJvmName != null) && (serverJvmName.length()>0) )
             jvmProps.addElement("serverJvmName=" + serverJvmName);
+        if ( (hostName != null) && (hostName.length()>0) )
+        	jvmProps.addElement("hostName=" + hostName);
         if ( useprocess == false )
             jvmProps.addElement("useprocess=false");
         if ( skipsed.equals("true") )
@@ -740,6 +743,7 @@ public class RunList
 		bootcp = suiteProperties.getProperty("bootcp");
 		serverJvm = suiteProperties.getProperty("serverJvm");
 		serverJvmName = suiteProperties.getProperty("serverJvmName");
+		hostName = suiteProperties.getProperty("hostName");
 		canondir = suiteProperties.getProperty("canondir");
 		mtestdir = suiteProperties.getProperty("mtestdir");
 		String usepr = suiteProperties.getProperty("useprocess");
@@ -823,7 +827,10 @@ public class RunList
             p.put("serverJvmName", serverJvmName);
 		else
             serverJvmName = p.getProperty("serverJvmName");
-
+        if ( hostName != null )
+            p.put("hostName", hostName);
+        else
+        	p.put("hostName","localhost");
         // Encryption may be set at the top or just for a subsuite
 	    if ( parentProperties.getProperty("encryption") != null )
 		    p.put("encryption", encryption);
diff --git a/java/testing/org/apache/derbyTesting/functionTests/harness/RunSuite.java b/java/testing/org/apache/derbyTesting/functionTests/harness/RunSuite.java
index 47c689cc5..d5f05f423 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/harness/RunSuite.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/harness/RunSuite.java
@@ -71,6 +71,7 @@ public class RunSuite
 	static String canondir; // location of master dir (default is master)
 	static String bootcp; //  path for j9 bootclasspath setting
 	static String serverJvm; //  path for j9 bootclasspath setting
+	static String hostName; // needs to be settable for IPV6 testing; localhost otherwise. 
 	static String ijdefaultResourcePackage; // for ij tests only
 	static String debug; // for setting verbose mode to pass down to RunTest
     static String timeout; // to allow killing a hanging test
@@ -341,6 +342,7 @@ public class RunSuite
             outputdir = p.getProperty("outputdir");
             canondir = p.getProperty("canondir");
             bootcp = p.getProperty("bootcp");
+            hostName = p.getProperty("hostName");
             serverJvm = p.getProperty("serverJvm");
             systemdiff = p.getProperty("systemdiff");
             ijdefaultResourcePackage = p.getProperty("ij.defaultResourcePackage");
@@ -467,6 +469,9 @@ public class RunSuite
 		    bootcp = j9bootcp;
 		    suiteProperties.put("bootcp", bootcp);
 		}
+		String hostname = sp.getProperty("hostName");
+		if (hostname != null)
+			suiteProperties.put("hostName", hostname);
 		String serverJvm = sp.getProperty("serverJvm");
 		if (serverJvm != null)
 		    suiteProperties.put("serverJvm", serverJvm);
diff --git a/java/testing/org/apache/derbyTesting/functionTests/harness/RunTest.java b/java/testing/org/apache/derbyTesting/functionTests/harness/RunTest.java
index 148579dc7..5a0a61db4 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/harness/RunTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/harness/RunTest.java
@@ -121,6 +121,7 @@ public class RunTest
 	static boolean dbIsNew = true;
 	static String runwithjvm="true";
 	static boolean startServer=true; // should test harness start the server
+	static String hostName; // needs to be settable for ipv testing, localhost otherwise.)
 
 	// Other test variables for directories, files, output
 	static String scriptName = ""; // testname as passed in
@@ -276,13 +277,13 @@ public class RunTest
                     // default to the latest one we know 
                     jvmnetjvm = "j9_22";
                 }
-			
+
                 ns = new NetServer(baseDir, jvmnetjvm, classpathServer, null,
-								   jvmflags,framework, startServer);
+                                     jvmflags,framework, startServer);
             }
             else
-			    ns = new NetServer(baseDir, jvmName, classpathServer, 
-								   javaCmd, jvmflags,framework, startServer);
+                ns = new NetServer(baseDir, jvmName, classpathServer, 
+                                     javaCmd, jvmflags,framework, startServer);
 		    ns.start();
 		    frameworkInitialized = true;
 	    }
@@ -324,7 +325,7 @@ public class RunTest
         {
             isI18N=true;
         }
-
+        
         if (skipsed)
         {
             tmpOutFile.renameTo(finalOutFile);
@@ -418,10 +419,6 @@ public class RunTest
         if (testType.startsWith("sql"))
             scriptPath = script.getPath();
                 
-        // Build the test command
-        String[] testCmd = 
-    		buildTestCommand(propString, systemHome, scriptPath);
-        
 	    // cleanup for all tests that re-use standard testCSHome/wombat database
 	    if (useCommonDB == true 
 	    	&& (usesystem == null || usesystem == "")
@@ -434,7 +431,11 @@ public class RunTest
         // Create a process to execute the command unless useprocess is false
         if ( useprocess )
 		{
+            // Build the test command
+            String[] testCmd = 
+        		buildTestCommand(propString, systemHome, scriptPath);
             execTestProcess(testCmd);
+        
 		}
         else
 		{
@@ -838,24 +839,33 @@ public class RunTest
 			framework = "";
 		else
 			driverName = NetServer.getDriverName(framework);
-		String skipFile;
-		// Some tests will not work with some frameworks,
-		// so check property files for tests to be skipped
-		skipFile = framework + ".exclude";
 
-		if (!framework.equals(""))
-		{
-			if (SkipTest.skipIt(skipFile, scriptName)) {
-				skiptest = true;
-				addSkiptestReason("Test skipped: listed in " + 
-								  skipFile + 
-						  " file, skipping test: " 
-								  + scriptName);
-			}
-		}
-		else
-			framework = "";
-	
+        hostName = sp.getProperty("hostName");
+        // force hostName to localhost if it is not set
+        if (hostName == null)
+           hostName="localhost";
+		
+        // Some tests will not work with some frameworks,
+        // so check suite exclude files for tests to be skipped
+        String skipFile = framework + ".exclude";
+        if (!framework.equals(""))
+        {
+            skiptest = (SkipTest.skipIt(skipFile, scriptName));
+            // in addition, check to see if the test should get skipped 
+            // because it's not suitable for a remotely started server
+            if (!skiptest) 
+            {
+                if (!hostName.equals("localhost")) 
+                {
+                    skipFile = framework + "Remote.exclude";
+                    skiptest = (SkipTest.skipIt(skipFile, scriptName));
+                }
+            }
+            if (skiptest) // if we're skipping...
+                addSkiptestReason("Test skipped: listed in " + skipFile + 
+                     " file, skipping test: " + scriptName);
+        }
+		
 		jvmName = sp.getProperty("jvm");
 
 		//System.out.println("jvmName is: " + jvmName);
@@ -921,7 +931,6 @@ public class RunTest
 		
         javaCmd = sp.getProperty("javaCmd");
         bootcp = sp.getProperty("bootcp");
-
         jvmflags = sp.getProperty("jvmflags");
 		testJavaFlags = sp.getProperty("testJavaFlags");
 		classpath = sp.getProperty("classpath");
@@ -1025,7 +1034,7 @@ public class RunTest
 		outputdir = sp.getProperty("outputdir");
 		if (outputdir == null)
 		    outputdir = "";
-		bootcp = sp.getProperty("bootcp");
+		
 		canondir = sp.getProperty("canondir");
 		canonpath = sp.getProperty("canonpath");
 
@@ -1048,6 +1057,16 @@ public class RunTest
 		else
 		    useprocess = true;
 		
+        // if the hostName is something other than localhost, we must
+        // be trying to connect to a remote server, and so, we should not
+        // try to create a new database.
+        // also, startServer should be false.
+		if (!hostName.equals("localhost"))
+		{
+        	useprocess=false;
+        	startServer=false;
+		}
+		
 		String nosed = sp.getProperty("skipsed");
 		if (nosed != null)
 		{
@@ -1519,7 +1538,6 @@ clp.list(System.out);
     		String suppFiles = ap.getProperty("supportfiles");
 			boolean copySupportFiles = ((suppFiles != null) && (suppFiles.length()>0));
 			boolean createExtDirs= new Boolean(ap.getProperty("useextdirs","false")).booleanValue();
-			
     		if (copySupportFiles || createExtDirs)
     		{
 				File copyOutDir = null;
@@ -2048,7 +2066,11 @@ clp.list(System.out);
                 defaultPackageName);
         
         if ( (framework != null) )
+        {
             jvmProps.addElement("framework=" + framework);
+            if ((hostName != null) && (!hostName.equals("localhost")))
+            		jvmProps.addElement("hostName=" + hostName);
+        }
             
         if ( (jvmflags != null) && (jvmflags.length()>0) )
         {
@@ -2237,6 +2259,10 @@ clp.list(System.out);
         Properties ptmp = System.getProperties();
         ptmp.put("derby.system.home", systemHome);
         ptmp.put("derby.infolog.append", "true");
+        // for framework tests, we may need to pick up the hostName 
+        // passed on on command line to individual tests...
+        if (framework.startsWith("DerbyNet"))
+        	ptmp.put("hostName=", hostName);
         System.setProperties(ptmp);
     	PrintStream stdout = System.out;
     	PrintStream stderr = System.err;
@@ -2255,6 +2281,7 @@ clp.list(System.out);
 	        fw.close();
 	        pathStr = tmpOutFile.getCanonicalPath().replace(File.separatorChar,fileSep);
 	    }
+	    
 
     	PrintStream ps = new PrintStream(new FileOutputStream(pathStr), true);
     	System.setOut(ps);
@@ -2301,7 +2328,9 @@ clp.list(System.out);
         else if (testType.equals("java"))
         {
             sysProp.put("user.dir", outDir.getCanonicalPath());
-            javaPath = "org.apache.derbyTesting.functionTests.tests." + testDirName;
+	    if (javaPath == null)
+	            javaPath = "org.apache.derbyTesting.functionTests.tests." + testDirName;
+	    
             String[] args = new String[2];
             args[0] = "-p";
             args[1] = propString;
@@ -2313,7 +2342,7 @@ clp.list(System.out);
             Method testMain = JavaTest.getMethod("main", classArray);
             Object[] argObj = new Object[1];
             argObj[0] = args;
-			RunClass testObject = new RunClass(JavaTest, testMain, argObj);
+			RunClass testObject = new RunClass(testMain, argObj);
 			Thread testThread = new Thread(testObject);
 			try
 			{
@@ -2324,7 +2353,7 @@ clp.list(System.out);
 				}
 				else
 				{
-					testThread.join(timeout * 1000);
+					testThread.join(timeout * 60 * 1000);
 				}
 			}
 			catch(Exception e)
@@ -2377,6 +2406,7 @@ clp.list(System.out);
             org.apache.derbyTesting.unitTests.harness.UnitTestMain.main(args);
             */
         }
+        
         ps.close();
         // Reset System.out and System.err
         System.setOut(stdout);
diff --git a/java/testing/org/apache/derbyTesting/functionTests/harness/Sed.java b/java/testing/org/apache/derbyTesting/functionTests/harness/Sed.java
index 998ca8d0f..e6ec8cdae 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/harness/Sed.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/harness/Sed.java
@@ -35,6 +35,7 @@ import org.apache.oro.text.regex.*;
 import java.util.Enumeration;
 import java.util.Properties;
 import java.util.StringTokenizer;
+import org.apache.derbyTesting.functionTests.util.TestUtil;
 
 public class Sed
 {
@@ -57,6 +58,8 @@ public class Sed
     public void exec(File srcFile, File dstFile, InputStream isSed, boolean isJCC, boolean isI18N)
         throws IOException
     {
+    	String hostName = TestUtil.getHostName();
+    	
         // Vector for storing lines to be deleted
         Vector deleteLines = new Vector();
         deleteLines.addElement("^ij version.*$");
@@ -165,6 +168,8 @@ public class Sed
         searchStrings.addElement("  DB2ConnectionCorrelator: [0-9A-Z.]*");
 		// Filter for SAX exception name diffs between jvms.
         searchStrings.addElement("org.xml.sax.SAX.*$");
+        // Filter out localhost, or hostName
+        searchStrings.addElement(hostName);
 
         Vector subStrings = new Vector();
         subStrings.addElement("Transaction:(XXX)|");
@@ -202,6 +207,8 @@ public class Sed
         subStrings.addElement("");
 		// Filter for SAX exception name diffs between jvms.
         subStrings.addElement("xxxFILTERED-SAX-EXCEPTIONxxx'.");
+        // Filter out localhost, or hostName
+        subStrings.addElement("xxxFILTERED_HOSTNAMExxx");
         doWork(srcFile, dstFile, null, deleteLines, searchStrings, subStrings, isSed, isI18N);
         
     } // end exec
diff --git a/java/testing/org/apache/derbyTesting/functionTests/harness/jvm.java b/java/testing/org/apache/derbyTesting/functionTests/harness/jvm.java
index 6deb6ed81..27f033855 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/harness/jvm.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/harness/jvm.java
@@ -105,6 +105,7 @@ public abstract class jvm {
     public String minorVersion = "";
     public int imajor = 0;
     public int iminor = 0;
+    String hostName;
 
 	// security defaults relative to WS
 	// not used if jvmargs serverPolicyFile or serverCodeBase are set
@@ -370,8 +371,11 @@ public abstract class jvm {
 		this.D.addElement(codebaseType + "=" + cb.toURL());
 		// file path to the codebase
 		this.D.addElement("csinfo.codedir=" + cb.getAbsolutePath());
-		this.D.addElement("csinfo.serverhost=localhost");
-		this.D.addElement("csinfo.trustedhost=localhost");	 
+		String hostName = (System.getProperty("hostName"));
+		if (hostName == null)
+			hostName="localhost";
+		this.D.addElement("csinfo.serverhost=" + hostName);
+		this.D.addElement("csinfo.trustedhost=" + hostName);	 
 		
 		// add an invalid path to the unused type 
 		this.D.addElement(unusedType + "=file://unused/");
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/LOBTest.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/LOBTest.out
index c21694096..33b2806c4 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/LOBTest.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/LOBTest.out
@@ -3871,3 +3871,4 @@ insert into blobCheck (bl ) values (cast (X'C8' as blob(80)) )
 insert into blobCheck (bl ) values ( X'a78a' )
 	ERROR 42821: Columns of type 'BLOB' cannot hold values of type 'CHAR () FOR BIT DATA'. 
 insert into blobCheck (bl ) values (cast (X'a78a' as blob(80)) )
+drop table blobCheck
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/blobclob4BLOB.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/blobclob4BLOB.out
index bcaa6f37a..91e82b67d 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/blobclob4BLOB.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/blobclob4BLOB.out
@@ -1,16 +1,16 @@
 Test blobclob starting
 START: prepareCLOBMAIN
-===> inserting extin/short.txt length = 56
-===> inserting extin/littleclob.txt length = 10000
-===> inserting extin/empty.txt length = 0
-===> inserting extin/searchclob.txt length = 5000
-===> inserting extin/aclob.txt length = 300000
+===> inserting short.txt length = 56
+===> inserting littleclob.txt length = 10000
+===> inserting empty.txt length = 0
+===> inserting searchclob.txt length = 5000
+===> inserting aclob.txt length = 300000
 START: prepareSearchClobTable
-===> inserting extin/short.txt length = 56
-===> inserting extin/littleclob.txt length = 10000
-===> inserting extin/empty.txt length = 0
-===> inserting extin/searchclob.txt length = 5000
-===> inserting extin/aclob.txt length = 300000
+===> inserting short.txt length = 56
+===> inserting littleclob.txt length = 10000
+===> inserting empty.txt length = 0
+===> inserting searchclob.txt length = 5000
+===> inserting aclob.txt length = 300000
 prepareSearchClobTable finished
 START: prepareUnicodeTable
 START: prepareUnicodeFile
@@ -524,17 +524,17 @@ clobTest95 finished
 START: clobTest96
 clobTest96 finished
 START: prepareBlobTable
-===> inserting extin/short.txt length = 56
-===> inserting extin/littleclob.txt length = 10000
-===> inserting extin/empty.txt length = 0
-===> inserting extin/searchclob.txt length = 5000
-===> inserting extin/aclob.txt length = 300000
+===> inserting short.txt length = 56
+===> inserting littleclob.txt length = 10000
+===> inserting empty.txt length = 0
+===> inserting searchclob.txt length = 5000
+===> inserting aclob.txt length = 300000
 START: prepareSearchBlobTable
-===> inserting extin/short.txt length = 56
-===> inserting extin/littleclob.txt length = 10000
-===> inserting extin/empty.txt length = 0
-===> inserting extin/searchclob.txt length = 5000
-===> inserting extin/aclob.txt length = 300000
+===> inserting short.txt length = 56
+===> inserting littleclob.txt length = 10000
+===> inserting empty.txt length = 0
+===> inserting searchclob.txt length = 5000
+===> inserting aclob.txt length = 300000
 START: blobTest0
 blobTest0 finished
 START: blobTest2
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/checkDriver.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/checkDriver.out
index 63f0363d7..a2e7230b2 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/checkDriver.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/checkDriver.out
@@ -2,6 +2,6 @@ jdbcCompliant() = true
 driver.getMajorVersion() = EXPECTED VERSION
 driver.getMinorVersion() = EXPECTED VERSION
 checking acceptsURL(jdbc:derby:wombat;create=true)
-checking acceptsURL(jdbc:derby://localhost:1527/wombat;create=true)
-checking acceptsURL(jdbc:derby:net://localhost:1527/wombat;create=true)
+checking acceptsURL(jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true)
+checking acceptsURL(jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true)
 checking acceptsURL(jdbc:db2j:wombat;create=true)
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/dataSourcePermissions_net.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/dataSourcePermissions_net.out
index bb3019427..d1c9faa14 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/dataSourcePermissions_net.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/dataSourcePermissions_net.out
@@ -35,4 +35,6 @@ ConnectionPoolDataSource with valid default user
 CP connected as EDWARD
 CP connected as FRANCES
 EXPECTED SHUTDOWN DB2 SQL error: SQLCODE: -1, SQLSTATE: 08006, SQLERRMC: Database 'wombat' shutdown.
+EXPECTED SHUTDOWN DB2 SQL error: SQLCODE: -1, SQLSTATE: 08006, SQLERRMC: Database 'wombat' shutdown.
+EXPECTED SHUTDOWN DB2 SQL error: SQLCODE: -1, SQLSTATE: 08006, SQLERRMC: Database 'wombat' shutdown.
 Completed dataSourcePermissions_net
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/dbMetaDataJdbc30.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/dbMetaDataJdbc30.out
index 795011d2f..ffba5d549 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/dbMetaDataJdbc30.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/dbMetaDataJdbc30.out
@@ -1,6 +1,6 @@
 Test dbMetaDataJdbc30 starting
 JDBC Driver 'IBM DB2 JDBC Universal Driver Architecture', version (EXPECTED VERSION)
-The URL is: jdbc:derby:net://localhost:1527/wombat;create=true
+The URL is: jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true
 supportsSavepoints() : true
 supportsNamedParameters() : false
 supportsMultipleOpenResults() : true
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/forupdate.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/forupdate.out
index 3a2683170..511a12c73 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/forupdate.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/forupdate.out
@@ -492,6 +492,8 @@ drop table t1;
 0 rows inserted/updated/deleted
 ij> drop table t2;
 0 rows inserted/updated/deleted
+ij> drop table t3;
+0 rows inserted/updated/deleted
 ij> -- bug 5643
 ----- JCC throws NPE when trying to execute a cursor after the resultset is closed
 autocommit off;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/holdCursorExternalSortJDBC30.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/holdCursorExternalSortJDBC30.out
index 932bc27b8..d65cc8964 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/holdCursorExternalSortJDBC30.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/holdCursorExternalSortJDBC30.out
@@ -342,4 +342,5 @@ ij> drop procedure WAIT_FOR_POST_COMMIT;
 0 rows inserted/updated/deleted
 ij> drop table foo;
 0 rows inserted/updated/deleted
+ij> commit;
 ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/holdCursorIJ.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/holdCursorIJ.out
index ac958c147..4f3a7d7e5 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/holdCursorIJ.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/holdCursorIJ.out
@@ -312,4 +312,6 @@ ij> update t1 set c12=c12+1 where current of scrollCursor;
 1 row inserted/updated/deleted
 ij> -- clean up.
 close scrollCursor;
+ij> drop table t1;
+0 rows inserted/updated/deleted
 ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/holdCursorJDBC30.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/holdCursorJDBC30.out
index a934afe77..808b6e786 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/holdCursorJDBC30.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/holdCursorJDBC30.out
@@ -1576,4 +1576,15 @@ ij> next test12;
 No current row
 ij> commit;
 ij> close test12;
+ij> drop table foo;
+0 rows inserted/updated/deleted
+ij> drop table t1;
+0 rows inserted/updated/deleted
+ij> drop table t2;
+0 rows inserted/updated/deleted
+ij> drop function padstring;
+0 rows inserted/updated/deleted
+ij> drop procedure wait_for_post_commit;
+0 rows inserted/updated/deleted
+ij> commit;
 ij> exit;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/metadata.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/metadata.out
index d5b9f76e4..fdc401ed0 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/metadata.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/metadata.out
@@ -10,7 +10,7 @@ Column result scale after division is: 23
 dc / 2 = 5.55000000000000000000000
 dc / 2 = 5.55500000000000000000000
 JDBC Driver 'IBM DB2 JDBC Universal Driver Architecture', version (EXPECTED VERSION)
-The URL is: jdbc:derby:net://localhost:1527/wombat;create=true
+The URL is: jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true
 allTablesAreSelectable(): true
 maxColumnNameLength(): 128
 getSchemas():
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/odbc_metadata.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/odbc_metadata.out
index 2b103c517..4b1d82da9 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/odbc_metadata.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/odbc_metadata.out
@@ -40,7 +40,7 @@ Column result scale after division is: 23
 dc / 2 = 5.55000000000000000000000
 dc / 2 = 5.55500000000000000000000
 JDBC Driver 'IBM DB2 JDBC Universal Driver Architecture', version (EXPECTED VERSION)
-The URL is: jdbc:derby:net://localhost:1527/wombat;create=true
+The URL is: jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true
 allTablesAreSelectable(): true
 maxColumnNameLength(): 128
 getSchemas():
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/optimizerOverrides.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/optimizerOverrides.out
index 9ba64d0e9..2229631db 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/optimizerOverrides.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/optimizerOverrides.out
@@ -967,4 +967,5 @@ ij> drop table t1;
 0 rows inserted/updated/deleted
 ij> drop table temp1;
 0 rows inserted/updated/deleted
+ij> commit;
 ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/secureUsers.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/secureUsers.out
index 0006f1665..0b49d4c7a 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/secureUsers.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/secureUsers.out
@@ -98,11 +98,11 @@ ij(CONNECTION2)> connect 'wombat;user=francois;password=paceesalute';
 ij(CONNECTION3)> -- Invalid ones:
 connect 'wombat;user=Jamie;password=theHooligan';
 ij(CONNECTION4)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/wombat;create=true;user=kreg;password=IwasBornReady
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/wombat;user=jeff;password=homeRun
-CONNECTION2 - 	jdbc:derby:net://localhost:1527/wombat;user=howardR;password=takeItEasy
-CONNECTION3 - 	jdbc:derby:net://localhost:1527/wombat;user=francois;password=paceesalute
-CONNECTION4* - 	jdbc:derby:net://localhost:1527/wombat;user=Jamie;password=theHooligan
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true;user=kreg;password=IwasBornReady
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=jeff;password=homeRun
+CONNECTION2 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=howardR;password=takeItEasy
+CONNECTION3 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=francois;password=paceesalute
+CONNECTION4* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=Jamie;password=theHooligan
 * = current connection
 ij(CONNECTION4)> connect 'guestSchemeDB;user=kreg;password=IwasBornReady';
 ij(CONNECTION5)> connect 'guestSchemeDB;user=jeff;password=homeRun';
@@ -111,16 +111,16 @@ ij(CONNECTION7)> connect 'guestSchemeDB;user=francois;password=paceesalute';
 ij(CONNECTION8)> -- Invalid ones:
 connect 'guestSchemeDB;user=Jamie;password=theHooligan';
 ij(CONNECTION9)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/wombat;create=true;user=kreg;password=IwasBornReady
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/wombat;user=jeff;password=homeRun
-CONNECTION2 - 	jdbc:derby:net://localhost:1527/wombat;user=howardR;password=takeItEasy
-CONNECTION3 - 	jdbc:derby:net://localhost:1527/wombat;user=francois;password=paceesalute
-CONNECTION4 - 	jdbc:derby:net://localhost:1527/wombat;user=Jamie;password=theHooligan
-CONNECTION5 - 	jdbc:derby:net://localhost:1527/guestSchemeDB;user=kreg;password=IwasBornReady
-CONNECTION6 - 	jdbc:derby:net://localhost:1527/guestSchemeDB;user=jeff;password=homeRun
-CONNECTION7 - 	jdbc:derby:net://localhost:1527/guestSchemeDB;user=howardR;password=takeItEasy
-CONNECTION8 - 	jdbc:derby:net://localhost:1527/guestSchemeDB;user=francois;password=paceesalute
-CONNECTION9* - 	jdbc:derby:net://localhost:1527/guestSchemeDB;user=Jamie;password=theHooligan
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true;user=kreg;password=IwasBornReady
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=jeff;password=homeRun
+CONNECTION2 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=howardR;password=takeItEasy
+CONNECTION3 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=francois;password=paceesalute
+CONNECTION4 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=Jamie;password=theHooligan
+CONNECTION5 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB;user=kreg;password=IwasBornReady
+CONNECTION6 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB;user=jeff;password=homeRun
+CONNECTION7 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB;user=howardR;password=takeItEasy
+CONNECTION8 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB;user=francois;password=paceesalute
+CONNECTION9* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB;user=Jamie;password=theHooligan
 * = current connection
 ij(CONNECTION9)> connect 'derbySchemeDB;user=mamta;password=ieScape';
 ij(CONNECTION10)> connect 'derbySchemeDB;user=dan;password=makeItFaster';
@@ -131,19 +131,19 @@ ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid
 ij(CONNECTION12)> connect 'derbySchemeDB;user=francois;password=paceesalute';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij(CONNECTION12)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/wombat;create=true;user=kreg;password=IwasBornReady
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/wombat;user=jeff;password=homeRun
-CONNECTION10 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=mamta;password=ieScape
-CONNECTION11 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=dan;password=makeItFaster
-CONNECTION12* - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=martin;password=obfuscateIt
-CONNECTION2 - 	jdbc:derby:net://localhost:1527/wombat;user=howardR;password=takeItEasy
-CONNECTION3 - 	jdbc:derby:net://localhost:1527/wombat;user=francois;password=paceesalute
-CONNECTION4 - 	jdbc:derby:net://localhost:1527/wombat;user=Jamie;password=theHooligan
-CONNECTION5 - 	jdbc:derby:net://localhost:1527/guestSchemeDB;user=kreg;password=IwasBornReady
-CONNECTION6 - 	jdbc:derby:net://localhost:1527/guestSchemeDB;user=jeff;password=homeRun
-CONNECTION7 - 	jdbc:derby:net://localhost:1527/guestSchemeDB;user=howardR;password=takeItEasy
-CONNECTION8 - 	jdbc:derby:net://localhost:1527/guestSchemeDB;user=francois;password=paceesalute
-CONNECTION9 - 	jdbc:derby:net://localhost:1527/guestSchemeDB;user=Jamie;password=theHooligan
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true;user=kreg;password=IwasBornReady
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=jeff;password=homeRun
+CONNECTION10 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=mamta;password=ieScape
+CONNECTION11 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=dan;password=makeItFaster
+CONNECTION12* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=martin;password=obfuscateIt
+CONNECTION2 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=howardR;password=takeItEasy
+CONNECTION3 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=francois;password=paceesalute
+CONNECTION4 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=Jamie;password=theHooligan
+CONNECTION5 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB;user=kreg;password=IwasBornReady
+CONNECTION6 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB;user=jeff;password=homeRun
+CONNECTION7 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB;user=howardR;password=takeItEasy
+CONNECTION8 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB;user=francois;password=paceesalute
+CONNECTION9 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB;user=Jamie;password=theHooligan
 * = current connection
 ij(CONNECTION12)> connect 'simpleSchemeDB;user=jeff;password=homeRun';
 ij(CONNECTION13)> connect 'simpleSchemeDB;user=howardR;password=takeItEasy';
@@ -159,22 +159,22 @@ ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid
 ij(CONNECTION15)> connect 'simpleSchemeDB;user=francois;password=corsica';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij(CONNECTION15)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/wombat;create=true;user=kreg;password=IwasBornReady
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/wombat;user=jeff;password=homeRun
-CONNECTION10 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=mamta;password=ieScape
-CONNECTION11 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=dan;password=makeItFaster
-CONNECTION12 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=martin;password=obfuscateIt
-CONNECTION13 - 	jdbc:derby:net://localhost:1527/simpleSchemeDB;user=jeff;password=homeRun
-CONNECTION14 - 	jdbc:derby:net://localhost:1527/simpleSchemeDB;user=howardR;password=takeItEasy
-CONNECTION15* - 	jdbc:derby:net://localhost:1527/simpleSchemeDB;user=francois;password=paceesalute
-CONNECTION2 - 	jdbc:derby:net://localhost:1527/wombat;user=howardR;password=takeItEasy
-CONNECTION3 - 	jdbc:derby:net://localhost:1527/wombat;user=francois;password=paceesalute
-CONNECTION4 - 	jdbc:derby:net://localhost:1527/wombat;user=Jamie;password=theHooligan
-CONNECTION5 - 	jdbc:derby:net://localhost:1527/guestSchemeDB;user=kreg;password=IwasBornReady
-CONNECTION6 - 	jdbc:derby:net://localhost:1527/guestSchemeDB;user=jeff;password=homeRun
-CONNECTION7 - 	jdbc:derby:net://localhost:1527/guestSchemeDB;user=howardR;password=takeItEasy
-CONNECTION8 - 	jdbc:derby:net://localhost:1527/guestSchemeDB;user=francois;password=paceesalute
-CONNECTION9 - 	jdbc:derby:net://localhost:1527/guestSchemeDB;user=Jamie;password=theHooligan
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true;user=kreg;password=IwasBornReady
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=jeff;password=homeRun
+CONNECTION10 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=mamta;password=ieScape
+CONNECTION11 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=dan;password=makeItFaster
+CONNECTION12 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=martin;password=obfuscateIt
+CONNECTION13 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/simpleSchemeDB;user=jeff;password=homeRun
+CONNECTION14 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/simpleSchemeDB;user=howardR;password=takeItEasy
+CONNECTION15* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/simpleSchemeDB;user=francois;password=paceesalute
+CONNECTION2 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=howardR;password=takeItEasy
+CONNECTION3 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=francois;password=paceesalute
+CONNECTION4 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=Jamie;password=theHooligan
+CONNECTION5 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB;user=kreg;password=IwasBornReady
+CONNECTION6 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB;user=jeff;password=homeRun
+CONNECTION7 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB;user=howardR;password=takeItEasy
+CONNECTION8 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB;user=francois;password=paceesalute
+CONNECTION9 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB;user=Jamie;password=theHooligan
 * = current connection
 ij(CONNECTION15)> disconnect all;
 ij> show connections;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/secureUsersldap.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/secureUsersldap.out
index 4a160d21f..956253329 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/secureUsersldap.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/secureUsersldap.out
@@ -93,9 +93,9 @@ ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid
 ij(CONNECTION2)> connect 'derbySchemeDB;user=francois;password=paceesalute';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij(CONNECTION2)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=mamta;password=ieScape
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=dan;password=makeItFaster
-CONNECTION2* - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=martin;password=obfuscateIt
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=mamta;password=ieScape
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=dan;password=makeItFaster
+CONNECTION2* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=martin;password=obfuscateIt
 * = current connection
 ij(CONNECTION2)> --
 ----- 1rst test phase for LDAP
@@ -114,9 +114,9 @@ ij(CONNECTION2)> -- wrong ldap password
 connect 'ldapSchemeDB;user=francois;password=paceesalute';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij(CONNECTION2)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=mamta;password=ieScape
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=dan;password=makeItFaster
-CONNECTION2* - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=martin;password=obfuscateIt
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=mamta;password=ieScape
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=dan;password=makeItFaster
+CONNECTION2* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=martin;password=obfuscateIt
 * = current connection
 ij(CONNECTION2)> --
 ----- 2nd test phases for LDAP - Cache the User DN locally
@@ -134,9 +134,9 @@ Statement executed.
 ij(CONNECTION2)> execute p5 using 'values(''derby.user.francois'', ''uid=francois,ou=People,o=opensource.apache.com'')';
 Statement executed.
 ij(CONNECTION2)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=mamta;password=ieScape
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=dan;password=makeItFaster
-CONNECTION2* - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=martin;password=obfuscateIt
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=mamta;password=ieScape
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=dan;password=makeItFaster
+CONNECTION2* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=martin;password=obfuscateIt
 * = current connection
 ij(CONNECTION2)> commit;
 ij(CONNECTION2)> autocommit on;
@@ -157,9 +157,9 @@ ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid
 ij(CONNECTION2)> connect 'ldapSchemeDB;user=rachael;password=rachaelF';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij(CONNECTION2)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=mamta;password=ieScape
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=dan;password=makeItFaster
-CONNECTION2* - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=martin;password=obfuscateIt
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=mamta;password=ieScape
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=dan;password=makeItFaster
+CONNECTION2* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=martin;password=obfuscateIt
 * = current connection
 ij(CONNECTION2)> -- Invalid ones:
 connect 'ldapSchemeDB;user=Jamie;password=theHooligan';
@@ -170,9 +170,9 @@ ij(CONNECTION2)> -- wrong ldap password
 connect 'ldapSchemeDB;user=francois;password=paceesalute';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij(CONNECTION2)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=mamta;password=ieScape
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=dan;password=makeItFaster
-CONNECTION2* - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=martin;password=obfuscateIt
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=mamta;password=ieScape
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=dan;password=makeItFaster
+CONNECTION2* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=martin;password=obfuscateIt
 * = current connection
 ij(CONNECTION2)> -- Database shutdown - check user - should fail
 connect 'derbySchemeDB;shutdown=true';
@@ -180,9 +180,9 @@ ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid
 ij(CONNECTION2)> connect 'ldapSchemeDB;user=jamie;password=LetMeIn;shutdown=true';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij(CONNECTION2)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=mamta;password=ieScape
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=dan;password=makeItFaster
-CONNECTION2* - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=martin;password=obfuscateIt
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=mamta;password=ieScape
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=dan;password=makeItFaster
+CONNECTION2* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=martin;password=obfuscateIt
 * = current connection
 ij(CONNECTION2)> -- Database shutdown - check user - should succeed
 connect 'derbySchemeDB;user=mamta;password=ieScape;shutdown=true';
@@ -190,9 +190,9 @@ ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid
 ij(CONNECTION2)> connect 'ldapSchemeDB;user=mamta;password=yeeHaLdap;shutdown=true';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij(CONNECTION2)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=mamta;password=ieScape
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=dan;password=makeItFaster
-CONNECTION2* - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=martin;password=obfuscateIt
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=mamta;password=ieScape
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=dan;password=makeItFaster
+CONNECTION2* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=martin;password=obfuscateIt
 * = current connection
 ij(CONNECTION2)> -- Derby system shutdown - check user - should fail
 connect ';user=jamie;password=LetMeIn;shutdown=true';
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/supersimple.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/supersimple.out
index 1671c0ac6..2cc10e1cb 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/supersimple.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/supersimple.out
@@ -123,9 +123,18 @@ ij> drop table a;
 0 rows inserted/updated/deleted
 ij> -- Bug 4694 Test automatic rollback with close of connection
 ----- in ij
-autocommit off;
-ij> create table a (a int);
+connect 'wombat';
+ij(CONNECTION1)> autocommit off;
+ij(CONNECTION1)> create table a (a int);
 0 rows inserted/updated/deleted
+ij(CONNECTION1)> select count(*) from a;
+1          
+-----
+0          
+ij(CONNECTION1)> disconnect;
+ij> set connection connection0;
+ij> select count(*) from a;
+ERROR 42X05: Table 'A' does not exist.
 ij> -- Bug 4758 - Store error does not return properly to client
 autocommit off;
 ij> create table t (i int);
@@ -176,4 +185,10 @@ C2
 some clob 
 ij(CONNECTION1)> drop table t1;
 0 rows inserted/updated/deleted
-ij(CONNECTION1)> 
+ij(CONNECTION1)> commit;
+ij(CONNECTION1)> disconnect;
+ij> set connection connection0;
+ij> autocommit on;
+ij> drop table t;
+0 rows inserted/updated/deleted
+ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/sysinfo.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/sysinfo.out
index cc28eb3ad..3eff42f01 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/sysinfo.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/sysinfo.out
@@ -9,7 +9,7 @@ derby.drda.portNumber=1527
 derby.drda.logConnections=false
 derby.drda.timeSlice=0
 derby.drda.startNetworkServer=false
-derby.drda.host=localhost
+derby.drda.host=xxxFILTERED_HOSTNAMExxx
 derby.drda.traceAll=false
 ----- Derby Information --------
 -----
@@ -36,7 +36,7 @@ derby.drda.portNumber=1527
 derby.drda.logConnections=false
 derby.drda.timeSlice=0
 derby.drda.startNetworkServer=false
-derby.drda.host=localhost
+derby.drda.host=xxxFILTERED_HOSTNAMExxx
 derby.drda.traceAll=false
 ----- Derby Information --------
 -----
@@ -64,7 +64,7 @@ derby.drda.portNumber=1527
 derby.drda.logConnections=false
 derby.drda.timeSlice=0
 derby.drda.startNetworkServer=false
-derby.drda.host=localhost
+derby.drda.host=xxxFILTERED_HOSTNAMExxx
 derby.drda.traceAll=false
 ----- Derby Information --------
 -----
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/testSecMec.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/testSecMec.out
index cfe7e6cc7..55e33e147 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/testSecMec.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/testSecMec.out
@@ -1,9 +1,9 @@
 Checking security mechanism authentication with DriverManager
-T4: jdbc:derby:net://localhost:20000/wombat;create=true:user=neelima;password=lee;securityMechanism=3;
-T1: jdbc:derby:net://localhost:20000/wombat - EXCEPTION null userid not supported
-T2: jdbc:derby:net://localhost:20000/wombat:user=max; - EXCEPTION null password not supported
-T3: jdbc:derby:net://localhost:20000/wombat:user=neelima;password=lee;
-T6: jdbc:derby:net://localhost:20000/wombat:user=neelima;securityMechanism=4;
-T8: jdbc:derby:net://localhost:20000/wombat:user=neelima;password=lee;securityMechanism=4;
+T4: jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:xxxFILTEREDPORTxxx/wombat;create=true:user=neelima;password=lee;securityMechanism=3;
+T1: jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:xxxFILTEREDPORTxxx/wombat - EXCEPTION null userid not supported
+T2: jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:xxxFILTEREDPORTxxx/wombat:user=max; - EXCEPTION null password not supported
+T3: jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:xxxFILTEREDPORTxxx/wombat:user=neelima;password=lee;
+T6: jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:xxxFILTEREDPORTxxx/wombat:user=neelima;securityMechanism=4;
+T8: jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:xxxFILTEREDPORTxxx/wombat:user=neelima;password=lee;securityMechanism=4;
 SECMEC_USRIDPWD: OK
 Completed testSecMec
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/users.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/users.out
index c19d30534..9403f465c 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/users.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/users.out
@@ -36,11 +36,11 @@ ij(CONNECTION1)> connect 'wombat;user=ames;password=AnyVolunteer?';
 ij(CONNECTION2)> connect 'wombat;user=howardR;password=IamBetterAtTennis';
 ij(CONNECTION3)> connect 'wombat;user=francois;password=paceesalute';
 ij(CONNECTION4)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/wombat;user=kreg;password=visualWhat?
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/wombat;user=jeff;password=HomeRun61
-CONNECTION2 - 	jdbc:derby:net://localhost:1527/wombat;user=ames;password=AnyVolunteer?
-CONNECTION3 - 	jdbc:derby:net://localhost:1527/wombat;user=howardR;password=IamBetterAtTennis
-CONNECTION4* - 	jdbc:derby:net://localhost:1527/wombat;user=francois;password=paceesalute
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=kreg;password=visualWhat?
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=jeff;password=HomeRun61
+CONNECTION2 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=ames;password=AnyVolunteer?
+CONNECTION3 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=howardR;password=IamBetterAtTennis
+CONNECTION4* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=francois;password=paceesalute
 * = current connection
 ij(CONNECTION4)> disconnect all;
 ij> -- check allowed users in myDB db.
@@ -84,12 +84,12 @@ FRANCOIS
 ij(CONNECTION5)> update APP.t1 set c1 = USER;
 ERROR 23513: The check constraint 'xxxxGENERATED-IDxxxx' was violated while performing an INSERT or UPDATE on table 'APP.T1'.
 ij(CONNECTION5)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/myDB;user=jerry;password=SacreBleu
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/myDB;user=kreg;password=visualWhat?
-CONNECTION2 - 	jdbc:derby:net://localhost:1527/myDB;user=ames;password=AnyVolunteer?
-CONNECTION3 - 	jdbc:derby:net://localhost:1527/myDB;user=dan;password=MakeItFaster
-CONNECTION4 - 	jdbc:derby:net://localhost:1527/myDB;user=francois;password=paceesalute
-CONNECTION5* - 	jdbc:derby:net://localhost:1527/myDB;user=jamie;password=MrNamePlates
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/myDB;user=jerry;password=SacreBleu
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/myDB;user=kreg;password=visualWhat?
+CONNECTION2 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/myDB;user=ames;password=AnyVolunteer?
+CONNECTION3 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/myDB;user=dan;password=MakeItFaster
+CONNECTION4 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/myDB;user=francois;password=paceesalute
+CONNECTION5* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/myDB;user=jamie;password=MrNamePlates
 * = current connection
 ij(CONNECTION5)> disconnect all;
 ij> --
@@ -127,8 +127,8 @@ ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid
 ij(CONNECTION1)> connect 'wombat;user=jerry;password=SacreBleu;shutdown=true';
 ERROR 04501: Database connection refused.
 ij(CONNECTION1)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/wombat;user=francois;password=paceesalute
-CONNECTION1* - 	jdbc:derby:net://localhost:1527/myDB;user=jerry;password=SacreBleu
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=francois;password=paceesalute
+CONNECTION1* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/myDB;user=jerry;password=SacreBleu
 * = current connection
 ij(CONNECTION1)> -- Database shutdown - check user - should succeed
 ----- beetle 5367
@@ -137,8 +137,8 @@ ERROR 08006: Database 'wombat' shutdown.
 ij(CONNECTION1)> connect 'myDB;user=jerry;password=SacreBleu;shutdown=true';
 ERROR 08006: Database 'myDB' shutdown.
 ij(CONNECTION1)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/wombat;user=francois;password=paceesalute
-CONNECTION1* - 	jdbc:derby:net://localhost:1527/myDB;user=jerry;password=SacreBleu
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=francois;password=paceesalute
+CONNECTION1* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/myDB;user=jerry;password=SacreBleu
 * = current connection
 ij(CONNECTION1)> -- JBMS System shutdown - check user - should fail
 connect ';user=jamie;password=LetMeIn;shutdown=true';
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/users2.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/users2.out
index e878c869a..803f68a76 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/users2.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/users2.out
@@ -72,12 +72,12 @@ ERROR 25502: An SQL data change is not permitted for a read-only connection, use
 ij(CONNECTION5)> create table APP.t2(c1 char(30));
 ERROR 25503: DDL is not permitted for a read-only connection, user or database.
 ij(CONNECTION5)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/wombat;user=system;password=manager
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/wombat;user=kreg;password=visualWhat?
-CONNECTION2 - 	jdbc:derby:net://localhost:1527/wombat;user=jeff;password=HomeRun61
-CONNECTION3 - 	jdbc:derby:net://localhost:1527/wombat;user=ames;password=AnyVolunteer?
-CONNECTION4 - 	jdbc:derby:net://localhost:1527/wombat;user=howardR;password=IamBetterAtTennis
-CONNECTION5* - 	jdbc:derby:net://localhost:1527/wombat;user=jamie;password=MrNamePlates
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=system;password=manager
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=kreg;password=visualWhat?
+CONNECTION2 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=jeff;password=HomeRun61
+CONNECTION3 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=ames;password=AnyVolunteer?
+CONNECTION4 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=howardR;password=IamBetterAtTennis
+CONNECTION5* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=jamie;password=MrNamePlates
 * = current connection
 ij(CONNECTION5)> disconnect all;
 ij> -- check allowed users in myDB db.
@@ -169,13 +169,13 @@ FRANCOIS
 ij(CONNECTION6)> update APP.t1 set c1 = USER;
 ERROR 23513: The check constraint 'xxxxGENERATED-IDxxxx' was violated while performing an INSERT or UPDATE on table 'APP.T1'.
 ij(CONNECTION6)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/myDB;user=system;password=manager
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/myDB;user=jerry;password=SacreBleu
-CONNECTION2 - 	jdbc:derby:net://localhost:1527/myDB;user=kreg;password=visualWhat?
-CONNECTION3 - 	jdbc:derby:net://localhost:1527/myDB;user=ames;password=AnyVolunteer?
-CONNECTION4 - 	jdbc:derby:net://localhost:1527/myDB;user=dan;password=MakeItFaster
-CONNECTION5 - 	jdbc:derby:net://localhost:1527/myDB;user=francois;password=paceesalute
-CONNECTION6* - 	jdbc:derby:net://localhost:1527/myDB;user=jamie;password=MrNamePlates
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/myDB;user=system;password=manager
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/myDB;user=jerry;password=SacreBleu
+CONNECTION2 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/myDB;user=kreg;password=visualWhat?
+CONNECTION3 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/myDB;user=ames;password=AnyVolunteer?
+CONNECTION4 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/myDB;user=dan;password=MakeItFaster
+CONNECTION5 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/myDB;user=francois;password=paceesalute
+CONNECTION6* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/myDB;user=jamie;password=MrNamePlates
 * = current connection
 ij(CONNECTION6)> disconnect all;
 ij> --
@@ -201,7 +201,7 @@ ij> connect 'wombat;user=jerry;password=SacreBleu';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij> connect 'wombat;user=jamie;password=MrNamePlates';
 ij> show connections;
-CONNECTION0* - 	jdbc:derby:net://localhost:1527/wombat;user=jamie;password=MrNamePlates
+CONNECTION0* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=jamie;password=MrNamePlates
 * = current connection
 ij> connect 'wombat;user=francois;password=paceesalute';
 ij(CONNECTION1)> connect 'myDB;user=jerry;password=SacreBleu';
@@ -213,9 +213,9 @@ ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid
 ij(CONNECTION2)> connect 'wombat;user=jerry;password=SacreBleu;shutdown=true';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij(CONNECTION2)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/wombat;user=jamie;password=MrNamePlates
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/wombat;user=francois;password=paceesalute
-CONNECTION2* - 	jdbc:derby:net://localhost:1527/myDB;user=jerry;password=SacreBleu
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=jamie;password=MrNamePlates
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;user=francois;password=paceesalute
+CONNECTION2* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/myDB;user=jerry;password=SacreBleu
 * = current connection
 ij(CONNECTION2)> disconnect all;
 ij> show connections;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/wisconsin.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/wisconsin.out
index 33e40c2f1..c193490d6 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/wisconsin.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/wisconsin.out
@@ -30661,4 +30661,15 @@ None
 	Ordered null semantics on the following columns: 
 				qualifiers:
 None
+ij> -- cleanup
+drop table TENKTUP1;
+0 rows inserted/updated/deleted
+ij> drop table TENKTUP2;
+0 rows inserted/updated/deleted
+ij> drop table ONEKTUP;
+0 rows inserted/updated/deleted
+ij> drop table BPRIME;
+0 rows inserted/updated/deleted
+ij> drop procedure WISCINSERT;
+0 rows inserted/updated/deleted
 ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/LOBTest.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/LOBTest.out
index 86fc3d0e7..f6f882d90 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/LOBTest.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/LOBTest.out
@@ -3871,3 +3871,4 @@ insert into blobCheck (bl ) values (cast (X'C8' as blob(80)) )
 insert into blobCheck (bl ) values ( X'a78a' )
 	ERROR 42821: Columns of type 'BLOB' cannot hold values of type 'CHAR () FOR BIT DATA'. 
 insert into blobCheck (bl ) values (cast (X'a78a' as blob(80)) )
+drop table blobCheck
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/blobclob4BLOB.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/blobclob4BLOB.out
index bcaa6f37a..91e82b67d 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/blobclob4BLOB.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/blobclob4BLOB.out
@@ -1,16 +1,16 @@
 Test blobclob starting
 START: prepareCLOBMAIN
-===> inserting extin/short.txt length = 56
-===> inserting extin/littleclob.txt length = 10000
-===> inserting extin/empty.txt length = 0
-===> inserting extin/searchclob.txt length = 5000
-===> inserting extin/aclob.txt length = 300000
+===> inserting short.txt length = 56
+===> inserting littleclob.txt length = 10000
+===> inserting empty.txt length = 0
+===> inserting searchclob.txt length = 5000
+===> inserting aclob.txt length = 300000
 START: prepareSearchClobTable
-===> inserting extin/short.txt length = 56
-===> inserting extin/littleclob.txt length = 10000
-===> inserting extin/empty.txt length = 0
-===> inserting extin/searchclob.txt length = 5000
-===> inserting extin/aclob.txt length = 300000
+===> inserting short.txt length = 56
+===> inserting littleclob.txt length = 10000
+===> inserting empty.txt length = 0
+===> inserting searchclob.txt length = 5000
+===> inserting aclob.txt length = 300000
 prepareSearchClobTable finished
 START: prepareUnicodeTable
 START: prepareUnicodeFile
@@ -524,17 +524,17 @@ clobTest95 finished
 START: clobTest96
 clobTest96 finished
 START: prepareBlobTable
-===> inserting extin/short.txt length = 56
-===> inserting extin/littleclob.txt length = 10000
-===> inserting extin/empty.txt length = 0
-===> inserting extin/searchclob.txt length = 5000
-===> inserting extin/aclob.txt length = 300000
+===> inserting short.txt length = 56
+===> inserting littleclob.txt length = 10000
+===> inserting empty.txt length = 0
+===> inserting searchclob.txt length = 5000
+===> inserting aclob.txt length = 300000
 START: prepareSearchBlobTable
-===> inserting extin/short.txt length = 56
-===> inserting extin/littleclob.txt length = 10000
-===> inserting extin/empty.txt length = 0
-===> inserting extin/searchclob.txt length = 5000
-===> inserting extin/aclob.txt length = 300000
+===> inserting short.txt length = 56
+===> inserting littleclob.txt length = 10000
+===> inserting empty.txt length = 0
+===> inserting searchclob.txt length = 5000
+===> inserting aclob.txt length = 300000
 START: blobTest0
 blobTest0 finished
 START: blobTest2
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/checkDriver.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/checkDriver.out
index fe6d1bd66..c5b1603da 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/checkDriver.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/checkDriver.out
@@ -2,52 +2,52 @@ jdbcCompliant() = true
 driver.getMajorVersion() = EXPECTED VERSION
 driver.getMinorVersion() = EXPECTED VERSION
 checking acceptsURL(jdbc:derby:wombat;create=true)
-checking acceptsURL(jdbc:derby://localhost:1527/wombat;create=true)
-checking acceptsURL(jdbc:derby:net://localhost:1527/wombat;create=true)
+checking acceptsURL(jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true)
+checking acceptsURL(jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true)
 checking acceptsURL(jdbc:db2j:wombat;create=true)
 testEmbeddedAttributes()
-Connection info for connect(jdbc:derby://localhost:1527/testcreatedb1, {create=true})
-getURL() = jdbc:derby://localhost:1527/testcreatedb1;create=true
+Connection info for connect(jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/testcreatedb1, {create=true})
+getURL() = jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/testcreatedb1;create=true
 getUserName() = APP
 CURRENT SCHEMA = APP
-Connection info for connect(jdbc:derby://localhost:1527/testcreatedb2;create=true, null)
-getURL() = jdbc:derby://localhost:1527/testcreatedb2;create=true
+Connection info for connect(jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/testcreatedb2;create=true, null)
+getURL() = jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/testcreatedb2;create=true
 getUserName() = APP
 CURRENT SCHEMA = APP
-Connection info for connect(jdbc:derby://localhost:1527/testpropdb, {user=APP, password=xxxx})
-getURL() = jdbc:derby://localhost:1527/testpropdb
+Connection info for connect(jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/testpropdb, {user=APP, password=xxxx})
+getURL() = jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/testpropdb
 getUserName() = APP
 CURRENT SCHEMA = APP
-Connection info for connect(jdbc:derby://localhost:1527/testpropdb;user=testuser;password=testpass, null)
-getURL() = jdbc:derby://localhost:1527/testpropdb
+Connection info for connect(jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/testpropdb;user=testuser;password=testpass, null)
+getURL() = jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/testpropdb
 getUserName() = testuser
 CURRENT SCHEMA = TESTUSER
-Connection info for connect(jdbc:derby://localhost:1527/testpropdb;user=testusr, {password=testpass})
-getURL() = jdbc:derby://localhost:1527/testpropdb
+Connection info for connect(jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/testpropdb;user=testusr, {password=testpass})
+getURL() = jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/testpropdb
 getUserName() = testusr
 CURRENT SCHEMA = TESTUSR
-Connection info for connect(jdbc:derby://localhost:1527/testpropdb;user=testuser;password=testpass, null)
-getURL() = jdbc:derby://localhost:1527/testpropdb
+Connection info for connect(jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/testpropdb;user=testuser;password=testpass, null)
+getURL() = jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/testpropdb
 getUserName() = testuser
 CURRENT SCHEMA = TESTUSER
 Expected Exception:08006:DERBY SQL error: SQLCODE: -1, SQLSTATE: 08006, SQLERRMC: Database 'testcreatedb1' shutdown.
 testClientAttributes()
-Connection info for connect(jdbc:derby://localhost:1527/testpropdb;traceFile=[DERBY_SYSTEM_HOME]/trace.out, {})
-getURL() = jdbc:derby://localhost:1527/testpropdb;traceFile=[DERBY_SYSTEM_HOME]/trace.out
+Connection info for connect(jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/testpropdb;traceFile=[DERBY_SYSTEM_HOME]/trace.out, {})
+getURL() = jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/testpropdb;traceFile=[DERBY_SYSTEM_HOME]/trace.out
 getUserName() = APP
 CURRENT SCHEMA = APP
  trace file exists
-Connection info for connect(jdbc:derby://localhost:1527/testpropdb, {traceFile=[DERBY_SYSTEM_HOME]/trace2.out})
-getURL() = jdbc:derby://localhost:1527/testpropdb;traceFile=[DERBY_SYSTEM_HOME]/trace2.out
+Connection info for connect(jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/testpropdb, {traceFile=[DERBY_SYSTEM_HOME]/trace2.out})
+getURL() = jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/testpropdb;traceFile=[DERBY_SYSTEM_HOME]/trace2.out
 getUserName() = APP
 CURRENT SCHEMA = APP
  trace file exists
 doClientURLTest()
-doClientURLTest with url: jdbc:derby://localhost:1527/wombat:create=true
-Null connection returned for url jdbc:derby://localhost:1527/wombat:create=true
-doClientURLTest with url: jdbc:derby://localhost:1527/'wombat';create=true
-Connection info for connect(jdbc:derby://localhost:1527/'wombat';create=true, null)
-getURL() = jdbc:derby://localhost:1527/'wombat';create=true
+doClientURLTest with url: jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat:create=true
+Null connection returned for url jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat:create=true
+doClientURLTest with url: jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/'wombat';create=true
+Connection info for connect(jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/'wombat';create=true, null)
+getURL() = jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/'wombat';create=true
 getUserName() = APP
 CURRENT SCHEMA = APP
-PASSED:Connection Successful with url: jdbc:derby://localhost:1527/'wombat';create=true
+PASSED:Connection Successful with url: jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/'wombat';create=true
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/dataSourcePermissions_net.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/dataSourcePermissions_net.out
index 2f9a0d90c..8698ed539 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/dataSourcePermissions_net.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/dataSourcePermissions_net.out
@@ -58,4 +58,6 @@ No username, no password test: PASS.
 Turning on authentication
 EXPECTED SHUTDOWN DERBY SQL error: SQLCODE: -1, SQLSTATE: 08006, SQLERRMC: Database 'wombat' shutdown.
 End username and password tests
+EXPECTED SHUTDOWN DERBY SQL error: SQLCODE: -1, SQLSTATE: 08006, SQLERRMC: Database 'wombat' shutdown.
+EXPECTED SHUTDOWN DERBY SQL error: SQLCODE: -1, SQLSTATE: 08006, SQLERRMC: Database 'wombat' shutdown.
 Completed dataSourcePermissions_net
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/dbMetaDataJdbc30.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/dbMetaDataJdbc30.out
index e53aecaf5..71e6e145d 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/dbMetaDataJdbc30.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/dbMetaDataJdbc30.out
@@ -1,6 +1,6 @@
 Test dbMetaDataJdbc30 starting
 JDBC Driver 'Apache Derby Network Client JDBC Driver', version 10.2 (10.2.0.0 alpha)
-The URL is: jdbc:derby://localhost:1527/wombat;create=true
+The URL is: jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true
 supportsSavepoints() : true
 supportsNamedParameters() : false
 supportsMultipleOpenResults() : true
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/forupdate.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/forupdate.out
index f8b9e1aa9..d7cabde2e 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/forupdate.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/forupdate.out
@@ -492,6 +492,8 @@ drop table t1;
 0 rows inserted/updated/deleted
 ij> drop table t2;
 0 rows inserted/updated/deleted
+ij> drop table t3;
+0 rows inserted/updated/deleted
 ij> -- bug 5643
 ----- JCC throws NPE when trying to execute a cursor after the resultset is closed
 autocommit off;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/holdCursorExternalSortJDBC30.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/holdCursorExternalSortJDBC30.out
index 932bc27b8..d65cc8964 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/holdCursorExternalSortJDBC30.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/holdCursorExternalSortJDBC30.out
@@ -342,4 +342,5 @@ ij> drop procedure WAIT_FOR_POST_COMMIT;
 0 rows inserted/updated/deleted
 ij> drop table foo;
 0 rows inserted/updated/deleted
+ij> commit;
 ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/holdCursorIJ.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/holdCursorIJ.out
index b048c422f..e399dfb44 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/holdCursorIJ.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/holdCursorIJ.out
@@ -312,4 +312,6 @@ ij> update t1 set c12=c12+1 where current of scrollCursor;
 1 row inserted/updated/deleted
 ij> -- clean up.
 close scrollCursor;
+ij> drop table t1;
+0 rows inserted/updated/deleted
 ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/holdCursorJDBC30.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/holdCursorJDBC30.out
index bf7c599c3..92f49dfe3 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/holdCursorJDBC30.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/holdCursorJDBC30.out
@@ -1576,4 +1576,15 @@ ij> next test12;
 No current row
 ij> commit;
 ij> close test12;
+ij> drop table foo;
+0 rows inserted/updated/deleted
+ij> drop table t1;
+0 rows inserted/updated/deleted
+ij> drop table t2;
+0 rows inserted/updated/deleted
+ij> drop function padstring;
+0 rows inserted/updated/deleted
+ij> drop procedure wait_for_post_commit;
+0 rows inserted/updated/deleted
+ij> commit;
 ij> exit;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/metadata.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/metadata.out
index 6835edfbf..b82182d4b 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/metadata.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/metadata.out
@@ -10,7 +10,7 @@ Column result scale after division is: 23
 dc / 2 = 5.55000000000000000000000
 dc / 2 = 5.55500000000000000000000
 JDBC Driver 'Apache Derby Network Client JDBC Driver', version 10.2 (10.2.0.0 alpha)
-The URL is: jdbc:derby://localhost:1527/wombat;create=true
+The URL is: jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true
 allTablesAreSelectable(): true
 maxColumnNameLength(): 128
 getSchemas():
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/odbc_metadata.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/odbc_metadata.out
index a074aae98..01a8cc2b8 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/odbc_metadata.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/odbc_metadata.out
@@ -40,7 +40,7 @@ Column result scale after division is: 23
 dc / 2 = 5.55000000000000000000000
 dc / 2 = 5.55500000000000000000000
 JDBC Driver 'Apache Derby Network Client JDBC Driver', version 10.2 (10.2.0.0 alpha)
-The URL is: jdbc:derby://localhost:1527/wombat;create=true
+The URL is: jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true
 allTablesAreSelectable(): true
 maxColumnNameLength(): 128
 getSchemas():
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/optimizerOverrides.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/optimizerOverrides.out
index 4f04e5545..dbb843570 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/optimizerOverrides.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/optimizerOverrides.out
@@ -976,4 +976,5 @@ ij> drop table t1;
 0 rows inserted/updated/deleted
 ij> drop table temp1;
 0 rows inserted/updated/deleted
+ij> commit;
 ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/secureUsers.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/secureUsers.out
index a1938e543..902a7bb07 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/secureUsers.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/secureUsers.out
@@ -98,11 +98,11 @@ ij(CONNECTION2)> connect 'wombat;user=francois;password=paceesalute';
 ij(CONNECTION3)> -- Invalid ones:
 connect 'wombat;user=Jamie;password=theHooligan';
 ij(CONNECTION4)> show connections;
-CONNECTION0 - 	jdbc:derby://localhost:1527/wombat;create=true
-CONNECTION1 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION2 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION3 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION4* - 	jdbc:derby://localhost:1527/wombat
+CONNECTION0 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true
+CONNECTION1 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION2 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION3 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION4* - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
 * = current connection
 ij(CONNECTION4)> connect 'guestSchemeDB;user=kreg;password=IwasBornReady';
 ij(CONNECTION5)> connect 'guestSchemeDB;user=jeff;password=homeRun';
@@ -111,16 +111,16 @@ ij(CONNECTION7)> connect 'guestSchemeDB;user=francois;password=paceesalute';
 ij(CONNECTION8)> -- Invalid ones:
 connect 'guestSchemeDB;user=Jamie;password=theHooligan';
 ij(CONNECTION9)> show connections;
-CONNECTION0 - 	jdbc:derby://localhost:1527/wombat;create=true
-CONNECTION1 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION2 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION3 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION4 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION5 - 	jdbc:derby://localhost:1527/guestSchemeDB
-CONNECTION6 - 	jdbc:derby://localhost:1527/guestSchemeDB
-CONNECTION7 - 	jdbc:derby://localhost:1527/guestSchemeDB
-CONNECTION8 - 	jdbc:derby://localhost:1527/guestSchemeDB
-CONNECTION9* - 	jdbc:derby://localhost:1527/guestSchemeDB
+CONNECTION0 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true
+CONNECTION1 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION2 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION3 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION4 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION5 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB
+CONNECTION6 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB
+CONNECTION7 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB
+CONNECTION8 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB
+CONNECTION9* - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB
 * = current connection
 ij(CONNECTION9)> connect 'derbySchemeDB;user=mamta;password=ieScape';
 ij(CONNECTION10)> connect 'derbySchemeDB;user=dan;password=makeItFaster';
@@ -131,19 +131,19 @@ ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid
 ij(CONNECTION12)> connect 'derbySchemeDB;user=francois;password=paceesalute';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij(CONNECTION12)> show connections;
-CONNECTION0 - 	jdbc:derby://localhost:1527/wombat;create=true
-CONNECTION1 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION10 - 	jdbc:derby://localhost:1527/derbySchemeDB
-CONNECTION11 - 	jdbc:derby://localhost:1527/derbySchemeDB
-CONNECTION12* - 	jdbc:derby://localhost:1527/derbySchemeDB
-CONNECTION2 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION3 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION4 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION5 - 	jdbc:derby://localhost:1527/guestSchemeDB
-CONNECTION6 - 	jdbc:derby://localhost:1527/guestSchemeDB
-CONNECTION7 - 	jdbc:derby://localhost:1527/guestSchemeDB
-CONNECTION8 - 	jdbc:derby://localhost:1527/guestSchemeDB
-CONNECTION9 - 	jdbc:derby://localhost:1527/guestSchemeDB
+CONNECTION0 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true
+CONNECTION1 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION10 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB
+CONNECTION11 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB
+CONNECTION12* - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB
+CONNECTION2 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION3 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION4 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION5 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB
+CONNECTION6 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB
+CONNECTION7 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB
+CONNECTION8 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB
+CONNECTION9 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB
 * = current connection
 ij(CONNECTION12)> connect 'simpleSchemeDB;user=jeff;password=homeRun';
 ij(CONNECTION13)> connect 'simpleSchemeDB;user=howardR;password=takeItEasy';
@@ -159,22 +159,22 @@ ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid
 ij(CONNECTION15)> connect 'simpleSchemeDB;user=francois;password=corsica';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij(CONNECTION15)> show connections;
-CONNECTION0 - 	jdbc:derby://localhost:1527/wombat;create=true
-CONNECTION1 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION10 - 	jdbc:derby://localhost:1527/derbySchemeDB
-CONNECTION11 - 	jdbc:derby://localhost:1527/derbySchemeDB
-CONNECTION12 - 	jdbc:derby://localhost:1527/derbySchemeDB
-CONNECTION13 - 	jdbc:derby://localhost:1527/simpleSchemeDB
-CONNECTION14 - 	jdbc:derby://localhost:1527/simpleSchemeDB
-CONNECTION15* - 	jdbc:derby://localhost:1527/simpleSchemeDB
-CONNECTION2 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION3 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION4 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION5 - 	jdbc:derby://localhost:1527/guestSchemeDB
-CONNECTION6 - 	jdbc:derby://localhost:1527/guestSchemeDB
-CONNECTION7 - 	jdbc:derby://localhost:1527/guestSchemeDB
-CONNECTION8 - 	jdbc:derby://localhost:1527/guestSchemeDB
-CONNECTION9 - 	jdbc:derby://localhost:1527/guestSchemeDB
+CONNECTION0 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true
+CONNECTION1 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION10 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB
+CONNECTION11 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB
+CONNECTION12 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB
+CONNECTION13 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/simpleSchemeDB
+CONNECTION14 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/simpleSchemeDB
+CONNECTION15* - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/simpleSchemeDB
+CONNECTION2 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION3 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION4 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION5 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB
+CONNECTION6 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB
+CONNECTION7 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB
+CONNECTION8 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB
+CONNECTION9 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/guestSchemeDB
 * = current connection
 ij(CONNECTION15)> disconnect all;
 ij> show connections;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/secureUsersldap.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/secureUsersldap.out
index 4a160d21f..956253329 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/secureUsersldap.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/secureUsersldap.out
@@ -93,9 +93,9 @@ ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid
 ij(CONNECTION2)> connect 'derbySchemeDB;user=francois;password=paceesalute';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij(CONNECTION2)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=mamta;password=ieScape
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=dan;password=makeItFaster
-CONNECTION2* - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=martin;password=obfuscateIt
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=mamta;password=ieScape
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=dan;password=makeItFaster
+CONNECTION2* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=martin;password=obfuscateIt
 * = current connection
 ij(CONNECTION2)> --
 ----- 1rst test phase for LDAP
@@ -114,9 +114,9 @@ ij(CONNECTION2)> -- wrong ldap password
 connect 'ldapSchemeDB;user=francois;password=paceesalute';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij(CONNECTION2)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=mamta;password=ieScape
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=dan;password=makeItFaster
-CONNECTION2* - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=martin;password=obfuscateIt
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=mamta;password=ieScape
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=dan;password=makeItFaster
+CONNECTION2* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=martin;password=obfuscateIt
 * = current connection
 ij(CONNECTION2)> --
 ----- 2nd test phases for LDAP - Cache the User DN locally
@@ -134,9 +134,9 @@ Statement executed.
 ij(CONNECTION2)> execute p5 using 'values(''derby.user.francois'', ''uid=francois,ou=People,o=opensource.apache.com'')';
 Statement executed.
 ij(CONNECTION2)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=mamta;password=ieScape
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=dan;password=makeItFaster
-CONNECTION2* - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=martin;password=obfuscateIt
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=mamta;password=ieScape
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=dan;password=makeItFaster
+CONNECTION2* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=martin;password=obfuscateIt
 * = current connection
 ij(CONNECTION2)> commit;
 ij(CONNECTION2)> autocommit on;
@@ -157,9 +157,9 @@ ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid
 ij(CONNECTION2)> connect 'ldapSchemeDB;user=rachael;password=rachaelF';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij(CONNECTION2)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=mamta;password=ieScape
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=dan;password=makeItFaster
-CONNECTION2* - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=martin;password=obfuscateIt
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=mamta;password=ieScape
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=dan;password=makeItFaster
+CONNECTION2* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=martin;password=obfuscateIt
 * = current connection
 ij(CONNECTION2)> -- Invalid ones:
 connect 'ldapSchemeDB;user=Jamie;password=theHooligan';
@@ -170,9 +170,9 @@ ij(CONNECTION2)> -- wrong ldap password
 connect 'ldapSchemeDB;user=francois;password=paceesalute';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij(CONNECTION2)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=mamta;password=ieScape
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=dan;password=makeItFaster
-CONNECTION2* - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=martin;password=obfuscateIt
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=mamta;password=ieScape
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=dan;password=makeItFaster
+CONNECTION2* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=martin;password=obfuscateIt
 * = current connection
 ij(CONNECTION2)> -- Database shutdown - check user - should fail
 connect 'derbySchemeDB;shutdown=true';
@@ -180,9 +180,9 @@ ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid
 ij(CONNECTION2)> connect 'ldapSchemeDB;user=jamie;password=LetMeIn;shutdown=true';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij(CONNECTION2)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=mamta;password=ieScape
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=dan;password=makeItFaster
-CONNECTION2* - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=martin;password=obfuscateIt
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=mamta;password=ieScape
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=dan;password=makeItFaster
+CONNECTION2* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=martin;password=obfuscateIt
 * = current connection
 ij(CONNECTION2)> -- Database shutdown - check user - should succeed
 connect 'derbySchemeDB;user=mamta;password=ieScape;shutdown=true';
@@ -190,9 +190,9 @@ ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid
 ij(CONNECTION2)> connect 'ldapSchemeDB;user=mamta;password=yeeHaLdap;shutdown=true';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij(CONNECTION2)> show connections;
-CONNECTION0 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=mamta;password=ieScape
-CONNECTION1 - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=dan;password=makeItFaster
-CONNECTION2* - 	jdbc:derby:net://localhost:1527/derbySchemeDB;user=martin;password=obfuscateIt
+CONNECTION0 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=mamta;password=ieScape
+CONNECTION1 - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=dan;password=makeItFaster
+CONNECTION2* - 	jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/derbySchemeDB;user=martin;password=obfuscateIt
 * = current connection
 ij(CONNECTION2)> -- Derby system shutdown - check user - should fail
 connect ';user=jamie;password=LetMeIn;shutdown=true';
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/supersimple.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/supersimple.out
index 1671c0ac6..2cc10e1cb 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/supersimple.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/supersimple.out
@@ -123,9 +123,18 @@ ij> drop table a;
 0 rows inserted/updated/deleted
 ij> -- Bug 4694 Test automatic rollback with close of connection
 ----- in ij
-autocommit off;
-ij> create table a (a int);
+connect 'wombat';
+ij(CONNECTION1)> autocommit off;
+ij(CONNECTION1)> create table a (a int);
 0 rows inserted/updated/deleted
+ij(CONNECTION1)> select count(*) from a;
+1          
+-----
+0          
+ij(CONNECTION1)> disconnect;
+ij> set connection connection0;
+ij> select count(*) from a;
+ERROR 42X05: Table 'A' does not exist.
 ij> -- Bug 4758 - Store error does not return properly to client
 autocommit off;
 ij> create table t (i int);
@@ -176,4 +185,10 @@ C2
 some clob 
 ij(CONNECTION1)> drop table t1;
 0 rows inserted/updated/deleted
-ij(CONNECTION1)> 
+ij(CONNECTION1)> commit;
+ij(CONNECTION1)> disconnect;
+ij> set connection connection0;
+ij> autocommit on;
+ij> drop table t;
+0 rows inserted/updated/deleted
+ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/sysinfo.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/sysinfo.out
index cc28eb3ad..3eff42f01 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/sysinfo.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/sysinfo.out
@@ -9,7 +9,7 @@ derby.drda.portNumber=1527
 derby.drda.logConnections=false
 derby.drda.timeSlice=0
 derby.drda.startNetworkServer=false
-derby.drda.host=localhost
+derby.drda.host=xxxFILTERED_HOSTNAMExxx
 derby.drda.traceAll=false
 ----- Derby Information --------
 -----
@@ -36,7 +36,7 @@ derby.drda.portNumber=1527
 derby.drda.logConnections=false
 derby.drda.timeSlice=0
 derby.drda.startNetworkServer=false
-derby.drda.host=localhost
+derby.drda.host=xxxFILTERED_HOSTNAMExxx
 derby.drda.traceAll=false
 ----- Derby Information --------
 -----
@@ -64,7 +64,7 @@ derby.drda.portNumber=1527
 derby.drda.logConnections=false
 derby.drda.timeSlice=0
 derby.drda.startNetworkServer=false
-derby.drda.host=localhost
+derby.drda.host=xxxFILTERED_HOSTNAMExxx
 derby.drda.traceAll=false
 ----- Derby Information --------
 -----
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/testSecMec.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/testSecMec.out
index 916d314da..52b3cfd91 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/testSecMec.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/testSecMec.out
@@ -1,9 +1,9 @@
 Checking security mechanism authentication with DriverManager
-T4: jdbc:derby://localhost:20000/wombat;create=true;user=neelima;password=lee;securityMechanism=3
-T1: jdbc:derby://localhost:20000/wombat
-T2: jdbc:derby://localhost:20000/wombat;user=max
-T3: jdbc:derby://localhost:20000/wombat;user=neelima;password=lee
-T6: jdbc:derby://localhost:20000/wombat;user=neelima;securityMechanism=4
-T8: jdbc:derby://localhost:20000/wombat;user=neelima;password=lee;securityMechanism=4
+T4: jdbc:derby://xxxFILTERED_HOSTNAMExxx:xxxFILTEREDPORTxxx/wombat;create=true;user=neelima;password=lee;securityMechanism=3
+T1: jdbc:derby://xxxFILTERED_HOSTNAMExxx:xxxFILTEREDPORTxxx/wombat
+T2: jdbc:derby://xxxFILTERED_HOSTNAMExxx:xxxFILTEREDPORTxxx/wombat;user=max
+T3: jdbc:derby://xxxFILTERED_HOSTNAMExxx:xxxFILTEREDPORTxxx/wombat;user=neelima;password=lee
+T6: jdbc:derby://xxxFILTERED_HOSTNAMExxx:xxxFILTEREDPORTxxx/wombat;user=neelima;securityMechanism=4
+T8: jdbc:derby://xxxFILTERED_HOSTNAMExxx:xxxFILTEREDPORTxxx/wombat;user=neelima;password=lee;securityMechanism=4
 SECMEC_USRIDPWD: OK
 Completed testSecMec
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/testij.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/testij.out
index 8d4525764..516cf92ba 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/testij.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/testij.out
@@ -1,9 +1,9 @@
 Testing various ij connections and comments in front of selects
-org.apache.derby.tools.ij extin/testclientij.sql 
+org.apache.derby.tools.ij xxxFILTERED_TESTIJSOURCExxx
 ij> driver 'org.apache.derby.jdbc.ClientDriver';
 ij> --Bug 4632  Make the db italian to make sure string selects  are working
-connect 'jdbc:derby://localhost:1527/wombat;create=true;territory=it' USER 'dbadmin' PASSWORD 'dbadmin';
-ij> connect 'jdbc:derby://localhost:1527/wombat' USER 'dbadmin' PASSWORD 'dbadbmin';
+connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true;territory=it' USER 'dbadmin' PASSWORD 'dbadmin';
+ij> connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat' USER 'dbadmin' PASSWORD 'dbadbmin';
 ij(CONNECTION1)> -- this is a comment, a comment in front of a select should not cause an error
 select * from sys.systables where 1=0;
 TABLEID |TABLENAME |& |SCHEMAID |&
@@ -17,43 +17,43 @@ values(1);
 1 row selected
 ij(CONNECTION1)> -- Try some URL attributes
 disconnect all;
-ij> connect 'jdbc:derby://localhost:1527/junk;create=true' USER 'dbadmin' PASSWORD 'dbadbmin';
+ij> connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/junk;create=true' USER 'dbadmin' PASSWORD 'dbadbmin';
 ij> select * from APP.notthere;
 ERROR 42X05: Table 'APP.NOTTHERE' does not exist.
 ij> -- examples from the docs
-connect 'jdbc:derby://localhost:1527/wombat;create=true;user=judy;password=judy';
-ij(CONNECTION1)> connect 'jdbc:derby://localhost:1527/./wombat;user=judy;password=judy';
-ij(CONNECTION2)> connect 'jdbc:derby://localhost:1527/toursDB';
+connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true;user=judy;password=judy';
+ij(CONNECTION1)> connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/./wombat;user=judy;password=judy';
+ij(CONNECTION2)> connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/toursDB';
 ERROR 08004: The application server rejected establishment of the connection.  An attempt was made to access a database, toursDB, which was not found.
-ij(CONNECTION2)> connect 'jdbc:derby://localhost:1527/toursDB' USER 'dbadmin' PASSWORD 'dbadbmin';
+ij(CONNECTION2)> connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/toursDB' USER 'dbadmin' PASSWORD 'dbadbmin';
 ERROR 08004: The application server rejected establishment of the connection.  An attempt was made to access a database, toursDB, which was not found.
-ij(CONNECTION2)> connect 'jdbc:derby://localhost:1527/wombat' USER 'APP' PASSWORD 'APP';
-ij(CONNECTION3)> connect  'jdbc:derby://localhost:1527/my-db-name;create=true;user=usr;password=pwd';
-ij(CONNECTION4)> connect 'jdbc:derby://localhost:1527/my-db-name;upgrade=true;user=usr;password=pwd';
-ij(CONNECTION5)> connect 'jdbc:derby://localhost:1527/my-db-name;shutdown=true;user=usr;password=pwd';
+ij(CONNECTION2)> connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat' USER 'APP' PASSWORD 'APP';
+ij(CONNECTION3)> connect  'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/my-db-name;create=true;user=usr;password=pwd';
+ij(CONNECTION4)> connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/my-db-name;upgrade=true;user=usr;password=pwd';
+ij(CONNECTION5)> connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/my-db-name;shutdown=true;user=usr;password=pwd';
 ERROR 08006: DERBY SQL error: SQLCODE: -1, SQLSTATE: 08006, SQLERRMC: Database 'my-db-name' shutdown.
-ij(CONNECTION5)> connect 'jdbc:derby://localhost:1527/./my-dbname;create=true;user=usr;password=pwd';
-ij(CONNECTION6)> connect 'jdbc:derby://localhost:1527/./my-dbname;create=true;user=usr;password=pwd';
-ij(CONNECTION7)> connect 'jdbc:derby://localhost:1527/toursDB' USER 'dbadmin' PASSWORD 'dbadbmin';
+ij(CONNECTION5)> connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/./my-dbname;create=true;user=usr;password=pwd';
+ij(CONNECTION6)> connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/./my-dbname;create=true;user=usr;password=pwd';
+ij(CONNECTION7)> connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/toursDB' USER 'dbadmin' PASSWORD 'dbadbmin';
 ERROR 08004: The application server rejected establishment of the connection.  An attempt was made to access a database, toursDB, which was not found.
-ij(CONNECTION7)> connect 'jdbc:derby://localhost:1527/wombat' USER 'APP' PASSWORD 'APP';
-ij(CONNECTION8)> connect  'jdbc:derby://localhost:1527/my-db-name;create=true;user=usr;password=pwd';
-ij(CONNECTION9)> connect 'jdbc:derby://localhost:1527/my-db-name;upgrade=true;user=usr;password=pwd';
-ij(CONNECTION10)> connect 'jdbc:derby://localhost:1527/my-db-name;shutdown=true;user=usr;password=pwd';
+ij(CONNECTION7)> connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat' USER 'APP' PASSWORD 'APP';
+ij(CONNECTION8)> connect  'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/my-db-name;create=true;user=usr;password=pwd';
+ij(CONNECTION9)> connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/my-db-name;upgrade=true;user=usr;password=pwd';
+ij(CONNECTION10)> connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/my-db-name;shutdown=true;user=usr;password=pwd';
 ERROR 08006: DERBY SQL error: SQLCODE: -1, SQLSTATE: 08006, SQLERRMC: Database 'my-db-name' shutdown.
 ij(CONNECTION10)> -- Database names with /'s
-connect 'jdbc:derby://localhost:1527/./my-dbname;create=true;user=usr;password=pwd';
-ij(CONNECTION11)> connect 'jdbc:derby://localhost:1527/./my-dbname;create=true;user=usr;password=pwd';
+connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/./my-dbname;create=true;user=usr;password=pwd';
+ij(CONNECTION11)> connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/./my-dbname;create=true;user=usr;password=pwd';
 ij(CONNECTION12)> -- retrieveMessageText Testing
-connect 'jdbc:derby://localhost:1527/my-db-name;create=true;user=usr;password=pwd;retrieveMessageText=false';
+connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/my-db-name;create=true;user=usr;password=pwd;retrieveMessageText=false';
 ij(CONNECTION13)> -- Should not get message text
 select * from APP.notthere;
 ERROR 42X05: DERBY SQL error: SQLCODE: -1, SQLSTATE: 42X05, SQLERRMC: APP.NOTTHERE42X05
-ij(CONNECTION13)> connect 'jdbc:derby://localhost:1527/my-db-name;create=true;user=usr;password=pwd;retrieveMessageText=true';
+ij(CONNECTION13)> connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/my-db-name;create=true;user=usr;password=pwd;retrieveMessageText=true';
 ij(CONNECTION14)> -- Should see message text
 select * from APP.notthere;
 ERROR 42X05: Table 'APP.NOTTHERE' does not exist.
 ij(CONNECTION14)> -- just user security mechanism
-connect 'jdbc:derby://localhost:1527/my-db-name;create=true;user=usr;retrieveMessageText=true';
-ij(CONNECTION15)> connect 'jdbc:derby://localhost:1527/wombat' USER 'APP';
+connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/my-db-name;create=true;user=usr;retrieveMessageText=true';
+ij(CONNECTION15)> connect 'jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat' USER 'APP';
 ij(CONNECTION16)> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/users.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/users.out
index a9c02a182..1dbda7128 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/users.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/users.out
@@ -36,11 +36,11 @@ ij(CONNECTION1)> connect 'wombat;user=ames;password=AnyVolunteer?';
 ij(CONNECTION2)> connect 'wombat;user=howardR;password=IamBetterAtTennis';
 ij(CONNECTION3)> connect 'wombat;user=francois;password=paceesalute';
 ij(CONNECTION4)> show connections;
-CONNECTION0 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION1 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION2 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION3 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION4* - 	jdbc:derby://localhost:1527/wombat
+CONNECTION0 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION1 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION2 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION3 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION4* - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
 * = current connection
 ij(CONNECTION4)> disconnect all;
 ij> -- check allowed users in myDB db.
@@ -84,12 +84,12 @@ FRANCOIS
 ij(CONNECTION5)> update APP.t1 set c1 = USER;
 ERROR 23513: The check constraint 'xxxxGENERATED-IDxxxx' was violated while performing an INSERT or UPDATE on table 'APP.T1'.
 ij(CONNECTION5)> show connections;
-CONNECTION0 - 	jdbc:derby://localhost:1527/myDB
-CONNECTION1 - 	jdbc:derby://localhost:1527/myDB
-CONNECTION2 - 	jdbc:derby://localhost:1527/myDB
-CONNECTION3 - 	jdbc:derby://localhost:1527/myDB
-CONNECTION4 - 	jdbc:derby://localhost:1527/myDB
-CONNECTION5* - 	jdbc:derby://localhost:1527/myDB
+CONNECTION0 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/myDB
+CONNECTION1 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/myDB
+CONNECTION2 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/myDB
+CONNECTION3 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/myDB
+CONNECTION4 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/myDB
+CONNECTION5* - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/myDB
 * = current connection
 ij(CONNECTION5)> disconnect all;
 ij> --
@@ -127,8 +127,8 @@ ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid
 ij(CONNECTION1)> connect 'wombat;user=jerry;password=SacreBleu;shutdown=true';
 ERROR 04501: DERBY SQL error: SQLCODE: -1, SQLSTATE: 04501, SQLERRMC: Database connection refused.
 ij(CONNECTION1)> show connections;
-CONNECTION0 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION1* - 	jdbc:derby://localhost:1527/myDB
+CONNECTION0 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION1* - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/myDB
 * = current connection
 ij(CONNECTION1)> -- Database shutdown - check user - should succeed
 ----- beetle 5367
@@ -137,8 +137,8 @@ ERROR 08006: DERBY SQL error: SQLCODE: -1, SQLSTATE: 08006, SQLERRMC: Database '
 ij(CONNECTION1)> connect 'myDB;user=jerry;password=SacreBleu;shutdown=true';
 ERROR 08006: DERBY SQL error: SQLCODE: -1, SQLSTATE: 08006, SQLERRMC: Database 'myDB' shutdown.
 ij(CONNECTION1)> show connections;
-CONNECTION0 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION1* - 	jdbc:derby://localhost:1527/myDB
+CONNECTION0 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION1* - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/myDB
 * = current connection
 ij(CONNECTION1)> -- JBMS System shutdown - check user - should fail
 connect ';user=jamie;password=LetMeIn;shutdown=true';
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/users2.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/users2.out
index 6700c8020..5cb980ea5 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/users2.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/users2.out
@@ -72,12 +72,12 @@ ERROR 25502: An SQL data change is not permitted for a read-only connection, use
 ij(CONNECTION5)> create table APP.t2(c1 char(30));
 ERROR 25503: DDL is not permitted for a read-only connection, user or database.
 ij(CONNECTION5)> show connections;
-CONNECTION0 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION1 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION2 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION3 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION4 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION5* - 	jdbc:derby://localhost:1527/wombat
+CONNECTION0 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION1 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION2 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION3 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION4 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION5* - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
 * = current connection
 ij(CONNECTION5)> disconnect all;
 ij> -- check allowed users in myDB db.
@@ -169,13 +169,13 @@ FRANCOIS
 ij(CONNECTION6)> update APP.t1 set c1 = USER;
 ERROR 23513: The check constraint 'xxxxGENERATED-IDxxxx' was violated while performing an INSERT or UPDATE on table 'APP.T1'.
 ij(CONNECTION6)> show connections;
-CONNECTION0 - 	jdbc:derby://localhost:1527/myDB
-CONNECTION1 - 	jdbc:derby://localhost:1527/myDB
-CONNECTION2 - 	jdbc:derby://localhost:1527/myDB
-CONNECTION3 - 	jdbc:derby://localhost:1527/myDB
-CONNECTION4 - 	jdbc:derby://localhost:1527/myDB
-CONNECTION5 - 	jdbc:derby://localhost:1527/myDB
-CONNECTION6* - 	jdbc:derby://localhost:1527/myDB
+CONNECTION0 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/myDB
+CONNECTION1 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/myDB
+CONNECTION2 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/myDB
+CONNECTION3 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/myDB
+CONNECTION4 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/myDB
+CONNECTION5 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/myDB
+CONNECTION6* - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/myDB
 * = current connection
 ij(CONNECTION6)> disconnect all;
 ij> --
@@ -201,7 +201,7 @@ ij> connect 'wombat;user=jerry;password=SacreBleu';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij> connect 'wombat;user=jamie;password=MrNamePlates';
 ij> show connections;
-CONNECTION0* - 	jdbc:derby://localhost:1527/wombat
+CONNECTION0* - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
 * = current connection
 ij> connect 'wombat;user=francois;password=paceesalute';
 ij(CONNECTION1)> connect 'myDB;user=jerry;password=SacreBleu';
@@ -213,9 +213,9 @@ ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid
 ij(CONNECTION2)> connect 'wombat;user=jerry;password=SacreBleu;shutdown=true';
 ERROR (no SQLState): Connection authorization failure occurred.  Reason: userid invalid.
 ij(CONNECTION2)> show connections;
-CONNECTION0 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION1 - 	jdbc:derby://localhost:1527/wombat
-CONNECTION2* - 	jdbc:derby://localhost:1527/myDB
+CONNECTION0 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION1 - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat
+CONNECTION2* - 	jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/myDB
 * = current connection
 ij(CONNECTION2)> disconnect all;
 ij> show connections;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/wisconsin.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/wisconsin.out
index 5ac102365..210813dd8 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/wisconsin.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/wisconsin.out
@@ -30661,4 +30661,15 @@ None
 	Ordered null semantics on the following columns: 
 				qualifiers:
 None
+ij> -- cleanup
+drop table TENKTUP1;
+0 rows inserted/updated/deleted
+ij> drop table TENKTUP2;
+0 rows inserted/updated/deleted
+ij> drop table ONEKTUP;
+0 rows inserted/updated/deleted
+ij> drop table BPRIME;
+0 rows inserted/updated/deleted
+ij> drop procedure WISCINSERT;
+0 rows inserted/updated/deleted
 ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/xaSimplePositive.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/xaSimplePositive.out
index 286986313..469ac0a4d 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/xaSimplePositive.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/xaSimplePositive.out
@@ -189,6 +189,8 @@ A
 4          
 77         
 5          
+ij(XA)> drop table APP.foo;
+0 rows inserted/updated/deleted
 ij(XA)> xa_end xa_success 5;
 ij(XA)> xa_prepare 5;
 ij(XA)> xa_commit xa_2Phase 5;
@@ -223,6 +225,14 @@ ij(XA)> call DRS(1);
 I |B              
 -----
 1 |one            
+ij(XA)> drop procedure DRS;
+0 rows inserted/updated/deleted
+ij(XA)> drop table t1;
+0 rows inserted/updated/deleted
+ij(XA)> drop view APP.global_xacttable;
+0 rows inserted/updated/deleted
+ij(XA)> drop schema sku restrict;
+0 rows inserted/updated/deleted
 ij(XA)> xa_end xa_success 6;
 ij(XA)> xa_commit xa_1Phase 6;
-ij(XA)> 
\ No newline at end of file
+ij(XA)> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/LOBTest.out b/java/testing/org/apache/derbyTesting/functionTests/master/LOBTest.out
index 41eb904f4..1e72bee48 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/LOBTest.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/LOBTest.out
@@ -3871,3 +3871,4 @@ insert into blobCheck (bl ) values (cast (X'C8' as blob(80)) )
 insert into blobCheck (bl ) values ( X'a78a' )
 	ERROR 42821: Columns of type 'BLOB' cannot hold values of type 'CHAR () FOR BIT DATA'. 
 insert into blobCheck (bl ) values (cast (X'a78a' as blob(80)) )
+drop table blobCheck
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/bestrowidentifier.out b/java/testing/org/apache/derbyTesting/functionTests/master/bestrowidentifier.out
index 1ff93d8f6..789025fb9 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/bestrowidentifier.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/bestrowidentifier.out
@@ -173,4 +173,7 @@ execute bestrow using 'values(''APP'',''T16'',3,''true'')';
 SCOPE |COLUMN_NAME                                                                                                                     |DATA_&|TYPE_NAME                                                                                                                       |COLUMN_SIZE|BUFFER_LEN&|DECIM&|PSEUD&
 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 ij> rollback work;
+ij> drop procedure getBestRowID;
+0 rows inserted/updated/deleted
+ij> commit;
 ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/blobclob4BLOB.out b/java/testing/org/apache/derbyTesting/functionTests/master/blobclob4BLOB.out
index 30d93cf17..00a03a550 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/blobclob4BLOB.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/blobclob4BLOB.out
@@ -1,16 +1,16 @@
 Test blobclob starting
 START: prepareCLOBMAIN
-===> inserting extin/short.txt length = 56
-===> inserting extin/littleclob.txt length = 10000
-===> inserting extin/empty.txt length = 0
-===> inserting extin/searchclob.txt length = 5000
-===> inserting extin/aclob.txt length = 300000
+===> inserting short.txt length = 56
+===> inserting littleclob.txt length = 10000
+===> inserting empty.txt length = 0
+===> inserting searchclob.txt length = 5000
+===> inserting aclob.txt length = 300000
 START: prepareSearchClobTable
-===> inserting extin/short.txt length = 56
-===> inserting extin/littleclob.txt length = 10000
-===> inserting extin/empty.txt length = 0
-===> inserting extin/searchclob.txt length = 5000
-===> inserting extin/aclob.txt length = 300000
+===> inserting short.txt length = 56
+===> inserting littleclob.txt length = 10000
+===> inserting empty.txt length = 0
+===> inserting searchclob.txt length = 5000
+===> inserting aclob.txt length = 300000
 prepareSearchClobTable finished
 START: prepareUnicodeTable
 START: prepareUnicodeFile
@@ -545,17 +545,17 @@ clobTest95 finished
 START: clobTest96
 clobTest96 finished
 START: prepareBlobTable
-===> inserting extin/short.txt length = 56
-===> inserting extin/littleclob.txt length = 10000
-===> inserting extin/empty.txt length = 0
-===> inserting extin/searchclob.txt length = 5000
-===> inserting extin/aclob.txt length = 300000
+===> inserting short.txt length = 56
+===> inserting littleclob.txt length = 10000
+===> inserting empty.txt length = 0
+===> inserting searchclob.txt length = 5000
+===> inserting aclob.txt length = 300000
 START: prepareSearchBlobTable
-===> inserting extin/short.txt length = 56
-===> inserting extin/littleclob.txt length = 10000
-===> inserting extin/empty.txt length = 0
-===> inserting extin/searchclob.txt length = 5000
-===> inserting extin/aclob.txt length = 300000
+===> inserting short.txt length = 56
+===> inserting littleclob.txt length = 10000
+===> inserting empty.txt length = 0
+===> inserting searchclob.txt length = 5000
+===> inserting aclob.txt length = 300000
 START: blobTest0
 blobTest0 finished
 START: blobTest2
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/checkDriver.out b/java/testing/org/apache/derbyTesting/functionTests/master/checkDriver.out
index 9fdaeba73..b23f22dcc 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/checkDriver.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/checkDriver.out
@@ -2,8 +2,8 @@ jdbcCompliant() = true
 driver.getMajorVersion() = EXPECTED VERSION
 driver.getMinorVersion() = EXPECTED VERSION
 checking acceptsURL(jdbc:derby:wombat;create=true)
-checking acceptsURL(jdbc:derby://localhost:1527/wombat;create=true)
-checking acceptsURL(jdbc:derby:net://localhost:1527/wombat;create=true)
+checking acceptsURL(jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true)
+checking acceptsURL(jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true)
 checking acceptsURL(jdbc:db2j:wombat;create=true)
 testEmbeddedAttributes()
 Connection info for connect(jdbc:derby:testcreatedb1, {create=true})
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/dataSourcePermissions.out b/java/testing/org/apache/derbyTesting/functionTests/master/dataSourcePermissions.out
index 018056188..de56b79a4 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/dataSourcePermissions.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/dataSourcePermissions.out
@@ -55,4 +55,6 @@ XADataSource with valid default user
 XA connected as EDWARD
 XA connected as FRANCES
 EXPECTED SHUTDOWN Derby system shutdown.
+EXPECTED SHUTDOWN Derby system shutdown.
+EXPECTED SHUTDOWN Derby system shutdown.
 Completed dataSourcePermissions
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/dblook_test.out b/java/testing/org/apache/derbyTesting/functionTests/master/dblook_test.out
index 549755709..386c04dbe 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/dblook_test.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/dblook_test.out
@@ -5302,7 +5302,7 @@ Msg Test 3
  java org.apache.derby.tools.dblook -d <sourceDBUrl> [OPTIONS]
  	where the source URL is the full URL, including the connection protocol
  	and any connection attributes that might apply.  For example, use
- 	'jdbc:derby:myDB', or 'jdbc:derby:net://localhost:1527/myDB:user=usr;'. 
+ 	'jdbc:derby:myDB', or 'jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/myDB:user=usr;'. 
  	options include: 
  	-z <schemaName> to specify a schema to which the DDL generation
  	 should be limited.  Only database objects with that schema will have
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/forupdate.out b/java/testing/org/apache/derbyTesting/functionTests/master/forupdate.out
index cc89c3b58..1f6141704 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/forupdate.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/forupdate.out
@@ -492,6 +492,8 @@ drop table t1;
 0 rows inserted/updated/deleted
 ij> drop table t2;
 0 rows inserted/updated/deleted
+ij> drop table t3;
+0 rows inserted/updated/deleted
 ij> -- bug 5643
 -- JCC throws NPE when trying to execute a cursor after the resultset is closed
 autocommit off;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/getCurrentProperties.out b/java/testing/org/apache/derbyTesting/functionTests/master/getCurrentProperties.out
index 1fa7e079e..4247ac7f5 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/getCurrentProperties.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/getCurrentProperties.out
@@ -7,7 +7,7 @@ derby.drda.portNumber=1527
 derby.drda.logConnections=false
 derby.drda.timeSlice=0
 derby.drda.startNetworkServer=false
-derby.drda.host=localhost
+derby.drda.host=xxxFILTERED_HOSTNAMExxx
 derby.drda.traceAll=false
 Properties with tracing on
 ----- listing properties --
@@ -20,7 +20,7 @@ derby.drda.portNumber=1527
 derby.drda.logConnections=true
 derby.drda.timeSlice=0
 derby.drda.startNetworkServer=false
-derby.drda.host=localhost
+derby.drda.host=xxxFILTERED_HOSTNAMExxx
 derby.drda.traceAll=false
 Properties with tracing on
 ----- listing properties --
@@ -32,5 +32,5 @@ derby.drda.portNumber=1527
 derby.drda.logConnections=true
 derby.drda.timeSlice=0
 derby.drda.startNetworkServer=false
-derby.drda.host=localhost
+derby.drda.host=xxxFILTERED_HOSTNAMExxx
 derby.drda.traceAll=true
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/holdCursorExternalSortJDBC30.out b/java/testing/org/apache/derbyTesting/functionTests/master/holdCursorExternalSortJDBC30.out
index f32d8ee7b..8d85eb009 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/holdCursorExternalSortJDBC30.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/holdCursorExternalSortJDBC30.out
@@ -342,4 +342,5 @@ ij> drop procedure WAIT_FOR_POST_COMMIT;
 0 rows inserted/updated/deleted
 ij> drop table foo;
 0 rows inserted/updated/deleted
+ij> commit;
 ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/holdCursorIJ.out b/java/testing/org/apache/derbyTesting/functionTests/master/holdCursorIJ.out
index 519ed1401..20c34c131 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/holdCursorIJ.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/holdCursorIJ.out
@@ -312,4 +312,6 @@ ij> update t1 set c12=c12+1 where current of scrollCursor;
 ERROR 24000: Invalid cursor state - no current row.
 ij> -- clean up.
 close scrollCursor;
+ij> drop table t1;
+0 rows inserted/updated/deleted
 ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/holdCursorJDBC30.out b/java/testing/org/apache/derbyTesting/functionTests/master/holdCursorJDBC30.out
index bddf3f056..e62f5cfc2 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/holdCursorJDBC30.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/holdCursorJDBC30.out
@@ -1572,4 +1572,15 @@ ij> next test12;
 No current row
 ij> commit;
 ij> close test12;
+ij> drop table foo;
+0 rows inserted/updated/deleted
+ij> drop table t1;
+0 rows inserted/updated/deleted
+ij> drop table t2;
+0 rows inserted/updated/deleted
+ij> drop function padstring;
+0 rows inserted/updated/deleted
+ij> drop procedure wait_for_post_commit;
+0 rows inserted/updated/deleted
+ij> commit;
 ij> exit;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/j9_13/checkDriver.out b/java/testing/org/apache/derbyTesting/functionTests/master/j9_13/checkDriver.out
index f42363180..9103ef9e5 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/j9_13/checkDriver.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/j9_13/checkDriver.out
@@ -2,8 +2,8 @@ jdbcCompliant() = true
 driver.getMajorVersion() = EXPECTED VERSION
 driver.getMinorVersion() = EXPECTED VERSION
 checking acceptsURL(jdbc:derby:wombat;create=true)
-checking acceptsURL(jdbc:derby://localhost:1527/wombat;create=true)
-checking acceptsURL(jdbc:derby:net://localhost:1527/wombat;create=true)
+checking acceptsURL(jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true)
+checking acceptsURL(jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true)
 checking acceptsURL(jdbc:db2j:wombat;create=true)
 testEmbeddedAttributes()
 Connection info for connect(jdbc:derby:testcreatedb1, {create=true})
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/j9_22/checkDriver.out b/java/testing/org/apache/derbyTesting/functionTests/master/j9_22/checkDriver.out
index 9fdaeba73..b23f22dcc 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/j9_22/checkDriver.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/j9_22/checkDriver.out
@@ -2,8 +2,8 @@ jdbcCompliant() = true
 driver.getMajorVersion() = EXPECTED VERSION
 driver.getMinorVersion() = EXPECTED VERSION
 checking acceptsURL(jdbc:derby:wombat;create=true)
-checking acceptsURL(jdbc:derby://localhost:1527/wombat;create=true)
-checking acceptsURL(jdbc:derby:net://localhost:1527/wombat;create=true)
+checking acceptsURL(jdbc:derby://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true)
+checking acceptsURL(jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true)
 checking acceptsURL(jdbc:db2j:wombat;create=true)
 testEmbeddedAttributes()
 Connection info for connect(jdbc:derby:testcreatedb1, {create=true})
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/maxthreads.out b/java/testing/org/apache/derbyTesting/functionTests/master/maxthreads.out
index faf3ca6f4..4f37b3225 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/maxthreads.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/maxthreads.out
@@ -2,7 +2,7 @@ Testing maxthreads
 org.apache.derby.drda.NetworkServerControl maxthreads 0 
 Max threads changed to 0.
 PASS - max threads value, 0 is correct
-org.apache.derby.drda.NetworkServerControl maxthreads -1 -h localhost -p 1527 
+org.apache.derby.drda.NetworkServerControl maxthreads -1 -h xxxFILTERED_HOSTNAMExxx -p 1527 
 Max threads changed to 0.
 PASS - max threads value, 0 is correct
 org.apache.derby.drda.NetworkServerControl maxthreads -12 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/optimizerOverrides.out b/java/testing/org/apache/derbyTesting/functionTests/master/optimizerOverrides.out
index 73d4603a8..c76865021 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/optimizerOverrides.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/optimizerOverrides.out
@@ -976,4 +976,5 @@ ij> drop table t1;
 0 rows inserted/updated/deleted
 ij> drop table temp1;
 0 rows inserted/updated/deleted
+ij> commit;
 ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/simpleScroll.out b/java/testing/org/apache/derbyTesting/functionTests/master/simpleScroll.out
index f3b8af08a..687b13541 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/simpleScroll.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/simpleScroll.out
@@ -144,6 +144,8 @@ C2
 -----
 String 1                                                        
 NULL                                                            
+ij> drop table t;
+0 rows inserted/updated/deleted
 ij> drop table t1;
 0 rows inserted/updated/deleted
 ij> drop table t2;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/supersimple.out b/java/testing/org/apache/derbyTesting/functionTests/master/supersimple.out
index 4a10350a6..e1efb74e0 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/supersimple.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/supersimple.out
@@ -123,9 +123,18 @@ ij> drop table a;
 0 rows inserted/updated/deleted
 ij> -- Bug 4694 Test automatic rollback with close of connection
 -- in ij
-autocommit off;
-ij> create table a (a int);
+connect 'wombat';
+ij(CONNECTION1)> autocommit off;
+ij(CONNECTION1)> create table a (a int);
 0 rows inserted/updated/deleted
+ij(CONNECTION1)> select count(*) from a;
+1          
+-----------
+0          
+ij(CONNECTION1)> disconnect;
+ij> set connection connection0;
+ij> select count(*) from a;
+ERROR 42X05: Table 'A' does not exist.
 ij> -- Bug 4758 - Store error does not return properly to client
 autocommit off;
 ij> create table t (i int);
@@ -176,4 +185,10 @@ C2
 some clob 
 ij(CONNECTION1)> drop table t1;
 0 rows inserted/updated/deleted
-ij(CONNECTION1)> 
+ij(CONNECTION1)> commit;
+ij(CONNECTION1)> disconnect;
+ij> set connection connection0;
+ij> autocommit on;
+ij> drop table t;
+0 rows inserted/updated/deleted
+ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/testProperties.out b/java/testing/org/apache/derbyTesting/functionTests/master/testProperties.out
index 2ec2bcfed..fb1b5e7c8 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/testProperties.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/testProperties.out
@@ -18,8 +18,8 @@ Testing start server by specifying system properties without values
 First shutdown server started on default port by the test harness
 org.apache.derby.drda.NetworkServerControl shutdown -p 1527 
 Shutdown successful.
--Dderby.drda.logConnections -Dderby.drda.traceAll -Dderby.drda.traceDirectory -Dderby.drda.keepAlive -Dderby.drda.timeSlice -Dderby.drda.host -Dderby.drda.portNumber -Dderby.drda.minThreads -Dderby.drda.maxThreads -Dderby.drda.startNetworkServer -Dderby.drda.debug org.apache.derby.drda.NetworkServerControl start 
--- listing properties --
+-----Dderby.drda.logConnections -Dderby.drda.traceAll -Dderby.drda.traceDirectory -Dderby.drda.keepAlive -Dderby.drda.timeSlice -Dderby.drda.host -Dderby.drda.portNumber -Dderby.drda.minThreads -Dderby.drda.maxThreads -Dderby.drda.startNetworkServer -Dderby.drda.debug org.apache.derby.drda.NetworkServerControl start 
+----- listing properties --
 derby.drda.maxThreads=0
 derby.drda.keepAlive=true
 derby.drda.minThreads=0
@@ -27,14 +27,14 @@ derby.drda.portNumber=1527
 derby.drda.logConnections=false
 derby.drda.timeSlice=0
 derby.drda.startNetworkServer=false
-derby.drda.host=localhost
+derby.drda.host=xxxFILTERED_HOSTNAMExxx
 derby.drda.traceAll=false
 org.apache.derby.drda.NetworkServerControl trace on -p 1527 
 Trace turned on for all sessions.
 Trace turned on for all sessions.
 org.apache.derby.drda.NetworkServerControl logconnections on -p 1527 
 Log Connections changed to on.
--- listing properties --
+----- listing properties --
 derby.drda.maxThreads=0
 derby.drda.keepAlive=true
 derby.drda.minThreads=0
@@ -42,7 +42,7 @@ derby.drda.portNumber=1527
 derby.drda.logConnections=true
 derby.drda.timeSlice=0
 derby.drda.startNetworkServer=false
-derby.drda.host=localhost
+derby.drda.host=xxxFILTERED_HOSTNAMExxx
 derby.drda.traceAll=true
 org.apache.derby.drda.NetworkServerControl trace off -p 1527 
 Trace turned off for all sessions.
@@ -55,7 +55,7 @@ derby.drda.portNumber=1527
 derby.drda.logConnections=true
 derby.drda.timeSlice=0
 derby.drda.startNetworkServer=false
-derby.drda.host=localhost
+derby.drda.host=xxxFILTERED_HOSTNAMExxx
 derby.drda.traceAll=false
 org.apache.derby.drda.NetworkServerControl shutdown -p 1527 
 Shutdown successful.
@@ -68,10 +68,10 @@ shutdown [-h <host>][-p <portnumber>]
 ping [-h <host>][-p <portnumber>]
 sysinfo [-h <host>][-p <portnumber>]
 runtimeinfo [-h <host>][-p <portnumber>]
-logconnections {on|off}[-h <host>][-p <portnumber>]
+logconnections {on |off}[-h <host>][-p <portnumber>]
 maxthreads <max>[-h <host>][-p <portnumber>]
 timeslice <milliseconds>[-h <host>][-p <portnumber>]
-trace {on|off} [-s <session id>][-h <host>][-p <portnumber>]
+trace {on |off} [-s <session id>][-h <host>][-p <portnumber>]
 tracedirectory <traceDirectory>[-h <host>][-p <portnumber>]
 org.apache.derby.drda.NetworkServerControl unknowncmd 
 Command unknowncmd is unknown.
@@ -82,10 +82,10 @@ shutdown [-h <host>][-p <portnumber>]
 ping [-h <host>][-p <portnumber>]
 sysinfo [-h <host>][-p <portnumber>]
 runtimeinfo [-h <host>][-p <portnumber>]
-logconnections {on|off}[-h <host>][-p <portnumber>]
+logconnections {on |off}[-h <host>][-p <portnumber>]
 maxthreads <max>[-h <host>][-p <portnumber>]
 timeslice <milliseconds>[-h <host>][-p <portnumber>]
-trace {on|off} [-s <session id>][-h <host>][-p <portnumber>]
+trace {on |off} [-s <session id>][-h <host>][-p <portnumber>]
 tracedirectory <traceDirectory>[-h <host>][-p <portnumber>]
 org.apache.derby.drda.NetworkServerControl ping arg1 
 Invalid number of arguments for command ping.
@@ -96,9 +96,9 @@ shutdown [-h <host>][-p <portnumber>]
 ping [-h <host>][-p <portnumber>]
 sysinfo [-h <host>][-p <portnumber>]
 runtimeinfo [-h <host>][-p <portnumber>]
-logconnections {on|off}[-h <host>][-p <portnumber>]
+logconnections {on |off}[-h <host>][-p <portnumber>]
 maxthreads <max>[-h <host>][-p <portnumber>]
 timeslice <milliseconds>[-h <host>][-p <portnumber>]
-trace {on|off} [-s <session id>][-h <host>][-p <portnumber>]
+trace {on |off} [-s <session id>][-h <host>][-p <portnumber>]
 tracedirectory <traceDirectory>[-h <host>][-p <portnumber>]
 End test
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/testProtocol.out b/java/testing/org/apache/derbyTesting/functionTests/master/testProtocol.out
index 131ddc015..4ee46aa9e 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/testProtocol.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/testProtocol.out
@@ -288,3 +288,4 @@ Test exception is thrown when specifying non-null indicator for both MBCS and SB
 PASSED
 Test for missing SQLSTT in EXCSQLSET - PKGNAMCT is ignored
 PASSED
+PASSED
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/testconnection.out b/java/testing/org/apache/derbyTesting/functionTests/master/testconnection.out
index f4c0c1cc3..b78e908cf 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/testconnection.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/testconnection.out
@@ -1,18 +1,18 @@
 Testing testconnection
-org.apache.derby.drda.NetworkServerControl ping 
-Connection obtained for host: localhost, port number 1527.
-org.apache.derby.drda.NetworkServerControl ping -h localhost -p 1527 
-Connection obtained for host: localhost, port number 1527.
+org.apache.derby.drda.NetworkServerControl ping...
+Connection obtained for host: xxxFILTERED_HOSTNAMExxx, port number 1527.
+org.apache.derby.drda.NetworkServerControl ping -h xxxFILTERED_HOSTNAMExxx -p 1527 
+Connection obtained for host: xxxFILTERED_HOSTNAMExxx, port number 1527.
 org.apache.derby.drda.NetworkServerControl ping -h notthere -p 1527 
 Unable to find host: notthere.
 org.apache.derby.drda.NetworkServerControl ping -h ihave-inmyname.com -p 1527 
 Unable to find host: ihave-inmyname.com.
-org.apache.derby.drda.NetworkServerControl ping -h localhost 
-Connection obtained for host: localhost, port number 1527.
-org.apache.derby.drda.NetworkServerControl ping -h localhost -p 9393 
-Could not connect to Derby Network Server on host localhost, port 9393.
-org.apache.derby.drda.NetworkServerControl ping -p 1527 
-Connection obtained for host: localhost, port number 1527.
-org.apache.derby.drda.NetworkServerControl ping -p 9393 
-Could not connect to Derby Network Server on host localhost, port 9393.
+org.apache.derby.drda.NetworkServerControl ping -h xxxFILTERED_HOSTNAMExxx 
+Connection obtained for host: xxxFILTERED_HOSTNAMExxx, port number 1527.
+org.apache.derby.drda.NetworkServerControl ping -h xxxFILTERED_HOSTNAMExxx -p 9393 
+Could not connect to Derby Network Server on host xxxFILTERED_HOSTNAMExxx, port 9393.
+org.apache.derby.drda.NetworkServerControl ping...
+Connection obtained for host: xxxFILTERED_HOSTNAMExxx, port number 1527.
+org.apache.derby.drda.NetworkServerControl ping...
+Could not connect to Derby Network Server on host xxxFILTERED_HOSTNAMExxx, port 9393.
 End test
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/testij.out b/java/testing/org/apache/derbyTesting/functionTests/master/testij.out
index 15460daf2..b43d382ab 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/testij.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/testij.out
@@ -1,9 +1,9 @@
 Testing various ij connections and comments in front of selects
-org.apache.derby.tools.ij extin/testij.sql 
+org.apache.derby.tools.ij xxxFILTERED_TESTIJSOURCExxx
 ij> driver 'com.ibm.db2.jcc.DB2Driver';
 ij> --Bug 4632  Make the db italian to make sure string selects  are working
-connect 'jdbc:derby:net://localhost:1527/wombat;create=true;territory=it:retrieveMessagesFromServerOnGetMessage=true;' USER 'dbadmin' PASSWORD 'dbadmin';
-ij> connect 'jdbc:derby:net://localhost:1527/wombat' USER 'dbadmin' PASSWORD 'dbadbmin';
+connect 'jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true;territory=it:retrieveMessagesFromServerOnGetMessage=true;' USER 'dbadmin' PASSWORD 'dbadmin';
+ij> connect 'jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat' USER 'dbadmin' PASSWORD 'dbadbmin';
 ij(CONNECTION1)> -- this is a comment, a comment in front of a select should not cause an error
 select * from sys.systables where 1=0;
 TABLEID |TABLENAME |& |SCHEMAID |&
@@ -17,25 +17,25 @@ values(1);
 1 row selected
 ij(CONNECTION1)> -- Try some URL attributes
 disconnect all;
-ij> connect 'jdbc:derby:net://localhost:1527/junk;create=true:retrieveMessagesFromServerOnGetMessage=true;' USER 'dbadmin' PASSWORD 'dbadbmin';
+ij> connect 'jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/junk;create=true:retrieveMessagesFromServerOnGetMessage=true;' USER 'dbadmin' PASSWORD 'dbadbmin';
 ij> select * from APP.notthere;
 ERROR 42X05: Table 'APP.NOTTHERE' does not exist.
 ij> -- examples from the docs
-connect 'jdbc:derby:net://localhost:1527/wombat;create=true:user=judy;password=judy;retrieveMessagesFromServerOnGetMessage=true;';
-ij(CONNECTION1)> connect 'jdbc:derby:net://localhost:1527/"./wombat":user=judy;password=judy;retrieveMessagesFromServerOnGetMessage=true;';
-ij(CONNECTION2)> connect 'jdbc:derby:net://localhost:1527/toursDB:retrieveMessagesFromServerOnGetMessage=true;';
+connect 'jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true:user=judy;password=judy;retrieveMessagesFromServerOnGetMessage=true;';
+ij(CONNECTION1)> connect 'jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/"./wombat":user=judy;password=judy;retrieveMessagesFromServerOnGetMessage=true;';
+ij(CONNECTION2)> connect 'jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/toursDB:retrieveMessagesFromServerOnGetMessage=true;';
 ERROR (no SQLState): null userid not supported
-ij(CONNECTION2)> connect 'jdbc:derby:net://localhost:1527/toursDB:retrieveMessagesFromServerOnGetMessage=true;' USER 'dbadmin' PASSWORD 'dbadbmin';
+ij(CONNECTION2)> connect 'jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/toursDB:retrieveMessagesFromServerOnGetMessage=true;' USER 'dbadmin' PASSWORD 'dbadbmin';
 ERROR 08004: The application server rejected establishment of the connection.  An attempt was made to access a database, toursDB, which was not found.
-ij(CONNECTION2)> connect 'jdbc:derby:net://localhost:1527/wombat' USER 'APP' PASSWORD 'APP';
-ij(CONNECTION3)> connect  'jdbc:derby:net://localhost:1527/my-db-name;create=true:user=usr;password=pwd;retrieveMessagesFromServerOnGetMessage=true;';
-ij(CONNECTION4)> connect 'jdbc:derby:net://localhost:1527/my-db-name;upgrade=true:user=usr;password=pwd;retrieveMessagesFromServerOnGetMessage=true;';
-ij(CONNECTION5)> connect 'jdbc:derby:net://localhost:1527/my-db-name;shutdown=true:user=usr;password=pwd;'
+ij(CONNECTION2)> connect 'jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat' USER 'APP' PASSWORD 'APP';
+ij(CONNECTION3)> connect  'jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/my-db-name;create=true:user=usr;password=pwd;retrieveMessagesFromServerOnGetMessage=true;';
+ij(CONNECTION4)> connect 'jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/my-db-name;upgrade=true:user=usr;password=pwd;retrieveMessagesFromServerOnGetMessage=true;';
+ij(CONNECTION5)> connect 'jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/my-db-name;shutdown=true:user=usr;password=pwd;'
 ----- Quoted db and attributes
-connect 'jdbc:derby:net://localhost:1527/"./my-dbname;create=true":user=usr;password=pwd;';
+connect 'jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/"./my-dbname;create=true":user=usr;password=pwd;';
 ERROR 08006: DB2 SQL error: SQLCODE: -1, SQLSTATE: 08006, SQLERRMC: Database 'my-db-name' shutdown.
-ij(CONNECTION5)> connect 'jdbc:derby:net://localhost:1527/"./my-dbname;create=true":user=usr;password=pwd;retrieveMessagesFromServerOnGetMessage=true;';
+ij(CONNECTION5)> connect 'jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/"./my-dbname;create=true":user=usr;password=pwd;retrieveMessagesFromServerOnGetMessage=true;';
 ij(CONNECTION6)> -- with no user
-connect 'jdbc:derby:net://localhost:1527/wombat;create=true:retrieveMessagesFromServerOnGetMessage=true;';
+connect 'jdbc:derby:net://xxxFILTERED_HOSTNAMExxx:1527/wombat;create=true:retrieveMessagesFromServerOnGetMessage=true;';
 ERROR (no SQLState): null userid not supported
 ij(CONNECTION6)> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/timeslice.out b/java/testing/org/apache/derbyTesting/functionTests/master/timeslice.out
index c9535e999..f088a959d 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/timeslice.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/timeslice.out
@@ -2,7 +2,7 @@ Testing timeslice
 org.apache.derby.drda.NetworkServerControl timeslice 0 
 Time slice changed to 0.
 PASS - time slice value, 0 is correct
-org.apache.derby.drda.NetworkServerControl timeslice -1 -h localhost -p 1527 
+org.apache.derby.drda.NetworkServerControl timeslice -1 -h xxxFILTERED_HOSTNAMExxx -p 1527 
 Time slice changed to 0.
 PASS - time slice value, 0 is correct
 org.apache.derby.drda.NetworkServerControl timeslice -12 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/wisconsin.out b/java/testing/org/apache/derbyTesting/functionTests/master/wisconsin.out
index 18baa567e..78e474c2b 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/wisconsin.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/wisconsin.out
@@ -30661,4 +30661,15 @@ None
 	Ordered null semantics on the following columns: 
 				qualifiers:
 None
+ij> -- cleanup
+drop table TENKTUP1;
+0 rows inserted/updated/deleted
+ij> drop table TENKTUP2;
+0 rows inserted/updated/deleted
+ij> drop table ONEKTUP;
+0 rows inserted/updated/deleted
+ij> drop table BPRIME;
+0 rows inserted/updated/deleted
+ij> drop procedure WISCINSERT;
+0 rows inserted/updated/deleted
 ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/xaSimplePositive.out b/java/testing/org/apache/derbyTesting/functionTests/master/xaSimplePositive.out
index 30b7c2929..a5ed46753 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/xaSimplePositive.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/xaSimplePositive.out
@@ -189,6 +189,8 @@ A
 4          
 77         
 5          
+ij(XA)> drop table APP.foo;
+0 rows inserted/updated/deleted
 ij(XA)> xa_end xa_success 5;
 ij(XA)> xa_prepare 5;
 ij(XA)> xa_commit xa_2Phase 5;
@@ -225,6 +227,14 @@ selectRows - 1 arg - 1 rs
 I          |B              
 ---------------------------
 1          |one            
+ij(XA)> drop procedure DRS;
+0 rows inserted/updated/deleted
+ij(XA)> drop table t1;
+0 rows inserted/updated/deleted
+ij(XA)> drop view APP.global_xacttable;
+0 rows inserted/updated/deleted
+ij(XA)> drop schema sku restrict;
+0 rows inserted/updated/deleted
 ij(XA)> xa_end xa_success 6;
 ij(XA)> xa_commit xa_1Phase 6;
-ij(XA)> 
\ No newline at end of file
+ij(XA)> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/suites/DerbyNetClientRemote.exclude b/java/testing/org/apache/derbyTesting/functionTests/suites/DerbyNetClientRemote.exclude
new file mode 100644
index 000000000..92f3caf79
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/suites/DerbyNetClientRemote.exclude
@@ -0,0 +1,56 @@
+# this file holds tests that cannot be successfully run with DerbyNetClient framework
+# with a remote server. Tests in this file will be skipped in addition to those in 
+# DerbyNetClient.exclude when the property -DhostName is set to something else than the localhost
+#
+# excluding test   - because...
+# store/bootLock.java - this test uses local connections to make sure 
+#     a database cannot be loaded by 2 different instances.
+# jdbcapi/secureUsers,secureUsers1, users and users2.sql 
+#     because they expect the server to have been started with special derby.properties
+#     this test can be made to work by changing the properties from system properties
+#     i.e. set in a derby.properties file - to be database properties - i.e. set using
+#     SYSCS_SET_ procedure.
+# derbynet/dblook_test_net because it tries to search derby.log, which is on
+#     the server machine, and it assumes files in a location not consistent with running with 
+#     useprocess=false 
+# derbynet/getCurrentProperties for it exercises NetworkServerControl statements
+#     that are only supported on localhost
+# derbynet/NSinSameJVM - tries to start the server
+# derbynet/DataSourcePermissions_net - tries to use NetworkServerControl statements
+# derbynet/maxthreads - tries to use NetworkServerControl statements
+# derbynet/runtimeinfo - tries to use NetworkServerControl statements
+# derbynet/sysinfo - tries to use NetworkServerControl statements
+# derbynet/testProperties - tries to use NetworkServerControl statements
+# derbynet/timeslice - tries to use NetworkServerControl statements
+# derbynet/DerbyNetAutoStart - tries to start networkserver
+# derbynet/DerbyNetNewServer - tries to start networkserver and uses local connections to the db.
+# tools/ieptests - names files in extin dir, which is in a different location when run with
+#     useprocess=false
+# tools/importExport - tries to confirm correct export by file-comparing the exported files,
+#	which may be on a different machine and thus not found.
+# lang/wisconsin - optimization is quite different when running remote server.
+# lang/syscat - test is to sensitive to other tests leaving stuff behind
+# junitTests/derbyNet/CompatibilityTest.java - tries to start and shutdown the server, which will 
+#	give securitymanager errors.
+# 
+store/bootLock.java
+jdbcapi/secureUsers.sql
+jdbcapi/secureUsers1.sql
+jdbcapi/users.sql
+jdbcapi/users2.sql
+derbynet/dblook_test_net.java
+derbynet/getCurrentProperties.java
+derbynet/NSinSameJVM.java
+derbynet/DataSourcePermissions_net.java
+derbynet/maxthreads.java
+derbynet/runtimeinfo.java
+derbynet/sysinfo.java
+derbynet/testProperties.java
+derbynet/timeslice.java
+derbynet/DerbyNetAutoStart.java
+derbynet/DerbyNetNewServer.java
+tools/ieptests.sql
+tools/importExport.java
+lang/wisconsin.sql
+lang/syscat.sql
+junitTests/derbyNet/CompatibilityTest.java
diff --git a/java/testing/org/apache/derbyTesting/functionTests/suites/DerbyNetRemote.exclude b/java/testing/org/apache/derbyTesting/functionTests/suites/DerbyNetRemote.exclude
new file mode 100644
index 000000000..6405ed20c
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/suites/DerbyNetRemote.exclude
@@ -0,0 +1,56 @@
+# this file holds tests that cannot be successfully run with DerbyNet framework
+# with a remote server. Tests in this file will be skipped in addition to those in 
+# DerbyNet.exclude when the property -DhostName is set to something else than the localhost
+#
+# excluding test   - because...
+# store/bootLock.java - this test uses local connections to make sure 
+#     a database cannot be loaded by 2 different instances.
+# jdbcapi/secureUsers,secureUsers1, users and users2.sql 
+#     because they expect the server to have been started with special derby.properties
+#     this test can be made to work by changing the properties from system properties
+#     i.e. set in a derby.properties file - to be database properties - i.e. set using
+#     SYSCS_SET_ procedure.
+# derbynet/dblook_test_net because it tries to search derby.log, which is on
+#     the server machine, and it assumes files in a location not consistent with running with 
+#     useprocess=false 
+# derbynet/getCurrentProperties for it exercises NetworkServerControl statements
+#     that are only supported on localhost
+# derbynet/NSinSameJVM - tries to start the server
+# derbynet/DataSourcePermissions_net - tries to use NetworkServerControl statements
+# derbynet/maxthreads - tries to use NetworkServerControl statements
+# derbynet/runtimeinfo - tries to use NetworkServerControl statements
+# derbynet/sysinfo - tries to use NetworkServerControl statements
+# derbynet/testProperties - tries to use NetworkServerControl statements
+# derbynet/timeslice - tries to use NetworkServerControl statements
+# derbynet/DerbyNetAutoStart - tries to start networkserver
+# derbynet/DerbyNetNewServer - tries to start networkserver and uses local connections to the db.
+# tools/ieptests - names files in extin dir, which is in a different location when run with
+#     useprocess=false
+# tools/importExport - tries to confirm correct export by file-comparing the exported files,
+#	which may be on a different machine and thus not found.
+# lang/wisconsin - optimization is quite different when running remote server.
+# lang/syscat - test is too sensitive to other tests leaving behind stuff
+# junitTests/derbyNet/CompatibilityTest.java - tries to start and shutdown the server, which will
+# 	give securitymanager errors.
+# 
+store/bootLock.java
+jdbcapi/secureUsers.sql
+jdbcapi/secureUsers1.sql
+jdbcapi/users.sql
+jdbcapi/users2.sql
+derbynet/dblook_test_net.java
+derbynet/getCurrentProperties.java
+derbynet/NSinSameJVM.java
+derbynet/DataSourcePermissions_net.java
+derbynet/maxthreads.java
+derbynet/runtimeinfo.java
+derbynet/sysinfo.java
+derbynet/testProperties.java
+derbynet/timeslice.java
+derbynet/DerbyNetAutoStart.java
+derbynet/DerbyNetNewServer.java
+tools/ieptests.sql
+tools/importExport.java
+lang/wisconsin.sql
+lang/syscat.sql
+junitTests/derbyNet/CompatibilityTest.java
diff --git a/java/testing/org/apache/derbyTesting/functionTests/suites/derbynetmats.runall b/java/testing/org/apache/derbyTesting/functionTests/suites/derbynetmats.runall
index 4ca0c1ba2..f38610ddc 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/suites/derbynetmats.runall
+++ b/java/testing/org/apache/derbyTesting/functionTests/suites/derbynetmats.runall
@@ -26,7 +26,6 @@ jdbcapi/metadataMultiConn.java
 jdbcapi/odbc_metadata.java
 lang/optimizerOverrides.sql
 jdbcapi/parameterMetaDataJdbc30.java
-jdbcapi/savepointJdbc30.java
 lang/big.sql
 lang/bug5054.java
 lang/ConcurrentImplicitCreateSchema.java
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/DerbyNetAutoStart.java b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/DerbyNetAutoStart.java
index 06c132693..ff565f083 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/DerbyNetAutoStart.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/DerbyNetAutoStart.java
@@ -72,6 +72,7 @@ public class DerbyNetAutoStart
     private static Connection embeddedConn;
     private static int testNumber = 0;
     private static int portNumber;
+    private static String hostName;
     private static String homeDir;
     private static String databaseName;
     private static Properties baseProperties = new Properties();
@@ -113,6 +114,7 @@ public class DerbyNetAutoStart
 
 			ij.getPropertyArg(args);
             homeDir = System.getProperty( "derby.system.home", ".");
+            hostName = TestUtil.getHostName();
             
             for( int i = 0; i < args.length; i++)
             {
@@ -134,7 +136,7 @@ public class DerbyNetAutoStart
                     if( portNumber <= 0)
                         portNumber = NetworkServerControl.DEFAULT_PORTNUMBER;
                     
-                    NetworkServerControl server = new NetworkServerControl(InetAddress.getByName("localhost"),portNumber);
+                    NetworkServerControl server = new NetworkServerControl(InetAddress.getByName(hostName),portNumber);
                     server.start(null);
 					// Wait for server to come up 
 					for (int j = 0; j < 60; j++)
@@ -316,7 +318,7 @@ public class DerbyNetAutoStart
 
         Process serverProcess = Runtime.getRuntime().exec( cmd);
         // Wait for to start
-        String dbUrl = TestUtil.getJdbcUrlPrefix("localhost",
+        String dbUrl = TestUtil.getJdbcUrlPrefix(hostName,
 												 Integer.parseInt(portStr)) +
 			"database1";
         Connection drdaConn = null;
@@ -450,7 +452,7 @@ public class DerbyNetAutoStart
         try
         {
             NetworkServerControl server =
-				new NetworkServerControl(InetAddress.getByName("localhost"),
+				new NetworkServerControl(InetAddress.getByName(hostName),
 									 portNumber);
 			server.shutdown();
             Thread.sleep(5000);
@@ -540,7 +542,7 @@ public class DerbyNetAutoStart
                 try
                 {
                     drdaConn = DriverManager.getConnection(
-														   TestUtil.getJdbcUrlPrefix("localhost",portNumber) + databaseName,
+														   TestUtil.getJdbcUrlPrefix(hostName,portNumber) + databaseName,
 														   authenticationProperties);
                     break;
                 }
@@ -658,7 +660,7 @@ public class DerbyNetAutoStart
                 }
                 catch( InterruptedException ie){};
                 drdaConn = DriverManager.getConnection(
-													   TestUtil.getJdbcUrlPrefix("localhost", portNumber) +  databaseName,
+													   TestUtil.getJdbcUrlPrefix(hostName, portNumber) +  databaseName,
                                                         authenticationProperties);
                 passed = false;
                 System.out.println( "Was able to connect to the network server after Derby shut down.");
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NSinSameJVM.java b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NSinSameJVM.java
index 135f69b46..8dd2a586b 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NSinSameJVM.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NSinSameJVM.java
@@ -77,7 +77,8 @@ public class NSinSameJVM {
 			System.out.println("FAIL Network Server did not start");
 			return;
 		}
-		String jdbcUrlPrefix = TestUtil.getJdbcUrlPrefix("localhost", NETWORKSERVER_PORT);
+		String hostName = TestUtil.getHostName();
+		String jdbcUrlPrefix = TestUtil.getJdbcUrlPrefix(hostName, NETWORKSERVER_PORT);
 
         String url = jdbcUrlPrefix + databaseFileName;
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/callable.java b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/callable.java
index 23cdb8e0e..c68940ac0 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/callable.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/callable.java
@@ -33,6 +33,7 @@ import java.sql.BatchUpdateException;
 import java.sql.DriverManager;
 import java.sql.Connection;
 import org.apache.derby.tools.ij;
+import org.apache.derbyTesting.functionTests.util.TestUtil;
 /**
 	This test tests the JDBC CallableStatement.
 */
@@ -50,7 +51,8 @@ public class callable
 
 			// This also tests quoted pathname in database name portion of URL, beetle 4781.
 			String protocol = System.getProperty("ij.protocol");
-			System.setProperty("ij.database", protocol + "//localhost/\"" + System.getProperty("derby.system.home") + java.io.File.separator + "wombat;create=true\"");
+			String hostName = TestUtil.getHostName();
+			System.setProperty("ij.database", protocol + "//" + hostName + "/\"" + System.getProperty("derby.system.home") + java.io.File.separator + "wombat;create=true\"");
 			ij.getPropertyArg(args); 
 			Connection conn = ij.startJBMS();
 			if (conn == null)
@@ -228,6 +230,9 @@ public class callable
 			// Temporarily take out testbatch until jcc bug is fixed (5827)
 			// testBatch(conn);
 
+                        cleanUp(stmt);
+			stmt.close();
+			conn.close();
 			System.out.println("CallableStatement Test Ends");
         }
 		catch (Exception e)
@@ -695,4 +700,15 @@ public class callable
 	  
 	}
 
+
+	// test update of table in batch
+	public static void cleanUp (Statement stmt) throws SQLException 
+	{
+		String[] testObjects = { "table longvarbinary_tab", "table num_tab",
+			"procedure method1", "function method2",
+			"function method4", 
+			"procedure longvarbinary_in"}; 	
+		TestUtil.cleanUpTest(stmt, testObjects);
+	}
+
 }
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/checkSecMgr.java b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/checkSecMgr.java
index 5fad125fa..0bf2fd0f5 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/checkSecMgr.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/checkSecMgr.java
@@ -48,6 +48,7 @@ public class checkSecMgr
 			// bug 6021
 			// testIllegalDBCreate();
 			testIllegalPropertySet(conn);
+			cleanUp(conn);
 		}
 		catch (Exception e)
 		{
@@ -71,9 +72,18 @@ public class checkSecMgr
 			//    We seem to be able to create the database.
 			// Ideally this test should attempt to create the database
 			// ../wombat;create=true and get the security exception.
-			String databaseURL = TestUtil.getJdbcUrlPrefix() + "localhost/" + 
-				"\"D:/wombat;create=true\"";
-			System.out.println(databaseURL);
+			String hostName = TestUtil.getHostName();
+			String databaseURL;
+			if (hostName.equals("localhost"))
+			{
+				databaseURL = TestUtil.getJdbcUrlPrefix() + hostName + 
+				"/\"D:/wombat;create=true\"";
+			}
+			else
+			{
+				databaseURL = TestUtil.getJdbcUrlPrefix() + hostName + "wombat";
+			}
+			//System.out.println(databaseURL);
 			java.util.Properties properties = new java.util.Properties();
 			properties.put ("user", "cs");
 			properties.put ("password", "cs");
@@ -114,4 +124,15 @@ public class checkSecMgr
 	{
 		System.setProperty("notAllowed", "somevalue");
 	}
+
+	public static void cleanUp(Connection conn) throws SQLException
+	{
+		Statement stmt = conn.createStatement();
+		try {
+			stmt.executeUpdate("drop procedure setIllegalPropertyProc");
+		} catch (SQLException se) {
+			JDBCTestDisplayUtil.ShowCommonSQLException(System.out, se);
+		}
+	}
+
 }
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/copyfiles.ant b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/copyfiles.ant
index 29f10318f..698b88448 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/copyfiles.ant
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/copyfiles.ant
@@ -24,6 +24,7 @@ testProperties_derby.properties
 testProtocol_app.properties
 testProtocol_derby.properties
 testSecMec_app.properties
+testSecMec_sed.properties
 timeslice_app.properties
 protocol.tests
 excsat_accsecrd1.inc
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/csPrepStmt.java b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/csPrepStmt.java
index 4d7f93884..ecb81d1fd 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/csPrepStmt.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/csPrepStmt.java
@@ -39,10 +39,14 @@ import org.apache.derby.tools.ij;
 	This test tests the JDBC PreparedStatement.
 */
 
-class csPrepStmt
+public class csPrepStmt
 {
 	private static Connection conn = null;
 
+    private static String[] testObjects =  // string array for cleaning up
+        {"table t1", "table tab1", "table t2", "table bigtab", "table tstab",
+         "table Numeric_Tab", "table lobCheckOne", "table lobCheckTwo"};
+
 	public static void main (String args[])
 	{
 		try
@@ -52,11 +56,16 @@ class csPrepStmt
 			// Initialize JavaCommonClient Driver.
 			ij.getPropertyArg(args); 
 			conn = ij.startJBMS();
+
 			if (conn == null)
 			{
 				System.out.println("conn didn't work");
 				return;
 			}
+
+			Statement cleanstmt = conn.createStatement();
+			TestUtil.cleanUpTest(cleanstmt, testObjects);
+
 			PreparedStatement ps;
 			ResultSet rs;
 			boolean hasResultSet;
@@ -293,8 +302,23 @@ class csPrepStmt
 				System.out.println("SQLState: " + e.getSQLState() + 
 								   " message: " + e.getMessage());
 			}
-			rs.close();
-			ps.close();
+			finally
+			{
+				try
+				{
+					if(rs != null)
+					{
+						 rs.close();
+						 rs = null;
+					}
+					if(ps != null)
+					{
+						 ps.close();
+						 ps = null;
+					}
+				}
+				catch(Exception e){ }
+			}
 
 			test4975(conn);
 			test5130(conn);
@@ -302,6 +326,11 @@ class csPrepStmt
 			testLobInRS(conn);
 
 			conn.close();
+			// cleanup, first refresh conn
+			conn = ij.startJBMS();
+			cleanstmt = conn.createStatement();
+			TestUtil.cleanUpTest(cleanstmt, testObjects);
+			cleanstmt.close();
 			System.out.println("csPrepStmt Test Ends");
         }
 		catch (Exception e)
@@ -364,6 +393,8 @@ class csPrepStmt
 		ps.setString(2, timestamp );
 		try {
 			ResultSet rs = ps.executeQuery();
+            rs.close();
+			ps.close( );
 		}
 		catch (SQLException e) {
 			System.out.println("SQLState: " + e.getSQLState() + " message: " + e.getMessage());
@@ -503,6 +534,7 @@ class csPrepStmt
 			for (i = 1; i <= numCols; i++)
 				ps.setInt(i,i);
 			ps.executeUpdate();
+			ps.close();
 		} catch (SQLException e)
 		{
 			System.out.println("SQLState: " + e.getSQLState() + 
@@ -588,7 +620,8 @@ class csPrepStmt
 			else
 				System.out.println("FAIL: Statement executed, but returned " +
 					"an empty result set.");
-
+			rs.close();
+			st.close();
 		} catch (Exception e) {
 			System.out.println("FAIL: Encountered exception:");
 			e.printStackTrace();
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/dataSourcePermissions_net.java b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/dataSourcePermissions_net.java
index 1913bdf6f..70933f45d 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/dataSourcePermissions_net.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/dataSourcePermissions_net.java
@@ -59,18 +59,26 @@ import java.lang.reflect.*;
 public class dataSourcePermissions_net extends org.apache.derbyTesting.functionTests.tests.jdbcapi.dataSourcePermissions
 {
 
-	private static final int NETWORKSERVER_PORT = 20000;
-
+	private static int NETWORKSERVER_PORT;
+	private static String hostName;
 	private static NetworkServerControl networkServer = null;
 
 	public static void main(String[] args) throws Exception {
 
+		hostName = TestUtil.getHostName();
+		if (hostName.equals("localhost"))
+			NETWORKSERVER_PORT = 20000;
+		else
+			NETWORKSERVER_PORT = 1527;
+		
 		// Load harness properties.
 		ij.getPropertyArg(args);
 
 		// "runTest()" is going to try to connect to the database through
 		// the server at port NETWORKSERVER_PORT.  Thus, we have to
 		// start the server on that port before calling runTest.
+		// Except when we are using a remote server, then we assume the port is 1527,
+		// and we assume the server has been started already
 
 		try {
 			TestUtil.loadDriver();
@@ -78,13 +86,17 @@ public class dataSourcePermissions_net extends org.apache.derbyTesting.functionT
 			e.printStackTrace();
 		}
 
-		// Start the NetworkServer on another thread
-		networkServer = new NetworkServerControl(InetAddress.getByName("localhost"),NETWORKSERVER_PORT);
-		networkServer.start(null);
 
-		// Wait for the NetworkServer to start.
-		if (!isServerStarted(networkServer, 60))
-			System.exit(-1);
+		if (hostName.equals("localhost"))
+		{
+			// Start the NetworkServer on another thread
+			networkServer = new NetworkServerControl(InetAddress.getByName("localhost"),NETWORKSERVER_PORT);
+			networkServer.start(null);
+
+			// Wait for the NetworkServer to start.
+			if (!isServerStarted(networkServer, 60))
+				System.exit(-1);
+		}
 
 		// Now, go ahead and run the test.
 		try {
@@ -93,6 +105,7 @@ public class dataSourcePermissions_net extends org.apache.derbyTesting.functionT
 			tester.runTest();
 			if (TestUtil.isDerbyNetClientFramework())
 				tester.testClientDataSourceProperties();
+			new dataSourcePermissions_net().cleanUp();
 
 		} catch (Exception e) {
 		// if we catch an exception of some sort, we need to make sure to
@@ -105,10 +118,13 @@ public class dataSourcePermissions_net extends org.apache.derbyTesting.functionT
 		}
 
 		// Shutdown the server.
-		networkServer.shutdown();
-		// how do we do this with the new api?
-		//networkServer.join();
-		Thread.sleep(5000);
+		if (hostName.equals("localhost"))
+		{
+			networkServer.shutdown();
+			// how do we do this with the new api?
+			//networkServer.join();
+			Thread.sleep(5000);
+		}
 		System.out.println("Completed dataSourcePermissions_net");
 
 		System.out.close();
@@ -121,10 +137,9 @@ public class dataSourcePermissions_net extends org.apache.derbyTesting.functionT
 	}
 
 	public void setProperties() {
-
 		// Set required server properties.
 		System.setProperty("database",
-						   TestUtil.getJdbcUrlPrefix("localhost",
+						   TestUtil.getJdbcUrlPrefix(hostName,
 													 NETWORKSERVER_PORT) +
 						   "wombat;create=true");
 		System.setProperty("ij.user", "EDWARD");
@@ -133,15 +148,19 @@ public class dataSourcePermissions_net extends org.apache.derbyTesting.functionT
 	}
 
 	public String getJDBCUrl(String db, String attrs) {
-
-		String s = TestUtil.getJdbcUrlPrefix("localhost", NETWORKSERVER_PORT)
+		// this method is accessed from subclasses - need to establish hostName
+		String hostName = TestUtil.getHostName();
+		if (hostName.equals("localhost"))
+			NETWORKSERVER_PORT = 20000;	
+		else
+			NETWORKSERVER_PORT = 1527;
+		String s = TestUtil.getJdbcUrlPrefix(hostName, NETWORKSERVER_PORT)
 			+ db;
 		if (attrs != null)
 			if (TestUtil.isJCCFramework())
 				s = s + ":" + attrs + ";";
 			else
 				s = s + ";" + attrs;
-		//System.out.println("getJDBCUrl:" + s);
 		return s;
 
 	}
@@ -182,18 +201,27 @@ public class dataSourcePermissions_net extends org.apache.derbyTesting.functionT
 
 	private Properties addRequiredAttributes(Properties attrs)
 	{
+		// this method is accessed from subclasses - need to establish hostName
+		hostName = TestUtil.getHostName();
 		if (TestUtil.isJCCFramework())
 		{
 			attrs.setProperty("driverType","4");
             /**
-             * As per the fix of derby-410
-             * servername should now default to localhost 
+             * As per the fix of derby-410 servername should
+             * default to localhost, but for jcc it's still needed  
              */
-            attrs.setProperty("serverName","localhost");
+            attrs.setProperty("serverName",hostName);
 		}
-
-
-		attrs.setProperty("portNumber","20000");
+		/** 
+		 * For a remote host of course it's also needed 
+		 */
+		if (!hostName.equals("localhost"))
+		{
+			attrs.setProperty("serverName",hostName);
+			attrs.setProperty("portNumber", "1527");
+		}
+		else
+			attrs.setProperty("portNumber", "20000");
 		//attrs.setProperty("retrieveMessagesFromServerOnGetMessage","true");
 		return attrs;
 	}
@@ -213,10 +241,9 @@ public class dataSourcePermissions_net extends org.apache.derbyTesting.functionT
 	}
 
 	public void shutdown() {
-
 		try {
-			DriverManager.getConnection(TestUtil.getJdbcUrlPrefix("localhost",
-																  NETWORKSERVER_PORT) +
+			DriverManager.getConnection(TestUtil.getJdbcUrlPrefix(hostName,
+															  NETWORKSERVER_PORT) +
 										"wombat;shutdown=true",
 				"EDWARD", "noodle");
 			System.out.println("FAIL - Shutdown returned connection");
@@ -224,8 +251,8 @@ public class dataSourcePermissions_net extends org.apache.derbyTesting.functionT
 		} catch (SQLException sqle) {
 			System.out.println("EXPECTED SHUTDOWN " + sqle.getMessage());
 		}
-
 	}
+
 	protected static boolean isServerStarted(NetworkServerControl server, int ntries)
 	{
 		for (int i = 1; i <= ntries; i ++)
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/executeUpdate.java b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/executeUpdate.java
index d472bd36f..3b3ea7009 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/executeUpdate.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/executeUpdate.java
@@ -33,7 +33,7 @@ import org.apache.derby.tools.ij;
 	is minimally covered.
 */
 
-class executeUpdate
+public class executeUpdate
 {
 
 	public static void main (String args[])
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/maxthreads.java b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/maxthreads.java
index f96815452..32f7278d6 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/maxthreads.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/maxthreads.java
@@ -30,6 +30,7 @@ import org.apache.derby.iapi.reference.Property;
 import org.apache.derby.drda.NetworkServerControl;
 import org.apache.derbyTesting.functionTests.harness.jvm;
 import org.apache.derbyTesting.functionTests.harness.ProcessStreamResult;
+import org.apache.derbyTesting.functionTests.util.TestUtil;
 import org.apache.derby.tools.ij;
 
 /**
@@ -55,7 +56,7 @@ public class maxthreads
 			"maxthreads", "a"};
     private static  BufferedOutputStream bos = null;
 	private static  NetworkServerControl server;
-	private static String host = "localhost";
+	private static String host;
 	private static int port = 1527;
 	/**
 	 * Execute the given command and dump the results to standard out
@@ -116,6 +117,9 @@ public class maxthreads
 
 	public static void main (String args[]) throws Exception
 	{
+		host = TestUtil.getHostName();
+		maxthreadsCmd2[4] = host;
+		
 		if ((System.getProperty("java.vm.name") != null) && System.getProperty("java.vm.name").equals("J9"))
 			jvm = jvm.getJvm("j9_13");
 		else
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/prepStmt.java b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/prepStmt.java
index 37b3233d3..7faeddf80 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/prepStmt.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/prepStmt.java
@@ -40,10 +40,14 @@ import org.apache.derby.tools.JDBCDisplayUtil;
 	This test tests the JDBC PreparedStatement.
 */
 
-class prepStmt
+public class prepStmt
 {
 	private static Connection conn = null;
 
+    private static String[] testObjects =  // string array for cleaning up
+        {"table t1", "table tab1", "table t2", "table bigtab", "table tstab",
+         "table doubletab", "table numtab", "table Numeric_Tab", "table jira614"};
+
 	public static void main (String args[])
 	{
 		try
@@ -57,6 +61,10 @@ class prepStmt
 				System.out.println("conn didn't work");
 				return;
 			}
+	
+			Statement cleanstmt = conn.createStatement();
+			TestUtil.cleanUpTest(cleanstmt, testObjects);
+
 			PreparedStatement ps;
 			ResultSet rs;
 			boolean hasResultSet;
@@ -302,6 +310,12 @@ class prepStmt
 			test5172(conn);
 			jira614Test(conn);
 			conn.close();
+			// refresh conn before cleaning up
+			conn = ij.startJBMS();
+			cleanstmt = conn.createStatement();
+			TestUtil.cleanUpTest(cleanstmt, testObjects);
+			cleanstmt.close();
+			conn.close();
 			System.out.println("prepStmt Test Ends");
         }
 		catch (Exception e)
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/protocol.tests b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/protocol.tests
index b369fd12c..9c0469d3c 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/protocol.tests
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/protocol.tests
@@ -1265,6 +1265,34 @@ skipDss // RDBUPDRM
 checkSQLCard 0 "     "
 skipDss // ENDUOWRM
 skipDss // SQLCARD for commit
+// use default encoding for drop statement
+createDssRequest
+startDdm EXCSQLIMM
+startDdm PKGNAMCSN
+writePaddedString "test" 18
+writePaddedString "rdbcolid" 18
+writePaddedString "pkgid"  18
+writeBytes "0x0101010101010101"
+writeShort 1
+endDdm
+endDdm
+endDss
+createDssObject 
+startDdm SQLSTT
+writeByte 0	// null indicator
+writeEncodedLDString "drop table rdbcmtoktrue" "UTF-8" 4
+writeByte 255 // null indicator
+endDdm
+endDss "0x40"
+createDssRequest // send commit
+startDdm RDBCMM
+endDdm
+endDss
+flush
+skipDss // RDBUPDRM
+checkSQLCard 0 "     "
+skipDss // ENDUOWRM
+skipDss //SQLCARD for commit
 endTest
 //
 DISPLAY "Test for valid false value for RDBCMTOK in EXCSQLIMM"
@@ -1297,6 +1325,34 @@ skipDss // RDBUPDRM
 checkSQLCard 0 "     "
 skipDss // ENDUOWRM
 skipDss // SQLCARD for commit
+// use default encoding for drop statement
+createDssRequest
+startDdm EXCSQLIMM
+startDdm PKGNAMCSN
+writePaddedString "test" 18
+writePaddedString "rdbcolid" 18
+writePaddedString "pkgid"  18
+writeBytes "0x0101010101010101"
+writeShort 1
+endDdm
+endDdm
+endDss
+createDssObject 
+startDdm SQLSTT
+writeByte 0	// null indicator
+writeEncodedLDString "drop table rdbcmtokfalse" "UTF-8" 4
+writeByte 255 // null indicator
+endDdm
+endDss "0x40"
+createDssRequest // send commit
+startDdm RDBCMM
+endDdm
+endDss
+flush
+skipDss // RDBUPDRM
+checkSQLCard 0 "     "
+skipDss // ENDUOWRM
+skipDss //SQLCARD for commit
 endTest
 //
 DISPLAY "Test that we only send one RDBUPRM per transaction"
@@ -3100,4 +3156,35 @@ endDss
 flush
 checkError SYNTAXRM	8 29 TYPDEFNAM
 endTest
+// 
+include connect.inc
+createDssRequest
+startDdm EXCSQLIMM
+startDdm PKGNAMCSN
+writePaddedString "test" 18
+writePaddedString "rdbcolid" 18
+writePaddedString "pkgid"  18
+writeBytes "0x0101010101010101"
+writeShort 1
+endDdm
+endDdm
+endDss
+createDssObject 
+startDdm SQLSTT
+writeByte 0	// null indicator
+writeEncodedLDString "drop schema test restrict" "UTF-8" 4
+writeByte 255 // null indicator
+endDdm
+endDss "0x40"
+createDssRequest // send commit
+startDdm RDBCMM
+endDdm
+endDss
+flush
+skipDss // RDBUPDRM
+checkSQLCard 0 "     "
+skipDss // ENDUOWRM
+skipDss //SQLCARD for commit
+endTest
+completeTest
 //
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testProtocol.java b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testProtocol.java
index 9433e2ab7..8b82e3798 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testProtocol.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testProtocol.java
@@ -32,7 +32,7 @@ public class testProtocol {
 	private static final String DEFAULT_FILENAME = "protocol.tests";
 	
 	// constructor
-	private testProtocol() {}
+	public testProtocol() {}
 	
 
 	/**
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testSecMec.java b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testSecMec.java
index 9c73c1b59..f7c18fcb0 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testSecMec.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testSecMec.java
@@ -53,7 +53,7 @@ public class testSecMec extends dataSourcePermissions_net
 
 {
 
-	private static final int NETWORKSERVER_PORT = 20000;
+	private static int NETWORKSERVER_PORT;
 
 	private static NetworkServerControl networkServer = null;
 
@@ -62,6 +62,12 @@ public class testSecMec extends dataSourcePermissions_net
 		// Load harness properties.
 		ij.getPropertyArg(args);
 
+		String hostName = TestUtil.getHostName();
+		if (hostName.equals("localhost"))
+			NETWORKSERVER_PORT = 20000;
+		else
+			NETWORKSERVER_PORT = 1527;
+
 		// "runTest()" is going to try to connect to the database through
 		// the server at port NETWORKSERVER_PORT.  Thus, we have to
 		// start the server on that port before calling runTest.
@@ -72,13 +78,16 @@ public class testSecMec extends dataSourcePermissions_net
 			e.printStackTrace();
 		}
 
-		// Start the NetworkServer on another thread
-		networkServer = new NetworkServerControl(InetAddress.getByName("localhost"),NETWORKSERVER_PORT);
-		networkServer.start(null);
+		// Start the NetworkServer on another thread, unless it's a remote host
+		networkServer = new NetworkServerControl(InetAddress.getByName(hostName),NETWORKSERVER_PORT);
+		if (hostName.equals("localhost"))
+		{
+			networkServer.start(null);
 
-		// Wait for the NetworkServer to start.
-		if (!isServerStarted(networkServer, 60))
-			System.exit(-1);
+			// Wait for the NetworkServer to start.
+			if (!isServerStarted(networkServer, 60))
+				System.exit(-1);
+		}
 
 		// Now, go ahead and run the test.
 		try {
@@ -96,10 +105,13 @@ public class testSecMec extends dataSourcePermissions_net
 		}
 
 		// Shutdown the server.
-		networkServer.shutdown();
-		// how do we do this with the new api?
-		//networkServer.join();
-		Thread.sleep(5000);
+		if (hostName.equals("localhost"))
+		{
+			networkServer.shutdown();
+			// how do we do this with the new api?
+			//networkServer.join();
+			Thread.sleep(5000);
+		}
 		System.out.println("Completed testSecMec");
 
 		System.out.close();
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testconnection.java b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testconnection.java
index cab0c5ed6..12024df1a 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testconnection.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testconnection.java
@@ -28,6 +28,7 @@ import java.io.BufferedOutputStream;
 
 import org.apache.derbyTesting.functionTests.harness.jvm;
 import org.apache.derbyTesting.functionTests.harness.ProcessStreamResult;
+import org.apache.derbyTesting.functionTests.util.TestUtil;
 import org.apache.derby.tools.ij;
 
 /**
@@ -39,6 +40,7 @@ public class testconnection
 
 	private static jvm jvm;
 	private static Vector vCmd;
+	private static String hostName;
 	private static String[] TestConnectionCmd1 = new String[] {"org.apache.derby.drda.NetworkServerControl",
 		"ping"};
 	private static String[] TestConnectionCmd2 = new String[] {"org.apache.derby.drda.NetworkServerControl",
@@ -51,12 +53,29 @@ public class testconnection
 	private static String[] TestConnectionCmd5 = new String[] {"org.apache.derby.drda.NetworkServerControl",
 		"ping", "-h", "localhost", "-p", "9393"};
 	private static String[] TestConnectionCmd6 = new String[] {"org.apache.derby.drda.NetworkServerControl",
-		"ping", "-p", "1527"};
+		"ping", "-h", "localhost", "-p", "1527"};
+	private static String[] TestConnectionCmd6b = new String[] {"org.apache.derby.drda.NetworkServerControl",
+		"ping", "-h", "localhost", "-p", "1527"};
 	private static String[] TestConnectionCmd7 = new String[] {"org.apache.derby.drda.NetworkServerControl",
-		"ping", "-p", "9393"};
+		"ping", "-h", "localhost", "-p", "9393"};
+	private static String[] TestConnectionCmd7b = new String[] {"org.apache.derby.drda.NetworkServerControl",
+		"ping", "-h", "localhost", "-p", "9393"};
 
     private static  BufferedOutputStream bos = null;
     
+    /**
+	 * Execute the given command and dump the results to standard out
+	 *
+	 * @param args	command and arguments
+     * @param printcmd to printout the executing command or not
+	 * @exception Exception
+	 */
+    private static void execCmdDumpResults (String[] args, boolean printcmd)
+        throws Exception
+    {
+        execCmdDumpResults(args, 0, printcmd);
+    }
+
     /**
 	 * Execute the given command and dump the results to standard out
 	 *
@@ -66,18 +85,31 @@ public class testconnection
     private static void execCmdDumpResults (String[] args)
         throws Exception
     {
-        execCmdDumpResults(args, 0);
+        execCmdDumpResults(args, 0, true);
     }
 
+
 	/**
 	 * Execute the given command and dump the results to standard out
 	 *
 	 * @param args	command and arguments
      * @param expectedExitCode the exit code that we expect from running this
+     */
+	private static void execCmdDumpResults (String[] args, int expectedExitCode)
+        throws Exception
+	{
+        execCmdDumpResults(args, expectedExitCode, true);
+    }
+
+	/**
+	 * Execute the given command and dump the results to standard out
+	 *
+	 * @param args	command and arguments
+     * @param expectedExitCode the exit code that we expect from running this
+     * @param printcmd to indicate if the executing command should get printed
 	 * @exception Exception
 	 */
-
-	private static void execCmdDumpResults (String[] args, int expectedExitCode)
+	private static void execCmdDumpResults (String[] args, int expectedExitCode, boolean printcmd)
         throws Exception
 	{
         // We need the process inputstream and errorstream
@@ -90,7 +122,10 @@ public class testconnection
         {
             sb.append(args[i] + " ");                    
         }
-        System.out.println(sb.toString());
+        if (printcmd)
+            System.out.println(sb.toString());
+        else
+            System.out.println("org.apache.derby.drda.NetworkServerControl ping...");            
 		int totalSize = vCmd.size() + args.length;
 		String serverCmd[] = new String[totalSize];
 		int i;
@@ -130,6 +165,15 @@ public class testconnection
 
 	public static void main (String args[]) throws Exception
 	{
+		hostName = TestUtil.getHostName();
+		TestConnectionCmd2[3] = hostName;
+		TestConnectionCmd4[3] = hostName;
+		TestConnectionCmd5[3] = hostName;
+		TestConnectionCmd6b[3] = hostName;
+		TestConnectionCmd7b[3] = hostName;
+        
+ 
+		
 		if ((System.getProperty("java.vm.name") != null) && System.getProperty("java.vm.name").equals("J9"))
 			jvm = jvm.getJvm("j9_13");
 		else
@@ -145,7 +189,12 @@ public class testconnection
 			 ************************************************************/
 			System.out.println("Testing testconnection");
 			//test connection - no parameters
-			execCmdDumpResults(TestConnectionCmd1);	
+            if (!hostName.equals("localhost")) // except with remote server, add the hostName 
+            {
+                execCmdDumpResults(TestConnectionCmd4, 0, false);
+            }
+            else
+		    	execCmdDumpResults(TestConnectionCmd1, false);	
 			//test connection - specifying host and port
 			execCmdDumpResults(TestConnectionCmd2);	
 			//test connection - specifying non-existant host and port
@@ -157,9 +206,15 @@ public class testconnection
 			//test connection - specifying host and invalid port
 			execCmdDumpResults(TestConnectionCmd5, 1);	
 			//test connection - specifying no host and valid port
-			execCmdDumpResults(TestConnectionCmd6);	
+            if (!hostName.equals("localhost")) // except with remote server, add the hostName
+			    execCmdDumpResults(TestConnectionCmd6b, false);	
+            else
+			    execCmdDumpResults(TestConnectionCmd6, false);	
 			//test connection - specifying no host and invalid port
-			execCmdDumpResults(TestConnectionCmd7, 1);	
+            if (!hostName.equals("localhost")) // except with remote server, add the hostName
+			    execCmdDumpResults(TestConnectionCmd7b, 1, false);	
+            else
+			    execCmdDumpResults(TestConnectionCmd7, 1, false);	
 
 			System.out.println("End test");
 			bos.close();
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testij.java b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testij.java
index d3bc07222..4aaf4d94b 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testij.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testij.java
@@ -23,11 +23,17 @@ import java.sql.*;
 import java.util.Vector;
 import java.util.Properties;
 import java.io.File;
+import java.io.FileInputStream;
 import java.io.FileOutputStream;
 import java.io.BufferedOutputStream;
+import java.io.InputStream;
+import java.io.OutputStream;
+import java.io.ByteArrayInputStream;
+import java.io.FileNotFoundException;
 
 import org.apache.derbyTesting.functionTests.harness.jvm;
 import org.apache.derbyTesting.functionTests.harness.ProcessStreamResult;
+import org.apache.derbyTesting.functionTests.harness.Sed;
 import org.apache.derbyTesting.functionTests.util.TestUtil;
 
 import org.apache.derby.drda.NetworkServerControl;
@@ -40,11 +46,15 @@ public class testij
 	private static Properties properties = new java.util.Properties();
 	private static jvm jvm;
 	private static Vector vCmd;
-	private static String[] jccIjCmd = new String[] {"org.apache.derby.tools.ij",
-		"extin/testij.sql"};
 
-	private static String[] clientIjCmd = new String[] {"org.apache.derby.tools.ij",
-													 "extin/testclientij.sql"};
+	private static String IjCmd="org.apache.derby.tools.ij";
+	private static String SqlDir="extin";
+	private static String jccSqlFile="testij.sql";
+	private static String sep;
+	private static String clientSqlFile="testclientij.sql";
+	private static String altExtinDir;
+	private static boolean useAltExtinDir=false;
+	
 	private static void execCmd (String[] args) throws Exception
 	{
 		int totalSize = vCmd.size() + args.length;
@@ -115,6 +125,42 @@ public class testij
 		bos.close();
 
 	}
+	
+    public static void massageSqlFile (String hostName, String fileName) throws Exception {
+        // only called if hostName is *not* localhost. 
+        // Need to replace each occurrence of the string 'localhost' with 
+        // whatever is the hostName
+        File tmpFile = new File("extin", "tmpFile.sql");
+        File orgFile = new File("extin", fileName);
+        // wrap this in a try to possibly try using user.dir to find the file
+        InputStream original; 
+        OutputStream copy; 
+        try { 
+            fileName = SqlDir + sep + fileName; 
+            original = new FileInputStream(fileName);
+            copy = new FileOutputStream(tmpFile);
+        }
+        catch (FileNotFoundException fnfe) {
+            // we must be running from within a suite...
+            useAltExtinDir = true;
+            String userdir =  System.getProperty("user.dir");
+            altExtinDir = userdir + sep + ".."; 
+            tmpFile = new File(altExtinDir, "tmpFile.sql");
+            orgFile = new File (altExtinDir,  fileName); 
+            fileName = altExtinDir + sep + fileName;
+            original = new FileInputStream(fileName);
+            copy = new FileOutputStream(tmpFile);
+        }
+        int content;
+        while ((content = original.read())> 0 ) {
+            copy.write(content);
+        }
+        copy.close();
+        original.close();
+        Sed hostSed = new Sed();
+        InputStream sedIs = new ByteArrayInputStream(("substitute=localhost;" + hostName).getBytes("UTF-8"));
+        hostSed.exec(tmpFile, orgFile, sedIs, false, false);		
+    }
 
 	public static void main (String args[]) throws Exception
 	{
@@ -123,6 +169,7 @@ public class testij
 		else
 			jvm = jvm.getJvm("currentjvm");		// ensure compatibility
 		vCmd = jvm.getCommandLine();
+		sep =  System.getProperty("file.separator");
 		try
 		{
 			/************************************************************
@@ -131,10 +178,27 @@ public class testij
 			//create wombat database
 			NetworkServerControl server = new NetworkServerControl();
 			System.out.println("Testing various ij connections and comments in front of selects");
-			if (TestUtil.isJCCFramework())
-				execCmdDumpResults(jccIjCmd);	
-			else   // Derby Client
-				execCmdDumpResults(clientIjCmd);	
+			
+			// first, we have to massage the .sql file to replace localhost, if 
+			// there is a system property set.
+						
+			String hostName=TestUtil.getHostName();
+			if (TestUtil.isJCCFramework()){
+				// use jccSqlfile
+				if (!hostName.equals("localhost")) 
+					massageSqlFile(hostName,jccSqlFile);
+				if (useAltExtinDir)	
+					execCmdDumpResults(new String[]{IjCmd,(altExtinDir + sep + SqlDir + sep + jccSqlFile)});
+				execCmdDumpResults(new String[]{IjCmd,(SqlDir + sep + jccSqlFile)});
+			} else {   // Derby Client
+				// use clientSqlFile
+				if(!hostName.equals("localhost")) {
+					massageSqlFile(hostName,clientSqlFile);
+				if (useAltExtinDir)	
+					execCmdDumpResults(new String[]{IjCmd,(altExtinDir + sep + SqlDir + sep + clientSqlFile)});
+				}
+				execCmdDumpResults(new String[]{IjCmd,(SqlDir + sep + clientSqlFile)});
+			}
 			System.out.println("End test");
 		}
 		catch (Exception e)
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testij_sed.properties b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testij_sed.properties
index 0464d00fb..c4ff5d594 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testij_sed.properties
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testij_sed.properties
@@ -9,7 +9,7 @@ en
 # No commas or semicolons can be allowed in the patterns/subsitutes.
 -------------------------------------------------------------------------------
 --
-substitute=(server log.*);(server log XXX),Required user property not set;null userid not supported
+substitute=(server log.*);(server log XXX),Required user property not set;null userid not supported,org.apache.derby.tools.ij.*;org.apache.derby.tools.ij xxxFILTERED_TESTIJSOURCExxx
 
 
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/timeslice.java b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/timeslice.java
index 905bc27dd..094579a02 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/timeslice.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/timeslice.java
@@ -30,6 +30,7 @@ import org.apache.derby.iapi.reference.Property;
 import org.apache.derby.drda.NetworkServerControl;
 import org.apache.derbyTesting.functionTests.harness.jvm;
 import org.apache.derbyTesting.functionTests.harness.ProcessStreamResult;
+import org.apache.derbyTesting.functionTests.util.TestUtil;
 import org.apache.derby.tools.ij;
 
 /**
@@ -55,7 +56,7 @@ public class timeslice
 			"timeslice", "a"};
     private static  BufferedOutputStream bos = null;
 	private static  NetworkServerControl server;
-	private static String host = "localhost";
+	private static String host;
 	private static int port = 1527;
 	/**
 	 * Execute the given command and dump the results to standard out
@@ -115,6 +116,8 @@ public class timeslice
 
 	public static void main (String args[]) throws Exception
 	{
+		host = TestUtil.getHostName();
+		timesliceCmd2[4] = host;
 		if ((System.getProperty("java.vm.name") != null) && System.getProperty("java.vm.name").equals("J9"))
 			jvm = jvm.getJvm("j9_13");
 		else
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/LOBTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/LOBTest.java
index 856c3bd9b..e8c22b50c 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/LOBTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/LOBTest.java
@@ -470,6 +470,7 @@ class LOBTester {
 				" ) values (cast (X'a78a' as blob(80)) )";
 			Xprint(insert);
 		}
+            Xprint("drop table blobCheck");
 	}
     public void test() throws SQLException {
         // create table for testing
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/StmtCloseFunTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/StmtCloseFunTest.java
index 083be0e92..4c5be0283 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/StmtCloseFunTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/StmtCloseFunTest.java
@@ -65,10 +65,12 @@ public class StmtCloseFunTest {
 			// make the initial connection.
 			ij.getPropertyArg(args);
 			Connection conn = ij.startJBMS();
+			cleanUp(conn);
 			test1(conn);
 			test2(conn);
 			test3(conn);
 
+			cleanUp(conn);
 			conn.close();		
 				
 		} catch (SQLException e) {
@@ -81,6 +83,16 @@ public class StmtCloseFunTest {
 		System.out.println("Statement Close Fun Test finished");
 	}
 
+	
+    private static void cleanUp(Connection conn) throws SQLException {
+	Statement s = conn.createStatement();
+	String[] testObjects = {"PROCEDURE TAKESSTRING", "TABLE TAB1", "TABLE TAB2", "TABLE TAB3"};
+        try {
+		TestUtil.cleanUpTest(s, testObjects);
+	} catch (SQLException se){//
+	}
+    }
+
     private static void test1(Connection conn) {
 		Statement s;
         try {
@@ -583,7 +595,6 @@ public class StmtCloseFunTest {
 				}
 				catch(SQLException e) { }
 
-				s.execute("drop procedure takesString");
 				s.close();
 			}
 		
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/Stream.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/Stream.java
index d8b7cb1f7..6b8fbf3cb 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/Stream.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/Stream.java
@@ -1,465 +1,467 @@
-/*
-
-Derby - Class org.apache.derbyTesting.functionTests.tests.jdbcapi.Stream
-
-Copyright 1999, 2005 The Apache Software Foundation or its licensors, as applicable.
-
-Licensed under the Apache License, Version 2.0 (the "License");
-you may not use this file except in compliance with the License.
-You may obtain a copy of the License at
-
-http://www.apache.org/licenses/LICENSE-2.0
-
-Unless required by applicable law or agreed to in writing, software
-distributed under the License is distributed on an "AS IS" BASIS,
-WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-See the License for the specific language governing permissions and
-limitations under the License.
-
-*/
-
-package org.apache.derbyTesting.functionTests.tests.jdbcapi;
-
-import java.io.InputStream;
-import java.io.Reader;
-import java.sql.Connection;
-import java.sql.Statement;
-import java.sql.PreparedStatement;
-import java.sql.ResultSet;
-
-import java.io.IOException;
-import java.sql.SQLException;
-
-import org.apache.derby.tools.ij;
-
-
-public class Stream {
-    
-    public static void main(String[] args){
-	
-	Connection conn = null;
-
-	try{
-	    ij.getPropertyArg(args);
-	    conn = ij.startJBMS();
-	    
-	    createTestTables(conn);
-	    executeTests(conn);
-	    dropTestTables(conn);
-	    
-	}catch(Throwable t){
-	    t.printStackTrace();
-	    
-	}finally{
-	    if(conn != null){
-		try{
-		    conn.close();
-		    
-		}catch(SQLException e){
-		    e.printStackTrace();
-		}
-		
-	    }
-	}
-	
-    }
-
-    
-    private static void createTestTables(Connection conn) 
-	throws SQLException,IOException {
-	
-	createTable(conn);
-	createTestData(conn);
-	
-    }
-    
-    
-    private static void createTable(Connection conn) throws SQLException {
-	
-	Statement st = null;
-	
-	try{
-	    
-	    st = conn.createStatement();
-	    st.execute("create table SMALL_BLOB_TABLE( SMALL_BLOB blob( 512 ))");
-	    st.execute("create table LARGE_BLOB_TABLE( LARGE_BLOB blob( 512k ))");
-	    st.execute("create table SMALL_CLOB_TABLE( SMALL_CLOB clob( 512 ))");
-	    st.execute("create table LARGE_CLOB_TABLE( LARGE_CLOB clob( 512k ))");
-
-	}finally{
-	    if(st != null)
-		st.close();
-	}
-	
-    }
-
-    
-    private static void createTestData(Connection conn) 
-	throws SQLException,IOException {
-
-	createSmallBlobTestData( conn );
-	createLargeBlobTestData( conn );
-	createSmallClobTestData( conn );
-	createLargeClobTestData( conn );
-	
-    }
-    
-    
-    private static void createSmallBlobTestData(Connection conn) 
-	throws SQLException,IOException {
-	
-	PreparedStatement st = null;
-	TestDataStream stream = null;
-
-	try{
-	    st = conn.prepareStatement("insert into SMALL_BLOB_TABLE(SMALL_BLOB) values(?)");
-	    stream = new TestDataStream(512);
-	    st.setBinaryStream(1, stream, 512);
-	    st.executeUpdate();
-	    
-	}finally{
-	    if(st != null){
-		st.close();
-	    }
-
-	    if(stream != null){
-		stream.close();
-	    }
-	    
-	}
-
-    }
-    
-    
-    private static void createLargeBlobTestData(Connection conn) 
-	throws SQLException,IOException {
-	
-	PreparedStatement st = null;
-	TestDataStream stream = null;
-	
-	try{
-	    st = conn.prepareStatement("insert into LARGE_BLOB_TABLE(LARGE_BLOB) values(?)");
-	    stream = new TestDataStream( 512 * 1024);
-	    st.setBinaryStream(1,stream, 512 * 1024);
-
-	    st.executeUpdate();
-	    
-	}finally{
-	    if(st != null){
-		st.close();
-	    }
-
-	    if(stream != null){
-		stream.close();
-	    }
-	}
-    }
-    
-    
-    private static void createSmallClobTestData(Connection conn)
-	throws SQLException,IOException {
-	
-	PreparedStatement st = null;
-	TestDataReader reader = null;
-	
-	try{
-	    st = conn.prepareStatement("insert into SMALL_CLOB_TABLE( SMALL_CLOB ) values(?)");
-
-	    reader = new TestDataReader( 512 );
-	    st.setCharacterStream(1,
-				  reader, 
-				  512);
-	    
-	    st.executeUpdate();
-	    
-	    
-	}finally{
-	    if(st != null)
-		st.close();
-	    
-	    if(reader != null)
-		reader.close();
-	    
-	}
-	
-    }   
-    
-
-    private static void createLargeClobTestData(Connection conn)
-	throws SQLException, IOException {
-	
-	PreparedStatement st = null;
-	TestDataReader reader = null;
-
-	try{
-	    st = conn.prepareStatement("insert into LARGE_CLOB_TABLE( LARGE_CLOB ) values(?)");
-	    
-	    reader = new TestDataReader( 512 * 1024 );
-	    st.setCharacterStream(1,
-				  reader,
-				  512 * 1024 );
-	    
-	    st.executeUpdate();
-	    
-	    
-	} finally {
-	    if(st != null)
-		st.close();
-	    
-	    if(reader != null)
-		reader.close();
-	}
-    }
-
-    private static void executeTests(Connection conn) 
-	throws SQLException, IOException {
-	
-	executeTestOnSmallBlob( conn );
-	executeTestOnLargeBlob( conn );
-	executeTestOnSmallClob( conn );
-	executeTestOnLargeClob( conn );
-	
-    }
-    
-    
-    private static void executeTestOnSmallBlob( Connection conn ) 
-	throws SQLException, IOException {
-	
-	BlobTester tester = new BlobTester( "SMALL_BLOB_TABLE", 
-					    "SMALL_BLOB" );
-	tester.testGetStreamTwice( conn );
-	
-    }
-
-
-    private static void executeTestOnLargeBlob( Connection conn ) 
-	throws SQLException, IOException {
-	
-	BlobTester tester = new BlobTester( "LARGE_BLOB_TABLE", 
-					    "LARGE_BLOB" );
-	tester.testGetStreamTwice( conn );
-	
-    }
-    
-    
-    private static void executeTestOnSmallClob( Connection conn ) 
-	throws SQLException, IOException {
-	
-	ClobTester tester = new ClobTester( "SMALL_CLOB_TABLE",
-					    "SMALL_CLOB" );
-	tester.testGetReaderTwice( conn );
-
-    }
-
-
-    private static void executeTestOnLargeClob( Connection conn ) 
-	throws SQLException, IOException {
-	
-	ClobTester tester = new ClobTester( "LARGE_CLOB_TABLE",
-					    "LARGE_CLOB" );
-	tester.testGetReaderTwice( conn );
-
-    }
-    
-
-    private static void dropTestTables( Connection conn ) throws SQLException {
-	
-	Statement st = null;
-	
-	try{
-	    st = conn.createStatement();
-	    st.execute("drop table SMALL_BLOB_TABLE");
-	    st.execute("drop table LARGE_BLOB_TABLE");
-
-	}finally{
-	    if(st != null)
-		st.close();
-	}
-	
-    }
-    
-    
-    static class TestDataStream extends InputStream {
-	
-	private long streamedLength = 0;
-	private final long total;
-	
-	
-	public TestDataStream(long length){
-	    total = length;
-	}
-	
-	
-	public int read(){
-	    
-	    if(streamedLength >= total){
-		return -1;
-	    }
-
-	    return (int) ((streamedLength ++) % 256L);
-	    
-	}
-	
-	
-	public void close(){
-	    streamedLength = total;
-	}
-	
-    }
-    
-
-    static class TestDataReader extends Reader {
-	
-	private long wroteLength = 0;
-	private final long total;
-
-	
-	public TestDataReader(long length){
-	    total = length;
-	}
-
-	
-	public void close(){
-	    wroteLength = total;
-	}
-
-	
-	public int read( char[] cbuf,
-			 int off,
-			 int len ){
-	    
-	    if(wroteLength >= total)
-		return -1;
-	    
-	    int i;
-	    for(i = off ;
-		i < off + len &&
-		    wroteLength <= total ;
-		i++, wroteLength ++){
-		
-		cbuf[i] = (char) (wroteLength % 0x10000L);
-		
-	    }
-
-	    return i - off;
-	}
-	
-    }
-    
-    
-    static class BlobTester {
-	
-	final String tableName;
-	final String colName;
-	
-	
-	BlobTester(String tableName,
-		   String colName){
-	    
-	    this.tableName  = tableName;
-	    this.colName = colName;
-	    
-	}
-	
-	
-	public void testGetStreamTwice(Connection conn) 
-	    throws SQLException, IOException {
-	    
-	    Statement st = null;
-	    ResultSet rs = null;
-	    InputStream is = null;
-
-	    try{
-		st = conn.createStatement();
-		
-		rs = st.executeQuery("select " + 
-				     colName + " "+ 
-				     "from " + 
-				     tableName);
-		rs.next();
-		
-		System.out.println("get stream from " + tableName + "." + colName + " ...");
-		is = rs.getBinaryStream(1);
-		is.close();
-		
-		System.out.println("get stream from " + tableName + "." + colName + " again ...");
-		is = rs.getBinaryStream(1);
-		
-		System.out.println("Expected exception did not happen.");
-		
-	    }catch(SQLException e){
-		System.out.println("Expected exception may happen.");
-		e.printStackTrace(System.out);
-		
-	    }finally{
-		if( st != null )
-		    st.close();
-		
-		if( rs != null )
-		    rs.close();
-		
-		if( is != null )
-		    is.close();
-		
-	    }
-	}
-    }
-
-
-    static class ClobTester {
-	
-	final String tableName;
-	final String colName;
-
-	public ClobTester( String tableName ,
-			   String colName ){
-	    
-	    this.tableName = tableName;
-	    this.colName = colName;
-	    
-	}
-	
-	
-	public void testGetReaderTwice( Connection conn ) 
-	    throws SQLException, IOException {
-	    
-	    Statement st = null;
-	    ResultSet rs = null;
-	    Reader reader = null;
-
-	    try{
-		st = conn.createStatement();
-		
-		rs = st.executeQuery( "select " + 
-				      colName + " " + 
-				      "from " + 
-				      tableName );
-		rs.next();
-		
-		System.out.println("get reader from " + tableName + "." + colName + " ...");
-		reader = rs.getCharacterStream(1);
-		reader.close();
-		
-		System.out.println("get reader from " + tableName + "." + colName + "again ...");
-		reader = rs.getCharacterStream(1);
-		
-		System.out.println("Expected exception did not happen.");
-		
-	    }catch(SQLException e){
-		System.out.println("Expected exception may happen.");
-		e.printStackTrace(System.out);
-
-	    }finally{
-		if(st != null)
-		    st.close();
-		
-		if(rs != null)
-		    rs.close();
-
-		if(reader != null)
-		    reader.close();
-
-	    }
-	}
-    }
-}
+/*
+
+Derby - Class org.apache.derbyTesting.functionTests.tests.jdbcapi.Stream
+
+Copyright 1999, 2005 The Apache Software Foundation or its licensors, as applicable.
+
+Licensed under the Apache License, Version 2.0 (the "License");
+you may not use this file except in compliance with the License.
+You may obtain a copy of the License at
+
+http://www.apache.org/licenses/LICENSE-2.0
+
+Unless required by applicable law or agreed to in writing, software
+distributed under the License is distributed on an "AS IS" BASIS,
+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+See the License for the specific language governing permissions and
+limitations under the License.
+
+*/
+
+package org.apache.derbyTesting.functionTests.tests.jdbcapi;
+
+import java.io.InputStream;
+import java.io.Reader;
+import java.sql.Connection;
+import java.sql.Statement;
+import java.sql.PreparedStatement;
+import java.sql.ResultSet;
+
+import java.io.IOException;
+import java.sql.SQLException;
+
+import org.apache.derby.tools.ij;
+
+
+public class Stream {
+    
+    public static void main(String[] args){
+	
+	Connection conn = null;
+
+	try{
+	    ij.getPropertyArg(args);
+	    conn = ij.startJBMS();
+	    
+	    createTestTables(conn);
+	    executeTests(conn);
+	    dropTestTables(conn);
+	    
+	}catch(Throwable t){
+	    t.printStackTrace();
+	    
+	}finally{
+	    if(conn != null){
+		try{
+		    conn.close();
+		    
+		}catch(SQLException e){
+		    e.printStackTrace();
+		}
+		
+	    }
+	}
+	
+    }
+
+    
+    private static void createTestTables(Connection conn) 
+	throws SQLException,IOException {
+	
+	createTable(conn);
+	createTestData(conn);
+	
+    }
+    
+    
+    private static void createTable(Connection conn) throws SQLException {
+	
+	Statement st = null;
+	
+	try{
+	    
+	    st = conn.createStatement();
+	    st.execute("create table SMALL_BLOB_TABLE( SMALL_BLOB blob( 512 ))");
+	    st.execute("create table LARGE_BLOB_TABLE( LARGE_BLOB blob( 512k ))");
+	    st.execute("create table SMALL_CLOB_TABLE( SMALL_CLOB clob( 512 ))");
+	    st.execute("create table LARGE_CLOB_TABLE( LARGE_CLOB clob( 512k ))");
+
+	}finally{
+	    if(st != null)
+		st.close();
+	}
+	
+    }
+
+    
+    private static void createTestData(Connection conn) 
+	throws SQLException,IOException {
+
+	createSmallBlobTestData( conn );
+	createLargeBlobTestData( conn );
+	createSmallClobTestData( conn );
+	createLargeClobTestData( conn );
+	
+    }
+    
+    
+    private static void createSmallBlobTestData(Connection conn) 
+	throws SQLException,IOException {
+	
+	PreparedStatement st = null;
+	TestDataStream stream = null;
+
+	try{
+	    st = conn.prepareStatement("insert into SMALL_BLOB_TABLE(SMALL_BLOB) values(?)");
+	    stream = new TestDataStream(512);
+	    st.setBinaryStream(1, stream, 512);
+	    st.executeUpdate();
+	    
+	}finally{
+	    if(st != null){
+		st.close();
+	    }
+
+	    if(stream != null){
+		stream.close();
+	    }
+	    
+	}
+
+    }
+    
+    
+    private static void createLargeBlobTestData(Connection conn) 
+	throws SQLException,IOException {
+	
+	PreparedStatement st = null;
+	TestDataStream stream = null;
+	
+	try{
+	    st = conn.prepareStatement("insert into LARGE_BLOB_TABLE(LARGE_BLOB) values(?)");
+	    stream = new TestDataStream( 512 * 1024);
+	    st.setBinaryStream(1,stream, 512 * 1024);
+
+	    st.executeUpdate();
+	    
+	}finally{
+	    if(st != null){
+		st.close();
+	    }
+
+	    if(stream != null){
+		stream.close();
+	    }
+	}
+    }
+    
+    
+    private static void createSmallClobTestData(Connection conn)
+	throws SQLException,IOException {
+	
+	PreparedStatement st = null;
+	TestDataReader reader = null;
+	
+	try{
+	    st = conn.prepareStatement("insert into SMALL_CLOB_TABLE( SMALL_CLOB ) values(?)");
+
+	    reader = new TestDataReader( 512 );
+	    st.setCharacterStream(1,
+				  reader, 
+				  512);
+	    
+	    st.executeUpdate();
+	    
+	    
+	}finally{
+	    if(st != null)
+		st.close();
+	    
+	    if(reader != null)
+		reader.close();
+	    
+	}
+	
+    }   
+    
+
+    private static void createLargeClobTestData(Connection conn)
+	throws SQLException, IOException {
+	
+	PreparedStatement st = null;
+	TestDataReader reader = null;
+
+	try{
+	    st = conn.prepareStatement("insert into LARGE_CLOB_TABLE( LARGE_CLOB ) values(?)");
+	    
+	    reader = new TestDataReader( 512 * 1024 );
+	    st.setCharacterStream(1,
+				  reader,
+				  512 * 1024 );
+	    
+	    st.executeUpdate();
+	    
+	    
+	} finally {
+	    if(st != null)
+		st.close();
+	    
+	    if(reader != null)
+		reader.close();
+	}
+    }
+
+    private static void executeTests(Connection conn) 
+	throws SQLException, IOException {
+	
+	executeTestOnSmallBlob( conn );
+	executeTestOnLargeBlob( conn );
+	executeTestOnSmallClob( conn );
+	executeTestOnLargeClob( conn );
+	
+    }
+    
+    
+    private static void executeTestOnSmallBlob( Connection conn ) 
+	throws SQLException, IOException {
+	
+	BlobTester tester = new BlobTester( "SMALL_BLOB_TABLE", 
+					    "SMALL_BLOB" );
+	tester.testGetStreamTwice( conn );
+	
+    }
+
+
+    private static void executeTestOnLargeBlob( Connection conn ) 
+	throws SQLException, IOException {
+	
+	BlobTester tester = new BlobTester( "LARGE_BLOB_TABLE", 
+					    "LARGE_BLOB" );
+	tester.testGetStreamTwice( conn );
+	
+    }
+    
+    
+    private static void executeTestOnSmallClob( Connection conn ) 
+	throws SQLException, IOException {
+	
+	ClobTester tester = new ClobTester( "SMALL_CLOB_TABLE",
+					    "SMALL_CLOB" );
+	tester.testGetReaderTwice( conn );
+
+    }
+
+
+    private static void executeTestOnLargeClob( Connection conn ) 
+	throws SQLException, IOException {
+	
+	ClobTester tester = new ClobTester( "LARGE_CLOB_TABLE",
+					    "LARGE_CLOB" );
+	tester.testGetReaderTwice( conn );
+
+    }
+    
+
+    private static void dropTestTables( Connection conn ) throws SQLException {
+	
+	Statement st = null;
+	
+	try{
+	    st = conn.createStatement();
+	    st.execute("drop table SMALL_BLOB_TABLE");
+	    st.execute("drop table LARGE_BLOB_TABLE");
+	    st.execute("drop table SMALL_CLOB_TABLE");
+	    st.execute("drop table LARGE_CLOB_TABLE");
+
+	}finally{
+	    if(st != null)
+		st.close();
+	}
+	
+    }
+    
+    
+    static class TestDataStream extends InputStream {
+	
+	private long streamedLength = 0;
+	private final long total;
+	
+	
+	public TestDataStream(long length){
+	    total = length;
+	}
+	
+	
+	public int read(){
+	    
+	    if(streamedLength >= total){
+		return -1;
+	    }
+
+	    return (int) ((streamedLength ++) % 256L);
+	    
+	}
+	
+	
+	public void close(){
+	    streamedLength = total;
+	}
+	
+    }
+    
+
+    static class TestDataReader extends Reader {
+	
+	private long wroteLength = 0;
+	private final long total;
+
+	
+	public TestDataReader(long length){
+	    total = length;
+	}
+
+	
+	public void close(){
+	    wroteLength = total;
+	}
+
+	
+	public int read( char[] cbuf,
+			 int off,
+			 int len ){
+	    
+	    if(wroteLength >= total)
+		return -1;
+	    
+	    int i;
+	    for(i = off ;
+		i < off + len &&
+		    wroteLength <= total ;
+		i++, wroteLength ++){
+		
+		cbuf[i] = (char) (wroteLength % 0x10000L);
+		
+	    }
+
+	    return i - off;
+	}
+	
+    }
+    
+    
+    static class BlobTester {
+	
+	final String tableName;
+	final String colName;
+	
+	
+	BlobTester(String tableName,
+		   String colName){
+	    
+	    this.tableName  = tableName;
+	    this.colName = colName;
+	    
+	}
+	
+	
+	public void testGetStreamTwice(Connection conn) 
+	    throws SQLException, IOException {
+	    
+	    Statement st = null;
+	    ResultSet rs = null;
+	    InputStream is = null;
+
+	    try{
+		st = conn.createStatement();
+		
+		rs = st.executeQuery("select " + 
+				     colName + " "+ 
+				     "from " + 
+				     tableName);
+		rs.next();
+		
+		System.out.println("get stream from " + tableName + "." + colName + " ...");
+		is = rs.getBinaryStream(1);
+		is.close();
+		
+		System.out.println("get stream from " + tableName + "." + colName + " again ...");
+		is = rs.getBinaryStream(1);
+		
+		System.out.println("Expected exception did not happen.");
+		
+	    }catch(SQLException e){
+		System.out.println("Expected exception may happen.");
+		e.printStackTrace(System.out);
+		
+	    }finally{
+		if( st != null )
+		    st.close();
+		
+		if( rs != null )
+		    rs.close();
+		
+		if( is != null )
+		    is.close();
+		
+	    }
+	}
+    }
+
+
+    static class ClobTester {
+	
+	final String tableName;
+	final String colName;
+
+	public ClobTester( String tableName ,
+			   String colName ){
+	    
+	    this.tableName = tableName;
+	    this.colName = colName;
+	    
+	}
+	
+	
+	public void testGetReaderTwice( Connection conn ) 
+	    throws SQLException, IOException {
+	    
+	    Statement st = null;
+	    ResultSet rs = null;
+	    Reader reader = null;
+
+	    try{
+		st = conn.createStatement();
+		
+		rs = st.executeQuery( "select " + 
+				      colName + " " + 
+				      "from " + 
+				      tableName );
+		rs.next();
+		
+		System.out.println("get reader from " + tableName + "." + colName + " ...");
+		reader = rs.getCharacterStream(1);
+		reader.close();
+		
+		System.out.println("get reader from " + tableName + "." + colName + "again ...");
+		reader = rs.getCharacterStream(1);
+		
+		System.out.println("Expected exception did not happen.");
+		
+	    }catch(SQLException e){
+		System.out.println("Expected exception may happen.");
+		e.printStackTrace(System.out);
+
+	    }finally{
+		if(st != null)
+		    st.close();
+		
+		if(rs != null)
+		    rs.close();
+
+		if(reader != null)
+		    reader.close();
+
+	    }
+	}
+    }
+}
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/autoGeneratedJdbc30.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/autoGeneratedJdbc30.java
index 5782fa04b..c33e24ae8 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/autoGeneratedJdbc30.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/autoGeneratedJdbc30.java
@@ -32,6 +32,8 @@ import java.sql.SQLException;
 import org.apache.derby.tools.ij;
 import org.apache.derby.tools.JDBCDisplayUtil;
 
+import org.apache.derbyTesting.functionTests.util.TestUtil;
+
 /**
  * Test the new Auto Generated Keys feature in jdbc 30 for Statement and PreparedStatement.
  *
@@ -39,6 +41,9 @@ import org.apache.derby.tools.JDBCDisplayUtil;
  */
 
 public class autoGeneratedJdbc30 { 
+
+	private static String[] testObjects= {"table t11","table t21","table t31"};
+
 	public static void main(String[] args) {
 
 		Connection con = null;
@@ -63,6 +68,9 @@ public class autoGeneratedJdbc30 {
 
 			negativeTests(con);
 
+			s = con.createStatement();
+			TestUtil.cleanUpTest(s, testObjects);
+			con.commit();
 			con.close();
 		}
 		catch (SQLException e) {
@@ -112,6 +120,15 @@ public class autoGeneratedJdbc30 {
 	//Set up the test by creating the table used by the rest of the test.
 	public static void setUpTest(Statement s)
 					throws SQLException {
+		try {
+			// first drop to make sure there's nothing there
+			s.execute("drop table t11");
+			s.execute("drop table t21");
+			s.execute("drop table t31");
+		} catch (SQLException se) {
+			// assume failure because there really wasn't anything there 
+		}
+
 		/* Create a table */
 		// set by increment not yet supported for create table...
 		// does not matter for purpose of this test.
@@ -883,6 +900,7 @@ public class autoGeneratedJdbc30 {
 				else
 					JDBCDisplayUtil.ShowSQLException(System.out,e);
 			}
+		con.rollback();
 	}
 
 	public static void doTest1920(Statement s, Connection con) throws SQLException
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/bestrowidentifier.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/bestrowidentifier.sql
index 477024460..5481edf4a 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/bestrowidentifier.sql
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/bestrowidentifier.sql
@@ -125,3 +125,5 @@ execute bestrow using 'values(''APP'',''T16'',3,''true'')';
 
 rollback work;
 
+drop procedure getBestRowID;
+commit;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/blobclob4BLOB.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/blobclob4BLOB.java
index bcd784c44..4f4f89108 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/blobclob4BLOB.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/blobclob4BLOB.java
@@ -57,6 +57,10 @@ import org.apache.derbyTesting.functionTests.util.TestUtil;
 public class blobclob4BLOB { 
 
 	static String[] fileName;
+	static String[] basefileName; // for printing messages so that no path info is in .out
+	static String filePath;
+	static String unicodeFilePath;
+	static String sep;
 	static long[] fileLength;
     static int numFiles;
     static int numRows;
@@ -72,14 +76,21 @@ public class blobclob4BLOB {
 	static
 	{
 		numFiles = 5;
+		filePath = "extin";
 		fileName = new String[numFiles];
+		basefileName = new String[numFiles];
 		fileLength = new long[numFiles];
 
-		fileName[0] = "extin/short.txt";	// set up a short (fit in one page) blob/clob
-		fileName[1] = "extin/littleclob.txt"; // set up a long (longer than a page) blob/clob
-		fileName[2] = "extin/empty.txt"; // set up a blob/clob with nothing in it
-		fileName[3] = "extin/searchclob.txt"; // set up a blob/clob to search with
-		fileName[4] = "extin/aclob.txt"; // set up a really long (over 300K) blob/clob
+		fileName[0] = "short.txt";	// set up a short (fit in one page) blob/clob
+		fileName[1] = "littleclob.txt"; // set up a long (longer than a page) blob/clob
+		fileName[2] = "empty.txt"; // set up a blob/clob with nothing in it
+		fileName[3] = "searchclob.txt"; // set up a blob/clob to search with
+		fileName[4] = "aclob.txt"; // set up a really long (over 300K) blob/clob
+
+		for (int i = 0 ; i < numFiles; i++)
+		{
+			basefileName[i] = fileName[i];
+		}
 
         numRows = 10;
 
@@ -90,7 +101,8 @@ public class blobclob4BLOB {
         unicodeStrings[2] = "\u05d0\u05d1\u05d2";
         numRowsUnicode = 6;
 
-        unicodeFileName = "extinout/unicodeFile.txt";
+        unicodeFilePath = "extinout";
+        unicodeFileName = "unicodeFile.txt";
     }
 
 
@@ -102,6 +114,21 @@ public class blobclob4BLOB {
 
 		try
         {
+            // first check to see if the path to extin/out dir is ok.
+            sep = System.getProperty("file.separator");
+            boolean exists = (new File(filePath, fileName[0])).exists();
+            if (!exists)
+            {
+                String userDir = System.getProperty("user.dir");
+                filePath = userDir + sep + ".." + sep + filePath;
+                unicodeFilePath = userDir + sep + ".." + sep + unicodeFilePath;
+            }
+            for (int i=0; i < numFiles; i++) 
+            {
+                fileName[i] = filePath + sep + fileName[i];
+            }
+            unicodeFileName = unicodeFilePath + sep + unicodeFileName;
+
 			// use the ij utility to read the property file and
 			// make the initial connection.
 			ij.getPropertyArg(args);
@@ -180,9 +207,23 @@ public class blobclob4BLOB {
             conn.commit();
             clobNegativeTest_Derby265(conn);
             blobNegativeTest_Derby265(conn);
+
+            // restart the connection for cleaning up
+            conn = ij.startJBMS();
+            String[] testObjects = {"table testclob_main", "table searchclob", 
+                                  "table testunicode", "table testunicode2", 
+                                  "table testclob10", "table testinteger", 
+                                  "table testclobcolumn", "table testclob2", 
+                                  "table testclob7", "table testlongrowclob", 
+                                  "table testblob", "table searchblob", 
+                                  "table testvarbinary", "table testinteger2", 
+                                  "table testblobcolumn", "table testblob2", 
+                                  "table testblobx", "table testlongrowblob", 
+                                  "table maps", "table maps_blob"};
+            Statement stmt = conn.createStatement();
+            TestUtil.cleanUpTest(stmt, testObjects);
             conn.close();
             System.out.println("FINISHED TEST blobclob :-)");
-
 		}
         catch (SQLException e)
         {
@@ -263,12 +304,12 @@ public class blobclob4BLOB {
                 fileLength[i] = file.length();
 				/*
 				System.out.println("inserting filename[" +i +
-								   "]" + fileName[i] +
+								   "]" + basefileName[i] +
 								   " length: " + fileLength[i]);
 				*/
                 InputStream fileIn = new FileInputStream(file);
 
-                System.out.println("===> inserting " + fileName[i] + " length = "
+                System.out.println("===> inserting " + basefileName[i] + " length = "
 				    				   + fileLength[i]);
 
                 // insert a streaming column
@@ -348,10 +389,10 @@ public class blobclob4BLOB {
 
 				/*
 				System.out.println("inserting filename[" +i +
-								   "]" + fileName[i] +
+								   "]" + basefileName[i] +
 								   " length: " + fileLength[i]);
 				*/
-                System.out.println("===> inserting " + fileName[i] + " length = "
+                System.out.println("===> inserting " + basefileName[i] + " length = "
 				    				   + fileLength[i]);
 
                 // insert a streaming column
@@ -2682,7 +2723,7 @@ public class blobclob4BLOB {
                 fileLength[i] = file.length();
                 InputStream fileIn = new FileInputStream(file);
 
-                System.out.println("===> inserting " + fileName[i] + " length = "
+                System.out.println("===> inserting " + basefileName[i] + " length = "
 				    				   + fileLength[i]);
 
                 // insert a streaming column
@@ -2797,7 +2838,7 @@ public class blobclob4BLOB {
                 fileLength[i] = file.length();
                 InputStream fileIn = new FileInputStream(file);
 
-                System.out.println("===> inserting " + fileName[i] + " length = "
+                System.out.println("===> inserting " + basefileName[i] + " length = "
 				    				   + fileLength[i]);
 
                 // insert a streaming column
@@ -4202,11 +4243,3 @@ public class blobclob4BLOB {
 }
 
 
-
-
-
-
-
-
-
-
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/checkDriver.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/checkDriver.java
index 06d83e8d1..a22c0b3a8 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/checkDriver.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/checkDriver.java
@@ -42,45 +42,20 @@ import org.apache.derby.tools.JDBCDisplayUtil;
 
 public class checkDriver {
 
+	private static String hostName;
 	private static String EMBEDDED_URL = "jdbc:derby:wombat;create=true";
-	private static String CLIENT_URL = "jdbc:derby://localhost:1527/wombat;create=true";
-	private static String JCC_URL = "jdbc:derby:net://localhost:1527/wombat;create=true";
+	private static String CLIENT_URL;
+	private static String JCC_URL;
 	private static String INVALID_URL = "jdbc:db2j:wombat;create=true";
 	
 	private static String DERBY_SYSTEM_HOME = System.getProperty("derby.system.home");
 	
-	private static String CLIENT_URL_WITH_COLON1 = 
-		"jdbc:derby://localhost:1527/wombat:create=true";
-	private static String CLIENT_URL_WITH_COLON2 = 
-		"jdbc:derby://localhost:1527/"+ DERBY_SYSTEM_HOME + File.separator +"wombat:create=true";
-	private static String CLIENT_URL_WITH_DOUBLE_QUOTES1 = 
-		"jdbc:derby://localhost:1527/\"wombat\";create=true"; 
-	private static String CLIENT_URL_WITH_DOUBLE_QUOTES2 = 
-		"jdbc:derby://localhost:1527/\"" + DERBY_SYSTEM_HOME + File.separator + "wombat\";create=true";
-	private static String CLIENT_URL_WITH_SINGLE_QUOTES1 = 
-		"jdbc:derby://localhost:1527/'" + DERBY_SYSTEM_HOME + File.separator + "wombat';create=true";
-	private static String CLIENT_URL_WITH_SINGLE_QUOTES2 = 
-		"jdbc:derby://localhost:1527/'wombat';create=true";
-	
-	// URLS to check.  New urls need to also be added to the acceptsUrl table
-	private static String[] urls = new String[]
-	{
-	  	EMBEDDED_URL,
-		CLIENT_URL,
-		JCC_URL,
-		INVALID_URL,
-	};
-	
-	//Client URLS
-	private static String[] clientUrls = new String[]
-	{
-		CLIENT_URL_WITH_COLON1,
-		//CLIENT_URL_WITH_COLON2,
-		//CLIENT_URL_WITH_DOUBLE_QUOTES1,
-		//CLIENT_URL_WITH_DOUBLE_QUOTES2,
-		//CLIENT_URL_WITH_SINGLE_QUOTES1,
-		CLIENT_URL_WITH_SINGLE_QUOTES2
-	};
+	private static String CLIENT_URL_WITH_COLON1; 
+	private static String CLIENT_URL_WITH_COLON2;
+	private static String CLIENT_URL_WITH_DOUBLE_QUOTES1;  
+	private static String CLIENT_URL_WITH_DOUBLE_QUOTES2; 
+	private static String CLIENT_URL_WITH_SINGLE_QUOTES1; 
+	private static String CLIENT_URL_WITH_SINGLE_QUOTES2;
 	
 	/**
 	 * url prefix for this framework
@@ -91,7 +66,6 @@ public class checkDriver {
 	// to check for valid results for each framework
 	private static int  frameworkOffset;
 	
-	
 	private static int EMBEDDED_OFFSET = 0;
 	private static int DERBYNETCLIENT_OFFSET = 1;
 	private static int DERBYNET_OFFSET = 2;   // JCC
@@ -104,7 +78,38 @@ public class checkDriver {
 			frameworkOffset = DERBYNETCLIENT_OFFSET;
 		else if (TestUtil.isJCCFramework())
 			frameworkOffset = DERBYNET_OFFSET; // JCC
+		
+		hostName = TestUtil.getHostName();
+		CLIENT_URL = "jdbc:derby://" + hostName + ":1527/wombat;create=true";
+		JCC_URL = "jdbc:derby:net://" + hostName + ":1527/wombat;create=true";
+		CLIENT_URL_WITH_COLON1 = "jdbc:derby://" + hostName + ":1527/wombat:create=true";
+		CLIENT_URL_WITH_COLON2 = "jdbc:derby://" + hostName + ":1527/"+ DERBY_SYSTEM_HOME + File.separator +"wombat:create=true";
+		CLIENT_URL_WITH_DOUBLE_QUOTES1 = "jdbc:derby://" + hostName + ":1527/\"wombat\";create=true"; 
+		CLIENT_URL_WITH_DOUBLE_QUOTES2 = "jdbc:derby://" + hostName + ":1527/\"" + DERBY_SYSTEM_HOME + File.separator + "wombat\";create=true";
+		CLIENT_URL_WITH_SINGLE_QUOTES1 = "jdbc:derby://" + hostName + ":1527/'" + DERBY_SYSTEM_HOME + File.separator + "wombat';create=true";
+		CLIENT_URL_WITH_SINGLE_QUOTES2 = "jdbc:derby://" + hostName + ":1527/'wombat';create=true";
 	}
+
+	// URLS to check.  New urls need to also be added to the acceptsUrl table
+	private static String[] urls = new String[]
+	{
+	  	EMBEDDED_URL,
+		CLIENT_URL,
+		JCC_URL,
+		INVALID_URL,
+	};
+		
+	//Client URLS
+	private static String[] clientUrls = new String[]
+	{
+		CLIENT_URL_WITH_COLON1,
+		//CLIENT_URL_WITH_COLON2,
+		//CLIENT_URL_WITH_DOUBLE_QUOTES1,
+		//CLIENT_URL_WITH_DOUBLE_QUOTES2,
+		//CLIENT_URL_WITH_SINGLE_QUOTES1,
+		CLIENT_URL_WITH_SINGLE_QUOTES2
+	};
+	
 	
 	// Table that shows whether tested urls should return true for acceptsURL
 	// under the given framework
@@ -120,6 +125,7 @@ public class checkDriver {
 			
 
 	public static void main(String[] args) {
+		
 		try {
 			Driver driver = loadAndCheckDriverForFramework();			
 			checkAcceptsURL(driver);
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/connectionJdbc20.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/connectionJdbc20.java
index e260a37c6..2150c802c 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/connectionJdbc20.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/connectionJdbc20.java
@@ -44,6 +44,8 @@ public class connectionJdbc20{
    
 	static private boolean isDerbyNet = false;
 
+	static private String[] testObjects = {"TABLE TAB1"};
+
 	public static void main(String[] args) {
 		Connection conn, connreturn;
 		Statement stmt, stmtreturn;
@@ -58,6 +60,8 @@ public class connectionJdbc20{
 			 conn = ij.startJBMS();
 			 isDerbyNet = TestUtil.isNetFramework();
 			 stmt = conn.createStatement();
+			// cleanup table, just in case
+			TestUtil.cleanUpTest(stmt, testObjects);
             //create a table, insert a row, do a select from the table,
 			 stmt.execute("create table tab1("+
                                            "c1 char(100) for bit data,"+
@@ -162,6 +166,7 @@ public class connectionJdbc20{
 
             cs.close();
 			conn.close();
+			TestUtil.cleanUpTest(stmt, testObjects);
 
 		}
 		catch (SQLException e) {
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/dataSourcePermissions.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/dataSourcePermissions.java
index 3f2b7f12c..0f2d9a402 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/dataSourcePermissions.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/dataSourcePermissions.java
@@ -24,6 +24,8 @@ import org.apache.derby.jdbc.EmbeddedDataSource;
 import org.apache.derby.jdbc.EmbeddedConnectionPoolDataSource;
 import org.apache.derby.jdbc.EmbeddedXADataSource;
 
+import java.util.Properties;
+
 import java.sql.Connection;
 import java.sql.ResultSet;
 import java.sql.PreparedStatement;
@@ -44,6 +46,7 @@ import javax.sql.ConnectionEventListener;
 import javax.sql.ConnectionEvent;
 import org.apache.derby.tools.JDBCDisplayUtil;
 import org.apache.derby.tools.ij;
+import org.apache.derbyTesting.functionTests.util.TestUtil;
 
 import java.io.*;
 import java.util.Hashtable;
@@ -62,6 +65,7 @@ public class dataSourcePermissions
 
 		ij.getPropertyArg(args);
 		new dataSourcePermissions().runTest();
+		new dataSourcePermissions().cleanUp();
 		System.out.println("Completed dataSourcePermissions");
 
 	}
@@ -281,6 +285,7 @@ public class dataSourcePermissions
 
 		shutdown();
 		}
+
 	}
 
 	private static void checkConnection(Connection conn) throws SQLException {
@@ -372,4 +377,47 @@ public class dataSourcePermissions
 			System.out.println("EXPECTED SHUTDOWN " + sqle.getMessage());
 		}
 	}
+
+	protected void cleanUp() throws Exception {
+		// clear up in case this test gets run with useprocess=false
+		try {
+			TestUtil.loadDriver();
+			Connection conn = DriverManager.getConnection(getJDBCUrl("wombat", "user=EDWARD;password=noodle"));
+			CallableStatement cs = conn.prepareCall("CALL SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(?, ?)");
+			start();
+
+			cs.setString(1, "derby.connection.requireAuthentication");
+			cs.setString(2, "false");
+			cs.execute();
+			cs.close();
+
+			shutdown();
+			start();
+
+			conn = DriverManager.getConnection(getJDBCUrl("wombat", "user=EDWARD;password=noodle"));
+			cs = conn.prepareCall("CALL SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(?, ?)");
+
+			cs.setString(1, "derby.user.EDWARD");
+			cs.setNull(2, java.sql.Types.VARCHAR);
+			cs.execute();
+
+			cs.setString(1, "derby.user.FRANCES");
+			cs.setNull(2, java.sql.Types.VARCHAR);
+			cs.execute();
+
+			cs.setString(1, "derby.user." + zeus);
+			cs.setNull(2, java.sql.Types.VARCHAR);
+			cs.execute();
+
+			cs.close();
+
+			conn.close();
+			shutdown();
+		
+		} catch (SQLException sqle) {
+			System.out.println("UNEXPECTED CONNFAIL " + sqle.getMessage());
+			System.out.println("could not clean up");
+		}
+	}
+
 }
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/lobStreams.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/lobStreams.java
index f9b61a9e8..1e31c8c6a 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/lobStreams.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/lobStreams.java
@@ -40,6 +40,7 @@ import org.apache.derbyTesting.functionTests.util.TestUtil;
 public class lobStreams {
     
         static String[] fileName = new String[2];
+        static String sep;
         static long fileLength;
 
         static boolean debug = true;
@@ -47,14 +48,34 @@ public class lobStreams {
 
         static
         {
-            fileName[0] = "extin/aclob.txt";
-            fileName[1] = "extin/littleclob.txt";
+//            fileName[0] = "extin" + sep + "aclob.txt";
+ //           fileName[1] = "extin" + sep + "littleclob.txt";
+            fileName[0] =  "aclob.txt";
+            fileName[1] =  "littleclob.txt";
         }
         
         public static void main(String[] args)
         {
             System.out.println("Test lob stream with multiple writes starting");
 
+            // check to see if we have the correct extin path, if the files aren't right here, try one more time
+	    boolean exists = (new File("extin", fileName[0])).exists();
+            String sep =  System.getProperty("file.separator");
+	    if (!exists) 
+            {
+                // assume it's in a dir up, if that's wrong too, too bad...
+                String userdir =  System.getProperty("user.dir");
+                fileName[0] = userdir + sep + ".." + sep + "extin" + sep + fileName[0];
+                fileName[1] = userdir + sep + ".." + sep + "extin" + sep + fileName[1];
+            }
+            else
+            {
+                // assume it's in a dir up, if that's wrong too, too bad...
+                fileName[0] = "extin" + sep + fileName[0];
+                fileName[1] = "extin" + sep + fileName[1];
+            }
+
+
             try
             {
                 // use the ij utility to read the property file and
@@ -76,6 +97,8 @@ public class lobStreams {
 
                 // restart the connection
                 conn.commit();
+                cleanUp(conn);
+                conn.commit();
                 conn.close();
                 System.out.println("FINISHED TEST blobSetBinaryStream :-)");
 
@@ -443,4 +466,11 @@ public class lobStreams {
             } 
             return true;
         }
+
+        private static void cleanUp(Connection conn) throws SQLException {
+            String[] testObjects = {"table testBlobX1"};
+            Statement cleanupStmt = conn.createStatement();
+            TestUtil.cleanUpTest(cleanupStmt, testObjects);
+        }
+
 }
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/maxfieldsize.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/maxfieldsize.java
index 9262de37b..165b1a897 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/maxfieldsize.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/maxfieldsize.java
@@ -61,6 +61,10 @@ public class maxfieldsize {
 		Connection conn;
 		Statement stmt;
 
+		// start by cleaning up, just in case
+		String[] testObjects = {"table tab1", "table tab2"};
+		
+
 		System.out.println("Test MaxFieldSize  starting");
 
 		isDerbyNet = TestUtil.isNetFramework();
@@ -71,6 +75,7 @@ public class maxfieldsize {
 			 ij.getPropertyArg(args);
 			 conn = ij.startJBMS();
 			 stmt = conn.createStatement();
+			 TestUtil.cleanUpTest(stmt, testObjects);
             //create a table, insert a row, do a select from the table,
 			 stmt.execute("create table tab1("+
                                            "c1 char(100) for bit data,"+
@@ -163,6 +168,8 @@ public class maxfieldsize {
 
 			testSort(conn, stmt);
 
+			TestUtil.cleanUpTest(stmt, testObjects);
+
 			stmt.close();
 			conn.close();
 
@@ -313,4 +320,10 @@ public class maxfieldsize {
         }
     }
 
+	static private void cleanUp(Connection conn) throws SQLException
+	{
+		
+	}
+
+
 }
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/metadata_test.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/metadata_test.java
index fe8425f0c..c639895c1 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/metadata_test.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/metadata_test.java
@@ -39,6 +39,7 @@ import java.util.Properties;
 import java.util.StringTokenizer;
 
 import org.apache.derby.tools.ij;
+import org.apache.derbyTesting.functionTests.util.TestUtil;
 
 /**
  * Test of database meta-data.  This program simply calls each of the meta-data
@@ -1062,24 +1063,14 @@ public abstract class metadata_test {
 				" parameter style java"); 
             	s.execute("call isReadO()");
             }
-			s.execute("drop procedure isReadO");
-			s.execute("drop procedure GETPCTEST4Bx");
-			s.execute("drop procedure GETPCTEST4B");
-			s.execute("drop procedure GETPCTEST4A");
-			s.execute("drop procedure GETPCTEST3B");
-			s.execute("drop procedure GETPCTEST3A");
-			s.execute("drop procedure GETPCTEST2");
-			s.execute("drop procedure GETPCTEST1");
-			s.execute("drop table t");
-			s.execute("drop table reftab");
-			s.execute("drop table reftab2");
-			s.execute("drop view SCREWIE");
-			s.execute("drop table louie");
-			s.execute("drop table alltypes");
+			cleanUp(s);
+	
 			s.close();
+
 			if (con.getAutoCommit() == false)
 				con.commit();
 
+			
 			con.close();
 
 		}
@@ -1278,5 +1269,18 @@ public abstract class metadata_test {
 		return con;
 
 	}
+
+	protected void cleanUp(Statement stmt) throws SQLException {
+		con.setAutoCommit(true);
+		String[] testObjects = {"table t", "table t1", "view screwie", 
+			"table reftab", "table reftab2", "table inflight" , "table alltypes", 
+			"table louie",
+			"procedure getpctest1", "procedure getpctest2",
+			"procedure getpctest3a", "procedure getpctest3b",
+			"procedure getpctest4a", "procedure getpctest4b", "procedure getpctest4bx",
+			"procedure isreadO" };
+		TestUtil.cleanUpTest(stmt, testObjects);
+	}
+
 }
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/nullSQLText.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/nullSQLText.java
index 79ed6915a..a6755d71c 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/nullSQLText.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/nullSQLText.java
@@ -199,7 +199,7 @@ public class nullSQLText {
 			st.execute("drop table t1");
 		} catch (SQLException se) {}
 		try {
-			st.execute("drop procedure proc1");
+			st.execute("drop procedure za");
 		} catch (SQLException se) {}
 
 		st.close();
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/parameterMetaDataJdbc30.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/parameterMetaDataJdbc30.java
index cffb2f48e..d33b45b74 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/parameterMetaDataJdbc30.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/parameterMetaDataJdbc30.java
@@ -44,6 +44,8 @@ import org.apache.derbyTesting.functionTests.util.TestUtil;
 
 public class parameterMetaDataJdbc30 {
 	private static boolean isDerbyNet;
+	private static String[] testObjects = { "TABLE  T", "FUNCTION RDB",
+					 "PROCEDURE DUMMYINT", "PROCEDURE DUMMY_NUMERIC_PROC"};
 	public static void main(String[] args) {
 		Connection con = null;
 		Statement  s;
@@ -65,6 +67,7 @@ public class parameterMetaDataJdbc30 {
 			s = con.createStatement();
 
 			/* Create the table and do any other set-up */
+			TestUtil.cleanUpTest(s, testObjects);
 			setUpTest(s);
 
       s.executeUpdate("create function RDB(P1 INT) RETURNS DECIMAL(10,2) language java external name 'org.apache.derbyTesting.functionTests.tests.lang.outparams30.returnsBigDecimal' parameter style java");
@@ -181,6 +184,7 @@ public class parameterMetaDataJdbc30 {
       ps.execute();
 
       cs.close();
+      ps.close();    
 
       System.out.println("test: the scale returned should be the one set by registerOutParameter");
       s.executeUpdate("create procedure dummy_numeric_Proc(out a NUMERIC(30,15), out b NUMERIC(30,15)) language java parameter style java external name 'org.apache.derbyTesting.functionTests.tests.jdbcapi.parameterMetaDataJdbc30.dummy_numeric_Proc'");
@@ -252,6 +256,13 @@ public class parameterMetaDataJdbc30 {
 	  cs.close();
 	  s.execute("DROP PROCEDURE PMDD");
       }
+     s.close();
+     con = ij.startJBMS();
+     con.setAutoCommit(true); // make sure it is true
+     s = con.createStatement();
+	 TestUtil.cleanUpTest(s, testObjects);
+     s.close();
+     con.close();
      }
 	 catch (SQLException e) {
 	 dumpSQLExceptions(e);
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/prepStmtMetaData.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/prepStmtMetaData.java
index f2b2e1cb7..94c01e2f8 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/prepStmtMetaData.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/prepStmtMetaData.java
@@ -140,6 +140,7 @@ public class prepStmtMetaData {
 
 			// clean up
 			executeStmt(con,"drop table ab");
+			executeStmt(con,"drop table bug4579");
 
 			con.close();
 		}
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/prepStmtNull.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/prepStmtNull.java
index 39c03d930..9e0700eab 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/prepStmtNull.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/prepStmtNull.java
@@ -6,6 +6,8 @@ import java.sql.*;
 import org.apache.derby.tools.ij;
 import org.apache.derby.tools.JDBCDisplayUtil;
 
+import org.apache.derbyTesting.functionTests.util.TestUtil;
+
 public class prepStmtNull {
 
     public static void main(String[] args) {
@@ -51,6 +53,9 @@ public class prepStmtNull {
 			   System.out.println("ResultSet is: "+rs.getObject(1));
 			   System.out.println("ResultSet is: "+rs.getObject(2));
 			}
+			String[] testObjects = {"table nullTS"};
+                        TestUtil.cleanUpTest(stmt1, testObjects);
+   			con.commit();
  		} catch(SQLException sqle) {
  		   dumpSQLExceptions(sqle);
  		   sqle.printStackTrace();
@@ -99,6 +104,9 @@ public class prepStmtNull {
 			   System.out.println("ResultSet is: "+rs.getObject(1));
 			   System.out.println("ResultSet is: "+rs.getObject(2));
 			}
+			String[] testObjects = {"table nullBlob"};
+                        TestUtil.cleanUpTest(stmt1, testObjects);
+   			con.commit();
  		} catch(SQLException sqle) {
  		   dumpSQLExceptions(sqle);
  		   sqle.printStackTrace();
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/resultset.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/resultset.java
index 2566589d7..f98258135 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/resultset.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/resultset.java
@@ -166,6 +166,11 @@ public class resultset {
 			stmt = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
 									   ResultSet.CONCUR_UPDATABLE);
 
+            try { 
+                stmt.execute("drop table t"); 
+            } catch (SQLException se) {
+            } // ignore, assume it is because table does not exist
+
 			stmt.execute("create table t (i int, s smallint, r real, "+
 				"d double precision, dt date, t time, ts timestamp, "+
 				"c char(10), v varchar(40) not null, dc dec(10,2),"+
@@ -597,7 +602,8 @@ public class resultset {
 			System.out.println("rollback with auto commit");
 			showLocksForAutoCommitSelect(con, stmt, 2);
 
-
+            stmt.execute("drop table bug4810");
+			con.commit();
 			stmt.close();
 
 			testMutableValues(con);
@@ -877,6 +883,13 @@ public class resultset {
 		System.out.println("Schema name of first column is " + met.getSchemaName(1));
 		System.out.println("Table name of second column is " + met.getTableName(2));
 		System.out.println("Schema name of second column is " + met.getSchemaName(2));
+        stmt.execute("drop table s");
+        stmt.execute("drop table s1.t1");
+        stmt.execute("drop schema s1 restrict");
+        stmt.execute("drop table app1.t1");
+        stmt.execute("drop table app2.t1");
+        stmt.execute("drop schema app2 restrict");
+        stmt.execute("drop schema app1 restrict");
 	}
 
 	static private void doTheTests() throws Exception
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/resultsetJdbc20.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/resultsetJdbc20.java
index ac09113ba..f847d2598 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/resultsetJdbc20.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/resultsetJdbc20.java
@@ -31,6 +31,8 @@ import java.sql.Types;
 import org.apache.derby.tools.ij;
 import org.apache.derby.tools.JDBCDisplayUtil;
 
+import org.apache.derbyTesting.functionTests.util.TestUtil;
+
 /**
  * Test of additional methods in JDBC2.0 result set meta-data.
  * This program simply calls each of the additional result set meta-data
@@ -39,11 +41,13 @@ import org.apache.derby.tools.JDBCDisplayUtil;
  */
 
 public class resultsetJdbc20 { 
+	private static String[] testObjects = { "TABLE T"};
 	public static void main(String[] args) {
 		Connection con;
 		ResultSetMetaData met;
 		ResultSet rs;
 		Statement stmt;
+		
 		String[]  columnNames = {"i", "s", "r", "d", "dt", "t", "ts", "c", "v", "dc"};
 
 		System.out.println("Test resultsetJdbc20 starting");
@@ -55,6 +59,8 @@ public class resultsetJdbc20 {
 			ij.getPropertyArg(args);
 			con = ij.startJBMS();
 			stmt = con.createStatement();
+			// first clean up
+			TestUtil.cleanUpTest(stmt, testObjects);
 
       //create a table, insert a row, do a select from the table,
       //get the resultset meta data and go through each column in
@@ -91,6 +97,7 @@ public class resultsetJdbc20 {
 
 			rs.close();
 
+			TestUtil.cleanUpTest(stmt, testObjects);
 			stmt.close();
 			con.close();
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/resultsetStream.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/resultsetStream.java
index f562c33ff..c7f3f191a 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/resultsetStream.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/resultsetStream.java
@@ -31,6 +31,7 @@ import java.sql.PreparedStatement;
 
 import org.apache.derby.tools.ij;
 import org.apache.derby.tools.JDBCDisplayUtil;
+import org.apache.derbyTesting.functionTests.util.TestUtil;
 
 import java.io.InputStream;
 import java.io.IOException;
@@ -70,14 +71,22 @@ public class resultsetStream {
 			stmt.execute("create table t2 (len int, data LONG VARCHAR FOR BIT DATA)");
 			PreparedStatement ppw = con.prepareStatement(
 				"insert into t2 (len, data) values (?, ?)");
-			File file = new File("extin/littleclob.txt");
+			String filePath = "extin";
+			String sep = System.getProperty("file.separator");
+			boolean exists = (new File("extin", "littleclob.txt")).exists();
+			if (!exists)
+			{
+				String userDir = System.getProperty("user.dir");
+					filePath = userDir + sep + ".." + sep + filePath;
+			}
+			File file = new File(filePath + sep + "littleclob.txt");
 			int fileSize = (int) file.length();
 			BufferedInputStream fileData = new BufferedInputStream(new FileInputStream(file));
 			ppw.setInt(1, fileSize);
 			ppw.setBinaryStream(2, fileData, fileSize);
 			ppw.executeUpdate();
 
-			file = new File("extin/short.txt");
+			file = new File(filePath + sep + "short.txt");
 			fileSize = (int) file.length();
 			fileData = new BufferedInputStream(new FileInputStream(file));
 			ppw.setInt(1, fileSize);
@@ -89,7 +98,7 @@ public class resultsetStream {
 			ppw.executeUpdate();
 
 			// value copied over from original Java object test.
-			File rssg = new java.io.File("extin/resultsetStream.gif");
+			File rssg = new java.io.File(filePath + sep + "resultsetStream.gif");
 			int rssgLength = (int) rssg.length();
 			ppw.setInt(1, (int) rssgLength);
 			ppw.setBinaryStream(2, new FileInputStream(rssg), rssgLength);
@@ -282,10 +291,11 @@ public class resultsetStream {
 
 			ppw.close();
 			rs.close();
-			stmt.close();
 			
 			TestOfGetAsciiStream.executeTestOfGetAsciiStream(con);
 
+			cleanUp(stmt);
+			stmt.close();
 			con.close();
 
 		}
@@ -308,6 +318,10 @@ public class resultsetStream {
 		}
 	}
 	
+	private static void cleanUp(Statement stmt) throws SQLException {
+		String[] testObjects = { " table t3", "table t2" };
+		TestUtil.cleanUpTest(stmt, testObjects);
+	}
 	
 	static class TestOfGetAsciiStream {
 		
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/rsgetXXXcolumnNames.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/rsgetXXXcolumnNames.java
index 3634ebafc..de3315b35 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/rsgetXXXcolumnNames.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/rsgetXXXcolumnNames.java
@@ -6,6 +6,8 @@ import java.sql.*;
 import org.apache.derby.tools.ij;
 import org.apache.derby.tools.JDBCDisplayUtil;
 
+import org.apache.derbyTesting.functionTests.util.TestUtil;
+
 public class rsgetXXXcolumnNames {
 
     public static void main(String[] args) {
@@ -27,10 +29,15 @@ public class rsgetXXXcolumnNames {
                         ij.getPropertyArg(args);
                         con = ij.startJBMS();
 					
-			con.setAutoCommit(false);                        			              
 
                         stmt = con.createStatement(); 
 
+                        // first cleanup in case we're using useprocess false
+                        String[] testObjects = {"table caseiscol"};
+                        TestUtil.cleanUpTest(stmt, testObjects);
+
+			con.setAutoCommit(false);                        			              
+
 			// create a table with two columns, their names differ in they being in different cases.
                         stmt.executeUpdate("create table caseiscol(COL1 int ,\"col1\" int)");
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/savepointJdbc30.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/savepointJdbc30.java
index 72e4cd5b1..1fb9ed249 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/savepointJdbc30.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/savepointJdbc30.java
@@ -44,8 +44,12 @@ public class savepointJdbc30 {
 
 	static private boolean isDerbyNet = false;
 
+    static private String[] testObjects = { "table t1", "table t2", "table savepoint"};
+
+
+
 	public static void main(String[] args) {
-		Connection con = null, con2 = null;
+		Connection con = null, con2 = null, con3 = null;
 		Statement  s;
 		System.out.println("Test savepointJdbc30 starting");
 
@@ -80,6 +84,15 @@ public class savepointJdbc30 {
 			s.close();
 			con.close();
 			con2.close();
+
+			con3 = ij.startJBMS();
+			con3.setAutoCommit(true);
+			s = con3.createStatement();
+			TestUtil.cleanUpTest(s, testObjects);
+			s.close();
+			con3.close();
+
+
 		}
 		catch (SQLException e) {
 			dumpSQLExceptions(e);
@@ -873,6 +886,16 @@ public class savepointJdbc30 {
 	//Set up the test by creating the table used by the rest of the test.
 	static void setUpTest(Statement s)
 					throws SQLException {
+
+		try {
+			/* Drop the tables, just in case they're there from another test */
+			s.execute("drop table t1");
+			s.execute("drop table t2");
+			s.execute("drop table savepoint");
+		} catch (SQLException se) {
+			//System.out.println("Expected Exception is " + se.getMessage());
+		}
+
 		/* Create a table */
 		s.execute("create table t1 (c11 int, c12 smallint)");
 		s.execute("create table t2 (c11 int)");
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/setTransactionIsolation.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/setTransactionIsolation.java
index 13155248e..f48fe71c8 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/setTransactionIsolation.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/setTransactionIsolation.java
@@ -35,6 +35,7 @@ import java.io.*;
 
 import org.apache.derby.tools.ij;
 import org.apache.derby.tools.JDBCDisplayUtil;
+import org.apache.derbyTesting.functionTests.util.TestUtil;
 
 
 public class setTransactionIsolation{
@@ -54,6 +55,7 @@ public class setTransactionIsolation{
 		createAndPopulateTable(conn);
 		runTests(conn);
 		conn.rollback();
+		cleanUp(conn);
 		conn.close();
     } catch (Throwable  e) {
 		e.printStackTrace();
@@ -343,6 +345,16 @@ public class setTransactionIsolation{
 		}			
 	}
 
+	static void cleanUp(Connection conn) throws SQLException
+	{
+		String[] testObjects = {"table t1"};
+		Statement stmt = conn.createStatement();
+		TestUtil.cleanUpTest(stmt, testObjects);
+		conn.commit();
+		stmt.close();
+	}
+	
+
 }
 
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/xaSimplePositive.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/xaSimplePositive.sql
index b4c28cbd8..ca96b463e 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/xaSimplePositive.sql
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/xaSimplePositive.sql
@@ -135,6 +135,7 @@ xa_start xa_join 5;
 
 select * from APP.global_xactTable where gxid is not null order by gxid;
 select * from APP.foo;
+drop table APP.foo;
 xa_end xa_success 5;
 xa_prepare 5;
 xa_commit xa_2Phase 5;
@@ -156,5 +157,9 @@ create table t1(i int not null primary key, b char(15));
 insert into t1 values (1,'one'), (2, 'two'), (3,'three');
 create procedure DRS(p1 int) parameter style JAVA READS SQL DATA dynamic result sets 1 language java external name 'org.apache.derbyTesting.functionTests.util.ProcedureTest.selectRows';
 call DRS(1);
+drop procedure DRS;
+drop table t1;
+drop view APP.global_xacttable;
+drop schema sku restrict;
 xa_end xa_success 6;
 xa_commit xa_1Phase 6;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/bug5054.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/bug5054.java
index df73058af..dde05f554 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/bug5054.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/bug5054.java
@@ -45,6 +45,7 @@ public class bug5054 {
       	createTables(conn);
       	doUpdates(conn);
       	dumpResult(conn);
+        cleanUp(conn);
 		conn.close();
     } catch (Exception e) {
 		System.out.println("FAIL -- unexpected exception "+e);
@@ -68,6 +69,14 @@ public class bug5054 {
     stmt.close();
   }
 
+  private static void cleanUp(Connection conn) throws SQLException {
+    Statement stmt = conn.createStatement();
+	try {
+    	stmt.executeUpdate( "DROP TABLE T1" );
+	}catch (Exception e) {}
+    stmt.close();
+  }
+
   private static void doUpdates(Connection conn) throws SQLException
   {
     int rc;
@@ -98,6 +107,7 @@ public class bug5054 {
     while (rs.next()) {
       System.out.println(rs.getInt(1)+ " " + rs.getInt(2));
     }
+    rs.close();
   }
 
 }
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/declareGlobalTempTableJavaJDBC30.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/declareGlobalTempTableJavaJDBC30.java
index a40ba7a32..646a3d1aa 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/declareGlobalTempTableJavaJDBC30.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/declareGlobalTempTableJavaJDBC30.java
@@ -1185,8 +1185,8 @@ public class declareGlobalTempTableJavaJDBC30 {
 				ds.setDatabaseName("wombat");
 				ds.setUser("cs");
 				ds.setPassword("cs");
-
-				ds.setServerName("localhost");
+				hostName = TestUtil.getHostName();
+				ds.setServerName(hostName);
 				ds.setPortNumber(1527);
 				ds.setDriverType(4);
 				dsp = ds;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/forupdate.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/forupdate.sql
index 8e879c6f3..1b0a1f6a7 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/forupdate.sql
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/forupdate.sql
@@ -243,6 +243,7 @@ autocommit on;
 -- drop the tables
 drop table t1;
 drop table t2;
+drop table t3;
 
 -- bug 5643
 -- JCC throws NPE when trying to execute a cursor after the resultset is closed
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/holdCursorIJ.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/holdCursorIJ.sql
index 7c0179eb2..562d00c05 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/holdCursorIJ.sql
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/holdCursorIJ.sql
@@ -208,4 +208,4 @@ update t1 set c12=c12+1 where current of scrollCursor;
 close scrollCursor;
 
 
-
+drop table t1;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/holdCursorJava.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/holdCursorJava.java
index 39adef27d..baaa1a1f9 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/holdCursorJava.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/holdCursorJava.java
@@ -33,10 +33,15 @@ import java.sql.Types;
 import org.apache.derby.tools.ij;
 import org.apache.derby.tools.JDBCDisplayUtil;
 
+import org.apache.derbyTesting.functionTests.util.TestUtil;
+
 /**
  * Test hold cursor after commit
  */
 public class holdCursorJava {
+  private static String[] databaseObjects = {"PROCEDURE MYPROC", "TABLE T1", "TABLE T2",
+                                 "TABLE TESTTABLE1", "TABLE TESTTABLE2",
+                                 "TABLE BUG4385"};
 
   public static void main (String args[])
   {
@@ -57,7 +62,13 @@ public class holdCursorJava {
 		testIsolationLevelChange(conn);
 
 		conn.rollback();
+                conn.setAutoCommit(true);
+		
+		Statement stmt = conn.createStatement();
+                TestUtil.cleanUpTest(stmt, databaseObjects);
 		conn.close();
+               
+
     } catch (Exception e) {
 		System.out.println("FAIL -- unexpected exception "+e);
 		JDBCDisplayUtil.ShowException(System.out, e);
@@ -69,6 +80,9 @@ public class holdCursorJava {
   private static void createAndPopulateTable(Connection conn) throws SQLException {
     Statement stmt = conn.createStatement();
 
+    // first drop the objects, in case something is left over from past runs or other tests
+    TestUtil.cleanUpTest(stmt, databaseObjects);
+
     System.out.println("Creating table...");
     stmt.executeUpdate( "CREATE TABLE T1 (c11 int, c12 int)" );
     stmt.executeUpdate("INSERT INTO T1 VALUES(1,1)");
@@ -88,6 +102,19 @@ public class holdCursorJava {
     stmt.close();
   }
 
+  //drop tables
+  private static void cleanUpTest(Connection conn) throws SQLException {
+    Statement stmt = conn.createStatement();
+    //System.out.println("dropping test objects...");
+    stmt.executeUpdate( "DROP PROCEDURE MYPROC" );
+    stmt.executeUpdate( "DROP TABLE T1" );
+    stmt.executeUpdate( "DROP TABLE T2" );
+    stmt.executeUpdate( "DROP TABLE testtable1" );
+    stmt.executeUpdate( "DROP TABLE testtable2" );
+    stmt.executeUpdate( "DROP TABLE BUG4385" );
+    stmt.close();
+  }
+
   //test cursor holdability after commit on multi table query
   private static void testHoldCursorOnMultiTableQuery(Connection conn) throws Exception
   {
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/holdCursorJavaReflection.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/holdCursorJavaReflection.java
index c1689bd4f..81ea82379 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/holdCursorJavaReflection.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/holdCursorJavaReflection.java
@@ -72,6 +72,7 @@ public class holdCursorJavaReflection {
 		ij.getPropertyArg(args);
 		Connection conn = ij.startJBMS();
 
+        dropTable(conn);
 		createAndPopulateTable(conn);
 
     //set autocommit to off after creating table and inserting data
@@ -80,6 +81,8 @@ public class holdCursorJavaReflection {
 		testPreparedStatement(conn);
 		testCallableStatement(conn);
 		conn.rollback();
+        conn.setAutoCommit(true);
+        dropTable(conn);
 		conn.close();
     } catch (Exception e) {
 		System.out.println("FAIL -- unexpected exception "+e);
@@ -101,6 +104,17 @@ public class holdCursorJavaReflection {
     stmt.close();
   }
 
+  //drop table
+  private static void dropTable(Connection conn)
+// throws SQLException 
+{
+    try {
+        Statement stmt = conn.createStatement();
+        stmt.executeUpdate( "DROP TABLE T1" );
+        stmt.close();
+    } catch (SQLException se) {} // assume any error is because table doesn't exist  
+  }
+
   //test cursor holdability for callable statements
   private static void testCallableStatement(Connection conn) throws Exception
   {
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/optimizerOverrides.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/optimizerOverrides.sql
index 5965c4e0a..190d063f3 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/optimizerOverrides.sql
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/optimizerOverrides.sql
@@ -219,3 +219,4 @@ drop view v1;
 drop table t2;
 drop table t1;
 drop table temp1;
+commit;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/procedure.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/procedure.java
index 1a22b3bfe..8c1d4cdab 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/procedure.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/procedure.java
@@ -48,6 +48,7 @@ public class procedure
 	{
    		ij.getPropertyArg(argv); 
         Connection conn = ij.startJBMS();
+		cleanUp(conn);
 		isDerbyNet = TestUtil.isNetFramework();
 
 		// DB2 !!
@@ -86,6 +87,7 @@ public class procedure
 			testLiterals(conn);
             
             multipleRSTests(conn);
+			cleanUp(conn);
 		} catch (SQLException sqle) {
 			org.apache.derby.tools.JDBCDisplayUtil.ShowSQLException(System.out, sqle);
 			sqle.printStackTrace(System.out);
@@ -1761,4 +1763,21 @@ public class procedure
         } catch (Exception e) {return cs.getMoreResults();}//for jdks prior to jdk14 
     }
 
+    /** 
+     * clean up any objects not cleaned up by previous efforts
+     */
+    private static void cleanUp(Connection conn) throws SQLException {
+        String[] testObjects = {
+            "table t1", "procedure procdup", "schema s1 restrict",
+            "schema s2 restrict", "procedure drs", "procedure drs2",
+            "procedure litt.ty_smallint", "procedure litt.ty_integer", "procedure litt.ty_bigint",
+            "procedure litt.ty_real", "procedure litt.ty_double", "procedure litt.ty_decimal",
+            "procedure litt.ty_char", "procedure litt.ty_varchar",
+            "table SQLC.SQLCONTROL_DDL", "table SQLCONTROL_DDL",
+            "table SQLC.SQLCONTROL_DML",
+             }; 
+        Statement stmt = conn.createStatement();
+        TestUtil.cleanUpTest(stmt, testObjects);
+    } 
+
 }
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/procedureJdbc30.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/procedureJdbc30.java
index 778423a11..8fe85140d 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/procedureJdbc30.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/procedureJdbc30.java
@@ -32,6 +32,7 @@ public class procedureJdbc30
 { 
 
 	static private boolean isDerbyNet = false;
+	static private String[] testObjects = { "TABLE MRS.FIVERS", "PROCEDURE MRS.FIVEJP"};
 
 	public static void main (String[] argv) throws Throwable
 	{
@@ -56,6 +57,7 @@ public class procedureJdbc30
 	private static void testMoreResults(Connection conn) throws SQLException {
 
 		Statement s = conn.createStatement();
+		TestUtil.cleanUpTest(s, testObjects);
 
 		s.executeUpdate("create table MRS.FIVERS(i integer)");
 		PreparedStatement ps = conn.prepareStatement("insert into MRS.FIVERS values (?)");
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/scrollCursors2.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/scrollCursors2.java
index a00af71d0..4c779916e 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/scrollCursors2.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/scrollCursors2.java
@@ -64,6 +64,7 @@ public class scrollCursors2 {
 			// make the initial connection.
 			ij.getPropertyArg(args);
 			conn = ij.startJBMS();
+			cleanUp(conn);	
 			conn.setAutoCommit(false);
 
 			/* Create the table and do any other set-up */
@@ -1611,17 +1612,15 @@ public class scrollCursors2 {
 	static boolean cleanUp(Connection conn, Statement s) {
 		try {
 			/* Drop the table we created */
-			if (s != null)
+			if (s == null)
 			{
-				s.execute("drop table t");
+				// well, then, we'll have to restart
+				s = conn.createStatement();
 			}
-
+			s.execute("drop table t");
 			/* Close the connection */
-			if (conn != null)
-			{
-				conn.commit();
-				conn.close();
-			}
+			conn.commit();
+			conn.close();
 		} catch (Throwable e) {
 			System.out.println("FAIL -- unexpected exception caught in cleanup()");
 			JDBCDisplayUtil.ShowException(System.out, e);
@@ -1630,4 +1629,17 @@ public class scrollCursors2 {
 
 		return true;
 	}
+
+	/* 
+	 * cleanup also before test start, just in case
+	 * @param conn	The Connection
+	 */
+	static void cleanUp(Connection conn) throws SQLException {
+		Statement cleanupStmt = conn.createStatement();
+		String[] testObjects = {"table t"};
+		TestUtil.cleanUpTest(cleanupStmt, testObjects);
+		cleanupStmt.close();
+	}
+
+
 }
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/simpleScroll.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/simpleScroll.sql
index c96f54d78..07dfabcef 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/simpleScroll.sql
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/simpleScroll.sql
@@ -76,6 +76,7 @@ select c2 from t1 right outer join t2 on (i1=i2);
 select c1 from t1 left outer join t2 on (i1=i2);
 select c2 from t1 left outer join t2 on (i1=i2);
 
+drop table t;
 drop table t1;
 drop table t2;
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/supersimple.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/supersimple.sql
index 278e2e7cd..e545cd723 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/supersimple.sql
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/supersimple.sql
@@ -88,9 +88,13 @@ drop table a;
 
 -- Bug 4694 Test automatic rollback with close of connection
 -- in ij
+connect 'wombat';
 autocommit off;
 create table a (a int);
-
+select count(*) from a;
+disconnect;
+set connection connection0;
+select count(*) from a;
 
 -- Bug 4758 - Store error does not return properly to client
 autocommit off;
@@ -115,4 +119,8 @@ insert into t1 values ('some clob', '');
 select * from t1;
 select c2 from t1;
 drop table t1;
-
+commit;
+disconnect;
+set connection connection0;
+autocommit on;
+drop table t;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/unaryArithmeticDynamicParameter.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/unaryArithmeticDynamicParameter.java
index ff16c036b..0a10c1a14 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/unaryArithmeticDynamicParameter.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/unaryArithmeticDynamicParameter.java
@@ -28,6 +28,7 @@ import java.sql.SQLException;
 import java.sql.Statement;
 
 import org.apache.derby.tools.ij;
+import org.apache.derbyTesting.functionTests.util.TestUtil;
 
 
 /**
@@ -421,7 +422,22 @@ public class unaryArithmeticDynamicParameter {
 			System.out.println("SQL State : " + e.getSQLState());
 			System.out.println("Got expected exception " + e.getMessage());
 		}
+		finally {
+			cleanUp(conn);
+		}
 	};
+
+	private static void cleanUp(Connection conn) throws SQLException
+	{
+		Statement stmt = conn.createStatement();
+		String[] testObjects = { "table t1", "table t2", "view v1", 
+					"procedure abs_funct", "procedure max_cni"};
+		// this will drop all testobjects listed
+		TestUtil.cleanUpTest(stmt, testObjects);
+		stmt.close();
+		conn.close();
+	}
+
 	private static void dumpRS(ResultSet s) throws SQLException
 	{
 		if (s == null)
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/updatableResultSet.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/updatableResultSet.java
index 34795127e..9c5259d4c 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/updatableResultSet.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/updatableResultSet.java
@@ -2685,18 +2685,16 @@ public class updatableResultSet {
 
 	static void teardown() throws SQLException {
 		Statement stmt = conn.createStatement();
-		stmt.executeUpdate("drop table t1");
-		stmt.executeUpdate("drop table t2");
-		stmt.executeUpdate("drop table t3");
-		stmt.executeUpdate("drop table tableWithConstraint");
-		stmt.executeUpdate("drop table tableWithPrimaryKey");
-		stmt.executeUpdate("drop table deleteTriggerInsertIntoThisTable");
-		stmt.executeUpdate("drop table updateTriggerInsertIntoThisTable");
-		stmt.executeUpdate("drop table table0WithTriggers");
-		stmt.executeUpdate("drop table table1WithTriggers");
-		stmt.executeUpdate("drop table table2WithTriggers");
-		stmt.executeUpdate("drop table selfReferencingT1");
-		stmt.executeUpdate("drop table selfReferencingT2");
+		String[] testObjects={"table \" t 11 \"", "table \"t1\"",
+			"trigger tr1", "trigger tr2", "trigger tr3", "trigger tr4",
+			"view v1", "table s2.t1", "schema s2 restrict", "table t2", 
+			"table t1", "table t3",	"table tableWithConstraint",
+			"table tableWithPrimaryKey", "table deleteTriggerInsertIntoThisTable",
+			"table updateTriggerInsertIntoThisTable", "table table0WithTriggers",
+			"table table1WithTriggers", "table table2WithTriggers",
+			"table selfReferencingT1", "table selfReferencingT2",
+			"table AllDataTypesForTestingTable", "table AllDataTypesNewValuesData"};
+		TestUtil.cleanUpTest(stmt, testObjects);	
 		conn.commit();
 		stmt.close();
 	}
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/wisconsin.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/wisconsin.sql
index c20ce94ea..ac69c71d5 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/wisconsin.sql
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/wisconsin.sql
@@ -3569,3 +3569,10 @@ get cursor c as
 close c;
 -- 27, join on onePercent--1 row
 values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
+
+-- cleanup
+drop table TENKTUP1;
+drop table TENKTUP2;
+drop table ONEKTUP;
+drop table BPRIME;
+drop procedure WISCINSERT;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/wisconsin_derby.properties b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/wisconsin_derby.properties
index 4cfe84195..fdd4a961b 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/wisconsin_derby.properties
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/wisconsin_derby.properties
@@ -10,3 +10,4 @@ derby.language.preloadClasses=true
 derby.storage.checkpointInterval=100000
 # override derby.debug.true to speed up test execution.
 derby.debug.true=
+derby.optimize.noTimeout=true
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/store/bootLock1.java b/java/testing/org/apache/derbyTesting/functionTests/tests/store/bootLock1.java
index 36752626b..457d9f6af 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/store/bootLock1.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/store/bootLock1.java
@@ -50,6 +50,9 @@ public class bootLock1 {
 			ij.getPropertyArg(args);
 			Class.forName("org.apache.derby.jdbc.EmbeddedDriver");
 			con = DriverManager.getConnection("jdbc:derby:wombat");
+			stmt = con.createStatement();
+			// while we're here, let's cleanup
+			stmt.execute("drop table t1");
 			//infinite loop until it gets killed.
 			for(;;)
 			{
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/store/holdCursorExternalSortJDBC30.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/store/holdCursorExternalSortJDBC30.sql
index f0c945000..2441561de 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/store/holdCursorExternalSortJDBC30.sql
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/store/holdCursorExternalSortJDBC30.sql
@@ -152,3 +152,4 @@ close test1;
 drop function PADSTRING;
 drop procedure WAIT_FOR_POST_COMMIT;
 drop table foo;
+commit;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/store/holdCursorJDBC30.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/store/holdCursorJDBC30.sql
index f1a7e4eea..cad830c52 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/store/holdCursorJDBC30.sql
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/store/holdCursorJDBC30.sql
@@ -1102,4 +1102,13 @@ next test12;
 commit;
 
 close test12;
+
+
+drop table foo;
+drop table t1;
+drop table t2;
+drop function padstring;
+drop procedure wait_for_post_commit;
+commit;
+
 exit;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/tools/dblook_test.java b/java/testing/org/apache/derbyTesting/functionTests/tests/tools/dblook_test.java
index 8d32bf277..a46541f80 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/tools/dblook_test.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/tools/dblook_test.java
@@ -386,7 +386,8 @@ public class dblook_test {
 
 		printAsHeader("\nDumping DDL for all objects, " +
 			"using\nNetwork Server:\n");
-		jdbcProtocol = TestUtil.getJdbcUrlPrefix("localhost",SERVER_PORT);
+		String hostName = TestUtil.getHostName();
+		jdbcProtocol = TestUtil.getJdbcUrlPrefix(hostName,SERVER_PORT);
 
 		String sourceDBUrl;
 		if (TestUtil.isJCCFramework())
diff --git a/java/testing/org/apache/derbyTesting/functionTests/util/TestUtil.java b/java/testing/org/apache/derbyTesting/functionTests/util/TestUtil.java
index e347f20d4..39424e0e1 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/util/TestUtil.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/util/TestUtil.java
@@ -181,14 +181,27 @@ public class TestUtil {
 	/**
 	    Get URL prefix for current framework.
 		
-		@return url, assume localhost and port 1527 for Network Tests
+		@return url, assume localhost - unless set differently in System property - 
+		             and assume port 1527 for Network Tests
 		@see getJdbcUrlPrefix(String server, int port)
 		
 	*/
-	public static String getJdbcUrlPrefix()
-	{
-		return getJdbcUrlPrefix("localhost", 1527);
-	}
+    public static String getJdbcUrlPrefix()
+    {
+        String hostName=getHostName();
+        return getJdbcUrlPrefix(hostName, 1527);
+    }
+
+    /** Get hostName as passed in - if not, set it to "localhost" 
+        @return hostName, as passed into system properties, or "localhost"
+    */
+    public static String getHostName()
+    {
+        String hostName = (System.getProperty("hostName"));
+        if (hostName == null)
+            hostName="localhost";
+        return hostName;
+    }
 
 	/** 
 		Get URL prefix for current framework		
@@ -659,6 +672,26 @@ public class TestUtil {
 		}
 
 	}
+
+    /**
+        Drop the test objects passed in as a string identifying the
+        type of object (e.g. TABLE, PROCEDURE) and its name.
+        Thus, for example, a testObject array could be:
+        {"TABLE MYSCHEMA.MYTABLE", "PROCEDURE THISDUMMY"}
+        The statement passed in must be a 'live' statement in the test.
+    */
+    public static void cleanUpTest (Statement s, String[] testObjects)
+                                    throws SQLException {
+        /* drop each object named */
+        for (int i=0; i < testObjects.length; i++) {
+            try {
+                s.execute("drop " + testObjects[i]);
+                //System.out.println("now dropping " + testObjects[i]);
+            } catch (SQLException se) { // ignore...
+            }
+        }	
+    }
+
 	
 	public static Connection getDataSourceConnection (Properties prop) throws SQLException {
 		DataSource ds = TestUtil.getDataSource(prop);
@@ -683,5 +716,6 @@ public class TestUtil {
 			throw e;
 		}
 	}
+
 }
 
diff --git a/java/tools/org/apache/derby/impl/tools/ij/xaHelper.java b/java/tools/org/apache/derby/impl/tools/ij/xaHelper.java
index 095756a92..76daa4694 100644
--- a/java/tools/org/apache/derby/impl/tools/ij/xaHelper.java
+++ b/java/tools/org/apache/derby/impl/tools/ij/xaHelper.java
@@ -89,8 +89,17 @@ class xaHelper implements xaAbstractHelper
 			  
 			  if (isJCC || isNetClient)
 			  {
-			  xaHelper.setDataSourceProperty(currentXADataSource,
-											 "ServerName", "localhost");
+			  	String hostName = System.getProperty("hostName");
+			  	if ((hostName != null ) && (!hostName.equals("localhost")))
+				{			
+			  		xaHelper.setDataSourceProperty(currentXADataSource,
+											 "ServerName", hostName);
+				}
+			  	else
+				{			
+			  		xaHelper.setDataSourceProperty(currentXADataSource,
+							 "ServerName", "localhost");
+				}
 			  xaHelper.setDataSourceProperty(currentXADataSource,
 											 "portNumber", 1527);
 			  
