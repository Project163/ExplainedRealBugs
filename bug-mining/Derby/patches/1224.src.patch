diff --git a/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java b/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java
index 966e8e012..c27b0c115 100644
--- a/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java
+++ b/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java
@@ -1174,7 +1174,7 @@ public abstract class EmbedConnection implements EngineConnection
 				(rootConnection == this) && 
 				(!autoCommit && !transactionIsIdle())) {
 			throw newSQLException(
-				SQLState.LANG_INVALID_TRANSACTION_STATE);
+				SQLState.CANNOT_CLOSE_ACTIVE_CONNECTION);
 		}
 		
 		close(exceptionClose);
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbc4/StatementTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbc4/StatementTest.java
index 3ecad5f6a..5ee99d10b 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbc4/StatementTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbc4/StatementTest.java
@@ -165,11 +165,8 @@ public class StatementTest
         } catch (SQLException sqle) {
             // The SQL State is incorrect in the embedded client, see
             // JIRA id DERBY-1168
-            String expectedState;
-            if ( this.usingDerbyNetClient() )
-                expectedState = SQLStateConstants.INVALID_TRANSACTION_STATE_ACTIVE_SQL_TRANSACTION;
-            else
-                expectedState = SQLStateConstants.INVALID_TRANSACTION_STATE_NO_SUBCLASS;
+            String expectedState =
+                SQLStateConstants.INVALID_TRANSACTION_STATE_ACTIVE_SQL_TRANSACTION;
             
             if ( ! expectedState.equals(sqle.getSQLState()) )
             {
