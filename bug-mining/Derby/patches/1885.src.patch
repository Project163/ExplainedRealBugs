diff --git a/java/engine/org/apache/derby/iapi/services/context/ContextService.java b/java/engine/org/apache/derby/iapi/services/context/ContextService.java
index c50ab8098..2464f65b9 100644
--- a/java/engine/org/apache/derby/iapi/services/context/ContextService.java
+++ b/java/engine/org/apache/derby/iapi/services/context/ContextService.java
@@ -21,19 +21,16 @@
 
 package org.apache.derby.iapi.services.context;
 
-import org.apache.derby.iapi.error.ShutdownException;
-import org.apache.derby.iapi.services.monitor.Monitor;
-import org.apache.derby.iapi.services.sanity.SanityManager;
-import org.apache.derby.iapi.services.stream.HeaderPrintWriter;
-
 import java.security.AccessController;
 import java.security.PrivilegedAction;
-import java.util.Hashtable;
-import java.util.Enumeration;
-
 import java.util.HashSet;
 import java.util.Iterator;
 
+import org.apache.derby.iapi.error.ShutdownException;
+import org.apache.derby.iapi.services.monitor.Monitor;
+import org.apache.derby.iapi.services.sanity.SanityManager;
+import org.apache.derby.iapi.services.stream.HeaderPrintWriter;
+
 /**
 	A set of static methods to supply easier access to contexts.
 */
diff --git a/java/engine/org/apache/derby/impl/sql/execute/InternalTriggerExecutionContext.java b/java/engine/org/apache/derby/impl/sql/execute/InternalTriggerExecutionContext.java
index dc8b02398..31c9c12f0 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/InternalTriggerExecutionContext.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/InternalTriggerExecutionContext.java
@@ -21,30 +21,28 @@
 
 package org.apache.derby.impl.sql.execute;
 
-import org.apache.derby.iapi.services.sanity.SanityManager;
-import org.apache.derby.iapi.error.PublicAPI;
+import java.sql.SQLException;
+import java.util.Enumeration;
+import java.util.Hashtable;
+import java.util.Map;
+import java.util.Vector;
+
+import org.apache.derby.catalog.UUID;
 import org.apache.derby.iapi.db.TriggerExecutionContext;
+import org.apache.derby.iapi.error.ExceptionSeverity;
+import org.apache.derby.iapi.error.PublicAPI;
+import org.apache.derby.iapi.error.StandardException;
+import org.apache.derby.iapi.jdbc.ConnectionContext;
+import org.apache.derby.iapi.reference.SQLState;
+import org.apache.derby.iapi.services.i18n.MessageService;
+import org.apache.derby.iapi.services.sanity.SanityManager;
 import org.apache.derby.iapi.sql.conn.LanguageConnectionContext;
-import org.apache.derby.iapi.sql.ResultSet;
+import org.apache.derby.iapi.sql.dictionary.TriggerDescriptor;
+import org.apache.derby.iapi.sql.execute.ConstantAction;
 import org.apache.derby.iapi.sql.execute.CursorResultSet;
 import org.apache.derby.iapi.sql.execute.ExecRow;
-import org.apache.derby.iapi.types.DataValueDescriptor;
 import org.apache.derby.iapi.sql.execute.ExecutionStmtValidator;
-import org.apache.derby.iapi.sql.execute.ConstantAction;
-import org.apache.derby.iapi.sql.dictionary.TriggerDescriptor;
-import org.apache.derby.iapi.error.StandardException;
-import org.apache.derby.iapi.services.i18n.MessageService;
-import org.apache.derby.iapi.reference.SQLState;
-import org.apache.derby.iapi.jdbc.ConnectionContext; 
-import org.apache.derby.catalog.UUID;
-import java.util.Enumeration;
-import java.util.Vector;
-import java.util.Hashtable;
-import java.util.Map;
-import java.sql.Connection;
-import java.sql.SQLException;
-import java.sql.Statement;
-import org.apache.derby.iapi.error.ExceptionSeverity;
+import org.apache.derby.iapi.types.DataValueDescriptor;
 /**
  * There is one of these beasts per INSERT/DELETE/UPDATE 
  * statement.  It fulfills the contract for the externally
diff --git a/java/engine/org/apache/derby/impl/sql/execute/OrderableAggregator.java b/java/engine/org/apache/derby/impl/sql/execute/OrderableAggregator.java
index 4f3ffbc87..240e6b174 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/OrderableAggregator.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/OrderableAggregator.java
@@ -21,16 +21,14 @@
 
 package org.apache.derby.impl.sql.execute;
 
+import java.io.IOException;
+import java.io.ObjectInput;
+import java.io.ObjectOutput;
+
+import org.apache.derby.iapi.error.StandardException;
 import org.apache.derby.iapi.services.sanity.SanityManager;
 import org.apache.derby.iapi.sql.execute.ExecAggregator;
 import org.apache.derby.iapi.types.DataValueDescriptor;
-import org.apache.derby.iapi.error.StandardException;
-import org.apache.derby.iapi.services.io.Formatable;
-
-
-import java.io.ObjectOutput;
-import java.io.ObjectInput;
-import java.io.IOException;
 
 /**
  * Abstract aggregator for Orderable aggregates (max/min).
diff --git a/java/testing/org/apache/derbyTesting/functionTests/harness/RunTest.java b/java/testing/org/apache/derbyTesting/functionTests/harness/RunTest.java
index c188d88e3..25f5c501d 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/harness/RunTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/harness/RunTest.java
@@ -21,44 +21,32 @@
 
 package org.apache.derbyTesting.functionTests.harness;
 
-import org.apache.derby.tools.sysinfo;
-import org.apache.derby.tools.ij;
-import org.apache.derby.iapi.reference.Attribute;
-
-import java.io.File;
-import java.io.InputStream;
-import java.io.InputStreamReader;
-import java.io.ByteArrayInputStream;
+import java.io.BufferedOutputStream;
 import java.io.BufferedReader;
-import java.io.FileReader;
-import java.io.FileWriter;
+import java.io.BufferedWriter;
+import java.io.File;
 import java.io.FileInputStream;
+import java.io.FileNotFoundException;
 import java.io.FileOutputStream;
-import java.io.BufferedOutputStream;
-import java.io.BufferedWriter;
+import java.io.FileReader;
 import java.io.FileWriter;
+import java.io.IOException;
+import java.io.InputStream;
+import java.io.InputStreamReader;
 import java.io.OutputStreamWriter;
-import java.io.PrintWriter;
 import java.io.PrintStream;
-import java.io.IOException;
-import java.io.FileNotFoundException;
-import java.lang.ClassNotFoundException;
-import java.lang.ClassFormatError;
-import java.lang.Thread;
+import java.io.PrintWriter;
 import java.lang.reflect.Method;
 import java.util.Enumeration;
 import java.util.Locale;
-import java.util.Vector;
-import java.sql.Timestamp;
-import java.sql.Connection;
-import java.sql.SQLException;
-import java.sql.DriverManager;
 import java.util.Properties;
 import java.util.StringTokenizer;
-import java.net.URL;
+import java.util.Vector;
 
 import junit.framework.TestSuite;
 
+import org.apache.derby.iapi.reference.Attribute;
+
 public class RunTest
 {
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/access.out b/java/testing/org/apache/derbyTesting/functionTests/master/access.out
deleted file mode 100644
index 371c161e5..000000000
--- a/java/testing/org/apache/derbyTesting/functionTests/master/access.out
+++ /dev/null
@@ -1,5062 +0,0 @@
-ij> --
---   Licensed to the Apache Software Foundation (ASF) under one or more
---   contributor license agreements.  See the NOTICE file distributed with
---   this work for additional information regarding copyright ownership.
---   The ASF licenses this file to You under the Apache License, Version 2.0
---   (the "License"); you may not use this file except in compliance with
---   the License.  You may obtain a copy of the License at
---
---      http://www.apache.org/licenses/LICENSE-2.0
---
---   Unless required by applicable law or agreed to in writing, software
---   distributed under the License is distributed on an "AS IS" BASIS,
---   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
---   See the License for the specific language governing permissions and
---   limitations under the License.
---
-set isolation to RR;
-0 rows inserted/updated/deleted
-ij> run resource 'createTestProcedures.subsql';
-ij> --
---   Licensed to the Apache Software Foundation (ASF) under one or more
---   contributor license agreements.  See the NOTICE file distributed with
---   this work for additional information regarding copyright ownership.
---   The ASF licenses this file to You under the Apache License, Version 2.0
---   (the "License"); you may not use this file except in compliance with
---   the License.  You may obtain a copy of the License at
---
---      http://www.apache.org/licenses/LICENSE-2.0
---
---   Unless required by applicable law or agreed to in writing, software
---   distributed under the License is distributed on an "AS IS" BASIS,
---   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
---   See the License for the specific language governing permissions and
---   limitations under the License.
---
-CREATE FUNCTION  PADSTRING (DATA VARCHAR(32000), LENGTH INTEGER) RETURNS VARCHAR(32000) EXTERNAL NAME 'org.apache.derbyTesting.functionTests.util.Formatters.padString' LANGUAGE JAVA PARAMETER STYLE JAVA;
-0 rows inserted/updated/deleted
-ij> CREATE PROCEDURE WAIT_FOR_POST_COMMIT() DYNAMIC RESULT SETS 0 LANGUAGE JAVA EXTERNAL NAME 'org.apache.derbyTesting.functionTests.util.T_Access.waitForPostCommitToFinish' PARAMETER STYLE JAVA;
-0 rows inserted/updated/deleted
-ij> -- by default, holdability of ResultSet objects created using this Connection object is true. Following will set it to false for this connection.
-NoHoldForConnection;
-ij> autocommit off;
-ij> --------------------------------------------------------------------------
--- test qualifier skip code on fields with length having the 8th bit set in low
--- order length byte.
---------------------------------------------------------------------------
-drop table a;
-ERROR 42Y55: 'DROP TABLE' cannot be performed on 'A' because it does not exist.
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '32768');
-0 rows inserted/updated/deleted
-ij> create table a
-    (
-        i1      int,
-        col00   varchar(384),
-        col01   varchar(390),
-        i2      int
-    );
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-0 rows inserted/updated/deleted
-ij> insert into a values (1, PADSTRING('10',384), PADSTRING('100',390), 1000);
-1 row inserted/updated/deleted
-ij> insert into a values (2, PADSTRING('20',384), PADSTRING('200',390), 2000);
-1 row inserted/updated/deleted
-ij> insert into a values (3, PADSTRING('30',384), PADSTRING('300',390), 3000);
-1 row inserted/updated/deleted
-ij> select i1, i2 from a where i2 = 3000;
-I1         |I2         
------------------------
-3          |3000       
-ij> drop table a;
-0 rows inserted/updated/deleted
-ij> commit;
-ij> -- test case for track 2590
---    The problem was that the btree split would self deadlock while trying
---    to reclaim rows during the split.  Fixed by just giving up if btree 
---    can't get the locks during the reclaim try.
-create table foo (a int, b varchar(900), c int);
-0 rows inserted/updated/deleted
-ij> insert into foo values (1, PADSTRING('1',900), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (2, PADSTRING('2',900), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (3, PADSTRING('3',900), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (4, PADSTRING('4',900), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (5, PADSTRING('5',900), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (6, PADSTRING('6',900), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (7, PADSTRING('7',900), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (8, PADSTRING('8',900), 1);
-1 row inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '4096');
-0 rows inserted/updated/deleted
-ij> create index foox on foo (a, b);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-0 rows inserted/updated/deleted
-ij> commit;
-ij> delete from foo where foo.a <> 2;
-7 rows inserted/updated/deleted
-ij> -- Test full cursor for update scan over all the rows in the heap, 
--- with default group fetch.  Group fetch should be disabled.
---------------------------------------------------------------------------------
--- force index until optimizer fixes problem where it does not pick index.
-get cursor scan_cursor as
-    'select a, b, c from foo for update of c';
-ij> next scan_cursor;
-A          |B                                                                                                                               |C          
---------------------------------------------------------------------------------------------------------------------------------------------------------
-2          |2                                                                                                                              &|1          
-ij> -- these inserts would cause a lock wait timeout before the bug fix.
-insert into foo values (1, PADSTRING('11',900), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (1, PADSTRING('12',900), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (1, PADSTRING('13',900), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (1, PADSTRING('14',900), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (1, PADSTRING('15',900), 1);
-1 row inserted/updated/deleted
-ij> commit;
-ij> drop table foo;
-0 rows inserted/updated/deleted
-ij> commit;
-ij> -- test case for track 735
---    The problem was that when the level of btree grew, raw store would
---    incorrectly report that there was not enough space to move all the
---    rows from the root page to a newly allocated leaf page, so the create
---    index operation would fail with a message saying that a row was too
---    big.
--- create and load a table with values from 1024 down to 1, the reverse order
--- is important to reproduce the bug.
-create table foo (a int);
-0 rows inserted/updated/deleted
-ij> insert into foo values (1024);
-1 row inserted/updated/deleted
-ij> insert into foo (select foo.a - 1   from foo);
-1 row inserted/updated/deleted
-ij> insert into foo (select foo.a - 2   from foo);
-2 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 4   from foo);
-4 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 8   from foo);
-8 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 16  from foo);
-16 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 32  from foo);
-32 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 64  from foo);
-64 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 128 from foo);
-128 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 256 from foo);
-256 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 512 from foo);
-512 rows inserted/updated/deleted
-ij> -- this create index use to fail.
-create index a on foo (a);
-0 rows inserted/updated/deleted
-ij> -- Check the consistency of the indexes
-VALUES SYSCS_UTIL.SYSCS_CHECK_TABLE('APP', 'FOO');
-1          
------------
-1          
-ij> -- a delete of the whole table also exercises the index well.
-delete from foo;
-1024 rows inserted/updated/deleted
-ij> drop table foo;
-0 rows inserted/updated/deleted
-ij> -- ----------------------------------------------------------------------------
--- stress the conglomerate directory.  abort of an alter table will clear
--- the cache.
--- ----------------------------------------------------------------------------
-autocommit off;
-ij> create table a (a int);
-0 rows inserted/updated/deleted
-ij> commit;
-ij> alter table a add column c1 int;
-0 rows inserted/updated/deleted
-ij> rollback;
-ij> select * from a;
-A          
------------
-ij> drop table a;
-0 rows inserted/updated/deleted
-ij> commit;
-ij> -- ----------------------------------------------------------------------------
--- test case for partial row runtime statistics.
--- ----------------------------------------------------------------------------
-create table foo (a int, b int, c int, d int, e int);
-0 rows inserted/updated/deleted
-ij> insert into foo values (1, 2, 3, 4, 5);
-1 row inserted/updated/deleted
-ij> insert into foo values (10, 20, 30, 40, 50);
-1 row inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1);
-0 rows inserted/updated/deleted
-ij> maximumdisplaywidth 2500;
-ij> -- all the columns
-select * from foo;
-A          |B          |C          |D          |E          
------------------------------------------------------------
-1          |2          |3          |4          |5          
-10         |20         |30         |40         |50         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- all the columns
-select * from foo
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Table Scan ResultSet for FOO at serializable isolation level using share table locking chosen by the optimizer
-Number of opens = 1
-Rows seen = 2
-Rows filtered = 0
-Fetch Size = 16
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	next time in milliseconds/row = 0
-scan information:
-	Bit set of columns fetched=All
-	Number of columns fetched=5
-	Number of pages visited=1
-	Number of rows qualified=2
-	Number of rows visited=2
-	Scan type=heap
-	start position:
-		null
-	stop position:
-		null
-	qualifiers:
-		None
-ij> -- just last column - should be 5 and 50
-select e from foo;
-E          
------------
-5          
-50         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- just last column - should be 5 and 50
-select e from foo
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Table Scan ResultSet for FOO at serializable isolation level using share table locking chosen by the optimizer
-Number of opens = 1
-Rows seen = 2
-Rows filtered = 0
-Fetch Size = 16
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	next time in milliseconds/row = 0
-scan information:
-	Bit set of columns fetched={4}
-	Number of columns fetched=1
-	Number of pages visited=1
-	Number of rows qualified=2
-	Number of rows visited=2
-	Scan type=heap
-	start position:
-		null
-	stop position:
-		null
-	qualifiers:
-		None
-ij> -- as subset of columns - should be 5,3,1 and 50,30,10
-select e, c, a from foo;
-E          |C          |A          
------------------------------------
-5          |3          |1          
-50         |30         |10         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- as subset of columns - should be 5,3,1 and 50,30,10
-select e, c, a from foo
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Project-Restrict ResultSet (2):
-Number of opens = 1
-Rows seen = 2
-Rows filtered = 0
-restriction = false
-projection = true
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	restriction time (milliseconds) = 0
-	projection time (milliseconds) = 0
-Source result set:
-	Table Scan ResultSet for FOO at serializable isolation level using share table locking chosen by the optimizer
-	Number of opens = 1
-	Rows seen = 2
-	Rows filtered = 0
-	Fetch Size = 16
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		next time in milliseconds/row = 0
-	scan information:
-		Bit set of columns fetched={0, 2, 4}
-		Number of columns fetched=3
-		Number of pages visited=1
-		Number of rows qualified=2
-		Number of rows visited=2
-		Scan type=heap
-		start position:
-			null
-		stop position:
-			null
-		qualifiers:
-			None
-ij> -- as subset of columns, with qualifier in list - should be 5,3,1 and 50,30,10
-select e, c, a from foo where foo.e = 5;
-E          |C          |A          
------------------------------------
-5          |3          |1          
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- as subset of columns, with qualifier in list - should be 5,3,1 and 50,30,10
-select e, c, a from foo where foo.e = 5
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Project-Restrict ResultSet (2):
-Number of opens = 1
-Rows seen = 1
-Rows filtered = 0
-restriction = false
-projection = true
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	restriction time (milliseconds) = 0
-	projection time (milliseconds) = 0
-Source result set:
-	Table Scan ResultSet for FOO at serializable isolation level using share table locking chosen by the optimizer
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	Fetch Size = 16
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		next time in milliseconds/row = 0
-	scan information:
-		Bit set of columns fetched={0, 2, 4}
-		Number of columns fetched=3
-		Number of pages visited=1
-		Number of rows qualified=1
-		Number of rows visited=2
-		Scan type=heap
-		start position:
-			null
-		stop position:
-			null
-		qualifiers:
-			Column[0][0] Id: 4
-			Operator: =
-			Ordered nulls: false
-			Unknown return value: false
-			Negate comparison result: false
-ij> -- as subset of columns, with qualifier not in list 
---   - should be 5,3,1 and 50,30,10
-select e, c, a from foo where foo.b = 20;
-E          |C          |A          
------------------------------------
-50         |30         |10         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- as subset of columns, with qualifier not in list 
---   - should be 5,3,1 and 50,30,10
-select e, c, a from foo where foo.b = 20
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Project-Restrict ResultSet (2):
-Number of opens = 1
-Rows seen = 1
-Rows filtered = 0
-restriction = false
-projection = true
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	restriction time (milliseconds) = 0
-	projection time (milliseconds) = 0
-Source result set:
-	Table Scan ResultSet for FOO at serializable isolation level using share table locking chosen by the optimizer
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	Fetch Size = 16
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		next time in milliseconds/row = 0
-	scan information:
-		Bit set of columns fetched={0, 1, 2, 4}
-		Number of columns fetched=4
-		Number of pages visited=1
-		Number of rows qualified=1
-		Number of rows visited=2
-		Scan type=heap
-		start position:
-			null
-		stop position:
-			null
-		qualifiers:
-			Column[0][0] Id: 1
-			Operator: =
-			Ordered nulls: false
-			Unknown return value: false
-			Negate comparison result: false
-ij> -- as subset of columns - should be 1,2 and 10,20
-select a, b from foo;
-A          |B          
------------------------
-1          |2          
-10         |20         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- as subset of columns - should be 1,2 and 10,20
-select a, b from foo
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Table Scan ResultSet for FOO at serializable isolation level using share table locking chosen by the optimizer
-Number of opens = 1
-Rows seen = 2
-Rows filtered = 0
-Fetch Size = 16
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	next time in milliseconds/row = 0
-scan information:
-	Bit set of columns fetched={0, 1}
-	Number of columns fetched=2
-	Number of pages visited=1
-	Number of rows qualified=2
-	Number of rows visited=2
-	Scan type=heap
-	start position:
-		null
-	stop position:
-		null
-	qualifiers:
-		None
-ij> -- now check index scans - force the index just to 
--- make sure it does an index scan.
-create index foo_cover on foo (e, d, c, b, a);
-0 rows inserted/updated/deleted
-ij> -- all the columns
-select * from foo;
-A          |B          |C          |D          |E          
------------------------------------------------------------
-1          |2          |3          |4          |5          
-10         |20         |30         |40         |50         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- all the columns
-select * from foo
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Project-Restrict ResultSet (2):
-Number of opens = 1
-Rows seen = 2
-Rows filtered = 0
-restriction = false
-projection = true
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	restriction time (milliseconds) = 0
-	projection time (milliseconds) = 0
-Source result set:
-	Index Scan ResultSet for FOO using index FOO_COVER at serializable isolation level using share table locking chosen by the optimizer
-	Number of opens = 1
-	Rows seen = 2
-	Rows filtered = 0
-	Fetch Size = 16
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		next time in milliseconds/row = 0
-	scan information:
-		Bit set of columns fetched={0, 1, 2, 3, 4}
-		Number of columns fetched=5
-		Number of deleted rows visited=0
-		Number of pages visited=1
-		Number of rows qualified=2
-		Number of rows visited=2
-		Scan type=btree
-		Tree height=1
-		start position:
-			None
-		stop position:
-			None
-		qualifiers:
-			None
-ij> -- just last column - should be 5 and 50
-select e from foo;
-E          
------------
-5          
-50         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- just last column - should be 5 and 50
-select e from foo
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Index Scan ResultSet for FOO using index FOO_COVER at serializable isolation level using share table locking chosen by the optimizer
-Number of opens = 1
-Rows seen = 2
-Rows filtered = 0
-Fetch Size = 16
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	next time in milliseconds/row = 0
-scan information:
-	Bit set of columns fetched={0}
-	Number of columns fetched=1
-	Number of deleted rows visited=0
-	Number of pages visited=1
-	Number of rows qualified=2
-	Number of rows visited=2
-	Scan type=btree
-	Tree height=1
-	start position:
-		None
-	stop position:
-		None
-	qualifiers:
-		None
-ij> -- as subset of columns - should be 5,3,1 and 50,30,10
-select e, c, a from foo;
-E          |C          |A          
------------------------------------
-5          |3          |1          
-50         |30         |10         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- as subset of columns - should be 5,3,1 and 50,30,10
-select e, c, a from foo
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Project-Restrict ResultSet (3):
-Number of opens = 1
-Rows seen = 2
-Rows filtered = 0
-restriction = false
-projection = true
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	restriction time (milliseconds) = 0
-	projection time (milliseconds) = 0
-Source result set:
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 2
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Index Scan ResultSet for FOO using index FOO_COVER at serializable isolation level using share table locking chosen by the optimizer
-		Number of opens = 1
-		Rows seen = 2
-		Rows filtered = 0
-		Fetch Size = 16
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			next time in milliseconds/row = 0
-		scan information:
-			Bit set of columns fetched={0, 2, 4}
-			Number of columns fetched=3
-			Number of deleted rows visited=0
-			Number of pages visited=1
-			Number of rows qualified=2
-			Number of rows visited=2
-			Scan type=btree
-			Tree height=1
-			start position:
-				None
-			stop position:
-				None
-			qualifiers:
-				None
-ij> -- as subset of columns, with qualifier in list - should be 5,3,1 and 50, 30, 10
-select e, c, a from foo where foo.e = 5;
-E          |C          |A          
------------------------------------
-5          |3          |1          
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- as subset of columns, with qualifier in list - should be 5,3,1 and 50, 30, 10
-select e, c, a from foo where foo.e = 5
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Project-Restrict ResultSet (3):
-Number of opens = 1
-Rows seen = 1
-Rows filtered = 0
-restriction = false
-projection = true
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	restriction time (milliseconds) = 0
-	projection time (milliseconds) = 0
-Source result set:
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Index Scan ResultSet for FOO using index FOO_COVER at serializable isolation level using share row locking chosen by the optimizer
-		Number of opens = 1
-		Rows seen = 1
-		Rows filtered = 0
-		Fetch Size = 16
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			next time in milliseconds/row = 0
-		scan information:
-			Bit set of columns fetched={0, 2, 4}
-			Number of columns fetched=3
-			Number of deleted rows visited=0
-			Number of pages visited=1
-			Number of rows qualified=1
-			Number of rows visited=2
-			Scan type=btree
-			Tree height=1
-			start position:
-				>= on first 1 column(s).
-				Ordered null semantics on the following columns: 
-			stop position:
-				> on first 1 column(s).
-				Ordered null semantics on the following columns: 
-			qualifiers:
-				None
-ij> -- as subset of columns, with qualifier not in list - should be 5,3,1 
--- and 50, 30, 10
-select e, c, a from foo where foo.b = 20;
-E          |C          |A          
------------------------------------
-50         |30         |10         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- as subset of columns, with qualifier not in list - should be 5,3,1 
--- and 50, 30, 10
-select e, c, a from foo where foo.b = 20
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Project-Restrict ResultSet (3):
-Number of opens = 1
-Rows seen = 1
-Rows filtered = 0
-restriction = false
-projection = true
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	restriction time (milliseconds) = 0
-	projection time (milliseconds) = 0
-Source result set:
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Index Scan ResultSet for FOO using index FOO_COVER at serializable isolation level using share table locking chosen by the optimizer
-		Number of opens = 1
-		Rows seen = 1
-		Rows filtered = 0
-		Fetch Size = 16
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			next time in milliseconds/row = 0
-		scan information:
-			Bit set of columns fetched={0, 2, 3, 4}
-			Number of columns fetched=4
-			Number of deleted rows visited=0
-			Number of pages visited=1
-			Number of rows qualified=1
-			Number of rows visited=2
-			Scan type=btree
-			Tree height=1
-			start position:
-				None
-			stop position:
-				None
-			qualifiers:
-				Column[0][0] Id: 3
-				Operator: =
-				Ordered nulls: false
-				Unknown return value: false
-				Negate comparison result: false
-ij> -- as subset of columns - should be 1,2 and 10, 20
-select a, b from foo;
-A          |B          
------------------------
-1          |2          
-10         |20         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- as subset of columns - should be 1,2 and 10, 20
-select a, b from foo
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Project-Restrict ResultSet (2):
-Number of opens = 1
-Rows seen = 2
-Rows filtered = 0
-restriction = false
-projection = true
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	restriction time (milliseconds) = 0
-	projection time (milliseconds) = 0
-Source result set:
-	Index Scan ResultSet for FOO using index FOO_COVER at serializable isolation level using share table locking chosen by the optimizer
-	Number of opens = 1
-	Rows seen = 2
-	Rows filtered = 0
-	Fetch Size = 16
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		next time in milliseconds/row = 0
-	scan information:
-		Bit set of columns fetched={3, 4}
-		Number of columns fetched=2
-		Number of deleted rows visited=0
-		Number of pages visited=1
-		Number of rows qualified=2
-		Number of rows visited=2
-		Scan type=btree
-		Tree height=1
-		start position:
-			None
-		stop position:
-			None
-		qualifiers:
-			None
-ij> -- check deleted row feature
-insert into foo values (100, 2, 3, 4, 5);
-1 row inserted/updated/deleted
-ij> insert into foo values (1000, 2, 3, 4, 5);
-1 row inserted/updated/deleted
-ij> delete from foo where foo.a = 100;
-1 row inserted/updated/deleted
-ij> delete from foo where foo.a = 1000;
-1 row inserted/updated/deleted
-ij> -- now check with deleted rows involved.
--- all the columns
-select * from foo;
-A          |B          |C          |D          |E          
------------------------------------------------------------
-1          |2          |3          |4          |5          
-10         |20         |30         |40         |50         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- now check with deleted rows involved.
--- all the columns
-select * from foo
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Project-Restrict ResultSet (2):
-Number of opens = 1
-Rows seen = 2
-Rows filtered = 0
-restriction = false
-projection = true
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	restriction time (milliseconds) = 0
-	projection time (milliseconds) = 0
-Source result set:
-	Index Scan ResultSet for FOO using index FOO_COVER at serializable isolation level using share table locking chosen by the optimizer
-	Number of opens = 1
-	Rows seen = 2
-	Rows filtered = 0
-	Fetch Size = 16
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		next time in milliseconds/row = 0
-	scan information:
-		Bit set of columns fetched={0, 1, 2, 3, 4}
-		Number of columns fetched=5
-		Number of deleted rows visited=2
-		Number of pages visited=1
-		Number of rows qualified=2
-		Number of rows visited=4
-		Scan type=btree
-		Tree height=1
-		start position:
-			None
-		stop position:
-			None
-		qualifiers:
-			None
-ij> -- just last column - should be 5 and 50
-select e from foo;
-E          
------------
-5          
-50         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- just last column - should be 5 and 50
-select e from foo
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Index Scan ResultSet for FOO using index FOO_COVER at serializable isolation level using share table locking chosen by the optimizer
-Number of opens = 1
-Rows seen = 2
-Rows filtered = 0
-Fetch Size = 16
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	next time in milliseconds/row = 0
-scan information:
-	Bit set of columns fetched={0}
-	Number of columns fetched=1
-	Number of deleted rows visited=2
-	Number of pages visited=1
-	Number of rows qualified=2
-	Number of rows visited=4
-	Scan type=btree
-	Tree height=1
-	start position:
-		None
-	stop position:
-		None
-	qualifiers:
-		None
-ij> -- as subset of columns - should be 5,3,1 and 50,30,10
-select e, c, a from foo;
-E          |C          |A          
------------------------------------
-5          |3          |1          
-50         |30         |10         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- as subset of columns - should be 5,3,1 and 50,30,10
-select e, c, a from foo
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Project-Restrict ResultSet (3):
-Number of opens = 1
-Rows seen = 2
-Rows filtered = 0
-restriction = false
-projection = true
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	restriction time (milliseconds) = 0
-	projection time (milliseconds) = 0
-Source result set:
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 2
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Index Scan ResultSet for FOO using index FOO_COVER at serializable isolation level using share table locking chosen by the optimizer
-		Number of opens = 1
-		Rows seen = 2
-		Rows filtered = 0
-		Fetch Size = 16
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			next time in milliseconds/row = 0
-		scan information:
-			Bit set of columns fetched={0, 2, 4}
-			Number of columns fetched=3
-			Number of deleted rows visited=2
-			Number of pages visited=1
-			Number of rows qualified=2
-			Number of rows visited=4
-			Scan type=btree
-			Tree height=1
-			start position:
-				None
-			stop position:
-				None
-			qualifiers:
-				None
-ij> -- as subset of columns, with qualifier in list - should be 5,3,1 and 50,30,10
-select e, c, a from foo where foo.e = 5;
-E          |C          |A          
------------------------------------
-5          |3          |1          
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- as subset of columns, with qualifier in list - should be 5,3,1 and 50,30,10
-select e, c, a from foo where foo.e = 5
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Project-Restrict ResultSet (3):
-Number of opens = 1
-Rows seen = 1
-Rows filtered = 0
-restriction = false
-projection = true
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	restriction time (milliseconds) = 0
-	projection time (milliseconds) = 0
-Source result set:
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Index Scan ResultSet for FOO using index FOO_COVER at serializable isolation level using share row locking chosen by the optimizer
-		Number of opens = 1
-		Rows seen = 1
-		Rows filtered = 0
-		Fetch Size = 16
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			next time in milliseconds/row = 0
-		scan information:
-			Bit set of columns fetched={0, 2, 4}
-			Number of columns fetched=3
-			Number of deleted rows visited=2
-			Number of pages visited=1
-			Number of rows qualified=1
-			Number of rows visited=4
-			Scan type=btree
-			Tree height=1
-			start position:
-				>= on first 1 column(s).
-				Ordered null semantics on the following columns: 
-			stop position:
-				> on first 1 column(s).
-				Ordered null semantics on the following columns: 
-			qualifiers:
-				None
-ij> -- as subset of columns, with qualifier not in list 
---   - should be 5,3,1 and 50,30,10
-select e, c, a from foo where foo.b = 20;
-E          |C          |A          
------------------------------------
-50         |30         |10         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- as subset of columns, with qualifier not in list 
---   - should be 5,3,1 and 50,30,10
-select e, c, a from foo where foo.b = 20
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Project-Restrict ResultSet (3):
-Number of opens = 1
-Rows seen = 1
-Rows filtered = 0
-restriction = false
-projection = true
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	restriction time (milliseconds) = 0
-	projection time (milliseconds) = 0
-Source result set:
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Index Scan ResultSet for FOO using index FOO_COVER at serializable isolation level using share table locking chosen by the optimizer
-		Number of opens = 1
-		Rows seen = 1
-		Rows filtered = 0
-		Fetch Size = 16
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			next time in milliseconds/row = 0
-		scan information:
-			Bit set of columns fetched={0, 2, 3, 4}
-			Number of columns fetched=4
-			Number of deleted rows visited=2
-			Number of pages visited=1
-			Number of rows qualified=1
-			Number of rows visited=4
-			Scan type=btree
-			Tree height=1
-			start position:
-				None
-			stop position:
-				None
-			qualifiers:
-				Column[0][0] Id: 3
-				Operator: =
-				Ordered nulls: false
-				Unknown return value: false
-				Negate comparison result: false
-ij> -- as subset of columns - should be 1,2 and 10,20
-select a, b from foo;
-A          |B          
------------------------
-1          |2          
-10         |20         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- as subset of columns - should be 1,2 and 10,20
-select a, b from foo
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Project-Restrict ResultSet (2):
-Number of opens = 1
-Rows seen = 2
-Rows filtered = 0
-restriction = false
-projection = true
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	restriction time (milliseconds) = 0
-	projection time (milliseconds) = 0
-Source result set:
-	Index Scan ResultSet for FOO using index FOO_COVER at serializable isolation level using share table locking chosen by the optimizer
-	Number of opens = 1
-	Rows seen = 2
-	Rows filtered = 0
-	Fetch Size = 16
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		next time in milliseconds/row = 0
-	scan information:
-		Bit set of columns fetched={3, 4}
-		Number of columns fetched=2
-		Number of deleted rows visited=2
-		Number of pages visited=1
-		Number of rows qualified=2
-		Number of rows visited=4
-		Scan type=btree
-		Tree height=1
-		start position:
-			None
-		stop position:
-			None
-		qualifiers:
-			None
-ij> -- now check index scans - force the index just to 
--- make sure it does an index scan.
-create index foo_cover on foo (e, d, c, b, a);
-0 rows inserted/updated/deleted
-WARNING 01504: The new index is a duplicate of an existing index: FOO_COVER.
-ij> -- all the columns
-select * from foo;
-A          |B          |C          |D          |E          
------------------------------------------------------------
-1          |2          |3          |4          |5          
-10         |20         |30         |40         |50         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- all the columns
-select * from foo
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Project-Restrict ResultSet (2):
-Number of opens = 1
-Rows seen = 2
-Rows filtered = 0
-restriction = false
-projection = true
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	restriction time (milliseconds) = 0
-	projection time (milliseconds) = 0
-Source result set:
-	Index Scan ResultSet for FOO using index FOO_COVER at serializable isolation level using share table locking chosen by the optimizer
-	Number of opens = 1
-	Rows seen = 2
-	Rows filtered = 0
-	Fetch Size = 16
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		next time in milliseconds/row = 0
-	scan information:
-		Bit set of columns fetched={0, 1, 2, 3, 4}
-		Number of columns fetched=5
-		Number of deleted rows visited=2
-		Number of pages visited=1
-		Number of rows qualified=2
-		Number of rows visited=4
-		Scan type=btree
-		Tree height=1
-		start position:
-			None
-		stop position:
-			None
-		qualifiers:
-			None
-ij> -- just last column - should be 5 and 50
-select e from foo;
-E          
------------
-5          
-50         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- just last column - should be 5 and 50
-select e from foo
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Index Scan ResultSet for FOO using index FOO_COVER at serializable isolation level using share table locking chosen by the optimizer
-Number of opens = 1
-Rows seen = 2
-Rows filtered = 0
-Fetch Size = 16
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	next time in milliseconds/row = 0
-scan information:
-	Bit set of columns fetched={0}
-	Number of columns fetched=1
-	Number of deleted rows visited=2
-	Number of pages visited=1
-	Number of rows qualified=2
-	Number of rows visited=4
-	Scan type=btree
-	Tree height=1
-	start position:
-		None
-	stop position:
-		None
-	qualifiers:
-		None
-ij> -- as subset of columns - should be 5,3,1 and 50,30,10
-select e, c, a from foo;
-E          |C          |A          
------------------------------------
-5          |3          |1          
-50         |30         |10         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- as subset of columns - should be 5,3,1 and 50,30,10
-select e, c, a from foo
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Project-Restrict ResultSet (3):
-Number of opens = 1
-Rows seen = 2
-Rows filtered = 0
-restriction = false
-projection = true
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	restriction time (milliseconds) = 0
-	projection time (milliseconds) = 0
-Source result set:
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 2
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Index Scan ResultSet for FOO using index FOO_COVER at serializable isolation level using share table locking chosen by the optimizer
-		Number of opens = 1
-		Rows seen = 2
-		Rows filtered = 0
-		Fetch Size = 16
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			next time in milliseconds/row = 0
-		scan information:
-			Bit set of columns fetched={0, 2, 4}
-			Number of columns fetched=3
-			Number of deleted rows visited=2
-			Number of pages visited=1
-			Number of rows qualified=2
-			Number of rows visited=4
-			Scan type=btree
-			Tree height=1
-			start position:
-				None
-			stop position:
-				None
-			qualifiers:
-				None
-ij> -- as subset of columns, with qualifier in list - should be 5,3,1 and 50, 30, 10
-select e, c, a from foo where foo.e = 5;
-E          |C          |A          
------------------------------------
-5          |3          |1          
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- as subset of columns, with qualifier in list - should be 5,3,1 and 50, 30, 10
-select e, c, a from foo where foo.e = 5
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Project-Restrict ResultSet (3):
-Number of opens = 1
-Rows seen = 1
-Rows filtered = 0
-restriction = false
-projection = true
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	restriction time (milliseconds) = 0
-	projection time (milliseconds) = 0
-Source result set:
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Index Scan ResultSet for FOO using index FOO_COVER at serializable isolation level using share row locking chosen by the optimizer
-		Number of opens = 1
-		Rows seen = 1
-		Rows filtered = 0
-		Fetch Size = 16
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			next time in milliseconds/row = 0
-		scan information:
-			Bit set of columns fetched={0, 2, 4}
-			Number of columns fetched=3
-			Number of deleted rows visited=2
-			Number of pages visited=1
-			Number of rows qualified=1
-			Number of rows visited=4
-			Scan type=btree
-			Tree height=1
-			start position:
-				>= on first 1 column(s).
-				Ordered null semantics on the following columns: 
-			stop position:
-				> on first 1 column(s).
-				Ordered null semantics on the following columns: 
-			qualifiers:
-				None
-ij> -- as subset of columns, with qualifier not in list - should be 5,3,1 
--- and 50, 30, 10
-select e, c, a from foo where foo.b = 20;
-E          |C          |A          
------------------------------------
-50         |30         |10         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- as subset of columns, with qualifier not in list - should be 5,3,1 
--- and 50, 30, 10
-select e, c, a from foo where foo.b = 20
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Project-Restrict ResultSet (3):
-Number of opens = 1
-Rows seen = 1
-Rows filtered = 0
-restriction = false
-projection = true
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	restriction time (milliseconds) = 0
-	projection time (milliseconds) = 0
-Source result set:
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Index Scan ResultSet for FOO using index FOO_COVER at serializable isolation level using share table locking chosen by the optimizer
-		Number of opens = 1
-		Rows seen = 1
-		Rows filtered = 0
-		Fetch Size = 16
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			next time in milliseconds/row = 0
-		scan information:
-			Bit set of columns fetched={0, 2, 3, 4}
-			Number of columns fetched=4
-			Number of deleted rows visited=2
-			Number of pages visited=1
-			Number of rows qualified=1
-			Number of rows visited=4
-			Scan type=btree
-			Tree height=1
-			start position:
-				None
-			stop position:
-				None
-			qualifiers:
-				Column[0][0] Id: 3
-				Operator: =
-				Ordered nulls: false
-				Unknown return value: false
-				Negate comparison result: false
-ij> -- as subset of columns - should be 1,2 and 10, 20
-select a, b from foo;
-A          |B          
------------------------
-1          |2          
-10         |20         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- as subset of columns - should be 1,2 and 10, 20
-select a, b from foo
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Project-Restrict ResultSet (2):
-Number of opens = 1
-Rows seen = 2
-Rows filtered = 0
-restriction = false
-projection = true
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	restriction time (milliseconds) = 0
-	projection time (milliseconds) = 0
-Source result set:
-	Index Scan ResultSet for FOO using index FOO_COVER at serializable isolation level using share table locking chosen by the optimizer
-	Number of opens = 1
-	Rows seen = 2
-	Rows filtered = 0
-	Fetch Size = 16
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		next time in milliseconds/row = 0
-	scan information:
-		Bit set of columns fetched={3, 4}
-		Number of columns fetched=2
-		Number of deleted rows visited=2
-		Number of pages visited=1
-		Number of rows qualified=2
-		Number of rows visited=4
-		Scan type=btree
-		Tree height=1
-		start position:
-			None
-		stop position:
-			None
-		qualifiers:
-			None
-ij> -- ----------------------------------------------------------------------------
--- test case for costing - make sure optimizer picks obvious covered query.
--- ----------------------------------------------------------------------------
-call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1);
-0 rows inserted/updated/deleted
-ij> maximumdisplaywidth 2000;
-ij> create table base_table (a int, b varchar(1000));
-0 rows inserted/updated/deleted
-ij> insert into base_table values (1,  PADSTRING('1',1000));
-1 row inserted/updated/deleted
-ij> insert into base_table values (2,  PADSTRING('2',1000));
-1 row inserted/updated/deleted
-ij> insert into base_table values (3,  PADSTRING('3',1000));
-1 row inserted/updated/deleted
-ij> insert into base_table values (4,  PADSTRING('4',1000));
-1 row inserted/updated/deleted
-ij> insert into base_table values (5,  PADSTRING('5',1000));
-1 row inserted/updated/deleted
-ij> insert into base_table values (6,  PADSTRING('6',1000));
-1 row inserted/updated/deleted
-ij> insert into base_table values (7,  PADSTRING('7',1000));
-1 row inserted/updated/deleted
-ij> insert into base_table values (8,  PADSTRING('8',1000));
-1 row inserted/updated/deleted
-ij> insert into base_table values (9,  PADSTRING('9',1000));
-1 row inserted/updated/deleted
-ij> insert into base_table values (10, PADSTRING('10',1000));
-1 row inserted/updated/deleted
-ij> create index cover_idx on base_table(a);
-0 rows inserted/updated/deleted
-ij> -- make sure covered index is chosen
-select a from base_table;
-A          
------------
-1          
-2          
-3          
-4          
-5          
-6          
-7          
-8          
-9          
-10         
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- make sure covered index is chosen
-select a from base_table
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Index Scan ResultSet for BASE_TABLE using index COVER_IDX at serializable isolation level using share table locking chosen by the optimizer
-Number of opens = 1
-Rows seen = 10
-Rows filtered = 0
-Fetch Size = 16
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	next time in milliseconds/row = 0
-scan information:
-	Bit set of columns fetched={0}
-	Number of columns fetched=1
-	Number of deleted rows visited=0
-	Number of pages visited=1
-	Number of rows qualified=10
-	Number of rows visited=10
-	Scan type=btree
-	Tree height=1
-	start position:
-		None
-	stop position:
-		None
-	qualifiers:
-		None
-ij> -- ----------------------------------------------------------------------------
--- test for key too big error message.
--- ----------------------------------------------------------------------------
-create table d (id int not null, t_bigvarchar varchar(400), unique (id));
-0 rows inserted/updated/deleted
-ij> create index t_bigvarchar_ind on d ( t_bigvarchar);
-0 rows inserted/updated/deleted
-ij> alter table d alter t_bigvarchar set data type varchar(4096);
-0 rows inserted/updated/deleted
-ij> insert into d (id, t_bigvarchar) values (1, 
-'1111111123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-890123456789012345678901234567890123456789012345678901234567890123456');
-ERROR XSCB6: Limitation: Record of a btree secondary index cannot be updated or inserted due to lack of space on the page.  Use the parameters derby.storage.pageSize and/or derby.storage.pageReservedSpace to work around this limitation.
-ij> -- ----------------------------------------------------------------------------
--- test space for update
--- ----------------------------------------------------------------------------
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '1024');
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.minimumRecordSize', '1');
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageReservedSpace', '0');
-0 rows inserted/updated/deleted
-ij> create table testing (a varchar(100));
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.minimumRecordSize', NULL);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.minimumRecordSize', NULL);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageReservedSpace', NULL);
-0 rows inserted/updated/deleted
-ij> insert into testing values ('a');
-1 row inserted/updated/deleted
-ij> insert into testing (select testing.a from testing);
-1 row inserted/updated/deleted
-ij> insert into testing (select testing.a from testing);
-2 rows inserted/updated/deleted
-ij> insert into testing (select testing.a from testing);
-4 rows inserted/updated/deleted
-ij> insert into testing (select testing.a from testing);
-8 rows inserted/updated/deleted
-ij> insert into testing (select testing.a from testing);
-16 rows inserted/updated/deleted
-ij> insert into testing (select testing.a from testing);
-32 rows inserted/updated/deleted
-ij> insert into testing (select testing.a from testing);
-64 rows inserted/updated/deleted
-ij> update testing set a = 'abcd' where a = 'a';
-128 rows inserted/updated/deleted
-ij> create index zz on testing (a);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '1024');
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.minimumRecordSize', '1');
-0 rows inserted/updated/deleted
-ij> create table t1 (a varchar(100));
-0 rows inserted/updated/deleted
-ij> insert into t1 values ('a');
-1 row inserted/updated/deleted
-ij> insert into t1 (select t1.a from t1);
-1 row inserted/updated/deleted
-ij> insert into t1 (select t1.a from t1);
-2 rows inserted/updated/deleted
-ij> insert into t1 (select t1.a from t1);
-4 rows inserted/updated/deleted
-ij> insert into t1 (select t1.a from t1);
-8 rows inserted/updated/deleted
-ij> insert into t1 (select t1.a from t1);
-16 rows inserted/updated/deleted
-ij> insert into t1 (select t1.a from t1);
-32 rows inserted/updated/deleted
-ij> insert into t1 (select t1.a from t1);
-64 rows inserted/updated/deleted
-ij> update t1 set a = 'abcd' where a = 'a';
-128 rows inserted/updated/deleted
-ij> create index zz1 on t1 (a);
-0 rows inserted/updated/deleted
-ij> -- ----------------------------------------------------------------------------
--- test load with long columns with index creation
--- ----------------------------------------------------------------------------
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '1024');
-0 rows inserted/updated/deleted
-ij> create table long1 (a varchar(32000), b int, c int);
-0 rows inserted/updated/deleted
-ij> insert into long1 values ('this is a long row which will get even longer and longer to force a stream', 1, 2);
-1 row inserted/updated/deleted
-ij> insert into long1 values ('this is another long row which will get even longer and longer to force a stream', 2, 3);
-1 row inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-0 rows inserted/updated/deleted
-ij> update long1 set a = a||a||a||a||a||a;
-2 rows inserted/updated/deleted
-ij> update long1 set a = a||a||a||a||a||a;
-2 rows inserted/updated/deleted
-ij> update long1 set a = a||a;
-2 rows inserted/updated/deleted
-ij> select LENGTH(a) from long1;
-1          
------------
-5328       
-5760       
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '1024');
-0 rows inserted/updated/deleted
-ij> create table long2 (a varchar(16384), b int, c int);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '16384');
-0 rows inserted/updated/deleted
-ij> create index long2i1 on long2 (a);
-0 rows inserted/updated/deleted
-ij> create index long2i2 on long2 (a,b);
-0 rows inserted/updated/deleted
-ij> create index long2i3 on long2 (a,b,c);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-0 rows inserted/updated/deleted
-ij> insert into long2 select * from long1;
-2 rows inserted/updated/deleted
-ij> select LENGTH(a) from long2;
-1          
------------
-5328       
-5760       
-ij> -- DefectId 1346 
-insert into long2 select * from long1;
-2 rows inserted/updated/deleted
-ij> select LENGTH(a) from long2;
-1          
------------
-5328       
-5328       
-5760       
-5760       
-ij> delete from long2;
-4 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '1024');
-0 rows inserted/updated/deleted
-ij> create index long2small on long2 (a, c);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-0 rows inserted/updated/deleted
-ij> -- this small index should cause the insert to fail
-insert into long2 select * from long1;
-ERROR XSCB6: Limitation: Record of a btree secondary index cannot be updated or inserted due to lack of space on the page.  Use the parameters derby.storage.pageSize and/or derby.storage.pageReservedSpace to work around this limitation.
-ij> -- DefectId 1346 
--- the small index should cause this insert to also fail
-insert into long2 select * from long1;
-ERROR XSCB6: Limitation: Record of a btree secondary index cannot be updated or inserted due to lack of space on the page.  Use the parameters derby.storage.pageSize and/or derby.storage.pageReservedSpace to work around this limitation.
-ij> select LENGTH(a) from long2;
-1          
------------
-ij> --
--- test case for track 1346
-drop table long1;
-0 rows inserted/updated/deleted
-ij> drop table long2;
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '1024');
-0 rows inserted/updated/deleted
-ij> create table long1 (a varchar(32000), b int, c int);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-0 rows inserted/updated/deleted
-ij> insert into long1 values
-	('this is a long row which will get even longer', 1, 2);
-1 row inserted/updated/deleted
-ij> insert into long1 values
-	('a second row that will also grow very long', 2, 3);
-1 row inserted/updated/deleted
-ij> update long1 set a = a||a||a||a||a||a;
-2 rows inserted/updated/deleted
-ij> update long1 set a = a||a||a||a||a||a;
-2 rows inserted/updated/deleted
-ij> update long1 set a = a||a;
-2 rows inserted/updated/deleted
-ij> select LENGTH(a) from long1;
-1          
------------
-3240       
-3024       
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '1024');
-0 rows inserted/updated/deleted
-ij> create table long2 (a varchar(30000), b int, c int);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '16384');
-0 rows inserted/updated/deleted
-ij> create index long2i1 on long2 (a);
-0 rows inserted/updated/deleted
-ij> create index long2i2 on long2 (b, a);
-0 rows inserted/updated/deleted
-ij> create index long2i3 on long2 (b, a, c);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-0 rows inserted/updated/deleted
-ij> insert into long2 select * from long1;
-2 rows inserted/updated/deleted
-ij> insert into long2 select * from long1;
-2 rows inserted/updated/deleted
-ij> select LENGTH(a) from long2;
-1          
------------
-3240       
-3240       
-3024       
-3024       
-ij> drop table long1;
-0 rows inserted/updated/deleted
-ij> drop table long2;
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '1024');
-0 rows inserted/updated/deleted
-ij> create table long1 (a varchar(32000), b int, c int);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-0 rows inserted/updated/deleted
-ij> insert into long1 values
-	('this is a long row which will get even longer', 1, 2);
-1 row inserted/updated/deleted
-ij> insert into long1 values
-	('a second row that will also grow very long', 2, 3);
-1 row inserted/updated/deleted
-ij> update long1 set a = a||a||a||a||a||a;
-2 rows inserted/updated/deleted
-ij> update long1 set a = a||a||a||a||a||a;
-2 rows inserted/updated/deleted
-ij> update long1 set a = a||a;
-2 rows inserted/updated/deleted
-ij> select LENGTH(a) from long1;
-1          
------------
-3240       
-3024       
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '1024');
-0 rows inserted/updated/deleted
-ij> create table long2 (a varchar(32000), b int, c int);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '16384');
-0 rows inserted/updated/deleted
-ij> create index long2i1 on long2 (a);
-0 rows inserted/updated/deleted
-ij> create index long2i2 on long2 (b, a);
-0 rows inserted/updated/deleted
-ij> create index long2i3 on long2 (b, a, c);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-0 rows inserted/updated/deleted
-ij> -- insert into the second table multiple times
-insert into long2 select * from long1;
-2 rows inserted/updated/deleted
-ij> insert into long2 select * from long1;
-2 rows inserted/updated/deleted
-ij> insert into long2 select * from long1;
-2 rows inserted/updated/deleted
-ij> insert into long2 select * from long1;
-2 rows inserted/updated/deleted
-ij> insert into long2 select * from long1;
-2 rows inserted/updated/deleted
-ij> insert into long2 select * from long1;
-2 rows inserted/updated/deleted
-ij> insert into long2 select * from long1;
-2 rows inserted/updated/deleted
-ij> insert into long2 select * from long1;
-2 rows inserted/updated/deleted
-ij> insert into long2 select * from long1;
-2 rows inserted/updated/deleted
-ij> insert into long2 select * from long1;
-2 rows inserted/updated/deleted
-ij> select LENGTH(a) from long2;
-1          
------------
-3240       
-3240       
-3240       
-3240       
-3240       
-3240       
-3240       
-3240       
-3240       
-3240       
-3024       
-3024       
-3024       
-3024       
-3024       
-3024       
-3024       
-3024       
-3024       
-3024       
-ij> select count(*) from long2;
-1          
------------
-20         
-ij> -- test case for track 1552
---    Make sure that a full scan which needs columns not in index does not
---    use the index.  Before the fix, access costing would make the optimizer
---    pick the index because it incorrectly costed rows spanning pages.
-drop table a;
-ERROR 42Y55: 'DROP TABLE' cannot be performed on 'A' because it does not exist.
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize','4096');
-0 rows inserted/updated/deleted
-ij> create table a (a int, b varchar(4000), c varchar(4000), d varchar(4000));
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-0 rows inserted/updated/deleted
-ij> create index a_idx on a (a);
-0 rows inserted/updated/deleted
-ij> insert into a values (5, PADSTRING('a',4000), PADSTRING('a',4000), PADSTRING('a',4000));
-1 row inserted/updated/deleted
-ij> insert into a values (4, PADSTRING('a',4000), PADSTRING('a',4000), PADSTRING('a',4000));
-1 row inserted/updated/deleted
-ij> insert into a values (3, PADSTRING('a',4000), PADSTRING('a',4000), PADSTRING('a',4000));
-1 row inserted/updated/deleted
-ij> insert into a values (2, PADSTRING('a',4000), PADSTRING('a',4000), PADSTRING('a',4000));
-1 row inserted/updated/deleted
-ij> insert into a values (1, PADSTRING('a',4000), PADSTRING('a',4000), PADSTRING('a',4000));
-1 row inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1);
-0 rows inserted/updated/deleted
-ij> maximumdisplaywidth 2000;
-ij> select a, d from a;
-A          |D                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-5          |a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              &
-4          |a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              &
-3          |a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              &
-2          |a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              &
-1          |a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              &
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	select a, d from a
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Table Scan ResultSet for A at serializable isolation level using share table locking chosen by the optimizer
-Number of opens = 1
-Rows seen = 5
-Rows filtered = 0
-Fetch Size = 16
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	next time in milliseconds/row = 0
-scan information:
-	Bit set of columns fetched={0, 3}
-	Number of columns fetched=2
-	Number of pages visited=6
-	Number of rows qualified=5
-	Number of rows visited=5
-	Scan type=heap
-	start position:
-		null
-	stop position:
-		null
-	qualifiers:
-		None
-ij> autocommit on;
-ij> -- test case for track 2241
---    The problem was that when the level of btree grew, sometimes a long
---    row would be chosen as the branch delimiter, and the branch code did
---    not throw the correct error noSpaceForKey error.
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.minimumRecordSize', NULL);
-0 rows inserted/updated/deleted
-ij> create table b2241 (a int, b varchar(32000));
-0 rows inserted/updated/deleted
-ij> insert into b2241 values (1024, '01234567890123456789012345678901234567890123456789');
-1 row inserted/updated/deleted
-ij> insert into b2241 (select b2241.a + 1  , b from b2241);
-1 row inserted/updated/deleted
-ij> insert into b2241 (select b2241.a + 2  , b from b2241);
-2 rows inserted/updated/deleted
-ij> insert into b2241 (select b2241.a + 4  , b from b2241);
-4 rows inserted/updated/deleted
-ij> insert into b2241 (select b2241.a + 8  , b from b2241);
-8 rows inserted/updated/deleted
-ij> insert into b2241 (select b2241.a + 16  , b from b2241);
-16 rows inserted/updated/deleted
-ij> insert into b2241 (select b2241.a + 32  , b from b2241);
-32 rows inserted/updated/deleted
-ij> insert into b2241 (select b2241.a + 64  , b from b2241);
-64 rows inserted/updated/deleted
-ij> update b2241 set b = b||b;
-128 rows inserted/updated/deleted
-ij> update b2241 set b = b||b;
-128 rows inserted/updated/deleted
-ij> update b2241 set b = b||b;
-128 rows inserted/updated/deleted
-ij> update b2241 set b = b||b;
-128 rows inserted/updated/deleted
-ij> update b2241 set b = b||b;
-128 rows inserted/updated/deleted
-ij> select LENGTH(b) from b2241 where a = 1025;
-1          
------------
-1600       
-ij> insert into b2241 (select 1, b||b||b||b||b||b||b||b from b2241 where a = 1024);
-1 row inserted/updated/deleted
-ij> insert into b2241 (select 8000, b||b||b||b||b||b||b||b from b2241 where a = 1024);
-1 row inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '4096');
-0 rows inserted/updated/deleted
-ij> -- this create index use to fail with an assert - 
--- should fail with key too big error.
-create index a on b2241 (b, a);
-ERROR XSCB6: Limitation: Record of a btree secondary index cannot be updated or inserted due to lack of space on the page.  Use the parameters derby.storage.pageSize and/or derby.storage.pageReservedSpace to work around this limitation.
-ij> -- make sure table still accessable
-create index a on b2241 (b, a);
-ERROR XSCB6: Limitation: Record of a btree secondary index cannot be updated or inserted due to lack of space on the page.  Use the parameters derby.storage.pageSize and/or derby.storage.pageReservedSpace to work around this limitation.
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-0 rows inserted/updated/deleted
-ij> -- delete 2 big records and then index should work.
-delete from b2241 where a = 1;
-1 row inserted/updated/deleted
-ij> delete from b2241 where a = 8000;
-1 row inserted/updated/deleted
-ij> create index a on b2241 (b, a);
-0 rows inserted/updated/deleted
-ij> -- Check the consistency of the indexes
-VALUES SYSCS_UTIL.SYSCS_CHECK_TABLE('APP', 'FOO');
-1          
------------
-1          
-ij> drop table b2241;
-0 rows inserted/updated/deleted
-ij> -- test case for reclaiming deleted rows during split.
---    o insert bunch of rows with sequential keys.
---    o create non-unique index.
---    o delete every other one - this will make normat post commit not fire.
---    o commit
---    o now reinsert rows into the "holes" which before the fix would cause
---      splits, but now will force reclaim space and reuse existing space in
---      btree.
-autocommit off;
-ij> -- set page size back to default.
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '4096');
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.minimumRecordSize', '1');
-0 rows inserted/updated/deleted
-ij> commit;
-ij> drop table foo;
-0 rows inserted/updated/deleted
-ij> drop table foo2;
-ERROR 42Y55: 'DROP TABLE' cannot be performed on 'FOO2' because it does not exist.
-ij> -- create and load a table with values from 1024 down to 1, 
-create table foo (a int, b char(200), c int);
-0 rows inserted/updated/deleted
-ij> insert into foo values (1024,             'even', 0);
-1 row inserted/updated/deleted
-ij> insert into foo        (select foo.a - 1, 'odd' , 1 from foo);
-1 row inserted/updated/deleted
-ij> insert into foo (select foo.a - 2,   foo.b, foo.c from foo);
-2 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 4,   foo.b, foo.c from foo);
-4 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 8,   foo.b, foo.c from foo);
-8 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 16,  foo.b, foo.c from foo);
-16 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 32,  foo.b, foo.c from foo);
-32 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 64,  foo.b, foo.c from foo);
-64 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 128, foo.b, foo.c from foo);
-128 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 256, foo.b, foo.c from foo);
-256 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 512, foo.b, foo.c from foo);
-512 rows inserted/updated/deleted
-ij> -- insert into the "holes", but different keys (even2 instead of even)
-create table foo2 (a int, b char(200), c int);
-0 rows inserted/updated/deleted
-ij> insert into foo2 (select * from foo);
-1024 rows inserted/updated/deleted
-ij> delete from foo2 where foo2.c = 1;
-512 rows inserted/updated/deleted
-ij> -- create "packed" index.
-create index a on foo (a, b);
-0 rows inserted/updated/deleted
-ij> -- delete ever other row
-delete from foo where foo.c = 0;
-512 rows inserted/updated/deleted
-ij> -- turn all the deletes into "committed deletes"
-commit;
-ij> insert into foo (select foo2.a, 'even2', foo2.c from foo2);
-512 rows inserted/updated/deleted
-ij> commit;
-ij> -- insert dups 
-insert into foo (select foo2.a, 'even2', foo2.c from foo2);
-512 rows inserted/updated/deleted
-ij> commit;
-ij> -- a delete of the whole table also exercises the btree well.
-delete from foo;
-1536 rows inserted/updated/deleted
-ij> drop table foo;
-0 rows inserted/updated/deleted
-ij> drop table foo2;
-0 rows inserted/updated/deleted
-ij> -- try same test with unique index.
--- create and load a table with values from 1024 down to 1, 
-create table foo (a int, b char(200), c int);
-0 rows inserted/updated/deleted
-ij> insert into foo values (1024,             'even', 0);
-1 row inserted/updated/deleted
-ij> insert into foo        (select foo.a - 1, 'odd' , 1 from foo);
-1 row inserted/updated/deleted
-ij> insert into foo (select foo.a - 2,   foo.b, foo.c from foo);
-2 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 4,   foo.b, foo.c from foo);
-4 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 8,   foo.b, foo.c from foo);
-8 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 16,  foo.b, foo.c from foo);
-16 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 32,  foo.b, foo.c from foo);
-32 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 64,  foo.b, foo.c from foo);
-64 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 128, foo.b, foo.c from foo);
-128 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 256, foo.b, foo.c from foo);
-256 rows inserted/updated/deleted
-ij> insert into foo (select foo.a - 512, foo.b, foo.c from foo);
-512 rows inserted/updated/deleted
-ij> -- insert into the "holes", but different keys (even2 instead of even)
-create table foo2 (a int, b char(200), c int);
-0 rows inserted/updated/deleted
-ij> insert into foo2 (select * from foo);
-1024 rows inserted/updated/deleted
-ij> delete from foo2 where foo2.c = 1;
-512 rows inserted/updated/deleted
-ij> -- create "packed" unique index.
-create unique index a on foo (a, b);
-0 rows inserted/updated/deleted
-ij> -- delete ever other row
-delete from foo where foo.c = 0;
-512 rows inserted/updated/deleted
-ij> -- turn all the deletes into "committed deletes"
-commit;
-ij> insert into foo (select foo2.a, 'even2', foo2.c from foo2);
-512 rows inserted/updated/deleted
-ij> commit;
-ij> -- insert dups will cause error
-insert into foo (select foo2.a, 'even2', foo2.c from foo2);
-ERROR 23505: The statement was aborted because it would have caused a duplicate key value in a unique or primary key constraint or unique index identified by 'A' defined on 'FOO'.
-ij> commit;
-ij> -- a delete of the whole table also exercises the btree well.
-delete from foo;
-1024 rows inserted/updated/deleted
-ij> drop table foo;
-0 rows inserted/updated/deleted
-ij> drop table foo2;
-0 rows inserted/updated/deleted
-ij> commit;
-ij> -- another simple test of reclaim deleted row code paths.
--- this test should not reclaim rows as deletes are not committed.
-create table foo (a int, b varchar(1100), c int);
-0 rows inserted/updated/deleted
-ij> create index a on foo (a, b);
-0 rows inserted/updated/deleted
-ij> insert into foo values (1, PADSTRING('a',1100), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (2, PADSTRING('a',1100), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (3, PADSTRING('a',1100), 1);
-1 row inserted/updated/deleted
-ij> commit;
-ij> delete from foo where foo.a = 1;
-1 row inserted/updated/deleted
-ij> delete from foo where foo.a = 2;
-1 row inserted/updated/deleted
-ij> insert into foo values (-1, PADSTRING('ab',1100), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (-2, PADSTRING('ab',1100), 1);
-1 row inserted/updated/deleted
-ij> rollback;
-ij> drop table foo;
-0 rows inserted/updated/deleted
-ij> -- another simple test of reclaim deleted row code paths.
--- this test should reclaim rows as deletes are not committed.
-create table foo (a int, b varchar(1100), c int);
-0 rows inserted/updated/deleted
-ij> create index a on foo (a, b);
-0 rows inserted/updated/deleted
-ij> insert into foo values (1, PADSTRING('a',1100), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (2, PADSTRING('a',1100), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (3, PADSTRING('a',1100), 1);
-1 row inserted/updated/deleted
-ij> commit;
-ij> delete from foo where foo.a = 1;
-1 row inserted/updated/deleted
-ij> delete from foo where foo.a = 2;
-1 row inserted/updated/deleted
-ij> commit;
-ij> insert into foo values (-1, PADSTRING('ab',1100), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (-2, PADSTRING('ab',1100), 1);
-1 row inserted/updated/deleted
-ij> rollback;
-ij> drop table foo;
-0 rows inserted/updated/deleted
-ij> -- this test will not reclaim rows because the parent xact has table level lock.
-create table foo (a int, b varchar(1100), c int);
-0 rows inserted/updated/deleted
-ij> create index a on foo (a, b);
-0 rows inserted/updated/deleted
-ij> insert into foo values (1, PADSTRING('a',1100), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (2, PADSTRING('a',1100), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (3, PADSTRING('a',1100), 1);
-1 row inserted/updated/deleted
-ij> delete from foo where foo.a = 1;
-1 row inserted/updated/deleted
-ij> insert into foo values (0, PADSTRING('a',1100), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (1, PADSTRING('a',1100), 1);
-1 row inserted/updated/deleted
-ij> rollback;
-ij> drop table foo;
-0 rows inserted/updated/deleted
-ij> -- test case for track 2778
---    Make sure that an update which causes a row to go from a non long row
---    to a long row can be aborted correctly.  Prior to this fix the columns
---    moving off the page would be corrupted.
--- create a base table that contains 2 rows, 19 columns, that leaves just
--- 1 byte free on the page.  freeSpace: 1, spareSpace: 10, PageSize: 2048
-drop table t2778;
-ERROR 42Y55: 'DROP TABLE' cannot be performed on 'T2778' because it does not exist.
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '2048');
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageReservedSpace', '10');
-0 rows inserted/updated/deleted
-ij> create table t2778 
-    (
-        col00 char(2),
-        col01 char(1),
-        col02 char(99),
-        col03 char(11),
-        col04 char(7),
-        col05 char(11),
-        col06 char(6),
-        col07 char(6),
-        col08 char(2),
-        col09 char(6),
-        col10 varchar(1000),
-        col11 char(2),
-        col12 char(1),
-        col13 char(7),
-        col14 char(24),
-        col15 char(1),
-        col16 char(166),
-        col17 char(207),
-        col18 char(2)
-    );
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageReservedSpace', NULL);
-0 rows inserted/updated/deleted
-ij> create unique index a_idx on t2778 (col00);
-ERROR X0Y32: Index 'A_IDX' already exists in Schema 'APP'.
-ij> commit;
-ij> insert into t2778 values (
-        '0_',
-        '0',
-        '0_col02',
-        '0_col03',
-        '0_col04',
-        '0_col05',
-        '0_06',
-        '0_07',
-        '0_',
-        '0_09',
-        '0_col10llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll012340_col10lllllllllll',
-        '0_',
-        '0',
-        '0_col13',
-        '0_col14',
-        '0',
-        '0_col16',
-        '0_col17',
-        '0_'
-        );
-1 row inserted/updated/deleted
-ij> insert into t2778 values (
-        '1_',
-        '1',
-        '1_col02',
-        '1_col03',
-        '1_col04',
-        '1_col05',
-        '1_06',
-        '1_07',
-        '1_',
-        '1_09',
-        '1_col10llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll012340_col10lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll012340_col10lllllllllllxxxxxxxxxxxxxxxxxxx',
-        '1_',
-        '1',
-        '1_col13',
-        '1_col14',
-        '1',
-        '1_col16',
-        '1_col17',
-        '1_'
-        );
-1 row inserted/updated/deleted
-ij> commit;
-ij> select col16, col17, col18 from t2778;
-COL16                                                                                                                                                                 |COL17                                                                                                                                                                                                          |COL&
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-0_col16                                                                                                                                                               |0_col17                                                                                                                                                                                                        |0_  
-1_col16                                                                                                                                                               |1_col17                                                                                                                                                                                                        |1_  
-ij> commit;
-ij> update t2778 --derby-properties index = a_idx 
-    set col10 = 
-        '0_col10llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll012340_col10lllllllllllxxxxxx'
-    where col00 = '0_';
-ERROR 42X01: Syntax error: DERBY-PROPERTIES.
-Issue the 'help' command for general information on IJ command syntax.
-Any unrecognized commands are treated as potential SQL commands and executed directly.
-Consult your DBMS server reference documentation for details of the SQL syntax supported by your server.
-ij> rollback;
-ij> -- prior to the fix col17 and col18 would come back null.
-select col01, col02, col03, col04, col05,  col06, col07, col08, col09, col10, col11, col12, col13, col14, col15, col16, col17, col18 from t2778;
-COL&|COL02                                                                                              |COL03      |COL04  |COL05      |COL06 |COL07 |COL&|COL09 |COL10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-0   |0_col02                                                                                            |0_col03    |0_col04|0_col05    |0_06  |0_07  |0_  |0_09  |0_col10llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll012340_col10lllllllllll                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |0_  |0   |0_col13|0_col14                 |0   |0_col16                                                                                                                                                               |0_col17                                                                                                                                                                                                        |0_  
-1   |1_col02                                                                                            |1_col03    |1_col04|1_col05    |1_06  |1_07  |1_  |1_09  |1_col10llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll012340_col10lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll012340_col10lllllllllllxxxxxxxxxxxxxxxxxxx                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |1_  |1   |1_col13|1_col14                 |1   |1_col16                                                                                                                                                               |1_col17                                                                                                                                                                                                        |1_  
-ij> commit;
-ij> -- test case for track 3149, improving max on btree optimization
-autocommit off;
-ij> create table foo (a int, b varchar(500), c int);
-0 rows inserted/updated/deleted
-ij> insert into foo values (1, PADSTRING('1',500), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (11, PADSTRING('11',500), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (12, PADSTRING('12',500), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (13, PADSTRING('13',500), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (14, PADSTRING('14',500), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (15, PADSTRING('15',500), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (16, PADSTRING('16',500), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (17, PADSTRING('17',500), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (18, PADSTRING('18',500), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (2, PADSTRING('2',500), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (3, PADSTRING('3',500), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (4, PADSTRING('4',500), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (5, PADSTRING('5',500), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (6, PADSTRING('6',500), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (7, PADSTRING('7',500), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (8, PADSTRING('8',500), 1);
-1 row inserted/updated/deleted
-ij> insert into foo values (9, PADSTRING('9',500), 1);
-1 row inserted/updated/deleted
-ij> create index foox on foo (b);
-0 rows inserted/updated/deleted
-ij> commit;
-ij> -- normal max optimization, last row in index is not deleted.
-select max(b) from foo;
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-9                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
-ij> -- new max optimization, last row in index is deleted but others on page aren't.
-delete from foo where a = 9;
-1 row inserted/updated/deleted
-ij> select max(b) from foo;
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-8                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
-ij> -- new max optimization, last row in index is deleted but others on page aren't.
-delete from foo where a = 8;
-1 row inserted/updated/deleted
-ij> select max(b) from foo;
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
-ij> -- max optimization does not work - fail over to scan, all rows on last page are
--- deleted.
-delete from foo where a > 2;
-13 rows inserted/updated/deleted
-ij> select max(b) from foo;
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
-ij> commit;
-ij> drop table foo;
-0 rows inserted/updated/deleted
-ij> ------------------------------------------------------------------------
--- regression test for bugs 3368, 3370
--- the bugs arose for the edge case where pageReservedSpace = 100
--- before bug 3368 was fixed, a short row insert caused 2 pages to be
--- allocated per short row insert.
-drop table a;
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageReservedSpace', '100');
-0 rows inserted/updated/deleted
-ij> create table a (a int);
-0 rows inserted/updated/deleted
-ij> call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageReservedSpace', NULL);
-0 rows inserted/updated/deleted
-ij> insert into a values (1);
-1 row inserted/updated/deleted
-ij> select numallocatedpages from new org.apache.derby.diag.SpaceTable('A') as a;
-NUMALLOCATEDPAGES   
---------------------
-2                   
-ij> insert into a values (2);
-1 row inserted/updated/deleted
-ij> select numallocatedpages from new org.apache.derby.diag.SpaceTable('A') as a;
-NUMALLOCATEDPAGES   
---------------------
-3                   
-ij> insert into a values (1);
-1 row inserted/updated/deleted
-ij> select numallocatedpages from new org.apache.derby.diag.SpaceTable('A') as a;
-NUMALLOCATEDPAGES   
---------------------
-4                   
-ij> insert into a values (2);
-1 row inserted/updated/deleted
-ij> select numallocatedpages from new org.apache.derby.diag.SpaceTable('A') as a;
-NUMALLOCATEDPAGES   
---------------------
-5                   
-ij> ------------------------------------------------------------------------
--- regression test for bug 4595, make sure index used in unique key update
--- even if table has zero rows.
---
-call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1);
-0 rows inserted/updated/deleted
-ij> maximumdisplaywidth 9000;
-ij> -- try delete/update statement compiled against table with 0 rows
-drop table foo;
-ERROR 42Y55: 'DROP TABLE' cannot be performed on 'FOO' because it does not exist.
-ij> create table foo (a int, b int);
-0 rows inserted/updated/deleted
-ij> create unique index foox on foo (a);
-0 rows inserted/updated/deleted
-ij> -- delete against table with 0 rows.
-delete from foo where a = 1;
-0 rows inserted/updated/deleted
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- delete against table with 0 rows.
-delete from foo where a = 1
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Delete ResultSet using row locking:
-deferred: false
-Rows deleted = 0
-Indexes updated = 1
-Execute Time = 0
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 0
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Project-Restrict ResultSet (1):
-		Number of opens = 1
-		Rows seen = 0
-		Rows filtered = 0
-		restriction = false
-		projection = true
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			restriction time (milliseconds) = 0
-			projection time (milliseconds) = 0
-		Source result set:
-			Index Scan ResultSet for FOO using index FOOX at serializable isolation level using exclusive row locking chosen by the optimizer
-			Number of opens = 1
-			Rows seen = 0
-			Rows filtered = 0
-			Fetch Size = 1
-				constructor time (milliseconds) = 0
-				open time (milliseconds) = 0
-				next time (milliseconds) = 0
-				close time (milliseconds) = 0
-			scan information:
-				Bit set of columns fetched={0, 1}
-				Number of columns fetched=2
-				Number of deleted rows visited=0
-				Number of pages visited=1
-				Number of rows qualified=0
-				Number of rows visited=0
-				Scan type=btree
-				Tree height=1
-				start position:
-					>= on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				stop position:
-					> on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				qualifiers:
-					None
-ij> -- update against table with 0 rows.
-update foo set b = 1 where a = 2;
-0 rows inserted/updated/deleted
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- update against table with 0 rows.
-update foo set b = 1 where a = 2
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Update ResultSet using row locking:
-deferred: false
-Rows updated = 0
-Indexes updated = 0
-Execute Time = 0
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 0
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Index Row to Base Row ResultSet for FOO:
-		Number of opens = 1
-		Rows seen = 0
-		Columns accessed from heap = {1}
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			Index Scan ResultSet for FOO using index FOOX at serializable isolation level using exclusive row locking chosen by the optimizer
-			Number of opens = 1
-			Rows seen = 0
-			Rows filtered = 0
-			Fetch Size = 1
-				constructor time (milliseconds) = 0
-				open time (milliseconds) = 0
-				next time (milliseconds) = 0
-				close time (milliseconds) = 0
-			scan information:
-				Bit set of columns fetched=All
-				Number of columns fetched=2
-				Number of deleted rows visited=0
-				Number of pages visited=1
-				Number of rows qualified=0
-				Number of rows visited=0
-				Scan type=btree
-				Tree height=1
-				start position:
-					>= on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				stop position:
-					> on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				qualifiers:
-					None
-ij> -- select against table with 0 rows.
-select * from foo where a = 2;
-A          |B          
------------------------
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- select against table with 0 rows.
-select * from foo where a = 2
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Index Row to Base Row ResultSet for FOO:
-Number of opens = 1
-Rows seen = 0
-Columns accessed from heap = {1}
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	Index Scan ResultSet for FOO using index FOOX at serializable isolation level using share row locking chosen by the optimizer
-	Number of opens = 1
-	Rows seen = 0
-	Rows filtered = 0
-	Fetch Size = 1
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-	scan information:
-		Bit set of columns fetched=All
-		Number of columns fetched=2
-		Number of deleted rows visited=0
-		Number of pages visited=1
-		Number of rows qualified=0
-		Number of rows visited=0
-		Scan type=btree
-		Tree height=1
-		start position:
-			>= on first 1 column(s).
-			Ordered null semantics on the following columns: 
-		stop position:
-			> on first 1 column(s).
-			Ordered null semantics on the following columns: 
-		qualifiers:
-			None
-ij> -- select against table with 0 rows.
-select a from foo where a = 2;
-A          
------------
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- select against table with 0 rows.
-select a from foo where a = 2
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Index Scan ResultSet for FOO using index FOOX at serializable isolation level using share row locking chosen by the optimizer
-Number of opens = 1
-Rows seen = 0
-Rows filtered = 0
-Fetch Size = 1
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-scan information:
-	Bit set of columns fetched={0}
-	Number of columns fetched=1
-	Number of deleted rows visited=0
-	Number of pages visited=1
-	Number of rows qualified=0
-	Number of rows visited=0
-	Scan type=btree
-	Tree height=1
-	start position:
-		>= on first 1 column(s).
-		Ordered null semantics on the following columns: 
-	stop position:
-		> on first 1 column(s).
-		Ordered null semantics on the following columns: 
-	qualifiers:
-		None
-ij> -- select against table with 0 rows.
-select a from foo where a = 2;
-A          
------------
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- select against table with 0 rows.
-select a from foo where a = 2
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Index Scan ResultSet for FOO using index FOOX at serializable isolation level using share row locking chosen by the optimizer
-Number of opens = 1
-Rows seen = 0
-Rows filtered = 0
-Fetch Size = 1
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-scan information:
-	Bit set of columns fetched={0}
-	Number of columns fetched=1
-	Number of deleted rows visited=0
-	Number of pages visited=1
-	Number of rows qualified=0
-	Number of rows visited=0
-	Scan type=btree
-	Tree height=1
-	start position:
-		>= on first 1 column(s).
-		Ordered null semantics on the following columns: 
-	stop position:
-		> on first 1 column(s).
-		Ordered null semantics on the following columns: 
-	qualifiers:
-		None
-ij> -- now insert one row and make sure still same plan.  Previous to 4595 
--- 0 row plan was a table scan and it would not change when 1 row was inserted.
-insert into foo values (1, 1);
-1 row inserted/updated/deleted
-ij> -- update against table with 1 row.
-update foo set b = 2 where a = 1;
-1 row inserted/updated/deleted
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- update against table with 1 row.
-update foo set b = 2 where a = 1
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Update ResultSet using row locking:
-deferred: false
-Rows updated = 1
-Indexes updated = 0
-Execute Time = 0
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Index Row to Base Row ResultSet for FOO:
-		Number of opens = 1
-		Rows seen = 1
-		Columns accessed from heap = {1}
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			Index Scan ResultSet for FOO using index FOOX at serializable isolation level using exclusive row locking chosen by the optimizer
-			Number of opens = 1
-			Rows seen = 1
-			Rows filtered = 0
-			Fetch Size = 1
-				constructor time (milliseconds) = 0
-				open time (milliseconds) = 0
-				next time (milliseconds) = 0
-				close time (milliseconds) = 0
-				next time in milliseconds/row = 0
-			scan information:
-				Bit set of columns fetched=All
-				Number of columns fetched=2
-				Number of deleted rows visited=0
-				Number of pages visited=1
-				Number of rows qualified=1
-				Number of rows visited=1
-				Scan type=btree
-				Tree height=1
-				start position:
-					>= on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				stop position:
-					> on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				qualifiers:
-					None
-ij> -- delete against table with 1 row.
-delete from foo where a = 1;
-1 row inserted/updated/deleted
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- delete against table with 1 row.
-delete from foo where a = 1
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Delete ResultSet using row locking:
-deferred: false
-Rows deleted = 1
-Indexes updated = 1
-Execute Time = 0
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Project-Restrict ResultSet (1):
-		Number of opens = 1
-		Rows seen = 1
-		Rows filtered = 0
-		restriction = false
-		projection = true
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			restriction time (milliseconds) = 0
-			projection time (milliseconds) = 0
-		Source result set:
-			Index Scan ResultSet for FOO using index FOOX at serializable isolation level using exclusive row locking chosen by the optimizer
-			Number of opens = 1
-			Rows seen = 1
-			Rows filtered = 0
-			Fetch Size = 1
-				constructor time (milliseconds) = 0
-				open time (milliseconds) = 0
-				next time (milliseconds) = 0
-				close time (milliseconds) = 0
-				next time in milliseconds/row = 0
-			scan information:
-				Bit set of columns fetched={0, 1}
-				Number of columns fetched=2
-				Number of deleted rows visited=0
-				Number of pages visited=1
-				Number of rows qualified=1
-				Number of rows visited=1
-				Scan type=btree
-				Tree height=1
-				start position:
-					>= on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				stop position:
-					> on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				qualifiers:
-					None
-ij> -- try delete/update statement compiled against table with 1 row.
-drop table foo;
-0 rows inserted/updated/deleted
-ij> create table foo (a int, b int);
-0 rows inserted/updated/deleted
-ij> insert into foo values (1, 1);
-1 row inserted/updated/deleted
-ij> create unique index foox on foo (a);
-0 rows inserted/updated/deleted
-ij> -- update against table with 1 row.
-update foo set b = 2 where a = 1;
-1 row inserted/updated/deleted
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- update against table with 1 row.
-update foo set b = 2 where a = 1
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Update ResultSet using row locking:
-deferred: false
-Rows updated = 1
-Indexes updated = 0
-Execute Time = 0
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Index Row to Base Row ResultSet for FOO:
-		Number of opens = 1
-		Rows seen = 1
-		Columns accessed from heap = {1}
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			Index Scan ResultSet for FOO using index FOOX at serializable isolation level using exclusive row locking chosen by the optimizer
-			Number of opens = 1
-			Rows seen = 1
-			Rows filtered = 0
-			Fetch Size = 1
-				constructor time (milliseconds) = 0
-				open time (milliseconds) = 0
-				next time (milliseconds) = 0
-				close time (milliseconds) = 0
-				next time in milliseconds/row = 0
-			scan information:
-				Bit set of columns fetched=All
-				Number of columns fetched=2
-				Number of deleted rows visited=0
-				Number of pages visited=1
-				Number of rows qualified=1
-				Number of rows visited=1
-				Scan type=btree
-				Tree height=1
-				start position:
-					>= on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				stop position:
-					> on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				qualifiers:
-					None
-ij> -- delete against table with 1 row.
-delete from foo where a = 1;
-1 row inserted/updated/deleted
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- delete against table with 1 row.
-delete from foo where a = 1
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Delete ResultSet using row locking:
-deferred: false
-Rows deleted = 1
-Indexes updated = 1
-Execute Time = 0
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Project-Restrict ResultSet (1):
-		Number of opens = 1
-		Rows seen = 1
-		Rows filtered = 0
-		restriction = false
-		projection = true
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			restriction time (milliseconds) = 0
-			projection time (milliseconds) = 0
-		Source result set:
-			Index Scan ResultSet for FOO using index FOOX at serializable isolation level using exclusive row locking chosen by the optimizer
-			Number of opens = 1
-			Rows seen = 1
-			Rows filtered = 0
-			Fetch Size = 1
-				constructor time (milliseconds) = 0
-				open time (milliseconds) = 0
-				next time (milliseconds) = 0
-				close time (milliseconds) = 0
-				next time in milliseconds/row = 0
-			scan information:
-				Bit set of columns fetched={0, 1}
-				Number of columns fetched=2
-				Number of deleted rows visited=0
-				Number of pages visited=1
-				Number of rows qualified=1
-				Number of rows visited=1
-				Scan type=btree
-				Tree height=1
-				start position:
-					>= on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				stop position:
-					> on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				qualifiers:
-					None
-ij> -- repeat set of 4595 tests against table with primary key, vs. unique index - 
--- there should be no difference in plan shape.
--- try delete/update statement compiled against table with 0 rows
-drop table foo;
-0 rows inserted/updated/deleted
-ij> create table foo (a int not null primary key, b int);
-0 rows inserted/updated/deleted
-ij> -- delete against table with 0 rows.
-delete from foo where a = 1;
-0 rows inserted/updated/deleted
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- delete against table with 0 rows.
-delete from foo where a = 1
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Delete ResultSet using row locking:
-deferred: false
-Rows deleted = 0
-Indexes updated = 1
-Execute Time = 0
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 0
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Project-Restrict ResultSet (1):
-		Number of opens = 1
-		Rows seen = 0
-		Rows filtered = 0
-		restriction = false
-		projection = true
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			restriction time (milliseconds) = 0
-			projection time (milliseconds) = 0
-		Source result set:
-			Index Scan ResultSet for FOO using constraint xxxxGENERATED-IDxxxx at serializable isolation level using exclusive row locking chosen by the optimizer
-			Number of opens = 1
-			Rows seen = 0
-			Rows filtered = 0
-			Fetch Size = 1
-				constructor time (milliseconds) = 0
-				open time (milliseconds) = 0
-				next time (milliseconds) = 0
-				close time (milliseconds) = 0
-			scan information:
-				Bit set of columns fetched={0, 1}
-				Number of columns fetched=2
-				Number of deleted rows visited=0
-				Number of pages visited=1
-				Number of rows qualified=0
-				Number of rows visited=0
-				Scan type=btree
-				Tree height=1
-				start position:
-					>= on first 1 column(s).
-					Ordered null semantics on the following columns: 
-					0 
-				stop position:
-					> on first 1 column(s).
-					Ordered null semantics on the following columns: 
-					0 
-				qualifiers:
-					None
-ij> -- update against table with 0 rows.
-update foo set b = 1 where a = 2;
-0 rows inserted/updated/deleted
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- update against table with 0 rows.
-update foo set b = 1 where a = 2
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Update ResultSet using row locking:
-deferred: false
-Rows updated = 0
-Indexes updated = 0
-Execute Time = 0
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 0
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Index Row to Base Row ResultSet for FOO:
-		Number of opens = 1
-		Rows seen = 0
-		Columns accessed from heap = {1}
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			Index Scan ResultSet for FOO using constraint xxxxGENERATED-IDxxxx at serializable isolation level using exclusive row locking chosen by the optimizer
-			Number of opens = 1
-			Rows seen = 0
-			Rows filtered = 0
-			Fetch Size = 1
-				constructor time (milliseconds) = 0
-				open time (milliseconds) = 0
-				next time (milliseconds) = 0
-				close time (milliseconds) = 0
-			scan information:
-				Bit set of columns fetched=All
-				Number of columns fetched=2
-				Number of deleted rows visited=0
-				Number of pages visited=1
-				Number of rows qualified=0
-				Number of rows visited=0
-				Scan type=btree
-				Tree height=1
-				start position:
-					>= on first 1 column(s).
-					Ordered null semantics on the following columns: 
-					0 
-				stop position:
-					> on first 1 column(s).
-					Ordered null semantics on the following columns: 
-					0 
-				qualifiers:
-					None
-ij> -- select against table with 0 rows.
-select * from foo where a = 2;
-A          |B          
------------------------
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- select against table with 0 rows.
-select * from foo where a = 2
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Index Row to Base Row ResultSet for FOO:
-Number of opens = 1
-Rows seen = 0
-Columns accessed from heap = {1}
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	Index Scan ResultSet for FOO using constraint xxxxGENERATED-IDxxxx at serializable isolation level using share row locking chosen by the optimizer
-	Number of opens = 1
-	Rows seen = 0
-	Rows filtered = 0
-	Fetch Size = 1
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-	scan information:
-		Bit set of columns fetched=All
-		Number of columns fetched=2
-		Number of deleted rows visited=0
-		Number of pages visited=1
-		Number of rows qualified=0
-		Number of rows visited=0
-		Scan type=btree
-		Tree height=1
-		start position:
-			>= on first 1 column(s).
-			Ordered null semantics on the following columns: 
-			0 
-		stop position:
-			> on first 1 column(s).
-			Ordered null semantics on the following columns: 
-			0 
-		qualifiers:
-			None
-ij> -- select against table with 0 rows.
-select a from foo where a = 2;
-A          
------------
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- select against table with 0 rows.
-select a from foo where a = 2
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Index Scan ResultSet for FOO using constraint xxxxGENERATED-IDxxxx at serializable isolation level using share row locking chosen by the optimizer
-Number of opens = 1
-Rows seen = 0
-Rows filtered = 0
-Fetch Size = 1
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-scan information:
-	Bit set of columns fetched={0}
-	Number of columns fetched=1
-	Number of deleted rows visited=0
-	Number of pages visited=1
-	Number of rows qualified=0
-	Number of rows visited=0
-	Scan type=btree
-	Tree height=1
-	start position:
-		>= on first 1 column(s).
-		Ordered null semantics on the following columns: 
-		0 
-	stop position:
-		> on first 1 column(s).
-		Ordered null semantics on the following columns: 
-		0 
-	qualifiers:
-		None
-ij> -- select against table with 0 rows.
-select a from foo where a = 2;
-A          
------------
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- select against table with 0 rows.
-select a from foo where a = 2
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Index Scan ResultSet for FOO using constraint xxxxGENERATED-IDxxxx at serializable isolation level using share row locking chosen by the optimizer
-Number of opens = 1
-Rows seen = 0
-Rows filtered = 0
-Fetch Size = 1
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-scan information:
-	Bit set of columns fetched={0}
-	Number of columns fetched=1
-	Number of deleted rows visited=0
-	Number of pages visited=1
-	Number of rows qualified=0
-	Number of rows visited=0
-	Scan type=btree
-	Tree height=1
-	start position:
-		>= on first 1 column(s).
-		Ordered null semantics on the following columns: 
-		0 
-	stop position:
-		> on first 1 column(s).
-		Ordered null semantics on the following columns: 
-		0 
-	qualifiers:
-		None
-ij> -- now insert one row and make sure still same plan.  Previous to 4595 
--- 0 row plan was a table scan and it would not change when 1 row was inserted.
-insert into foo values (1, 1);
-1 row inserted/updated/deleted
-ij> -- update against table with 1 row.
-update foo set b = 2 where a = 1;
-1 row inserted/updated/deleted
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- update against table with 1 row.
-update foo set b = 2 where a = 1
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Update ResultSet using row locking:
-deferred: false
-Rows updated = 1
-Indexes updated = 0
-Execute Time = 0
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Index Row to Base Row ResultSet for FOO:
-		Number of opens = 1
-		Rows seen = 1
-		Columns accessed from heap = {1}
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			Index Scan ResultSet for FOO using constraint xxxxGENERATED-IDxxxx at serializable isolation level using exclusive row locking chosen by the optimizer
-			Number of opens = 1
-			Rows seen = 1
-			Rows filtered = 0
-			Fetch Size = 1
-				constructor time (milliseconds) = 0
-				open time (milliseconds) = 0
-				next time (milliseconds) = 0
-				close time (milliseconds) = 0
-				next time in milliseconds/row = 0
-			scan information:
-				Bit set of columns fetched=All
-				Number of columns fetched=2
-				Number of deleted rows visited=0
-				Number of pages visited=1
-				Number of rows qualified=1
-				Number of rows visited=1
-				Scan type=btree
-				Tree height=1
-				start position:
-					>= on first 1 column(s).
-					Ordered null semantics on the following columns: 
-					0 
-				stop position:
-					> on first 1 column(s).
-					Ordered null semantics on the following columns: 
-					0 
-				qualifiers:
-					None
-ij> -- delete against table with 1 row.
-delete from foo where a = 1;
-1 row inserted/updated/deleted
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- delete against table with 1 row.
-delete from foo where a = 1
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Delete ResultSet using row locking:
-deferred: false
-Rows deleted = 1
-Indexes updated = 1
-Execute Time = 0
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Project-Restrict ResultSet (1):
-		Number of opens = 1
-		Rows seen = 1
-		Rows filtered = 0
-		restriction = false
-		projection = true
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			restriction time (milliseconds) = 0
-			projection time (milliseconds) = 0
-		Source result set:
-			Index Scan ResultSet for FOO using constraint xxxxGENERATED-IDxxxx at serializable isolation level using exclusive row locking chosen by the optimizer
-			Number of opens = 1
-			Rows seen = 1
-			Rows filtered = 0
-			Fetch Size = 1
-				constructor time (milliseconds) = 0
-				open time (milliseconds) = 0
-				next time (milliseconds) = 0
-				close time (milliseconds) = 0
-				next time in milliseconds/row = 0
-			scan information:
-				Bit set of columns fetched={0, 1}
-				Number of columns fetched=2
-				Number of deleted rows visited=0
-				Number of pages visited=1
-				Number of rows qualified=1
-				Number of rows visited=1
-				Scan type=btree
-				Tree height=1
-				start position:
-					>= on first 1 column(s).
-					Ordered null semantics on the following columns: 
-					0 
-				stop position:
-					> on first 1 column(s).
-					Ordered null semantics on the following columns: 
-					0 
-				qualifiers:
-					None
-ij> -- try delete/update statement compiled against table with 1 row.
-drop table foo;
-0 rows inserted/updated/deleted
-ij> create table foo (a int not null primary key, b int);
-0 rows inserted/updated/deleted
-ij> insert into foo values (1, 1);
-1 row inserted/updated/deleted
-ij> -- update against table with 1 row.
-update foo set b = 2 where a = 1;
-1 row inserted/updated/deleted
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- update against table with 1 row.
-update foo set b = 2 where a = 1
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Update ResultSet using row locking:
-deferred: false
-Rows updated = 1
-Indexes updated = 0
-Execute Time = 0
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Index Row to Base Row ResultSet for FOO:
-		Number of opens = 1
-		Rows seen = 1
-		Columns accessed from heap = {1}
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			Index Scan ResultSet for FOO using constraint xxxxGENERATED-IDxxxx at serializable isolation level using exclusive row locking chosen by the optimizer
-			Number of opens = 1
-			Rows seen = 1
-			Rows filtered = 0
-			Fetch Size = 1
-				constructor time (milliseconds) = 0
-				open time (milliseconds) = 0
-				next time (milliseconds) = 0
-				close time (milliseconds) = 0
-				next time in milliseconds/row = 0
-			scan information:
-				Bit set of columns fetched=All
-				Number of columns fetched=2
-				Number of deleted rows visited=0
-				Number of pages visited=1
-				Number of rows qualified=1
-				Number of rows visited=1
-				Scan type=btree
-				Tree height=1
-				start position:
-					>= on first 1 column(s).
-					Ordered null semantics on the following columns: 
-					0 
-				stop position:
-					> on first 1 column(s).
-					Ordered null semantics on the following columns: 
-					0 
-				qualifiers:
-					None
-ij> -- delete against table with 1 row.
-delete from foo where a = 1;
-1 row inserted/updated/deleted
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- delete against table with 1 row.
-delete from foo where a = 1
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Delete ResultSet using row locking:
-deferred: false
-Rows deleted = 1
-Indexes updated = 1
-Execute Time = 0
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Project-Restrict ResultSet (1):
-		Number of opens = 1
-		Rows seen = 1
-		Rows filtered = 0
-		restriction = false
-		projection = true
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			restriction time (milliseconds) = 0
-			projection time (milliseconds) = 0
-		Source result set:
-			Index Scan ResultSet for FOO using constraint xxxxGENERATED-IDxxxx at serializable isolation level using exclusive row locking chosen by the optimizer
-			Number of opens = 1
-			Rows seen = 1
-			Rows filtered = 0
-			Fetch Size = 1
-				constructor time (milliseconds) = 0
-				open time (milliseconds) = 0
-				next time (milliseconds) = 0
-				close time (milliseconds) = 0
-				next time in milliseconds/row = 0
-			scan information:
-				Bit set of columns fetched={0, 1}
-				Number of columns fetched=2
-				Number of deleted rows visited=0
-				Number of pages visited=1
-				Number of rows qualified=1
-				Number of rows visited=1
-				Scan type=btree
-				Tree height=1
-				start position:
-					>= on first 1 column(s).
-					Ordered null semantics on the following columns: 
-					0 
-				stop position:
-					> on first 1 column(s).
-					Ordered null semantics on the following columns: 
-					0 
-				qualifiers:
-					None
-ij> -- select against table with 1 row.
-select * from foo where a = 2;
-A          |B          
------------------------
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- select against table with 1 row.
-select * from foo where a = 2
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Index Row to Base Row ResultSet for FOO:
-Number of opens = 1
-Rows seen = 0
-Columns accessed from heap = {1}
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	Index Scan ResultSet for FOO using constraint xxxxGENERATED-IDxxxx at serializable isolation level using share row locking chosen by the optimizer
-	Number of opens = 1
-	Rows seen = 0
-	Rows filtered = 0
-	Fetch Size = 1
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-	scan information:
-		Bit set of columns fetched=All
-		Number of columns fetched=2
-		Number of deleted rows visited=0
-		Number of pages visited=1
-		Number of rows qualified=0
-		Number of rows visited=0
-		Scan type=btree
-		Tree height=1
-		start position:
-			>= on first 1 column(s).
-			Ordered null semantics on the following columns: 
-			0 
-		stop position:
-			> on first 1 column(s).
-			Ordered null semantics on the following columns: 
-			0 
-		qualifiers:
-			None
-ij> -- select against table with 1 row.
-select a from foo where a = 2;
-A          
------------
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- select against table with 1 row.
-select a from foo where a = 2
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Index Scan ResultSet for FOO using constraint xxxxGENERATED-IDxxxx at serializable isolation level using share row locking chosen by the optimizer
-Number of opens = 1
-Rows seen = 0
-Rows filtered = 0
-Fetch Size = 1
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-scan information:
-	Bit set of columns fetched={0}
-	Number of columns fetched=1
-	Number of deleted rows visited=0
-	Number of pages visited=1
-	Number of rows qualified=0
-	Number of rows visited=0
-	Scan type=btree
-	Tree height=1
-	start position:
-		>= on first 1 column(s).
-		Ordered null semantics on the following columns: 
-		0 
-	stop position:
-		> on first 1 column(s).
-		Ordered null semantics on the following columns: 
-		0 
-	qualifiers:
-		None
-ij> -- select against table with 1 row.
-select a from foo where a = 2;
-A          
------------
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- select against table with 1 row.
-select a from foo where a = 2
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Index Scan ResultSet for FOO using constraint xxxxGENERATED-IDxxxx at serializable isolation level using share row locking chosen by the optimizer
-Number of opens = 1
-Rows seen = 0
-Rows filtered = 0
-Fetch Size = 1
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-scan information:
-	Bit set of columns fetched={0}
-	Number of columns fetched=1
-	Number of deleted rows visited=0
-	Number of pages visited=1
-	Number of rows qualified=0
-	Number of rows visited=0
-	Scan type=btree
-	Tree height=1
-	start position:
-		>= on first 1 column(s).
-		Ordered null semantics on the following columns: 
-		0 
-	stop position:
-		> on first 1 column(s).
-		Ordered null semantics on the following columns: 
-		0 
-	qualifiers:
-		None
-ij> -- repeat set of 4595 tests against table with non-unique index with no
--- statistics.
--- there should be no difference in plan shape.
--- try delete/update statement compiled against table with 0 rows
-drop table foo;
-0 rows inserted/updated/deleted
-ij> create table foo (a int, b int);
-0 rows inserted/updated/deleted
-ij> create index foox on foo (a);
-0 rows inserted/updated/deleted
-ij> -- delete against table with 0 rows.
-delete from foo where a = 1;
-0 rows inserted/updated/deleted
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- delete against table with 0 rows.
-delete from foo where a = 1
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Delete ResultSet using row locking:
-deferred: false
-Rows deleted = 0
-Indexes updated = 1
-Execute Time = 0
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 0
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Project-Restrict ResultSet (1):
-		Number of opens = 1
-		Rows seen = 0
-		Rows filtered = 0
-		restriction = false
-		projection = true
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			restriction time (milliseconds) = 0
-			projection time (milliseconds) = 0
-		Source result set:
-			Index Scan ResultSet for FOO using index FOOX at serializable isolation level using exclusive row locking chosen by the optimizer
-			Number of opens = 1
-			Rows seen = 0
-			Rows filtered = 0
-			Fetch Size = 1
-				constructor time (milliseconds) = 0
-				open time (milliseconds) = 0
-				next time (milliseconds) = 0
-				close time (milliseconds) = 0
-			scan information:
-				Bit set of columns fetched={0, 1}
-				Number of columns fetched=2
-				Number of deleted rows visited=0
-				Number of pages visited=1
-				Number of rows qualified=0
-				Number of rows visited=0
-				Scan type=btree
-				Tree height=1
-				start position:
-					>= on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				stop position:
-					> on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				qualifiers:
-					None
-ij> -- update against table with 0 rows.
-update foo set b = 1 where a = 2;
-0 rows inserted/updated/deleted
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- update against table with 0 rows.
-update foo set b = 1 where a = 2
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Update ResultSet using row locking:
-deferred: false
-Rows updated = 0
-Indexes updated = 0
-Execute Time = 0
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 0
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Index Row to Base Row ResultSet for FOO:
-		Number of opens = 1
-		Rows seen = 0
-		Columns accessed from heap = {1}
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			Index Scan ResultSet for FOO using index FOOX at serializable isolation level using exclusive row locking chosen by the optimizer
-			Number of opens = 1
-			Rows seen = 0
-			Rows filtered = 0
-			Fetch Size = 1
-				constructor time (milliseconds) = 0
-				open time (milliseconds) = 0
-				next time (milliseconds) = 0
-				close time (milliseconds) = 0
-			scan information:
-				Bit set of columns fetched=All
-				Number of columns fetched=2
-				Number of deleted rows visited=0
-				Number of pages visited=1
-				Number of rows qualified=0
-				Number of rows visited=0
-				Scan type=btree
-				Tree height=1
-				start position:
-					>= on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				stop position:
-					> on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				qualifiers:
-					None
-ij> -- select against table with 0 rows.
-select * from foo where a = 2;
-A          |B          
------------------------
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- select against table with 0 rows.
-select * from foo where a = 2
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Index Row to Base Row ResultSet for FOO:
-Number of opens = 1
-Rows seen = 0
-Columns accessed from heap = {0, 1}
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	Index Scan ResultSet for FOO using index FOOX at serializable isolation level using share row locking chosen by the optimizer
-	Number of opens = 1
-	Rows seen = 0
-	Rows filtered = 0
-	Fetch Size = 16
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-	scan information:
-		Bit set of columns fetched=All
-		Number of columns fetched=2
-		Number of deleted rows visited=0
-		Number of pages visited=1
-		Number of rows qualified=0
-		Number of rows visited=0
-		Scan type=btree
-		Tree height=1
-		start position:
-			>= on first 1 column(s).
-			Ordered null semantics on the following columns: 
-		stop position:
-			> on first 1 column(s).
-			Ordered null semantics on the following columns: 
-		qualifiers:
-			None
-ij> -- select against table with 0 rows.
-select a from foo where a = 2;
-A          
------------
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- select against table with 0 rows.
-select a from foo where a = 2
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Index Scan ResultSet for FOO using index FOOX at serializable isolation level using share row locking chosen by the optimizer
-Number of opens = 1
-Rows seen = 0
-Rows filtered = 0
-Fetch Size = 16
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-scan information:
-	Bit set of columns fetched={0}
-	Number of columns fetched=1
-	Number of deleted rows visited=0
-	Number of pages visited=1
-	Number of rows qualified=0
-	Number of rows visited=0
-	Scan type=btree
-	Tree height=1
-	start position:
-		>= on first 1 column(s).
-		Ordered null semantics on the following columns: 
-	stop position:
-		> on first 1 column(s).
-		Ordered null semantics on the following columns: 
-	qualifiers:
-		None
-ij> -- select against table with 0 rows.
-select a from foo where a = 2;
-A          
------------
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- select against table with 0 rows.
-select a from foo where a = 2
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Index Scan ResultSet for FOO using index FOOX at serializable isolation level using share row locking chosen by the optimizer
-Number of opens = 1
-Rows seen = 0
-Rows filtered = 0
-Fetch Size = 16
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-scan information:
-	Bit set of columns fetched={0}
-	Number of columns fetched=1
-	Number of deleted rows visited=0
-	Number of pages visited=1
-	Number of rows qualified=0
-	Number of rows visited=0
-	Scan type=btree
-	Tree height=1
-	start position:
-		>= on first 1 column(s).
-		Ordered null semantics on the following columns: 
-	stop position:
-		> on first 1 column(s).
-		Ordered null semantics on the following columns: 
-	qualifiers:
-		None
-ij> -- now insert one row and make sure still same plan.  Previous to 4595 
--- 0 row plan was a table scan and it would not change when 1 row was inserted.
-insert into foo values (1, 1);
-1 row inserted/updated/deleted
-ij> -- update against table with 1 row.
-update foo set b = 2 where a = 1;
-1 row inserted/updated/deleted
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- update against table with 1 row.
-update foo set b = 2 where a = 1
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Update ResultSet using row locking:
-deferred: false
-Rows updated = 1
-Indexes updated = 0
-Execute Time = 0
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Index Row to Base Row ResultSet for FOO:
-		Number of opens = 1
-		Rows seen = 1
-		Columns accessed from heap = {1}
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			Index Scan ResultSet for FOO using index FOOX at serializable isolation level using exclusive row locking chosen by the optimizer
-			Number of opens = 1
-			Rows seen = 1
-			Rows filtered = 0
-			Fetch Size = 1
-				constructor time (milliseconds) = 0
-				open time (milliseconds) = 0
-				next time (milliseconds) = 0
-				close time (milliseconds) = 0
-				next time in milliseconds/row = 0
-			scan information:
-				Bit set of columns fetched=All
-				Number of columns fetched=2
-				Number of deleted rows visited=0
-				Number of pages visited=1
-				Number of rows qualified=1
-				Number of rows visited=1
-				Scan type=btree
-				Tree height=1
-				start position:
-					>= on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				stop position:
-					> on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				qualifiers:
-					None
-ij> -- delete against table with 1 row.
-delete from foo where a = 1;
-1 row inserted/updated/deleted
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- delete against table with 1 row.
-delete from foo where a = 1
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Delete ResultSet using row locking:
-deferred: false
-Rows deleted = 1
-Indexes updated = 1
-Execute Time = 0
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Project-Restrict ResultSet (1):
-		Number of opens = 1
-		Rows seen = 1
-		Rows filtered = 0
-		restriction = false
-		projection = true
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			restriction time (milliseconds) = 0
-			projection time (milliseconds) = 0
-		Source result set:
-			Index Scan ResultSet for FOO using index FOOX at serializable isolation level using exclusive row locking chosen by the optimizer
-			Number of opens = 1
-			Rows seen = 1
-			Rows filtered = 0
-			Fetch Size = 1
-				constructor time (milliseconds) = 0
-				open time (milliseconds) = 0
-				next time (milliseconds) = 0
-				close time (milliseconds) = 0
-				next time in milliseconds/row = 0
-			scan information:
-				Bit set of columns fetched={0, 1}
-				Number of columns fetched=2
-				Number of deleted rows visited=0
-				Number of pages visited=1
-				Number of rows qualified=1
-				Number of rows visited=1
-				Scan type=btree
-				Tree height=1
-				start position:
-					>= on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				stop position:
-					> on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				qualifiers:
-					None
-ij> -- try delete/update statement compiled against table with 1 row.
-drop table foo;
-0 rows inserted/updated/deleted
-ij> create table foo (a int, b int);
-0 rows inserted/updated/deleted
-ij> create index foox on foo (a);
-0 rows inserted/updated/deleted
-ij> insert into foo values (1, 1);
-1 row inserted/updated/deleted
-ij> -- update against table with 1 row.
-update foo set b = 2 where a = 1;
-1 row inserted/updated/deleted
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- update against table with 1 row.
-update foo set b = 2 where a = 1
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Update ResultSet using row locking:
-deferred: false
-Rows updated = 1
-Indexes updated = 0
-Execute Time = 0
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Index Row to Base Row ResultSet for FOO:
-		Number of opens = 1
-		Rows seen = 1
-		Columns accessed from heap = {1}
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			Index Scan ResultSet for FOO using index FOOX at serializable isolation level using exclusive row locking chosen by the optimizer
-			Number of opens = 1
-			Rows seen = 1
-			Rows filtered = 0
-			Fetch Size = 1
-				constructor time (milliseconds) = 0
-				open time (milliseconds) = 0
-				next time (milliseconds) = 0
-				close time (milliseconds) = 0
-				next time in milliseconds/row = 0
-			scan information:
-				Bit set of columns fetched=All
-				Number of columns fetched=2
-				Number of deleted rows visited=0
-				Number of pages visited=1
-				Number of rows qualified=1
-				Number of rows visited=1
-				Scan type=btree
-				Tree height=1
-				start position:
-					>= on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				stop position:
-					> on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				qualifiers:
-					None
-ij> -- delete against table with 1 row.
-delete from foo where a = 1;
-1 row inserted/updated/deleted
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- delete against table with 1 row.
-delete from foo where a = 1
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Delete ResultSet using row locking:
-deferred: false
-Rows deleted = 1
-Indexes updated = 1
-Execute Time = 0
-	Project-Restrict ResultSet (2):
-	Number of opens = 1
-	Rows seen = 1
-	Rows filtered = 0
-	restriction = false
-	projection = true
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-		restriction time (milliseconds) = 0
-		projection time (milliseconds) = 0
-	Source result set:
-		Project-Restrict ResultSet (1):
-		Number of opens = 1
-		Rows seen = 1
-		Rows filtered = 0
-		restriction = false
-		projection = true
-			constructor time (milliseconds) = 0
-			open time (milliseconds) = 0
-			next time (milliseconds) = 0
-			close time (milliseconds) = 0
-			restriction time (milliseconds) = 0
-			projection time (milliseconds) = 0
-		Source result set:
-			Index Scan ResultSet for FOO using index FOOX at serializable isolation level using exclusive row locking chosen by the optimizer
-			Number of opens = 1
-			Rows seen = 1
-			Rows filtered = 0
-			Fetch Size = 1
-				constructor time (milliseconds) = 0
-				open time (milliseconds) = 0
-				next time (milliseconds) = 0
-				close time (milliseconds) = 0
-				next time in milliseconds/row = 0
-			scan information:
-				Bit set of columns fetched={0, 1}
-				Number of columns fetched=2
-				Number of deleted rows visited=0
-				Number of pages visited=1
-				Number of rows qualified=1
-				Number of rows visited=1
-				Scan type=btree
-				Tree height=1
-				start position:
-					>= on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				stop position:
-					> on first 1 column(s).
-					Ordered null semantics on the following columns: 
-				qualifiers:
-					None
-ij> -- select against table with 1 row.
-select * from foo where a = 2;
-A          |B          
------------------------
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- select against table with 1 row.
-select * from foo where a = 2
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Index Row to Base Row ResultSet for FOO:
-Number of opens = 1
-Rows seen = 0
-Columns accessed from heap = {0, 1}
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-	Index Scan ResultSet for FOO using index FOOX at serializable isolation level using share row locking chosen by the optimizer
-	Number of opens = 1
-	Rows seen = 0
-	Rows filtered = 0
-	Fetch Size = 16
-		constructor time (milliseconds) = 0
-		open time (milliseconds) = 0
-		next time (milliseconds) = 0
-		close time (milliseconds) = 0
-	scan information:
-		Bit set of columns fetched=All
-		Number of columns fetched=2
-		Number of deleted rows visited=0
-		Number of pages visited=1
-		Number of rows qualified=0
-		Number of rows visited=0
-		Scan type=btree
-		Tree height=1
-		start position:
-			>= on first 1 column(s).
-			Ordered null semantics on the following columns: 
-		stop position:
-			> on first 1 column(s).
-			Ordered null semantics on the following columns: 
-		qualifiers:
-			None
-ij> -- select against table with 1 row.
-select a from foo where a = 2;
-A          
------------
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- select against table with 1 row.
-select a from foo where a = 2
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Index Scan ResultSet for FOO using index FOOX at serializable isolation level using share row locking chosen by the optimizer
-Number of opens = 1
-Rows seen = 0
-Rows filtered = 0
-Fetch Size = 16
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-scan information:
-	Bit set of columns fetched={0}
-	Number of columns fetched=1
-	Number of deleted rows visited=0
-	Number of pages visited=1
-	Number of rows qualified=0
-	Number of rows visited=0
-	Scan type=btree
-	Tree height=1
-	start position:
-		>= on first 1 column(s).
-		Ordered null semantics on the following columns: 
-	stop position:
-		> on first 1 column(s).
-		Ordered null semantics on the following columns: 
-	qualifiers:
-		None
-ij> -- select against table with 1 row.
-select a from foo where a = 2;
-A          
------------
-ij> values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-Statement Name: 
-	null
-Statement Text: 
-	-- select against table with 1 row.
-select a from foo where a = 2
-Parse Time: 0
-Bind Time: 0
-Optimize Time: 0
-Generate Time: 0
-Compile Time: 0
-Execute Time: 0
-Begin Compilation Timestamp : null
-End Compilation Timestamp : null
-Begin Execution Timestamp : null
-End Execution Timestamp : null
-Statement Execution Plan Text: 
-Index Scan ResultSet for FOO using index FOOX at serializable isolation level using share row locking chosen by the optimizer
-Number of opens = 1
-Rows seen = 0
-Rows filtered = 0
-Fetch Size = 16
-	constructor time (milliseconds) = 0
-	open time (milliseconds) = 0
-	next time (milliseconds) = 0
-	close time (milliseconds) = 0
-scan information:
-	Bit set of columns fetched={0}
-	Number of columns fetched=1
-	Number of deleted rows visited=0
-	Number of pages visited=1
-	Number of rows qualified=0
-	Number of rows visited=0
-	Scan type=btree
-	Tree height=1
-	start position:
-		>= on first 1 column(s).
-		Ordered null semantics on the following columns: 
-	stop position:
-		> on first 1 column(s).
-		Ordered null semantics on the following columns: 
-	qualifiers:
-		None
-ij> ------------------------------------------------------------------------
--- simple regression test for qualifier work.
-------------------------------------------------------------------------
-drop table foo;
-0 rows inserted/updated/deleted
-ij> commit;
-ij> create table foo (a int, b int, c int);
-0 rows inserted/updated/deleted
-ij> insert into foo values (1, 10, 100);
-1 row inserted/updated/deleted
-ij> insert into foo values (2, 20, 200);
-1 row inserted/updated/deleted
-ij> insert into foo values (3, 30, 300);
-1 row inserted/updated/deleted
-ij> -- should return no rows
-select a, b, c from foo where a = 1 and b = 20;
-A          |B          |C          
------------------------------------
-ij> -- should return one row
-select a, b, c from foo where a = 3 and b = 30;
-A          |B          |C          
------------------------------------
-3          |30         |300        
-ij> select a, b, c from foo where a = 3 or c = 40;
-A          |B          |C          
------------------------------------
-3          |30         |300        
-ij> -- should return 2 rows
-select a, b, c from foo where a = 1 or b = 20;
-A          |B          |C          
------------------------------------
-1          |10         |100        
-2          |20         |200        
-ij> select a, b, c from foo where a = 1 or a = 3;
-A          |B          |C          
------------------------------------
-1          |10         |100        
-3          |30         |300        
-ij> DROP FUNCTION PADSTRING;
-0 rows inserted/updated/deleted
-ij> DROP PROCEDURE WAIT_FOR_POST_COMMIT;
-0 rows inserted/updated/deleted
-ij> exit;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/suites/EncryptionSuite.java b/java/testing/org/apache/derbyTesting/functionTests/suites/EncryptionSuite.java
index 26269707f..9cf3e5e42 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/suites/EncryptionSuite.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/suites/EncryptionSuite.java
@@ -20,8 +20,12 @@
  */
 package org.apache.derbyTesting.functionTests.suites;
 
+import java.sql.Connection;
 import java.sql.SQLException;
+import java.sql.Statement;
+import java.util.Properties;
 
+import org.apache.derbyTesting.functionTests.tests.store.AccessTest;
 import org.apache.derbyTesting.junit.BaseJDBCTestCase;
 import org.apache.derbyTesting.junit.Decorator;
 import org.apache.derbyTesting.junit.JDBC;
@@ -98,9 +102,44 @@ public final class EncryptionSuite extends BaseJDBCTestCase {
         // no tests that were previously run under encryption converted.
         suite.addTestSuite(EncryptionSuite.class);
         
+        Properties sysProps = new Properties();
+        sysProps.put("derby.optimizer.optimizeJoinOrder", "false");
+        sysProps.put("derby.optimizer.ruleBasedOptimization", "true");
+        sysProps.put("derby.optimizer.noTimeout", "true");
+        
+        suite.addTestSuite(AccessTest.class);
+        
         return suite;
     }
     
+    protected void setUp() {
+        
+        try { 
+                Connection conn = getConnection();
+                Statement s = createStatement();
+
+                s.execute("CREATE FUNCTION  PADSTRING (DATA VARCHAR(32000), "
+                        + "LENGTH INTEGER) RETURNS VARCHAR(32000) EXTERNAL NAME " +
+                        "'org.apache.derbyTesting.functionTests.util.Formatters" +
+                ".padString' LANGUAGE JAVA PARAMETER STYLE JAVA");
+                s.close();
+                conn.close();
+
+        } catch (SQLException se) {
+            // ignore
+        }
+    }
+    
+    public void tearDown() throws Exception {
+        Statement st = createStatement();
+        super.tearDown();
+        try {
+            st.executeUpdate("DROP FUNCTION PADSTRING");
+        } catch (SQLException e) {
+            // never mind.
+        }
+    }
+    
     /**
      * Very simple test that ensures we can get a connection to
      * the booted encrypted database.
@@ -110,4 +149,6 @@ public final class EncryptionSuite extends BaseJDBCTestCase {
     {
         getConnection().close();
     }
+    
+    
 }
diff --git a/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionAES.runall b/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionAES.runall
index 34699a789..b17f0ad2f 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionAES.runall
+++ b/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionAES.runall
@@ -1,2 +1 @@
 store/encryptDatabase.sql
-store/access.sql
diff --git a/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionBlowfish.runall b/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionBlowfish.runall
index f4fcae9b0..551d958c4 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionBlowfish.runall
+++ b/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionBlowfish.runall
@@ -1,3 +1,2 @@
 unit/T_CipherBlowfish.unit
 store/encryptDatabase.sql
-store/access.sql
diff --git a/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionCFB.runall b/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionCFB.runall
index b6d53d7c6..8af76afd0 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionCFB.runall
+++ b/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionCFB.runall
@@ -1,3 +1,2 @@
 unit/T_CipherCFB.unit
 store/encryptDatabase.sql
-store/access.sql
diff --git a/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionDES.runall b/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionDES.runall
index d99ae214d..c953ec0c2 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionDES.runall
+++ b/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionDES.runall
@@ -1,3 +1,2 @@
 unit/T_CipherDES.unit
 store/encryptDatabase.sql
-store/access.sql
diff --git a/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionECB.runall b/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionECB.runall
index 7bce79fe5..ccbd44223 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionECB.runall
+++ b/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionECB.runall
@@ -1,3 +1,2 @@
 unit/T_CipherECB.unit
 store/encryptDatabase.sql
-store/access.sql
diff --git a/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionOFB.runall b/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionOFB.runall
index a56791d19..eb528345d 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionOFB.runall
+++ b/java/testing/org/apache/derbyTesting/functionTests/suites/encryptionOFB.runall
@@ -1,3 +1,2 @@
 unit/T_CipherOFB.unit
 store/encryptDatabase.sql
-store/access.sql
diff --git a/java/testing/org/apache/derbyTesting/functionTests/suites/storemats.runall b/java/testing/org/apache/derbyTesting/functionTests/suites/storemats.runall
index 3126e1de5..64d84933b 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/suites/storemats.runall
+++ b/java/testing/org/apache/derbyTesting/functionTests/suites/storemats.runall
@@ -1,6 +1,5 @@
 store/RowLockBasic.sql
 store/TableLockBasic.sql
-store/access.sql
 store/longColumn.sql
 store/madhare.sql
 store/updatelocksJDBC30.sql
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/store/AccessTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/store/AccessTest.java
new file mode 100644
index 000000000..1263a9e4c
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/store/AccessTest.java
@@ -0,0 +1,1857 @@
+/*
+   Derby - Class org.apache.derbyTesting.functionTests.tests.store.AccessTest
+
+   Licensed to the Apache Software Foundation (ASF) under one
+   or more contributor license agreements.  See the NOTICE file
+   distributed with this work for additional information
+   regarding copyright ownership.  The ASF licenses this file
+   to you under the Apache License, Version 2.0 (the
+   "License"); you may not use this file except in compliance
+   with the License.  You may obtain a copy of the License at
+   
+   http://www.apache.org/licenses/LICENSE-2.0
+   
+   Unless required by applicable law or agreed to in writing,
+   software distributed under the License is distributed on an
+   "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+   KIND, either express or implied.  See the License for the
+   specific language governing permissions and limitations
+   under the License.
+*/
+
+package org.apache.derbyTesting.functionTests.tests.store;
+
+import java.sql.CallableStatement;
+import java.sql.Connection;
+import java.sql.PreparedStatement;
+import java.sql.ResultSet;
+import java.sql.SQLException;
+import java.sql.Statement;
+import java.util.Properties;
+
+import junit.framework.Test;
+
+import org.apache.derbyTesting.functionTests.util.Formatters;
+import org.apache.derbyTesting.junit.BaseJDBCTestCase;
+import org.apache.derbyTesting.junit.CleanDatabaseTestSetup;
+import org.apache.derbyTesting.junit.JDBC;
+import org.apache.derbyTesting.junit.RuntimeStatisticsParser;
+import org.apache.derbyTesting.junit.SystemPropertyTestSetup;
+import org.apache.derbyTesting.junit.TestConfiguration;
+
+
+public final class AccessTest extends BaseJDBCTestCase {
+
+    /**
+     * Public constructor required for running test as standalone JUnit.
+     */
+    public AccessTest(String name)
+    {
+        super(name);
+    }
+    
+    public void tearDown() throws Exception {
+        Statement st = createStatement();
+        super.tearDown();
+        try {
+            st.executeUpdate("DROP FUNCTION PADSTRING");
+        } catch (SQLException e) {
+            // never mind.
+        }
+    }
+    
+    public static Test suite() {
+        Properties sysProps = new Properties();
+        sysProps.put("derby.optimizer.optimizeJoinOrder", "false");
+        sysProps.put("derby.optimizer.ruleBasedOptimization", "true");
+        sysProps.put("derby.optimizer.noTimeout", "true");
+
+        Test suite = TestConfiguration.embeddedSuite(AccessTest.class);
+        return new CleanDatabaseTestSetup(new SystemPropertyTestSetup(suite, sysProps, true)) {
+            /**
+             * Creates the table used in the test cases.
+             *
+             */
+            protected void decorateSQL(Statement s) throws SQLException {
+                Connection conn = s.getConnection();
+                conn.setAutoCommit(false);
+
+                s.execute("CREATE FUNCTION  PADSTRING (DATA VARCHAR(32000), "
+                        + "LENGTH INTEGER) RETURNS VARCHAR(32000) EXTERNAL NAME " +
+                        "'org.apache.derbyTesting.functionTests.util.Formatters" +
+                ".padString' LANGUAGE JAVA PARAMETER STYLE JAVA");
+            }
+        };
+    }    
+    
+    //---------------------------------------------------------
+    //    test qualifier skip code on fields with length  
+    //    having the 8th bit set in low order length byte. 
+    // --------------------------------------------------------
+    public void testQualifierSkipLOLB() throws Exception
+    {
+
+        ResultSet rs = null;
+        CallableStatement cSt;
+        Statement st = createStatement();
+
+        String [][] expRS;
+        String [] expColNames;
+
+        setAutoCommit(false);
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', '32768')");
+        cSt.execute();
+        st.executeUpdate("create table a ( " +
+                "i1 int, col00 varchar(384), col01 varchar(390), i2 int )");
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', NULL)");
+        cSt.execute();
+
+        // insert rows
+        st.executeUpdate(
+                "insert into a values (1, PADSTRING('10',384), "
+                + "PADSTRING('100',390), 1000)");
+        st.executeUpdate(
+                "insert into a values (2, PADSTRING('20',384), "
+                + "PADSTRING('200',390), 2000)");
+        st.executeUpdate(
+                "insert into a values (3, PADSTRING('30',384), "
+                + "PADSTRING('300',390), 3000)");
+
+        rs = st.executeQuery("select i1, i2 from a where i2 = 3000");
+
+        expColNames = new String [] {"I1", "I2"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][] {{"3", "3000"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        st.executeUpdate("drop table a");
+        commit();
+    }
+
+    // test case for a fixed bug where the problem was that the btree split 
+    // would self deadlock while trying to reclaim rows during the split.
+    // Fixed by just giving up if btree can't get the locks during the 
+    // reclaim try.
+    public void testCSBug2590() throws Exception
+    {
+        Statement st = createStatement();
+        st.executeUpdate("create table foo (a int, b varchar(900), c int)");
+
+        // insert
+        st.executeUpdate("insert into foo values (1, PADSTRING('1',900), 1)");
+        st.executeUpdate("insert into foo values (2, PADSTRING('2',900), 1)");
+        st.executeUpdate("insert into foo values (3, PADSTRING('3',900), 1)");
+        st.executeUpdate("insert into foo values (4, PADSTRING('4',900), 1)");
+        st.executeUpdate("insert into foo values (5, PADSTRING('5',900), 1)");
+        st.executeUpdate("insert into foo values (6, PADSTRING('6',900), 1)");
+        st.executeUpdate("insert into foo values (7, PADSTRING('7',900), 1)");
+        st.executeUpdate("insert into foo values (8, PADSTRING('8',900), 1)");
+
+        CallableStatement cSt;
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', '4096')");
+        cSt.execute();
+        st.executeUpdate("create index foox on foo (a, b)");
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', NULL)");
+        cSt.execute();
+        commit();
+
+        assertUpdateCount(st, 7, "delete from foo where foo.a <> 2");
+
+        ResultSet rs = null;
+        String [][] expRS;
+
+        // Test full cursor for update scan over all the rows in the heap,  
+        // with default group fetch.  Group fetch should be disabled.
+        
+        rs = st.executeQuery("select a, b, c from foo for update of c");
+        expRS = new String [][] {{"2","2","1"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        // Do the same, but use a PreparedStatement.
+        PreparedStatement ps_scan_cursor = prepareStatement(
+            "select a, b, c from foo for update of c");
+        ResultSet scan_cursor = ps_scan_cursor.executeQuery();
+        expRS = new String [][] {{"2","2","1"}};
+        JDBC.assertFullResultSet(scan_cursor, expRS, true);
+
+        // these inserts would cause a lock wait timeout before 
+        // the bug fix.
+        st.executeUpdate("insert into foo values (1, PADSTRING('11',900), 1)");
+        st.executeUpdate("insert into foo values (1, PADSTRING('12',900), 1)");
+        st.executeUpdate("insert into foo values (1, PADSTRING('13',900), 1)");
+        st.executeUpdate("insert into foo values (1, PADSTRING('14',900), 1)");
+        st.executeUpdate("insert into foo values (1, PADSTRING('15',900), 1)");
+
+        commit();
+        st.executeUpdate("drop table foo");
+        commit();
+    }
+
+    // test case a fixed bug where the problem was that when 
+    // the level of btree grew, raw store would incorrectly 
+    // report that there was not enough space to move all the   
+    // rows from the root page to a newly allocated leaf page, 
+    // so the create index operation would fail with a 
+    // message saying that a row was too big. create and 
+    // load a table with values from 1024 down to 1, the 
+    // reverse order is important to reproduce the bug.
+    public void testCSBug735() throws Exception
+    {
+
+        ResultSet rs = null;
+        Statement st = createStatement();
+
+        String [][] expRS;
+        String [] expColNames;
+
+        st.executeUpdate("create table foo (a int)");
+        st.executeUpdate("insert into foo values (1024)");
+        st.executeUpdate("insert into foo (select foo.a - 1   from foo)");
+        st.executeUpdate("insert into foo (select foo.a - 2   from foo)");
+        st.executeUpdate("insert into foo (select foo.a - 4   from foo)");
+        st.executeUpdate("insert into foo (select foo.a - 8   from foo)");
+        st.executeUpdate("insert into foo (select foo.a - 16  from foo)");
+        st.executeUpdate("insert into foo (select foo.a - 32  from foo)");
+        st.executeUpdate("insert into foo (select foo.a - 64  from foo)");
+        st.executeUpdate("insert into foo (select foo.a - 128 from foo)");
+        st.executeUpdate("insert into foo (select foo.a - 256 from foo)");
+        st.executeUpdate("insert into foo (select foo.a - 512 from foo)");
+        
+        // this create index used to fail.
+        assertEquals(0, st.executeUpdate("create index a on foo (a)"));
+
+        // Check the consistency of the indexes
+        rs = st.executeQuery(
+            "VALUES SYSCS_UTIL.SYSCS_CHECK_TABLE('APP', 'FOO')");
+        expColNames = new String [] {"1"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][] {{"1"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        // a delete of the whole table also exercises the index well.
+        assertUpdateCount(st, 1024, "delete from foo");
+
+        st.executeUpdate("drop table foo");
+    }
+
+    // ---------------------------------------------------------
+    // stress the conglomerate directory.  
+    // abort of an alter table will clear the cache. 
+    // ---------------------------------------------------------
+    public void test_conglomDirectory() throws Exception
+    {
+        ResultSet rs = null;
+        Statement st = createStatement();
+
+        String [] expColNames;
+        setAutoCommit(false);
+
+        st.executeUpdate("create table a (a int)");
+        commit();
+        st.executeUpdate("alter table a add column c1 int");
+
+        rollback();
+
+        rs = st.executeQuery("select * from a");
+
+        expColNames = new String [] {"A"};
+        JDBC.assertColumnNames(rs, expColNames);
+        JDBC.assertDrainResults(rs, 0);
+
+        st.executeUpdate("drop table a");
+        commit();
+    }
+
+    // ---------------------------------------------------------
+    // ----- test case for partial row runtime statistics. ----- 
+    // ---------------------------------------------------------
+    /* This test checks correctness of simple runtime statistics.
+       It first exercises queries when there's no index present, then with
+        an index present; expecting to see a difference between Table Scan 
+        and Index Scan. Also of interest is that the qualifiers look right; 
+        whether it is using scan start/stop (this is a way to do qualifiers 
+        using index).
+       Then it does the same 2 actions after some rows have been
+        deleted, to exercise the 'deleted rows visited' section in the
+        runtime statistics.
+       The queries which are cycled through are:
+         query1: all columns & rows: "select * from foo"
+         query2 - just last column: "select e from foo"
+         query3: as subset of columns: "select e, c, a from foo"
+         query4: as subset of columns, with qualifier in list: 
+             "select e, c, a from foo where foo.e = 5"
+         query5: as subset of columns, with qualifier not in list: 
+             "select e, c, a from foo where foo.b = 20"
+         query6: as subset of columns: "select a, b from foo"
+     */
+    public void testPartialRowRTStats() throws Exception
+    {
+        Statement st = createStatement();
+        st.executeUpdate("set ISOLATION to RR");
+        setAutoCommit(false);
+        
+        st.executeUpdate(
+            "create table foo (a int, b int, c int, d int, e int)");
+        st.executeUpdate("insert into foo values (1, 2, 3, 4, 5)");
+        st.executeUpdate("insert into foo values (10, 20, 30, 40, 50)");
+        
+        // switch on runtime statistics
+        st.execute("call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1)");
+
+        runQueriesNormal(st);
+
+        // now check index scans - force the index just to make sure it 
+        // does an index scan. 
+        st.executeUpdate("create index foo_cover on foo (e, d, c, b, a)");
+        runQueriesWithIndex(st);
+        // drop the index...
+        st.executeUpdate("drop index foo_cover");
+        st.execute("call SYSCS_UTIL.SYSCS_UPDATE_STATISTICS('APP','FOO',null)");
+        
+        // check deleted row feature
+        st.executeUpdate("insert into foo values (100, 2, 3, 4, 5)");
+        st.executeUpdate("insert into foo values (1000, 2, 3, 4, 5)");
+        assertUpdateCount(st, 1, "delete from foo where foo.a = 100");
+        assertUpdateCount(st, 1, "delete from foo where foo.a = 1000");
+        runQueriesWithDeletedRows(st);
+        
+        // now check index scans again
+        // recreate the index to make sure it does an index scan.
+        st.execute("create index foo_cover on foo (e, d, c, b, a)");
+        // of course, we'll have to update statistics now before it looks good
+        st.execute("call SYSCS_UTIL.SYSCS_UPDATE_STATISTICS('APP','FOO',null)");
+        // and then we have to re-delete the rows because update statistics would've
+        // reset the info about deleted rows.
+        st.executeUpdate("insert into foo values (100, 2, 3, 4, 5)");
+        st.executeUpdate("insert into foo values (1000, 2, 3, 4, 5)");
+        assertUpdateCount(st, 1, "delete from foo where foo.a = 100");
+        assertUpdateCount(st, 1, "delete from foo where foo.a = 1000");
+        runQueriesWithIndexDeletedRows(st);
+        
+        st.executeUpdate("drop table foo");
+    }
+    
+    /* method used in testPartialRowRTStats and testCostingCoveredQuery */
+    private void assertStatsOK(Statement st, String expectedScan, 
+            String expTableInIndexScan, String expIndexInIndexScan, 
+            String expBits, String expNumCols, String expDelRowsV,  
+            String expPages, String expRowsQ, String expRowsV, 
+            String expScanType, String expStartPosition, String expStopPosition,
+            String expQualifier, String expQualifierInfo)
+    throws SQLException {
+        
+        ResultSet rs = null;
+        rs = st.executeQuery(
+            "values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS()");
+        rs.next();
+        if(usingEmbedded()){
+            RuntimeStatisticsParser rtsp = new RuntimeStatisticsParser(rs.getString(1));
+            rs.close();
+            if (expectedScan.equals("Table"))
+                    assertTrue(rtsp.usedTableScan());
+            else if (expectedScan.equals("Index"))
+            {
+                assertTrue(rtsp.usedIndexScan());
+                assertTrue(rtsp.usedSpecificIndexForIndexScan(
+                        expTableInIndexScan, expIndexInIndexScan));
+            }
+            else if (expectedScan.equals("Constraint"))
+            {
+                assertTrue(rtsp.usedIndexScan());
+                assertTrue(rtsp.usedConstraintForIndexScan(
+                        expTableInIndexScan));
+            }
+            assertTrue(rtsp.findString("Bit set of columns fetched="+expBits, 1));
+            assertTrue(rtsp.findString("Number of columns fetched="+expNumCols, 1));
+            if (expDelRowsV!=null)
+                assertTrue(rtsp.findString("Number of deleted rows visited="+expDelRowsV, 1));
+            assertTrue(rtsp.findString("Number of pages visited="+expPages, 1));
+            assertTrue(rtsp.findString("Number of rows qualified="+expRowsQ, 1));            
+            assertTrue(rtsp.findString("Number of rows visited="+expRowsV, 1));
+            assertTrue(rtsp.findString("Scan type="+expScanType, 1));
+            assertTrue(rtsp.getStartPosition()[1].indexOf(expStartPosition)>1);
+            assertTrue(rtsp.getStopPosition()[1].indexOf(expStopPosition)>1);
+
+            if (expQualifier.equals("None"))
+                assertTrue(rtsp.hasNoQualifiers());
+            else if (expQualifier.equals("Equals"))
+                assertTrue(rtsp.hasEqualsQualifier());
+            if (expQualifierInfo !=null)
+                assertTrue(rtsp.findString(expQualifierInfo, 1));
+        }
+    }
+    
+    private void runQueriesNormal(Statement st) throws SQLException { 
+        doQuery1(st);
+        assertStatsOK(st, 
+            "Table", null, null, "All", "5", null, "1", "2", "2", 
+            "heap","null","null","None", null);
+        
+        doQuery2(st);
+        assertStatsOK(st, 
+            "Table", null, null, "{4}", "1", null, "1", "2", "2", 
+            "heap","null","null","None", null);
+
+        doQuery3(st);
+        assertStatsOK(st, 
+            "Table", null, null, "{0, 2, 4}", "3", null, "1", "2", "2", 
+            "heap","null","null","None", null);
+
+        doQuery4(st);
+        assertStatsOK(st, 
+            "Table", null, null, "{0, 2, 4}", "3", null, "1", "1", "2", 
+            "heap","null","null","Equals","Column[0][0] Id: 4");
+
+        doQuery5(st);
+        assertStatsOK(st, 
+            "Table", null, null, "{0, 1, 2, 4}", "4", null, "1", "1", "2", 
+            "heap","null","null","Equals","Column[0][0] Id: 1");
+
+        doQuery6(st);
+        assertStatsOK(st, 
+            "Table", null, null, "{0, 1}", "2", null, "1", "2", "2", 
+            "heap","null","null","None",null);
+    }
+    
+    private void runQueriesWithIndex(Statement st) throws SQLException {
+        doQuery1(st);
+        assertStatsOK(st, 
+            "Index", "FOO", "FOO_COVER", 
+            "{0, 1, 2, 3, 4}", "5", "0", "1", "2", "2", "btree",
+            "None","None","None", null);
+
+        doQuery2(st);
+        assertStatsOK(st, 
+            "Index", "FOO", "FOO_COVER", 
+            "{0}", "1", "0", "1", "2", "2", "btree",
+            "None","None","None", null);
+
+        doQuery3(st);
+        assertStatsOK(st, 
+            "Index", "FOO", "FOO_COVER", 
+            "{0, 2, 4}", "3", "0", "1", "2", "2", "btree",
+            "None","None","None", null);
+
+        doQuery4(st);
+        assertStatsOK(st, 
+            "Index", "FOO", "FOO_COVER", 
+            "{0, 2, 4}", "3", "0", "1", "1", "2", 
+            "btree",">= on first 1 column(s).","> on first 1 column(s).","None", null);
+
+        doQuery5(st);
+        assertStatsOK(st, 
+            "Index", "FOO", "FOO_COVER", 
+            "{0, 2, 3, 4}", "4", "0", "1", "1", "2", "btree",
+            "None","None","Equals", "Column[0][0] Id: 3");
+
+        doQuery6(st);
+        assertStatsOK(st, 
+            "Index", "FOO", "FOO_COVER", 
+            "{3, 4}", "2", "0", "1", "2", "2", "btree",
+            "None","None","None", null);
+    }
+    
+    private void runQueriesWithDeletedRows(Statement st) throws SQLException {
+        doQuery1(st);
+        assertStatsOK(st, 
+            "Table", null, null, "All", "5", null, "1", "2", "4", "heap",
+            "null","null","None", null);
+
+        doQuery2(st);
+        assertStatsOK(st, 
+            "Table", null, null, "{4}", "1", null, "1", "2", "4", "heap",
+            "null","null","None", null);
+
+        doQuery3(st);
+        assertStatsOK(st, 
+            "Table", null, null, "{0, 2, 4}", "3", null, "1", "2", "4", "heap",
+            "null","null","None", null);
+
+        doQuery4(st);
+        assertStatsOK(st, 
+            "Table", null, null, "{0, 2, 4}", "3", null, "1", "1", "4", "heap",
+            "null","null","Equals","Column[0][0] Id: 4");
+
+        doQuery5(st);
+        assertStatsOK(st, 
+            "Table", null, null, "{0, 1, 2, 4}", "4", null, "1", "1", "4", "heap",
+            "null","null","Equals","Column[0][0] Id: 1");
+
+        doQuery6(st);
+        assertStatsOK(st, 
+            "Table", null, null, "{0, 1}", "2", null, "1", "2", "4", "heap",
+            "null","null","None",null);
+    }
+    
+    private void runQueriesWithIndexDeletedRows(Statement st) throws SQLException {
+        doQuery1(st);
+        assertStatsOK(st, 
+            "Index", "FOO", "FOO_COVER", 
+            "{0, 1, 2, 3, 4}", "5", "2", "1", "2", "4", "btree",
+            "None","None","None", null);
+
+        doQuery2(st);
+        assertStatsOK(st, 
+            "Index", "FOO", "FOO_COVER", 
+            "{0}", "1", "2", "1", "2", "4", "btree",
+            "None","None","None", null);
+
+        doQuery3(st);
+        assertStatsOK(st, 
+            "Index", "FOO", "FOO_COVER", 
+            "{0, 2, 4}", "3", "2", "1", "2", "4", "btree",
+            "None","None","None", null);
+
+        doQuery4(st);
+        assertStatsOK(st, 
+            "Index", "FOO", "FOO_COVER", 
+            "{0, 2, 4}", "3", "2", "1", "1", "4", "btree",
+            ">= on first 1 column(s).","> on first 1 column(s).","None", null);
+
+        doQuery5(st);
+        assertStatsOK(st, 
+            "Index", "FOO", "FOO_COVER", 
+            "{0, 2, 3, 4}", "4", "2", "1", "1", "4", "btree",
+            "None","None","Equals", "Column[0][0] Id: 3");
+
+        doQuery6(st);
+        assertStatsOK(st, 
+            "Index", "FOO", "FOO_COVER", 
+            "{3, 4}", "2", "2", "1", "2", "4", "btree",
+            "None","None","None", null);
+    }
+    
+    private void doQuery1(Statement st) throws SQLException {
+        // all columns and rows
+        doQuery(st, "select * from foo",
+                new String [] {"A", "B", "C", "D", "E"},
+                new String [][] {
+                        {"1", "2", "3", "4", "5"},
+                        {"10", "20", "30", "40", "50"}});        
+    }
+    
+    private void doQuery2(Statement st) throws SQLException {
+        // just last column - should be 5 and 50 
+        doQuery(st, "select e from foo", 
+                new String[] {"E"}, 
+                new String[][] {{"5"},{"50"}});
+    }
+
+    private void doQuery3(Statement st) throws SQLException {
+        // as subset of columns - should be 5,3,1 and 50,30,10
+        doQuery(st, "select e, c, a from foo",
+                new String [] {"E", "C", "A"},
+                new String [][] {
+                        {"5", "3", "1"},
+                        {"50", "30", "10"}});
+    }
+
+    private void doQuery4(Statement st) throws SQLException {
+        // as subset of columns, with qualifier in list - should be 5,3,1
+        doQuery(st, "select e, c, a from foo where foo.e = 5",
+                new String [] {"E", "C", "A"},
+                new String [][]{{"5", "3", "1"}});        
+    }
+    
+    private void doQuery5(Statement st) throws SQLException {
+        // as subset of columns, with qualifier not in list; should be 50,30,10 
+        doQuery(st, "select e, c, a from foo where foo.b = 20", 
+                new String [] {"E", "C", "A"}, 
+                new String [][] {{"50", "30", "10"}});        
+    }
+    
+    private void doQuery6(Statement st) throws SQLException {
+        // as subset of columns
+        doQuery(st, "select a, b from foo", 
+                new String [] {"A", "B"}, 
+                new String [][] {{"1", "2"},{"10", "20"}}); 
+    }
+    
+    private void doQuery(Statement st,
+            String query, String [] expColNames, String[][] expRS) 
+    throws SQLException {
+        ResultSet rs = null;
+        rs = st.executeQuery(query);
+        JDBC.assertColumnNames(rs, expColNames);
+        JDBC.assertFullResultSet(rs, expRS, true);        
+    }
+    
+    // ----------------------------------------------------
+    //           -- test case for costing - 
+    // make sure optimizer picks obvious covered query. 
+    // ----------------------------------------------------
+    public void testCostingCoveredQuery() throws Exception
+    {
+        Statement st = createStatement();
+        st.executeUpdate("set ISOLATION to RR");
+        setAutoCommit(false);
+
+        st.executeUpdate("create table base_table (a int, b varchar(1000))");
+        st.executeUpdate(
+            "insert into base_table values (1, PADSTRING('1',1000))");
+        st.executeUpdate(
+            "insert into base_table values (2, PADSTRING('2',1000))");
+        st.executeUpdate(
+            "insert into base_table values (3,  PADSTRING('3',1000))");
+        st.executeUpdate(
+            "insert into base_table values (4,  PADSTRING('4',1000))");
+        st.executeUpdate(
+            "insert into base_table values (5,  PADSTRING('5',1000))");
+        st.executeUpdate(
+            "insert into base_table values (6,  PADSTRING('6',1000))");
+        st.executeUpdate(
+            "insert into base_table values (7,  PADSTRING('7',1000))");
+        st.executeUpdate(
+        "insert into base_table values (8,  PADSTRING('8',1000))");
+        st.executeUpdate(
+            "insert into base_table values (9,  PADSTRING('9',1000))");
+        st.executeUpdate(
+            "insert into base_table values (10, PADSTRING('10',1000))");
+        st.executeUpdate("create index cover_idx on base_table(a)");
+
+        // switch on runtime statistics
+        st.execute("call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1)");
+
+        // make sure covered index is chosen
+        doQuery(st, "select a from base_table", 
+                new String [] {"A"}, 
+                new String [][] {{"1"},{"2"},{"3"},{"4"},{"5"},
+                                {"6"},{"7"},{"8"},{"9"},{"10"}});
+        assertStatsOK(st, 
+                "Index", "BASE_TABLE", "COVER_IDX", 
+                "{0}", "1", "0", "1", "10", "10", "btree",
+                "None","None","None", null);
+    }
+    
+    // ----------------------------------------------------
+    //       -- test for key too big error message. -- 
+    // ----------------------------------------------------
+    public void testKeyTooBigError() throws Exception
+    {
+        Statement st = createStatement();
+        st.executeUpdate ("create table d (id int not null, " +
+            "t_bigvarchar varchar(400), unique (id))");
+        st.executeUpdate("create index t_bigvarchar_ind on d ( t_bigvarchar)");
+        st.executeUpdate(
+            "alter table d alter t_bigvarchar set data type varchar(4096)");
+
+        String bigString="1111111";
+        for (int i=0 ; i<314 ; i++)
+            bigString=bigString+"1234567890";
+        bigString=bigString+"123456";
+        assertStatementError("XSCB6", st,
+            "insert into d (id, t_bigvarchar) values (1, '" + bigString + "')");
+    }
+    
+    // ---------------------------------------------------------
+    //                  test space for update 
+    // ---------------------------------------------------------
+    public void testSpaceForUpdate() throws Exception
+    {
+        CallableStatement cSt;
+        Statement st = createStatement();
+        
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', '1024')");
+        cSt.execute();
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.minimumRecordSize', '1')");
+        cSt.execute();
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageReservedSpace', '0')");
+        cSt.execute();
+
+        st.executeUpdate("create table testing (a varchar(100))");
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', NULL)");
+        cSt.execute();
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+        "'derby.storage.minimumRecordSize', NULL)");
+        cSt.execute();
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+        "'derby.storage.minimumRecordSize', NULL)");
+        cSt.execute();
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageReservedSpace', NULL)");
+        cSt.execute();
+
+        st.executeUpdate("insert into testing values ('a')");
+        for (int i=0 ; i<7 ; i++)
+            st.executeUpdate(
+                "insert into testing (select testing.a from testing)");
+
+        assertUpdateCount(st, 128,
+            "update testing set a = 'abcd' where a = 'a'");
+
+        st.executeUpdate("create index zz on testing (a)");
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', '1024')");
+        cSt.execute();
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.minimumRecordSize', '1')");
+        cSt.execute();
+
+        st.executeUpdate("create table t1 (a varchar(100))");
+
+        st.executeUpdate("insert into t1 values ('a')");
+        for (int i=0 ; i<7 ; i++)
+            st.executeUpdate("insert into t1 (select t1.a from t1)");
+
+        assertUpdateCount(st, 128,
+        " update t1 set a = 'abcd' where a = 'a'");
+
+        st.executeUpdate("create index zz1 on t1 (a)");
+    }
+    
+        
+    // ---------------------------------------------------------
+    //     test load with long columns with index creation 
+    // ---------------------------------------------------------
+    public void testLoadLongColumnsCreateIndex() throws Exception
+    {
+        ResultSet rs = null;
+        CallableStatement cSt;
+        Statement st = createStatement();
+        String [][] expRS;
+        String [] expColNames;
+        st.executeUpdate("set ISOLATION to RR");
+        setAutoCommit(false);
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', '1024')");
+        cSt.execute();
+
+        st.executeUpdate(
+            "create table long1 (a varchar(32000), b int, c int)");
+
+        st.executeUpdate("insert into long1 values (" +
+            "'this is a long row which will get even longer and longer " +
+            "to force a stream', 1, 2)");
+        st.executeUpdate("insert into long1 values (" +
+            "'this is another long row which will get even longer " +
+            "and longer to force a stream', 2, 3)");
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', NULL)");
+        cSt.execute();
+
+        assertUpdateCount(st, 2, "update long1 set a = a||a||a||a||a||a");
+        assertUpdateCount(st, 2, "update long1 set a = a||a||a||a||a||a");
+        assertUpdateCount(st, 2, "update long1 set a = a||a");
+
+        rs = st.executeQuery("select LENGTH(a) from long1");
+
+        expColNames = new String [] {"1"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"5328"},{"5760"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', '1024')");
+        cSt.execute();
+
+        st.executeUpdate(
+            "create table long2 (a varchar(16384), b int, c int)");
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', NULL)");
+        cSt.execute();
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', '16384')");
+        cSt.execute();
+
+        st.executeUpdate("create index long2i1 on long2 (a)");
+        st.executeUpdate("create index long2i2 on long2 (a,b)");
+        st.executeUpdate("create index long2i3 on long2 (a,b,c)");
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', NULL)");
+        cSt.execute();
+
+        st.executeUpdate("insert into long2 select * from long1");
+
+        rs = st.executeQuery("select LENGTH(a) from long2");
+
+        expColNames = new String [] {"1"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"5328"},{"5760"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        rs = st.executeQuery("select LENGTH(a) from long2 " +
+            "/*derby_properties index=long2i2*/");
+
+        expColNames = new String [] {"1"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"5328"},{"5760"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        // DefectId CS 1346
+
+        st.executeUpdate("insert into long2 select * from long1");
+
+        rs = st.executeQuery("select LENGTH(a) from long2");
+
+        expColNames = new String [] {"1"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"5328"},{"5328"},{"5760"},{"5760"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        rs = st.executeQuery("select LENGTH(a) from long2 " +
+            "/*derby_properties index=long2i2*/");
+
+        expColNames = new String [] {"1"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"5328"},{"5328"},{"5760"},{"5760"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+        
+        assertUpdateCount(st, 4, "delete from long2");
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', '1024')");
+        cSt.execute();
+
+        st.executeUpdate("create index long2small on long2 (a, c)");
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', NULL)");
+        cSt.execute();
+
+        // this small index should cause the insert to fail
+
+        assertStatementError("XSCB6", st, 
+            "insert into long2 select * from long1");
+
+        // DefectId CS 1346 the small index should cause this insert 
+        // to also fail
+
+        assertStatementError("XSCB6", st,
+            "insert into long2 select * from long1");
+
+        rs = st.executeQuery("select LENGTH(a) from long2");
+
+        expColNames = new String [] {"1"};
+        JDBC.assertColumnNames(rs, expColNames);
+        JDBC.assertDrainResults(rs, 0);
+
+        // test case for track 1346
+
+        st.executeUpdate("drop table long1");
+        st.executeUpdate("drop table long2");
+    }
+    
+    public void testCS1346() throws Exception
+    {
+        ResultSet rs = null;
+        CallableStatement cSt;
+        Statement st = createStatement();
+        String [][] expRS;
+        String [] expColNames;
+        st.executeUpdate("set ISOLATION to RR");
+        setAutoCommit(false);
+        
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', '1024')");
+        cSt.execute();
+        st.executeUpdate(
+            "create table long1 (a varchar(32000), b int, c int)");
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', NULL)");
+        cSt.execute();
+
+        st.executeUpdate("insert into long1 values ('this is a long row " +
+            "which will get even longer', 1, 2)");
+        st.executeUpdate("insert into long1 values ('a second row that will " +
+            "also grow very long', 2, 3)");
+
+        assertUpdateCount(st, 2, "update long1 set a = a||a||a||a||a||a");
+        assertUpdateCount(st, 2, "update long1 set a = a||a||a||a||a||a");
+        assertUpdateCount(st, 2, "update long1 set a = a||a");
+
+        rs = st.executeQuery("select LENGTH(a) as x from long1 order by x");
+
+        expColNames = new String [] {"X"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"3024"},{"3240"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', '1024')");
+        cSt.execute();
+
+        st.executeUpdate(
+            "create table long2 (a varchar(30000), b int, c int)");
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', NULL)");
+        cSt.execute();
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', '16384')");
+        cSt.execute();
+
+        st.executeUpdate("create index long2i1 on long2 (a)");
+        st.executeUpdate("create index long2i2 on long2 (b, a)");
+        st.executeUpdate("create index long2i3 on long2 (b, a, c)");
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', NULL)");
+        cSt.execute();
+
+        st.executeUpdate("insert into long2 select * from long1");
+        st.executeUpdate("insert into long2 select * from long1");
+
+        rs = st.executeQuery("select LENGTH(a) as x from long2 order by x");
+
+        expColNames = new String [] {"X"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"3024"},{"3024"},{"3240"},{"3240"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        st.executeUpdate("drop table long1");
+        st.executeUpdate("drop table long2");
+
+    }
+
+    public void testCS1346b() throws Exception
+    {
+        ResultSet rs = null;
+        CallableStatement cSt;
+        Statement st = createStatement();
+        String [][] expRS;
+        String [] expColNames;
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', '1024')");
+        cSt.execute();
+
+        st.executeUpdate(
+            "create table long1 (a varchar(32000), b int, c int)");
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', NULL)");
+        cSt.execute();
+
+        st.executeUpdate("insert into long1 values ('this is a long row " +
+            "which will get even longer', 1, 2)");
+        st.executeUpdate("insert into long1 values ('a second row that will "
+            + "also grow very long', 2, 3)");
+
+        assertUpdateCount(st, 2, "update long1 set a = a||a||a||a||a||a");
+        assertUpdateCount(st, 2, "update long1 set a = a||a||a||a||a||a");
+        assertUpdateCount(st, 2, "update long1 set a = a||a");
+
+        rs = st.executeQuery("select LENGTH(a) as x from long1 order by x");
+
+        expColNames = new String [] {"X"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"3024"},{"3240"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', '1024')");
+        cSt.execute();
+
+        st.executeUpdate(
+            "create table long2 (a varchar(32000), b int, c int)");
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', NULL)");
+        cSt.execute();
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', '16384')");
+        cSt.execute();
+
+        st.executeUpdate("create index long2i1 on long2 (a)");
+        st.executeUpdate("create index long2i2 on long2 (b, a)");
+        st.executeUpdate("create index long2i3 on long2 (b, a, c)");
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', NULL)");
+        cSt.execute();
+
+        // insert into the second table multiple times
+        for (int i=0 ; i<10 ; i++)
+            st.executeUpdate("insert into long2 select * from long1");
+
+        rs = st.executeQuery("select LENGTH(a) as x from long2 order by x");
+
+        expColNames = new String [] {"X"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [20][1];
+        //10 rows should have '3024' and 10 '3240 as length
+        for (int i=0 ; i<10 ; i++)
+            expRS[i][0]="3024";
+        for (int i=10 ; i<20 ; i++)
+            expRS[i][0]="3240";
+        JDBC.assertFullResultSet(rs, expRS, true);
+        rs = st.executeQuery("select count(*) from long2");
+        expColNames = new String [] {"1"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"20"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+    }
+
+    // regression test case for a Cloudscape era bug, 1552
+    // Make sure that a full scan which needs columns not in index
+    // does not use the index.
+    // Before the fix, access costing would make the optimizer 
+    // pick the index because it incorrectly costed rows spanning pages.
+    public void testCS1552() throws Exception
+    {
+        ResultSet rs = null;
+        CallableStatement cSt;
+        Statement st = createStatement();
+        String [][] expRS;
+        String [] expColNames;
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize','4096')");
+        cSt.execute();
+
+        st.executeUpdate("create table a " +
+            "(a int, b varchar(4000), c varchar(4000), d varchar(4000))");
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', NULL)");
+        cSt.execute();
+
+        st.executeUpdate("create index a_idx on a (a)");
+
+        st.executeUpdate("insert into a values (5, PADSTRING('a',4000), " + 
+            "PADSTRING('a',4000), PADSTRING('a',4000))");
+        st.executeUpdate("insert into a values (4, PADSTRING('a',4000), " + 
+            "PADSTRING('a',4000), PADSTRING('a',4000))");
+        st.executeUpdate("insert into a values (3, PADSTRING('a',4000), " +
+            "PADSTRING('a',4000), PADSTRING('a',4000))");
+        st.executeUpdate("insert into a values (2, PADSTRING('a',4000), " +
+            "PADSTRING('a',4000), PADSTRING('a',4000))");
+        st.executeUpdate("insert into a values (1, PADSTRING('a',4000), " +
+            "PADSTRING('a',4000), PADSTRING('a',4000))");
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1)");
+        cSt.execute();
+
+        rs = st.executeQuery("select a, d from a");
+
+        expColNames = new String [] {"A", "D"};
+        JDBC.assertColumnNames(rs, expColNames);
+        String paddeda = Formatters.padString("a", 4000);
+        expRS = new String[][] {
+            {"5", paddeda},
+            {"4", paddeda}, 
+            {"3", paddeda}, 
+            {"2", paddeda}, 
+            {"1", paddeda}}; 
+        JDBC.assertFullResultSet(rs, expRS, true);
+        assertStatsOK(st, 
+            "Table", null, null, "{0, 3}", "2", null, "6", "5", "5", 
+            "heap","null","null","None", null);
+        
+        st.execute("drop table a");
+        commit();
+    }
+    
+    // test case for track 2241"};
+    // The problem was that when the level of btree grew, 
+    // sometimes a long row would be chosen as the branch 
+    // delimiter, and the branch code did not throw the 
+    // correct error noSpaceForKey error.
+    public void testCS2241() throws Exception
+    {
+        ResultSet rs = null;
+        CallableStatement cSt;
+        Statement st = createStatement();
+        String [][] expRS;
+        String [] expColNames;
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', NULL)");
+        cSt.execute();
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.minimumRecordSize', NULL)");
+        cSt.execute();
+
+        st.executeUpdate("create table b2241 (a int, b varchar(32000))");
+        st.executeUpdate("insert into b2241 values (1024, " +
+            "'01234567890123456789012345678901234567890123456789')");
+        String inshalf1 = "insert into b2241 (select b2241.a + ";
+        String inshalf2 = ", b from b2241)";
+        st.executeUpdate(inshalf1 + "1" + inshalf2);
+        st.executeUpdate(inshalf1 + "2" + inshalf2);
+        st.executeUpdate(inshalf1 + "4" + inshalf2);
+        st.executeUpdate(inshalf1 + "8" + inshalf2);
+        st.executeUpdate(inshalf1 + "16" + inshalf2);
+        st.executeUpdate(inshalf1 + "32" + inshalf2);
+        st.executeUpdate(inshalf1 + "64" + inshalf2);
+        for (int i=0 ; i<5  ; i++)
+            assertUpdateCount(st, 128, "update b2241 set b = b||b");
+        rs = st.executeQuery("select LENGTH(b) from b2241 where a = 1025");
+
+        expColNames = new String [] {"1"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"1600"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+        st.executeUpdate(
+                " insert into b2241 (select 1, "
+                + "b||b||b||b||b||b||b||b from b2241 where a = 1024)");
+        st.executeUpdate(
+                " insert into b2241 (select 8000, "
+                + "b||b||b||b||b||b||b||b from b2241 where a = 1024)");
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', '4096')");
+        cSt.execute();
+
+        // this create index use to fail with an assert - should 
+        // fail with key too big error.
+        assertStatementError("XSCB6", st, "create index a on b2241 (b, a)");
+        // make sure table still accessable, by doing the same statement
+        assertStatementError("XSCB6", st, "create index a on b2241 (b, a)");
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', NULL)");
+        cSt.execute();
+
+        // delete 2 big records and then index should work.
+        assertUpdateCount(st, 1, "delete from b2241 where a = 1");
+        assertUpdateCount(st, 1, "delete from b2241 where a = 8000");
+
+        st.executeUpdate("create index a on b2241 (b, a)");
+
+        // Check the consistency of the indexes
+        rs = st.executeQuery("VALUES SYSCS_UTIL.SYSCS_CHECK_TABLE('APP', 'B2241')");
+
+        expColNames = new String [] {"1"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"1"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        st.executeUpdate("drop table b2241");
+    }
+
+    // o insert bunch of rows with sequential keys.
+    // o create an index (non unique or unique)
+    // o delete every other one - will make normat post commit not fire.
+    // o commit
+    // o now reinsert rows into the "holes" which before the fix 
+    //   would cause splits, but now will force reclaim space and 
+    //   reuse existing space in btree.
+    private void reclaimTest(String createIndex, String expectedError) 
+    throws SQLException {
+        CallableStatement cSt;
+        setAutoCommit(false);
+        Statement st = createStatement();
+
+        // set page size to default.
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', '4096')");
+        cSt.execute();
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.minimumRecordSize', '1')");
+        cSt.execute();
+        cSt.close();        
+        commit();
+
+        // create and load a table with values from 1024 down to 1,
+        st.executeUpdate("create table foo (a int, b char(200), c int)");
+        st.executeUpdate("insert into foo values (1024, 'even', 0)");
+        st.executeUpdate("insert into foo " +
+            "(select foo.a - 1, 'odd' , 1 from foo)");
+        st.executeUpdate("insert into foo " +
+            "(select foo.a - 2, foo.b, foo.c from foo)");
+        st.executeUpdate("insert into foo " +
+            "(select foo.a - 4, foo.b, foo.c from foo)");
+        st.executeUpdate("insert into foo " +
+            "(select foo.a - 8, foo.b, foo.c from foo)");
+        st.executeUpdate("insert into foo " +
+            "(select foo.a - 16, foo.b, foo.c from foo)");
+        st.executeUpdate("insert into foo " +
+            "(select foo.a - 32, foo.b, foo.c from foo)");
+        st.executeUpdate("insert into foo " +
+            "(select foo.a - 64, foo.b, foo.c from foo)");
+        st.executeUpdate("insert into foo " +
+            "(select foo.a - 128, foo.b, foo.c from foo)");
+        st.executeUpdate("insert into foo " +
+            "(select foo.a - 256, foo.b, foo.c from foo)");
+        st.executeUpdate("insert into foo " +
+            "(select foo.a - 512, foo.b, foo.c from foo)");
+
+        // insert into the "holes", but different keys (even2 instead of even)
+        st.executeUpdate("create table foo2 (a int, b char(200), c int)");
+        st.executeUpdate("insert into foo2 (select * from foo)");
+
+        assertUpdateCount(st, 512, "delete from foo2 where foo2.c = 1");
+
+        // create "packed" index.
+        st.executeUpdate(createIndex);
+
+        // delete ever other row
+        assertUpdateCount(st, 512, "delete from foo where foo.c = 0");
+
+        // turn all the deletes into "committed deletes"
+        commit();
+        st.executeUpdate("insert into foo " +
+            "(select foo2.a, 'even2', foo2.c from foo2)");
+        commit();
+
+        // insert dups
+        if (expectedError !=  null)
+            assertStatementError("23505", st, "insert into foo " +
+            "(select foo2.a, 'even2', foo2.c from foo2)");
+        else
+            assertUpdateCount(st, 512, "insert into foo " +
+            "(select foo2.a, 'even2', foo2.c from foo2)");
+        commit();
+
+        // a delete of the whole table also exercises the btree well.
+        if (expectedError !=  null)
+        {
+            assertUpdateCount(st, 1024, "delete from foo");
+            assertUpdateCount(st, 512, "delete from foo2");
+        }
+        else 
+        {
+            assertUpdateCount(st, 1536, "delete from foo");
+            assertUpdateCount(st, 512, "delete from foo2");
+        }
+        commit();
+
+        st.executeUpdate("drop table foo");
+        st.executeUpdate("drop table foo2");
+        commit();
+    }
+    
+    // test case for reclaiming deleted rows during split.
+    // actual work is done in method reclaimTest()
+    // exercise test case with non-unique index
+    public void testReclaimDeletedRowsDuringSplit() throws Exception
+    {
+        reclaimTest("create index a on foo (a, b)", null);
+    }
+
+    // as testReclaimDeletedRowsDuringSplit, but with unique index,
+    // so when attempting to create the duplicat rows, we should get an
+    // error. 
+    // actual work is done in method reclaimTest()
+    public void testReclaimDeletedRowsUniqueIndex() throws Exception
+    {
+        reclaimTest("create unique index a on foo (a, b)", "23505");
+    }
+
+    // same foo used in the next 3 test fixtures
+    private void setupForReclaim2(Statement st) throws SQLException {
+        st.executeUpdate("create table foo (a int, b varchar(1100), c int)");
+        st.executeUpdate("create index a on foo (a, b)");
+        st.executeUpdate("insert into foo values (1, PADSTRING('a',1100), 1)");
+        st.executeUpdate("insert into foo values (2, PADSTRING('a',1100), 1)");
+        st.executeUpdate("insert into foo values (3, PADSTRING('a',1100), 1)");
+    }
+    
+    private void reclaimDeletedRows2(boolean toCommit) throws SQLException {
+        Statement st = createStatement();
+
+        setupForReclaim2(st);
+        commit();
+
+        assertUpdateCount(st, 1, "delete from foo where foo.a = 1");
+        assertUpdateCount(st, 1, "delete from foo where foo.a = 2");
+        
+        if (toCommit)
+            commit();
+        st.executeUpdate("insert into foo values " +
+            "(-1, PADSTRING('ab',1100), 1)");
+        st.executeUpdate("insert into foo values " +
+            "(-2, PADSTRING('ab',1100), 1)");
+        rollback();
+
+        st.executeUpdate("drop table foo");
+        commit();
+    }
+    
+    // another simple test of reclaim deleted row code paths. 
+    // this test should not reclaim rows as deletes are not committed.
+    public void testUncommittedDeletesNotReclaimed() throws Exception
+    {
+        reclaimDeletedRows2(false);
+    }
+
+    // another simple test of reclaim deleted row code paths. 
+    // this test should reclaim rows as deletes are committed.
+    public void testCommittedDeletesReclaim() throws Exception
+    {
+        reclaimDeletedRows2(true);
+    }
+
+    // this test will not reclaim rows because the parent xact 
+    // has table level lock.
+    public void testAllUncommittedReclaim() throws Exception
+    {
+        Statement st = createStatement();
+
+        setupForReclaim2(st);
+        assertUpdateCount(st, 1, "delete from foo where foo.a = 1");
+
+        st.executeUpdate("insert into foo values (0, PADSTRING('a',1100), 1)");
+        st.executeUpdate("insert into foo values (1, PADSTRING('a',1100), 1)");
+        rollback();
+
+        st.executeUpdate("drop table foo");
+    }
+
+    // regression test case for Cloudscape fixed bug track 2778
+    // Make sure that an update which causes a row to go from a non long row 
+    // to a long row can be aborted correctly.
+    // Prior to this fix the columns moving off the page would be corrupted. 
+    // create a base table that contains 2 rows, 19 columns,  
+    // that leaves just 1 byte free on the page.
+    // freeSpace: 1, spareSpace: 10, PageSize: 2048
+    public void testCS2778() throws Exception
+    {
+        ResultSet rs = null;
+        CallableStatement cSt;
+        Statement st = createStatement();
+        String [][] expRS;
+        String [] expColNames;
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', '2048')");
+        cSt.execute();
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageReservedSpace', '10')");
+        cSt.execute();
+
+        st.executeUpdate("create table t2778 (" +
+            "col00 char(2), col01 char(1), col02 char(99), col03 char(11), " +
+            "col04 char(7), col05 char(11), col06 char(6), col07 char(6), " +
+            "col08 char(2), col09 char(6), col10 varchar(1000), " +
+            "col11 char(2), col12 char(1), col13 char(7), col14 char(24), " +
+            "col15 char(1), col16 char(166), col17 char(207), col18 char(2))");
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageSize', NULL)");
+        cSt.execute();
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageReservedSpace', NULL)");
+        cSt.execute();
+
+        st.executeUpdate("create unique index a_idx on t2778 (col00)");
+        commit();
+
+        st.executeUpdate("insert into t2778 values ( '0_', '0', '0_col02', " +
+            "'0_col03', '0_col04', '0_col05', '0_06', '0_07', '0_', '0_09', " +
+            "'0_col10lllllllllllllllllllllllllllllllllllllllllllllllllllllll" +
+            "lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll" +
+            "lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll" +
+            "lllllllllll012340_col10lllllllllll', '0_', '0', '0_col13', " +
+            "'0_col14', '0', '0_col16', '0_col17', '0_' )");
+
+        st.executeUpdate("insert into t2778 values ( '1_', '1', '1_col02', " +
+            "'1_col03', '1_col04', '1_col05', '1_06', '1_07', '1_', '1_09', " +
+            "'1_col10lllllllllllllllllllllllllllllllllllllllllllllllllllllll" +
+            "lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll" +
+            "lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll" +
+            "lllllllllll012340_col10llllllllllllllllllllllllllllllllllllllll" +
+            "lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll" +
+            "lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll" +
+            "lllllllllllllllllllllllllllllllllllll012340_col10lllllllllllxxx" +
+            "xxxxxxxxxxxxxxxx', '1_', '1', '1_col13', '1_col14', '1', " +
+            "'1_col16', '1_col17', '1_' )");
+        commit();
+
+        rs = st.executeQuery(" select col16, col17, col18 from t2778");
+        expColNames = new String [] {"COL16", "COL17", "COL18"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{
+            {"0_col16", "0_col17", "0_"},
+            {"1_col16", "1_col17", "1_"}
+                              };
+        JDBC.assertFullResultSet(rs, expRS, true);
+        commit();
+
+        assertUpdateCount(st, 1, "update t2778 " +
+            "/*derby-properties index=a_idx*/ set col10 = " +
+            "'0_col10lllllllllllllllllllllllllllllllllllllllllllllllllllllll" +
+            "lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll" +
+            "lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll" +
+            "lllllllllll012340_col10lllllllllllxxxxxx' " +
+            "where col00 = '0_'");
+        rollback();
+
+        // prior to the fix col17 and col18 would come back null.
+        rs = st.executeQuery("select " +
+            "col01, col02, col03, col04, col05,  col06, " +
+            "col07, col08, col09, col10, col11, col12, col13, " +
+            "col14, col15, col16, col17, col18 from t2778");
+
+        expColNames = new String [] {"COL01", "COL02", "COL03", "COL04", 
+            "COL05", "COL06", "COL07", "COL08", "COL09", "COL10", "COL11",
+            "COL12", "COL13", "COL14", "COL15", "COL16", "COL17", "COL18"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"0", "0_col02", "0_col03", "0_col04", 
+            "0_col05", "0_06", "0_07", "0_", "0_09", 
+            "0_col10llllllllllllllllllllllllllllllllllllllllllllllllllllllll" +
+            "lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll" +
+            "lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll" +
+            "llllllllll012340_col10lllllllllllxxxxxx", 
+            "0_", "0", "0_col13", "0_col14", "0", "0_col16", "0_col17", "0_"},
+                                {"1", "1_col02", "1_col03", "1_col04", 
+            "1_col05", "1_06", "1_07", "1_", "1_09", 
+            "1_col10llllllllllllllllllllllllllllllllllllllllllllllllllllllll" +
+            "lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll" +
+            "lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll" +
+            "llllllllll012340_col10lllllllllllllllllllllllllllllllllllllllll" +
+            "lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll" +
+            "lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll" +
+            "llllllllllllllllllllllllllllllllllll012340_col10lllllllllllxxxx" +
+            "xxxxxxxxxxxxxxx", "1_", "1", "1_col13", "1_col14", "1", 
+            "1_col16", "1_col17", "1_"}
+                              };
+        JDBC.assertFullResultSet(rs, expRS, true);
+        commit();
+
+        st.executeUpdate("drop table t2778");
+        commit();
+    }
+
+    // test case for Cloudscape track 3149, improving max on btree optimization
+    public void testCS3149() throws Exception
+    {
+        ResultSet rs = null;
+        Statement st = createStatement();
+        String [][] expRS;
+        String [] expColNames;        
+
+        setAutoCommit(false);
+        st.executeUpdate("create table foo (a int, b varchar(500), c int)");
+        
+        String insertPart1 = "insert into foo values (";
+        String insertPart2 = ", PADSTRING('";
+        String insertPart3 = "',500), 1)";
+        for (int i=1 ; i<10 ; i++)
+        {
+            String s = String.valueOf(i);
+            st.executeUpdate(insertPart1 + s + insertPart2 + s + insertPart3);
+        }
+        for (int i=11 ; i<19 ; i++)
+        {
+            String s = String.valueOf(i);
+            st.executeUpdate(insertPart1 + s + insertPart2 + s + insertPart3);
+        }
+        st.executeUpdate("create index foox on foo (b)");
+        commit();
+
+        // normal max optimization, last row in index is not deleted.
+        rs = st.executeQuery("select max(b) from foo");
+
+        expColNames = new String [] {"1"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"9"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        // new max optimization, last row in index is deleted but 
+        // others on page aren't.
+        assertUpdateCount(st, 1, "delete from foo where a = 9");
+
+        rs = st.executeQuery("select max(b) from foo");
+
+        expColNames = new String [] {"1"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"8"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        // new max optimization, last row in index is deleted but 
+        // others on page aren't.
+        assertUpdateCount(st, 1, "delete from foo where a = 8");
+
+        rs = st.executeQuery("select max(b) from foo");
+        expColNames = new String [] {"1"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"7"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        // max optimization does not work - fail over to scan, all 
+        // rows on last page are deleted.
+        assertUpdateCount(st, 13, "delete from foo where a > 2");
+
+        rs = st.executeQuery("select max(b) from foo");
+        expColNames = new String [] {"1"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"2"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+        commit();
+
+        st.executeUpdate("drop table foo");
+        commit();
+    }
+
+    //---------------------------------------------------------
+    //         regression test for Cloudscape bugs 3368, 3370  
+    // the bugs arose for the edge case where pageReservedSpace = 100
+    // before bug 3368 was fixed, a short row insert caused 2 pages 
+    // to be allocated per short row insert.
+    public void testCS3368_3370() throws Exception
+    {
+        CallableStatement cSt;
+        Statement st = createStatement();
+
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageReservedSpace', '100')");
+        cSt.execute();
+        st.executeUpdate("create table a (a int)");
+        cSt = prepareCall("call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(" +
+            "'derby.storage.pageReservedSpace', NULL)");
+        cSt.execute();
+
+        st.executeUpdate("insert into a values (1)");
+
+        checkSpaceTable(st, "2");
+
+        st.executeUpdate("insert into a values (2)");
+
+        checkSpaceTable(st, "3");
+
+        st.executeUpdate("insert into a values (1)");
+
+        checkSpaceTable(st, "4");
+
+        st.executeUpdate("insert into a values (2)");
+
+        checkSpaceTable(st, "5");
+    }
+    
+    private void checkSpaceTable(Statement st, String expValue)
+    throws SQLException {
+        ResultSet rs = null;
+        String [][] expRS;
+        
+        rs = st.executeQuery("select numallocatedpages from TABLE" +
+                "(SYSCS_DIAG.SPACE_TABLE('APP', 'A')) a");
+        expRS = new String [][]{{expValue}};
+        JDBC.assertFullResultSet(rs, expRS, true);        
+    }
+
+    //---------------------------------------------------------
+    // regression test for old Cloudscape bug track 4595,
+    // following are 2 test cases that get cycled with 3 different indexes:
+    // 1. unique index
+    // 2. primary key
+    // 3. non unique index
+    // The 2 test cases are:
+    // a. do delete, update and select without any rows (and check statistics)
+    //    then insert a row, and do update and delete
+    // b. do delete, and update after inserting a row (and check stats)
+    //    then do the same selects as in test case a
+    private void doTestCaseCS4595A (Statement st, String indexOrConstraint) 
+    throws SQLException {
+        ResultSet rs = null;
+        String [] expColNames;
+        
+        String indexName;
+        if (indexOrConstraint.equals("Index"))
+            indexName="FOOX";
+        else 
+            indexName=null;
+
+        st.executeUpdate("set ISOLATION to RR");
+        
+        // delete against table with 0 rows.
+        assertUpdateCount(st, 0, "delete from foo where a = 1");
+
+        // make sure index used in unique key update even if table has zero rows.
+        assertStatsOK(st, 
+            indexOrConstraint, "FOO", indexName, 
+            "{0, 1}", "2", "0", "1", "0", "0", "btree",
+            ">= on first 1 column(s).","> on first 1 column(s).","None", null);
+
+        // update against table with 0 rows. 
+        
+        assertUpdateCount(st, 0, "update foo set b = 1 where a = 2");
+
+        assertStatsOK(st, 
+            indexOrConstraint, "FOO", indexName, 
+            "All", "2", "0", "1", "0", "0", "btree",
+            ">= on first 1 column(s).","> on first 1 column(s).","None", null);
+
+        // select * against table with 0 rows. 
+        rs = st.executeQuery("select * from foo where a = 2");
+
+        JDBC.assertEmpty(rs);
+        assertStatsOK(st, 
+            indexOrConstraint, "FOO", indexName, 
+            "All", "2", "0", "1", "0", "0", "btree",
+            ">= on first 1 column(s).","> on first 1 column(s).","None", null);
+
+        // select against table with 0 rows
+        rs = st.executeQuery("select a from foo where a = 2");
+
+        expColNames = new String [] {"A"};
+        JDBC.assertColumnNames(rs, expColNames);
+        JDBC.assertDrainResults(rs, 0);
+        
+        assertStatsOK(st, 
+            indexOrConstraint, "FOO", indexName, 
+            "{0}", "1", "0", "1", "0", "0", "btree",
+            ">= on first 1 column(s).","> on first 1 column(s).","None", null);
+
+        // select against table with 0 rows.
+        // second time should give slightly different statistics; different
+        // set of rows fetched.
+        rs = st.executeQuery("select a from foo where a = 2");
+
+        expColNames = new String [] {"A"};
+        JDBC.assertColumnNames(rs, expColNames);
+        JDBC.assertDrainResults(rs, 0);
+
+        assertStatsOK(st, 
+            indexOrConstraint, "FOO", indexName, 
+            "{0}", "1", "0", "1", "0", "0", "btree",
+            ">= on first 1 column(s).","> on first 1 column(s).","None", null);
+        
+        // now insert one row and make sure still same plan.  
+        // Previous to 4595, 0 row plan was a table scan and it would not 
+        // change when 1 row was inserted.
+        st.execute("insert into foo values (1, 1)");
+
+        // update against table with 1 row.
+        assertUpdateCount(st, 1, "update foo set b = 2 where a = 1");
+
+        assertStatsOK(st, 
+            indexOrConstraint, "FOO", indexName, 
+            "All", "2", "0", "1", "1", "1", "btree",
+            ">= on first 1 column(s).","> on first 1 column(s).","None", null);
+
+        // delete against table with 1 row.
+        st.execute("delete from foo where a = 1");
+
+        assertStatsOK(st, 
+            indexOrConstraint, "FOO", indexName, 
+            "{0, 1}", "2", "0", "1", "1", "1", "btree",
+            ">= on first 1 column(s).","> on first 1 column(s).","None", null);
+
+        st.execute("drop table foo");
+        commit();
+    }
+    
+    private void doTestCaseCS4595B(Statement st, String indexOrConstraint) throws SQLException {
+        ResultSet rs = null;
+        String [] expColNames;
+
+        String indexName;
+        if (indexOrConstraint.equals("Index"))
+            indexName="FOOX";
+        else 
+            indexName=null;
+        
+        commit();
+        
+        // update against table with 1 row.
+        assertUpdateCount(st, 1, "update foo set b = 2 where a = 1");
+
+        assertStatsOK(st, 
+            indexOrConstraint, "FOO", indexName, 
+            "All", "2", "0", "1", "1", "1", "btree",
+            ">= on first 1 column(s).","> on first 1 column(s).","None", null);
+
+        // delete against table with 1 row.
+        st.execute("delete from foo where a = 1");
+
+        assertStatsOK(st, 
+            indexOrConstraint, "FOO", indexName, 
+            "{0, 1}", "2", "0", "1", "1", "1", "btree",
+            ">= on first 1 column(s).","> on first 1 column(s).","None", null);
+        
+        rs = st.executeQuery("select * from foo where a = 2");
+
+        JDBC.assertEmpty(rs);
+        assertStatsOK(st, 
+            indexOrConstraint, "FOO", indexName, 
+            "All", "2", "0", "1", "0", "0", "btree",
+            ">= on first 1 column(s).","> on first 1 column(s).","None", null);
+
+        // select against table with 0 rows
+        rs = st.executeQuery("select a from foo where a = 2");
+
+        expColNames = new String [] {"A"};
+        JDBC.assertColumnNames(rs, expColNames);
+        JDBC.assertDrainResults(rs, 0);
+        
+        assertStatsOK(st, 
+            indexOrConstraint, "FOO", indexName, 
+            "{0}", "1", "0", "1", "0", "0", "btree",
+            ">= on first 1 column(s).","> on first 1 column(s).","None", null);
+
+        // select against table with 0 rows.
+        // second time should give slightly different statistics; different
+        // set of rows fetched.
+        rs = st.executeQuery("select a from foo where a = 2");
+
+        expColNames = new String [] {"A"};
+        JDBC.assertColumnNames(rs, expColNames);
+        JDBC.assertDrainResults(rs, 0);
+
+        assertStatsOK(st, 
+            indexOrConstraint, "FOO", indexName, 
+            "{0}", "1", "0", "1", "0", "0", "btree",
+            ">= on first 1 column(s).","> on first 1 column(s).","None", null);
+
+        st.execute("drop table foo");
+    }
+
+    public void testCS4595A_UniqueIndex() throws Exception
+    {
+        Statement st = createStatement();
+        
+        st.executeUpdate("set ISOLATION to RR");
+        st.execute("call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1)");
+
+        st.executeUpdate("create table foo (a int, b int)");
+        st.executeUpdate("create unique index foox on foo (a)");
+
+        doTestCaseCS4595A(st, "Index");
+    }
+
+    // try delete/update statement compiled against table with 1 row.
+    public void testCS4595B_UniqueIndex() throws Exception
+    {
+        Statement st = createStatement();
+
+        st.executeUpdate("set ISOLATION to RR");
+        st.execute("call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1)");
+
+        st.executeUpdate("create table foo (a int, b int)");
+        // this time, insert a row before creating an index
+        st.executeUpdate("insert into foo values (1, 1)");
+        st.executeUpdate("create unique index foox on foo (a)");
+
+        doTestCaseCS4595B(st, "Index");
+    }
+
+    // repeat set of testCS459_a against table with primary key, 
+    // vs. unique index 
+    // there should be no difference in plan shape. 
+    // try delete/update statement compiled against table with 0 rows
+    public void testCS4595A_PrimaryKey() throws Exception
+    {
+        Statement st = createStatement();
+
+        st.executeUpdate("set ISOLATION to RR");
+        st.execute("call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1)");
+
+        st.executeUpdate(
+            "create table foo (a int not null primary key, b int)");
+        
+        doTestCaseCS4595A(st, "Constraint");
+    }
+
+    // try delete/update statement compiled against table with 1 row.
+    // With primary key.
+    public void testCS4595B_PrimaryKey() throws Exception
+    {
+        Statement st = createStatement();
+        st.executeUpdate("set ISOLATION to RR");
+        st.execute("call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1)");
+        
+        st.executeUpdate(
+            "create table foo (a int not null primary key, b int)");
+        st.executeUpdate("insert into foo values (1, 1)");
+        
+        doTestCaseCS4595B(st, "Constraint");
+    }
+
+    // repeat set of 4595 tests against table with non-unique index 
+    // with no statistics.
+    // there should be no difference in plan shape.
+    // try delete/update statement compiled against table with 0 rows
+    public void testCaseCS4595A_NonUniqueIndex() throws Exception
+    {
+        Statement st = createStatement();
+        st.executeUpdate("set ISOLATION to RR");
+        st.execute("call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1)");
+
+        st.executeUpdate("create table foo (a int, b int)");
+        st.executeUpdate("create index foox on foo (a)");
+
+        doTestCaseCS4595A(st, "Index");
+    }
+
+    // try delete/update statement compiled against table with 1 row.
+    public void testCaseCS4595B_NonUniqueIndex() throws Exception
+    {
+        Statement st = createStatement();
+        st.executeUpdate("set ISOLATION to RR");
+        st.execute("call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1)");
+
+        st.executeUpdate("create table foo (a int, b int)");
+        st.executeUpdate("create index foox on foo (a)");
+        st.executeUpdate("insert into foo values (1, 1)");
+        
+        doTestCaseCS4595B(st, "Index");
+    }
+
+    // ----------------------------------------------------
+    //        simple regression test for qualifier work. 
+    // ----------------------------------------------------
+    public void testQualifiers() throws Exception
+    {
+        ResultSet rs = null;
+        Statement st = createStatement();
+
+        String [][] expRS;
+        String [] expColNames;
+
+        st.executeUpdate("create table foo (a int, b int, c int)");
+        st.executeUpdate("insert into foo values (1, 10, 100)");
+        st.executeUpdate("insert into foo values (2, 20, 200)");
+        st.executeUpdate("insert into foo values (3, 30, 300)");
+
+        // should return no rows
+        rs = st.executeQuery("select a, b, c from foo where a = 1 and b = 20");
+
+        expColNames = new String [] {"A", "B", "C"};
+        JDBC.assertColumnNames(rs, expColNames);
+        JDBC.assertDrainResults(rs, 0);
+
+        // should return one row
+        rs = st.executeQuery("select a, b, c from foo where a = 3 and b = 30");
+
+        expColNames = new String [] {"A", "B", "C"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"3", "30", "300"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        rs = st.executeQuery("select a, b, c from foo where a = 3 or c = 40");
+
+        expColNames = new String [] {"A", "B", "C"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"3", "30", "300"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        // should return 2 rows
+        rs = st.executeQuery("select a, b, c from foo where a = 1 or b = 20");
+
+        expColNames = new String [] {"A", "B", "C"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"1", "10", "100"}, {"2", "20", "200"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        rs = st.executeQuery("select a, b, c from foo where a = 1 or a = 3");
+
+        expColNames = new String [] {"A", "B", "C"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"1", "10", "100"}, {"3", "30", "300"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        st.executeUpdate("DROP FUNCTION PADSTRING");
+
+        rollback();
+        st.close();
+    }
+}
\ No newline at end of file
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/store/_Suite.java b/java/testing/org/apache/derbyTesting/functionTests/tests/store/_Suite.java
index d23080ead..b2d2b0084 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/store/_Suite.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/store/_Suite.java
@@ -65,6 +65,7 @@ public class _Suite extends BaseTestCase  {
         suite.addTest(ClobReclamationTest.suite());
         suite.addTest(IndexSplitDeadlockTest.suite());
         suite.addTest(HoldCursorJDBC30Test.suite());
+        suite.addTest(AccessTest.suite());
         
         /* Tests that only run in sane builds */
         if (SanityManager.DEBUG) {
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/store/access.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/store/access.sql
deleted file mode 100644
index bb6c999b3..000000000
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/store/access.sql
+++ /dev/null
@@ -1,1127 +0,0 @@
---
---   Licensed to the Apache Software Foundation (ASF) under one or more
---   contributor license agreements.  See the NOTICE file distributed with
---   this work for additional information regarding copyright ownership.
---   The ASF licenses this file to You under the Apache License, Version 2.0
---   (the "License"); you may not use this file except in compliance with
---   the License.  You may obtain a copy of the License at
---
---      http://www.apache.org/licenses/LICENSE-2.0
---
---   Unless required by applicable law or agreed to in writing, software
---   distributed under the License is distributed on an "AS IS" BASIS,
---   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
---   See the License for the specific language governing permissions and
---   limitations under the License.
---
-set isolation to RR;
-run resource 'createTestProcedures.subsql';
-
--- by default, holdability of ResultSet objects created using this Connection object is true. Following will set it to false for this connection.
-NoHoldForConnection;
-
-autocommit off;
-
---------------------------------------------------------------------------
--- test qualifier skip code on fields with length having the 8th bit set in low
--- order length byte.
---------------------------------------------------------------------------
-
-drop table a;
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '32768');
-create table a
-    (
-        i1      int,
-        col00   varchar(384),
-        col01   varchar(390),
-        i2      int
-    );
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-
-insert into a values (1, PADSTRING('10',384), PADSTRING('100',390), 1000);
-insert into a values (2, PADSTRING('20',384), PADSTRING('200',390), 2000);
-insert into a values (3, PADSTRING('30',384), PADSTRING('300',390), 3000);
-
-select i1, i2 from a where i2 = 3000;
-
-drop table a;
-
-commit;
-
--- test case for track 2590
---    The problem was that the btree split would self deadlock while trying
---    to reclaim rows during the split.  Fixed by just giving up if btree 
---    can't get the locks during the reclaim try.
-
-
-create table foo (a int, b varchar(900), c int);
-insert into foo values (1, PADSTRING('1',900), 1); 
-insert into foo values (2, PADSTRING('2',900), 1); 
-insert into foo values (3, PADSTRING('3',900), 1); 
-insert into foo values (4, PADSTRING('4',900), 1); 
-insert into foo values (5, PADSTRING('5',900), 1); 
-insert into foo values (6, PADSTRING('6',900), 1); 
-insert into foo values (7, PADSTRING('7',900), 1); 
-insert into foo values (8, PADSTRING('8',900), 1); 
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '4096');
-create index foox on foo (a, b);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-
-commit;
-
-delete from foo where foo.a <> 2;
-
--- Test full cursor for update scan over all the rows in the heap, 
--- with default group fetch.  Group fetch should be disabled.
---------------------------------------------------------------------------------
--- force index until optimizer fixes problem where it does not pick index.
-get cursor scan_cursor as
-    'select a, b, c from foo for update of c';
-
-next scan_cursor;
-
--- these inserts would cause a lock wait timeout before the bug fix.
-insert into foo values (1, PADSTRING('11',900), 1);
-insert into foo values (1, PADSTRING('12',900), 1);
-insert into foo values (1, PADSTRING('13',900), 1);
-insert into foo values (1, PADSTRING('14',900), 1);
-insert into foo values (1, PADSTRING('15',900), 1);
-
-commit;
-
-drop table foo;
-commit;
-
-
-
--- test case for track 735
---    The problem was that when the level of btree grew, raw store would
---    incorrectly report that there was not enough space to move all the
---    rows from the root page to a newly allocated leaf page, so the create
---    index operation would fail with a message saying that a row was too
---    big.
-
--- create and load a table with values from 1024 down to 1, the reverse order
--- is important to reproduce the bug.
-create table foo (a int);
-insert into foo values (1024);
-insert into foo (select foo.a - 1   from foo); 
-insert into foo (select foo.a - 2   from foo); 
-insert into foo (select foo.a - 4   from foo); 
-insert into foo (select foo.a - 8   from foo); 
-insert into foo (select foo.a - 16  from foo); 
-insert into foo (select foo.a - 32  from foo); 
-insert into foo (select foo.a - 64  from foo); 
-insert into foo (select foo.a - 128 from foo); 
-insert into foo (select foo.a - 256 from foo); 
-insert into foo (select foo.a - 512 from foo); 
-
--- this create index use to fail.
-create index a on foo (a);
-
--- Check the consistency of the indexes
-VALUES SYSCS_UTIL.SYSCS_CHECK_TABLE('APP', 'FOO');
-
--- a delete of the whole table also exercises the index well.
-delete from foo;
-
-drop table foo;
-
--- ----------------------------------------------------------------------------
--- stress the conglomerate directory.  abort of an alter table will clear
--- the cache.
--- ----------------------------------------------------------------------------
-autocommit off;
-create table a (a int);
-commit;
-alter table a add column c1 int;
-rollback;
-select * from a;
-drop table a;
-commit;
-
--- ----------------------------------------------------------------------------
--- test case for partial row runtime statistics.
--- ----------------------------------------------------------------------------
-
-create table foo (a int, b int, c int, d int, e int);
-insert into foo values (1, 2, 3, 4, 5);
-insert into foo values (10, 20, 30, 40, 50);
-
-
-call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1);
-maximumdisplaywidth 2500;
-
--- all the columns
-select * from foo;
-
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- just last column - should be 5 and 50
-select e from foo;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- as subset of columns - should be 5,3,1 and 50,30,10
-select e, c, a from foo;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- as subset of columns, with qualifier in list - should be 5,3,1 and 50,30,10
-select e, c, a from foo where foo.e = 5;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- as subset of columns, with qualifier not in list 
---   - should be 5,3,1 and 50,30,10
-select e, c, a from foo where foo.b = 20;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- as subset of columns - should be 1,2 and 10,20
-select a, b from foo;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- now check index scans - force the index just to 
--- make sure it does an index scan.
-create index foo_cover on foo (e, d, c, b, a);
-
--- all the columns
-select * from foo;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- just last column - should be 5 and 50
-select e from foo;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- as subset of columns - should be 5,3,1 and 50,30,10
-select e, c, a from foo;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- as subset of columns, with qualifier in list - should be 5,3,1 and 50, 30, 10
-select e, c, a from foo where foo.e = 5;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- as subset of columns, with qualifier not in list - should be 5,3,1 
--- and 50, 30, 10
-select e, c, a from foo where foo.b = 20;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- as subset of columns - should be 1,2 and 10, 20
-select a, b from foo;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- check deleted row feature
-insert into foo values (100, 2, 3, 4, 5);
-insert into foo values (1000, 2, 3, 4, 5);
-delete from foo where foo.a = 100;
-delete from foo where foo.a = 1000;
-
--- now check with deleted rows involved.
-
--- all the columns
-select * from foo;
-
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- just last column - should be 5 and 50
-select e from foo;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- as subset of columns - should be 5,3,1 and 50,30,10
-select e, c, a from foo;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- as subset of columns, with qualifier in list - should be 5,3,1 and 50,30,10
-select e, c, a from foo where foo.e = 5;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- as subset of columns, with qualifier not in list 
---   - should be 5,3,1 and 50,30,10
-select e, c, a from foo where foo.b = 20;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- as subset of columns - should be 1,2 and 10,20
-select a, b from foo;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- now check index scans - force the index just to 
--- make sure it does an index scan.
-create index foo_cover on foo (e, d, c, b, a);
-
--- all the columns
-select * from foo;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- just last column - should be 5 and 50
-select e from foo;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- as subset of columns - should be 5,3,1 and 50,30,10
-select e, c, a from foo;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- as subset of columns, with qualifier in list - should be 5,3,1 and 50, 30, 10
-select e, c, a from foo where foo.e = 5;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- as subset of columns, with qualifier not in list - should be 5,3,1 
--- and 50, 30, 10
-select e, c, a from foo where foo.b = 20;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- as subset of columns - should be 1,2 and 10, 20
-select a, b from foo;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- ----------------------------------------------------------------------------
--- test case for costing - make sure optimizer picks obvious covered query.
--- ----------------------------------------------------------------------------
-call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1);
-maximumdisplaywidth 2000;
-
-create table base_table (a int, b varchar(1000));
-
-insert into base_table values (1,  PADSTRING('1',1000));
-insert into base_table values (2,  PADSTRING('2',1000));
-insert into base_table values (3,  PADSTRING('3',1000));
-insert into base_table values (4,  PADSTRING('4',1000));
-insert into base_table values (5,  PADSTRING('5',1000));
-insert into base_table values (6,  PADSTRING('6',1000));
-insert into base_table values (7,  PADSTRING('7',1000));
-insert into base_table values (8,  PADSTRING('8',1000));
-insert into base_table values (9,  PADSTRING('9',1000));
-insert into base_table values (10, PADSTRING('10',1000));
-
-create index cover_idx on base_table(a);
-
--- make sure covered index is chosen
-select a from base_table;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- ----------------------------------------------------------------------------
--- test for key too big error message.
--- ----------------------------------------------------------------------------
-create table d (id int not null, t_bigvarchar varchar(400), unique (id));
-create index t_bigvarchar_ind on d ( t_bigvarchar);
-alter table d alter t_bigvarchar set data type varchar(4096);
-insert into d (id, t_bigvarchar) values (1, 
-
-'1111111123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-
-89012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012
-
-34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
-
-890123456789012345678901234567890123456789012345678901234567890123456');
-
-
--- ----------------------------------------------------------------------------
--- test space for update
--- ----------------------------------------------------------------------------
-
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '1024');
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.minimumRecordSize', '1');
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageReservedSpace', '0');
-create table testing (a varchar(100));
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.minimumRecordSize', NULL);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.minimumRecordSize', NULL);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageReservedSpace', NULL);
-
-insert into testing values ('a');
-insert into testing (select testing.a from testing); 
-insert into testing (select testing.a from testing); 
-insert into testing (select testing.a from testing); 
-insert into testing (select testing.a from testing); 
-insert into testing (select testing.a from testing); 
-insert into testing (select testing.a from testing); 
-insert into testing (select testing.a from testing); 
-update testing set a = 'abcd' where a = 'a';
-create index zz on testing (a);
-
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '1024');
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.minimumRecordSize', '1');
-create table t1 (a varchar(100));
-insert into t1 values ('a');
-insert into t1 (select t1.a from t1); 
-insert into t1 (select t1.a from t1); 
-insert into t1 (select t1.a from t1); 
-insert into t1 (select t1.a from t1); 
-insert into t1 (select t1.a from t1); 
-insert into t1 (select t1.a from t1); 
-insert into t1 (select t1.a from t1); 
-update t1 set a = 'abcd' where a = 'a';
-create index zz1 on t1 (a);
-
--- ----------------------------------------------------------------------------
--- test load with long columns with index creation
--- ----------------------------------------------------------------------------
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '1024');
-create table long1 (a varchar(32000), b int, c int);
-insert into long1 values ('this is a long row which will get even longer and longer to force a stream', 1, 2);
-insert into long1 values ('this is another long row which will get even longer and longer to force a stream', 2, 3);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-
-update long1 set a = a||a||a||a||a||a;
-update long1 set a = a||a||a||a||a||a;
-update long1 set a = a||a;
-
-select LENGTH(a) from long1;
-
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '1024');
-create table long2 (a varchar(16384), b int, c int);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '16384');
-create index long2i1 on long2 (a);
-create index long2i2 on long2 (a,b);
-create index long2i3 on long2 (a,b,c);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-
-insert into long2 select * from long1;
-select LENGTH(a) from long2;
-
--- DefectId 1346 
-insert into long2 select * from long1;
-select LENGTH(a) from long2;
-
-delete from long2;
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '1024');
-create index long2small on long2 (a, c);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-
--- this small index should cause the insert to fail
-insert into long2 select * from long1;
-
--- DefectId 1346 
--- the small index should cause this insert to also fail
-insert into long2 select * from long1;
-
-select LENGTH(a) from long2;
---
-
--- test case for track 1346
-drop table long1;
-drop table long2;
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '1024');
-create table long1 (a varchar(32000), b int, c int);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-insert into long1 values
-	('this is a long row which will get even longer', 1, 2);
-insert into long1 values
-	('a second row that will also grow very long', 2, 3);
-update long1 set a = a||a||a||a||a||a;
-update long1 set a = a||a||a||a||a||a;
-update long1 set a = a||a;
-select LENGTH(a) from long1;
-
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '1024');
-create table long2 (a varchar(30000), b int, c int);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '16384');
-create index long2i1 on long2 (a);
-create index long2i2 on long2 (b, a);
-create index long2i3 on long2 (b, a, c);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-insert into long2 select * from long1;
-insert into long2 select * from long1;
-select LENGTH(a) from long2;
-
-drop table long1;
-drop table long2;
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '1024');
-create table long1 (a varchar(32000), b int, c int);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-insert into long1 values
-	('this is a long row which will get even longer', 1, 2);
-insert into long1 values
-	('a second row that will also grow very long', 2, 3);
-update long1 set a = a||a||a||a||a||a;
-update long1 set a = a||a||a||a||a||a;
-update long1 set a = a||a;
-select LENGTH(a) from long1;
-
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '1024');
-create table long2 (a varchar(32000), b int, c int);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '16384');
-create index long2i1 on long2 (a);
-create index long2i2 on long2 (b, a);
-create index long2i3 on long2 (b, a, c);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
--- insert into the second table multiple times
-insert into long2 select * from long1;
-insert into long2 select * from long1;
-insert into long2 select * from long1;
-insert into long2 select * from long1;
-insert into long2 select * from long1;
-insert into long2 select * from long1;
-insert into long2 select * from long1;
-insert into long2 select * from long1;
-insert into long2 select * from long1;
-insert into long2 select * from long1;
-select LENGTH(a) from long2;
-select count(*) from long2;
-
--- test case for track 1552
---    Make sure that a full scan which needs columns not in index does not
---    use the index.  Before the fix, access costing would make the optimizer
---    pick the index because it incorrectly costed rows spanning pages.
-drop table a;
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize','4096');
-create table a (a int, b varchar(4000), c varchar(4000), d varchar(4000)); 
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-create index a_idx on a (a);
-insert into a values (5, PADSTRING('a',4000), PADSTRING('a',4000), PADSTRING('a',4000));
-insert into a values (4, PADSTRING('a',4000), PADSTRING('a',4000), PADSTRING('a',4000));
-insert into a values (3, PADSTRING('a',4000), PADSTRING('a',4000), PADSTRING('a',4000));
-insert into a values (2, PADSTRING('a',4000), PADSTRING('a',4000), PADSTRING('a',4000));
-insert into a values (1, PADSTRING('a',4000), PADSTRING('a',4000), PADSTRING('a',4000));
-
-call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1);
-maximumdisplaywidth 2000;
-
-select a, d from a;
-
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
-autocommit on;
--- test case for track 2241
---    The problem was that when the level of btree grew, sometimes a long
---    row would be chosen as the branch delimiter, and the branch code did
---    not throw the correct error noSpaceForKey error.
-
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.minimumRecordSize', NULL);
-create table b2241 (a int, b varchar(32000));
-insert into b2241 values (1024, '01234567890123456789012345678901234567890123456789');
-
-
-insert into b2241 (select b2241.a + 1  , b from b2241); 
-insert into b2241 (select b2241.a + 2  , b from b2241); 
-insert into b2241 (select b2241.a + 4  , b from b2241); 
-insert into b2241 (select b2241.a + 8  , b from b2241); 
-insert into b2241 (select b2241.a + 16  , b from b2241); 
-insert into b2241 (select b2241.a + 32  , b from b2241); 
-insert into b2241 (select b2241.a + 64  , b from b2241); 
-
-update b2241 set b = b||b;
-update b2241 set b = b||b;
-update b2241 set b = b||b;
-update b2241 set b = b||b;
-update b2241 set b = b||b;
-
-select LENGTH(b) from b2241 where a = 1025;
-
-insert into b2241 (select 1, b||b||b||b||b||b||b||b from b2241 where a = 1024); 
-insert into b2241 (select 8000, b||b||b||b||b||b||b||b from b2241 where a = 1024); 
-
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '4096');
--- this create index use to fail with an assert - 
--- should fail with key too big error.
-create index a on b2241 (b, a);
--- make sure table still accessable
-create index a on b2241 (b, a);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-
--- delete 2 big records and then index should work.
-delete from b2241 where a = 1;
-delete from b2241 where a = 8000;
-create index a on b2241 (b, a);
-
--- Check the consistency of the indexes
-VALUES SYSCS_UTIL.SYSCS_CHECK_TABLE('APP', 'FOO');
-
-drop table b2241;
-
--- test case for reclaiming deleted rows during split.
---    o insert bunch of rows with sequential keys.
---    o create non-unique index.
---    o delete every other one - this will make normat post commit not fire.
---    o commit
---    o now reinsert rows into the "holes" which before the fix would cause
---      splits, but now will force reclaim space and reuse existing space in
---      btree.
-autocommit off;
-
--- set page size back to default.
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '4096');
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.minimumRecordSize', '1');
-
-commit;
-drop table foo;
-drop table foo2;
-
--- create and load a table with values from 1024 down to 1, 
-create table foo (a int, b char(200), c int);
-insert into foo values (1024,             'even', 0);
-insert into foo        (select foo.a - 1, 'odd' , 1 from foo);
-
-insert into foo (select foo.a - 2,   foo.b, foo.c from foo);
-insert into foo (select foo.a - 4,   foo.b, foo.c from foo);
-insert into foo (select foo.a - 8,   foo.b, foo.c from foo);
-insert into foo (select foo.a - 16,  foo.b, foo.c from foo);
-insert into foo (select foo.a - 32,  foo.b, foo.c from foo);
-insert into foo (select foo.a - 64,  foo.b, foo.c from foo);
-insert into foo (select foo.a - 128, foo.b, foo.c from foo);
-insert into foo (select foo.a - 256, foo.b, foo.c from foo);
-insert into foo (select foo.a - 512, foo.b, foo.c from foo);
-
--- insert into the "holes", but different keys (even2 instead of even)
-create table foo2 (a int, b char(200), c int);
-insert into foo2 (select * from foo);
-delete from foo2 where foo2.c = 1;
-
-
--- create "packed" index.
-create index a on foo (a, b);
-
--- delete ever other row
-delete from foo where foo.c = 0;
-
--- turn all the deletes into "committed deletes"
-commit;
-
-
-insert into foo (select foo2.a, 'even2', foo2.c from foo2);
-commit;
-
--- insert dups 
-insert into foo (select foo2.a, 'even2', foo2.c from foo2);
-commit;
-
--- a delete of the whole table also exercises the btree well.
-delete from foo;
-
-drop table foo;
-drop table foo2;
-
--- try same test with unique index.
-
--- create and load a table with values from 1024 down to 1, 
-create table foo (a int, b char(200), c int);
-insert into foo values (1024,             'even', 0);
-insert into foo        (select foo.a - 1, 'odd' , 1 from foo);
-
-insert into foo (select foo.a - 2,   foo.b, foo.c from foo);
-insert into foo (select foo.a - 4,   foo.b, foo.c from foo);
-insert into foo (select foo.a - 8,   foo.b, foo.c from foo);
-insert into foo (select foo.a - 16,  foo.b, foo.c from foo);
-insert into foo (select foo.a - 32,  foo.b, foo.c from foo);
-insert into foo (select foo.a - 64,  foo.b, foo.c from foo);
-insert into foo (select foo.a - 128, foo.b, foo.c from foo);
-insert into foo (select foo.a - 256, foo.b, foo.c from foo);
-insert into foo (select foo.a - 512, foo.b, foo.c from foo);
-
--- insert into the "holes", but different keys (even2 instead of even)
-create table foo2 (a int, b char(200), c int);
-insert into foo2 (select * from foo);
-delete from foo2 where foo2.c = 1;
-
-
--- create "packed" unique index.
-create unique index a on foo (a, b);
-
--- delete ever other row
-delete from foo where foo.c = 0;
-
--- turn all the deletes into "committed deletes"
-commit;
-
-
-insert into foo (select foo2.a, 'even2', foo2.c from foo2);
-commit;
-
--- insert dups will cause error
-insert into foo (select foo2.a, 'even2', foo2.c from foo2);
-commit;
-
--- a delete of the whole table also exercises the btree well.
-delete from foo;
-
-drop table foo;
-drop table foo2;
-commit;
-
--- another simple test of reclaim deleted row code paths.
--- this test should not reclaim rows as deletes are not committed.
-
-
-create table foo (a int, b varchar(1100), c int);
-create index a on foo (a, b);
-insert into foo values (1, PADSTRING('a',1100), 1);
-insert into foo values (2, PADSTRING('a',1100), 1);
-insert into foo values (3, PADSTRING('a',1100), 1);
-commit;
-delete from foo where foo.a = 1;
-delete from foo where foo.a = 2;
-insert into foo values (-1, PADSTRING('ab',1100), 1);
-insert into foo values (-2, PADSTRING('ab',1100), 1);
-rollback;
-
-drop table foo;
-
--- another simple test of reclaim deleted row code paths.
--- this test should reclaim rows as deletes are not committed.
-
-create table foo (a int, b varchar(1100), c int);
-create index a on foo (a, b);
-insert into foo values (1, PADSTRING('a',1100), 1);
-insert into foo values (2, PADSTRING('a',1100), 1);
-insert into foo values (3, PADSTRING('a',1100), 1);
-commit;
-delete from foo where foo.a = 1;
-delete from foo where foo.a = 2;
-commit;
-insert into foo values (-1, PADSTRING('ab',1100), 1);
-insert into foo values (-2, PADSTRING('ab',1100), 1);
-rollback;
-
-drop table foo;
-
--- this test will not reclaim rows because the parent xact has table level lock.
-create table foo (a int, b varchar(1100), c int);
-create index a on foo (a, b);
-insert into foo values (1, PADSTRING('a',1100), 1);
-insert into foo values (2, PADSTRING('a',1100), 1);
-insert into foo values (3, PADSTRING('a',1100), 1);
-delete from foo where foo.a = 1;
-insert into foo values (0, PADSTRING('a',1100), 1);
-insert into foo values (1, PADSTRING('a',1100), 1);
-rollback;
-drop table foo;
-
--- test case for track 2778
---    Make sure that an update which causes a row to go from a non long row
---    to a long row can be aborted correctly.  Prior to this fix the columns
---    moving off the page would be corrupted.
-
--- create a base table that contains 2 rows, 19 columns, that leaves just
--- 1 byte free on the page.  freeSpace: 1, spareSpace: 10, PageSize: 2048
-
-drop table t2778;
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', '2048');
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageReservedSpace', '10');
-create table t2778 
-    (
-        col00 char(2),
-        col01 char(1),
-        col02 char(99),
-        col03 char(11),
-        col04 char(7),
-        col05 char(11),
-        col06 char(6),
-        col07 char(6),
-        col08 char(2),
-        col09 char(6),
-        col10 varchar(1000),
-        col11 char(2),
-        col12 char(1),
-        col13 char(7),
-        col14 char(24),
-        col15 char(1),
-        col16 char(166),
-        col17 char(207),
-        col18 char(2)
-    );
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageSize', NULL);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageReservedSpace', NULL);
-
-create unique index a_idx on t2778 (col00);
-
-commit;
-
-insert into t2778 values (
-        '0_',
-        '0',
-        '0_col02',
-        '0_col03',
-        '0_col04',
-        '0_col05',
-        '0_06',
-        '0_07',
-        '0_',
-        '0_09',
-        '0_col10llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll012340_col10lllllllllll',
-        '0_',
-        '0',
-        '0_col13',
-        '0_col14',
-        '0',
-        '0_col16',
-        '0_col17',
-        '0_'
-        );
-
-insert into t2778 values (
-        '1_',
-        '1',
-        '1_col02',
-        '1_col03',
-        '1_col04',
-        '1_col05',
-        '1_06',
-        '1_07',
-        '1_',
-        '1_09',
-        '1_col10llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll012340_col10lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll012340_col10lllllllllllxxxxxxxxxxxxxxxxxxx',
-        '1_',
-        '1',
-        '1_col13',
-        '1_col14',
-        '1',
-        '1_col16',
-        '1_col17',
-        '1_'
-        );
-
-commit;
-
-select col16, col17, col18 from t2778; 
-
-commit;
-
-update t2778 --derby-properties index = a_idx 
-    set col10 = 
-        '0_col10llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll012340_col10lllllllllllxxxxxx'
-    where col00 = '0_';
-
-rollback;
-
--- prior to the fix col17 and col18 would come back null.
-select col01, col02, col03, col04, col05,  col06, col07, col08, col09, col10, col11, col12, col13, col14, col15, col16, col17, col18 from t2778; 
-
-commit;
-
-
-
--- test case for track 3149, improving max on btree optimization
-autocommit off;
-
-create table foo (a int, b varchar(500), c int);
-insert into foo values (1, PADSTRING('1',500), 1); 
-insert into foo values (11, PADSTRING('11',500), 1); 
-insert into foo values (12, PADSTRING('12',500), 1); 
-insert into foo values (13, PADSTRING('13',500), 1); 
-insert into foo values (14, PADSTRING('14',500), 1); 
-insert into foo values (15, PADSTRING('15',500), 1); 
-insert into foo values (16, PADSTRING('16',500), 1); 
-insert into foo values (17, PADSTRING('17',500), 1); 
-insert into foo values (18, PADSTRING('18',500), 1); 
-insert into foo values (2, PADSTRING('2',500), 1); 
-insert into foo values (3, PADSTRING('3',500), 1); 
-insert into foo values (4, PADSTRING('4',500), 1); 
-insert into foo values (5, PADSTRING('5',500), 1); 
-insert into foo values (6, PADSTRING('6',500), 1); 
-insert into foo values (7, PADSTRING('7',500), 1); 
-insert into foo values (8, PADSTRING('8',500), 1); 
-insert into foo values (9, PADSTRING('9',500), 1); 
-create index foox on foo (b);
-
-commit;
-
--- normal max optimization, last row in index is not deleted.
-select max(b) from foo;
-
--- new max optimization, last row in index is deleted but others on page aren't.
-delete from foo where a = 9;
-select max(b) from foo;
-
--- new max optimization, last row in index is deleted but others on page aren't.
-delete from foo where a = 8;
-select max(b) from foo;
-
--- max optimization does not work - fail over to scan, all rows on last page are
--- deleted.
-delete from foo where a > 2;
-select max(b) from foo;
-commit;
-
-drop table foo;
-
-------------------------------------------------------------------------
--- regression test for bugs 3368, 3370
--- the bugs arose for the edge case where pageReservedSpace = 100
--- before bug 3368 was fixed, a short row insert caused 2 pages to be
--- allocated per short row insert.
-
-drop table a;
-
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageReservedSpace', '100');
-create table a (a int);
-call SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY('derby.storage.pageReservedSpace', NULL);
-
-insert into a values (1);
-select numallocatedpages from new org.apache.derby.diag.SpaceTable('A') as a;
-
-insert into a values (2);
-select numallocatedpages from new org.apache.derby.diag.SpaceTable('A') as a;
-
-insert into a values (1);
-select numallocatedpages from new org.apache.derby.diag.SpaceTable('A') as a;
-
-insert into a values (2);
-select numallocatedpages from new org.apache.derby.diag.SpaceTable('A') as a;
-
-------------------------------------------------------------------------
--- regression test for bug 4595, make sure index used in unique key update
--- even if table has zero rows.
---
-
-call SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1);
-maximumdisplaywidth 9000;
-
--- try delete/update statement compiled against table with 0 rows
-drop table foo;
-create table foo (a int, b int);
-create unique index foox on foo (a);
-
--- delete against table with 0 rows.
-delete from foo where a = 1;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- update against table with 0 rows.
-update foo set b = 1 where a = 2;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- select against table with 0 rows.
-select * from foo where a = 2;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- select against table with 0 rows.
-select a from foo where a = 2;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- select against table with 0 rows.
-select a from foo where a = 2;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- now insert one row and make sure still same plan.  Previous to 4595 
--- 0 row plan was a table scan and it would not change when 1 row was inserted.
-insert into foo values (1, 1);
-
-
--- update against table with 1 row.
-update foo set b = 2 where a = 1;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- delete against table with 1 row.
-delete from foo where a = 1;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- try delete/update statement compiled against table with 1 row.
-drop table foo;
-create table foo (a int, b int);
-insert into foo values (1, 1);
-create unique index foox on foo (a);
-
--- update against table with 1 row.
-update foo set b = 2 where a = 1;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- delete against table with 1 row.
-delete from foo where a = 1;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- repeat set of 4595 tests against table with primary key, vs. unique index - 
--- there should be no difference in plan shape.
-
--- try delete/update statement compiled against table with 0 rows
-drop table foo;
-create table foo (a int not null primary key, b int);
-
--- delete against table with 0 rows.
-delete from foo where a = 1;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- update against table with 0 rows.
-update foo set b = 1 where a = 2;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- select against table with 0 rows.
-select * from foo where a = 2;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- select against table with 0 rows.
-select a from foo where a = 2;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- select against table with 0 rows.
-select a from foo where a = 2;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- now insert one row and make sure still same plan.  Previous to 4595 
--- 0 row plan was a table scan and it would not change when 1 row was inserted.
-insert into foo values (1, 1);
-
-
--- update against table with 1 row.
-update foo set b = 2 where a = 1;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- delete against table with 1 row.
-delete from foo where a = 1;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- try delete/update statement compiled against table with 1 row.
-drop table foo;
-create table foo (a int not null primary key, b int);
-insert into foo values (1, 1);
-
--- update against table with 1 row.
-update foo set b = 2 where a = 1;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- delete against table with 1 row.
-delete from foo where a = 1;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- select against table with 1 row.
-select * from foo where a = 2;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- select against table with 1 row.
-select a from foo where a = 2;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- select against table with 1 row.
-select a from foo where a = 2;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- repeat set of 4595 tests against table with non-unique index with no
--- statistics.
-
--- there should be no difference in plan shape.
-
--- try delete/update statement compiled against table with 0 rows
-drop table foo;
-create table foo (a int, b int);
-create index foox on foo (a);
-
--- delete against table with 0 rows.
-delete from foo where a = 1;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- update against table with 0 rows.
-update foo set b = 1 where a = 2;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- select against table with 0 rows.
-select * from foo where a = 2;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- select against table with 0 rows.
-select a from foo where a = 2;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- select against table with 0 rows.
-select a from foo where a = 2;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- now insert one row and make sure still same plan.  Previous to 4595 
--- 0 row plan was a table scan and it would not change when 1 row was inserted.
-insert into foo values (1, 1);
-
--- update against table with 1 row.
-update foo set b = 2 where a = 1;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- delete against table with 1 row.
-delete from foo where a = 1;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- try delete/update statement compiled against table with 1 row.
-drop table foo;
-create table foo (a int, b int);
-create index foox on foo (a);
-insert into foo values (1, 1);
-
--- update against table with 1 row.
-update foo set b = 2 where a = 1;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- delete against table with 1 row.
-delete from foo where a = 1;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- select against table with 1 row.
-select * from foo where a = 2;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- select against table with 1 row.
-select a from foo where a = 2;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
--- select against table with 1 row.
-select a from foo where a = 2;
-values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
-
-------------------------------------------------------------------------
--- simple regression test for qualifier work.
-------------------------------------------------------------------------
-drop table foo;
-commit;
-
-create table foo (a int, b int, c int);
-insert into foo values (1, 10, 100);
-insert into foo values (2, 20, 200);
-insert into foo values (3, 30, 300);
-
--- should return no rows
-select a, b, c from foo where a = 1 and b = 20;
-
--- should return one row
-select a, b, c from foo where a = 3 and b = 30;
-select a, b, c from foo where a = 3 or c = 40;
-
--- should return 2 rows
-select a, b, c from foo where a = 1 or b = 20;
-select a, b, c from foo where a = 1 or a = 3;
-
-DROP FUNCTION PADSTRING;
-DROP PROCEDURE WAIT_FOR_POST_COMMIT;
-exit;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/store/access_app.properties b/java/testing/org/apache/derbyTesting/functionTests/tests/store/access_app.properties
deleted file mode 100644
index c932ad417..000000000
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/store/access_app.properties
+++ /dev/null
@@ -1,18 +0,0 @@
-# Licensed to the Apache Software Foundation (ASF) under one or more
-# contributor license agreements.  See the NOTICE file distributed with
-# this work for additional information regarding copyright ownership.
-# The ASF licenses this file to you under the Apache License, Version 2.0
-# (the "License"); you may not use this file except in compliance with
-# the License.  You may obtain a copy of the License at
-#
-#     http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-
-usedefaults=true
-
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/store/access_derby.properties b/java/testing/org/apache/derbyTesting/functionTests/tests/store/access_derby.properties
deleted file mode 100644
index 744b9a29e..000000000
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/store/access_derby.properties
+++ /dev/null
@@ -1,26 +0,0 @@
-# Licensed to the Apache Software Foundation (ASF) under one or more
-# contributor license agreements.  See the NOTICE file distributed with
-# this work for additional information regarding copyright ownership.
-# The ASF licenses this file to you under the Apache License, Version 2.0
-# (the "License"); you may not use this file except in compliance with
-# the License.  You may obtain a copy of the License at
-#
-#     http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-# statement cache size of 20 is the default, do not add this property
-# to this file.  If your test wants to do consistency checking that
-# requires an empty cache, add a special .properties file, see
-# lang/inbetween.properties for an example.
-#
-# derby.language.statementCacheSize=20
-derby.infolog.append=true
-derby.optimizer.optimizeJoinOrder=false
-derby.optimizer.ruleBasedOptimization=true
-derby.optimizer.noTimeout=true
-#derby.language.logStatementText=true
diff --git a/java/testing/org/apache/derbyTesting/junit/RuntimeStatisticsParser.java b/java/testing/org/apache/derbyTesting/junit/RuntimeStatisticsParser.java
index 06919989b..a70a4fd31 100644
--- a/java/testing/org/apache/derbyTesting/junit/RuntimeStatisticsParser.java
+++ b/java/testing/org/apache/derbyTesting/junit/RuntimeStatisticsParser.java
@@ -35,6 +35,8 @@ public class RuntimeStatisticsParser {
     private String statistics = "";
     private boolean scrollInsensitive = false;
     private final HashSet qualifiers;
+    private String [] startPosition = {"None"};
+    private String [] stopPosition = {"None"};
 
     /**
      * Create a RuntimeStatistics object to parse the text and extract
@@ -75,6 +77,9 @@ public class RuntimeStatisticsParser {
             scrollInsensitive = true;
 
         qualifiers = findQualifiers();
+        
+        startPosition = getStartPosition();
+        stopPosition = getStopPosition();
     }
     
 
@@ -206,9 +211,17 @@ public class RuntimeStatisticsParser {
                     tableName + " ")!= -1);
     }
     
+    /**
+     * @param tableName
+     * @param indexName
+     * @return true if passed indexName was used for Index Scan ResultSet 
+     *     for the passed tableName
+     */
+    public boolean usedConstraintForIndexScan(String tableName){
+        return (statistics.indexOf("Index Scan ResultSet for " + 
+                    tableName + " using constraint")!= -1);
+    }
     
-    
-
     /**
      * Return whether or not an index scan result set was used in the query.
      */
@@ -281,8 +294,36 @@ public class RuntimeStatisticsParser {
     public boolean hasLessThanQualifier() {
         return qualifiers.contains(new Qualifier("<", false));
     }
-  
     
+    /**
+     * Return whether or not the query used an equals scan qualifier.
+     */
+    public boolean hasEqualsQualifier() {
+        return qualifiers.contains(new Qualifier("=", false));
+    }
+    
+    /**
+     * Return whether there are no qualifiers (i.e. qualifiers: None)
+     */
+    public boolean hasNoQualifiers() {
+        int startPos = statistics.indexOf("qualifiers:\n");
+        if (startPos >= 0) {
+            // start search after "qualifiers:\n"
+            String searchString = statistics.substring(startPos + 12);
+            if (searchString.indexOf("None")>1)
+                return true;
+            else
+            {
+                System.out.println("statistics.substring: " + searchString);
+                return false;
+            }
+        }
+        else {
+            throw new AssertionError(
+                    "Expected to find \"qualifiers: None\", " +
+                    "but didn't even find 'qualifiers'");
+        }
+    }  
 
     /**
      * Return whether or not the query plan includes a line of the form
@@ -365,5 +406,41 @@ public class RuntimeStatisticsParser {
     public String toString() {
         return statistics;
     }
+    
+    /**
+     * Find the start position ; sometimes using a scan start / stop is
+     * a way of doing qualifiers using an index
+     * @ return the String array following start position:
+     */
+    public String [] getStartPosition() {
+        int startStartIndex = statistics.indexOf("start position:");
+        int endStartIndex = statistics.indexOf("stop position:");
+        if (startStartIndex >= 0 && endStartIndex >= 0)
+        {
+            String positionLines = statistics.substring(startStartIndex, endStartIndex);
+            String [] startPositionLines = positionLines.split("\n");
+            return startPositionLines;}
+        else 
+            return null;
+        
+    }
+
+    /**
+     * Find the stop position ; sometimes using a scan start / stop is
+     * a way of doing qualifiers using an index
+     * @ return the String array following start position:
+     */
+    public String [] getStopPosition() {
+        int startStopIndex = statistics.indexOf("stop position:");
+        int endStopIndex = statistics.indexOf("qualifiers:");
+        if (startStopIndex >= 0 && endStopIndex >= 0)
+        {
+            String positionLines = statistics.substring(startStopIndex, endStopIndex);
+            String [] startPositionLines = positionLines.split("\n");
+            return startPositionLines;}
+        else 
+            return null;
+    }
+
 }
     
