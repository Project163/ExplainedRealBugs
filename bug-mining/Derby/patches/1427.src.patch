diff --git a/java/engine/org/apache/derby/impl/sql/compile/ModifyColumnNode.java b/java/engine/org/apache/derby/impl/sql/compile/ModifyColumnNode.java
index 69ca27b2b..a9db81a6e 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/ModifyColumnNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/ModifyColumnNode.java
@@ -188,18 +188,20 @@ public class ModifyColumnNode extends ColumnDefinitionNode
 			}	
 			else
 			{
-				//if a column is part of unique constraint it can't be
-				//made nullable in soft upgrade mode from a pre-10.4 db.
-				if ((existingConstraint.getConstraintType() == 
-								DataDictionary.UNIQUE_CONSTRAINT)) 
-                {
-					if (!dd.checkVersion(
-							DataDictionary.DD_VERSION_DERBY_10_4, null))
-                    {
+				if (!dd.checkVersion(
+					DataDictionary.DD_VERSION_DERBY_10_4, null)) 
+				{
+					//if a column is part of unique constraint it can't be
+					//made nullable in soft upgrade mode from a pre-10.4 db.
+					if ((getNodeType() == 
+						C_NodeTypes.MODIFY_COLUMN_CONSTRAINT_NODE) &&
+						(existingConstraint.getConstraintType() == 
+							DataDictionary.UNIQUE_CONSTRAINT)) 
+					{
 						throw StandardException.newException(
-								SQLState.LANG_MODIFY_COLUMN_EXISTING_CONSTRAINT,
-								name);
-                    }
+							SQLState.LANG_MODIFY_COLUMN_EXISTING_CONSTRAINT,
+							name);
+					}
 				}
 
 				// a column that is part of a primary key
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/upgradeTests/Changes10_4.java b/java/testing/org/apache/derbyTesting/functionTests/tests/upgradeTests/Changes10_4.java
index 81d28ee66..b752bdf36 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/upgradeTests/Changes10_4.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/upgradeTests/Changes10_4.java
@@ -721,4 +721,31 @@ public class Changes10_4 extends UpgradeChange {
                 break;
         }
     }
+    
+    /**
+     * Tests if alter column works for a column in unique constraint.
+     */
+    public void testAlterColumnOfUniqueConstraint () throws Exception {
+        Statement stmt = createStatement();
+        switch (getPhase()) {
+           case PH_CREATE:
+               stmt.executeUpdate("create table datatype_test (fl1 varchar (2) " +
+                       "not null)");
+               stmt.executeUpdate("alter table datatype_test " +
+                       "add constraint ucon_datatype_test unique (fl1)");
+               stmt.executeUpdate("alter table datatype_test alter column fl1" +
+                       " set data type varchar (3)");
+               break;
+           case PH_SOFT_UPGRADE:
+               stmt.executeUpdate("alter table datatype_test alter column fl1 " +
+                       " set data type varchar (4)");
+               break;
+
+           case PH_HARD_UPGRADE:
+               stmt.executeUpdate("alter table datatype_test alter column fl1 " +
+                       " set data type varchar (5)");
+               break;
+        }
+        stmt.close();
+    }
 }
