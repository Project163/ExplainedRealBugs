diff --git a/java/engine/org/apache/derby/impl/load/ExportWriteData.java b/java/engine/org/apache/derby/impl/load/ExportWriteData.java
index 0cd4ad035..53be1273f 100644
--- a/java/engine/org/apache/derby/impl/load/ExportWriteData.java
+++ b/java/engine/org/apache/derby/impl/load/ExportWriteData.java
@@ -103,28 +103,62 @@ final class ExportWriteData extends ExportWriteDataAbstract
 		  lobsFileName = url.getFile();
 	  }
     } catch (MalformedURLException ex) {}
-    FileOutputStream anOutputStream = new FileOutputStream(outputFileName);
-    BufferedOutputStream buffered = new BufferedOutputStream(anOutputStream);
+
+    
+    FileOutputStream anOutputStream = null;
+    BufferedOutputStream buffered = null;
+    FileOutputStream lobOutputStream = null;
+
+    try {
+        anOutputStream = new FileOutputStream(outputFileName);
+        buffered = new BufferedOutputStream(anOutputStream);
     
-    aStream = dataCodeset == null ?
+        aStream = dataCodeset == null ?
     		new OutputStreamWriter(buffered) :
     		new OutputStreamWriter(buffered, dataCodeset);    	        
 
-    // if lobs are exported to an external file, then 
-    // setup the required streams to write lob data.
-    if (lobsInExtFile) 
-    {
-        // setup streams to write large objects into the external file. 
-        FileOutputStream lobOutputStream = new FileOutputStream(lobsFileName);
-        lobOutBinaryStream = new BufferedOutputStream(lobOutputStream);
-
-        // helper stream to convert char data to binary, after conversion
-        // data is written to lobOutBinaryStream.
-        lobByteArrayStream = new ByteArrayOutputStream();
-        lobCharStream =  dataCodeset == null ?
-            new OutputStreamWriter(lobByteArrayStream) :
-            new OutputStreamWriter(lobByteArrayStream, dataCodeset);    	        
-	}
+        // if lobs are exported to an external file, then 
+        // setup the required streams to write lob data.
+        if (lobsInExtFile) 
+        {
+            // setup streams to write large objects into the external file. 
+            lobOutputStream = new FileOutputStream(lobsFileName);
+            lobOutBinaryStream = new BufferedOutputStream(lobOutputStream);
+
+            // helper stream to convert char data to binary, after conversion
+            // data is written to lobOutBinaryStream.
+            lobByteArrayStream = new ByteArrayOutputStream();
+            lobCharStream =  dataCodeset == null ?
+                new OutputStreamWriter(lobByteArrayStream) :
+                new OutputStreamWriter(lobByteArrayStream, dataCodeset);    	        
+        }
+    } catch (Exception e) {
+        // might have failed to setup export file stream. for example 
+        // user has specified invalid codeset or incorrect file path. 
+        // close the opened file streams.
+
+        if (aStream == null) {
+            if (buffered != null) {
+                buffered.close();
+            } else {
+                if(anOutputStream != null)
+                    anOutputStream .close();
+            }
+        } else {
+            // close the main export file stream.
+            aStream.close();
+            // close the external lob file stream.
+            if (lobOutBinaryStream != null) {
+                lobOutBinaryStream.close() ;
+            } else {
+                if (lobOutputStream != null) 
+                    lobOutputStream.close();
+            }
+        }
+
+        // throw back the original exception.
+        throw e;
+    }
   }
 
   /**if control file says true for column definition, write it as first line of the
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/tools/ImportExportTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/tools/ImportExportTest.java
index f315c7e3e..d42cdcc8a 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/tools/ImportExportTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/tools/ImportExportTest.java
@@ -151,10 +151,7 @@ public class ImportExportTest extends BaseJDBCTestCase {
 		doImportAndExport(c, "T1", "%", "&", "UTF-16");
 	}
 	
-    /* This test is disabled temporarily due to bug : DERBY-2456 .
-     * Remove the prefix "derby2456"  when the bug is fixed.
-     */
-	public void derby2456testInvalidEncoding() throws Exception {
+	public void testInvalidEncoding() throws Exception {
 		Connection c = getConnection();
 		resetTables();
 		try {
