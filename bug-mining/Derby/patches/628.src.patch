diff --git a/frameworks/NetworkServer/bin/NetworkServerControl.bat b/frameworks/NetworkServer/bin/NetworkServerControl.bat
index b0e4b0dcf..4ed10565c 100755
--- a/frameworks/NetworkServer/bin/NetworkServerControl.bat
+++ b/frameworks/NetworkServer/bin/NetworkServerControl.bat
@@ -36,13 +36,10 @@ rem set DERBY_INSTALL=
 @if "%JAVA_HOME%"=="" goto nojavahome
 @if not exist "%JAVA_HOME%\bin\java.exe" goto nojavahome
 
-@if !"%CLASSPATH%"==! call "%DERBY_HOME%"/frameworks/NetworkServer/bin/setNetworkServerCP.bat
-@if "%CLASSPATH%" == "" call "%DERBY_HOME%"/frameworks/NetworkServer/bin/setNetworkServerCP.bat
-
 @REM ---------------------------------------------------------
 @REM -- start Derby as a Network server
 @REM ---------------------------------------------------------
-"%JAVA_HOME%\bin\java" org.apache.derby.drda.NetworkServerControl %*
+"%JAVA_HOME%\bin\java" -cp "%DERBY_HOME%\lib\derby.jar;%DERBY_HOME%\lib\derbytools.jar;%DERBY_HOME%\lib\derbynet.jar;%CLASSPATH%" org.apache.derby.drda.NetworkServerControl %*
 @goto end
 
 @REM ---------------------------------------------------------
diff --git a/frameworks/NetworkServer/bin/NetworkServerControl.ksh b/frameworks/NetworkServer/bin/NetworkServerControl.ksh
index 3579f6207..a0b016295 100755
--- a/frameworks/NetworkServer/bin/NetworkServerControl.ksh
+++ b/frameworks/NetworkServer/bin/NetworkServerControl.ksh
@@ -48,15 +48,11 @@ DERBY_HOME=${DERBY_HOME:-$DERBY_INSTALL}
   }
 } 
 
-[ -z "$CLASSPATH" ] && {
-  . "$DERBY_HOME"/frameworks/NetworkServer/bin/setNetworkServerCP.ksh
-}
-
 # ---------------------------------------------------------
 # -- start Derby Network Server
 # ---------------------------------------------------------
 
-"$JAVA_HOME/bin/java" org.apache.derby.drda.NetworkServerControl $*
+"$JAVA_HOME/bin/java" -cp "${DERBY_HOME}/lib/derby.jar:${DERBY_HOME}/lib/derbytools.jar:${DERBY_HOME}/lib/derbynet.jar:${CLASSPATH}" org.apache.derby.drda.NetworkServerControl $*
 
 
 # ---------------------------------------------------------
diff --git a/frameworks/NetworkServer/bin/dblook.bat b/frameworks/NetworkServer/bin/dblook.bat
index c04abb34e..8f458d422 100755
--- a/frameworks/NetworkServer/bin/dblook.bat
+++ b/frameworks/NetworkServer/bin/dblook.bat
@@ -35,13 +35,10 @@ rem set DERBY_INSTALL=
 @if "%JAVA_HOME%"=="" goto nojavahome
 @if not exist "%JAVA_HOME%\bin\java.exe" goto nojavahome
 
-if !"%CLASSPATH%"==! call "%DERBY_HOME%"/frameworks/NetworkServer/bin/setNetworkClientCP.bat
-if "%CLASSPATH%" == "" call "%DERBY_HOME%"/frameworks/NetworkServer/bin/setNetworkClientCP.bat
-
 @REM ---------------------------------------------------------
 @REM -- start dblook
 @REM ---------------------------------------------------------
-"%JAVA_HOME%\bin\java" org.apache.derby.tools.dblook %*
+"%JAVA_HOME%\bin\java" -cp "%DERBY_HOME%\lib\derbyclient.jar;%DERBY_HOME%\lib\derbytools.jar;%CLASSPATH%" org.apache.derby.tools.dblook %*
 @GOTO end
 
 @REM ---------------------------------------------------------
diff --git a/frameworks/NetworkServer/bin/dblook.ksh b/frameworks/NetworkServer/bin/dblook.ksh
index 2b849aa37..a1f7f7f6d 100755
--- a/frameworks/NetworkServer/bin/dblook.ksh
+++ b/frameworks/NetworkServer/bin/dblook.ksh
@@ -48,14 +48,10 @@ DERBY_HOME=${DERBY_HOME:-$DERBY_INSTALL}
   }
 } 
 
-[ -z "$CLASSPATH" ] && {
-  . "$DERBY_HOME"/frameworks/NetworkServer/bin/setNetworkClientCP.ksh
-}
-
 # ---------------------------------------------------------
 # -- start dblook
 # ---------------------------------------------------------
-"$JAVA_HOME/bin/java" org.apache.derby.tools.dblook $@
+"$JAVA_HOME/bin/java" -cp "${DERBY_HOME}/lib/derbyclient.jar:${DERBY_HOME}/lib/derbytools.jar:${CLASSPATH}" org.apache.derby.tools.dblook $@
 
 # ---------------------------------------------------------
 # -- To use a different JVM with a different syntax, simply edit
diff --git a/frameworks/NetworkServer/bin/ij.bat b/frameworks/NetworkServer/bin/ij.bat
index 9cd258ccb..134dd6724 100755
--- a/frameworks/NetworkServer/bin/ij.bat
+++ b/frameworks/NetworkServer/bin/ij.bat
@@ -38,9 +38,6 @@ rem set DERBY_INSTALL=
 @if "%JAVA_HOME%"=="" goto nojavahome
 @if not exist "%JAVA_HOME%\bin\java.exe" goto nojavahome
 
-@if !"%CLASSPATH%"==! call "%DERBY_HOME%"/frameworks/NetworkServer/bin/setNetworkClientCP.bat
-@if "%CLASSPATH%" == "" call "%DERBY_HOME%"/frameworks/NetworkServer/bin/setNetworkClientCP.bat
-
 set IJ_HOST=localhost
 set IJ_PORT=1527
 set IJ_USER=APP
@@ -50,8 +47,7 @@ set IJ_PASSWORD=APP
 @REM -- start ij
 @REM -- host, port, user and password may need to be changed
 @REM ---------------------------------------------------------
-@echo on
-"%JAVA_HOME%\bin\java" -Dij.driver=org.apache.derby.jdbc.ClientDriver -Dij.protocol=jdbc:derby://%IJ_HOST%:%IJ_PORT%/ -Dij.user=%IJ_USER% -Dij.password=%IJ_PASSWORD%  org.apache.derby.tools.ij
+"%JAVA_HOME%\bin\java" -cp "%DERBY_HOME%\lib\derbyclient.jar;%DERBY_HOME%\lib\derbytools.jar;%CLASSPATH%" -Dij.driver=org.apache.derby.jdbc.ClientDriver -Dij.protocol=jdbc:derby://%IJ_HOST%:%IJ_PORT%/ -Dij.user=%IJ_USER% -Dij.password=%IJ_PASSWORD%  org.apache.derby.tools.ij
 @goto end
 
 @REM ---------------------------------------------------------
diff --git a/frameworks/NetworkServer/bin/ij.ksh b/frameworks/NetworkServer/bin/ij.ksh
index 20ba61bcd..5e958962a 100755
--- a/frameworks/NetworkServer/bin/ij.ksh
+++ b/frameworks/NetworkServer/bin/ij.ksh
@@ -48,10 +48,6 @@ DERBY_HOME=${DERBY_HOME:-$DERBY_INSTALL}
   }
 } 
 
-[ -z "$CLASSPATH" ] && {
-  . "$DERBY_HOME"/frameworks/NetworkServer/bin/setNetworkClientCP.ksh
-}
- 
 export IJ_HOST=localhost
 export IJ_PORT=1527
 export IJ_USER=APP
@@ -60,7 +56,7 @@ export IJ_PASSWORD=APP
 # ---------------------------------------------------------
 # -- start ij
 # ---------------------------------------------------------
-"$JAVA_HOME/bin/java" -Dij.driver=org.apache.derby.jdbc.ClientDriver -Dij.protocol=jdbc:derby://$IJ_HOST:$IJ_PORT/ -Dij.user=$IJ_USER -Dij.password=$IJ_PASSWORD  org.apache.derby.tools.ij
+"$JAVA_HOME/bin/java" -cp "${DERBY_HOME}/lib/derbyclient.jar:${DERBY_HOME}/lib/derbytools.jar:${CLASSPATH}" -Dij.driver=org.apache.derby.jdbc.ClientDriver -Dij.protocol=jdbc:derby://$IJ_HOST:$IJ_PORT/ -Dij.user=$IJ_USER -Dij.password=$IJ_PASSWORD  org.apache.derby.tools.ij
 
 # ---------------------------------------------------------
 # -- To use a different JVM with a different syntax, simply edit
diff --git a/frameworks/NetworkServer/bin/setNetworkClientCP.bat b/frameworks/NetworkServer/bin/setNetworkClientCP.bat
index ea6c27645..0b8f6c445 100755
--- a/frameworks/NetworkServer/bin/setNetworkClientCP.bat
+++ b/frameworks/NetworkServer/bin/setNetworkClientCP.bat
@@ -25,8 +25,8 @@
 @REM -- This file for use on Windows systems
 @REM -- 
 @REM ---------------------------------------------------------
-
-@rem set DERBY_INSTALL=
+@echo off
+rem set DERBY_INSTALL=
 
 @if "%DERBY_HOME%"=="" set DERBY_HOME=%DERBY_INSTALL%
 @if "%DERBY_HOME%"=="" goto noderbyhome
diff --git a/frameworks/NetworkServer/bin/setNetworkServerCP.bat b/frameworks/NetworkServer/bin/setNetworkServerCP.bat
index edd039594..978dc7640 100755
--- a/frameworks/NetworkServer/bin/setNetworkServerCP.bat
+++ b/frameworks/NetworkServer/bin/setNetworkServerCP.bat
@@ -25,8 +25,8 @@
 @REM -- This file for use on Windows systems
 @REM -- 
 @REM ---------------------------------------------------------
-
-@rem set DERBY_INSTALL=
+@echo off
+rem set DERBY_INSTALL=
 
 @if "%DERBY_HOME%"=="" set DERBY_HOME=%DERBY_INSTALL%
 @if "%DERBY_HOME%"=="" goto noderbyhome
diff --git a/frameworks/NetworkServer/bin/startNetworkServer.bat b/frameworks/NetworkServer/bin/startNetworkServer.bat
index e3d5c6839..ce7cffbef 100755
--- a/frameworks/NetworkServer/bin/startNetworkServer.bat
+++ b/frameworks/NetworkServer/bin/startNetworkServer.bat
@@ -18,7 +18,7 @@
 @REM ---------------------------------------------------------
 
 @echo off
-@rem set DERBY_INSTALL=
+rem set DERBY_INSTALL=
 
 @if "%DERBY_HOME%"=="" set DERBY_HOME=%DERBY_INSTALL%
 @if "%DERBY_HOME%"=="" goto noderbyhome
@@ -26,9 +26,6 @@
 @if "%JAVA_HOME%"=="" goto nojavahome
 @if not exist "%JAVA_HOME%\bin\java.exe" goto nojavahome
 
-@if !"%CLASSPATH%"==! call "%DERBY_HOME%"/frameworks/NetworkServer/bin/setNetworkServerCP.bat
-@if "%CLASSPATH%" == "" call "%DERBY_HOME%"/frameworks/NetworkServer/bin/setNetworkServerCP.bat
-
 :set_host
 
 if "%1" == "" goto setServerHost
@@ -64,7 +61,7 @@ set derbyPort=%DERBY_SERVER_PORT%
 @REM ---------------------------------------------------------
 @REM -- start Derby as a Network server
 @REM ---------------------------------------------------------
-"%JAVA_HOME%\bin\java" org.apache.derby.drda.NetworkServerControl start -h %derbyHost% -p %derbyPort%
+"%JAVA_HOME%\bin\java" -cp "%DERBY_HOME%\lib\derby.jar;%DERBY_HOME%\lib\derbytools.jar;%DERBY_HOME%\lib\derbynet.jar;%CLASSPATH%" org.apache.derby.drda.NetworkServerControl start -h %derbyHost% -p %derbyPort%
 
 goto end
 @REM ---------------------------------------------------------
diff --git a/frameworks/NetworkServer/bin/startNetworkServer.ksh b/frameworks/NetworkServer/bin/startNetworkServer.ksh
index d07112519..85e7eab2f 100755
--- a/frameworks/NetworkServer/bin/startNetworkServer.ksh
+++ b/frameworks/NetworkServer/bin/startNetworkServer.ksh
@@ -51,11 +51,6 @@ DERBY_HOME=${DERBY_HOME:-$DERBY_INSTALL}
   }
 }
 
-[ -z "$CLASSPATH" ] && {
-  . "$DERBY_HOME"/frameworks/NetworkServer/bin/setNetworkServerCP.ksh
-}
-
-
 # ---------------------------------------------------------
 # -- Determine the host and port to use by:
 # --  1. Check to see if the host and port are set on the command line
@@ -83,7 +78,7 @@ then
    DERBY_SERVER_PORT=1527
 fi
 
-"$JAVA_HOME/bin/java" org.apache.derby.drda.NetworkServerControl start -h $DERBY_SERVER_HOST -p $DERBY_SERVER_PORT
+"$JAVA_HOME/bin/java" -cp "${DERBY_HOME}/lib/derby.jar:${DERBY_HOME}/lib/derbytools.jar:${DERBY_HOME}/lib/derbynet.jar:${CLASSPATH}" org.apache.derby.drda.NetworkServerControl start -h $DERBY_SERVER_HOST -p $DERBY_SERVER_PORT
 
 # ---------------------------------------------------------
 # -- To use a different JVM with a different syntax, simply edit
diff --git a/frameworks/NetworkServer/bin/stopNetworkServer.bat b/frameworks/NetworkServer/bin/stopNetworkServer.bat
index 4cd399607..34b346034 100755
--- a/frameworks/NetworkServer/bin/stopNetworkServer.bat
+++ b/frameworks/NetworkServer/bin/stopNetworkServer.bat
@@ -25,7 +25,7 @@
 @REM ---------------------------------------------------------
 
 @echo off
-@rem set DERBY_INSTALL=
+rem set DERBY_INSTALL=
 
 @if "%DERBY_HOME%"=="" set DERBY_HOME=%DERBY_INSTALL%
 @if "%DERBY_HOME%"=="" goto noderbyhome
@@ -33,9 +33,6 @@
 @if "%JAVA_HOME%"=="" goto nojavahome
 @if not exist "%JAVA_HOME%\bin\java.exe" goto nojavahome
 
-@if !"%CLASSPATH%"==! call "%DERBY_HOME%"/frameworks/NetworkServer/bin/setNetworkServerCP.bat
-@if "%CLASSPATH%" == "" call "%DERBY_HOME%"/frameworks/NetworkServer/bin/setNetworkServerCP.bat
-
 :set_host
 
 if "%1" == "" goto setServerHost
@@ -71,7 +68,7 @@ set derbyPort=%DERBY_SERVER_PORT%
 @REM ---------------------------------------------------------
 @REM -- shutdown Derby as a Network server
 @REM ---------------------------------------------------------
-%JAVA_HOME%\bin\java org.apache.derby.drda.NetworkServerControl shutdown -h %derbyHost% -p %derbyPort%
+%JAVA_HOME%\bin\java -cp "%DERBY_HOME%\lib\derby.jar;%DERBY_HOME%\lib\derbytools.jar;%DERBY_HOME%\lib\derbynet.jar;%CLASSPATH%" org.apache.derby.drda.NetworkServerControl shutdown -h %derbyHost% -p %derbyPort%
 
 goto end
 @REM ---------------------------------------------------------
diff --git a/frameworks/NetworkServer/bin/stopNetworkServer.ksh b/frameworks/NetworkServer/bin/stopNetworkServer.ksh
index 6201e9400..c1bd63292 100755
--- a/frameworks/NetworkServer/bin/stopNetworkServer.ksh
+++ b/frameworks/NetworkServer/bin/stopNetworkServer.ksh
@@ -51,10 +51,6 @@ DERBY_HOME=${DERBY_HOME:-$DERBY_INSTALL}
   }
 }
  
-[ -z "$CLASSPATH" ] && {
-  . "$DERBY_HOME"/frameworks/NetworkServer/bin/setNetworkServerCP.ksh
-}
-
 # ---------------------------------------------------------
 # -- Determine the host and port to use by:
 # --  1. Check to see if the host and port are set on the command line
@@ -82,7 +78,7 @@ then
    DERBY_SERVER_PORT=1527
 fi
 
-"$JAVA_HOME/bin/java" org.apache.derby.drda.NetworkServerControl shutdown -h $DERBY_SERVER_HOST -p $DERBY_SERVER_PORT
+"$JAVA_HOME/bin/java" -cp "${DERBY_HOME}/lib/derby.jar:${DERBY_HOME}/lib/derbytools.jar:${DERBY_HOME}/lib/derbynet.jar:${CLASSPATH}" org.apache.derby.drda.NetworkServerControl shutdown -h $DERBY_SERVER_HOST -p $DERBY_SERVER_PORT
 
 # ---------------------------------------------------------
 # -- To use a different JVM with a different syntax, simply edit
diff --git a/frameworks/NetworkServer/bin/sysinfo.bat b/frameworks/NetworkServer/bin/sysinfo.bat
index 0fbb42160..fd4992570 100755
--- a/frameworks/NetworkServer/bin/sysinfo.bat
+++ b/frameworks/NetworkServer/bin/sysinfo.bat
@@ -38,13 +38,10 @@ rem set DERBY_INSTALL=
 @if "%JAVA_HOME%"=="" goto nojavahome
 @if not exist "%JAVA_HOME%\bin\java.exe" goto nojavahome
 
-@if !"%CLASSPATH%"==! call "%DERBY_HOME%"/frameworks/NetworkServer/bin/setNetworkServerCP.bat
-@if "%CLASSPATH%" == "" call "%DERBY_HOME%"/frameworks/NetworkServer/bin/setNetworkServerCP.bat
-
 @REM ---------------------------------------------------------
 @REM -- start sysinfo
 @REM ---------------------------------------------------------
-"%JAVA_HOME%\bin\java" org.apache.derby.drda.NetworkServerControl sysinfo %*
+"%JAVA_HOME%\bin\java" -cp "%DERBY_HOME%\lib\derby.jar;%DERBY_HOME%\lib\derbytools.jar;%DERBY_HOME%\lib\derbynet.jar;%CLASSPATH%" org.apache.derby.drda.NetworkServerControl sysinfo
 @GOTO end
 
 @REM ---------------------------------------------------------
diff --git a/frameworks/NetworkServer/bin/sysinfo.ksh b/frameworks/NetworkServer/bin/sysinfo.ksh
index f21658319..478b70320 100755
--- a/frameworks/NetworkServer/bin/sysinfo.ksh
+++ b/frameworks/NetworkServer/bin/sysinfo.ksh
@@ -54,14 +54,10 @@ DERBY_HOME=${DERBY_HOME:-$DERBY_INSTALL}
   }
 }
  
-[ -z "$CLASSPATH" ] && {
-  . "$DERBY_HOME"/frameworks/NetworkServer/bin/setNetworkServerCP.ksh
-}
-
 # ---------------------------------------------------------
 # -- start sysinfo
 # ---------------------------------------------------------
-"$JAVA_HOME/bin/java" org.apache.derby.drda.NetworkServerControl sysinfo $*
+"$JAVA_HOME/bin/java" -cp "${DERBY_HOME}/lib/derby.jar:${DERBY_HOME}/lib/derbytools.jar:${DERBY_HOME}/lib/derbynet.jar:${CLASSPATH}" org.apache.derby.drda.NetworkServerControl sysinfo $*
 # ---------------------------------------------------------
 # -- To use a different JVM with a different syntax, simply edit
 # -- this file
diff --git a/frameworks/embedded/bin/dblook.bat b/frameworks/embedded/bin/dblook.bat
index cecf27288..ceed543c4 100755
--- a/frameworks/embedded/bin/dblook.bat
+++ b/frameworks/embedded/bin/dblook.bat
@@ -35,13 +35,11 @@ rem set DERBY_INSTALL=
 @if "%JAVA_HOME%"=="" goto nojavahome
 @if not exist "%JAVA_HOME%\bin\java.exe" goto nojavahome
 
-@if !"%CLASSPATH%"==! call "%DERBY_HOME%"/frameworks/embedded/bin/setEmbeddedCP.bat
-@if "%CLASSPATH%" == "" call "%DERBY_HOME%"/frameworks/embedded/bin/setEmbeddedCP.bat
 
 @REM ---------------------------------------------------------
 @REM -- start dblook
 @REM ---------------------------------------------------------
-"%JAVA_HOME%\bin\java" org.apache.derby.tools.dblook %*
+"%JAVA_HOME%\bin\java" -cp "%DERBY_HOME%\lib\derby.jar;%DERBY_HOME%\lib\derbytools.jar;%CLASSPATH%" org.apache.derby.tools.dblook %*
 @GOTO end
 
 @REM ---------------------------------------------------------
diff --git a/frameworks/embedded/bin/dblook.ksh b/frameworks/embedded/bin/dblook.ksh
index a12b8b371..5895eca98 100755
--- a/frameworks/embedded/bin/dblook.ksh
+++ b/frameworks/embedded/bin/dblook.ksh
@@ -47,15 +47,11 @@ DERBY_HOME=${DERBY_HOME:-$DERBY_INSTALL}
     exit 1
   }
 }
- 
-[ -z "$CLASSPATH" ] && {
-  . "$DERBY_HOME"/frameworks/embedded/bin/setEmbeddedCP.ksh
-}
- 
+
 # ---------------------------------------------------------
 # -- start dblook
 # ---------------------------------------------------------
-"$JAVA_HOME/bin/java" org.apache.derby.tools.dblook $@
+"$JAVA_HOME/bin/java" -cp "${DERBY_HOME}/lib/derby.jar:${DERBY_HOME}/lib/derbytools.jar:${CLASSPATH}" org.apache.derby.tools.dblook $@
 
 # ---------------------------------------------------------
 # -- To use a different JVM with a different syntax, simply edit
diff --git a/frameworks/embedded/bin/ij.bat b/frameworks/embedded/bin/ij.bat
index 7d90c0a03..5b0cb7c3b 100755
--- a/frameworks/embedded/bin/ij.bat
+++ b/frameworks/embedded/bin/ij.bat
@@ -35,13 +35,10 @@ rem set DERBY_INSTALL=
 @if "%JAVA_HOME%"=="" goto nojavahome
 @if not exist "%JAVA_HOME%\bin\java.exe" goto nojavahome
 
-@if !"%CLASSPATH%"==! call "%DERBY_INSTALL%"/frameworks/embedded/bin/setEmbeddedCP.bat
-@if "%CLASSPATH%" == "" call "%DERBY_INSTALL%"/frameworks/embedded/bin/setEmbeddedCP.bat
-
 @REM ---------------------------------------------------------
 @REM -- start ij
 @REM ---------------------------------------------------------
-"%JAVA_HOME%\bin\java" -Dij.protocol=jdbc:derby: org.apache.derby.tools.ij
+"%JAVA_HOME%\bin\java" -cp "%DERBY_HOME%\lib\derby.jar;%DERBY_HOME%\lib\derbytools.jar;%CLASSPATH%" -Dij.protocol=jdbc:derby: org.apache.derby.tools.ij
 @goto end
 
 @REM ---------------------------------------------------------
diff --git a/frameworks/embedded/bin/ij.ksh b/frameworks/embedded/bin/ij.ksh
index a4792fa68..2100cd3ba 100755
--- a/frameworks/embedded/bin/ij.ksh
+++ b/frameworks/embedded/bin/ij.ksh
@@ -48,14 +48,10 @@ DERBY_HOME=${DERBY_HOME:-$DERBY_INSTALL}
   }
 }
  
-[ -z "$CLASSPATH" ] && {
-  . "$DERBY_HOME"/frameworks/embedded/bin/setEmbeddedCP.ksh
-}
- 
 # ---------------------------------------------------------
 # -- start ij
 # ---------------------------------------------------------
-"$JAVA_HOME/bin/java" -Dij.protocol=jdbc:derby: org.apache.derby.tools.ij
+"$JAVA_HOME/bin/java" -cp "${DERBY_HOME}/lib/derby.jar:${DERBY_HOME}/lib/derbytools.jar:${CLASSPATH}" -Dij.protocol=jdbc:derby: org.apache.derby.tools.ij
 
 # ---------------------------------------------------------
 # -- To use a different JVM with a different syntax, simply edit
diff --git a/frameworks/embedded/bin/setEmbeddedCP.bat b/frameworks/embedded/bin/setEmbeddedCP.bat
index 49b5ceb97..0acb2ee03 100755
--- a/frameworks/embedded/bin/setEmbeddedCP.bat
+++ b/frameworks/embedded/bin/setEmbeddedCP.bat
@@ -25,8 +25,8 @@
 @REM -- This file for use on Windows systems
 @REM -- 
 @REM ---------------------------------------------------------
-
-@rem set DERBY_INSTALL=
+@echo off
+rem set DERBY_INSTALL=
 
 @if "%DERBY_HOME%"=="" set DERBY_HOME=%DERBY_INSTALL%
 @if "%DERBY_HOME%"=="" goto noderbyhome
diff --git a/frameworks/embedded/bin/sysinfo.bat b/frameworks/embedded/bin/sysinfo.bat
index 90301681a..16a15feb9 100755
--- a/frameworks/embedded/bin/sysinfo.bat
+++ b/frameworks/embedded/bin/sysinfo.bat
@@ -30,7 +30,7 @@
 @REM -- This file for use on Windows systems
 @REM ---------------------------------------------------------
 @echo off
-@rem set DERBY_INSTALL=
+rem set DERBY_INSTALL=
 
 @if "%DERBY_HOME%"=="" set DERBY_HOME=%DERBY_INSTALL%
 @if "%DERBY_HOME%"=="" goto noderbyhome
@@ -38,13 +38,10 @@
 @if "%JAVA_HOME%"=="" goto nojavahome
 @if not exist "%JAVA_HOME%\bin\java.exe" goto nojavahome
 
-@if !"%CLASSPATH%"==! call "%DERBY_INSTALL%"/frameworks/embedded/bin/setEmbeddedCP.bat
-@if "%CLASSPATH%" == "" call "%DERBY_INSTALL%"/frameworks/embedded/bin/setEmbeddedCP.bat
-
 @REM ---------------------------------------------------------
 @REM -- start sysinfo
 @REM ---------------------------------------------------------
-"%JAVA_HOME%\bin\java" org.apache.derby.tools.sysinfo
+"%JAVA_HOME%\bin\java" -cp "%DERBY_HOME%\lib\derby.jar;%DERBY_HOME%\lib\derbytools.jar;%CLASSPATH%" org.apache.derby.tools.sysinfo
 @GOTO end
 
 @REM ---------------------------------------------------------
diff --git a/frameworks/embedded/bin/sysinfo.ksh b/frameworks/embedded/bin/sysinfo.ksh
index 981a65569..959d975c4 100755
--- a/frameworks/embedded/bin/sysinfo.ksh
+++ b/frameworks/embedded/bin/sysinfo.ksh
@@ -52,14 +52,10 @@ DERBY_HOME=${DERBY_HOME:-$DERBY_INSTALL}
   }
 }
  
-[ -z "$CLASSPATH" ] && {
-  . "$DERBY_HOME"/frameworks/embedded/bin/setEmbeddedCP.ksh
-}
- 
 # ---------------------------------------------------------
 # -- start sysinfo
 # ---------------------------------------------------------
-"$JAVA_HOME/bin/java" org.apache.derby.tools.sysinfo
+"$JAVA_HOME/bin/java" -cp "${DERBY_HOME}/lib/derby.jar:${DERBY_HOME}/lib/derbytools.jar:${CLASSPATH}" org.apache.derby.tools.sysinfo
 
 # ---------------------------------------------------------
 # -- To use a different JVM with a different syntax, simply edit
