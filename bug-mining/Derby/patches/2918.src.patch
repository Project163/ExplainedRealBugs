diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/currentSchema.out b/java/testing/org/apache/derbyTesting/functionTests/master/currentSchema.out
deleted file mode 100644
index 7955a69f8..000000000
--- a/java/testing/org/apache/derbyTesting/functionTests/master/currentSchema.out
+++ /dev/null
@@ -1,343 +0,0 @@
-ij> --
---   Licensed to the Apache Software Foundation (ASF) under one or more
---   contributor license agreements.  See the NOTICE file distributed with
---   this work for additional information regarding copyright ownership.
---   The ASF licenses this file to You under the Apache License, Version 2.0
---   (the "License"); you may not use this file except in compliance with
---   the License.  You may obtain a copy of the License at
---
---      http://www.apache.org/licenses/LICENSE-2.0
---
---   Unless required by applicable law or agreed to in writing, software
---   distributed under the License is distributed on an "AS IS" BASIS,
---   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
---   See the License for the specific language governing permissions and
---   limitations under the License.
---
--- test for CURRENT SCHEMA and optional DB2 compatible SET SCHEMA statement
---
--- test SET SCHEMA syntax variations
--- syntax is SET [CURRENT] SCHEMA [=] (<identifier> | USER | ? | '<string>')
---			 SET CURRENT SQLID [=] (<identifier> | USER | ? | '<string>')
---
-values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-APP                                                                                                                             
-ij> set schema sys;
-0 rows inserted/updated/deleted
-ij> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-SYS                                                                                                                             
-ij> create schema app;
-ERROR X0Y68: Schema 'APP' already exists.
-ij> set current schema app;
-0 rows inserted/updated/deleted
-ij> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-APP                                                                                                                             
-ij> set schema =  sys;
-0 rows inserted/updated/deleted
-ij> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-SYS                                                                                                                             
-ij> set current schema = app;
-0 rows inserted/updated/deleted
-ij> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-APP                                                                                                                             
-ij> set schema sys;
-0 rows inserted/updated/deleted
-ij> -- user should use default schema if no user set
-set schema user;
-0 rows inserted/updated/deleted
-ij> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-APP                                                                                                                             
-ij> -- see what user does when there is a user
-create schema judy;
-0 rows inserted/updated/deleted
-ij> connect 'wombat;user=judy' as judy;
-ij(JUDY)> set schema app;
-0 rows inserted/updated/deleted
-ij(JUDY)> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-APP                                                                                                                             
-ij(JUDY)> set schema user;
-0 rows inserted/updated/deleted
-ij(JUDY)> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-JUDY                                                                                                                            
-ij(JUDY)> disconnect;
-ij> set connection connection0;
-ij> -- check for default
-values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-APP                                                                                                                             
-ij> -- check that current sqlid works as a synonym
-values current sqlid;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-APP                                                                                                                             
-ij> -- check that sqlid still works as an identifer
-create table sqlid(sqlid int);
-0 rows inserted/updated/deleted
-ij> drop table sqlid;
-0 rows inserted/updated/deleted
-ij> -- check that set current sqlid works
-set current sqlid judy;
-0 rows inserted/updated/deleted
-ij> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-JUDY                                                                                                                            
-ij> -- check that set sqlid doesn't work (not DB2 compatible) - should get error
-set sqlid judy;
-ERROR 42X01: Syntax error: Encountered "sqlid" at line 2, column 5.
-Issue the 'help' command for general information on IJ command syntax.
-Any unrecognized commands are treated as potential SQL commands and executed directly.
-Consult your DBMS server reference documentation for details of the SQL syntax supported by your server.
-ij> -- change schema and make sure that the current schema is correct
-set schema sys;
-0 rows inserted/updated/deleted
-ij> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-SYS                                                                                                                             
-ij> set schema app;
-0 rows inserted/updated/deleted
-ij> -- try using ? outside of a prepared statement
-set schema ?;
-ERROR 07000: At least one parameter to the current statement is uninitialized.
-ij> -- use set schema in a prepared statement
-autocommit off;
-ij> prepare p1 as 'set schema ?';
-ij> -- should get error with no parameters
-execute p1;
-ERROR 07000: At least one parameter to the current statement is uninitialized.
-ij> -- should get error if null is used
-create table t1(name varchar(128));
-0 rows inserted/updated/deleted
-ij> insert into t1 values(null);
-1 row inserted/updated/deleted
-ij> execute p1 using 'select name from t1';
-ERROR 42815: The replacement value for 'CURRENT SCHEMA' is invalid.
-ij> -- should get error if schema doesn't exist
-execute p1 using 'values(''notthere'')';
-ERROR 42Y07: Schema 'notthere' does not exist
-ij> -- should error with empty string
-execute p1 using 'values('''')';
-ERROR 42Y07: Schema '' does not exist
-ij> -- should get error if wrong case used
-execute p1 using 'values(''sys'')';
-ERROR 42Y07: Schema 'sys' does not exist
-ij> -- should get error if too many parameters
-execute p1 using 'values(''sys'',''app'')';
-ERROR XCL13: The parameter position '2' is out of range.  The number of parameters for this prepared  statement is '1'.
-ij> -- USER should return an error as it is interpreted as a string constant not an
--- identifier
-execute p1 using 'values(''USER'')';
-ERROR 42Y07: Schema 'USER' does not exist
-ij> -- try positive test
-execute p1 using 'values(''SYS'')';
-0 rows inserted/updated/deleted
-ij> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-SYS                                                                                                                             
-ij> rollback;
-ij> autocommit on;
-ij> -- 
--- try current schema in a number of statements types
-set schema app;
-0 rows inserted/updated/deleted
-ij> create table t1 ( a varchar(128));
-0 rows inserted/updated/deleted
-ij> -- insert
-insert into t1 values (current schema);
-1 row inserted/updated/deleted
-ij> select * from t1;
-A                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-APP                                                                                                                             
-ij> set schema judy;
-0 rows inserted/updated/deleted
-ij> insert into app.t1 values (current schema);
-1 row inserted/updated/deleted
-ij> select * from app.t1;
-A                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-APP                                                                                                                             
-JUDY                                                                                                                            
-ij> -- delete where clause
-delete from app.t1 where a = current schema;
-1 row inserted/updated/deleted
-ij> select * from app.t1;
-A                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-APP                                                                                                                             
-ij> set current schema app;
-0 rows inserted/updated/deleted
-ij> -- target list
-select current schema from t1;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-APP                                                                                                                             
-ij> -- where clause
-select * from t1 where a = current schema;
-A                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-APP                                                                                                                             
-ij> -- update statement
-delete from t1;
-1 row inserted/updated/deleted
-ij> insert into t1 values ('test');
-1 row inserted/updated/deleted
-ij> select * from t1;
-A                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-test                                                                                                                            
-ij> update t1 set a = current schema;
-1 row inserted/updated/deleted
-ij> select * from t1;
-A                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-APP                                                                                                                             
-ij> set schema judy;
-0 rows inserted/updated/deleted
-ij> update app.t1 set a = current schema;
-1 row inserted/updated/deleted
-ij> select * from app.t1;
-A                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-JUDY                                                                                                                            
-ij> set schema app;
-0 rows inserted/updated/deleted
-ij> drop table t1;
-0 rows inserted/updated/deleted
-ij> -- default
-set schema APP;
-0 rows inserted/updated/deleted
-ij> create table t1 ( a int, b varchar(128) default current schema);
-0 rows inserted/updated/deleted
-ij> insert into t1 (a) values (1);
-1 row inserted/updated/deleted
-ij> set schema SYS;
-0 rows inserted/updated/deleted
-ij> insert into app.t1 (a) values (1);
-1 row inserted/updated/deleted
-ij> set schema judy;
-0 rows inserted/updated/deleted
-ij> insert into app.t1 (a) values (1);
-1 row inserted/updated/deleted
-ij> set schema APP;
-0 rows inserted/updated/deleted
-ij> select * from t1;
-A          |B                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------------------
-1          |APP                                                                                                                             
-1          |SYS                                                                                                                             
-1          |JUDY                                                                                                                            
-ij> drop table t1;
-0 rows inserted/updated/deleted
-ij> -- check constraint - this should fail
-create table t1 ( a varchar(128), check (a = current schema));
-ERROR 42Y39: 'CURRENT SCHEMA' may not appear in a CHECK CONSTRAINT definition because it may return non-deterministic results.
-ij> create table t1 ( a varchar(128), check (a = current sqlid));
-ERROR 42Y39: 'CURRENT SCHEMA' may not appear in a CHECK CONSTRAINT definition because it may return non-deterministic results.
-ij> -- try mix case
-create schema "MiXCase";
-0 rows inserted/updated/deleted
-ij> set schema "MiXCase";
-0 rows inserted/updated/deleted
-ij> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-MiXCase                                                                                                                         
-ij> set schema app;
-0 rows inserted/updated/deleted
-ij> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-APP                                                                                                                             
-ij> set schema 'MiXCase';
-0 rows inserted/updated/deleted
-ij> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-MiXCase                                                                                                                         
-ij> -- following should get error - schema not found
-set schema 'MIXCASE';
-ERROR 42Y07: Schema 'MIXCASE' does not exist
-ij> set schema mixcase;
-ERROR 42Y07: Schema 'MIXCASE' does not exist
-ij> -- try long schema names (maximum schema identifier length has been changed to 30 as part of DB2 compatibility work)
-create schema t23456789012345678901234567890;
-0 rows inserted/updated/deleted
-ij> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-MiXCase                                                                                                                         
-ij> set schema app;
-0 rows inserted/updated/deleted
-ij> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-APP                                                                                                                             
-ij> set schema t23456789012345678901234567890;
-0 rows inserted/updated/deleted
-ij> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-T23456789012345678901234567890                                                                                                  
-ij> set schema app;
-0 rows inserted/updated/deleted
-ij> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-APP                                                                                                                             
-ij> set schema 'T23456789012345678901234567890';
-0 rows inserted/updated/deleted
-ij> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-T23456789012345678901234567890                                                                                                  
-ij> set schema app;
-0 rows inserted/updated/deleted
-ij> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-APP                                                                                                                             
-ij> autocommit off;
-ij> prepare p1 as 'set schema ?';
-ij> execute p1 using 'values(''T23456789012345678901234567890'')';
-0 rows inserted/updated/deleted
-ij> values current schema;
-1                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------
-T23456789012345678901234567890                                                                                                  
-ij> -- the following should fail - 129 length
-create schema TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT;
-ERROR 42622: The name 'TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT' is too long. The maximum length is '128'.
-ij> set schema TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT;
-ERROR 42622: The name 'TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT' is too long. The maximum length is '128'.
-ij> set schema 'TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT';
-ERROR 42622: The name 'TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT' is too long. The maximum length is '128'.
-ij> execute p1 using 'values(''TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT'')';
-ERROR 42815: The replacement value for 'CURRENT SCHEMA' is invalid.
-ij> rollback;
-ij> autocommit on;
-ij> -- clean up
-drop schema judy restrict;
-0 rows inserted/updated/deleted
-ij> drop schema TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT restrict;
-ERROR 42622: The name 'TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT' is too long. The maximum length is '128'.
-ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/suites/derbylang.runall b/java/testing/org/apache/derbyTesting/functionTests/suites/derbylang.runall
index 1fe6ea4d3..f0821e08b 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/suites/derbylang.runall
+++ b/java/testing/org/apache/derbyTesting/functionTests/suites/derbylang.runall
@@ -1,7 +1,6 @@
 lang/aggregateOptimization.sql
 lang/compressTable.sql
 lang/consistencyChecker.sql
-lang/currentSchema.sql
 lang/cursorerrors.sql
 lang/db2Compatibility.sql
 lang/ddlTableLockMode.sql
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/CurrentSchemaTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/CurrentSchemaTest.java
new file mode 100644
index 000000000..2696e55d6
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/CurrentSchemaTest.java
@@ -0,0 +1,477 @@
+package org.apache.derbyTesting.functionTests.tests.lang;
+
+import java.sql.Connection;
+import java.sql.PreparedStatement;
+import java.sql.ResultSet;
+import java.sql.ResultSetMetaData;
+import java.sql.SQLException;
+import java.sql.Statement;
+import junit.framework.Test;
+import junit.framework.TestSuite;
+import org.apache.derbyTesting.junit.BaseJDBCTestCase;
+import org.apache.derbyTesting.junit.JDBC;
+import org.apache.derbyTesting.junit.TestConfiguration;
+
+/**
+ * Test for CURRENT SCHEMA and optional DB2 compatible SET SCHEMA statement
+ * test SET SCHEMA syntax variations syntax is:
+ * <p>
+ * <pre>
+ *    SET [CURRENT] SCHEMA [=] (<identifier> | USER | ? | '<string>')
+ *    SET CURRENT SQLID [=] (<identifier> | USER | ? | '<string>')
+ * </pre>
+ */
+public final class CurrentSchemaTest extends BaseJDBCTestCase {
+
+    /**
+     * Public constructor required for running test as standalone JUnit.
+     * @param name test name
+     */
+    public CurrentSchemaTest(String name)
+    {
+        super(name);
+    }
+
+    public static Test suite()
+    {
+        TestSuite suite = new TestSuite("CurrentSchemaTest");
+        suite.addTest(TestConfiguration.defaultSuite(CurrentSchemaTest.class));
+        return suite;
+    }
+
+    public void testCurrentSchema() throws Exception
+    {
+        ResultSet rs;
+        ResultSetMetaData rsmd;
+
+        PreparedStatement pSt;
+        final Statement st = createStatement();
+
+        String [][] expRS;
+        String [] expColNames;
+
+        assertCurrentSchema(st, "APP");
+
+        st.executeUpdate("set schema sys");
+        assertCurrentSchema(st, "SYS");
+
+        assertStatementError("X0Y68", st, "create schema app");
+
+        st.executeUpdate("set current schema app");
+        assertCurrentSchema(st, "APP");
+
+        st.executeUpdate("set schema = sys");
+        assertCurrentSchema(st, "SYS");
+
+        st.executeUpdate("set current schema = app");
+        assertCurrentSchema(st, "APP");
+
+        st.executeUpdate("set schema sys");
+
+        //
+        // user should use default schema if no user set
+        //
+        st.executeUpdate("set schema user");
+        assertCurrentSchema(st, "APP");
+
+        //
+        // see what user does when there is a user
+        //
+        st.executeUpdate("create schema judy");
+        Connection judy = openUserConnection("judy");
+        Statement jst = judy.createStatement();
+
+        jst.executeUpdate("set schema app");
+        assertCurrentSchema(jst, "APP");
+
+        jst.executeUpdate("set schema user");
+        assertCurrentSchema(jst, "JUDY");
+
+        judy.close();
+
+        //
+        // check for default
+        //
+        assertCurrentSchema(st, "APP");
+
+        //
+        // Check that current sqlid works as a synonym
+        //
+        rs = st.executeQuery("values current sqlid");
+        expRS = new String [][]{{"APP"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        //
+        // Check that sqlid still works as an identifer
+        //
+        st.executeUpdate("create table sqlid(sqlid int)");
+        st.executeUpdate("drop table sqlid");
+
+        //
+        // Check that set current sqlid works
+        //
+        st.executeUpdate("set current sqlid judy");
+        assertCurrentSchema(st, "JUDY");
+
+        //
+        // Check that set sqlid doesn't work (not DB2 compatible) - should get
+        // error
+        assertStatementError("42X01", st, "set sqlid judy");
+
+        //
+        // Change schema and make sure that the current schema is correct
+        //
+        st.executeUpdate("set schema sys");
+        assertCurrentSchema(st, "SYS");
+
+        st.executeUpdate("set schema app");
+
+        //
+        // Try using ? outside of a prepared statement
+        //
+        assertStatementError("07000", st, "set schema ?");
+
+        //
+        // Use set schema in a prepared statement
+        //
+        setAutoCommit(false);
+
+        pSt = prepareStatement("set schema ?");
+
+        //
+        // Should get error with no parameters
+        //
+        assertStatementError("07000", pSt);
+
+        //
+        // Should get error if null is used
+        //
+        st.executeUpdate("create table t1(name varchar(128))");
+        st.executeUpdate("insert into t1 values(null)");
+        rs = st.executeQuery("select name from t1");
+        rs.next();
+        pSt.setObject(1, rs.getObject(1));
+        assertStatementError("42815", pSt);
+
+        //
+        // Should get error if schema doesn't exist
+        //
+        rs = st.executeQuery("values('notthere')");
+        rs.next();
+        pSt.setObject(1, rs.getObject(1));
+        assertStatementError("42Y07", pSt);
+
+        //
+        // Should error with empty string
+        //
+        rs = st.executeQuery("values('')");
+        rs.next();
+        pSt.setObject(1, rs.getObject(1));
+        assertStatementError("42Y07", pSt);
+
+        //
+        // Should get error if wrong case used
+        //
+        rs = st.executeQuery("values('sys')");
+        rs.next();
+        pSt.setObject(1, rs.getObject(1));
+        assertStatementError("42Y07", pSt);
+
+        //
+        // Should get error if too many parameters
+        //
+        rs = st.executeQuery("values('sys','app')");
+        rs.next();
+        rsmd = rs.getMetaData();
+
+        try {
+            for (int i = 1; i <= rsmd.getColumnCount(); i++) {
+                pSt.setObject(i, rs.getObject(i));
+            }
+        } catch (SQLException e) {
+            if (usingDerbyNetClient()) {
+                assertSQLState("XCL14", e);
+            } else {
+                assertSQLState("XCL13", e);
+            }
+        }
+
+        //
+        // USER should return an error as it is interpreted as a
+        // string constant not an identifier
+        //
+        rs = st.executeQuery("values('USER')");
+        rs.next();
+        pSt.setObject(1, rs.getObject(1));
+        assertStatementError("42Y07", pSt);
+
+        //
+        // Try positive test
+        //
+        rs = st.executeQuery("values('SYS')");
+        rs.next();
+        pSt.setObject(1, rs.getObject(1));
+        assertUpdateCount(pSt, 0);
+        assertCurrentSchema(st, "SYS");
+
+        rollback();
+        setAutoCommit(true);
+
+        //
+        // Try current schema in a number of statements types
+        //
+        st.executeUpdate("set schema app");
+        st.executeUpdate("create table t1 ( a varchar(128))");
+
+        //
+        // insert
+        //
+        st.executeUpdate("insert into t1 values (current schema)");
+        rs = st.executeQuery("select * from t1");
+        expColNames = new String [] {"A"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]{{"APP"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        st.executeUpdate("set schema judy");
+        st.executeUpdate("insert into app.t1 values (current schema)");
+        rs = st.executeQuery("select * from app.t1");
+        expColNames = new String [] {"A"};
+        JDBC.assertColumnNames(rs, expColNames);
+        expRS = new String [][]
+        {
+            {"APP"},
+            {"JUDY"}
+        };
+
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        //
+        // delete where clause
+        //
+        assertUpdateCount(st, 1,"delete from app.t1 where a = current schema");
+        rs = st.executeQuery("select * from app.t1");
+        expColNames = new String [] {"A"};
+        JDBC.assertColumnNames(rs, expColNames);
+
+        expRS = new String [][]
+        {
+            {"APP"}
+        };
+
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        st.executeUpdate("set current schema app");
+
+        //
+        // Target list
+        //
+        rs = st.executeQuery("select current schema from t1");
+
+        expColNames = new String [] {"1"};
+        JDBC.assertColumnNames(rs, expColNames);
+
+        expRS = new String [][]
+        {
+            {"APP"}
+        };
+
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        //
+        // where clause
+        //
+        rs = st.executeQuery("select * from t1 where a = current schema");
+
+        expColNames = new String [] {"A"};
+        JDBC.assertColumnNames(rs, expColNames);
+
+        expRS = new String [][]{{"APP"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        //
+        // update statement
+        //
+        assertUpdateCount(st, 1, "delete from t1");
+        st.executeUpdate("insert into t1 values ('test')");
+        rs = st.executeQuery("select * from t1");
+
+        expColNames = new String [] {"A"};
+        JDBC.assertColumnNames(rs, expColNames);
+
+        expRS = new String [][]{{"test"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        assertUpdateCount(st, 1, "update t1 set a = current schema");
+
+        rs = st.executeQuery("select * from t1");
+        expColNames = new String [] {"A"};
+        JDBC.assertColumnNames(rs, expColNames);
+
+        expRS = new String [][]{{"APP"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        st.executeUpdate("set schema judy");
+        assertUpdateCount(st, 1, "update app.t1 set a = current schema");
+
+        rs = st.executeQuery("select * from app.t1");
+
+        expColNames = new String [] {"A"};
+        JDBC.assertColumnNames(rs, expColNames);
+
+        expRS = new String [][]{{"JUDY"}};
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        st.executeUpdate("set schema app");
+        st.executeUpdate("drop table t1");
+
+        //
+        // Column default
+        //
+        st.executeUpdate("set schema APP");
+
+        st.executeUpdate(
+            " create table t1 ( a int, b varchar(128) default "
+            + "current schema)");
+
+        st.executeUpdate("insert into t1 (a) values (1)");
+        st.executeUpdate("set schema SYS");
+        st.executeUpdate("insert into app.t1 (a) values (1)");
+        st.executeUpdate("set schema judy");
+        st.executeUpdate("insert into app.t1 (a) values (1)");
+        st.executeUpdate("set schema APP");
+
+        rs = st.executeQuery("select * from t1");
+
+        expColNames = new String [] {"A", "B"};
+        JDBC.assertColumnNames(rs, expColNames);
+
+        expRS = new String [][]
+        {
+            {"1", "APP"},
+            {"1", "SYS"},
+            {"1", "JUDY"}
+        };
+
+        JDBC.assertFullResultSet(rs, expRS, true);
+
+        st.executeUpdate("drop table t1");
+
+        //
+        // Check constraint - this should fail
+        //
+        assertStatementError("42Y39", st,
+            "create table t1 ( a varchar(128), check (a = "
+            + "current schema))");
+
+        assertStatementError("42Y39", st,
+            " create table t1 ( a varchar(128), check (a = "
+            + "current sqlid))");
+
+        //
+        // Try mix case
+        //
+        st.executeUpdate("create schema \"MiXCase\"");
+        st.executeUpdate("set schema \"MiXCase\"");
+        assertCurrentSchema(st, "MiXCase");
+
+        st.executeUpdate("set schema app");
+        assertCurrentSchema(st, "APP");
+
+        st.executeUpdate("set schema 'MiXCase'");
+        assertCurrentSchema(st, "MiXCase");
+
+        //
+        // Following should get error - schema not found
+        //
+        assertStatementError("42Y07", st, "set schema 'MIXCASE'");
+        assertStatementError("42Y07", st, "set schema mixcase");
+
+        //
+        // Try long schema names (maximum schema identifier length
+        // has been changed to 30 as part of DB2 compatibility work)
+        //
+        st.executeUpdate("create schema t23456789012345678901234567890");
+        assertCurrentSchema(st, "MiXCase");
+
+        st.executeUpdate("set schema app");
+        assertCurrentSchema(st, "APP");
+
+        st.executeUpdate("set schema t23456789012345678901234567890");
+        assertCurrentSchema(st, "T23456789012345678901234567890");
+
+        st.executeUpdate(" set schema app");
+        assertCurrentSchema(st, "APP");
+
+        st.executeUpdate("set schema 'T23456789012345678901234567890'");
+        assertCurrentSchema(st, "T23456789012345678901234567890");
+
+        st.executeUpdate("set schema app");
+        assertCurrentSchema(st, "APP");
+
+        setAutoCommit(false);
+
+        pSt = prepareStatement("set schema ?");
+        rs = st.executeQuery("values('T23456789012345678901234567890')");
+        rs.next();
+        pSt.setObject(1, rs.getObject(1));
+        assertUpdateCount(pSt, 0);
+
+        assertCurrentSchema(st, "T23456789012345678901234567890");
+
+        //
+        // The following should fail - 129 length
+        //
+        assertStatementError("42622", st,
+            "create schema "
+            + "TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT"
+            + "TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT"
+            + "TTTTTTTTTTTTTTTTTTTTTTTTT");
+
+        assertStatementError("42622", st,
+            " set schema "
+            + "TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT"
+            + "TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT"
+            + "TTTTTTTTTTTTTTTTTTTTTTTTT");
+
+        assertStatementError("42622", st,
+            " set schema "
+            + "'TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT"
+            + "TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT"
+            + "TTTTTTTTTTTTTTTTTTTTTTTTTT'");
+
+        rs = st.executeQuery(
+                "values('TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT"
+                + "TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT"
+                + "TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT')");
+        rs.next();
+        pSt.setObject(1, rs.getObject(1));
+        assertStatementError("42815", pSt);
+
+        rollback();
+        setAutoCommit(true);
+
+        //
+        // Clean up
+        //
+        st.executeUpdate("drop schema judy restrict");
+
+        assertStatementError("42622", st,
+            " drop schema "
+            + "TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT"
+            + "TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT"
+            + "TTTTTTTTTTTTTTTTTTTTTTTTT restrict");
+
+        rollback();
+        st.close();
+    }
+
+    private void assertCurrentSchema(Statement st, String schema)
+        throws SQLException {
+
+        JDBC.assertFullResultSet(
+            st.executeQuery("values current schema"),
+            new String [][]{{schema}},
+            true);
+    }
+}
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/_Suite.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/_Suite.java
index 5604b82d4..7ec97412c 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/_Suite.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/_Suite.java
@@ -245,6 +245,7 @@ public class _Suite extends BaseTestCase  {
         suite.addTest(MergeStatementTest.suite());
         suite.addTest(ForeignKeysNonSpsTest.suite());
         suite.addTest(LOBDB2compatibilityTest.suite());
+        suite.addTest(CurrentSchemaTest.suite());
         suite.addTest(Test_6496.suite());
         suite.addTest(ConstraintCharacteristicsTest.suite());
         suite.addTest(DB2IsolationLevelsTest.suite());
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/currentSchema.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/currentSchema.sql
deleted file mode 100644
index 673d9cb06..000000000
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/currentSchema.sql
+++ /dev/null
@@ -1,203 +0,0 @@
---
---   Licensed to the Apache Software Foundation (ASF) under one or more
---   contributor license agreements.  See the NOTICE file distributed with
---   this work for additional information regarding copyright ownership.
---   The ASF licenses this file to You under the Apache License, Version 2.0
---   (the "License"); you may not use this file except in compliance with
---   the License.  You may obtain a copy of the License at
---
---      http://www.apache.org/licenses/LICENSE-2.0
---
---   Unless required by applicable law or agreed to in writing, software
---   distributed under the License is distributed on an "AS IS" BASIS,
---   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
---   See the License for the specific language governing permissions and
---   limitations under the License.
---
--- test for CURRENT SCHEMA and optional DB2 compatible SET SCHEMA statement
---
--- test SET SCHEMA syntax variations
--- syntax is SET [CURRENT] SCHEMA [=] (<identifier> | USER | ? | '<string>')
---			 SET CURRENT SQLID [=] (<identifier> | USER | ? | '<string>')
---
-values current schema;
-set schema sys;
-values current schema;
-create schema app;
-set current schema app;
-values current schema;
-set schema =  sys;
-values current schema;
-set current schema = app;
-values current schema;
-set schema sys;
--- user should use default schema if no user set
-set schema user;
-values current schema;
--- see what user does when there is a user
-create schema judy;
-connect 'wombat;user=judy' as judy;
-set schema app;
-values current schema;
-set schema user;
-values current schema;
-disconnect;
-set connection connection0;
-
--- check for default
-values current schema;
-
--- check that current sqlid works as a synonym
-values current sqlid;
-
--- check that sqlid still works as an identifer
-create table sqlid(sqlid int);
-drop table sqlid;
-
--- check that set current sqlid works
-set current sqlid judy;
-values current schema;
-
--- check that set sqlid doesn't work (not DB2 compatible) - should get error
-set sqlid judy;
-
--- change schema and make sure that the current schema is correct
-set schema sys;
-values current schema;
-set schema app;
-
--- try using ? outside of a prepared statement
-set schema ?;
-
--- use set schema in a prepared statement
-autocommit off;
-prepare p1 as 'set schema ?';
--- should get error with no parameters
-execute p1;
--- should get error if null is used
-create table t1(name varchar(128));
-insert into t1 values(null);
-execute p1 using 'select name from t1';
--- should get error if schema doesn't exist
-execute p1 using 'values(''notthere'')';
--- should error with empty string
-execute p1 using 'values('''')';
--- should get error if wrong case used
-execute p1 using 'values(''sys'')';
--- should get error if too many parameters
-execute p1 using 'values(''sys'',''app'')';
--- USER should return an error as it is interpreted as a string constant not an
--- identifier
-execute p1 using 'values(''USER'')';
-
--- try positive test
-execute p1 using 'values(''SYS'')';
-values current schema;
-
-
-rollback;
-autocommit on;
-
-
--- 
--- try current schema in a number of statements types
-set schema app;
-create table t1 ( a varchar(128));
-
--- insert
-insert into t1 values (current schema);
-select * from t1;
-set schema judy;
-insert into app.t1 values (current schema);
-select * from app.t1;
--- delete where clause
-delete from app.t1 where a = current schema;
-select * from app.t1;
-set current schema app;
-
-
--- target list
-select current schema from t1;
-
--- where clause
-select * from t1 where a = current schema;
-
--- update statement
-delete from t1;
-insert into t1 values ('test');
-select * from t1;
-update t1 set a = current schema;
-select * from t1;
-set schema judy;
-update app.t1 set a = current schema;
-select * from app.t1;
-set schema app;
-
-drop table t1;
-
--- default
-set schema APP;
-create table t1 ( a int, b varchar(128) default current schema);
-insert into t1 (a) values (1);
-set schema SYS;
-insert into app.t1 (a) values (1);
-set schema judy;
-insert into app.t1 (a) values (1);
-set schema APP;
-select * from t1;
-drop table t1;
-
--- check constraint - this should fail
-create table t1 ( a varchar(128), check (a = current schema));
-create table t1 ( a varchar(128), check (a = current sqlid));
-
--- try mix case
-create schema "MiXCase";
-set schema "MiXCase";
-values current schema;
-set schema app;
-values current schema;
-set schema 'MiXCase';
-values current schema;
--- following should get error - schema not found
-set schema 'MIXCASE';
-set schema mixcase;
-
--- try long schema names (maximum schema identifier length has been changed to 30 as part of DB2 compatibility work)
-create schema t23456789012345678901234567890;
-values current schema;
-set schema app;
-values current schema;
-
-set schema t23456789012345678901234567890;
-values current schema;
-set schema app;
-values current schema;
-
-set schema 'T23456789012345678901234567890';
-values current schema;
-set schema app;
-values current schema;
-
-
-autocommit off;
-prepare p1 as 'set schema ?';
-execute p1 using 'values(''T23456789012345678901234567890'')';
-
-values current schema;
-
--- the following should fail - 129 length
-create schema TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT;
-
-set schema TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT;
-
-set schema 'TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT';
-
-execute p1 using 'values(''TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT'')';
-
-rollback;
-autocommit on;
-
--- clean up
-drop schema judy restrict;
-drop schema TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT restrict;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/currentSchema_app.properties b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/currentSchema_app.properties
deleted file mode 100644
index 640f6179a..000000000
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/currentSchema_app.properties
+++ /dev/null
@@ -1,17 +0,0 @@
-# Licensed to the Apache Software Foundation (ASF) under one or more
-# contributor license agreements.  See the NOTICE file distributed with
-# this work for additional information regarding copyright ownership.
-# The ASF licenses this file to you under the Apache License, Version 2.0
-# (the "License"); you may not use this file except in compliance with
-# the License.  You may obtain a copy of the License at
-#
-#     http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-
-usedefaults=true
-
