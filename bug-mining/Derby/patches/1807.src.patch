diff --git a/java/engine/org/apache/derby/impl/sql/compile/FromList.java b/java/engine/org/apache/derby/impl/sql/compile/FromList.java
index 6fad642e1..2a13f6677 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/FromList.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/FromList.java
@@ -384,27 +384,6 @@ public class FromList extends QueryTreeNodeVector implements OptimizableList
 			fromListParam.removeElementAt(0);
 	}
 
-	/**
-	 * Returns true if any Outer joins present. Used to set Nullability
-	 *
-	 * @return	True if has any outer joins. False otherwise.
-	 */
-	public boolean hasOuterJoins()
-				throws StandardException
-	{
-		FromTable	fromTable;
-
-		int size = size();
-		for (int index = 0; index < size; index++)
-		{
-			fromTable = (FromTable) elementAt(index);
-			if (fromTable instanceof HalfOuterJoinNode)
-				return true;
-		}
-
-		return false;
-	}
-
 	/**
 	 * Expand a "*" into the appropriate ResultColumnList. If the "*"
 	 * is unqualified it will expand into a list of all columns in all
diff --git a/java/engine/org/apache/derby/impl/sql/compile/JoinNode.java b/java/engine/org/apache/derby/impl/sql/compile/JoinNode.java
index c63ecf8f0..34eeb4375 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/JoinNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/JoinNode.java
@@ -572,6 +572,17 @@ public class JoinNode extends TableOperatorNode
 				throw StandardException.newException(SQLState.LANG_AMBIGUOUS_COLUMN_NAME, 
 						 columnReference.getSQLColumnName());
 			}
+
+            // All columns on the logical right side of a "half" outer join
+            // can contain nulls. The correct nullability is set by
+            // bindResultColumns()/buildRCL(). However, if bindResultColumns()
+            // has not been called yet, the caller of this method will see
+            // the wrong nullability. This problem is logged as DERBY-2916.
+            // Until that's fixed, set the nullability here too.
+            if (this instanceof HalfOuterJoinNode) {
+                rightRC.setNullability(true);
+            }
+
 			resultColumn = rightRC;
 		}
 
diff --git a/java/engine/org/apache/derby/impl/sql/compile/SelectNode.java b/java/engine/org/apache/derby/impl/sql/compile/SelectNode.java
index 02f905c0d..a8feba3ae 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/SelectNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/SelectNode.java
@@ -641,10 +641,6 @@ public class SelectNode extends ResultSetNode
 		{
 			throw StandardException.newException(SQLState.LANG_TOO_MANY_ELEMENTS);
 		}
-
-		/* Fix nullability in case of any outer joins in the fromList */
-		if (fromList.hasOuterJoins())
-			resultColumns.setNullability(true);
 	}
 
 	/**
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/dml148.out b/java/testing/org/apache/derbyTesting/functionTests/master/dml148.out
index 9f58a29cf..c560baf1d 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/dml148.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/dml148.out
@@ -162,13 +162,13 @@ ij> -- PASS:0844 If 6 rows selected with ordered rows and column values ?
     FROM SEVEN_TYPES right outer JOIN HU.STAFF
        ON GRADE IN (10, 11, 13) AND EMPNUM = T_CHAR
    ORDER BY EMPNAME, T_INT;
-T_INT      |T_CHAR    |EMPNAME             |EMP&|GRADE
-------------------------------------------------------
-NULL       |NULL      |Alice               |E1  |12   
-2          |E2        |Betty               |E2  |10   
-NULL       |NULL      |Carmen              |E3  |13   
-NULL       |NULL      |Don                 |E4  |12   
-NULL       |NULL      |Ed                  |E5  |13   
+T_INT      |T_CHAR    |EMPNAME             |EM&|GRADE
+-----------------------------------------------------
+NULL       |NULL      |Alice               |E1 |12   
+2          |E2        |Betty               |E2 |10   
+NULL       |NULL      |Carmen              |E3 |13   
+NULL       |NULL      |Don                 |E4 |12   
+NULL       |NULL      |Ed                  |E5 |13   
 ij> -- PASS:0844 If 5 rows selected with ordered rows and column values ?
 -- PASS:0844    NULL NULL Alice  E1 12  ?
 -- PASS:0844       2 E2   Betty  E2 10  ?
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/dml162.out b/java/testing/org/apache/derbyTesting/functionTests/master/dml162.out
index f8cef721e..0c569a579 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/dml162.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/dml162.out
@@ -45,21 +45,21 @@ ij> -- PASS:0863 If COUNT = 3?
 
    SELECT * FROM HU.STAFF LEFT OUTER JOIN HU.WORKS
       ON (HU.STAFF.EMPNUM=HU.WORKS.EMPNUM);
-EMP&|EMPNAME             |GRADE|CITY           |EMP&|PNUM|HOURS 
-----------------------------------------------------------------
-E1  |Alice               |12   |Deale          |E1  |P1  |40    
-E1  |Alice               |12   |Deale          |E1  |P2  |20    
-E1  |Alice               |12   |Deale          |E1  |P3  |80    
-E1  |Alice               |12   |Deale          |E1  |P4  |20    
-E1  |Alice               |12   |Deale          |E1  |P5  |12    
-E1  |Alice               |12   |Deale          |E1  |P6  |12    
-E2  |Betty               |10   |Vienna         |E2  |P1  |40    
-E2  |Betty               |10   |Vienna         |E2  |P2  |80    
-E3  |Carmen              |13   |Vienna         |E3  |P2  |20    
-E4  |Don                 |12   |Deale          |E4  |P2  |20    
-E4  |Don                 |12   |Deale          |E4  |P4  |40    
-E4  |Don                 |12   |Deale          |E4  |P5  |80    
-E5  |Ed                  |13   |Akron          |NULL|NULL|NULL  
+EM&|EMPNAME             |GRADE|CITY           |EMP&|PNUM|HOURS 
+---------------------------------------------------------------
+E1 |Alice               |12   |Deale          |E1  |P1  |40    
+E1 |Alice               |12   |Deale          |E1  |P2  |20    
+E1 |Alice               |12   |Deale          |E1  |P3  |80    
+E1 |Alice               |12   |Deale          |E1  |P4  |20    
+E1 |Alice               |12   |Deale          |E1  |P5  |12    
+E1 |Alice               |12   |Deale          |E1  |P6  |12    
+E2 |Betty               |10   |Vienna         |E2  |P1  |40    
+E2 |Betty               |10   |Vienna         |E2  |P2  |80    
+E3 |Carmen              |13   |Vienna         |E3  |P2  |20    
+E4 |Don                 |12   |Deale          |E4  |P2  |20    
+E4 |Don                 |12   |Deale          |E4  |P4  |40    
+E4 |Don                 |12   |Deale          |E4  |P5  |80    
+E5 |Ed                  |13   |Akron          |NULL|NULL|NULL  
 ij> -- PASS:0863 If 13 rows are returned?
 
    COMMIT WORK;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/outerjoin.out b/java/testing/org/apache/derbyTesting/functionTests/master/outerjoin.out
index 668ef22ef..f98577513 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/outerjoin.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/outerjoin.out
@@ -136,13 +136,13 @@ NULL
 NULL       
 NULL       
 ij> select a.* from ((values ('a', 'b')) a inner join (values ('c', 'd')) b on 1=1) left outer join (values ('e', 'f')) c on 1=1;
-1   |2   
----------
-a   |b   
+1|2
+---
+a|b
 ij> select b.* from ((values ('a', 'b')) a inner join (values ('c', 'd')) b on 1=1) left outer join (values ('e', 'f')) c on 1=1;
-1   |2   
----------
-c   |d   
+1|2
+---
+c|d
 ij> select c.* from ((values ('a', 'b')) a inner join (values ('c', 'd')) b on 1=1) left outer join (values ('e', 'f')) c on 1=1;
 1   |2   
 ---------
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/wisconsin.out b/java/testing/org/apache/derbyTesting/functionTests/master/wisconsin.out
index 935032599..72bbf7ab1 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/wisconsin.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/wisconsin.out
@@ -29214,11 +29214,9 @@ Left result set:
 					start position:
 						>= on first 1 column(s).
 						Ordered null semantics on the following columns: 
-						0 
 					stop position:
 						> on first 1 column(s).
 						Ordered null semantics on the following columns: 
-						0 
 					qualifiers:
 						None
 	Right result set:
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/JoinTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/JoinTest.java
new file mode 100644
index 000000000..1c4c852f5
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/JoinTest.java
@@ -0,0 +1,124 @@
+/*
+
+   Derby - Class org.apache.derbyTesting.functionTests.tests.lang.JoinTest
+
+   Licensed to the Apache Software Foundation (ASF) under one or more
+   contributor license agreements.  See the NOTICE file distributed with
+   this work for additional information regarding copyright ownership.
+   The ASF licenses this file to You under the Apache License, Version 2.0
+   (the "License"); you may not use this file except in compliance with
+   the License.  You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+
+ */
+
+package org.apache.derbyTesting.functionTests.tests.lang;
+
+import java.sql.ResultSet;
+import java.sql.SQLException;
+import java.sql.Statement;
+import junit.framework.Test;
+import org.apache.derbyTesting.junit.BaseJDBCTestCase;
+import org.apache.derbyTesting.junit.JDBC;
+import org.apache.derbyTesting.junit.TestConfiguration;
+
+/**
+ * Test cases for JOINs.
+ */
+public class JoinTest extends BaseJDBCTestCase {
+    public JoinTest(String name) {
+        super(name);
+    }
+
+    public static Test suite() {
+        return TestConfiguration.defaultSuite(JoinTest.class);
+    }
+
+    /**
+     * Test that the columns returned by a left or right outer join have the
+     * correct nullability. In a left outer join, the columns from the left
+     * side of the join should have their original nullability, and all the
+     * columns from the right side of the join should be nullable. In a right
+     * outer join, all the columns from the left side should be nullable,
+     * and the columns from the right side should preserve their original
+     * nullability. DERBY-4284.
+     */
+    public void testNullabilityInLeftOrRightOuterJoin() throws SQLException {
+        // Turn auto-commit off so that tearDown() can roll back all test data
+        setAutoCommit(false);
+
+        Statement s = createStatement();
+        s.execute("create table t (c1 int not null, c2 int not null, c3 int)");
+
+        // Nullability should be unchanged for columns from the left side
+        // (first three columns) and nullable for the ones from the right side).
+        ResultSet rs = s.executeQuery(
+                "select * from t t1 left outer join t t2 on 1=1");
+        JDBC.assertNullability(rs,
+                new boolean[]{false, false, true, true, true, true});
+        JDBC.assertEmpty(rs);
+
+        // Nullability should be unchanged for columns from the right side of
+        // the right outer join, and nullable for the ones from the left side.
+        rs = s.executeQuery(
+                "select * from t t1 right outer join t t2 on 1=1");
+        JDBC.assertNullability(rs,
+                new boolean[]{true, true, true, false, false, true});
+        JDBC.assertEmpty(rs);
+
+        // CASTs had some problems where they set the nullability too early
+        // to get it correctly from the underlying join. Test it here.
+        rs = s.executeQuery(
+                "select cast(t1.c1 as int), cast(t2.c2 as int) from " +
+                "t t1 left outer join t t2 on 1=1");
+        JDBC.assertNullability(rs, new boolean[]{false, true});
+        JDBC.assertEmpty(rs);
+
+        rs = s.executeQuery(
+                "select cast(t1.c1 as int), cast(t2.c2 as int) from " +
+                "t t1 right outer join t t2 on 1=1");
+        JDBC.assertNullability(rs, new boolean[]{true, false});
+        JDBC.assertEmpty(rs);
+
+        // Nested outer joins
+        rs = s.executeQuery(
+                "select t1.c1, t2.c1, t3.c1 from " +
+                "t t1 left join (t t2 left join t t3 on 1=1) on 1=1");
+        JDBC.assertNullability(rs, new boolean[]{false, true, true});
+        JDBC.assertEmpty(rs);
+
+        rs = s.executeQuery(
+                "select t1.c1, t2.c1, t3.c1 from " +
+                "t t1 right join (t t2 right join t t3 on 1=1) on 1=1");
+        JDBC.assertNullability(rs, new boolean[]{true, true, false});
+        JDBC.assertEmpty(rs);
+
+        rs = s.executeQuery(
+                "select t1.c1, t2.c1, t3.c1, t4.c1 from " +
+                "(t t1 left join t t2 on 1=1) left join " +
+                "(t t3 left join t t4 on 1=1) on 1=1");
+        JDBC.assertNullability(rs, new boolean[]{false, true, true, true});
+        JDBC.assertEmpty(rs);
+
+        rs = s.executeQuery(
+                "select t1.c1, t2.c1, t3.c1, t4.c1 from " +
+                "(t t1 left join t t2 on 1=1) right join " +
+                "(t t3 left join t t4 on 1=1) on 1=1");
+        JDBC.assertNullability(rs, new boolean[]{true, true, false, true});
+        JDBC.assertEmpty(rs);
+
+        rs = s.executeQuery(
+                "select t1.c1, t2.c1, t3.c1, t4.c1 from " +
+                "(t t1 right join t t2 on 1=1) left join " +
+                "(t t3 left join t t4 on 1=1) on 1=1");
+        JDBC.assertNullability(rs, new boolean[]{true, false, true, true});
+        JDBC.assertEmpty(rs);
+    }
+}
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/_Suite.java b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/_Suite.java
index 178a694f3..aeb52b004 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/_Suite.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/_Suite.java
@@ -73,6 +73,7 @@ public class _Suite extends BaseTestCase  {
         suite.addTest(GroupByExpressionTest.suite());
         suite.addTest(InbetweenTest.suite());
         suite.addTest(InsertTest.suite());
+        suite.addTest(JoinTest.suite());
 		suite.addTest(LangScripts.suite());
         suite.addTest(MathTrigFunctionsTest.suite());
         suite.addTest(PrepareExecuteDDL.suite());
