diff --git a/java/engine/org/apache/derby/impl/sql/execute/SortResultSet.java b/java/engine/org/apache/derby/impl/sql/execute/SortResultSet.java
index 14e6159a0..a645c6aac 100755
--- a/java/engine/org/apache/derby/impl/sql/execute/SortResultSet.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/SortResultSet.java
@@ -230,6 +230,7 @@ public class SortResultSet extends NoPutResultSetImpl
      */
 	public void	openCore() throws StandardException 
 	{
+		nextCalled = false;
 		beginTime = getCurrentTimeMillis();
 		// REVISIT: through the direct DB API, this needs to be an
 		// error, not an ASSERT; users can open twice. Only through JDBC
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/distinct.out b/java/testing/org/apache/derbyTesting/functionTests/master/distinct.out
index a142fdd86..0500da72e 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/distinct.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/distinct.out
@@ -2477,6 +2477,31 @@ NAME
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 name1                                                                                                                           |sum2                                                                                                                            
 ij> rollback;
+ij> create table td (x int);
+0 rows inserted/updated/deleted
+ij> insert into td values (1);
+1 row inserted/updated/deleted
+ij> insert into td values (1);
+1 row inserted/updated/deleted
+ij> insert into td values (2);
+1 row inserted/updated/deleted
+ij> -- distinct in subquery where the store does not perform the sort.
+select * from td, (select distinct 1 from td) as sub(x);
+X          |X          
+-----------------------
+1          |1          
+1          |1          
+2          |1          
+ij> -- get the storage system to do the sort.
+select * from td, (select distinct x from td) as sub(x);
+X          |X          
+-----------------------
+1          |2          
+1          |1          
+1          |2          
+1          |1          
+2          |2          
+2          |1          
 ij> -- reset autocomiit
 autocommit on;
 ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/distinct.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/distinct.sql
index 1af4b39ff..757ae34f5 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/distinct.sql
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/distinct.sql
@@ -329,5 +329,16 @@ prepare c1 as 'SELECT DISTINCT nb.name AS name, nb.summary AS summary
 execute c1 using 'values(''lusername1'', ''lusername2'', ''lname1'')';
 rollback;
 
+create table td (x int);
+insert into td values (1);
+insert into td values (1);
+insert into td values (2);
+
+-- distinct in subquery where the store does not perform the sort.
+select * from td, (select distinct 1 from td) as sub(x);
+
+-- get the storage system to do the sort.
+select * from td, (select distinct x from td) as sub(x);
+
 -- reset autocomiit
 autocommit on;
