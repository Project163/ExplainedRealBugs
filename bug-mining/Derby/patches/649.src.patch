diff --git a/java/engine/org/apache/derby/impl/sql/compile/GrantNode.java b/java/engine/org/apache/derby/impl/sql/compile/GrantNode.java
index 88fbc63c0..37d182998 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/GrantNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/GrantNode.java
@@ -94,7 +94,7 @@ public class GrantNode extends MiscellaneousStatementNode
 	 */
 	public QueryTreeNode bind() throws StandardException
 	{
-		privileges = (PrivilegeNode) privileges.bind( new HashMap());
+		privileges = (PrivilegeNode) privileges.bind( new HashMap(), grantees);
 		return this;
 	} // end of bind
 
diff --git a/java/engine/org/apache/derby/impl/sql/compile/PrivilegeNode.java b/java/engine/org/apache/derby/impl/sql/compile/PrivilegeNode.java
index cdba8d5fb..214173e3a 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/PrivilegeNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/PrivilegeNode.java
@@ -35,6 +35,7 @@ import org.apache.derby.impl.sql.execute.PrivilegeInfo;
 import org.apache.derby.catalog.TypeDescriptor;
 
 import java.util.HashMap;
+import java.util.List;
 
 /**
  * This node represents a set of privileges that are granted or revoked on one object.
@@ -96,16 +97,17 @@ public class PrivilegeNode extends QueryTreeNode
      * @param dependencies The list of privilege objects that this statement has already seen.
      *               If the object of this privilege is not in the list then this statement is registered
      *               as dependent on the object.
+     * @param grantees The list of grantees
      *
      * @return the bound node
      *
      * @exception StandardException	Standard error policy.
      */
-	public QueryTreeNode bind( HashMap dependencies ) throws StandardException
+	public QueryTreeNode bind( HashMap dependencies, List grantees ) throws StandardException
 	{
         Provider dependencyProvider = null;
         SchemaDescriptor sd = null;
-        
+		
         switch( objectType)
         {
         case TABLE_PRIVILEGES:
@@ -123,11 +125,15 @@ public class PrivilegeNode extends QueryTreeNode
             if (isSessionSchema(sd.getSchemaName()))
                 throw StandardException.newException(SQLState.LANG_OPERATION_NOT_ALLOWED_ON_SESSION_SCHEMA_TABLES);
 
-            // GrantRevoke TODO: Disable grant on VTIs and Synonyms
             if (td.getTableType() != TableDescriptor.BASE_TABLE_TYPE &&
             		td.getTableType() != TableDescriptor.VIEW_TYPE)
                 throw StandardException.newException(SQLState.AUTH_GRANT_REVOKE_NOT_ALLOWED, tableName.getFullTableName());
 
+			// Can not grant/revoke permissions from self
+			if (grantees.contains(sd.getAuthorizationId()))
+				throw StandardException.newException(SQLState.AUTH_GRANT_REVOKE_NOT_ALLOWED,
+						 td.getQualifiedName());
+
             specificPrivileges.bind( td);
             dependencyProvider = td;
             break;
@@ -146,6 +152,11 @@ public class PrivilegeNode extends QueryTreeNode
                 rd.isFunction ? AliasInfo.ALIAS_NAME_SPACE_FUNCTION_AS_CHAR : AliasInfo.ALIAS_NAME_SPACE_PROCEDURE_AS_CHAR
                 );
 
+			// Can not grant/revoke permissions from self
+			if (grantees.contains(sd.getAuthorizationId()))
+				throw StandardException.newException(SQLState.AUTH_GRANT_REVOKE_NOT_ALLOWED,
+						 rd.name.getFullTableName());
+
             if( rd.paramTypeList == null)
             {
                 // No signature was specified. Make sure that there is exactly one routine with that name.
@@ -198,6 +209,7 @@ public class PrivilegeNode extends QueryTreeNode
             dependencyProvider = proc;
             break;
         }
+
         if( dependencyProvider != null)
         {
             if( dependencies.get( dependencyProvider) == null)
diff --git a/java/engine/org/apache/derby/impl/sql/compile/RevokeNode.java b/java/engine/org/apache/derby/impl/sql/compile/RevokeNode.java
index 933ea925f..0d1312413 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/RevokeNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/RevokeNode.java
@@ -94,7 +94,7 @@ public class RevokeNode extends MiscellaneousStatementNode
      */
 	public QueryTreeNode bind() throws StandardException
 	{
-        privileges = (PrivilegeNode) privileges.bind( new HashMap());
+        privileges = (PrivilegeNode) privileges.bind( new HashMap(), grantees);
         return this;
     } // end of bind
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/grantRevokeDDL.out b/java/testing/org/apache/derbyTesting/functionTests/master/grantRevokeDDL.out
index 0add61101..eddc91f3d 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/grantRevokeDDL.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/grantRevokeDDL.out
@@ -2834,4 +2834,48 @@ NULL
 0.011   
 0.023   
 3 rows selected
+ij(MAMTA1)> -- DERBY-1538: Disable ability to GRANT or REVOKE from self
+CREATE FUNCTION F_ABS(P1 INT)
+RETURNS INT NO SQL
+RETURNS NULL ON NULL INPUT
+EXTERNAL NAME 'java.lang.Math.abs'
+LANGUAGE JAVA PARAMETER STYLE JAVA;
+0 rows inserted/updated/deleted
+ij(MAMTA1)> create table mamta1Table ( i int, j int);
+0 rows inserted/updated/deleted
+ij(MAMTA1)> -- Try granting or revoking to mamta1. Should all fail
+grant select on mamta1Table to mamta1;
+ERROR: Failed with SQLSTATE 2850F
+ij(MAMTA1)> revoke select on mamta1Table from mamta1;
+ERROR: Failed with SQLSTATE 2850F
+ij(MAMTA1)> grant execute on function f_abs to mamta1;
+ERROR: Failed with SQLSTATE 2850F
+ij(MAMTA1)> revoke execute on function f_abs from mamta1 restrict;
+ERROR: Failed with SQLSTATE 2850F
+ij(MAMTA1)> -- Connect as database owner. Even she can not grant to owner or revoke from owner
+set connection satConnection;
+ij(SATCONNECTION)> set schema mamta1;
+0 rows inserted/updated/deleted
+ij(SATCONNECTION)> grant select on mamta1Table to mamta1;
+ERROR: Failed with SQLSTATE 2850F
+ij(SATCONNECTION)> revoke select on mamta1Table from mamta1;
+ERROR: Failed with SQLSTATE 2850F
+ij(SATCONNECTION)> grant execute on function f_abs to mamta1;
+ERROR: Failed with SQLSTATE 2850F
+ij(SATCONNECTION)> revoke execute on function f_abs from mamta1 restrict;
+ERROR: Failed with SQLSTATE 2850F
+ij(SATCONNECTION)> -- But Grant/Revoke to another user should pass
+grant select on mamta1Table to randy;
+0 rows inserted/updated/deleted
+ij(SATCONNECTION)> revoke select on mamta1Table from randy;
+0 rows inserted/updated/deleted
+ij(SATCONNECTION)> grant execute on function f_abs to randy;
+0 rows inserted/updated/deleted
+ij(SATCONNECTION)> revoke execute on function f_abs from randy restrict;
+0 rows inserted/updated/deleted
+ij(SATCONNECTION)> set connection mamta1;
+ij(MAMTA1)> drop table mamta1Table;
+0 rows inserted/updated/deleted
+ij(MAMTA1)> drop function f_abs;
+0 rows inserted/updated/deleted
 ij(MAMTA1)> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/grantRevokeDDL.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/grantRevokeDDL.sql
index 82adeac51..14a5632cc 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/grantRevokeDDL.sql
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/grantRevokeDDL.sql
@@ -1782,3 +1782,43 @@ select cast (TAN(d) as DECIMAL(6,3)) AS TAN FROM SYSFUN_MATH_TEST;
 
 select cast (DEGREES(d) as DECIMAL(6,3)) AS DEGREES FROM SYSFUN_MATH_TEST;
 select cast (RADIANS(d) as DECIMAL(6,3)) AS RADIANS FROM SYSFUN_MATH_TEST;
+
+-- DERBY-1538: Disable ability to GRANT or REVOKE from self
+
+CREATE FUNCTION F_ABS(P1 INT)
+RETURNS INT NO SQL
+RETURNS NULL ON NULL INPUT
+EXTERNAL NAME 'java.lang.Math.abs'
+LANGUAGE JAVA PARAMETER STYLE JAVA;
+
+create table mamta1Table ( i int, j int);
+
+-- Try granting or revoking to mamta1. Should all fail
+
+grant select on mamta1Table to mamta1;
+revoke select on mamta1Table from mamta1;
+
+grant execute on function f_abs to mamta1;
+revoke execute on function f_abs from mamta1 restrict;
+
+-- Connect as database owner. Even she can not grant to owner or revoke from owner
+set connection satConnection;
+set schema mamta1;
+
+grant select on mamta1Table to mamta1;
+revoke select on mamta1Table from mamta1;
+
+grant execute on function f_abs to mamta1;
+revoke execute on function f_abs from mamta1 restrict;
+
+-- But Grant/Revoke to another user should pass
+grant select on mamta1Table to randy;
+revoke select on mamta1Table from randy;
+
+grant execute on function f_abs to randy;
+revoke execute on function f_abs from randy restrict;
+
+set connection mamta1;
+
+drop table mamta1Table;
+drop function f_abs;
