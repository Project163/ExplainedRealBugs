diff --git a/java/engine/org/apache/derby/impl/store/replication/net/ReplicationMessageReceive.java b/java/engine/org/apache/derby/impl/store/replication/net/ReplicationMessageReceive.java
index 87bb19db5..d59aa2af6 100644
--- a/java/engine/org/apache/derby/impl/store/replication/net/ReplicationMessageReceive.java
+++ b/java/engine/org/apache/derby/impl/store/replication/net/ReplicationMessageReceive.java
@@ -209,11 +209,18 @@ public class ReplicationMessageReceive {
             sendPingSemaphore.notify();
         }
 
-        if (socketConn != null) {
-            socketConn.tearDown();
-        }
-        if (serverSocket != null) {
-            serverSocket.close();
+        // socketConn.tearDown() may fail if the master has crashed. We still
+        // want to close the server socket if an exception is thrown, so that
+        // we don't prevent starting a new slave listening to the same port.
+        // Therefore, use try/finally. DERBY-3878
+        try {
+            if (socketConn != null) {
+                socketConn.tearDown();
+            }
+        } finally {
+            if (serverSocket != null) {
+                serverSocket.close();
+            }
         }
     }
     
diff --git a/java/engine/org/apache/derby/impl/store/replication/net/SocketConnection.java b/java/engine/org/apache/derby/impl/store/replication/net/SocketConnection.java
index 69c1cb779..103d6d5af 100644
--- a/java/engine/org/apache/derby/impl/store/replication/net/SocketConnection.java
+++ b/java/engine/org/apache/derby/impl/store/replication/net/SocketConnection.java
@@ -110,8 +110,15 @@ public class SocketConnection {
      *                     the socket or the streams.
      */
     public void tearDown() throws IOException {
-        objInputStream.close();
-        objOutputStream.close();
-        socket.close();
+        // If the other party has crashed, closing the streams may fail (at
+        // least the output stream since its close() method calls flush()).
+        // In any case, we want the socket to be closed, so close it in a
+        // finally clause. DERBY-3878
+        try {
+            objInputStream.close();
+            objOutputStream.close();
+        } finally {
+            socket.close();
+        }
     }
 }
