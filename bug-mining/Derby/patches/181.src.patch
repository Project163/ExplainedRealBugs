diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/errorCode.out b/java/testing/org/apache/derbyTesting/functionTests/master/errorCode.out
index e067b292a..d3a219c74 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/errorCode.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/errorCode.out
@@ -50,6 +50,345 @@ ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state =
 SQL_&|MESSAGE                                                                                                                         |SEVERITY   
 --------------------------------------------------------------------------------------------------------------------------------------------------
 42X74|Invalid CALL statement syntax.                                                                                                  |20000      
+ij> -- test ErrorMessages VTI for severe errors
+-- session_severity
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = '04501';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+04501|Database connection refused.                                                                                                    |40000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = '28502';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+28502|The user name '{0}' is not valid.                                                                                               |40000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ004';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XJ004|Database '{0}' not found.                                                                                                       |40000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ028';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XJ028|The URL '{0}' is not properly formed.                                                                                           |40000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ040';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XJ040|Failed to start database '{0}', see the next exception for details.                                                             |40000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ041';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XJ041|Failed to create database '{0}', see the next exception for details.                                                            |40000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ049';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XJ049|Conflicting create attributes specified.                                                                                        |40000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ081';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XJ081|Invalid value '{0}' passed as parameter '{1}' to method '{2}'                                                                   |20000      
+XJ081|Conflicting create/restore/recovery attributes specified.                                                                       |40000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ05B';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XJ05B|JDBC attribute '{0}' has an invalid value '{1}', valid values are '{2}'.                                                        |40000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XXXXX';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XXXXX|Normal database session close.                                                                                                  |40000      
+ij> -- database_severity
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM01';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM01|Startup failed due to an exception. See next exception for details.                                                             |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM02';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM02|Startup failed due to missing functionality for {0}. Please ensure your classpath includes the correct Derby software.          |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM05';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM05|Startup failed due to missing product version information for {0}.                                                              |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM06';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM06|Startup failed. An encrypted database cannot be accessed without the correct boot password.                                     |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM07';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM07|Startup failed. Boot password must be at least 8 bytes long.                                                                    |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM08';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM08|Could not instantiage {0} StorageFactory class {1}.                                                                             |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0G';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0G|Failed to start encryption engine. Please make sure you are running Java 2 and have downloaded an encryption provider such as j&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0H';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0H|Directory {0} cannot be created.                                                                                                |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0I';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0I|Directory {0} cannot be removed.                                                                                                |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0J';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0J|Directory {0} already exists.                                                                                                   |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0K';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0K|Unknown sub-protocol for database name {0}.                                                                                     |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0L';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0L|Specified authentication scheme class {0} does implement the authentication interface {1}.                                      |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0M';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0M|Error creating instance of authentication scheme class {0}.                                                                     |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0N';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0N|JDBC Driver registration with java.sql.DriverManager failed. See next exception for details.                                    |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0P';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0P|Service provider is read-only. Operation not permitted.                                                                         |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0Q';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0Q|File {0} not found. Please make sure that backup copy is the correct one and it is not corrupted.                               |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0R';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0R|Unable to remove File {0}.                                                                                                      |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0S';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0S|Unable to rename file '{0}' to '{1}'                                                                                            |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0T';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0T|Ambiguous sub-protocol for database name {0}.                                                                                   |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0X';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0X|Supplied territory description '{0}' is invalid, expecting ln[_CO[_variant]]
+ln=lower-case two-letter ISO-639 language code, CO&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0Y';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0Y|Backup database directory {0} not found. Please make sure that the specified backup path is right.                              |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0Z';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0Z|Unable to copy file '{0}' to '{1}'. Please make sure that there is enough space and permissions are correct.                    |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XCW00';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XCW00|Unsupported upgrade from '{0}' to '{1}'.                                                                                        |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA0';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLA0|Cannot flush the log file to disk {0}.                                                                                          |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA1';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLA1|Log Record has been sent to the stream, but it cannot be applied to the store (Object {0}).  This may cause recovery problems a&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA2';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLA2|System will shutdown, got I/O Exception while accessing log file.                                                               |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA3';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLA3|Log Corrupted, has invalid data in the log stream.                                                                              |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA4';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLA4|Cannot write to the log, most likely the log is full.  Please delete unnecessary files.  It is also possible that the file syst&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA5';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLA5|Cannot read log stream for some reason to rollback transaction {0}.                                                             |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA6';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLA6|Cannot recover the database.                                                                                                    |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA7';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLA7|Cannot redo operation {0} in the log.                                                                                           |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA8';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLA8|Cannot rollback transaction {0}, trying to compensate {1} operation with {2}                                                    |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAA';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAA|The store has been marked for shutdown by an earlier exception.                                                                 |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAB';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAB|Cannot find log file {0}, please make sure your logDevice property is properly set with the correct path separator for your pla&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAC';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAC|Database at {0} have incompatible format with the current version of software, it may have been created by or upgraded by a lat&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAD';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAD|log Record at instant {2} in log file {3} corrupted. Expected log record length {0}, real length {1}.                           |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAE';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAE|Control file at {0} cannot be written or updated.                                                                               |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAF';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAF|A Read Only database was created with dirty data buffers.                                                                       |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAH';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAH|A Read Only database is being updated.                                                                                          |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAI';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAI|Cannot log the checkpoint log record                                                                                            |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAJ';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAJ|The logging system has been marked to shut down due to an earlier problem and will not allow any more operations until the syst&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAK';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAK|Database has exceeded largest log file number {0}.                                                                              |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAL';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAL|log record size {2} exceeded the maximum allowable log file size {3}. Error encounted in log file {0}, position {1}             |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAM';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAM|Cannot verify database format at {1} due to IOException.                                                                        |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAN';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAN|Database at {0} has an incompatible format with the current version of the software.  The database was created by or upgraded b&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAO';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAO|Recovery failed unexpected problem {0}.                                                                                         |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAP';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAP|Database at {0} is at version {1}. Beta databases cannot be upgraded,                                                           |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAQ';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAQ|cannot create log file at directory {0}.                                                                                        |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAR';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAR|Unable to copy log file '{0}' to '{1}' during restore. Please make sure that there is enough space and permissions are correct. |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAS';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAS|Log directory {0} not found in backup during restore. Please make sure that backup copy is the correct one and it is not corrup&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAT';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAT|Log directory {0} exists. Please make sure specified logDevice location is correct.                                             |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB0';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB1';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB2';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB3';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB4';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB5';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB6';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB7';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB8';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB9';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDBA';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG0';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSDG0|Page {0} could not be read from disk.                                                                                           |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG1';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSDG1|Page {0} could not be written to disk, please check if disk is full.                                                            |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG2';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSDG2|Invalid checksum on Page {0}, expected={1}, on-disk version={2}, page dump follows: {3}                                         |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG3';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSDG3|Meta-data for Container {0} could not be accessed                                                                               |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG5';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSDG5|Database is not in create mode when createFinished is called.                                                                   |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG6';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSDG6|Data segment directory not found in {0} backup during restore. Please make sure that backup copy is the right one and it is not&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG7';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSDG7|Directory {0} could not be removed during restore. Please make sure that permissions are correct.                               |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG8';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSDG8|Unable to copy directory '{0}' to '{1}' during restore. Please make sure that there is enough space and permissions are correct&|45000      
+ij> -- system_severity
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSTB0';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSTB0|An exception was thrown during transaction abort.                                                                               |50000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSTB2';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSTB2|Cannot log transaction changes, maybe trying to write to a read only database.                                                  |50000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSTB3';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSTB3|Cannot abort transaction because the log manager is null, probably due to an earlier error.                                     |50000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSTB5';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSTB5|Creating database with logging disabled encountered unexpected problem.                                                         |50000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSTB6';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSTB6|Cannot substitue a transaction table with another while one is already in use.                                                  |50000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ015';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XJ015|Derby system shutdown.                                                                                                          |50000      
 ij> -- cleanup
 drop table t;
 0 rows inserted/updated/deleted
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/j9_13/errorCode.out b/java/testing/org/apache/derbyTesting/functionTests/master/j9_13/errorCode.out
index e6aa389ce..ffea79588 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/j9_13/errorCode.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/j9_13/errorCode.out
@@ -50,6 +50,345 @@ ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state =
 SQL_&|MESSAGE                                                                                                                         |SEVERITY   
 --------------------------------------------------------------------------------------------------------------------------------------------------
 42X74|Invalid CALL statement syntax.                                                                                                  |20000      
+ij> -- test ErrorMessages VTI for severe errors
+-- session_severity
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = '04501';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+04501|Database connection refused.                                                                                                    |40000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = '28502';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+28502|The user name '{0}' is not valid.                                                                                               |40000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ004';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XJ004|Database '{0}' not found.                                                                                                       |40000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ028';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XJ028|The URL '{0}' is not properly formed.                                                                                           |40000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ040';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XJ040|Failed to start database '{0}', see the next exception for details.                                                             |40000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ041';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XJ041|Failed to create database '{0}', see the next exception for details.                                                            |40000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ049';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XJ049|Conflicting create attributes specified.                                                                                        |40000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ081';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XJ081|Conflicting create/restore/recovery attributes specified.                                                                       |40000      
+XJ081|Invalid value '{0}' passed as parameter '{1}' to method '{2}'                                                                   |20000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ05B';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XJ05B|JDBC attribute '{0}' has an invalid value '{1}', valid values are '{2}'.                                                        |40000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XXXXX';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XXXXX|Normal database session close.                                                                                                  |40000      
+ij> -- database_severity
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM01';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM01|Startup failed due to an exception. See next exception for details.                                                             |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM02';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM02|Startup failed due to missing functionality for {0}. Please ensure your classpath includes the correct Derby software.          |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM05';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM05|Startup failed due to missing product version information for {0}.                                                              |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM06';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM06|Startup failed. An encrypted database cannot be accessed without the correct boot password.                                     |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM07';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM07|Startup failed. Boot password must be at least 8 bytes long.                                                                    |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM08';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM08|Could not instantiage {0} StorageFactory class {1}.                                                                             |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0G';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0G|Failed to start encryption engine. Please make sure you are running Java 2 and have downloaded an encryption provider such as j&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0H';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0H|Directory {0} cannot be created.                                                                                                |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0I';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0I|Directory {0} cannot be removed.                                                                                                |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0J';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0J|Directory {0} already exists.                                                                                                   |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0K';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0K|Unknown sub-protocol for database name {0}.                                                                                     |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0L';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0L|Specified authentication scheme class {0} does implement the authentication interface {1}.                                      |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0M';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0M|Error creating instance of authentication scheme class {0}.                                                                     |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0N';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0N|JDBC Driver registration with java.sql.DriverManager failed. See next exception for details.                                    |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0P';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0P|Service provider is read-only. Operation not permitted.                                                                         |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0Q';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0Q|File {0} not found. Please make sure that backup copy is the correct one and it is not corrupted.                               |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0R';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0R|Unable to remove File {0}.                                                                                                      |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0S';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0S|Unable to rename file '{0}' to '{1}'                                                                                            |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0T';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0T|Ambiguous sub-protocol for database name {0}.                                                                                   |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0X';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0X|Supplied territory description '{0}' is invalid, expecting ln[_CO[_variant]]
+ln=lower-case two-letter ISO-639 language code, CO&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0Y';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0Y|Backup database directory {0} not found. Please make sure that the specified backup path is right.                              |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0Z';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XBM0Z|Unable to copy file '{0}' to '{1}'. Please make sure that there is enough space and permissions are correct.                    |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XCW00';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XCW00|Unsupported upgrade from '{0}' to '{1}'.                                                                                        |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA0';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLA0|Cannot flush the log file to disk {0}.                                                                                          |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA1';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLA1|Log Record has been sent to the stream, but it cannot be applied to the store (Object {0}).  This may cause recovery problems a&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA2';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLA2|System will shutdown, got I/O Exception while accessing log file.                                                               |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA3';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLA3|Log Corrupted, has invalid data in the log stream.                                                                              |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA4';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLA4|Cannot write to the log, most likely the log is full.  Please delete unnecessary files.  It is also possible that the file syst&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA5';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLA5|Cannot read log stream for some reason to rollback transaction {0}.                                                             |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA6';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLA6|Cannot recover the database.                                                                                                    |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA7';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLA7|Cannot redo operation {0} in the log.                                                                                           |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA8';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLA8|Cannot rollback transaction {0}, trying to compensate {1} operation with {2}                                                    |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAA';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAA|The store has been marked for shutdown by an earlier exception.                                                                 |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAB';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAB|Cannot find log file {0}, please make sure your logDevice property is properly set with the correct path separator for your pla&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAC';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAC|Database at {0} have incompatible format with the current version of software, it may have been created by or upgraded by a lat&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAD';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAD|log Record at instant {2} in log file {3} corrupted. Expected log record length {0}, real length {1}.                           |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAE';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAE|Control file at {0} cannot be written or updated.                                                                               |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAF';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAF|A Read Only database was created with dirty data buffers.                                                                       |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAH';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAH|A Read Only database is being updated.                                                                                          |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAI';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAI|Cannot log the checkpoint log record                                                                                            |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAJ';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAJ|The logging system has been marked to shut down due to an earlier problem and will not allow any more operations until the syst&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAK';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAK|Database has exceeded largest log file number {0}.                                                                              |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAL';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAL|log record size {2} exceeded the maximum allowable log file size {3}. Error encounted in log file {0}, position {1}             |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAM';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAM|Cannot verify database format at {1} due to IOException.                                                                        |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAN';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAN|Database at {0} has an incompatible format with the current version of the software.  The database was created by or upgraded b&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAO';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAO|Recovery failed unexpected problem {0}.                                                                                         |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAP';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAP|Database at {0} is at version {1}. Beta databases cannot be upgraded,                                                           |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAQ';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAQ|cannot create log file at directory {0}.                                                                                        |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAR';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAR|Unable to copy log file '{0}' to '{1}' during restore. Please make sure that there is enough space and permissions are correct. |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAS';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAS|Log directory {0} not found in backup during restore. Please make sure that backup copy is the correct one and it is not corrup&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAT';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSLAT|Log directory {0} exists. Please make sure specified logDevice location is correct.                                             |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB0';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB1';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB2';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB3';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB4';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB5';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB6';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB7';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB8';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB9';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDBA';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG0';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSDG0|Page {0} could not be read from disk.                                                                                           |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG1';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSDG1|Page {0} could not be written to disk, please check if disk is full.                                                            |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG2';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSDG2|Invalid checksum on Page {0}, expected={1}, on-disk version={2}, page dump follows: {3}                                         |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG3';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSDG3|Meta-data for Container {0} could not be accessed                                                                               |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG5';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSDG5|Database is not in create mode when createFinished is called.                                                                   |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG6';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSDG6|Data segment directory not found in {0} backup during restore. Please make sure that backup copy is the right one and it is not&|45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG7';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSDG7|Directory {0} could not be removed during restore. Please make sure that permissions are correct.                               |45000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG8';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSDG8|Unable to copy directory '{0}' to '{1}' during restore. Please make sure that there is enough space and permissions are correct&|45000      
+ij> -- system_severity
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSTB0';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSTB0|An exception was thrown during transaction abort.                                                                               |50000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSTB2';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSTB2|Cannot log transaction changes, maybe trying to write to a read only database.                                                  |50000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSTB3';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSTB3|Cannot abort transaction because the log manager is null, probably due to an earlier error.                                     |50000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSTB5';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSTB5|Creating database with logging disabled encountered unexpected problem.                                                         |50000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSTB6';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XSTB6|Cannot substitue a transaction table with another while one is already in use.                                                  |50000      
+ij> select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ015';
+SQL_&|MESSAGE                                                                                                                         |SEVERITY   
+--------------------------------------------------------------------------------------------------------------------------------------------------
+XJ015|Derby system shutdown.                                                                                                          |50000      
 ij> -- cleanup
 drop table t;
 0 rows inserted/updated/deleted
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/errorCode.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/errorCode.sql
index 150b12943..7adc2694a 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/errorCode.sql
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/errorCode.sql
@@ -43,5 +43,98 @@ select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = '070
 select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = '22012';
 select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = '42X74';
 
+-- test ErrorMessages VTI for severe errors
+-- session_severity
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = '04501';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = '28502';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ004';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ028';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ040';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ041';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ049';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ081';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ05B';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XXXXX';
+
+-- database_severity
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM01';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM02';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM05';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM06';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM07';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM08';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0G';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0H';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0I';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0J';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0K';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0L';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0M';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0N';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0P';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0Q';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0R';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0S';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0T';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0X';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0Y';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XBM0Z';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XCW00';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA0';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA1';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA2';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA3';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA4';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA5';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA6';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA7';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLA8';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAA';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAB';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAC';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAD';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAE';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAF';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAH';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAI';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAJ';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAK';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAL';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAM';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAN';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAO';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAP';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAQ';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAR';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAS';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSLAT';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB0';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB1';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB2';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB3';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB4';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB5';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB6';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB7';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB8';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDB9';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDBA';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG0';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG1';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG2';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG3';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG5';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG6';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG7';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSDG8';
+
+-- system_severity
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSTB0';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSTB2';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSTB3';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSTB5';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XSTB6';
+select * from new org.apache.derby.diag.ErrorMessages() c where sql_state = 'XJ015';
+
 -- cleanup
 drop table t;
