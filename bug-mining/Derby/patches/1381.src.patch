diff --git a/java/engine/org/apache/derby/iapi/db/Database.java b/java/engine/org/apache/derby/iapi/db/Database.java
index 6c2e912a6..d4fc22c8a 100644
--- a/java/engine/org/apache/derby/iapi/db/Database.java
+++ b/java/engine/org/apache/derby/iapi/db/Database.java
@@ -133,13 +133,14 @@ public interface Database extends org.apache.derby.database.Database, LocaleFind
      *
      * @param dbname the replication database that is being failed over.
      *
-     * @exception SQLException   1) If the failover succeeds, an exception is
-     *                              thrown to indicate that the master database
-     *                              was shutdown after a successful failover
-     *                           2) If a failure occurs during network
-     *                              communication with slave.
+     * @exception StandardException 1) If the failover succeeds, an exception
+     *                                 is thrown to indicate that the master
+     *                                 database was shutdown after a successful
+     *                                 failover
+     *                              2) If a failure occurs during network
+     *                                 communication with slave.
      */
-    public void failover(String dbname) throws SQLException;
+    public void failover(String dbname) throws StandardException;
 
     /**
      * Used to indicated whether the database is in the replication
diff --git a/java/engine/org/apache/derby/impl/db/BasicDatabase.java b/java/engine/org/apache/derby/impl/db/BasicDatabase.java
index 7fedafcfd..87638bfd9 100644
--- a/java/engine/org/apache/derby/impl/db/BasicDatabase.java
+++ b/java/engine/org/apache/derby/impl/db/BasicDatabase.java
@@ -412,12 +412,8 @@ public class BasicDatabase implements ModuleControl, ModuleSupportable, Property
     /**
      * @see org.apache.derby.iapi.db.Database#failover(String)
      */
-    public void failover(String dbname) throws SQLException {
-        try {
-            af.failover(dbname);
-        } catch (StandardException se) {
-            throw PublicAPI.wrapStandardException(se);
-        }
+    public void failover(String dbname) throws StandardException {
+        af.failover(dbname);
     }
 
 	public void freeze() throws SQLException
diff --git a/java/engine/org/apache/derby/impl/db/SlaveDatabase.java b/java/engine/org/apache/derby/impl/db/SlaveDatabase.java
index 02969213f..9d8b96baa 100644
--- a/java/engine/org/apache/derby/impl/db/SlaveDatabase.java
+++ b/java/engine/org/apache/derby/impl/db/SlaveDatabase.java
@@ -253,30 +253,26 @@ public class SlaveDatabase extends BasicDatabase {
         slaveFac = null;
     }
 
-    public void failover(String dbname) throws SQLException {
-        try {
-            if (inReplicationSlaveMode) {
-                slaveFac.failover();
-                // SlaveFactory#failover will make the 
-                // SlaveDatabaseBootThread complete booting of the store 
-                // modules, and inReplicationSlaveMode will then be set to 
-                // false (see SlaveDatabaseBootThread#run). 
-                // Wait until store is completely booted before returning from 
-                // this method
-                while (inReplicationSlaveMode) {
-                    try {
-                        Thread.sleep(500);
-                    } catch (InterruptedException ie) {
-                    // do nothing
-                    }
+    public void failover(String dbname) throws StandardException {
+        if (inReplicationSlaveMode) {
+            slaveFac.failover();
+            // SlaveFactory#failover will make the
+            // SlaveDatabaseBootThread complete booting of the store
+            // modules, and inReplicationSlaveMode will then be set to
+            // false (see SlaveDatabaseBootThread#run).
+            // Wait until store is completely booted before returning from
+            // this method
+            while (inReplicationSlaveMode) {
+                try {
+                    Thread.sleep(500);
+                } catch (InterruptedException ie) {
+                // do nothing
                 }
-            } else {
-                // If failover is performed on a master that has been a slave 
-                // earlier
-                super.failover(dbname);
             }
-        } catch (StandardException se) {
-            throw PublicAPI.wrapStandardException(se);
+        } else {
+            // If failover is performed on a master that has been a slave
+            // earlier
+            super.failover(dbname);
         }
     }
     
diff --git a/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java b/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java
index fd43c8b05..0d9ccbb58 100644
--- a/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java
+++ b/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java
@@ -852,15 +852,15 @@ public abstract class EmbedConnection implements EngineConnection
      * 
      * @param tr an instance of TransactionResourceImpl Links the connection 
      *           to the database.
-     * @throws java.sql.SQLException 1) Thrown upon a authorization failure 
-     *                           2) If the failover succeeds, an exception is
+     * @throws StandardException 1) If the failover succeeds, an exception is
      *                              thrown to indicate that the master database
      *                              was shutdown after a successful failover
-     *                           3) If a failure occurs during network 
+     *                           2) If a failure occurs during network
      *                              communication with slave.
+     * @throws SQLException      1) Thrown upon a authorization failure.
      */
     private void handleFailoverMaster(TransactionResourceImpl tr)
-        throws SQLException {
+        throws SQLException, StandardException {
 
         // If authorization is turned on, we need to check if this
         // user is database owner.
@@ -906,7 +906,11 @@ public abstract class EmbedConnection implements EngineConnection
         // databases in slave mode since the AuthenticationService has
         // not been booted for the database
 
-        database.failover(getTR().getDBName());
+        try {
+            database.failover(getTR().getDBName());
+        } catch (StandardException se) {
+            throw Util.generateCsSQLException(se);
+        }
     }
 	/**
 	 * Remove any encryption or upgarde properties from the given properties
diff --git a/java/engine/org/apache/derby/impl/services/replication/master/MasterController.java b/java/engine/org/apache/derby/impl/services/replication/master/MasterController.java
index faabe2a91..87e435849 100644
--- a/java/engine/org/apache/derby/impl/services/replication/master/MasterController.java
+++ b/java/engine/org/apache/derby/impl/services/replication/master/MasterController.java
@@ -278,6 +278,13 @@ public class MasterController
             //The exception thrown is of Database Severity, this shuts
             //down the master database.
             teardownNetwork();
+
+            //If we require an exception of Database Severity to shutdown the
+            //database to shutdown the database we need to unfreeze first
+            //before throwing the exception. Unless we unfreeze the shutdown
+            //hangs.
+            rawStoreFactory.unfreeze();
+
             throw StandardException.newException
                     (SQLState.REPLICATION_FAILOVER_SUCCESSFUL, dbname);  
         } else {
