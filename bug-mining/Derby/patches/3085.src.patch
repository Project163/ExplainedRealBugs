diff --git a/java/engine/org/apache/derby/impl/jdbc/EmbedDatabaseMetaData.java b/java/engine/org/apache/derby/impl/jdbc/EmbedDatabaseMetaData.java
index d1ce8f460..971554bd1 100644
--- a/java/engine/org/apache/derby/impl/jdbc/EmbedDatabaseMetaData.java
+++ b/java/engine/org/apache/derby/impl/jdbc/EmbedDatabaseMetaData.java
@@ -331,7 +331,10 @@ public class EmbedDatabaseMetaData extends ConnectionChild
      * @return true if so
      */
 	public boolean usesLocalFiles() {
-		return true;
+        if (url.contains("memory"))
+            return false;
+        else
+            return true;
 	}
 
     /**
@@ -340,7 +343,10 @@ public class EmbedDatabaseMetaData extends ConnectionChild
      * @return true if the database uses a local file for each table
      */
 	public boolean usesLocalFilePerTable() {
-		return true;
+        if (url.contains("memory"))
+            return false;
+        else
+            return true;
 	}
 
     /**
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/memorydb/Derby6662Test.java b/java/testing/org/apache/derbyTesting/functionTests/tests/memorydb/Derby6662Test.java
new file mode 100644
index 000000000..79247b8b6
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/memorydb/Derby6662Test.java
@@ -0,0 +1,118 @@
+/*
+   Derby - Class org.apache.derbyTesting.functionTests.tests.memorydb.Derby6662Test
+
+   Licensed to the Apache Software Foundation (ASF) under one
+   or more contributor license agreements.  See the NOTICE file
+   distributed with this work for additional information
+   regarding copyright ownership.  The ASF licenses this file
+   to you under the Apache License, Version 2.0 (the
+   "License"); you may not use this file except in compliance
+   with the License.  You may obtain a copy of the License at
+
+     http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing,
+   software distributed under the License is distributed on an
+   "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+   KIND, either express or implied.  See the License for the
+   specific language governing permissions and limitations
+   under the License.
+ */
+
+package org.apache.derbyTesting.functionTests.tests.memorydb;
+
+import junit.framework.Test;
+import java.sql.Connection;
+import java.sql.DatabaseMetaData;
+import java.sql.DriverManager;
+import java.sql.SQLException;
+import org.apache.derbyTesting.junit.BaseJDBCTestCase;
+import org.apache.derbyTesting.junit.TestConfiguration;
+
+public class Derby6662Test extends BaseJDBCTestCase {
+    
+    public Derby6662Test(String name) { super(name); }
+    
+    public static Test suite() {
+      return TestConfiguration.defaultSuite(Derby6662Test.class);
+    }
+    
+    /** Dispose of objects after testing. */
+    protected void tearDown() throws Exception
+    {
+      super.tearDown();
+    }
+    
+    public void testDatabaseMetaDataCalls() throws SQLException
+    {
+        DatabaseMetaData dmd = getDMD();
+        assertFalse(dmd.usesLocalFilePerTable());
+        assertFalse(dmd.usesLocalFiles());
+    }
+    
+    private DatabaseMetaData getDMD() throws SQLException
+    {
+        return obtainConnection().getMetaData();
+    }
+    
+    /**
+     * Obtains a connection to an in-memory database.
+     *
+     * @return A connection to an in-memory database.
+     * @throws SQLException if obtaining the connection fails
+     */
+    private Connection obtainConnection()
+          throws SQLException {
+      try {
+          if (usingDerbyNetClient()) {
+              Class.forName("org.apache.derby.jdbc.ClientDriver");
+          } else {
+              Class.forName("org.apache.derby.jdbc.EmbeddedDriver");
+          }
+      } catch (Exception e) {
+          SQLException sqle =  new SQLException(e.getMessage());
+          sqle.initCause(e);
+          throw sqle;
+      }
+      StringBuffer sb = constructUrl().append(";create=true");
+      return DriverManager.getConnection(sb.toString());
+    }
+    
+    /**
+     * Drops the database used by the test.
+     *
+     * @throws SQLException if dropping the database fails
+     */
+    private void dropInMemoryDb() throws SQLException {
+        StringBuffer sb = constructUrl().append(";drop=true");
+        try {
+            DriverManager.getConnection(sb.toString());
+            fail("Dropping database should have raised exception.");
+        } catch (SQLException sqle) {
+            assertSQLState("08006", sqle);
+        }
+    }
+    
+    /**
+     * Constructs the default URL for the in-memory test database.
+     *
+     * @return A database URL (without any connection attributes).
+     */
+    private StringBuffer constructUrl() {
+        StringBuffer sb = new StringBuffer("jdbc:derby:");
+        if (usingEmbedded()) {
+            sb.append("memory:");
+        } else {
+            // This is a hack. Change this when proper support for the in-memory
+            // back end has been implemented.
+            sb.append("//");
+            sb.append(TestConfiguration.getCurrent().getHostName());
+            sb.append(':');
+            sb.append(TestConfiguration.getCurrent().getPort());
+            sb.append('/');
+            sb.append("memory:");
+        }
+        sb.append("MogTestDb");
+        return sb;
+    }
+}
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/memorydb/_Suite.java b/java/testing/org/apache/derbyTesting/functionTests/tests/memorydb/_Suite.java
index 7a87ad927..e52a67318 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/memorydb/_Suite.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/memorydb/_Suite.java
@@ -46,6 +46,7 @@ public class _Suite extends BaseTestCase  {
         // Tests are not yet compatible with JSR169 / JavaME
         if (!JDBC.vmSupportsJSR169()) {
             suite.addTest(BasicInMemoryDbTest.suite());
+            suite.addTest(Derby6662Test.suite());
             suite.addTest(MogTest.suite());
         }
         return suite;
