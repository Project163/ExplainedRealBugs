diff --git a/bin/derby_common.bat b/bin/derby_common.bat
index 4137c96a9..d53123340 100755
--- a/bin/derby_common.bat
+++ b/bin/derby_common.bat
@@ -56,7 +56,7 @@ echo Please set the DERBY_HOME environment variable to the path where you instal
 goto endcommon
 
 :setLocalClassPath
-set LOCALCLASSPATH=%DERBY_HOME%/lib/derby.jar;%DERBY_HOME%/lib/derbynet.jar;%DERBY_HOME%/lib/derbyclient.jar;%DERBY_HOME%/lib/derbytools.jar;%DERBY_HOME%/lib/derbyoptionaltools.jar
+set LOCALCLASSPATH=%DERBY_HOME%/lib/derbyshared.jar;%DERBY_HOME%/lib/derby.jar;%DERBY_HOME%/lib/derbynet.jar;%DERBY_HOME%/lib/derbyclient.jar;%DERBY_HOME%/lib/derbytools.jar;%DERBY_HOME%/lib/derbyoptionaltools.jar
 
 :checkJava
 set _JAVACMD=%JAVACMD%
diff --git a/bin/setEmbeddedCP b/bin/setEmbeddedCP
index 27471e432..f07e35d3a 100755
--- a/bin/setEmbeddedCP
+++ b/bin/setEmbeddedCP
@@ -23,4 +23,6 @@ if [ -z "$DERBY_HOME" ] ; then
   return 1
 fi
 
-export CLASSPATH="${DERBY_HOME}/lib/derby.jar:${DERBY_HOME}/lib/derbytools.jar:${DERBY_HOME}/lib/derbyoptionaltools.jar:${CLASSPATH}"
+export CLASSPATH="${DERBY_HOME}/lib/derbyshared.jar:${DERBY_HOME}/lib/derby.jar:${DERBY_HOME}/lib/derbytools.jar:${DERBY_HOME}/lib/derbyoptionaltools.jar:${CLASSPATH}"
+
+export MODULEPATH="${DERBY_HOME}/lib/derbyshared.jar:${DERBY_HOME}/lib/derby.jar:${DERBY_HOME}/lib/derbytools.jar:${DERBY_HOME}/lib/derbyoptionaltools.jar"
diff --git a/bin/setEmbeddedCP.bat b/bin/setEmbeddedCP.bat
index 3d77bc308..64ffeb25f 100755
--- a/bin/setEmbeddedCP.bat
+++ b/bin/setEmbeddedCP.bat
@@ -22,7 +22,10 @@
 
 @FOR %%X in ("%DERBY_HOME%") DO SET DERBY_HOME=%%~sX
 
-set CLASSPATH=%DERBY_HOME%\lib\derby.jar;%DERBY_HOME%\lib\derbytools.jar;%DERBY_HOME%/lib/derbyoptionaltools.jar;%CLASSPATH%
+set CLASSPATH=%DERBY_HOME%\lib\derbyshared.jar;%DERBY_HOME%\lib\derby.jar;%DERBY_HOME%\lib\derbytools.jar;%DERBY_HOME%/lib/derbyoptionaltools.jar;%CLASSPATH%
+
+set MODULEPATH=%DERBY_HOME%\lib\derbyshared.jar;%DERBY_HOME%\lib\derby.jar;%DERBY_HOME%\lib\derbytools.jar;%DERBY_HOME%/lib/derbyoptionaltools.jar
+
 @goto end
 
 :noderbyhome
diff --git a/bin/setNetworkClientCP b/bin/setNetworkClientCP
index c1331265a..6f41dd15f 100755
--- a/bin/setNetworkClientCP
+++ b/bin/setNetworkClientCP
@@ -23,4 +23,6 @@ if [ -z "$DERBY_HOME" ] ; then
   return 1
 fi
 
-export CLASSPATH="${DERBY_HOME}/lib/derbyclient.jar:${DERBY_HOME}/lib/derbytools.jar:${DERBY_HOME}/lib/derbyoptionaltools.jar:${CLASSPATH}"
+export CLASSPATH="${DERBY_HOME}/lib/derbyshared.jar:${DERBY_HOME}/lib/derbyclient.jar:${DERBY_HOME}/lib/derbytools.jar"
+
+export MODULEPATH="${DERBY_HOME}/lib/derbyshared.jar:${DERBY_HOME}/lib/derbyclient.jar:${DERBY_HOME}/lib/derbytools.jar"
diff --git a/bin/setNetworkClientCP.bat b/bin/setNetworkClientCP.bat
index 85b7444b2..afa89912f 100755
--- a/bin/setNetworkClientCP.bat
+++ b/bin/setNetworkClientCP.bat
@@ -22,7 +22,10 @@
 
 @FOR %%X in ("%DERBY_HOME%") DO SET DERBY_HOME=%%~sX
 
-set CLASSPATH=%DERBY_HOME%\lib\derbyclient.jar;%DERBY_HOME%\lib\derbytools.jar;%DERBY_HOME%/lib/derbyoptionaltools.jar;%CLASSPATH%
+set CLASSPATH=%DERBY_HOME%\lib\derbyshared.jar;%DERBY_HOME%\lib\derbyclient.jar;%DERBY_HOME%\lib\derbytools.jar
+
+set MODULEPATH=%DERBY_HOME%\lib\derbyshared.jar;%DERBY_HOME%\lib\derbyclient.jar;%DERBY_HOME%\lib\derbytools.jar
+
 @goto end
 
 :noderbyhome
diff --git a/bin/setNetworkServerCP b/bin/setNetworkServerCP
index 878953f7b..af4f8dbe9 100755
--- a/bin/setNetworkServerCP
+++ b/bin/setNetworkServerCP
@@ -23,4 +23,6 @@ if [ -z "$DERBY_HOME" ]; then
   return 1
 fi
 
-export CLASSPATH="${DERBY_HOME}/lib/derbynet.jar:${DERBY_HOME}/lib/derbytools.jar:${DERBY_HOME}/lib/derbyoptionaltools.jar:${CLASSPATH}"
+export CLASSPATH="${DERBY_HOME}/lib/derbyshared.jar:${DERBY_HOME}/lib/derby.jar:${DERBY_HOME}/lib/derbynet.jar:${DERBY_HOME}/lib/derbytools.jar:${DERBY_HOME}/lib/derbyoptionaltools.jar:${CLASSPATH}"
+
+export MODULEPATH="${DERBY_HOME}/lib/derbyshared.jar:${DERBY_HOME}/lib/derby.jar:${DERBY_HOME}/lib/derbynet.jar:${DERBY_HOME}/lib/derbytools.jar:${DERBY_HOME}/lib/derbyoptionaltools.jar"
diff --git a/bin/setNetworkServerCP.bat b/bin/setNetworkServerCP.bat
index 07e4da674..6e9b3f620 100755
--- a/bin/setNetworkServerCP.bat
+++ b/bin/setNetworkServerCP.bat
@@ -22,7 +22,10 @@
 
 @FOR %%X in ("%DERBY_HOME%") DO SET DERBY_INSTALL=%%~sX
 
-set CLASSPATH=%DERBY_HOME%\lib\derbynet.jar;%DERBY_HOME%\lib\derbytools.jar;%DERBY_HOME%/lib/derbyoptionaltools.jar;%CLASSPATH%
+set CLASSPATH=%DERBY_HOME%\lib\derbyshared.jar;%DERBY_HOME%\lib\derbynet.jar;%DERBY_HOME%\lib\derby.jar;%DERBY_HOME%\lib\derbytools.jar;%DERBY_HOME%/lib/derbyoptionaltools.jar;%CLASSPATH%
+
+set MODULEPATH=%DERBY_HOME%\lib\derbyshared.jar;%DERBY_HOME%\lib\derbynet.jar;%DERBY_HOME%\lib\derby.jar;%DERBY_HOME%\lib\derbytools.jar;%DERBY_HOME%/lib/derbyoptionaltools.jar
+
 @goto end
 
 :noderbyhome
diff --git a/bin/templates/derby_common.sh b/bin/templates/derby_common.sh
index 5c119f481..e2e97ec23 100755
--- a/bin/templates/derby_common.sh
+++ b/bin/templates/derby_common.sh
@@ -89,7 +89,7 @@ if [ ! -x "$JAVACMD" ] ; then
 fi
 
 # set local classpath, don't overwrite the user's
-LOCALCLASSPATH=$DERBY_LIB/derby.jar:$DERBY_LIB/derbynet.jar:$DERBY_LIB/derbytools.jar:$DERBY_LIB/derbyoptionaltools.jar:$DERBY_LIB/derbyclient.jar
+LOCALCLASSPATH=$DERBY_LIB/derbyshared.jar:$DERBY_LIB/derby.jar:$DERBY_LIB/derbynet.jar:$DERBY_LIB/derbytools.jar:$DERBY_LIB/derbyoptionaltools.jar:$DERBY_LIB/derbyclient.jar
 
 
 # if CLASSPATH_OVERRIDE env var is set, LOCALCLASSPATH will be
diff --git a/java/org.apache.derby.tools/module-info.java b/java/org.apache.derby.tools/module-info.java
index 59166188e..9c08ad1c6 100644
--- a/java/org.apache.derby.tools/module-info.java
+++ b/java/org.apache.derby.tools/module-info.java
@@ -63,8 +63,6 @@ module org.apache.derby.tools
     requires java.sql;
     requires java.xml;
 
-    requires org.apache.derby.engine;
-    requires org.apache.derby.client;
     requires org.apache.derby.commons;
 
     //
@@ -73,6 +71,8 @@ module org.apache.derby.tools
     // REQUIRED AT COMPILE-TIME.
     // OPTIONAL AT RUN-TIME.
     //
+    requires static org.apache.derby.engine;
+    requires static org.apache.derby.client;
     requires static java.naming;
 
     //
