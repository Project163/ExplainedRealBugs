diff --git a/java/client/org/apache/derby/client/am/Blob.java b/java/client/org/apache/derby/client/am/Blob.java
index 09a392ae5..95bbac334 100644
--- a/java/client/org/apache/derby/client/am/Blob.java
+++ b/java/client/org/apache/derby/client/am/Blob.java
@@ -469,7 +469,7 @@ public class Blob extends Lob implements java.sql.Blob {
         if (len == 0) {
             return 0;
         }
-        if (len + offset > bytes.length) {
+        if (len > bytes.length - offset) {
             throw new SqlException(agent_.logWriter_,
                     new ClientMessageId(SQLState.BLOB_LENGTH_TOO_LONG),
                     new Integer(len));
diff --git a/java/engine/org/apache/derby/impl/jdbc/EmbedBlob.java b/java/engine/org/apache/derby/impl/jdbc/EmbedBlob.java
index ad0c7f5c7..d6f00c8f9 100644
--- a/java/engine/org/apache/derby/impl/jdbc/EmbedBlob.java
+++ b/java/engine/org/apache/derby/impl/jdbc/EmbedBlob.java
@@ -898,7 +898,7 @@ final class EmbedBlob extends ConnectionChild implements Blob, EngineLOB
         if (len == 0) {
             return 0;
         }
-        if (len + offset > bytes.length) {
+        if (len > bytes.length - offset) {
             throw Util.generateCsSQLException(SQLState.BLOB_LENGTH_TOO_LONG,
                     new Long(len));
         }
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/BlobSetBytesBoundaryTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/BlobSetBytesBoundaryTest.java
index a7039c212..284ae62e2 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/BlobSetBytesBoundaryTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/BlobSetBytesBoundaryTest.java
@@ -90,7 +90,16 @@ public class BlobSetBytesBoundaryTest extends BaseJDBCTestCase {
         } catch (SQLException sqle) {
             assertSQLState("XJ079", sqle);
         }
-        
+
+        // Also check that we fail with the expected error if the sum of
+        // offset and length is greater than Integer.MAX_VALUE.
+        try {
+            blob.setBytes(1, new byte[100], 10, Integer.MAX_VALUE);
+            fail("setBytes() should fail when offset+length > bytes.length");
+        } catch (SQLException sqle) {
+            assertSQLState("XJ079", sqle);
+        }
+
         stmt.close();
     }
     
