diff --git a/java/engine/org/apache/derby/iapi/sql/dictionary/DataDictionary.java b/java/engine/org/apache/derby/iapi/sql/dictionary/DataDictionary.java
index e58037d41..1099506e2 100644
--- a/java/engine/org/apache/derby/iapi/sql/dictionary/DataDictionary.java
+++ b/java/engine/org/apache/derby/iapi/sql/dictionary/DataDictionary.java
@@ -1871,6 +1871,16 @@ public interface DataDictionary
 		@return True if the database has been upgraded to the required level, false otherwise.
 	*/
 	public boolean checkVersion(int majorVersion, String feature) throws StandardException;
+
+    /**
+     * Check if the database is read only and requires some form of upgrade
+     * that makes the stored prepared statements invalid.
+     *
+     * @return {@code true} if the stored prepared statements are invalid
+     * because of an upgrade and the database is read only, {@code false}
+     * otherwise
+     */
+    public boolean isReadOnlyUpgrade();
 	
     /**
      * Add or remove a permission to the permission database.
diff --git a/java/engine/org/apache/derby/iapi/sql/dictionary/SPSDescriptor.java b/java/engine/org/apache/derby/iapi/sql/dictionary/SPSDescriptor.java
index 34d488a61..72eb18fe9 100644
--- a/java/engine/org/apache/derby/iapi/sql/dictionary/SPSDescriptor.java
+++ b/java/engine/org/apache/derby/iapi/sql/dictionary/SPSDescriptor.java
@@ -393,7 +393,7 @@ public class SPSDescriptor extends TupleDescriptor
 		setCompileTime();
 		setParams(preparedStatement.getParameterTypes());
 
-		if (!((org.apache.derby.impl.sql.catalog.DataDictionaryImpl) dd).readOnlyUpgrade) {
+		if (!dd.isReadOnlyUpgrade()) {
 
 			/*
 			** Indicate that we are going to write the data
@@ -689,7 +689,7 @@ public class SPSDescriptor extends TupleDescriptor
 			
 
 
-			if (!((org.apache.derby.impl.sql.catalog.DataDictionaryImpl) (lcc.getDataDictionary())).readOnlyUpgrade) {
+			if (!lcc.getDataDictionary().isReadOnlyUpgrade()) {
 
 				//bug 4821 - First try compiling on a nested transaction so we can release
 				//the locks after the compilation. But if we get lock time out on the
@@ -1100,7 +1100,7 @@ public class SPSDescriptor extends TupleDescriptor
 
 		DataDictionary dd = getDataDictionary();
 
-		if (((org.apache.derby.impl.sql.catalog.DataDictionaryImpl) dd).readOnlyUpgrade)
+		if (dd.isReadOnlyUpgrade())
 			return;
 
 
diff --git a/java/engine/org/apache/derby/impl/sql/catalog/DD_Version.java b/java/engine/org/apache/derby/impl/sql/catalog/DD_Version.java
index e7bea5389..903ef958d 100644
--- a/java/engine/org/apache/derby/impl/sql/catalog/DD_Version.java
+++ b/java/engine/org/apache/derby/impl/sql/catalog/DD_Version.java
@@ -555,7 +555,7 @@ public	class DD_Version implements	Formatable
 			// invalidate all the procedures we need to indicate that
 			// any procedure we read off disk is automatically invalid,
 			// so we do not try to load the generated class.
-			bootingDictionary.readOnlyUpgrade = true;
+			bootingDictionary.setReadOnlyUpgrade();
 		}
 
 		bootingDictionary.clearCaches();
diff --git a/java/engine/org/apache/derby/impl/sql/catalog/DataDictionaryImpl.java b/java/engine/org/apache/derby/impl/sql/catalog/DataDictionaryImpl.java
index ccbac3c2a..d10d41034 100644
--- a/java/engine/org/apache/derby/impl/sql/catalog/DataDictionaryImpl.java
+++ b/java/engine/org/apache/derby/impl/sql/catalog/DataDictionaryImpl.java
@@ -428,7 +428,8 @@ public final class	DataDictionaryImpl
 		that created it.
 
 	*/
-	public boolean readOnlyUpgrade;
+	private boolean readOnlyUpgrade;
+
     /**
      * Tells if the automatic index statistics refresher has been disabled.
      * <p>
@@ -10486,7 +10487,19 @@ public final class	DataDictionaryImpl
 
 		return dictionaryVersion.checkVersion(requiredMajorVersion, feature);
 	}
-		
+
+    public boolean isReadOnlyUpgrade() {
+        return readOnlyUpgrade;
+    }
+
+    /**
+     * Mark this database as a read only database whose stored prepared
+     * statements are invalid because some kind of upgrade is needed.
+     */
+    void setReadOnlyUpgrade() {
+        readOnlyUpgrade = true;
+    }
+
 	/**
 	** Create system built-in metadata stored prepared statements.
 	*/
diff --git a/java/engine/org/apache/derby/impl/sql/catalog/SYSSTATEMENTSRowFactory.java b/java/engine/org/apache/derby/impl/sql/catalog/SYSSTATEMENTSRowFactory.java
index 9b758b7db..a362a820a 100644
--- a/java/engine/org/apache/derby/impl/sql/catalog/SYSSTATEMENTSRowFactory.java
+++ b/java/engine/org/apache/derby/impl/sql/catalog/SYSSTATEMENTSRowFactory.java
@@ -307,7 +307,7 @@ public class SYSSTATEMENTSRowFactory extends CatalogRowFactory
 
 		// In soft upgrade mode the plan may not be understand by this engine
 		// so force a recompile.
-		if (((DataDictionaryImpl) dd).readOnlyUpgrade) {
+		if (dd.isReadOnlyUpgrade()) {
 			valid = false;
 		} else {
 			// 5th column is VALID (boolean)
diff --git a/java/storeless/org/apache/derby/impl/storeless/EmptyDictionary.java b/java/storeless/org/apache/derby/impl/storeless/EmptyDictionary.java
index d73116b87..9845de88a 100644
--- a/java/storeless/org/apache/derby/impl/storeless/EmptyDictionary.java
+++ b/java/storeless/org/apache/derby/impl/storeless/EmptyDictionary.java
@@ -775,6 +775,10 @@ public class EmptyDictionary implements DataDictionary, ModuleSupportable {
 		return false;
 	}
 
+    public boolean isReadOnlyUpgrade() {
+        return false;
+    }
+
 	public boolean addRemovePermissionsDescriptor(boolean add,
 			PermissionsDescriptor perm, String grantee, TransactionController tc)
 			throws StandardException {
