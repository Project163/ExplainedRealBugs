diff --git a/java/engine/org/apache/derby/impl/load/Import.java b/java/engine/org/apache/derby/impl/load/Import.java
index 079ba63ae..74b0854d2 100644
--- a/java/engine/org/apache/derby/impl/load/Import.java
+++ b/java/engine/org/apache/derby/impl/load/Import.java
@@ -31,6 +31,10 @@ import java.sql.ResultSetMetaData;
 import java.sql.DatabaseMetaData;
 import java.util.*;
 
+import org.apache.derby.iapi.reference.SQLState;
+import org.apache.derby.iapi.error.StandardException;
+import org.apache.derby.iapi.error.PublicAPI;
+
 /**
  * This class implements import of data from a URL into a table.
  * Import functions provided here in this class shouble be called through
@@ -40,7 +44,10 @@ import java.util.*;
 
 public class Import extends ImportAbstract{
 
-	private String inputFileName;
+    private static  int                _importCounter;
+    private static  Hashtable   _importers = new Hashtable();
+
+    private String inputFileName;
 
 	/**
 	 * Constructior to Invoke Import from a select statement 
@@ -50,7 +57,8 @@ public class Import extends ImportAbstract{
 	public Import(String inputFileName, String columnDelimiter,
                   String characterDelimiter,  String codeset, 
                   int noOfColumnsExpected,  String columnTypes, 
-                  boolean lobsInExtFile) throws SQLException 
+                  boolean lobsInExtFile,
+                  int importCounter ) throws SQLException 
 	{
 
 		try{
@@ -62,6 +70,8 @@ public class Import extends ImportAbstract{
 												   columnDelimiter, codeset);
             this.lobsInExtFile = lobsInExtFile;
 
+            _importers.put( new Integer( importCounter ), this );
+            
 			doImport();
 
 		}catch(Exception e)
@@ -159,111 +169,130 @@ public class Import extends ImportAbstract{
 	 * INTEGER)  from new org.apache.derby.impl.load.Import('extin/Tutor1.asc') as importvti;
 	 *
 	 */
-	private static void performImport(Connection connection, 
-                                      String schemaName, 
-                                      String insertColumnList, 
-                                      String columnIndexes,
-                                      String tableName, 
-                                      String inputFileName,  
-                                      String  columnDelimiter, 
-                                      String characterDelimiter, 
-                                      String codeset, 
-                                      short replace, 
-                                      boolean lobsInExtFile)
+    private static void performImport
+        (Connection connection, 
+         String schemaName, 
+         String insertColumnList, 
+         String columnIndexes,
+         String tableName, 
+         String inputFileName,  
+         String  columnDelimiter, 
+         String characterDelimiter, 
+         String codeset, 
+         short replace, 
+         boolean lobsInExtFile)
         throws SQLException 
-	{
-
-		if (connection == null)
-			throw LoadError.connectionNull();
-		
-	
-		
-		if (tableName == null)
-			throw LoadError.entityNameMissing();
-		
-
-		ColumnInfo columnInfo = new ColumnInfo(connection , schemaName ,
-											   tableName, insertColumnList, 
-											   columnIndexes, COLUMNNAMEPREFIX);
-
-		/* special handling of single quote delimiters
-		 * Single quote should be writeen with an extra quote otherwise sql will
-		 * throw syntac error.
-		 * i.e  to recognize a quote  it has to be appended with extra  quote ('')
-		 */
-		if(characterDelimiter!=null && characterDelimiter.equals("'"))
-			characterDelimiter = "''";
-		if(columnDelimiter !=null && columnDelimiter.equals("'"))
-			columnDelimiter = "''";
-		
-
-		StringBuffer sb = new StringBuffer("new ");
-		sb.append("org.apache.derby.impl.load.Import");
-		sb.append("(") ; 
-		sb.append(	(inputFileName !=null ? "'" + inputFileName + "'" : null));
-		sb.append(",") ;
-		sb.append(	(columnDelimiter !=null ? "'" + columnDelimiter + "'" : null));
-		sb.append(",") ;
-		sb.append(	(characterDelimiter !=null ? "'" + characterDelimiter + "'" : null));
-		sb.append(",") ;
-		sb.append(	(codeset !=null ? "'" + codeset + "'" : null));
-		sb.append(", ");
-        sb.append( columnInfo.getExpectedNumberOfColumnsInFile());
-        sb.append(", ");
-        sb.append( "'" + columnInfo.getExpectedVtiColumnTypesAsString() + "'");
-        sb.append(", ");
-        sb.append(lobsInExtFile);
-		sb.append(" )") ;
-
-		String importvti = sb.toString();
-
-		// delimit the table and schema names with quotes.
-		// because they might have been  created as quoted
-		// identifiers(for example when reserved words are used, names are quoted)
-		
-		// Import procedures are to be called with case-senisitive names. 
-		// Incase of delimited table names, they need to be passed as defined
-		// and when they are not delimited, they need to be passed in upper
-		// case, because all undelimited names are stored in the upper case 
-		// in the database. 
-
-		String entityName = (schemaName == null ? "\""+ tableName + "\"" : 
-							 "\"" + schemaName + "\"" + "." + "\"" + tableName + "\""); 
-
-		String insertModeValue;
-		if(replace > 0)
-			insertModeValue = "replace";
-		else
-			insertModeValue = "bulkInsert";
-
-		String cNamesWithCasts = columnInfo.getColumnNamesWithCasts();
-		String insertColumnNames = columnInfo.getInsertColumnNames();
-		if(insertColumnNames !=null)
-			insertColumnNames = "(" + insertColumnNames + ") " ;
-		else
-			insertColumnNames = "";
-		String insertSql = "INSERT INTO " + entityName +  insertColumnNames + 
-			" --DERBY-PROPERTIES insertMode=" + insertModeValue + "\n" +
-			" SELECT " + cNamesWithCasts + " from " + 
-			importvti + " AS importvti" ;
-
-		//prepare the import statement to hit any errors before locking the table
-		PreparedStatement ips = connection.prepareStatement(insertSql);
-		
-		//lock the table before perfoming import, because there may 
-		//huge number of lockes aquired that might have affect on performance 
-		//and some possible dead lock scenarios.
-		Statement statement = connection.createStatement();
-		String lockSql = "LOCK TABLE " + entityName + " IN EXCLUSIVE MODE";
-		statement.executeUpdate(lockSql);
-
-		//execute the import operaton.
-		ips.executeUpdate();
-		statement.close();
-		ips.close();
-
-	}
-
+    {
+        Integer     importCounter = new Integer( bumpImportCounter() );
+        
+        try {
+            if (connection == null)
+                throw LoadError.connectionNull();
+            
+            
+            
+            if (tableName == null)
+                throw LoadError.entityNameMissing();
+            
+            
+            ColumnInfo columnInfo = new ColumnInfo(connection , schemaName ,
+                                                   tableName, insertColumnList, 
+                                                   columnIndexes, COLUMNNAMEPREFIX);
+            
+            /* special handling of single quote delimiters
+             * Single quote should be writeen with an extra quote otherwise sql will
+             * throw syntac error.
+             * i.e  to recognize a quote  it has to be appended with extra  quote ('')
+             */
+            if(characterDelimiter!=null && characterDelimiter.equals("'"))
+                characterDelimiter = "''";
+            if(columnDelimiter !=null && columnDelimiter.equals("'"))
+                columnDelimiter = "''";
+            
+            
+            StringBuffer sb = new StringBuffer("new ");
+            sb.append("org.apache.derby.impl.load.Import");
+            sb.append("(") ; 
+            sb.append(	(inputFileName !=null ? "'" + inputFileName + "'" : null));
+            sb.append(",") ;
+            sb.append(	(columnDelimiter !=null ? "'" + columnDelimiter + "'" : null));
+            sb.append(",") ;
+            sb.append(	(characterDelimiter !=null ? "'" + characterDelimiter + "'" : null));
+            sb.append(",") ;
+            sb.append(	(codeset !=null ? "'" + codeset + "'" : null));
+            sb.append(", ");
+            sb.append( columnInfo.getExpectedNumberOfColumnsInFile());
+            sb.append(", ");
+            sb.append( "'" + columnInfo.getExpectedVtiColumnTypesAsString() + "'");
+            sb.append(", ");
+            sb.append(lobsInExtFile);
+            sb.append(", ");
+            sb.append( importCounter.intValue() );
+            sb.append(" )") ;
+            
+            String importvti = sb.toString();
+            
+            // delimit the table and schema names with quotes.
+            // because they might have been  created as quoted
+            // identifiers(for example when reserved words are used, names are quoted)
+            
+            // Import procedures are to be called with case-senisitive names. 
+            // Incase of delimited table names, they need to be passed as defined
+            // and when they are not delimited, they need to be passed in upper
+            // case, because all undelimited names are stored in the upper case 
+            // in the database. 
+            
+            String entityName = (schemaName == null ? "\""+ tableName + "\"" : 
+                                 "\"" + schemaName + "\"" + "." + "\"" + tableName + "\""); 
+            
+            String insertModeValue;
+            if(replace > 0)
+                insertModeValue = "replace";
+            else
+                insertModeValue = "bulkInsert";
+            
+            String cNamesWithCasts = columnInfo.getColumnNamesWithCasts();
+            String insertColumnNames = columnInfo.getInsertColumnNames();
+            if(insertColumnNames !=null)
+                insertColumnNames = "(" + insertColumnNames + ") " ;
+            else
+                insertColumnNames = "";
+            String insertSql = "INSERT INTO " + entityName +  insertColumnNames + 
+                " --DERBY-PROPERTIES insertMode=" + insertModeValue + "\n" +
+                " SELECT " + cNamesWithCasts + " from " + 
+                importvti + " AS importvti" ;
+            
+            //prepare the import statement to hit any errors before locking the table
+            PreparedStatement ips = connection.prepareStatement(insertSql);
+            
+            //lock the table before perfoming import, because there may 
+            //huge number of lockes aquired that might have affect on performance 
+            //and some possible dead lock scenarios.
+            Statement statement = connection.createStatement();
+            String lockSql = "LOCK TABLE " + entityName + " IN EXCLUSIVE MODE";
+            statement.executeUpdate(lockSql);
+            
+            //execute the import operaton.
+            try {
+                ips.executeUpdate();
+            }
+            catch (Throwable t)
+            {
+                throw formatImportError( (Import) _importers.get( importCounter ), inputFileName, t );
+            }
+            statement.close();
+            ips.close();
+        }
+        finally
+        {
+            //
+            // The importer was put into a hashtable so that we could look up
+            // line numbers for error messages. The Import constructor put
+            // the importer in the hashtable. Now garbage collect that entry.
+            //
+            _importers.remove( importCounter );
+        }
+    }
 
 	/** virtual method from the abstract class
 	 * @exception	Exception on error
@@ -271,23 +300,31 @@ public class Import extends ImportAbstract{
 	ImportReadData getImportReadData() throws Exception {
 		return new ImportReadData(inputFileName, controlFileReader);
 	}
-}
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
 
+    /*
+     * Bump the import counter.
+     *
+     */
+    private static  synchronized    int bumpImportCounter()
+    {
+        return ++_importCounter;
+    }
+    
+    /*
+     * Format a import error with line number
+     *
+     */
+    private static  SQLException    formatImportError( Import importer, String inputFile, Throwable t )
+    {
+        int     lineNumber = -1;
+
+        if ( importer != null ) { lineNumber = importer.getCurrentLineNumber(); }
+        
+        StandardException se = StandardException.newException
+            ( SQLState.UNEXPECTED_IMPORT_ERROR, new Integer( lineNumber ), inputFile, t.getMessage() );
+        se.setNestedException( t );
+
+        return PublicAPI.wrapStandardException(se);
+    }
+    
+}
diff --git a/java/engine/org/apache/derby/impl/load/ImportAbstract.java b/java/engine/org/apache/derby/impl/load/ImportAbstract.java
index d318237fb..ebc51a369 100644
--- a/java/engine/org/apache/derby/impl/load/ImportAbstract.java
+++ b/java/engine/org/apache/derby/impl/load/ImportAbstract.java
@@ -45,6 +45,7 @@ abstract class ImportAbstract extends VTITemplate {
   int numberOfColumns;
   int[] columnWidths;
 
+  int lineNumber = 0;
   String[] nextRow;
 
   ResultSetMetaData importResultSetMetaData;
@@ -114,8 +115,12 @@ abstract class ImportAbstract extends VTITemplate {
     return (importReadData.getCurrentRowNumber());
   }
   
+    /** gets the current line number */
+    public    int getCurrentLineNumber() { return lineNumber; }
+    
   public boolean next() throws SQLException {
     try {
+      lineNumber++;
       return (importReadData.readNextRow(nextRow));
     } catch (Exception ex) {
 		throw LoadError.unexpectedError(ex);
diff --git a/java/engine/org/apache/derby/loc/messages.xml b/java/engine/org/apache/derby/loc/messages.xml
index e1976fee6..5071ab0e5 100644
--- a/java/engine/org/apache/derby/loc/messages.xml
+++ b/java/engine/org/apache/derby/loc/messages.xml
@@ -3888,6 +3888,14 @@ ln=lower-case two-letter ISO-639 language code, CO=upper-case two-letter ISO-316
                 <text>Lob data file name cannot be null. </text>
             </msg>
 
+            <msg>
+                <name>XIE0R.S</name>
+                <text>Import error on line {0} of file {1}: {2} </text>
+                <arg>lineNumber</arg>
+                <arg>fileName</arg>
+                <arg>details</arg>
+            </msg>
+
 
         </family>
 
diff --git a/java/shared/org/apache/derby/shared/common/reference/SQLState.java b/java/shared/org/apache/derby/shared/common/reference/SQLState.java
index 8cbb4cf51..99c9bc3d2 100644
--- a/java/shared/org/apache/derby/shared/common/reference/SQLState.java
+++ b/java/shared/org/apache/derby/shared/common/reference/SQLState.java
@@ -1712,6 +1712,7 @@ public interface SQLState {
 	String IMPORTFILE_HAS_INVALID_HEXSTRING                        ="XIE0N.S";
 	String LOB_DATA_FILE_NOT_FOUND                                 ="XIE0P.S";
 	String LOB_DATA_FILE_NULL                                      ="XIE0Q.S";
+	String UNEXPECTED_IMPORT_ERROR                       ="XIE0R.S";
 
 
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/ieptests.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/ieptests.out
index e05e1f43c..47126a224 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/ieptests.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/ieptests.out
@@ -661,7 +661,7 @@ ij> call SYSCS_UTIL.SYSCS_EXPORT_QUERY('select * from parent where a < 3' , 'ext
 Statement executed.
 ij> --replace should fail because of dependent table
 CALL SYSCS_UTIL.SYSCS_IMPORT_TABLE(NULL, 'PARENT', 'extinout/parent.del',null, null, null,1);
-ERROR 38000: The exception 'java.sql.SQLException: INSERT on table 'PARENT' caused a violation of foreign key constraint 'xxxxGENERATED-IDxxxx' for key (3).  The statement has been rolled back.' was thrown while evaluating an expression. SQLSTATE: 23503: INSERT on table 'PARENT' caused a violation of foreign key constraint 'xxxxGENERATED-IDxxxx' for key (3).  The statement has been rolled back.
+ERROR XIE0R: Import error on line 3 of file extinout/parent.del: INSERT on table 'PARENT' caused a violation of foreign key constraint 'xxxxGENERATED-IDxxxx' for key (3).  The statement has been rolled back.  SQLSTATE: 23503: INSERT on table 'PARENT' caused a violation of foreign key constraint 'xxxxGENERATED-IDxxxx' for key (3).  The statement has been rolled back.
 ij> select * from parent;
 A          
 -----
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/jdk16/ieptests.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/jdk16/ieptests.out
index a4d44f5ce..d4453109b 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/jdk16/ieptests.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNet/jdk16/ieptests.out
@@ -661,7 +661,7 @@ ij> call SYSCS_UTIL.SYSCS_EXPORT_QUERY('select * from parent where a < 3' , 'ext
 Statement executed.
 ij> --replace should fail because of dependent table
 CALL SYSCS_UTIL.SYSCS_IMPORT_TABLE(NULL, 'PARENT', 'extinout/parent.del',null, null, null,1);
-ERROR 38000: The exception 'java.sql.SQLException: INSERT on table 'PARENT' caused a violation of foreign key constraint 'xxxxGENERATED-IDxxxx' for key (3).  The statement has been rolled back.' was thrown while evaluating an expression.
+ERROR XIE0R: Import error on line 3 of file extinout/parent.del: INSERT on table 'PARENT' caused a violation of foreign key constraint 'xxxxGENERATED-IDxxxx' for key (3).  The statement has been rolled back. 
 ij> select * from parent;
 A          
 -----
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/ieptests.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/ieptests.out
index e05e1f43c..47126a224 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/ieptests.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/ieptests.out
@@ -661,7 +661,7 @@ ij> call SYSCS_UTIL.SYSCS_EXPORT_QUERY('select * from parent where a < 3' , 'ext
 Statement executed.
 ij> --replace should fail because of dependent table
 CALL SYSCS_UTIL.SYSCS_IMPORT_TABLE(NULL, 'PARENT', 'extinout/parent.del',null, null, null,1);
-ERROR 38000: The exception 'java.sql.SQLException: INSERT on table 'PARENT' caused a violation of foreign key constraint 'xxxxGENERATED-IDxxxx' for key (3).  The statement has been rolled back.' was thrown while evaluating an expression. SQLSTATE: 23503: INSERT on table 'PARENT' caused a violation of foreign key constraint 'xxxxGENERATED-IDxxxx' for key (3).  The statement has been rolled back.
+ERROR XIE0R: Import error on line 3 of file extinout/parent.del: INSERT on table 'PARENT' caused a violation of foreign key constraint 'xxxxGENERATED-IDxxxx' for key (3).  The statement has been rolled back.  SQLSTATE: 23503: INSERT on table 'PARENT' caused a violation of foreign key constraint 'xxxxGENERATED-IDxxxx' for key (3).  The statement has been rolled back.
 ij> select * from parent;
 A          
 -----
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/jdk16/ieptests.out b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/jdk16/ieptests.out
index a4d44f5ce..d4453109b 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/jdk16/ieptests.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/jdk16/ieptests.out
@@ -661,7 +661,7 @@ ij> call SYSCS_UTIL.SYSCS_EXPORT_QUERY('select * from parent where a < 3' , 'ext
 Statement executed.
 ij> --replace should fail because of dependent table
 CALL SYSCS_UTIL.SYSCS_IMPORT_TABLE(NULL, 'PARENT', 'extinout/parent.del',null, null, null,1);
-ERROR 38000: The exception 'java.sql.SQLException: INSERT on table 'PARENT' caused a violation of foreign key constraint 'xxxxGENERATED-IDxxxx' for key (3).  The statement has been rolled back.' was thrown while evaluating an expression.
+ERROR XIE0R: Import error on line 3 of file extinout/parent.del: INSERT on table 'PARENT' caused a violation of foreign key constraint 'xxxxGENERATED-IDxxxx' for key (3).  The statement has been rolled back. 
 ij> select * from parent;
 A          
 -----
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/ieptests.out b/java/testing/org/apache/derbyTesting/functionTests/master/ieptests.out
index 7d92776df..78dd69ff8 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/ieptests.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/ieptests.out
@@ -676,7 +676,7 @@ ij> call SYSCS_UTIL.SYSCS_EXPORT_QUERY('select * from parent where a < 3' , 'ext
 0 rows inserted/updated/deleted
 ij> --replace should fail because of dependent table
 CALL SYSCS_UTIL.SYSCS_IMPORT_TABLE(NULL, 'PARENT', 'extinout/parent.del',null, null, null,1);
-ERROR 38000: The exception 'java.sql.SQLException: INSERT on table 'PARENT' caused a violation of foreign key constraint 'xxxxGENERATED-IDxxxx' for key (3).  The statement has been rolled back.' was thrown while evaluating an expression.
+ERROR XIE0R: Import error on line 3 of file extinout/parent.del: INSERT on table 'PARENT' caused a violation of foreign key constraint 'xxxxGENERATED-IDxxxx' for key (3).  The statement has been rolled back. 
 ERROR 23503: INSERT on table 'PARENT' caused a violation of foreign key constraint 'xxxxGENERATED-IDxxxx' for key (3).  The statement has been rolled back.
 ij> select * from parent;
 A          
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/importExportThruIJ.out b/java/testing/org/apache/derbyTesting/functionTests/master/importExportThruIJ.out
index 4bbbec502..664c84795 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/importExportThruIJ.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/importExportThruIJ.out
@@ -38,7 +38,7 @@ ij> create index T1_IndexLname on T1 (Lname, Account);
 0 rows inserted/updated/deleted
 ij> call SYSCS_UTIL.SYSCS_IMPORT_TABLE (null, 'T1' , 'extin/EndOfFile.txt' , 
                                     null, null, null, 0) ;
-ERROR 38000: The exception 'java.sql.SQLException: Read endOfFile at unexpected place on line 2.' was thrown while evaluating an expression.
+ERROR XIE0R: Import error on line 2 of file extin/EndOfFile.txt: Read endOfFile at unexpected place on line 2. 
 ERROR XIE0E: Read endOfFile at unexpected place on line 2.
 ij> call SYSCS_UTIL.SYSCS_IMPORT_TABLE (null, 'T1' , 'extin/Tutor1.asc' , 
                                     null, null, null, 0) ;
@@ -382,7 +382,7 @@ ij> create table Alt1 (	Account	int,
 0 rows inserted/updated/deleted
 ij> call SYSCS_UTIL.SYSCS_IMPORT_TABLE (null, 'ALT1' , 'extin/Alt1.asc' , 
                                       null, null, null, 0) ;
-ERROR 38000: The exception 'java.sql.SQLException: Invalid character string format for type INTEGER.' was thrown while evaluating an expression.
+ERROR XIE0R: Import error on line 1 of file extin/Alt1.asc: Invalid character string format for type INTEGER. 
 ERROR 22018: Invalid character string format for type INTEGER.
 ij> select * from Alt1 where State = 'CA';
 ACCOUNT    |FNAME                         |LNAME                         |COMPANY                            |ADDRESS                                 |CITY                |STATE|ZIP       |PAYMENT   |BALANCE   
@@ -406,7 +406,7 @@ ij> create table Alt3 (	Account	int,
 0 rows inserted/updated/deleted
 ij> call SYSCS_UTIL.SYSCS_IMPORT_TABLE (null, 'ALT3' , 'extin/Alt3.asc' , 
                                       null, null, null, 0) ;
-ERROR 38000: The exception 'java.sql.SQLException: Invalid character string format for type INTEGER.' was thrown while evaluating an expression.
+ERROR XIE0R: Import error on line 1 of file extin/Alt3.asc: Invalid character string format for type INTEGER. 
 ERROR 22018: Invalid character string format for type INTEGER.
 ij> select * from Alt3 where State = 'CA' or State = 'TX';
 ACCOUNT    |FNAME                         |LNAME                         |COMPANY                            |ADDRESS                                 |CITY                |STATE|ZIP       |PAYMENT   |BALANCE   
@@ -801,6 +801,22 @@ in the bopshebop                                  |16
 NULL                                              |NULL       
 boopdeedoo                                        |10         
 ij> --
+-- Errors should contain identifying line numbers
+--
+create table derby_2193_lineNumber
+(
+    a  int,
+    b  int
+);
+0 rows inserted/updated/deleted
+ij> CALL SYSCS_UTIL.SYSCS_IMPORT_TABLE 
+( null, 'DERBY_2193_LINENUMBER', 'extin/derby-2193-linenumber.txt', null, null, null, 0 );
+ERROR XIE0R: Import error on line 2 of file extin/derby-2193-linenumber.txt: Invalid character string format for type INTEGER. 
+ERROR 22018: Invalid character string format for type INTEGER.
+ij> select * from derby_2193_lineNumber;
+A          |B          
+-----------------------
+ij> --
 -- end test case for derby-2193:
 --
 ;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/testData/ImportExport/derby-2193-linenumber.txt b/java/testing/org/apache/derbyTesting/functionTests/testData/ImportExport/derby-2193-linenumber.txt
new file mode 100644
index 000000000..e7cbc3ba6
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/testData/ImportExport/derby-2193-linenumber.txt
@@ -0,0 +1,3 @@
+1, 2
+3, foo
+5, 6
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/tools/importExportThruIJ.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/tools/importExportThruIJ.sql
index 263bdadb4..5eb1bb988 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/tools/importExportThruIJ.sql
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/tools/importExportThruIJ.sql
@@ -320,6 +320,19 @@ CALL SYSCS_UTIL.SYSCS_IMPORT_TABLE
 select * from derby_2193_tab;
 select b, length(b) from derby_2193_tab;
 
+--
+-- Errors should contain identifying line numbers
+--
+create table derby_2193_lineNumber
+(
+    a  int,
+    b  int
+);
+
+CALL SYSCS_UTIL.SYSCS_IMPORT_TABLE 
+( null, 'DERBY_2193_LINENUMBER', 'extin/derby-2193-linenumber.txt', null, null, null, 0 );
+select * from derby_2193_lineNumber;
+
 --
 -- end test case for derby-2193:
 --
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/tools/importExportThruIJ_app.properties b/java/testing/org/apache/derbyTesting/functionTests/tests/tools/importExportThruIJ_app.properties
index c19d08db5..a4d652a7f 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/tools/importExportThruIJ_app.properties
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/tools/importExportThruIJ_app.properties
@@ -1,4 +1,4 @@
-supportfiles=testData/ImportExport/sqlAnywhere1.utf,testData/ImportExport/sqlAnywhere2.utf,testData/ImportExport/Access1.txt,testData/ImportExport/Access2.txt,testData/ImportExport/Access3.txt,testData/ImportExport/Alt1.asc,testData/ImportExport/Alt2.asc,testData/ImportExport/Alt3.asc,testData/ImportExport/Alt4.asc,testData/ImportExport/Alt5.asc,testData/ImportExport/Alt6.asc,testData/ImportExport/Tutor1.asc,testData/ImportExport/Tutor2.asc,testData/ImportExport/Tutor3.asc,testData/ImportExport/EndOfFile.txt,testData/ImportExport/derby-2193.txt
+supportfiles=testData/ImportExport/sqlAnywhere1.utf,testData/ImportExport/sqlAnywhere2.utf,testData/ImportExport/Access1.txt,testData/ImportExport/Access2.txt,testData/ImportExport/Access3.txt,testData/ImportExport/Alt1.asc,testData/ImportExport/Alt2.asc,testData/ImportExport/Alt3.asc,testData/ImportExport/Alt4.asc,testData/ImportExport/Alt5.asc,testData/ImportExport/Alt6.asc,testData/ImportExport/Tutor1.asc,testData/ImportExport/Tutor2.asc,testData/ImportExport/Tutor3.asc,testData/ImportExport/EndOfFile.txt,testData/ImportExport/derby-2193.txt,testData/ImportExport/derby-2193-linenumber.txt
 # fails: supportfiles=testData/ImportExport/sqlAnywhere2.txt,testData/ImportExport/Access1.txt,testData/ImportExport/Access2.txt,testData/ImportExport/Access3.txt,testData/ImportExport/Alt1.asc,testData/ImportExport/Alt2.asc,testData/ImportExport/Alt3.asc,testData/ImportExport/Alt4.asc,testData/ImportExport/Alt5.asc,testData/ImportExport/Alt6.asc,testData/ImportExport/Tutor1.asc,testData/ImportExport/Tutor2.asc,testData/ImportExport/Tutor3.asc,testData/ImportExport/EndOfFile.txt
 #also fails: supportfiles=testData/ImportExport/sqlAnywhere1.txt,testData/ImportExport/Access1.txt,testData/ImportExport/Access2.txt,testData/ImportExport/Access3.txt,testData/ImportExport/Alt1.asc,testData/ImportExport/Alt2.asc,testData/ImportExport/Alt3.asc,testData/ImportExport/Alt4.asc,testData/ImportExport/Alt5.asc,testData/ImportExport/Alt6.asc,testData/ImportExport/Tutor1.asc,testData/ImportExport/Tutor2.asc,testData/ImportExport/Tutor3.asc,testData/ImportExport/EndOfFile.txt
 usedefaults=true
