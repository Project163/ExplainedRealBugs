diff --git a/java/engine/org/apache/derby/iapi/sql/conn/LanguageConnectionContext.java b/java/engine/org/apache/derby/iapi/sql/conn/LanguageConnectionContext.java
index 6038f694f..67627e7df 100644
--- a/java/engine/org/apache/derby/iapi/sql/conn/LanguageConnectionContext.java
+++ b/java/engine/org/apache/derby/iapi/sql/conn/LanguageConnectionContext.java
@@ -1053,4 +1053,9 @@ public interface LanguageConnectionContext extends Context {
 	 * @return True if SQL standard permissions are being used
 	 */
 	public boolean usesSqlAuthorization();
+
+	/**
+	 * Close any unused activations in this connection context.
+	 */
+	public void closeUnusedActivations() throws StandardException;
 }
diff --git a/java/engine/org/apache/derby/impl/sql/GenericPreparedStatement.java b/java/engine/org/apache/derby/impl/sql/GenericPreparedStatement.java
index 00a3efd34..72e069ae3 100644
--- a/java/engine/org/apache/derby/impl/sql/GenericPreparedStatement.java
+++ b/java/engine/org/apache/derby/impl/sql/GenericPreparedStatement.java
@@ -218,18 +218,27 @@ public class GenericPreparedStatement
 	 *
 	 * @exception StandardException thrown if finished.
 	 */
-	public synchronized Activation	getActivation(LanguageConnectionContext lcc, boolean scrollable) throws StandardException 
+	public Activation getActivation(LanguageConnectionContext lcc,
+									boolean scrollable)
+		throws StandardException
 	{
-		GeneratedClass gc = getActivationClass();
+		Activation ac;
+		synchronized (this) {
+			GeneratedClass gc = getActivationClass();
 
-		if (gc == null) {
-			rePrepare(lcc);
-			gc = getActivationClass();
-		}
+			if (gc == null) {
+				rePrepare(lcc);
+				gc = getActivationClass();
+			}
 
-		Activation ac = new GenericActivationHolder(lcc, gc, this, scrollable);
+			ac = new GenericActivationHolder(lcc, gc, this, scrollable);
 
-		inUseCount++;
+			inUseCount++;
+		}
+		// DERBY-2689. Close unused activations-- this method should be called
+		// when I'm not holding a lock on a prepared statement to avoid
+		// deadlock.
+		lcc.closeUnusedActivations();
 
 		return ac;
 	}
diff --git a/java/engine/org/apache/derby/impl/sql/conn/GenericLanguageConnectionContext.java b/java/engine/org/apache/derby/impl/sql/conn/GenericLanguageConnectionContext.java
index f8256bd6e..c19534a40 100644
--- a/java/engine/org/apache/derby/impl/sql/conn/GenericLanguageConnectionContext.java
+++ b/java/engine/org/apache/derby/impl/sql/conn/GenericLanguageConnectionContext.java
@@ -414,7 +414,11 @@ public class GenericLanguageConnectionContext
 		if (acts.size() > maxActsSize) {
 			maxActsSize = acts.size();
 		}
+	}
 
+	public void closeUnusedActivations()
+			throws StandardException
+	{
 		// DERBY-418. Activations which are marked unused,
 		// are closed here. Activations Vector is iterated 
 		// to identify and close unused activations, only if 
@@ -422,6 +426,7 @@ public class GenericLanguageConnectionContext
 		// size exceeds 20.
 		if( (unusedActs) && (acts.size() > 20) ) {
 			unusedActs = false;
+
 			for (int i = acts.size() - 1; i >= 0; i--) {
 
 				// it maybe the case that a Activation's reset() ends up
