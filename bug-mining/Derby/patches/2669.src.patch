diff --git a/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java b/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java
index 4eba113a1..514e20410 100644
--- a/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java
+++ b/java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java
@@ -251,6 +251,13 @@ public class EmbedConnection implements EngineConnection
 			// see if database is already booted
 			Database database = (Database) Monitor.findService(Property.DATABASE_MODULE, tr.getDBName());
 
+            // encryption, re-encryption and decryption are not allowed on an already booted database.
+            // see DERBY-5969.
+            if ( (database != null) && isCryptoBoot( info ) )
+            {
+                addWarning( SQLWarningFactory.newSQLWarning( SQLState.AUTH_ENCRYPT_ALREADY_BOOTED ) );
+            }
+
 			// See if user wants to create a new database.
 			boolean	createBoot = createBoot(info);	
 
diff --git a/java/engine/org/apache/derby/loc/messages.xml b/java/engine/org/apache/derby/loc/messages.xml
index 90fb2013f..adf0c40b9 100644
--- a/java/engine/org/apache/derby/loc/messages.xml
+++ b/java/engine/org/apache/derby/loc/messages.xml
@@ -235,6 +235,11 @@ Guide.
                 <arg>databaseName</arg>
             </msg>
 
+            <msg>
+                <name>01J17</name>
+                <text>You cannot encrypt, re-encrypt, or decrypt a database which is already booted. You must shutdown the database before attempting these operations.</text>
+            </msg>
+
         </family>
 
         <family>
diff --git a/java/shared/org/apache/derby/shared/common/reference/SQLState.java b/java/shared/org/apache/derby/shared/common/reference/SQLState.java
index 2dff421f8..9ed3994aa 100644
--- a/java/shared/org/apache/derby/shared/common/reference/SQLState.java
+++ b/java/shared/org/apache/derby/shared/common/reference/SQLState.java
@@ -1730,6 +1730,7 @@ public interface SQLState {
 	String SQL_AUTHORIZATION_WITH_NO_AUTHENTICATION = "01J14";
 	String PASSWORD_EXPIRES_SOON = "01J15";
 	String DBO_PASSWORD_EXPIRES_SOON = "01J16";
+    String AUTH_ENCRYPT_ALREADY_BOOTED = "01J17";
 
     String CURSOR_OPERATION_CONFLICT = "01001";
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/URLCheck.out b/java/testing/org/apache/derbyTesting/functionTests/master/URLCheck.out
index 6252d2589..7a8665e5f 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/URLCheck.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/URLCheck.out
@@ -16,6 +16,7 @@ ij> --
 --
 -- Use a valid attribute, but do not display message.
 connect 'jdbc:derby:wombat;dataEncryption=true';
+WARNING 01J17: You cannot encrypt, re-encrypt, or decrypt a database which is already booted. You must shutdown the database before attempting these operations.
 ij(CONNECTION1)> -- Find an unknown attribute.
 connect 'jdbc:derby:wombat;unknown=x';
 URL Attribute [unknown=x]
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/store/DecryptDatabaseTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/store/DecryptDatabaseTest.java
index edc0ffac0..62a395f3d 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/store/DecryptDatabaseTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/store/DecryptDatabaseTest.java
@@ -51,6 +51,7 @@ public class DecryptDatabaseTest
 
     private static final String TABLE = "DECRYPTTABLE";
     private static final String BOOTPW = "Thursday";
+    private static final String ALREADY_BOOTED = "01J17";
     /** Current encryption algorithm, used when re-encrypting during set up. */
     private static String encryptionAlgorithm;
 
@@ -207,6 +208,15 @@ public class DecryptDatabaseTest
     public void testDecryptOnBootedDatabase()
             throws SQLException {
         getConnection();
+
+        // These connection attempts should succeed but raise a warning
+        // that encryption change is not possible while the database is booted.
+        println( "Test warning " + ALREADY_BOOTED );
+        vetChangeWarning( connect( false, BOOTPW, "dataEncryption=true" ) );
+        vetChangeWarning( connect( false, BOOTPW, "newBootPassword=foo" ) );
+        vetChangeWarning( connect( false, BOOTPW, "newEncryptionKey=foo" ) );
+        vetChangeWarning( connect( false, BOOTPW, "decryptDatabase=true" ) );
+        
         // Connect to decrypt the database. We expect this to fail since the
         // database is already booted. In this case fail means ignored...
         connect(true, BOOTPW, null).close();
@@ -218,6 +228,13 @@ public class DecryptDatabaseTest
             assertSQLState("XBM06", sqle);
         }
     }
+    private void    vetChangeWarning( Connection conn )
+        throws SQLException
+    {
+        assertWarning( conn, ALREADY_BOOTED );
+        conn.close();
+    }
+
 
     /**
      * Tests that asking to decrypt an un-encrypted doesn't fail.
diff --git a/java/testing/org/apache/derbyTesting/junit/BaseJDBCTestCase.java b/java/testing/org/apache/derbyTesting/junit/BaseJDBCTestCase.java
index 88aa477e2..7a15e5519 100644
--- a/java/testing/org/apache/derbyTesting/junit/BaseJDBCTestCase.java
+++ b/java/testing/org/apache/derbyTesting/junit/BaseJDBCTestCase.java
@@ -886,6 +886,27 @@ public abstract class BaseJDBCTestCase
         }
     }
 
+    /**
+     * Assert that a warning is chained to the connection.
+     *
+     * @param conn  the connection
+     * @param expected the expected SQLState of the warning
+     */
+    public static void assertWarning( Connection conn, String expected )
+        throws SQLException
+    {
+        SQLWarning  firstWarning = conn.getWarnings();
+        assertNotNull( firstWarning );
+
+        for ( SQLWarning warning = firstWarning; warning != null; warning = warning.getNextWarning() )
+        {
+            if ( expected.equals( warning.getSQLState() ) ) { return; }
+        }
+
+        fail( "Expected to see a SQLWarning with the SQLState " + expected );
+    }
+
+
     /**
      * Assert that SQLState is as expected.
      *
