diff --git a/java/engine/org/apache/derby/impl/sql/compile/OrderByColumn.java b/java/engine/org/apache/derby/impl/sql/compile/OrderByColumn.java
index b12be6ef4..a9b214ffd 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/OrderByColumn.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/OrderByColumn.java
@@ -461,11 +461,8 @@ public class OrderByColumn extends OrderedColumn {
 	private static boolean isReferedColByNum(ValueNode expression) 
 	throws StandardException{
 		
-		if(!expression.isConstantExpression()){
-			return false;
-		}
-		
-		return expression.getConstantValueAsObject() instanceof Integer;
+       return expression instanceof NumericConstantNode &&
+               expression.getConstantValueAsObject() instanceof Integer;
 	}
 
 	
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/orderby.out b/java/testing/org/apache/derbyTesting/functionTests/master/orderby.out
index 550ea8691..48cc293d2 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/orderby.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/orderby.out
@@ -2346,4 +2346,30 @@ ij> values (1,-1),(3,-3),(2,-2) order by 2;
 3          |-3         
 2          |-2         
 1          |-1         
+ij> -- DERBY-6027: ORDER BY a cast expression gives NPE 
+values 1 order by int(1);
+ERROR 4287B: In this context, the ORDER BY clause may only specify a column number.
+ij> -- expect error
+values 1 order by 1;
+1          
+-----------
+1          
+ij> -- ok, order by column #
+
+-- check that int(1) doesn't do sorting with SELECT, it's just a constant expression
+create table d6027(i int);
+0 rows inserted/updated/deleted
+ij> insert into d6027 values (2,1,3);
+ERROR 42802: The number of values assigned is not the same as the number of specified or implied columns.
+ij> select i from d6027 order by 1;
+I          
+-----------
+ij> -- OK, sort
+select i from d6027 order by int(1);
+I          
+-----------
+ij> -- OK, don't sort
+
+drop table d6027;
+0 rows inserted/updated/deleted
 ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/orderby.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/orderby.sql
index 623f399b1..a28ba2ce7 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/orderby.sql
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/orderby.sql
@@ -914,3 +914,14 @@ values 1,2 order by 1+0;
 values (1,-1),(3,-3),(2,-2) order by 1;
 values (1,-1),(3,-3),(2,-2) order by 2;
 
+-- DERBY-6027: ORDER BY a cast expression gives NPE 
+values 1 order by int(1); -- expect error
+values 1 order by 1;      -- ok, order by column #
+
+-- check that int(1) doesn't do sorting with SELECT, it's just a constant expression
+create table d6027(i int);
+insert into d6027 values (2,1,3);
+select i from d6027 order by 1;      -- OK, sort
+select i from d6027 order by int(1); -- OK, don't sort
+
+drop table d6027;
