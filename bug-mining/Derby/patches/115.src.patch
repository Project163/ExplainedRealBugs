diff --git a/java/client/org/apache/derby/client/am/BlobOutputStream.java b/java/client/org/apache/derby/client/am/BlobOutputStream.java
index 3cf2268f9..faa96fc88 100644
--- a/java/client/org/apache/derby/client/am/BlobOutputStream.java
+++ b/java/client/org/apache/derby/client/am/BlobOutputStream.java
@@ -55,8 +55,8 @@ public class BlobOutputStream extends java.io.OutputStream {
         byte[] newbuf = new byte[(int) offset_ - 1 + len + blob_.dataOffset_];
         System.arraycopy(blob_.binaryString_, 0, newbuf, 0, (int) offset_ - 1 + blob_.dataOffset_);
         blob_.binaryString_ = newbuf;
-        for (int i = 0; i < len; i++) {
-            blob_.binaryString_[(int) offset_ + i + blob_.dataOffset_ - 1] = b[off + i];
+        for (int i = 0; i < len; i++, offset_++) {
+            blob_.binaryString_[(int) offset_ + blob_.dataOffset_ - 1] = b[off + i];
         }
         blob_.binaryStream_ = new java.io.ByteArrayInputStream(blob_.binaryString_);
         blob_.sqlLength_ = blob_.binaryString_.length - blob_.dataOffset_;
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/blobSetBinaryStream.out b/java/testing/org/apache/derbyTesting/functionTests/master/blobSetBinaryStream.out
new file mode 100644
index 000000000..f766cddf8
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/blobSetBinaryStream.out
@@ -0,0 +1,10 @@
+Test blob setBinaryStream with multiple writes starting
+START: testBlob1
+testBlob1 finished
+FINISHED TEST blobSetBinaryStream :-)
+Test blob setBinaryStream with multiple writes finished
+Test blob setBinaryStram with mutiple writes starting
+START: testBlob1
+testBlob1 finished
+FINISHED TEST blobSetBinaryStream :-)
+Test blob setBinaryStram with mutiple writes finished
diff --git a/java/testing/org/apache/derbyTesting/functionTests/suites/DerbyNet.exclude b/java/testing/org/apache/derbyTesting/functionTests/suites/DerbyNet.exclude
index 7a5fd3341..396bd2861 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/suites/DerbyNet.exclude
+++ b/java/testing/org/apache/derbyTesting/functionTests/suites/DerbyNet.exclude
@@ -16,3 +16,4 @@ jdbcapi/testRelative.java
 jdbcapi/rsgetXXXcolumnNames.java
 jdbcapi/SetQueryTimeoutTest.java
 lang/updatableResultSet.java
+jdbcapi/blobSetBinaryStream.java
diff --git a/java/testing/org/apache/derbyTesting/functionTests/suites/derbynetclientmats.runall b/java/testing/org/apache/derbyTesting/functionTests/suites/derbynetclientmats.runall
index d6b86c2e3..2ac64b01d 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/suites/derbynetclientmats.runall
+++ b/java/testing/org/apache/derbyTesting/functionTests/suites/derbynetclientmats.runall
@@ -1,2 +1,4 @@
 jdbcapi/xaSimplePositive.sql
 jdbcapi/xaStateTran.sql
+jdbcapi/blobSetBinaryStream.java
+
diff --git a/java/testing/org/apache/derbyTesting/functionTests/suites/embedded.exclude b/java/testing/org/apache/derbyTesting/functionTests/suites/embedded.exclude
index 8d1c8b69c..e77945fa5 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/suites/embedded.exclude
+++ b/java/testing/org/apache/derbyTesting/functionTests/suites/embedded.exclude
@@ -1 +1 @@
- 
+jdbcapi/blobSetBinaryStream.java
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/blobSetBinaryStream.java b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/blobSetBinaryStream.java
new file mode 100644
index 000000000..9cd1e44b2
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/blobSetBinaryStream.java
@@ -0,0 +1,483 @@
+/*
+
+   Derby - Class org.apache.derbyTesting.functionTests.tests.jdbcapi.blobSetBinaryStream
+
+   Copyright 2003, 2005 The Apache Software Foundation or its licensors, as applicable.
+
+   Licensed under the Apache License, Version 2.0 (the "License");
+   you may not use this file except in compliance with the License.
+   You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+
+ */
+
+package org.apache.derbyTesting.functionTests.tests.jdbcapi;
+
+
+import java.io.File;
+import java.io.FileInputStream;
+import java.io.FileNotFoundException;
+import java.io.InputStream;
+import java.io.OutputStream;
+import java.sql.Blob;
+import java.sql.Connection;
+import java.sql.PreparedStatement;
+import java.sql.ResultSet;
+import java.sql.SQLException;
+import java.sql.Statement;
+
+import org.apache.derby.tools.ij;
+import org.apache.derbyTesting.functionTests.util.TestUtil;
+
+public class blobSetBinaryStream {
+    
+        static String fileName;
+        static long fileLength;
+
+        static boolean debug = true;
+        private static final String START = "\nSTART: ";
+
+        static
+        {
+            fileName = "extin/aclob.txt";
+        }
+        
+        public static void main(String[] args)
+        {
+            System.out.println("Test blob setBinaryStream with multiple writes starting");
+
+            try
+            {
+                // use the ij utility to read the property file and
+                // make the initial connection.
+                ij.getPropertyArg(args);
+                Connection conn = ij.startJBMS();
+                // turn off autocommit, otherwise blobs/clobs cannot hang around
+                // until end of transaction
+                conn.setAutoCommit(false);
+
+                testBlob1(conn);
+
+                // restart the connection
+                conn.commit();
+                conn.close();
+                System.out.println("FINISHED TEST blobSetBinaryStream :-)");
+
+            }
+            catch (Throwable e)
+            {
+                System.out.println("FAIL -- unexpected exception:" + e.toString());
+                if (debug) e.printStackTrace();
+            }
+            System.out.println("Test blob setBinaryStream with multiple writes finished\n");
+        }
+        
+        private static void testBlob1(Connection conn)
+        {
+            try {
+                System.out.println(START + "testBlob1");
+
+                Statement stmt1 = conn.createStatement();
+                stmt1.execute("create table testBlobX1 (a blob(300K), b integer)");
+                stmt1.close();
+
+                byte[] b2 = new byte[1];
+                b2[0] = (byte)64;
+                PreparedStatement stmt2 = conn.prepareStatement(
+                        "insert into testBlobX1(a,b) values(?,?)");
+                stmt2.setBytes(1,  b2);
+                stmt2.setInt(2, 1);
+                stmt2.execute();
+                stmt2.close();
+                
+                PreparedStatement stmt3 = conn.prepareStatement(
+                    "SELECT a FROM testBlobX1 WHERE b = 1");
+                
+                ResultSet rs3 = stmt3.executeQuery();
+                
+                rs3.next();
+
+                Blob blob = rs3.getBlob(1);
+
+                File file = new File(fileName);
+                fileLength = file.length();
+                InputStream fileIn = new FileInputStream(file);
+
+                if (blob != null) {
+                    int count = 0;
+                    byte[] buffer = new byte[1024];
+                    OutputStream outstream = blob.setBinaryStream(1L);
+                    while ((count = fileIn.read(buffer)) != -1) {
+                        outstream.write(buffer, 0, count);
+                    }
+                    outstream.close();
+                    fileIn.close();
+                    PreparedStatement stmt4 = conn.prepareStatement(
+                        "UPDATE testBlobX1 SET a = ? WHERE b = 1");
+                    stmt4.setBlob(1,  blob);
+                    stmt4.executeUpdate();
+                    
+                    stmt4.close();
+                } else {
+                    System.out.println("FAIL -- blob is NULL");
+                }
+
+                rs3.close();
+                rs3 = stmt3.executeQuery();
+                
+                if (rs3.next()) {
+                    long new_length = rs3.getBlob(1).length();
+                    if (new_length != fileLength) {
+                        System.out.println(
+                                "FAIL -- wrong blob length; original: " + 
+                                fileLength + " blob length: " + new_length);
+                    }
+                } else {
+                    System.out.println("FAIL -- blob not found");
+                }
+                rs3.close();
+                stmt3.close();
+
+                System.out.println("testBlob1 finished");
+            } catch (SQLException e) {
+                TestUtil.dumpSQLExceptions(e);
+            } catch (Throwable e) {
+                if (debug) e.printStackTrace();
+            }
+        }
+}
+/*
+
+   Derby - Class org.apache.derbyTesting.functionTests.tests.jdbcapi.blobSetBinaryStream
+
+   Copyright 2003, 2005 The Apache Software Foundation or its licensors, as applicable.
+
+   Licensed under the Apache License, Version 2.0 (the "License");
+   you may not use this file except in compliance with the License.
+   You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+
+ */
+
+package org.apache.derbyTesting.functionTests.tests.jdbcapi;
+
+
+import java.io.File;
+import java.io.FileInputStream;
+import java.io.FileNotFoundException;
+import java.io.InputStream;
+import java.io.OutputStream;
+import java.sql.Blob;
+import java.sql.Connection;
+import java.sql.PreparedStatement;
+import java.sql.ResultSet;
+import java.sql.SQLException;
+import java.sql.Statement;
+
+import org.apache.derby.tools.ij;
+import org.apache.derbyTesting.functionTests.util.TestUtil;
+
+public class blobSetBinaryStream {
+    
+        static String fileName;
+        static long fileLength;
+
+        static boolean debug = true;
+        private static final String START = "\nSTART: ";
+
+        static
+        {
+            fileName = "extin/aclob.txt";
+        }
+        
+        public static void main(String[] args)
+        {
+            System.out.println("Test blob setBinaryStream with multiple writes starting");
+
+            try
+            {
+                // use the ij utility to read the property file and
+                // make the initial connection.
+                ij.getPropertyArg(args);
+                Connection conn = ij.startJBMS();
+                // turn off autocommit, otherwise blobs/clobs cannot hang around
+                // until end of transaction
+                conn.setAutoCommit(false);
+
+                testBlob1(conn);
+
+                // restart the connection
+                conn.commit();
+                conn.close();
+                System.out.println("FINISHED TEST blobSetBinaryStream :-)");
+
+            }
+            catch (Throwable e)
+            {
+                System.out.println("FAIL -- unexpected exception:" + e.toString());
+                if (debug) e.printStackTrace();
+            }
+            System.out.println("Test blob setBinaryStream with multiple writes finished\n");
+        }
+        
+        private static void testBlob1(Connection conn)
+        {
+            try {
+                System.out.println(START + "testBlob1");
+
+                Statement stmt1 = conn.createStatement();
+                stmt1.execute("create table testBlobX1 (a blob(300K), b integer)");
+                stmt1.close();
+
+                byte[] b2 = new byte[1];
+                b2[0] = (byte)64;
+                PreparedStatement stmt2 = conn.prepareStatement(
+                        "insert into testBlobX1(a,b) values(?,?)");
+                stmt2.setBytes(1,  b2);
+                stmt2.setInt(2, 1);
+                stmt2.execute();
+                stmt2.close();
+                
+                PreparedStatement stmt3 = conn.prepareStatement(
+                    "SELECT a FROM testBlobX1 WHERE b = 1");
+                
+                ResultSet rs3 = stmt3.executeQuery();
+                
+                rs3.next();
+
+                Blob blob = rs3.getBlob(1);
+
+                File file = new File(fileName);
+                fileLength = file.length();
+                InputStream fileIn = new FileInputStream(file);
+
+                if (blob != null) {
+                    int count = 0;
+                    byte[] buffer = new byte[1024];
+                    OutputStream outstream = blob.setBinaryStream(1L);
+                    while ((count = fileIn.read(buffer)) != -1) {
+                        outstream.write(buffer, 0, count);
+                    }
+                    outstream.close();
+                    fileIn.close();
+                    PreparedStatement stmt4 = conn.prepareStatement(
+                        "UPDATE testBlobX1 SET a = ? WHERE b = 1");
+                    stmt4.setBlob(1,  blob);
+                    stmt4.executeUpdate();
+                    
+                    stmt4.close();
+                } else {
+                    System.out.println("FAIL -- blob is NULL");
+                }
+
+                rs3.close();
+                rs3 = stmt3.executeQuery();
+                
+                if (rs3.next()) {
+                    long new_length = rs3.getBlob(1).length();
+                    if (new_length != fileLength) {
+                        System.out.println(
+                                "FAIL -- wrong blob length; original: " + 
+                                fileLength + " blob length: " + new_length);
+                    }
+                } else {
+                    System.out.println("FAIL -- blob not found");
+                }
+                rs3.close();
+                stmt3.close();
+
+                System.out.println("testBlob1 finished");
+            } catch (SQLException e) {
+                TestUtil.dumpSQLExceptions(e);
+            } catch (Throwable e) {
+                if (debug) e.printStackTrace();
+            }
+        }
+}
+/*
+
+   Derby - Class org.apache.derbyTesting.functionTests.tests.jdbcapi.blobclob4BLOB
+
+   Copyright 2003, 2005 The Apache Software Foundation or its licensors, as applicable.
+
+   Licensed under the Apache License, Version 2.0 (the "License");
+   you may not use this file except in compliance with the License.
+   You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+
+ */
+
+package org.apache.derbyTesting.functionTests.tests.jdbcapi;
+
+
+import java.io.File;
+import java.io.FileInputStream;
+import java.io.FileNotFoundException;
+import java.io.FileOutputStream;
+import java.io.FileReader;
+import java.io.FileWriter;
+import java.io.IOException;
+import java.io.InputStream;
+import java.io.InputStreamReader;
+import java.io.OutputStream;
+import java.io.OutputStreamWriter;
+import java.io.Reader;
+import java.io.Writer;
+import java.sql.Blob;
+import java.sql.Clob;
+import java.sql.Connection;
+import java.sql.PreparedStatement;
+import java.sql.ResultSet;
+import java.sql.ResultSetMetaData;
+import java.sql.SQLException;
+import java.sql.Statement;
+import java.sql.Types;
+
+import org.apache.derby.tools.JDBCDisplayUtil;
+import org.apache.derby.tools.ij;
+import org.apache.derbyTesting.functionTests.util.Formatters;
+import org.apache.derbyTesting.functionTests.util.TestUtil;
+
+public class blobSetBinaryStream {
+    
+        static String fileName;
+        static long fileLength;
+
+        static boolean isDerbyNet = false;
+        static boolean debug = true;
+        private static final String START = "\nSTART: ";
+
+        static
+        {
+                fileName = "extin/aclob.txt";
+        }
+        
+        public static void main(String[] args)
+        {
+        System.out.println("Test blob setBinaryStram with mutiple writes starting");
+
+        isDerbyNet = TestUtil.isNetFramework();
+
+        try
+        {
+                // use the ij utility to read the property file and
+                // make the initial connection.
+                ij.getPropertyArg(args);
+                Connection conn = ij.startJBMS();
+                // turn off autocommit, otherwise blobs/clobs cannot hang around
+                // until end of transaction
+                conn.setAutoCommit(false);
+
+                testBlob1(conn);
+                
+                // restart the connection
+                conn = ij.startJBMS();
+                conn.setAutoCommit(false);
+                conn.commit();
+                conn.close();
+                System.out.println("FINISHED TEST blobSetBinaryStream :-)");
+
+        }
+        catch (Throwable e)
+        {
+                System.out.println("xFAIL -- unexpected exception:" + e.toString());
+                if (debug) e.printStackTrace();
+        }
+        System.out.println("Test blob setBinaryStram with mutiple writes finished\n");
+        }
+        
+        private static void testBlob1(Connection conn)
+        {
+            try {
+                System.out.println(START + "testBlob1");
+
+                Statement stmt1 = conn.createStatement();
+                stmt1.execute("create table testBlobX1 (a blob(300K), b integer)");
+                stmt1.close();
+
+                byte[] b2 = new byte[1];
+                b2[0] = (byte)64;
+                PreparedStatement stmt2 = conn.prepareStatement(
+                        "insert into testBlobX1(a,b) values(?,?)");
+                stmt2.setBytes(1,  b2);
+                stmt2.setInt(2, 1);
+                stmt2.execute();
+                stmt2.close();
+                
+                PreparedStatement stmt3 = conn.prepareStatement(
+                    "SELECT a FROM testBlobX1 WHERE b = 1");
+                
+                ResultSet rs3 = stmt3.executeQuery();
+                
+                rs3.next();
+
+                Blob blob = rs3.getBlob(1);
+
+                File file = new File(fileName);
+                fileLength = file.length();
+                InputStream fileIn = new FileInputStream(file);
+
+                if (blob != null) {
+                    int count = 0;
+                    byte[] buffer = new byte[1024];
+                    OutputStream outstream = blob.setBinaryStream(1L);
+                    while ((count = fileIn.read(buffer)) != -1) {
+                        outstream.write(buffer, 0, count);
+                    }
+                    outstream.close();
+                    fileIn.close();
+                    PreparedStatement stmt4 = conn.prepareStatement(
+                        "UPDATE testBlobX1 SET a = ? WHERE b = 1");
+                    stmt4.setBlob(1,  blob);
+                    stmt4.executeUpdate();
+                    
+                    stmt4.close();
+                } else {
+                    System.out.println("FAIL -- blob is NULL");
+                }
+
+                rs3.close();
+                rs3 = stmt3.executeQuery();
+                
+                if (rs3.next()) {
+                    long new_length = rs3.getBlob(1).length();
+                    if (new_length != fileLength) {
+                        System.out.println("FAIL -- wrong blob length; original: " + fileLength + " blob length: " + new_length);
+                    }
+                } else {
+                    System.out.println("FAIL -- blob not found");
+                }
+                rs3.close();
+                stmt3.close();
+
+                System.out.println("testBlob1 finished");
+            } catch (SQLException e) {
+                TestUtil.dumpSQLExceptions(e);
+            } catch (Throwable e) {
+                if (debug) e.printStackTrace();
+            }
+        }
+
+
+}
\ No newline at end of file
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/blobSetBinaryStream_app.properties b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/blobSetBinaryStream_app.properties
new file mode 100644
index 000000000..4dfaed634
--- /dev/null
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/blobSetBinaryStream_app.properties
@@ -0,0 +1,18 @@
+runwithjdk13=false
+runwithibm13=false
+runwithj9=false
+supportfiles=tests/jdbcapi/short.txt,tests/jdbcapi/littleclob.txt,tests/jdbcapi/empty.txt,tests/jdbcapi/aclob.txt,tests/jdbcapi/searchclob.txt
+usedefaults=true
+useextdirs=true
+runwithjdk13=false
+runwithibm13=false
+runwithj9=false
+supportfiles=tests/jdbcapi/short.txt,tests/jdbcapi/littleclob.txt,tests/jdbcapi/empty.txt,tests/jdbcapi/aclob.txt,tests/jdbcapi/searchclob.txt
+usedefaults=true
+useextdirs=true
+runwithjdk13=false
+runwithibm13=false
+runwithj9=false
+supportfiles=tests/jdbcapi/short.txt,tests/jdbcapi/littleclob.txt,tests/jdbcapi/empty.txt,tests/jdbcapi/aclob.txt,tests/jdbcapi/searchclob.txt
+usedefaults=true
+useextdirs=true
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/build.xml b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/build.xml
index 297224fc7..014915e5e 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/build.xml
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/build.xml
@@ -76,6 +76,7 @@
       <exclude name="${this.dir}/statementJdbc30.java"/>
       <exclude name="${this.dir}/savepointJdbc30.java"/>
       <exclude name="${this.dir}/xaJNDI.java"/>
+      <exclude name="${this.dir}/blobSetBinaryStream.java"/>
     </javac>
   </target>
 
@@ -103,6 +104,7 @@
       <include name="${this.dir}/parameterMetaDataJdbc30.java"/>
       <include name="${this.dir}/resultsetJdbc30.java"/>
       <include name="${this.dir}/statementJdbc30.java"/>
+      <include name="${this.dir}/blobSetBinaryStream.java"/>
     </javac>
   </target>
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/copyfiles.ant b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/copyfiles.ant
index fa49da5ac..d076c188c 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/copyfiles.ant
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/copyfiles.ant
@@ -72,3 +72,4 @@ xaSimplePositive_app.properties
 xaSimplePositive_sed.properties
 xaSimplePositive_derby.properties
 xaStateTran.sql
+blobSetBinaryStream_app.properties
