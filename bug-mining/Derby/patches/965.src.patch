diff --git a/bin/NetworkServerControl.bat b/bin/NetworkServerControl.bat
index 6d68e7eb7..60c96413d 100755
--- a/bin/NetworkServerControl.bat
+++ b/bin/NetworkServerControl.bat
@@ -19,6 +19,8 @@
 
 CALL "%~dp0derby_common.bat" %*
 
+if "%_JAVACMD%"=="" goto end
+
 if "%_USE_CLASSPATH%"=="no" goto runNoClasspath
 if not "%CLASSPATH%"=="" goto runWithClasspath
 
diff --git a/bin/dblook.bat b/bin/dblook.bat
index bc7c80c74..337479907 100755
--- a/bin/dblook.bat
+++ b/bin/dblook.bat
@@ -19,6 +19,8 @@
 
 CALL "%~dp0derby_common.bat" %*
 
+if "%_JAVACMD%"=="" goto end
+
 if "%_USE_CLASSPATH%"=="no" goto runNoClasspath
 if not "%CLASSPATH%"=="" goto runWithClasspath
 
diff --git a/bin/derby_common.bat b/bin/derby_common.bat
index 790fd7e13..37d7b7021 100755
--- a/bin/derby_common.bat
+++ b/bin/derby_common.bat
@@ -50,9 +50,10 @@ rem and for NT handling to skip to.
 rem check the value of DERBY_HOME
 if exist "%DERBY_HOME%\lib\derby.jar" goto setLocalClassPath
 
-:noAntHome
-echo DERBY_HOME is set incorrectly or derby.jar could not be located. Please set DERBY_HOME.
-goto end
+:noDerbyHome
+echo DERBY_HOME is set incorrectly or derby.jar could not be located. 
+echo Please set the DERBY_HOME environment variable to the path where you installed Derby.
+goto endcommon
 
 :setLocalClassPath
 set LOCALCLASSPATH=%DERBY_HOME%/lib/derby.jar;%DERBY_HOME%/lib/derbynet.jar;%DERBY_HOME%/lib/derbyclient.jar;%DERBY_HOME%/lib/derbytools.jar
diff --git a/bin/ij.bat b/bin/ij.bat
index 045b8dbdd..14f453a91 100755
--- a/bin/ij.bat
+++ b/bin/ij.bat
@@ -19,6 +19,8 @@
 
 CALL "%~dp0derby_common.bat" %*
 
+if "%_JAVACMD%"=="" goto end
+
 if "%_USE_CLASSPATH%"=="no" goto runNoClasspath
 if not "%CLASSPATH%"=="" goto runWithClasspath
 
diff --git a/bin/startNetworkServer.bat b/bin/startNetworkServer.bat
index a58bae0be..b302b59bd 100755
--- a/bin/startNetworkServer.bat
+++ b/bin/startNetworkServer.bat
@@ -19,6 +19,8 @@
 
 CALL "%~dp0derby_common.bat" %*
 
+if "%_JAVACMD%"=="" goto end
+
 if "%_USE_CLASSPATH%"=="no" goto runNoClasspath
 if not "%CLASSPATH%"=="" goto runWithClasspath
 
diff --git a/bin/stopNetworkServer.bat b/bin/stopNetworkServer.bat
index 5ea354aab..4bcea0190 100755
--- a/bin/stopNetworkServer.bat
+++ b/bin/stopNetworkServer.bat
@@ -19,6 +19,8 @@
 
 CALL "%~dp0derby_common.bat" %*
 
+if "%_JAVACMD%"=="" goto end
+
 if "%_USE_CLASSPATH%"=="no" goto runNoClasspath
 if not "%CLASSPATH%"=="" goto runWithClasspath
 
diff --git a/bin/sysinfo.bat b/bin/sysinfo.bat
index 54c8a7ee5..347d12474 100755
--- a/bin/sysinfo.bat
+++ b/bin/sysinfo.bat
@@ -19,6 +19,8 @@
 
 CALL "%~dp0derby_common.bat" %*
 
+if "%_JAVACMD%"=="" goto end
+
 if "%_USE_CLASSPATH%"=="no" goto runNoClasspath
 if not "%CLASSPATH%"=="" goto runWithClasspath
 
