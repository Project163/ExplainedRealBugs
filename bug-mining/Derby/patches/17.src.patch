diff --git a/java/engine/org/apache/derby/impl/sql/compile/AllResultColumn.java b/java/engine/org/apache/derby/impl/sql/compile/AllResultColumn.java
index c36c8cbc0..08674857b 100755
--- a/java/engine/org/apache/derby/impl/sql/compile/AllResultColumn.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/AllResultColumn.java
@@ -87,4 +87,9 @@ public class AllResultColumn extends ResultColumn
 									tableName,
 									getContextManager());
 	}
+
+
+    public TableName getTableNameObject() {
+        return tableName;
+    }
 }
diff --git a/java/engine/org/apache/derby/impl/sql/compile/FromBaseTable.java b/java/engine/org/apache/derby/impl/sql/compile/FromBaseTable.java
index d7e8fda61..405c2c6f2 100755
--- a/java/engine/org/apache/derby/impl/sql/compile/FromBaseTable.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/FromBaseTable.java
@@ -3412,7 +3412,7 @@ public class FromBaseTable extends FromTable
 	 *
 	 * @exception StandardException		Thrown on error
 	 */
-	public ResultColumnList getAllResultColumns(String allTableName)
+	public ResultColumnList getAllResultColumns(TableName allTableName)
 			throws StandardException
 	{
 		return getResultColumnsForList(allTableName, resultColumns, tableName);
diff --git a/java/engine/org/apache/derby/impl/sql/compile/FromList.java b/java/engine/org/apache/derby/impl/sql/compile/FromList.java
index 5e741af84..606105abc 100755
--- a/java/engine/org/apache/derby/impl/sql/compile/FromList.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/FromList.java
@@ -136,14 +136,24 @@ public class FromList extends QueryTreeNodeVector implements OptimizableList
 		 * user is executing a really dumb query and we won't throw
 		 * and exception - consider it an ANSI extension.
 		 */
+        TableName leftTable = null;
+        TableName rightTable = null;
 		if (! (fromTable instanceof TableOperatorNode))
 		{
 			/* Check for duplicate table name in FROM list */
 			int size = size();
 			for (int index = 0; index < size; index++)
 			{
-				if (fromTable.getExposedName().equals
-					(((FromTable) elementAt(index)).getExposedName()) )
+                leftTable = fromTable.getTableName();
+
+                if(((FromTable) elementAt(index)) instanceof TableOperatorNode) {
+                    continue;
+                }
+
+                else {                    
+                    rightTable = ((FromTable) elementAt(index)).getTableName();
+                }
+                if(leftTable.equals(rightTable))
 				{
 					throw StandardException.newException(SQLState.LANG_FROM_LIST_DUPLICATE_TABLE_NAME, fromTable.getExposedName());
 				}
@@ -380,7 +390,7 @@ public class FromList extends QueryTreeNodeVector implements OptimizableList
 	 *
 	 * @exception StandardException		Thrown on error
 	 */
-	public ResultColumnList expandAll(String allTableName)
+	public ResultColumnList expandAll(TableName allTableName)
 			throws StandardException
 	{
 		ResultColumnList resultColumnList = null;
diff --git a/java/engine/org/apache/derby/impl/sql/compile/FromSubquery.java b/java/engine/org/apache/derby/impl/sql/compile/FromSubquery.java
index 604cdb1f2..b637b291b 100755
--- a/java/engine/org/apache/derby/impl/sql/compile/FromSubquery.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/FromSubquery.java
@@ -626,17 +626,24 @@ public class FromSubquery extends FromTable
 	 * result columns from the subquery.
 	 * @exception StandardException		Thrown on error
 	 */
-	public ResultColumnList getAllResultColumns(String allTableName)
+	public ResultColumnList getAllResultColumns(TableName allTableName)
 			throws StandardException
 	{
 		ResultColumnList rcList = null;
 		TableName		 exposedName;
-
-
-		if (allTableName != null && ! allTableName.equals(getExposedName()))
-		{
-			return null;
-		}
+        TableName        toCompare;
+
+
+		if(allTableName != null)
+             toCompare = makeTableName(allTableName.getSchemaName(),correlationName);
+        else
+            toCompare = makeTableName(null,correlationName);
+        
+        if ( allTableName != null &&
+             ! allTableName.equals(toCompare))
+        {
+            return null;
+        }
 
 		/* Cache exposed name for this table.
 		 * The exposed name becomes the qualifier for each column
diff --git a/java/engine/org/apache/derby/impl/sql/compile/FromTable.java b/java/engine/org/apache/derby/impl/sql/compile/FromTable.java
index b9d902cf6..a4de81406 100755
--- a/java/engine/org/apache/derby/impl/sql/compile/FromTable.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/FromTable.java
@@ -32,12 +32,7 @@ import org.apache.derby.iapi.sql.compile.AccessPath;
 import org.apache.derby.iapi.sql.compile.RowOrdering;
 import org.apache.derby.iapi.sql.compile.C_NodeTypes;
 
-import org.apache.derby.iapi.sql.dictionary.DataDictionary;
-import org.apache.derby.iapi.sql.dictionary.DataDictionaryContext;
-import org.apache.derby.iapi.sql.dictionary.ColumnDescriptor;
-import org.apache.derby.iapi.sql.dictionary.ConglomerateDescriptor;
-import org.apache.derby.iapi.sql.dictionary.SchemaDescriptor;
-import org.apache.derby.iapi.sql.dictionary.TableDescriptor;
+import org.apache.derby.iapi.sql.dictionary.*;
 
 import org.apache.derby.iapi.types.DataTypeDescriptor;
 
@@ -52,6 +47,7 @@ import org.apache.derby.impl.sql.execute.HashScanResultSet;
 import org.apache.derby.iapi.util.JBitSet;
 import org.apache.derby.iapi.services.io.FormatableBitSet;
 import org.apache.derby.iapi.util.StringUtil;
+import org.apache.derby.catalog.UUID;
 
 import java.util.Enumeration;
 import java.util.Properties;
@@ -958,7 +954,7 @@ public abstract class FromTable extends ResultSetNode implements Optimizable
 	 *
 	 * @exception StandardException		Thrown on error
 	 */
-	public ResultColumnList getResultColumnsForList(String allTableName,
+	public ResultColumnList getResultColumnsForList(TableName allTableName,
 												ResultColumnList inputRcl,
 												TableName tableName)
 			throws StandardException
@@ -968,14 +964,26 @@ public abstract class FromTable extends ResultSetNode implements Optimizable
 		ValueNode		 valueNode;
 		String			 columnName;
 		TableName		 exposedName;
+        TableName        toCompare;
 
-		/* If allTableName is non-null, then we must check to see if it matches 
+		/* If allTableName is non-null, then we must check to see if it matches
 		 * our exposed name.
 		 */
-		if (allTableName != null && ! allTableName.equals(getExposedName()))
-		{
-			return null;
-		}
+
+        if(correlationName == null)
+           toCompare = tableName;
+        else {
+            if(allTableName != null)
+                toCompare = makeTableName(allTableName.getSchemaName(),correlationName);
+            else
+                toCompare = makeTableName(null,correlationName);
+        }
+
+        if ( allTableName != null &&
+             ! allTableName.equals(toCompare))
+        {
+            return null;
+        }
 
 		/* Cache exposed name for this table.
 		 * The exposed name becomes the qualifier for each column
diff --git a/java/engine/org/apache/derby/impl/sql/compile/FromVTI.java b/java/engine/org/apache/derby/impl/sql/compile/FromVTI.java
index ac11442d9..6e0a9b011 100755
--- a/java/engine/org/apache/derby/impl/sql/compile/FromVTI.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/FromVTI.java
@@ -901,18 +901,25 @@ public class FromVTI extends FromTable implements VTIEnvironment
 	 * result columns from the subquery.
 	 * @exception StandardException		Thrown on error
 	 */
-	public ResultColumnList getAllResultColumns(String allTableName)
+	public ResultColumnList getAllResultColumns(TableName allTableName)
 			throws StandardException
 	{
 		ResultColumnList rcList = null;
 		ResultColumn	 resultColumn;
 		ValueNode		 valueNode;
 		String			 columnName;
+        TableName        toCompare;
 
-		if (allTableName != null && ! allTableName.equals(getExposedName()))
-		{
-			return null;
-		}
+		if(allTableName != null)
+             toCompare = makeTableName(allTableName.getSchemaName(),correlationName);
+        else
+            toCompare = makeTableName(null,correlationName);
+
+        if ( allTableName != null &&
+             ! allTableName.equals(toCompare))
+        {
+            return null;
+        }
 
 		rcList = (ResultColumnList) getNodeFactory().getNode(
 										C_NodeTypes.RESULT_COLUMN_LIST,
diff --git a/java/engine/org/apache/derby/impl/sql/compile/JoinNode.java b/java/engine/org/apache/derby/impl/sql/compile/JoinNode.java
index 2bb5cf0b6..e95151a47 100755
--- a/java/engine/org/apache/derby/impl/sql/compile/JoinNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/JoinNode.java
@@ -359,7 +359,7 @@ public class JoinNode extends TableOperatorNode
 	 *
 	 * @exception StandardException		Thrown on error
 	 */
-	public ResultColumnList getAllResultColumns(String allTableName)
+	public ResultColumnList getAllResultColumns(TableName allTableName)
 			throws StandardException
 	{
 		/* We need special processing when there is a USING clause.
@@ -453,7 +453,7 @@ public class JoinNode extends TableOperatorNode
 	 *
 	 * @exception StandardException		Thrown on error
 	 */
-	private ResultColumnList getAllResultColumnsNoUsing(String allTableName)
+	private ResultColumnList getAllResultColumnsNoUsing(TableName allTableName)
 			throws StandardException
 	{
 		ResultColumnList leftRCL = leftResultSet.getAllResultColumns(allTableName); 
diff --git a/java/engine/org/apache/derby/impl/sql/compile/ResultColumn.java b/java/engine/org/apache/derby/impl/sql/compile/ResultColumn.java
index 57d926bf8..6648ab19d 100755
--- a/java/engine/org/apache/derby/impl/sql/compile/ResultColumn.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/ResultColumn.java
@@ -1730,4 +1730,8 @@ public class ResultColumn extends ValueNode
         }
         return dtd;
     } // end of getTypeServices
+
+    public TableName getTableNameObject() {
+        return null;
+    }
 }
diff --git a/java/engine/org/apache/derby/impl/sql/compile/ResultColumnList.java b/java/engine/org/apache/derby/impl/sql/compile/ResultColumnList.java
index fb9f60ec8..b558b7c9e 100755
--- a/java/engine/org/apache/derby/impl/sql/compile/ResultColumnList.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/ResultColumnList.java
@@ -1451,7 +1451,7 @@ public class ResultColumnList extends QueryTreeNodeVector
 	{
 		boolean			expanded = false;
 		ResultColumnList allExpansion;
-		String			fullTableName;
+		TableName			fullTableName;
 
 		/* First walk result column list looking for *'s to expand */
 		for (int index = 0; index < size(); index++)
@@ -1461,7 +1461,15 @@ public class ResultColumnList extends QueryTreeNodeVector
 			{
 				expanded = true;
 
-				fullTableName = ((AllResultColumn) rc).getFullTableName();
+				//fullTableName = ((AllResultColumn) rc).getFullTableName();
+                TableName temp = rc.getTableNameObject();
+                if(temp != null) {
+                   String sName = temp.getSchemaName();
+                   String tName = temp.getTableName();
+                   fullTableName = makeTableName(sName,tName);
+                }
+                else
+                   fullTableName = null;
 				allExpansion = fromList.expandAll(fullTableName);
 
 				/* Make sure that every column has a name */
diff --git a/java/engine/org/apache/derby/impl/sql/compile/ResultSetNode.java b/java/engine/org/apache/derby/impl/sql/compile/ResultSetNode.java
index 3a9d9024a..a40355721 100755
--- a/java/engine/org/apache/derby/impl/sql/compile/ResultSetNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/ResultSetNode.java
@@ -493,7 +493,7 @@ public abstract class ResultSetNode extends QueryTreeNode
 	 *
 	 * @exception StandardException		Thrown on error
 	 */
-	public ResultColumnList getAllResultColumns(String allTableName)
+	public ResultColumnList getAllResultColumns(TableName allTableName)
 					throws StandardException
 	{
 		if (SanityManager.DEBUG)
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/select.out b/java/testing/org/apache/derbyTesting/functionTests/master/select.out
index bd769e319..5aa3e728e 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/select.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/select.out
@@ -160,4 +160,23 @@ ij> drop table content.keygen;
 0 rows inserted/updated/deleted
 ij> drop schema content restrict;
 0 rows inserted/updated/deleted
+ij> -- This is to test quotes handling in tables.
+-- This tests patch for Derby 13
+create table "S1.T1" (id int not null primary key, d1 int);
+0 rows inserted/updated/deleted
+ij> create schema s1;
+0 rows inserted/updated/deleted
+ij> create table s1.t1 (id int not null primary key, d2 int);
+0 rows inserted/updated/deleted
+ij> select * from s1.t1, "S1.T1" where s1.t1.id = "S1.T1".id;
+ID         |D2         |ID         |D1         
+-----------------------------------------------
+ij> select s1.t1.* from "S1.T1";
+ERROR 42X10: 'S1.T1' is not an exposed table name in the scope in which it appears.
+ij> select "S1.T1".* from s1.t1;
+ERROR 42X10: 'S1.T1' is not an exposed table name in the scope in which it appears.
+ij> select * from "S1.T1" , APP."S1.T1";
+ERROR 42X09: The table or alias name 'APP.S1.T1' is used more than once in the FROM list.
+ij> select "S1.T1".d1 from "S1.T1", APP."S1.T1";
+ERROR 42X09: The table or alias name 'APP.S1.T1' is used more than once in the FROM list.
 ij> 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/select.sql b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/select.sql
index b46aa95ea..00ae394d9 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/lang/select.sql
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/lang/select.sql
@@ -102,3 +102,22 @@ drop table content.content;
 drop table content.style;
 drop table content.keygen;
 drop schema content restrict;
+
+
+-- This is to test quotes handling in tables.
+-- This tests patch for Derby 13
+
+create table "S1.T1" (id int not null primary key, d1 int);
+
+create schema s1;
+create table s1.t1 (id int not null primary key, d2 int);
+
+select * from s1.t1, "S1.T1" where s1.t1.id = "S1.T1".id;
+
+select s1.t1.* from "S1.T1";
+
+select "S1.T1".* from s1.t1;
+
+select * from "S1.T1" , APP."S1.T1";
+
+select "S1.T1".d1 from "S1.T1", APP."S1.T1";
