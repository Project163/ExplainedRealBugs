diff --git a/java/engine/org/apache/derby/impl/sql/compile/ColumnReference.java b/java/engine/org/apache/derby/impl/sql/compile/ColumnReference.java
index da36a4382..35aa92d29 100755
--- a/java/engine/org/apache/derby/impl/sql/compile/ColumnReference.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/ColumnReference.java
@@ -405,7 +405,7 @@ public class ColumnReference extends ValueNode
 		/* Error if no match found in fromList */
 		if (matchingRC == null)
 		{
-			throw StandardException.newException(SQLState.LANG_COLUMN_NOT_FOUND, getFullColumnName());
+			throw StandardException.newException(SQLState.LANG_COLUMN_NOT_FOUND, getSQLColumnName());
 		}
 
 		/* Set the columnNumber from the base table.
@@ -417,22 +417,20 @@ public class ColumnReference extends ValueNode
 	}
 
 	/**
-	 * Get the full column name of this column for purposes of error
-	 * messages or debugging.  The full column name includes the table
-	 * name and schema name, if any.
+	 * Get the column name for purposes of error
+	 * messages or debugging. This returns the column
+	 * name as used in the SQL statement. Thus if it was qualified
+	 * with a table, alias name that will be included.
 	 *
-	 * @return	The full column name in the form schema.table.column
+	 * @return	The  column name in the form [[schema.]table.]column
 	 */
 
-	public String getFullColumnName()
+	public String getSQLColumnName()
 	{
-		String	fullColumnName = "";
-
-		if (tableName != null)
-			fullColumnName += tableName.getFullTableName() + ".";
-		fullColumnName += columnName;
-
-		return fullColumnName;
+		if (tableName == null)
+			return columnName;
+		
+		return tableName.toString() + "." + columnName;
 	}
 
 	/**
diff --git a/java/engine/org/apache/derby/impl/sql/compile/FromList.java b/java/engine/org/apache/derby/impl/sql/compile/FromList.java
index 606105abc..648f84632 100755
--- a/java/engine/org/apache/derby/impl/sql/compile/FromList.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/FromList.java
@@ -544,7 +544,7 @@ public class FromList extends QueryTreeNodeVector implements OptimizableList
 				else
 				{
 					throw StandardException.newException(SQLState.LANG_AMBIGUOUS_COLUMN_NAME, 
-							 columnReference.getFullColumnName());
+							 columnReference.getSQLColumnName());
 				}
 			}
 
diff --git a/java/engine/org/apache/derby/impl/sql/compile/JoinNode.java b/java/engine/org/apache/derby/impl/sql/compile/JoinNode.java
index e95151a47..b5d377685 100755
--- a/java/engine/org/apache/derby/impl/sql/compile/JoinNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/JoinNode.java
@@ -552,7 +552,7 @@ public class JoinNode extends TableOperatorNode
 			if (leftRC != null)
 			{
 				throw StandardException.newException(SQLState.LANG_AMBIGUOUS_COLUMN_NAME, 
-						 columnReference.getFullColumnName());
+						 columnReference.getSQLColumnName());
 			}
 			resultColumn = rightRC;
 		}
diff --git a/java/engine/org/apache/derby/impl/sql/compile/TableName.java b/java/engine/org/apache/derby/impl/sql/compile/TableName.java
index 7fa2fd3bb..2e6b7d275 100755
--- a/java/engine/org/apache/derby/impl/sql/compile/TableName.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/TableName.java
@@ -46,6 +46,7 @@ public class TableName extends QueryTreeNode
 	*/
 	String	tableName;
 	String	schemaName;
+	private boolean hasSchema;
 
 	/*
 	** These fields are used to track the being and end
@@ -66,6 +67,7 @@ public class TableName extends QueryTreeNode
 
 	public void init(Object schemaName, Object tableName)
 	{
+		hasSchema = schemaName != null;
 		this.schemaName = (String) schemaName;
 		this.tableName = (String) tableName;
 	}
@@ -88,8 +90,7 @@ public class TableName extends QueryTreeNode
 		Object	tokEndOffset
 	)
 	{
-		this.schemaName = (String) schemaName;
-		this.tableName = (String) tableName;
+		init(schemaName, tableName);
 		this.tokBeginOffset = ((Integer) tokBeginOffset).intValue();
 		this.tokEndOffset = ((Integer) tokEndOffset).intValue();
 	}
@@ -177,7 +178,10 @@ public class TableName extends QueryTreeNode
 
 	public String toString()
 	{
-		return getFullTableName();
+		if (hasSchema)
+			return getFullTableName();
+		else
+			return tableName;
 	}
 
 	/**
diff --git a/java/engine/org/apache/derby/impl/sql/compile/VerifyAggregateExpressionsVisitor.java b/java/engine/org/apache/derby/impl/sql/compile/VerifyAggregateExpressionsVisitor.java
index bb3ae308c..35c85846a 100755
--- a/java/engine/org/apache/derby/impl/sql/compile/VerifyAggregateExpressionsVisitor.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/VerifyAggregateExpressionsVisitor.java
@@ -77,12 +77,12 @@ public class VerifyAggregateExpressionsVisitor implements Visitor
 		
 			if (groupByList == null)
 			{
-				throw StandardException.newException(SQLState.LANG_INVALID_COL_REF_NON_GROUPED_SELECT_LIST, cr.getFullColumnName());
+				throw StandardException.newException(SQLState.LANG_INVALID_COL_REF_NON_GROUPED_SELECT_LIST, cr.getSQLColumnName());
 			}
 
 			if (groupByList.containsColumnReference(cr) == null)
 			{
-				throw StandardException.newException(SQLState.LANG_INVALID_COL_REF_GROUPED_SELECT_LIST, cr.getFullColumnName());
+				throw StandardException.newException(SQLState.LANG_INVALID_COL_REF_GROUPED_SELECT_LIST, cr.getSQLColumnName());
 			}
 		} 
 		/*
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/altertable.out b/java/testing/org/apache/derbyTesting/functionTests/master/altertable.out
index 656538e0c..c7518c4e7 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/altertable.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/altertable.out
@@ -764,7 +764,7 @@ alter table x drop constraint app.newcons;
 0 rows inserted/updated/deleted
 ij> -- bad schema name
 alter table x add constraint badschema.newcons primary key (x);
-ERROR 42X85: Constraint 'BADSCHEMA.NEWCONS'is required to be in the same schema as table 'APP.X'.
+ERROR 42X85: Constraint 'BADSCHEMA.NEWCONS'is required to be in the same schema as table 'X'.
 ij> -- two constriants, same name, different schema (second will fail)
 drop table x;
 0 rows inserted/updated/deleted
@@ -773,7 +773,7 @@ ij> create table x (x int not null, y int not null);
 ij> alter table x add constraint con check (x > 1);
 0 rows inserted/updated/deleted
 ij> alter table x add constraint newschema.con check (x > 1);
-ERROR 42X85: Constraint 'NEWSCHEMA.CON'is required to be in the same schema as table 'APP.X'.
+ERROR 42X85: Constraint 'NEWSCHEMA.CON'is required to be in the same schema as table 'X'.
 ij> select schemaname, constraintname from sys.sysconstraints c, sys.sysschemas s where s.schemaid = c.schemaid order by 1;
 SCHEMANAME                                                                                                                      |CONSTRAINTNAME                                                                                                                  
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
@@ -842,7 +842,7 @@ ERROR 42X86: ALTER table failed. There is no constraint 'EMPTYSCHEMA.C1' on tabl
 ij> alter table t1 drop constraint nosuchschema.C2;
 ERROR 42Y07: Schema 'NOSUCHSCHEMA' does not exist
 ij> alter table t1 add constraint emptyschema.C1_PLUS_C2 check ((c1 + c2) < 100);
-ERROR 42X85: Constraint 'EMPTYSCHEMA.C1_PLUS_C2'is required to be in the same schema as table 'APP.T1'.
+ERROR 42X85: Constraint 'EMPTYSCHEMA.C1_PLUS_C2'is required to be in the same schema as table 'T1'.
 ij> alter table t1 add constraint C1_PLUS_C2 check ((c1 + c2) < 100);
 0 rows inserted/updated/deleted
 ij> prepare alplus as 'alter table t1 drop constraint C1_PLUS_C2';
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/primarykey.out b/java/testing/org/apache/derbyTesting/functionTests/master/primarykey.out
index 9c8515656..86c6a64dc 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/primarykey.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/primarykey.out
@@ -20,13 +20,13 @@ create table neg (c1 int not null, c2 int not null, primary key(c1, c2, cx));
 ERROR 42X93: Table 'NEG' contains a constraint definition with column 'CX' which is not in the table.
 ij> -- invalid constraint schema name
 create table neg (c1 int not null, c2 int not null, constraint bar.pkneg primary key(c1, c2));
-ERROR 42X85: Constraint 'BAR.PKNEG'is required to be in the same schema as table 'APP.NEG'.
+ERROR 42X85: Constraint 'BAR.PKNEG'is required to be in the same schema as table 'NEG'.
 ij> create table neg (c1 int not null, c2 int not null, constraint sys.pkneg primary key(c1, c2));
-ERROR 42X85: Constraint 'SYS.PKNEG'is required to be in the same schema as table 'APP.NEG'.
+ERROR 42X85: Constraint 'SYS.PKNEG'is required to be in the same schema as table 'NEG'.
 ij> create table neg (c1 int not null constraint bar.pkneg primary key, c2 int);
-ERROR 42X85: Constraint 'BAR.PKNEG'is required to be in the same schema as table 'APP.NEG'.
+ERROR 42X85: Constraint 'BAR.PKNEG'is required to be in the same schema as table 'NEG'.
 ij> create table neg (c1 int not null constraint sys.pkneg primary key, c2 int);
-ERROR 42X85: Constraint 'SYS.PKNEG'is required to be in the same schema as table 'APP.NEG'.
+ERROR 42X85: Constraint 'SYS.PKNEG'is required to be in the same schema as table 'NEG'.
 ij> -- constraint names must be unique within a schema
 create table neg1(c1 int not null constraint asdf primary key);
 0 rows inserted/updated/deleted
