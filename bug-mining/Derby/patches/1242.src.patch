diff --git a/java/drda/org/apache/derby/drda/NetworkServerControl.java b/java/drda/org/apache/derby/drda/NetworkServerControl.java
index d2c771bf7..2cfe42e71 100644
--- a/java/drda/org/apache/derby/drda/NetworkServerControl.java
+++ b/java/drda/org/apache/derby/drda/NetworkServerControl.java
@@ -585,6 +585,14 @@ public class NetworkServerControl{
         if ( PropertyUtil.getSystemProperty( Property.SYSTEM_HOME_PROPERTY ) == null )
         { System.setProperty( Property.SYSTEM_HOME_PROPERTY, PropertyUtil.getSystemProperty( "user.dir" ) ); }
 
+        //
+        // Make sure the following property is set so that it can be substituted into the
+        // policy file. That will let us grant write permission on the server's
+        // trace file.
+        //
+        if ( PropertyUtil.getSystemProperty( Property.DRDA_PROP_TRACEDIRECTORY ) == null )
+        { System.setProperty( Property.DRDA_PROP_TRACEDIRECTORY, PropertyUtil.getSystemProperty( Property.SYSTEM_HOME_PROPERTY ) ); }
+
         //
         // Forcibly set the following property so that it will be correctly
         // substituted into the default policy file. This is the hostname for
diff --git a/java/drda/org/apache/derby/drda/server.policy b/java/drda/org/apache/derby/drda/server.policy
index 34eb26619..26ff28d29 100644
--- a/java/drda/org/apache/derby/drda/server.policy
+++ b/java/drda/org/apache/derby/drda/server.policy
@@ -21,6 +21,21 @@ grant codeBase "${derby.install.url}derby.jar"
 // You may want to restrict this access to specific directories.
 //
   permission java.io.FilePermission "<<ALL FILES>>", "read,write,delete";
+
+//
+// Needed by sysinfo. The file permission is needed to
+// check the existence of jars on the classpath. You can
+// limit this permission to just the locations which hold
+// your jar files. This block is reproduced for all codebases
+// which include the sysinfo classes--the policy file syntax
+// does not let you grant permissions to several codebases
+// all at once.
+//
+  permission java.util.PropertyPermission "user.*", "read";
+  permission java.util.PropertyPermission "java.home", "read";
+  permission java.util.PropertyPermission "java.class.path", "read";
+  permission java.lang.RuntimePermission "getProtectionDomain";
+  permission java.io.FilePermission "<<ALL FILES>>", "read";
 };
 
 grant codeBase "${derby.install.url}derbynet.jar"
@@ -39,5 +54,81 @@ grant codeBase "${derby.install.url}derbynet.jar"
 
   permission java.net.SocketPermission "*", "accept"; 
 
+//
+// Needed for server tracing.
+//
+  permission java.io.FilePermission "${derby.drda.traceDirectory}${/}-", "read,write,delete";
+
+//
+// Needed by sysinfo. The file permission is needed to
+// check the existence of jars on the classpath. You can
+// limit this permission to just the locations which hold
+// your jar files. This block is reproduced for all codebases
+// which include the sysinfo classes--the policy file syntax
+// does not let you grant permissions to several codebases
+// all at once.
+//
+  permission java.util.PropertyPermission "user.*", "read";
+  permission java.util.PropertyPermission "java.home", "read";
+  permission java.util.PropertyPermission "java.class.path", "read";
+  permission java.lang.RuntimePermission "getProtectionDomain";
+  permission java.io.FilePermission "<<ALL FILES>>", "read";
+};
+
+
+grant codeBase "${derby.install.url}derbytools.jar"
+{
+//
+// Needed by sysinfo. The file permission is needed to
+// check the existence of jars on the classpath. You can
+// limit this permission to just the locations which hold
+// your jar files. This block is reproduced in the 3 codebases
+// which include the sysinfo classes--the policy file syntax
+// does not let you grant permissions to several codebases
+// all at once.
+//
+  permission java.util.PropertyPermission "user.*", "read";
+  permission java.util.PropertyPermission "java.home", "read";
+  permission java.util.PropertyPermission "java.class.path", "read";
+  permission java.lang.RuntimePermission "getProtectionDomain";
+  permission java.io.FilePermission "<<ALL FILES>>", "read";
+};
+
+grant codeBase "${derby.install.url}derbyclient.jar"
+{
+//
+// Needed by sysinfo. The file permission is needed to
+// check the existence of jars on the classpath. You can
+// limit this permission to just the locations which hold
+// your jar files. This block is reproduced in the 3 codebases
+// which include the sysinfo classes--the policy file syntax
+// does not let you grant permissions to several codebases
+// all at once.
+//
+  permission java.util.PropertyPermission "user.*", "read";
+  permission java.util.PropertyPermission "java.home", "read";
+  permission java.util.PropertyPermission "java.class.path", "read";
+  permission java.lang.RuntimePermission "getProtectionDomain";
+  permission java.io.FilePermission "<<ALL FILES>>", "read";
 };
 
+grant codeBase "${derby.install.url}derbytesting.jar"
+{
+//
+// Needed by sysinfo. The file permission is needed to
+// check the existence of jars on the classpath. You can
+// limit this permission to just the locations which hold
+// your jar files. This block is reproduced in the 3 codebases
+// which include the sysinfo classes--the policy file syntax
+// does not let you grant permissions to several codebases
+// all at once.
+//
+  permission java.util.PropertyPermission "user.*", "read";
+  permission java.util.PropertyPermission "java.home", "read";
+  permission java.util.PropertyPermission "java.class.path", "read";
+  permission java.lang.RuntimePermission "getProtectionDomain";
+  permission java.io.FilePermission "<<ALL FILES>>", "read";
+};
+
+
+
diff --git a/java/drda/org/apache/derby/drda/template.policy b/java/drda/org/apache/derby/drda/template.policy
index 1921cc04c..db2b1df5a 100644
--- a/java/drda/org/apache/derby/drda/template.policy
+++ b/java/drda/org/apache/derby/drda/template.policy
@@ -33,6 +33,7 @@ grant codeBase "${derby.install.url}derby.jar"
 // You may want to restrict this access to specific directories.
 //
   permission java.io.FilePermission "<<ALL FILES>>", "read,write,delete";
+
 };
 
 grant codeBase "${derby.install.url}derbynet.jar"
@@ -51,5 +52,36 @@ grant codeBase "${derby.install.url}derbynet.jar"
 
   permission java.net.SocketPermission "*", "accept"; 
 
+//
+// Needed for server tracing.
+//
+  permission java.io.FilePermission "${derby.drda.traceDirectory}${/}-", "read,write,delete";
+
+//
+// Needed by sysinfo. The file permission is needed to
+// check the existence of jars on the classpath. You can
+// limit this permission to just the locations which hold
+// your jar files.
+//
+// In this template file, this block of permissions is granted
+// to derbynet.jar under the assumption that derbynet.jar is
+// the first jar file in your classpath which contains the
+// sysinfo classes. If that is not the case, then you will want
+// to grant this block of permissions to the first jar file
+// in your classpath which contains the sysinfo classes.
+// Those classes are bundled into the following Derby
+// jar files:
+//
+//    derbynet.jar
+//    derby.jar
+//    derbyclient.jar
+//    derbytools.jar
+//    derbytesting.jar
+//
+  permission java.util.PropertyPermission "user.*", "read";
+  permission java.util.PropertyPermission "java.home", "read";
+  permission java.util.PropertyPermission "java.class.path", "read";
+  permission java.lang.RuntimePermission "getProtectionDomain";
+  permission java.io.FilePermission "<<ALL FILES>>", "read";
 };
 
diff --git a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/SecureServerTest.java b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/SecureServerTest.java
index c74929501..8893843f6 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/SecureServerTest.java
+++ b/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/SecureServerTest.java
@@ -25,6 +25,8 @@ import java.io.InputStream;
 import java.io.PrintWriter;
 import java.io.StringWriter;
 import java.net.URL;
+import java.security.AccessController;
+import java.security.PrivilegedAction;
 import java.sql.Connection;
 import java.sql.DriverManager;
 import java.util.ArrayList;
@@ -355,6 +357,12 @@ public class SecureServerTest extends BaseJDBCTestCase
         // wildcarded (DERBY-2811)
         //
         if ( _authenticationRequired && ( _wildCardHost != null ) ) { connectToServer(); }
+
+        //
+        // make sure that we can run sysinfo and turn on tracing (DERBY-3086)
+        //
+        runsysinfo();
+        enableTracing();
     }
 
     private void    connectToServer()
@@ -376,6 +384,26 @@ public class SecureServerTest extends BaseJDBCTestCase
         conn.close();
     }
 
+    private void    runsysinfo()
+        throws Exception
+    {
+        String          sysinfoOutput = runServerCommand( "sysinfo" );
+
+        if ( sysinfoOutput.indexOf( "Security Exception:" ) > -1 )
+        { fail( "Security exceptions in sysinfo output:\n\n:" + sysinfoOutput ); }
+    }
+
+    private void    enableTracing()
+        throws Exception
+    {
+        String          traceOnOutput = runServerCommand( "trace on" );
+
+        println( "Output for trace on command:\n\n" + traceOnOutput );
+
+        if ( traceOnOutput.indexOf( "Trace turned on for all sessions." ) < 0 )
+        { fail( "Security exceptions in output of trace enabling command:\n\n:" + traceOnOutput ); }
+    }
+    
     ///////////////////////////////////////////////////////////////////////////////////
     //
     // Object OVERLOADS
@@ -402,12 +430,59 @@ public class SecureServerTest extends BaseJDBCTestCase
     //
     ///////////////////////////////////////////////////////////////////////////////////
 
+    /**
+     * <p>
+     * Run a NetworkServerControl command.
+     * </p>
+     */
+    private String    runServerCommand( String commandSpecifics )
+        throws Exception
+    {
+        String          portNumber = Integer.toString( getTestConfiguration().getPort() );
+        StringBuffer    buffer = new StringBuffer();
+        String          classpath = getSystemProperty( "java.class.path" );
+
+        buffer.append( "java -classpath " );
+        buffer.append( classpath );
+        buffer.append( " org.apache.derby.drda.NetworkServerControl -p " + portNumber + " " + commandSpecifics );
+
+        final   String  command = buffer.toString();
+
+        println( "Server command is " + command );
+
+        Process     serverProcess = (Process) AccessController.doPrivileged
+            (
+             new PrivilegedAction()
+             {
+                 public Object run()
+                 {
+                     Process    result = null;
+                     try {
+                        result = Runtime.getRuntime().exec( command );
+                     } catch (Exception ex) {
+                         ex.printStackTrace();
+                     }
+                     
+                     return result;
+                 }
+             }
+            );
+
+        InputStream is = serverProcess.getInputStream();
+        
+        return getProcessOutput( is, 10000 );
+    }
+
     private String  getServerOutput()
         throws Exception
     {
-        byte[]          inputBuffer = new byte[ 1000 ];
+        return getProcessOutput( _inputStreamHolder[ 0 ], 1000 );
+    }
 
-        InputStream is = _inputStreamHolder[ 0 ];
+    private String  getProcessOutput( InputStream is, int bufferLength )
+        throws Exception
+    {
+        byte[]          inputBuffer = new byte[ bufferLength ];
 
         int             bytesRead = is.read( inputBuffer );
 
diff --git a/java/tools/org/apache/derby/impl/tools/sysinfo/Main.java b/java/tools/org/apache/derby/impl/tools/sysinfo/Main.java
index 5e819b332..50eca49f2 100644
--- a/java/tools/org/apache/derby/impl/tools/sysinfo/Main.java
+++ b/java/tools/org/apache/derby/impl/tools/sysinfo/Main.java
@@ -199,10 +199,17 @@ public static void getMainInfo (java.io.PrintWriter aw, boolean pause) {
 
 	  localAW.println("JRE - JDBC: " + org.apache.derby.iapi.services.info.JVMInfo.derbyVMLevel());
 
-	  String classpath;
-
-	  try {
-		  classpath = System.getProperty("java.class.path");
+	  String classpath = null;
+
+      try {
+          classpath = (String) AccessController.doPrivileged( new PrivilegedAction()
+              {
+                  public Object run()
+                  {
+                      return System.getProperty("java.class.path");
+                  }
+              }
+              );
 	  }
 	  catch (SecurityException se) {
           localAW.println(
@@ -210,7 +217,7 @@ public static void getMainInfo (java.io.PrintWriter aw, boolean pause) {
 		  classpath = null;
 	  }
 
-    ZipInfoProperties zip[]= Main.getAllInfo (classpath);
+      ZipInfoProperties zip[]= Main.getAllInfo (classpath);
 
     if (zip != null) {
 
@@ -289,15 +296,20 @@ public static void getMainInfo (java.io.PrintWriter aw, boolean pause) {
     security exception.
    */
 
-  private static String getJavaProperty (String whichProperty) {
+  private static String getJavaProperty (final String whichProperty) {
 
-    String property;
-    String unavailable = Main.getTextMessage ("SIF01.H");
+    final   String unavailable = Main.getTextMessage ("SIF01.H");
 
     try {
-
-      property = System.getProperty (whichProperty, unavailable);
-      return property;
+        String  property = (String) AccessController.doPrivileged( new PrivilegedAction()
+            {
+                public  Object  run()
+                {
+                    return System.getProperty (whichProperty, unavailable);
+                }
+            }
+            );
+        return property;
     }
     catch (SecurityException se) {
 
@@ -889,26 +901,34 @@ public static void getMainInfo (java.io.PrintWriter aw, boolean pause) {
      *  @param cpEntry the classpath element
      *  @return a ZipInfoProperties if an info properties file is found.
      */
-    private static ZipInfoProperties checkForInfo(String cpEntry)
+    private static ZipInfoProperties checkForInfo(final String cpEntry)
     {
-        File f = new File(cpEntry);
-        if ( ! f.exists())
-        {
-            return null;
-        }
+        return (ZipInfoProperties) AccessController.doPrivileged( new PrivilegedAction()
+            {
+                public Object run()
+                {
+                    File f = new File(cpEntry);
+                    if ( ! f.exists())
+                    {
+                        return null;
+                    }
 
-        if (f.isDirectory())
-        {
-            ZipInfoProperties zip = checkDirectory(cpEntry);
-            return zip;
-        }
+                    if (f.isDirectory())
+                    {
+                        ZipInfoProperties zip = checkDirectory(cpEntry);
+                        return zip;
+                    }
 
-        if (f.isFile())
-        {
-            ZipInfoProperties zip = checkFile(cpEntry);
-            return zip;
-        }
-        return null;
+                    if (f.isFile())
+                    {
+                        ZipInfoProperties zip = checkFile(cpEntry);
+                        return zip;
+                    }
+                    return null;
+                }
+            }
+            );
+        
     }
 
     /**
