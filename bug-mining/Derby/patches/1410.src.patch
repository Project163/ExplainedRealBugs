diff --git a/java/engine/org/apache/derby/impl/sql/compile/ModifyColumnNode.java b/java/engine/org/apache/derby/impl/sql/compile/ModifyColumnNode.java
index e5510c87e..69ca27b2b 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/ModifyColumnNode.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/ModifyColumnNode.java
@@ -209,8 +209,13 @@ public class ModifyColumnNode extends ColumnDefinitionNode
 					((existingConstraint.getConstraintType() == 
 					 DataDictionary.PRIMARYKEY_CONSTRAINT)))
 				{
-                    throw StandardException.newException(
-                         SQLState.LANG_MODIFY_COLUMN_EXISTING_CONSTRAINT, name);
+					String errorState = 
+						(getLanguageConnectionContext().getDataDictionary()
+								.checkVersion(DataDictionary.DD_VERSION_DERBY_10_4, 
+								null))
+						? SQLState.LANG_MODIFY_COLUMN_EXISTING_PRIMARY_KEY
+						: SQLState.LANG_MODIFY_COLUMN_EXISTING_CONSTRAINT;
+					throw StandardException.newException(errorState, name);
 				}
 				// unique key or primary key.
 				ConstraintDescriptorList 
diff --git a/java/engine/org/apache/derby/impl/sql/compile/TableElementList.java b/java/engine/org/apache/derby/impl/sql/compile/TableElementList.java
index bb5298532..230e4dd55 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/TableElementList.java
+++ b/java/engine/org/apache/derby/impl/sql/compile/TableElementList.java
@@ -1070,7 +1070,13 @@ public class TableElementList extends QueryTreeNodeVector
             // todo dtd may be null if the column does not exist, we should check that first
             if (dtd != null && dtd.isNullable())
             {
-                throw StandardException.newException(SQLState.LANG_DB2_ADD_UNIQUE_OR_PRIMARY_KEY_ON_NULL_COLS, colName);
+                String errorState = 
+                   (getLanguageConnectionContext().getDataDictionary()
+                        .checkVersion(DataDictionary.DD_VERSION_DERBY_10_4, null))
+                    ? SQLState.LANG_ADD_PRIMARY_KEY_ON_NULL_COLS
+                    : SQLState.LANG_DB2_ADD_UNIQUE_OR_PRIMARY_KEY_ON_NULL_COLS;
+
+                throw StandardException.newException(errorState, colName);
             }
         }
     }
diff --git a/java/engine/org/apache/derby/impl/sql/compile/sqlgrammar.jj b/java/engine/org/apache/derby/impl/sql/compile/sqlgrammar.jj
index 769778eed..5e29788f3 100644
--- a/java/engine/org/apache/derby/impl/sql/compile/sqlgrammar.jj
+++ b/java/engine/org/apache/derby/impl/sql/compile/sqlgrammar.jj
@@ -313,10 +313,10 @@ public class SQLParser
 		@param version Data Dictionary major version (DataDictionary.DD_ constant)
 		@param feature SQL Feature name, for error text.
 	*/
-	private void checkVersion(int version, String feature) throws StandardException
+	private boolean checkVersion(int version, String feature) throws StandardException
 	{
-		getLanguageConnectionContext().getDataDictionary().checkVersion(
-				version, feature);
+		return getLanguageConnectionContext()
+				.getDataDictionary().checkVersion(version, feature);
 	}
 
     /**
@@ -11876,7 +11876,10 @@ uniqueConstraintDefinition(TableName constraintName) throws StandardException :
 				String primaryKeyColumnName = ((ResultColumn) uniqueColumnList.elementAt(index)).getName();
 				if (explicitlyNullableColumnsList.contains(primaryKeyColumnName))
 				{
-					String errorState = SQLState.LANG_DB2_ADD_UNIQUE_OR_PRIMARY_KEY_ON_NULL_COLS;
+					String errorState = 
+						(checkVersion (DataDictionary.DD_VERSION_DERBY_10_4, null))
+							? SQLState.LANG_ADD_PRIMARY_KEY_ON_NULL_COLS
+							: SQLState.LANG_DB2_ADD_UNIQUE_OR_PRIMARY_KEY_ON_NULL_COLS;
 					throw StandardException.newException(errorState, primaryKeyColumnName);
 				}
 			}
@@ -11913,7 +11916,11 @@ uniqueSpecification(String columnName) throws StandardException :
 		//a column-level constraint of primary key on it will result in an error.
 		if (explicitNull) 
 		{
-			String errorState = SQLState.LANG_DB2_ADD_UNIQUE_OR_PRIMARY_KEY_ON_NULL_COLS;
+			String errorState = 
+				(checkVersion (DataDictionary.DD_VERSION_DERBY_10_4, null))
+					? SQLState.LANG_ADD_PRIMARY_KEY_ON_NULL_COLS
+					: SQLState.LANG_DB2_ADD_UNIQUE_OR_PRIMARY_KEY_ON_NULL_COLS;
+
 			throw StandardException.newException(errorState, columnName);
 		}
 		return DataDictionary.PRIMARYKEY_CONSTRAINT;
diff --git a/java/engine/org/apache/derby/impl/sql/execute/AlterTableConstantAction.java b/java/engine/org/apache/derby/impl/sql/execute/AlterTableConstantAction.java
index bf896cc37..d6da019e2 100644
--- a/java/engine/org/apache/derby/impl/sql/execute/AlterTableConstantAction.java
+++ b/java/engine/org/apache/derby/impl/sql/execute/AlterTableConstantAction.java
@@ -2601,10 +2601,17 @@ class AlterTableConstantAction extends DDLSingleTableConstantAction
 									lcc,
 									false))
 			{	
-				if (errorMsg.equals(SQLState.LANG_NULL_DATA_IN_PRIMARY_KEY))
+				if (errorMsg.equals(SQLState.LANG_NULL_DATA_IN_PRIMARY_KEY_OR_UNIQUE_CONSTRAINT))
 				{	//alter table add primary key
+					 //soft upgrade mode
 					throw StandardException.newException(
-						SQLState.LANG_NULL_DATA_IN_PRIMARY_KEY, 
+						SQLState.LANG_NULL_DATA_IN_PRIMARY_KEY_OR_UNIQUE_CONSTRAINT, 
+						td.getQualifiedName());
+				}
+				else if (errorMsg.equals(SQLState.LANG_NULL_DATA_IN_PRIMARY_KEY)) 
+				{	//alter table add primary key
+					throw StandardException.newException(
+						SQLState.LANG_NULL_DATA_IN_PRIMARY_KEY,
 						td.getQualifiedName());
 				}
 				else 
diff --git a/java/engine/org/apache/derby/loc/messages.xml b/java/engine/org/apache/derby/loc/messages.xml
index 1d943ff30..2a3fb1fbe 100644
--- a/java/engine/org/apache/derby/loc/messages.xml
+++ b/java/engine/org/apache/derby/loc/messages.xml
@@ -1258,6 +1258,12 @@ Guide.
                 <arg>columnName</arg>
             </msg>
 
+            <msg>
+                <name>42831.S.1</name>
+                <text>'{0}' cannot be a column of a primary key because it can contain null values.</text>
+                <arg>columnName</arg>
+            </msg>
+
             <msg>
                 <name>42834</name>
                 <text>SET NULL cannot be specified because FOREIGN KEY '{0}'  cannot contain null values.  </text>
@@ -2392,6 +2398,12 @@ Guide.
                 <arg>columnName</arg>
             </msg>
 
+            <msg>
+                <name>42Z20.S.1</name>
+                <text>Column '{0}' cannot be made nullable. It is part of a primary key, which cannot have any nullable columns.</text>
+                <arg>columnName</arg>
+            </msg>
+
             <msg>
                 <name>42Z21</name>
                 <text>Invalid increment specified for identity for column '{0}'. Increment cannot be zero.  </text>
@@ -3076,6 +3088,12 @@ Guide.
                 <arg>tableName</arg>
             </msg>
 
+            <msg>
+                <name>X0Y63.S.1</name>
+                <text>The command on table '{0}' failed because null data was found in the primary key/index column(s). All columns in a primary key must not be null.  </text>
+                <arg>tableName</arg>
+            </msg>
+
             <msg>
                 <name>X0Y66.S</name>
                 <text>Cannot issue commit in a nested connection when there is a pending operation in the parent connection.</text>
diff --git a/java/shared/org/apache/derby/shared/common/reference/SQLState.java b/java/shared/org/apache/derby/shared/common/reference/SQLState.java
index 2e6022054..d25529f4c 100644
--- a/java/shared/org/apache/derby/shared/common/reference/SQLState.java
+++ b/java/shared/org/apache/derby/shared/common/reference/SQLState.java
@@ -771,6 +771,7 @@ public interface SQLState {
 	String LANG_DB2_INVALID_COLS_SPECIFIED                             = "42802";
         String LANG_DB2_INVALID_SELECT_COL_FOR_HAVING = "42803";
 	String LANG_DB2_ADD_UNIQUE_OR_PRIMARY_KEY_ON_NULL_COLS			   = "42831";
+	String LANG_ADD_PRIMARY_KEY_ON_NULL_COLS                           = "42831.S.1";
 	String LANG_DB2_REPLACEMENT_ERROR								   = "42815.S.713";
 	String LANG_DB2_COALESCE_DATATYPE_MISMATCH								   = "42815.S.171";
 	String LANG_DB2_TOO_LONG_FLOATING_POINT_LITERAL			           = "42820";
@@ -988,6 +989,7 @@ public interface SQLState {
 	String LANG_MODIFY_COLUMN_FKEY_CONSTRAINT						   = "42Z18";
 	String LANG_MODIFY_COLUMN_REFERENCED							   = "42Z19";
 	String LANG_MODIFY_COLUMN_EXISTING_CONSTRAINT					   = "42Z20";
+	String LANG_MODIFY_COLUMN_EXISTING_PRIMARY_KEY					   = "42Z20.S.1";
 
 	String LANG_AI_INVALID_INCREMENT								   = "42Z21";
 	String LANG_AI_INVALID_TYPE										   = "42Z22";
@@ -1301,7 +1303,8 @@ public interface SQLState {
 	String LANG_ADDING_NON_NULL_COLUMN_TO_NON_EMPTY_TABLE              = "X0Y57.S";
 	String LANG_ADD_PRIMARY_KEY_FAILED1                                = "X0Y58.S";
 	String LANG_ADD_CHECK_CONSTRAINT_FAILED                            = "X0Y59.S";
-	String LANG_NULL_DATA_IN_PRIMARY_KEY                 	   	   	   = "X0Y63.S";
+	String LANG_NULL_DATA_IN_PRIMARY_KEY_OR_UNIQUE_CONSTRAINT      	   = "X0Y63.S";
+	String LANG_NULL_DATA_IN_PRIMARY_KEY                               = "X0Y63.S.1";
 	String LANG_NO_COMMIT_IN_NESTED_CONNECTION                         = "X0Y66.S";
 	String LANG_NO_ROLLBACK_IN_NESTED_CONNECTION                       = "X0Y67.S";
 	String LANG_OBJECT_ALREADY_EXISTS                                  = "X0Y68.S";
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/altertable.out b/java/testing/org/apache/derbyTesting/functionTests/master/altertable.out
index 6bb973a7f..237feeb90 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/altertable.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/altertable.out
@@ -418,9 +418,9 @@ ij> -- add constraint
 alter table t0 add column c3 int;
 0 rows inserted/updated/deleted
 ij> alter table t0 add constraint cons1 primary key(c3);
-ERROR 42831: 'C3' cannot be a column of a primary key or unique key because it can contain null values.
+ERROR 42831: 'C3' cannot be a column of a primary key because it can contain null values.
 ij> alter table t0 add primary key(c3);
-ERROR 42831: 'C3' cannot be a column of a primary key or unique key because it can contain null values.
+ERROR 42831: 'C3' cannot be a column of a primary key because it can contain null values.
 ij> -- add constraint references non-existant column
 alter table t4 add constraint t4pk primary key("c1");
 ERROR 42X14: 'c1' is not a column in table or VTI 'T4'.
@@ -609,7 +609,7 @@ alter table t1 drop constraint p1;
 ERROR 42X86: ALTER TABLE failed. There is no constraint 'APP.P1' on table '"APP"."T1"'. 
 ij> -- In DB2 compatibility mode, we cann't add a nullable primary key
 alter table t0_1 add constraint p2 primary key(c1);
-ERROR 42831: 'C1' cannot be a column of a primary key or unique key because it can contain null values.
+ERROR 42831: 'C1' cannot be a column of a primary key because it can contain null values.
 ij> alter table t0_1 drop constraint p2;
 ERROR 42X86: ALTER TABLE failed. There is no constraint 'APP.P2' on table '"APP"."T0_1"'. 
 ij> -- positive tests
@@ -926,13 +926,13 @@ ij> -- show that a column which is part of the PRIMARY KEY cannot be modified NU
 create table atmcn_2 (a integer not null primary key, b integer not null);
 0 rows inserted/updated/deleted
 ij> alter table atmcn_2 alter column a null;
-ERROR 42Z20: Column 'A' cannot be made nullable. It is part of a primary key or unique constraint, which cannot have any nullable columns.
+ERROR 42Z20: Column 'A' cannot be made nullable. It is part of a primary key, which cannot have any nullable columns.
 ij> create table atmcn_3 (a integer not null, b integer not null);
 0 rows inserted/updated/deleted
 ij> alter table atmcn_3 add constraint atmcn_3_pk primary key(a, b);
 0 rows inserted/updated/deleted
 ij> alter table atmcn_3 alter column b null;
-ERROR 42Z20: Column 'B' cannot be made nullable. It is part of a primary key or unique constraint, which cannot have any nullable columns.
+ERROR 42Z20: Column 'B' cannot be made nullable. It is part of a primary key, which cannot have any nullable columns.
 ij> -- verify that the keyword "column" in the ALTER TABLE ... ALTER COLUMN ...
 -- statement is optional:
 create table atmcn_4 (a integer not null, b integer);
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/db2Compatibility.out b/java/testing/org/apache/derbyTesting/functionTests/master/db2Compatibility.out
index 2d2273a7c..fa05e4451 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/db2Compatibility.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/db2Compatibility.out
@@ -1704,7 +1704,7 @@ ij> -- Beetle 5717: Disable adding primary or unique constraints on non-nullable
 create table t1 (c1 int, c2 int);
 0 rows inserted/updated/deleted
 ij> alter table t1 add constraint pk1 primary key (c1);
-ERROR 42831: 'C1' cannot be a column of a primary key or unique key because it can contain null values.
+ERROR 42831: 'C1' cannot be a column of a primary key because it can contain null values.
 ij> alter table t1 add constraint uc1 unique (c2);
 0 rows inserted/updated/deleted
 ij> -- positive tests
diff --git a/java/testing/org/apache/derbyTesting/functionTests/master/nulls.out b/java/testing/org/apache/derbyTesting/functionTests/master/nulls.out
index 26ae7bd5c..b89810458 100644
--- a/java/testing/org/apache/derbyTesting/functionTests/master/nulls.out
+++ b/java/testing/org/apache/derbyTesting/functionTests/master/nulls.out
@@ -61,7 +61,7 @@ create table a (a1 int not null, a2 int);
 ij> insert into a values(1, NULL);
 1 row inserted/updated/deleted
 ij> alter table a add constraint ap1 primary key(a1, a2);
-ERROR 42831: 'A2' cannot be a column of a primary key or unique key because it can contain null values.
+ERROR 42831: 'A2' cannot be a column of a primary key because it can contain null values.
 ij> drop table a;
 0 rows inserted/updated/deleted
 ij> -- try with multiple columns
@@ -69,7 +69,7 @@ create table a (a1 int, a2 int, a3 int);
 0 rows inserted/updated/deleted
 ij> -- This is an error in DB2 compatibility mode
 alter table a add constraint ap1 primary key(a1, a2, a3);
-ERROR 42831: 'A1' cannot be a column of a primary key or unique key because it can contain null values.
+ERROR 42831: 'A1' cannot be a column of a primary key because it can contain null values.
 ij> drop table a;
 0 rows inserted/updated/deleted
 ij> -- try with multiple null columns
@@ -79,7 +79,7 @@ ij> insert into a values(1,1,1);
 1 row inserted/updated/deleted
 ij> -- table with no null data should work
 alter table a add constraint ap1 primary key(a1, a2, a3);
-ERROR 42831: 'A2' cannot be a column of a primary key or unique key because it can contain null values.
+ERROR 42831: 'A2' cannot be a column of a primary key because it can contain null values.
 ij> -- insert a null into one of the primary key columns should fail
 insert into a values(1, NULL, 1);
 1 row inserted/updated/deleted
@@ -92,7 +92,7 @@ ij> insert into a values(1,NULL,1);
 1 row inserted/updated/deleted
 ij> -- table with some null data should fail
 alter table a add constraint ap1 primary key(a1, a2, a3);
-ERROR 42831: 'A2' cannot be a column of a primary key or unique key because it can contain null values.
+ERROR 42831: 'A2' cannot be a column of a primary key because it can contain null values.
 ij> -- defining primarykey column constraint for explicitly nullable column
 -- gives error
 create table a1(ac1 int null primary key);
