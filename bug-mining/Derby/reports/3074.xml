<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 14:49:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DERBY-6736] The jacoco-junit target fails to store coverage data for some sub-suites</title>
                <link>https://issues.apache.org/jira/browse/DERBY-6736</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The console log for the code coverage test runs at &lt;a href=&quot;https://builds.apache.org/job/Derby-JaCoCo/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Derby-JaCoCo/&lt;/a&gt; shows that JaCoCo fails to write coverage data for the following test suites:&lt;/p&gt;

&lt;p&gt;lang&lt;br/&gt;
jdbcapi&lt;br/&gt;
store&lt;br/&gt;
engine&lt;br/&gt;
encryption&lt;/p&gt;

&lt;p&gt;It is caused by the following permissions-related exception:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    [junit] java.security.AccessControlException: access denied (&quot;java.io.FilePermission&quot; &quot;/home/jenkins/jenkins-slave/workspace/Derby-JaCoCo/trunk/junit_20140912_1758/jacoco.exec&quot; &quot;write&quot;)
    [junit] 	at java.security.AccessControlContext.checkPermission(AccessControlContext.java:372)
    [junit] 	at java.security.AccessController.checkPermission(AccessController.java:559)
    [junit] 	at java.lang.SecurityManager.checkPermission(SecurityManager.java:549)
    [junit] 	at java.lang.SecurityManager.checkWrite(SecurityManager.java:979)
    [junit] 	at java.io.FileOutputStream.&amp;lt;init&amp;gt;(FileOutputStream.java:203)
    [junit] 	at org.jacoco.agent.rt.internal_9dd1198.output.FileOutput.openFile(FileOutput.java:67)
    [junit] 	at org.jacoco.agent.rt.internal_9dd1198.output.FileOutput.writeExecutionData(FileOutput.java:53)
    [junit] 	at org.jacoco.agent.rt.internal_9dd1198.Agent.shutdown(Agent.java:143)
    [junit] 	at org.jacoco.agent.rt.internal_9dd1198.Agent$1.run(Agent.java:60)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The result of this is that the coverage report shows lower coverage than what&apos;s actually covered by the tests.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12741455">DERBY-6736</key>
            <summary>The jacoco-junit target fails to store coverage data for some sub-suites</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Mon, 15 Sep 2014 11:40:00 +0000</created>
                <updated>Fri, 9 Sep 2016 09:52:24 +0000</updated>
                            <resolved>Mon, 15 Sep 2014 14:10:35 +0000</resolved>
                                    <version>10.12.1.1</version>
                                    <fixVersion>10.12.1.1</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14133820" author="knutanders" created="Mon, 15 Sep 2014 11:59:28 +0000"  >&lt;p&gt;Common for the suites that &lt;em&gt;don&apos;t&lt;/em&gt; fail, seems to be that the last test in each of those suites runs with a custom security policy. Since SecurityManagerSetup.tearDown() uninstalls the security manager after these tests, there is no security manager installed when the JVM shutdown hook runs. The coverage data are written to disk from the JVM shutdown hook.&lt;/p&gt;

&lt;p&gt;In tests that don&apos;t use a custom security policy, the security manager is not uninstalled when the test is torn down. Therefore, in test suites that end with a test that uses the default security policy, the JVM shutdown hook runs with the default test policy. Presumably, the default policy lacks the permission needed to write the coverage data to a file.&lt;/p&gt;</comment>
                            <comment id="14133842" author="knutanders" created="Mon, 15 Sep 2014 12:40:49 +0000"  >&lt;p&gt;Actually, the default test policy does include the required permission, but the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6715&quot; title=&quot;MissingPermissionsTest fails under JaCoCo&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6715&quot;&gt;&lt;del&gt;DERBY-6715&lt;/del&gt;&lt;/a&gt; accidentally removed the code that activated the permission.&lt;/p&gt;

&lt;p&gt;The attached patch (&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12668758/12668758_d6736-1a.diff&quot; title=&quot;d6736-1a.diff attached to DERBY-6736&quot;&gt;d6736-1a.diff&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;) brings that code back to life, and it adds some comments to make it stand out, so that it&apos;s less likely to be overlooked and accidentally removed again.&lt;/p&gt;

&lt;p&gt;This made some smaller tests collect coverage data again. I&apos;m running the full &quot;ant jacoco-junit&quot; test suite now to verify that it doesn&apos;t introduce any new problems.&lt;/p&gt;</comment>
                            <comment id="14133921" author="knutanders" created="Mon, 15 Sep 2014 14:09:39 +0000"  >&lt;p&gt;The tests ran cleanly with the patch, and no AccessControlExceptions were printed to the console when running &quot;ant jacoco-junit&quot;.&lt;/p&gt;</comment>
                            <comment id="14133922" author="jira-bot" created="Mon, 15 Sep 2014 14:10:00 +0000"  >&lt;p&gt;Commit 1625037 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=knutanders&quot; class=&quot;user-hover&quot; rel=&quot;knutanders&quot;&gt;knutanders&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1625037&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1625037&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6736&quot; title=&quot;The jacoco-junit target fails to store coverage data for some sub-suites&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6736&quot;&gt;&lt;del&gt;DERBY-6736&lt;/del&gt;&lt;/a&gt;: The jacoco-junit target fails to store coverage data for some sub-suites&lt;/p&gt;

&lt;p&gt;Set the jacoco.active property to the empty string when the tests run&lt;br/&gt;
under JaCoCo. The code that did this was removed by mistake in&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6715&quot; title=&quot;MissingPermissionsTest fails under JaCoCo&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6715&quot;&gt;&lt;del&gt;DERBY-6715&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15476572" author="knutanders" created="Fri, 9 Sep 2016 09:52:24 +0000"  >&lt;p&gt;[ Automatically closing all resolved issues that haven&apos;t been updated in more than six months. ]&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12736768">DERBY-6715</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12668758" name="d6736-1a.diff" size="1683" author="knutanders" created="Mon, 15 Sep 2014 12:40:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10420"><![CDATA[Regression]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 10 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i201jz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>