<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 13:58:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DERBY-3889] LOBStreamControl.truncate() doesn&apos;t delete temporary files</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3889</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;If LOBStreamControl.truncate() reduces the size of the lob so that it fits in the internal buffer, it closes the temporary file, but it doesn&apos;t remove it. See the attached Java class (TruncateClob.java) which fills the tmp directory with temporary lob files, even if each lob is explicitly freed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12405465">DERBY-3889</key>
            <summary>LOBStreamControl.truncate() doesn&apos;t delete temporary files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 30 Sep 2008 13:55:28 +0000</created>
                <updated>Mon, 4 May 2009 18:22:58 +0000</updated>
                            <resolved>Wed, 15 Oct 2008 08:25:51 +0000</resolved>
                                    <version>10.3.1.4</version>
                    <version>10.4.2.0</version>
                                    <fixVersion>10.3.3.1</fixVersion>
                    <fixVersion>10.4.2.1</fixVersion>
                    <fixVersion>10.5.1.1</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12638518" author="knutanders" created="Fri, 10 Oct 2008 09:54:26 +0000"  >&lt;p&gt;derby-3889-1a.diff changes LOBStreamControl so that it deletes the temporary file when truncate() switches from file to memory. Since we have three different places in the code that need to do the same set of operations when a temporary file is discarded, I factored it out in a separate method, releaseTempFile().&lt;/p&gt;

&lt;p&gt;I also moved the field lobFile (of type StorageFile) from LOBStreamControl to LOBFile, since it should always be in sync with the field tmpField (of type LOBFile) and the current handling of those fields is a bit confusing (for instance, we only null out tmpFile in free() and truncate(), which works since we always check for tmpFile==null instead of lobFile==null, but it leaves LOBStreamControl in a confusing state). By making it a final field in LOBFile, we automatically get consistency between the two, and the new method releaseTempFile() becomes a one-argument method instead of a two-argument method.&lt;/p&gt;

&lt;p&gt;Derbyall and suites.All ran cleanly with the patch, and I have manually verified that the uploaded repro does not create thousands of temporary files.&lt;/p&gt;</comment>
                            <comment id="12639005" author="kristwaa" created="Mon, 13 Oct 2008 10:06:45 +0000"  >&lt;p&gt;The patch looks good to me. The refactoring makes it easer to write correct code.&lt;br/&gt;
+1 to commit&lt;/p&gt;

&lt;p&gt;I reviewed the code and ran the repro. Without the patch I observed thousands of temporary files, and with the patch the ls command showed zero or one file in the tmp directory. I have also started the regression tests.&lt;/p&gt;</comment>
                            <comment id="12639020" author="knutanders" created="Mon, 13 Oct 2008 11:05:34 +0000"  >&lt;p&gt;Thanks for reviewing the patch, Kristian!&lt;br/&gt;
Committed revision 704010.&lt;/p&gt;

&lt;p&gt;I&apos;m leaving the issue open until the fix has been back-ported to 10.4 and 10.3.&lt;/p&gt;</comment>
                            <comment id="12639760" author="knutanders" created="Wed, 15 Oct 2008 08:25:51 +0000"  >&lt;p&gt;Regression tests passed on 10.4 and 10.3.&lt;/p&gt;

&lt;p&gt;Committed to 10.4 with revision 704803.&lt;br/&gt;
Committed to 10.3 with revision 704804.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12391217" name="TruncateClob.java" size="678" author="knutanders" created="Tue, 30 Sep 2008 13:55:52 +0000"/>
                            <attachment id="12391873" name="derby-3889-1a.diff" size="4216" author="knutanders" created="Fri, 10 Oct 2008 09:54:26 +0000"/>
                            <attachment id="12391874" name="derby-3889-1a.stat" size="127" author="knutanders" created="Fri, 10 Oct 2008 09:54:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23901</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 7 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i072o7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39199</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>