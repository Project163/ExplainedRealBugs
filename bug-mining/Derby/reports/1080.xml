<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 13:39:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DERBY-2787] make entry for clob in connection so that temporary file is removed when a connection is closed or transaction is commited/rolledback</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2787</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description></description>
                <environment></environment>
        <key id="12371226">DERBY-2787</key>
            <summary>make entry for clob in connection so that temporary file is removed when a connection is closed or transaction is commited/rolledback</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="anurag">Anurag Aggarwal</assignee>
                                    <reporter username="anurag">Anurag Aggarwal</reporter>
                        <labels>
                    </labels>
                <created>Fri, 8 Jun 2007 06:25:42 +0000</created>
                <updated>Thu, 2 May 2013 02:29:05 +0000</updated>
                            <resolved>Wed, 13 Jun 2007 14:06:41 +0000</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12502693" author="anurag" created="Fri, 8 Jun 2007 06:31:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2729&quot; title=&quot;temporary lob file should be cleaned when the transaction or connection is no longer valid.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2729&quot;&gt;&lt;del&gt;DERBY-2729&lt;/del&gt;&lt;/a&gt; introduces code required to cleanup the blob and clob during commit/rollback or when connection is closed. The only missing link for clob is to add an entry in EmbeddedConnection so that free method is called on EmbedClob.&lt;/p&gt;</comment>
                            <comment id="12502711" author="anurag" created="Fri, 8 Jun 2007 08:01:08 +0000"  >&lt;p&gt;This patch makes a call to connection.addLobMapping to add entry in connection. Once an entry is added EmbeddedConnection takes care of calling free method hence clearing file.&lt;/p&gt;

&lt;p&gt;please see the description of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2729&quot; title=&quot;temporary lob file should be cleaned when the transaction or connection is no longer valid.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2729&quot;&gt;&lt;del&gt;DERBY-2729&lt;/del&gt;&lt;/a&gt; for more info able SQLState changes. This patches follows similar scheme. &lt;/p&gt;

&lt;p&gt;modified files&lt;/p&gt;

&lt;p&gt;java/engine/org/apache/derby/impl/jdbc/EmbedClob.java&lt;/p&gt;

&lt;p&gt;added call to Connection.addLobMapping in constructors.&lt;br/&gt;
moved checking for closed connection before check for valid flag in checkValidity method. This ensures that if the clob is freed because of closed connection proper sql code is set in SQLException.&lt;br/&gt;
    java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/ClobStoredProcedureTest.java&lt;/p&gt;

&lt;p&gt;Modified tests to get new value for locators. As the Clob now add itself to the connection stored procedure will be getting different value for locator. &lt;br/&gt;
      java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/BlobClob4BlobTest.java&lt;/p&gt;

&lt;p&gt;If a clob is accessed after commit or after free SQLException gets a SSQLState of XJ217. Updated testClobAfterCommit to check for it.&lt;/p&gt;</comment>
                            <comment id="12503734" author="anurag" created="Tue, 12 Jun 2007 06:10:20 +0000"  >&lt;p&gt;fixed conflicts. &lt;br/&gt;
I have run jdbcapi/BlobClob4BlobTest after fixing the conflicts.&lt;br/&gt;
I am running all suites will post about the result after its done.&lt;/p&gt;</comment>
                            <comment id="12503806" author="anurag" created="Tue, 12 Jun 2007 09:48:34 +0000"  >&lt;p&gt;suites.All without any problem it can be considered for review/commit&lt;/p&gt;</comment>
                            <comment id="12504247" author="bernt" created="Wed, 13 Jun 2007 14:06:41 +0000"  >&lt;p&gt;Patch reviewed and found ok.&lt;br/&gt;
Committed revision 546881.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12370514">DERBY-2729</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12370414">DERBY-2715</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12359258" name="derby-2787.diff" size="9550" author="anurag" created="Fri, 8 Jun 2007 08:01:07 +0000"/>
                            <attachment id="12359470" name="derby-2787v2.diff" size="8269" author="anurag" created="Tue, 12 Jun 2007 06:10:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23246</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 24 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i077af:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39947</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>