<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 14:41:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DERBY-6273] NullPointerException when using more than one parameter in COALESCE</title>
                <link>https://issues.apache.org/jira/browse/DERBY-6273</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Calls to COALESCE fail with NullPointerExceptions if there are multiple ? parameters:&lt;/p&gt;

&lt;p&gt;ij version 10.10&lt;br/&gt;
ij&amp;gt; connect &apos;jdbc:derby:memory:db;create=true&apos;;&lt;br/&gt;
ij&amp;gt; prepare ps as &apos;values coalesce(?,?,1)&apos;;&lt;br/&gt;
ERROR XJ001: Java exception: &apos;: java.lang.NullPointerException&apos;. (errorCode = 0)&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.ParameterNode.generateExpression(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.CoalesceFunctionNode.generateExpression(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.ResultColumn.generateExpression(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.ResultColumnList.generateCore(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.ResultColumnList.generate(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.RowResultSetNode.generate(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.ScrollInsensitiveResultSetNode.generate(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.CursorNode.generate(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.StatementNode.generate(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.&amp;lt;init&amp;gt;(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement20.&amp;lt;init&amp;gt;(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement30.&amp;lt;init&amp;gt;(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement40.&amp;lt;init&amp;gt;(Unknown Source)&lt;br/&gt;
	at org.apache.derby.jdbc.Driver40.newEmbedPreparedStatement(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.ij.PrepareStatement(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.ij.ijStatement(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.utilMain.go(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.Main.go(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.Main.mainCore(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.Main.main(Unknown Source)&lt;br/&gt;
	at org.apache.derby.tools.ij.main(Unknown Source)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12654454">DERBY-6273</key>
            <summary>NullPointerException when using more than one parameter in COALESCE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Mon, 24 Jun 2013 09:46:02 +0000</created>
                <updated>Wed, 21 Jan 2015 00:23:19 +0000</updated>
                            <resolved>Wed, 26 Jun 2013 16:31:46 +0000</resolved>
                                    <version>10.10.1.1</version>
                                    <fixVersion>10.8.3.3</fixVersion>
                    <fixVersion>10.9.2.2</fixVersion>
                    <fixVersion>10.10.2.0</fixVersion>
                    <fixVersion>10.11.1.1</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13691853" author="knutanders" created="Mon, 24 Jun 2013 09:53:45 +0000"  >&lt;p&gt;The problem seems to be this loop in CoalesceFunctionNode.bindExpression():&lt;/p&gt;

&lt;p&gt;		//set all the parameter types to the type of the result type&lt;br/&gt;
		for (int index = 0; index &amp;lt; argumentsListSize; index++)&lt;br/&gt;
		{&lt;br/&gt;
			if (((ValueNode) argumentsList.elementAt(index)).requiresTypeFromContext())&lt;/p&gt;
			{
				((ValueNode)argumentsList.elementAt(index)).setType(getTypeServices());
				break;
			}
&lt;p&gt;		}&lt;/p&gt;

&lt;p&gt;The comment says it should set &lt;b&gt;all&lt;/b&gt; the parameter types, but the loop only sets the type of the &lt;b&gt;first&lt;/b&gt; parameter.&lt;/p&gt;

&lt;p&gt;Removing the break statement from the loop seems to make the query compile without throwing NPE.&lt;/p&gt;</comment>
                            <comment id="13692836" author="knutanders" created="Tue, 25 Jun 2013 08:24:23 +0000"  >&lt;p&gt;Attaching derby-6273-01-a.diff, which removes the break statement from the loop so that sets the types of all untyped parameters from context, and adds a test case that verifies that the NPE no longer happens.&lt;/p&gt;

&lt;p&gt;All regression tests passed with the patch.&lt;/p&gt;</comment>
                            <comment id="13693843" author="jira-bot" created="Wed, 26 Jun 2013 08:56:48 +0000"  >&lt;p&gt;Commit 1496837 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=knutanders&quot; class=&quot;user-hover&quot; rel=&quot;knutanders&quot;&gt;knutanders&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1496837&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1496837&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6273&quot; title=&quot;NullPointerException when using more than one parameter in COALESCE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6273&quot;&gt;&lt;del&gt;DERBY-6273&lt;/del&gt;&lt;/a&gt;: NullPointerException when using more than one parameter in COALESCE&lt;/p&gt;</comment>
                            <comment id="13694061" author="jira-bot" created="Wed, 26 Jun 2013 16:31:26 +0000"  >&lt;p&gt;Commit 1496996 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=knutanders&quot; class=&quot;user-hover&quot; rel=&quot;knutanders&quot;&gt;knutanders&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1496996&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1496996&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6273&quot; title=&quot;NullPointerException when using more than one parameter in COALESCE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6273&quot;&gt;&lt;del&gt;DERBY-6273&lt;/del&gt;&lt;/a&gt;: NullPointerException when using more than one parameter in COALESCE&lt;/p&gt;

&lt;p&gt;Merged revision 1496837 from trunk.&lt;/p&gt;</comment>
                            <comment id="13702437" author="jira-bot" created="Mon, 8 Jul 2013 21:18:12 +0000"  >&lt;p&gt;Commit 1500958 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kmarsden&quot; class=&quot;user-hover&quot; rel=&quot;kmarsden&quot;&gt;kmarsden&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1500958&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1500958&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6273&quot; title=&quot;NullPointerException when using more than one parameter in COALESCE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6273&quot;&gt;&lt;del&gt;DERBY-6273&lt;/del&gt;&lt;/a&gt; NullPointerException when using more than one parameter in COALESCE &lt;/p&gt;

&lt;p&gt;merge revision 1496837 from trunk to 10.9&lt;/p&gt;</comment>
                            <comment id="13702446" author="kmarsden" created="Mon, 8 Jul 2013 21:23:34 +0000"  >&lt;p&gt;Assign to myself temporarily  for backport to 10.8&lt;/p&gt;</comment>
                            <comment id="13702617" author="jira-bot" created="Mon, 8 Jul 2013 23:27:19 +0000"  >&lt;p&gt;Commit 1501013 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kmarsden&quot; class=&quot;user-hover&quot; rel=&quot;kmarsden&quot;&gt;kmarsden&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1501013&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1501013&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6273&quot; title=&quot;NullPointerException when using more than one parameter in COALESCE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6273&quot;&gt;&lt;del&gt;DERBY-6273&lt;/del&gt;&lt;/a&gt; NullPointerException when using more than one parameter in COALESCE &lt;/p&gt;

&lt;p&gt;merge revision 1496837 from trunk to 10.8&lt;/p&gt;</comment>
                            <comment id="14284781" author="myrna" created="Wed, 21 Jan 2015 00:23:19 +0000"  >&lt;p&gt;bulk change to close all issues resolved but not closed and not changed since June 1, 2014.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12656863">DERBY-6289</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12589570" name="derby-6273-01-a.diff" size="3270" author="knutanders" created="Tue, 25 Jun 2013 08:24:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>334731</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10424"><![CDATA[Repro attached]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 44 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1lqof:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>335057</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>