<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 14:51:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DERBY-6998] Make it possible to build Derby cleanly using JDK 10</title>
                <link>https://issues.apache.org/jira/browse/DERBY-6998</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;When I build Derby using JDK 10, I get the following warning:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    [javac] /Users/rhillegas/derby/mainline/trunk/java/engine/org/apache/derby/iapi/types/SqlXmlUtil.java:728: warning: [unchecked] getPrefixes(String) in NullNamespaceContext implements getPrefixes(String) in NamespaceContext
    [javac]         public Iterator getPrefixes(String namespaceURI) {
    [javac]                         ^
    [javac]   return type requires unchecked conversion from Iterator to Iterator&amp;lt;String&amp;gt;
    [javac] 1 warning
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I will clean this up.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13162453">DERBY-6998</key>
            <summary>Make it possible to build Derby cleanly using JDK 10</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="rhillegas">Richard N. Hillegas</reporter>
                        <labels>
                    </labels>
                <created>Mon, 28 May 2018 21:46:35 +0000</created>
                <updated>Tue, 20 Oct 2020 01:01:37 +0000</updated>
                                            <version>10.15.1.3</version>
                                                    <component>Build tools</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16492940" author="rhillegas" created="Mon, 28 May 2018 22:24:20 +0000"  >&lt;p&gt;Attaching derby-6998-01-ab-tightenReturnType.diff. This patch tightens a generic type declaration so that the warning no longer appears. This patch also turns off the echoproperties call in the master build script. No-one has taken advantage of the extra output and it is overwhelming. I will run tests on both Java 9 and Java 10. &lt;/p&gt;

&lt;p&gt;Touches the following file:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;-----------------------

M       build.xml

Turn off the echoproperties diagnostic.

-----------------------

M       java/build/org/apache/derbyBuild/lastgoodjarcontents/insane.derbyTesting.jar.lastcontents
M       java/build/org/apache/derbyBuild/lastgoodjarcontents/sane.derbyTesting.jar.lastcontents
M       java/build/org/apache/derbyBuild/lastgoodjarcontents/sane.derbytools.jar.lastcontents
M       java/testing/org/apache/derbyTesting/functionTests/harness/JavaVersionHolder.java
A       java/testing/org/apache/derbyTesting/functionTests/harness/jdk100.java

Make the tests recognize JDK 10.

-----------------------

M       java/engine/org/apache/derby/iapi/types/SqlXmlUtil.java

Fix the new warning raised when we compile this class using JDK 10.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16499083" author="rhillegas" created="Sat, 2 Jun 2018 14:14:11 +0000"  >&lt;p&gt;Tests passed cleanly for me with this patch:&lt;/p&gt;

&lt;p&gt;1) Building and running tests with JDK 9&lt;/p&gt;

&lt;p&gt;2)  Building and running tests with JDK 10&lt;/p&gt;</comment>
                            <comment id="16499085" author="jira-bot" created="Sat, 2 Jun 2018 14:15:44 +0000"  >&lt;p&gt;Commit 1832736 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhillegas&quot; class=&quot;user-hover&quot; rel=&quot;rhillegas&quot;&gt;rhillegas&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1832736&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1832736&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6998&quot; title=&quot;Make it possible to build Derby cleanly using JDK 10&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6998&quot;&gt;DERBY-6998&lt;/a&gt;: Fix compilation warning when building with JDK 10; commit derby-6998-01-ab-tightenReturnType.diff.&lt;/p&gt;</comment>
                            <comment id="16499213" author="rhillegas" created="Sat, 2 Jun 2018 22:15:26 +0000"  >&lt;p&gt;Attaching derby-6998-02-aa-supportForJDK11.diff. This patch adds testing support for JDK 11. With this patch, Derby builds and tests cleanly on JDK 11.&lt;/p&gt;

&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;----------------------

M       java/build/org/apache/derbyBuild/lastgoodjarcontents/insane.derbyTesting.jar.lastcontents
M       java/build/org/apache/derbyBuild/lastgoodjarcontents/sane.derbyTesting.jar.lastcontents
M       java/testing/org/apache/derbyTesting/functionTests/harness/jdk100.java
A       java/testing/org/apache/derbyTesting/functionTests/harness/jdk110.java

Add a new jdk type to the test harness.

----------------------

M       java/testing/org/apache/derbyTesting/functionTests/harness/JavaVersionHolder.java

Recognize 11-ea as a valid JDK version.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16499214" author="jira-bot" created="Sat, 2 Jun 2018 22:17:17 +0000"  >&lt;p&gt;Commit 1832750 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhillegas&quot; class=&quot;user-hover&quot; rel=&quot;rhillegas&quot;&gt;rhillegas&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1832750&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1832750&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6998&quot; title=&quot;Make it possible to build Derby cleanly using JDK 10&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6998&quot;&gt;DERBY-6998&lt;/a&gt;: Add testing support for JDK 11; commit derby-6998-02-aa-supportForJDK11.diff.&lt;/p&gt;</comment>
                            <comment id="16629467" author="rhillegas" created="Wed, 26 Sep 2018 22:06:46 +0000"  >&lt;p&gt;Attaching derby-6998-03-aa-reenableEncryptionTestsOnJDK11.diff. This patch re-enables the old-harness encryption tests, which weren&apos;t running when the JVM was Java 11.&lt;/p&gt;

&lt;p&gt;The problem was that our test machinery was not parsing the JVM version correctly and thought that Java 11 came before Java 1.2.&lt;/p&gt;

&lt;p&gt;I am running regression tests now on Java 9. Even with this change, there is still an outstanding problem with Java 11: the JUnit SSLTest fails on that platform.&lt;/p&gt;


&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;----------------------------

M       java/org.apache.derby.tests/org/apache/derbyTesting/functionTests/harness/JavaVersionHolder.java

Use 1.10.0 as the version string for Java 10 and 1.11.0 as the version
string for Java 11 rather than 10.0.1 and 11.0.1 respectively.

----------------------------

M       java/build/org/apache/derbyBuild/lastgoodjarcontents/insane.derbyTesting.jar.lastcontents
M       java/build/org/apache/derbyBuild/lastgoodjarcontents/sane.derbyTesting.jar.lastcontents
D       java/org.apache.derby.tests/org/apache/derbyTesting/functionTests/harness/jdk100.java
R  +    java/org.apache.derby.tests/org/apache/derbyTesting/functionTests/harness/jdk110.java
A  +    java/org.apache.derby.tests/org/apache/derbyTesting/functionTests/harness/jdk111.java

Correspondingly rename jdk100 as jdk110 and rename jdk110 as jdk111.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16629560" author="jira-bot" created="Thu, 27 Sep 2018 00:16:29 +0000"  >&lt;p&gt;Commit 1842064 from rhillegas@apache.org in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1842064&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1842064&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6998&quot; title=&quot;Make it possible to build Derby cleanly using JDK 10&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6998&quot;&gt;DERBY-6998&lt;/a&gt;: Re-enable encryption tests when running on Java 11; tests passed cleanly on derby-6998-03-aa-reenableEncryptionTestsOnJDK11.diff.&lt;/p&gt;</comment>
                            <comment id="16636065" author="rhillegas" created="Tue, 2 Oct 2018 20:15:13 +0000"  >&lt;p&gt;Attaching sslHandshake.tar. The is a compact repro for the failure in SSLTest which is seen when you run under JDK 11. To reproduce the problem, unpack the tarball, cd to the root directory where you unpacked it, and following the instructions in the README file. Those instructions follow:&lt;/p&gt;

&lt;p&gt;SSL handshake succeeds under JDK 9 but not under JDK 11.&lt;/p&gt;

&lt;p&gt;To reproduce the bug, do the following:&lt;/p&gt;

&lt;p&gt;1) Cd to the directory where you unpacked this tarball.&lt;/p&gt;

&lt;p&gt;2) Set your environment to use JDK 9.&lt;/p&gt;

&lt;p&gt;3) Build the program as follows:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   ant jar
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;4) Now run the program successfully under JDK 9:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   ant runClientAndServer
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;5) Now switch your environment to use JDK 11.&lt;/p&gt;

&lt;p&gt;6) Observe that the program fails under JDK 11:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   ant runClientAndServer
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Here is the successful output of the program under JDK 9:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;     [java] Startup args = [startServer, startClient]
     [java] ServerThread starting...
     [java] Host address = localhost/127.0.0.1
     [java] ClientThread starting...
     [java] Host address = localhost/127.0.0.1
     [java] ServerThread successfully accepted connection request 0
     [java] ClientThread initiating handshake...
     [java] Hooray! Successfully shook the server&apos;s hand!
     [java] ClientThread exiting...
     [java] ServerThread read &apos;Hello, world!&apos; from the socket!
     [java] ServerThread exiting...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here is the output of the failed run under JDK 11:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;     [java] Startup args = [startServer, startClient]
     [java] ServerThread starting...
     [java] Host address = localhost/127.0.0.1
     [java] ClientThread starting...
     [java] Host address = localhost/127.0.0.1
     [java] ServerThread successfully accepted connection request 0
     [java] ClientThread initiating handshake...
     [java] Oops! Handshake failed!
     [java] Oops! Socket failed!javax.net.ssl.SSLHandshakeException: Received fatal alert: handshake_failure
     [java] 
     [java] ClientThread exiting...
     [java] 	at java.base/sun.security.ssl.Alert.createSSLException(Alert.java:128)
     [java] ServerThread exiting...
     [java] 	at java.base/sun.security.ssl.Alert.createSSLException(Alert.java:117)
     [java] 	at java.base/sun.security.ssl.TransportContext.fatal(TransportContext.java:308)
     [java] 	at java.base/sun.security.ssl.Alert$AlertConsumer.consume(Alert.java:279)
     [java] 	at java.base/sun.security.ssl.TransportContext.dispatch(TransportContext.java:181)
     [java] 	at java.base/sun.security.ssl.SSLTransport.decode(SSLTransport.java:164)
     [java] 	at java.base/sun.security.ssl.SSLSocketImpl.decode(SSLSocketImpl.java:1152)
     [java] 	at java.base/sun.security.ssl.SSLSocketImpl.readHandshakeRecord(SSLSocketImpl.java:1063)
     [java] 	at java.base/sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:402)
     [java] 	at tests.Test$ClientThread.run(Test.java:141)
     [java] javax.net.ssl.SSLHandshakeException: No available authentication scheme
     [java] 	at java.base/sun.security.ssl.Alert.createSSLException(Alert.java:128)
     [java] 	at java.base/sun.security.ssl.Alert.createSSLException(Alert.java:117)
     [java] 	at java.base/sun.security.ssl.TransportContext.fatal(TransportContext.java:308)
     [java] 	at java.base/sun.security.ssl.TransportContext.fatal(TransportContext.java:264)
     [java] 	at java.base/sun.security.ssl.TransportContext.fatal(TransportContext.java:255)
     [java] 	at java.base/sun.security.ssl.CertificateMessage$T13CertificateProducer.onProduceCertificate(CertificateMessage.java:945)
     [java] 	at java.base/sun.security.ssl.CertificateMessage$T13CertificateProducer.produce(CertificateMessage.java:934)
     [java] 	at java.base/sun.security.ssl.SSLHandshake.produce(SSLHandshake.java:436)
     [java] 	at java.base/sun.security.ssl.ClientHello$T13ClientHelloConsumer.goServerHello(ClientHello.java:1189)
     [java] 	at java.base/sun.security.ssl.ClientHello$T13ClientHelloConsumer.consume(ClientHello.java:1125)
     [java] 	at java.base/sun.security.ssl.ClientHello$ClientHelloConsumer.onClientHello(ClientHello.java:831)
     [java] 	at java.base/sun.security.ssl.ClientHello$ClientHelloConsumer.consume(ClientHello.java:792)
     [java] 	at java.base/sun.security.ssl.SSLHandshake.consume(SSLHandshake.java:392)
     [java] 	at java.base/sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:444)
     [java] 	at java.base/sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:421)
     [java] 	at java.base/sun.security.ssl.TransportContext.dispatch(TransportContext.java:178)
     [java] 	at java.base/sun.security.ssl.SSLTransport.decode(SSLTransport.java:164)
     [java] 	at java.base/sun.security.ssl.SSLSocketImpl.decode(SSLSocketImpl.java:1152)
     [java] 	at java.base/sun.security.ssl.SSLSocketImpl.readHandshakeRecord(SSLSocketImpl.java:1063)
     [java] 	at java.base/sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:402)
     [java] 	at java.base/sun.security.ssl.SSLSocketImpl.ensureNegotiated(SSLSocketImpl.java:716)
     [java] 	at java.base/sun.security.ssl.SSLSocketImpl$AppInputStream.read(SSLSocketImpl.java:799)
     [java] 	at tests.Test$ServerThread.run(Test.java:105)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;----------------------------------------&lt;/p&gt;

&lt;p&gt;The keystore/SSLTestServerKey.key file was generated as follows, using the JDK 9 keytool&lt;br/&gt;
program:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;keystore (1.9) &amp;gt; keytool -keystore SSLTestServerKey.key -genkey -alias mykey -startdate 2018/06/01 -validity 365000
keytool -keystore SSLTestServerKey.key -genkey -alias mykey -startdate 2018/06/01 -validity 365000
Enter keystore password:  qwerty

Re-enter new password: 
What is your first and last name?
  [Unknown]:  Rick Hillegas
Rick Hillegas
What is the name of your organizational unit?
  [Unknown]:  Apache Derby
Apache Derby
What is the name of your organization?
  [Unknown]:  Apache Derby
Apache Derby
What is the name of your City or Locality?
  [Unknown]:  San Francisco
San Francisco
What is the name of your State or Province?
  [Unknown]:  California
California
What is the two-letter country code for this unit?
  [Unknown]:  US
US
Is CN=Rick Hillegas, OU=Apache Derby, O=Apache Derby, L=San Francisco, ST=California, C=US correct?
  [no]:  yes
yes
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16636075" author="rhillegas" created="Tue, 2 Oct 2018 20:27:37 +0000"  >&lt;p&gt;I have logged a JDK bug with this provisional internal review ID : 9057492&lt;/p&gt;</comment>
                            <comment id="16636258" author="rhillegas" created="Wed, 3 Oct 2018 00:05:55 +0000"  >&lt;p&gt;Attaching derby-6998-04-aa-increaseCertificateLifetime.diff. This patch increases the lifetime of the certificate used by SSLTest. While investigating the failure of that test under JDK 11, I noticed that the certificate expired many years ago. I don&apos;t know whether the expired certificate is a real problem, but it looked goofy to me. This patch increases the certificate lifetime to 100 years.&lt;/p&gt;

&lt;p&gt;Tests passed cleanly for me with this patch on JDK 9.&lt;/p&gt;


&lt;p&gt;Touches the following file:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;----------------------------

M       java/org.apache.derby.tests/org/apache/derbyTesting/functionTests/tests/derbynet/SSLTestServerKey.key

Regenerate the keystore used for the SSLTest so that the certificate
has a long lifetime.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16637021" author="jira-bot" created="Wed, 3 Oct 2018 14:22:35 +0000"  >&lt;p&gt;Commit 1842727 from rhillegas@apache.org in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1842727&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1842727&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6998&quot; title=&quot;Make it possible to build Derby cleanly using JDK 10&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6998&quot;&gt;DERBY-6998&lt;/a&gt;: Increase the lifetime of the certificate used by SSLTTest; commit derby-6998-04-aa-increaseCertificateLifetime.diff.&lt;/p&gt;</comment>
                            <comment id="16637179" author="rhillegas" created="Wed, 3 Oct 2018 16:45:54 +0000"  >&lt;p&gt;A JDK bug has been opened to track the issue scripted by sslHandshake.tar: &lt;a href=&quot;https://bugs.openjdk.java.net/browse/JDK-8211426&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bugs.openjdk.java.net/browse/JDK-8211426&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16639122" author="bryanpendleton" created="Fri, 5 Oct 2018 01:14:38 +0000"  >&lt;p&gt;&amp;gt;  thought that Java 11 came before Java 1.2.&lt;/p&gt;

&lt;p&gt;Back to the future!&lt;/p&gt;

&lt;p&gt;Slightly more seriously: we still have code in the Derby codebase that changes its behavior relevant to JDK 1.2??!!!&lt;/p&gt;

&lt;p&gt;That was, what, 1995?&lt;/p&gt;

&lt;p&gt;Actually, Wikipedia says 1998: &lt;a href=&quot;https://en.wikipedia.org/wiki/Java_version_history&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://en.wikipedia.org/wiki/Java_version_history&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;At any rate, that&apos;s 20 years ago!&lt;/p&gt;</comment>
                            <comment id="16639139" author="rhillegas" created="Fri, 5 Oct 2018 01:34:02 +0000"  >&lt;p&gt;Good point. That code should be whacked since recent versions of Derby won&apos;t run on anything before Java 8. But I didn&apos;t take the time to whack the dead code--I just wanted the tests to run on Java 11. Cheers!&lt;/p&gt;</comment>
                            <comment id="16705983" author="rhillegas" created="Sat, 1 Dec 2018 20:15:11 +0000"  >&lt;p&gt;Attaching derby-6998-05-aa-use-java.specification.version.diff. This patch updates the test machinery so that the old harness tests run on Java 10.&lt;/p&gt;

&lt;p&gt;When trying to run the modulepath tests on Linux on Java 10, I discovered that the old harness tests no longer run on Java 10. The machinery for picking a JVM wrapper class is very brittle. It works for Java 9 and 11 but not for Java 10. The machinery tries to figure out the major/minor levels of the JVM in two separate places in two different ways. In one place the machinery parses these levels correctly by getting them from the system property java.specification.version. In the other place it gets the wrong answer for Java 10 when parsing the major/minor levels from the value of the system property java.version.&lt;/p&gt;

&lt;p&gt;I made both places use java.specification.version.&lt;/p&gt;

&lt;p&gt;If this brittle logic continues to plague us in the future, then I recommend that we rewrite it to be much simpler. This logic evolved over time to handle a lot of JVMs which we no longer support. That complexity is no longer needed.&lt;/p&gt;

&lt;p&gt;I will build and run tests on Java 9, 10, and 11 before checking in this fix.&lt;/p&gt;

&lt;p&gt;Touches the following file:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;M       java/org.apache.derby.tests/org/apache/derbyTesting/functionTests/harness/RunTest.java
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16706040" author="rhillegas" created="Sat, 1 Dec 2018 23:37:11 +0000"  >&lt;p&gt;Attaching derby-6998-05-ab-use-java.specification.version.diff. I found some more places where java.version needed to be replaced by java.specification.version.&lt;/p&gt;

&lt;p&gt;Touches the following additional files:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;M       java/org.apache.derby.tests/org/apache/derbyTesting/functionTests/harness/RunList.java
M       java/org.apache.derby.tests/org/apache/derbyTesting/functionTests/harness/RunSuite.java
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16706350" author="rhillegas" created="Sun, 2 Dec 2018 15:27:37 +0000"  >&lt;p&gt;Tests passed cleanly on derby-6998-05-ab-use-java.specification.version.diff. when built and run on JDK 9, 10, and 11 except for the two ssl handshake tests (see above) which fail on JDK 11.&lt;/p&gt;</comment>
                            <comment id="16706351" author="jira-bot" created="Sun, 2 Dec 2018 15:28:50 +0000"  >&lt;p&gt;Commit 1848004 from rhillegas@apache.org in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1848004&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1848004&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6998&quot; title=&quot;Make it possible to build Derby cleanly using JDK 10&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6998&quot;&gt;DERBY-6998&lt;/a&gt;: Make it possible to run old harness tests on JDK 10 again; commit derby-6998-05-ab-use-java.specification.version.diff.&lt;/p&gt;</comment>
                            <comment id="17216995" author="rhillegas" created="Mon, 19 Oct 2020 18:11:21 +0000"  >&lt;p&gt;The SSL bug in the JDK (&lt;a href=&quot;https://bugs.openjdk.java.net/browse/JDK-8211426&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bugs.openjdk.java.net/browse/JDK-8211426&lt;/a&gt;) was closed as WONT_FIX in 2018. We should disable these tests or adjust them to workaround this problem.&lt;/p&gt;</comment>
                            <comment id="17217183" author="bpendleton" created="Tue, 20 Oct 2020 01:01:37 +0000"  >&lt;p&gt;Your suggestion seems fine to me!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12931787">DERBY-6856</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13201804">DERBY-7021</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13336073">DERBY-7087</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12925470" name="derby-6998-01-ab-tightenReturnType.diff" size="7713" author="rhillegas" created="Mon, 28 May 2018 22:23:41 +0000"/>
                            <attachment id="12926256" name="derby-6998-02-aa-supportForJDK11.diff" size="6994" author="rhillegas" created="Sat, 2 Jun 2018 22:15:07 +0000"/>
                            <attachment id="12941451" name="derby-6998-03-aa-reenableEncryptionTestsOnJDK11.diff" size="10495" author="rhillegas" created="Wed, 26 Sep 2018 22:06:22 +0000"/>
                            <attachment id="12942212" name="derby-6998-04-aa-increaseCertificateLifetime.diff" size="264" author="rhillegas" created="Wed, 3 Oct 2018 00:05:32 +0000"/>
                            <attachment id="12950290" name="derby-6998-05-aa-use-java.specification.version.diff" size="739" author="rhillegas" created="Sat, 1 Dec 2018 20:14:53 +0000"/>
                            <attachment id="12950292" name="derby-6998-05-ab-use-java.specification.version.diff" size="4487" author="rhillegas" created="Sat, 1 Dec 2018 23:36:49 +0000"/>
                            <attachment id="12942180" name="sslHandshake.tar" size="27136" author="rhillegas" created="Tue, 2 Oct 2018 20:11:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 4 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3u8jr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>