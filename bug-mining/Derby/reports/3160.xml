<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 14:51:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DERBY-6962] Forbid ALTER TABLE ... SET CYCLE on identity columns in pre-10.11 databases</title>
                <link>https://issues.apache.org/jira/browse/DERBY-6962</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The&lt;/p&gt;

&lt;p&gt;  ALTER TABLE ALTER COLUMN $columnName SET CYCLE&lt;/p&gt;

&lt;p&gt;command does not raise an error even on identity columns in pre-10.12 databases. Those identity columns are not backed by sequence generators. Afterwards, the columns do not cycle, even though the ALTER TABLE command appeared to run successfully. This should be easy to fix. The parser just needs to forbid the ALTER TABLE...SET CYCLE command in pre-10.12 databases. The following scripts show this behavior:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;-- run the following script with version 10.10.1.1:
connect &apos;jdbc:derby:db;create=true&apos;;

create table t1(a int generated always as identity (start with 2147483646), b int);
insert into t1(b) values (1);
insert into t1(b) values (2);
-- fails as expected
insert into t1(b) values (3);

select * from t1 order by b;

create table t2(a int generated always as identity (start with 2147483646), b int);

-- now run the following script with 10.14
connect &apos;jdbc:derby:db&apos;;

-- succeeds but should not
alter table t2 alter column a set cycle;

insert into t2(b) values (1);
insert into t2(b) values (2);
-- fails because the cycling behavior did not change
insert into t2(b) values (3);

select * from t2 order by b;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13102778">DERBY-6962</key>
            <summary>Forbid ALTER TABLE ... SET CYCLE on identity columns in pre-10.11 databases</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rhillegas">Richard N. Hillegas</assignee>
                                    <reporter username="rhillegas">Richard N. Hillegas</reporter>
                        <labels>
                    </labels>
                <created>Sat, 16 Sep 2017 15:51:12 +0000</created>
                <updated>Sun, 17 Sep 2017 15:31:52 +0000</updated>
                            <resolved>Sun, 17 Sep 2017 15:31:44 +0000</resolved>
                                    <version>10.14.1.0</version>
                                    <fixVersion>10.14.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16169042" author="rhillegas" created="Sat, 16 Sep 2017 20:15:33 +0000"  >&lt;p&gt;Attaching derby-6962-01-aa-forbidSetCycleOn10_10.diff. This patch prevents changes to the cycling behavior of identity columns in soft-upgraded databases at level 10.10 and earlier. The upgrade tests ran cleanly against the following releases:&lt;/p&gt;

&lt;p&gt;  10.1.1.0&lt;br/&gt;
  10.1.2.1&lt;br/&gt;
  10.1.3.1&lt;br/&gt;
  10.2.1.6&lt;br/&gt;
  10.2.2.0&lt;br/&gt;
  10.2.2.1&lt;br/&gt;
  10.3.3.0&lt;br/&gt;
  10.4.1.3&lt;br/&gt;
  10.4.2.0&lt;br/&gt;
  10.4.2.1&lt;br/&gt;
  10.5.1.1&lt;br/&gt;
  10.5.3.0&lt;br/&gt;
  10.6.1.0&lt;br/&gt;
  10.6.2.1&lt;br/&gt;
  10.7.1.1&lt;br/&gt;
  10.8.1.2&lt;br/&gt;
  10.8.2.2&lt;br/&gt;
  10.9.1.0&lt;br/&gt;
  10.10.1.1&lt;br/&gt;
  10.10.1.2&lt;br/&gt;
  10.10.1.3&lt;br/&gt;
  10.10.2.0&lt;br/&gt;
  10.11.1.1&lt;br/&gt;
  10.12.1.1&lt;br/&gt;
  10.13.1.1&lt;/p&gt;

&lt;p&gt;I will run full regression tests now.&lt;/p&gt;

&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;----------------------&lt;/p&gt;

&lt;p&gt;M       java/engine/org/apache/derby/impl/sql/compile/sqlgrammar.jj&lt;/p&gt;

&lt;p&gt;Raise an error at parse time if someone tries to change the cycling behavior of an identity column in a database at level 10.10 or earlier.&lt;/p&gt;

&lt;p&gt;----------------------&lt;/p&gt;

&lt;p&gt;M       java/testing/org/apache/derbyTesting/functionTests/tests/upgradeTests/Changes10_13.java&lt;/p&gt;

&lt;p&gt;Upgrade test for this change.&lt;/p&gt;</comment>
                            <comment id="16169126" author="bryanpendleton" created="Sat, 16 Sep 2017 22:50:24 +0000"  >&lt;p&gt;Thanks Rick!&lt;/p&gt;

&lt;p&gt;The only tiny, tiny nit I see is that the title of this JIRA issue says &quot;pre-10.12 databases&quot;, but it seems like the actual behavior is such that the JIRA issue should be edited to read &quot;pre-10.11 databases&quot;.&lt;/p&gt;

&lt;p&gt;The actual patch itself looks great.&lt;/p&gt;</comment>
                            <comment id="16169136" author="rhillegas" created="Sat, 16 Sep 2017 23:47:04 +0000"  >&lt;p&gt;Attaching derby-6962-01-ab-forbidSetCycleOn10_10.diff. Tests passed cleanly on the previous patch, but I realized that the new test belonged in a new, 10.14-specific test class. The new patch has been tested against the same battery of old releases. I am running full tests again.&lt;/p&gt;

&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;-------------------------&lt;/p&gt;

&lt;p&gt;M       java/engine/org/apache/derby/impl/sql/compile/sqlgrammar.jj&lt;/p&gt;

&lt;p&gt;Parser changes, as before.&lt;/p&gt;

&lt;p&gt;-------------------------&lt;/p&gt;

&lt;p&gt;M       java/build/org/apache/derbyBuild/lastgoodjarcontents/insane.derbyTesting.jar.lastcontents&lt;br/&gt;
M       java/build/org/apache/derbyBuild/lastgoodjarcontents/sane.derbyTesting.jar.lastcontents&lt;br/&gt;
A       java/testing/org/apache/derbyTesting/functionTests/tests/upgradeTests/Changes10_14.java&lt;br/&gt;
M       java/testing/org/apache/derbyTesting/functionTests/tests/upgradeTests/UpgradeRun.java&lt;/p&gt;

&lt;p&gt;New class to hold the new tests.&lt;/p&gt;</comment>
                            <comment id="16169137" author="rhillegas" created="Sat, 16 Sep 2017 23:48:31 +0000"  >&lt;p&gt;Thanks for catching that,  Bryan. I am updating the title on this issue as you recommended.&lt;/p&gt;</comment>
                            <comment id="16169168" author="rhillegas" created="Sun, 17 Sep 2017 01:58:43 +0000"  >&lt;p&gt;Tests passed cleanly on derby-6962-01-ab-forbidSetCycleOn10_10.diff.&lt;/p&gt;</comment>
                            <comment id="16169170" author="jira-bot" created="Sun, 17 Sep 2017 02:00:01 +0000"  >&lt;p&gt;Commit 1808600 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhillegas&quot; class=&quot;user-hover&quot; rel=&quot;rhillegas&quot;&gt;rhillegas&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1808600&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1808600&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6962&quot; title=&quot;Forbid ALTER TABLE ... SET CYCLE on identity columns in pre-10.11 databases&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6962&quot;&gt;&lt;del&gt;DERBY-6962&lt;/del&gt;&lt;/a&gt;: Forbid attempts to change the cycling behavior of identity columns in pre-10.11 databases; commit derby-6962-01-ab-forbidSetCycleOn10_10.diff.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12997160">DERBY-6904</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12887519" name="derby-6962-01-aa-forbidSetCycleOn10_10.diff" size="6257" author="rhillegas" created="Sat, 16 Sep 2017 20:14:57 +0000"/>
                            <attachment id="12887526" name="derby-6962-01-ab-forbidSetCycleOn10_10.diff" size="11161" author="rhillegas" created="Sat, 16 Sep 2017 23:46:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 9 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3k5ov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10050"><![CDATA[Blocker]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>