<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 14:16:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DERBY-3258] &apos;Unexpected row count: expected:&lt;0&gt; but was:&lt;3&gt;&apos; in testReleaseCompileLocks</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3258</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Seen in &lt;a href=&quot;http://dbtg.thresher.com/derby/test/trunk16/jvmAll/testing/Limited/testSummary-601462.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://dbtg.thresher.com/derby/test/trunk16/jvmAll/testing/Limited/testSummary-601462.html&lt;/a&gt; : JDK16Jvm1.6SunOS-5.11 i86pc-i386.&lt;/p&gt;

&lt;p&gt;There was 1 failure:&lt;br/&gt;
1) testReleaseCompileLocks(org.apache.derbyTesting.functionTests.tests.lang.ReleaseCompileLocksTest)junit.framework.AssertionFailedError: Unexpected row count: expected:&amp;lt;0&amp;gt; but was:&amp;lt;3&amp;gt;&lt;br/&gt;
	at org.apache.derbyTesting.junit.JDBC.assertDrainResults(JDBC.java:596)&lt;br/&gt;
	at org.apache.derbyTesting.junit.JDBC.assertEmpty(JDBC.java:490)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.ReleaseCompileLocksTest.testReleaseCompileLocks(ReleaseCompileLocksTest.java:146)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;/p&gt;
</description>
                <environment>OS: Solaris Nevada snv_27a X86 64 bits - SunOS 5.11 snv_27&lt;br/&gt;
VJM: Sun Microsystems Inc. 1.6.0-b105</environment>
        <key id="12384084">DERBY-3258</key>
            <summary>&apos;Unexpected row count: expected:&lt;0&gt; but was:&lt;3&gt;&apos; in testReleaseCompileLocks</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="olesolberg">Ole Solberg</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Dec 2007 15:30:59 +0000</created>
                <updated>Mon, 17 Jun 2013 09:19:25 +0000</updated>
                            <resolved>Thu, 2 Dec 2010 11:48:23 +0000</resolved>
                                    <version>10.4.1.3</version>
                                    <fixVersion>10.7.1.4</fixVersion>
                    <fixVersion>10.8.1.2</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12706534" author="myrna" created="Wed, 6 May 2009 17:46:31 +0000"  >&lt;p&gt;I saw what I take to be a variation on this with 10.5.1.2 built at revision 772042 on windows: &lt;br/&gt;
(org.apache.derbyTesting.functionTests.tests.lang.ReleaseCompileLocksTest)junit.framework.AssertionFailedError: Unexpected row count: expected:&amp;lt;0&amp;gt; but was:&amp;lt;1&amp;gt;&lt;br/&gt;
	at org.apache.derbyTesting.junit.JDBC.assertDrainResults(JDBC.java:640)&lt;br/&gt;
	at org.apache.derbyTesting.junit.JDBC.assertEmpty(JDBC.java:492)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.ReleaseCompileLocksTest.testReleaseCompileLocks(ReleaseCompileLocksTest.java:120)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:105)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;/p&gt;</comment>
                            <comment id="12889538" author="dagw" created="Sat, 17 Jul 2010 21:53:24 +0000"  >&lt;p&gt;I just saw this on trunk on OpenSolaris svn_142, in the variant similar to what Myrna did, but mine failed on the assert on line 146 rather than on line 120. It appeared when I ran the test in Knut&apos;s parallel tester using 6 threads on my dual core laptop (Lenovo T61p, 4Gb ram).&lt;br/&gt;
When running th test standalone I do not see the error.&lt;/p&gt;

&lt;p&gt;junit.framework.AssertionFailedError: Unexpected row count: expected:&amp;lt;0&amp;gt; but was:&amp;lt;1&amp;gt;&lt;br/&gt;
at junit.framework.Assert.fail(Assert.java:47)&lt;br/&gt;
at junit.framework.Assert.failNotEquals(Assert.java:280)&lt;br/&gt;
at junit.framework.Assert.assertEquals(Assert.java:64)&lt;br/&gt;
at junit.framework.Assert.assertEquals(Assert.java:198)&lt;br/&gt;
at org.apache.derbyTesting.junit.JDBC.assertDrainResults(JDBC.java:674)&lt;br/&gt;
at org.apache.derbyTesting.junit.JDBC.assertEmpty(JDBC.java:526)&lt;br/&gt;
at org.apache.derbyTesting.functionTests.tests.lang.ReleaseCompileLocksTest.testReleaseCompileLocks(ReleaseCompileLocksTest.java:146)&lt;br/&gt;
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
:&lt;/p&gt;</comment>
                            <comment id="12889828" author="knutanders" created="Mon, 19 Jul 2010 11:46:19 +0000"  >&lt;p&gt;This instability may have the same root cause as &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4211&quot; title=&quot;&amp;#39;derbyall/encryptionAll/storemats.fail:store/updatelocksJDBC30.sql&amp;#39; fails with unexpected locks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4211&quot;&gt;&lt;del&gt;DERBY-4211&lt;/del&gt;&lt;/a&gt;, where the background thread hadn&apos;t finished post commit cleanup and locks on committed deleted rows could appear in the lock table dump. The fix in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4211&quot; title=&quot;&amp;#39;derbyall/encryptionAll/storemats.fail:store/updatelocksJDBC30.sql&amp;#39; fails with unexpected locks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4211&quot;&gt;&lt;del&gt;DERBY-4211&lt;/del&gt;&lt;/a&gt; was to wait for the post commit work to be completed before querying the lock table.&lt;/p&gt;</comment>
                            <comment id="12965826" author="knutanders" created="Wed, 1 Dec 2010 20:11:50 +0000"  >&lt;p&gt;I am able to reproduce this fairly quickly in my environment if I start five threads running this test in a loop. Most of the time it&apos;s the assert on line 146 that fails, but sometimes it&apos;s the assert on line 140.&lt;/p&gt;

&lt;p&gt;With the attached patch, which makes the test wait for the post commit thread to complete before it queries the lock table, I&apos;m not able to reproduce the failure anymore.&lt;/p&gt;</comment>
                            <comment id="12965860" author="dagw" created="Wed, 1 Dec 2010 21:47:51 +0000"  >&lt;p&gt;Looks like clean and good solution to me. +1&lt;/p&gt;</comment>
                            <comment id="12966074" author="knutanders" created="Thu, 2 Dec 2010 11:48:23 +0000"  >&lt;p&gt;Thanks, Dag!&lt;/p&gt;

&lt;p&gt;Committed revision 1041338.&lt;/p&gt;

&lt;p&gt;Also backported to 10.7 and committed revision 1041339.&lt;/p&gt;</comment>
                            <comment id="13685237" author="knutanders" created="Mon, 17 Jun 2013 09:19:25 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bulk update&amp;#93;&lt;/span&gt; Close all resolved issues that haven&apos;t been updated for more than one year.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12537350">DERBY-5568</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12465064" name="d3258.diff" size="5608" author="knutanders" created="Wed, 1 Dec 2010 20:11:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23527</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 23 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i06jr3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36134</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>