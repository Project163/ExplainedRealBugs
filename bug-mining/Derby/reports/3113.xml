<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 14:50:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DERBY-6788] Wrong value inserted by INSERT INTO with multiple subselects</title>
                <link>https://issues.apache.org/jira/browse/DERBY-6788</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Certain INSERT INTO statements with multiple subselects insert wrong values, i.e. may lead to data corruption.&lt;/p&gt;

&lt;p&gt;Here is a very simple example how to reproduce this bug: Start with a new (empty) Derby database, create 3 tiny tables, and insert two records:&lt;/p&gt;

&lt;p&gt;create table m1 (k varchar(64), s decimal);&lt;br/&gt;
create table m2 (k varchar(64), s decimal);&lt;br/&gt;
create table v (s decimal);&lt;/p&gt;

&lt;p&gt;insert into m1 values (&apos;Bug&apos;, 2015);&lt;br/&gt;
insert into m2 values (&apos;Bug&apos;, 1957);&lt;/p&gt;

&lt;p&gt;Now, the following (likewise simple) select&lt;/p&gt;

&lt;p&gt;select res.* from (select d2.s from m1&lt;br/&gt;
left join (select k,s from m2) as d2 on m1.k=d2.k) as res&lt;/p&gt;

&lt;p&gt;yields 1957, of course. - Of course? Not entirely: If I add an INSERT INTO to that select, i.e.&lt;/p&gt;

&lt;p&gt;insert into v (select res.* from (select d2.s from m1&lt;br/&gt;
left join (select k,s from m2) as d2 on m1.k=d2.k) as res)&lt;/p&gt;

&lt;p&gt;then table v contains 1 row (as it should), but in this row s=4,355,431. This value is interesting, because 4355431 = Hex 427567 and &apos;B&apos; = X42, &apos;u&apos;=X75, &apos;g&apos;=X67.&lt;/p&gt;

&lt;p&gt;Finally, if I slightly modify the INSERT INTO above as&lt;/p&gt;

&lt;p&gt;insert into v (select res.* from (select d2.s*1 from m1&lt;br/&gt;
left join (select k,s from m2) as d2 on m1.k=d2.k) as res)&lt;/p&gt;

&lt;p&gt;then it works correct.&lt;/p&gt;

&lt;p&gt;This phenomenon arose with every Derby version 10.x I tried (see list above).&lt;/p&gt;

&lt;p&gt;Possibly this bug is related to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6786&quot; title=&quot;NullPointerException in INSERT INTO statement with multiple subselects&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6786&quot;&gt;DERBY-6786&lt;/a&gt;, where similar INSERT INTOs with subselects appear.&lt;/p&gt;

&lt;p&gt;Addendum: There is indeed a close relationship between &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6786&quot; title=&quot;NullPointerException in INSERT INTO statement with multiple subselects&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6786&quot;&gt;DERBY-6786&lt;/a&gt; and this one: Let&apos;s denote by SQL1 the first INSERT INTO above, by SQL2 the second one, i.e.&lt;/p&gt;

&lt;p&gt;SQL1 = insert into v (select res.* from (select d2.s from m1 left join (select k,s from m2) as d2 on m1.k=d2.k) as res)&lt;br/&gt;
SQL2 = insert into v (select res.* from (select d2.s*1 from m1 left join (select k,s from m2) as d2 on m1.k=d2.k) as res)&lt;/p&gt;

&lt;p&gt;We further assume that there are exactly 1 record R1 in table M1 and exactly 1 record R2 in table M2, both without NULL-values. Then:&lt;/p&gt;

&lt;p&gt;If R1.k is equal to R2.k, then SQL1 -&amp;gt; data corruption, SQL2 -&amp;gt; correct.&lt;br/&gt;
If R1.k is not equal to R2.k, then SQL1 -&amp;gt; correct, SQL2 -&amp;gt; NullPointerException.&lt;/p&gt;</description>
                <environment>not relevant, tested under Windows 7 32bit</environment>
        <key id="12765980">DERBY-6788</key>
            <summary>Wrong value inserted by INSERT INTO with multiple subselects</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="mac777">Abhinav Gupta</assignee>
                                    <reporter username="foco-mste">Manfred Steinsiek</reporter>
                        <labels>
                    </labels>
                <created>Fri, 9 Jan 2015 09:44:57 +0000</created>
                <updated>Sun, 30 Aug 2015 14:50:24 +0000</updated>
                                            <version>10.1.1.0</version>
                    <version>10.2.2.0</version>
                    <version>10.3.3.0</version>
                    <version>10.4.2.0</version>
                    <version>10.5.3.0</version>
                    <version>10.6.2.1</version>
                    <version>10.7.1.1</version>
                    <version>10.8.2.2</version>
                    <version>10.9.1.0</version>
                    <version>10.10.2.0</version>
                    <version>10.11.1.1</version>
                                                    <component>SQL</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14287887" author="jira-bot" created="Thu, 22 Jan 2015 18:13:39 +0000"  >&lt;p&gt;Commit 1653986 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mamtas&quot; class=&quot;user-hover&quot; rel=&quot;mamtas&quot;&gt;mamtas&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1653986&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1653986&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6788&quot; title=&quot;Wrong value inserted by INSERT INTO with multiple subselects&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6788&quot;&gt;DERBY-6788&lt;/a&gt;(Wrong value inserted by INSERT INTO with multiple subselects)&lt;/p&gt;

&lt;p&gt;Adding a junit test case for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6788&quot; title=&quot;Wrong value inserted by INSERT INTO with multiple subselects&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6788&quot;&gt;DERBY-6788&lt;/a&gt;. This bug might be related to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6786&quot; title=&quot;NullPointerException in INSERT INTO statement with multiple subselects&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6786&quot;&gt;DERBY-6786&lt;/a&gt;(NullPointerException in INSERT INTO statement with  multiple subselects)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10364"><![CDATA[Data corruption]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10424"><![CDATA[Repro attached]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 43 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2446v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>