<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 13:35:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DERBY-2502] Unclosed ResultSets choke JUnit lang _Suite on java 6</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2502</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The lang suite fail for me from UnaryArithmeticParameterTest on. The tests can&apos;t drop table T1 because a ResultSet is open. &lt;/p&gt;</description>
                <environment>solaris, java 6 build 105, insane+debug jars</environment>
        <key id="12366142">DERBY-2502</key>
            <summary>Unclosed ResultSets choke JUnit lang _Suite on java 6</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="rhillegas">Richard N. Hillegas</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Mar 2007 16:58:46 +0000</created>
                <updated>Tue, 15 May 2007 21:29:35 +0000</updated>
                            <resolved>Tue, 10 Apr 2007 15:55:10 +0000</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>SQL</component>
                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12485253" author="rhillegas" created="Thu, 29 Mar 2007 17:02:29 +0000"  >&lt;p&gt;Attaching a patch which closes ResultSets after pawing through them. The patch allows the lang suite to run cleanly in this environment. I&apos;m going to run the full JUnit test suite now.&lt;/p&gt;

&lt;p&gt;If the tests pass, I&apos;m inclined to check in this patch. I think that we still need to understand why this particular combination of jvm and built jars shows this error but other combinations don&apos;t.&lt;/p&gt;</comment>
                            <comment id="12485386" author="rhillegas" created="Fri, 30 Mar 2007 00:05:33 +0000"  >&lt;p&gt;Committed derby-2502-01.diff at subversion revision 523887. JUnit tests pass cleanly for me under jdk1.4. Under 1.6 with insane+debug jars, I see the following error. I also see this error in that environment even without this change when I run the jdbcapi JUnit suite:&lt;/p&gt;

&lt;p&gt;1) testIsolation(org.apache.derbyTesting.functionTests.tests.jdbcapi.SetTransactionIsolationTest)java.sql.SQLException: Invalid transaction state - held cursor requires same isolation level&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:95)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Util.java:202)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:380)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:345)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:1511)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.setTransactionIsolation(EmbedConnection.java:1365)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.jdbcapi.SetTransactionIsolationTest.checkIsolationLevelTimeout(SetTransactionIsolationTest.java:78)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.jdbcapi.SetTransactionIsolationTest.testIsolation(SetTransactionIsolationTest.java:57)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
Caused by: java.sql.SQLException: Invalid transaction state - held cursor requires same isolation level&lt;br/&gt;
	at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:295)&lt;br/&gt;
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.setIsolationLevel(GenericLanguageConnectionContext.java:2397)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.setTransactionIsolation(EmbedConnection.java:1363)&lt;br/&gt;
	... 28 more&lt;/p&gt;

</comment>
                            <comment id="12486723" author="army" created="Wed, 4 Apr 2007 18:01:57 +0000"  >&lt;p&gt;The patch committed for this issue (derby-2502-01.diff, committed with svn # 523887) is causing a failure in the lang/XMLTypeAndOpsTest.  The failure occurs because the testAttrSerialization() fixture tries to getWarnings() on the result set after checking the results, but with derby-2502-01.diff the result set is now closed, hence an error when trying to &quot;getWarnings()&quot;.&lt;/p&gt;

&lt;p&gt;This particular assertion of the warning is not critical to the test, it&apos;s just something that came over from the .sql test.  Nonetheless, it worked before svn # 523887 and fails after.&lt;/p&gt;

&lt;p&gt;This has not been showing up in the tinderbox tests because tinderbox runs with Sun JDKs, which do not include the requisite version of Xalan and thus the XML tests are implicitly disabled.&lt;/p&gt;</comment>
                            <comment id="12486734" author="rhillegas" created="Wed, 4 Apr 2007 18:30:50 +0000"  >&lt;p&gt;Thanks, Army. Do you have a recommendation about what to do here. E.g.:&lt;/p&gt;

&lt;p&gt;1) Revert the patch so that testAttrSerialization continues to work but the lang suite goes back to choking in certain environment.&lt;/p&gt;

&lt;p&gt;2) Revise testAttrSerialiation so that it doesn&apos;t assert a warning which is not critical to that test.&lt;/p&gt;</comment>
                            <comment id="12486736" author="army" created="Wed, 4 Apr 2007 18:41:30 +0000"  >&lt;p&gt;Maybe&lt;/p&gt;

&lt;p&gt;3) Add another (optional) argument to the assertResultSet methods to allow a caller to skip the close.  Then the caller is responsible for closing the result set explicitly...?&lt;/p&gt;</comment>
                            <comment id="12486737" author="djd" created="Wed, 4 Apr 2007 18:42:09 +0000"  >&lt;p&gt;3) Have a variation of the method that looks at result sets that does not close the result set.&lt;/p&gt;

&lt;p&gt;4) Have a variation of the method that looks at result sets provide the ability to check for warnings or return warnings.&lt;/p&gt;

&lt;p&gt;Would actually be interesting to have these generic result set methods assert that there are no warnings to ensure we are not getting stray warnings.&lt;/p&gt;</comment>
                            <comment id="12487072" author="rhillegas" created="Thu, 5 Apr 2007 18:36:41 +0000"  >&lt;p&gt;Committed derby-2502-02.diff at subversion revision 525924. This fixes the error in XMLTypeAndOpsTest introduced by the previous patch. Touches the following files:&lt;/p&gt;

&lt;p&gt;M      java/testing/org/apache/derbyTesting/junit/JDBC.java&lt;/p&gt;

&lt;p&gt;   Adds a new overload for assertFullResultSet() for callers who don&apos;t want to close the ResultSet.&lt;/p&gt;

&lt;p&gt;M      java/testing/org/apache/derbyTesting/functionTests/tests/lang/XMLTypeAndOpsTest.java&lt;/p&gt;

&lt;p&gt;   Uses the new overload.&lt;/p&gt;

&lt;p&gt;The full JUnit suite ran cleanly except for an error in GroupByExpressionTest--that error occurs even without this patch:&lt;/p&gt;

&lt;p&gt;1) testMiscExpressions(org.apache.derbyTesting.functionTests.tests.lang.GroupByExpressionTest)java.sql.SQLException: The SELECT list of a grouped query contains at least one invalid expression. If a SELECT list has a GROUP BY, the list may only contain valid grouping expressions and valid aggregate expressions.  &lt;br/&gt;
	at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:295)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.VerifyAggregateExpressionsVisitor.visit(VerifyAggregateExpressionsVisitor.java:85)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.QueryTreeNode.accept(QueryTreeNode.java:660)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.CastNode.accept(CastNode.java:1017)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.ResultColumn.accept(ResultColumn.java:1518)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.QueryTreeNodeVector.accept(QueryTreeNodeVector.java:158)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.SelectNode.bindExpressions(SelectNode.java:544)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindExpressions(DMLStatementNode.java:227)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(DMLStatementNode.java:140)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(CursorNode.java:236)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(GenericStatement.java:314)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericStatement.prepare(GenericStatement.java:88)&lt;br/&gt;
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(GenericLanguageConnectionContext.java:742)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.&amp;lt;init&amp;gt;(EmbedPreparedStatement.java:129)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement20.&amp;lt;init&amp;gt;(EmbedPreparedStatement20.java:82)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement30.&amp;lt;init&amp;gt;(EmbedPreparedStatement30.java:63)&lt;br/&gt;
	at org.apache.derby.jdbc.Driver30.newEmbedPreparedStatement(Driver30.java:93)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(EmbedConnection.java:871)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(EmbedConnection.java:715)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestCase.prepareStatement(BaseJDBCTestCase.java:146)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.GroupByExpressionTest.verifyQueryResults(GroupByExpressionTest.java:423)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.GroupByExpressionTest.testMiscExpressions(GroupByExpressionTest.java:159)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;/p&gt;

</comment>
                            <comment id="12487075" author="army" created="Thu, 5 Apr 2007 18:47:43 +0000"  >&lt;p&gt;I verified that lang/XMLTypeAndOpsTest is now running cleanly again.  Thank you for addressing this so quickly, Rick. And thanks also for the update to the wiki page!&lt;/p&gt;</comment>
                            <comment id="12487079" author="rhillegas" created="Thu, 5 Apr 2007 19:18:58 +0000"  >&lt;p&gt;Committed derby-2503-03.diff at subversion revision 525933:&lt;/p&gt;

&lt;p&gt;M      java/testing/org/apache/derbyTesting/junit/XML.java&lt;/p&gt;

&lt;p&gt;  Added a header comment exlaining how to configure your environment so that the XML tests run.&lt;/p&gt;

&lt;p&gt;M      java/testing/org/apache/derbyTesting/junit/BaseJDBCTestCase.java&lt;/p&gt;

&lt;p&gt;  Fixed a javadoc warning while I was in there.&lt;/p&gt;</comment>
                            <comment id="12487801" author="rhillegas" created="Tue, 10 Apr 2007 15:55:10 +0000"  >&lt;p&gt;I believe that this issue is fixed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12354535" name="derby-2502-01.diff" size="1537" author="rhillegas" created="Thu, 29 Mar 2007 17:02:29 +0000"/>
                            <attachment id="12355028" name="derby-2502-02.diff" size="3909" author="rhillegas" created="Thu, 5 Apr 2007 18:36:41 +0000"/>
                            <attachment id="12355032" name="derby-2502-03.diff" size="2222" author="rhillegas" created="Thu, 5 Apr 2007 19:18:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23076</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 34 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i077nj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40006</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>