<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 14:50:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DERBY-5605] Calling Blob/Clob free() explicitly after implicit free throws exception in client driver</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5605</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;If a Blob or Clob is freed implicitly in the client driver, calling free explicitly afterwards will throw an exception. Instead, this should probably be a no-op.&lt;/p&gt;

&lt;p&gt;To reproduce, do something like this:&lt;br/&gt;
    con.setAutoCommit(false);&lt;br/&gt;
    Clob c = con.createClob();&lt;br/&gt;
    con.commit();&lt;br/&gt;
    c.free();&lt;/p&gt;

&lt;p&gt;==&amp;gt;&lt;br/&gt;
Caused by: org.apache.derby.client.am.SqlException: You cannot invoke other java.sql.Clob/java.sql.Blob methods after calling the free() method or after the Blob/Clob&apos;s transaction has been committed or rolled back.&lt;br/&gt;
        at org.apache.derby.client.am.CallableLocatorProcedures.handleInvalidLocator(CallableLocatorProcedures.java:1071)&lt;br/&gt;
        at org.apache.derby.client.am.CallableLocatorProcedures.clobReleaseLocator(CallableLocatorProcedures.java:664)&lt;br/&gt;
        at org.apache.derby.client.am.Clob.free(Clob.java:844)&lt;br/&gt;
        ... 38 more&lt;br/&gt;
Caused by: org.apache.derby.client.am.SqlException: The exception &apos;java.sql.SQLException: The locator that was supplied for this CLOB/BLOB is invalid&apos; was thrown while evaluating an expression.&lt;br/&gt;
        at org.apache.derby.client.am.Statement.completeExecute(Statement.java:1604)&lt;br/&gt;
        at org.apache.derby.client.net.NetStatementReply.parseEXCSQLSTTreply(NetStatementReply.java:322)&lt;br/&gt;
        at org.apache.derby.client.net.NetStatementReply.readExecuteCall(NetStatementReply.java:106)&lt;br/&gt;
        at org.apache.derby.client.net.StatementReply.readExecuteCall(StatementReply.java:75)&lt;br/&gt;
        at org.apache.derby.client.net.NetStatement.readExecuteCall_(NetStatement.java:175)&lt;br/&gt;
        at org.apache.derby.client.am.Statement.readExecuteCall(Statement.java:1570)&lt;br/&gt;
        at org.apache.derby.client.am.PreparedStatement.flowExecute(PreparedStatement.java:2156)&lt;br/&gt;
        at org.apache.derby.client.am.PreparedStatement.executeX(PreparedStatement.java:1599)&lt;br/&gt;
        at org.apache.derby.client.am.CallableLocatorProcedures.clobReleaseLocator(CallableLocatorProcedures.java:662)&lt;br/&gt;
        ... 39 more&lt;br/&gt;
Caused by: org.apache.derby.client.am.SqlException: The locator that was supplied for this CLOB/BLOB is invalid&lt;br/&gt;
        ... 48 more&lt;/p&gt;

&lt;p&gt;The problem dosen&apos;t exist in the embedded driver.&lt;br/&gt;
The immediate cause seems to be that the client driver state becomes out of sync with the server side. This may be fixable by dealing specifically witht the invalid locator exception in free().&lt;/p&gt;</description>
                <environment></environment>
        <key id="12541420">DERBY-5605</key>
            <summary>Calling Blob/Clob free() explicitly after implicit free throws exception in client driver</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kmarsden">Katherine Marsden</assignee>
                                    <reporter username="kristwaa">Kristian Waagan</reporter>
                        <labels>
                            <label>derby_triage10_11</label>
                            <label>derby_triage10_9</label>
                    </labels>
                <created>Mon, 6 Feb 2012 14:41:28 +0000</created>
                <updated>Fri, 9 Sep 2016 09:51:57 +0000</updated>
                            <resolved>Mon, 19 Oct 2015 20:44:54 +0000</resolved>
                                    <version>10.9.1.0</version>
                                    <fixVersion>10.13.1.0</fixVersion>
                                    <component>Network Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13209904" author="kmarsden" created="Fri, 17 Feb 2012 00:12:33 +0000"  >&lt;p&gt;Triage for 10.9.   Moved priority from trivial to minor as I think it could be hit by applications expecting this to work.&lt;/p&gt;</comment>
                            <comment id="14959375" author="kmarsden" created="Thu, 15 Oct 2015 18:34:37 +0000"  >&lt;p&gt;Attached is a patch and new test for this issue.  This changes CLOBRELEASELOCATOR so that it does not throw an exception if the Clob has already been released.&lt;/p&gt;</comment>
                            <comment id="14959583" author="kmarsden" created="Thu, 15 Oct 2015 20:44:29 +0000"  >&lt;p&gt;Unchecking patch available.  Looks like Blob has the same problem. I will post a patch that has a fix for both Clob and Blob.&lt;/p&gt;</comment>
                            <comment id="14960860" author="kmarsden" created="Fri, 16 Oct 2015 15:11:25 +0000"  >&lt;p&gt;Here is the updated patch.  Suites.All and derbyall passed. Please review.&lt;/p&gt;</comment>
                            <comment id="14961584" author="bryanpendleton" created="Sat, 17 Oct 2015 00:34:47 +0000"  >&lt;p&gt;Looks great! The new tests fail as I expected without the code change, and&lt;br/&gt;
pass as I expected with the code change applied. I also read through the&lt;br/&gt;
diff, and both the code and test diffs are simple and clear.&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14963488" author="jira-bot" created="Mon, 19 Oct 2015 15:41:05 +0000"  >&lt;p&gt;Commit 1709431 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kmarsden&quot; class=&quot;user-hover&quot; rel=&quot;kmarsden&quot;&gt;kmarsden&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1709431&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1709431&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5605&quot; title=&quot;Calling Blob/Clob free() explicitly after implicit free throws exception in client driver&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5605&quot;&gt;&lt;del&gt;DERBY-5605&lt;/del&gt;&lt;/a&gt; Calling Blob/Clob free() explicitly after implicit free throws exception in client driver.&lt;br/&gt;
Changed stored  procedures to noop if the locator is already freed.&lt;/p&gt;</comment>
                            <comment id="14964023" author="kmarsden" created="Mon, 19 Oct 2015 20:44:54 +0000"  >&lt;p&gt;Thanks Bryan for the review. Committed the change and resolving this issue.&lt;/p&gt;</comment>
                            <comment id="15476547" author="knutanders" created="Fri, 9 Sep 2016 09:51:57 +0000"  >&lt;p&gt;[ Automatically closing all resolved issues that haven&apos;t been updated in more than six months. ]&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12767084" name="derby-5605_diff.txt" size="3289" author="kmarsden" created="Fri, 16 Oct 2015 15:11:25 +0000"/>
                            <attachment id="12766842" name="derby-5605_diff.txt" size="1688" author="kmarsden" created="Thu, 15 Oct 2015 18:34:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10363"><![CDATA[Embedded/Client difference]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>226707</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10422"><![CDATA[High Value Fix]]></customfieldvalue>
    <customfieldvalue key="10423"><![CDATA[Newcomer]]></customfieldvalue>
    <customfieldvalue key="10424"><![CDATA[Repro attached]]></customfieldvalue>
    <customfieldvalue key="10427"><![CDATA[Workaround attached]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 10 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i06j4n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36033</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>