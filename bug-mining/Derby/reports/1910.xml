<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 14:08:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DERBY-4469] Fix the CASTing behavior of UDTs</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4469</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The actual behavior of UDTs, now under construction, does not conform to the spec. The spec says that you can&apos;t CAST to or from UDTs. This is probably too harsh. We should allow the following CAST&lt;/p&gt;

&lt;p&gt;  cast ( null as udtType )&lt;/p&gt;

&lt;p&gt;I also think that we should allow at least the implicit casting of subtypes to supertypes since Java gives us the ability to discover the type graph. See Knut&apos;s comment on &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-651&quot; title=&quot;Re-enable the storing of java objects in the database&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-651&quot;&gt;&lt;del&gt;DERBY-651&lt;/del&gt;&lt;/a&gt; on Dec 11, 2009.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12443090">DERBY-4469</key>
            <summary>Fix the CASTing behavior of UDTs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rhillegas">Richard N. Hillegas</assignee>
                                    <reporter username="rhillegas">Richard N. Hillegas</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Dec 2009 13:27:31 +0000</created>
                <updated>Wed, 12 Jan 2011 19:14:16 +0000</updated>
                            <resolved>Fri, 12 Feb 2010 14:11:43 +0000</resolved>
                                    <version>10.6.1.0</version>
                                    <fixVersion>10.6.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12789784" author="rhillegas" created="Sat, 12 Dec 2009 20:41:38 +0000"  >&lt;p&gt;Attaching derby-4469-01-aa-castNullsAndUntypedParameters.diff. This patch makes it possible to cast nulls and untyped ? parameters as UDTs. More tests will need to be written to verify that casting from builtin types to UDTs and vice-versa does not work. Some additional logic will need to be written to handle the case when a UDT is bound to one of the Java types which correspond to Derby&apos;s SQL types (e.g., String, Integer, etc.). Tests passed cleanly for me. Committed at subversion revision 889975.&lt;/p&gt;

&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;M      java/engine/org/apache/derby/impl/sql/compile/sqlgrammar.jj&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/compile/CastNode.java&lt;/p&gt;

&lt;p&gt;Allow casting to UDTs.&lt;/p&gt;

&lt;p&gt;M      java/testing/org/apache/derbyTesting/functionTests/tests/lang/UDTTest.java&lt;/p&gt;

&lt;p&gt;Verify that the following now work:&lt;/p&gt;

&lt;p&gt;  cast ( null as udtType )&lt;br/&gt;
  cast ( ? as udtType )&lt;/p&gt;

&lt;p&gt;In addition, change the definition of the UDT dependent views so that they reference UDTs via casts rather than via function calls. This will tease apart the next bit of dependency tracking which must be built: dependencies of routines on UDTs.&lt;/p&gt;


&lt;p&gt;M      java/testing/org/apache/derbyTesting/functionTests/master/db2Compatibility.out&lt;/p&gt;

&lt;p&gt;The casts to Java types now fail with a different syntax error.&lt;/p&gt;</comment>
                            <comment id="12832696" author="rhillegas" created="Thu, 11 Feb 2010 21:51:17 +0000"  >&lt;p&gt;Attaching derby-4469-02-ab-illegalCasts.diff. This implements the full, harsh behavior described by the functional spec. UDTs can&apos;t be cast to other UDTs or to builtin types. Builtin types can&apos;t be cast to UDTs. Both implicit and explicit casts are forbidden. Regression tests are running.&lt;/p&gt;


&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;M      java/engine/org/apache/derby/impl/sql/compile/JavaValueNode.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/compile/JavaToSQLValueNode.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/compile/MethodCallNode.java&lt;/p&gt;

&lt;p&gt;The full type information was being lost on the return values of functions. All that was being preserved was the name of the class returned by the corresponding Java method. This is not enough. We need to know the SQL type returned by the function, that is, the full schema-qualified type.&lt;/p&gt;

&lt;p&gt;-----------&lt;/p&gt;


&lt;p&gt;M      java/engine/org/apache/derby/impl/sql/compile/UserDefinedTypeCompiler.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/compile/BaseTypeCompiler.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/compile/CharTypeCompiler.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/compile/BitTypeCompiler.java&lt;/p&gt;

&lt;p&gt;Given full type information, prevent illegal implicit and explicit casts involving UDTs.&lt;/p&gt;

&lt;p&gt;-----------&lt;/p&gt;


&lt;p&gt;M      java/testing/org/apache/derbyTesting/functionTests/tests/lang/GeneratedColumnsHelper.java&lt;br/&gt;
M      java/testing/org/apache/derbyTesting/functionTests/tests/lang/UDTTest.java&lt;/p&gt;

&lt;p&gt;New tests to verify the harsh rules imposed by the functional spec.&lt;/p&gt;</comment>
                            <comment id="12832761" author="rhillegas" created="Fri, 12 Feb 2010 00:40:39 +0000"  >&lt;p&gt;Tests ran cleanly on derby-4469-02-ab-illegalCasts.diff. Committed at subversion revision 909190.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12325061">DERBY-651</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12427831" name="derby-4469-01-aa-castNullsAndUntypedParameters.diff" size="10186" author="rhillegas" created="Sat, 12 Dec 2009 20:41:38 +0000"/>
                            <attachment id="12435616" name="derby-4469-02-ab-illegalCasts.diff" size="20647" author="rhillegas" created="Thu, 11 Feb 2010 21:51:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24278</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10102"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 41 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i06tlr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37730</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>