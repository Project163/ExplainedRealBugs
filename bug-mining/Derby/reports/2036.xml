<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 14:12:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DERBY-4459] Verification error at execute-time when an outer function which takes a primitive arg is wrapped around an inner function which returns the corresponding Java wrapper object</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4459</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;An insane Derby raises a verification error when trying to run the following query:&lt;/p&gt;

&lt;p&gt;values( negateInt( getNullInt() ) );&lt;/p&gt;

&lt;p&gt;where negateInt() takes a primitive int argument and getNullInt() returns an Integer.&lt;/p&gt;

&lt;p&gt;Sane Derby raises an assertion. The same test case, run against 10.3.3.1, also fails but raises a more graceful compile-time exception.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12442110">DERBY-4459</key>
            <summary>Verification error at execute-time when an outer function which takes a primitive arg is wrapped around an inner function which returns the corresponding Java wrapper object</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rhillegas">Richard N. Hillegas</assignee>
                                    <reporter username="rhillegas">Richard N. Hillegas</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Dec 2009 16:07:45 +0000</created>
                <updated>Fri, 14 Jun 2013 17:35:44 +0000</updated>
                            <resolved>Wed, 16 Feb 2011 19:30:15 +0000</resolved>
                                    <version>10.4.2.1</version>
                    <version>10.5.3.1</version>
                    <version>10.6.1.0</version>
                                    <fixVersion>10.5.3.2</fixVersion>
                    <fixVersion>10.6.2.4</fixVersion>
                    <fixVersion>10.7.1.1</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12784312" author="rhillegas" created="Tue, 1 Dec 2009 18:08:35 +0000"  >&lt;p&gt;Attaching a reproducible test case: derby4459.java and derby-4459.sql. If you compile the class and run the script through ij, you will see this output:&lt;/p&gt;

&lt;p&gt;ij version 10.6&lt;br/&gt;
ij&amp;gt; connect &apos;jdbc:derby:memory:db;create=true&apos;;&lt;br/&gt;
ij&amp;gt; create function getNullInt() returns int language java parameter style java external name &apos;derby4459.getNullInt&apos;;&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; create function negateInt( a int ) returns int language java parameter style java external name &apos;derby4459.negateInt&apos;;&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; &amp;#8211; this fails gracefully&lt;br/&gt;
values( negateInt( cast( null as int) ) );&lt;br/&gt;
1          &lt;br/&gt;
-----------&lt;br/&gt;
ERROR 39004: A NULL value cannot be passed to a method which takes a parameter of primitive type &apos;int&apos;.&lt;br/&gt;
ij&amp;gt; &amp;#8211; this fails gracelessly&lt;br/&gt;
values( negateInt( getNullInt() ) );&lt;br/&gt;
ERROR XBCM2: Cannot create an instance of generated class org.apache.derby.exe.ac0b5b0099x0125x4b6bxa3fdx000000135f981.&lt;br/&gt;
ERROR XJ001: Java exception: &apos;(class: org/apache/derby/exe/ac0b5b0099x0125x4b6bxa3fdx000000135f981, method: e0 signature: ()Ljava/lang/Object&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Expecting to find integer on stack: java.lang.VerifyError&apos;.&lt;/p&gt;</comment>
                            <comment id="12784313" author="rhillegas" created="Tue, 1 Dec 2009 18:10:10 +0000"  >&lt;p&gt;Linking this issue to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1030&quot; title=&quot;In some situations a RETURNS NULL ON NULL function is called when one ot its parameters is NULL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1030&quot;&gt;&lt;del&gt;DERBY-1030&lt;/del&gt;&lt;/a&gt; because this bug may be another symptom of the over-eager optimization which causes that bug.&lt;/p&gt;</comment>
                            <comment id="12784314" author="rhillegas" created="Tue, 1 Dec 2009 18:10:45 +0000"  >&lt;p&gt;Linking to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-479&quot; title=&quot;Passing the return of  a RETURN NULL ON NULL INPUT function to another function call throws linkage error.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-479&quot;&gt;&lt;del&gt;DERBY-479&lt;/del&gt;&lt;/a&gt; because this bug may be another symptom of the over-eager optimization which causes that bug.&lt;/p&gt;</comment>
                            <comment id="12887826" author="rhillegas" created="Tue, 13 Jul 2010 16:19:43 +0000"  >&lt;p&gt;Attaching derby-4459-01-aa-disableOptimization.diff. This disables the same over-eager optimization which led to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1030&quot; title=&quot;In some situations a RETURNS NULL ON NULL function is called when one ot its parameters is NULL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1030&quot;&gt;&lt;del&gt;DERBY-1030&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;For more context, please see &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1030&quot; title=&quot;In some situations a RETURNS NULL ON NULL function is called when one ot its parameters is NULL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1030&quot;&gt;&lt;del&gt;DERBY-1030&lt;/del&gt;&lt;/a&gt;. This is another case of that optimization being applied too liberally. This patch disables that optimization when the bind() phase has determined that an argument needs to be cast to a primitive in order to match the selected method. Running tests now.&lt;/p&gt;

&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;-------------&lt;/p&gt;

&lt;p&gt;M      java/engine/org/apache/derby/impl/sql/compile/StaticMethodCallNode.java&lt;/p&gt;

&lt;p&gt;Disables the optimization.&lt;/p&gt;

&lt;p&gt;-------------&lt;/p&gt;

&lt;p&gt;M      java/testing/org/apache/derbyTesting/functionTests/tests/lang/RoutineTest.java&lt;/p&gt;

&lt;p&gt;Adds a test case.&lt;/p&gt;</comment>
                            <comment id="12887929" author="rhillegas" created="Tue, 13 Jul 2010 18:45:37 +0000"  >&lt;p&gt;Tests ran cleanly for me except for the following errors which seem to have been introduced into the mainline recently:&lt;/p&gt;

&lt;p&gt;1) testAttributeAccumulatedConnectionCount(org.apache.derbyTesting.functionTests.tests.management.NetworkServerMBeanTest)java.security.PrivilegedActionException: javax.management.InstanceNotFoundException: org.apache.derby:type=NetworkServer,system=c013800d-0129-cd0d-100f-ffffe1d7aa3e&lt;br/&gt;
	at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.management.MBeanTest.getAttribute(MBeanTest.java:379)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.management.NetworkServerMBeanTest.testAttributeAccumulatedConnectionCount(NetworkServerMBeanTest.java:93)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:109)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
Caused by: javax.management.InstanceNotFoundException: org.apache.derby:type=NetworkServer,system=c013800d-0129-cd0d-100f-ffffe1d7aa3e&lt;br/&gt;
	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.getMBean(DefaultMBeanServerInterceptor.java:1010)&lt;br/&gt;
	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.getAttribute(DefaultMBeanServerInterceptor.java:627)&lt;br/&gt;
	at com.sun.jmx.mbeanserver.JmxMBeanServer.getAttribute(JmxMBeanServer.java:659)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.management.MBeanTest$4.run(MBeanTest.java:382)&lt;br/&gt;
	... 41 more&lt;br/&gt;
There was 1 failure:&lt;br/&gt;
1) ttestSetPortPriority(org.apache.derbyTesting.functionTests.tests.derbynet.ServerPropertiesTest)junit.framework.AssertionFailedError: Port 1537 exceeeds expected maximum. You may need to update TestConfiguration.MAX_PORTS_USED and the Wiki page at &lt;a href=&quot;http://wiki.apache.org/db-derby/DerbyJUnitTesting&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://wiki.apache.org/db-derby/DerbyJUnitTesting&lt;/a&gt; if test runs now require more available ports&lt;br/&gt;
	at org.apache.derbyTesting.junit.TestConfiguration.getNextAvailablePort(TestConfiguration.java:1413)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.derbynet.ServerPropertiesTest.ttestSetPortPriority(ServerPropertiesTest.java:445)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:109)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;/p&gt;

&lt;p&gt;FAILURES!!!&lt;br/&gt;
Tests run: 8845,  Failures: 1,  Errors: 1&lt;/p&gt;</comment>
                            <comment id="12888324" author="rhillegas" created="Wed, 14 Jul 2010 13:12:18 +0000"  >&lt;p&gt;Committed patch at subversion revision 964039.&lt;/p&gt;</comment>
                            <comment id="12989887" author="kmarsden" created="Wed, 2 Feb 2011 23:41:37 +0000"  >&lt;p&gt;Reopen for backport.&lt;/p&gt;</comment>
                            <comment id="12994629" author="kmarsden" created="Tue, 15 Feb 2011 02:14:52 +0000"  >&lt;p&gt;Assign to myself temporarily for backport&lt;/p&gt;</comment>
                            <comment id="12995475" author="kmarsden" created="Wed, 16 Feb 2011 19:30:15 +0000"  >&lt;p&gt;Resolving after backport to 10.5. Thank  you Rick for the fix.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12312748">DERBY-479</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12329346">DERBY-1030</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="12497378">DERBY-4994</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12449366" name="derby-4459-01-aa-disableOptimization.diff" size="2818" author="rhillegas" created="Tue, 13 Jul 2010 16:19:43 +0000"/>
                            <attachment id="12426555" name="derby-4459.sql" size="412" author="rhillegas" created="Tue, 1 Dec 2009 18:08:35 +0000"/>
                            <attachment id="12426556" name="derby4459.java" size="143" author="rhillegas" created="Tue, 1 Dec 2009 18:08:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24270</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 40 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i06nkn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36753</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>