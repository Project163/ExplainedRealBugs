{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/156","repository_url":"https://api.github.com/repos/BurntSushi/ripgrep","labels_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/156/labels{/name}","comments_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/156/comments","events_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/156/events","html_url":"https://github.com/BurntSushi/ripgrep/issues/156","id":181805559,"node_id":"MDU6SXNzdWUxODE4MDU1NTk=","number":156,"title":"rg not parsing regex correctly?","user":{"login":"isker","id":5225653,"node_id":"MDQ6VXNlcjUyMjU2NTM=","avatar_url":"https://avatars.githubusercontent.com/u/5225653?v=4","gravatar_id":"","url":"https://api.github.com/users/isker","html_url":"https://github.com/isker","followers_url":"https://api.github.com/users/isker/followers","following_url":"https://api.github.com/users/isker/following{/other_user}","gists_url":"https://api.github.com/users/isker/gists{/gist_id}","starred_url":"https://api.github.com/users/isker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/isker/subscriptions","organizations_url":"https://api.github.com/users/isker/orgs","repos_url":"https://api.github.com/users/isker/repos","events_url":"https://api.github.com/users/isker/events{/privacy}","received_events_url":"https://api.github.com/users/isker/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":339721678,"node_id":"MDU6TGFiZWwzMzk3MjE2Nzg=","url":"https://api.github.com/repos/BurntSushi/ripgrep/labels/bug","name":"bug","color":"fc2929","default":true,"description":"A bug."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2016-10-08T05:19:27Z","updated_at":"2016-10-11T12:51:33Z","closed_at":"2016-10-11T02:04:33Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Hi.  Apologies if this question is nonsensical - I am not super experienced with rg or Rust.\n\nI've got ripgrep 0.2.1 from homebrew.  I cannot get it to correctly handle a regex from the command line, while I can get ag to do so.  I've attached a simple example file.\n\n[testcase.txt](https://github.com/BurntSushi/ripgrep/files/517442/testcase.txt)\n\nRunning this regex yields expected results:\n\n```\n$ rg '#(?:parse|include)' /tmp/testcase.txt\n1:#parse('widgets/foo_bar_macros.vm')\n2:#parse ( 'widgets/mobile/foo_bar_macros.vm' )\n3:#parse (\"widgets/foobarhiddenformfields.vm\")\n4:#parse ( \"widgets/foo_bar_legal.vm\" )\n5:#include( 'widgets/foo_bar_tips.vm' )\n6:#include('widgets/mobile/foo_bar_macros.vm')\n7:#include (\"widgets/mobile/foo_bar_resetpw.vm\")\n8:#parse('widgets/foo-bar-macros.vm')\n9:#parse ( 'widgets/mobile/foo-bar-macros.vm' )\n10:#parse (\"widgets/foo-bar-hiddenformfields.vm\")\n11:#parse ( \"widgets/foo-bar-legal.vm\" )\n12:#include( 'widgets/foo-bar-tips.vm' )\n13:#include('widgets/mobile/foo-bar-macros.vm')\n14:#include (\"widgets/mobile/foo-bar-resetpw.vm\")\n```\n\nBut extending it further does not:\n\n```\n$ rg $'#(?:parse|include)\\s*\\(\\s*(?:\"|\\')[./A-Za-z_-]+(?:\"|\\')' /tmp/testcase.txt\n$\n```\n\nThe Silver Searcher gets the same thing:\n\n```\n$ ag $'#(?:parse|include)\\s*\\(\\s*(?:\"|\\')[./A-Za-z_-]+(?:\"|\\')' /tmp/testcase.txt\n1:#parse('widgets/foo_bar_macros.vm')\n2:#parse ( 'widgets/mobile/foo_bar_macros.vm' )\n3:#parse (\"widgets/foobarhiddenformfields.vm\")\n4:#parse ( \"widgets/foo_bar_legal.vm\" )\n5:#include( 'widgets/foo_bar_tips.vm' )\n6:#include('widgets/mobile/foo_bar_macros.vm')\n7:#include (\"widgets/mobile/foo_bar_resetpw.vm\")\n8:#parse('widgets/foo-bar-macros.vm')\n9:#parse ( 'widgets/mobile/foo-bar-macros.vm' )\n10:#parse (\"widgets/foo-bar-hiddenformfields.vm\")\n11:#parse ( \"widgets/foo-bar-legal.vm\" )\n12:#include( 'widgets/foo-bar-tips.vm' )\n13:#include('widgets/mobile/foo-bar-macros.vm')\n14:#include (\"widgets/mobile/foo-bar-resetpw.vm\")\n```\n\nThe cause of the difference, as indicated by the output colors, is that ripgrep stops matching at the '.' in each line, even though '.' is included in the character class I am matching on.  --debug output indicates that this character should be matched:\n\n```\n        Repeat {\n            e: Class(\n                CharClass {\n                    ranges: [\n                        ClassRange {\n                            start: '-',   <-- '.' is in this range...\n                            end: '/'\n                        },\n                        ClassRange {\n                            start: 'A',\n                            end: 'Z'\n                        },\n                        ClassRange {\n                            start: '_',\n                            end: '_'\n                        },\n                        ClassRange {\n                            start: 'a',\n                            end: 'z'\n                        }\n                    ]\n                }\n            ),\n            r: OneOrMore,\n            greedy: true\n        },\n```\n\nI tested the regex in a simple Rust program to ensure that the regex itself is fine in the eyes of Rust.\n\n```\nextern crate regex;\n\nuse regex::Regex;\n\nfn main() {\n    let re = Regex::new(r##\"#(?:parse|include)\\s*\\(\\s*(?:\"|')[./A-Za-z_-]+(?:\"|')\"##).unwrap();\n    assert!(re.is_match(\"#parse('widgets/foo_bar_macros.vm')\"));\n    assert!(re.is_match(\"#parse('widgets/mobile/foo-bar-resetpw.vm')\"));\n}\n```\n\nI'm at a bit of a loss.  Not too sure if this is a bug with rg or with me.  Any idea?  Thanks!\n","closed_by":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/156/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/156/timeline","performed_via_github_app":null,"state_reason":"completed"}