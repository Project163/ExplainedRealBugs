{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/3184","repository_url":"https://api.github.com/repos/BurntSushi/ripgrep","labels_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/3184/labels{/name}","comments_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/3184/comments","events_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/3184/events","html_url":"https://github.com/BurntSushi/ripgrep/issues/3184","id":3511420316,"node_id":"I_kwDOAzJbyc7RTAWc","number":3184,"title":"Excessive slowdown with larger `-A` context windows?","user":{"login":"d-e-s-o","id":6610056,"node_id":"MDQ6VXNlcjY2MTAwNTY=","avatar_url":"https://avatars.githubusercontent.com/u/6610056?v=4","gravatar_id":"","url":"https://api.github.com/users/d-e-s-o","html_url":"https://github.com/d-e-s-o","followers_url":"https://api.github.com/users/d-e-s-o/followers","following_url":"https://api.github.com/users/d-e-s-o/following{/other_user}","gists_url":"https://api.github.com/users/d-e-s-o/gists{/gist_id}","starred_url":"https://api.github.com/users/d-e-s-o/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/d-e-s-o/subscriptions","organizations_url":"https://api.github.com/users/d-e-s-o/orgs","repos_url":"https://api.github.com/users/d-e-s-o/repos","events_url":"https://api.github.com/users/d-e-s-o/events{/privacy}","received_events_url":"https://api.github.com/users/d-e-s-o/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":339721678,"node_id":"MDU6TGFiZWwzMzk3MjE2Nzg=","url":"https://api.github.com/repos/BurntSushi/ripgrep/labels/bug","name":"bug","color":"fc2929","default":true,"description":"A bug."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2025-10-13T20:37:49Z","updated_at":"2025-10-14T19:13:20Z","closed_at":"2025-10-14T18:27:44Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Please tick this box to confirm you have reviewed the above.\n\n- [x] I have a different issue.\n\n### What version of ripgrep are you using?\n\nrg --version\nripgrep 14.1.1\n\nfeatures:-pcre2\nsimd(compile):+SSE2,-SSSE3,-AVX2\nsimd(runtime):+SSE2,+SSSE3,+AVX2\n\nPCRE2 is not available in this build of ripgrep.\n\n### How did you install ripgrep?\n\n`emerge`\n\n### What operating system are you using ripgrep on?\n\nGentoo\n\n### Describe your bug.\n\nOn large files, `rg` seems to slow down significantly with larger `-A` values.\n\n```\n$ ls -lh large_file\n> -rwxr-xr-x 1 XXX XXX 9.8G Oct 10 11:35 large_file\n```\n\n```sh\n$ time cat large_file | rg XXXXX -A99\nbinary file matches (found \"\\0\" byte around offset 7)\n\n________________________________________________________\nExecuted in  334.68 millis    fish           external\n   usr time  260.39 millis    2.94 millis  257.45 millis\n   sys time   75.03 millis    0.99 millis   74.04 millis\n\n$ time cat large_file | rg XXXXX -A999\nbinary file matches (found \"\\0\" byte around offset 7)\n\n________________________________________________________\nExecuted in  349.03 millis    fish           external\n   usr time  269.92 millis    1.57 millis  268.36 millis\n   sys time   91.83 millis    1.02 millis   90.81 millis\n\n$ time cat large_file | rg XXXXX -A9999\nbinary file matches (found \"\\0\" byte around offset 7)\n\n________________________________________________________\nExecuted in  667.18 millis    fish           external\n   usr time  565.68 millis    1.62 millis  564.06 millis\n   sys time  103.22 millis    1.02 millis  102.20 millis\n\n$ time cat large_file | rg XXXXX -A99999\nbinary file matches (found \"\\0\" byte around offset 7)\n\n________________________________________________________\nExecuted in    3.39 secs    fish           external\n   usr time    3.27 secs    0.73 millis    3.27 secs\n   sys time    0.12 secs    2.01 millis    0.12 secs\n\n$ time cat large_file | rg XXXXX -A999999\nbinary file matches (found \"\\0\" byte around offset 7)\n\n________________________________________________________\nExecuted in   28.48 secs    fish           external\n   usr time   28.29 secs    0.82 millis   28.28 secs\n   sys time    0.14 secs    2.01 millis    0.13 secs\n\n$ time cat large_file | rg XXXXX -A9999999\nbinary file matches (found \"\\0\" byte around offset 7)\n\n________________________________________________________\nExecuted in  235.28 secs    fish           external\n   usr time  234.74 secs    2.70 millis  234.73 secs\n   sys time    0.18 secs    1.02 millis    0.18 secs\n```\nThe larger the context window, the longer it takes, it seems.\n\nCompare that to `grep`:\n```sh\n$ time cat large_file | grep XXXXX -A99\ngrep: (standard input): binary file matches\n\n________________________________________________________\nExecuted in    5.54 secs    fish           external\n   usr time    0.23 secs    1.46 millis    0.23 secs\n   sys time    5.29 secs    2.04 millis    5.28 secs\n\n$ time cat large_file | grep XXXXX -A999\ngrep: (standard input): binary file matches\n\n________________________________________________________\nExecuted in    5.56 secs    fish           external\n   usr time    0.22 secs    1.00 millis    0.22 secs\n   sys time    5.34 secs    2.97 millis    5.34 secs\n\n$ time cat large_file | grep XXXXX -A9999\ngrep: (standard input): binary file matches\n\n________________________________________________________\nExecuted in    5.50 secs    fish           external\n   usr time    0.24 secs    1.12 millis    0.23 secs\n   sys time    5.27 secs    3.08 millis    5.27 secs\n\n$ time cat large_file | grep XXXXX -A99999\ngrep: (standard input): binary file matches\n\n________________________________________________________\nExecuted in    5.53 secs    fish           external\n   usr time    0.22 secs    0.27 millis    0.22 secs\n   sys time    5.30 secs    3.03 millis    5.30 secs\n\n$ time cat large_file | grep XXXXX -A999999\ngrep: (standard input): binary file matches\n\n________________________________________________________\nExecuted in    5.36 secs    fish           external\n   usr time    0.20 secs    1.32 millis    0.20 secs\n   sys time    5.18 secs    2.03 millis    5.18 secs\n\n$ time cat large_file | grep XXXXX -A9999999\ngrep: (standard input): binary file matches\n\n________________________________________________________\nExecuted in    5.48 secs    fish           external\n   usr time    0.23 secs    0.00 millis    0.23 secs\n   sys time    5.25 secs    2.94 millis    5.25 secs\n```\n\nThis is very unfortunate behavior, as it means that `grep` can, in fact, not rest in peace.\n\n### What are the steps to reproduce the behavior?\n\nSee above.\n\n### What is the actual behavior?\n\nIt's slow.\n\n### What is the expected behavior?\n\nIt should be faster.","closed_by":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/3184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/3184/timeline","performed_via_github_app":null,"state_reason":"completed"}