{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/2246","repository_url":"https://api.github.com/repos/BurntSushi/ripgrep","labels_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/2246/labels{/name}","comments_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/2246/comments","events_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/2246/events","html_url":"https://github.com/BurntSushi/ripgrep/issues/2246","id":1283901562,"node_id":"I_kwDOAzJbyc5Mhsh6","number":2246,"title":"emit log message when file is skipped becaue it was detected as \"binary\" data","user":{"login":"asomers","id":129721,"node_id":"MDQ6VXNlcjEyOTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/129721?v=4","gravatar_id":"","url":"https://api.github.com/users/asomers","html_url":"https://github.com/asomers","followers_url":"https://api.github.com/users/asomers/followers","following_url":"https://api.github.com/users/asomers/following{/other_user}","gists_url":"https://api.github.com/users/asomers/gists{/gist_id}","starred_url":"https://api.github.com/users/asomers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asomers/subscriptions","organizations_url":"https://api.github.com/users/asomers/orgs","repos_url":"https://api.github.com/users/asomers/repos","events_url":"https://api.github.com/users/asomers/events{/privacy}","received_events_url":"https://api.github.com/users/asomers/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":339721680,"node_id":"MDU6TGFiZWwzMzk3MjE2ODA=","url":"https://api.github.com/repos/BurntSushi/ripgrep/labels/enhancement","name":"enhancement","color":"84b6eb","default":true,"description":"An enhancement to the functionality of the software."},{"id":1849506066,"node_id":"MDU6TGFiZWwxODQ5NTA2MDY2","url":"https://api.github.com/repos/BurntSushi/ripgrep/labels/rollup","name":"rollup","color":"ffccee","default":false,"description":"A PR that has been merged with many others in a rollup."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2022-06-24T15:42:29Z","updated_at":"2023-11-25T20:03:59Z","closed_at":"2023-11-25T20:03:59Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### What version of ripgrep are you using?\r\n```\r\nripgrep 13.0.0\r\n+SIMD -AVX (compiled)\r\n+SIMD +AVX (runtime)\r\n```\r\n\r\n#### How did you install ripgrep?\r\nThrough the FreeBSD ports collection\r\n\r\n#### What operating system are you using ripgrep on?\r\n\r\nFreeBSD 14.0-CURRENT amd64.  The file system is ZFS.\r\n\r\n#### Describe your bug.\r\n\r\nI have a directory with 552,900 entries, one for every version of every crate ever published to crates.io.  If I run `rg` with no PATH arguments, it finishes in about a minute with no results.  However, if I run it with specific PATH arguments then it finds plentiful results.  The likeliest explanation I can think of is that when recursing through `.`, rg doesn't iterate through every child.\r\n\r\n#### What are the steps to reproduce the behavior?\r\n\r\nFirst, create a fresh file system with at least 100 GB of space.  Then download every published crate, using a command similar to the following.  Note that `fetch` is a FreeBSD-specific command, and may be replaced by curl or wget.\r\n```\r\ngit clone https:â€‹//github.com/rust-lang/crates.io-index index\r\ngrep -hr . index/*/ | jq '.name + \"-\" + .vers + \".tar.gz \" + \"https://crates.io/api/v1/crates/\" + .name + \"/\" + .vers + \"/download\"' -r | xargs -P100 -n2 fetch -o\r\n```\r\nRun this command to show which files match.  You can CTRL-C it after you're satisfied.\r\n```\r\nls | xargs -n 1000 rg -l -z '\\bsigevent\\b'`\r\n```\r\nThen run this command.  It will wrongly produce no output.\r\n```\r\nrg -l -z '\\bsigevent\\b'\r\n```\r\n#### What is the actual behavior?\r\n\r\n```\r\n> rg --debug -l -z  '\\bsigevent\\b'\r\nDEBUG|grep_regex::literal|crates/regex/src/literal.rs:180: required literal found: \"sigevent\"\r\nDEBUG|grep_regex::matcher|crates/regex/src/matcher.rs:50: extracted fast line regex: (?-u:sigevent)\r\nDEBUG|globset|crates/globset/src/lib.rs:421: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:421: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:421: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:421: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:421: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:421: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:421: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:421: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:421: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:421: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:421: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:421: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:421: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|ignore::walk|crates/ignore/src/walk.rs:1741: ignoring ./.affected-packages.txt.swp: Ignore(IgnoreMatch(Hidden))\r\nDEBUG|ignore::walk|crates/ignore/src/walk.rs:1741: ignoring ./.summary.txt.swp: Ignore(IgnoreMatch(Hidden))\r\nDEBUG|ignore::walk|crates/ignore/src/walk.rs:1741: ignoring ./index/.git: Ignore(IgnoreMatch(Hidden))\r\nDEBUG|ignore::walk|crates/ignore/src/walk.rs:1741: ignoring ./index/.github: Ignore(IgnoreMatch(Hidden))\r\n```\r\n\r\n#### What is the expected behavior?\r\n\r\nIt should have returned about 1353 files.\r\n","closed_by":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/2246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/2246/timeline","performed_via_github_app":null,"state_reason":"completed"}