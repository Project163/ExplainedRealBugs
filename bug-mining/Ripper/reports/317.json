{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/1878","repository_url":"https://api.github.com/repos/BurntSushi/ripgrep","labels_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/1878/labels{/name}","comments_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/1878/comments","events_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/1878/events","html_url":"https://github.com/BurntSushi/ripgrep/issues/1878","id":906448882,"node_id":"MDU6SXNzdWU5MDY0NDg4ODI=","number":1878,"title":"using '^' (or '\\A') with multi-line search doesn't always produce expected result","user":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-05-29T11:27:39Z","updated_at":"2021-05-29T11:38:01Z","closed_at":"2021-05-29T11:38:01Z","author_association":"OWNER","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Initially found on HN: https://news.ycombinator.com/item?id=27324265\r\n\r\nSpecifically, while this output is correct (since `^` is set to be in regex multi-line mode always):\r\n\r\n```\r\n$ printf 'a\\nbaz\\nabc\\n' | rg -U '^b'\r\nbaz\r\n```\r\n\r\nIt should be the case that using `(?-m)^b` or `\\Ab` would _not_ print `baz` as a match. But that's not the case here:\r\n\r\n```\r\n$ printf 'a\\nbaz\\nabc\\n' | rg -U '(?-m)^b'\r\nbaz\r\n$ printf 'a\\nbaz\\nabc\\n' | rg -U '\\Ab'\r\nbaz\r\n```\r\n\r\nThe issue here is that in this case, ripgrep isn't memory mapping the input. In that case, ripgrep tries to be \"smart\" and not actually read the entire contents on to the heap if it knows the pattern can't match through a line terminator. But in this case, we can't quite make that assumption since anchors can match line terminators as look-around.","closed_by":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/1878/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/1878/timeline","performed_via_github_app":null,"state_reason":"completed"}