{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/413","repository_url":"https://api.github.com/repos/BurntSushi/ripgrep","labels_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/413/labels{/name}","comments_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/413/comments","events_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/413/events","html_url":"https://github.com/BurntSushi/ripgrep/issues/413","id":215268930,"node_id":"MDU6SXNzdWUyMTUyNjg5MzA=","number":413,"title":"ripgrep binaries are an order of magnitude larger than they need to be","user":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":339721683,"node_id":"MDU6TGFiZWwzMzk3MjE2ODM=","url":"https://api.github.com/repos/BurntSushi/ripgrep/labels/question","name":"question","color":"cc317c","default":true,"description":"An issue that is lacking clarity on one or more points."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":11,"created_at":"2017-03-19T14:48:33Z","updated_at":"2017-08-23T22:07:58Z","closed_at":"2017-08-23T22:07:58Z","author_association":"OWNER","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"This discussion started in #412.\r\n\r\nThe problem is that when you compile ripgrep today, you get big binaries. Both the `cargo install` approach and installing Linux binaries from the Github releases yield large binaries.\r\n\r\nTo address the inconsistency concern in the abstract: there are *many* inconsistencies between the ripgrep releases and what's installed with `cargo install`, and these inconsistencies will always be there. For example, `cargo install` doesn't provide easy access to a man page, license info or to the various auto-completion scripts. So the fact that there is yet another inconsistency doesn't really bother me. Namely, `cargo install` is *not* the recommended way to install ripgrep, so I'm less sympathetic to issues that people have using it. It's provided on a best effort basis because it's occasionally convenient for folks who are otherwise Rust programmers.\r\n\r\nSecondly, I will describe why I have `debug = true` for release builds. Perhaps there is some other solution that I haven't thought of.\r\n\r\nThere are two primary benefits I perceived when setting `debug = true`:\r\n\r\n1. A large fraction of time I spend developing ripgrep is with it compiled in release mode because I want to inspect its runtime performance. Release mode by default doesn't include debug symbols, so this makes profiling harder. If `debug = false` were committed to source control, then I would have to constantly be changing around that value in the `Cargo.toml` during development, which is a huge pain. I don't want to do it.\r\n2. If and when ripgrep panics and the bug is hard to reproduce, the reporter can set `RUST_BACKTRACE=1` on some systems and get a useful stack trace if and only if debug symbols are in the binary.\r\n\r\n(2) is interesting, because ripgrep hardly ever panics, so it actually has not turned out to be as useful as I would have thought. In the case where it does happen, we could ask the user to compile ripgrep on their own---which is probably what most projects do---but I had wanted to make it as effortless as possible to report a bug. Nevertheless, since it rarely happens, it seems weird to optimize for that case.\r\n\r\nWith all that said, it seems like this is an argument in favor of stripping debug info from the binaries released in Github, but to retain the `debug = true` in `Cargo.toml`. Is there another solution? Can Cargo's config do something to help me out here?","closed_by":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/413/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/413/timeline","performed_via_github_app":null,"state_reason":"completed"}