{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/3139","repository_url":"https://api.github.com/repos/BurntSushi/ripgrep","labels_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/3139/labels{/name}","comments_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/3139/comments","events_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/3139/events","html_url":"https://github.com/BurntSushi/ripgrep/issues/3139","id":3388448111,"node_id":"I_kwDOAzJbyc7J951v","number":3139,"title":"Inconsistent behaviour when using --files-with-matches vs without","user":{"login":"F8enjoyer","id":120069402,"node_id":"U_kgDOBygdGg","avatar_url":"https://avatars.githubusercontent.com/u/120069402?v=4","gravatar_id":"","url":"https://api.github.com/users/F8enjoyer","html_url":"https://github.com/F8enjoyer","followers_url":"https://api.github.com/users/F8enjoyer/followers","following_url":"https://api.github.com/users/F8enjoyer/following{/other_user}","gists_url":"https://api.github.com/users/F8enjoyer/gists{/gist_id}","starred_url":"https://api.github.com/users/F8enjoyer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/F8enjoyer/subscriptions","organizations_url":"https://api.github.com/users/F8enjoyer/orgs","repos_url":"https://api.github.com/users/F8enjoyer/repos","events_url":"https://api.github.com/users/F8enjoyer/events{/privacy}","received_events_url":"https://api.github.com/users/F8enjoyer/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":339721678,"node_id":"MDU6TGFiZWwzMzk3MjE2Nzg=","url":"https://api.github.com/repos/BurntSushi/ripgrep/labels/bug","name":"bug","color":"fc2929","default":true,"description":"A bug."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2025-09-05T18:39:12Z","updated_at":"2025-09-22T13:12:17Z","closed_at":"2025-09-22T13:12:17Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Please tick this box to confirm you have reviewed the above.\n\n- [x] I have a different issue.\n\n### What version of ripgrep are you using?\n\nripgrep 14.1.1\n\nfeatures:+pcre2\nsimd(compile):+SSE2,-SSSE3,-AVX2\nsimd(runtime):+SSE2,+SSSE3,+AVX2\n\nPCRE2 10.43 is available (JIT is available)\n\n### How did you install ripgrep?\n\ncargo install ripgrep --features pcre2\n\n\n\n### What operating system are you using ripgrep on?\n\nWindows 10 & 11\n\n### Describe your bug.\n\nOutput when using switch `--files-with-matches` appears to leave out files, that otherwise show matches when the switch is not present.\n\n### What are the steps to reproduce the behavior?\n\nCompare the output of these two commands on the attached files:\n\n`rg --pcre2 --iglob *.txt --multiline \"(?s)Start(?!.*thing1)(?=.*thing2)(?!.*thing3)\"`\n`rg --pcre2 --iglob *.txt --multiline \"(?s)Start(?!.*thing1)(?=.*thing2)(?!.*thing3)\" --files-with-matches`\n\n[issue.txt](https://github.com/user-attachments/files/22177751/issue.txt)\n[normal.txt](https://github.com/user-attachments/files/22177755/normal.txt)\n\nBase64-encoded version of issue.txt (just in case attachment mangles it):\n> U3RhcnQgCiAgIAoKICAgWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFgKICAgWVlZWVlZWVlZWVlZ\n> WVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZ\n> WVlZWVkKICAgCiAgICAgIHRoaW5nMiAKCgo=\n\nBase64 normal.txt:\n> U3RhcnQKCiAgdGhpbmcyIAoK\n\n### What is the actual behavior?\n\nWithout `--files-with-matches`:\n> normal.txt\n> 1:Start\n> \n> issue.txt\n> 1:Start\n\n(Note: When run in a console, the match for the match for normal.txt is colored red, but the match in issue.txt is not)\n\nWith `--files-with-matches`:\n> normal.txt\n\n### What is the expected behavior?\n\nI would expect the `--files-with-matches` version of the command to list both normal.txt and issue.txt","closed_by":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/3139/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/3139/timeline","performed_via_github_app":null,"state_reason":"completed"}