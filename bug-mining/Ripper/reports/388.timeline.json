[{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/810698320","html_url":"https://github.com/BurntSushi/ripgrep/issues/1838#issuecomment-810698320","issue_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/1838","id":810698320,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDY5ODMyMA==","user":{"login":"bdlmt","id":29551954,"node_id":"MDQ6VXNlcjI5NTUxOTU0","avatar_url":"https://avatars.githubusercontent.com/u/29551954?v=4","gravatar_id":"","url":"https://api.github.com/users/bdlmt","html_url":"https://github.com/bdlmt","followers_url":"https://api.github.com/users/bdlmt/followers","following_url":"https://api.github.com/users/bdlmt/following{/other_user}","gists_url":"https://api.github.com/users/bdlmt/gists{/gist_id}","starred_url":"https://api.github.com/users/bdlmt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdlmt/subscriptions","organizations_url":"https://api.github.com/users/bdlmt/orgs","repos_url":"https://api.github.com/users/bdlmt/repos","events_url":"https://api.github.com/users/bdlmt/events{/privacy}","received_events_url":"https://api.github.com/users/bdlmt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T01:58:19Z","updated_at":"2021-03-31T01:58:19Z","body":"Further test results, when copying all of /usr/bin into a local test directory. \r\n\r\nSomehow, there are more pattern hits after a copy:\r\n```\r\nuser@local:~$ mkdir test2\r\nuser@local:~$ cd test2/\r\nuser@local:~/test2$ cp /usr/bin/* .\r\ncp: -r not specified; omitting directory '/usr/bin/X11'\r\nuser@local:~/test2$ rg -uuu '(?-u)\\x7f\\x45\\x4c\\x46\\x02\\x01\\x01' /usr/bin | wc -l\r\n1092\r\nuser@local:~/test2$ rg -uuu '(?-u)\\x7f\\x45\\x4c\\x46\\x02\\x01\\x01' | wc -l\r\n1468\r\n```\r\nThe full byte pattern search still doesn't match any files, unless individual files are targeted:\r\n```\r\nuser@local:~/test2$ rg -uuu '(?-u)\\x7f\\x45\\x4c\\x46\\x02\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' | wc -l\r\n0\r\nuser@local:~/test2$ rg -uuu '(?-u)\\x7f\\x45\\x4c\\x46\\x02\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' ./ls | wc -l\r\n1\r\n```\r\nAnd here's some more --debug output:\r\n```\r\nuser@local:~/test2$ rg -uuu '(?-u)\\x7f\\x45\\x4c\\x46\\x02\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' --debug\r\nDEBUG|grep_regex::literal|crates/regex/src/literal.rs:58: literal prefixes detected: Literals { lits: [Complete(ELF)], limit_size: 250, limit_class: 10 }\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\n```","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/810698320/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bdlmt","id":29551954,"node_id":"MDQ6VXNlcjI5NTUxOTU0","avatar_url":"https://avatars.githubusercontent.com/u/29551954?v=4","gravatar_id":"","url":"https://api.github.com/users/bdlmt","html_url":"https://github.com/bdlmt","followers_url":"https://api.github.com/users/bdlmt/followers","following_url":"https://api.github.com/users/bdlmt/following{/other_user}","gists_url":"https://api.github.com/users/bdlmt/gists{/gist_id}","starred_url":"https://api.github.com/users/bdlmt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdlmt/subscriptions","organizations_url":"https://api.github.com/users/bdlmt/orgs","repos_url":"https://api.github.com/users/bdlmt/repos","events_url":"https://api.github.com/users/bdlmt/events{/privacy}","received_events_url":"https://api.github.com/users/bdlmt/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/810705822","html_url":"https://github.com/BurntSushi/ripgrep/issues/1838#issuecomment-810705822","issue_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/1838","id":810705822,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDcwNTgyMg==","user":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T02:16:54Z","updated_at":"2021-03-31T02:17:09Z","body":"At first, I thought this might just be some confusion at how ripgrep handles binary files. The guide's section on binary data tries to explain the different modes. But since you are enabling binary mode via `-uuu` in all of your searches, that _should_ cause things to behave consistently.\r\n\r\nOn mobile at the moment, but I suspect there may be a bug in how ripgrep is detecting and handling binary data specifically when a match occurs. I'll take a look when I'm back on my workstation.\r\n\r\nOut of curiosity, do your results change if you add the `--no-mmap` flag? What about `--mmap`?","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/810705822/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/810706383","html_url":"https://github.com/BurntSushi/ripgrep/issues/1838#issuecomment-810706383","issue_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/1838","id":810706383,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDcwNjM4Mw==","user":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T02:18:29Z","updated_at":"2021-03-31T02:18:29Z","body":"(I believe there were changes in this area between the 11 and 12 releases, so please make sure you're doing all your testing with the latest release.)","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/810706383/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/810756948","html_url":"https://github.com/BurntSushi/ripgrep/issues/1838#issuecomment-810756948","issue_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/1838","id":810756948,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDc1Njk0OA==","user":{"login":"bdlmt","id":29551954,"node_id":"MDQ6VXNlcjI5NTUxOTU0","avatar_url":"https://avatars.githubusercontent.com/u/29551954?v=4","gravatar_id":"","url":"https://api.github.com/users/bdlmt","html_url":"https://github.com/bdlmt","followers_url":"https://api.github.com/users/bdlmt/followers","following_url":"https://api.github.com/users/bdlmt/following{/other_user}","gists_url":"https://api.github.com/users/bdlmt/gists{/gist_id}","starred_url":"https://api.github.com/users/bdlmt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdlmt/subscriptions","organizations_url":"https://api.github.com/users/bdlmt/orgs","repos_url":"https://api.github.com/users/bdlmt/repos","events_url":"https://api.github.com/users/bdlmt/events{/privacy}","received_events_url":"https://api.github.com/users/bdlmt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T04:45:48Z","updated_at":"2021-03-31T04:45:48Z","body":"> (I believe there were changes in this area between the 11 and 12 releases, so please make sure you're doing all your testing with the latest release.)\r\n\r\nAll reported test results have been with latest.\r\n(I was using 11.0.2 initially, but replicated all results in 12.1.1 for the bug report.)\r\n\r\n> At first, I thought this might just be some confusion at how ripgrep handles binary files. The guide's section on binary data tries to explain the different modes. But since you are enabling binary mode via `-uuu` in all of your searches, that _should_ cause things to behave consistently.\r\n> \r\n> On mobile at the moment, but I suspect there may be a bug in how ripgrep is detecting and handling binary data specifically when a match occurs. I'll take a look when I'm back on my workstation.\r\n> \r\n> Out of curiosity, do your results change if you add the `--no-mmap` flag? What about `--mmap`?\r\n\r\nThe issue seems unchanged by '--no-mmap':\r\n```\r\nuser@local:~/test2$ rg -uuu '(?-u)\\x7f\\x45\\x4c\\x46\\x02\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' --no-mmap | wc -l\r\n0\r\n```\r\nBut the results do change with '--mmap':\r\n```\r\nuser@local:~/test2$ rg -uuu '(?-u)\\x7f\\x45\\x4c\\x46\\x02\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' --mmap | wc -l\r\n1447\r\n```\r\n1447 seems to be the correct number of matches for that directory.\r\n\r\nI tested using '--mmap' with a much larger set of files as well, and again got the expected number of matches.\r\n(Though, slower than I expected, but maybe that's a side effect of escaping out of Unicode mode to do byte searches with regex.)\r\n\r\nHere's a debug run with '--mmap' over the test dir with only 4 files:\r\n```\r\n$ rg -uuu '(?-u)\\x7f\\x45\\x4c\\x46\\x02\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' --mmap --debug\r\nDEBUG|grep_regex::literal|crates/regex/src/literal.rs:58: literal prefixes detected: Literals { lits: [Complete(ELF)], limit_size: 250, limit_class: 10 }\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexesBinary file ls matches (found \"\\u{0}\" byte around offset 7)\r\n\r\n\r\nBinary file file matches (found \"\\u{0}\" byte around offset 7)\r\n\r\nBinary file find matches (found \"\\u{0}\" byte around offset 7)\r\n\r\nBinary file ed matches (found \"\\u{0}\" byte around offset 7)\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\nDEBUG|globset|crates/globset/src/lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes\r\n```\r\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/810756948/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bdlmt","id":29551954,"node_id":"MDQ6VXNlcjI5NTUxOTU0","avatar_url":"https://avatars.githubusercontent.com/u/29551954?v=4","gravatar_id":"","url":"https://api.github.com/users/bdlmt","html_url":"https://github.com/bdlmt","followers_url":"https://api.github.com/users/bdlmt/followers","following_url":"https://api.github.com/users/bdlmt/following{/other_user}","gists_url":"https://api.github.com/users/bdlmt/gists{/gist_id}","starred_url":"https://api.github.com/users/bdlmt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdlmt/subscriptions","organizations_url":"https://api.github.com/users/bdlmt/orgs","repos_url":"https://api.github.com/users/bdlmt/repos","events_url":"https://api.github.com/users/bdlmt/events{/privacy}","received_events_url":"https://api.github.com/users/bdlmt/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/811023321","html_url":"https://github.com/BurntSushi/ripgrep/issues/1838#issuecomment-811023321","issue_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/1838","id":811023321,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTAyMzMyMQ==","user":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T12:17:18Z","updated_at":"2021-03-31T12:17:18Z","body":"> (Though, slower than I expected, but maybe that's a side effect of escaping out of Unicode mode to do byte searches with regex.)\r\n\r\nYeah, forcing memory maps when searching a bunch of tiny files actually results in some pretty serious overhead that slows down the entire enterprise.\r\n\r\nIn any case, I am able to reproduce this on my own `/usr/bin` directory, so I'll investigate this as soon as I can. Thanks for the great bug report!","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/811023321/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/811160941","html_url":"https://github.com/BurntSushi/ripgrep/issues/1838#issuecomment-811160941","issue_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/1838","id":811160941,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTE2MDk0MQ==","user":{"login":"bdlmt","id":29551954,"node_id":"MDQ6VXNlcjI5NTUxOTU0","avatar_url":"https://avatars.githubusercontent.com/u/29551954?v=4","gravatar_id":"","url":"https://api.github.com/users/bdlmt","html_url":"https://github.com/bdlmt","followers_url":"https://api.github.com/users/bdlmt/followers","following_url":"https://api.github.com/users/bdlmt/following{/other_user}","gists_url":"https://api.github.com/users/bdlmt/gists{/gist_id}","starred_url":"https://api.github.com/users/bdlmt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdlmt/subscriptions","organizations_url":"https://api.github.com/users/bdlmt/orgs","repos_url":"https://api.github.com/users/bdlmt/repos","events_url":"https://api.github.com/users/bdlmt/events{/privacy}","received_events_url":"https://api.github.com/users/bdlmt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T15:33:56Z","updated_at":"2021-03-31T15:33:56Z","body":"> In any case, I am able to reproduce this on my own `/usr/bin` directory, so I'll investigate this as soon as I can. \r\n\r\nIf I were to attempt to investigate and fix the issue, where's your best guess to start looking?\r\nI'm still new to Rust, but willing to dig in.\r\n\r\n> Thanks for the great bug report!\r\n\r\nNo problem; thank you for creating and maintaining a great project.\r\n\r\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/811160941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bdlmt","id":29551954,"node_id":"MDQ6VXNlcjI5NTUxOTU0","avatar_url":"https://avatars.githubusercontent.com/u/29551954?v=4","gravatar_id":"","url":"https://api.github.com/users/bdlmt","html_url":"https://github.com/bdlmt","followers_url":"https://api.github.com/users/bdlmt/followers","following_url":"https://api.github.com/users/bdlmt/following{/other_user}","gists_url":"https://api.github.com/users/bdlmt/gists{/gist_id}","starred_url":"https://api.github.com/users/bdlmt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdlmt/subscriptions","organizations_url":"https://api.github.com/users/bdlmt/orgs","repos_url":"https://api.github.com/users/bdlmt/repos","events_url":"https://api.github.com/users/bdlmt/events{/privacy}","received_events_url":"https://api.github.com/users/bdlmt/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/811225254","html_url":"https://github.com/BurntSushi/ripgrep/issues/1838#issuecomment-811225254","issue_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/1838","id":811225254,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTIyNTI1NA==","user":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T16:36:22Z","updated_at":"2021-03-31T16:41:34Z","body":"OK, so I took a look at this, and yeesh, this is actually behaving as _intended_. Which is kind of scary, because the UX here is just totally abysmal. This is a perfect storm, basically.\r\n\r\nTL;DR - If you put `--no-mmap` in your ripgrep config file (or alias or whatever), then you'll get consistent behavior. For the specific case of searching for explicit binary data, you almost always want the `-a` flag. Otherwise, a `\\x00` byte will never match anything, by construction.\r\n\r\nSo the top-level issue here is that binary detection/handling fundamentally works differently depending on whether memory maps are used or not.\r\n\r\nThe underlying motivation for binary handling is a desire for ripgrep to treat files as \"text.\" Of course, ripgrep, like any grep, can also search binary files. The main problem is that you generally don't want to _accidentally_ print out results from a binary file because it can muck with your terminal via escape sequences and what not. On top of that, there is the issue that \"text\" files are typically line oriented where as binary data isn't. That means a single \"line\" in a binary data (typically a meaningless concept) can actually be quite large. Since ripgrep requires that each line be able to fit in memory, it uses a trick: it converts `\\x00` bytes into line terminators in an effort to make binary data \"look\" like text. When this happens, the file is also marked as \"binary.\" If a match occurs, you get the \"match found but it's a binary file so we aren't going to print anything\" message.\r\n\r\nOnly looking at the above, we can explain why `rg -uuu 'foo\\x00\\x00'` finds nothing and why `rg -uuu 'foo'` finds something:\r\n\r\n* The third `-u` flag is synonymous with `--binary`. This causes ripgrep to disable auto-filtering of binary data. The main UX concern here is that if no match is found, then one should be able to conclude that no matches exist.\r\n* Since the `-a/--text` flag is _not_ enabled, ripgrep does not treat everything as if it were \"text.\" Instead, it tries to do binary detection. As stated above, this has a dual purpose: to prevent dumping arbitrary binary data to your terminal, but also to avoid using gratuitous amounts of memory for long lines in binary files. Thus, **all `\\x00` bytes in every file searched are rewritten to `\\n` bytes**. This is what explains why `foo\\x00` won't match: `\\x00` can never match because all such bytes are re-mapped to line terminators. But `foo` contains no NUL bytes, and thus can match.\r\n\r\nAll of that behavior was lifted _exactly_ from GNU grep. Including the NUL byte rewriting. However, GNU grep makes it much harder to search for NUL bytes. It doesn't recognize things like `\\x00`, and inserting a NUL byte into a shell string is weird.\r\n\r\nIf that weren't confusing enough as it is, there's another catch here. When you search a single file directly, ripgrep will typically switch over to using memory maps to read the file since it tends to be faster in that case. The issue with memory maps is that we can't apply the above technique in the same way without destroying the performance benefit gained by using memory maps in the first place. In particular:\r\n\r\n1. We can't search the entire file for `\\x00` without adverse consequences. e.g., In particularly big files, in the worst case, this could require reading the entire file twice. When it comes to memory maps, they aren't searched in blocks, but rather, as a single contiguous slice. Thus binary detection is itself different for memory maps.\r\n2. When using memory maps, we never copy the data from the actual file just for searching. Therefore, there is no real opportunity to rewrite `\\x00` bytes as line terminators, even if we could find all such `\\x00` bytes.\r\n\r\nSo, with memory maps, we do binary detection slightly differently:\r\n\r\n1. We look for a `\\x00` byte in the first `N` bytes of a file.\r\n2. When printing matches or contextual lines, we search only those specific lines for a `\\x00` byte. In this way, we prevent dumping binary data to the terminal.\r\n\r\nThus, when you search a file directly, you get matches because ripgrep is using memory maps for searching and thus doesn't rewrite `\\x00` bytes as line terminators. So your pattern finds a hit.\r\n\r\nSo what could we do differently here? I don't think documentation is going to really help much here. It's such an oddball case. We could add to the relevant section on the guide with this particular case study. And in particular, we could say something like, \"add `--no-mmap` to your config file to make binary data handling consistent.\" The performance improvement from memory maps isn't _that_ great, after all.\r\n\r\nIn terms of behavior changes, here are some things I can think of in no particular order. But I also include reasons why they problematic:\r\n\r\n1. We could force the `--no-mmap` strategy to have the same binary handling logic as the `--mmap` strategy. e.g., By only looking for binary data in the first N bytes and otherwise only searching matching lines. This would at least avoid dumping binary data to your terminal. However, this gives up on the heuristic for avoiding large heap usages due to long \"lines\" in binary data. Memory maps don't have this problem since the OS handles paging things in and out of memory transparently. Having the heap explode when searching binary data seems unfortunate.\r\n2. We could get rid of memory maps entirely. The problem here is that they do have some nice perf benefits. They also enable [certain configurations to run very very fast](https://github.com/BurntSushi/ripgrep/blob/master/FAQ.md#pcre2-slow) that wouldn't otherwise be possible without memory maps.\r\n3. We could somehow force the memory map binary handling to match the non-memory map handling. The only way I can think to do this would be to chunk up the memory map, copy data from it and rewrite its bytes like we do in the non-mmap case. But this is adding a lot of extra costs to the memory map handling that we can safely ignore precisely because of the nature of memory maps.\r\n4. We could forcefully disable the use of memory maps whenever `--binary` mode is enabled. But this is enabled by default when searching a specific file, so this would effectively shut off memory maps completely.","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/811225254/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4535954038,"node_id":"MDEyOkxhYmVsZWRFdmVudDQ1MzU5NTQwMzg=","url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/events/4535954038","actor":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2021-03-31T16:41:55Z","label":{"name":"doc","color":"fbca04"},"performed_via_github_app":null},{"id":4535954040,"node_id":"MDEyOkxhYmVsZWRFdmVudDQ1MzU5NTQwNDA=","url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/events/4535954040","actor":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2021-03-31T16:41:55Z","label":{"name":"question","color":"cc317c"},"performed_via_github_app":null},{"id":4536354668,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ1MzYzNTQ2Njg=","url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/events/4536354668","actor":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"7923d252285d78b023a237d669d741dfa210ff86","commit_url":"https://api.github.com/repos/BurntSushi/ripgrep/commits/7923d252285d78b023a237d669d741dfa210ff86","created_at":"2021-03-31T17:55:51Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/811314011","html_url":"https://github.com/BurntSushi/ripgrep/issues/1838#issuecomment-811314011","issue_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/1838","id":811314011,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTMxNDAxMQ==","user":{"login":"bdlmt","id":29551954,"node_id":"MDQ6VXNlcjI5NTUxOTU0","avatar_url":"https://avatars.githubusercontent.com/u/29551954?v=4","gravatar_id":"","url":"https://api.github.com/users/bdlmt","html_url":"https://github.com/bdlmt","followers_url":"https://api.github.com/users/bdlmt/followers","following_url":"https://api.github.com/users/bdlmt/following{/other_user}","gists_url":"https://api.github.com/users/bdlmt/gists{/gist_id}","starred_url":"https://api.github.com/users/bdlmt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdlmt/subscriptions","organizations_url":"https://api.github.com/users/bdlmt/orgs","repos_url":"https://api.github.com/users/bdlmt/repos","events_url":"https://api.github.com/users/bdlmt/events{/privacy}","received_events_url":"https://api.github.com/users/bdlmt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T18:30:57Z","updated_at":"2021-03-31T18:42:08Z","body":"Thank you for your detailed explanation!\r\n\r\n> For the specific case of searching for explicit binary data, you almost always want the -a flag. Otherwise, a \\x00 byte will never match anything, by construction.\r\n\r\nAha! I missed that in the docs. \r\n\r\n> That means a single \"line\" in a binary data (typically a meaningless concept) can actually be quite large. Since ripgrep requires that each line be able to fit in memory, it uses a trick: it converts \\x00 bytes into line terminators in an effort to make binary data \"look\" like text. \r\n\r\nOkay, got it.\r\n\r\n> The third -u flag is synonymous with --binary. \r\n\r\nAfter reading through your response and the man page, I'm not able to rectify this behavior:\r\n```\r\nuser@local:~$ rg -a --binary '(?-u)\\x7f\\x45\\x4c\\x46\\x02\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' /usr/bin | wc -l\r\n0\r\nuser@local:~$ rg -a -uuu '(?-u)\\x7f\\x45\\x4c\\x46\\x02\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' /usr/bin | wc -l\r\n1081\r\nuser@local:~$ rg -a --binary --mmap '(?-u)\\x7f\\x45\\x4c\\x46\\x02\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' /usr/bin | wc -l\r\n1080\r\nuser@local:~$ rg -a -uuu --mmap '(?-u)\\x7f\\x45\\x4c\\x46\\x02\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' /usr/bin | wc -l\r\n1081\r\nuser@local:~$ rg -a --binary --no-mmap '(?-u)\\x7f\\x45\\x4c\\x46\\x02\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' /usr/bin | wc -l\r\n0\r\nuser@local:~$ rg -a -uuu --no-mmap '(?-u)\\x7f\\x45\\x4c\\x46\\x02\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' /usr/bin | wc -l\r\n1081\r\n```\r\n`-uuu` and `--binary` seem to have different behavior when combined with `-a`, `--mmap`, and `--no-mmap`.\r\n\r\nAssuming I understand your explanation correctly, the `-uuu` cases are behaving as expected, while the `--binary` cases don't seem to be.\r\n\r\n(Edit: rearranged the test cases to make more sense side-by-side.)","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/811314011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bdlmt","id":29551954,"node_id":"MDQ6VXNlcjI5NTUxOTU0","avatar_url":"https://avatars.githubusercontent.com/u/29551954?v=4","gravatar_id":"","url":"https://api.github.com/users/bdlmt","html_url":"https://github.com/bdlmt","followers_url":"https://api.github.com/users/bdlmt/followers","following_url":"https://api.github.com/users/bdlmt/following{/other_user}","gists_url":"https://api.github.com/users/bdlmt/gists{/gist_id}","starred_url":"https://api.github.com/users/bdlmt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdlmt/subscriptions","organizations_url":"https://api.github.com/users/bdlmt/orgs","repos_url":"https://api.github.com/users/bdlmt/repos","events_url":"https://api.github.com/users/bdlmt/events{/privacy}","received_events_url":"https://api.github.com/users/bdlmt/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/811369603","html_url":"https://github.com/BurntSushi/ripgrep/issues/1838#issuecomment-811369603","issue_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/1838","id":811369603,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTM2OTYwMw==","user":{"login":"bdlmt","id":29551954,"node_id":"MDQ6VXNlcjI5NTUxOTU0","avatar_url":"https://avatars.githubusercontent.com/u/29551954?v=4","gravatar_id":"","url":"https://api.github.com/users/bdlmt","html_url":"https://github.com/bdlmt","followers_url":"https://api.github.com/users/bdlmt/followers","following_url":"https://api.github.com/users/bdlmt/following{/other_user}","gists_url":"https://api.github.com/users/bdlmt/gists{/gist_id}","starred_url":"https://api.github.com/users/bdlmt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdlmt/subscriptions","organizations_url":"https://api.github.com/users/bdlmt/orgs","repos_url":"https://api.github.com/users/bdlmt/repos","events_url":"https://api.github.com/users/bdlmt/events{/privacy}","received_events_url":"https://api.github.com/users/bdlmt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T19:21:57Z","updated_at":"2021-03-31T19:21:57Z","body":"> In terms of behavior changes, here are some things I can think of in no particular order. But I also include reasons why they problematic:\r\n> \r\n> 1. We could force the --no-mmap strategy to have the same binary handling logic as the --mmap strategy. e.g., By only looking for binary data in the first N bytes and otherwise only searching matching lines. This would at least avoid dumping binary data to your terminal. However, this gives up on the heuristic for avoiding large heap usages due to long \"lines\" in binary data. Memory maps don't have this problem since the OS handles paging things in and out of memory transparently. Having the heap explode when searching binary data seems unfortunate.\r\n> 2. We could get rid of memory maps entirely. The problem here is that they do have some nice perf benefits. They also enable certain configurations to run very very fast that wouldn't otherwise be possible without memory maps.\r\n> 3. We could somehow force the memory map binary handling to match the non-memory map handling. The only way I can think to do this would be to chunk up the memory map, copy data from it and rewrite its bytes like we do in the non-mmap case. But this is adding a lot of extra costs to the memory map handling that we can safely ignore precisely because of the nature of memory maps.\r\n> 4. We could forcefully disable the use of memory maps whenever --binary mode is enabled. But this is enabled by default when searching a specific file, so this would effectively shut off memory maps completely.\r\n\r\nWould it make sense to have this as an option as well?\r\n5. Use memory map mode whenever --binary mode is enabled. Treat a binary file as a long line and let the OS handle paging. No \\x00 replacement overhead would be required, and the heap wouldn't explode on large binaries.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/811369603/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bdlmt","id":29551954,"node_id":"MDQ6VXNlcjI5NTUxOTU0","avatar_url":"https://avatars.githubusercontent.com/u/29551954?v=4","gravatar_id":"","url":"https://api.github.com/users/bdlmt","html_url":"https://github.com/bdlmt","followers_url":"https://api.github.com/users/bdlmt/followers","following_url":"https://api.github.com/users/bdlmt/following{/other_user}","gists_url":"https://api.github.com/users/bdlmt/gists{/gist_id}","starred_url":"https://api.github.com/users/bdlmt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdlmt/subscriptions","organizations_url":"https://api.github.com/users/bdlmt/orgs","repos_url":"https://api.github.com/users/bdlmt/repos","events_url":"https://api.github.com/users/bdlmt/events{/privacy}","received_events_url":"https://api.github.com/users/bdlmt/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/811383975","html_url":"https://github.com/BurntSushi/ripgrep/issues/1838#issuecomment-811383975","issue_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/1838","id":811383975,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTM4Mzk3NQ==","user":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T19:36:18Z","updated_at":"2021-03-31T19:36:18Z","body":"@bdlmt The `-a/--text` and `--binary` flag are mutually exclusive things. They actually override each other. So `-a --binary` enables binary searching while `--binary -a` makes everything searched as if it were text. Of course, the former is equivalent to `--binary` without `-a` and the latter is equivalent to `-a` without `--binary`.\r\n\r\n> 5. Use memory map mode whenever --binary mode is enabled. Treat a binary file as a long line and let the OS handle paging. No `\\x00` replacement overhead would be required, and the heap wouldn't explode on large binaries.\r\n\r\nIt wouldn't. Aside from the downside of this seriously regressing performance when `--binary` is enabled, it's also just plain impossible. Memory maps can only be used in a subset of cases. They can't be used on streams and certain files (like `/proc/cpuinfo`) can't be memory mapped. If it was just a matter of performance regressing, then it would make sense to list it for completeness. But it's actually impossible. Standard `read` syscalls are the only universal way to search data.","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/811383975/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4536913904,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDUzNjkxMzkwNA==","url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/events/4536913904","actor":{"login":"bdlmt","id":29551954,"node_id":"MDQ6VXNlcjI5NTUxOTU0","avatar_url":"https://avatars.githubusercontent.com/u/29551954?v=4","gravatar_id":"","url":"https://api.github.com/users/bdlmt","html_url":"https://github.com/bdlmt","followers_url":"https://api.github.com/users/bdlmt/followers","following_url":"https://api.github.com/users/bdlmt/following{/other_user}","gists_url":"https://api.github.com/users/bdlmt/gists{/gist_id}","starred_url":"https://api.github.com/users/bdlmt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdlmt/subscriptions","organizations_url":"https://api.github.com/users/bdlmt/orgs","repos_url":"https://api.github.com/users/bdlmt/repos","events_url":"https://api.github.com/users/bdlmt/events{/privacy}","received_events_url":"https://api.github.com/users/bdlmt/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-03-31T19:36:18Z","performed_via_github_app":null},{"id":4536913909,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ1MzY5MTM5MDk=","url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/events/4536913909","actor":{"login":"bdlmt","id":29551954,"node_id":"MDQ6VXNlcjI5NTUxOTU0","avatar_url":"https://avatars.githubusercontent.com/u/29551954?v=4","gravatar_id":"","url":"https://api.github.com/users/bdlmt","html_url":"https://github.com/bdlmt","followers_url":"https://api.github.com/users/bdlmt/followers","following_url":"https://api.github.com/users/bdlmt/following{/other_user}","gists_url":"https://api.github.com/users/bdlmt/gists{/gist_id}","starred_url":"https://api.github.com/users/bdlmt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdlmt/subscriptions","organizations_url":"https://api.github.com/users/bdlmt/orgs","repos_url":"https://api.github.com/users/bdlmt/repos","events_url":"https://api.github.com/users/bdlmt/events{/privacy}","received_events_url":"https://api.github.com/users/bdlmt/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-03-31T19:36:18Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/811407343","html_url":"https://github.com/BurntSushi/ripgrep/issues/1838#issuecomment-811407343","issue_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/1838","id":811407343,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMTQwNzM0Mw==","user":{"login":"bdlmt","id":29551954,"node_id":"MDQ6VXNlcjI5NTUxOTU0","avatar_url":"https://avatars.githubusercontent.com/u/29551954?v=4","gravatar_id":"","url":"https://api.github.com/users/bdlmt","html_url":"https://github.com/bdlmt","followers_url":"https://api.github.com/users/bdlmt/followers","following_url":"https://api.github.com/users/bdlmt/following{/other_user}","gists_url":"https://api.github.com/users/bdlmt/gists{/gist_id}","starred_url":"https://api.github.com/users/bdlmt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdlmt/subscriptions","organizations_url":"https://api.github.com/users/bdlmt/orgs","repos_url":"https://api.github.com/users/bdlmt/repos","events_url":"https://api.github.com/users/bdlmt/events{/privacy}","received_events_url":"https://api.github.com/users/bdlmt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T19:58:37Z","updated_at":"2021-03-31T19:58:37Z","body":"> The `-a/--text` and `--binary` flag are mutually exclusive things. They actually override each other. So `-a --binary` enables binary searching while `--binary -a` makes everything searched as if it were text. Of course, the former is equivalent to `--binary` without `-a` and the latter is equivalent to `-a` without `--binary`.\r\n\r\nI see now. I read the man page incorrectly. I misunderstood this line under `--binary`:\r\n```\r\nThis flag can be disabled with --no-binary. It overrides the -a/--text flag.\r\n```\r\n\r\nI thought \"It\" referred to `--no-binary`, not `--binary`. I should have realized I had it wrong, based on the intended nature of `-a/--text` and `--binary`.\r\n\r\n> They can't be used on streams and certain files (like /proc/cpuinfo) can't be memory mapped.\r\n\r\nGood point; I wasn't thinking far enough outside my recent use case.\r\n\r\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/811407343/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bdlmt","id":29551954,"node_id":"MDQ6VXNlcjI5NTUxOTU0","avatar_url":"https://avatars.githubusercontent.com/u/29551954?v=4","gravatar_id":"","url":"https://api.github.com/users/bdlmt","html_url":"https://github.com/bdlmt","followers_url":"https://api.github.com/users/bdlmt/followers","following_url":"https://api.github.com/users/bdlmt/following{/other_user}","gists_url":"https://api.github.com/users/bdlmt/gists{/gist_id}","starred_url":"https://api.github.com/users/bdlmt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdlmt/subscriptions","organizations_url":"https://api.github.com/users/bdlmt/orgs","repos_url":"https://api.github.com/users/bdlmt/repos","events_url":"https://api.github.com/users/bdlmt/events{/privacy}","received_events_url":"https://api.github.com/users/bdlmt/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/812102320","html_url":"https://github.com/BurntSushi/ripgrep/issues/1838#issuecomment-812102320","issue_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/1838","id":812102320,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjEwMjMyMA==","user":{"login":"bdlmt","id":29551954,"node_id":"MDQ6VXNlcjI5NTUxOTU0","avatar_url":"https://avatars.githubusercontent.com/u/29551954?v=4","gravatar_id":"","url":"https://api.github.com/users/bdlmt","html_url":"https://github.com/bdlmt","followers_url":"https://api.github.com/users/bdlmt/followers","following_url":"https://api.github.com/users/bdlmt/following{/other_user}","gists_url":"https://api.github.com/users/bdlmt/gists{/gist_id}","starred_url":"https://api.github.com/users/bdlmt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdlmt/subscriptions","organizations_url":"https://api.github.com/users/bdlmt/orgs","repos_url":"https://api.github.com/users/bdlmt/repos","events_url":"https://api.github.com/users/bdlmt/events{/privacy}","received_events_url":"https://api.github.com/users/bdlmt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-01T18:48:54Z","updated_at":"2021-04-01T18:48:54Z","body":"> 1. We could force the --no-mmap strategy to have the same binary handling logic as the --mmap strategy. e.g., By only looking for binary data in the first N bytes and otherwise only searching matching lines. This would at least avoid dumping binary data to your terminal. However, this gives up on the heuristic for avoiding large heap usages due to long \"lines\" in binary data. Memory maps don't have this problem since the OS handles paging things in and out of memory transparently. Having the heap explode when searching binary data seems unfortunate.\r\n\r\nFrom a UX point of view, behavior change option **1** seems best. Mixing `-a/--text` with `-uuu` to enable text mode during a binary search in order to successfully match on raw `\\x00` bytes is a bit awkward and not intuitive. The change would also address the unexpected disparity between using `-a/--text` with `--binary` (mutually exclusive) vs. using `-a/--text` with `-uuu` (text mode enabled on binaries), because `-a/--text` would no longer be necessary when matching on `\\x00` bytes.\r\n\r\nFrom a performance point of view, it seems like leaving it as-is would be best, unless there's a way to split a binary file into multiple \"lines\" without replacing bytes.\r\n\r\nAs a user, I like the sound of improving the UX, but obviously not if there's a significant performance hit.\r\n\r\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/comments/812102320/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bdlmt","id":29551954,"node_id":"MDQ6VXNlcjI5NTUxOTU0","avatar_url":"https://avatars.githubusercontent.com/u/29551954?v=4","gravatar_id":"","url":"https://api.github.com/users/bdlmt","html_url":"https://github.com/bdlmt","followers_url":"https://api.github.com/users/bdlmt/followers","following_url":"https://api.github.com/users/bdlmt/following{/other_user}","gists_url":"https://api.github.com/users/bdlmt/gists{/gist_id}","starred_url":"https://api.github.com/users/bdlmt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bdlmt/subscriptions","organizations_url":"https://api.github.com/users/bdlmt/orgs","repos_url":"https://api.github.com/users/bdlmt/repos","events_url":"https://api.github.com/users/bdlmt/events{/privacy}","received_events_url":"https://api.github.com/users/bdlmt/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11061035791,"node_id":"REFE_lADOAzJbyc4yZz1vzwAAAAKTSgMP","url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/events/11061035791","actor":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"630456869d09439a63f63094f5065eef4a43bc2e","commit_url":"https://api.github.com/repos/BurntSushi/ripgrep/commits/630456869d09439a63f63094f5065eef4a43bc2e","created_at":"2023-11-25T15:40:57Z","performed_via_github_app":null},{"id":11061035808,"node_id":"LE_lADOAzJbyc4yZz1vzwAAAAKTSgMg","url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/events/11061035808","actor":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-11-25T15:40:58Z","label":{"name":"rollup","color":"ffccee"},"performed_via_github_app":null},{"id":11061380268,"node_id":"CE_lADOAzJbyc4yZz1vzwAAAAKTT0Ss","url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/events/11061380268","actor":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"9ed7565fcb47d02e76398d41f24ba0817f6b9c2f","commit_url":"https://api.github.com/repos/BurntSushi/ripgrep/commits/9ed7565fcb47d02e76398d41f24ba0817f6b9c2f","created_at":"2023-11-25T20:04:00Z","state_reason":null,"performed_via_github_app":null},{"actor":{"login":"sankalp-khare","id":962615,"node_id":"MDQ6VXNlcjk2MjYxNQ==","avatar_url":"https://avatars.githubusercontent.com/u/962615?v=4","gravatar_id":"","url":"https://api.github.com/users/sankalp-khare","html_url":"https://github.com/sankalp-khare","followers_url":"https://api.github.com/users/sankalp-khare/followers","following_url":"https://api.github.com/users/sankalp-khare/following{/other_user}","gists_url":"https://api.github.com/users/sankalp-khare/gists{/gist_id}","starred_url":"https://api.github.com/users/sankalp-khare/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sankalp-khare/subscriptions","organizations_url":"https://api.github.com/users/sankalp-khare/orgs","repos_url":"https://api.github.com/users/sankalp-khare/repos","events_url":"https://api.github.com/users/sankalp-khare/events{/privacy}","received_events_url":"https://api.github.com/users/sankalp-khare/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-26T20:57:25Z","updated_at":"2023-11-26T20:57:25Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/Homebrew/homebrew-core/issues/155592","repository_url":"https://api.github.com/repos/Homebrew/homebrew-core","labels_url":"https://api.github.com/repos/Homebrew/homebrew-core/issues/155592/labels{/name}","comments_url":"https://api.github.com/repos/Homebrew/homebrew-core/issues/155592/comments","events_url":"https://api.github.com/repos/Homebrew/homebrew-core/issues/155592/events","html_url":"https://github.com/Homebrew/homebrew-core/pull/155592","id":2011202062,"node_id":"PR_kwDOAyaC3M5gYeMZ","number":155592,"title":"ripgrep 14.0.0","user":{"login":"sankalp-khare","id":962615,"node_id":"MDQ6VXNlcjk2MjYxNQ==","avatar_url":"https://avatars.githubusercontent.com/u/962615?v=4","gravatar_id":"","url":"https://api.github.com/users/sankalp-khare","html_url":"https://github.com/sankalp-khare","followers_url":"https://api.github.com/users/sankalp-khare/followers","following_url":"https://api.github.com/users/sankalp-khare/following{/other_user}","gists_url":"https://api.github.com/users/sankalp-khare/gists{/gist_id}","starred_url":"https://api.github.com/users/sankalp-khare/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sankalp-khare/subscriptions","organizations_url":"https://api.github.com/users/sankalp-khare/orgs","repos_url":"https://api.github.com/users/sankalp-khare/repos","events_url":"https://api.github.com/users/sankalp-khare/events{/privacy}","received_events_url":"https://api.github.com/users/sankalp-khare/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":624617309,"node_id":"MDU6TGFiZWw2MjQ2MTczMDk=","url":"https://api.github.com/repos/Homebrew/homebrew-core/labels/rust","name":"rust","color":"bfe5bf","default":false,"description":"Rust use is a significant feature of the PR or issue"},{"id":778631352,"node_id":"MDU6TGFiZWw3Nzg2MzEzNTI=","url":"https://api.github.com/repos/Homebrew/homebrew-core/labels/ready%20to%20merge","name":"ready to merge","color":"0e8a16","default":false,"description":"PR can be merged once CI is green"},{"id":921363785,"node_id":"MDU6TGFiZWw5MjEzNjM3ODU=","url":"https://api.github.com/repos/Homebrew/homebrew-core/labels/outdated","name":"outdated","color":"d93f0b","default":false,"description":"PR was locked due to age"},{"id":2983832093,"node_id":"MDU6TGFiZWwyOTgzODMyMDkz","url":"https://api.github.com/repos/Homebrew/homebrew-core/labels/bump-formula-pr","name":"bump-formula-pr","color":"606060","default":false,"description":"PR was created using `brew bump-formula-pr`"},{"id":5278102982,"node_id":"LA_kwDOAyaC3M8AAAABOpl1xg","url":"https://api.github.com/repos/Homebrew/homebrew-core/labels/CI-published-bottle-commits","name":"CI-published-bottle-commits","color":"0E8A16","default":false,"description":"The commits for the built bottles have been pushed to the PR branch."}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2023-11-26T20:57:24Z","updated_at":"2023-12-27T00:02:09Z","closed_at":"2023-11-26T23:17:53Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":"resolved","draft":false,"repository":{"id":52855516,"node_id":"MDEwOlJlcG9zaXRvcnk1Mjg1NTUxNg==","name":"homebrew-core","full_name":"Homebrew/homebrew-core","private":false,"owner":{"login":"Homebrew","id":1503512,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE1MDM1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1503512?v=4","gravatar_id":"","url":"https://api.github.com/users/Homebrew","html_url":"https://github.com/Homebrew","followers_url":"https://api.github.com/users/Homebrew/followers","following_url":"https://api.github.com/users/Homebrew/following{/other_user}","gists_url":"https://api.github.com/users/Homebrew/gists{/gist_id}","starred_url":"https://api.github.com/users/Homebrew/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Homebrew/subscriptions","organizations_url":"https://api.github.com/users/Homebrew/orgs","repos_url":"https://api.github.com/users/Homebrew/repos","events_url":"https://api.github.com/users/Homebrew/events{/privacy}","received_events_url":"https://api.github.com/users/Homebrew/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/Homebrew/homebrew-core","description":" Default formulae for the missing package manager for macOS (or Linux)","fork":false,"url":"https://api.github.com/repos/Homebrew/homebrew-core","forks_url":"https://api.github.com/repos/Homebrew/homebrew-core/forks","keys_url":"https://api.github.com/repos/Homebrew/homebrew-core/keys{/key_id}","collaborators_url":"https://api.github.com/repos/Homebrew/homebrew-core/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/Homebrew/homebrew-core/teams","hooks_url":"https://api.github.com/repos/Homebrew/homebrew-core/hooks","issue_events_url":"https://api.github.com/repos/Homebrew/homebrew-core/issues/events{/number}","events_url":"https://api.github.com/repos/Homebrew/homebrew-core/events","assignees_url":"https://api.github.com/repos/Homebrew/homebrew-core/assignees{/user}","branches_url":"https://api.github.com/repos/Homebrew/homebrew-core/branches{/branch}","tags_url":"https://api.github.com/repos/Homebrew/homebrew-core/tags","blobs_url":"https://api.github.com/repos/Homebrew/homebrew-core/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/Homebrew/homebrew-core/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/Homebrew/homebrew-core/git/refs{/sha}","trees_url":"https://api.github.com/repos/Homebrew/homebrew-core/git/trees{/sha}","statuses_url":"https://api.github.com/repos/Homebrew/homebrew-core/statuses/{sha}","languages_url":"https://api.github.com/repos/Homebrew/homebrew-core/languages","stargazers_url":"https://api.github.com/repos/Homebrew/homebrew-core/stargazers","contributors_url":"https://api.github.com/repos/Homebrew/homebrew-core/contributors","subscribers_url":"https://api.github.com/repos/Homebrew/homebrew-core/subscribers","subscription_url":"https://api.github.com/repos/Homebrew/homebrew-core/subscription","commits_url":"https://api.github.com/repos/Homebrew/homebrew-core/commits{/sha}","git_commits_url":"https://api.github.com/repos/Homebrew/homebrew-core/git/commits{/sha}","comments_url":"https://api.github.com/repos/Homebrew/homebrew-core/comments{/number}","issue_comment_url":"https://api.github.com/repos/Homebrew/homebrew-core/issues/comments{/number}","contents_url":"https://api.github.com/repos/Homebrew/homebrew-core/contents/{+path}","compare_url":"https://api.github.com/repos/Homebrew/homebrew-core/compare/{base}...{head}","merges_url":"https://api.github.com/repos/Homebrew/homebrew-core/merges","archive_url":"https://api.github.com/repos/Homebrew/homebrew-core/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/Homebrew/homebrew-core/downloads","issues_url":"https://api.github.com/repos/Homebrew/homebrew-core/issues{/number}","pulls_url":"https://api.github.com/repos/Homebrew/homebrew-core/pulls{/number}","milestones_url":"https://api.github.com/repos/Homebrew/homebrew-core/milestones{/number}","notifications_url":"https://api.github.com/repos/Homebrew/homebrew-core/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/Homebrew/homebrew-core/labels{/name}","releases_url":"https://api.github.com/repos/Homebrew/homebrew-core/releases{/id}","deployments_url":"https://api.github.com/repos/Homebrew/homebrew-core/deployments","created_at":"2016-03-01T06:58:36Z","updated_at":"2025-11-09T23:51:33Z","pushed_at":"2025-11-09T23:58:21Z","git_url":"git://github.com/Homebrew/homebrew-core.git","ssh_url":"git@github.com:Homebrew/homebrew-core.git","clone_url":"https://github.com/Homebrew/homebrew-core.git","svn_url":"https://github.com/Homebrew/homebrew-core","homepage":"https://brew.sh","size":1043335,"stargazers_count":14795,"watchers_count":14795,"language":"Ruby","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":13181,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":78,"license":{"key":"bsd-2-clause","name":"BSD 2-Clause \"Simplified\" License","spdx_id":"BSD-2-Clause","url":"https://api.github.com/licenses/bsd-2-clause","node_id":"MDc6TGljZW5zZTQ="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["core","formulae","hacktoberfest","homebrew","ruby","tap"],"visibility":"public","forks":13181,"open_issues":78,"watchers":14795,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/Homebrew/homebrew-core/pulls/155592","html_url":"https://github.com/Homebrew/homebrew-core/pull/155592","diff_url":"https://github.com/Homebrew/homebrew-core/pull/155592.diff","patch_url":"https://github.com/Homebrew/homebrew-core/pull/155592.patch","merged_at":"2023-11-26T23:17:53Z"},"body":"Created by `brew bump`\n\n---\n\nCreated with `brew bump-formula-pr`.<details>\n  <summary>release notes</summary>\n  <pre>ripgrep 14 is a new major version release of ripgrep that has some new\r\nfeatures, performance improvements and a lot of bug fixes.\r\n\r\n> In case you haven't heard of it before, ripgrep is a line-oriented search\r\n> tool that recursively searches the current directory for a regex pattern.\r\n> By default, ripgrep will respect gitignore rules and automatically skip\r\n> hidden files/directories and binary files.\r\n\r\nThe headling feature in this release is hyperlink support. In this release,\r\nthey are an opt-in feature but may change to an opt-out feature in the future.\r\nTo enable them, try passing `--hyperlink-format default`. If you use [VS Code],\r\nthen try passing `--hyperlink-format vscode`. Please [report your experience\r\nwith hyperlinks][report-hyperlinks], positive or negative.\r\n\r\n[VS Code]: https://code.visualstudio.com/\r\n[report-hyperlinks]: https://github.com/BurntSushi/ripgrep/discussions/2611\r\n\r\nAnother headling development in this release is that it contains a rewrite of\r\nits regex engine. You generally shouldn't notice any changes, except for some\r\nsearches may get faster. You can read more about the [regex engine rewrite on\r\nmy blog][regex-internals]. Please [report your performance improvements or\r\nregressions that you notice][report-perf].\r\n\r\n[report-perf]: https://github.com/BurntSushi/ripgrep/discussions/2652\r\n\r\nFinally, ripgrep switched the library it uses for argument parsing. Users\r\nshould not notice a difference in most cases (error messages have changed\r\nsomewhat), but flag overrides should generally be more consistent. For example,\r\nthings like `--no-ignore --ignore-vcs` work as one would expect (disables all\r\nfiltering related to ignore rules except for rules found in version control\r\nsystems such as `git`).\r\n\r\n[regex-internals]: https://blog.burntsushi.net/regex-internals/\r\n\r\n**BREAKING CHANGES**:\r\n\r\n* `rg -C1 -A2` used to be equivalent to `rg -A2`, but now it is equivalent to\r\n  `rg -B1 -A2`. That is, `-A` and `-B` no longer completely override `-C`.\r\n  Instead, they only partially override `-C`.\r\n\r\nBuild process changes:\r\n\r\n* ripgrep's shell completions and man page are now created by running ripgrep\r\nwith a new `--generate` flag. For example, `rg --generate man` will write a\r\nman page in `roff` format on stdout. The release archives have not changed.\r\n* The optional build dependency on `asciidoc` or `asciidoctor` has been\r\ndropped. Previously, it was used to produce ripgrep's man page. ripgrep now\r\nowns this process itself by writing `roff` directly.\r\n\r\nPerformance improvements:\r\n\r\n* [PERF #1746](https://github.com/BurntSushi/ripgrep/issues/1746):\r\n  Make some cases with inner literals faster.\r\n* [PERF #1760](https://github.com/BurntSushi/ripgrep/issues/1760):\r\n  Make most searches with `\\b` look-arounds (among others) much faster.\r\n* [PERF #2591](https://github.com/BurntSushi/ripgrep/pull/2591):\r\n  Parallel directory traversal now uses work stealing for faster searches.\r\n* [PERF #2642](https://github.com/BurntSushi/ripgrep/pull/2642):\r\n  Parallel directory traversal has some contention reduced.\r\n\r\nFeature enhancements:\r\n\r\n* Added or improved file type filtering for Ada, DITA, Elixir, Fuchsia, Gentoo,\r\n  Gradle, GraphQL, Markdown, Prolog, Raku, TypeScript, USD, V\r\n* [FEATURE #665](https://github.com/BurntSushi/ripgrep/issues/665):\r\n  Add a new `--hyperlink-format` flag that turns file paths into hyperlinks.\r\n* [FEATURE #1709](https://github.com/BurntSushi/ripgrep/issues/1709):\r\n  Improve documentation of ripgrep's behavior when stdout is a tty.\r\n* [FEATURE #1737](https://github.com/BurntSushi/ripgrep/issues/1737):\r\n  Provide binaries for Apple silicon.\r\n* [FEATURE #1790](https://github.com/BurntSushi/ripgrep/issues/1790):\r\n  Add new `--stop-on-nonmatch` flag.\r\n* [FEATURE #1814](https://github.com/BurntSushi/ripgrep/issues/1814):\r\n  Flags are now categorized in `-h/--help` output and ripgrep's man page.\r\n* [FEATURE #1838](https://github.com/BurntSushi/ripgrep/issues/1838):\r\n  An error is shown when searching for NUL bytes with binary detection enabled.\r\n* [FEATURE #2195](https://github.com/BurntSushi/ripgrep/issues/2195):\r\n  When `extra-verbose` mode is enabled in zsh, show extra file type info.\r\n* [FEATURE #2298](https://github.com/BurntSushi/ripgrep/issues/2298):\r\n  Add instructions for installing ripgrep using `cargo binstall`.\r\n* [FEATURE #2409](https://github.com/BurntSushi/ripgrep/pull/2409):\r\n  Added installation instructions for `winget`.\r\n* [FEATURE #2425](https://github.com/BurntSushi/ripgrep/pull/2425):\r\n  Shell completions (and man page) can be created via `rg --generate`.\r\n* [FEATURE #2524](https://github.com/BurntSushi/ripgrep/issues/2524):\r\n  The `--debug` flag now indicates whether stdin or `./` is being searched.\r\n* [FEATURE #2643](https://github.com/BurntSushi/ripgrep/issues/2643):\r\n  Make `-d` a short flag for `--max-depth`.\r\n* [FEATURE #2645](https://github.com/BurntSushi/ripgrep/issues/2645):\r\n  The `--version` output will now also contain PCRE2 availability information.\r\n\r\nBug fixes:\r\n\r\n* [BUG #884](https://github.com/BurntSushi/ripgrep/issues/884):\r\n  Don't error when `-v/--invert-match` is used multiple times.\r\n* [BUG #1275](https://github.com/BurntSushi/ripgrep/issues/1275):\r\n  Fix bug with `\\b` assertion in the regex engine.\r\n* [BUG #1376](https://github.com/BurntSushi/ripgrep/issues/1376):\r\n  Using `--no-ignore --ignore-vcs` now works as one would expect.\r\n* [BUG #1622](https://github.com/BurntSushi/ripgrep/issues/1622):\r\n  Add note about error messages to `-z/--search-zip` documentation.\r\n* [BUG #1648](https://github.com/BurntSushi/ripgrep/issues/1648):\r\n  Fix bug where sometimes short flags with values, e.g., `-M 900`, would fail.\r\n* [BUG #1701](https://github.com/BurntSushi/ripgrep/issues/1701):\r\n  Fix bug where some flags could not be repeated.\r\n* [BUG #1757](https://github.com/BurntSushi/ripgrep/issues/1757):\r\n  Fix bug when searching a sub-directory didn't have ignores applied correctly.\r\n* [BUG #1891](https://github.com/BurntSushi/ripgrep/issues/1891):\r\n  Fix bug when using `-w` with a regex that can match the empty string.\r\n* [BUG #1911](https://github.com/BurntSushi/ripgrep/issues/1911):\r\n  Disable mmap searching in all non-64-bit environments.\r\n* [BUG #1966](https://github.com/BurntSushi/ripgrep/issues/1966):\r\n  Fix bug where ripgrep can panic when printing to stderr.\r\n* [BUG #2046](https://github.com/BurntSushi/ripgrep/issues/2046):\r\n  Clarify that `--pre` can accept any kind of path in the documentation.\r\n* [BUG #2108](https://github.com/BurntSushi/ripgrep/issues/2108):\r\n  Improve docs for `-r/--replace` syntax.\r\n* [BUG #2198](https://github.com/BurntSushi/ripgrep/issues/2198):\r\n  Fix bug where `--no-ignore-dot` would not ignore `.rgignore`.\r\n* [BUG #2201](https://github.com/BurntSushi/ripgrep/issues/2201):\r\n  Improve docs for `-r/--replace` flag.\r\n* [BUG #2288](https://github.com/BurntSushi/ripgrep/issues/2288):\r\n  `-A` and `-B` now only each partially override `-C`.\r\n* [BUG #2236](https://github.com/BurntSushi/ripgrep/issues/2236):\r\n  Fix gitignore parsing bug where a trailing `\\/` resulted in an error.\r\n* [BUG #2243](https://github.com/BurntSushi/ripgrep/issues/2243):\r\n  Fix `--sort` flag for values other than `path`.\r\n* [BUG #2246](https://github.com/BurntSushi/ripgrep/issues/2246):\r\n  Add note in `--debug` logs when binary files are ignored.\r\n* [BUG #2337](https://github.com/BurntSushi/ripgrep/issues/2337):\r\n  Improve docs to mention that `--stats` is always implied by `--json`.\r\n* [BUG #2381](https://github.com/BurntSushi/ripgrep/issues/2381):\r\n  Make `-p/--pretty` override flags like `--no-line-number`.\r\n* [BUG #2392](https://github.com/BurntSushi/ripgrep/issues/2392):\r\n  Improve global git config parsing of the `excludesFile` field.\r\n* [BUG #2418](https://github.com/BurntSushi/ripgrep/pull/2418):\r\n  Clarify sorting semantics of `--sort=path`.\r\n* [BUG #2458](https://github.com/BurntSushi/ripgrep/pull/2458):\r\n  Make `--trim` run before `-M/--max-columns` takes effect.\r\n* [BUG #2479](https://github.com/BurntSushi/ripgrep/issues/2479):\r\n  Add documentation about `.ignore`/`.rgignore` files in parent directories.\r\n* [BUG #2480](https://github.com/BurntSushi/ripgrep/issues/2480):\r\n  Fix bug when using inline regex flags with `-e/--regexp`.\r\n* [BUG #2505](https://github.com/BurntSushi/ripgrep/issues/2505):\r\n  Improve docs for `--vimgrep` by mentioning footguns and some work-arounds.\r\n* [BUG #2519](https://github.com/BurntSushi/ripgrep/issues/2519):\r\n  Fix incorrect default value in documentation for `--field-match-separator`.\r\n* [BUG #2523](https://github.com/BurntSushi/ripgrep/issues/2523):\r\n  Make executable searching take `.com` into account on Windows.\r\n* [BUG #2574](https://github.com/BurntSushi/ripgrep/issues/2574):\r\n  Fix bug in `-w/--word-regexp` that would result in incorrect match offsets.\r\n* [BUG #2623](https://github.com/BurntSushi/ripgrep/issues/2623):\r\n  Fix a number of bugs with the `-w/--word-regexp` flag.\r\n* [BUG #2636](https://github.com/BurntSushi/ripgrep/pull/2636):\r\n  Strip release binaries for macOS.</pre>\n</details>\n\n\n","reactions":{"url":"https://api.github.com/repos/Homebrew/homebrew-core/issues/155592/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Homebrew/homebrew-core/issues/155592/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":11082621255,"node_id":"REFE_lADOAzJbyc4yZz1vzwAAAAKUk2FH","url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/events/11082621255","actor":{"login":"netbsd-srcmastr","id":27641251,"node_id":"MDQ6VXNlcjI3NjQxMjUx","avatar_url":"https://avatars.githubusercontent.com/u/27641251?v=4","gravatar_id":"","url":"https://api.github.com/users/netbsd-srcmastr","html_url":"https://github.com/netbsd-srcmastr","followers_url":"https://api.github.com/users/netbsd-srcmastr/followers","following_url":"https://api.github.com/users/netbsd-srcmastr/following{/other_user}","gists_url":"https://api.github.com/users/netbsd-srcmastr/gists{/gist_id}","starred_url":"https://api.github.com/users/netbsd-srcmastr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/netbsd-srcmastr/subscriptions","organizations_url":"https://api.github.com/users/netbsd-srcmastr/orgs","repos_url":"https://api.github.com/users/netbsd-srcmastr/repos","events_url":"https://api.github.com/users/netbsd-srcmastr/events{/privacy}","received_events_url":"https://api.github.com/users/netbsd-srcmastr/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"3d89a0083ce5495fcb9ca9e744f2fe3097f071c5","commit_url":"https://api.github.com/repos/NetBSD/pkgsrc/commits/3d89a0083ce5495fcb9ca9e744f2fe3097f071c5","created_at":"2023-11-28T11:59:17Z","performed_via_github_app":null},{"id":11656583189,"node_id":"REFE_lADOAzJbyc4yZz1vzwAAAAK2yVgV","url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/events/11656583189","actor":{"login":"liqipeng","id":6264774,"node_id":"MDQ6VXNlcjYyNjQ3NzQ=","avatar_url":"https://avatars.githubusercontent.com/u/6264774?v=4","gravatar_id":"","url":"https://api.github.com/users/liqipeng","html_url":"https://github.com/liqipeng","followers_url":"https://api.github.com/users/liqipeng/followers","following_url":"https://api.github.com/users/liqipeng/following{/other_user}","gists_url":"https://api.github.com/users/liqipeng/gists{/gist_id}","starred_url":"https://api.github.com/users/liqipeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liqipeng/subscriptions","organizations_url":"https://api.github.com/users/liqipeng/orgs","repos_url":"https://api.github.com/users/liqipeng/repos","events_url":"https://api.github.com/users/liqipeng/events{/privacy}","received_events_url":"https://api.github.com/users/liqipeng/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"9ed7565fcb47d02e76398d41f24ba0817f6b9c2f","commit_url":"https://api.github.com/repos/liqipeng/rust-ripgrep/commits/9ed7565fcb47d02e76398d41f24ba0817f6b9c2f","created_at":"2024-01-31T14:27:45Z","performed_via_github_app":null}]