{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/617","repository_url":"https://api.github.com/repos/BurntSushi/ripgrep","labels_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/617/labels{/name}","comments_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/617/comments","events_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/617/events","html_url":"https://github.com/BurntSushi/ripgrep/issues/617","id":261860337,"node_id":"MDU6SXNzdWUyNjE4NjAzMzc=","number":617,"title":"Slower than grep: test case on 10M-line text file","user":{"login":"goblin","id":2834,"node_id":"MDQ6VXNlcjI4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/2834?v=4","gravatar_id":"","url":"https://api.github.com/users/goblin","html_url":"https://github.com/goblin","followers_url":"https://api.github.com/users/goblin/followers","following_url":"https://api.github.com/users/goblin/following{/other_user}","gists_url":"https://api.github.com/users/goblin/gists{/gist_id}","starred_url":"https://api.github.com/users/goblin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/goblin/subscriptions","organizations_url":"https://api.github.com/users/goblin/orgs","repos_url":"https://api.github.com/users/goblin/repos","events_url":"https://api.github.com/users/goblin/events{/privacy}","received_events_url":"https://api.github.com/users/goblin/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2017-09-30T17:54:23Z","updated_at":"2017-12-30T21:00:40Z","closed_at":"2017-10-15T21:29:56Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"On your blog you're asking to file an issue with something you can reproduce, so here we go.\r\n\r\nRipgrep 0.60 -AVX -SIMD is slower than GNU grep 2.27 when searching for the last line in a tmpfs-mounted 620MiB file containing 64-character lines, as shown in this log:\r\n\r\n```\r\nuser@host:~$ sudo mount -t tmpfs none k\r\nuser@host:~$ cd k\r\nuser@host:~/k$ dd if=/dev/urandom bs=32 count=10000000 | xxd -ps -c32 > file\r\n10000000+0 records in\r\n10000000+0 records out\r\n320000000 bytes (320 MB, 305 MiB) copied, 6.44868 s, 49.6 MB/s\r\nuser@host:~/k$ grep --version\r\ngrep (GNU grep) 2.27\r\nCopyright (C) 2016 Free Software Foundation, Inc.\r\nLicense GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>.\r\nThis is free software: you are free to change and redistribute it.\r\nThere is NO WARRANTY, to the extent permitted by law.\r\n\r\nWritten by Mike Haertel and others, see <http://git.sv.gnu.org/cgit/grep.git/tree/AUTHORS>.\r\nuser@host:~/k$ ../ripgrep/target/release/rg --version\r\nripgrep 0.6.0\r\n-AVX -SIMD\r\nuser@host:~/k$ tail -n1 file \r\n01515049ee5ab42240db3cb6b288f29a68ce9f027219f6e65a63f284ba4d9a76\r\nuser@host:~/k$ time grep 01515049ee5ab42240db3cb6b288f29a68ce9f027219f6e65a63f284ba4d9a76 file\r\n01515049ee5ab42240db3cb6b288f29a68ce9f027219f6e65a63f284ba4d9a76\r\n\r\nreal    0m0.440s\r\nuser    0m0.308s\r\nsys     0m0.128s\r\nuser@host:~/k$ time ../ripgrep/target/release/rg -N 01515049ee5ab42240db3cb6b288f29a68ce9f027219f6e65a63f284ba4d9a76 file\r\n01515049ee5ab42240db3cb6b288f29a68ce9f027219f6e65a63f284ba4d9a76\r\n\r\nreal    0m0.728s\r\nuser    0m0.708s\r\nsys     0m0.016s\r\nuser@host:~/k$ \r\n\r\n```\r\n\r\nSubsequent executions show similar timings.","closed_by":{"login":"BurntSushi","id":456674,"node_id":"MDQ6VXNlcjQ1NjY3NA==","avatar_url":"https://avatars.githubusercontent.com/u/456674?v=4","gravatar_id":"","url":"https://api.github.com/users/BurntSushi","html_url":"https://github.com/BurntSushi","followers_url":"https://api.github.com/users/BurntSushi/followers","following_url":"https://api.github.com/users/BurntSushi/following{/other_user}","gists_url":"https://api.github.com/users/BurntSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/BurntSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BurntSushi/subscriptions","organizations_url":"https://api.github.com/users/BurntSushi/orgs","repos_url":"https://api.github.com/users/BurntSushi/repos","events_url":"https://api.github.com/users/BurntSushi/events{/privacy}","received_events_url":"https://api.github.com/users/BurntSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/617/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/BurntSushi/ripgrep/issues/617/timeline","performed_via_github_app":null,"state_reason":"completed"}