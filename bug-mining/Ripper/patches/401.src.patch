diff --git a/crates/core/messages.rs b/crates/core/messages.rs
index ea514c1..2f72350 100644
--- a/crates/core/messages.rs
+++ b/crates/core/messages.rs
@@ -39,21 +39,29 @@ macro_rules! eprintln_locked {
             // lock stdout before printing to stderr. This avoids interleaving
             // lines within ripgrep because `search_parallel` uses `termcolor`,
             // which accesses the same stdout lock when writing lines.
-            let stdout = std::io::stdout();
-            let _handle = stdout.lock();
+            let stdout = std::io::stdout().lock();
+            let mut stderr = std::io::stderr().lock();
             // We specifically ignore any errors here. One plausible error we
             // can get in some cases is a broken pipe error. And when that
             // occurs, we should exit gracefully. Otherwise, just abort with
             // an error code because there isn't much else we can do.
             //
             // See: https://github.com/BurntSushi/ripgrep/issues/1966
-            if let Err(err) = writeln!(std::io::stderr(), $($tt)*) {
+            if let Err(err) = write!(stderr, "rg: ") {
                 if err.kind() == std::io::ErrorKind::BrokenPipe {
                     std::process::exit(0);
                 } else {
                     std::process::exit(2);
                 }
             }
+            if let Err(err) = writeln!(stderr, $($tt)*) {
+                if err.kind() == std::io::ErrorKind::BrokenPipe {
+                    std::process::exit(0);
+                } else {
+                    std::process::exit(2);
+                }
+            }
+            drop(stdout);
         }
     }}
 }
diff --git a/tests/feature.rs b/tests/feature.rs
index 5a2cff4..680bacd 100644
--- a/tests/feature.rs
+++ b/tests/feature.rs
@@ -975,7 +975,7 @@ rgtest!(f1404_nothing_searched_warning, |dir: Dir, mut cmd: TestCommand| {
     let output = cmd.raw_output();
     let stderr = String::from_utf8_lossy(&output.stderr);
     let expected = "\
-        No files were searched, which means ripgrep probably applied \
+        rg: No files were searched, which means ripgrep probably applied \
         a filter you didn't expect.\n\
         Running with --debug will show why files are being skipped.\n\
     ";
diff --git a/tests/regression.rs b/tests/regression.rs
index ef0a333..e28af4a 100644
--- a/tests/regression.rs
+++ b/tests/regression.rs
@@ -402,7 +402,7 @@ rgtest!(r428_unrecognized_style, |dir: Dir, mut cmd: TestCommand| {
     let output = cmd.raw_output();
     let stderr = String::from_utf8_lossy(&output.stderr);
     let expected = "\
-error parsing flag --colors: \
+rg: error parsing flag --colors: \
 unrecognized style attribute ''. Choose from: nobold, bold, nointense, \
 intense, nounderline, underline.
 ";
