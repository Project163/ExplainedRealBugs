{"url":"https://api.github.com/repos/ChartsOrg/Charts/issues/4099","repository_url":"https://api.github.com/repos/ChartsOrg/Charts","labels_url":"https://api.github.com/repos/ChartsOrg/Charts/issues/4099/labels{/name}","comments_url":"https://api.github.com/repos/ChartsOrg/Charts/issues/4099/comments","events_url":"https://api.github.com/repos/ChartsOrg/Charts/issues/4099/events","html_url":"https://github.com/ChartsOrg/Charts/issues/4099","id":478491294,"node_id":"MDU6SXNzdWU0Nzg0OTEyOTQ=","number":4099,"title":"Line charts: Line sections disappear when zoomed in (has PR).","user":{"login":"4np","id":1049693,"node_id":"MDQ6VXNlcjEwNDk2OTM=","avatar_url":"https://avatars.githubusercontent.com/u/1049693?v=4","gravatar_id":"","url":"https://api.github.com/users/4np","html_url":"https://github.com/4np","followers_url":"https://api.github.com/users/4np/followers","following_url":"https://api.github.com/users/4np/following{/other_user}","gists_url":"https://api.github.com/users/4np/gists{/gist_id}","starred_url":"https://api.github.com/users/4np/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/4np/subscriptions","organizations_url":"https://api.github.com/users/4np/orgs","repos_url":"https://api.github.com/users/4np/repos","events_url":"https://api.github.com/users/4np/events{/privacy}","received_events_url":"https://api.github.com/users/4np/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":189801831,"node_id":"MDU6TGFiZWwxODk4MDE4MzE=","url":"https://api.github.com/repos/ChartsOrg/Charts/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-08-08T14:01:58Z","updated_at":"2019-10-09T02:13:53Z","closed_at":"2019-10-09T02:13:53Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"# Line sections disappear when zoomed in\r\n\r\nRegularly, line sections of line-based charts (line, area) will disappear when zoomed in (make sure `scaleXEnabled = true`, `scaleYEnabled = true` and `dragEnabled = true`). \r\n\r\nPossibly related issues: #3253, #3933, #3898?\r\n\r\n# Steps to reproduce\r\n\r\n1. Launch the iOS Charts demo app\r\n2. Open the `Line Chart` demo\r\n3. Zoom in deep (so that the left y-axis ranges from 20 to 70, zoom level > 3.8)\r\n4. Drag the chart so that a sharp line corner will _just_ go below the x-axis\r\n5. Observe the left line section will disappear\r\n\r\n![issue-4099](https://user-images.githubusercontent.com/1049693/62709905-a00fe380-b9f6-11e9-80c9-81bbc83f34a3.gif)\r\n\r\n(View the [full video](https://www.dropbox.com/s/c8fbmt8m7i5q31x/iOS%20Charts%20Issue%204099.MOV?dl=0) for more context)\r\n\r\n# Cause of the issue\r\n\r\nThe issue is caused by some logic in [LineChartRenderer.swift](https://github.com/danielgindi/Charts/blob/master/Source/Charts/Renderers/LineChartRenderer.swift#L356) that determines whether or not a line should be rendered. It does so by checking if a line lies outside the viewport, however it does not take into account that lines might _intersect_ the viewport while its start and endpoint lie outside of the viewport.\r\n\r\nIn the above gif, the start point of the line was outside of the viewport while the end point lies within the viewport. Dragging the chart downward makes the end point move outside of the viewport, causing the logic below to skip rendering.\r\n\r\n```swift\r\nif (!viewPortHandler.isInBoundsRight(_lineSegments[0].x))\r\n{\r\n    break\r\n}\r\n\r\n// make sure the lines don't do shitty things outside bounds\r\nif !viewPortHandler.isInBoundsLeft(_lineSegments[1].x)\r\n    || (!viewPortHandler.isInBoundsTop(_lineSegments[0].y) && !viewPortHandler.isInBoundsBottom(_lineSegments[1].y))\r\n{\r\n    continue\r\n}\r\n```\r\n\r\n# Fix\r\n\r\nIn Pull Request #4100 I have improved the logic to determine whether or not a line's start- or endpoint lie within the viewport, _or_ if the line intersects the viewport.\r\n\r\n# Environment\r\n\r\n- Charts version 3.3.0 (it is also present in 3.2.2)\r\n- Xcode 10.3\r\n- Swift 5\r\n- macOS Mojave 10.14.16\r\n","closed_by":{"login":"liuxuan30","id":4375169,"node_id":"MDQ6VXNlcjQzNzUxNjk=","avatar_url":"https://avatars.githubusercontent.com/u/4375169?v=4","gravatar_id":"","url":"https://api.github.com/users/liuxuan30","html_url":"https://github.com/liuxuan30","followers_url":"https://api.github.com/users/liuxuan30/followers","following_url":"https://api.github.com/users/liuxuan30/following{/other_user}","gists_url":"https://api.github.com/users/liuxuan30/gists{/gist_id}","starred_url":"https://api.github.com/users/liuxuan30/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liuxuan30/subscriptions","organizations_url":"https://api.github.com/users/liuxuan30/orgs","repos_url":"https://api.github.com/users/liuxuan30/repos","events_url":"https://api.github.com/users/liuxuan30/events{/privacy}","received_events_url":"https://api.github.com/users/liuxuan30/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/ChartsOrg/Charts/issues/4099/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/ChartsOrg/Charts/issues/4099/timeline","performed_via_github_app":null,"state_reason":"completed"}