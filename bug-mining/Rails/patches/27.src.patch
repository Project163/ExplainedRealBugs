diff --git a/actionpack/lib/action_dispatch/middleware/ssl.rb b/actionpack/lib/action_dispatch/middleware/ssl.rb
index c5b074e099..2dba8347b7 100644
--- a/actionpack/lib/action_dispatch/middleware/ssl.rb
+++ b/actionpack/lib/action_dispatch/middleware/ssl.rb
@@ -113,7 +113,9 @@ def build_hsts_header(hsts)
 
       def flag_cookies_as_secure!(headers)
         if cookies = headers["Set-Cookie"]
-          cookies = cookies.split("\n")
+          if cookies.is_a?(String)
+            cookies = cookies.split("\n")
+          end
 
           headers["Set-Cookie"] = cookies.map { |cookie|
             if !/;\s*secure\s*(;|$)/i.match?(cookie)
diff --git a/actionpack/test/dispatch/ssl_test.rb b/actionpack/test/dispatch/ssl_test.rb
index cf41129a56..5353081fd2 100644
--- a/actionpack/test/dispatch/ssl_test.rb
+++ b/actionpack/test/dispatch/ssl_test.rb
@@ -196,6 +196,16 @@ def test_flag_cookies_as_secure
     assert_cookies "id=1; path=/; secure", "token=abc; path=/; secure; HttpOnly"
   end
 
+  def test_flag_cookies_as_secure_with_single_cookie_in_array
+    get headers: { "Set-Cookie" => ["id=1"] }
+    assert_cookies "id=1; secure"
+  end
+
+  def test_flag_cookies_as_secure_with_multiple_cookies_in_array
+    get headers: { "Set-Cookie" => ["id=1", "problem=def"] }
+    assert_cookies "id=1; secure", "problem=def; secure"
+  end
+
   def test_flag_cookies_as_secure_at_end_of_line
     get headers: { "Set-Cookie" => "problem=def; path=/; HttpOnly; secure" }
     assert_cookies "problem=def; path=/; HttpOnly; secure"
