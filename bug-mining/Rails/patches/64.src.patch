diff --git a/activesupport/lib/active_support/message_pack/serializer.rb b/activesupport/lib/active_support/message_pack/serializer.rb
index 52c8e54392..c5ce8e18ae 100644
--- a/activesupport/lib/active_support/message_pack/serializer.rb
+++ b/activesupport/lib/active_support/message_pack/serializer.rb
@@ -51,7 +51,7 @@ def message_pack_pool
               install_unregistered_type_handler
               message_pack_factory.freeze
             end
-            message_pack_factory.pool(ENV.fetch("RAILS_MAX_THREADS") { 5 })
+            message_pack_factory.pool(ENV.fetch("RAILS_MAX_THREADS", 5).to_i)
           end
         end
 
diff --git a/activesupport/test/message_pack/shared_serializer_tests.rb b/activesupport/test/message_pack/shared_serializer_tests.rb
index e590e6fa4e..f70e474fb2 100644
--- a/activesupport/test/message_pack/shared_serializer_tests.rb
+++ b/activesupport/test/message_pack/shared_serializer_tests.rb
@@ -140,6 +140,15 @@ module MessagePackSharedSerializerTests
     test "roundtrips ActiveSupport::HashWithIndifferentAccess" do
       assert_roundtrip ActiveSupport::HashWithIndifferentAccess.new(a: true, b: 2, c: "three")
     end
+
+    test "works with ENV['RAILS_MAX_THREADS']" do
+      original_env = ENV.to_h
+      ENV["RAILS_MAX_THREADS"] = "1"
+
+      assert_roundtrip "value"
+    ensure
+      ENV.replace(original_env)
+    end
   end
 
   private
