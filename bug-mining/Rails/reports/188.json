{"url":"https://api.github.com/repos/rails/rails/issues/54579","repository_url":"https://api.github.com/repos/rails/rails","labels_url":"https://api.github.com/repos/rails/rails/issues/54579/labels{/name}","comments_url":"https://api.github.com/repos/rails/rails/issues/54579/comments","events_url":"https://api.github.com/repos/rails/rails/issues/54579/events","html_url":"https://github.com/rails/rails/issues/54579","id":2865571833,"node_id":"I_kwDNIULOqs0n-Q","number":54579,"title":"uninitialized constant #<Class:ActiveRecord::ConnectionAdapters::SQLite3Adapter>::Rails when executing subset of test suite","user":{"login":"voxik","id":14406,"node_id":"MDQ6VXNlcjE0NDA2","avatar_url":"https://avatars.githubusercontent.com/u/14406?v=4","gravatar_id":"","url":"https://api.github.com/users/voxik","html_url":"https://github.com/voxik","followers_url":"https://api.github.com/users/voxik/followers","following_url":"https://api.github.com/users/voxik/following{/other_user}","gists_url":"https://api.github.com/users/voxik/gists{/gist_id}","starred_url":"https://api.github.com/users/voxik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/voxik/subscriptions","organizations_url":"https://api.github.com/users/voxik/orgs","repos_url":"https://api.github.com/users/voxik/repos","events_url":"https://api.github.com/users/voxik/events{/privacy}","received_events_url":"https://api.github.com/users/voxik/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2025-02-20T09:25:46Z","updated_at":"2025-02-21T09:03:32Z","closed_at":"2025-02-21T09:03:32Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"This is follow up to #54495. The fix from #54498 fixes most of the issues except one. This is the shortest reproducer:\n\n~~~\n$ ARCONN=sqlite3_mem ruby -Itest:lib -e '\n  Dir.glob %|./test/cases/adapters/sqlite3/**/*_test.rb|, &method(:require)\n' -- -n /test_sqlite3_db_with_defined_rails_root/ \nUsing sqlite3_mem\nRun options: -n /test_sqlite3_db_with_defined_rails_root/ --seed 46473\n\n# Running:\n\nE\n\nFinished in 0.004631s, 215.9434 runs/s, 0.0000 assertions/s.\n\n  1) Error:\nActiveRecord::ConnectionAdapters::SQLite3DbConsoleTest#test_sqlite3_db_with_defined_rails_root:\nNameError: uninitialized constant ActiveRecord::ConnectionAdapters::SQLite3DbConsoleTest::Rails\n    test/cases/adapters/sqlite3/dbconsole_test.rb:52:in 'ActiveRecord::ConnectionAdapters::SQLite3DbConsoleTest#test_sqlite3_db_with_defined_rails_root'\n\n1 runs, 0 assertions, 0 failures, 1 errors, 0 skips\n~~~\n\nThis helps to workaround the issue:\n\n~~~diff\ndiff --git a/activerecord/test/cases/adapters/sqlite3/dbconsole_test.rb b/activerecord/test/cases/adapters/sqlite3/dbconsole_test.rb\nindex 6702cf14db..5e2c5a8aa0 100644\n--- a/activerecord/test/cases/adapters/sqlite3/dbconsole_test.rb\n+++ b/activerecord/test/cases/adapters/sqlite3/dbconsole_test.rb\n@@ -40,6 +40,8 @@ def test_sqlite3_db_absolute_path\n         end\n       end\n \n+      module Rails; end\n+\n       def test_sqlite3_db_with_defined_rails_root\n         config = make_db_config(adapter: \"sqlite3\", database: \"config/db.sqlite3\")\n  \n~~~\n\nBut it does not look tome to be the best solution ðŸ¤·","closed_by":{"login":"byroot","id":44640,"node_id":"MDQ6VXNlcjQ0NjQw","avatar_url":"https://avatars.githubusercontent.com/u/44640?v=4","gravatar_id":"","url":"https://api.github.com/users/byroot","html_url":"https://github.com/byroot","followers_url":"https://api.github.com/users/byroot/followers","following_url":"https://api.github.com/users/byroot/following{/other_user}","gists_url":"https://api.github.com/users/byroot/gists{/gist_id}","starred_url":"https://api.github.com/users/byroot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/byroot/subscriptions","organizations_url":"https://api.github.com/users/byroot/orgs","repos_url":"https://api.github.com/users/byroot/repos","events_url":"https://api.github.com/users/byroot/events{/privacy}","received_events_url":"https://api.github.com/users/byroot/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rails/rails/issues/54579/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rails/rails/issues/54579/timeline","performed_via_github_app":null,"state_reason":"completed"}