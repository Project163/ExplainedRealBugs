[{"id":7888365541,"node_id":"RTE_lADNIULOVz8Ccc8AAAAB1i7n5Q","url":"https://api.github.com/repos/rails/rails/issues/events/7888365541","actor":{"login":"SeanLF","id":7193989,"node_id":"MDQ6VXNlcjcxOTM5ODk=","avatar_url":"https://avatars.githubusercontent.com/u/7193989?v=4","gravatar_id":"","url":"https://api.github.com/users/SeanLF","html_url":"https://github.com/SeanLF","followers_url":"https://api.github.com/users/SeanLF/followers","following_url":"https://api.github.com/users/SeanLF/following{/other_user}","gists_url":"https://api.github.com/users/SeanLF/gists{/gist_id}","starred_url":"https://api.github.com/users/SeanLF/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SeanLF/subscriptions","organizations_url":"https://api.github.com/users/SeanLF/orgs","repos_url":"https://api.github.com/users/SeanLF/repos","events_url":"https://api.github.com/users/SeanLF/events{/privacy}","received_events_url":"https://api.github.com/users/SeanLF/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2022-11-24T19:46:03Z","rename":{"from":"`String.transliterate` performance optimization","to":"`transliterate` performance optimization"},"performed_via_github_app":null},{"id":7888371630,"node_id":"RTE_lADNIULOVz8Ccc8AAAAB1i7_rg","url":"https://api.github.com/repos/rails/rails/issues/events/7888371630","actor":{"login":"SeanLF","id":7193989,"node_id":"MDQ6VXNlcjcxOTM5ODk=","avatar_url":"https://avatars.githubusercontent.com/u/7193989?v=4","gravatar_id":"","url":"https://api.github.com/users/SeanLF","html_url":"https://github.com/SeanLF","followers_url":"https://api.github.com/users/SeanLF/followers","following_url":"https://api.github.com/users/SeanLF/following{/other_user}","gists_url":"https://api.github.com/users/SeanLF/gists{/gist_id}","starred_url":"https://api.github.com/users/SeanLF/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SeanLF/subscriptions","organizations_url":"https://api.github.com/users/SeanLF/orgs","repos_url":"https://api.github.com/users/SeanLF/repos","events_url":"https://api.github.com/users/SeanLF/events{/privacy}","received_events_url":"https://api.github.com/users/SeanLF/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2022-11-24T19:47:37Z","rename":{"from":"`transliterate` performance optimization","to":"`ActiveSupport::Inflector.transliterate` performance optimization"},"performed_via_github_app":null},{"id":7895426473,"node_id":"LE_lADNIULOVz8Ccc8AAAAB1pqlqQ","url":"https://api.github.com/repos/rails/rails/issues/events/7895426473","actor":{"login":"ghiculescu","id":509837,"node_id":"MDQ6VXNlcjUwOTgzNw==","avatar_url":"https://avatars.githubusercontent.com/u/509837?v=4","gravatar_id":"","url":"https://api.github.com/users/ghiculescu","html_url":"https://github.com/ghiculescu","followers_url":"https://api.github.com/users/ghiculescu/followers","following_url":"https://api.github.com/users/ghiculescu/following{/other_user}","gists_url":"https://api.github.com/users/ghiculescu/gists{/gist_id}","starred_url":"https://api.github.com/users/ghiculescu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ghiculescu/subscriptions","organizations_url":"https://api.github.com/users/ghiculescu/orgs","repos_url":"https://api.github.com/users/ghiculescu/repos","events_url":"https://api.github.com/users/ghiculescu/events{/privacy}","received_events_url":"https://api.github.com/users/ghiculescu/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-11-25T23:32:42Z","label":{"name":"activesupport","color":"FC9300"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/rails/rails/issues/comments/1327929953","html_url":"https://github.com/rails/rails/issues/46569#issuecomment-1327929953","issue_url":"https://api.github.com/repos/rails/rails/issues/46569","id":1327929953,"node_id":"IC_kwDNIULOTyaaYQ","user":{"login":"ghiculescu","id":509837,"node_id":"MDQ6VXNlcjUwOTgzNw==","avatar_url":"https://avatars.githubusercontent.com/u/509837?v=4","gravatar_id":"","url":"https://api.github.com/users/ghiculescu","html_url":"https://github.com/ghiculescu","followers_url":"https://api.github.com/users/ghiculescu/followers","following_url":"https://api.github.com/users/ghiculescu/following{/other_user}","gists_url":"https://api.github.com/users/ghiculescu/gists{/gist_id}","starred_url":"https://api.github.com/users/ghiculescu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ghiculescu/subscriptions","organizations_url":"https://api.github.com/users/ghiculescu/orgs","repos_url":"https://api.github.com/users/ghiculescu/repos","events_url":"https://api.github.com/users/ghiculescu/events{/privacy}","received_events_url":"https://api.github.com/users/ghiculescu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-11-25T23:34:30Z","updated_at":"2022-11-25T23:34:30Z","body":"Would you like to make a PR for this? Tests would go [here](https://github.com/rails/rails/blob/main/activesupport/test/transliterate_test.rb) and you can also find details about benchmarking the changes [here](https://guides.rubyonrails.org/contributing_to_ruby_on_rails.html#benchmark-your-code) to confirm how much faster it is. Based on that we can evaluate if it's a worthwhile change.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/comments/1327929953/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ghiculescu","id":509837,"node_id":"MDQ6VXNlcjUwOTgzNw==","avatar_url":"https://avatars.githubusercontent.com/u/509837?v=4","gravatar_id":"","url":"https://api.github.com/users/ghiculescu","html_url":"https://github.com/ghiculescu","followers_url":"https://api.github.com/users/ghiculescu/followers","following_url":"https://api.github.com/users/ghiculescu/following{/other_user}","gists_url":"https://api.github.com/users/ghiculescu/gists{/gist_id}","starred_url":"https://api.github.com/users/ghiculescu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ghiculescu/subscriptions","organizations_url":"https://api.github.com/users/ghiculescu/orgs","repos_url":"https://api.github.com/users/ghiculescu/repos","events_url":"https://api.github.com/users/ghiculescu/events{/privacy}","received_events_url":"https://api.github.com/users/ghiculescu/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rails/rails/issues/comments/1327930139","html_url":"https://github.com/rails/rails/issues/46569#issuecomment-1327930139","issue_url":"https://api.github.com/repos/rails/rails/issues/46569","id":1327930139,"node_id":"IC_kwDNIULOTyabGw","user":{"login":"ghiculescu","id":509837,"node_id":"MDQ6VXNlcjUwOTgzNw==","avatar_url":"https://avatars.githubusercontent.com/u/509837?v=4","gravatar_id":"","url":"https://api.github.com/users/ghiculescu","html_url":"https://github.com/ghiculescu","followers_url":"https://api.github.com/users/ghiculescu/followers","following_url":"https://api.github.com/users/ghiculescu/following{/other_user}","gists_url":"https://api.github.com/users/ghiculescu/gists{/gist_id}","starred_url":"https://api.github.com/users/ghiculescu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ghiculescu/subscriptions","organizations_url":"https://api.github.com/users/ghiculescu/orgs","repos_url":"https://api.github.com/users/ghiculescu/repos","events_url":"https://api.github.com/users/ghiculescu/events{/privacy}","received_events_url":"https://api.github.com/users/ghiculescu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-11-25T23:35:20Z","updated_at":"2022-11-25T23:35:20Z","body":"I'm going to close this, as it's not a bug, which is what we try to reserve the issue tracker for. A PR would be a great place to discuss this ðŸ‘ ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/comments/1327930139/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"ghiculescu","id":509837,"node_id":"MDQ6VXNlcjUwOTgzNw==","avatar_url":"https://avatars.githubusercontent.com/u/509837?v=4","gravatar_id":"","url":"https://api.github.com/users/ghiculescu","html_url":"https://github.com/ghiculescu","followers_url":"https://api.github.com/users/ghiculescu/followers","following_url":"https://api.github.com/users/ghiculescu/following{/other_user}","gists_url":"https://api.github.com/users/ghiculescu/gists{/gist_id}","starred_url":"https://api.github.com/users/ghiculescu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ghiculescu/subscriptions","organizations_url":"https://api.github.com/users/ghiculescu/orgs","repos_url":"https://api.github.com/users/ghiculescu/repos","events_url":"https://api.github.com/users/ghiculescu/events{/privacy}","received_events_url":"https://api.github.com/users/ghiculescu/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":7895430529,"node_id":"CE_lADNIULOVz8Ccc8AAAAB1pq1gQ","url":"https://api.github.com/repos/rails/rails/issues/events/7895430529","actor":{"login":"ghiculescu","id":509837,"node_id":"MDQ6VXNlcjUwOTgzNw==","avatar_url":"https://avatars.githubusercontent.com/u/509837?v=4","gravatar_id":"","url":"https://api.github.com/users/ghiculescu","html_url":"https://github.com/ghiculescu","followers_url":"https://api.github.com/users/ghiculescu/followers","following_url":"https://api.github.com/users/ghiculescu/following{/other_user}","gists_url":"https://api.github.com/users/ghiculescu/gists{/gist_id}","starred_url":"https://api.github.com/users/ghiculescu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ghiculescu/subscriptions","organizations_url":"https://api.github.com/users/ghiculescu/orgs","repos_url":"https://api.github.com/users/ghiculescu/repos","events_url":"https://api.github.com/users/ghiculescu/events{/privacy}","received_events_url":"https://api.github.com/users/ghiculescu/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-11-25T23:35:20Z","state_reason":null,"performed_via_github_app":null},{"id":7896412139,"node_id":"REFE_lADNIULOVz8Ccc8AAAAB1qmv6w","url":"https://api.github.com/repos/rails/rails/issues/events/7896412139","actor":{"login":"SeanLF","id":7193989,"node_id":"MDQ6VXNlcjcxOTM5ODk=","avatar_url":"https://avatars.githubusercontent.com/u/7193989?v=4","gravatar_id":"","url":"https://api.github.com/users/SeanLF","html_url":"https://github.com/SeanLF","followers_url":"https://api.github.com/users/SeanLF/followers","following_url":"https://api.github.com/users/SeanLF/following{/other_user}","gists_url":"https://api.github.com/users/SeanLF/gists{/gist_id}","starred_url":"https://api.github.com/users/SeanLF/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SeanLF/subscriptions","organizations_url":"https://api.github.com/users/SeanLF/orgs","repos_url":"https://api.github.com/users/SeanLF/repos","events_url":"https://api.github.com/users/SeanLF/events{/privacy}","received_events_url":"https://api.github.com/users/SeanLF/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"e115480dab525cf69b1718057473d08bdf413e92","commit_url":"https://api.github.com/repos/SeanLF/rails/commits/e115480dab525cf69b1718057473d08bdf413e92","created_at":"2022-11-26T15:30:40Z","performed_via_github_app":null},{"actor":{"login":"SeanLF","id":7193989,"node_id":"MDQ6VXNlcjcxOTM5ODk=","avatar_url":"https://avatars.githubusercontent.com/u/7193989?v=4","gravatar_id":"","url":"https://api.github.com/users/SeanLF","html_url":"https://github.com/SeanLF","followers_url":"https://api.github.com/users/SeanLF/followers","following_url":"https://api.github.com/users/SeanLF/following{/other_user}","gists_url":"https://api.github.com/users/SeanLF/gists{/gist_id}","starred_url":"https://api.github.com/users/SeanLF/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SeanLF/subscriptions","organizations_url":"https://api.github.com/users/SeanLF/orgs","repos_url":"https://api.github.com/users/SeanLF/repos","events_url":"https://api.github.com/users/SeanLF/events{/privacy}","received_events_url":"https://api.github.com/users/SeanLF/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-11-26T15:41:59Z","updated_at":"2022-11-26T15:41:59Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/rails/rails/issues/46586","repository_url":"https://api.github.com/repos/rails/rails","labels_url":"https://api.github.com/repos/rails/rails/issues/46586/labels{/name}","comments_url":"https://api.github.com/repos/rails/rails/issues/46586/comments","events_url":"https://api.github.com/repos/rails/rails/issues/46586/events","html_url":"https://github.com/rails/rails/pull/46586","id":1465186873,"node_id":"PR_kwDNIULOQ72ESg","number":46586,"title":"Improve `ActiveSupport::Inflector.transliterate` performance [Fix #46569]","user":{"login":"SeanLF","id":7193989,"node_id":"MDQ6VXNlcjcxOTM5ODk=","avatar_url":"https://avatars.githubusercontent.com/u/7193989?v=4","gravatar_id":"","url":"https://api.github.com/users/SeanLF","html_url":"https://github.com/SeanLF","followers_url":"https://api.github.com/users/SeanLF/followers","following_url":"https://api.github.com/users/SeanLF/following{/other_user}","gists_url":"https://api.github.com/users/SeanLF/gists{/gist_id}","starred_url":"https://api.github.com/users/SeanLF/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SeanLF/subscriptions","organizations_url":"https://api.github.com/users/SeanLF/orgs","repos_url":"https://api.github.com/users/SeanLF/repos","events_url":"https://api.github.com/users/SeanLF/events{/privacy}","received_events_url":"https://api.github.com/users/SeanLF/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":107194,"node_id":"MDU6TGFiZWwxMDcxOTQ=","url":"https://api.github.com/repos/rails/rails/labels/activesupport","name":"activesupport","color":"FC9300","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-11-26T15:41:58Z","updated_at":"2022-11-28T13:15:18Z","closed_at":"2022-11-28T13:15:17Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":8514,"node_id":"MDEwOlJlcG9zaXRvcnk4NTE0","name":"rails","full_name":"rails/rails","private":false,"owner":{"login":"rails","id":4223,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQyMjM=","avatar_url":"https://avatars.githubusercontent.com/u/4223?v=4","gravatar_id":"","url":"https://api.github.com/users/rails","html_url":"https://github.com/rails","followers_url":"https://api.github.com/users/rails/followers","following_url":"https://api.github.com/users/rails/following{/other_user}","gists_url":"https://api.github.com/users/rails/gists{/gist_id}","starred_url":"https://api.github.com/users/rails/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rails/subscriptions","organizations_url":"https://api.github.com/users/rails/orgs","repos_url":"https://api.github.com/users/rails/repos","events_url":"https://api.github.com/users/rails/events{/privacy}","received_events_url":"https://api.github.com/users/rails/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/rails/rails","description":"Ruby on Rails","fork":false,"url":"https://api.github.com/repos/rails/rails","forks_url":"https://api.github.com/repos/rails/rails/forks","keys_url":"https://api.github.com/repos/rails/rails/keys{/key_id}","collaborators_url":"https://api.github.com/repos/rails/rails/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/rails/rails/teams","hooks_url":"https://api.github.com/repos/rails/rails/hooks","issue_events_url":"https://api.github.com/repos/rails/rails/issues/events{/number}","events_url":"https://api.github.com/repos/rails/rails/events","assignees_url":"https://api.github.com/repos/rails/rails/assignees{/user}","branches_url":"https://api.github.com/repos/rails/rails/branches{/branch}","tags_url":"https://api.github.com/repos/rails/rails/tags","blobs_url":"https://api.github.com/repos/rails/rails/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/rails/rails/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/rails/rails/git/refs{/sha}","trees_url":"https://api.github.com/repos/rails/rails/git/trees{/sha}","statuses_url":"https://api.github.com/repos/rails/rails/statuses/{sha}","languages_url":"https://api.github.com/repos/rails/rails/languages","stargazers_url":"https://api.github.com/repos/rails/rails/stargazers","contributors_url":"https://api.github.com/repos/rails/rails/contributors","subscribers_url":"https://api.github.com/repos/rails/rails/subscribers","subscription_url":"https://api.github.com/repos/rails/rails/subscription","commits_url":"https://api.github.com/repos/rails/rails/commits{/sha}","git_commits_url":"https://api.github.com/repos/rails/rails/git/commits{/sha}","comments_url":"https://api.github.com/repos/rails/rails/comments{/number}","issue_comment_url":"https://api.github.com/repos/rails/rails/issues/comments{/number}","contents_url":"https://api.github.com/repos/rails/rails/contents/{+path}","compare_url":"https://api.github.com/repos/rails/rails/compare/{base}...{head}","merges_url":"https://api.github.com/repos/rails/rails/merges","archive_url":"https://api.github.com/repos/rails/rails/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/rails/rails/downloads","issues_url":"https://api.github.com/repos/rails/rails/issues{/number}","pulls_url":"https://api.github.com/repos/rails/rails/pulls{/number}","milestones_url":"https://api.github.com/repos/rails/rails/milestones{/number}","notifications_url":"https://api.github.com/repos/rails/rails/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/rails/rails/labels{/name}","releases_url":"https://api.github.com/repos/rails/rails/releases{/id}","deployments_url":"https://api.github.com/repos/rails/rails/deployments","created_at":"2008-04-11T02:19:47Z","updated_at":"2025-11-10T02:03:47Z","pushed_at":"2025-11-10T00:33:52Z","git_url":"git://github.com/rails/rails.git","ssh_url":"git@github.com:rails/rails.git","clone_url":"https://github.com/rails/rails.git","svn_url":"https://github.com/rails/rails","homepage":"https://rubyonrails.org","size":271619,"stargazers_count":57840,"watchers_count":57840,"language":"Ruby","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":22025,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1341,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["activejob","activerecord","framework","html","mvc","rails","ruby"],"visibility":"public","forks":22025,"open_issues":1341,"watchers":57840,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/rails/rails/pulls/46586","html_url":"https://github.com/rails/rails/pull/46586","diff_url":"https://github.com/rails/rails/pull/46586.diff","patch_url":"https://github.com/rails/rails/pull/46586.patch","merged_at":"2022-11-28T13:15:17Z"},"body":"### Motivation / Background\r\n\r\n`ActiveSupport::Inflector.transliterate` does not need to perform any work when the string that is passed to it is already in ASCII.\r\n\r\nThis has an impact on `ActiveSupport::Inflector.parameterize` as well.\r\n\r\nResolves #46569\r\n\r\n### Detail\r\n\r\nThis Pull Request adds a check to `transliterate` to avoid performing expensive work if the string is already ASCII only.\r\n\r\n### Additional information\r\n\r\nBenchmark indicates that \r\n* same performance when transliteration is actually required (non-ASCII characters are present in the string)\r\n* current code is 20x slower for regular length ASCII-only strings (~30 characters)\r\n* current code is 670x slower for very long ASCII-only strings (~2000 characters)\r\n\r\nBenchmark included below\r\n\r\n### Benchmark\r\n\r\n```ruby\r\n# frozen_string_literal: true\r\n\r\nrequire \"bundler/inline\"\r\n\r\ngemfile(true) do\r\n  source \"https://rubygems.org\"\r\n\r\n  git_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\r\n\r\n  gem \"rails\", github: \"rails/rails\", branch: \"main\"\r\n  gem \"benchmark-ips\"\r\nend\r\n\r\nrequire \"active_support\"\r\nrequire \"active_support/inflector/transliterate\"\r\n\r\nmodule ActiveSupport::Inflector\r\n  def transliterate_fast(string, replacement = \"?\", locale: nil)\r\n    raise ArgumentError, \"Can only transliterate strings. Received #{string.class.name}\" unless string.is_a?(String)\r\n    raise ArgumentError, \"Cannot transliterate strings with #{string.encoding} encoding\" unless ALLOWED_ENCODINGS_FOR_TRANSLITERATE.include?(string.encoding)\r\n\r\n    return string if string.ascii_only? # ðŸ‘ˆ my change here\r\n\r\n    string = string.dup if string.frozen? # ðŸ‘ˆ moved this down to avoid duplicating a string before argument checks\r\n    input_encoding = string.encoding\r\n\r\n    # US-ASCII is a subset of UTF-8 so we'll force encoding as UTF-8 if\r\n    # US-ASCII is given. This way we can let tidy_bytes handle the string\r\n    # in the same way as we do for UTF-8\r\n    string.force_encoding(Encoding::UTF_8) if string.encoding == Encoding::US_ASCII\r\n\r\n    # GB18030 is Unicode compatible but is not a direct mapping so needs to be\r\n    # transcoded. Using invalid/undef :replace will result in loss of data in\r\n    # the event of invalid characters, but since tidy_bytes will replace\r\n    # invalid/undef with a \"?\" we're safe to do the same beforehand\r\n    string.encode!(Encoding::UTF_8, invalid: :replace, undef: :replace) if string.encoding == Encoding::GB18030\r\n\r\n    transliterated = I18n.transliterate(\r\n      ActiveSupport::Multibyte::Unicode.tidy_bytes(string).unicode_normalize(:nfc),\r\n      replacement: replacement,\r\n      locale: locale\r\n    )\r\n\r\n    # Restore the string encoding of the input if it was not UTF-8.\r\n    # Apply invalid/undef :replace as tidy_bytes does\r\n    transliterated.encode!(input_encoding, invalid: :replace, undef: :replace) if input_encoding != transliterated.encoding\r\n\r\n    transliterated\r\n  end\r\nend\r\n\r\n# Enumerate some representative scenarios here.\r\n#\r\n# It is very easy to make an optimization that improves performance for a\r\n# specific scenario you care about but regresses on other common cases.\r\n# Therefore, you should test your change against a list of representative\r\n# scenarios. Ideally, they should be based on real-world scenarios extracted\r\n# from production applications.\r\nSCENARIOS = {\r\n  \"Empty\"                         => \"\",\r\n  \"Single Space\"                  => \" \",\r\n  \"ASCII string\"                  => \"This is a normal ASCII String.\",\r\n  \"US ASCII encoded String\"       => String.new(\"This is a normal ASCII String.\", encoding: Encoding::US_ASCII),\r\n  \"Very Long String\"              => \"Very Long String :)\" * 100,\r\n  \"Very Long french String\"       => \"Very Long StringÃ© :)\" * 100,\r\n  \"French string\"                 => \"Ceci est une chaÃ®ne de test pour la mÃ©thode de translittÃ©ration.\",\r\n  \"UTF-8 encoded Chinese string\"  => String.new(\"é€™æ˜¯éŸ³è­¯æ–¹æ³•çš„æ¸¬è©¦å­—ç¬¦ä¸²\", encoding: Encoding::UTF_8)\r\n\r\n}\r\n\r\nSCENARIOS.each_pair do |name, value|\r\n  puts\r\n  puts \" #{name} \".center(80, \"=\")\r\n  puts\r\n\r\n  Benchmark.ips do |x|\r\n    x.report(\"transliterate\")      { ActiveSupport::Inflector.transliterate(value) }\r\n    x.report(\"transliterate_fast\") { ActiveSupport::Inflector.transliterate_fast(value) }\r\n    x.compare!\r\n  end\r\nend\r\n```\r\n\r\n### Benchmark results\r\n\r\n```txt\r\n==================================== Empty =====================================\r\n\r\nWarming up --------------------------------------\r\n       transliterate    65.500k i/100ms\r\n  transliterate_fast   687.485k i/100ms\r\nCalculating -------------------------------------\r\n       transliterate    657.632k (Â± 0.8%) i/s -      3.340M in   5.079936s\r\n  transliterate_fast      6.869M (Â± 1.6%) i/s -     34.374M in   5.005813s\r\n\r\nComparison:\r\n  transliterate_fast:  6868816.3 i/s\r\n       transliterate:   657631.8 i/s - 10.44x  (Â± 0.00) slower\r\n\r\n================================= Single Space =================================\r\n\r\nWarming up --------------------------------------\r\n       transliterate    62.732k i/100ms\r\n  transliterate_fast   678.223k i/100ms\r\nCalculating -------------------------------------\r\n       transliterate    628.475k (Â± 0.8%) i/s -      3.199M in   5.090978s\r\n  transliterate_fast      6.799M (Â± 0.2%) i/s -     34.589M in   5.087534s\r\n\r\nComparison:\r\n  transliterate_fast:  6798890.3 i/s\r\n       transliterate:   628475.2 i/s - 10.82x  (Â± 0.00) slower\r\n\r\n================================= ASCII string =================================\r\n\r\nWarming up --------------------------------------\r\n       transliterate    32.095k i/100ms\r\n  transliterate_fast   687.396k i/100ms\r\nCalculating -------------------------------------\r\n       transliterate    319.529k (Â± 0.8%) i/s -      1.605M in   5.022547s\r\n  transliterate_fast      6.879M (Â± 0.3%) i/s -     35.057M in   5.096224s\r\n\r\nComparison:\r\n  transliterate_fast:  6879113.6 i/s\r\n       transliterate:   319528.9 i/s - 21.53x  (Â± 0.00) slower\r\n\r\n=========================== US ASCII encoded String ============================\r\n\r\nWarming up --------------------------------------\r\n       transliterate    33.027k i/100ms\r\n  transliterate_fast   688.354k i/100ms\r\nCalculating -------------------------------------\r\n       transliterate    330.268k (Â± 0.9%) i/s -      1.651M in   5.000445s\r\n  transliterate_fast      6.861M (Â± 0.8%) i/s -     34.418M in   5.016963s\r\n\r\nComparison:\r\n  transliterate_fast:  6860726.0 i/s\r\n       transliterate:   330267.8 i/s - 20.77x  (Â± 0.00) slower\r\n\r\n=============================== Very Long String ===============================\r\n\r\nWarming up --------------------------------------\r\n       transliterate   985.000  i/100ms\r\n  transliterate_fast   672.674k i/100ms\r\nCalculating -------------------------------------\r\n       transliterate      9.899k (Â± 0.5%) i/s -     50.235k in   5.074820s\r\n  transliterate_fast      6.729M (Â± 0.7%) i/s -     34.306M in   5.098807s\r\n\r\nComparison:\r\n  transliterate_fast:  6728668.4 i/s\r\n       transliterate:     9899.2 i/s - 679.72x  (Â± 0.00) slower\r\n\r\n=========================== Very Long french String ============================\r\n\r\nWarming up --------------------------------------\r\n       transliterate   671.000  i/100ms\r\n  transliterate_fast   671.000  i/100ms\r\nCalculating -------------------------------------\r\n       transliterate      6.635k (Â± 1.9%) i/s -     33.550k in   5.058424s\r\n  transliterate_fast      6.622k (Â± 1.7%) i/s -     33.550k in   5.068289s\r\n\r\nComparison:\r\n       transliterate:     6634.9 i/s\r\n  transliterate_fast:     6621.7 i/s - same-ish: difference falls within error\r\n\r\n================================ French string =================================\r\n\r\nWarming up --------------------------------------\r\n       transliterate    14.726k i/100ms\r\n  transliterate_fast    14.679k i/100ms\r\nCalculating -------------------------------------\r\n       transliterate    145.933k (Â± 1.5%) i/s -    736.300k in   5.046537s\r\n  transliterate_fast    146.753k (Â± 1.2%) i/s -    733.950k in   5.001937s\r\n\r\nComparison:\r\n  transliterate_fast:   146752.8 i/s\r\n       transliterate:   145933.1 i/s - same-ish: difference falls within error\r\n\r\n========================= UTF-8 encoded Chinese string =========================\r\n\r\nWarming up --------------------------------------\r\n       transliterate    13.905k i/100ms\r\n  transliterate_fast    14.093k i/100ms\r\nCalculating -------------------------------------\r\n       transliterate    141.222k (Â± 1.9%) i/s -    709.155k in   5.023366s\r\n  transliterate_fast    140.510k (Â± 1.7%) i/s -    704.650k in   5.016400s\r\n\r\nComparison:\r\n       transliterate:   141221.9 i/s\r\n  transliterate_fast:   140510.4 i/s - same-ish: difference falls within error\r\n```","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/46586/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":2,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rails/rails/issues/46586/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/rails/rails/issues/comments/1328068290","html_url":"https://github.com/rails/rails/issues/46569#issuecomment-1328068290","issue_url":"https://api.github.com/repos/rails/rails/issues/46569","id":1328068290,"node_id":"IC_kwDNIULOTyi2wg","user":{"login":"SeanLF","id":7193989,"node_id":"MDQ6VXNlcjcxOTM5ODk=","avatar_url":"https://avatars.githubusercontent.com/u/7193989?v=4","gravatar_id":"","url":"https://api.github.com/users/SeanLF","html_url":"https://github.com/SeanLF","followers_url":"https://api.github.com/users/SeanLF/followers","following_url":"https://api.github.com/users/SeanLF/following{/other_user}","gists_url":"https://api.github.com/users/SeanLF/gists{/gist_id}","starred_url":"https://api.github.com/users/SeanLF/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SeanLF/subscriptions","organizations_url":"https://api.github.com/users/SeanLF/orgs","repos_url":"https://api.github.com/users/SeanLF/repos","events_url":"https://api.github.com/users/SeanLF/events{/privacy}","received_events_url":"https://api.github.com/users/SeanLF/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-11-26T15:42:43Z","updated_at":"2022-11-26T15:42:43Z","body":"@ghiculescu I've opened the PR ðŸš€ ","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/comments/1328068290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"SeanLF","id":7193989,"node_id":"MDQ6VXNlcjcxOTM5ODk=","avatar_url":"https://avatars.githubusercontent.com/u/7193989?v=4","gravatar_id":"","url":"https://api.github.com/users/SeanLF","html_url":"https://github.com/SeanLF","followers_url":"https://api.github.com/users/SeanLF/followers","following_url":"https://api.github.com/users/SeanLF/following{/other_user}","gists_url":"https://api.github.com/users/SeanLF/gists{/gist_id}","starred_url":"https://api.github.com/users/SeanLF/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SeanLF/subscriptions","organizations_url":"https://api.github.com/users/SeanLF/orgs","repos_url":"https://api.github.com/users/SeanLF/repos","events_url":"https://api.github.com/users/SeanLF/events{/privacy}","received_events_url":"https://api.github.com/users/SeanLF/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":7896423990,"node_id":"MEE_lADNIULOVz8Ccc8AAAAB1qneNg","url":"https://api.github.com/repos/rails/rails/issues/events/7896423990","actor":{"login":"ghiculescu","id":509837,"node_id":"MDQ6VXNlcjUwOTgzNw==","avatar_url":"https://avatars.githubusercontent.com/u/509837?v=4","gravatar_id":"","url":"https://api.github.com/users/ghiculescu","html_url":"https://github.com/ghiculescu","followers_url":"https://api.github.com/users/ghiculescu/followers","following_url":"https://api.github.com/users/ghiculescu/following{/other_user}","gists_url":"https://api.github.com/users/ghiculescu/gists{/gist_id}","starred_url":"https://api.github.com/users/ghiculescu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ghiculescu/subscriptions","organizations_url":"https://api.github.com/users/ghiculescu/orgs","repos_url":"https://api.github.com/users/ghiculescu/repos","events_url":"https://api.github.com/users/ghiculescu/events{/privacy}","received_events_url":"https://api.github.com/users/ghiculescu/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-11-26T15:42:43Z","performed_via_github_app":null},{"id":7896423993,"node_id":"SE_lADNIULOVz8Ccc8AAAAB1qneOQ","url":"https://api.github.com/repos/rails/rails/issues/events/7896423993","actor":{"login":"ghiculescu","id":509837,"node_id":"MDQ6VXNlcjUwOTgzNw==","avatar_url":"https://avatars.githubusercontent.com/u/509837?v=4","gravatar_id":"","url":"https://api.github.com/users/ghiculescu","html_url":"https://github.com/ghiculescu","followers_url":"https://api.github.com/users/ghiculescu/followers","following_url":"https://api.github.com/users/ghiculescu/following{/other_user}","gists_url":"https://api.github.com/users/ghiculescu/gists{/gist_id}","starred_url":"https://api.github.com/users/ghiculescu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ghiculescu/subscriptions","organizations_url":"https://api.github.com/users/ghiculescu/orgs","repos_url":"https://api.github.com/users/ghiculescu/repos","events_url":"https://api.github.com/users/ghiculescu/events{/privacy}","received_events_url":"https://api.github.com/users/ghiculescu/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-11-26T15:42:43Z","performed_via_github_app":null},{"id":7901760269,"node_id":"REFE_lADNIULOVz8Ccc8AAAAB1vtLDQ","url":"https://api.github.com/repos/rails/rails/issues/events/7901760269","actor":{"login":"SeanLF","id":7193989,"node_id":"MDQ6VXNlcjcxOTM5ODk=","avatar_url":"https://avatars.githubusercontent.com/u/7193989?v=4","gravatar_id":"","url":"https://api.github.com/users/SeanLF","html_url":"https://github.com/SeanLF","followers_url":"https://api.github.com/users/SeanLF/followers","following_url":"https://api.github.com/users/SeanLF/following{/other_user}","gists_url":"https://api.github.com/users/SeanLF/gists{/gist_id}","starred_url":"https://api.github.com/users/SeanLF/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SeanLF/subscriptions","organizations_url":"https://api.github.com/users/SeanLF/orgs","repos_url":"https://api.github.com/users/SeanLF/repos","events_url":"https://api.github.com/users/SeanLF/events{/privacy}","received_events_url":"https://api.github.com/users/SeanLF/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"8194f8ec88ad7e4e2c2df99fbf4dacc93faa6805","commit_url":"https://api.github.com/repos/SeanLF/rails/commits/8194f8ec88ad7e4e2c2df99fbf4dacc93faa6805","created_at":"2022-11-28T11:03:09Z","performed_via_github_app":null},{"id":7902842444,"node_id":"REFE_lADNIULOVz8Ccc8AAAAB1wvOTA","url":"https://api.github.com/repos/rails/rails/issues/events/7902842444","actor":{"login":"byroot","id":44640,"node_id":"MDQ6VXNlcjQ0NjQw","avatar_url":"https://avatars.githubusercontent.com/u/44640?v=4","gravatar_id":"","url":"https://api.github.com/users/byroot","html_url":"https://github.com/byroot","followers_url":"https://api.github.com/users/byroot/followers","following_url":"https://api.github.com/users/byroot/following{/other_user}","gists_url":"https://api.github.com/users/byroot/gists{/gist_id}","starred_url":"https://api.github.com/users/byroot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/byroot/subscriptions","organizations_url":"https://api.github.com/users/byroot/orgs","repos_url":"https://api.github.com/users/byroot/repos","events_url":"https://api.github.com/users/byroot/events{/privacy}","received_events_url":"https://api.github.com/users/byroot/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"cfa577818c7b7dada4684f0999bbe52206ad7f28","commit_url":"https://api.github.com/repos/rails/rails/commits/cfa577818c7b7dada4684f0999bbe52206ad7f28","created_at":"2022-11-28T13:15:49Z","performed_via_github_app":null},{"id":9030250372,"node_id":"REFE_lADNIULOVz8Ccc8AAAACGj6vhA","url":"https://api.github.com/repos/rails/rails/issues/events/9030250372","actor":{"login":"mattpolito","id":2145,"node_id":"MDQ6VXNlcjIxNDU=","avatar_url":"https://avatars.githubusercontent.com/u/2145?v=4","gravatar_id":"","url":"https://api.github.com/users/mattpolito","html_url":"https://github.com/mattpolito","followers_url":"https://api.github.com/users/mattpolito/followers","following_url":"https://api.github.com/users/mattpolito/following{/other_user}","gists_url":"https://api.github.com/users/mattpolito/gists{/gist_id}","starred_url":"https://api.github.com/users/mattpolito/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mattpolito/subscriptions","organizations_url":"https://api.github.com/users/mattpolito/orgs","repos_url":"https://api.github.com/users/mattpolito/repos","events_url":"https://api.github.com/users/mattpolito/events{/privacy}","received_events_url":"https://api.github.com/users/mattpolito/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"413a74ad6b60ff4a027193768398a92b5cfa831a","commit_url":"https://api.github.com/repos/mattpolito/rails/commits/413a74ad6b60ff4a027193768398a92b5cfa831a","created_at":"2023-04-18T00:40:23Z","performed_via_github_app":null}]