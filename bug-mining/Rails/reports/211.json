{"url":"https://api.github.com/repos/rails/rails/issues/55215","repository_url":"https://api.github.com/repos/rails/rails","labels_url":"https://api.github.com/repos/rails/rails/issues/55215/labels{/name}","comments_url":"https://api.github.com/repos/rails/rails/issues/55215/comments","events_url":"https://api.github.com/repos/rails/rails/issues/55215/events","html_url":"https://github.com/rails/rails/issues/55215","id":3163083044,"node_id":"I_kwDNIULOvIjRJA","number":55215,"title":"`NameError: uninitialized constant ActionController::Base` for `railties/lib/rails/health_controller.rb`","user":{"login":"voxik","id":14406,"node_id":"MDQ6VXNlcjE0NDA2","avatar_url":"https://avatars.githubusercontent.com/u/14406?v=4","gravatar_id":"","url":"https://api.github.com/users/voxik","html_url":"https://github.com/voxik","followers_url":"https://api.github.com/users/voxik/followers","following_url":"https://api.github.com/users/voxik/following{/other_user}","gists_url":"https://api.github.com/users/voxik/gists{/gist_id}","starred_url":"https://api.github.com/users/voxik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/voxik/subscriptions","organizations_url":"https://api.github.com/users/voxik/orgs","repos_url":"https://api.github.com/users/voxik/repos","events_url":"https://api.github.com/users/voxik/events{/privacy}","received_events_url":"https://api.github.com/users/voxik/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":107195,"node_id":"MDU6TGFiZWwxMDcxOTU=","url":"https://api.github.com/repos/rails/rails/labels/railties","name":"railties","color":"8BE06E","default":false,"description":null},{"id":41328116,"node_id":"MDU6TGFiZWw0MTMyODExNg==","url":"https://api.github.com/repos/rails/rails/labels/attached%20PR","name":"attached PR","color":"006b75","default":false,"description":null},{"id":126910270,"node_id":"MDU6TGFiZWwxMjY5MTAyNzA=","url":"https://api.github.com/repos/rails/rails/labels/With%20reproduction%20steps","name":"With reproduction steps","color":"009800","default":false,"description":null},{"id":384913768,"node_id":"MDU6TGFiZWwzODQ5MTM3Njg=","url":"https://api.github.com/repos/rails/rails/labels/good%20first%20issue","name":"good first issue","color":"0e8a16","default":true,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2025-06-20T12:01:00Z","updated_at":"2025-07-01T07:14:49Z","closed_at":"2025-07-01T07:14:49Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Looking into [enabling Rails 8 CI for globalid](https://github.com/rails/globalid/pull/197), there is following test failure:\n\n~~~\n  4) Error:\nRailtieTest#test_config.global_id_can_be_used_to_set_configurations_after_the_railtie_has_been_loaded:\nNameError: uninitialized constant ActionController::Base\n    vendor/bundle/ruby/3.4.0/gems/railties-8.0.2/lib/rails/health_controller.rb:35:in '<module:Rails>'\n    vendor/bundle/ruby/3.4.0/gems/railties-8.0.2/lib/rails/health_controller.rb:3:in '<top (required)>'\n    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/bundled_gems.rb:82:in 'Kernel.require'\n    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/bundled_gems.rb:82:in 'block (2 levels) in Kernel#replace_require'\n    vendor/bundle/ruby/3.4.0/gems/zeitwerk-2.7.3/lib/zeitwerk/core_ext/kernel.rb:34:in 'Kernel#require'\n    vendor/bundle/ruby/3.4.0/gems/activesupport-8.0.2/lib/active_support/dependencies/autoload.rb:67:in 'Module#const_get'\n    vendor/bundle/ruby/3.4.0/gems/activesupport-8.0.2/lib/active_support/dependencies/autoload.rb:67:in 'block in ActiveSupport::Autoload#eager_load!'\n    vendor/bundle/ruby/3.4.0/gems/activesupport-8.0.2/lib/active_support/dependencies/autoload.rb:67:in 'Array#each'\n    vendor/bundle/ruby/3.4.0/gems/activesupport-8.0.2/lib/active_support/dependencies/autoload.rb:67:in 'ActiveSupport::Autoload#eager_load!'\n    vendor/bundle/ruby/3.4.0/gems/railties-8.0.2/lib/rails/application/finisher.rb:80:in 'block in <module:Finisher>'\n    vendor/bundle/ruby/3.4.0/gems/railties-8.0.2/lib/rails/initializable.rb:32:in 'BasicObject#instance_exec'\n    vendor/bundle/ruby/3.4.0/gems/railties-8.0.2/lib/rails/initializable.rb:32:in 'Rails::Initializable::Initializer#run'\n    vendor/bundle/ruby/3.4.0/gems/railties-8.0.2/lib/rails/initializable.rb:61:in 'block in Rails::Initializable#run_initializers'\n    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/tsort.rb:231:in 'block in TSort.tsort_each'\n    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/tsort.rb:353:in 'block (2 levels) in TSort.each_strongly_connected_component'\n    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/tsort.rb:434:in 'TSort.each_strongly_connected_component_from'\n    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/tsort.rb:352:in 'block in TSort.each_strongly_connected_component'\n    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/tsort.rb:350:in 'Rails::Initializable::Collection#each'\n    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/tsort.rb:350:in 'Method#call'\n    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/tsort.rb:350:in 'TSort.each_strongly_connected_component'\n    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/tsort.rb:229:in 'TSort.tsort_each'\n    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/tsort.rb:208:in 'TSort#tsort_each'\n    vendor/bundle/ruby/3.4.0/gems/railties-8.0.2/lib/rails/initializable.rb:60:in 'Rails::Initializable#run_initializers'\n    vendor/bundle/ruby/3.4.0/gems/railties-8.0.2/lib/rails/application.rb:440:in 'Rails::Application#initialize!'\n    test/cases/railtie_test.rb:53:in 'block in <class:RailtieTest>'\n~~~\n\nI don't know if the test case is setup properly, but it seems that `RUBYOPT=-raction_controller` helps to workaround this issue. This makes me wonder, should there be `require \"action_controller\"` included somewhere in `railties/lib/rails/health_controller.rb`?","closed_by":{"login":"byroot","id":44640,"node_id":"MDQ6VXNlcjQ0NjQw","avatar_url":"https://avatars.githubusercontent.com/u/44640?v=4","gravatar_id":"","url":"https://api.github.com/users/byroot","html_url":"https://github.com/byroot","followers_url":"https://api.github.com/users/byroot/followers","following_url":"https://api.github.com/users/byroot/following{/other_user}","gists_url":"https://api.github.com/users/byroot/gists{/gist_id}","starred_url":"https://api.github.com/users/byroot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/byroot/subscriptions","organizations_url":"https://api.github.com/users/byroot/orgs","repos_url":"https://api.github.com/users/byroot/repos","events_url":"https://api.github.com/users/byroot/events{/privacy}","received_events_url":"https://api.github.com/users/byroot/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rails/rails/issues/55215/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rails/rails/issues/55215/timeline","performed_via_github_app":null,"state_reason":"completed"}