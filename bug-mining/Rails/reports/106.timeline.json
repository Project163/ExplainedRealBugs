[{"id":10541814061,"node_id":"LE_lADNIULOcrPXes8AAAACdFdRLQ","url":"https://api.github.com/repos/rails/rails/issues/events/10541814061","actor":{"login":"paulreece","id":96156234,"node_id":"U_kgDOBbs6Sg","avatar_url":"https://avatars.githubusercontent.com/u/96156234?v=4","gravatar_id":"","url":"https://api.github.com/users/paulreece","html_url":"https://github.com/paulreece","followers_url":"https://api.github.com/users/paulreece/followers","following_url":"https://api.github.com/users/paulreece/following{/other_user}","gists_url":"https://api.github.com/users/paulreece/gists{/gist_id}","starred_url":"https://api.github.com/users/paulreece/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/paulreece/subscriptions","organizations_url":"https://api.github.com/users/paulreece/orgs","repos_url":"https://api.github.com/users/paulreece/repos","events_url":"https://api.github.com/users/paulreece/events{/privacy}","received_events_url":"https://api.github.com/users/paulreece/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-10-03T18:13:49Z","label":{"name":"activerecord","color":"0b02e1"},"performed_via_github_app":null},{"id":10549464611,"node_id":"LE_lADNIULOcrPXes8AAAACdMwOIw","url":"https://api.github.com/repos/rails/rails/issues/events/10549464611","actor":{"login":"zzak","id":277819,"node_id":"MDQ6VXNlcjI3NzgxOQ==","avatar_url":"https://avatars.githubusercontent.com/u/277819?v=4","gravatar_id":"","url":"https://api.github.com/users/zzak","html_url":"https://github.com/zzak","followers_url":"https://api.github.com/users/zzak/followers","following_url":"https://api.github.com/users/zzak/following{/other_user}","gists_url":"https://api.github.com/users/zzak/gists{/gist_id}","starred_url":"https://api.github.com/users/zzak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zzak/subscriptions","organizations_url":"https://api.github.com/users/zzak/orgs","repos_url":"https://api.github.com/users/zzak/repos","events_url":"https://api.github.com/users/zzak/events{/privacy}","received_events_url":"https://api.github.com/users/zzak/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-10-04T10:57:29Z","label":{"name":"attached PR","color":"006b75"},"performed_via_github_app":null},{"actor":{"login":"zzak","id":277819,"node_id":"MDQ6VXNlcjI3NzgxOQ==","avatar_url":"https://avatars.githubusercontent.com/u/277819?v=4","gravatar_id":"","url":"https://api.github.com/users/zzak","html_url":"https://github.com/zzak","followers_url":"https://api.github.com/users/zzak/followers","following_url":"https://api.github.com/users/zzak/following{/other_user}","gists_url":"https://api.github.com/users/zzak/gists{/gist_id}","starred_url":"https://api.github.com/users/zzak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zzak/subscriptions","organizations_url":"https://api.github.com/users/zzak/orgs","repos_url":"https://api.github.com/users/zzak/repos","events_url":"https://api.github.com/users/zzak/events{/privacy}","received_events_url":"https://api.github.com/users/zzak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-04T10:57:42Z","updated_at":"2023-10-04T10:57:42Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/rails/rails/issues/48785","repository_url":"https://api.github.com/repos/rails/rails","labels_url":"https://api.github.com/repos/rails/rails/issues/48785/labels{/name}","comments_url":"https://api.github.com/repos/rails/rails/issues/48785/comments","events_url":"https://api.github.com/repos/rails/rails/issues/48785/events","html_url":"https://github.com/rails/rails/pull/48785","id":1816415292,"node_id":"PR_kwDNIULOViFuCg","number":48785,"title":"Fix child association loading in `:n_plus_one_only` mode","user":{"login":"reid-rigo","id":2439912,"node_id":"MDQ6VXNlcjI0Mzk5MTI=","avatar_url":"https://avatars.githubusercontent.com/u/2439912?v=4","gravatar_id":"","url":"https://api.github.com/users/reid-rigo","html_url":"https://github.com/reid-rigo","followers_url":"https://api.github.com/users/reid-rigo/followers","following_url":"https://api.github.com/users/reid-rigo/following{/other_user}","gists_url":"https://api.github.com/users/reid-rigo/gists{/gist_id}","starred_url":"https://api.github.com/users/reid-rigo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reid-rigo/subscriptions","organizations_url":"https://api.github.com/users/reid-rigo/orgs","repos_url":"https://api.github.com/users/reid-rigo/repos","events_url":"https://api.github.com/users/reid-rigo/events{/privacy}","received_events_url":"https://api.github.com/users/reid-rigo/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":107191,"node_id":"MDU6TGFiZWwxMDcxOTE=","url":"https://api.github.com/repos/rails/rails/labels/activerecord","name":"activerecord","color":"0b02e1","default":false,"description":null},{"id":1072773639,"node_id":"MDU6TGFiZWwxMDcyNzczNjM5","url":"https://api.github.com/repos/rails/rails/labels/ready","name":"ready","color":"fef2c0","default":false,"description":"PRs ready to merge"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2023-07-21T21:44:39Z","updated_at":"2024-04-19T02:00:34Z","closed_at":"2024-04-19T02:00:33Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":8514,"node_id":"MDEwOlJlcG9zaXRvcnk4NTE0","name":"rails","full_name":"rails/rails","private":false,"owner":{"login":"rails","id":4223,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQyMjM=","avatar_url":"https://avatars.githubusercontent.com/u/4223?v=4","gravatar_id":"","url":"https://api.github.com/users/rails","html_url":"https://github.com/rails","followers_url":"https://api.github.com/users/rails/followers","following_url":"https://api.github.com/users/rails/following{/other_user}","gists_url":"https://api.github.com/users/rails/gists{/gist_id}","starred_url":"https://api.github.com/users/rails/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rails/subscriptions","organizations_url":"https://api.github.com/users/rails/orgs","repos_url":"https://api.github.com/users/rails/repos","events_url":"https://api.github.com/users/rails/events{/privacy}","received_events_url":"https://api.github.com/users/rails/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/rails/rails","description":"Ruby on Rails","fork":false,"url":"https://api.github.com/repos/rails/rails","forks_url":"https://api.github.com/repos/rails/rails/forks","keys_url":"https://api.github.com/repos/rails/rails/keys{/key_id}","collaborators_url":"https://api.github.com/repos/rails/rails/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/rails/rails/teams","hooks_url":"https://api.github.com/repos/rails/rails/hooks","issue_events_url":"https://api.github.com/repos/rails/rails/issues/events{/number}","events_url":"https://api.github.com/repos/rails/rails/events","assignees_url":"https://api.github.com/repos/rails/rails/assignees{/user}","branches_url":"https://api.github.com/repos/rails/rails/branches{/branch}","tags_url":"https://api.github.com/repos/rails/rails/tags","blobs_url":"https://api.github.com/repos/rails/rails/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/rails/rails/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/rails/rails/git/refs{/sha}","trees_url":"https://api.github.com/repos/rails/rails/git/trees{/sha}","statuses_url":"https://api.github.com/repos/rails/rails/statuses/{sha}","languages_url":"https://api.github.com/repos/rails/rails/languages","stargazers_url":"https://api.github.com/repos/rails/rails/stargazers","contributors_url":"https://api.github.com/repos/rails/rails/contributors","subscribers_url":"https://api.github.com/repos/rails/rails/subscribers","subscription_url":"https://api.github.com/repos/rails/rails/subscription","commits_url":"https://api.github.com/repos/rails/rails/commits{/sha}","git_commits_url":"https://api.github.com/repos/rails/rails/git/commits{/sha}","comments_url":"https://api.github.com/repos/rails/rails/comments{/number}","issue_comment_url":"https://api.github.com/repos/rails/rails/issues/comments{/number}","contents_url":"https://api.github.com/repos/rails/rails/contents/{+path}","compare_url":"https://api.github.com/repos/rails/rails/compare/{base}...{head}","merges_url":"https://api.github.com/repos/rails/rails/merges","archive_url":"https://api.github.com/repos/rails/rails/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/rails/rails/downloads","issues_url":"https://api.github.com/repos/rails/rails/issues{/number}","pulls_url":"https://api.github.com/repos/rails/rails/pulls{/number}","milestones_url":"https://api.github.com/repos/rails/rails/milestones{/number}","notifications_url":"https://api.github.com/repos/rails/rails/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/rails/rails/labels{/name}","releases_url":"https://api.github.com/repos/rails/rails/releases{/id}","deployments_url":"https://api.github.com/repos/rails/rails/deployments","created_at":"2008-04-11T02:19:47Z","updated_at":"2025-11-10T02:03:47Z","pushed_at":"2025-11-10T00:33:52Z","git_url":"git://github.com/rails/rails.git","ssh_url":"git@github.com:rails/rails.git","clone_url":"https://github.com/rails/rails.git","svn_url":"https://github.com/rails/rails","homepage":"https://rubyonrails.org","size":271619,"stargazers_count":57840,"watchers_count":57840,"language":"Ruby","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":22025,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1341,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["activejob","activerecord","framework","html","mvc","rails","ruby"],"visibility":"public","forks":22025,"open_issues":1341,"watchers":57840,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/rails/rails/pulls/48785","html_url":"https://github.com/rails/rails/pull/48785","diff_url":"https://github.com/rails/rails/pull/48785.diff","patch_url":"https://github.com/rails/rails/pull/48785.patch","merged_at":"2024-04-19T02:00:33Z"},"body":"<!--\r\nThanks for contributing to Rails!\r\n\r\nPlease do not make *Draft* pull requests, as they still send\r\nnotifications to everyone watching the Rails repo.\r\n\r\nCreate a pull request when it is ready for review and feedback\r\nfrom the Rails team :).\r\n\r\nIf your pull request affects documentation or any non-code\r\nchanges, guidelines for those changes are [available\r\nhere](https://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html#contributing-to-the-rails-documentation)\r\n\r\nAbout this template\r\n\r\nThe following template aims to help contributors write a good description for their pull requests.\r\nWe'd like you to provide a description of the changes in your pull request (i.e. bugs fixed or features added), motivation behind the changes, and complete the checklist below before opening a pull request.\r\n\r\nFeel free to discard it if you need to (e.g. when you just fix a typo). -->\r\n\r\n### Motivation / Background\r\n\r\nFixes #49473\r\n\r\nStrict loading in `:n_plus_one_only` mode is designed to prevent performance issues when deeply traversing associations. It allows `Person.find(1).posts`, but _not_ `Person.find(1).posts.map(&:category)`. This fix avoids the surprise that occurs when `person.posts.first` eagerly loads the whole association rather than allowing the user to manage the child association.\r\n\r\nThis fixes a serious ordering issue. Without strict loading, `person.posts.first` is guaranteed to return the first post in primary key order. On the other hand, `person.posts.load.first` is nondeterministic. The database is not guaranteed to return in a consistent order, in particular under load with other operations occurring. This is a rude surprise when trying to use `:n_plus_one_only` mode.\r\n\r\n### Detail\r\n\r\nBefore:\r\n\r\n```ruby\r\nperson = Person.find(1)\r\nperson.strict_loading!(mode: :n_plus_one_only)\r\nperson.posts.first\r\n# SELECT * FROM posts WHERE person_id = 1; -- non-deterministic order\r\n```\r\n\r\nAfter:\r\n\r\n```ruby\r\nperson = Person.find(1)\r\nperson.strict_loading!(mode: :n_plus_one_only)\r\nperson.posts.first # this is 1+1, not N+1\r\n# SELECT * FROM posts WHERE person_id = 1 ORDER BY id LIMIT 1;\r\n```\r\n\r\n### Checklist\r\n\r\nBefore submitting the PR make sure the following are checked:\r\n\r\n* [x] This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.\r\n* [x] Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: `[Fix #issue-number]`\r\n* [x] Tests are added or updated if you fix a bug or add a feature.\r\n* [x] CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.\r\n","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/48785/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rails/rails/issues/48785/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":10878608490,"node_id":"REFE_lADNIULOcrPXes8AAAACiGpkag","url":"https://api.github.com/repos/rails/rails/issues/events/10878608490","actor":{"login":"reid-rigo","id":2439912,"node_id":"MDQ6VXNlcjI0Mzk5MTI=","avatar_url":"https://avatars.githubusercontent.com/u/2439912?v=4","gravatar_id":"","url":"https://api.github.com/users/reid-rigo","html_url":"https://github.com/reid-rigo","followers_url":"https://api.github.com/users/reid-rigo/followers","following_url":"https://api.github.com/users/reid-rigo/following{/other_user}","gists_url":"https://api.github.com/users/reid-rigo/gists{/gist_id}","starred_url":"https://api.github.com/users/reid-rigo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reid-rigo/subscriptions","organizations_url":"https://api.github.com/users/reid-rigo/orgs","repos_url":"https://api.github.com/users/reid-rigo/repos","events_url":"https://api.github.com/users/reid-rigo/events{/privacy}","received_events_url":"https://api.github.com/users/reid-rigo/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"5ca58b0818aa55003e514f7b50aa71d3a53a81b0","commit_url":"https://api.github.com/repos/reid-rigo/rails/commits/5ca58b0818aa55003e514f7b50aa71d3a53a81b0","created_at":"2023-11-06T21:14:02Z","performed_via_github_app":null},{"id":10878616259,"node_id":"REFE_lADNIULOcrPXes8AAAACiGqCww","url":"https://api.github.com/repos/rails/rails/issues/events/10878616259","actor":{"login":"reid-rigo","id":2439912,"node_id":"MDQ6VXNlcjI0Mzk5MTI=","avatar_url":"https://avatars.githubusercontent.com/u/2439912?v=4","gravatar_id":"","url":"https://api.github.com/users/reid-rigo","html_url":"https://github.com/reid-rigo","followers_url":"https://api.github.com/users/reid-rigo/followers","following_url":"https://api.github.com/users/reid-rigo/following{/other_user}","gists_url":"https://api.github.com/users/reid-rigo/gists{/gist_id}","starred_url":"https://api.github.com/users/reid-rigo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reid-rigo/subscriptions","organizations_url":"https://api.github.com/users/reid-rigo/orgs","repos_url":"https://api.github.com/users/reid-rigo/repos","events_url":"https://api.github.com/users/reid-rigo/events{/privacy}","received_events_url":"https://api.github.com/users/reid-rigo/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"1d9ac36e3850c0065aa665fe014565854e3a1504","commit_url":"https://api.github.com/repos/reid-rigo/rails/commits/1d9ac36e3850c0065aa665fe014565854e3a1504","created_at":"2023-11-06T21:14:58Z","performed_via_github_app":null},{"id":10878630195,"node_id":"REFE_lADNIULOcrPXes8AAAACiGq5Mw","url":"https://api.github.com/repos/rails/rails/issues/events/10878630195","actor":{"login":"reid-rigo","id":2439912,"node_id":"MDQ6VXNlcjI0Mzk5MTI=","avatar_url":"https://avatars.githubusercontent.com/u/2439912?v=4","gravatar_id":"","url":"https://api.github.com/users/reid-rigo","html_url":"https://github.com/reid-rigo","followers_url":"https://api.github.com/users/reid-rigo/followers","following_url":"https://api.github.com/users/reid-rigo/following{/other_user}","gists_url":"https://api.github.com/users/reid-rigo/gists{/gist_id}","starred_url":"https://api.github.com/users/reid-rigo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reid-rigo/subscriptions","organizations_url":"https://api.github.com/users/reid-rigo/orgs","repos_url":"https://api.github.com/users/reid-rigo/repos","events_url":"https://api.github.com/users/reid-rigo/events{/privacy}","received_events_url":"https://api.github.com/users/reid-rigo/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"cd45a3c0fc50f1345e2016b5799d2fe287cedf85","commit_url":"https://api.github.com/repos/reid-rigo/rails/commits/cd45a3c0fc50f1345e2016b5799d2fe287cedf85","created_at":"2023-11-06T21:16:41Z","performed_via_github_app":null},{"id":12529050668,"node_id":"REFE_lADNIULOcrPXes8AAAAC6sokLA","url":"https://api.github.com/repos/rails/rails/issues/events/12529050668","actor":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"5cfaad2b992e4a70464164e9be3c7a179aa67825","commit_url":"https://api.github.com/repos/reid-rigo/rails/commits/5cfaad2b992e4a70464164e9be3c7a179aa67825","created_at":"2024-04-18T21:05:10Z","performed_via_github_app":null},{"id":12530204068,"node_id":"REFE_lADNIULOcrPXes8AAAAC6tu9pA","url":"https://api.github.com/repos/rails/rails/issues/events/12530204068","actor":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"f900fd44a82289d8b69690d3aca4af0f77e23de9","commit_url":"https://api.github.com/repos/reid-rigo/rails/commits/f900fd44a82289d8b69690d3aca4af0f77e23de9","created_at":"2024-04-18T23:04:53Z","performed_via_github_app":null},{"id":12530241137,"node_id":"REFE_lADNIULOcrPXes8AAAAC6txOcQ","url":"https://api.github.com/repos/rails/rails/issues/events/12530241137","actor":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"6bacf171123ed672715c2e7d0b6dbcbd662855ba","commit_url":"https://api.github.com/repos/reid-rigo/rails/commits/6bacf171123ed672715c2e7d0b6dbcbd662855ba","created_at":"2024-04-18T23:10:32Z","performed_via_github_app":null},{"id":12530612424,"node_id":"REFE_lADNIULOcrPXes8AAAAC6uH4yA","url":"https://api.github.com/repos/rails/rails/issues/events/12530612424","actor":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"715276071f8ab72292b88df5d8d25855a35d4339","commit_url":"https://api.github.com/repos/reid-rigo/rails/commits/715276071f8ab72292b88df5d8d25855a35d4339","created_at":"2024-04-19T00:05:19Z","performed_via_github_app":null},{"id":12531412057,"node_id":"CE_lADNIULOcrPXes8AAAAC6u4sWQ","url":"https://api.github.com/repos/rails/rails/issues/events/12531412057","actor":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2024-04-19T02:00:35Z","state_reason":null,"performed_via_github_app":null},{"id":12787379929,"node_id":"REFE_lADNIULOcrPXes8AAAAC-i_u2Q","url":"https://api.github.com/repos/rails/rails/issues/events/12787379929","actor":{"login":"fractaledmind","id":5077225,"node_id":"MDQ6VXNlcjUwNzcyMjU=","avatar_url":"https://avatars.githubusercontent.com/u/5077225?v=4","gravatar_id":"","url":"https://api.github.com/users/fractaledmind","html_url":"https://github.com/fractaledmind","followers_url":"https://api.github.com/users/fractaledmind/followers","following_url":"https://api.github.com/users/fractaledmind/following{/other_user}","gists_url":"https://api.github.com/users/fractaledmind/gists{/gist_id}","starred_url":"https://api.github.com/users/fractaledmind/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fractaledmind/subscriptions","organizations_url":"https://api.github.com/users/fractaledmind/orgs","repos_url":"https://api.github.com/users/fractaledmind/repos","events_url":"https://api.github.com/users/fractaledmind/events{/privacy}","received_events_url":"https://api.github.com/users/fractaledmind/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"de4b782b7fcb06cc95c91ff6bc6a8373dff64997","commit_url":"https://api.github.com/repos/fractaledmind/rails/commits/de4b782b7fcb06cc95c91ff6bc6a8373dff64997","created_at":"2024-05-13T13:25:49Z","performed_via_github_app":null},{"id":13091796041,"node_id":"REFE_lADNIULOcrPXes8AAAADDFT0SQ","url":"https://api.github.com/repos/rails/rails/issues/events/13091796041","actor":{"login":"xjunior","id":8156,"node_id":"MDQ6VXNlcjgxNTY=","avatar_url":"https://avatars.githubusercontent.com/u/8156?v=4","gravatar_id":"","url":"https://api.github.com/users/xjunior","html_url":"https://github.com/xjunior","followers_url":"https://api.github.com/users/xjunior/followers","following_url":"https://api.github.com/users/xjunior/following{/other_user}","gists_url":"https://api.github.com/users/xjunior/gists{/gist_id}","starred_url":"https://api.github.com/users/xjunior/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xjunior/subscriptions","organizations_url":"https://api.github.com/users/xjunior/orgs","repos_url":"https://api.github.com/users/xjunior/repos","events_url":"https://api.github.com/users/xjunior/events{/privacy}","received_events_url":"https://api.github.com/users/xjunior/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"3c0cfec7c5b5a310e5d111bbf81ee202f8237e85","commit_url":"https://api.github.com/repos/xjunior/rails/commits/3c0cfec7c5b5a310e5d111bbf81ee202f8237e85","created_at":"2024-06-09T15:41:52Z","performed_via_github_app":null},{"id":13417922520,"node_id":"REFE_lADNIULOcrPXes8AAAADH8U_2A","url":"https://api.github.com/repos/rails/rails/issues/events/13417922520","actor":{"login":"Set2005","id":209831,"node_id":"MDQ6VXNlcjIwOTgzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/209831?v=4","gravatar_id":"","url":"https://api.github.com/users/Set2005","html_url":"https://github.com/Set2005","followers_url":"https://api.github.com/users/Set2005/followers","following_url":"https://api.github.com/users/Set2005/following{/other_user}","gists_url":"https://api.github.com/users/Set2005/gists{/gist_id}","starred_url":"https://api.github.com/users/Set2005/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Set2005/subscriptions","organizations_url":"https://api.github.com/users/Set2005/orgs","repos_url":"https://api.github.com/users/Set2005/repos","events_url":"https://api.github.com/users/Set2005/events{/privacy}","received_events_url":"https://api.github.com/users/Set2005/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"6393a583b5d66775f17d50aa80d401a1d4d75e48","commit_url":"https://api.github.com/repos/Set2005/fix-association-initialize-order/commits/6393a583b5d66775f17d50aa80d401a1d4d75e48","created_at":"2024-07-08T05:31:21Z","performed_via_github_app":null},{"actor":{"login":"INexizI","id":39536903,"node_id":"MDQ6VXNlcjM5NTM2OTAz","avatar_url":"https://avatars.githubusercontent.com/u/39536903?v=4","gravatar_id":"","url":"https://api.github.com/users/INexizI","html_url":"https://github.com/INexizI","followers_url":"https://api.github.com/users/INexizI/followers","following_url":"https://api.github.com/users/INexizI/following{/other_user}","gists_url":"https://api.github.com/users/INexizI/gists{/gist_id}","starred_url":"https://api.github.com/users/INexizI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/INexizI/subscriptions","organizations_url":"https://api.github.com/users/INexizI/orgs","repos_url":"https://api.github.com/users/INexizI/repos","events_url":"https://api.github.com/users/INexizI/events{/privacy}","received_events_url":"https://api.github.com/users/INexizI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-31T10:00:44Z","updated_at":"2024-08-31T10:00:44Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/INexizI/KR-DB/issues/392","repository_url":"https://api.github.com/repos/INexizI/KR-DB","labels_url":"https://api.github.com/repos/INexizI/KR-DB/issues/392/labels{/name}","comments_url":"https://api.github.com/repos/INexizI/KR-DB/issues/392/comments","events_url":"https://api.github.com/repos/INexizI/KR-DB/issues/392/events","html_url":"https://github.com/INexizI/KR-DB/pull/392","id":2498762120,"node_id":"PR_kwDOFXHYDM56DH-4","number":392,"title":"[Snyk] Upgrade @rails/actioncable from 7.1.3 to 7.2.0","user":{"login":"INexizI","id":39536903,"node_id":"MDQ6VXNlcjM5NTM2OTAz","avatar_url":"https://avatars.githubusercontent.com/u/39536903?v=4","gravatar_id":"","url":"https://api.github.com/users/INexizI","html_url":"https://github.com/INexizI","followers_url":"https://api.github.com/users/INexizI/followers","following_url":"https://api.github.com/users/INexizI/following{/other_user}","gists_url":"https://api.github.com/users/INexizI/gists{/gist_id}","starred_url":"https://api.github.com/users/INexizI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/INexizI/subscriptions","organizations_url":"https://api.github.com/users/INexizI/orgs","repos_url":"https://api.github.com/users/INexizI/repos","events_url":"https://api.github.com/users/INexizI/events{/privacy}","received_events_url":"https://api.github.com/users/INexizI/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"INexizI","id":39536903,"node_id":"MDQ6VXNlcjM5NTM2OTAz","avatar_url":"https://avatars.githubusercontent.com/u/39536903?v=4","gravatar_id":"","url":"https://api.github.com/users/INexizI","html_url":"https://github.com/INexizI","followers_url":"https://api.github.com/users/INexizI/followers","following_url":"https://api.github.com/users/INexizI/following{/other_user}","gists_url":"https://api.github.com/users/INexizI/gists{/gist_id}","starred_url":"https://api.github.com/users/INexizI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/INexizI/subscriptions","organizations_url":"https://api.github.com/users/INexizI/orgs","repos_url":"https://api.github.com/users/INexizI/repos","events_url":"https://api.github.com/users/INexizI/events{/privacy}","received_events_url":"https://api.github.com/users/INexizI/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"INexizI","id":39536903,"node_id":"MDQ6VXNlcjM5NTM2OTAz","avatar_url":"https://avatars.githubusercontent.com/u/39536903?v=4","gravatar_id":"","url":"https://api.github.com/users/INexizI","html_url":"https://github.com/INexizI","followers_url":"https://api.github.com/users/INexizI/followers","following_url":"https://api.github.com/users/INexizI/following{/other_user}","gists_url":"https://api.github.com/users/INexizI/gists{/gist_id}","starred_url":"https://api.github.com/users/INexizI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/INexizI/subscriptions","organizations_url":"https://api.github.com/users/INexizI/orgs","repos_url":"https://api.github.com/users/INexizI/repos","events_url":"https://api.github.com/users/INexizI/events{/privacy}","received_events_url":"https://api.github.com/users/INexizI/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":0,"created_at":"2024-08-31T10:00:43Z","updated_at":"2024-09-01T22:09:13Z","closed_at":"2024-09-01T22:09:11Z","author_association":"OWNER","active_lock_reason":null,"draft":false,"repository":{"id":359782412,"node_id":"MDEwOlJlcG9zaXRvcnkzNTk3ODI0MTI=","name":"KR-DB","full_name":"INexizI/KR-DB","private":false,"owner":{"login":"INexizI","id":39536903,"node_id":"MDQ6VXNlcjM5NTM2OTAz","avatar_url":"https://avatars.githubusercontent.com/u/39536903?v=4","gravatar_id":"","url":"https://api.github.com/users/INexizI","html_url":"https://github.com/INexizI","followers_url":"https://api.github.com/users/INexizI/followers","following_url":"https://api.github.com/users/INexizI/following{/other_user}","gists_url":"https://api.github.com/users/INexizI/gists{/gist_id}","starred_url":"https://api.github.com/users/INexizI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/INexizI/subscriptions","organizations_url":"https://api.github.com/users/INexizI/orgs","repos_url":"https://api.github.com/users/INexizI/repos","events_url":"https://api.github.com/users/INexizI/events{/privacy}","received_events_url":"https://api.github.com/users/INexizI/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/INexizI/KR-DB","description":"Extended version KR-Calc + Heroes DB","fork":false,"url":"https://api.github.com/repos/INexizI/KR-DB","forks_url":"https://api.github.com/repos/INexizI/KR-DB/forks","keys_url":"https://api.github.com/repos/INexizI/KR-DB/keys{/key_id}","collaborators_url":"https://api.github.com/repos/INexizI/KR-DB/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/INexizI/KR-DB/teams","hooks_url":"https://api.github.com/repos/INexizI/KR-DB/hooks","issue_events_url":"https://api.github.com/repos/INexizI/KR-DB/issues/events{/number}","events_url":"https://api.github.com/repos/INexizI/KR-DB/events","assignees_url":"https://api.github.com/repos/INexizI/KR-DB/assignees{/user}","branches_url":"https://api.github.com/repos/INexizI/KR-DB/branches{/branch}","tags_url":"https://api.github.com/repos/INexizI/KR-DB/tags","blobs_url":"https://api.github.com/repos/INexizI/KR-DB/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/INexizI/KR-DB/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/INexizI/KR-DB/git/refs{/sha}","trees_url":"https://api.github.com/repos/INexizI/KR-DB/git/trees{/sha}","statuses_url":"https://api.github.com/repos/INexizI/KR-DB/statuses/{sha}","languages_url":"https://api.github.com/repos/INexizI/KR-DB/languages","stargazers_url":"https://api.github.com/repos/INexizI/KR-DB/stargazers","contributors_url":"https://api.github.com/repos/INexizI/KR-DB/contributors","subscribers_url":"https://api.github.com/repos/INexizI/KR-DB/subscribers","subscription_url":"https://api.github.com/repos/INexizI/KR-DB/subscription","commits_url":"https://api.github.com/repos/INexizI/KR-DB/commits{/sha}","git_commits_url":"https://api.github.com/repos/INexizI/KR-DB/git/commits{/sha}","comments_url":"https://api.github.com/repos/INexizI/KR-DB/comments{/number}","issue_comment_url":"https://api.github.com/repos/INexizI/KR-DB/issues/comments{/number}","contents_url":"https://api.github.com/repos/INexizI/KR-DB/contents/{+path}","compare_url":"https://api.github.com/repos/INexizI/KR-DB/compare/{base}...{head}","merges_url":"https://api.github.com/repos/INexizI/KR-DB/merges","archive_url":"https://api.github.com/repos/INexizI/KR-DB/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/INexizI/KR-DB/downloads","issues_url":"https://api.github.com/repos/INexizI/KR-DB/issues{/number}","pulls_url":"https://api.github.com/repos/INexizI/KR-DB/pulls{/number}","milestones_url":"https://api.github.com/repos/INexizI/KR-DB/milestones{/number}","notifications_url":"https://api.github.com/repos/INexizI/KR-DB/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/INexizI/KR-DB/labels{/name}","releases_url":"https://api.github.com/repos/INexizI/KR-DB/releases{/id}","deployments_url":"https://api.github.com/repos/INexizI/KR-DB/deployments","created_at":"2021-04-20T10:56:43Z","updated_at":"2025-11-06T14:30:34Z","pushed_at":"2025-11-10T05:04:43Z","git_url":"git://github.com/INexizI/KR-DB.git","ssh_url":"git@github.com:INexizI/KR-DB.git","clone_url":"https://github.com/INexizI/KR-DB.git","svn_url":"https://github.com/INexizI/KR-DB","homepage":"","size":987672,"stargazers_count":0,"watchers_count":0,"language":"Slim","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":10,"license":null,"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":10,"watchers":0,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/INexizI/KR-DB/pulls/392","html_url":"https://github.com/INexizI/KR-DB/pull/392","diff_url":"https://github.com/INexizI/KR-DB/pull/392.diff","patch_url":"https://github.com/INexizI/KR-DB/pull/392.patch","merged_at":"2024-09-01T22:09:11Z"},"body":"![snyk-top-banner](https://github.com/andygongea/OWASP-Benchmark/assets/818805/c518c423-16fe-447e-b67f-ad5a49b5d123)\n\n\n<h3>Snyk has created this PR to upgrade @rails/actioncable from 7.1.3 to 7.2.0.</h3>\n\n:information_source: Keep your dependencies up-to-date. This makes it easier to fix existing vulnerabilities and to more quickly identify and fix newly disclosed vulnerabilities when they affect your project.\n\n<hr/>\n\n\n- The recommended version is **6 versions** ahead of your current version.\n\n- The recommended version was released on **21 days ago**.\n\n\n\n<details>\n<summary><b>Release notes</b></summary>\n<br/>\n  <details>\n    <summary>Package name: <b>@rails/actioncable</b></summary>\n    <ul>\n      <li>\n        <b>7.2.0</b> - <a href=\"https://github.com/rails/rails/releases/tag/v7.2.0\">2024-08-09</a></br><h2>Active Support</h2>\n<ul>\n<li>\n<p>Fix <code>delegate_missing_to allow_nil: true</code> when called with implict self</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Person\n  delegate_missing_to :address, allow_nil: true\n\n  def address\n    nil\n  end\n\n  def berliner?\n    city == &quot;Berlin&quot;\n  end\nend\n\nPerson.new.city # =&gt; nil\nPerson.new.berliner? # undefined local variable or method `city' for an instance of Person (NameError)\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Person</span>\n  <span class=\"pl-en\">delegate_missing_to</span> <span class=\"pl-pds\">:address</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">allow_nil</span>: <span class=\"pl-c1\">true</span>\n\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">address</span>\n    <span class=\"pl-c1\">nil</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">berliner?</span>\n    <span class=\"pl-en\">city</span> == <span class=\"pl-s\">\"Berlin\"</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">city</span> <span class=\"pl-c\"># =&gt; nil</span>\n<span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">berliner?</span> <span class=\"pl-c\"># undefined local variable or method `city' for an instance of Person (NameError)</span></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add <code>logger</code> as a dependency since it is a bundled gem candidate for Ruby 3.5</p>\n<p><em>Earlopain</em></p>\n</li>\n<li>\n<p>Define <code>Digest::UUID.nil_uuid</code>, which returns the so-called nil UUID.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Support <code>duration</code> type in <code>ActiveSupport::XmlMini</code>.</p>\n<p><em>heka1024</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveSupport::Notifications::Event#children</code> and  <code>ActiveSupport::Notifications::Event#parent_of?</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to call the following methods without passing a deprecator:</p>\n<ul>\n<li><code>deprecate</code></li>\n<li><code>deprecate_constant</code></li>\n<li><code>ActiveSupport::Deprecation::DeprecatedObjectProxy.new</code></li>\n<li><code>ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy.new</code></li>\n<li><code>ActiveSupport::Deprecation::DeprecatedConstantProxy.new</code></li>\n<li><code>assert_deprecated</code></li>\n<li><code>assert_not_deprecated</code></li>\n<li><code>collect_deprecations</code></li>\n</ul>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveSupport::Deprecation</code> delegation to instance.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>SafeBuffer#clone_empty</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>#to_default_s</code> from <code>Array</code>, <code>Date</code>, <code>DateTime</code> and <code>Time</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to passing <code>Dalli::Client</code> instances to <code>MemCacheStore</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>config.active_support.use_rfc4122_namespaced_uuids</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>config.active_support.remove_deprecated_time_with_zone_name</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>config.active_support.disable_to_s_conversion</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to bolding log text with positional boolean in <code>ActiveSupport::LogSubscriber#color</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated constants <code>ActiveSupport::LogSubscriber::CLEAR</code> and <code>ActiveSupport::LogSubscriber::BOLD</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support for <code>config.active_support.cache_format_version = 6.1</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>:pool_size</code> and <code>:pool_timeout</code> options for the cache storage.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Warn on tests without assertions.</p>\n<p><code>ActiveSupport::TestCase</code> now warns when tests do not run any assertions.<br>\nThis is helpful in detecting broken tests that do not perform intended assertions.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Support <code>hexBinary</code> type in <code>ActiveSupport::XmlMini</code>.</p>\n<p><em>heka1024</em></p>\n</li>\n<li>\n<p>Deprecate <code>ActiveSupport::ProxyObject</code> in favor of Ruby's built-in <code>BasicObject</code>.</p>\n<p><em>Earlopain</em></p>\n</li>\n<li>\n<p><code>stub_const</code> now accepts a <code>exists: false</code> parameter to allow stubbing missing constants.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Make <code>ActiveSupport::BacktraceCleaner</code> copy filters and silencers on dup and clone.</p>\n<p>Previously the copy would still share the internal silencers and filters array,<br>\ncausing state to leak.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Updating Astana with Western Kazakhstan TZInfo identifier.</p>\n<p><em>Damian Nelson</em></p>\n</li>\n<li>\n<p>Add filename support for <code>ActiveSupport::Logger.logger_outputs_to?</code>.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"logger = Logger.new('/var/log/rails.log')\nActiveSupport::Logger.logger_outputs_to?(logger, '/var/log/rails.log')\"><pre><span class=\"pl-s1\">logger</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Logger</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'/var/log/rails.log'</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">Logger</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">logger_outputs_to?</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">logger</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'/var/log/rails.log'</span><span class=\"pl-kos\">)</span></pre></div>\n<p><em>Christian Schmidt</em></p>\n</li>\n<li>\n<p>Include <code>IPAddr#prefix</code> when serializing an <code>IPAddr</code> using the<br>\n<code>ActiveSupport::MessagePack</code> serializer.</p>\n<p>This change is backward and forward compatible — old payloads can<br>\nstill be read, and new payloads will be readable by older versions of Rails.</p>\n<p><em>Taiki Komaba</em></p>\n</li>\n<li>\n<p>Add <code>default:</code> support for <code>ActiveSupport::CurrentAttributes.attribute</code>.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Current &lt; ActiveSupport::CurrentAttributes\n  attribute :counter, default: 0\nend\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Current</span> &lt; <span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">CurrentAttributes</span>\n  <span class=\"pl-en\">attribute</span> <span class=\"pl-pds\">:counter</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">default</span>: <span class=\"pl-c1\">0</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Sean Doyle</em></p>\n</li>\n<li>\n<p>Yield instance to <code>Object#with</code> block.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"client.with(timeout: 5_000) do |c|\n  c.get(&quot;/commits&quot;)\nend\"><pre><span class=\"pl-en\">client</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">timeout</span>: <span class=\"pl-c1\">5_000</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">c</span>|\n  <span class=\"pl-s1\">c</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">get</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"/commits\"</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Sean Doyle</em></p>\n</li>\n<li>\n<p>Use logical core count instead of physical core count to determine the<br>\ndefault number of workers when parallelizing tests.</p>\n<p><em>Jonathan Hefner</em></p>\n</li>\n<li>\n<p>Fix <code>Time.now/DateTime.now/Date.today</code> to return results in a system timezone after <code>#travel_to</code>.</p>\n<p>There is a bug in the current implementation of #travel_to:<br>\nit remembers a timezone of its argument, and all stubbed methods start<br>\nreturning results in that remembered timezone. However, the expected<br>\nbehavior is to return results in a system timezone.</p>\n<p><em>Aleksei Chernenkov</em></p>\n</li>\n<li>\n<p>Add <code>ErrorReported#unexpected</code> to report precondition violations.</p>\n<p>For example:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"def edit\n  if published?\n    Rails.error.unexpected(&quot;[BUG] Attempting to edit a published article, that shouldn't be possible&quot;)\n    return false\n  end\n  # ...\nend\"><pre><span class=\"pl-k\">def</span> <span class=\"pl-en\">edit</span>\n  <span class=\"pl-k\">if</span> <span class=\"pl-en\">published?</span>\n    <span class=\"pl-v\">Rails</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">error</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">unexpected</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"[BUG] Attempting to edit a published article, that shouldn't be possible\"</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">false</span>\n  <span class=\"pl-k\">end</span>\n  <span class=\"pl-c\"># ...</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p>The above will raise an error in development and test, but only report the error in production.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Make the order of read_multi and write_multi notifications for <code>Cache::Store#fetch_multi</code> operations match the order they are executed in.</p>\n<p><em>Adam Renberg Tamm</em></p>\n</li>\n<li>\n<p>Make return values of <code>Cache::Store#write</code> consistent.</p>\n<p>The return value was not specified before. Now it returns <code>true</code> on a successful write,<br>\n<code>nil</code> if there was an error talking to the cache backend, and <code>false</code> if the write failed<br>\nfor another reason (e.g. the key already exists and <code>unless_exist: true</code> was passed).</p>\n<p><em>Sander Verdonschot</em></p>\n</li>\n<li>\n<p>Fix logged cache keys not always matching actual key used by cache action.</p>\n<p><em>Hartley McGuire</em></p>\n</li>\n<li>\n<p>Improve error messages of <code>assert_changes</code> and <code>assert_no_changes</code>.</p>\n<p><code>assert_changes</code> error messages now display objects with <code>.inspect</code> to make it easier<br>\nto differentiate nil from empty strings, strings from symbols, etc.<br>\n<code>assert_no_changes</code> error messages now surface the actual value.</p>\n<p><em>pcreux</em></p>\n</li>\n<li>\n<p>Fix <code>#to_fs(:human_size)</code> to correctly work with negative numbers.</p>\n<p><em>Earlopain</em></p>\n</li>\n<li>\n<p>Fix <code>BroadcastLogger#dup</code> so that it duplicates the logger's <code>broadcasts</code>.</p>\n<p><em>Andrew Novoselac</em></p>\n</li>\n<li>\n<p>Fix issue where <code>bootstrap.rb</code> overwrites the <code>level</code> of a <code>BroadcastLogger</code>'s <code>broadcasts</code>.</p>\n<p><em>Andrew Novoselac</em></p>\n</li>\n<li>\n<p>Fix compatibility with the <code>semantic_logger</code> gem.</p>\n<p>The <code>semantic_logger</code> gem doesn't behave exactly like stdlib logger in that<br>\n<code>SemanticLogger#level</code> returns a Symbol while stdlib <code>Logger#level</code> returns an Integer.</p>\n<p>This caused the various <code>LogSubscriber</code> classes in Rails to break when assigned a<br>\n<code>SemanticLogger</code> instance.</p>\n<p><em>Jean Boussier</em>, <em>ojab</em></p>\n</li>\n<li>\n<p>Fix MemoryStore to prevent race conditions when incrementing or decrementing.</p>\n<p><em>Pierre Jambet</em></p>\n</li>\n<li>\n<p>Implement <code>HashWithIndifferentAccess#to_proc</code>.</p>\n<p>Previously, calling <code>#to_proc</code> on <code>HashWithIndifferentAccess</code> object used inherited <code>#to_proc</code><br>\nmethod from the <code>Hash</code> class, which was not able to access values using indifferent keys.</p>\n<p><em>fatkodima</em></p>\n</li>\n</ul>\n<h2>Active Model</h2>\n<ul>\n<li>\n<p>Fix a bug where type casting of string to <code>Time</code> and <code>DateTime</code> doesn't<br>\ncalculate minus minute value in TZ offset correctly.</p>\n<p><em>Akira Matsuda</em></p>\n</li>\n<li>\n<p>Port the <code>type_for_attribute</code> method to Active Model. Classes that include<br>\n<code>ActiveModel::Attributes</code> will now provide this method. This method behaves<br>\nthe same for Active Model as it does for Active Record.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class MyModel\n  include ActiveModel::Attributes\n\n  attribute :my_attribute, :integer\nend\n\nMyModel.type_for_attribute(:my_attribute) # =&gt; #&lt;ActiveModel::Type::Integer ...&gt;\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">MyModel</span>\n  <span class=\"pl-en\">include</span> <span class=\"pl-v\">ActiveModel</span>::<span class=\"pl-v\">Attributes</span>\n\n  <span class=\"pl-en\">attribute</span> <span class=\"pl-pds\">:my_attribute</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:integer</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-v\">MyModel</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">type_for_attribute</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:my_attribute</span><span class=\"pl-kos\">)</span> <span class=\"pl-c\"># =&gt; #&lt;ActiveModel::Type::Integer ...&gt;</span></pre></div>\n<p><em>Jonathan Hefner</em></p>\n</li>\n</ul>\n<h2>Active Record</h2>\n<ul>\n<li>\n<p>Handle commas in Sqlite3 default function definitions.</p>\n<p><em>Stephen Margheim</em></p>\n</li>\n<li>\n<p>Fixes <code>validates_associated</code> raising an exception when configured with a<br>\nsingular association and having <code>index_nested_attribute_errors</code> enabled.</p>\n<p><em>Martin Spickermann</em></p>\n</li>\n<li>\n<p>The constant <code>ActiveRecord::ImmutableRelation</code> has been deprecated because<br>\nwe want to reserve that name for a stronger sense of \"immutable relation\".<br>\nPlease use <code>ActiveRecord::UnmodifiableRelation</code> instead.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Add condensed <code>#inspect</code> for <code>ConnectionPool</code>, <code>AbstractAdapter</code>, and<br>\n<code>DatabaseConfig</code>.</p>\n<p><em>Hartley McGuire</em></p>\n</li>\n<li>\n<p>Fixed a memory performance issue in Active Record attribute methods definition.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Define the new Active Support notification event <code>start_transaction.active_record</code>.</p>\n<p>This event is fired when database transactions or savepoints start, and<br>\ncomplements <code>transaction.active_record</code>, which is emitted when they finish.</p>\n<p>The payload has the transaction (<code>:transaction</code>) and the connection (<code>:connection</code>).</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Fix an issue where the IDs reader method did not return expected results<br>\nfor preloaded associations in models using composite primary keys.</p>\n<p><em>Jay Ang</em></p>\n</li>\n<li>\n<p>The payload of <code>sql.active_record</code> Active Support notifications now has the current transaction in the <code>:transaction</code> key.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>The payload of <code>transaction.active_record</code> Active Support notifications now has the transaction the event is related to in the <code>:transaction</code> key.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Define <code>ActiveRecord::Transaction#uuid</code>, which returns a UUID for the database transaction. This may be helpful when tracing database activity. These UUIDs are generated only on demand.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Fix inference of association model on nested models with the same demodularized name.</p>\n<p>E.g. with the following setup:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Nested::Post &lt; ApplicationRecord\n  has_one :post, through: :other\nend\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Nested</span>::<span class=\"pl-v\">Post</span> &lt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-en\">has_one</span> <span class=\"pl-pds\">:post</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">through</span>: <span class=\"pl-pds\">:other</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p>Before, <code>#post</code> would infer the model as <code>Nested::Post</code>, but now it correctly infers <code>Post</code>.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>PostgreSQL <code>Cidr#change?</code> detects the address prefix change.</p>\n<p><em>Taketo Takashima</em></p>\n</li>\n<li>\n<p>Change <code>BatchEnumerator#destroy_all</code> to return the total number of affected rows.</p>\n<p>Previously, it always returned <code>nil</code>.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Support <code>touch_all</code> in batches.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Post.in_batches.touch_all\"><pre><span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">in_batches</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">touch_all</span></pre></div>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Add support for <code>:if_not_exists</code> and <code>:force</code> options to <code>create_schema</code>.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Fix <code>index_errors</code> having incorrect index in association validation errors.</p>\n<p><em>lulalala</em></p>\n</li>\n<li>\n<p>Add <code>index_errors: :nested_attributes_order</code> mode.</p>\n<p>This indexes the association validation errors based on the order received by nested attributes setter, and respects the <code>reject_if</code> configuration. This enables API to provide enough information to the frontend to map the validation errors back to their respective form fields.</p>\n<p><em>lulalala</em></p>\n</li>\n<li>\n<p>Add <code>Rails.application.config.active_record.postgresql_adapter_decode_dates</code> to opt out of decoding dates automatically with the postgresql adapter. Defaults to true.</p>\n<p><em>Joé Dupuis</em></p>\n</li>\n<li>\n<p>Association option <code>query_constraints</code> is deprecated in favor of <code>foreign_key</code>.</p>\n<p><em>Nikita Vasilevsky</em></p>\n</li>\n<li>\n<p>Add <code>ENV[\"SKIP_TEST_DATABASE_TRUNCATE\"]</code> flag to speed up multi-process test runs on large DBs when all tests run within default transaction.</p>\n<p>This cuts ~10s from the test run of HEY when run by 24 processes against the 178 tables, since ~4,000 table truncates can then be skipped.</p>\n<p><em>DHH</em></p>\n</li>\n<li>\n<p>Added support for recursive common table expressions.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Post.with_recursive(\n  post_and_replies: [\n    Post.where(id: 42),\n    Post.joins('JOIN post_and_replies ON posts.in_reply_to_id = post_and_replies.id'),\n  ]\n)\"><pre><span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with_recursive</span><span class=\"pl-kos\">(</span>\n  <span class=\"pl-pds\">post_and_replies</span>: <span class=\"pl-kos\">[</span>\n    <span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">where</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">id</span>: <span class=\"pl-c1\">42</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">joins</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'JOIN post_and_replies ON posts.in_reply_to_id = post_and_replies.id'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-kos\">]</span>\n<span class=\"pl-kos\">)</span></pre></div>\n<p>Generates the following SQL:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"WITH RECURSIVE &quot;post_and_replies&quot; AS (\n  (SELECT &quot;posts&quot;.* FROM &quot;posts&quot; WHERE &quot;posts&quot;.&quot;id&quot; = 42)\n  UNION ALL\n  (SELECT &quot;posts&quot;.* FROM &quot;posts&quot; JOIN post_and_replies ON posts.in_reply_to_id = post_and_replies.id)\n)\nSELECT &quot;posts&quot;.* FROM &quot;posts&quot;\"><pre>WITH RECURSIVE <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>post_and_replies<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">AS</span> (\n  (<span class=\"pl-k\">SELECT</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">WHERE</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">42</span>)\n  <span class=\"pl-k\">UNION ALL</span>\n  (<span class=\"pl-k\">SELECT</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">JOIN</span> post_and_replies <span class=\"pl-k\">ON</span> <span class=\"pl-c1\">posts</span>.<span class=\"pl-c1\">in_reply_to_id</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">post_and_replies</span>.<span class=\"pl-c1\">id</span>)\n)\n<span class=\"pl-k\">SELECT</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span></pre></div>\n<p><em>ClearlyClaire</em></p>\n</li>\n<li>\n<p><code>validate_constraint</code> can be called in a <code>change_table</code> block.</p>\n<p>ex:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"change_table :products do |t|\n  t.check_constraint &quot;price &gt; discounted_price&quot;, name: &quot;price_check&quot;, validate: false\n  t.validate_check_constraint &quot;price_check&quot;\nend\"><pre><span class=\"pl-en\">change_table</span> <span class=\"pl-pds\">:products</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">check_constraint</span> <span class=\"pl-s\">\"price &gt; discounted_price\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">name</span>: <span class=\"pl-s\">\"price_check\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">validate</span>: <span class=\"pl-c1\">false</span>\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">validate_check_constraint</span> <span class=\"pl-s\">\"price_check\"</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Cody Cutrer</em></p>\n</li>\n<li>\n<p><code>PostgreSQLAdapter</code> now decodes columns of type date to <code>Date</code> instead of string.</p>\n<p>Ex:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ActiveRecord::Base.connection\n     .select_value(&quot;select '2024-01-01'::date&quot;).class #=&gt; Date\"><pre><span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n     <span class=\"pl-kos\">.</span><span class=\"pl-en\">select_value</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"select '2024-01-01'::date\"</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">class</span> <span class=\"pl-c\">#=&gt; Date</span></pre></div>\n<p><em>Joé Dupuis</em></p>\n</li>\n<li>\n<p>Strict loading using <code>:n_plus_one_only</code> does not eagerly load child associations.</p>\n<p>With this change, child associations are no longer eagerly loaded, to<br>\nmatch intended behavior and to prevent non-deterministic order issues caused<br>\nby calling methods like <code>first</code> or <code>last</code>. As <code>first</code> and <code>last</code> don't cause<br>\nan N+1 by themselves, calling child associations will no longer raise.<br>\nFixes <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1924388730\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49473\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49473/hovercard\" href=\"https://github.com/rails/rails/issues/49473\">#49473</a>.</p>\n<p>Before:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"person = Person.find(1)\nperson.strict_loading!(mode: :n_plus_one_only)\nperson.posts.first\n# SELECT * FROM posts WHERE person_id = 1; -- non-deterministic order\nperson.posts.first.firm # raises ActiveRecord::StrictLoadingViolationError\"><pre><span class=\"pl-s1\">person</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">find</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">strict_loading!</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">mode</span>: <span class=\"pl-pds\">:n_plus_one_only</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">posts</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span>\n<span class=\"pl-c\"># SELECT * FROM posts WHERE person_id = 1; -- non-deterministic order</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">posts</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">firm</span> <span class=\"pl-c\"># raises ActiveRecord::StrictLoadingViolationError</span></pre></div>\n<p>After:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"person = Person.find(1)\nperson.strict_loading!(mode: :n_plus_one_only)\nperson.posts.first # this is 1+1, not N+1\n# SELECT * FROM posts WHERE person_id = 1 ORDER BY id LIMIT 1;\nperson.posts.first.firm # no longer raises\"><pre><span class=\"pl-s1\">person</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">find</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">strict_loading!</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">mode</span>: <span class=\"pl-pds\">:n_plus_one_only</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">posts</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span> <span class=\"pl-c\"># this is 1+1, not N+1</span>\n<span class=\"pl-c\"># SELECT * FROM posts WHERE person_id = 1 ORDER BY id LIMIT 1;</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">posts</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">firm</span> <span class=\"pl-c\"># no longer raises</span></pre></div>\n<p><em>Reid Lynch</em></p>\n</li>\n<li>\n<p>Allow <code>Sqlite3Adapter</code> to use <code>sqlite3</code> gem version <code>2.x</code>.</p>\n<p><em>Mike Dalessio</em></p>\n</li>\n<li>\n<p>Allow <code>ActiveRecord::Base#pluck</code> to accept hash values.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"# Before\nPost.joins(:comments).pluck(&quot;posts.id&quot;, &quot;comments.id&quot;, &quot;comments.body&quot;)\n\n# After\nPost.joins(:comments).pluck(posts: [:id], comments: [:id, :body])\"><pre><span class=\"pl-c\"># Before</span>\n<span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">joins</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:comments</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">pluck</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"posts.id\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"comments.id\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"comments.body\"</span><span class=\"pl-kos\">)</span>\n\n<span class=\"pl-c\"># After</span>\n<span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">joins</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:comments</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">pluck</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">posts</span>: <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">comments</span>: <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:body</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span></pre></div>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Raise an <code>ActiveRecord::ActiveRecordError</code> error when the MySQL database returns an invalid version string.</p>\n<p><em>Kevin McPhillips</em></p>\n</li>\n<li>\n<p><code>ActiveRecord::Base.transaction</code> now yields an <code>ActiveRecord::Transaction</code> object.</p>\n<p>This allows to register callbacks on it.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Article.transaction do |transaction|\n  article.update(published: true)\n  transaction.after_commit do\n    PublishNotificationMailer.with(article: article).deliver_later\n  end\nend\"><pre><span class=\"pl-v\">Article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">transaction</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">transaction</span>|\n  <span class=\"pl-en\">article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">update</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">published</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-s1\">transaction</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">after_commit</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-v\">PublishNotificationMailer</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">article</span>: <span class=\"pl-en\">article</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">deliver_later</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add <code>ActiveRecord::Base.current_transaction</code>.</p>\n<p>Returns the current transaction, to allow registering callbacks on it.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Article.current_transaction.after_commit do\n  PublishNotificationMailer.with(article: article).deliver_later\nend\"><pre><span class=\"pl-v\">Article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">current_transaction</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">after_commit</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-v\">PublishNotificationMailer</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">article</span>: <span class=\"pl-en\">article</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">deliver_later</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add <code>ActiveRecord.after_all_transactions_commit</code> callback.</p>\n<p>Useful for code that may run either inside or outside a transaction and needs<br>\nto perform work after the state changes have been properly persisted.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"def publish_article(article)\n  article.update(published: true)\n  ActiveRecord.after_all_transactions_commit do\n    PublishNotificationMailer.with(article: article).deliver_later\n  end\nend\"><pre><span class=\"pl-k\">def</span> <span class=\"pl-en\">publish_article</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">article</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-s1\">article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">update</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">published</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-v\">ActiveRecord</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">after_all_transactions_commit</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-v\">PublishNotificationMailer</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">article</span>: <span class=\"pl-s1\">article</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">deliver_later</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p>In the above example, the block is either executed immediately if called outside<br>\nof a transaction, or called after the open transaction is committed.</p>\n<p>If the transaction is rolled back, the block isn't called.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add the ability to ignore counter cache columns until they are backfilled.</p>\n<p>Starting to use counter caches on existing large tables can be troublesome, because the column<br>\nvalues must be backfilled separately of the column addition (to not lock the table for too long)<br>\nand before the use of <code>:counter_cache</code> (otherwise methods like <code>size</code>/<code>any?</code>/etc, which use<br>\ncounter caches internally, can produce incorrect results). People usually use database triggers<br>\nor callbacks on child associations while backfilling before introducing a counter cache<br>\nconfiguration to the association.</p>\n<p>Now, to safely backfill the column, while keeping the column updated with child records added/removed, use:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Comment &lt; ApplicationRecord\n  belongs_to :post, counter_cache: { active: false }\nend\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Comment</span> &lt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-en\">belongs_to</span> <span class=\"pl-pds\">:post</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">counter_cache</span>: <span class=\"pl-kos\">{</span> <span class=\"pl-pds\">active</span>: <span class=\"pl-c1\">false</span> <span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p>While the counter cache is not \"active\", the methods like <code>size</code>/<code>any?</code>/etc will not use it,<br>\nbut get the results directly from the database. After the counter cache column is backfilled, simply<br>\nremove the <code>{ active: false }</code> part from the counter cache definition, and it will now be used by the<br>\nmentioned methods.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Retry known idempotent SELECT queries on connection-related exceptions.</p>\n<p>SELECT queries we construct by walking the Arel tree and / or with known model attributes<br>\nare idempotent and can safely be retried in the case of a connection error. Previously,<br>\nadapters such as <code>TrilogyAdapter</code> would raise <code>ActiveRecord::ConnectionFailed: Trilogy::EOFError</code><br>\nwhen encountering a connection error mid-request.</p>\n<p><em>Adrianna Chang</em></p>\n</li>\n<li>\n<p>Allow association's <code>foreign_key</code> to be composite.</p>\n<p><code>query_constraints</code> option was the only way to configure a composite foreign key by passing an <code>Array</code>.<br>\nNow it's possible to pass an Array value as <code>foreign_key</code> to achieve the same behavior of an association.</p>\n<p><em>Nikita Vasilevsky</em></p>\n</li>\n<li>\n<p>Allow association's <code>primary_key</code> to be composite.</p>\n<p>Association's <code>primary_key</code> can be composite when derived from associated model <code>primary_key</code> or <code>query_constraints</code>.<br>\nNow it's possible to explicitly set it as composite on the association.</p>\n<p><em>Nikita Vasilevsky</em></p>\n</li>\n<li>\n<p>Add <code>config.active_record.permanent_connection_checkout</code> setting.</p>\n<p>Controls whether <code>ActiveRecord::Base.connection</code> raises an error, emits a deprecation warning, or neither.</p>\n<p><code>ActiveRecord::Base.connection</code> checkouts a database connection from the pool and keeps it leased until the end of<br>\nthe request or job. This behavior can be undesirable in environments that use many more threads or fibers than there<br>\nis available connections.</p>\n<p>This configuration can be used to track down and eliminate code that calls <code>ActiveRecord::Base.connection</code> and<br>\nmigrate it to use <code>ActiveRecord::Base.with_connection</code> instead.</p>\n<p>The default behavior remains unchanged, and there is currently no plans to change the default.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add dirties option to uncached.</p>\n<p>This adds a <code>dirties</code> option to <code>ActiveRecord::Base.uncached</code> and<br>\n<code>ActiveRecord::ConnectionAdapters::ConnectionPool#uncached</code>.</p>\n<p>When set to <code>true</code> (the default), writes will clear all query caches belonging to the current thread.<br>\nWhen set to <code>false</code>, writes to the affected connection pool will not clear any query cache.</p>\n<p>This is needed by Solid Cache so that cache writes do not clear query caches.</p>\n<p><em>Donal McBreen</em></p>\n</li>\n<li>\n<p>Deprecate <code>ActiveRecord::Base.connection</code> in favor of <code>.lease_connection</code>.</p>\n<p>The method has been renamed as <code>lease_connection</code> to better reflect that the returned<br>\nconnection will be held for the duration of the request or job.</p>\n<p>This deprecation is a soft deprecation, no warnings will be issued and there is no<br>\ncurrent plan to remove the method.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Deprecate <code>ActiveRecord::ConnectionAdapters::ConnectionPool#connection</code>.</p>\n<p>The method has been renamed as <code>lease_connection</code> to better reflect that the returned<br>\nconnection will be held for the duration of the request or job.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Expose a generic fixture accessor for fixture names that may conflict with Minitest.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"assert_equal &quot;Ruby on Rails&quot;, web_sites(:rubyonrails).name\nassert_equal &quot;Ruby on Rails&quot;, fixture(:web_sites, :rubyonrails).name\"><pre><span class=\"pl-en\">assert_equal</span> <span class=\"pl-s\">\"Ruby on Rails\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-en\">web_sites</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:rubyonrails</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">name</span>\n<span class=\"pl-en\">assert_equal</span> <span class=\"pl-s\">\"Ruby on Rails\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-en\">fixture</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:web_sites</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:rubyonrails</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">name</span></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Using <code>Model.query_constraints</code> with a single non-primary-key column used to raise as expected, but with an<br>\nincorrect error message.</p>\n<p>This has been fixed to raise with a more appropriate error message.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>Fix <code>has_one</code> association autosave setting the foreign key attribute when it is unchanged.</p>\n<p>This behavior is also inconsistent with autosaving <code>belongs_to</code> and can have unintended side effects like raising<br>\nan <code>ActiveRecord::ReadonlyAttributeError</code> when the foreign key attribute is marked as read-only.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>Remove deprecated behavior that would rollback a transaction block when exited using <code>return</code>, <code>break</code> or <code>throw</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Deprecate <code>Rails.application.config.active_record.commit_transaction_on_non_local_return</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to pass <code>rewhere</code> to <code>ActiveRecord::Relation#merge</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to pass <code>deferrable: true</code> to <code>add_foreign_key</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to quote <code>ActiveSupport::Duration</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>#quote_bound_value</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::ConnectionAdapters::ConnectionPool#connection_klass</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to apply <code>#connection_pool_list</code>, <code>#active_connections?</code>, <code>#clear_active_connections!</code>,<br>\n<code>#clear_reloadable_connections!</code>, <code>#clear_all_connections!</code> and <code>#flush_idle_connections!</code> to the connections pools<br>\nfor the current role when the <code>role</code> argument isn't provided.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>#all_connection_pools</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::ConnectionAdapters::SchemaCache#data_sources</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::ConnectionAdapters::SchemaCache.load_from</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>#all_foreign_keys_valid?</code> from database adapters.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to passing coder and class as second argument to <code>serialize</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to <code>ActiveRecord::Base#read_attribute(:id)</code> to return the custom primary key value.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>TestFixtures.fixture_path</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated behavior to support referring to a singular association by its plural name.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Deprecate <code>Rails.application.config.active_record.allow_deprecated_singular_associations_name</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to passing <code>SchemaMigration</code> and <code>InternalMetadata</code> classes as arguments to<br>\n<code>ActiveRecord::MigrationContext</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Migration.check_pending!</code> method.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::LogSubscriber.runtime</code> method.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::LogSubscriber.runtime=</code> method.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::LogSubscriber.reset_runtime</code> method.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to define <code>explain</code> in the connection adapter with 2 arguments.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::ActiveJobRequiredError</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Base.clear_active_connections!</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Base.clear_reloadable_connections!</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Base.clear_all_connections!</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Base.flush_idle_connections!</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>name</code> argument from <code>ActiveRecord::Base.remove_connection</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to call <code>alias_attribute</code> with non-existent attribute names.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>Rails.application.config.active_record.suppress_multiple_database_warning</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Add <code>ActiveRecord::Encryption::MessagePackMessageSerializer</code>.</p>\n<p>Serialize data to the MessagePack format, for efficient storage in binary columns.</p>\n<p>The binary encoding requires around 30% less space than the base64 encoding<br>\nused by the default serializer.</p>\n<p><em>Donal McBreen</em></p>\n</li>\n<li>\n<p>Add support for encrypting binary columns.</p>\n<p>Ensure encryption and decryption pass <code>Type::Binary::Data</code> around for binary data.</p>\n<p>Previously encrypting binary columns with the <code>ActiveRecord::Encryption::MessageSerializer</code><br>\nincidentally worked for MySQL and SQLite, but not PostgreSQL.</p>\n<p><em>Donal McBreen</em></p>\n</li>\n<li>\n<p>Deprecated <code>ENV[\"SCHEMA_CACHE\"]</code> in favor of <code>schema_cache_path</code> in the database configuration.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Add <code>ActiveRecord::Base.with_connection</code> as a shortcut for leasing a connection for a short duration.</p>\n<p>The leased connection is yielded, and for the duration of the block, any call to <code>ActiveRecord::Base.connection</code><br>\nwill yield that same connection.</p>\n<p>This is useful to perform a few database operations without causing a connection to be leased for the<br>\nentire duration of the request or job.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Deprecate <code>config.active_record.warn_on_records_fetched_greater_than</code> now that <code>sql.active_record</code><br>\nnotification includes <code>:row_count</code> field.</p>\n<p><em>Jason Nochlin</em></p>\n</li>\n<li>\n<p>The fix ensures that the association is joined using the appropriate join type<br>\n(either inner join or left outer join) based on the existing joins in the scope.</p>\n<p>This prevents unintentional overrides of existing join types and ensures consistency in the generated SQL queries.</p>\n<p>Example:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"# `associated` will use `LEFT JOIN` instead of using `JOIN`\nPost.left_joins(:author).where.associated(:author)\"><pre><span class=\"pl-c\"># `associated` will use `LEFT JOIN` instead of using `JOIN`</span>\n<span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">left_joins</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:author</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">where</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">associated</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:author</span><span class=\"pl-kos\">)</span></pre></div>\n<p><em>Saleh Alhaddad</em></p>\n</li>\n<li>\n<p>Fix an issue where <code>ActiveRecord::Encryption</code> configurations are not ready before the loading<br>\nof Active Record models, when an application is eager loaded. As a result, encrypted attributes<br>\ncould be misconfigured in some cases.</p>\n<p><em>Maxime Réty</em></p>\n</li>\n<li>\n<p>Deprecate defining an <code>enum</code> with keyword arguments.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Function &gt; ApplicationRecord\n  # BAD\n  enum color: [:red, :blue],\n       type: [:instance, :class]\n\n  # GOOD\n  enum :color, [:red, :blue]\n  enum :type, [:instance, :class]\nend\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Function</span> &gt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-c\"># BAD</span>\n  <span class=\"pl-en\">enum</span> <span class=\"pl-pds\">color</span>: <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:red</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:blue</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span>\n       <span class=\"pl-pds\">type</span>: <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:instance</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:class</span><span class=\"pl-kos\">]</span>\n\n  <span class=\"pl-c\"># GOOD</span>\n  <span class=\"pl-en\">enum</span> <span class=\"pl-pds\">:color</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:red</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:blue</span><span class=\"pl-kos\">]</span>\n  <span class=\"pl-en\">enum</span> <span class=\"pl-pds\">:type</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:instance</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:class</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Hartley McGuire</em></p>\n</li>\n<li>\n<p>Add <code>config.active_record.validate_migration_timestamps</code> option for validating migration timestamps.</p>\n<p>When set, validates that the timestamp prefix for a migration is no more than a day ahead of<br>\nthe timestamp associated with the current time. This is designed to prevent migrations prefixes<br>\nfrom being hand-edited to future timestamps, which impacts migration generation and other<br>\nmigration commands.</p>\n<p><em>Adrianna Chang</em></p>\n</li>\n<li>\n<p>Properly synchronize <code>Mysql2Adapter#active?</code> and <code>TrilogyAdapter#active?</code>.</p>\n<p>As well as <code>disconnect!</code> and <code>verify!</code>.</p>\n<p>This generally isn't a big problem as connections must not be shared between<br>\nthreads, but is required when running transactional tests or system tests<br>\nand could lead to a SEGV.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Support <code>:source_location</code> tag option for query log tags.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"config.active_record.query_log_tags &lt;&lt; :source_location\"><pre><span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">active_record</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">query_log_tags</span> &lt;&lt; <span class=\"pl-pds\">:source_location</span></pre></div>\n<p>Calculating the caller location is a costly operation and should be used primarily in development<br>\n(note, there is also a <code>config.active_record.verbose_query_logs</code> that serves the same purpose)<br>\nor occasionally on production for debugging purposes.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Add an option to <code>ActiveRecord::Encryption::Encryptor</code> to disable compression.</p>\n<p>Allow compression to be disabled by setting <code>compress: false</code></p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"  class User\n    encrypts :name, encryptor: ActiveRecord::Encryption::Encryptor.new(compress: false)\n  end\"><pre>  <span class=\"pl-k\">class</span> <span class=\"pl-v\">User</span>\n    <span class=\"pl-en\">encrypts</span> <span class=\"pl-pds\">:name</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">encryptor</span>: <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Encryption</span>::<span class=\"pl-v\">Encryptor</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">compress</span>: <span class=\"pl-c1\">false</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span></pre></div>\n<p><em>Donal McBreen</em></p>\n</li>\n<li>\n<p>Deprecate passing strings to <code>ActiveRecord::Tasks::DatabaseTasks.cache_dump_filename</code>.</p>\n<p>A <code>ActiveRecord::DatabaseConfigurations::DatabaseConfig</code> object should be passed instead.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Add <code>row_count</code> field to <code>sql.active_record</code> notification.</p>\n<p>This field returns the amount of rows returned by the query that emitted the notification.</p>\n<p>This metric is useful in cases where one wants to detect queries with big result sets.</p>\n<p><em>Marvin Bitterlich</em></p>\n</li>\n<li>\n<p>Consistently raise an <code>ArgumentError</code> when passing an invalid argument to a nested attributes association writer.</p>\n<p>Previously, this would only raise on collection associations and produce a generic error on singular associations.</p>\n<p>Now, it will raise on both collection and singular associations.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>Fix single quote escapes on default generated MySQL columns.</p>\n<p>MySQL 5.7.5+ supports generated columns, which can be used to create a column that is computed from an expression.</p>\n<p>Previously, the schema dump would output a string with double escapes for generated columns with single quotes in the default expression.</p>\n<p>This would result in issues when importing the schema on a fresh instance of a MySQL database.</p>\n<p>Now, the string will not be escaped and will be valid Ruby upon importing of the schema.</p>\n<p><em>Yash Kapadia</em></p>\n</li>\n<li>\n<p>Fix Migrations with versions older than 7.1 validating options given to<br>\n<code>add_reference</code> and <code>t.references</code>.</p>\n<p><em>Hartley McGuire</em></p>\n</li>\n<li>\n<p>Add <code>&lt;role&gt;_types</code> class method to <code>ActiveRecord::DelegatedType</code> so that the delegated types can be introspected.</p>\n<p><em>JP Rosevear</em></p>\n</li>\n<li>\n<p>Make <code>schema_dump</code>, <code>query_cache</code>, <code>replica</code> and <code>database_tasks</code> configurable via <code>DATABASE_URL</code>.</p>\n<p>This wouldn't always work previously because boolean values would be interpreted as strings.</p>\n<p>e.g. <code>DATABASE_URL=postgres://localhost/foo?schema_dump=false</code> now properly disable dumping the schema<br>\ncache.</p>\n<p><em>Mike Coutermarsh</em>, <em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Introduce <code>ActiveRecord::Transactions::ClassMethods#set_callback</code>.</p>\n<p>It is identical to <code>ActiveSupport::Callbacks::ClassMethods#set_callback</code><br>\nbut with support for <code>after_commit</code> and <code>after_rollback</code> callback options.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>Make <code>ActiveRecord::Encryption::Encryptor</code> agnostic of the serialization format used for encrypted data.</p>\n<p>Previously, the encryptor instance only allowed an encrypted value serialized as a <code>String</code> to be passed to the message serializer.</p>\n<p>Now, the encryptor lets the configured <code>message_serializer</code> decide which types of serialized encrypted values are supported. A custom serialiser is therefore allowed to serialize <code>ActiveRecord::Encryption::Message</code> objects using a type other than <code>String</code>.</p>\n<p>The default <code>ActiveRecord::Encryption::MessageSerializer</code> already ensures that only <code>String</code> objects are passed for deserialization.</p>\n<p><em>Maxime Réty</em></p>\n</li>\n<li>\n<p>Fix <code>encrypted_attribute?</code> to take into account context properties passed to <code>encrypts</code>.</p>\n<p><em>Maxime Réty</em></p>\n</li>\n<li>\n<p>The object returned by <code>explain</code> now responds to <code>pluck</code>, <code>first</code>,<br>\n<code>last</code>, <code>average</code>, <code>count</code>, <code>maximum</code>, <code>minimum</code>, and <code>sum</code>. Those<br>\nnew methods run <code>EXPLAIN</code> on the corresponding queries:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"User.all.explain.count\n# EXPLAIN SELECT COUNT(*) FROM `users`\n# ...\n\nUser.all.explain.maximum(:id)\n# EXPLAIN SELECT MAX(`users`.`id`) FROM `users`\n# ...\"><pre><span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">all</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">explain</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">count</span>\n<span class=\"pl-c\"># EXPLAIN SELECT COUNT(*) FROM `users`</span>\n<span class=\"pl-c\"># ...</span>\n\n<span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">all</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">explain</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">maximum</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:id</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c\"># EXPLAIN SELECT MAX(`users`.`id`) FROM `users`</span>\n<span class=\"pl-c\"># ...</span></pre></div>\n<p><em>Petrik de Heus</em></p>\n</li>\n<li>\n<p>Fixes an issue where <code>validates_associated</code> <code>:on</code>  option wasn't respected<br>\nwhen validating associated records.</p>\n<p><em>Austen Madden</em>, <em>Alex Ghiculescu</em>, <em>Rafał Brize</em></p>\n</li>\n<li>\n<p>Allow overriding SQLite defaults from <code>database.yml</code>.</p>\n<p>Any PRAGMA configuration set under the <code>pragmas</code> key in the configuration<br>\nfile takes precedence over Rails' defaults, and additional PRAGMAs can be<br>\nset as well.</p>\n<div class=\"highlight highlight-source-yaml notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"database: storage/development.sqlite3\ntimeout: 5000\npragmas:\n  journal_mode: off\n  temp_store: memory\"><pre><span class=\"pl-ent\">database</span>: <span class=\"pl-s\">storage/development.sqlite3</span>\n<span class=\"pl-ent\">timeout</span>: <span class=\"pl-c1\">5000</span>\n<span class=\"pl-ent\">pragmas</span>:\n  <span class=\"pl-ent\">journal_mode</span>: <span class=\"pl-s\">off</span>\n  <span class=\"pl-ent\">temp_store</span>: <span class=\"pl-s\">memory</span></pre></div>\n<p><em>Stephen Margheim</em></p>\n</li>\n<li>\n<p>Remove warning message when running SQLite in production, but leave it unconfigured.</p>\n<p>There are valid use cases for running SQLite in production. However, it must be done<br>\nwith care, so instead of a warning most users won't see anyway, it's preferable to<br>\nleave the configuration commented out to force them to think about having the database<br>\non a persistent volume etc.</p>\n<p><em>Jacopo Beschi</em>, <em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add support for generated columns to the SQLite3 adapter.</p>\n<p>Generated columns (both stored and dynamic) are supported since version 3.31.0 of SQLite.<br>\nThis adds support for those to the SQLite3 adapter.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"create_table :users do |t|\n  t.string :name\n  t.virtual :name_upper, type: :string, as: 'UPPER(name)'\n  t.virtual :name_lower, type: :string, as: 'LOWER(name)', stored: true\nend\"><pre><span class=\"pl-en\">create_table</span> <span class=\"pl-pds\">:users</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">string</span> <span class=\"pl-pds\">:name</span>\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">virtual</span> <span class=\"pl-pds\">:name_upper</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">type</span>: <span class=\"pl-pds\">:string</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">as</span>: <span class=\"pl-s\">'UPPER(name)'</span>\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">virtual</span> <span class=\"pl-pds\">:name_lower</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">type</span>: <span class=\"pl-pds\">:string</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">as</span>: <span class=\"pl-s\">'LOWER(name)'</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">stored</span>: <span class=\"pl-c1\">true</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Stephen Margheim</em></p>\n</li>\n<li>\n<p>TrilogyAdapter: ignore <code>host</code> if <code>socket</code> parameter is set.</p>\n<p>This allows to configure a connection on a UNIX socket via <code>DATABASE_URL</code>:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"DATABASE_URL=trilogy://does-not-matter/my_db_production?socket=/var/run/mysql.sock\"><pre class=\"notranslate\"><code>DATABASE_URL=trilogy://does-not-matter/my_db_production?socket=/var/run/mysql.sock\n</code></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Make <code>assert_queries_count</code>, <code>assert_no_queries</code>, <code>assert_queries_match</code>, and<br>\n<code>assert_no_queries_match</code> assertions public.</p>\n<p>To assert the expected number of queries are made, Rails internally uses <code>assert_queries_count</code> and<br>\n<code>assert_no_queries</code>. To assert that specific SQL queries are made, <code>assert_queries_match</code> and<br>\n<code>assert_no_queries_match</code> are used. These assertions can now be used in applications as well.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class ArticleTest &lt; ActiveSupport::TestCase\n  test &quot;queries are made&quot; do\n    assert_queries_count(1) { Article.first }\n  end\n\n  test &quot;creates a foreign key&quot; do\n    assert_queries_match(/ADD FOREIGN KEY/i, include_schema: true) do\n      @ connection.add_foreign_key(:comments, :posts)\n    end\n  end\nend\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">ArticleTest</span> &lt; <span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">TestCase</span>\n  <span class=\"pl-en\">test</span> <span class=\"pl-s\">\"queries are made\"</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-en\">assert_queries_count</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span> <span class=\"pl-v\">Article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span> <span class=\"pl-kos\">}</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-en\">test</span> <span class=\"pl-s\">\"creates a foreign key\"</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-en\">assert_queries_match</span><span class=\"pl-kos\">(</span><span class=\"pl-sr\">/ADD FOREIGN KEY/i</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">include_schema</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n      <span class=\"pl-c1\">@ connection</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">add_foreign_key</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:comments</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:posts</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-k\">end</span...","reactions":{"url":"https://api.github.com/repos/INexizI/KR-DB/issues/392/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/INexizI/KR-DB/issues/392/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"INexizI","id":39536903,"node_id":"MDQ6VXNlcjM5NTM2OTAz","avatar_url":"https://avatars.githubusercontent.com/u/39536903?v=4","gravatar_id":"","url":"https://api.github.com/users/INexizI","html_url":"https://github.com/INexizI","followers_url":"https://api.github.com/users/INexizI/followers","following_url":"https://api.github.com/users/INexizI/following{/other_user}","gists_url":"https://api.github.com/users/INexizI/gists{/gist_id}","starred_url":"https://api.github.com/users/INexizI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/INexizI/subscriptions","organizations_url":"https://api.github.com/users/INexizI/orgs","repos_url":"https://api.github.com/users/INexizI/repos","events_url":"https://api.github.com/users/INexizI/events{/privacy}","received_events_url":"https://api.github.com/users/INexizI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-31T10:00:51Z","updated_at":"2024-08-31T10:00:51Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/INexizI/KR-DB/issues/393","repository_url":"https://api.github.com/repos/INexizI/KR-DB","labels_url":"https://api.github.com/repos/INexizI/KR-DB/issues/393/labels{/name}","comments_url":"https://api.github.com/repos/INexizI/KR-DB/issues/393/comments","events_url":"https://api.github.com/repos/INexizI/KR-DB/issues/393/events","html_url":"https://github.com/INexizI/KR-DB/pull/393","id":2498762158,"node_id":"PR_kwDOFXHYDM56DH_Y","number":393,"title":"[Snyk] Upgrade @rails/activestorage from 7.1.3 to 7.2.0","user":{"login":"INexizI","id":39536903,"node_id":"MDQ6VXNlcjM5NTM2OTAz","avatar_url":"https://avatars.githubusercontent.com/u/39536903?v=4","gravatar_id":"","url":"https://api.github.com/users/INexizI","html_url":"https://github.com/INexizI","followers_url":"https://api.github.com/users/INexizI/followers","following_url":"https://api.github.com/users/INexizI/following{/other_user}","gists_url":"https://api.github.com/users/INexizI/gists{/gist_id}","starred_url":"https://api.github.com/users/INexizI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/INexizI/subscriptions","organizations_url":"https://api.github.com/users/INexizI/orgs","repos_url":"https://api.github.com/users/INexizI/repos","events_url":"https://api.github.com/users/INexizI/events{/privacy}","received_events_url":"https://api.github.com/users/INexizI/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"INexizI","id":39536903,"node_id":"MDQ6VXNlcjM5NTM2OTAz","avatar_url":"https://avatars.githubusercontent.com/u/39536903?v=4","gravatar_id":"","url":"https://api.github.com/users/INexizI","html_url":"https://github.com/INexizI","followers_url":"https://api.github.com/users/INexizI/followers","following_url":"https://api.github.com/users/INexizI/following{/other_user}","gists_url":"https://api.github.com/users/INexizI/gists{/gist_id}","starred_url":"https://api.github.com/users/INexizI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/INexizI/subscriptions","organizations_url":"https://api.github.com/users/INexizI/orgs","repos_url":"https://api.github.com/users/INexizI/repos","events_url":"https://api.github.com/users/INexizI/events{/privacy}","received_events_url":"https://api.github.com/users/INexizI/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"INexizI","id":39536903,"node_id":"MDQ6VXNlcjM5NTM2OTAz","avatar_url":"https://avatars.githubusercontent.com/u/39536903?v=4","gravatar_id":"","url":"https://api.github.com/users/INexizI","html_url":"https://github.com/INexizI","followers_url":"https://api.github.com/users/INexizI/followers","following_url":"https://api.github.com/users/INexizI/following{/other_user}","gists_url":"https://api.github.com/users/INexizI/gists{/gist_id}","starred_url":"https://api.github.com/users/INexizI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/INexizI/subscriptions","organizations_url":"https://api.github.com/users/INexizI/orgs","repos_url":"https://api.github.com/users/INexizI/repos","events_url":"https://api.github.com/users/INexizI/events{/privacy}","received_events_url":"https://api.github.com/users/INexizI/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":0,"created_at":"2024-08-31T10:00:50Z","updated_at":"2024-09-02T21:30:30Z","closed_at":"2024-09-02T21:30:28Z","author_association":"OWNER","active_lock_reason":null,"draft":false,"repository":{"id":359782412,"node_id":"MDEwOlJlcG9zaXRvcnkzNTk3ODI0MTI=","name":"KR-DB","full_name":"INexizI/KR-DB","private":false,"owner":{"login":"INexizI","id":39536903,"node_id":"MDQ6VXNlcjM5NTM2OTAz","avatar_url":"https://avatars.githubusercontent.com/u/39536903?v=4","gravatar_id":"","url":"https://api.github.com/users/INexizI","html_url":"https://github.com/INexizI","followers_url":"https://api.github.com/users/INexizI/followers","following_url":"https://api.github.com/users/INexizI/following{/other_user}","gists_url":"https://api.github.com/users/INexizI/gists{/gist_id}","starred_url":"https://api.github.com/users/INexizI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/INexizI/subscriptions","organizations_url":"https://api.github.com/users/INexizI/orgs","repos_url":"https://api.github.com/users/INexizI/repos","events_url":"https://api.github.com/users/INexizI/events{/privacy}","received_events_url":"https://api.github.com/users/INexizI/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/INexizI/KR-DB","description":"Extended version KR-Calc + Heroes DB","fork":false,"url":"https://api.github.com/repos/INexizI/KR-DB","forks_url":"https://api.github.com/repos/INexizI/KR-DB/forks","keys_url":"https://api.github.com/repos/INexizI/KR-DB/keys{/key_id}","collaborators_url":"https://api.github.com/repos/INexizI/KR-DB/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/INexizI/KR-DB/teams","hooks_url":"https://api.github.com/repos/INexizI/KR-DB/hooks","issue_events_url":"https://api.github.com/repos/INexizI/KR-DB/issues/events{/number}","events_url":"https://api.github.com/repos/INexizI/KR-DB/events","assignees_url":"https://api.github.com/repos/INexizI/KR-DB/assignees{/user}","branches_url":"https://api.github.com/repos/INexizI/KR-DB/branches{/branch}","tags_url":"https://api.github.com/repos/INexizI/KR-DB/tags","blobs_url":"https://api.github.com/repos/INexizI/KR-DB/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/INexizI/KR-DB/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/INexizI/KR-DB/git/refs{/sha}","trees_url":"https://api.github.com/repos/INexizI/KR-DB/git/trees{/sha}","statuses_url":"https://api.github.com/repos/INexizI/KR-DB/statuses/{sha}","languages_url":"https://api.github.com/repos/INexizI/KR-DB/languages","stargazers_url":"https://api.github.com/repos/INexizI/KR-DB/stargazers","contributors_url":"https://api.github.com/repos/INexizI/KR-DB/contributors","subscribers_url":"https://api.github.com/repos/INexizI/KR-DB/subscribers","subscription_url":"https://api.github.com/repos/INexizI/KR-DB/subscription","commits_url":"https://api.github.com/repos/INexizI/KR-DB/commits{/sha}","git_commits_url":"https://api.github.com/repos/INexizI/KR-DB/git/commits{/sha}","comments_url":"https://api.github.com/repos/INexizI/KR-DB/comments{/number}","issue_comment_url":"https://api.github.com/repos/INexizI/KR-DB/issues/comments{/number}","contents_url":"https://api.github.com/repos/INexizI/KR-DB/contents/{+path}","compare_url":"https://api.github.com/repos/INexizI/KR-DB/compare/{base}...{head}","merges_url":"https://api.github.com/repos/INexizI/KR-DB/merges","archive_url":"https://api.github.com/repos/INexizI/KR-DB/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/INexizI/KR-DB/downloads","issues_url":"https://api.github.com/repos/INexizI/KR-DB/issues{/number}","pulls_url":"https://api.github.com/repos/INexizI/KR-DB/pulls{/number}","milestones_url":"https://api.github.com/repos/INexizI/KR-DB/milestones{/number}","notifications_url":"https://api.github.com/repos/INexizI/KR-DB/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/INexizI/KR-DB/labels{/name}","releases_url":"https://api.github.com/repos/INexizI/KR-DB/releases{/id}","deployments_url":"https://api.github.com/repos/INexizI/KR-DB/deployments","created_at":"2021-04-20T10:56:43Z","updated_at":"2025-11-06T14:30:34Z","pushed_at":"2025-11-10T05:04:43Z","git_url":"git://github.com/INexizI/KR-DB.git","ssh_url":"git@github.com:INexizI/KR-DB.git","clone_url":"https://github.com/INexizI/KR-DB.git","svn_url":"https://github.com/INexizI/KR-DB","homepage":"","size":987672,"stargazers_count":0,"watchers_count":0,"language":"Slim","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":10,"license":null,"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":10,"watchers":0,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/INexizI/KR-DB/pulls/393","html_url":"https://github.com/INexizI/KR-DB/pull/393","diff_url":"https://github.com/INexizI/KR-DB/pull/393.diff","patch_url":"https://github.com/INexizI/KR-DB/pull/393.patch","merged_at":"2024-09-02T21:30:27Z"},"body":"![snyk-top-banner](https://github.com/andygongea/OWASP-Benchmark/assets/818805/c518c423-16fe-447e-b67f-ad5a49b5d123)\n\n\n<h3>Snyk has created this PR to upgrade @rails/activestorage from 7.1.3 to 7.2.0.</h3>\n\n:information_source: Keep your dependencies up-to-date. This makes it easier to fix existing vulnerabilities and to more quickly identify and fix newly disclosed vulnerabilities when they affect your project.\n\n<hr/>\n\n\n- The recommended version is **6 versions** ahead of your current version.\n\n- The recommended version was released on **21 days ago**.\n\n\n\n<details>\n<summary><b>Release notes</b></summary>\n<br/>\n  <details>\n    <summary>Package name: <b>@rails/activestorage</b></summary>\n    <ul>\n      <li>\n        <b>7.2.0</b> - <a href=\"https://github.com/rails/rails/releases/tag/v7.2.0\">2024-08-09</a></br><h2>Active Support</h2>\n<ul>\n<li>\n<p>Fix <code>delegate_missing_to allow_nil: true</code> when called with implict self</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Person\n  delegate_missing_to :address, allow_nil: true\n\n  def address\n    nil\n  end\n\n  def berliner?\n    city == &quot;Berlin&quot;\n  end\nend\n\nPerson.new.city # =&gt; nil\nPerson.new.berliner? # undefined local variable or method `city' for an instance of Person (NameError)\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Person</span>\n  <span class=\"pl-en\">delegate_missing_to</span> <span class=\"pl-pds\">:address</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">allow_nil</span>: <span class=\"pl-c1\">true</span>\n\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">address</span>\n    <span class=\"pl-c1\">nil</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">berliner?</span>\n    <span class=\"pl-en\">city</span> == <span class=\"pl-s\">\"Berlin\"</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">city</span> <span class=\"pl-c\"># =&gt; nil</span>\n<span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">berliner?</span> <span class=\"pl-c\"># undefined local variable or method `city' for an instance of Person (NameError)</span></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add <code>logger</code> as a dependency since it is a bundled gem candidate for Ruby 3.5</p>\n<p><em>Earlopain</em></p>\n</li>\n<li>\n<p>Define <code>Digest::UUID.nil_uuid</code>, which returns the so-called nil UUID.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Support <code>duration</code> type in <code>ActiveSupport::XmlMini</code>.</p>\n<p><em>heka1024</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveSupport::Notifications::Event#children</code> and  <code>ActiveSupport::Notifications::Event#parent_of?</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to call the following methods without passing a deprecator:</p>\n<ul>\n<li><code>deprecate</code></li>\n<li><code>deprecate_constant</code></li>\n<li><code>ActiveSupport::Deprecation::DeprecatedObjectProxy.new</code></li>\n<li><code>ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy.new</code></li>\n<li><code>ActiveSupport::Deprecation::DeprecatedConstantProxy.new</code></li>\n<li><code>assert_deprecated</code></li>\n<li><code>assert_not_deprecated</code></li>\n<li><code>collect_deprecations</code></li>\n</ul>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveSupport::Deprecation</code> delegation to instance.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>SafeBuffer#clone_empty</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>#to_default_s</code> from <code>Array</code>, <code>Date</code>, <code>DateTime</code> and <code>Time</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to passing <code>Dalli::Client</code> instances to <code>MemCacheStore</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>config.active_support.use_rfc4122_namespaced_uuids</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>config.active_support.remove_deprecated_time_with_zone_name</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>config.active_support.disable_to_s_conversion</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to bolding log text with positional boolean in <code>ActiveSupport::LogSubscriber#color</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated constants <code>ActiveSupport::LogSubscriber::CLEAR</code> and <code>ActiveSupport::LogSubscriber::BOLD</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support for <code>config.active_support.cache_format_version = 6.1</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>:pool_size</code> and <code>:pool_timeout</code> options for the cache storage.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Warn on tests without assertions.</p>\n<p><code>ActiveSupport::TestCase</code> now warns when tests do not run any assertions.<br>\nThis is helpful in detecting broken tests that do not perform intended assertions.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Support <code>hexBinary</code> type in <code>ActiveSupport::XmlMini</code>.</p>\n<p><em>heka1024</em></p>\n</li>\n<li>\n<p>Deprecate <code>ActiveSupport::ProxyObject</code> in favor of Ruby's built-in <code>BasicObject</code>.</p>\n<p><em>Earlopain</em></p>\n</li>\n<li>\n<p><code>stub_const</code> now accepts a <code>exists: false</code> parameter to allow stubbing missing constants.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Make <code>ActiveSupport::BacktraceCleaner</code> copy filters and silencers on dup and clone.</p>\n<p>Previously the copy would still share the internal silencers and filters array,<br>\ncausing state to leak.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Updating Astana with Western Kazakhstan TZInfo identifier.</p>\n<p><em>Damian Nelson</em></p>\n</li>\n<li>\n<p>Add filename support for <code>ActiveSupport::Logger.logger_outputs_to?</code>.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"logger = Logger.new('/var/log/rails.log')\nActiveSupport::Logger.logger_outputs_to?(logger, '/var/log/rails.log')\"><pre><span class=\"pl-s1\">logger</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Logger</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'/var/log/rails.log'</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">Logger</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">logger_outputs_to?</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">logger</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'/var/log/rails.log'</span><span class=\"pl-kos\">)</span></pre></div>\n<p><em>Christian Schmidt</em></p>\n</li>\n<li>\n<p>Include <code>IPAddr#prefix</code> when serializing an <code>IPAddr</code> using the<br>\n<code>ActiveSupport::MessagePack</code> serializer.</p>\n<p>This change is backward and forward compatible — old payloads can<br>\nstill be read, and new payloads will be readable by older versions of Rails.</p>\n<p><em>Taiki Komaba</em></p>\n</li>\n<li>\n<p>Add <code>default:</code> support for <code>ActiveSupport::CurrentAttributes.attribute</code>.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Current &lt; ActiveSupport::CurrentAttributes\n  attribute :counter, default: 0\nend\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Current</span> &lt; <span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">CurrentAttributes</span>\n  <span class=\"pl-en\">attribute</span> <span class=\"pl-pds\">:counter</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">default</span>: <span class=\"pl-c1\">0</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Sean Doyle</em></p>\n</li>\n<li>\n<p>Yield instance to <code>Object#with</code> block.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"client.with(timeout: 5_000) do |c|\n  c.get(&quot;/commits&quot;)\nend\"><pre><span class=\"pl-en\">client</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">timeout</span>: <span class=\"pl-c1\">5_000</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">c</span>|\n  <span class=\"pl-s1\">c</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">get</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"/commits\"</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Sean Doyle</em></p>\n</li>\n<li>\n<p>Use logical core count instead of physical core count to determine the<br>\ndefault number of workers when parallelizing tests.</p>\n<p><em>Jonathan Hefner</em></p>\n</li>\n<li>\n<p>Fix <code>Time.now/DateTime.now/Date.today</code> to return results in a system timezone after <code>#travel_to</code>.</p>\n<p>There is a bug in the current implementation of #travel_to:<br>\nit remembers a timezone of its argument, and all stubbed methods start<br>\nreturning results in that remembered timezone. However, the expected<br>\nbehavior is to return results in a system timezone.</p>\n<p><em>Aleksei Chernenkov</em></p>\n</li>\n<li>\n<p>Add <code>ErrorReported#unexpected</code> to report precondition violations.</p>\n<p>For example:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"def edit\n  if published?\n    Rails.error.unexpected(&quot;[BUG] Attempting to edit a published article, that shouldn't be possible&quot;)\n    return false\n  end\n  # ...\nend\"><pre><span class=\"pl-k\">def</span> <span class=\"pl-en\">edit</span>\n  <span class=\"pl-k\">if</span> <span class=\"pl-en\">published?</span>\n    <span class=\"pl-v\">Rails</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">error</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">unexpected</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"[BUG] Attempting to edit a published article, that shouldn't be possible\"</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">false</span>\n  <span class=\"pl-k\">end</span>\n  <span class=\"pl-c\"># ...</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p>The above will raise an error in development and test, but only report the error in production.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Make the order of read_multi and write_multi notifications for <code>Cache::Store#fetch_multi</code> operations match the order they are executed in.</p>\n<p><em>Adam Renberg Tamm</em></p>\n</li>\n<li>\n<p>Make return values of <code>Cache::Store#write</code> consistent.</p>\n<p>The return value was not specified before. Now it returns <code>true</code> on a successful write,<br>\n<code>nil</code> if there was an error talking to the cache backend, and <code>false</code> if the write failed<br>\nfor another reason (e.g. the key already exists and <code>unless_exist: true</code> was passed).</p>\n<p><em>Sander Verdonschot</em></p>\n</li>\n<li>\n<p>Fix logged cache keys not always matching actual key used by cache action.</p>\n<p><em>Hartley McGuire</em></p>\n</li>\n<li>\n<p>Improve error messages of <code>assert_changes</code> and <code>assert_no_changes</code>.</p>\n<p><code>assert_changes</code> error messages now display objects with <code>.inspect</code> to make it easier<br>\nto differentiate nil from empty strings, strings from symbols, etc.<br>\n<code>assert_no_changes</code> error messages now surface the actual value.</p>\n<p><em>pcreux</em></p>\n</li>\n<li>\n<p>Fix <code>#to_fs(:human_size)</code> to correctly work with negative numbers.</p>\n<p><em>Earlopain</em></p>\n</li>\n<li>\n<p>Fix <code>BroadcastLogger#dup</code> so that it duplicates the logger's <code>broadcasts</code>.</p>\n<p><em>Andrew Novoselac</em></p>\n</li>\n<li>\n<p>Fix issue where <code>bootstrap.rb</code> overwrites the <code>level</code> of a <code>BroadcastLogger</code>'s <code>broadcasts</code>.</p>\n<p><em>Andrew Novoselac</em></p>\n</li>\n<li>\n<p>Fix compatibility with the <code>semantic_logger</code> gem.</p>\n<p>The <code>semantic_logger</code> gem doesn't behave exactly like stdlib logger in that<br>\n<code>SemanticLogger#level</code> returns a Symbol while stdlib <code>Logger#level</code> returns an Integer.</p>\n<p>This caused the various <code>LogSubscriber</code> classes in Rails to break when assigned a<br>\n<code>SemanticLogger</code> instance.</p>\n<p><em>Jean Boussier</em>, <em>ojab</em></p>\n</li>\n<li>\n<p>Fix MemoryStore to prevent race conditions when incrementing or decrementing.</p>\n<p><em>Pierre Jambet</em></p>\n</li>\n<li>\n<p>Implement <code>HashWithIndifferentAccess#to_proc</code>.</p>\n<p>Previously, calling <code>#to_proc</code> on <code>HashWithIndifferentAccess</code> object used inherited <code>#to_proc</code><br>\nmethod from the <code>Hash</code> class, which was not able to access values using indifferent keys.</p>\n<p><em>fatkodima</em></p>\n</li>\n</ul>\n<h2>Active Model</h2>\n<ul>\n<li>\n<p>Fix a bug where type casting of string to <code>Time</code> and <code>DateTime</code> doesn't<br>\ncalculate minus minute value in TZ offset correctly.</p>\n<p><em>Akira Matsuda</em></p>\n</li>\n<li>\n<p>Port the <code>type_for_attribute</code> method to Active Model. Classes that include<br>\n<code>ActiveModel::Attributes</code> will now provide this method. This method behaves<br>\nthe same for Active Model as it does for Active Record.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class MyModel\n  include ActiveModel::Attributes\n\n  attribute :my_attribute, :integer\nend\n\nMyModel.type_for_attribute(:my_attribute) # =&gt; #&lt;ActiveModel::Type::Integer ...&gt;\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">MyModel</span>\n  <span class=\"pl-en\">include</span> <span class=\"pl-v\">ActiveModel</span>::<span class=\"pl-v\">Attributes</span>\n\n  <span class=\"pl-en\">attribute</span> <span class=\"pl-pds\">:my_attribute</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:integer</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-v\">MyModel</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">type_for_attribute</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:my_attribute</span><span class=\"pl-kos\">)</span> <span class=\"pl-c\"># =&gt; #&lt;ActiveModel::Type::Integer ...&gt;</span></pre></div>\n<p><em>Jonathan Hefner</em></p>\n</li>\n</ul>\n<h2>Active Record</h2>\n<ul>\n<li>\n<p>Handle commas in Sqlite3 default function definitions.</p>\n<p><em>Stephen Margheim</em></p>\n</li>\n<li>\n<p>Fixes <code>validates_associated</code> raising an exception when configured with a<br>\nsingular association and having <code>index_nested_attribute_errors</code> enabled.</p>\n<p><em>Martin Spickermann</em></p>\n</li>\n<li>\n<p>The constant <code>ActiveRecord::ImmutableRelation</code> has been deprecated because<br>\nwe want to reserve that name for a stronger sense of \"immutable relation\".<br>\nPlease use <code>ActiveRecord::UnmodifiableRelation</code> instead.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Add condensed <code>#inspect</code> for <code>ConnectionPool</code>, <code>AbstractAdapter</code>, and<br>\n<code>DatabaseConfig</code>.</p>\n<p><em>Hartley McGuire</em></p>\n</li>\n<li>\n<p>Fixed a memory performance issue in Active Record attribute methods definition.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Define the new Active Support notification event <code>start_transaction.active_record</code>.</p>\n<p>This event is fired when database transactions or savepoints start, and<br>\ncomplements <code>transaction.active_record</code>, which is emitted when they finish.</p>\n<p>The payload has the transaction (<code>:transaction</code>) and the connection (<code>:connection</code>).</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Fix an issue where the IDs reader method did not return expected results<br>\nfor preloaded associations in models using composite primary keys.</p>\n<p><em>Jay Ang</em></p>\n</li>\n<li>\n<p>The payload of <code>sql.active_record</code> Active Support notifications now has the current transaction in the <code>:transaction</code> key.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>The payload of <code>transaction.active_record</code> Active Support notifications now has the transaction the event is related to in the <code>:transaction</code> key.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Define <code>ActiveRecord::Transaction#uuid</code>, which returns a UUID for the database transaction. This may be helpful when tracing database activity. These UUIDs are generated only on demand.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Fix inference of association model on nested models with the same demodularized name.</p>\n<p>E.g. with the following setup:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Nested::Post &lt; ApplicationRecord\n  has_one :post, through: :other\nend\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Nested</span>::<span class=\"pl-v\">Post</span> &lt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-en\">has_one</span> <span class=\"pl-pds\">:post</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">through</span>: <span class=\"pl-pds\">:other</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p>Before, <code>#post</code> would infer the model as <code>Nested::Post</code>, but now it correctly infers <code>Post</code>.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>PostgreSQL <code>Cidr#change?</code> detects the address prefix change.</p>\n<p><em>Taketo Takashima</em></p>\n</li>\n<li>\n<p>Change <code>BatchEnumerator#destroy_all</code> to return the total number of affected rows.</p>\n<p>Previously, it always returned <code>nil</code>.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Support <code>touch_all</code> in batches.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Post.in_batches.touch_all\"><pre><span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">in_batches</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">touch_all</span></pre></div>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Add support for <code>:if_not_exists</code> and <code>:force</code> options to <code>create_schema</code>.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Fix <code>index_errors</code> having incorrect index in association validation errors.</p>\n<p><em>lulalala</em></p>\n</li>\n<li>\n<p>Add <code>index_errors: :nested_attributes_order</code> mode.</p>\n<p>This indexes the association validation errors based on the order received by nested attributes setter, and respects the <code>reject_if</code> configuration. This enables API to provide enough information to the frontend to map the validation errors back to their respective form fields.</p>\n<p><em>lulalala</em></p>\n</li>\n<li>\n<p>Add <code>Rails.application.config.active_record.postgresql_adapter_decode_dates</code> to opt out of decoding dates automatically with the postgresql adapter. Defaults to true.</p>\n<p><em>Joé Dupuis</em></p>\n</li>\n<li>\n<p>Association option <code>query_constraints</code> is deprecated in favor of <code>foreign_key</code>.</p>\n<p><em>Nikita Vasilevsky</em></p>\n</li>\n<li>\n<p>Add <code>ENV[\"SKIP_TEST_DATABASE_TRUNCATE\"]</code> flag to speed up multi-process test runs on large DBs when all tests run within default transaction.</p>\n<p>This cuts ~10s from the test run of HEY when run by 24 processes against the 178 tables, since ~4,000 table truncates can then be skipped.</p>\n<p><em>DHH</em></p>\n</li>\n<li>\n<p>Added support for recursive common table expressions.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Post.with_recursive(\n  post_and_replies: [\n    Post.where(id: 42),\n    Post.joins('JOIN post_and_replies ON posts.in_reply_to_id = post_and_replies.id'),\n  ]\n)\"><pre><span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with_recursive</span><span class=\"pl-kos\">(</span>\n  <span class=\"pl-pds\">post_and_replies</span>: <span class=\"pl-kos\">[</span>\n    <span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">where</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">id</span>: <span class=\"pl-c1\">42</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">joins</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'JOIN post_and_replies ON posts.in_reply_to_id = post_and_replies.id'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-kos\">]</span>\n<span class=\"pl-kos\">)</span></pre></div>\n<p>Generates the following SQL:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"WITH RECURSIVE &quot;post_and_replies&quot; AS (\n  (SELECT &quot;posts&quot;.* FROM &quot;posts&quot; WHERE &quot;posts&quot;.&quot;id&quot; = 42)\n  UNION ALL\n  (SELECT &quot;posts&quot;.* FROM &quot;posts&quot; JOIN post_and_replies ON posts.in_reply_to_id = post_and_replies.id)\n)\nSELECT &quot;posts&quot;.* FROM &quot;posts&quot;\"><pre>WITH RECURSIVE <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>post_and_replies<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">AS</span> (\n  (<span class=\"pl-k\">SELECT</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">WHERE</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">42</span>)\n  <span class=\"pl-k\">UNION ALL</span>\n  (<span class=\"pl-k\">SELECT</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">JOIN</span> post_and_replies <span class=\"pl-k\">ON</span> <span class=\"pl-c1\">posts</span>.<span class=\"pl-c1\">in_reply_to_id</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">post_and_replies</span>.<span class=\"pl-c1\">id</span>)\n)\n<span class=\"pl-k\">SELECT</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span></pre></div>\n<p><em>ClearlyClaire</em></p>\n</li>\n<li>\n<p><code>validate_constraint</code> can be called in a <code>change_table</code> block.</p>\n<p>ex:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"change_table :products do |t|\n  t.check_constraint &quot;price &gt; discounted_price&quot;, name: &quot;price_check&quot;, validate: false\n  t.validate_check_constraint &quot;price_check&quot;\nend\"><pre><span class=\"pl-en\">change_table</span> <span class=\"pl-pds\">:products</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">check_constraint</span> <span class=\"pl-s\">\"price &gt; discounted_price\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">name</span>: <span class=\"pl-s\">\"price_check\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">validate</span>: <span class=\"pl-c1\">false</span>\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">validate_check_constraint</span> <span class=\"pl-s\">\"price_check\"</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Cody Cutrer</em></p>\n</li>\n<li>\n<p><code>PostgreSQLAdapter</code> now decodes columns of type date to <code>Date</code> instead of string.</p>\n<p>Ex:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ActiveRecord::Base.connection\n     .select_value(&quot;select '2024-01-01'::date&quot;).class #=&gt; Date\"><pre><span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n     <span class=\"pl-kos\">.</span><span class=\"pl-en\">select_value</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"select '2024-01-01'::date\"</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">class</span> <span class=\"pl-c\">#=&gt; Date</span></pre></div>\n<p><em>Joé Dupuis</em></p>\n</li>\n<li>\n<p>Strict loading using <code>:n_plus_one_only</code> does not eagerly load child associations.</p>\n<p>With this change, child associations are no longer eagerly loaded, to<br>\nmatch intended behavior and to prevent non-deterministic order issues caused<br>\nby calling methods like <code>first</code> or <code>last</code>. As <code>first</code> and <code>last</code> don't cause<br>\nan N+1 by themselves, calling child associations will no longer raise.<br>\nFixes <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1924388730\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49473\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49473/hovercard\" href=\"https://github.com/rails/rails/issues/49473\">#49473</a>.</p>\n<p>Before:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"person = Person.find(1)\nperson.strict_loading!(mode: :n_plus_one_only)\nperson.posts.first\n# SELECT * FROM posts WHERE person_id = 1; -- non-deterministic order\nperson.posts.first.firm # raises ActiveRecord::StrictLoadingViolationError\"><pre><span class=\"pl-s1\">person</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">find</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">strict_loading!</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">mode</span>: <span class=\"pl-pds\">:n_plus_one_only</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">posts</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span>\n<span class=\"pl-c\"># SELECT * FROM posts WHERE person_id = 1; -- non-deterministic order</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">posts</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">firm</span> <span class=\"pl-c\"># raises ActiveRecord::StrictLoadingViolationError</span></pre></div>\n<p>After:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"person = Person.find(1)\nperson.strict_loading!(mode: :n_plus_one_only)\nperson.posts.first # this is 1+1, not N+1\n# SELECT * FROM posts WHERE person_id = 1 ORDER BY id LIMIT 1;\nperson.posts.first.firm # no longer raises\"><pre><span class=\"pl-s1\">person</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">find</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">strict_loading!</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">mode</span>: <span class=\"pl-pds\">:n_plus_one_only</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">posts</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span> <span class=\"pl-c\"># this is 1+1, not N+1</span>\n<span class=\"pl-c\"># SELECT * FROM posts WHERE person_id = 1 ORDER BY id LIMIT 1;</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">posts</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">firm</span> <span class=\"pl-c\"># no longer raises</span></pre></div>\n<p><em>Reid Lynch</em></p>\n</li>\n<li>\n<p>Allow <code>Sqlite3Adapter</code> to use <code>sqlite3</code> gem version <code>2.x</code>.</p>\n<p><em>Mike Dalessio</em></p>\n</li>\n<li>\n<p>Allow <code>ActiveRecord::Base#pluck</code> to accept hash values.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"# Before\nPost.joins(:comments).pluck(&quot;posts.id&quot;, &quot;comments.id&quot;, &quot;comments.body&quot;)\n\n# After\nPost.joins(:comments).pluck(posts: [:id], comments: [:id, :body])\"><pre><span class=\"pl-c\"># Before</span>\n<span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">joins</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:comments</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">pluck</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"posts.id\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"comments.id\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"comments.body\"</span><span class=\"pl-kos\">)</span>\n\n<span class=\"pl-c\"># After</span>\n<span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">joins</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:comments</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">pluck</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">posts</span>: <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">comments</span>: <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:body</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span></pre></div>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Raise an <code>ActiveRecord::ActiveRecordError</code> error when the MySQL database returns an invalid version string.</p>\n<p><em>Kevin McPhillips</em></p>\n</li>\n<li>\n<p><code>ActiveRecord::Base.transaction</code> now yields an <code>ActiveRecord::Transaction</code> object.</p>\n<p>This allows to register callbacks on it.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Article.transaction do |transaction|\n  article.update(published: true)\n  transaction.after_commit do\n    PublishNotificationMailer.with(article: article).deliver_later\n  end\nend\"><pre><span class=\"pl-v\">Article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">transaction</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">transaction</span>|\n  <span class=\"pl-en\">article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">update</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">published</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-s1\">transaction</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">after_commit</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-v\">PublishNotificationMailer</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">article</span>: <span class=\"pl-en\">article</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">deliver_later</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add <code>ActiveRecord::Base.current_transaction</code>.</p>\n<p>Returns the current transaction, to allow registering callbacks on it.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Article.current_transaction.after_commit do\n  PublishNotificationMailer.with(article: article).deliver_later\nend\"><pre><span class=\"pl-v\">Article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">current_transaction</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">after_commit</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-v\">PublishNotificationMailer</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">article</span>: <span class=\"pl-en\">article</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">deliver_later</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add <code>ActiveRecord.after_all_transactions_commit</code> callback.</p>\n<p>Useful for code that may run either inside or outside a transaction and needs<br>\nto perform work after the state changes have been properly persisted.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"def publish_article(article)\n  article.update(published: true)\n  ActiveRecord.after_all_transactions_commit do\n    PublishNotificationMailer.with(article: article).deliver_later\n  end\nend\"><pre><span class=\"pl-k\">def</span> <span class=\"pl-en\">publish_article</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">article</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-s1\">article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">update</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">published</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-v\">ActiveRecord</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">after_all_transactions_commit</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-v\">PublishNotificationMailer</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">article</span>: <span class=\"pl-s1\">article</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">deliver_later</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p>In the above example, the block is either executed immediately if called outside<br>\nof a transaction, or called after the open transaction is committed.</p>\n<p>If the transaction is rolled back, the block isn't called.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add the ability to ignore counter cache columns until they are backfilled.</p>\n<p>Starting to use counter caches on existing large tables can be troublesome, because the column<br>\nvalues must be backfilled separately of the column addition (to not lock the table for too long)<br>\nand before the use of <code>:counter_cache</code> (otherwise methods like <code>size</code>/<code>any?</code>/etc, which use<br>\ncounter caches internally, can produce incorrect results). People usually use database triggers<br>\nor callbacks on child associations while backfilling before introducing a counter cache<br>\nconfiguration to the association.</p>\n<p>Now, to safely backfill the column, while keeping the column updated with child records added/removed, use:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Comment &lt; ApplicationRecord\n  belongs_to :post, counter_cache: { active: false }\nend\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Comment</span> &lt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-en\">belongs_to</span> <span class=\"pl-pds\">:post</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">counter_cache</span>: <span class=\"pl-kos\">{</span> <span class=\"pl-pds\">active</span>: <span class=\"pl-c1\">false</span> <span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p>While the counter cache is not \"active\", the methods like <code>size</code>/<code>any?</code>/etc will not use it,<br>\nbut get the results directly from the database. After the counter cache column is backfilled, simply<br>\nremove the <code>{ active: false }</code> part from the counter cache definition, and it will now be used by the<br>\nmentioned methods.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Retry known idempotent SELECT queries on connection-related exceptions.</p>\n<p>SELECT queries we construct by walking the Arel tree and / or with known model attributes<br>\nare idempotent and can safely be retried in the case of a connection error. Previously,<br>\nadapters such as <code>TrilogyAdapter</code> would raise <code>ActiveRecord::ConnectionFailed: Trilogy::EOFError</code><br>\nwhen encountering a connection error mid-request.</p>\n<p><em>Adrianna Chang</em></p>\n</li>\n<li>\n<p>Allow association's <code>foreign_key</code> to be composite.</p>\n<p><code>query_constraints</code> option was the only way to configure a composite foreign key by passing an <code>Array</code>.<br>\nNow it's possible to pass an Array value as <code>foreign_key</code> to achieve the same behavior of an association.</p>\n<p><em>Nikita Vasilevsky</em></p>\n</li>\n<li>\n<p>Allow association's <code>primary_key</code> to be composite.</p>\n<p>Association's <code>primary_key</code> can be composite when derived from associated model <code>primary_key</code> or <code>query_constraints</code>.<br>\nNow it's possible to explicitly set it as composite on the association.</p>\n<p><em>Nikita Vasilevsky</em></p>\n</li>\n<li>\n<p>Add <code>config.active_record.permanent_connection_checkout</code> setting.</p>\n<p>Controls whether <code>ActiveRecord::Base.connection</code> raises an error, emits a deprecation warning, or neither.</p>\n<p><code>ActiveRecord::Base.connection</code> checkouts a database connection from the pool and keeps it leased until the end of<br>\nthe request or job. This behavior can be undesirable in environments that use many more threads or fibers than there<br>\nis available connections.</p>\n<p>This configuration can be used to track down and eliminate code that calls <code>ActiveRecord::Base.connection</code> and<br>\nmigrate it to use <code>ActiveRecord::Base.with_connection</code> instead.</p>\n<p>The default behavior remains unchanged, and there is currently no plans to change the default.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add dirties option to uncached.</p>\n<p>This adds a <code>dirties</code> option to <code>ActiveRecord::Base.uncached</code> and<br>\n<code>ActiveRecord::ConnectionAdapters::ConnectionPool#uncached</code>.</p>\n<p>When set to <code>true</code> (the default), writes will clear all query caches belonging to the current thread.<br>\nWhen set to <code>false</code>, writes to the affected connection pool will not clear any query cache.</p>\n<p>This is needed by Solid Cache so that cache writes do not clear query caches.</p>\n<p><em>Donal McBreen</em></p>\n</li>\n<li>\n<p>Deprecate <code>ActiveRecord::Base.connection</code> in favor of <code>.lease_connection</code>.</p>\n<p>The method has been renamed as <code>lease_connection</code> to better reflect that the returned<br>\nconnection will be held for the duration of the request or job.</p>\n<p>This deprecation is a soft deprecation, no warnings will be issued and there is no<br>\ncurrent plan to remove the method.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Deprecate <code>ActiveRecord::ConnectionAdapters::ConnectionPool#connection</code>.</p>\n<p>The method has been renamed as <code>lease_connection</code> to better reflect that the returned<br>\nconnection will be held for the duration of the request or job.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Expose a generic fixture accessor for fixture names that may conflict with Minitest.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"assert_equal &quot;Ruby on Rails&quot;, web_sites(:rubyonrails).name\nassert_equal &quot;Ruby on Rails&quot;, fixture(:web_sites, :rubyonrails).name\"><pre><span class=\"pl-en\">assert_equal</span> <span class=\"pl-s\">\"Ruby on Rails\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-en\">web_sites</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:rubyonrails</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">name</span>\n<span class=\"pl-en\">assert_equal</span> <span class=\"pl-s\">\"Ruby on Rails\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-en\">fixture</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:web_sites</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:rubyonrails</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">name</span></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Using <code>Model.query_constraints</code> with a single non-primary-key column used to raise as expected, but with an<br>\nincorrect error message.</p>\n<p>This has been fixed to raise with a more appropriate error message.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>Fix <code>has_one</code> association autosave setting the foreign key attribute when it is unchanged.</p>\n<p>This behavior is also inconsistent with autosaving <code>belongs_to</code> and can have unintended side effects like raising<br>\nan <code>ActiveRecord::ReadonlyAttributeError</code> when the foreign key attribute is marked as read-only.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>Remove deprecated behavior that would rollback a transaction block when exited using <code>return</code>, <code>break</code> or <code>throw</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Deprecate <code>Rails.application.config.active_record.commit_transaction_on_non_local_return</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to pass <code>rewhere</code> to <code>ActiveRecord::Relation#merge</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to pass <code>deferrable: true</code> to <code>add_foreign_key</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to quote <code>ActiveSupport::Duration</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>#quote_bound_value</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::ConnectionAdapters::ConnectionPool#connection_klass</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to apply <code>#connection_pool_list</code>, <code>#active_connections?</code>, <code>#clear_active_connections!</code>,<br>\n<code>#clear_reloadable_connections!</code>, <code>#clear_all_connections!</code> and <code>#flush_idle_connections!</code> to the connections pools<br>\nfor the current role when the <code>role</code> argument isn't provided.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>#all_connection_pools</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::ConnectionAdapters::SchemaCache#data_sources</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::ConnectionAdapters::SchemaCache.load_from</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>#all_foreign_keys_valid?</code> from database adapters.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to passing coder and class as second argument to <code>serialize</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to <code>ActiveRecord::Base#read_attribute(:id)</code> to return the custom primary key value.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>TestFixtures.fixture_path</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated behavior to support referring to a singular association by its plural name.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Deprecate <code>Rails.application.config.active_record.allow_deprecated_singular_associations_name</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to passing <code>SchemaMigration</code> and <code>InternalMetadata</code> classes as arguments to<br>\n<code>ActiveRecord::MigrationContext</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Migration.check_pending!</code> method.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::LogSubscriber.runtime</code> method.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::LogSubscriber.runtime=</code> method.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::LogSubscriber.reset_runtime</code> method.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to define <code>explain</code> in the connection adapter with 2 arguments.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::ActiveJobRequiredError</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Base.clear_active_connections!</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Base.clear_reloadable_connections!</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Base.clear_all_connections!</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Base.flush_idle_connections!</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>name</code> argument from <code>ActiveRecord::Base.remove_connection</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to call <code>alias_attribute</code> with non-existent attribute names.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>Rails.application.config.active_record.suppress_multiple_database_warning</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Add <code>ActiveRecord::Encryption::MessagePackMessageSerializer</code>.</p>\n<p>Serialize data to the MessagePack format, for efficient storage in binary columns.</p>\n<p>The binary encoding requires around 30% less space than the base64 encoding<br>\nused by the default serializer.</p>\n<p><em>Donal McBreen</em></p>\n</li>\n<li>\n<p>Add support for encrypting binary columns.</p>\n<p>Ensure encryption and decryption pass <code>Type::Binary::Data</code> around for binary data.</p>\n<p>Previously encrypting binary columns with the <code>ActiveRecord::Encryption::MessageSerializer</code><br>\nincidentally worked for MySQL and SQLite, but not PostgreSQL.</p>\n<p><em>Donal McBreen</em></p>\n</li>\n<li>\n<p>Deprecated <code>ENV[\"SCHEMA_CACHE\"]</code> in favor of <code>schema_cache_path</code> in the database configuration.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Add <code>ActiveRecord::Base.with_connection</code> as a shortcut for leasing a connection for a short duration.</p>\n<p>The leased connection is yielded, and for the duration of the block, any call to <code>ActiveRecord::Base.connection</code><br>\nwill yield that same connection.</p>\n<p>This is useful to perform a few database operations without causing a connection to be leased for the<br>\nentire duration of the request or job.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Deprecate <code>config.active_record.warn_on_records_fetched_greater_than</code> now that <code>sql.active_record</code><br>\nnotification includes <code>:row_count</code> field.</p>\n<p><em>Jason Nochlin</em></p>\n</li>\n<li>\n<p>The fix ensures that the association is joined using the appropriate join type<br>\n(either inner join or left outer join) based on the existing joins in the scope.</p>\n<p>This prevents unintentional overrides of existing join types and ensures consistency in the generated SQL queries.</p>\n<p>Example:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"# `associated` will use `LEFT JOIN` instead of using `JOIN`\nPost.left_joins(:author).where.associated(:author)\"><pre><span class=\"pl-c\"># `associated` will use `LEFT JOIN` instead of using `JOIN`</span>\n<span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">left_joins</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:author</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">where</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">associated</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:author</span><span class=\"pl-kos\">)</span></pre></div>\n<p><em>Saleh Alhaddad</em></p>\n</li>\n<li>\n<p>Fix an issue where <code>ActiveRecord::Encryption</code> configurations are not ready before the loading<br>\nof Active Record models, when an application is eager loaded. As a result, encrypted attributes<br>\ncould be misconfigured in some cases.</p>\n<p><em>Maxime Réty</em></p>\n</li>\n<li>\n<p>Deprecate defining an <code>enum</code> with keyword arguments.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Function &gt; ApplicationRecord\n  # BAD\n  enum color: [:red, :blue],\n       type: [:instance, :class]\n\n  # GOOD\n  enum :color, [:red, :blue]\n  enum :type, [:instance, :class]\nend\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Function</span> &gt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-c\"># BAD</span>\n  <span class=\"pl-en\">enum</span> <span class=\"pl-pds\">color</span>: <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:red</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:blue</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span>\n       <span class=\"pl-pds\">type</span>: <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:instance</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:class</span><span class=\"pl-kos\">]</span>\n\n  <span class=\"pl-c\"># GOOD</span>\n  <span class=\"pl-en\">enum</span> <span class=\"pl-pds\">:color</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:red</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:blue</span><span class=\"pl-kos\">]</span>\n  <span class=\"pl-en\">enum</span> <span class=\"pl-pds\">:type</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:instance</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:class</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Hartley McGuire</em></p>\n</li>\n<li>\n<p>Add <code>config.active_record.validate_migration_timestamps</code> option for validating migration timestamps.</p>\n<p>When set, validates that the timestamp prefix for a migration is no more than a day ahead of<br>\nthe timestamp associated with the current time. This is designed to prevent migrations prefixes<br>\nfrom being hand-edited to future timestamps, which impacts migration generation and other<br>\nmigration commands.</p>\n<p><em>Adrianna Chang</em></p>\n</li>\n<li>\n<p>Properly synchronize <code>Mysql2Adapter#active?</code> and <code>TrilogyAdapter#active?</code>.</p>\n<p>As well as <code>disconnect!</code> and <code>verify!</code>.</p>\n<p>This generally isn't a big problem as connections must not be shared between<br>\nthreads, but is required when running transactional tests or system tests<br>\nand could lead to a SEGV.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Support <code>:source_location</code> tag option for query log tags.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"config.active_record.query_log_tags &lt;&lt; :source_location\"><pre><span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">active_record</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">query_log_tags</span> &lt;&lt; <span class=\"pl-pds\">:source_location</span></pre></div>\n<p>Calculating the caller location is a costly operation and should be used primarily in development<br>\n(note, there is also a <code>config.active_record.verbose_query_logs</code> that serves the same purpose)<br>\nor occasionally on production for debugging purposes.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Add an option to <code>ActiveRecord::Encryption::Encryptor</code> to disable compression.</p>\n<p>Allow compression to be disabled by setting <code>compress: false</code></p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"  class User\n    encrypts :name, encryptor: ActiveRecord::Encryption::Encryptor.new(compress: false)\n  end\"><pre>  <span class=\"pl-k\">class</span> <span class=\"pl-v\">User</span>\n    <span class=\"pl-en\">encrypts</span> <span class=\"pl-pds\">:name</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">encryptor</span>: <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Encryption</span>::<span class=\"pl-v\">Encryptor</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">compress</span>: <span class=\"pl-c1\">false</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span></pre></div>\n<p><em>Donal McBreen</em></p>\n</li>\n<li>\n<p>Deprecate passing strings to <code>ActiveRecord::Tasks::DatabaseTasks.cache_dump_filename</code>.</p>\n<p>A <code>ActiveRecord::DatabaseConfigurations::DatabaseConfig</code> object should be passed instead.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Add <code>row_count</code> field to <code>sql.active_record</code> notification.</p>\n<p>This field returns the amount of rows returned by the query that emitted the notification.</p>\n<p>This metric is useful in cases where one wants to detect queries with big result sets.</p>\n<p><em>Marvin Bitterlich</em></p>\n</li>\n<li>\n<p>Consistently raise an <code>ArgumentError</code> when passing an invalid argument to a nested attributes association writer.</p>\n<p>Previously, this would only raise on collection associations and produce a generic error on singular associations.</p>\n<p>Now, it will raise on both collection and singular associations.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>Fix single quote escapes on default generated MySQL columns.</p>\n<p>MySQL 5.7.5+ supports generated columns, which can be used to create a column that is computed from an expression.</p>\n<p>Previously, the schema dump would output a string with double escapes for generated columns with single quotes in the default expression.</p>\n<p>This would result in issues when importing the schema on a fresh instance of a MySQL database.</p>\n<p>Now, the string will not be escaped and will be valid Ruby upon importing of the schema.</p>\n<p><em>Yash Kapadia</em></p>\n</li>\n<li>\n<p>Fix Migrations with versions older than 7.1 validating options given to<br>\n<code>add_reference</code> and <code>t.references</code>.</p>\n<p><em>Hartley McGuire</em></p>\n</li>\n<li>\n<p>Add <code>&lt;role&gt;_types</code> class method to <code>ActiveRecord::DelegatedType</code> so that the delegated types can be introspected.</p>\n<p><em>JP Rosevear</em></p>\n</li>\n<li>\n<p>Make <code>schema_dump</code>, <code>query_cache</code>, <code>replica</code> and <code>database_tasks</code> configurable via <code>DATABASE_URL</code>.</p>\n<p>This wouldn't always work previously because boolean values would be interpreted as strings.</p>\n<p>e.g. <code>DATABASE_URL=postgres://localhost/foo?schema_dump=false</code> now properly disable dumping the schema<br>\ncache.</p>\n<p><em>Mike Coutermarsh</em>, <em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Introduce <code>ActiveRecord::Transactions::ClassMethods#set_callback</code>.</p>\n<p>It is identical to <code>ActiveSupport::Callbacks::ClassMethods#set_callback</code><br>\nbut with support for <code>after_commit</code> and <code>after_rollback</code> callback options.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>Make <code>ActiveRecord::Encryption::Encryptor</code> agnostic of the serialization format used for encrypted data.</p>\n<p>Previously, the encryptor instance only allowed an encrypted value serialized as a <code>String</code> to be passed to the message serializer.</p>\n<p>Now, the encryptor lets the configured <code>message_serializer</code> decide which types of serialized encrypted values are supported. A custom serialiser is therefore allowed to serialize <code>ActiveRecord::Encryption::Message</code> objects using a type other than <code>String</code>.</p>\n<p>The default <code>ActiveRecord::Encryption::MessageSerializer</code> already ensures that only <code>String</code> objects are passed for deserialization.</p>\n<p><em>Maxime Réty</em></p>\n</li>\n<li>\n<p>Fix <code>encrypted_attribute?</code> to take into account context properties passed to <code>encrypts</code>.</p>\n<p><em>Maxime Réty</em></p>\n</li>\n<li>\n<p>The object returned by <code>explain</code> now responds to <code>pluck</code>, <code>first</code>,<br>\n<code>last</code>, <code>average</code>, <code>count</code>, <code>maximum</code>, <code>minimum</code>, and <code>sum</code>. Those<br>\nnew methods run <code>EXPLAIN</code> on the corresponding queries:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"User.all.explain.count\n# EXPLAIN SELECT COUNT(*) FROM `users`\n# ...\n\nUser.all.explain.maximum(:id)\n# EXPLAIN SELECT MAX(`users`.`id`) FROM `users`\n# ...\"><pre><span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">all</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">explain</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">count</span>\n<span class=\"pl-c\"># EXPLAIN SELECT COUNT(*) FROM `users`</span>\n<span class=\"pl-c\"># ...</span>\n\n<span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">all</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">explain</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">maximum</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:id</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c\"># EXPLAIN SELECT MAX(`users`.`id`) FROM `users`</span>\n<span class=\"pl-c\"># ...</span></pre></div>\n<p><em>Petrik de Heus</em></p>\n</li>\n<li>\n<p>Fixes an issue where <code>validates_associated</code> <code>:on</code>  option wasn't respected<br>\nwhen validating associated records.</p>\n<p><em>Austen Madden</em>, <em>Alex Ghiculescu</em>, <em>Rafał Brize</em></p>\n</li>\n<li>\n<p>Allow overriding SQLite defaults from <code>database.yml</code>.</p>\n<p>Any PRAGMA configuration set under the <code>pragmas</code> key in the configuration<br>\nfile takes precedence over Rails' defaults, and additional PRAGMAs can be<br>\nset as well.</p>\n<div class=\"highlight highlight-source-yaml notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"database: storage/development.sqlite3\ntimeout: 5000\npragmas:\n  journal_mode: off\n  temp_store: memory\"><pre><span class=\"pl-ent\">database</span>: <span class=\"pl-s\">storage/development.sqlite3</span>\n<span class=\"pl-ent\">timeout</span>: <span class=\"pl-c1\">5000</span>\n<span class=\"pl-ent\">pragmas</span>:\n  <span class=\"pl-ent\">journal_mode</span>: <span class=\"pl-s\">off</span>\n  <span class=\"pl-ent\">temp_store</span>: <span class=\"pl-s\">memory</span></pre></div>\n<p><em>Stephen Margheim</em></p>\n</li>\n<li>\n<p>Remove warning message when running SQLite in production, but leave it unconfigured.</p>\n<p>There are valid use cases for running SQLite in production. However, it must be done<br>\nwith care, so instead of a warning most users won't see anyway, it's preferable to<br>\nleave the configuration commented out to force them to think about having the database<br>\non a persistent volume etc.</p>\n<p><em>Jacopo Beschi</em>, <em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add support for generated columns to the SQLite3 adapter.</p>\n<p>Generated columns (both stored and dynamic) are supported since version 3.31.0 of SQLite.<br>\nThis adds support for those to the SQLite3 adapter.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"create_table :users do |t|\n  t.string :name\n  t.virtual :name_upper, type: :string, as: 'UPPER(name)'\n  t.virtual :name_lower, type: :string, as: 'LOWER(name)', stored: true\nend\"><pre><span class=\"pl-en\">create_table</span> <span class=\"pl-pds\">:users</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">string</span> <span class=\"pl-pds\">:name</span>\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">virtual</span> <span class=\"pl-pds\">:name_upper</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">type</span>: <span class=\"pl-pds\">:string</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">as</span>: <span class=\"pl-s\">'UPPER(name)'</span>\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">virtual</span> <span class=\"pl-pds\">:name_lower</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">type</span>: <span class=\"pl-pds\">:string</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">as</span>: <span class=\"pl-s\">'LOWER(name)'</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">stored</span>: <span class=\"pl-c1\">true</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Stephen Margheim</em></p>\n</li>\n<li>\n<p>TrilogyAdapter: ignore <code>host</code> if <code>socket</code> parameter is set.</p>\n<p>This allows to configure a connection on a UNIX socket via <code>DATABASE_URL</code>:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"DATABASE_URL=trilogy://does-not-matter/my_db_production?socket=/var/run/mysql.sock\"><pre class=\"notranslate\"><code>DATABASE_URL=trilogy://does-not-matter/my_db_production?socket=/var/run/mysql.sock\n</code></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Make <code>assert_queries_count</code>, <code>assert_no_queries</code>, <code>assert_queries_match</code>, and<br>\n<code>assert_no_queries_match</code> assertions public.</p>\n<p>To assert the expected number of queries are made, Rails internally uses <code>assert_queries_count</code> and<br>\n<code>assert_no_queries</code>. To assert that specific SQL queries are made, <code>assert_queries_match</code> and<br>\n<code>assert_no_queries_match</code> are used. These assertions can now be used in applications as well.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class ArticleTest &lt; ActiveSupport::TestCase\n  test &quot;queries are made&quot; do\n    assert_queries_count(1) { Article.first }\n  end\n\n  test &quot;creates a foreign key&quot; do\n    assert_queries_match(/ADD FOREIGN KEY/i, include_schema: true) do\n      @ connection.add_foreign_key(:comments, :posts)\n    end\n  end\nend\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">ArticleTest</span> &lt; <span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">TestCase</span>\n  <span class=\"pl-en\">test</span> <span class=\"pl-s\">\"queries are made\"</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-en\">assert_queries_count</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span> <span class=\"pl-v\">Article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span> <span class=\"pl-kos\">}</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-en\">test</span> <span class=\"pl-s\">\"creates a foreign key\"</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-en\">assert_queries_match</span><span class=\"pl-kos\">(</span><span class=\"pl-sr\">/ADD FOREIGN KEY/i</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">include_schema</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n      <span class=\"pl-c1\">@ connection</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">add_foreign_key</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:comments</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:posts</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-k\">end</...","reactions":{"url":"https://api.github.com/repos/INexizI/KR-DB/issues/393/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/INexizI/KR-DB/issues/393/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"INexizI","id":39536903,"node_id":"MDQ6VXNlcjM5NTM2OTAz","avatar_url":"https://avatars.githubusercontent.com/u/39536903?v=4","gravatar_id":"","url":"https://api.github.com/users/INexizI","html_url":"https://github.com/INexizI","followers_url":"https://api.github.com/users/INexizI/followers","following_url":"https://api.github.com/users/INexizI/following{/other_user}","gists_url":"https://api.github.com/users/INexizI/gists{/gist_id}","starred_url":"https://api.github.com/users/INexizI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/INexizI/subscriptions","organizations_url":"https://api.github.com/users/INexizI/orgs","repos_url":"https://api.github.com/users/INexizI/repos","events_url":"https://api.github.com/users/INexizI/events{/privacy}","received_events_url":"https://api.github.com/users/INexizI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-07T09:44:39Z","updated_at":"2024-09-07T09:44:39Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/INexizI/asmn_bot/issues/135","repository_url":"https://api.github.com/repos/INexizI/asmn_bot","labels_url":"https://api.github.com/repos/INexizI/asmn_bot/issues/135/labels{/name}","comments_url":"https://api.github.com/repos/INexizI/asmn_bot/issues/135/comments","events_url":"https://api.github.com/repos/INexizI/asmn_bot/issues/135/events","html_url":"https://github.com/INexizI/asmn_bot/pull/135","id":2511568020,"node_id":"PR_kwDOGoR7XM56ugF_","number":135,"title":"[Snyk] Upgrade: , , jquery-ui, react-spring","user":{"login":"INexizI","id":39536903,"node_id":"MDQ6VXNlcjM5NTM2OTAz","avatar_url":"https://avatars.githubusercontent.com/u/39536903?v=4","gravatar_id":"","url":"https://api.github.com/users/INexizI","html_url":"https://github.com/INexizI","followers_url":"https://api.github.com/users/INexizI/followers","following_url":"https://api.github.com/users/INexizI/following{/other_user}","gists_url":"https://api.github.com/users/INexizI/gists{/gist_id}","starred_url":"https://api.github.com/users/INexizI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/INexizI/subscriptions","organizations_url":"https://api.github.com/users/INexizI/orgs","repos_url":"https://api.github.com/users/INexizI/repos","events_url":"https://api.github.com/users/INexizI/events{/privacy}","received_events_url":"https://api.github.com/users/INexizI/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2024-09-07T09:44:38Z","updated_at":"2024-10-17T21:05:01Z","closed_at":"2024-10-17T21:04:59Z","author_association":"OWNER","active_lock_reason":null,"draft":false,"repository":{"id":444889948,"node_id":"R_kgDOGoR7XA","name":"asmn_bot","full_name":"INexizI/asmn_bot","private":false,"owner":{"login":"INexizI","id":39536903,"node_id":"MDQ6VXNlcjM5NTM2OTAz","avatar_url":"https://avatars.githubusercontent.com/u/39536903?v=4","gravatar_id":"","url":"https://api.github.com/users/INexizI","html_url":"https://github.com/INexizI","followers_url":"https://api.github.com/users/INexizI/followers","following_url":"https://api.github.com/users/INexizI/following{/other_user}","gists_url":"https://api.github.com/users/INexizI/gists{/gist_id}","starred_url":"https://api.github.com/users/INexizI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/INexizI/subscriptions","organizations_url":"https://api.github.com/users/INexizI/orgs","repos_url":"https://api.github.com/users/INexizI/repos","events_url":"https://api.github.com/users/INexizI/events{/privacy}","received_events_url":"https://api.github.com/users/INexizI/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/INexizI/asmn_bot","description":"Twitch Bot","fork":false,"url":"https://api.github.com/repos/INexizI/asmn_bot","forks_url":"https://api.github.com/repos/INexizI/asmn_bot/forks","keys_url":"https://api.github.com/repos/INexizI/asmn_bot/keys{/key_id}","collaborators_url":"https://api.github.com/repos/INexizI/asmn_bot/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/INexizI/asmn_bot/teams","hooks_url":"https://api.github.com/repos/INexizI/asmn_bot/hooks","issue_events_url":"https://api.github.com/repos/INexizI/asmn_bot/issues/events{/number}","events_url":"https://api.github.com/repos/INexizI/asmn_bot/events","assignees_url":"https://api.github.com/repos/INexizI/asmn_bot/assignees{/user}","branches_url":"https://api.github.com/repos/INexizI/asmn_bot/branches{/branch}","tags_url":"https://api.github.com/repos/INexizI/asmn_bot/tags","blobs_url":"https://api.github.com/repos/INexizI/asmn_bot/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/INexizI/asmn_bot/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/INexizI/asmn_bot/git/refs{/sha}","trees_url":"https://api.github.com/repos/INexizI/asmn_bot/git/trees{/sha}","statuses_url":"https://api.github.com/repos/INexizI/asmn_bot/statuses/{sha}","languages_url":"https://api.github.com/repos/INexizI/asmn_bot/languages","stargazers_url":"https://api.github.com/repos/INexizI/asmn_bot/stargazers","contributors_url":"https://api.github.com/repos/INexizI/asmn_bot/contributors","subscribers_url":"https://api.github.com/repos/INexizI/asmn_bot/subscribers","subscription_url":"https://api.github.com/repos/INexizI/asmn_bot/subscription","commits_url":"https://api.github.com/repos/INexizI/asmn_bot/commits{/sha}","git_commits_url":"https://api.github.com/repos/INexizI/asmn_bot/git/commits{/sha}","comments_url":"https://api.github.com/repos/INexizI/asmn_bot/comments{/number}","issue_comment_url":"https://api.github.com/repos/INexizI/asmn_bot/issues/comments{/number}","contents_url":"https://api.github.com/repos/INexizI/asmn_bot/contents/{+path}","compare_url":"https://api.github.com/repos/INexizI/asmn_bot/compare/{base}...{head}","merges_url":"https://api.github.com/repos/INexizI/asmn_bot/merges","archive_url":"https://api.github.com/repos/INexizI/asmn_bot/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/INexizI/asmn_bot/downloads","issues_url":"https://api.github.com/repos/INexizI/asmn_bot/issues{/number}","pulls_url":"https://api.github.com/repos/INexizI/asmn_bot/pulls{/number}","milestones_url":"https://api.github.com/repos/INexizI/asmn_bot/milestones{/number}","notifications_url":"https://api.github.com/repos/INexizI/asmn_bot/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/INexizI/asmn_bot/labels{/name}","releases_url":"https://api.github.com/repos/INexizI/asmn_bot/releases{/id}","deployments_url":"https://api.github.com/repos/INexizI/asmn_bot/deployments","created_at":"2022-01-05T17:21:07Z","updated_at":"2025-10-21T18:43:40Z","pushed_at":"2025-10-21T18:43:39Z","git_url":"git://github.com/INexizI/asmn_bot.git","ssh_url":"git@github.com:INexizI/asmn_bot.git","clone_url":"https://github.com/INexizI/asmn_bot.git","svn_url":"https://github.com/INexizI/asmn_bot","homepage":null,"size":2305,"stargazers_count":0,"watchers_count":0,"language":"JavaScript","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":4,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":4,"watchers":0,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/INexizI/asmn_bot/pulls/135","html_url":"https://github.com/INexizI/asmn_bot/pull/135","diff_url":"https://github.com/INexizI/asmn_bot/pull/135.diff","patch_url":"https://github.com/INexizI/asmn_bot/pull/135.patch","merged_at":"2024-10-17T21:04:59Z"},"body":"![snyk-top-banner](https://github.com/andygongea/OWASP-Benchmark/assets/818805/c518c423-16fe-447e-b67f-ad5a49b5d123)\n\n\n<h3>Snyk has created this PR to upgrade multiple dependencies.</h3>\n👯 The following dependencies are linked and will therefore be updated together.\n</br></br>\n:information_source: Keep your dependencies up-to-date. This makes it easier to fix existing vulnerabilities and to more quickly identify and fix newly disclosed vulnerabilities when they affect your project.\n</br></br>\n\n\n| Name | Versions | Released on |\n| :--- | :------- | :---------- |\n\n**@rails/actioncable**</br>from 7.1.3 to 7.2.0 | **6 versions** ahead of your current version | **a month ago**</br>on 2024-08-09\n**@rails/activestorage**</br>from 7.1.3 to 7.2.0 | **6 versions** ahead of your current version | **a month ago**</br>on 2024-08-09\n**jquery-ui**</br>from 1.13.3 to 1.14.0 | **3 versions** ahead of your current version | **a month ago**</br>on 2024-08-05\n**react-spring**</br>from 9.7.3 to 9.7.4 | **1 version** ahead of your current version | **2 months ago**</br>on 2024-07-21\n\n\n#### Issues fixed by the recommended upgrade:\n\n|  | Issue | Score | Exploit Maturity |\n:-------------------------:|:-------------------------|:-------------------------|:-------------------------\n![critical severity](https://res.cloudinary.com/snyk/image/upload/w_20,h_20/v1561977819/icon/c.png 'critical severity') | Improper Verification of Cryptographic Signature<br/>[SNYK-JS-ELLIPTIC-7577916](https://snyk.io/vuln/SNYK-JS-ELLIPTIC-7577916) | **562** | Proof of Concept \n![critical severity](https://res.cloudinary.com/snyk/image/upload/w_20,h_20/v1561977819/icon/c.png 'critical severity') | Improper Verification of Cryptographic Signature<br/>[SNYK-JS-ELLIPTIC-7577917](https://snyk.io/vuln/SNYK-JS-ELLIPTIC-7577917) | **562** | Proof of Concept \n![critical severity](https://res.cloudinary.com/snyk/image/upload/w_20,h_20/v1561977819/icon/c.png 'critical severity') | Improper Verification of Cryptographic Signature<br/>[SNYK-JS-ELLIPTIC-7577918](https://snyk.io/vuln/SNYK-JS-ELLIPTIC-7577918) | **562** | Proof of Concept \n\n\n\n<details>\n<summary><b>Release notes</b></summary>\n<br/>\n  <details>\n    <summary>Package name: <b>@rails/actioncable</b></summary>\n    <ul>\n      <li>\n        <b>7.2.0</b> - <a href=\"https://github.com/rails/rails/releases/tag/v7.2.0\">2024-08-09</a></br><h2>Active Support</h2>\n<ul>\n<li>\n<p>Fix <code>delegate_missing_to allow_nil: true</code> when called with implict self</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Person\n  delegate_missing_to :address, allow_nil: true\n\n  def address\n    nil\n  end\n\n  def berliner?\n    city == &quot;Berlin&quot;\n  end\nend\n\nPerson.new.city # =&gt; nil\nPerson.new.berliner? # undefined local variable or method `city' for an instance of Person (NameError)\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Person</span>\n  <span class=\"pl-en\">delegate_missing_to</span> <span class=\"pl-pds\">:address</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">allow_nil</span>: <span class=\"pl-c1\">true</span>\n\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">address</span>\n    <span class=\"pl-c1\">nil</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">berliner?</span>\n    <span class=\"pl-en\">city</span> == <span class=\"pl-s\">\"Berlin\"</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">city</span> <span class=\"pl-c\"># =&gt; nil</span>\n<span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">berliner?</span> <span class=\"pl-c\"># undefined local variable or method `city' for an instance of Person (NameError)</span></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add <code>logger</code> as a dependency since it is a bundled gem candidate for Ruby 3.5</p>\n<p><em>Earlopain</em></p>\n</li>\n<li>\n<p>Define <code>Digest::UUID.nil_uuid</code>, which returns the so-called nil UUID.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Support <code>duration</code> type in <code>ActiveSupport::XmlMini</code>.</p>\n<p><em>heka1024</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveSupport::Notifications::Event#children</code> and  <code>ActiveSupport::Notifications::Event#parent_of?</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to call the following methods without passing a deprecator:</p>\n<ul>\n<li><code>deprecate</code></li>\n<li><code>deprecate_constant</code></li>\n<li><code>ActiveSupport::Deprecation::DeprecatedObjectProxy.new</code></li>\n<li><code>ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy.new</code></li>\n<li><code>ActiveSupport::Deprecation::DeprecatedConstantProxy.new</code></li>\n<li><code>assert_deprecated</code></li>\n<li><code>assert_not_deprecated</code></li>\n<li><code>collect_deprecations</code></li>\n</ul>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveSupport::Deprecation</code> delegation to instance.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>SafeBuffer#clone_empty</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>#to_default_s</code> from <code>Array</code>, <code>Date</code>, <code>DateTime</code> and <code>Time</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to passing <code>Dalli::Client</code> instances to <code>MemCacheStore</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>config.active_support.use_rfc4122_namespaced_uuids</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>config.active_support.remove_deprecated_time_with_zone_name</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>config.active_support.disable_to_s_conversion</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to bolding log text with positional boolean in <code>ActiveSupport::LogSubscriber#color</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated constants <code>ActiveSupport::LogSubscriber::CLEAR</code> and <code>ActiveSupport::LogSubscriber::BOLD</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support for <code>config.active_support.cache_format_version = 6.1</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>:pool_size</code> and <code>:pool_timeout</code> options for the cache storage.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Warn on tests without assertions.</p>\n<p><code>ActiveSupport::TestCase</code> now warns when tests do not run any assertions.<br>\nThis is helpful in detecting broken tests that do not perform intended assertions.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Support <code>hexBinary</code> type in <code>ActiveSupport::XmlMini</code>.</p>\n<p><em>heka1024</em></p>\n</li>\n<li>\n<p>Deprecate <code>ActiveSupport::ProxyObject</code> in favor of Ruby's built-in <code>BasicObject</code>.</p>\n<p><em>Earlopain</em></p>\n</li>\n<li>\n<p><code>stub_const</code> now accepts a <code>exists: false</code> parameter to allow stubbing missing constants.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Make <code>ActiveSupport::BacktraceCleaner</code> copy filters and silencers on dup and clone.</p>\n<p>Previously the copy would still share the internal silencers and filters array,<br>\ncausing state to leak.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Updating Astana with Western Kazakhstan TZInfo identifier.</p>\n<p><em>Damian Nelson</em></p>\n</li>\n<li>\n<p>Add filename support for <code>ActiveSupport::Logger.logger_outputs_to?</code>.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"logger = Logger.new('/var/log/rails.log')\nActiveSupport::Logger.logger_outputs_to?(logger, '/var/log/rails.log')\"><pre><span class=\"pl-s1\">logger</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Logger</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'/var/log/rails.log'</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">Logger</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">logger_outputs_to?</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">logger</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'/var/log/rails.log'</span><span class=\"pl-kos\">)</span></pre></div>\n<p><em>Christian Schmidt</em></p>\n</li>\n<li>\n<p>Include <code>IPAddr#prefix</code> when serializing an <code>IPAddr</code> using the<br>\n<code>ActiveSupport::MessagePack</code> serializer.</p>\n<p>This change is backward and forward compatible — old payloads can<br>\nstill be read, and new payloads will be readable by older versions of Rails.</p>\n<p><em>Taiki Komaba</em></p>\n</li>\n<li>\n<p>Add <code>default:</code> support for <code>ActiveSupport::CurrentAttributes.attribute</code>.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Current &lt; ActiveSupport::CurrentAttributes\n  attribute :counter, default: 0\nend\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Current</span> &lt; <span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">CurrentAttributes</span>\n  <span class=\"pl-en\">attribute</span> <span class=\"pl-pds\">:counter</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">default</span>: <span class=\"pl-c1\">0</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Sean Doyle</em></p>\n</li>\n<li>\n<p>Yield instance to <code>Object#with</code> block.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"client.with(timeout: 5_000) do |c|\n  c.get(&quot;/commits&quot;)\nend\"><pre><span class=\"pl-en\">client</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">timeout</span>: <span class=\"pl-c1\">5_000</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">c</span>|\n  <span class=\"pl-s1\">c</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">get</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"/commits\"</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Sean Doyle</em></p>\n</li>\n<li>\n<p>Use logical core count instead of physical core count to determine the<br>\ndefault number of workers when parallelizing tests.</p>\n<p><em>Jonathan Hefner</em></p>\n</li>\n<li>\n<p>Fix <code>Time.now/DateTime.now/Date.today</code> to return results in a system timezone after <code>#travel_to</code>.</p>\n<p>There is a bug in the current implementation of #travel_to:<br>\nit remembers a timezone of its argument, and all stubbed methods start<br>\nreturning results in that remembered timezone. However, the expected<br>\nbehavior is to return results in a system timezone.</p>\n<p><em>Aleksei Chernenkov</em></p>\n</li>\n<li>\n<p>Add <code>ErrorReported#unexpected</code> to report precondition violations.</p>\n<p>For example:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"def edit\n  if published?\n    Rails.error.unexpected(&quot;[BUG] Attempting to edit a published article, that shouldn't be possible&quot;)\n    return false\n  end\n  # ...\nend\"><pre><span class=\"pl-k\">def</span> <span class=\"pl-en\">edit</span>\n  <span class=\"pl-k\">if</span> <span class=\"pl-en\">published?</span>\n    <span class=\"pl-v\">Rails</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">error</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">unexpected</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"[BUG] Attempting to edit a published article, that shouldn't be possible\"</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">false</span>\n  <span class=\"pl-k\">end</span>\n  <span class=\"pl-c\"># ...</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p>The above will raise an error in development and test, but only report the error in production.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Make the order of read_multi and write_multi notifications for <code>Cache::Store#fetch_multi</code> operations match the order they are executed in.</p>\n<p><em>Adam Renberg Tamm</em></p>\n</li>\n<li>\n<p>Make return values of <code>Cache::Store#write</code> consistent.</p>\n<p>The return value was not specified before. Now it returns <code>true</code> on a successful write,<br>\n<code>nil</code> if there was an error talking to the cache backend, and <code>false</code> if the write failed<br>\nfor another reason (e.g. the key already exists and <code>unless_exist: true</code> was passed).</p>\n<p><em>Sander Verdonschot</em></p>\n</li>\n<li>\n<p>Fix logged cache keys not always matching actual key used by cache action.</p>\n<p><em>Hartley McGuire</em></p>\n</li>\n<li>\n<p>Improve error messages of <code>assert_changes</code> and <code>assert_no_changes</code>.</p>\n<p><code>assert_changes</code> error messages now display objects with <code>.inspect</code> to make it easier<br>\nto differentiate nil from empty strings, strings from symbols, etc.<br>\n<code>assert_no_changes</code> error messages now surface the actual value.</p>\n<p><em>pcreux</em></p>\n</li>\n<li>\n<p>Fix <code>#to_fs(:human_size)</code> to correctly work with negative numbers.</p>\n<p><em>Earlopain</em></p>\n</li>\n<li>\n<p>Fix <code>BroadcastLogger#dup</code> so that it duplicates the logger's <code>broadcasts</code>.</p>\n<p><em>Andrew Novoselac</em></p>\n</li>\n<li>\n<p>Fix issue where <code>bootstrap.rb</code> overwrites the <code>level</code> of a <code>BroadcastLogger</code>'s <code>broadcasts</code>.</p>\n<p><em>Andrew Novoselac</em></p>\n</li>\n<li>\n<p>Fix compatibility with the <code>semantic_logger</code> gem.</p>\n<p>The <code>semantic_logger</code> gem doesn't behave exactly like stdlib logger in that<br>\n<code>SemanticLogger#level</code> returns a Symbol while stdlib <code>Logger#level</code> returns an Integer.</p>\n<p>This caused the various <code>LogSubscriber</code> classes in Rails to break when assigned a<br>\n<code>SemanticLogger</code> instance.</p>\n<p><em>Jean Boussier</em>, <em>ojab</em></p>\n</li>\n<li>\n<p>Fix MemoryStore to prevent race conditions when incrementing or decrementing.</p>\n<p><em>Pierre Jambet</em></p>\n</li>\n<li>\n<p>Implement <code>HashWithIndifferentAccess#to_proc</code>.</p>\n<p>Previously, calling <code>#to_proc</code> on <code>HashWithIndifferentAccess</code> object used inherited <code>#to_proc</code><br>\nmethod from the <code>Hash</code> class, which was not able to access values using indifferent keys.</p>\n<p><em>fatkodima</em></p>\n</li>\n</ul>\n<h2>Active Model</h2>\n<ul>\n<li>\n<p>Fix a bug where type casting of string to <code>Time</code> and <code>DateTime</code> doesn't<br>\ncalculate minus minute value in TZ offset correctly.</p>\n<p><em>Akira Matsuda</em></p>\n</li>\n<li>\n<p>Port the <code>type_for_attribute</code> method to Active Model. Classes that include<br>\n<code>ActiveModel::Attributes</code> will now provide this method. This method behaves<br>\nthe same for Active Model as it does for Active Record.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class MyModel\n  include ActiveModel::Attributes\n\n  attribute :my_attribute, :integer\nend\n\nMyModel.type_for_attribute(:my_attribute) # =&gt; #&lt;ActiveModel::Type::Integer ...&gt;\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">MyModel</span>\n  <span class=\"pl-en\">include</span> <span class=\"pl-v\">ActiveModel</span>::<span class=\"pl-v\">Attributes</span>\n\n  <span class=\"pl-en\">attribute</span> <span class=\"pl-pds\">:my_attribute</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:integer</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-v\">MyModel</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">type_for_attribute</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:my_attribute</span><span class=\"pl-kos\">)</span> <span class=\"pl-c\"># =&gt; #&lt;ActiveModel::Type::Integer ...&gt;</span></pre></div>\n<p><em>Jonathan Hefner</em></p>\n</li>\n</ul>\n<h2>Active Record</h2>\n<ul>\n<li>\n<p>Handle commas in Sqlite3 default function definitions.</p>\n<p><em>Stephen Margheim</em></p>\n</li>\n<li>\n<p>Fixes <code>validates_associated</code> raising an exception when configured with a<br>\nsingular association and having <code>index_nested_attribute_errors</code> enabled.</p>\n<p><em>Martin Spickermann</em></p>\n</li>\n<li>\n<p>The constant <code>ActiveRecord::ImmutableRelation</code> has been deprecated because<br>\nwe want to reserve that name for a stronger sense of \"immutable relation\".<br>\nPlease use <code>ActiveRecord::UnmodifiableRelation</code> instead.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Add condensed <code>#inspect</code> for <code>ConnectionPool</code>, <code>AbstractAdapter</code>, and<br>\n<code>DatabaseConfig</code>.</p>\n<p><em>Hartley McGuire</em></p>\n</li>\n<li>\n<p>Fixed a memory performance issue in Active Record attribute methods definition.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Define the new Active Support notification event <code>start_transaction.active_record</code>.</p>\n<p>This event is fired when database transactions or savepoints start, and<br>\ncomplements <code>transaction.active_record</code>, which is emitted when they finish.</p>\n<p>The payload has the transaction (<code>:transaction</code>) and the connection (<code>:connection</code>).</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Fix an issue where the IDs reader method did not return expected results<br>\nfor preloaded associations in models using composite primary keys.</p>\n<p><em>Jay Ang</em></p>\n</li>\n<li>\n<p>The payload of <code>sql.active_record</code> Active Support notifications now has the current transaction in the <code>:transaction</code> key.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>The payload of <code>transaction.active_record</code> Active Support notifications now has the transaction the event is related to in the <code>:transaction</code> key.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Define <code>ActiveRecord::Transaction#uuid</code>, which returns a UUID for the database transaction. This may be helpful when tracing database activity. These UUIDs are generated only on demand.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Fix inference of association model on nested models with the same demodularized name.</p>\n<p>E.g. with the following setup:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Nested::Post &lt; ApplicationRecord\n  has_one :post, through: :other\nend\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Nested</span>::<span class=\"pl-v\">Post</span> &lt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-en\">has_one</span> <span class=\"pl-pds\">:post</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">through</span>: <span class=\"pl-pds\">:other</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p>Before, <code>#post</code> would infer the model as <code>Nested::Post</code>, but now it correctly infers <code>Post</code>.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>PostgreSQL <code>Cidr#change?</code> detects the address prefix change.</p>\n<p><em>Taketo Takashima</em></p>\n</li>\n<li>\n<p>Change <code>BatchEnumerator#destroy_all</code> to return the total number of affected rows.</p>\n<p>Previously, it always returned <code>nil</code>.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Support <code>touch_all</code> in batches.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Post.in_batches.touch_all\"><pre><span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">in_batches</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">touch_all</span></pre></div>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Add support for <code>:if_not_exists</code> and <code>:force</code> options to <code>create_schema</code>.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Fix <code>index_errors</code> having incorrect index in association validation errors.</p>\n<p><em>lulalala</em></p>\n</li>\n<li>\n<p>Add <code>index_errors: :nested_attributes_order</code> mode.</p>\n<p>This indexes the association validation errors based on the order received by nested attributes setter, and respects the <code>reject_if</code> configuration. This enables API to provide enough information to the frontend to map the validation errors back to their respective form fields.</p>\n<p><em>lulalala</em></p>\n</li>\n<li>\n<p>Add <code>Rails.application.config.active_record.postgresql_adapter_decode_dates</code> to opt out of decoding dates automatically with the postgresql adapter. Defaults to true.</p>\n<p><em>Joé Dupuis</em></p>\n</li>\n<li>\n<p>Association option <code>query_constraints</code> is deprecated in favor of <code>foreign_key</code>.</p>\n<p><em>Nikita Vasilevsky</em></p>\n</li>\n<li>\n<p>Add <code>ENV[\"SKIP_TEST_DATABASE_TRUNCATE\"]</code> flag to speed up multi-process test runs on large DBs when all tests run within default transaction.</p>\n<p>This cuts ~10s from the test run of HEY when run by 24 processes against the 178 tables, since ~4,000 table truncates can then be skipped.</p>\n<p><em>DHH</em></p>\n</li>\n<li>\n<p>Added support for recursive common table expressions.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Post.with_recursive(\n  post_and_replies: [\n    Post.where(id: 42),\n    Post.joins('JOIN post_and_replies ON posts.in_reply_to_id = post_and_replies.id'),\n  ]\n)\"><pre><span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with_recursive</span><span class=\"pl-kos\">(</span>\n  <span class=\"pl-pds\">post_and_replies</span>: <span class=\"pl-kos\">[</span>\n    <span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">where</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">id</span>: <span class=\"pl-c1\">42</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">joins</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'JOIN post_and_replies ON posts.in_reply_to_id = post_and_replies.id'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-kos\">]</span>\n<span class=\"pl-kos\">)</span></pre></div>\n<p>Generates the following SQL:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"WITH RECURSIVE &quot;post_and_replies&quot; AS (\n  (SELECT &quot;posts&quot;.* FROM &quot;posts&quot; WHERE &quot;posts&quot;.&quot;id&quot; = 42)\n  UNION ALL\n  (SELECT &quot;posts&quot;.* FROM &quot;posts&quot; JOIN post_and_replies ON posts.in_reply_to_id = post_and_replies.id)\n)\nSELECT &quot;posts&quot;.* FROM &quot;posts&quot;\"><pre>WITH RECURSIVE <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>post_and_replies<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">AS</span> (\n  (<span class=\"pl-k\">SELECT</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">WHERE</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">42</span>)\n  <span class=\"pl-k\">UNION ALL</span>\n  (<span class=\"pl-k\">SELECT</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">JOIN</span> post_and_replies <span class=\"pl-k\">ON</span> <span class=\"pl-c1\">posts</span>.<span class=\"pl-c1\">in_reply_to_id</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">post_and_replies</span>.<span class=\"pl-c1\">id</span>)\n)\n<span class=\"pl-k\">SELECT</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span></pre></div>\n<p><em>ClearlyClaire</em></p>\n</li>\n<li>\n<p><code>validate_constraint</code> can be called in a <code>change_table</code> block.</p>\n<p>ex:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"change_table :products do |t|\n  t.check_constraint &quot;price &gt; discounted_price&quot;, name: &quot;price_check&quot;, validate: false\n  t.validate_check_constraint &quot;price_check&quot;\nend\"><pre><span class=\"pl-en\">change_table</span> <span class=\"pl-pds\">:products</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">check_constraint</span> <span class=\"pl-s\">\"price &gt; discounted_price\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">name</span>: <span class=\"pl-s\">\"price_check\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">validate</span>: <span class=\"pl-c1\">false</span>\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">validate_check_constraint</span> <span class=\"pl-s\">\"price_check\"</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Cody Cutrer</em></p>\n</li>\n<li>\n<p><code>PostgreSQLAdapter</code> now decodes columns of type date to <code>Date</code> instead of string.</p>\n<p>Ex:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ActiveRecord::Base.connection\n     .select_value(&quot;select '2024-01-01'::date&quot;).class #=&gt; Date\"><pre><span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n     <span class=\"pl-kos\">.</span><span class=\"pl-en\">select_value</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"select '2024-01-01'::date\"</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">class</span> <span class=\"pl-c\">#=&gt; Date</span></pre></div>\n<p><em>Joé Dupuis</em></p>\n</li>\n<li>\n<p>Strict loading using <code>:n_plus_one_only</code> does not eagerly load child associations.</p>\n<p>With this change, child associations are no longer eagerly loaded, to<br>\nmatch intended behavior and to prevent non-deterministic order issues caused<br>\nby calling methods like <code>first</code> or <code>last</code>. As <code>first</code> and <code>last</code> don't cause<br>\nan N+1 by themselves, calling child associations will no longer raise.<br>\nFixes <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1924388730\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49473\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49473/hovercard\" href=\"https://github.com/rails/rails/issues/49473\">#49473</a>.</p>\n<p>Before:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"person = Person.find(1)\nperson.strict_loading!(mode: :n_plus_one_only)\nperson.posts.first\n# SELECT * FROM posts WHERE person_id = 1; -- non-deterministic order\nperson.posts.first.firm # raises ActiveRecord::StrictLoadingViolationError\"><pre><span class=\"pl-s1\">person</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">find</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">strict_loading!</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">mode</span>: <span class=\"pl-pds\">:n_plus_one_only</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">posts</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span>\n<span class=\"pl-c\"># SELECT * FROM posts WHERE person_id = 1; -- non-deterministic order</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">posts</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">firm</span> <span class=\"pl-c\"># raises ActiveRecord::StrictLoadingViolationError</span></pre></div>\n<p>After:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"person = Person.find(1)\nperson.strict_loading!(mode: :n_plus_one_only)\nperson.posts.first # this is 1+1, not N+1\n# SELECT * FROM posts WHERE person_id = 1 ORDER BY id LIMIT 1;\nperson.posts.first.firm # no longer raises\"><pre><span class=\"pl-s1\">person</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">find</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">strict_loading!</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">mode</span>: <span class=\"pl-pds\">:n_plus_one_only</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">posts</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span> <span class=\"pl-c\"># this is 1+1, not N+1</span>\n<span class=\"pl-c\"># SELECT * FROM posts WHERE person_id = 1 ORDER BY id LIMIT 1;</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">posts</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">firm</span> <span class=\"pl-c\"># no longer raises</span></pre></div>\n<p><em>Reid Lynch</em></p>\n</li>\n<li>\n<p>Allow <code>Sqlite3Adapter</code> to use <code>sqlite3</code> gem version <code>2.x</code>.</p>\n<p><em>Mike Dalessio</em></p>\n</li>\n<li>\n<p>Allow <code>ActiveRecord::Base#pluck</code> to accept hash values.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"# Before\nPost.joins(:comments).pluck(&quot;posts.id&quot;, &quot;comments.id&quot;, &quot;comments.body&quot;)\n\n# After\nPost.joins(:comments).pluck(posts: [:id], comments: [:id, :body])\"><pre><span class=\"pl-c\"># Before</span>\n<span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">joins</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:comments</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">pluck</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"posts.id\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"comments.id\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"comments.body\"</span><span class=\"pl-kos\">)</span>\n\n<span class=\"pl-c\"># After</span>\n<span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">joins</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:comments</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">pluck</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">posts</span>: <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">comments</span>: <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:body</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span></pre></div>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Raise an <code>ActiveRecord::ActiveRecordError</code> error when the MySQL database returns an invalid version string.</p>\n<p><em>Kevin McPhillips</em></p>\n</li>\n<li>\n<p><code>ActiveRecord::Base.transaction</code> now yields an <code>ActiveRecord::Transaction</code> object.</p>\n<p>This allows to register callbacks on it.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Article.transaction do |transaction|\n  article.update(published: true)\n  transaction.after_commit do\n    PublishNotificationMailer.with(article: article).deliver_later\n  end\nend\"><pre><span class=\"pl-v\">Article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">transaction</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">transaction</span>|\n  <span class=\"pl-en\">article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">update</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">published</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-s1\">transaction</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">after_commit</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-v\">PublishNotificationMailer</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">article</span>: <span class=\"pl-en\">article</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">deliver_later</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add <code>ActiveRecord::Base.current_transaction</code>.</p>\n<p>Returns the current transaction, to allow registering callbacks on it.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Article.current_transaction.after_commit do\n  PublishNotificationMailer.with(article: article).deliver_later\nend\"><pre><span class=\"pl-v\">Article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">current_transaction</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">after_commit</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-v\">PublishNotificationMailer</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">article</span>: <span class=\"pl-en\">article</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">deliver_later</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add <code>ActiveRecord.after_all_transactions_commit</code> callback.</p>\n<p>Useful for code that may run either inside or outside a transaction and needs<br>\nto perform work after the state changes have been properly persisted.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"def publish_article(article)\n  article.update(published: true)\n  ActiveRecord.after_all_transactions_commit do\n    PublishNotificationMailer.with(article: article).deliver_later\n  end\nend\"><pre><span class=\"pl-k\">def</span> <span class=\"pl-en\">publish_article</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">article</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-s1\">article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">update</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">published</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-v\">ActiveRecord</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">after_all_transactions_commit</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-v\">PublishNotificationMailer</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">article</span>: <span class=\"pl-s1\">article</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">deliver_later</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p>In the above example, the block is either executed immediately if called outside<br>\nof a transaction, or called after the open transaction is committed.</p>\n<p>If the transaction is rolled back, the block isn't called.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add the ability to ignore counter cache columns until they are backfilled.</p>\n<p>Starting to use counter caches on existing large tables can be troublesome, because the column<br>\nvalues must be backfilled separately of the column addition (to not lock the table for too long)<br>\nand before the use of <code>:counter_cache</code> (otherwise methods like <code>size</code>/<code>any?</code>/etc, which use<br>\ncounter caches internally, can produce incorrect results). People usually use database triggers<br>\nor callbacks on child associations while backfilling before introducing a counter cache<br>\nconfiguration to the association.</p>\n<p>Now, to safely backfill the column, while keeping the column updated with child records added/removed, use:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Comment &lt; ApplicationRecord\n  belongs_to :post, counter_cache: { active: false }\nend\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Comment</span> &lt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-en\">belongs_to</span> <span class=\"pl-pds\">:post</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">counter_cache</span>: <span class=\"pl-kos\">{</span> <span class=\"pl-pds\">active</span>: <span class=\"pl-c1\">false</span> <span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p>While the counter cache is not \"active\", the methods like <code>size</code>/<code>any?</code>/etc will not use it,<br>\nbut get the results directly from the database. After the counter cache column is backfilled, simply<br>\nremove the <code>{ active: false }</code> part from the counter cache definition, and it will now be used by the<br>\nmentioned methods.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Retry known idempotent SELECT queries on connection-related exceptions.</p>\n<p>SELECT queries we construct by walking the Arel tree and / or with known model attributes<br>\nare idempotent and can safely be retried in the case of a connection error. Previously,<br>\nadapters such as <code>TrilogyAdapter</code> would raise <code>ActiveRecord::ConnectionFailed: Trilogy::EOFError</code><br>\nwhen encountering a connection error mid-request.</p>\n<p><em>Adrianna Chang</em></p>\n</li>\n<li>\n<p>Allow association's <code>foreign_key</code> to be composite.</p>\n<p><code>query_constraints</code> option was the only way to configure a composite foreign key by passing an <code>Array</code>.<br>\nNow it's possible to pass an Array value as <code>foreign_key</code> to achieve the same behavior of an association.</p>\n<p><em>Nikita Vasilevsky</em></p>\n</li>\n<li>\n<p>Allow association's <code>primary_key</code> to be composite.</p>\n<p>Association's <code>primary_key</code> can be composite when derived from associated model <code>primary_key</code> or <code>query_constraints</code>.<br>\nNow it's possible to explicitly set it as composite on the association.</p>\n<p><em>Nikita Vasilevsky</em></p>\n</li>\n<li>\n<p>Add <code>config.active_record.permanent_connection_checkout</code> setting.</p>\n<p>Controls whether <code>ActiveRecord::Base.connection</code> raises an error, emits a deprecation warning, or neither.</p>\n<p><code>ActiveRecord::Base.connection</code> checkouts a database connection from the pool and keeps it leased until the end of<br>\nthe request or job. This behavior can be undesirable in environments that use many more threads or fibers than there<br>\nis available connections.</p>\n<p>This configuration can be used to track down and eliminate code that calls <code>ActiveRecord::Base.connection</code> and<br>\nmigrate it to use <code>ActiveRecord::Base.with_connection</code> instead.</p>\n<p>The default behavior remains unchanged, and there is currently no plans to change the default.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add dirties option to uncached.</p>\n<p>This adds a <code>dirties</code> option to <code>ActiveRecord::Base.uncached</code> and<br>\n<code>ActiveRecord::ConnectionAdapters::ConnectionPool#uncached</code>.</p>\n<p>When set to <code>true</code> (the default), writes will clear all query caches belonging to the current thread.<br>\nWhen set to <code>false</code>, writes to the affected connection pool will not clear any query cache.</p>\n<p>This is needed by Solid Cache so that cache writes do not clear query caches.</p>\n<p><em>Donal McBreen</em></p>\n</li>\n<li>\n<p>Deprecate <code>ActiveRecord::Base.connection</code> in favor of <code>.lease_connection</code>.</p>\n<p>The method has been renamed as <code>lease_connection</code> to better reflect that the returned<br>\nconnection will be held for the duration of the request or job.</p>\n<p>This deprecation is a soft deprecation, no warnings will be issued and there is no<br>\ncurrent plan to remove the method.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Deprecate <code>ActiveRecord::ConnectionAdapters::ConnectionPool#connection</code>.</p>\n<p>The method has been renamed as <code>lease_connection</code> to better reflect that the returned<br>\nconnection will be held for the duration of the request or job.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Expose a generic fixture accessor for fixture names that may conflict with Minitest.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"assert_equal &quot;Ruby on Rails&quot;, web_sites(:rubyonrails).name\nassert_equal &quot;Ruby on Rails&quot;, fixture(:web_sites, :rubyonrails).name\"><pre><span class=\"pl-en\">assert_equal</span> <span class=\"pl-s\">\"Ruby on Rails\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-en\">web_sites</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:rubyonrails</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">name</span>\n<span class=\"pl-en\">assert_equal</span> <span class=\"pl-s\">\"Ruby on Rails\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-en\">fixture</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:web_sites</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:rubyonrails</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">name</span></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Using <code>Model.query_constraints</code> with a single non-primary-key column used to raise as expected, but with an<br>\nincorrect error message.</p>\n<p>This has been fixed to raise with a more appropriate error message.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>Fix <code>has_one</code> association autosave setting the foreign key attribute when it is unchanged.</p>\n<p>This behavior is also inconsistent with autosaving <code>belongs_to</code> and can have unintended side effects like raising<br>\nan <code>ActiveRecord::ReadonlyAttributeError</code> when the foreign key attribute is marked as read-only.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>Remove deprecated behavior that would rollback a transaction block when exited using <code>return</code>, <code>break</code> or <code>throw</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Deprecate <code>Rails.application.config.active_record.commit_transaction_on_non_local_return</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to pass <code>rewhere</code> to <code>ActiveRecord::Relation#merge</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to pass <code>deferrable: true</code> to <code>add_foreign_key</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to quote <code>ActiveSupport::Duration</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>#quote_bound_value</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::ConnectionAdapters::ConnectionPool#connection_klass</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to apply <code>#connection_pool_list</code>, <code>#active_connections?</code>, <code>#clear_active_connections!</code>,<br>\n<code>#clear_reloadable_connections!</code>, <code>#clear_all_connections!</code> and <code>#flush_idle_connections!</code> to the connections pools<br>\nfor the current role when the <code>role</code> argument isn't provided.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>#all_connection_pools</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::ConnectionAdapters::SchemaCache#data_sources</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::ConnectionAdapters::SchemaCache.load_from</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>#all_foreign_keys_valid?</code> from database adapters.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to passing coder and class as second argument to <code>serialize</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to <code>ActiveRecord::Base#read_attribute(:id)</code> to return the custom primary key value.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>TestFixtures.fixture_path</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated behavior to support referring to a singular association by its plural name.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Deprecate <code>Rails.application.config.active_record.allow_deprecated_singular_associations_name</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to passing <code>SchemaMigration</code> and <code>InternalMetadata</code> classes as arguments to<br>\n<code>ActiveRecord::MigrationContext</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Migration.check_pending!</code> method.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::LogSubscriber.runtime</code> method.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::LogSubscriber.runtime=</code> method.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::LogSubscriber.reset_runtime</code> method.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to define <code>explain</code> in the connection adapter with 2 arguments.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::ActiveJobRequiredError</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Base.clear_active_connections!</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Base.clear_reloadable_connections!</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Base.clear_all_connections!</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Base.flush_idle_connections!</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>name</code> argument from <code>ActiveRecord::Base.remove_connection</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to call <code>alias_attribute</code> with non-existent attribute names.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>Rails.application.config.active_record.suppress_multiple_database_warning</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Add <code>ActiveRecord::Encryption::MessagePackMessageSerializer</code>.</p>\n<p>Serialize data to the MessagePack format, for efficient storage in binary columns.</p>\n<p>The binary encoding requires around 30% less space than the base64 encoding<br>\nused by the default serializer.</p>\n<p><em>Donal McBreen</em></p>\n</li>\n<li>\n<p>Add support for encrypting binary columns.</p>\n<p>Ensure encryption and decryption pass <code>Type::Binary::Data</code> around for binary data.</p>\n<p>Previously encrypting binary columns with the <code>ActiveRecord::Encryption::MessageSerializer</code><br>\nincidentally worked for MySQL and SQLite, but not PostgreSQL.</p>\n<p><em>Donal McBreen</em></p>\n</li>\n<li>\n<p>Deprecated <code>ENV[\"SCHEMA_CACHE\"]</code> in favor of <code>schema_cache_path</code> in the database configuration.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Add <code>ActiveRecord::Base.with_connection</code> as a shortcut for leasing a connection for a short duration.</p>\n<p>The leased connection is yielded, and for the duration of the block, any call to <code>ActiveRecord::Base.connection</code><br>\nwill yield that same connection.</p>\n<p>This is useful to perform a few database operations without causing a connection to be leased for the<br>\nentire duration of the request or job.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Deprecate <code>config.active_record.warn_on_records_fetched_greater_than</code> now that <code>sql.active_record</code><br>\nnotification includes <code>:row_count</code> field.</p>\n<p><em>Jason Nochlin</em></p>\n</li>\n<li>\n<p>The fix ensures that the association is joined using the appropriate join type<br>\n(either inner join or left outer join) based on the existing joins in the scope.</p>\n<p>This prevents unintentional overrides of existing join types and ensures consistency in the generated SQL queries.</p>\n<p>Example:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"# `associated` will use `LEFT JOIN` instead of using `JOIN`\nPost.left_joins(:author).where.associated(:author)\"><pre><span class=\"pl-c\"># `associated` will use `LEFT JOIN` instead of using `JOIN`</span>\n<span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">left_joins</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:author</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">where</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">associated</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:author</span><span class=\"pl-kos\">)</span></pre></div>\n<p><em>Saleh Alhaddad</em></p>\n</li>\n<li>\n<p>Fix an issue where <code>ActiveRecord::Encryption</code> configurations are not ready before the loading<br>\nof Active Record models, when an application is eager loaded. As a result, encrypted attributes<br>\ncould be misconfigured in some cases.</p>\n<p><em>Maxime Réty</em></p>\n</li>\n<li>\n<p>Deprecate defining an <code>enum</code> with keyword arguments.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Function &gt; ApplicationRecord\n  # BAD\n  enum color: [:red, :blue],\n       type: [:instance, :class]\n\n  # GOOD\n  enum :color, [:red, :blue]\n  enum :type, [:instance, :class]\nend\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Function</span> &gt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-c\"># BAD</span>\n  <span class=\"pl-en\">enum</span> <span class=\"pl-pds\">color</span>: <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:red</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:blue</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span>\n       <span class=\"pl-pds\">type</span>: <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:instance</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:class</span><span class=\"pl-kos\">]</span>\n\n  <span class=\"pl-c\"># GOOD</span>\n  <span class=\"pl-en\">enum</span> <span class=\"pl-pds\">:color</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:red</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:blue</span><span class=\"pl-kos\">]</span>\n  <span class=\"pl-en\">enum</span> <span class=\"pl-pds\">:type</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:instance</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:class</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Hartley McGuire</em></p>\n</li>\n<li>\n<p>Add <code>config.active_record.validate_migration_timestamps</code> option for validating migration timestamps.</p>\n<p>When set, validates that the timestamp prefix for a migration is no more than a day ahead of<br>\nthe timestamp associated with the current time. This is designed to prevent migrations prefixes<br>\nfrom being hand-edited to future timestamps, which impacts migration generation and other<br>\nmigration commands.</p>\n<p><em>Adrianna Chang</em></p>\n</li>\n<li>\n<p>Properly synchronize <code>Mysql2Adapter#active?</code> and <code>TrilogyAdapter#active?</code>.</p>\n<p>As well as <code>disconnect!</code> and <code>verify!</code>.</p>\n<p>This generally isn't a big problem as connections must not be shared between<br>\nthreads, but is required when running transactional tests or system tests<br>\nand could lead to a SEGV.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Support <code>:source_location</code> tag option for query log tags.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"config.active_record.query_log_tags &lt;&lt; :source_location\"><pre><span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">active_record</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">query_log_tags</span> &lt;&lt; <span class=\"pl-pds\">:source_location</span></pre></div>\n<p>Calculating the caller location is a costly operation and should be used primarily in development<br>\n(note, there is also a <code>config.active_record.verbose_query_logs</code> that serves the same purpose)<br>\nor occasionally on production for debugging purposes.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Add an option to <code>ActiveRecord::Encryption::Encryptor</code> to disable compression.</p>\n<p>Allow compression to be disabled by setting <code>compress: false</code></p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"  class User\n    encrypts :name, encryptor: ActiveRecord::Encryption::Encryptor.new(compress: false)\n  end\"><pre>  <span class=\"pl-k\">class</span> <span class=\"pl-v\">User</span>\n    <span class=\"pl-en\">encrypts</span> <span class=\"pl-pds\">:name</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">encryptor</span>: <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Encryption</span>::<span class=\"pl-v\">Encryptor</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">compress</span>: <span class=\"pl-c1\">false</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span></pre></div>\n<p><em>Donal McBreen</em></p>\n</li>\n<li>\n<p>Deprecate passing strings to <code>ActiveRecord::Tasks::DatabaseTasks.cache_dump_filename</code>.</p>\n<p>A <code>ActiveRecord::DatabaseConfigurations::DatabaseConfig</code> object should be passed instead.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Add <code>row_count</code> field to <code>sql.active_record</code> notification.</p>\n<p>This field returns the amount of rows returned by the query that emitted the notification.</p>\n<p>This metric is useful in cases where one wants to detect queries with big result sets.</p>\n<p><em>Marvin Bitterlich</em></p>\n</li>\n<li>\n<p>Consistently raise an <code>ArgumentError</code> when passing an invalid argument to a nested attributes association writer.</p>\n<p>Previously, this would only raise on collection associations and produce a generic error on singular associations.</p>\n<p>Now, it will raise on both collection and singular associations.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>Fix single quote escapes on default generated MySQL columns.</p>\n<p>MySQL 5.7.5+ supports generated columns, which can be used to create a column that is computed from an expression.</p>\n<p>Previously, the schema dump would output a string with double escapes for generated columns with single quotes in the default expression.</p>\n<p>This would result in issues when importing the schema on a fresh instance of a MySQL database.</p>\n<p>Now, the string will not be escaped and will be valid Ruby upon importing of the schema.</p>\n<p><em>Yash Kapadia</em></p>\n</li>\n<li>\n<p>Fix Migrations with versions older than 7.1 validating options given to<br>\n<code>add_reference</code> and <code>t.references</code>.</p>\n<p><em>Hartley McGuire</em></p>\n</li>\n<li>\n<p>Add <code>&lt;role&gt;_types</code> class method to <code>ActiveRecord::DelegatedType</code> so that the delegated types can be introspected.</p>\n<p><em>JP Rosevear</em></p>\n</li>\n<li>\n<p>Make <code>schema_dump</code>, <code>query_cache</code>, <code>replica</code> and <code>database_tasks</code> configurable via <code>DATABASE_URL</code>.</p>\n<p>This wouldn't always work previously because boolean values would be interpreted as strings.</p>\n<p>e.g. <code>DATABASE_URL=postgres://localhost/foo?schema_dump=false</code> now properly disable dumping the schema<br>\ncache.</p>\n<p><em>Mike Coutermarsh</em>, <em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Introduce <code>ActiveRecord::Transactions::ClassMethods#set_callback</code>.</p>\n<p>It is identical to <code>ActiveSupport::Callbacks::ClassMethods#set_callback</code><br>\nbut with support for <code>after_commit</code> and <code>after_rollback</code> callback options.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>Make <code>ActiveRecord::Encryption::Encryptor</code> agnostic of the serialization format used for encrypted data.</p>\n<p>Previously, the encryptor instance only allowed an encrypted value serialized as a <code>String</code> to be passed to the message serializer.</p>\n<p>Now, the encryptor lets the configured <code>message_serializer</code> decide which types of serialized encrypted values are supported. A custom serialiser is therefore allowed to serialize <code>ActiveRecord::Encryption::Message</code> objects using a type other than <code>String</code>.</p>\n<p>The default <code>ActiveRecord::Encryption::MessageSerializer</code> already ensures that only <code>String</code> objects are passed for deserialization.</p>\n<p><em>Maxime Réty</em></p>\n</li>\n<li>\n<p>Fix <code>encrypted_attribute?</code> to take into account context properties passed to <code>encrypts</code>.</p>\n<p><em>Maxime Réty</em></p>\n</li>\n<li>\n<p>The object returned by <code>explain</code> now responds to <code>pluck</code>, <code>first</code>,<br>\n<code>last</code>, <code>average</code>, <code>count</code>, <code>maximum</code>, <code>minimum</code>, and <code>sum</code>. Those<br>\nnew methods run <code>EXPLAIN</code> on the corresponding queries:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"User.all.explain.count\n# EXPLAIN SELECT COUNT(*) FROM `users`\n# ...\n\nUser.all.explain.maximum(:id)\n# EXPLAIN SELECT MAX(`users`.`id`) FROM `users`\n# ...\"><pre><span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">all</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">explain</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">count</span>\n<span class=\"pl-c\"># EXPLAIN SELECT COUNT(*) FROM `users`</span>\n<span class=\"pl-c\"># ...</span>\n\n<span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">all</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">explain</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">maximum</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:id</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c\"># EXPLAIN SELECT MAX(`users`.`id`) FROM `users`</span>\n<span class=\"pl-c\"># ...</span></pre></div>\n<p><em>Petrik de Heus</em></p>\n</li>\n<li>\n<p>Fixes an issue where <code>validates_associated</code> <code>:on</code>  option wasn't respected<br>\nwhen validating associated records.</p>\n<p><em>Austen Madden</em>, <em>Alex Ghiculescu</em>, <em>Rafał Brize</em></p>\n</li>\n<li>\n<p>Allow overriding SQLite defaults from <code>database.yml</code>.</p>\n<p>Any PRAGMA configuration set under the <code>pragmas</code> key in the configuration<br>\nfile takes precedence over Rails' defaults, and additional PRAGMAs can be<br>\nset as well.</p>\n<div class=\"highlight highlight-source-yaml notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"database: storage/development.sqlite3\ntimeout: 5000\npragmas:\n  journal_mode: off\n  temp_store: memory\"><pre><span class=\"pl-ent\">database</span>: <span class=\"pl-s\">storage/development.sqlite3</span>\n<span class=\"pl-ent\">timeout</span>: <span class=\"pl-c1\">5000</span>\n<span class=\"pl-ent\">pragmas</span>:\n  <span class=\"pl-ent\">journal_mode</span>: <span class=\"pl-s\">off</span>\n  <span class=\"pl-ent\">temp_store</span>: <span class=\"pl-s\">memory</span></pre></div>\n<p><em>Stephen Margheim</em></p>\n</li>\n<li>\n<p>Remove warning message when running SQLite in production, but leave it unconfigured.</p>\n<p>There are valid use cases for running SQLite in production. However, it must be done<br>\nwith care, so instead of a warning most users won't see anyway, it's preferable to<br>\nleave the configuration commented out to force them to think about having the database<br>\non a persistent volume etc.</p>\n<p><em>Jacopo Beschi</em>, <em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add support for generated columns to the SQLite3 adapter.</p>\n<p>Generated columns (both stored and dynamic) are supported since version 3.31.0 of SQLite.<br>\nThis adds support for those to the SQLite3 adapter.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"create_table :users do |t|\n  t.string :name\n  t.virtual :name_upper, type: :string, as: 'UPPER(name)'\n  t.virtual :name_lower, type: :string, as: 'LOWER(name)', stored: true\nend\"><pre><span class=\"pl-en\">create_table</span> <span class=\"pl-pds\">:users</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">string</span> <span class=\"pl-pds\">:name</span>\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">virtual</span> <span class=\"pl-pds\">:name_upper</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">type</span>: <span class=\"pl-pds\">:string</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">as</span>: <span class=\"pl-s\">'UPPER(name)'</span>\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">virtual</span> <span class=\"pl-pds\">:name_lower</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">type</span>: <span class=\"pl-pds\">:string</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">as</span>: <span class=\"pl-s\">'LOWER(name)'</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">stored</span>: <span class=\"pl-c1\">true</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Stephen Margheim</em></p>\n</li>\n<li>\n<p>TrilogyAdapter: ignore <code>host</code> if <code>socket</code> parameter is set.</p>\n<p>This allows to configure a connection on a UNIX socket via <code>DATABASE_URL</code>:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"DATABASE_URL=trilogy://does-not-matter/my_db_production?socket=/var/run/mysql.sock\"><pre class=\"notranslate\"><code>DATABASE_URL=trilogy://does-not-matter/my_db_production?socket=/var/run/mysql.sock\n</code></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Make <code>assert_queries_count</code>, <code>assert_no_queries</code>, <code>assert_queries_match</code>, and<br>\n<code>assert_no_queries_match</code> assertions public.</p>\n<p>To assert the expected number of queries are made, Rails internally uses <code>assert_queries_count</code> and<br>\n<code>assert_no_queries</code>. To assert that specific SQL queries are made, <code>assert_queries_match</code> and<br>\n<code>assert_no_queries_match</code> are used. These assertions can now be used in applications as well.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class ArticleTest &lt; ActiveSupport::TestCase\n  test &quot;queries ar...","reactions":{"url":"https://api.github.com/repos/INexizI/asmn_bot/issues/135/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/INexizI/asmn_bot/issues/135/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"INexizI","id":39536903,"node_id":"MDQ6VXNlcjM5NTM2OTAz","avatar_url":"https://avatars.githubusercontent.com/u/39536903?v=4","gravatar_id":"","url":"https://api.github.com/users/INexizI","html_url":"https://github.com/INexizI","followers_url":"https://api.github.com/users/INexizI/followers","following_url":"https://api.github.com/users/INexizI/following{/other_user}","gists_url":"https://api.github.com/users/INexizI/gists{/gist_id}","starred_url":"https://api.github.com/users/INexizI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/INexizI/subscriptions","organizations_url":"https://api.github.com/users/INexizI/orgs","repos_url":"https://api.github.com/users/INexizI/repos","events_url":"https://api.github.com/users/INexizI/events{/privacy}","received_events_url":"https://api.github.com/users/INexizI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-13T10:24:29Z","updated_at":"2024-09-13T10:24:29Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/INexizI/KR-DB/issues/397","repository_url":"https://api.github.com/repos/INexizI/KR-DB","labels_url":"https://api.github.com/repos/INexizI/KR-DB/issues/397/labels{/name}","comments_url":"https://api.github.com/repos/INexizI/KR-DB/issues/397/comments","events_url":"https://api.github.com/repos/INexizI/KR-DB/issues/397/events","html_url":"https://github.com/INexizI/KR-DB/pull/397","id":2524483657,"node_id":"PR_kwDOFXHYDM57annx","number":397,"title":"[Snyk] Upgrade: , , ","user":{"login":"INexizI","id":39536903,"node_id":"MDQ6VXNlcjM5NTM2OTAz","avatar_url":"https://avatars.githubusercontent.com/u/39536903?v=4","gravatar_id":"","url":"https://api.github.com/users/INexizI","html_url":"https://github.com/INexizI","followers_url":"https://api.github.com/users/INexizI/followers","following_url":"https://api.github.com/users/INexizI/following{/other_user}","gists_url":"https://api.github.com/users/INexizI/gists{/gist_id}","starred_url":"https://api.github.com/users/INexizI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/INexizI/subscriptions","organizations_url":"https://api.github.com/users/INexizI/orgs","repos_url":"https://api.github.com/users/INexizI/repos","events_url":"https://api.github.com/users/INexizI/events{/privacy}","received_events_url":"https://api.github.com/users/INexizI/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"INexizI","id":39536903,"node_id":"MDQ6VXNlcjM5NTM2OTAz","avatar_url":"https://avatars.githubusercontent.com/u/39536903?v=4","gravatar_id":"","url":"https://api.github.com/users/INexizI","html_url":"https://github.com/INexizI","followers_url":"https://api.github.com/users/INexizI/followers","following_url":"https://api.github.com/users/INexizI/following{/other_user}","gists_url":"https://api.github.com/users/INexizI/gists{/gist_id}","starred_url":"https://api.github.com/users/INexizI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/INexizI/subscriptions","organizations_url":"https://api.github.com/users/INexizI/orgs","repos_url":"https://api.github.com/users/INexizI/repos","events_url":"https://api.github.com/users/INexizI/events{/privacy}","received_events_url":"https://api.github.com/users/INexizI/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"INexizI","id":39536903,"node_id":"MDQ6VXNlcjM5NTM2OTAz","avatar_url":"https://avatars.githubusercontent.com/u/39536903?v=4","gravatar_id":"","url":"https://api.github.com/users/INexizI","html_url":"https://github.com/INexizI","followers_url":"https://api.github.com/users/INexizI/followers","following_url":"https://api.github.com/users/INexizI/following{/other_user}","gists_url":"https://api.github.com/users/INexizI/gists{/gist_id}","starred_url":"https://api.github.com/users/INexizI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/INexizI/subscriptions","organizations_url":"https://api.github.com/users/INexizI/orgs","repos_url":"https://api.github.com/users/INexizI/repos","events_url":"https://api.github.com/users/INexizI/events{/privacy}","received_events_url":"https://api.github.com/users/INexizI/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":0,"created_at":"2024-09-13T10:24:28Z","updated_at":"2024-09-15T22:16:10Z","closed_at":"2024-09-15T22:16:07Z","author_association":"OWNER","active_lock_reason":null,"draft":false,"repository":{"id":359782412,"node_id":"MDEwOlJlcG9zaXRvcnkzNTk3ODI0MTI=","name":"KR-DB","full_name":"INexizI/KR-DB","private":false,"owner":{"login":"INexizI","id":39536903,"node_id":"MDQ6VXNlcjM5NTM2OTAz","avatar_url":"https://avatars.githubusercontent.com/u/39536903?v=4","gravatar_id":"","url":"https://api.github.com/users/INexizI","html_url":"https://github.com/INexizI","followers_url":"https://api.github.com/users/INexizI/followers","following_url":"https://api.github.com/users/INexizI/following{/other_user}","gists_url":"https://api.github.com/users/INexizI/gists{/gist_id}","starred_url":"https://api.github.com/users/INexizI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/INexizI/subscriptions","organizations_url":"https://api.github.com/users/INexizI/orgs","repos_url":"https://api.github.com/users/INexizI/repos","events_url":"https://api.github.com/users/INexizI/events{/privacy}","received_events_url":"https://api.github.com/users/INexizI/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/INexizI/KR-DB","description":"Extended version KR-Calc + Heroes DB","fork":false,"url":"https://api.github.com/repos/INexizI/KR-DB","forks_url":"https://api.github.com/repos/INexizI/KR-DB/forks","keys_url":"https://api.github.com/repos/INexizI/KR-DB/keys{/key_id}","collaborators_url":"https://api.github.com/repos/INexizI/KR-DB/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/INexizI/KR-DB/teams","hooks_url":"https://api.github.com/repos/INexizI/KR-DB/hooks","issue_events_url":"https://api.github.com/repos/INexizI/KR-DB/issues/events{/number}","events_url":"https://api.github.com/repos/INexizI/KR-DB/events","assignees_url":"https://api.github.com/repos/INexizI/KR-DB/assignees{/user}","branches_url":"https://api.github.com/repos/INexizI/KR-DB/branches{/branch}","tags_url":"https://api.github.com/repos/INexizI/KR-DB/tags","blobs_url":"https://api.github.com/repos/INexizI/KR-DB/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/INexizI/KR-DB/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/INexizI/KR-DB/git/refs{/sha}","trees_url":"https://api.github.com/repos/INexizI/KR-DB/git/trees{/sha}","statuses_url":"https://api.github.com/repos/INexizI/KR-DB/statuses/{sha}","languages_url":"https://api.github.com/repos/INexizI/KR-DB/languages","stargazers_url":"https://api.github.com/repos/INexizI/KR-DB/stargazers","contributors_url":"https://api.github.com/repos/INexizI/KR-DB/contributors","subscribers_url":"https://api.github.com/repos/INexizI/KR-DB/subscribers","subscription_url":"https://api.github.com/repos/INexizI/KR-DB/subscription","commits_url":"https://api.github.com/repos/INexizI/KR-DB/commits{/sha}","git_commits_url":"https://api.github.com/repos/INexizI/KR-DB/git/commits{/sha}","comments_url":"https://api.github.com/repos/INexizI/KR-DB/comments{/number}","issue_comment_url":"https://api.github.com/repos/INexizI/KR-DB/issues/comments{/number}","contents_url":"https://api.github.com/repos/INexizI/KR-DB/contents/{+path}","compare_url":"https://api.github.com/repos/INexizI/KR-DB/compare/{base}...{head}","merges_url":"https://api.github.com/repos/INexizI/KR-DB/merges","archive_url":"https://api.github.com/repos/INexizI/KR-DB/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/INexizI/KR-DB/downloads","issues_url":"https://api.github.com/repos/INexizI/KR-DB/issues{/number}","pulls_url":"https://api.github.com/repos/INexizI/KR-DB/pulls{/number}","milestones_url":"https://api.github.com/repos/INexizI/KR-DB/milestones{/number}","notifications_url":"https://api.github.com/repos/INexizI/KR-DB/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/INexizI/KR-DB/labels{/name}","releases_url":"https://api.github.com/repos/INexizI/KR-DB/releases{/id}","deployments_url":"https://api.github.com/repos/INexizI/KR-DB/deployments","created_at":"2021-04-20T10:56:43Z","updated_at":"2025-11-06T14:30:34Z","pushed_at":"2025-11-10T05:04:43Z","git_url":"git://github.com/INexizI/KR-DB.git","ssh_url":"git@github.com:INexizI/KR-DB.git","clone_url":"https://github.com/INexizI/KR-DB.git","svn_url":"https://github.com/INexizI/KR-DB","homepage":"","size":987672,"stargazers_count":0,"watchers_count":0,"language":"Slim","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":10,"license":null,"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":10,"watchers":0,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/INexizI/KR-DB/pulls/397","html_url":"https://github.com/INexizI/KR-DB/pull/397","diff_url":"https://github.com/INexizI/KR-DB/pull/397.diff","patch_url":"https://github.com/INexizI/KR-DB/pull/397.patch","merged_at":"2024-09-15T22:16:07Z"},"body":"![snyk-top-banner](https://github.com/andygongea/OWASP-Benchmark/assets/818805/c518c423-16fe-447e-b67f-ad5a49b5d123)\n\n\n<h3>Snyk has created this PR to upgrade multiple dependencies.</h3>\n👯‍♂ The following dependencies are linked and will therefore be updated together.\n</br></br>\n:information_source: Keep your dependencies up-to-date. This makes it easier to fix existing vulnerabilities and to more quickly identify and fix newly disclosed vulnerabilities when they affect your project.\n</br></br>\n\n\n| Name | Versions | Released on |\n| :--- | :------- | :---------- |\n\n**@rails/actioncable**</br>from 7.2.0 to 7.2.100 | **1 version** ahead of your current version | **22 days ago**</br>on 2024-08-22\n**@rails/activestorage**</br>from 7.2.0 to 7.2.100 | **1 version** ahead of your current version | **22 days ago**</br>on 2024-08-22\n**@rails/ujs**</br>from 7.1.3 to 7.1.400 | **1 version** ahead of your current version | **22 days ago**</br>on 2024-08-22\n\n\n\n\n<details>\n<summary><b>Release notes</b></summary>\n<br/>\n  <details>\n    <summary>Package name: <b>@rails/actioncable</b></summary>\n    <ul>\n      <li>\n        <b>7.2.100</b> - 2024-08-22\n      </li>\n      <li>\n        <b>7.2.0</b> - <a href=\"https://github.com/rails/rails/releases/tag/v7.2.0\">2024-08-09</a></br><h2>Active Support</h2>\n<ul>\n<li>\n<p>Fix <code>delegate_missing_to allow_nil: true</code> when called with implict self</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Person\n  delegate_missing_to :address, allow_nil: true\n\n  def address\n    nil\n  end\n\n  def berliner?\n    city == &quot;Berlin&quot;\n  end\nend\n\nPerson.new.city # =&gt; nil\nPerson.new.berliner? # undefined local variable or method `city' for an instance of Person (NameError)\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Person</span>\n  <span class=\"pl-en\">delegate_missing_to</span> <span class=\"pl-pds\">:address</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">allow_nil</span>: <span class=\"pl-c1\">true</span>\n\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">address</span>\n    <span class=\"pl-c1\">nil</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">berliner?</span>\n    <span class=\"pl-en\">city</span> == <span class=\"pl-s\">\"Berlin\"</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">city</span> <span class=\"pl-c\"># =&gt; nil</span>\n<span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">berliner?</span> <span class=\"pl-c\"># undefined local variable or method `city' for an instance of Person (NameError)</span></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add <code>logger</code> as a dependency since it is a bundled gem candidate for Ruby 3.5</p>\n<p><em>Earlopain</em></p>\n</li>\n<li>\n<p>Define <code>Digest::UUID.nil_uuid</code>, which returns the so-called nil UUID.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Support <code>duration</code> type in <code>ActiveSupport::XmlMini</code>.</p>\n<p><em>heka1024</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveSupport::Notifications::Event#children</code> and  <code>ActiveSupport::Notifications::Event#parent_of?</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to call the following methods without passing a deprecator:</p>\n<ul>\n<li><code>deprecate</code></li>\n<li><code>deprecate_constant</code></li>\n<li><code>ActiveSupport::Deprecation::DeprecatedObjectProxy.new</code></li>\n<li><code>ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy.new</code></li>\n<li><code>ActiveSupport::Deprecation::DeprecatedConstantProxy.new</code></li>\n<li><code>assert_deprecated</code></li>\n<li><code>assert_not_deprecated</code></li>\n<li><code>collect_deprecations</code></li>\n</ul>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveSupport::Deprecation</code> delegation to instance.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>SafeBuffer#clone_empty</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>#to_default_s</code> from <code>Array</code>, <code>Date</code>, <code>DateTime</code> and <code>Time</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to passing <code>Dalli::Client</code> instances to <code>MemCacheStore</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>config.active_support.use_rfc4122_namespaced_uuids</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>config.active_support.remove_deprecated_time_with_zone_name</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>config.active_support.disable_to_s_conversion</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to bolding log text with positional boolean in <code>ActiveSupport::LogSubscriber#color</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated constants <code>ActiveSupport::LogSubscriber::CLEAR</code> and <code>ActiveSupport::LogSubscriber::BOLD</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support for <code>config.active_support.cache_format_version = 6.1</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>:pool_size</code> and <code>:pool_timeout</code> options for the cache storage.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Warn on tests without assertions.</p>\n<p><code>ActiveSupport::TestCase</code> now warns when tests do not run any assertions.<br>\nThis is helpful in detecting broken tests that do not perform intended assertions.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Support <code>hexBinary</code> type in <code>ActiveSupport::XmlMini</code>.</p>\n<p><em>heka1024</em></p>\n</li>\n<li>\n<p>Deprecate <code>ActiveSupport::ProxyObject</code> in favor of Ruby's built-in <code>BasicObject</code>.</p>\n<p><em>Earlopain</em></p>\n</li>\n<li>\n<p><code>stub_const</code> now accepts a <code>exists: false</code> parameter to allow stubbing missing constants.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Make <code>ActiveSupport::BacktraceCleaner</code> copy filters and silencers on dup and clone.</p>\n<p>Previously the copy would still share the internal silencers and filters array,<br>\ncausing state to leak.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Updating Astana with Western Kazakhstan TZInfo identifier.</p>\n<p><em>Damian Nelson</em></p>\n</li>\n<li>\n<p>Add filename support for <code>ActiveSupport::Logger.logger_outputs_to?</code>.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"logger = Logger.new('/var/log/rails.log')\nActiveSupport::Logger.logger_outputs_to?(logger, '/var/log/rails.log')\"><pre><span class=\"pl-s1\">logger</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Logger</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'/var/log/rails.log'</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">Logger</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">logger_outputs_to?</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">logger</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'/var/log/rails.log'</span><span class=\"pl-kos\">)</span></pre></div>\n<p><em>Christian Schmidt</em></p>\n</li>\n<li>\n<p>Include <code>IPAddr#prefix</code> when serializing an <code>IPAddr</code> using the<br>\n<code>ActiveSupport::MessagePack</code> serializer.</p>\n<p>This change is backward and forward compatible — old payloads can<br>\nstill be read, and new payloads will be readable by older versions of Rails.</p>\n<p><em>Taiki Komaba</em></p>\n</li>\n<li>\n<p>Add <code>default:</code> support for <code>ActiveSupport::CurrentAttributes.attribute</code>.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Current &lt; ActiveSupport::CurrentAttributes\n  attribute :counter, default: 0\nend\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Current</span> &lt; <span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">CurrentAttributes</span>\n  <span class=\"pl-en\">attribute</span> <span class=\"pl-pds\">:counter</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">default</span>: <span class=\"pl-c1\">0</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Sean Doyle</em></p>\n</li>\n<li>\n<p>Yield instance to <code>Object#with</code> block.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"client.with(timeout: 5_000) do |c|\n  c.get(&quot;/commits&quot;)\nend\"><pre><span class=\"pl-en\">client</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">timeout</span>: <span class=\"pl-c1\">5_000</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">c</span>|\n  <span class=\"pl-s1\">c</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">get</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"/commits\"</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Sean Doyle</em></p>\n</li>\n<li>\n<p>Use logical core count instead of physical core count to determine the<br>\ndefault number of workers when parallelizing tests.</p>\n<p><em>Jonathan Hefner</em></p>\n</li>\n<li>\n<p>Fix <code>Time.now/DateTime.now/Date.today</code> to return results in a system timezone after <code>#travel_to</code>.</p>\n<p>There is a bug in the current implementation of #travel_to:<br>\nit remembers a timezone of its argument, and all stubbed methods start<br>\nreturning results in that remembered timezone. However, the expected<br>\nbehavior is to return results in a system timezone.</p>\n<p><em>Aleksei Chernenkov</em></p>\n</li>\n<li>\n<p>Add <code>ErrorReported#unexpected</code> to report precondition violations.</p>\n<p>For example:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"def edit\n  if published?\n    Rails.error.unexpected(&quot;[BUG] Attempting to edit a published article, that shouldn't be possible&quot;)\n    return false\n  end\n  # ...\nend\"><pre><span class=\"pl-k\">def</span> <span class=\"pl-en\">edit</span>\n  <span class=\"pl-k\">if</span> <span class=\"pl-en\">published?</span>\n    <span class=\"pl-v\">Rails</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">error</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">unexpected</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"[BUG] Attempting to edit a published article, that shouldn't be possible\"</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-c1\">false</span>\n  <span class=\"pl-k\">end</span>\n  <span class=\"pl-c\"># ...</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p>The above will raise an error in development and test, but only report the error in production.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Make the order of read_multi and write_multi notifications for <code>Cache::Store#fetch_multi</code> operations match the order they are executed in.</p>\n<p><em>Adam Renberg Tamm</em></p>\n</li>\n<li>\n<p>Make return values of <code>Cache::Store#write</code> consistent.</p>\n<p>The return value was not specified before. Now it returns <code>true</code> on a successful write,<br>\n<code>nil</code> if there was an error talking to the cache backend, and <code>false</code> if the write failed<br>\nfor another reason (e.g. the key already exists and <code>unless_exist: true</code> was passed).</p>\n<p><em>Sander Verdonschot</em></p>\n</li>\n<li>\n<p>Fix logged cache keys not always matching actual key used by cache action.</p>\n<p><em>Hartley McGuire</em></p>\n</li>\n<li>\n<p>Improve error messages of <code>assert_changes</code> and <code>assert_no_changes</code>.</p>\n<p><code>assert_changes</code> error messages now display objects with <code>.inspect</code> to make it easier<br>\nto differentiate nil from empty strings, strings from symbols, etc.<br>\n<code>assert_no_changes</code> error messages now surface the actual value.</p>\n<p><em>pcreux</em></p>\n</li>\n<li>\n<p>Fix <code>#to_fs(:human_size)</code> to correctly work with negative numbers.</p>\n<p><em>Earlopain</em></p>\n</li>\n<li>\n<p>Fix <code>BroadcastLogger#dup</code> so that it duplicates the logger's <code>broadcasts</code>.</p>\n<p><em>Andrew Novoselac</em></p>\n</li>\n<li>\n<p>Fix issue where <code>bootstrap.rb</code> overwrites the <code>level</code> of a <code>BroadcastLogger</code>'s <code>broadcasts</code>.</p>\n<p><em>Andrew Novoselac</em></p>\n</li>\n<li>\n<p>Fix compatibility with the <code>semantic_logger</code> gem.</p>\n<p>The <code>semantic_logger</code> gem doesn't behave exactly like stdlib logger in that<br>\n<code>SemanticLogger#level</code> returns a Symbol while stdlib <code>Logger#level</code> returns an Integer.</p>\n<p>This caused the various <code>LogSubscriber</code> classes in Rails to break when assigned a<br>\n<code>SemanticLogger</code> instance.</p>\n<p><em>Jean Boussier</em>, <em>ojab</em></p>\n</li>\n<li>\n<p>Fix MemoryStore to prevent race conditions when incrementing or decrementing.</p>\n<p><em>Pierre Jambet</em></p>\n</li>\n<li>\n<p>Implement <code>HashWithIndifferentAccess#to_proc</code>.</p>\n<p>Previously, calling <code>#to_proc</code> on <code>HashWithIndifferentAccess</code> object used inherited <code>#to_proc</code><br>\nmethod from the <code>Hash</code> class, which was not able to access values using indifferent keys.</p>\n<p><em>fatkodima</em></p>\n</li>\n</ul>\n<h2>Active Model</h2>\n<ul>\n<li>\n<p>Fix a bug where type casting of string to <code>Time</code> and <code>DateTime</code> doesn't<br>\ncalculate minus minute value in TZ offset correctly.</p>\n<p><em>Akira Matsuda</em></p>\n</li>\n<li>\n<p>Port the <code>type_for_attribute</code> method to Active Model. Classes that include<br>\n<code>ActiveModel::Attributes</code> will now provide this method. This method behaves<br>\nthe same for Active Model as it does for Active Record.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class MyModel\n  include ActiveModel::Attributes\n\n  attribute :my_attribute, :integer\nend\n\nMyModel.type_for_attribute(:my_attribute) # =&gt; #&lt;ActiveModel::Type::Integer ...&gt;\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">MyModel</span>\n  <span class=\"pl-en\">include</span> <span class=\"pl-v\">ActiveModel</span>::<span class=\"pl-v\">Attributes</span>\n\n  <span class=\"pl-en\">attribute</span> <span class=\"pl-pds\">:my_attribute</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:integer</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-v\">MyModel</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">type_for_attribute</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:my_attribute</span><span class=\"pl-kos\">)</span> <span class=\"pl-c\"># =&gt; #&lt;ActiveModel::Type::Integer ...&gt;</span></pre></div>\n<p><em>Jonathan Hefner</em></p>\n</li>\n</ul>\n<h2>Active Record</h2>\n<ul>\n<li>\n<p>Handle commas in Sqlite3 default function definitions.</p>\n<p><em>Stephen Margheim</em></p>\n</li>\n<li>\n<p>Fixes <code>validates_associated</code> raising an exception when configured with a<br>\nsingular association and having <code>index_nested_attribute_errors</code> enabled.</p>\n<p><em>Martin Spickermann</em></p>\n</li>\n<li>\n<p>The constant <code>ActiveRecord::ImmutableRelation</code> has been deprecated because<br>\nwe want to reserve that name for a stronger sense of \"immutable relation\".<br>\nPlease use <code>ActiveRecord::UnmodifiableRelation</code> instead.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Add condensed <code>#inspect</code> for <code>ConnectionPool</code>, <code>AbstractAdapter</code>, and<br>\n<code>DatabaseConfig</code>.</p>\n<p><em>Hartley McGuire</em></p>\n</li>\n<li>\n<p>Fixed a memory performance issue in Active Record attribute methods definition.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Define the new Active Support notification event <code>start_transaction.active_record</code>.</p>\n<p>This event is fired when database transactions or savepoints start, and<br>\ncomplements <code>transaction.active_record</code>, which is emitted when they finish.</p>\n<p>The payload has the transaction (<code>:transaction</code>) and the connection (<code>:connection</code>).</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Fix an issue where the IDs reader method did not return expected results<br>\nfor preloaded associations in models using composite primary keys.</p>\n<p><em>Jay Ang</em></p>\n</li>\n<li>\n<p>The payload of <code>sql.active_record</code> Active Support notifications now has the current transaction in the <code>:transaction</code> key.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>The payload of <code>transaction.active_record</code> Active Support notifications now has the transaction the event is related to in the <code>:transaction</code> key.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Define <code>ActiveRecord::Transaction#uuid</code>, which returns a UUID for the database transaction. This may be helpful when tracing database activity. These UUIDs are generated only on demand.</p>\n<p><em>Xavier Noria</em></p>\n</li>\n<li>\n<p>Fix inference of association model on nested models with the same demodularized name.</p>\n<p>E.g. with the following setup:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Nested::Post &lt; ApplicationRecord\n  has_one :post, through: :other\nend\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Nested</span>::<span class=\"pl-v\">Post</span> &lt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-en\">has_one</span> <span class=\"pl-pds\">:post</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">through</span>: <span class=\"pl-pds\">:other</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p>Before, <code>#post</code> would infer the model as <code>Nested::Post</code>, but now it correctly infers <code>Post</code>.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>PostgreSQL <code>Cidr#change?</code> detects the address prefix change.</p>\n<p><em>Taketo Takashima</em></p>\n</li>\n<li>\n<p>Change <code>BatchEnumerator#destroy_all</code> to return the total number of affected rows.</p>\n<p>Previously, it always returned <code>nil</code>.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Support <code>touch_all</code> in batches.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Post.in_batches.touch_all\"><pre><span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">in_batches</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">touch_all</span></pre></div>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Add support for <code>:if_not_exists</code> and <code>:force</code> options to <code>create_schema</code>.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Fix <code>index_errors</code> having incorrect index in association validation errors.</p>\n<p><em>lulalala</em></p>\n</li>\n<li>\n<p>Add <code>index_errors: :nested_attributes_order</code> mode.</p>\n<p>This indexes the association validation errors based on the order received by nested attributes setter, and respects the <code>reject_if</code> configuration. This enables API to provide enough information to the frontend to map the validation errors back to their respective form fields.</p>\n<p><em>lulalala</em></p>\n</li>\n<li>\n<p>Add <code>Rails.application.config.active_record.postgresql_adapter_decode_dates</code> to opt out of decoding dates automatically with the postgresql adapter. Defaults to true.</p>\n<p><em>Joé Dupuis</em></p>\n</li>\n<li>\n<p>Association option <code>query_constraints</code> is deprecated in favor of <code>foreign_key</code>.</p>\n<p><em>Nikita Vasilevsky</em></p>\n</li>\n<li>\n<p>Add <code>ENV[\"SKIP_TEST_DATABASE_TRUNCATE\"]</code> flag to speed up multi-process test runs on large DBs when all tests run within default transaction.</p>\n<p>This cuts ~10s from the test run of HEY when run by 24 processes against the 178 tables, since ~4,000 table truncates can then be skipped.</p>\n<p><em>DHH</em></p>\n</li>\n<li>\n<p>Added support for recursive common table expressions.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Post.with_recursive(\n  post_and_replies: [\n    Post.where(id: 42),\n    Post.joins('JOIN post_and_replies ON posts.in_reply_to_id = post_and_replies.id'),\n  ]\n)\"><pre><span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with_recursive</span><span class=\"pl-kos\">(</span>\n  <span class=\"pl-pds\">post_and_replies</span>: <span class=\"pl-kos\">[</span>\n    <span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">where</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">id</span>: <span class=\"pl-c1\">42</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">joins</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'JOIN post_and_replies ON posts.in_reply_to_id = post_and_replies.id'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-kos\">]</span>\n<span class=\"pl-kos\">)</span></pre></div>\n<p>Generates the following SQL:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"WITH RECURSIVE &quot;post_and_replies&quot; AS (\n  (SELECT &quot;posts&quot;.* FROM &quot;posts&quot; WHERE &quot;posts&quot;.&quot;id&quot; = 42)\n  UNION ALL\n  (SELECT &quot;posts&quot;.* FROM &quot;posts&quot; JOIN post_and_replies ON posts.in_reply_to_id = post_and_replies.id)\n)\nSELECT &quot;posts&quot;.* FROM &quot;posts&quot;\"><pre>WITH RECURSIVE <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>post_and_replies<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">AS</span> (\n  (<span class=\"pl-k\">SELECT</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">WHERE</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">42</span>)\n  <span class=\"pl-k\">UNION ALL</span>\n  (<span class=\"pl-k\">SELECT</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">JOIN</span> post_and_replies <span class=\"pl-k\">ON</span> <span class=\"pl-c1\">posts</span>.<span class=\"pl-c1\">in_reply_to_id</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">post_and_replies</span>.<span class=\"pl-c1\">id</span>)\n)\n<span class=\"pl-k\">SELECT</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-k\">*</span> <span class=\"pl-k\">FROM</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>posts<span class=\"pl-pds\">\"</span></span></pre></div>\n<p><em>ClearlyClaire</em></p>\n</li>\n<li>\n<p><code>validate_constraint</code> can be called in a <code>change_table</code> block.</p>\n<p>ex:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"change_table :products do |t|\n  t.check_constraint &quot;price &gt; discounted_price&quot;, name: &quot;price_check&quot;, validate: false\n  t.validate_check_constraint &quot;price_check&quot;\nend\"><pre><span class=\"pl-en\">change_table</span> <span class=\"pl-pds\">:products</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">check_constraint</span> <span class=\"pl-s\">\"price &gt; discounted_price\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">name</span>: <span class=\"pl-s\">\"price_check\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">validate</span>: <span class=\"pl-c1\">false</span>\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">validate_check_constraint</span> <span class=\"pl-s\">\"price_check\"</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Cody Cutrer</em></p>\n</li>\n<li>\n<p><code>PostgreSQLAdapter</code> now decodes columns of type date to <code>Date</code> instead of string.</p>\n<p>Ex:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ActiveRecord::Base.connection\n     .select_value(&quot;select '2024-01-01'::date&quot;).class #=&gt; Date\"><pre><span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n     <span class=\"pl-kos\">.</span><span class=\"pl-en\">select_value</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"select '2024-01-01'::date\"</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">class</span> <span class=\"pl-c\">#=&gt; Date</span></pre></div>\n<p><em>Joé Dupuis</em></p>\n</li>\n<li>\n<p>Strict loading using <code>:n_plus_one_only</code> does not eagerly load child associations.</p>\n<p>With this change, child associations are no longer eagerly loaded, to<br>\nmatch intended behavior and to prevent non-deterministic order issues caused<br>\nby calling methods like <code>first</code> or <code>last</code>. As <code>first</code> and <code>last</code> don't cause<br>\nan N+1 by themselves, calling child associations will no longer raise.<br>\nFixes <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1924388730\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49473\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49473/hovercard\" href=\"https://github.com/rails/rails/issues/49473\">#49473</a>.</p>\n<p>Before:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"person = Person.find(1)\nperson.strict_loading!(mode: :n_plus_one_only)\nperson.posts.first\n# SELECT * FROM posts WHERE person_id = 1; -- non-deterministic order\nperson.posts.first.firm # raises ActiveRecord::StrictLoadingViolationError\"><pre><span class=\"pl-s1\">person</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">find</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">strict_loading!</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">mode</span>: <span class=\"pl-pds\">:n_plus_one_only</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">posts</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span>\n<span class=\"pl-c\"># SELECT * FROM posts WHERE person_id = 1; -- non-deterministic order</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">posts</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">firm</span> <span class=\"pl-c\"># raises ActiveRecord::StrictLoadingViolationError</span></pre></div>\n<p>After:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"person = Person.find(1)\nperson.strict_loading!(mode: :n_plus_one_only)\nperson.posts.first # this is 1+1, not N+1\n# SELECT * FROM posts WHERE person_id = 1 ORDER BY id LIMIT 1;\nperson.posts.first.firm # no longer raises\"><pre><span class=\"pl-s1\">person</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">find</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">strict_loading!</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">mode</span>: <span class=\"pl-pds\">:n_plus_one_only</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">posts</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span> <span class=\"pl-c\"># this is 1+1, not N+1</span>\n<span class=\"pl-c\"># SELECT * FROM posts WHERE person_id = 1 ORDER BY id LIMIT 1;</span>\n<span class=\"pl-s1\">person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">posts</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">firm</span> <span class=\"pl-c\"># no longer raises</span></pre></div>\n<p><em>Reid Lynch</em></p>\n</li>\n<li>\n<p>Allow <code>Sqlite3Adapter</code> to use <code>sqlite3</code> gem version <code>2.x</code>.</p>\n<p><em>Mike Dalessio</em></p>\n</li>\n<li>\n<p>Allow <code>ActiveRecord::Base#pluck</code> to accept hash values.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"# Before\nPost.joins(:comments).pluck(&quot;posts.id&quot;, &quot;comments.id&quot;, &quot;comments.body&quot;)\n\n# After\nPost.joins(:comments).pluck(posts: [:id], comments: [:id, :body])\"><pre><span class=\"pl-c\"># Before</span>\n<span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">joins</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:comments</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">pluck</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"posts.id\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"comments.id\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"comments.body\"</span><span class=\"pl-kos\">)</span>\n\n<span class=\"pl-c\"># After</span>\n<span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">joins</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:comments</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">pluck</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">posts</span>: <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">comments</span>: <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:body</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span></pre></div>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Raise an <code>ActiveRecord::ActiveRecordError</code> error when the MySQL database returns an invalid version string.</p>\n<p><em>Kevin McPhillips</em></p>\n</li>\n<li>\n<p><code>ActiveRecord::Base.transaction</code> now yields an <code>ActiveRecord::Transaction</code> object.</p>\n<p>This allows to register callbacks on it.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Article.transaction do |transaction|\n  article.update(published: true)\n  transaction.after_commit do\n    PublishNotificationMailer.with(article: article).deliver_later\n  end\nend\"><pre><span class=\"pl-v\">Article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">transaction</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">transaction</span>|\n  <span class=\"pl-en\">article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">update</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">published</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-s1\">transaction</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">after_commit</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-v\">PublishNotificationMailer</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">article</span>: <span class=\"pl-en\">article</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">deliver_later</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add <code>ActiveRecord::Base.current_transaction</code>.</p>\n<p>Returns the current transaction, to allow registering callbacks on it.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Article.current_transaction.after_commit do\n  PublishNotificationMailer.with(article: article).deliver_later\nend\"><pre><span class=\"pl-v\">Article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">current_transaction</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">after_commit</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-v\">PublishNotificationMailer</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">article</span>: <span class=\"pl-en\">article</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">deliver_later</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add <code>ActiveRecord.after_all_transactions_commit</code> callback.</p>\n<p>Useful for code that may run either inside or outside a transaction and needs<br>\nto perform work after the state changes have been properly persisted.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"def publish_article(article)\n  article.update(published: true)\n  ActiveRecord.after_all_transactions_commit do\n    PublishNotificationMailer.with(article: article).deliver_later\n  end\nend\"><pre><span class=\"pl-k\">def</span> <span class=\"pl-en\">publish_article</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">article</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-s1\">article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">update</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">published</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-v\">ActiveRecord</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">after_all_transactions_commit</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-v\">PublishNotificationMailer</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">article</span>: <span class=\"pl-s1\">article</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">deliver_later</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p>In the above example, the block is either executed immediately if called outside<br>\nof a transaction, or called after the open transaction is committed.</p>\n<p>If the transaction is rolled back, the block isn't called.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add the ability to ignore counter cache columns until they are backfilled.</p>\n<p>Starting to use counter caches on existing large tables can be troublesome, because the column<br>\nvalues must be backfilled separately of the column addition (to not lock the table for too long)<br>\nand before the use of <code>:counter_cache</code> (otherwise methods like <code>size</code>/<code>any?</code>/etc, which use<br>\ncounter caches internally, can produce incorrect results). People usually use database triggers<br>\nor callbacks on child associations while backfilling before introducing a counter cache<br>\nconfiguration to the association.</p>\n<p>Now, to safely backfill the column, while keeping the column updated with child records added/removed, use:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Comment &lt; ApplicationRecord\n  belongs_to :post, counter_cache: { active: false }\nend\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Comment</span> &lt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-en\">belongs_to</span> <span class=\"pl-pds\">:post</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">counter_cache</span>: <span class=\"pl-kos\">{</span> <span class=\"pl-pds\">active</span>: <span class=\"pl-c1\">false</span> <span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p>While the counter cache is not \"active\", the methods like <code>size</code>/<code>any?</code>/etc will not use it,<br>\nbut get the results directly from the database. After the counter cache column is backfilled, simply<br>\nremove the <code>{ active: false }</code> part from the counter cache definition, and it will now be used by the<br>\nmentioned methods.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Retry known idempotent SELECT queries on connection-related exceptions.</p>\n<p>SELECT queries we construct by walking the Arel tree and / or with known model attributes<br>\nare idempotent and can safely be retried in the case of a connection error. Previously,<br>\nadapters such as <code>TrilogyAdapter</code> would raise <code>ActiveRecord::ConnectionFailed: Trilogy::EOFError</code><br>\nwhen encountering a connection error mid-request.</p>\n<p><em>Adrianna Chang</em></p>\n</li>\n<li>\n<p>Allow association's <code>foreign_key</code> to be composite.</p>\n<p><code>query_constraints</code> option was the only way to configure a composite foreign key by passing an <code>Array</code>.<br>\nNow it's possible to pass an Array value as <code>foreign_key</code> to achieve the same behavior of an association.</p>\n<p><em>Nikita Vasilevsky</em></p>\n</li>\n<li>\n<p>Allow association's <code>primary_key</code> to be composite.</p>\n<p>Association's <code>primary_key</code> can be composite when derived from associated model <code>primary_key</code> or <code>query_constraints</code>.<br>\nNow it's possible to explicitly set it as composite on the association.</p>\n<p><em>Nikita Vasilevsky</em></p>\n</li>\n<li>\n<p>Add <code>config.active_record.permanent_connection_checkout</code> setting.</p>\n<p>Controls whether <code>ActiveRecord::Base.connection</code> raises an error, emits a deprecation warning, or neither.</p>\n<p><code>ActiveRecord::Base.connection</code> checkouts a database connection from the pool and keeps it leased until the end of<br>\nthe request or job. This behavior can be undesirable in environments that use many more threads or fibers than there<br>\nis available connections.</p>\n<p>This configuration can be used to track down and eliminate code that calls <code>ActiveRecord::Base.connection</code> and<br>\nmigrate it to use <code>ActiveRecord::Base.with_connection</code> instead.</p>\n<p>The default behavior remains unchanged, and there is currently no plans to change the default.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add dirties option to uncached.</p>\n<p>This adds a <code>dirties</code> option to <code>ActiveRecord::Base.uncached</code> and<br>\n<code>ActiveRecord::ConnectionAdapters::ConnectionPool#uncached</code>.</p>\n<p>When set to <code>true</code> (the default), writes will clear all query caches belonging to the current thread.<br>\nWhen set to <code>false</code>, writes to the affected connection pool will not clear any query cache.</p>\n<p>This is needed by Solid Cache so that cache writes do not clear query caches.</p>\n<p><em>Donal McBreen</em></p>\n</li>\n<li>\n<p>Deprecate <code>ActiveRecord::Base.connection</code> in favor of <code>.lease_connection</code>.</p>\n<p>The method has been renamed as <code>lease_connection</code> to better reflect that the returned<br>\nconnection will be held for the duration of the request or job.</p>\n<p>This deprecation is a soft deprecation, no warnings will be issued and there is no<br>\ncurrent plan to remove the method.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Deprecate <code>ActiveRecord::ConnectionAdapters::ConnectionPool#connection</code>.</p>\n<p>The method has been renamed as <code>lease_connection</code> to better reflect that the returned<br>\nconnection will be held for the duration of the request or job.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Expose a generic fixture accessor for fixture names that may conflict with Minitest.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"assert_equal &quot;Ruby on Rails&quot;, web_sites(:rubyonrails).name\nassert_equal &quot;Ruby on Rails&quot;, fixture(:web_sites, :rubyonrails).name\"><pre><span class=\"pl-en\">assert_equal</span> <span class=\"pl-s\">\"Ruby on Rails\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-en\">web_sites</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:rubyonrails</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">name</span>\n<span class=\"pl-en\">assert_equal</span> <span class=\"pl-s\">\"Ruby on Rails\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-en\">fixture</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:web_sites</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:rubyonrails</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">name</span></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Using <code>Model.query_constraints</code> with a single non-primary-key column used to raise as expected, but with an<br>\nincorrect error message.</p>\n<p>This has been fixed to raise with a more appropriate error message.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>Fix <code>has_one</code> association autosave setting the foreign key attribute when it is unchanged.</p>\n<p>This behavior is also inconsistent with autosaving <code>belongs_to</code> and can have unintended side effects like raising<br>\nan <code>ActiveRecord::ReadonlyAttributeError</code> when the foreign key attribute is marked as read-only.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>Remove deprecated behavior that would rollback a transaction block when exited using <code>return</code>, <code>break</code> or <code>throw</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Deprecate <code>Rails.application.config.active_record.commit_transaction_on_non_local_return</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to pass <code>rewhere</code> to <code>ActiveRecord::Relation#merge</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to pass <code>deferrable: true</code> to <code>add_foreign_key</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to quote <code>ActiveSupport::Duration</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>#quote_bound_value</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::ConnectionAdapters::ConnectionPool#connection_klass</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to apply <code>#connection_pool_list</code>, <code>#active_connections?</code>, <code>#clear_active_connections!</code>,<br>\n<code>#clear_reloadable_connections!</code>, <code>#clear_all_connections!</code> and <code>#flush_idle_connections!</code> to the connections pools<br>\nfor the current role when the <code>role</code> argument isn't provided.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>#all_connection_pools</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::ConnectionAdapters::SchemaCache#data_sources</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::ConnectionAdapters::SchemaCache.load_from</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>#all_foreign_keys_valid?</code> from database adapters.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to passing coder and class as second argument to <code>serialize</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to <code>ActiveRecord::Base#read_attribute(:id)</code> to return the custom primary key value.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>TestFixtures.fixture_path</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated behavior to support referring to a singular association by its plural name.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Deprecate <code>Rails.application.config.active_record.allow_deprecated_singular_associations_name</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to passing <code>SchemaMigration</code> and <code>InternalMetadata</code> classes as arguments to<br>\n<code>ActiveRecord::MigrationContext</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Migration.check_pending!</code> method.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::LogSubscriber.runtime</code> method.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::LogSubscriber.runtime=</code> method.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::LogSubscriber.reset_runtime</code> method.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to define <code>explain</code> in the connection adapter with 2 arguments.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::ActiveJobRequiredError</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Base.clear_active_connections!</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Base.clear_reloadable_connections!</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Base.clear_all_connections!</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>ActiveRecord::Base.flush_idle_connections!</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>name</code> argument from <code>ActiveRecord::Base.remove_connection</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated support to call <code>alias_attribute</code> with non-existent attribute names.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Remove deprecated <code>Rails.application.config.active_record.suppress_multiple_database_warning</code>.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Add <code>ActiveRecord::Encryption::MessagePackMessageSerializer</code>.</p>\n<p>Serialize data to the MessagePack format, for efficient storage in binary columns.</p>\n<p>The binary encoding requires around 30% less space than the base64 encoding<br>\nused by the default serializer.</p>\n<p><em>Donal McBreen</em></p>\n</li>\n<li>\n<p>Add support for encrypting binary columns.</p>\n<p>Ensure encryption and decryption pass <code>Type::Binary::Data</code> around for binary data.</p>\n<p>Previously encrypting binary columns with the <code>ActiveRecord::Encryption::MessageSerializer</code><br>\nincidentally worked for MySQL and SQLite, but not PostgreSQL.</p>\n<p><em>Donal McBreen</em></p>\n</li>\n<li>\n<p>Deprecated <code>ENV[\"SCHEMA_CACHE\"]</code> in favor of <code>schema_cache_path</code> in the database configuration.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Add <code>ActiveRecord::Base.with_connection</code> as a shortcut for leasing a connection for a short duration.</p>\n<p>The leased connection is yielded, and for the duration of the block, any call to <code>ActiveRecord::Base.connection</code><br>\nwill yield that same connection.</p>\n<p>This is useful to perform a few database operations without causing a connection to be leased for the<br>\nentire duration of the request or job.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Deprecate <code>config.active_record.warn_on_records_fetched_greater_than</code> now that <code>sql.active_record</code><br>\nnotification includes <code>:row_count</code> field.</p>\n<p><em>Jason Nochlin</em></p>\n</li>\n<li>\n<p>The fix ensures that the association is joined using the appropriate join type<br>\n(either inner join or left outer join) based on the existing joins in the scope.</p>\n<p>This prevents unintentional overrides of existing join types and ensures consistency in the generated SQL queries.</p>\n<p>Example:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"# `associated` will use `LEFT JOIN` instead of using `JOIN`\nPost.left_joins(:author).where.associated(:author)\"><pre><span class=\"pl-c\"># `associated` will use `LEFT JOIN` instead of using `JOIN`</span>\n<span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">left_joins</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:author</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">where</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">associated</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:author</span><span class=\"pl-kos\">)</span></pre></div>\n<p><em>Saleh Alhaddad</em></p>\n</li>\n<li>\n<p>Fix an issue where <code>ActiveRecord::Encryption</code> configurations are not ready before the loading<br>\nof Active Record models, when an application is eager loaded. As a result, encrypted attributes<br>\ncould be misconfigured in some cases.</p>\n<p><em>Maxime Réty</em></p>\n</li>\n<li>\n<p>Deprecate defining an <code>enum</code> with keyword arguments.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Function &gt; ApplicationRecord\n  # BAD\n  enum color: [:red, :blue],\n       type: [:instance, :class]\n\n  # GOOD\n  enum :color, [:red, :blue]\n  enum :type, [:instance, :class]\nend\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">Function</span> &gt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-c\"># BAD</span>\n  <span class=\"pl-en\">enum</span> <span class=\"pl-pds\">color</span>: <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:red</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:blue</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span>\n       <span class=\"pl-pds\">type</span>: <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:instance</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:class</span><span class=\"pl-kos\">]</span>\n\n  <span class=\"pl-c\"># GOOD</span>\n  <span class=\"pl-en\">enum</span> <span class=\"pl-pds\">:color</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:red</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:blue</span><span class=\"pl-kos\">]</span>\n  <span class=\"pl-en\">enum</span> <span class=\"pl-pds\">:type</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:instance</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:class</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Hartley McGuire</em></p>\n</li>\n<li>\n<p>Add <code>config.active_record.validate_migration_timestamps</code> option for validating migration timestamps.</p>\n<p>When set, validates that the timestamp prefix for a migration is no more than a day ahead of<br>\nthe timestamp associated with the current time. This is designed to prevent migrations prefixes<br>\nfrom being hand-edited to future timestamps, which impacts migration generation and other<br>\nmigration commands.</p>\n<p><em>Adrianna Chang</em></p>\n</li>\n<li>\n<p>Properly synchronize <code>Mysql2Adapter#active?</code> and <code>TrilogyAdapter#active?</code>.</p>\n<p>As well as <code>disconnect!</code> and <code>verify!</code>.</p>\n<p>This generally isn't a big problem as connections must not be shared between<br>\nthreads, but is required when running transactional tests or system tests<br>\nand could lead to a SEGV.</p>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Support <code>:source_location</code> tag option for query log tags.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"config.active_record.query_log_tags &lt;&lt; :source_location\"><pre><span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">active_record</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">query_log_tags</span> &lt;&lt; <span class=\"pl-pds\">:source_location</span></pre></div>\n<p>Calculating the caller location is a costly operation and should be used primarily in development<br>\n(note, there is also a <code>config.active_record.verbose_query_logs</code> that serves the same purpose)<br>\nor occasionally on production for debugging purposes.</p>\n<p><em>fatkodima</em></p>\n</li>\n<li>\n<p>Add an option to <code>ActiveRecord::Encryption::Encryptor</code> to disable compression.</p>\n<p>Allow compression to be disabled by setting <code>compress: false</code></p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"  class User\n    encrypts :name, encryptor: ActiveRecord::Encryption::Encryptor.new(compress: false)\n  end\"><pre>  <span class=\"pl-k\">class</span> <span class=\"pl-v\">User</span>\n    <span class=\"pl-en\">encrypts</span> <span class=\"pl-pds\">:name</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">encryptor</span>: <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Encryption</span>::<span class=\"pl-v\">Encryptor</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">compress</span>: <span class=\"pl-c1\">false</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span></pre></div>\n<p><em>Donal McBreen</em></p>\n</li>\n<li>\n<p>Deprecate passing strings to <code>ActiveRecord::Tasks::DatabaseTasks.cache_dump_filename</code>.</p>\n<p>A <code>ActiveRecord::DatabaseConfigurations::DatabaseConfig</code> object should be passed instead.</p>\n<p><em>Rafael Mendonça França</em></p>\n</li>\n<li>\n<p>Add <code>row_count</code> field to <code>sql.active_record</code> notification.</p>\n<p>This field returns the amount of rows returned by the query that emitted the notification.</p>\n<p>This metric is useful in cases where one wants to detect queries with big result sets.</p>\n<p><em>Marvin Bitterlich</em></p>\n</li>\n<li>\n<p>Consistently raise an <code>ArgumentError</code> when passing an invalid argument to a nested attributes association writer.</p>\n<p>Previously, this would only raise on collection associations and produce a generic error on singular associations.</p>\n<p>Now, it will raise on both collection and singular associations.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>Fix single quote escapes on default generated MySQL columns.</p>\n<p>MySQL 5.7.5+ supports generated columns, which can be used to create a column that is computed from an expression.</p>\n<p>Previously, the schema dump would output a string with double escapes for generated columns with single quotes in the default expression.</p>\n<p>This would result in issues when importing the schema on a fresh instance of a MySQL database.</p>\n<p>Now, the string will not be escaped and will be valid Ruby upon importing of the schema.</p>\n<p><em>Yash Kapadia</em></p>\n</li>\n<li>\n<p>Fix Migrations with versions older than 7.1 validating options given to<br>\n<code>add_reference</code> and <code>t.references</code>.</p>\n<p><em>Hartley McGuire</em></p>\n</li>\n<li>\n<p>Add <code>&lt;role&gt;_types</code> class method to <code>ActiveRecord::DelegatedType</code> so that the delegated types can be introspected.</p>\n<p><em>JP Rosevear</em></p>\n</li>\n<li>\n<p>Make <code>schema_dump</code>, <code>query_cache</code>, <code>replica</code> and <code>database_tasks</code> configurable via <code>DATABASE_URL</code>.</p>\n<p>This wouldn't always work previously because boolean values would be interpreted as strings.</p>\n<p>e.g. <code>DATABASE_URL=postgres://localhost/foo?schema_dump=false</code> now properly disable dumping the schema<br>\ncache.</p>\n<p><em>Mike Coutermarsh</em>, <em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Introduce <code>ActiveRecord::Transactions::ClassMethods#set_callback</code>.</p>\n<p>It is identical to <code>ActiveSupport::Callbacks::ClassMethods#set_callback</code><br>\nbut with support for <code>after_commit</code> and <code>after_rollback</code> callback options.</p>\n<p><em>Joshua Young</em></p>\n</li>\n<li>\n<p>Make <code>ActiveRecord::Encryption::Encryptor</code> agnostic of the serialization format used for encrypted data.</p>\n<p>Previously, the encryptor instance only allowed an encrypted value serialized as a <code>String</code> to be passed to the message serializer.</p>\n<p>Now, the encryptor lets the configured <code>message_serializer</code> decide which types of serialized encrypted values are supported. A custom serialiser is therefore allowed to serialize <code>ActiveRecord::Encryption::Message</code> objects using a type other than <code>String</code>.</p>\n<p>The default <code>ActiveRecord::Encryption::MessageSerializer</code> already ensures that only <code>String</code> objects are passed for deserialization.</p>\n<p><em>Maxime Réty</em></p>\n</li>\n<li>\n<p>Fix <code>encrypted_attribute?</code> to take into account context properties passed to <code>encrypts</code>.</p>\n<p><em>Maxime Réty</em></p>\n</li>\n<li>\n<p>The object returned by <code>explain</code> now responds to <code>pluck</code>, <code>first</code>,<br>\n<code>last</code>, <code>average</code>, <code>count</code>, <code>maximum</code>, <code>minimum</code>, and <code>sum</code>. Those<br>\nnew methods run <code>EXPLAIN</code> on the corresponding queries:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"User.all.explain.count\n# EXPLAIN SELECT COUNT(*) FROM `users`\n# ...\n\nUser.all.explain.maximum(:id)\n# EXPLAIN SELECT MAX(`users`.`id`) FROM `users`\n# ...\"><pre><span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">all</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">explain</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">count</span>\n<span class=\"pl-c\"># EXPLAIN SELECT COUNT(*) FROM `users`</span>\n<span class=\"pl-c\"># ...</span>\n\n<span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">all</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">explain</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">maximum</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:id</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c\"># EXPLAIN SELECT MAX(`users`.`id`) FROM `users`</span>\n<span class=\"pl-c\"># ...</span></pre></div>\n<p><em>Petrik de Heus</em></p>\n</li>\n<li>\n<p>Fixes an issue where <code>validates_associated</code> <code>:on</code>  option wasn't respected<br>\nwhen validating associated records.</p>\n<p><em>Austen Madden</em>, <em>Alex Ghiculescu</em>, <em>Rafał Brize</em></p>\n</li>\n<li>\n<p>Allow overriding SQLite defaults from <code>database.yml</code>.</p>\n<p>Any PRAGMA configuration set under the <code>pragmas</code> key in the configuration<br>\nfile takes precedence over Rails' defaults, and additional PRAGMAs can be<br>\nset as well.</p>\n<div class=\"highlight highlight-source-yaml notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"database: storage/development.sqlite3\ntimeout: 5000\npragmas:\n  journal_mode: off\n  temp_store: memory\"><pre><span class=\"pl-ent\">database</span>: <span class=\"pl-s\">storage/development.sqlite3</span>\n<span class=\"pl-ent\">timeout</span>: <span class=\"pl-c1\">5000</span>\n<span class=\"pl-ent\">pragmas</span>:\n  <span class=\"pl-ent\">journal_mode</span>: <span class=\"pl-s\">off</span>\n  <span class=\"pl-ent\">temp_store</span>: <span class=\"pl-s\">memory</span></pre></div>\n<p><em>Stephen Margheim</em></p>\n</li>\n<li>\n<p>Remove warning message when running SQLite in production, but leave it unconfigured.</p>\n<p>There are valid use cases for running SQLite in production. However, it must be done<br>\nwith care, so instead of a warning most users won't see anyway, it's preferable to<br>\nleave the configuration commented out to force them to think about having the database<br>\non a persistent volume etc.</p>\n<p><em>Jacopo Beschi</em>, <em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Add support for generated columns to the SQLite3 adapter.</p>\n<p>Generated columns (both stored and dynamic) are supported since version 3.31.0 of SQLite.<br>\nThis adds support for those to the SQLite3 adapter.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"create_table :users do |t|\n  t.string :name\n  t.virtual :name_upper, type: :string, as: 'UPPER(name)'\n  t.virtual :name_lower, type: :string, as: 'LOWER(name)', stored: true\nend\"><pre><span class=\"pl-en\">create_table</span> <span class=\"pl-pds\">:users</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">string</span> <span class=\"pl-pds\">:name</span>\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">virtual</span> <span class=\"pl-pds\">:name_upper</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">type</span>: <span class=\"pl-pds\">:string</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">as</span>: <span class=\"pl-s\">'UPPER(name)'</span>\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">virtual</span> <span class=\"pl-pds\">:name_lower</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">type</span>: <span class=\"pl-pds\">:string</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">as</span>: <span class=\"pl-s\">'LOWER(name)'</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">stored</span>: <span class=\"pl-c1\">true</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p><em>Stephen Margheim</em></p>\n</li>\n<li>\n<p>TrilogyAdapter: ignore <code>host</code> if <code>socket</code> parameter is set.</p>\n<p>This allows to configure a connection on a UNIX socket via <code>DATABASE_URL</code>:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"DATABASE_URL=trilogy://does-not-matter/my_db_production?socket=/var/run/mysql.sock\"><pre class=\"notranslate\"><code>DATABASE_URL=trilogy://does-not-matter/my_db_production?socket=/var/run/mysql.sock\n</code></pre></div>\n<p><em>Jean Boussier</em></p>\n</li>\n<li>\n<p>Make <code>assert_queries_count</code>, <code>assert_no_queries</code>, <code>assert_queries_match</code>, and<br>\n<code>assert_no_queries_match</code> assertions public.</p>\n<p>To assert the expected number of queries are made, Rails internally uses <code>assert_queries_count</code> and<br>\n<code>assert_no_queries</code>. To assert that specific SQL queries are made, <code>assert_queries_match</code> and<br>\n<code>assert_no_queries_match</code> are used. These assertions can now be used in applications as well.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class ArticleTest &lt; ActiveSupport::TestCase\n  test &quot;queries are made&quot; do\n    assert_queries_count(1) { Article.first }\n  end\n\n  test &quot;creates a foreign key&quot; do\n    assert_queries_match(/ADD FOREIGN KEY/i, include_schema: true) do\n      @ connection.add_foreign_key(:comments, :posts)\n    end\n  end\nend\"><pre><span class=\"pl-k\">class</span> <span class=\"pl-v\">ArticleTest</span> &lt; <span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">TestCase</span>\n  <span class=\"pl-en\">test</span> <span class=\"pl-s\">\"queries are made\"</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-en\">assert_queries_count</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span> <span class=\"pl-v\">Article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span> <span class=\"pl-kos\">}</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-en\">test</span> <span class=\"pl-s\">\"creates a foreign key\"</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-en\">assert_queries_match</span><span class=\"pl-kos\">(</span><span class=\"pl-sr\">/ADD FOREIGN KEY/i</span><span class...","reactions":{"url":"https://api.github.com/repos/INexizI/KR-DB/issues/397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/INexizI/KR-DB/issues/397/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"}]