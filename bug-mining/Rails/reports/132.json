{"url":"https://api.github.com/repos/rails/rails/issues/52586","repository_url":"https://api.github.com/repos/rails/rails","labels_url":"https://api.github.com/repos/rails/rails/issues/52586/labels{/name}","comments_url":"https://api.github.com/repos/rails/rails/issues/52586/comments","events_url":"https://api.github.com/repos/rails/rails/issues/52586/events","html_url":"https://github.com/rails/rails/issues/52586","id":2461928655,"node_id":"I_kwDNIULOkr4Mzw","number":52586,"title":"Underscore-prefixed options to `enum` are silently ignored","user":{"login":"mattbrictson","id":189693,"node_id":"MDQ6VXNlcjE4OTY5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/189693?v=4","gravatar_id":"","url":"https://api.github.com/users/mattbrictson","html_url":"https://github.com/mattbrictson","followers_url":"https://api.github.com/users/mattbrictson/followers","following_url":"https://api.github.com/users/mattbrictson/following{/other_user}","gists_url":"https://api.github.com/users/mattbrictson/gists{/gist_id}","starred_url":"https://api.github.com/users/mattbrictson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mattbrictson/subscriptions","organizations_url":"https://api.github.com/users/mattbrictson/orgs","repos_url":"https://api.github.com/users/mattbrictson/repos","events_url":"https://api.github.com/users/mattbrictson/events{/privacy}","received_events_url":"https://api.github.com/users/mattbrictson/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2024-08-12T21:30:30Z","updated_at":"2024-08-14T17:49:28Z","closed_at":"2024-08-14T17:49:28Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Steps to reproduce\r\n\r\nI had an enum defined in the deprecated style:\r\n\r\n```ruby\r\nenum status: { open: \"open\", closed: \"closed\" }, _prefix: true\r\n```\r\n\r\nUpon upgrading to Rails 7.2, I saw this warning:\r\n\r\n> Defining enums with keyword arguments is deprecated and will be removed\r\n> in Rails 8.0. Positional arguments should be used instead\r\n>\r\n> `enum :status, {:open=>\"open\", :closed=>\"closed\"}`\r\n\r\nFollowing the instructions in the deprecation message, I changed my code to:\r\n\r\n```ruby\r\nenum :status, { open: \"open\", closed: \"closed\" }, _prefix: true\r\n```\r\n\r\nTo my surprise, the `:_prefix` option is now no longer honored, changing the behavior of the enum and breaking my tests. This was not mentioned in the deprecation message or in the Rails 7.2 upgrade notes.\r\n\r\n### Expected behavior\r\n\r\nI expect an error to be raised (e.g. \"`:_prefix is not a valid enum option`) or a warning to be emitted.\r\n\r\nIt would also be nice if the original deprecation warning had included non-underscored options in its code recommendation, i.e.:\r\n\r\n> Defining enums with keyword arguments is deprecated and will be removed\r\n> in Rails 8.0. Positional arguments should be used instead\r\n>\r\n> `enum :status, {:open=>\"open\", :closed=>\"closed\"}, prefix: true`\r\n\r\n### Actual behavior\r\n\r\nThe `:_prefix` option is silently ignored and has no apparent effect on the enum.\r\n\r\n### System configuration\r\n\r\n**Rails version**:Rails 7.2.0\r\n\r\n**Ruby version**: ruby 3.3.4 (2024-07-09 revision be1089c8ec) [x86_64-darwin23]\r\n","closed_by":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rails/rails/issues/52586/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rails/rails/issues/52586/timeline","performed_via_github_app":null,"state_reason":"completed"}