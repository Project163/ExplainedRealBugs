{"url":"https://api.github.com/repos/rails/rails/issues/48748","repository_url":"https://api.github.com/repos/rails/rails","labels_url":"https://api.github.com/repos/rails/rails/issues/48748/labels{/name}","comments_url":"https://api.github.com/repos/rails/rails/issues/48748/comments","events_url":"https://api.github.com/repos/rails/rails/issues/48748/events","html_url":"https://github.com/rails/rails/issues/48748","id":1808053524,"node_id":"I_kwDNIULOa8S1FA","number":48748,"title":"Rails cache storage not working propertly","user":{"login":"me-kirill","id":111381,"node_id":"MDQ6VXNlcjExMTM4MQ==","avatar_url":"https://avatars.githubusercontent.com/u/111381?v=4","gravatar_id":"","url":"https://api.github.com/users/me-kirill","html_url":"https://github.com/me-kirill","followers_url":"https://api.github.com/users/me-kirill/followers","following_url":"https://api.github.com/users/me-kirill/following{/other_user}","gists_url":"https://api.github.com/users/me-kirill/gists{/gist_id}","starred_url":"https://api.github.com/users/me-kirill/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/me-kirill/subscriptions","organizations_url":"https://api.github.com/users/me-kirill/orgs","repos_url":"https://api.github.com/users/me-kirill/repos","events_url":"https://api.github.com/users/me-kirill/events{/privacy}","received_events_url":"https://api.github.com/users/me-kirill/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"jonathanhefner","id":771968,"node_id":"MDQ6VXNlcjc3MTk2OA==","avatar_url":"https://avatars.githubusercontent.com/u/771968?v=4","gravatar_id":"","url":"https://api.github.com/users/jonathanhefner","html_url":"https://github.com/jonathanhefner","followers_url":"https://api.github.com/users/jonathanhefner/followers","following_url":"https://api.github.com/users/jonathanhefner/following{/other_user}","gists_url":"https://api.github.com/users/jonathanhefner/gists{/gist_id}","starred_url":"https://api.github.com/users/jonathanhefner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jonathanhefner/subscriptions","organizations_url":"https://api.github.com/users/jonathanhefner/orgs","repos_url":"https://api.github.com/users/jonathanhefner/repos","events_url":"https://api.github.com/users/jonathanhefner/events{/privacy}","received_events_url":"https://api.github.com/users/jonathanhefner/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"jonathanhefner","id":771968,"node_id":"MDQ6VXNlcjc3MTk2OA==","avatar_url":"https://avatars.githubusercontent.com/u/771968?v=4","gravatar_id":"","url":"https://api.github.com/users/jonathanhefner","html_url":"https://github.com/jonathanhefner","followers_url":"https://api.github.com/users/jonathanhefner/followers","following_url":"https://api.github.com/users/jonathanhefner/following{/other_user}","gists_url":"https://api.github.com/users/jonathanhefner/gists{/gist_id}","starred_url":"https://api.github.com/users/jonathanhefner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jonathanhefner/subscriptions","organizations_url":"https://api.github.com/users/jonathanhefner/orgs","repos_url":"https://api.github.com/users/jonathanhefner/repos","events_url":"https://api.github.com/users/jonathanhefner/events{/privacy}","received_events_url":"https://api.github.com/users/jonathanhefner/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":1,"created_at":"2023-07-17T15:38:32Z","updated_at":"2023-07-17T18:18:13Z","closed_at":"2023-07-17T18:18:06Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Steps to reproduce\r\n\r\n\r\n1. Init new app\r\n``` bash\r\nrails new rails-test --main\r\ncd rails-test\r\nbundle add dalli\r\ntouch tmp/caching-dev.txt\r\n```\r\n\r\n2. Set cache store in development.rb\r\n\r\n```ruby\r\nconfig.cache_store = :mem_cache_store\r\n```\r\n\r\n3. Run console\r\n``` bash\r\nrails c\r\n```\r\n\r\n4. Try to write cache\r\n```ruby\r\nirb(main):001:0> Rails.cache.clear\r\nDalli::Server#connect 127.0.0.1:11211\r\n=> [true]\r\nirb(main):002:0> Rails.cache.write(\"test\", \"MÃ¡s\")\r\n/Users/benone/.rbenv/versions/3.2.2/lib/ruby/gems/3.2.0/bundler/gems/rails-e18791c0bf2e/activesupport/lib/active_support/cache/serializer_with_fallback.rb:80:in `try_dump_bare_string': incompatible character encodings: ASCII-8BIT and UTF-8 (Encoding::CompatibilityError)\r\n```\r\n\r\n### Expected behavior\r\nWritten cache.\r\n\r\n### Actual behavior\r\nEncoding::CompatibilityError Exception \r\n\r\n### System configuration\r\n**Rails version**:\r\nrails main (e18791c0bf2e)\r\n\r\n**Ruby version**:\r\nruby 3.2.2 (2023-03-30 revision e51014f9c0) +YJIT [arm64-darwin22]\r\n\r\n\r\n\r\n### Related issue:\r\nhttps://github.com/rails/rails/issues/48196","closed_by":{"login":"jonathanhefner","id":771968,"node_id":"MDQ6VXNlcjc3MTk2OA==","avatar_url":"https://avatars.githubusercontent.com/u/771968?v=4","gravatar_id":"","url":"https://api.github.com/users/jonathanhefner","html_url":"https://github.com/jonathanhefner","followers_url":"https://api.github.com/users/jonathanhefner/followers","following_url":"https://api.github.com/users/jonathanhefner/following{/other_user}","gists_url":"https://api.github.com/users/jonathanhefner/gists{/gist_id}","starred_url":"https://api.github.com/users/jonathanhefner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jonathanhefner/subscriptions","organizations_url":"https://api.github.com/users/jonathanhefner/orgs","repos_url":"https://api.github.com/users/jonathanhefner/repos","events_url":"https://api.github.com/users/jonathanhefner/events{/privacy}","received_events_url":"https://api.github.com/users/jonathanhefner/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rails/rails/issues/48748/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rails/rails/issues/48748/timeline","performed_via_github_app":null,"state_reason":"completed"}