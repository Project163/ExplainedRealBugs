{"url":"https://api.github.com/repos/rails/rails/issues/54890","repository_url":"https://api.github.com/repos/rails/rails","labels_url":"https://api.github.com/repos/rails/rails/issues/54890/labels{/name}","comments_url":"https://api.github.com/repos/rails/rails/issues/54890/comments","events_url":"https://api.github.com/repos/rails/rails/issues/54890/events","html_url":"https://github.com/rails/rails/issues/54890","id":2979135791,"node_id":"I_kwDNIULOsZIBLw","number":54890,"title":"Flaky \"ActiveStorage::ImageTagTest#test_blob\"","user":{"login":"voxik","id":14406,"node_id":"MDQ6VXNlcjE0NDA2","avatar_url":"https://avatars.githubusercontent.com/u/14406?v=4","gravatar_id":"","url":"https://api.github.com/users/voxik","html_url":"https://github.com/voxik","followers_url":"https://api.github.com/users/voxik/followers","following_url":"https://api.github.com/users/voxik/following{/other_user}","gists_url":"https://api.github.com/users/voxik/gists{/gist_id}","starred_url":"https://api.github.com/users/voxik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/voxik/subscriptions","organizations_url":"https://api.github.com/users/voxik/orgs","repos_url":"https://api.github.com/users/voxik/repos","events_url":"https://api.github.com/users/voxik/events{/privacy}","received_events_url":"https://api.github.com/users/voxik/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":41328116,"node_id":"MDU6TGFiZWw0MTMyODExNg==","url":"https://api.github.com/repos/rails/rails/labels/attached%20PR","name":"attached PR","color":"006b75","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2025-04-08T09:13:25Z","updated_at":"2025-07-10T09:31:59Z","closed_at":"2025-04-11T06:48:02Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"In my testing, I observe following error from time to time:\n\n~~~\n$ bundle exec ruby -Itest -ractive_storage/engine -e 'Dir.glob \"./test/**/*_test.rb\", &method(:require)'\n/usr/share/gems/gems/mini_magick-4.11.0/lib/mini_magick/image/info.rb:70: warning: ambiguous `/`; wrap regexp in parentheses or add a space after `/` operator\nMissing service configuration file in /builddir/build/BUILD/rubygem-activestorage-8.0.1-build/activestorage-8.0.1/usr/share/gems/gems/activestorage-8.0.1/test/service/configurations.yml\n== 20170806125915 CreateActiveStorageTables: migrating ========================\n-- create_table(:active_storage_blobs, {id: :primary_key})\n   -> 0.0013s\n-- create_table(:active_storage_attachments, {id: :primary_key})\n   -> 0.0020s\n-- create_table(:active_storage_variant_records, {id: :primary_key})\n   -> 0.0061s\n== 20170806125915 CreateActiveStorageTables: migrated (0.0094s) ===============\n\n==  ActiveStorageCreateUsers: migrating =======================================\n-- create_table(:users)\n   -> 0.0023s\n==  ActiveStorageCreateUsers: migrated (0.0024s) ==============================\n\n==  ActiveStorageCreateGroups: migrating ======================================\n-- create_table(:groups)\n   -> 0.0002s\n==  ActiveStorageCreateGroups: migrated (0.0002s) =============================\n\nSkipping S3 Direct Upload tests because no S3 configuration was supplied\nSkipping GCS Direct Upload tests because no GCS configuration was supplied\nSkipping Azure Storage Direct Upload tests because no Azure Storage configuration was supplied\nSkipping Azure Storage Public Service tests because no Azure configuration was supplied\nSkipping Azure Storage Service tests because no Azure configuration was supplied\nSkipping GCS Public Service tests because no GCS configuration was supplied\nSkipping GCS Service tests because no GCS configuration was supplied\nSkipping S3 Public Service tests because no S3 configuration was supplied\nSkipping S3 Service tests because no S3 configuration was supplied\nRun options: --seed 25652\n\n# Running:\n\nE\n\nError:\nActiveStorage::ImageTagTest#test_blob:\nNoMethodError: undefined method 'blob_url' for an instance of ActiveStorage::ImageTagTest\n    /usr/share/gems/gems/activerecord-8.0.1/lib/active_record/test_fixtures.rb:280:in 'ActiveRecord::TestFixtures#method_missing'\n    /usr/share/gems/gems/actionpack-8.0.1/lib/action_dispatch/testing/assertions/routing.rb:265:in 'ActionDispatch::Assertions::RoutingAssertions#method_missing'\n    /usr/share/gems/gems/actionview-8.0.1/lib/action_view/test_case.rb:430:in 'ActionView::TestCase::Behavior#method_missing'\n    /usr/share/gems/gems/actionpack-8.0.1/lib/action_dispatch/routing/polymorphic_routes.rb:240:in 'Kernel#public_send'\n    /usr/share/gems/gems/actionpack-8.0.1/lib/action_dispatch/routing/polymorphic_routes.rb:240:in 'ActionDispatch::Routing::PolymorphicRoutes::HelperMethodBuilder.polymorphic_method'\n    /usr/share/gems/gems/actionpack-8.0.1/lib/action_dispatch/routing/polymorphic_routes.rb:125:in 'ActionDispatch::Routing::PolymorphicRoutes#polymorphic_url'\n    test/template/image_tag_test.rb:14:in 'block in <class:ImageTagTest>'\n\nbin/rails test /builddir/build/BUILD/rubygem-activestorage-8.0.1-build/activestorage-8.0.1/usr/share/gems/gems/activestorage-8.0.1/test/template/image_tag_test.rb:13\n\n......./usr/share/gems/gems/ffi-1.17.0/lib/ffi/function.rb:65: warning: method redefined; discarding old vips_object_print_all\n/usr/share/gems/gems/ffi-1.17.0/lib/ffi/function.rb:65: warning: method redefined; discarding old vips_object_print_all\n...........WARNING: The convert command is deprecated in IMv7, use \"magick\" instead of \"convert\" or \"magick convert\"\n\n.....WARNING: The convert command is deprecated in IMv7, use \"magick\" instead of \"convert\" or \"magick convert\"\n\n..........................S.SS.SSS................SS....................S........................................................S.............................................................................................................................................S..S.............................................................................................................................................................S.........................\n\nFinished in 12.001350s, 40.1621 runs/s, 119.6532 assertions/s.\n482 runs, 1436 assertions, 0 failures, 1 errors, 13 skips\n\nYou have skipped tests. Run with --verbose for details.\n~~~\n\nI'd say that some `require` is missing somewhere and hence it depends on the order of test execution if I hit the issue or not","closed_by":{"login":"byroot","id":44640,"node_id":"MDQ6VXNlcjQ0NjQw","avatar_url":"https://avatars.githubusercontent.com/u/44640?v=4","gravatar_id":"","url":"https://api.github.com/users/byroot","html_url":"https://github.com/byroot","followers_url":"https://api.github.com/users/byroot/followers","following_url":"https://api.github.com/users/byroot/following{/other_user}","gists_url":"https://api.github.com/users/byroot/gists{/gist_id}","starred_url":"https://api.github.com/users/byroot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/byroot/subscriptions","organizations_url":"https://api.github.com/users/byroot/orgs","repos_url":"https://api.github.com/users/byroot/repos","events_url":"https://api.github.com/users/byroot/events{/privacy}","received_events_url":"https://api.github.com/users/byroot/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rails/rails/issues/54890/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rails/rails/issues/54890/timeline","performed_via_github_app":null,"state_reason":"completed"}