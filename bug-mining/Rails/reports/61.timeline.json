[{"url":"https://api.github.com/repos/rails/rails/issues/comments/1732930815","html_url":"https://github.com/rails/rails/issues/49373#issuecomment-1732930815","issue_url":"https://api.github.com/repos/rails/rails/issues/49373","id":1732930815,"node_id":"IC_kwDNIULOZ0ps_w","user":{"login":"yahonda","id":73684,"node_id":"MDQ6VXNlcjczNjg0","avatar_url":"https://avatars.githubusercontent.com/u/73684?v=4","gravatar_id":"","url":"https://api.github.com/users/yahonda","html_url":"https://github.com/yahonda","followers_url":"https://api.github.com/users/yahonda/followers","following_url":"https://api.github.com/users/yahonda/following{/other_user}","gists_url":"https://api.github.com/users/yahonda/gists{/gist_id}","starred_url":"https://api.github.com/users/yahonda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yahonda/subscriptions","organizations_url":"https://api.github.com/users/yahonda/orgs","repos_url":"https://api.github.com/users/yahonda/repos","events_url":"https://api.github.com/users/yahonda/events{/privacy}","received_events_url":"https://api.github.com/users/yahonda/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-25T05:17:58Z","updated_at":"2023-09-25T05:17:58Z","body":"Unable to create a minimum steps using `minitest_bisect` because the bisect loop never finishes. I'm wondering why `SQLite3::IOException: disk I/O error` raised when `ARCONN=postgresql` is specified.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/comments/1732930815/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yahonda","id":73684,"node_id":"MDQ6VXNlcjczNjg0","avatar_url":"https://avatars.githubusercontent.com/u/73684?v=4","gravatar_id":"","url":"https://api.github.com/users/yahonda","html_url":"https://github.com/yahonda","followers_url":"https://api.github.com/users/yahonda/followers","following_url":"https://api.github.com/users/yahonda/following{/other_user}","gists_url":"https://api.github.com/users/yahonda/gists{/gist_id}","starred_url":"https://api.github.com/users/yahonda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yahonda/subscriptions","organizations_url":"https://api.github.com/users/yahonda/orgs","repos_url":"https://api.github.com/users/yahonda/repos","events_url":"https://api.github.com/users/yahonda/events{/privacy}","received_events_url":"https://api.github.com/users/yahonda/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":10457759838,"node_id":"LE_lADNIULOceKy6c8AAAACb1TAXg","url":"https://api.github.com/repos/rails/rails/issues/events/10457759838","actor":{"login":"yahonda","id":73684,"node_id":"MDQ6VXNlcjczNjg0","avatar_url":"https://avatars.githubusercontent.com/u/73684?v=4","gravatar_id":"","url":"https://api.github.com/users/yahonda","html_url":"https://github.com/yahonda","followers_url":"https://api.github.com/users/yahonda/followers","following_url":"https://api.github.com/users/yahonda/following{/other_user}","gists_url":"https://api.github.com/users/yahonda/gists{/gist_id}","starred_url":"https://api.github.com/users/yahonda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yahonda/subscriptions","organizations_url":"https://api.github.com/users/yahonda/orgs","repos_url":"https://api.github.com/users/yahonda/repos","events_url":"https://api.github.com/users/yahonda/events{/privacy}","received_events_url":"https://api.github.com/users/yahonda/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-09-25T05:39:44Z","label":{"name":"activerecord","color":"0b02e1"},"performed_via_github_app":null},{"id":10457759844,"node_id":"LE_lADNIULOceKy6c8AAAACb1TAZA","url":"https://api.github.com/repos/rails/rails/issues/events/10457759844","actor":{"login":"yahonda","id":73684,"node_id":"MDQ6VXNlcjczNjg0","avatar_url":"https://avatars.githubusercontent.com/u/73684?v=4","gravatar_id":"","url":"https://api.github.com/users/yahonda","html_url":"https://github.com/yahonda","followers_url":"https://api.github.com/users/yahonda/followers","following_url":"https://api.github.com/users/yahonda/following{/other_user}","gists_url":"https://api.github.com/users/yahonda/gists{/gist_id}","starred_url":"https://api.github.com/users/yahonda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yahonda/subscriptions","organizations_url":"https://api.github.com/users/yahonda/orgs","repos_url":"https://api.github.com/users/yahonda/repos","events_url":"https://api.github.com/users/yahonda/events{/privacy}","received_events_url":"https://api.github.com/users/yahonda/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-09-25T05:39:44Z","label":{"name":"ci issues","color":"aaafff"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/rails/rails/issues/comments/1733862233","html_url":"https://github.com/rails/rails/issues/49373#issuecomment-1733862233","issue_url":"https://api.github.com/repos/rails/rails/issues/49373","id":1733862233,"node_id":"IC_kwDNIULOZ1ijWQ","user":{"login":"yahonda","id":73684,"node_id":"MDQ6VXNlcjczNjg0","avatar_url":"https://avatars.githubusercontent.com/u/73684?v=4","gravatar_id":"","url":"https://api.github.com/users/yahonda","html_url":"https://github.com/yahonda","followers_url":"https://api.github.com/users/yahonda/followers","following_url":"https://api.github.com/users/yahonda/following{/other_user}","gists_url":"https://api.github.com/users/yahonda/gists{/gist_id}","starred_url":"https://api.github.com/users/yahonda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yahonda/subscriptions","organizations_url":"https://api.github.com/users/yahonda/orgs","repos_url":"https://api.github.com/users/yahonda/repos","events_url":"https://api.github.com/users/yahonda/events{/privacy}","received_events_url":"https://api.github.com/users/yahonda/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-25T14:43:26Z","updated_at":"2023-09-25T14:53:53Z","body":"According to `git bisect`, this error reproduces since c6d7ffc7b870f8c17b9f055f5a239253789a2b5b via #49349\r\n\r\n- Does not reproduce with 7c07787 that is the previous commit of c6d7ffc7b870f8c17b9f055f5a239253789a2b5b at the main branch\r\n\r\n```ruby\r\ngit reset --hard 7c07787\r\nbundle update sdoc --conservative # or rm ../Gemfile.lock ; bundle install\r\nARCONN=postgresql bin/test \"test/cases/active_record_schema_test.rb\" \"test/cases/active_record_test.rb\" \"test/cases/adapter_prevent_writes_test.rb\" \"test/cases/adapter_test.rb\" \"test/cases/aggregations_test.rb\" \"test/cases/annotate_test.rb\" \"test/cases/arel/attributes/attribute_test.rb\" \"test/cases/arel/attributes/math_test.rb\" \"test/cases/arel/attributes_test.rb\" \"test/cases/arel/collectors/bind_test.rb\" \"test/cases/arel/collectors/composite_test.rb\" \"test/cases/arel/collectors/sql_string_test.rb\" \"test/cases/arel/collectors/substitute_bind_collector_test.rb\" \"test/cases/arel/crud_test.rb\" \"test/cases/arel/delete_manager_test.rb\" \"test/cases/arel/factory_methods_test.rb\" \"test/cases/arel/insert_manager_test.rb\" \"test/cases/arel/nodes/and_test.rb\" \"test/cases/arel/nodes/as_test.rb\" \"test/cases/arel/nodes/ascending_test.rb\" \"test/cases/arel/nodes/bin_test.rb\" \"test/cases/arel/nodes/binary_test.rb\" \"test/cases/arel/nodes/bind_param_test.rb\" \"test/cases/arel/nodes/bound_sql_literal_test.rb\" \"test/cases/arel/nodes/case_test.rb\" \"test/cases/arel/nodes/casted_test.rb\" \"test/cases/arel/nodes/comment_test.rb\" \"test/cases/arel/nodes/count_test.rb\" \"test/cases/arel/nodes/cte_test.rb\" \"test/cases/arel/nodes/delete_statement_test.rb\" \"test/cases/arel/nodes/descending_test.rb\" \"test/cases/arel/nodes/distinct_test.rb\" \"test/cases/arel/nodes/equality_test.rb\" \"test/cases/arel/nodes/extract_test.rb\" \"test/cases/arel/nodes/false_test.rb\" \"test/cases/arel/nodes/filter_test.rb\" \"test/cases/arel/nodes/fragments_test.rb\" \"test/cases/arel/nodes/grouping_test.rb\" \"test/cases/arel/nodes/homogeneous_in_test.rb\" \"test/cases/arel/nodes/infix_operation_test.rb\" \"test/cases/arel/nodes/insert_statement_test.rb\" \"test/cases/arel/nodes/named_function_test.rb\" \"test/cases/arel/nodes/node_test.rb\" \"test/cases/arel/nodes/not_test.rb\" \"test/cases/arel/nodes/or_test.rb\" \"test/cases/arel/nodes/over_test.rb\" \"test/cases/arel/nodes/select_core_test.rb\" \"test/cases/arel/nodes/select_statement_test.rb\" \"test/cases/arel/nodes/sql_literal_test.rb\" \"test/cases/arel/nodes/sum_test.rb\" \"test/cases/arel/nodes/table_alias_test.rb\" \"test/cases/arel/nodes/true_test.rb\" \"test/cases/arel/nodes/unary_operation_test.rb\" \"test/cases/arel/nodes/update_statement_test.rb\" \"test/cases/arel/nodes/window_test.rb\" \"test/cases/arel/nodes_test.rb\" \"test/cases/arel/select_manager_test.rb\" \"test/cases/arel/table_test.rb\" \"test/cases/arel/update_manager_test.rb\" \"test/cases/arel/visitors/dispatch_contamination_test.rb\" \"test/cases/arel/visitors/dot_test.rb\" \"test/cases/arel/visitors/mysql_test.rb\" \"test/cases/arel/visitors/postgres_test.rb\" \"test/cases/arel/visitors/sqlite_test.rb\" \"test/cases/arel/visitors/to_sql_test.rb\" \"test/cases/associations/belongs_to_associations_test.rb\" \"test/cases/associations/bidirectional_destroy_dependencies_test.rb\" \"test/cases/associations/callbacks_test.rb\" \"test/cases/associations/cascaded_eager_loading_test.rb\" \"test/cases/associations/eager_load_includes_full_sti_class_test.rb\" \"test/cases/associations/eager_load_nested_include_test.rb\" \"test/cases/associations/eager_singularization_test.rb\" \"test/cases/associations/eager_test.rb\" \"test/cases/associations/extension_test.rb\" \"test/cases/associations/has_and_belongs_to_many_associations_test.rb\" \"test/cases/associations/has_many_associations_test.rb\" \"test/cases/associations/has_many_through_associations_test.rb\" \"test/cases/associations/has_many_through_disable_joins_associations_test.rb\" \"test/cases/associations/has_one_associations_test.rb\" \"test/cases/associations/has_one_through_associations_test.rb\" \"test/cases/associations/has_one_through_disable_joins_associations_test.rb\" \"test/cases/associations/inner_join_association_test.rb\" \"test/cases/associations/inverse_associations_test.rb\" \"test/cases/associations/join_model_test.rb\" \"test/cases/associations/left_outer_join_association_test.rb\" \"test/cases/associations/nested_through_associations_test.rb\" \"test/cases/associations/required_test.rb\" \"test/cases/associations_test.rb\" \"test/cases/asynchronous_queries_test.rb\" \"test/cases/attribute_methods/read_test.rb\" \"test/cases/attribute_methods_test.rb\" \"test/cases/attributes_test.rb\" \"test/cases/autosave_association_test.rb\" \"test/cases/base_prevent_writes_test.rb\" \"test/cases/base_test.rb\" \"test/cases/batches_test.rb\" \"test/cases/binary_test.rb\" \"test/cases/bind_parameter_test.rb\" \"test/cases/boolean_test.rb\" \"test/cases/cache_key_test.rb\" \"test/cases/calculations_test.rb\" \"test/cases/callbacks_test.rb\" \"test/cases/clone_test.rb\" \"test/cases/coders/json_test.rb\" \"test/cases/coders/yaml_column_test.rb\" \"test/cases/collection_cache_key_test.rb\" \"test/cases/column_alias_test.rb\" \"test/cases/column_definition_test.rb\" \"test/cases/comment_test.rb\" \"test/cases/connection_adapters/adapter_leasing_test.rb\" \"test/cases/connection_adapters/connection_handler_test.rb\" \"test/cases/connection_adapters/connection_handlers_multi_db_test.rb\" \"test/cases/connection_adapters/connection_handlers_multi_pool_config_test.rb\" \"test/cases/connection_adapters/connection_handlers_sharding_db_test.rb\" \"test/cases/connection_adapters/connection_swapping_nested_test.rb\" \"test/cases/connection_adapters/merge_and_resolve_default_url_config_test.rb\" \"test/cases/connection_adapters/mysql_type_lookup_test.rb\" \"test/cases/connection_adapters/schema_cache_test.rb\" \"test/cases/connection_adapters/standalone_connection_test.rb\" \"test/cases/connection_adapters/type_lookup_test.rb\" \"test/cases/connection_management_test.rb\" \"test/cases/connection_pool_test.rb\" \"test/cases/core_test.rb\" \"test/cases/counter_cache_test.rb\" \"test/cases/custom_locking_test.rb\" \"test/cases/database_configurations/hash_config_test.rb\" \"test/cases/database_configurations/resolver_test.rb\" \"test/cases/database_configurations_test.rb\" \"test/cases/database_selector_test.rb\" \"test/cases/database_statements_test.rb\" \"test/cases/date_test.rb\" \"test/cases/date_time_precision_test.rb\" \"test/cases/date_time_test.rb\" \"test/cases/defaults_test.rb\" \"test/cases/delegated_type_test.rb\" \"test/cases/dirty_test.rb\" \"test/cases/disconnected_test.rb\" \"test/cases/dup_test.rb\" \"test/cases/encryption/cipher/aes256_gcm_test.rb\" \"test/cases/encryption/cipher_test.rb\" \"test/cases/encryption/concurrency_test.rb\" \"test/cases/encryption/config_test.rb\" \"test/cases/encryption/configurable_test.rb\" \"test/cases/encryption/contexts_test.rb\" \"test/cases/encryption/derived_secret_key_provider_test.rb\" \"test/cases/encryption/deterministic_key_provider_test.rb\" \"test/cases/encryption/encryptable_record_api_test.rb\" \"test/cases/encryption/encryptable_record_test.rb\" \"test/cases/encryption/encrypted_fixtures_test.rb\" \"test/cases/encryption/encrypting_only_encryptor_test.rb\" \"test/cases/encryption/encryption_schemes_test.rb\" \"test/cases/encryption/encryptor_test.rb\" \"test/cases/encryption/envelope_encryption_key_provider_test.rb\" \"test/cases/encryption/extended_deterministic_queries_test.rb\" \"test/cases/encryption/key_generator_test.rb\" \"test/cases/encryption/key_provider_test.rb\" \"test/cases/encryption/key_test.rb\" \"test/cases/encryption/message_serializer_test.rb\" \"test/cases/encryption/message_test.rb\" \"test/cases/encryption/null_encryptor_test.rb\" \"test/cases/encryption/properties_test.rb\" \"test/cases/encryption/read_only_null_encryptor_test.rb\" \"test/cases/encryption/scheme_test.rb\" \"test/cases/encryption/unencrypted_attributes_test.rb\" \"test/cases/encryption/uniqueness_validations_test.rb\" \"test/cases/enum_test.rb\" \"test/cases/errors_test.rb\" \"test/cases/excluding_test.rb\" \"test/cases/explain_subscriber_test.rb\" \"test/cases/explain_test.rb\" \"test/cases/filter_attributes_test.rb\" \"test/cases/finder_respond_to_test.rb\" \"test/cases/finder_test.rb\" \"test/cases/fixture_set/file_test.rb\" \"test/cases/fixtures_test.rb\" \"test/cases/forbidden_attributes_protection_test.rb\" \"test/cases/habtm_destroy_order_test.rb\" \"test/cases/hot_compatibility_test.rb\" \"test/cases/i18n_test.rb\" \"test/cases/inheritance_test.rb\" \"test/cases/insert_all_test.rb\" \"test/cases/instrumentation_test.rb\" \"test/cases/integration_test.rb\" \"test/cases/invalid_connection_test.rb\" \"test/cases/invertible_migration_test.rb\" \"test/cases/json_attribute_test.rb\" \"test/cases/json_serialization_test.rb\" \"test/cases/locking_test.rb\" \"test/cases/log_subscriber_test.rb\" \"test/cases/marshal_serialization_test.rb\" \"test/cases/message_pack_test.rb\" \"test/cases/migration/change_schema_test.rb\" \"test/cases/migration/change_table_test.rb\" \"test/cases/migration/check_constraint_test.rb\" \"test/cases/migration/column_attributes_test.rb\" \"test/cases/migration/column_positioning_test.rb\" \"test/cases/migration/columns_test.rb\" \"test/cases/migration/command_recorder_test.rb\" \"test/cases/migration/compatibility_test.rb\" \"test/cases/migration/create_join_table_test.rb\" \"test/cases/migration/exclusion_constraint_test.rb\" \"test/cases/migration/foreign_key_test.rb\" \"test/cases/migration/index_test.rb\" \"test/cases/migration/invalid_options_test.rb\" \"test/cases/migration/logger_test.rb\" \"test/cases/migration/pending_migrations_test.rb\" \"test/cases/migration/references_foreign_key_test.rb\" \"test/cases/migration/references_index_test.rb\" \"test/cases/migration/references_statements_test.rb\" \"test/cases/migration/rename_table_test.rb\" \"test/cases/migration/schema_definitions_test.rb\" \"test/cases/migration/unique_key_test.rb\" \"test/cases/migration_test.rb\" \"test/cases/migrator_test.rb\" \"test/cases/mixin_test.rb\" \"test/cases/modules_test.rb\" \"test/cases/multi_db_migrator_test.rb\" \"test/cases/multiparameter_attributes_test.rb\" \"test/cases/multiple_db_test.rb\" \"test/cases/nested_attributes_test.rb\" \"test/cases/nested_attributes_with_callbacks_test.rb\" \"test/cases/normalized_attribute_test.rb\" \"test/cases/null_relation_test.rb\" \"test/cases/numeric_data_test.rb\" \"test/cases/persistence_test.rb\" \"test/cases/pooled_connections_test.rb\" \"test/cases/prepared_statement_status_test.rb\" \"test/cases/primary_class_test.rb\" \"test/cases/primary_keys_test.rb\" \"test/cases/query_cache_test.rb\" \"test/cases/query_logs_test.rb\" \"test/cases/quoting_test.rb\" \"test/cases/readonly_test.rb\" \"test/cases/reaper_test.rb\" \"test/cases/reflection_test.rb\" \"test/cases/relation/and_test.rb\" \"test/cases/relation/delegation_test.rb\" \"test/cases/relation/delete_all_test.rb\" \"test/cases/relation/field_ordered_values_test.rb\" \"test/cases/relation/load_async_test.rb\" \"test/cases/relation/merging_test.rb\" \"test/cases/relation/mutation_test.rb\" \"test/cases/relation/or_test.rb\" \"test/cases/relation/predicate_builder_test.rb\" \"test/cases/relation/record_fetch_warning_test.rb\" \"test/cases/relation/select_test.rb\" \"test/cases/relation/structural_compatibility_test.rb\" \"test/cases/relation/update_all_test.rb\" \"test/cases/relation/where_chain_test.rb\" \"test/cases/relation/where_clause_test.rb\" \"test/cases/relation/where_test.rb\" \"test/cases/relation/with_test.rb\" \"test/cases/relation_test.rb\" \"test/cases/relations_test.rb\" \"test/cases/reload_models_test.rb\" \"test/cases/reserved_word_test.rb\" \"test/cases/result_test.rb\" \"test/cases/sanitize_test.rb\" \"test/cases/schema_dumper_test.rb\" \"test/cases/schema_loading_test.rb\" \"test/cases/scoping/default_scoping_test.rb\" \"test/cases/scoping/named_scoping_test.rb\" \"test/cases/scoping/relation_scoping_test.rb\" \"test/cases/secure_password_test.rb\" \"test/cases/secure_token_test.rb\" \"test/cases/serialization_test.rb\" \"test/cases/serialized_attribute_test.rb\" \"test/cases/shard_selector_test.rb\" \"test/cases/signed_id_test.rb\" \"test/cases/statement_cache_test.rb\" \"test/cases/statement_invalid_test.rb\" \"test/cases/store_test.rb\" \"test/cases/strict_loading_test.rb\" \"test/cases/suppressor_test.rb\" \"test/cases/tasks/database_tasks_test.rb\" \"test/cases/test_databases_test.rb\" \"test/cases/test_fixtures_test.rb\" \"test/cases/time_precision_test.rb\" \"test/cases/timestamp_test.rb\" \"test/cases/token_for_test.rb\" \"test/cases/touch_later_test.rb\" \"test/cases/transaction_callbacks_test.rb\" \"test/cases/transaction_instrumentation_test.rb\" \"test/cases/transaction_isolation_test.rb\" \"test/cases/transactions_test.rb\" \"test/cases/type/adapter_specific_registry_test.rb\" \"test/cases/type/date_time_test.rb\" \"test/cases/type/integer_test.rb\" \"test/cases/type/string_test.rb\" \"test/cases/type/time_test.rb\" \"test/cases/type/type_map_test.rb\" \"test/cases/type/unsigned_integer_test.rb\" \"test/cases/type_test.rb\" \"test/cases/types_test.rb\" \"test/cases/unconnected_test.rb\" \"test/cases/unsafe_raw_sql_test.rb\" \"test/cases/validations/absence_validation_test.rb\" \"test/cases/validations/association_validation_test.rb\" \"test/cases/validations/i18n_generate_message_validation_test.rb\" \"test/cases/validations/i18n_validation_test.rb\" \"test/cases/validations/length_validation_test.rb\" \"test/cases/validations/numericality_validation_test.rb\" \"test/cases/validations/presence_validation_test.rb\" \"test/cases/validations/uniqueness_validation_test.rb\" \"test/cases/validations_test.rb\" \"test/cases/view_test.rb\" \"test/cases/yaml_serialization_test.rb\" \"test/cases/adapters/postgresql/active_schema_test.rb\" \"test/cases/adapters/postgresql/array_test.rb\" \"test/cases/adapters/postgresql/bind_parameter_test.rb\" \"test/cases/adapters/postgresql/bit_string_test.rb\" \"test/cases/adapters/postgresql/bytea_test.rb\" \"test/cases/adapters/postgresql/case_insensitive_test.rb\" \"test/cases/adapters/postgresql/change_schema_test.rb\" \"test/cases/adapters/postgresql/cidr_test.rb\" \"test/cases/adapters/postgresql/citext_test.rb\" \"test/cases/adapters/postgresql/collation_test.rb\" \"test/cases/adapters/postgresql/composite_test.rb\" \"test/cases/adapters/postgresql/connection_test.rb\" \"test/cases/adapters/postgresql/create_unlogged_tables_test.rb\" \"test/cases/adapters/postgresql/datatype_test.rb\" \"test/cases/adapters/postgresql/date_test.rb\" \"test/cases/adapters/postgresql/dbconsole_test.rb\" \"test/cases/adapters/postgresql/domain_test.rb\" \"test/cases/adapters/postgresql/enum_test.rb\" \"test/cases/adapters/postgresql/explain_test.rb\" \"test/cases/adapters/postgresql/extension_migration_test.rb\" \"test/cases/adapters/postgresql/foreign_table_test.rb\" \"test/cases/adapters/postgresql/full_text_test.rb\" \"test/cases/adapters/postgresql/geometric_test.rb\" \"test/cases/adapters/postgresql/hstore_test.rb\" \"test/cases/adapters/postgresql/infinity_test.rb\" \"test/cases/adapters/postgresql/integer_test.rb\" \"test/cases/adapters/postgresql/interval_test.rb\" \"test/cases/adapters/postgresql/invertible_migration_test.rb\" \"test/cases/adapters/postgresql/json_test.rb\" \"test/cases/adapters/postgresql/ltree_test.rb\" \"test/cases/adapters/postgresql/money_test.rb\" \"test/cases/adapters/postgresql/network_test.rb\" \"test/cases/adapters/postgresql/numbers_test.rb\" \"test/cases/adapters/postgresql/optimizer_hints_test.rb\" \"test/cases/adapters/postgresql/partitions_test.rb\" \"test/cases/adapters/postgresql/postgresql_adapter_prevent_writes_test.rb\" \"test/cases/adapters/postgresql/postgresql_adapter_test.rb\" \"test/cases/adapters/postgresql/postgresql_rake_test.rb\" \"test/cases/adapters/postgresql/prepared_statements_disabled_test.rb\" \"test/cases/adapters/postgresql/quoting_test.rb\" \"test/cases/adapters/postgresql/range_test.rb\" \"test/cases/adapters/postgresql/referential_integrity_test.rb\" \"test/cases/adapters/postgresql/rename_table_test.rb\" \"test/cases/adapters/postgresql/schema_authorization_test.rb\" \"test/cases/adapters/postgresql/schema_test.rb\" \"test/cases/adapters/postgresql/serial_test.rb\" \"test/cases/adapters/postgresql/statement_pool_test.rb\" \"test/cases/adapters/postgresql/timestamp_test.rb\" \"test/cases/adapters/postgresql/transaction_nested_test.rb\" \"test/cases/adapters/postgresql/transaction_test.rb\" \"test/cases/adapters/postgresql/type_lookup_test.rb\" \"test/cases/adapters/postgresql/utils_test.rb\" \"test/cases/adapters/postgresql/uuid_test.rb\" \"test/cases/adapters/postgresql/virtual_column_test.rb\" \"test/cases/adapters/postgresql/xml_test.rb\" --seed 58510\r\n```\r\n-> 9248 runs, 31231 assertions, 0 failures, 0 errors, 20 skips\r\n\r\n\r\n- Reproduce with c6d7ffc7b870f8c17b9f055f5a239253789a2b5b at the main branch\r\n\r\n```ruby\r\ngit checkout -f\r\ngit reset --hard c6d7ffc7b870f8c17b9f055f5a239253789a2b5b\r\nbundle update sdoc --conservative\r\nARCONN=postgresql bin/test \"test/cases/active_record_schema_test.rb\" \"test/cases/active_record_test.rb\" \"test/cases/adapter_prevent_writes_test.rb\" \"test/cases/adapter_test.rb\" \"test/cases/aggregations_test.rb\" \"test/cases/annotate_test.rb\" \"test/cases/arel/attributes/attribute_test.rb\" \"test/cases/arel/attributes/math_test.rb\" \"test/cases/arel/attributes_test.rb\" \"test/cases/arel/collectors/bind_test.rb\" \"test/cases/arel/collectors/composite_test.rb\" \"test/cases/arel/collectors/sql_string_test.rb\" \"test/cases/arel/collectors/substitute_bind_collector_test.rb\" \"test/cases/arel/crud_test.rb\" \"test/cases/arel/delete_manager_test.rb\" \"test/cases/arel/factory_methods_test.rb\" \"test/cases/arel/insert_manager_test.rb\" \"test/cases/arel/nodes/and_test.rb\" \"test/cases/arel/nodes/as_test.rb\" \"test/cases/arel/nodes/ascending_test.rb\" \"test/cases/arel/nodes/bin_test.rb\" \"test/cases/arel/nodes/binary_test.rb\" \"test/cases/arel/nodes/bind_param_test.rb\" \"test/cases/arel/nodes/bound_sql_literal_test.rb\" \"test/cases/arel/nodes/case_test.rb\" \"test/cases/arel/nodes/casted_test.rb\" \"test/cases/arel/nodes/comment_test.rb\" \"test/cases/arel/nodes/count_test.rb\" \"test/cases/arel/nodes/cte_test.rb\" \"test/cases/arel/nodes/delete_statement_test.rb\" \"test/cases/arel/nodes/descending_test.rb\" \"test/cases/arel/nodes/distinct_test.rb\" \"test/cases/arel/nodes/equality_test.rb\" \"test/cases/arel/nodes/extract_test.rb\" \"test/cases/arel/nodes/false_test.rb\" \"test/cases/arel/nodes/filter_test.rb\" \"test/cases/arel/nodes/fragments_test.rb\" \"test/cases/arel/nodes/grouping_test.rb\" \"test/cases/arel/nodes/homogeneous_in_test.rb\" \"test/cases/arel/nodes/infix_operation_test.rb\" \"test/cases/arel/nodes/insert_statement_test.rb\" \"test/cases/arel/nodes/named_function_test.rb\" \"test/cases/arel/nodes/node_test.rb\" \"test/cases/arel/nodes/not_test.rb\" \"test/cases/arel/nodes/or_test.rb\" \"test/cases/arel/nodes/over_test.rb\" \"test/cases/arel/nodes/select_core_test.rb\" \"test/cases/arel/nodes/select_statement_test.rb\" \"test/cases/arel/nodes/sql_literal_test.rb\" \"test/cases/arel/nodes/sum_test.rb\" \"test/cases/arel/nodes/table_alias_test.rb\" \"test/cases/arel/nodes/true_test.rb\" \"test/cases/arel/nodes/unary_operation_test.rb\" \"test/cases/arel/nodes/update_statement_test.rb\" \"test/cases/arel/nodes/window_test.rb\" \"test/cases/arel/nodes_test.rb\" \"test/cases/arel/select_manager_test.rb\" \"test/cases/arel/table_test.rb\" \"test/cases/arel/update_manager_test.rb\" \"test/cases/arel/visitors/dispatch_contamination_test.rb\" \"test/cases/arel/visitors/dot_test.rb\" \"test/cases/arel/visitors/mysql_test.rb\" \"test/cases/arel/visitors/postgres_test.rb\" \"test/cases/arel/visitors/sqlite_test.rb\" \"test/cases/arel/visitors/to_sql_test.rb\" \"test/cases/associations/belongs_to_associations_test.rb\" \"test/cases/associations/bidirectional_destroy_dependencies_test.rb\" \"test/cases/associations/callbacks_test.rb\" \"test/cases/associations/cascaded_eager_loading_test.rb\" \"test/cases/associations/eager_load_includes_full_sti_class_test.rb\" \"test/cases/associations/eager_load_nested_include_test.rb\" \"test/cases/associations/eager_singularization_test.rb\" \"test/cases/associations/eager_test.rb\" \"test/cases/associations/extension_test.rb\" \"test/cases/associations/has_and_belongs_to_many_associations_test.rb\" \"test/cases/associations/has_many_associations_test.rb\" \"test/cases/associations/has_many_through_associations_test.rb\" \"test/cases/associations/has_many_through_disable_joins_associations_test.rb\" \"test/cases/associations/has_one_associations_test.rb\" \"test/cases/associations/has_one_through_associations_test.rb\" \"test/cases/associations/has_one_through_disable_joins_associations_test.rb\" \"test/cases/associations/inner_join_association_test.rb\" \"test/cases/associations/inverse_associations_test.rb\" \"test/cases/associations/join_model_test.rb\" \"test/cases/associations/left_outer_join_association_test.rb\" \"test/cases/associations/nested_through_associations_test.rb\" \"test/cases/associations/required_test.rb\" \"test/cases/associations_test.rb\" \"test/cases/asynchronous_queries_test.rb\" \"test/cases/attribute_methods/read_test.rb\" \"test/cases/attribute_methods_test.rb\" \"test/cases/attributes_test.rb\" \"test/cases/autosave_association_test.rb\" \"test/cases/base_prevent_writes_test.rb\" \"test/cases/base_test.rb\" \"test/cases/batches_test.rb\" \"test/cases/binary_test.rb\" \"test/cases/bind_parameter_test.rb\" \"test/cases/boolean_test.rb\" \"test/cases/cache_key_test.rb\" \"test/cases/calculations_test.rb\" \"test/cases/callbacks_test.rb\" \"test/cases/clone_test.rb\" \"test/cases/coders/json_test.rb\" \"test/cases/coders/yaml_column_test.rb\" \"test/cases/collection_cache_key_test.rb\" \"test/cases/column_alias_test.rb\" \"test/cases/column_definition_test.rb\" \"test/cases/comment_test.rb\" \"test/cases/connection_adapters/adapter_leasing_test.rb\" \"test/cases/connection_adapters/connection_handler_test.rb\" \"test/cases/connection_adapters/connection_handlers_multi_db_test.rb\" \"test/cases/connection_adapters/connection_handlers_multi_pool_config_test.rb\" \"test/cases/connection_adapters/connection_handlers_sharding_db_test.rb\" \"test/cases/connection_adapters/connection_swapping_nested_test.rb\" \"test/cases/connection_adapters/merge_and_resolve_default_url_config_test.rb\" \"test/cases/connection_adapters/mysql_type_lookup_test.rb\" \"test/cases/connection_adapters/schema_cache_test.rb\" \"test/cases/connection_adapters/standalone_connection_test.rb\" \"test/cases/connection_adapters/type_lookup_test.rb\" \"test/cases/connection_management_test.rb\" \"test/cases/connection_pool_test.rb\" \"test/cases/core_test.rb\" \"test/cases/counter_cache_test.rb\" \"test/cases/custom_locking_test.rb\" \"test/cases/database_configurations/hash_config_test.rb\" \"test/cases/database_configurations/resolver_test.rb\" \"test/cases/database_configurations_test.rb\" \"test/cases/database_selector_test.rb\" \"test/cases/database_statements_test.rb\" \"test/cases/date_test.rb\" \"test/cases/date_time_precision_test.rb\" \"test/cases/date_time_test.rb\" \"test/cases/defaults_test.rb\" \"test/cases/delegated_type_test.rb\" \"test/cases/dirty_test.rb\" \"test/cases/disconnected_test.rb\" \"test/cases/dup_test.rb\" \"test/cases/encryption/cipher/aes256_gcm_test.rb\" \"test/cases/encryption/cipher_test.rb\" \"test/cases/encryption/concurrency_test.rb\" \"test/cases/encryption/config_test.rb\" \"test/cases/encryption/configurable_test.rb\" \"test/cases/encryption/contexts_test.rb\" \"test/cases/encryption/derived_secret_key_provider_test.rb\" \"test/cases/encryption/deterministic_key_provider_test.rb\" \"test/cases/encryption/encryptable_record_api_test.rb\" \"test/cases/encryption/encryptable_record_test.rb\" \"test/cases/encryption/encrypted_fixtures_test.rb\" \"test/cases/encryption/encrypting_only_encryptor_test.rb\" \"test/cases/encryption/encryption_schemes_test.rb\" \"test/cases/encryption/encryptor_test.rb\" \"test/cases/encryption/envelope_encryption_key_provider_test.rb\" \"test/cases/encryption/extended_deterministic_queries_test.rb\" \"test/cases/encryption/key_generator_test.rb\" \"test/cases/encryption/key_provider_test.rb\" \"test/cases/encryption/key_test.rb\" \"test/cases/encryption/message_serializer_test.rb\" \"test/cases/encryption/message_test.rb\" \"test/cases/encryption/null_encryptor_test.rb\" \"test/cases/encryption/properties_test.rb\" \"test/cases/encryption/read_only_null_encryptor_test.rb\" \"test/cases/encryption/scheme_test.rb\" \"test/cases/encryption/unencrypted_attributes_test.rb\" \"test/cases/encryption/uniqueness_validations_test.rb\" \"test/cases/enum_test.rb\" \"test/cases/errors_test.rb\" \"test/cases/excluding_test.rb\" \"test/cases/explain_subscriber_test.rb\" \"test/cases/explain_test.rb\" \"test/cases/filter_attributes_test.rb\" \"test/cases/finder_respond_to_test.rb\" \"test/cases/finder_test.rb\" \"test/cases/fixture_set/file_test.rb\" \"test/cases/fixtures_test.rb\" \"test/cases/forbidden_attributes_protection_test.rb\" \"test/cases/habtm_destroy_order_test.rb\" \"test/cases/hot_compatibility_test.rb\" \"test/cases/i18n_test.rb\" \"test/cases/inheritance_test.rb\" \"test/cases/insert_all_test.rb\" \"test/cases/instrumentation_test.rb\" \"test/cases/integration_test.rb\" \"test/cases/invalid_connection_test.rb\" \"test/cases/invertible_migration_test.rb\" \"test/cases/json_attribute_test.rb\" \"test/cases/json_serialization_test.rb\" \"test/cases/locking_test.rb\" \"test/cases/log_subscriber_test.rb\" \"test/cases/marshal_serialization_test.rb\" \"test/cases/message_pack_test.rb\" \"test/cases/migration/change_schema_test.rb\" \"test/cases/migration/change_table_test.rb\" \"test/cases/migration/check_constraint_test.rb\" \"test/cases/migration/column_attributes_test.rb\" \"test/cases/migration/column_positioning_test.rb\" \"test/cases/migration/columns_test.rb\" \"test/cases/migration/command_recorder_test.rb\" \"test/cases/migration/compatibility_test.rb\" \"test/cases/migration/create_join_table_test.rb\" \"test/cases/migration/exclusion_constraint_test.rb\" \"test/cases/migration/foreign_key_test.rb\" \"test/cases/migration/index_test.rb\" \"test/cases/migration/invalid_options_test.rb\" \"test/cases/migration/logger_test.rb\" \"test/cases/migration/pending_migrations_test.rb\" \"test/cases/migration/references_foreign_key_test.rb\" \"test/cases/migration/references_index_test.rb\" \"test/cases/migration/references_statements_test.rb\" \"test/cases/migration/rename_table_test.rb\" \"test/cases/migration/schema_definitions_test.rb\" \"test/cases/migration/unique_key_test.rb\" \"test/cases/migration_test.rb\" \"test/cases/migrator_test.rb\" \"test/cases/mixin_test.rb\" \"test/cases/modules_test.rb\" \"test/cases/multi_db_migrator_test.rb\" \"test/cases/multiparameter_attributes_test.rb\" \"test/cases/multiple_db_test.rb\" \"test/cases/nested_attributes_test.rb\" \"test/cases/nested_attributes_with_callbacks_test.rb\" \"test/cases/normalized_attribute_test.rb\" \"test/cases/null_relation_test.rb\" \"test/cases/numeric_data_test.rb\" \"test/cases/persistence_test.rb\" \"test/cases/pooled_connections_test.rb\" \"test/cases/prepared_statement_status_test.rb\" \"test/cases/primary_class_test.rb\" \"test/cases/primary_keys_test.rb\" \"test/cases/query_cache_test.rb\" \"test/cases/query_logs_test.rb\" \"test/cases/quoting_test.rb\" \"test/cases/readonly_test.rb\" \"test/cases/reaper_test.rb\" \"test/cases/reflection_test.rb\" \"test/cases/relation/and_test.rb\" \"test/cases/relation/delegation_test.rb\" \"test/cases/relation/delete_all_test.rb\" \"test/cases/relation/field_ordered_values_test.rb\" \"test/cases/relation/load_async_test.rb\" \"test/cases/relation/merging_test.rb\" \"test/cases/relation/mutation_test.rb\" \"test/cases/relation/or_test.rb\" \"test/cases/relation/predicate_builder_test.rb\" \"test/cases/relation/record_fetch_warning_test.rb\" \"test/cases/relation/select_test.rb\" \"test/cases/relation/structural_compatibility_test.rb\" \"test/cases/relation/update_all_test.rb\" \"test/cases/relation/where_chain_test.rb\" \"test/cases/relation/where_clause_test.rb\" \"test/cases/relation/where_test.rb\" \"test/cases/relation/with_test.rb\" \"test/cases/relation_test.rb\" \"test/cases/relations_test.rb\" \"test/cases/reload_models_test.rb\" \"test/cases/reserved_word_test.rb\" \"test/cases/result_test.rb\" \"test/cases/sanitize_test.rb\" \"test/cases/schema_dumper_test.rb\" \"test/cases/schema_loading_test.rb\" \"test/cases/scoping/default_scoping_test.rb\" \"test/cases/scoping/named_scoping_test.rb\" \"test/cases/scoping/relation_scoping_test.rb\" \"test/cases/secure_password_test.rb\" \"test/cases/secure_token_test.rb\" \"test/cases/serialization_test.rb\" \"test/cases/serialized_attribute_test.rb\" \"test/cases/shard_selector_test.rb\" \"test/cases/signed_id_test.rb\" \"test/cases/statement_cache_test.rb\" \"test/cases/statement_invalid_test.rb\" \"test/cases/store_test.rb\" \"test/cases/strict_loading_test.rb\" \"test/cases/suppressor_test.rb\" \"test/cases/tasks/database_tasks_test.rb\" \"test/cases/test_databases_test.rb\" \"test/cases/test_fixtures_test.rb\" \"test/cases/time_precision_test.rb\" \"test/cases/timestamp_test.rb\" \"test/cases/token_for_test.rb\" \"test/cases/touch_later_test.rb\" \"test/cases/transaction_callbacks_test.rb\" \"test/cases/transaction_instrumentation_test.rb\" \"test/cases/transaction_isolation_test.rb\" \"test/cases/transactions_test.rb\" \"test/cases/type/adapter_specific_registry_test.rb\" \"test/cases/type/date_time_test.rb\" \"test/cases/type/integer_test.rb\" \"test/cases/type/string_test.rb\" \"test/cases/type/time_test.rb\" \"test/cases/type/type_map_test.rb\" \"test/cases/type/unsigned_integer_test.rb\" \"test/cases/type_test.rb\" \"test/cases/types_test.rb\" \"test/cases/unconnected_test.rb\" \"test/cases/unsafe_raw_sql_test.rb\" \"test/cases/validations/absence_validation_test.rb\" \"test/cases/validations/association_validation_test.rb\" \"test/cases/validations/i18n_generate_message_validation_test.rb\" \"test/cases/validations/i18n_validation_test.rb\" \"test/cases/validations/length_validation_test.rb\" \"test/cases/validations/numericality_validation_test.rb\" \"test/cases/validations/presence_validation_test.rb\" \"test/cases/validations/uniqueness_validation_test.rb\" \"test/cases/validations_test.rb\" \"test/cases/view_test.rb\" \"test/cases/yaml_serialization_test.rb\" \"test/cases/adapters/postgresql/active_schema_test.rb\" \"test/cases/adapters/postgresql/array_test.rb\" \"test/cases/adapters/postgresql/bind_parameter_test.rb\" \"test/cases/adapters/postgresql/bit_string_test.rb\" \"test/cases/adapters/postgresql/bytea_test.rb\" \"test/cases/adapters/postgresql/case_insensitive_test.rb\" \"test/cases/adapters/postgresql/change_schema_test.rb\" \"test/cases/adapters/postgresql/cidr_test.rb\" \"test/cases/adapters/postgresql/citext_test.rb\" \"test/cases/adapters/postgresql/collation_test.rb\" \"test/cases/adapters/postgresql/composite_test.rb\" \"test/cases/adapters/postgresql/connection_test.rb\" \"test/cases/adapters/postgresql/create_unlogged_tables_test.rb\" \"test/cases/adapters/postgresql/datatype_test.rb\" \"test/cases/adapters/postgresql/date_test.rb\" \"test/cases/adapters/postgresql/dbconsole_test.rb\" \"test/cases/adapters/postgresql/domain_test.rb\" \"test/cases/adapters/postgresql/enum_test.rb\" \"test/cases/adapters/postgresql/explain_test.rb\" \"test/cases/adapters/postgresql/extension_migration_test.rb\" \"test/cases/adapters/postgresql/foreign_table_test.rb\" \"test/cases/adapters/postgresql/full_text_test.rb\" \"test/cases/adapters/postgresql/geometric_test.rb\" \"test/cases/adapters/postgresql/hstore_test.rb\" \"test/cases/adapters/postgresql/infinity_test.rb\" \"test/cases/adapters/postgresql/integer_test.rb\" \"test/cases/adapters/postgresql/interval_test.rb\" \"test/cases/adapters/postgresql/invertible_migration_test.rb\" \"test/cases/adapters/postgresql/json_test.rb\" \"test/cases/adapters/postgresql/ltree_test.rb\" \"test/cases/adapters/postgresql/money_test.rb\" \"test/cases/adapters/postgresql/network_test.rb\" \"test/cases/adapters/postgresql/numbers_test.rb\" \"test/cases/adapters/postgresql/optimizer_hints_test.rb\" \"test/cases/adapters/postgresql/partitions_test.rb\" \"test/cases/adapters/postgresql/postgresql_adapter_prevent_writes_test.rb\" \"test/cases/adapters/postgresql/postgresql_adapter_test.rb\" \"test/cases/adapters/postgresql/postgresql_rake_test.rb\" \"test/cases/adapters/postgresql/prepared_statements_disabled_test.rb\" \"test/cases/adapters/postgresql/quoting_test.rb\" \"test/cases/adapters/postgresql/range_test.rb\" \"test/cases/adapters/postgresql/referential_integrity_test.rb\" \"test/cases/adapters/postgresql/rename_table_test.rb\" \"test/cases/adapters/postgresql/schema_authorization_test.rb\" \"test/cases/adapters/postgresql/schema_test.rb\" \"test/cases/adapters/postgresql/serial_test.rb\" \"test/cases/adapters/postgresql/statement_pool_test.rb\" \"test/cases/adapters/postgresql/timestamp_test.rb\" \"test/cases/adapters/postgresql/transaction_nested_test.rb\" \"test/cases/adapters/postgresql/transaction_test.rb\" \"test/cases/adapters/postgresql/type_lookup_test.rb\" \"test/cases/adapters/postgresql/utils_test.rb\" \"test/cases/adapters/postgresql/uuid_test.rb\" \"test/cases/adapters/postgresql/virtual_column_test.rb\" \"test/cases/adapters/postgresql/xml_test.rb\" --seed 58510\r\n```\r\n\r\n```ruby\r\nError:\r\nReloadModelsTest#test_has_one_with_reload:\r\nActiveRecord::StatementInvalid: SQLite3::IOException: disk I/O error\r\n    /home/yahonda/.rbenv/versions/3.2.2/lib/ruby/gems/3.2.0/gems/sqlite3-1.6.6-x86_64-linux/lib/sqlite3/database.rb:150:in `initialize'\r\n    /home/yahonda/.rbenv/versions/3.2.2/lib/ruby/gems/3.2.0/gems/sqlite3-1.6.6-x86_64-linux/lib/sqlite3/database.rb:150:in `new'\r\n    /home/yahonda/.rbenv/versions/3.2.2/lib/ruby/gems/3.2.0/gems/sqlite3-1.6.6-x86_64-linux/lib/sqlite3/database.rb:150:in `prepare'\r\n    /home/yahonda/.rbenv/versions/3.2.2/lib/ruby/gems/3.2.0/gems/sqlite3-1.6.6-x86_64-linux/lib/sqlite3/database.rb:194:in `execute'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/sqlite3/database_statements.rb:115:in `block (2 levels) in raw_execute'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/abstract_adapter.rb:1024:in `block in with_raw_connection'\r\n    /home/yahonda/src/github.com/rails/rails/activesupport/lib/active_support/concurrency/null_lock.rb:9:in `synchronize'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/abstract_adapter.rb:996:in `with_raw_connection'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/sqlite3/database_statements.rb:114:in `block in raw_execute'\r\n    /home/yahonda/src/github.com/rails/rails/activesupport/lib/active_support/notifications/instrumenter.rb:58:in `instrument'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/abstract_adapter.rb:1134:in `log'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/sqlite3/database_statements.rb:113:in `raw_execute'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb:733:in `configure_connection'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/abstract_adapter.rb:693:in `block (2 levels) in reconnect!'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb:374:in `reset_transaction'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/abstract_adapter.rb:691:in `block in reconnect!'\r\n    /home/yahonda/src/github.com/rails/rails/activesupport/lib/active_support/concurrency/null_lock.rb:9:in `synchronize'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/abstract_adapter.rb:684:in `reconnect!'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/abstract_adapter.rb:788:in `verify!'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/abstract_adapter.rb:795:in `connect!'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/abstract_adapter.rb:997:in `block in with_raw_connection'\r\n    /home/yahonda/src/github.com/rails/rails/activesupport/lib/active_support/concurrency/null_lock.rb:9:in `synchronize'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/abstract_adapter.rb:996:in `with_raw_connection'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/sqlite3/database_statements.rb:78:in `block in begin_db_transaction'\r\n    /home/yahonda/src/github.com/rails/rails/activesupport/lib/active_support/notifications/instrumenter.rb:58:in `instrument'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/abstract_adapter.rb:1134:in `log'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/sqlite3/database_statements.rb:77:in `begin_db_transaction'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/abstract/transaction.rb:369:in `materialize!'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/abstract/transaction.rb:445:in `block in begin_transaction'\r\n    /home/yahonda/src/github.com/rails/rails/activesupport/lib/active_support/concurrency/null_lock.rb:9:in `synchronize'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/abstract/transaction.rb:412:in `begin_transaction'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb:350:in `begin_transaction'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/test_fixtures.rb:149:in `block in setup_fixtures'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/test_fixtures.rb:148:in `each'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/test_fixtures.rb:148:in `setup_fixtures'\r\n    /home/yahonda/src/github.com/rails/rails/activerecord/lib/active_record/test_fixtures.rb:10:in `before_setup'\r\n\r\n\r\nbin/test test/cases/reload_models_test.rb:13\r\n\r\n\r\n\r\nFinished in 138.217101s, 66.9092 runs/s, 225.9489 assertions/s.\r\n9248 runs, 31230 assertions, 0 failures, 1 errors, 20 skips\r\n\r\nYou have skipped tests. Run with --verbose for details.\r\n```","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/comments/1733862233/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yahonda","id":73684,"node_id":"MDQ6VXNlcjczNjg0","avatar_url":"https://avatars.githubusercontent.com/u/73684?v=4","gravatar_id":"","url":"https://api.github.com/users/yahonda","html_url":"https://github.com/yahonda","followers_url":"https://api.github.com/users/yahonda/followers","following_url":"https://api.github.com/users/yahonda/following{/other_user}","gists_url":"https://api.github.com/users/yahonda/gists{/gist_id}","starred_url":"https://api.github.com/users/yahonda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yahonda/subscriptions","organizations_url":"https://api.github.com/users/yahonda/orgs","repos_url":"https://api.github.com/users/yahonda/repos","events_url":"https://api.github.com/users/yahonda/events{/privacy}","received_events_url":"https://api.github.com/users/yahonda/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rails/rails/issues/comments/1734593653","html_url":"https://github.com/rails/rails/issues/49373#issuecomment-1734593653","issue_url":"https://api.github.com/repos/rails/rails/issues/49373","id":1734593653,"node_id":"IC_kwDNIULOZ2PMdQ","user":{"login":"fatkodima","id":5657035,"node_id":"MDQ6VXNlcjU2NTcwMzU=","avatar_url":"https://avatars.githubusercontent.com/u/5657035?v=4","gravatar_id":"","url":"https://api.github.com/users/fatkodima","html_url":"https://github.com/fatkodima","followers_url":"https://api.github.com/users/fatkodima/followers","following_url":"https://api.github.com/users/fatkodima/following{/other_user}","gists_url":"https://api.github.com/users/fatkodima/gists{/gist_id}","starred_url":"https://api.github.com/users/fatkodima/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fatkodima/subscriptions","organizations_url":"https://api.github.com/users/fatkodima/orgs","repos_url":"https://api.github.com/users/fatkodima/repos","events_url":"https://api.github.com/users/fatkodima/events{/privacy}","received_events_url":"https://api.github.com/users/fatkodima/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-25T23:20:56Z","updated_at":"2023-09-25T23:20:56Z","body":"Indeed, it fails after https://github.com/rails/rails/pull/49349 was merged. The culprit line is - https://github.com/rails/rails/commit/c6d7ffc7b870f8c17b9f055f5a239253789a2b5b#diff-13f18e985e903996e81f573b1fd364c19bddde279bc2797181491e6c146bcdc7R733.  \r\n\r\nThe culprit test case is https://github.com/rails/rails/blob/38ce7fa6b12ff0b4c8bf0bcc5762e38259becaa7/activerecord/test/cases/reload_models_test.rb#L8-L27\r\n\r\nWhen using `ActiveSupport::Testing::Isolation`, Active Record tries to resurrect existing connections/pools (sorry, the terminology might be incorrect, I am not very deep into the connection handling details) in a new process when inserting fixtures. Many tests are actually using `Sqlite3Adapter`, regardless of which adapter was specified to run the tests, before that failing test run. So, sqlite connections were previously established when that test runs.\r\n\r\nIn the failing test case, if we remove the `include ActiveSupport::Testing::Isolation`, the test passes. I am wondering, if we even need that? ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/comments/1734593653/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fatkodima","id":5657035,"node_id":"MDQ6VXNlcjU2NTcwMzU=","avatar_url":"https://avatars.githubusercontent.com/u/5657035?v=4","gravatar_id":"","url":"https://api.github.com/users/fatkodima","html_url":"https://github.com/fatkodima","followers_url":"https://api.github.com/users/fatkodima/followers","following_url":"https://api.github.com/users/fatkodima/following{/other_user}","gists_url":"https://api.github.com/users/fatkodima/gists{/gist_id}","starred_url":"https://api.github.com/users/fatkodima/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fatkodima/subscriptions","organizations_url":"https://api.github.com/users/fatkodima/orgs","repos_url":"https://api.github.com/users/fatkodima/repos","events_url":"https://api.github.com/users/fatkodima/events{/privacy}","received_events_url":"https://api.github.com/users/fatkodima/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rails/rails/issues/comments/1734622843","html_url":"https://github.com/rails/rails/issues/49373#issuecomment-1734622843","issue_url":"https://api.github.com/repos/rails/rails/issues/49373","id":1734622843,"node_id":"IC_kwDNIULOZ2Q-ew","user":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-25T23:56:45Z","updated_at":"2023-09-25T23:56:45Z","body":"Yes. We need it. We don't want the `remove_const` to spread to the entire process.\r\n\r\nThe real problem is that some tests are leaking connections, instead of cleaning them up. I'm trying to fix it, but it seems `.remove_connection` is broken and needs fixing.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/comments/1734622843/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rails/rails/issues/comments/1734636424","html_url":"https://github.com/rails/rails/issues/49373#issuecomment-1734636424","issue_url":"https://api.github.com/repos/rails/rails/issues/49373","id":1734636424,"node_id":"IC_kwDNIULOZ2RziA","user":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-26T00:16:15Z","updated_at":"2023-09-26T00:16:41Z","body":"This is pretty much the problem https://github.com/rails/rails/pull/49382","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/comments/1734636424/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":10477268682,"node_id":"CE_lADNIULOceKy6c8AAAACcH5uyg","url":"https://api.github.com/repos/rails/rails/issues/events/10477268682","actor":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"5dfded9e3350b1b58de7d629774b0bd2636ba080","commit_url":"https://api.github.com/repos/rails/rails/commits/5dfded9e3350b1b58de7d629774b0bd2636ba080","created_at":"2023-09-26T16:00:47Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/rails/rails/issues/comments/1736885444","html_url":"https://github.com/rails/rails/issues/49373#issuecomment-1736885444","issue_url":"https://api.github.com/repos/rails/rails/issues/49373","id":1736885444,"node_id":"IC_kwDNIULOZ4bExA","user":{"login":"fractaledmind","id":5077225,"node_id":"MDQ6VXNlcjUwNzcyMjU=","avatar_url":"https://avatars.githubusercontent.com/u/5077225?v=4","gravatar_id":"","url":"https://api.github.com/users/fractaledmind","html_url":"https://github.com/fractaledmind","followers_url":"https://api.github.com/users/fractaledmind/followers","following_url":"https://api.github.com/users/fractaledmind/following{/other_user}","gists_url":"https://api.github.com/users/fractaledmind/gists{/gist_id}","starred_url":"https://api.github.com/users/fractaledmind/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fractaledmind/subscriptions","organizations_url":"https://api.github.com/users/fractaledmind/orgs","repos_url":"https://api.github.com/users/fractaledmind/repos","events_url":"https://api.github.com/users/fractaledmind/events{/privacy}","received_events_url":"https://api.github.com/users/fractaledmind/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-27T07:51:42Z","updated_at":"2023-09-27T07:51:42Z","body":"This isn't fully resolved yet, as can be seen by running: `SEED=31616 bundle exec rake db:postgresql:rebuild postgresql:test`. \r\n\r\nIn addition to the `ConnectionHandlersShardingDbTest`, there are other tests that spawn and incorrectly cleanup connections:\r\n\r\n* `ConnectionHandlersMultiDbTest`\r\n* `ConnectionSwappingNestedTest`","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/comments/1736885444/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fractaledmind","id":5077225,"node_id":"MDQ6VXNlcjUwNzcyMjU=","avatar_url":"https://avatars.githubusercontent.com/u/5077225?v=4","gravatar_id":"","url":"https://api.github.com/users/fractaledmind","html_url":"https://github.com/fractaledmind","followers_url":"https://api.github.com/users/fractaledmind/followers","following_url":"https://api.github.com/users/fractaledmind/following{/other_user}","gists_url":"https://api.github.com/users/fractaledmind/gists{/gist_id}","starred_url":"https://api.github.com/users/fractaledmind/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fractaledmind/subscriptions","organizations_url":"https://api.github.com/users/fractaledmind/orgs","repos_url":"https://api.github.com/users/fractaledmind/repos","events_url":"https://api.github.com/users/fractaledmind/events{/privacy}","received_events_url":"https://api.github.com/users/fractaledmind/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"fractaledmind","id":5077225,"node_id":"MDQ6VXNlcjUwNzcyMjU=","avatar_url":"https://avatars.githubusercontent.com/u/5077225?v=4","gravatar_id":"","url":"https://api.github.com/users/fractaledmind","html_url":"https://github.com/fractaledmind","followers_url":"https://api.github.com/users/fractaledmind/followers","following_url":"https://api.github.com/users/fractaledmind/following{/other_user}","gists_url":"https://api.github.com/users/fractaledmind/gists{/gist_id}","starred_url":"https://api.github.com/users/fractaledmind/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fractaledmind/subscriptions","organizations_url":"https://api.github.com/users/fractaledmind/orgs","repos_url":"https://api.github.com/users/fractaledmind/repos","events_url":"https://api.github.com/users/fractaledmind/events{/privacy}","received_events_url":"https://api.github.com/users/fractaledmind/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-27T09:57:11Z","updated_at":"2023-09-27T09:57:11Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/rails/rails/issues/49403","repository_url":"https://api.github.com/repos/rails/rails","labels_url":"https://api.github.com/repos/rails/rails/issues/49403/labels{/name}","comments_url":"https://api.github.com/repos/rails/rails/issues/49403/comments","events_url":"https://api.github.com/repos/rails/rails/issues/49403/events","html_url":"https://github.com/rails/rails/pull/49403","id":1915139173,"node_id":"PR_kwDNIULOW1FkTw","number":49403,"title":"Fix the problem of database connections leaking between tests","user":{"login":"fractaledmind","id":5077225,"node_id":"MDQ6VXNlcjUwNzcyMjU=","avatar_url":"https://avatars.githubusercontent.com/u/5077225?v=4","gravatar_id":"","url":"https://api.github.com/users/fractaledmind","html_url":"https://github.com/fractaledmind","followers_url":"https://api.github.com/users/fractaledmind/followers","following_url":"https://api.github.com/users/fractaledmind/following{/other_user}","gists_url":"https://api.github.com/users/fractaledmind/gists{/gist_id}","starred_url":"https://api.github.com/users/fractaledmind/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fractaledmind/subscriptions","organizations_url":"https://api.github.com/users/fractaledmind/orgs","repos_url":"https://api.github.com/users/fractaledmind/repos","events_url":"https://api.github.com/users/fractaledmind/events{/privacy}","received_events_url":"https://api.github.com/users/fractaledmind/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":107191,"node_id":"MDU6TGFiZWwxMDcxOTE=","url":"https://api.github.com/repos/rails/rails/labels/activerecord","name":"activerecord","color":"0b02e1","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2023-09-27T09:57:10Z","updated_at":"2023-09-27T19:08:04Z","closed_at":"2023-09-27T14:58:44Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":8514,"node_id":"MDEwOlJlcG9zaXRvcnk4NTE0","name":"rails","full_name":"rails/rails","private":false,"owner":{"login":"rails","id":4223,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQyMjM=","avatar_url":"https://avatars.githubusercontent.com/u/4223?v=4","gravatar_id":"","url":"https://api.github.com/users/rails","html_url":"https://github.com/rails","followers_url":"https://api.github.com/users/rails/followers","following_url":"https://api.github.com/users/rails/following{/other_user}","gists_url":"https://api.github.com/users/rails/gists{/gist_id}","starred_url":"https://api.github.com/users/rails/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rails/subscriptions","organizations_url":"https://api.github.com/users/rails/orgs","repos_url":"https://api.github.com/users/rails/repos","events_url":"https://api.github.com/users/rails/events{/privacy}","received_events_url":"https://api.github.com/users/rails/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/rails/rails","description":"Ruby on Rails","fork":false,"url":"https://api.github.com/repos/rails/rails","forks_url":"https://api.github.com/repos/rails/rails/forks","keys_url":"https://api.github.com/repos/rails/rails/keys{/key_id}","collaborators_url":"https://api.github.com/repos/rails/rails/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/rails/rails/teams","hooks_url":"https://api.github.com/repos/rails/rails/hooks","issue_events_url":"https://api.github.com/repos/rails/rails/issues/events{/number}","events_url":"https://api.github.com/repos/rails/rails/events","assignees_url":"https://api.github.com/repos/rails/rails/assignees{/user}","branches_url":"https://api.github.com/repos/rails/rails/branches{/branch}","tags_url":"https://api.github.com/repos/rails/rails/tags","blobs_url":"https://api.github.com/repos/rails/rails/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/rails/rails/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/rails/rails/git/refs{/sha}","trees_url":"https://api.github.com/repos/rails/rails/git/trees{/sha}","statuses_url":"https://api.github.com/repos/rails/rails/statuses/{sha}","languages_url":"https://api.github.com/repos/rails/rails/languages","stargazers_url":"https://api.github.com/repos/rails/rails/stargazers","contributors_url":"https://api.github.com/repos/rails/rails/contributors","subscribers_url":"https://api.github.com/repos/rails/rails/subscribers","subscription_url":"https://api.github.com/repos/rails/rails/subscription","commits_url":"https://api.github.com/repos/rails/rails/commits{/sha}","git_commits_url":"https://api.github.com/repos/rails/rails/git/commits{/sha}","comments_url":"https://api.github.com/repos/rails/rails/comments{/number}","issue_comment_url":"https://api.github.com/repos/rails/rails/issues/comments{/number}","contents_url":"https://api.github.com/repos/rails/rails/contents/{+path}","compare_url":"https://api.github.com/repos/rails/rails/compare/{base}...{head}","merges_url":"https://api.github.com/repos/rails/rails/merges","archive_url":"https://api.github.com/repos/rails/rails/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/rails/rails/downloads","issues_url":"https://api.github.com/repos/rails/rails/issues{/number}","pulls_url":"https://api.github.com/repos/rails/rails/pulls{/number}","milestones_url":"https://api.github.com/repos/rails/rails/milestones{/number}","notifications_url":"https://api.github.com/repos/rails/rails/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/rails/rails/labels{/name}","releases_url":"https://api.github.com/repos/rails/rails/releases{/id}","deployments_url":"https://api.github.com/repos/rails/rails/deployments","created_at":"2008-04-11T02:19:47Z","updated_at":"2025-11-10T02:03:47Z","pushed_at":"2025-11-10T00:33:52Z","git_url":"git://github.com/rails/rails.git","ssh_url":"git@github.com:rails/rails.git","clone_url":"https://github.com/rails/rails.git","svn_url":"https://github.com/rails/rails","homepage":"https://rubyonrails.org","size":271619,"stargazers_count":57840,"watchers_count":57840,"language":"Ruby","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":22025,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1341,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["activejob","activerecord","framework","html","mvc","rails","ruby"],"visibility":"public","forks":22025,"open_issues":1341,"watchers":57840,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/rails/rails/pulls/49403","html_url":"https://github.com/rails/rails/pull/49403","diff_url":"https://github.com/rails/rails/pull/49403.diff","patch_url":"https://github.com/rails/rails/pull/49403.patch","merged_at":"2023-09-27T14:58:44Z"},"body":"### Motivation / Background\r\n\r\nFixes #49373 fully\r\n\r\n@rafaelfranca's commit to address this issue resolved the problem for the one file that the most recent CI had shown was leaking database connections. Further CI runs revealed other such tests, however.\r\n\r\n### Detail\r\n\r\nAt present, I have 5 test seeds that reproduce the `SQLite3::IOException: disk I/O error`:\r\n\r\n* `SEED=58510 bundle exec rake db:postgresql:rebuild postgresql:test`\r\n* `SEED=31616 bundle exec rake db:postgresql:rebuild postgresql:test`\r\n* `SEED=64449 bundle exec rake db:postgresql:rebuild postgresql:test`\r\n* `SEED=61510 bundle exec rake db:mysql:rebuild mysql2:test`\r\n* `SEED=62616 bundle exec rake db:mysql:rebuild mysql2:test`\r\n\r\nInvestigating the various test runs exposed at least 3 tests that leak database connections:\r\n\r\n* `ConnectionHandlersShardingDbTest`\r\n* `ConnectionHandlersMultiDbTest`\r\n* `ConnectionSwappingNestedTest`\r\n\r\nAll tests shared a call to `clean_up_connection_handler` in their `teardown` hook, so I looked for a tweak to `clean_up_connection_handler` that would consistently clean up the connection handlers.\r\n\r\nAfter investigation and experimentation, I found that there were only 4 ActiveRecord classes that were expected to have connections independent of a particular test. So, I added a simple additional check to the `clean_up_connection_handler`.\r\n\r\nThis removed the need for the previously added `remove_connections` method.\r\n\r\n### Checklist\r\n\r\nBefore submitting the PR make sure the following are checked:\r\n\r\n* [x] This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.\r\n* [x] Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: `[Fix #issue-number]`\r\n","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/49403/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rails/rails/issues/49403/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":10501162275,"node_id":"REFE_lADNIULOceKy6c8AAAACcesFIw","url":"https://api.github.com/repos/rails/rails/issues/events/10501162275","actor":{"login":"hannahramadan","id":76922290,"node_id":"MDQ6VXNlcjc2OTIyMjkw","avatar_url":"https://avatars.githubusercontent.com/u/76922290?v=4","gravatar_id":"","url":"https://api.github.com/users/hannahramadan","html_url":"https://github.com/hannahramadan","followers_url":"https://api.github.com/users/hannahramadan/followers","following_url":"https://api.github.com/users/hannahramadan/following{/other_user}","gists_url":"https://api.github.com/users/hannahramadan/gists{/gist_id}","starred_url":"https://api.github.com/users/hannahramadan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hannahramadan/subscriptions","organizations_url":"https://api.github.com/users/hannahramadan/orgs","repos_url":"https://api.github.com/users/hannahramadan/repos","events_url":"https://api.github.com/users/hannahramadan/events{/privacy}","received_events_url":"https://api.github.com/users/hannahramadan/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"15c93388a3e365b6e275caf8189ec9508d8ec2de","commit_url":"https://api.github.com/repos/hannahramadan/rails/commits/15c93388a3e365b6e275caf8189ec9508d8ec2de","created_at":"2023-09-28T15:36:56Z","performed_via_github_app":null},{"id":10619834674,"node_id":"REFE_lADNIULOceKy6c8AAAACeP3RMg","url":"https://api.github.com/repos/rails/rails/issues/events/10619834674","actor":{"login":"eileencodes","id":1080678,"node_id":"MDQ6VXNlcjEwODA2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/1080678?v=4","gravatar_id":"","url":"https://api.github.com/users/eileencodes","html_url":"https://github.com/eileencodes","followers_url":"https://api.github.com/users/eileencodes/followers","following_url":"https://api.github.com/users/eileencodes/following{/other_user}","gists_url":"https://api.github.com/users/eileencodes/gists{/gist_id}","starred_url":"https://api.github.com/users/eileencodes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eileencodes/subscriptions","organizations_url":"https://api.github.com/users/eileencodes/orgs","repos_url":"https://api.github.com/users/eileencodes/repos","events_url":"https://api.github.com/users/eileencodes/events{/privacy}","received_events_url":"https://api.github.com/users/eileencodes/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"216428069701bed973d62727bdd517e69c940c47","commit_url":"https://api.github.com/repos/eileencodes/rails/commits/216428069701bed973d62727bdd517e69c940c47","created_at":"2023-10-11T14:46:10Z","performed_via_github_app":null},{"actor":{"login":"eileencodes","id":1080678,"node_id":"MDQ6VXNlcjEwODA2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/1080678?v=4","gravatar_id":"","url":"https://api.github.com/users/eileencodes","html_url":"https://github.com/eileencodes","followers_url":"https://api.github.com/users/eileencodes/followers","following_url":"https://api.github.com/users/eileencodes/following{/other_user}","gists_url":"https://api.github.com/users/eileencodes/gists{/gist_id}","starred_url":"https://api.github.com/users/eileencodes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eileencodes/subscriptions","organizations_url":"https://api.github.com/users/eileencodes/orgs","repos_url":"https://api.github.com/users/eileencodes/repos","events_url":"https://api.github.com/users/eileencodes/events{/privacy}","received_events_url":"https://api.github.com/users/eileencodes/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-10-11T14:47:35Z","updated_at":"2023-10-11T14:47:35Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/rails/rails/issues/49584","repository_url":"https://api.github.com/repos/rails/rails","labels_url":"https://api.github.com/repos/rails/rails/issues/49584/labels{/name}","comments_url":"https://api.github.com/repos/rails/rails/issues/49584/comments","events_url":"https://api.github.com/repos/rails/rails/issues/49584/events","html_url":"https://github.com/rails/rails/pull/49584","id":1937982448,"node_id":"PR_kwDNIULOXIaxBg","number":49584,"title":"Fix remove connection for shards","user":{"login":"eileencodes","id":1080678,"node_id":"MDQ6VXNlcjEwODA2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/1080678?v=4","gravatar_id":"","url":"https://api.github.com/users/eileencodes","html_url":"https://github.com/eileencodes","followers_url":"https://api.github.com/users/eileencodes/followers","following_url":"https://api.github.com/users/eileencodes/following{/other_user}","gists_url":"https://api.github.com/users/eileencodes/gists{/gist_id}","starred_url":"https://api.github.com/users/eileencodes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eileencodes/subscriptions","organizations_url":"https://api.github.com/users/eileencodes/orgs","repos_url":"https://api.github.com/users/eileencodes/repos","events_url":"https://api.github.com/users/eileencodes/events{/privacy}","received_events_url":"https://api.github.com/users/eileencodes/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":107191,"node_id":"MDU6TGFiZWwxMDcxOTE=","url":"https://api.github.com/repos/rails/rails/labels/activerecord","name":"activerecord","color":"0b02e1","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2023-10-11T14:47:34Z","updated_at":"2025-04-17T06:58:54Z","closed_at":null,"author_association":"MEMBER","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":8514,"node_id":"MDEwOlJlcG9zaXRvcnk4NTE0","name":"rails","full_name":"rails/rails","private":false,"owner":{"login":"rails","id":4223,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQyMjM=","avatar_url":"https://avatars.githubusercontent.com/u/4223?v=4","gravatar_id":"","url":"https://api.github.com/users/rails","html_url":"https://github.com/rails","followers_url":"https://api.github.com/users/rails/followers","following_url":"https://api.github.com/users/rails/following{/other_user}","gists_url":"https://api.github.com/users/rails/gists{/gist_id}","starred_url":"https://api.github.com/users/rails/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rails/subscriptions","organizations_url":"https://api.github.com/users/rails/orgs","repos_url":"https://api.github.com/users/rails/repos","events_url":"https://api.github.com/users/rails/events{/privacy}","received_events_url":"https://api.github.com/users/rails/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/rails/rails","description":"Ruby on Rails","fork":false,"url":"https://api.github.com/repos/rails/rails","forks_url":"https://api.github.com/repos/rails/rails/forks","keys_url":"https://api.github.com/repos/rails/rails/keys{/key_id}","collaborators_url":"https://api.github.com/repos/rails/rails/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/rails/rails/teams","hooks_url":"https://api.github.com/repos/rails/rails/hooks","issue_events_url":"https://api.github.com/repos/rails/rails/issues/events{/number}","events_url":"https://api.github.com/repos/rails/rails/events","assignees_url":"https://api.github.com/repos/rails/rails/assignees{/user}","branches_url":"https://api.github.com/repos/rails/rails/branches{/branch}","tags_url":"https://api.github.com/repos/rails/rails/tags","blobs_url":"https://api.github.com/repos/rails/rails/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/rails/rails/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/rails/rails/git/refs{/sha}","trees_url":"https://api.github.com/repos/rails/rails/git/trees{/sha}","statuses_url":"https://api.github.com/repos/rails/rails/statuses/{sha}","languages_url":"https://api.github.com/repos/rails/rails/languages","stargazers_url":"https://api.github.com/repos/rails/rails/stargazers","contributors_url":"https://api.github.com/repos/rails/rails/contributors","subscribers_url":"https://api.github.com/repos/rails/rails/subscribers","subscription_url":"https://api.github.com/repos/rails/rails/subscription","commits_url":"https://api.github.com/repos/rails/rails/commits{/sha}","git_commits_url":"https://api.github.com/repos/rails/rails/git/commits{/sha}","comments_url":"https://api.github.com/repos/rails/rails/comments{/number}","issue_comment_url":"https://api.github.com/repos/rails/rails/issues/comments{/number}","contents_url":"https://api.github.com/repos/rails/rails/contents/{+path}","compare_url":"https://api.github.com/repos/rails/rails/compare/{base}...{head}","merges_url":"https://api.github.com/repos/rails/rails/merges","archive_url":"https://api.github.com/repos/rails/rails/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/rails/rails/downloads","issues_url":"https://api.github.com/repos/rails/rails/issues{/number}","pulls_url":"https://api.github.com/repos/rails/rails/pulls{/number}","milestones_url":"https://api.github.com/repos/rails/rails/milestones{/number}","notifications_url":"https://api.github.com/repos/rails/rails/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/rails/rails/labels{/name}","releases_url":"https://api.github.com/repos/rails/rails/releases{/id}","deployments_url":"https://api.github.com/repos/rails/rails/deployments","created_at":"2008-04-11T02:19:47Z","updated_at":"2025-11-10T02:03:47Z","pushed_at":"2025-11-10T00:33:52Z","git_url":"git://github.com/rails/rails.git","ssh_url":"git@github.com:rails/rails.git","clone_url":"https://github.com/rails/rails.git","svn_url":"https://github.com/rails/rails","homepage":"https://rubyonrails.org","size":271619,"stargazers_count":57840,"watchers_count":57840,"language":"Ruby","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":22025,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1341,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["activejob","activerecord","framework","html","mvc","rails","ruby"],"visibility":"public","forks":22025,"open_issues":1341,"watchers":57840,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/rails/rails/pulls/49584","html_url":"https://github.com/rails/rails/pull/49584","diff_url":"https://github.com/rails/rails/pull/49584.diff","patch_url":"https://github.com/rails/rails/pull/49584.patch","merged_at":null},"body":"Don't change conn spec name if there are more connections\r\n\r\nPreviously we were setting `connection_specification_name` to `nil`\r\nwhich would cause connection calls to fall back to the parent,\r\n`ActiveRecord::Base`. This is fine in a single db app, but in a multi-db\r\napp we should not do this unless it is the last remaining connection on\r\nthat class. So now we check the pool list size before setting the name\r\nto `nil`. I move the `remove_connection_pool` call inside\r\n`retrieve_connection` because you literally can't remove a connection\r\nthat does not exist, so it doesn't change behavior and is just more\r\naccurate.\r\n\r\nThis also undoes the changes in https://github.com/rails/rails/pull/49403 that are no longer necessary\r\nwhich requires us to remove the `not_default` shard connection in\r\nanother test since we don't want that one sticking around.\r\n\r\nRelated: https://github.com/rails/rails/pull/49382, https://github.com/rails/rails/pull/49403\r\nFixes https://github.com/rails/rails/issues/49373\r\n\r\ncc/ @rafaelfranca @fractaledmind ","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/49584/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rails/rails/issues/49584/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"skipkayhil","id":6014046,"node_id":"MDQ6VXNlcjYwMTQwNDY=","avatar_url":"https://avatars.githubusercontent.com/u/6014046?v=4","gravatar_id":"","url":"https://api.github.com/users/skipkayhil","html_url":"https://github.com/skipkayhil","followers_url":"https://api.github.com/users/skipkayhil/followers","following_url":"https://api.github.com/users/skipkayhil/following{/other_user}","gists_url":"https://api.github.com/users/skipkayhil/gists{/gist_id}","starred_url":"https://api.github.com/users/skipkayhil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skipkayhil/subscriptions","organizations_url":"https://api.github.com/users/skipkayhil/orgs","repos_url":"https://api.github.com/users/skipkayhil/repos","events_url":"https://api.github.com/users/skipkayhil/events{/privacy}","received_events_url":"https://api.github.com/users/skipkayhil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-04T15:49:54Z","updated_at":"2024-01-04T15:49:54Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/rails/rails/issues/50579","repository_url":"https://api.github.com/repos/rails/rails","labels_url":"https://api.github.com/repos/rails/rails/issues/50579/labels{/name}","comments_url":"https://api.github.com/repos/rails/rails/issues/50579/comments","events_url":"https://api.github.com/repos/rails/rails/issues/50579/events","html_url":"https://github.com/rails/rails/issues/50579","id":2065896582,"node_id":"I_kwDNIULOeyMUhg","number":50579,"title":"CI: SQLite adapter is running in Trilogy tests","user":{"login":"skipkayhil","id":6014046,"node_id":"MDQ6VXNlcjYwMTQwNDY=","avatar_url":"https://avatars.githubusercontent.com/u/6014046?v=4","gravatar_id":"","url":"https://api.github.com/users/skipkayhil","html_url":"https://github.com/skipkayhil","followers_url":"https://api.github.com/users/skipkayhil/followers","following_url":"https://api.github.com/users/skipkayhil/following{/other_user}","gists_url":"https://api.github.com/users/skipkayhil/gists{/gist_id}","starred_url":"https://api.github.com/users/skipkayhil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skipkayhil/subscriptions","organizations_url":"https://api.github.com/users/skipkayhil/orgs","repos_url":"https://api.github.com/users/skipkayhil/repos","events_url":"https://api.github.com/users/skipkayhil/events{/privacy}","received_events_url":"https://api.github.com/users/skipkayhil/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":107191,"node_id":"MDU6TGFiZWwxMDcxOTE=","url":"https://api.github.com/repos/rails/rails/labels/activerecord","name":"activerecord","color":"0b02e1","default":false,"description":null},{"id":149514554,"node_id":"MDU6TGFiZWwxNDk1MTQ1NTQ=","url":"https://api.github.com/repos/rails/rails/labels/pinned","name":"pinned","color":"f7c6c7","default":false,"description":null},{"id":776781281,"node_id":"MDU6TGFiZWw3NzY3ODEyODE=","url":"https://api.github.com/repos/rails/rails/labels/ci%20issues","name":"ci issues","color":"aaafff","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2024-01-04T15:49:54Z","updated_at":"2024-07-04T21:12:11Z","closed_at":null,"author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":8514,"node_id":"MDEwOlJlcG9zaXRvcnk4NTE0","name":"rails","full_name":"rails/rails","private":false,"owner":{"login":"rails","id":4223,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQyMjM=","avatar_url":"https://avatars.githubusercontent.com/u/4223?v=4","gravatar_id":"","url":"https://api.github.com/users/rails","html_url":"https://github.com/rails","followers_url":"https://api.github.com/users/rails/followers","following_url":"https://api.github.com/users/rails/following{/other_user}","gists_url":"https://api.github.com/users/rails/gists{/gist_id}","starred_url":"https://api.github.com/users/rails/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rails/subscriptions","organizations_url":"https://api.github.com/users/rails/orgs","repos_url":"https://api.github.com/users/rails/repos","events_url":"https://api.github.com/users/rails/events{/privacy}","received_events_url":"https://api.github.com/users/rails/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/rails/rails","description":"Ruby on Rails","fork":false,"url":"https://api.github.com/repos/rails/rails","forks_url":"https://api.github.com/repos/rails/rails/forks","keys_url":"https://api.github.com/repos/rails/rails/keys{/key_id}","collaborators_url":"https://api.github.com/repos/rails/rails/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/rails/rails/teams","hooks_url":"https://api.github.com/repos/rails/rails/hooks","issue_events_url":"https://api.github.com/repos/rails/rails/issues/events{/number}","events_url":"https://api.github.com/repos/rails/rails/events","assignees_url":"https://api.github.com/repos/rails/rails/assignees{/user}","branches_url":"https://api.github.com/repos/rails/rails/branches{/branch}","tags_url":"https://api.github.com/repos/rails/rails/tags","blobs_url":"https://api.github.com/repos/rails/rails/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/rails/rails/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/rails/rails/git/refs{/sha}","trees_url":"https://api.github.com/repos/rails/rails/git/trees{/sha}","statuses_url":"https://api.github.com/repos/rails/rails/statuses/{sha}","languages_url":"https://api.github.com/repos/rails/rails/languages","stargazers_url":"https://api.github.com/repos/rails/rails/stargazers","contributors_url":"https://api.github.com/repos/rails/rails/contributors","subscribers_url":"https://api.github.com/repos/rails/rails/subscribers","subscription_url":"https://api.github.com/repos/rails/rails/subscription","commits_url":"https://api.github.com/repos/rails/rails/commits{/sha}","git_commits_url":"https://api.github.com/repos/rails/rails/git/commits{/sha}","comments_url":"https://api.github.com/repos/rails/rails/comments{/number}","issue_comment_url":"https://api.github.com/repos/rails/rails/issues/comments{/number}","contents_url":"https://api.github.com/repos/rails/rails/contents/{+path}","compare_url":"https://api.github.com/repos/rails/rails/compare/{base}...{head}","merges_url":"https://api.github.com/repos/rails/rails/merges","archive_url":"https://api.github.com/repos/rails/rails/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/rails/rails/downloads","issues_url":"https://api.github.com/repos/rails/rails/issues{/number}","pulls_url":"https://api.github.com/repos/rails/rails/pulls{/number}","milestones_url":"https://api.github.com/repos/rails/rails/milestones{/number}","notifications_url":"https://api.github.com/repos/rails/rails/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/rails/rails/labels{/name}","releases_url":"https://api.github.com/repos/rails/rails/releases{/id}","deployments_url":"https://api.github.com/repos/rails/rails/deployments","created_at":"2008-04-11T02:19:47Z","updated_at":"2025-11-10T02:03:47Z","pushed_at":"2025-11-10T00:33:52Z","git_url":"git://github.com/rails/rails.git","ssh_url":"git@github.com:rails/rails.git","clone_url":"https://github.com/rails/rails.git","svn_url":"https://github.com/rails/rails","homepage":"https://rubyonrails.org","size":271619,"stargazers_count":57840,"watchers_count":57840,"language":"Ruby","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":22025,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1341,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["activejob","activerecord","framework","html","mvc","rails","ruby"],"visibility":"public","forks":22025,"open_issues":1341,"watchers":57840,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"Ref #49373\r\n\r\nhttps://buildkite.com/rails/rails/builds/103367#018cd514-4e51-4bac-be7c-c8656888c21e\r\n\r\nI'm pretty sure this means that some other test is leaking, but I have not dug in at all.","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/50579/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rails/rails/issues/50579/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":11668972079,"node_id":"REFE_lADNIULOceKy6c8AAAACt4ZiLw","url":"https://api.github.com/repos/rails/rails/issues/events/11668972079","actor":{"login":"noahgibbs","id":82408,"node_id":"MDQ6VXNlcjgyNDA4","avatar_url":"https://avatars.githubusercontent.com/u/82408?v=4","gravatar_id":"","url":"https://api.github.com/users/noahgibbs","html_url":"https://github.com/noahgibbs","followers_url":"https://api.github.com/users/noahgibbs/followers","following_url":"https://api.github.com/users/noahgibbs/following{/other_user}","gists_url":"https://api.github.com/users/noahgibbs/gists{/gist_id}","starred_url":"https://api.github.com/users/noahgibbs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/noahgibbs/subscriptions","organizations_url":"https://api.github.com/users/noahgibbs/orgs","repos_url":"https://api.github.com/users/noahgibbs/repos","events_url":"https://api.github.com/users/noahgibbs/events{/privacy}","received_events_url":"https://api.github.com/users/noahgibbs/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"5dfded9e3350b1b58de7d629774b0bd2636ba080","commit_url":"https://api.github.com/repos/noahgibbs/rails/commits/5dfded9e3350b1b58de7d629774b0bd2636ba080","created_at":"2024-02-01T11:49:46Z","performed_via_github_app":null},{"actor":{"login":"zzak","id":277819,"node_id":"MDQ6VXNlcjI3NzgxOQ==","avatar_url":"https://avatars.githubusercontent.com/u/277819?v=4","gravatar_id":"","url":"https://api.github.com/users/zzak","html_url":"https://github.com/zzak","followers_url":"https://api.github.com/users/zzak/followers","following_url":"https://api.github.com/users/zzak/following{/other_user}","gists_url":"https://api.github.com/users/zzak/gists{/gist_id}","starred_url":"https://api.github.com/users/zzak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zzak/subscriptions","organizations_url":"https://api.github.com/users/zzak/orgs","repos_url":"https://api.github.com/users/zzak/repos","events_url":"https://api.github.com/users/zzak/events{/privacy}","received_events_url":"https://api.github.com/users/zzak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-14T08:36:06Z","updated_at":"2024-12-14T08:36:06Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/rails/rails/issues/53945","repository_url":"https://api.github.com/repos/rails/rails","labels_url":"https://api.github.com/repos/rails/rails/issues/53945/labels{/name}","comments_url":"https://api.github.com/repos/rails/rails/issues/53945/comments","events_url":"https://api.github.com/repos/rails/rails/issues/53945/events","html_url":"https://github.com/rails/rails/pull/53945","id":2739700774,"node_id":"PR_kwDNIULOhTch_Q","number":53945,"title":"Raise when AR tests leak connections and fixes `shard_one` sqlite leak","user":{"login":"zzak","id":277819,"node_id":"MDQ6VXNlcjI3NzgxOQ==","avatar_url":"https://avatars.githubusercontent.com/u/277819?v=4","gravatar_id":"","url":"https://api.github.com/users/zzak","html_url":"https://github.com/zzak","followers_url":"https://api.github.com/users/zzak/followers","following_url":"https://api.github.com/users/zzak/following{/other_user}","gists_url":"https://api.github.com/users/zzak/gists{/gist_id}","starred_url":"https://api.github.com/users/zzak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zzak/subscriptions","organizations_url":"https://api.github.com/users/zzak/orgs","repos_url":"https://api.github.com/users/zzak/repos","events_url":"https://api.github.com/users/zzak/events{/privacy}","received_events_url":"https://api.github.com/users/zzak/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":107191,"node_id":"MDU6TGFiZWwxMDcxOTE=","url":"https://api.github.com/repos/rails/rails/labels/activerecord","name":"activerecord","color":"0b02e1","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2024-12-14T08:36:05Z","updated_at":"2025-03-10T09:36:44Z","closed_at":"2025-03-09T11:17:16Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":8514,"node_id":"MDEwOlJlcG9zaXRvcnk4NTE0","name":"rails","full_name":"rails/rails","private":false,"owner":{"login":"rails","id":4223,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQyMjM=","avatar_url":"https://avatars.githubusercontent.com/u/4223?v=4","gravatar_id":"","url":"https://api.github.com/users/rails","html_url":"https://github.com/rails","followers_url":"https://api.github.com/users/rails/followers","following_url":"https://api.github.com/users/rails/following{/other_user}","gists_url":"https://api.github.com/users/rails/gists{/gist_id}","starred_url":"https://api.github.com/users/rails/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rails/subscriptions","organizations_url":"https://api.github.com/users/rails/orgs","repos_url":"https://api.github.com/users/rails/repos","events_url":"https://api.github.com/users/rails/events{/privacy}","received_events_url":"https://api.github.com/users/rails/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/rails/rails","description":"Ruby on Rails","fork":false,"url":"https://api.github.com/repos/rails/rails","forks_url":"https://api.github.com/repos/rails/rails/forks","keys_url":"https://api.github.com/repos/rails/rails/keys{/key_id}","collaborators_url":"https://api.github.com/repos/rails/rails/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/rails/rails/teams","hooks_url":"https://api.github.com/repos/rails/rails/hooks","issue_events_url":"https://api.github.com/repos/rails/rails/issues/events{/number}","events_url":"https://api.github.com/repos/rails/rails/events","assignees_url":"https://api.github.com/repos/rails/rails/assignees{/user}","branches_url":"https://api.github.com/repos/rails/rails/branches{/branch}","tags_url":"https://api.github.com/repos/rails/rails/tags","blobs_url":"https://api.github.com/repos/rails/rails/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/rails/rails/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/rails/rails/git/refs{/sha}","trees_url":"https://api.github.com/repos/rails/rails/git/trees{/sha}","statuses_url":"https://api.github.com/repos/rails/rails/statuses/{sha}","languages_url":"https://api.github.com/repos/rails/rails/languages","stargazers_url":"https://api.github.com/repos/rails/rails/stargazers","contributors_url":"https://api.github.com/repos/rails/rails/contributors","subscribers_url":"https://api.github.com/repos/rails/rails/subscribers","subscription_url":"https://api.github.com/repos/rails/rails/subscription","commits_url":"https://api.github.com/repos/rails/rails/commits{/sha}","git_commits_url":"https://api.github.com/repos/rails/rails/git/commits{/sha}","comments_url":"https://api.github.com/repos/rails/rails/comments{/number}","issue_comment_url":"https://api.github.com/repos/rails/rails/issues/comments{/number}","contents_url":"https://api.github.com/repos/rails/rails/contents/{+path}","compare_url":"https://api.github.com/repos/rails/rails/compare/{base}...{head}","merges_url":"https://api.github.com/repos/rails/rails/merges","archive_url":"https://api.github.com/repos/rails/rails/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/rails/rails/downloads","issues_url":"https://api.github.com/repos/rails/rails/issues{/number}","pulls_url":"https://api.github.com/repos/rails/rails/pulls{/number}","milestones_url":"https://api.github.com/repos/rails/rails/milestones{/number}","notifications_url":"https://api.github.com/repos/rails/rails/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/rails/rails/labels{/name}","releases_url":"https://api.github.com/repos/rails/rails/releases{/id}","deployments_url":"https://api.github.com/repos/rails/rails/deployments","created_at":"2008-04-11T02:19:47Z","updated_at":"2025-11-10T02:03:47Z","pushed_at":"2025-11-10T00:33:52Z","git_url":"git://github.com/rails/rails.git","ssh_url":"git@github.com:rails/rails.git","clone_url":"https://github.com/rails/rails.git","svn_url":"https://github.com/rails/rails","homepage":"https://rubyonrails.org","size":271619,"stargazers_count":57840,"watchers_count":57840,"language":"Ruby","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":22025,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1341,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["activejob","activerecord","framework","html","mvc","rails","ruby"],"visibility":"public","forks":22025,"open_issues":1341,"watchers":57840,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/rails/rails/pulls/53945","html_url":"https://github.com/rails/rails/pull/53945","diff_url":"https://github.com/rails/rails/pull/53945.diff","patch_url":"https://github.com/rails/rails/pull/53945.patch","merged_at":null},"body":"```\r\nARCONN=mysql2 bin/test\r\n\r\nConnections leaked in AsyncHasManyAssociationsTest#test_async_load_has_many\r\n[#<ActiveRecord::ConnectionAdapters::Mysql2Adapter:0x00000000052fa8 env_name=\"arunit\" role=:writing>]\r\n\r\n............................................................\r\nConnections leaked in ActiveRecord::ConnectionAdapters::ConnectionHandlersShardingDbTest#test_establishing_a_connection_in_connected_to_block_uses_current_role_and_shard\r\n[#<ActiveRecord::ConnectionAdapters::Mysql2Adapter:0x00000000053458 env_name=\"arunit\" role=:writing shard=:shard_one>]\r\n\r\n............\r\nConnections leaked in ActiveRecord::ConnectionAdapters::ConnectionHandlersShardingDbTest#test_switching_connections_via_handler\r\n[#<ActiveRecord::ConnectionAdapters::SQLite3Adapter:0x00000000054358 env_name=\"default_env\" name=\"primary_shard_one\" role=:writing shard=:shard_one>, #<ActiveRecord::ConnectionAdapters::Mysql2Adapter:0x00000000054380 env_name=\"arunit\" role=:writing>]\r\n\r\n............................................................................................................................................................................................................................................................................................................................................................................\r\nConnections leaked in MigrationTest#test_migrator_one_up_with_unavailable_lock_using_run\r\n[#<ActiveRecord::ConnectionAdapters::Mysql2Adapter:0x00000000058638 env_name=\"arunit\" role=:writing>]\r\n```\r\n\r\nI found that sqlite3 test had left a connection open, so maybe that is why we see the sqlite3 adapter errors in other adapter test runs like reported in #49373.\r\n\r\nSee also: #49584, #49373, #49382, #49403, #50579\r\n/cc @eileencodes\r\n\r\nI'm not sure this is the right fix to ensure the connection is closed properly (see the PR above), but I can't reproduce the log with it, and want to see how this behaves on other adapters.","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/53945/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rails/rails/issues/53945/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"}]