{"url":"https://api.github.com/repos/rails/rails/issues/49717","repository_url":"https://api.github.com/repos/rails/rails","labels_url":"https://api.github.com/repos/rails/rails/issues/49717/labels{/name}","comments_url":"https://api.github.com/repos/rails/rails/issues/49717/comments","events_url":"https://api.github.com/repos/rails/rails/issues/49717/events","html_url":"https://github.com/rails/rails/issues/49717","id":1953737551,"node_id":"I_kwDNIULOdHOrTw","number":49717,"title":"Rails 7.1 - can't define enums for attributes which don't exist in table","user":{"login":"ejskipper","id":40039308,"node_id":"MDQ6VXNlcjQwMDM5MzA4","avatar_url":"https://avatars.githubusercontent.com/u/40039308?v=4","gravatar_id":"","url":"https://api.github.com/users/ejskipper","html_url":"https://github.com/ejskipper","followers_url":"https://api.github.com/users/ejskipper/followers","following_url":"https://api.github.com/users/ejskipper/following{/other_user}","gists_url":"https://api.github.com/users/ejskipper/gists{/gist_id}","starred_url":"https://api.github.com/users/ejskipper/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ejskipper/subscriptions","organizations_url":"https://api.github.com/users/ejskipper/orgs","repos_url":"https://api.github.com/users/ejskipper/repos","events_url":"https://api.github.com/users/ejskipper/events{/privacy}","received_events_url":"https://api.github.com/users/ejskipper/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":107191,"node_id":"MDU6TGFiZWwxMDcxOTE=","url":"https://api.github.com/repos/rails/rails/labels/activerecord","name":"activerecord","color":"0b02e1","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/rails/rails/milestones/90","html_url":"https://github.com/rails/rails/milestone/90","labels_url":"https://api.github.com/repos/rails/rails/milestones/90/labels","id":11472308,"node_id":"MI_kwDNIULOAK8NtA","number":90,"title":"7.2.2","description":null,"creator":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":5,"state":"closed","created_at":"2024-08-21T21:24:04Z","updated_at":"2024-11-11T20:55:10Z","due_on":null,"closed_at":"2024-11-11T20:55:10Z"},"comments":54,"created_at":"2023-10-20T07:51:32Z","updated_at":"2025-03-16T14:22:18Z","closed_at":"2024-08-26T17:07:22Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Not sure if this is an intended change or not. Pre 7.1, I could define an attr on a model using `attribute` and define enum values for it, then use enum helper methods. I'm using this heavily in my current project for i18ns etc, so defining the enum values as an array and manually validating won't cover all my use cases\r\n\r\nSince 7.1, this isn't possible.\r\n\r\n### Steps to reproduce\r\n\r\n```ruby\r\n# frozen_string_literal: true\r\n\r\nrequire \"bundler/inline\"\r\n\r\ngemfile(true) do\r\n  source \"https://rubygems.org\"\r\n\r\n  git_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\r\n\r\n  gem \"rails\", github: \"rails/rails\", branch: \"main\"\r\n  gem \"sqlite3\"\r\nend\r\n\r\nrequire \"active_record\"\r\nrequire \"minitest/autorun\"\r\nrequire \"logger\"\r\n\r\n# This connection will do for database-independent bug reports.\r\nActiveRecord::Base.establish_connection(adapter: \"sqlite3\", database: \":memory:\")\r\nActiveRecord::Base.logger = Logger.new(STDOUT)\r\n\r\nActiveRecord::Schema.define do\r\n  create_table :posts, force: true do |t|\r\n  end\r\nend\r\n\r\nclass Post < ActiveRecord::Base\r\n  attribute :topic\r\n  enum topic: %i[sports politics entertainment]\r\nend\r\n\r\nclass BugTest < Minitest::Test\r\n  def test_association_stuff\r\n    post = Post.create!\r\n    post.assign_attributes(topic: :sports)\r\n\r\n    assert_equal true, post.sports?\r\n  end\r\nend# frozen_string_literal: true\r\n\r\n\r\n```\r\n\r\n### Expected behavior\r\nPost should instantiate correctly and can use enum helper methods\r\n\r\n### Actual behavior\r\nError thrown\r\n\r\n`RuntimeError: Unknown enum attribute 'topic' for Post`\r\n\r\n### System configuration\r\n**Rails version**: 7.1.1\r\n\r\n**Ruby version**: ruby 3.1.2p20\r\n","closed_by":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rails/rails/issues/49717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rails/rails/issues/49717/timeline","performed_via_github_app":null,"state_reason":"completed"}