[{"id":13783335697,"node_id":"MEE_lADNIULOkiBcO88AAAADNY0DEQ","url":"https://api.github.com/repos/rails/rails/issues/events/13783335697","actor":{"login":"byroot","id":44640,"node_id":"MDQ6VXNlcjQ0NjQw","avatar_url":"https://avatars.githubusercontent.com/u/44640?v=4","gravatar_id":"","url":"https://api.github.com/users/byroot","html_url":"https://github.com/byroot","followers_url":"https://api.github.com/users/byroot/followers","following_url":"https://api.github.com/users/byroot/following{/other_user}","gists_url":"https://api.github.com/users/byroot/gists{/gist_id}","starred_url":"https://api.github.com/users/byroot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/byroot/subscriptions","organizations_url":"https://api.github.com/users/byroot/orgs","repos_url":"https://api.github.com/users/byroot/repos","events_url":"https://api.github.com/users/byroot/events{/privacy}","received_events_url":"https://api.github.com/users/byroot/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-08-06T19:56:59Z","performed_via_github_app":null},{"id":13783335710,"node_id":"SE_lADNIULOkiBcO88AAAADNY0DHg","url":"https://api.github.com/repos/rails/rails/issues/events/13783335710","actor":{"login":"byroot","id":44640,"node_id":"MDQ6VXNlcjQ0NjQw","avatar_url":"https://avatars.githubusercontent.com/u/44640?v=4","gravatar_id":"","url":"https://api.github.com/users/byroot","html_url":"https://github.com/byroot","followers_url":"https://api.github.com/users/byroot/followers","following_url":"https://api.github.com/users/byroot/following{/other_user}","gists_url":"https://api.github.com/users/byroot/gists{/gist_id}","starred_url":"https://api.github.com/users/byroot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/byroot/subscriptions","organizations_url":"https://api.github.com/users/byroot/orgs","repos_url":"https://api.github.com/users/byroot/repos","events_url":"https://api.github.com/users/byroot/events{/privacy}","received_events_url":"https://api.github.com/users/byroot/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-08-06T19:56:59Z","performed_via_github_app":null},{"id":13783335724,"node_id":"MEE_lADNIULOkiBcO88AAAADNY0DLA","url":"https://api.github.com/repos/rails/rails/issues/events/13783335724","actor":{"login":"dhh","id":2741,"node_id":"MDQ6VXNlcjI3NDE=","avatar_url":"https://avatars.githubusercontent.com/u/2741?v=4","gravatar_id":"","url":"https://api.github.com/users/dhh","html_url":"https://github.com/dhh","followers_url":"https://api.github.com/users/dhh/followers","following_url":"https://api.github.com/users/dhh/following{/other_user}","gists_url":"https://api.github.com/users/dhh/gists{/gist_id}","starred_url":"https://api.github.com/users/dhh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dhh/subscriptions","organizations_url":"https://api.github.com/users/dhh/orgs","repos_url":"https://api.github.com/users/dhh/repos","events_url":"https://api.github.com/users/dhh/events{/privacy}","received_events_url":"https://api.github.com/users/dhh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-08-06T19:56:59Z","performed_via_github_app":null},{"id":13783335739,"node_id":"SE_lADNIULOkiBcO88AAAADNY0DOw","url":"https://api.github.com/repos/rails/rails/issues/events/13783335739","actor":{"login":"dhh","id":2741,"node_id":"MDQ6VXNlcjI3NDE=","avatar_url":"https://avatars.githubusercontent.com/u/2741?v=4","gravatar_id":"","url":"https://api.github.com/users/dhh","html_url":"https://github.com/dhh","followers_url":"https://api.github.com/users/dhh/followers","following_url":"https://api.github.com/users/dhh/following{/other_user}","gists_url":"https://api.github.com/users/dhh/gists{/gist_id}","starred_url":"https://api.github.com/users/dhh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dhh/subscriptions","organizations_url":"https://api.github.com/users/dhh/orgs","repos_url":"https://api.github.com/users/dhh/repos","events_url":"https://api.github.com/users/dhh/events{/privacy}","received_events_url":"https://api.github.com/users/dhh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-08-06T19:56:59Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/rails/rails/issues/comments/2272056429","html_url":"https://github.com/rails/rails/issues/52522#issuecomment-2272056429","issue_url":"https://api.github.com/repos/rails/rails/issues/52522","id":2272056429,"node_id":"IC_kwDNIULOh2zUbQ","user":{"login":"dhh","id":2741,"node_id":"MDQ6VXNlcjI3NDE=","avatar_url":"https://avatars.githubusercontent.com/u/2741?v=4","gravatar_id":"","url":"https://api.github.com/users/dhh","html_url":"https://github.com/dhh","followers_url":"https://api.github.com/users/dhh/followers","following_url":"https://api.github.com/users/dhh/following{/other_user}","gists_url":"https://api.github.com/users/dhh/gists{/gist_id}","starred_url":"https://api.github.com/users/dhh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dhh/subscriptions","organizations_url":"https://api.github.com/users/dhh/orgs","repos_url":"https://api.github.com/users/dhh/repos","events_url":"https://api.github.com/users/dhh/events{/privacy}","received_events_url":"https://api.github.com/users/dhh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-06T20:05:31Z","updated_at":"2024-08-06T20:05:31Z","body":"Thanks for the very diligent investigation, @denys-chaikovskyi. I fully agree that we should try hard to ensure that the out-of-the-box experience on a place like DO is solid. I've been using DO for a lot of testing, but hadn't noticed this problem when using Droplets.\r\n\r\nI think ultimately it's going to be hard/impossible to find something that works in all instances. But maybe we can build up some combined heuristics that can help guide us. And maybe we can elevate the visibility of the WORKER count/variable. Perhaps using the new default config/deploy.yml file? Since someone would have to modify that anyway to do a deploy with the new Rails defaults, so they're likely to be exposed to it there. Versus normally you don't have to change the puma.rb file.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/comments/2272056429/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dhh","id":2741,"node_id":"MDQ6VXNlcjI3NDE=","avatar_url":"https://avatars.githubusercontent.com/u/2741?v=4","gravatar_id":"","url":"https://api.github.com/users/dhh","html_url":"https://github.com/dhh","followers_url":"https://api.github.com/users/dhh/followers","following_url":"https://api.github.com/users/dhh/following{/other_user}","gists_url":"https://api.github.com/users/dhh/gists{/gist_id}","starred_url":"https://api.github.com/users/dhh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dhh/subscriptions","organizations_url":"https://api.github.com/users/dhh/orgs","repos_url":"https://api.github.com/users/dhh/repos","events_url":"https://api.github.com/users/dhh/events{/privacy}","received_events_url":"https://api.github.com/users/dhh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":13783422132,"node_id":"MEE_lADNIULOkiBcO88AAAADNY5UtA","url":"https://api.github.com/repos/rails/rails/issues/events/13783422132","actor":{"login":"denys-chaikovskyi","id":12110348,"node_id":"MDQ6VXNlcjEyMTEwMzQ4","avatar_url":"https://avatars.githubusercontent.com/u/12110348?v=4","gravatar_id":"","url":"https://api.github.com/users/denys-chaikovskyi","html_url":"https://github.com/denys-chaikovskyi","followers_url":"https://api.github.com/users/denys-chaikovskyi/followers","following_url":"https://api.github.com/users/denys-chaikovskyi/following{/other_user}","gists_url":"https://api.github.com/users/denys-chaikovskyi/gists{/gist_id}","starred_url":"https://api.github.com/users/denys-chaikovskyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/denys-chaikovskyi/subscriptions","organizations_url":"https://api.github.com/users/denys-chaikovskyi/orgs","repos_url":"https://api.github.com/users/denys-chaikovskyi/repos","events_url":"https://api.github.com/users/denys-chaikovskyi/events{/privacy}","received_events_url":"https://api.github.com/users/denys-chaikovskyi/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-08-06T20:05:32Z","performed_via_github_app":null},{"id":13783422139,"node_id":"SE_lADNIULOkiBcO88AAAADNY5Uuw","url":"https://api.github.com/repos/rails/rails/issues/events/13783422139","actor":{"login":"denys-chaikovskyi","id":12110348,"node_id":"MDQ6VXNlcjEyMTEwMzQ4","avatar_url":"https://avatars.githubusercontent.com/u/12110348?v=4","gravatar_id":"","url":"https://api.github.com/users/denys-chaikovskyi","html_url":"https://github.com/denys-chaikovskyi","followers_url":"https://api.github.com/users/denys-chaikovskyi/followers","following_url":"https://api.github.com/users/denys-chaikovskyi/following{/other_user}","gists_url":"https://api.github.com/users/denys-chaikovskyi/gists{/gist_id}","starred_url":"https://api.github.com/users/denys-chaikovskyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/denys-chaikovskyi/subscriptions","organizations_url":"https://api.github.com/users/denys-chaikovskyi/orgs","repos_url":"https://api.github.com/users/denys-chaikovskyi/repos","events_url":"https://api.github.com/users/denys-chaikovskyi/events{/privacy}","received_events_url":"https://api.github.com/users/denys-chaikovskyi/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-08-06T20:05:32Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/rails/rails/issues/comments/2272114724","html_url":"https://github.com/rails/rails/issues/52522#issuecomment-2272114724","issue_url":"https://api.github.com/repos/rails/rails/issues/52522","id":2272114724,"node_id":"IC_kwDNIULOh224JA","user":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-06T20:42:52Z","updated_at":"2024-08-06T20:42:52Z","body":"I think we discussed this problem in the original issue and we decide that we can't possibly support the platform that wrongly report the CPU counts and that is why we kept `WEB_CONCURRENCY`.\r\n\r\nI think we should just report the worker count and I agree adding `WEB_CONCURRENCY` to `cofing/deploy.yml` and documenting this problem would be enough.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/comments/2272114724/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rails/rails/issues/comments/2272120577","html_url":"https://github.com/rails/rails/issues/52522#issuecomment-2272120577","issue_url":"https://api.github.com/repos/rails/rails/issues/52522","id":2272120577,"node_id":"IC_kwDNIULOh23PAQ","user":{"login":"dhh","id":2741,"node_id":"MDQ6VXNlcjI3NDE=","avatar_url":"https://avatars.githubusercontent.com/u/2741?v=4","gravatar_id":"","url":"https://api.github.com/users/dhh","html_url":"https://github.com/dhh","followers_url":"https://api.github.com/users/dhh/followers","following_url":"https://api.github.com/users/dhh/following{/other_user}","gists_url":"https://api.github.com/users/dhh/gists{/gist_id}","starred_url":"https://api.github.com/users/dhh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dhh/subscriptions","organizations_url":"https://api.github.com/users/dhh/orgs","repos_url":"https://api.github.com/users/dhh/repos","events_url":"https://api.github.com/users/dhh/events{/privacy}","received_events_url":"https://api.github.com/users/dhh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-06T20:46:08Z","updated_at":"2024-08-06T20:46:08Z","body":"Yeah, I think actually maybe that's the way to just do it. Set WEB_CONCURRENCY (crikey I hate that name) in config/deploy.yml with a comment that you can remove it to get \"available processor count\". And we can just set it conservatively to 1. That means if you do nothing, you get 1 worker. But you'll be exposed to that fact as you set the IP of your deploy target. And if you remove the setting, you'll get available processor count. Please do explore a PR, if you fancy, @denys-chaikovskyi.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/comments/2272120577/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"dhh","id":2741,"node_id":"MDQ6VXNlcjI3NDE=","avatar_url":"https://avatars.githubusercontent.com/u/2741?v=4","gravatar_id":"","url":"https://api.github.com/users/dhh","html_url":"https://github.com/dhh","followers_url":"https://api.github.com/users/dhh/followers","following_url":"https://api.github.com/users/dhh/following{/other_user}","gists_url":"https://api.github.com/users/dhh/gists{/gist_id}","starred_url":"https://api.github.com/users/dhh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dhh/subscriptions","organizations_url":"https://api.github.com/users/dhh/orgs","repos_url":"https://api.github.com/users/dhh/repos","events_url":"https://api.github.com/users/dhh/events{/privacy}","received_events_url":"https://api.github.com/users/dhh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":13783789685,"node_id":"MEE_lADNIULOkiBcO88AAAADNZPwdQ","url":"https://api.github.com/repos/rails/rails/issues/events/13783789685","actor":{"login":"denys-chaikovskyi","id":12110348,"node_id":"MDQ6VXNlcjEyMTEwMzQ4","avatar_url":"https://avatars.githubusercontent.com/u/12110348?v=4","gravatar_id":"","url":"https://api.github.com/users/denys-chaikovskyi","html_url":"https://github.com/denys-chaikovskyi","followers_url":"https://api.github.com/users/denys-chaikovskyi/followers","following_url":"https://api.github.com/users/denys-chaikovskyi/following{/other_user}","gists_url":"https://api.github.com/users/denys-chaikovskyi/gists{/gist_id}","starred_url":"https://api.github.com/users/denys-chaikovskyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/denys-chaikovskyi/subscriptions","organizations_url":"https://api.github.com/users/denys-chaikovskyi/orgs","repos_url":"https://api.github.com/users/denys-chaikovskyi/repos","events_url":"https://api.github.com/users/denys-chaikovskyi/events{/privacy}","received_events_url":"https://api.github.com/users/denys-chaikovskyi/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-08-06T20:46:09Z","performed_via_github_app":null},{"id":13783789693,"node_id":"SE_lADNIULOkiBcO88AAAADNZPwfQ","url":"https://api.github.com/repos/rails/rails/issues/events/13783789693","actor":{"login":"denys-chaikovskyi","id":12110348,"node_id":"MDQ6VXNlcjEyMTEwMzQ4","avatar_url":"https://avatars.githubusercontent.com/u/12110348?v=4","gravatar_id":"","url":"https://api.github.com/users/denys-chaikovskyi","html_url":"https://github.com/denys-chaikovskyi","followers_url":"https://api.github.com/users/denys-chaikovskyi/followers","following_url":"https://api.github.com/users/denys-chaikovskyi/following{/other_user}","gists_url":"https://api.github.com/users/denys-chaikovskyi/gists{/gist_id}","starred_url":"https://api.github.com/users/denys-chaikovskyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/denys-chaikovskyi/subscriptions","organizations_url":"https://api.github.com/users/denys-chaikovskyi/orgs","repos_url":"https://api.github.com/users/denys-chaikovskyi/repos","events_url":"https://api.github.com/users/denys-chaikovskyi/events{/privacy}","received_events_url":"https://api.github.com/users/denys-chaikovskyi/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-08-06T20:46:09Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/rails/rails/issues/comments/2272131245","html_url":"https://github.com/rails/rails/issues/52522#issuecomment-2272131245","issue_url":"https://api.github.com/repos/rails/rails/issues/52522","id":2272131245,"node_id":"IC_kwDNIULOh234rQ","user":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-06T20:52:41Z","updated_at":"2024-08-06T20:52:41Z","body":"We can also rename `WEB_CONCURRENCY`. We own this variable.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/comments/2272131245/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rails/rails/issues/comments/2272213191","html_url":"https://github.com/rails/rails/issues/52522#issuecomment-2272213191","issue_url":"https://api.github.com/repos/rails/rails/issues/52522","id":2272213191,"node_id":"IC_kwDNIULOh284xw","user":{"login":"byroot","id":44640,"node_id":"MDQ6VXNlcjQ0NjQw","avatar_url":"https://avatars.githubusercontent.com/u/44640?v=4","gravatar_id":"","url":"https://api.github.com/users/byroot","html_url":"https://github.com/byroot","followers_url":"https://api.github.com/users/byroot/followers","following_url":"https://api.github.com/users/byroot/following{/other_user}","gists_url":"https://api.github.com/users/byroot/gists{/gist_id}","starred_url":"https://api.github.com/users/byroot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/byroot/subscriptions","organizations_url":"https://api.github.com/users/byroot/orgs","repos_url":"https://api.github.com/users/byroot/repos","events_url":"https://api.github.com/users/byroot/events{/privacy}","received_events_url":"https://api.github.com/users/byroot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-06T21:51:28Z","updated_at":"2024-08-06T21:51:28Z","body":"Yeah, unfortunately we can't trust that all providers will expose limits in a standard way, and I was definitely expecting it wouldn't work everywhere, but DO is big enough that it kinda kills the idea.\r\n\r\nI'm very surprised by that `-1` quota though, I can't image DO went out of their way to mask this value, so I suspect they're not actually limiting CPU usage.\r\n\r\nBut even then, it's not uncommon not to enforce CPU quota and let the scheduler ensure fairness, so I guess it's not that weird.\r\n\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/comments/2272213191/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"byroot","id":44640,"node_id":"MDQ6VXNlcjQ0NjQw","avatar_url":"https://avatars.githubusercontent.com/u/44640?v=4","gravatar_id":"","url":"https://api.github.com/users/byroot","html_url":"https://github.com/byroot","followers_url":"https://api.github.com/users/byroot/followers","following_url":"https://api.github.com/users/byroot/following{/other_user}","gists_url":"https://api.github.com/users/byroot/gists{/gist_id}","starred_url":"https://api.github.com/users/byroot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/byroot/subscriptions","organizations_url":"https://api.github.com/users/byroot/orgs","repos_url":"https://api.github.com/users/byroot/repos","events_url":"https://api.github.com/users/byroot/events{/privacy}","received_events_url":"https://api.github.com/users/byroot/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rails/rails/issues/comments/2272225792","html_url":"https://github.com/rails/rails/issues/52522#issuecomment-2272225792","issue_url":"https://api.github.com/repos/rails/rails/issues/52522","id":2272225792,"node_id":"IC_kwDNIULOh29qAA","user":{"login":"denys-chaikovskyi","id":12110348,"node_id":"MDQ6VXNlcjEyMTEwMzQ4","avatar_url":"https://avatars.githubusercontent.com/u/12110348?v=4","gravatar_id":"","url":"https://api.github.com/users/denys-chaikovskyi","html_url":"https://github.com/denys-chaikovskyi","followers_url":"https://api.github.com/users/denys-chaikovskyi/followers","following_url":"https://api.github.com/users/denys-chaikovskyi/following{/other_user}","gists_url":"https://api.github.com/users/denys-chaikovskyi/gists{/gist_id}","starred_url":"https://api.github.com/users/denys-chaikovskyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/denys-chaikovskyi/subscriptions","organizations_url":"https://api.github.com/users/denys-chaikovskyi/orgs","repos_url":"https://api.github.com/users/denys-chaikovskyi/repos","events_url":"https://api.github.com/users/denys-chaikovskyi/events{/privacy}","received_events_url":"https://api.github.com/users/denys-chaikovskyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-06T22:01:46Z","updated_at":"2024-08-06T22:01:46Z","body":"Thanks for your prompt replies @dhh, @rafaelfranca and @byroot \r\n\r\nDroplets might not have this problem. I haven't tried using `available_processor_count` there. It might be that DO uses different mechanisms of managing shared CPUs in Droplet vs their PaaS \"App Platform\". I will have to play with Droplet to clarify that.\r\n\r\nGood idea on explicitly setting Worker count/variable in the deploy.yml file to elevate the visibility. I think this is a great improvement for an out-of-the-box experience. I will explore creating PR for this during the weekend.\r\n\r\nWhile this will improve the experience for new Rails deployments using deploy.yml and Kamal, it won’t address the issue for PaaS platforms like the DO App Platform that use a bare Dockerfile. I understand that it’s challenging to ensure a great out-of-the-box experience for every environment and that deploy.yml approach should be prioritized as the new standard.\r\n\r\nIn light of this, do you think we should still keep `available_processor_count` as the default in puma.rb? Or would setting it conservatively to 1 in in puma.rb be a better default approach?\r\n\r\nSo basically, I see two options here:\r\n\r\n1. Add Worker count/variable in the deploy.yml with the default as 1. Use it in puma.rb and if it is absent go with `available_processor_count`.\r\n2. Add Worker count/variable in the deploy.yml with the default as 1. Use it in puma.rb and if it is absent go with old default as 1. Meaning we don't rely on `available_processor_count`\r\n\r\nI think 2nd option would be a bit more more friendly for Paas with shared CPUs that cannot use deploy.yml. But option 1 is clearly a way more optimal for platforms that report the CPU counts accurately. \r\n\r\nA classic crossroads with trade-offs to consider.\r\n\r\n@dhh, @rafaelfranca, and @byroot, which option do you think will be better? Do you have an alternative one?","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/comments/2272225792/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"denys-chaikovskyi","id":12110348,"node_id":"MDQ6VXNlcjEyMTEwMzQ4","avatar_url":"https://avatars.githubusercontent.com/u/12110348?v=4","gravatar_id":"","url":"https://api.github.com/users/denys-chaikovskyi","html_url":"https://github.com/denys-chaikovskyi","followers_url":"https://api.github.com/users/denys-chaikovskyi/followers","following_url":"https://api.github.com/users/denys-chaikovskyi/following{/other_user}","gists_url":"https://api.github.com/users/denys-chaikovskyi/gists{/gist_id}","starred_url":"https://api.github.com/users/denys-chaikovskyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/denys-chaikovskyi/subscriptions","organizations_url":"https://api.github.com/users/denys-chaikovskyi/orgs","repos_url":"https://api.github.com/users/denys-chaikovskyi/repos","events_url":"https://api.github.com/users/denys-chaikovskyi/events{/privacy}","received_events_url":"https://api.github.com/users/denys-chaikovskyi/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":13784388713,"node_id":"MEE_lADNIULOkiBcO88AAAADNZ0UaQ","url":"https://api.github.com/repos/rails/rails/issues/events/13784388713","actor":{"login":"dhh","id":2741,"node_id":"MDQ6VXNlcjI3NDE=","avatar_url":"https://avatars.githubusercontent.com/u/2741?v=4","gravatar_id":"","url":"https://api.github.com/users/dhh","html_url":"https://github.com/dhh","followers_url":"https://api.github.com/users/dhh/followers","following_url":"https://api.github.com/users/dhh/following{/other_user}","gists_url":"https://api.github.com/users/dhh/gists{/gist_id}","starred_url":"https://api.github.com/users/dhh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dhh/subscriptions","organizations_url":"https://api.github.com/users/dhh/orgs","repos_url":"https://api.github.com/users/dhh/repos","events_url":"https://api.github.com/users/dhh/events{/privacy}","received_events_url":"https://api.github.com/users/dhh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-08-06T22:01:47Z","performed_via_github_app":null},{"id":13784388724,"node_id":"SE_lADNIULOkiBcO88AAAADNZ0UdA","url":"https://api.github.com/repos/rails/rails/issues/events/13784388724","actor":{"login":"dhh","id":2741,"node_id":"MDQ6VXNlcjI3NDE=","avatar_url":"https://avatars.githubusercontent.com/u/2741?v=4","gravatar_id":"","url":"https://api.github.com/users/dhh","html_url":"https://github.com/dhh","followers_url":"https://api.github.com/users/dhh/followers","following_url":"https://api.github.com/users/dhh/following{/other_user}","gists_url":"https://api.github.com/users/dhh/gists{/gist_id}","starred_url":"https://api.github.com/users/dhh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dhh/subscriptions","organizations_url":"https://api.github.com/users/dhh/orgs","repos_url":"https://api.github.com/users/dhh/repos","events_url":"https://api.github.com/users/dhh/events{/privacy}","received_events_url":"https://api.github.com/users/dhh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-08-06T22:01:47Z","performed_via_github_app":null},{"id":13784388739,"node_id":"MEE_lADNIULOkiBcO88AAAADNZ0Ugw","url":"https://api.github.com/repos/rails/rails/issues/events/13784388739","actor":{"login":"byroot","id":44640,"node_id":"MDQ6VXNlcjQ0NjQw","avatar_url":"https://avatars.githubusercontent.com/u/44640?v=4","gravatar_id":"","url":"https://api.github.com/users/byroot","html_url":"https://github.com/byroot","followers_url":"https://api.github.com/users/byroot/followers","following_url":"https://api.github.com/users/byroot/following{/other_user}","gists_url":"https://api.github.com/users/byroot/gists{/gist_id}","starred_url":"https://api.github.com/users/byroot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/byroot/subscriptions","organizations_url":"https://api.github.com/users/byroot/orgs","repos_url":"https://api.github.com/users/byroot/repos","events_url":"https://api.github.com/users/byroot/events{/privacy}","received_events_url":"https://api.github.com/users/byroot/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-08-06T22:01:48Z","performed_via_github_app":null},{"id":13784388750,"node_id":"SE_lADNIULOkiBcO88AAAADNZ0Ujg","url":"https://api.github.com/repos/rails/rails/issues/events/13784388750","actor":{"login":"byroot","id":44640,"node_id":"MDQ6VXNlcjQ0NjQw","avatar_url":"https://avatars.githubusercontent.com/u/44640?v=4","gravatar_id":"","url":"https://api.github.com/users/byroot","html_url":"https://github.com/byroot","followers_url":"https://api.github.com/users/byroot/followers","following_url":"https://api.github.com/users/byroot/following{/other_user}","gists_url":"https://api.github.com/users/byroot/gists{/gist_id}","starred_url":"https://api.github.com/users/byroot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/byroot/subscriptions","organizations_url":"https://api.github.com/users/byroot/orgs","repos_url":"https://api.github.com/users/byroot/repos","events_url":"https://api.github.com/users/byroot/events{/privacy}","received_events_url":"https://api.github.com/users/byroot/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-08-06T22:01:48Z","performed_via_github_app":null},{"id":13784388765,"node_id":"MEE_lADNIULOkiBcO88AAAADNZ0UnQ","url":"https://api.github.com/repos/rails/rails/issues/events/13784388765","actor":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-08-06T22:01:48Z","performed_via_github_app":null},{"id":13784388773,"node_id":"SE_lADNIULOkiBcO88AAAADNZ0UpQ","url":"https://api.github.com/repos/rails/rails/issues/events/13784388773","actor":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-08-06T22:01:48Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/rails/rails/issues/comments/2272252199","html_url":"https://github.com/rails/rails/issues/52522#issuecomment-2272252199","issue_url":"https://api.github.com/repos/rails/rails/issues/52522","id":2272252199,"node_id":"IC_kwDNIULOh2_RJw","user":{"login":"byroot","id":44640,"node_id":"MDQ6VXNlcjQ0NjQw","avatar_url":"https://avatars.githubusercontent.com/u/44640?v=4","gravatar_id":"","url":"https://api.github.com/users/byroot","html_url":"https://github.com/byroot","followers_url":"https://api.github.com/users/byroot/followers","following_url":"https://api.github.com/users/byroot/following{/other_user}","gists_url":"https://api.github.com/users/byroot/gists{/gist_id}","starred_url":"https://api.github.com/users/byroot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/byroot/subscriptions","organizations_url":"https://api.github.com/users/byroot/orgs","repos_url":"https://api.github.com/users/byroot/repos","events_url":"https://api.github.com/users/byroot/events{/privacy}","received_events_url":"https://api.github.com/users/byroot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-06T22:25:13Z","updated_at":"2024-08-06T22:25:13Z","body":"I think we could have `WEB_CONCURRENCY=auto` (or whatever the new name is), so that if you are using a platform that supports it you don't need to repeat yourself. But yes, `1` is a safer default.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/comments/2272252199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"byroot","id":44640,"node_id":"MDQ6VXNlcjQ0NjQw","avatar_url":"https://avatars.githubusercontent.com/u/44640?v=4","gravatar_id":"","url":"https://api.github.com/users/byroot","html_url":"https://github.com/byroot","followers_url":"https://api.github.com/users/byroot/followers","following_url":"https://api.github.com/users/byroot/following{/other_user}","gists_url":"https://api.github.com/users/byroot/gists{/gist_id}","starred_url":"https://api.github.com/users/byroot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/byroot/subscriptions","organizations_url":"https://api.github.com/users/byroot/orgs","repos_url":"https://api.github.com/users/byroot/repos","events_url":"https://api.github.com/users/byroot/events{/privacy}","received_events_url":"https://api.github.com/users/byroot/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":13785638050,"node_id":"CE_lADNIULOkiBcO88AAAADNbAkog","url":"https://api.github.com/repos/rails/rails/issues/events/13785638050","actor":{"login":"dhh","id":2741,"node_id":"MDQ6VXNlcjI3NDE=","avatar_url":"https://avatars.githubusercontent.com/u/2741?v=4","gravatar_id":"","url":"https://api.github.com/users/dhh","html_url":"https://github.com/dhh","followers_url":"https://api.github.com/users/dhh/followers","following_url":"https://api.github.com/users/dhh/following{/other_user}","gists_url":"https://api.github.com/users/dhh/gists{/gist_id}","starred_url":"https://api.github.com/users/dhh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dhh/subscriptions","organizations_url":"https://api.github.com/users/dhh/orgs","repos_url":"https://api.github.com/users/dhh/repos","events_url":"https://api.github.com/users/dhh/events{/privacy}","received_events_url":"https://api.github.com/users/dhh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"e3ec553f8c51fc646cecd7fc5efc7fae61e64827","commit_url":"https://api.github.com/repos/rails/rails/commits/e3ec553f8c51fc646cecd7fc5efc7fae61e64827","created_at":"2024-08-07T01:53:42Z","state_reason":null,"performed_via_github_app":null},{"id":13786892969,"node_id":"REFE_lADNIULOkiBcO88AAAADNcNKqQ","url":"https://api.github.com/repos/rails/rails/issues/events/13786892969","actor":{"login":"gmcgibbon","id":5162312,"node_id":"MDQ6VXNlcjUxNjIzMTI=","avatar_url":"https://avatars.githubusercontent.com/u/5162312?v=4","gravatar_id":"","url":"https://api.github.com/users/gmcgibbon","html_url":"https://github.com/gmcgibbon","followers_url":"https://api.github.com/users/gmcgibbon/followers","following_url":"https://api.github.com/users/gmcgibbon/following{/other_user}","gists_url":"https://api.github.com/users/gmcgibbon/gists{/gist_id}","starred_url":"https://api.github.com/users/gmcgibbon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gmcgibbon/subscriptions","organizations_url":"https://api.github.com/users/gmcgibbon/orgs","repos_url":"https://api.github.com/users/gmcgibbon/repos","events_url":"https://api.github.com/users/gmcgibbon/events{/privacy}","received_events_url":"https://api.github.com/users/gmcgibbon/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"e3ec553f8c51fc646cecd7fc5efc7fae61e64827","commit_url":"https://api.github.com/repos/Shopify/rails/commits/e3ec553f8c51fc646cecd7fc5efc7fae61e64827","created_at":"2024-08-07T05:38:21Z","performed_via_github_app":null},{"id":13787671653,"node_id":"REE_lADNIULOkiBcO88AAAADNc8sZQ","url":"https://api.github.com/repos/rails/rails/issues/events/13787671653","actor":{"login":"byroot","id":44640,"node_id":"MDQ6VXNlcjQ0NjQw","avatar_url":"https://avatars.githubusercontent.com/u/44640?v=4","gravatar_id":"","url":"https://api.github.com/users/byroot","html_url":"https://github.com/byroot","followers_url":"https://api.github.com/users/byroot/followers","following_url":"https://api.github.com/users/byroot/following{/other_user}","gists_url":"https://api.github.com/users/byroot/gists{/gist_id}","starred_url":"https://api.github.com/users/byroot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/byroot/subscriptions","organizations_url":"https://api.github.com/users/byroot/orgs","repos_url":"https://api.github.com/users/byroot/repos","events_url":"https://api.github.com/users/byroot/events{/privacy}","received_events_url":"https://api.github.com/users/byroot/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"reopened","commit_id":null,"commit_url":null,"created_at":"2024-08-07T07:00:35Z","state_reason":"reopened","performed_via_github_app":null},{"url":"https://api.github.com/repos/rails/rails/issues/comments/2272765270","html_url":"https://github.com/rails/rails/issues/52522#issuecomment-2272765270","issue_url":"https://api.github.com/repos/rails/rails/issues/52522","id":2272765270,"node_id":"IC_kwDNIULOh3elVg","user":{"login":"byroot","id":44640,"node_id":"MDQ6VXNlcjQ0NjQw","avatar_url":"https://avatars.githubusercontent.com/u/44640?v=4","gravatar_id":"","url":"https://api.github.com/users/byroot","html_url":"https://github.com/byroot","followers_url":"https://api.github.com/users/byroot/followers","following_url":"https://api.github.com/users/byroot/following{/other_user}","gists_url":"https://api.github.com/users/byroot/gists{/gist_id}","starred_url":"https://api.github.com/users/byroot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/byroot/subscriptions","organizations_url":"https://api.github.com/users/byroot/orgs","repos_url":"https://api.github.com/users/byroot/repos","events_url":"https://api.github.com/users/byroot/events{/privacy}","received_events_url":"https://api.github.com/users/byroot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-07T07:02:59Z","updated_at":"2024-08-07T07:02:59Z","body":"I don't think https://github.com/rails/rails/commit/e3ec553f8c51fc646cecd7fc5efc7fae61e64827 is enough, because that only concerns Kamal. ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/comments/2272765270/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"byroot","id":44640,"node_id":"MDQ6VXNlcjQ0NjQw","avatar_url":"https://avatars.githubusercontent.com/u/44640?v=4","gravatar_id":"","url":"https://api.github.com/users/byroot","html_url":"https://github.com/byroot","followers_url":"https://api.github.com/users/byroot/followers","following_url":"https://api.github.com/users/byroot/following{/other_user}","gists_url":"https://api.github.com/users/byroot/gists{/gist_id}","starred_url":"https://api.github.com/users/byroot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/byroot/subscriptions","organizations_url":"https://api.github.com/users/byroot/orgs","repos_url":"https://api.github.com/users/byroot/repos","events_url":"https://api.github.com/users/byroot/events{/privacy}","received_events_url":"https://api.github.com/users/byroot/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rails/rails/issues/comments/2273854610","html_url":"https://github.com/rails/rails/issues/52522#issuecomment-2273854610","issue_url":"https://api.github.com/repos/rails/rails/issues/52522","id":2273854610,"node_id":"IC_kwDNIULOh4hEkg","user":{"login":"denys-chaikovskyi","id":12110348,"node_id":"MDQ6VXNlcjEyMTEwMzQ4","avatar_url":"https://avatars.githubusercontent.com/u/12110348?v=4","gravatar_id":"","url":"https://api.github.com/users/denys-chaikovskyi","html_url":"https://github.com/denys-chaikovskyi","followers_url":"https://api.github.com/users/denys-chaikovskyi/followers","following_url":"https://api.github.com/users/denys-chaikovskyi/following{/other_user}","gists_url":"https://api.github.com/users/denys-chaikovskyi/gists{/gist_id}","starred_url":"https://api.github.com/users/denys-chaikovskyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/denys-chaikovskyi/subscriptions","organizations_url":"https://api.github.com/users/denys-chaikovskyi/orgs","repos_url":"https://api.github.com/users/denys-chaikovskyi/repos","events_url":"https://api.github.com/users/denys-chaikovskyi/events{/privacy}","received_events_url":"https://api.github.com/users/denys-chaikovskyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-07T16:24:02Z","updated_at":"2024-08-07T16:24:02Z","body":"I think `WEB_CONCURRENCY=auto` (or another name) suggested by @byroot could be a great middle-ground solution to provide a stable experience for platforms with shared vCPU with or without Kamal\r\n\r\nIn `deploy.yml` we can mention \"auto\" as a possible option to use with the caveat-comment written by @dhh\r\n\r\n```yml\r\nclear:\r\n    # Set this to the number of cores you wish the application to use on each server.\r\n    # You can use \"auto\" and the app will attempt to use all available cores (but may guess wrong on some cloud hosts!)\r\n    WEB_CONCURRENCY: 1\r\n```\r\n\r\nAnd in `puma.rb` have something like this:\r\n```ruby\r\n  workers_count = if ENV[\"WEB_CONCURRENCY\"] == \"auto\"\r\n                    Concurrent.available_processor_count\r\n                  else\r\n                    Integer(ENV.fetch(\"WEB_CONCURRENCY\", 1))\r\n                  end\r\n  workers workers_count if workers_count > 1\r\n  ```\r\n  \r\n  What do you think about this approach @dhh @byroot @rafaelfranca ?\r\n\r\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/rails/rails/issues/comments/2273854610/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"denys-chaikovskyi","id":12110348,"node_id":"MDQ6VXNlcjEyMTEwMzQ4","avatar_url":"https://avatars.githubusercontent.com/u/12110348?v=4","gravatar_id":"","url":"https://api.github.com/users/denys-chaikovskyi","html_url":"https://github.com/denys-chaikovskyi","followers_url":"https://api.github.com/users/denys-chaikovskyi/followers","following_url":"https://api.github.com/users/denys-chaikovskyi/following{/other_user}","gists_url":"https://api.github.com/users/denys-chaikovskyi/gists{/gist_id}","starred_url":"https://api.github.com/users/denys-chaikovskyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/denys-chaikovskyi/subscriptions","organizations_url":"https://api.github.com/users/denys-chaikovskyi/orgs","repos_url":"https://api.github.com/users/denys-chaikovskyi/repos","events_url":"https://api.github.com/users/denys-chaikovskyi/events{/privacy}","received_events_url":"https://api.github.com/users/denys-chaikovskyi/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":13794981402,"node_id":"MEE_lADNIULOkiBcO88AAAADNj62Gg","url":"https://api.github.com/repos/rails/rails/issues/events/13794981402","actor":{"login":"dhh","id":2741,"node_id":"MDQ6VXNlcjI3NDE=","avatar_url":"https://avatars.githubusercontent.com/u/2741?v=4","gravatar_id":"","url":"https://api.github.com/users/dhh","html_url":"https://github.com/dhh","followers_url":"https://api.github.com/users/dhh/followers","following_url":"https://api.github.com/users/dhh/following{/other_user}","gists_url":"https://api.github.com/users/dhh/gists{/gist_id}","starred_url":"https://api.github.com/users/dhh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dhh/subscriptions","organizations_url":"https://api.github.com/users/dhh/orgs","repos_url":"https://api.github.com/users/dhh/repos","events_url":"https://api.github.com/users/dhh/events{/privacy}","received_events_url":"https://api.github.com/users/dhh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-08-07T16:24:03Z","performed_via_github_app":null},{"id":13794981410,"node_id":"SE_lADNIULOkiBcO88AAAADNj62Ig","url":"https://api.github.com/repos/rails/rails/issues/events/13794981410","actor":{"login":"dhh","id":2741,"node_id":"MDQ6VXNlcjI3NDE=","avatar_url":"https://avatars.githubusercontent.com/u/2741?v=4","gravatar_id":"","url":"https://api.github.com/users/dhh","html_url":"https://github.com/dhh","followers_url":"https://api.github.com/users/dhh/followers","following_url":"https://api.github.com/users/dhh/following{/other_user}","gists_url":"https://api.github.com/users/dhh/gists{/gist_id}","starred_url":"https://api.github.com/users/dhh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dhh/subscriptions","organizations_url":"https://api.github.com/users/dhh/orgs","repos_url":"https://api.github.com/users/dhh/repos","events_url":"https://api.github.com/users/dhh/events{/privacy}","received_events_url":"https://api.github.com/users/dhh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-08-07T16:24:03Z","performed_via_github_app":null},{"id":13794981423,"node_id":"MEE_lADNIULOkiBcO88AAAADNj62Lw","url":"https://api.github.com/repos/rails/rails/issues/events/13794981423","actor":{"login":"byroot","id":44640,"node_id":"MDQ6VXNlcjQ0NjQw","avatar_url":"https://avatars.githubusercontent.com/u/44640?v=4","gravatar_id":"","url":"https://api.github.com/users/byroot","html_url":"https://github.com/byroot","followers_url":"https://api.github.com/users/byroot/followers","following_url":"https://api.github.com/users/byroot/following{/other_user}","gists_url":"https://api.github.com/users/byroot/gists{/gist_id}","starred_url":"https://api.github.com/users/byroot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/byroot/subscriptions","organizations_url":"https://api.github.com/users/byroot/orgs","repos_url":"https://api.github.com/users/byroot/repos","events_url":"https://api.github.com/users/byroot/events{/privacy}","received_events_url":"https://api.github.com/users/byroot/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-08-07T16:24:03Z","performed_via_github_app":null},{"id":13794981432,"node_id":"SE_lADNIULOkiBcO88AAAADNj62OA","url":"https://api.github.com/repos/rails/rails/issues/events/13794981432","actor":{"login":"byroot","id":44640,"node_id":"MDQ6VXNlcjQ0NjQw","avatar_url":"https://avatars.githubusercontent.com/u/44640?v=4","gravatar_id":"","url":"https://api.github.com/users/byroot","html_url":"https://github.com/byroot","followers_url":"https://api.github.com/users/byroot/followers","following_url":"https://api.github.com/users/byroot/following{/other_user}","gists_url":"https://api.github.com/users/byroot/gists{/gist_id}","starred_url":"https://api.github.com/users/byroot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/byroot/subscriptions","organizations_url":"https://api.github.com/users/byroot/orgs","repos_url":"https://api.github.com/users/byroot/repos","events_url":"https://api.github.com/users/byroot/events{/privacy}","received_events_url":"https://api.github.com/users/byroot/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-08-07T16:24:03Z","performed_via_github_app":null}]