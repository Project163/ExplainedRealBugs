{"url":"https://api.github.com/repos/rails/rails/issues/51606","repository_url":"https://api.github.com/repos/rails/rails","labels_url":"https://api.github.com/repos/rails/rails/issues/51606/labels{/name}","comments_url":"https://api.github.com/repos/rails/rails/issues/51606/comments","events_url":"https://api.github.com/repos/rails/rails/issues/51606/events","html_url":"https://github.com/rails/rails/issues/51606","id":2252182200,"node_id":"I_kwDNIULOhj2SuA","number":51606,"title":"collection_check_boxes hidden field ignores :form option","user":{"login":"stimlocy","id":19663433,"node_id":"MDQ6VXNlcjE5NjYzNDMz","avatar_url":"https://avatars.githubusercontent.com/u/19663433?v=4","gravatar_id":"","url":"https://api.github.com/users/stimlocy","html_url":"https://github.com/stimlocy","followers_url":"https://api.github.com/users/stimlocy/followers","following_url":"https://api.github.com/users/stimlocy/following{/other_user}","gists_url":"https://api.github.com/users/stimlocy/gists{/gist_id}","starred_url":"https://api.github.com/users/stimlocy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stimlocy/subscriptions","organizations_url":"https://api.github.com/users/stimlocy/orgs","repos_url":"https://api.github.com/users/stimlocy/repos","events_url":"https://api.github.com/users/stimlocy/events{/privacy}","received_events_url":"https://api.github.com/users/stimlocy/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":3666649,"node_id":"MDU6TGFiZWwzNjY2NjQ5","url":"https://api.github.com/repos/rails/rails/labels/actionview","name":"actionview","color":"d7e102","default":false,"description":null},{"id":41328116,"node_id":"MDU6TGFiZWw0MTMyODExNg==","url":"https://api.github.com/repos/rails/rails/labels/attached%20PR","name":"attached PR","color":"006b75","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2024-04-19T06:26:27Z","updated_at":"2025-01-08T16:03:15Z","closed_at":"2025-01-08T16:03:14Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"hidden field generated from `collection_check_boxes` ignores `form:` as `html_options`\r\n\r\n\r\n### Steps to reproduce\r\n\r\n```erb\r\n<%= form_with(url: parents_url, scope: :search, method: :get, id: 'myform') do |f| %>\r\n  <%= f.search_field :name %>\r\n  <%= f.submit %>\r\n<% end %>\r\n\r\n<%= collection_check_boxes :search, :parent_ids, Parent.all, :id, :name, {}, {form: 'myform'} %>\r\n```\r\n\r\n\r\n### Expected behavior\r\n```html\r\n<form id=\"myform\" action=\"http://localhost:3000/parents\" accept-charset=\"UTF-8\" method=\"get\">\r\n  <input type=\"search\" name=\"search[name]\" id=\"search_name\">\r\n  <input type=\"submit\" name=\"commit\" value=\"Save Search\" data-disable-with=\"Save Search\">\r\n</form>\r\n\r\n<input form=\"myform\" type=\"hidden\" name=\"search[parent_ids][]\" value=\"\" autocomplete=\"off\">\r\n<input form=\"myform\" type=\"checkbox\" value=\"1\" name=\"search[parent_ids][]\" id=\"search_parent_ids_1\">\r\n<label for=\"search_parent_ids_1\">Parent_1</label>\r\n```\r\n\r\n### Actual behavior\r\n```html\r\n<form id=\"myform\" action=\"http://localhost:3000/parents\" accept-charset=\"UTF-8\" method=\"get\">\r\n  <input type=\"search\" name=\"search[name]\" id=\"search_name\">\r\n  <input type=\"submit\" name=\"commit\" value=\"Save Search\" data-disable-with=\"Save Search\">\r\n</form>\r\n\r\n<input type=\"hidden\" name=\"search[parent_ids][]\" value=\"\" autocomplete=\"off\">  <!-- not exist form=\"myform\" -->\r\n<input form=\"myform\" type=\"checkbox\" value=\"1\" name=\"search[parent_ids][]\" id=\"search_parent_ids_1\">\r\n<label for=\"search_parent_ids_1\">Parent_1</label>\r\n```\r\n\r\nProbably the same problem as #12344\r\n\r\n\r\n### System configuration\r\n**Rails version**: 7.1.3.2\r\n**Ruby version**: 3.3.0\r\n\r\n\r\nUsing `collection_check_boxes` inside a form is fine, but if you want to use them outside of a form, it is convenient to be able to use the `:form` option.\r\nFor now, I am using `include_hidden: false` and `<%= hidden_field_tag 'search[parent_ids][]', {}, form: 'myform' %>` to work around the problem.\r\n\r\n\r\nLet me know if there's any additional information needed.","closed_by":{"login":"rafaelfranca","id":47848,"node_id":"MDQ6VXNlcjQ3ODQ4","avatar_url":"https://avatars.githubusercontent.com/u/47848?v=4","gravatar_id":"","url":"https://api.github.com/users/rafaelfranca","html_url":"https://github.com/rafaelfranca","followers_url":"https://api.github.com/users/rafaelfranca/followers","following_url":"https://api.github.com/users/rafaelfranca/following{/other_user}","gists_url":"https://api.github.com/users/rafaelfranca/gists{/gist_id}","starred_url":"https://api.github.com/users/rafaelfranca/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rafaelfranca/subscriptions","organizations_url":"https://api.github.com/users/rafaelfranca/orgs","repos_url":"https://api.github.com/users/rafaelfranca/repos","events_url":"https://api.github.com/users/rafaelfranca/events{/privacy}","received_events_url":"https://api.github.com/users/rafaelfranca/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rails/rails/issues/51606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rails/rails/issues/51606/timeline","performed_via_github_app":null,"state_reason":"completed"}