[{"url":"https://api.github.com/repos/rs/zerolog/issues/comments/401946420","html_url":"https://github.com/rs/zerolog/issues/80#issuecomment-401946420","issue_url":"https://api.github.com/repos/rs/zerolog/issues/80","id":401946420,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMTk0NjQyMA==","user":{"login":"rs","id":68232,"node_id":"MDQ6VXNlcjY4MjMy","avatar_url":"https://avatars.githubusercontent.com/u/68232?v=4","gravatar_id":"","url":"https://api.github.com/users/rs","html_url":"https://github.com/rs","followers_url":"https://api.github.com/users/rs/followers","following_url":"https://api.github.com/users/rs/following{/other_user}","gists_url":"https://api.github.com/users/rs/gists{/gist_id}","starred_url":"https://api.github.com/users/rs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rs/subscriptions","organizations_url":"https://api.github.com/users/rs/orgs","repos_url":"https://api.github.com/users/rs/repos","events_url":"https://api.github.com/users/rs/events{/privacy}","received_events_url":"https://api.github.com/users/rs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-07-02T21:40:56Z","updated_at":"2018-07-02T21:40:56Z","body":"The rational is that a request context should only have a single instance of the logger so your requests can add fields that are visible to parent middleware for instance. This is particularly useful with the `hlog.AccessHandler` which can be augmented with request specific fields.\r\n\r\nThis is also better for performance. Storing a new instance of the logger in the context for each update would end up with a pretty narrow context tree that would impact lookup time for every `context.Value` calls.\r\n\r\n","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/rs/zerolog/issues/comments/401946420/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rs","id":68232,"node_id":"MDQ6VXNlcjY4MjMy","avatar_url":"https://avatars.githubusercontent.com/u/68232?v=4","gravatar_id":"","url":"https://api.github.com/users/rs","html_url":"https://github.com/rs","followers_url":"https://api.github.com/users/rs/followers","following_url":"https://api.github.com/users/rs/following{/other_user}","gists_url":"https://api.github.com/users/rs/gists{/gist_id}","starred_url":"https://api.github.com/users/rs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rs/subscriptions","organizations_url":"https://api.github.com/users/rs/orgs","repos_url":"https://api.github.com/users/rs/repos","events_url":"https://api.github.com/users/rs/events{/privacy}","received_events_url":"https://api.github.com/users/rs/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rs/zerolog/issues/comments/401951635","html_url":"https://github.com/rs/zerolog/issues/80#issuecomment-401951635","issue_url":"https://api.github.com/repos/rs/zerolog/issues/80","id":401951635,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMTk1MTYzNQ==","user":{"login":"bluekeyes","id":1745813,"node_id":"MDQ6VXNlcjE3NDU4MTM=","avatar_url":"https://avatars.githubusercontent.com/u/1745813?v=4","gravatar_id":"","url":"https://api.github.com/users/bluekeyes","html_url":"https://github.com/bluekeyes","followers_url":"https://api.github.com/users/bluekeyes/followers","following_url":"https://api.github.com/users/bluekeyes/following{/other_user}","gists_url":"https://api.github.com/users/bluekeyes/gists{/gist_id}","starred_url":"https://api.github.com/users/bluekeyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluekeyes/subscriptions","organizations_url":"https://api.github.com/users/bluekeyes/orgs","repos_url":"https://api.github.com/users/bluekeyes/repos","events_url":"https://api.github.com/users/bluekeyes/events{/privacy}","received_events_url":"https://api.github.com/users/bluekeyes/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-07-02T22:02:46Z","updated_at":"2018-07-02T22:02:46Z","body":"Thanks. I think I understand the reasoning here, but I'm now confused by the difference between `(*Logger) UpdateContext` and `(Logger) WithContext`. It seems that `UpdateContext` also achieves what you describe (fields visible to parent middleware, no new context), so is there a reason to use `WithContext` instead of calling `zerolog.Ctx(ctx).UpdateContext(...)` in places that want this behavior?\r\n\r\nTo give a more concrete example, I have an application that responds to a GitHub webhook and performs an action on every open pull request in the repository. In the handler, I loop over the open PRs and call `updatePullRequest(context.Context, *github.PullRequest)`. This does some logging of its own (and may call other functions that log), so I want to attach the PR number that is being processed to the logger in the context that I pass.\r\n\r\nIn your view, is it better to pass the modified logger explicitly as an argument or re-add the necessary fields at each level instead of passing a modified context?\r\n\r\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rs/zerolog/issues/comments/401951635/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bluekeyes","id":1745813,"node_id":"MDQ6VXNlcjE3NDU4MTM=","avatar_url":"https://avatars.githubusercontent.com/u/1745813?v=4","gravatar_id":"","url":"https://api.github.com/users/bluekeyes","html_url":"https://github.com/bluekeyes","followers_url":"https://api.github.com/users/bluekeyes/followers","following_url":"https://api.github.com/users/bluekeyes/following{/other_user}","gists_url":"https://api.github.com/users/bluekeyes/gists{/gist_id}","starred_url":"https://api.github.com/users/bluekeyes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bluekeyes/subscriptions","organizations_url":"https://api.github.com/users/bluekeyes/orgs","repos_url":"https://api.github.com/users/bluekeyes/repos","events_url":"https://api.github.com/users/bluekeyes/events{/privacy}","received_events_url":"https://api.github.com/users/bluekeyes/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rs/zerolog/issues/comments/401953967","html_url":"https://github.com/rs/zerolog/issues/80#issuecomment-401953967","issue_url":"https://api.github.com/repos/rs/zerolog/issues/80","id":401953967,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMTk1Mzk2Nw==","user":{"login":"rs","id":68232,"node_id":"MDQ6VXNlcjY4MjMy","avatar_url":"https://avatars.githubusercontent.com/u/68232?v=4","gravatar_id":"","url":"https://api.github.com/users/rs","html_url":"https://github.com/rs","followers_url":"https://api.github.com/users/rs/followers","following_url":"https://api.github.com/users/rs/following{/other_user}","gists_url":"https://api.github.com/users/rs/gists{/gist_id}","starred_url":"https://api.github.com/users/rs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rs/subscriptions","organizations_url":"https://api.github.com/users/rs/orgs","repos_url":"https://api.github.com/users/rs/repos","events_url":"https://api.github.com/users/rs/events{/privacy}","received_events_url":"https://api.github.com/users/rs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-07-02T22:13:57Z","updated_at":"2018-07-02T22:13:57Z","body":"The `(*Logger) UpdateContext` will update the context of the logger with no copy of the logger (in place). If the `(Logger) WithContext` was just storing the pointer without trying to reuse the existing one, it would store the same pointer over and over in the context for each call of `WithContext`.\r\n\r\nWhat I can do though, is only updating the existing pointer if the currently stored logger is the same as the one you are trying to store. This way, if you copy the logger instead of calling `WithContext`, it will behave the way you expect.","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/rs/zerolog/issues/comments/401953967/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rs","id":68232,"node_id":"MDQ6VXNlcjY4MjMy","avatar_url":"https://avatars.githubusercontent.com/u/68232?v=4","gravatar_id":"","url":"https://api.github.com/users/rs","html_url":"https://github.com/rs","followers_url":"https://api.github.com/users/rs/followers","following_url":"https://api.github.com/users/rs/following{/other_user}","gists_url":"https://api.github.com/users/rs/gists{/gist_id}","starred_url":"https://api.github.com/users/rs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rs/subscriptions","organizations_url":"https://api.github.com/users/rs/orgs","repos_url":"https://api.github.com/users/rs/repos","events_url":"https://api.github.com/users/rs/events{/privacy}","received_events_url":"https://api.github.com/users/rs/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1712718522,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDE3MTI3MTg1MjI=","url":"https://api.github.com/repos/rs/zerolog/issues/events/1712718522","actor":{"login":"rs","id":68232,"node_id":"MDQ6VXNlcjY4MjMy","avatar_url":"https://avatars.githubusercontent.com/u/68232?v=4","gravatar_id":"","url":"https://api.github.com/users/rs","html_url":"https://github.com/rs","followers_url":"https://api.github.com/users/rs/followers","following_url":"https://api.github.com/users/rs/following{/other_user}","gists_url":"https://api.github.com/users/rs/gists{/gist_id}","starred_url":"https://api.github.com/users/rs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rs/subscriptions","organizations_url":"https://api.github.com/users/rs/orgs","repos_url":"https://api.github.com/users/rs/repos","events_url":"https://api.github.com/users/rs/events{/privacy}","received_events_url":"https://api.github.com/users/rs/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"e5651e4dbdaaf84cd87e13ee2954edf64a39712e","commit_url":"https://api.github.com/repos/rs/zerolog/commits/e5651e4dbdaaf84cd87e13ee2954edf64a39712e","created_at":"2018-07-02T23:02:27Z","performed_via_github_app":null},{"actor":{"login":"rs","id":68232,"node_id":"MDQ6VXNlcjY4MjMy","avatar_url":"https://avatars.githubusercontent.com/u/68232?v=4","gravatar_id":"","url":"https://api.github.com/users/rs","html_url":"https://github.com/rs","followers_url":"https://api.github.com/users/rs/followers","following_url":"https://api.github.com/users/rs/following{/other_user}","gists_url":"https://api.github.com/users/rs/gists{/gist_id}","starred_url":"https://api.github.com/users/rs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rs/subscriptions","organizations_url":"https://api.github.com/users/rs/orgs","repos_url":"https://api.github.com/users/rs/repos","events_url":"https://api.github.com/users/rs/events{/privacy}","received_events_url":"https://api.github.com/users/rs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-07-02T23:03:12Z","updated_at":"2018-07-02T23:03:12Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/rs/zerolog/issues/81","repository_url":"https://api.github.com/repos/rs/zerolog","labels_url":"https://api.github.com/repos/rs/zerolog/issues/81/labels{/name}","comments_url":"https://api.github.com/repos/rs/zerolog/issues/81/comments","events_url":"https://api.github.com/repos/rs/zerolog/issues/81/events","html_url":"https://github.com/rs/zerolog/pull/81","id":337691564,"node_id":"MDExOlB1bGxSZXF1ZXN0MTk4ODEwNDYw","number":81,"title":"ctx: store logger in context when missing or different that stored one","user":{"login":"rs","id":68232,"node_id":"MDQ6VXNlcjY4MjMy","avatar_url":"https://avatars.githubusercontent.com/u/68232?v=4","gravatar_id":"","url":"https://api.github.com/users/rs","html_url":"https://github.com/rs","followers_url":"https://api.github.com/users/rs/followers","following_url":"https://api.github.com/users/rs/following{/other_user}","gists_url":"https://api.github.com/users/rs/gists{/gist_id}","starred_url":"https://api.github.com/users/rs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rs/subscriptions","organizations_url":"https://api.github.com/users/rs/orgs","repos_url":"https://api.github.com/users/rs/repos","events_url":"https://api.github.com/users/rs/events{/privacy}","received_events_url":"https://api.github.com/users/rs/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2018-07-02T23:03:11Z","updated_at":"2018-07-03T01:23:54Z","closed_at":"2018-07-03T01:23:54Z","author_association":"OWNER","active_lock_reason":null,"draft":false,"repository":{"id":91054480,"node_id":"MDEwOlJlcG9zaXRvcnk5MTA1NDQ4MA==","name":"zerolog","full_name":"rs/zerolog","private":false,"owner":{"login":"rs","id":68232,"node_id":"MDQ6VXNlcjY4MjMy","avatar_url":"https://avatars.githubusercontent.com/u/68232?v=4","gravatar_id":"","url":"https://api.github.com/users/rs","html_url":"https://github.com/rs","followers_url":"https://api.github.com/users/rs/followers","following_url":"https://api.github.com/users/rs/following{/other_user}","gists_url":"https://api.github.com/users/rs/gists{/gist_id}","starred_url":"https://api.github.com/users/rs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rs/subscriptions","organizations_url":"https://api.github.com/users/rs/orgs","repos_url":"https://api.github.com/users/rs/repos","events_url":"https://api.github.com/users/rs/events{/privacy}","received_events_url":"https://api.github.com/users/rs/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/rs/zerolog","description":"Zero Allocation JSON Logger","fork":false,"url":"https://api.github.com/repos/rs/zerolog","forks_url":"https://api.github.com/repos/rs/zerolog/forks","keys_url":"https://api.github.com/repos/rs/zerolog/keys{/key_id}","collaborators_url":"https://api.github.com/repos/rs/zerolog/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/rs/zerolog/teams","hooks_url":"https://api.github.com/repos/rs/zerolog/hooks","issue_events_url":"https://api.github.com/repos/rs/zerolog/issues/events{/number}","events_url":"https://api.github.com/repos/rs/zerolog/events","assignees_url":"https://api.github.com/repos/rs/zerolog/assignees{/user}","branches_url":"https://api.github.com/repos/rs/zerolog/branches{/branch}","tags_url":"https://api.github.com/repos/rs/zerolog/tags","blobs_url":"https://api.github.com/repos/rs/zerolog/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/rs/zerolog/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/rs/zerolog/git/refs{/sha}","trees_url":"https://api.github.com/repos/rs/zerolog/git/trees{/sha}","statuses_url":"https://api.github.com/repos/rs/zerolog/statuses/{sha}","languages_url":"https://api.github.com/repos/rs/zerolog/languages","stargazers_url":"https://api.github.com/repos/rs/zerolog/stargazers","contributors_url":"https://api.github.com/repos/rs/zerolog/contributors","subscribers_url":"https://api.github.com/repos/rs/zerolog/subscribers","subscription_url":"https://api.github.com/repos/rs/zerolog/subscription","commits_url":"https://api.github.com/repos/rs/zerolog/commits{/sha}","git_commits_url":"https://api.github.com/repos/rs/zerolog/git/commits{/sha}","comments_url":"https://api.github.com/repos/rs/zerolog/comments{/number}","issue_comment_url":"https://api.github.com/repos/rs/zerolog/issues/comments{/number}","contents_url":"https://api.github.com/repos/rs/zerolog/contents/{+path}","compare_url":"https://api.github.com/repos/rs/zerolog/compare/{base}...{head}","merges_url":"https://api.github.com/repos/rs/zerolog/merges","archive_url":"https://api.github.com/repos/rs/zerolog/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/rs/zerolog/downloads","issues_url":"https://api.github.com/repos/rs/zerolog/issues{/number}","pulls_url":"https://api.github.com/repos/rs/zerolog/pulls{/number}","milestones_url":"https://api.github.com/repos/rs/zerolog/milestones{/number}","notifications_url":"https://api.github.com/repos/rs/zerolog/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/rs/zerolog/labels{/name}","releases_url":"https://api.github.com/repos/rs/zerolog/releases{/id}","deployments_url":"https://api.github.com/repos/rs/zerolog/deployments","created_at":"2017-05-12T05:24:39Z","updated_at":"2025-11-10T10:08:29Z","pushed_at":"2025-04-18T11:14:43Z","git_url":"git://github.com/rs/zerolog.git","ssh_url":"git@github.com:rs/zerolog.git","clone_url":"https://github.com/rs/zerolog.git","svn_url":"https://github.com/rs/zerolog","homepage":"","size":1369,"stargazers_count":11950,"watchers_count":11950,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":false,"forks_count":601,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":149,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["golang","json","logging","structured-logging","zerolog"],"visibility":"public","forks":601,"open_issues":149,"watchers":11950,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/rs/zerolog/pulls/81","html_url":"https://github.com/rs/zerolog/pull/81","diff_url":"https://github.com/rs/zerolog/pull/81.diff","patch_url":"https://github.com/rs/zerolog/pull/81.patch","merged_at":"2018-07-03T01:23:53Z"},"body":"Current implementation stores a copy of the logger as a pointer and\r\nupdate its content, which is now unecessary since the introduction of\r\nWithContext.\r\n\r\nThe new WithContext now takes the pointer and store it in the context if\r\nnone is stored already or if the last one stored is a different pointer.\r\nThis way it is still possible to update the context of a logger stored\r\nin the context, but it is also possible to store a copy of the logger in\r\na sub-context.\r\n\r\nFix #80","reactions":{"url":"https://api.github.com/repos/rs/zerolog/issues/81/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rs/zerolog/issues/81/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/rs/zerolog/issues/comments/401963223","html_url":"https://github.com/rs/zerolog/issues/80#issuecomment-401963223","issue_url":"https://api.github.com/repos/rs/zerolog/issues/80","id":401963223,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMTk2MzIyMw==","user":{"login":"rs","id":68232,"node_id":"MDQ6VXNlcjY4MjMy","avatar_url":"https://avatars.githubusercontent.com/u/68232?v=4","gravatar_id":"","url":"https://api.github.com/users/rs","html_url":"https://github.com/rs","followers_url":"https://api.github.com/users/rs/followers","following_url":"https://api.github.com/users/rs/following{/other_user}","gists_url":"https://api.github.com/users/rs/gists{/gist_id}","starred_url":"https://api.github.com/users/rs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rs/subscriptions","organizations_url":"https://api.github.com/users/rs/orgs","repos_url":"https://api.github.com/users/rs/repos","events_url":"https://api.github.com/users/rs/events{/privacy}","received_events_url":"https://api.github.com/users/rs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-07-02T23:03:28Z","updated_at":"2018-07-02T23:03:28Z","body":"Please review #81.","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/rs/zerolog/issues/comments/401963223/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"rs","id":68232,"node_id":"MDQ6VXNlcjY4MjMy","avatar_url":"https://avatars.githubusercontent.com/u/68232?v=4","gravatar_id":"","url":"https://api.github.com/users/rs","html_url":"https://github.com/rs","followers_url":"https://api.github.com/users/rs/followers","following_url":"https://api.github.com/users/rs/following{/other_user}","gists_url":"https://api.github.com/users/rs/gists{/gist_id}","starred_url":"https://api.github.com/users/rs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rs/subscriptions","organizations_url":"https://api.github.com/users/rs/orgs","repos_url":"https://api.github.com/users/rs/repos","events_url":"https://api.github.com/users/rs/events{/privacy}","received_events_url":"https://api.github.com/users/rs/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1712735658,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDE3MTI3MzU2NTg=","url":"https://api.github.com/repos/rs/zerolog/issues/events/1712735658","actor":{"login":"rs","id":68232,"node_id":"MDQ6VXNlcjY4MjMy","avatar_url":"https://avatars.githubusercontent.com/u/68232?v=4","gravatar_id":"","url":"https://api.github.com/users/rs","html_url":"https://github.com/rs","followers_url":"https://api.github.com/users/rs/followers","following_url":"https://api.github.com/users/rs/following{/other_user}","gists_url":"https://api.github.com/users/rs/gists{/gist_id}","starred_url":"https://api.github.com/users/rs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rs/subscriptions","organizations_url":"https://api.github.com/users/rs/orgs","repos_url":"https://api.github.com/users/rs/repos","events_url":"https://api.github.com/users/rs/events{/privacy}","received_events_url":"https://api.github.com/users/rs/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"eb64a6ddbcee806ae6265e6d6ce5e595344d0c45","commit_url":"https://api.github.com/repos/rs/zerolog/commits/eb64a6ddbcee806ae6265e6d6ce5e595344d0c45","created_at":"2018-07-02T23:18:03Z","performed_via_github_app":null},{"id":1712852511,"node_id":"MDExOkNsb3NlZEV2ZW50MTcxMjg1MjUxMQ==","url":"https://api.github.com/repos/rs/zerolog/issues/events/1712852511","actor":{"login":"rs","id":68232,"node_id":"MDQ6VXNlcjY4MjMy","avatar_url":"https://avatars.githubusercontent.com/u/68232?v=4","gravatar_id":"","url":"https://api.github.com/users/rs","html_url":"https://github.com/rs","followers_url":"https://api.github.com/users/rs/followers","following_url":"https://api.github.com/users/rs/following{/other_user}","gists_url":"https://api.github.com/users/rs/gists{/gist_id}","starred_url":"https://api.github.com/users/rs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rs/subscriptions","organizations_url":"https://api.github.com/users/rs/orgs","repos_url":"https://api.github.com/users/rs/repos","events_url":"https://api.github.com/users/rs/events{/privacy}","received_events_url":"https://api.github.com/users/rs/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2018-07-03T01:23:54Z","state_reason":null,"performed_via_github_app":null},{"id":1712852532,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDE3MTI4NTI1MzI=","url":"https://api.github.com/repos/rs/zerolog/issues/events/1712852532","actor":{"login":"rs","id":68232,"node_id":"MDQ6VXNlcjY4MjMy","avatar_url":"https://avatars.githubusercontent.com/u/68232?v=4","gravatar_id":"","url":"https://api.github.com/users/rs","html_url":"https://github.com/rs","followers_url":"https://api.github.com/users/rs/followers","following_url":"https://api.github.com/users/rs/following{/other_user}","gists_url":"https://api.github.com/users/rs/gists{/gist_id}","starred_url":"https://api.github.com/users/rs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rs/subscriptions","organizations_url":"https://api.github.com/users/rs/orgs","repos_url":"https://api.github.com/users/rs/repos","events_url":"https://api.github.com/users/rs/events{/privacy}","received_events_url":"https://api.github.com/users/rs/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"9cd6f6eef2d7e9041629e2dd853778a9b2abddbd","commit_url":"https://api.github.com/repos/rs/zerolog/commits/9cd6f6eef2d7e9041629e2dd853778a9b2abddbd","created_at":"2018-07-03T01:23:55Z","performed_via_github_app":null},{"actor":{"login":"twalwyn","id":511796,"node_id":"MDQ6VXNlcjUxMTc5Ng==","avatar_url":"https://avatars.githubusercontent.com/u/511796?v=4","gravatar_id":"","url":"https://api.github.com/users/twalwyn","html_url":"https://github.com/twalwyn","followers_url":"https://api.github.com/users/twalwyn/followers","following_url":"https://api.github.com/users/twalwyn/following{/other_user}","gists_url":"https://api.github.com/users/twalwyn/gists{/gist_id}","starred_url":"https://api.github.com/users/twalwyn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/twalwyn/subscriptions","organizations_url":"https://api.github.com/users/twalwyn/orgs","repos_url":"https://api.github.com/users/twalwyn/repos","events_url":"https://api.github.com/users/twalwyn/events{/privacy}","received_events_url":"https://api.github.com/users/twalwyn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-22T08:28:38Z","updated_at":"2018-11-22T08:28:38Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/rs/zerolog/issues/116","repository_url":"https://api.github.com/repos/rs/zerolog","labels_url":"https://api.github.com/repos/rs/zerolog/issues/116/labels{/name}","comments_url":"https://api.github.com/repos/rs/zerolog/issues/116/comments","events_url":"https://api.github.com/repos/rs/zerolog/issues/116/events","html_url":"https://github.com/rs/zerolog/issues/116","id":383426725,"node_id":"MDU6SXNzdWUzODM0MjY3MjU=","number":116,"title":"Chaining WithContext call is broken","user":{"login":"twalwyn","id":511796,"node_id":"MDQ6VXNlcjUxMTc5Ng==","avatar_url":"https://avatars.githubusercontent.com/u/511796?v=4","gravatar_id":"","url":"https://api.github.com/users/twalwyn","html_url":"https://github.com/twalwyn","followers_url":"https://api.github.com/users/twalwyn/followers","following_url":"https://api.github.com/users/twalwyn/following{/other_user}","gists_url":"https://api.github.com/users/twalwyn/gists{/gist_id}","starred_url":"https://api.github.com/users/twalwyn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/twalwyn/subscriptions","organizations_url":"https://api.github.com/users/twalwyn/orgs","repos_url":"https://api.github.com/users/twalwyn/repos","events_url":"https://api.github.com/users/twalwyn/events{/privacy}","received_events_url":"https://api.github.com/users/twalwyn/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2018-11-22T08:28:38Z","updated_at":"2022-02-24T00:17:12Z","closed_at":"2022-02-24T00:17:12Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":91054480,"node_id":"MDEwOlJlcG9zaXRvcnk5MTA1NDQ4MA==","name":"zerolog","full_name":"rs/zerolog","private":false,"owner":{"login":"rs","id":68232,"node_id":"MDQ6VXNlcjY4MjMy","avatar_url":"https://avatars.githubusercontent.com/u/68232?v=4","gravatar_id":"","url":"https://api.github.com/users/rs","html_url":"https://github.com/rs","followers_url":"https://api.github.com/users/rs/followers","following_url":"https://api.github.com/users/rs/following{/other_user}","gists_url":"https://api.github.com/users/rs/gists{/gist_id}","starred_url":"https://api.github.com/users/rs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rs/subscriptions","organizations_url":"https://api.github.com/users/rs/orgs","repos_url":"https://api.github.com/users/rs/repos","events_url":"https://api.github.com/users/rs/events{/privacy}","received_events_url":"https://api.github.com/users/rs/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/rs/zerolog","description":"Zero Allocation JSON Logger","fork":false,"url":"https://api.github.com/repos/rs/zerolog","forks_url":"https://api.github.com/repos/rs/zerolog/forks","keys_url":"https://api.github.com/repos/rs/zerolog/keys{/key_id}","collaborators_url":"https://api.github.com/repos/rs/zerolog/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/rs/zerolog/teams","hooks_url":"https://api.github.com/repos/rs/zerolog/hooks","issue_events_url":"https://api.github.com/repos/rs/zerolog/issues/events{/number}","events_url":"https://api.github.com/repos/rs/zerolog/events","assignees_url":"https://api.github.com/repos/rs/zerolog/assignees{/user}","branches_url":"https://api.github.com/repos/rs/zerolog/branches{/branch}","tags_url":"https://api.github.com/repos/rs/zerolog/tags","blobs_url":"https://api.github.com/repos/rs/zerolog/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/rs/zerolog/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/rs/zerolog/git/refs{/sha}","trees_url":"https://api.github.com/repos/rs/zerolog/git/trees{/sha}","statuses_url":"https://api.github.com/repos/rs/zerolog/statuses/{sha}","languages_url":"https://api.github.com/repos/rs/zerolog/languages","stargazers_url":"https://api.github.com/repos/rs/zerolog/stargazers","contributors_url":"https://api.github.com/repos/rs/zerolog/contributors","subscribers_url":"https://api.github.com/repos/rs/zerolog/subscribers","subscription_url":"https://api.github.com/repos/rs/zerolog/subscription","commits_url":"https://api.github.com/repos/rs/zerolog/commits{/sha}","git_commits_url":"https://api.github.com/repos/rs/zerolog/git/commits{/sha}","comments_url":"https://api.github.com/repos/rs/zerolog/comments{/number}","issue_comment_url":"https://api.github.com/repos/rs/zerolog/issues/comments{/number}","contents_url":"https://api.github.com/repos/rs/zerolog/contents/{+path}","compare_url":"https://api.github.com/repos/rs/zerolog/compare/{base}...{head}","merges_url":"https://api.github.com/repos/rs/zerolog/merges","archive_url":"https://api.github.com/repos/rs/zerolog/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/rs/zerolog/downloads","issues_url":"https://api.github.com/repos/rs/zerolog/issues{/number}","pulls_url":"https://api.github.com/repos/rs/zerolog/pulls{/number}","milestones_url":"https://api.github.com/repos/rs/zerolog/milestones{/number}","notifications_url":"https://api.github.com/repos/rs/zerolog/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/rs/zerolog/labels{/name}","releases_url":"https://api.github.com/repos/rs/zerolog/releases{/id}","deployments_url":"https://api.github.com/repos/rs/zerolog/deployments","created_at":"2017-05-12T05:24:39Z","updated_at":"2025-11-10T10:08:29Z","pushed_at":"2025-04-18T11:14:43Z","git_url":"git://github.com/rs/zerolog.git","ssh_url":"git@github.com:rs/zerolog.git","clone_url":"https://github.com/rs/zerolog.git","svn_url":"https://github.com/rs/zerolog","homepage":"","size":1369,"stargazers_count":11950,"watchers_count":11950,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":false,"forks_count":601,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":149,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["golang","json","logging","structured-logging","zerolog"],"visibility":"public","forks":601,"open_issues":149,"watchers":11950,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"#81 broke clients that chain `WithContext` calls. According to the docs, I expect the following program to compile (lifted from #80):\r\n\r\n```\r\npackage main\r\n\r\nimport (\r\n\t\"context\"\r\n\t\"github.com/rs/zerolog\"\r\n\t\"os\"\r\n)\r\n\r\nfunc process(ctx context.Context, id int) {\r\n\tlog := zerolog.Ctx(ctx).With().Int(\"id\", id).Logger()\r\n\tchild(log.WithContext(ctx))\r\n}\r\n\r\nfunc child(ctx context.Context) {\r\n\tzerolog.Ctx(ctx).Info().Msg(\"hello from child\")\r\n}\r\n\r\nfunc main() {\r\n\tctx := zerolog.New(os.Stdout).WithContext(context.Background())\r\n\tzerolog.Ctx(ctx).Info().Msg(\"processing 1\")\r\n\tprocess(ctx, 1)\r\n\r\n\tzerolog.Ctx(ctx).Info().Msg(\"processing 2\")\r\n\tprocess(ctx, 2)\r\n\r\n\tzerolog.Ctx(ctx).Info().Msg(\"done\")\r\n}\r\n```\r\n\r\nbut it fails: \r\n```\r\n# command-line-arguments\r\ncmd/main.go:19:31: cannot call pointer method on zerolog.New(os.Stdout)\r\ncmd/main.go:19:31: cannot take the address of zerolog.New(os.Stdout)\r\n```\r\n\r\nReason being that variables in go are addressable but return values from functions are not.\r\n\r\nThe current workaround is this: \r\n```\r\npackage main\r\n\r\nimport (\r\n\t\"context\"\r\n\t\"github.com/rs/zerolog\"\r\n\t\"os\"\r\n)\r\n\r\nfunc process(ctx context.Context, id int) {\r\n\tlog := zerolog.Ctx(ctx).With().Int(\"id\", id).Logger()\r\n\tchild(log.WithContext(ctx))\r\n}\r\n\r\nfunc child(ctx context.Context) {\r\n\tzerolog.Ctx(ctx).Info().Msg(\"hello from child\")\r\n}\r\n\r\nfunc main() {\r\n\tl := zerolog.New(os.Stdout)\r\n\tctx := l.WithContext(context.Background())\r\n\tzerolog.Ctx(ctx).Info().Msg(\"processing 1\")\r\n\tprocess(ctx, 1)\r\n\r\n\tzerolog.Ctx(ctx).Info().Msg(\"processing 2\")\r\n\tprocess(ctx, 2)\r\n\r\n\tzerolog.Ctx(ctx).Info().Msg(\"done\")\r\n}\r\n```\r\n\r\nOutput:\r\n```\r\n{\"level\":\"info\",\"message\":\"processing 1\"}\r\n{\"level\":\"info\",\"id\":1,\"message\":\"hello from child\"}\r\n{\"level\":\"info\",\"message\":\"processing 2\"}\r\n{\"level\":\"info\",\"id\":2,\"message\":\"hello from child\"}\r\n{\"level\":\"info\",\"message\":\"done\"}\r\n```","reactions":{"url":"https://api.github.com/repos/rs/zerolog/issues/116/reactions","total_count":14,"+1":14,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rs/zerolog/issues/116/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"}]