{"url":"https://api.github.com/repos/sass/sass/issues/3737","repository_url":"https://api.github.com/repos/sass/sass","labels_url":"https://api.github.com/repos/sass/sass/issues/3737/labels{/name}","comments_url":"https://api.github.com/repos/sass/sass/issues/3737/comments","events_url":"https://api.github.com/repos/sass/sass/issues/3737/events","html_url":"https://github.com/sass/sass/issues/3737","id":1976964354,"node_id":"I_kwDOAA4wNc511hUC","number":3737,"title":"Color Spaces: Representing clamped out-of-gamut colors","user":{"login":"nex3","id":188,"node_id":"MDQ6VXNlcjE4OA==","avatar_url":"https://avatars.githubusercontent.com/u/188?v=4","gravatar_id":"","url":"https://api.github.com/users/nex3","html_url":"https://github.com/nex3","followers_url":"https://api.github.com/users/nex3/followers","following_url":"https://api.github.com/users/nex3/following{/other_user}","gists_url":"https://api.github.com/users/nex3/gists{/gist_id}","starred_url":"https://api.github.com/users/nex3/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nex3/subscriptions","organizations_url":"https://api.github.com/users/nex3/orgs","repos_url":"https://api.github.com/users/nex3/repos","events_url":"https://api.github.com/users/nex3/events{/privacy}","received_events_url":"https://api.github.com/users/nex3/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":4610839871,"node_id":"LA_kwDOAA4wNc8AAAABEtPVPw","url":"https://api.github.com/repos/sass/sass/labels/proposal:%20color%20spaces","name":"proposal: color spaces","color":"28eda4","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"nex3","id":188,"node_id":"MDQ6VXNlcjE4OA==","avatar_url":"https://avatars.githubusercontent.com/u/188?v=4","gravatar_id":"","url":"https://api.github.com/users/nex3","html_url":"https://github.com/nex3","followers_url":"https://api.github.com/users/nex3/followers","following_url":"https://api.github.com/users/nex3/following{/other_user}","gists_url":"https://api.github.com/users/nex3/gists{/gist_id}","starred_url":"https://api.github.com/users/nex3/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nex3/subscriptions","organizations_url":"https://api.github.com/users/nex3/orgs","repos_url":"https://api.github.com/users/nex3/repos","events_url":"https://api.github.com/users/nex3/events{/privacy}","received_events_url":"https://api.github.com/users/nex3/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"nex3","id":188,"node_id":"MDQ6VXNlcjE4OA==","avatar_url":"https://avatars.githubusercontent.com/u/188?v=4","gravatar_id":"","url":"https://api.github.com/users/nex3","html_url":"https://github.com/nex3","followers_url":"https://api.github.com/users/nex3/followers","following_url":"https://api.github.com/users/nex3/following{/other_user}","gists_url":"https://api.github.com/users/nex3/gists{/gist_id}","starred_url":"https://api.github.com/users/nex3/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nex3/subscriptions","organizations_url":"https://api.github.com/users/nex3/orgs","repos_url":"https://api.github.com/users/nex3/repos","events_url":"https://api.github.com/users/nex3/events{/privacy}","received_events_url":"https://api.github.com/users/nex3/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":3,"created_at":"2023-11-03T21:39:59Z","updated_at":"2024-03-26T00:21:57Z","closed_at":"2024-03-26T00:21:57Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Per https://github.com/w3c/csswg-drafts/issues/9484, it's possible for color space conversion to produce a color that's outside the gamut of the space it's represented in _even when that space is clamped at parsed-value time_. This means that `color.to-space(color(xyz 1 1 1), lab)` represents a valid and meaningful CSS color value in the Lab color space that cannot be represented with the `lab()` syntax because its lightness is `100.12`.\r\n\r\nTo handle edge cases like this, I think we should add a special case to the color serialization spec that checks whether a non-legacy color has a channel value outside its clamped range and, if so, emits an XYZ color (which has no range gamut limitations whatsoever) that's converted to the given color space via `color-mix()`. For example, `color.to-space(color(xyz 1 1 1), lab)` would be emitted as `color-mix(in lab, color(xyz-d65 1 1 1) 100%, black)`. This is a little silly in that Sass doesn't support the native CSS `color-mix()` function, but it's the only way I know of to ensure that the colors we emit represent the same colors as Sass's notion.\r\n\r\n@jamesnw This probably means we should also allow out-of-range lightness values for Lab/OKLab/LCH/OKLCH in the JS API and the embedded protocol as well.","closed_by":{"login":"nex3","id":188,"node_id":"MDQ6VXNlcjE4OA==","avatar_url":"https://avatars.githubusercontent.com/u/188?v=4","gravatar_id":"","url":"https://api.github.com/users/nex3","html_url":"https://github.com/nex3","followers_url":"https://api.github.com/users/nex3/followers","following_url":"https://api.github.com/users/nex3/following{/other_user}","gists_url":"https://api.github.com/users/nex3/gists{/gist_id}","starred_url":"https://api.github.com/users/nex3/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nex3/subscriptions","organizations_url":"https://api.github.com/users/nex3/orgs","repos_url":"https://api.github.com/users/nex3/repos","events_url":"https://api.github.com/users/nex3/events{/privacy}","received_events_url":"https://api.github.com/users/nex3/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sass/sass/issues/3737/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sass/sass/issues/3737/timeline","performed_via_github_app":null,"state_reason":"completed"}