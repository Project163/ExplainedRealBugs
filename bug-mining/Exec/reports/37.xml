<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:54:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[EXEC-62] PumpStreamHandler hangs if process is terminated by timeout and it has not generated stdout / stderr output</title>
                <link>https://issues.apache.org/jira/browse/EXEC-62</link>
                <project id="12310814" key="EXEC">Commons Exec</project>
                    <description>&lt;p&gt;Hi,&lt;br/&gt;
I&apos;ve found an issue with DefaultExecutor hanging while waiting for PumpStreamHandler to close all subprocess streams if child process was terminated by watchdog (e.g. on timeout).&lt;/p&gt;

&lt;p&gt;I&apos;ve created a test case for the issue demonstrating working behaviour &amp;amp; issue.&lt;/p&gt;

&lt;p&gt;Test requires commons-io 1.4, Junit 4.x and commons-exec 1.1 to compile&lt;/p&gt;</description>
                <environment>&lt;p&gt;Ubuntu 11.04, &lt;br/&gt;
$ java -version&lt;br/&gt;
java version &quot;1.6.0_29&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.6.0_29-b11)&lt;br/&gt;
Java HotSpot(TM) Server VM (build 20.4-b02, mixed mode)&lt;/p&gt;</environment>
        <key id="12532321">EXEC-62</key>
            <summary>PumpStreamHandler hangs if process is terminated by timeout and it has not generated stdout / stderr output</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="3" iconUrl="https://issues.apache.org/jira/images/icons/statuses/inprogress.png" description="This issue is being actively worked on at the moment by the assignee.">In Progress</status>
                    <statusCategory id="4" key="indeterminate" colorName="yellow"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="sgoeschl">Siegfried Goeschl</assignee>
                                    <reporter username="izapolsky@gmail.com">Ignat Zapolsky</reporter>
                        <labels>
                    </labels>
                <created>Tue, 22 Nov 2011 12:14:03 +0000</created>
                <updated>Tue, 29 May 2018 09:33:15 +0000</updated>
                                            <version>1.1</version>
                                                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13155044" author="izapolsky@gmail.com" created="Tue, 22 Nov 2011 12:15:03 +0000"  >&lt;p&gt;Unit test + 2 scripts demonstrating the issue.&lt;/p&gt;</comment>
                            <comment id="13503992" author="jw.mach1" created="Mon, 26 Nov 2012 19:06:46 +0000"  >&lt;p&gt;I am also encountering PumpStreamHandler hanging, though my external processes have exited with a zero exit value. Then PumpStreamHandler locks upon join of the outputThread in the stop() method:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;from stop method&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (outputThread != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {         
  &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
    outputThread.join();
    outputThread = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
  } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (InterruptedException e) {
    &lt;span class=&quot;code-comment&quot;&gt;// ignore
&lt;/span&gt;  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As near as I can tell (from debug sessions), the outputThread is locked on read from the inputStream that is the output of the Process. Though in my scenario I have read all the expected output from the Process.&lt;/p&gt;</comment>
                            <comment id="13659908" author="sebtardif" created="Thu, 16 May 2013 20:07:32 +0000"  >&lt;p&gt;Same here:&lt;br/&gt;
&quot;pool-2-thread-1&quot; prio=10 tid=0x00007f102c5d0000 nid=0x2099 in Object.wait() &lt;span class=&quot;error&quot;&gt;&amp;#91;0x00007f101216c000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: WAITING (on object monitor)&lt;br/&gt;
	at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x00000000b8bbbf88&amp;gt; (a java.lang.Thread)&lt;br/&gt;
	at java.lang.Thread.join(Thread.java:1203)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x00000000b8bbbf88&amp;gt; (a java.lang.Thread)&lt;br/&gt;
	at java.lang.Thread.join(Thread.java:1256)&lt;br/&gt;
	at org.apache.commons.exec.PumpStreamHandler.stop(PumpStreamHandler.java:180)&lt;br/&gt;
	at org.apache.commons.exec.DefaultExecutor.executeInternal(DefaultExecutor.java:363)&lt;br/&gt;
	at org.apache.commons.exec.DefaultExecutor.execute(DefaultExecutor.java:160)&lt;br/&gt;
	at org.apache.commons.exec.DefaultExecutor.execute(DefaultExecutor.java:147)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13803605" author="sbressler" created="Thu, 24 Oct 2013 00:38:08 +0000"  >&lt;p&gt;This was filed following this e-mail exchange I believe:&lt;br/&gt;
&lt;a href=&quot;http://www.mail-archive.com/user@commons.apache.org/msg03481.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.mail-archive.com/user@commons.apache.org/msg03481.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15086164" author="sgoeschl" created="Wed, 6 Jan 2016 19:49:37 +0000"  >&lt;p&gt;The joy of multi-platform support - the problem under Ubuntu&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;the process is indeed killed by the watchdog&lt;/li&gt;
	&lt;li&gt;the StreamPumper is blocked reading from the child process streams and never returns&lt;/li&gt;
	&lt;li&gt;therefore the the worker threads are not terminated (since the are still in InputStream.read())&lt;/li&gt;
	&lt;li&gt;the Thread.join will never succeed&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Some thoughts along the line&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Some other bug report indicates that the problem is caused by no process output but adding an echo statement does not help either&lt;/li&gt;
	&lt;li&gt;I tried interrupting the StreamPumper threads but this does not work (see &lt;a href=&quot;http://bugs.java.com/bugdatabase/view_bug.do?bug_id=4514257&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bugs.java.com/bugdatabase/view_bug.do?bug_id=4514257&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16493298" author="ghilainm@gmail.com" created="Tue, 29 May 2018 09:32:38 +0000"  >&lt;p&gt;Exact same problem here. Do you have any solution in mind?&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Version&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;dependency&amp;gt;&lt;br/&gt;
 &amp;lt;groupId&amp;gt;org.zeroturnaround&amp;lt;/groupId&amp;gt;&lt;br/&gt;
 &amp;lt;artifactId&amp;gt;zt-exec&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
 &amp;lt;version&amp;gt;1.10&amp;lt;/version&amp;gt;&lt;br/&gt;
 &amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;&lt;br/&gt;
&amp;lt;/dependency&amp;gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Stack&lt;/b&gt;&#160;&lt;/p&gt;

&lt;p&gt;pool-2-thread-1&quot; #17 prio=5 os_prio=0 tid=0x00007f6218e47000 nid=0x175 in Object.wait() &lt;span class=&quot;error&quot;&gt;&amp;#91;0x00007f61f729f000&amp;#93;&lt;/span&gt;&lt;br/&gt;
 java.lang.Thread.State: WAITING (on object monitor)&lt;br/&gt;
 at java.lang.Object.wait(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;waiting on &amp;lt;0x000000071f9fa968&amp;gt; (a java.lang.Thread)&lt;br/&gt;
 at java.lang.Thread.join(Thread.java:1252)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x000000071f9fa968&amp;gt; (a java.lang.Thread)&lt;br/&gt;
 at java.lang.Thread.join(Thread.java:1326)&lt;br/&gt;
 at org.zeroturnaround.exec.stream.PumpStreamHandler.stop(PumpStreamHandler.java:219)&lt;br/&gt;
 at org.zeroturnaround.exec.close.StandardProcessCloser.close(StandardProcessCloser.java:41)&lt;br/&gt;
 at org.zeroturnaround.exec.WaitForProcess.call(WaitForProcess.java:110)&lt;br/&gt;
 at org.zeroturnaround.exec.ProcessExecutor.waitFor(ProcessExecutor.java:1097)&lt;br/&gt;
 at org.zeroturnaround.exec.ProcessExecutor.execute(ProcessExecutor.java:925)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12504733" name="sample.tar.gz" size="967" author="izapolsky@gmail.com" created="Tue, 22 Nov 2011 12:15:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>218054</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 24 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0rsdj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160241</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>