{"url":"https://api.github.com/repos/airbnb/lottie-android/issues/1972","repository_url":"https://api.github.com/repos/airbnb/lottie-android","labels_url":"https://api.github.com/repos/airbnb/lottie-android/issues/1972/labels{/name}","comments_url":"https://api.github.com/repos/airbnb/lottie-android/issues/1972/comments","events_url":"https://api.github.com/repos/airbnb/lottie-android/issues/1972/events","html_url":"https://github.com/airbnb/lottie-android/issues/1972","id":1087084340,"node_id":"I_kwDOBC8mW85Ay5c0","number":1972,"title":"Facilitate idling on animations during Espresso tests","user":{"login":"cmathew","id":1642417,"node_id":"MDQ6VXNlcjE2NDI0MTc=","avatar_url":"https://avatars.githubusercontent.com/u/1642417?v=4","gravatar_id":"","url":"https://api.github.com/users/cmathew","html_url":"https://github.com/cmathew","followers_url":"https://api.github.com/users/cmathew/followers","following_url":"https://api.github.com/users/cmathew/following{/other_user}","gists_url":"https://api.github.com/users/cmathew/gists{/gist_id}","starred_url":"https://api.github.com/users/cmathew/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cmathew/subscriptions","organizations_url":"https://api.github.com/users/cmathew/orgs","repos_url":"https://api.github.com/users/cmathew/repos","events_url":"https://api.github.com/users/cmathew/events{/privacy}","received_events_url":"https://api.github.com/users/cmathew/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":779072574,"node_id":"MDU6TGFiZWw3NzkwNzI1NzQ=","url":"https://api.github.com/repos/airbnb/lottie-android/labels/New%20feature","name":"New feature","color":"5319e7","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-12-22T18:40:17Z","updated_at":"2022-11-14T06:01:19Z","closed_at":"2022-11-14T06:01:19Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Is your feature request related to a problem? Please describe.**\r\nDevelopers who take screenshots of their app during integration tests will find that Lottie animations load + play asynchronously during those tests, resulting in inconsistent captures. \r\n\r\n**Describe the solution you'd like**\r\nProvide a way to guarantee that Lottie animations will always be visualized on a consistent frame (e.g. either the min frame or the max frame of the animation) during integration tests.\r\n\r\nLottie already respects 0x System animation scale (the standard setting for integration tests) by jumping to the last frame of an animation. Espresso only needs to be aware of, and \"idle\" on, onCompositionLoaded events. \r\n\r\n**Describe alternatives you've considered**\r\nIn my own repo, I've introduced a subclass of LottieAnimationView which maintains a global counter of compositions that are still loading. I then feed this number into an idling resource which only considers itself idle when the count is 0. To ensure my subclass of LottieAnimationView is used globally, I built a custom LayoutInflater.Factory2 which special-cases the inflation of `com.airbnb.lottie.LottieAnimationView` tags. \r\n\r\nIt would be neat to have a library-native way to hook into this global composition count, or more ideally: be able to specify a global composition-loading callback so that we can have knowledge of those events in Espresso.\r\n\r\n**Additional context**\r\nN/A","closed_by":{"login":"gpeal","id":1307745,"node_id":"MDQ6VXNlcjEzMDc3NDU=","avatar_url":"https://avatars.githubusercontent.com/u/1307745?v=4","gravatar_id":"","url":"https://api.github.com/users/gpeal","html_url":"https://github.com/gpeal","followers_url":"https://api.github.com/users/gpeal/followers","following_url":"https://api.github.com/users/gpeal/following{/other_user}","gists_url":"https://api.github.com/users/gpeal/gists{/gist_id}","starred_url":"https://api.github.com/users/gpeal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gpeal/subscriptions","organizations_url":"https://api.github.com/users/gpeal/orgs","repos_url":"https://api.github.com/users/gpeal/repos","events_url":"https://api.github.com/users/gpeal/events{/privacy}","received_events_url":"https://api.github.com/users/gpeal/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/airbnb/lottie-android/issues/1972/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"timeline_url":"https://api.github.com/repos/airbnb/lottie-android/issues/1972/timeline","performed_via_github_app":null,"state_reason":"completed"}