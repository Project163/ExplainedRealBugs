{"url":"https://api.github.com/repos/airbnb/lottie-android/issues/1696","repository_url":"https://api.github.com/repos/airbnb/lottie-android","labels_url":"https://api.github.com/repos/airbnb/lottie-android/issues/1696/labels{/name}","comments_url":"https://api.github.com/repos/airbnb/lottie-android/issues/1696/comments","events_url":"https://api.github.com/repos/airbnb/lottie-android/issues/1696/events","html_url":"https://github.com/airbnb/lottie-android/issues/1696","id":759875221,"node_id":"MDU6SXNzdWU3NTk4NzUyMjE=","number":1696,"title":"Strange behaviour when mixing LottieCompositionFactory and static drawable","user":{"login":"vellrya","id":13716114,"node_id":"MDQ6VXNlcjEzNzE2MTE0","avatar_url":"https://avatars.githubusercontent.com/u/13716114?v=4","gravatar_id":"","url":"https://api.github.com/users/vellrya","html_url":"https://github.com/vellrya","followers_url":"https://api.github.com/users/vellrya/followers","following_url":"https://api.github.com/users/vellrya/following{/other_user}","gists_url":"https://api.github.com/users/vellrya/gists{/gist_id}","starred_url":"https://api.github.com/users/vellrya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vellrya/subscriptions","organizations_url":"https://api.github.com/users/vellrya/orgs","repos_url":"https://api.github.com/users/vellrya/repos","events_url":"https://api.github.com/users/vellrya/events{/privacy}","received_events_url":"https://api.github.com/users/vellrya/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1460035932,"node_id":"MDU6TGFiZWwxNDYwMDM1OTMy","url":"https://api.github.com/repos/airbnb/lottie-android/labels/Non-Rendering%20Bug","name":"Non-Rendering Bug","color":"186199","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2020-12-08T23:55:43Z","updated_at":"2020-12-24T06:17:31Z","closed_at":"2020-12-24T06:17:31Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Checklist**\r\n\r\n1. Fork this repository into your account. -\r\n2. Reproduce your issue in the issue-repro module. Issues without a repro in the issue-repro \r\n   module may be auto-closed. -\r\n_- Maybe I'll be lucky :)_\r\n\r\n**Describe the bug**\r\nI found strange behaviour when using LottieAnimationView with static image and LottieCompositionFactory.\r\nLottie version: 3.5.0\r\n\r\n**Steps To Reproduce**\r\nSteps to reproduce the behavior:\r\n\r\n1. Load animation to LAV with LCF - works perfectly.\r\n2. Load static image to LAV with Glide (or .setImageDrawable - same result) - no problem\r\n3. Load the same animation object from p. 1 with the same cache key - oops, no animation, static image will stay in LAV.\r\nI can change static image and repeat p. 3 many times, but animation from p.1 will not work anymore.\r\n\r\nThere is a bad temp solution I found: If I change cache key of p.1 animation or load other animation after static image, I can successfully play animation number 1 again. \r\nAlso transitions \"static-static\" and \"animation-animation\" always have no problem.\r\n\r\nHere the relevant logcat and code sample, please, take a look:\r\n\r\n```\r\n        <com.airbnb.lottie.LottieAnimationView\r\n            android:id=\"@+id/resPreviewLAV\"\r\n            android:layout_width=\"150dp\"\r\n            android:layout_height=\"150dp\"\r\n            android:layout_centerInParent=\"true\"\r\n            android:translationY=\"@dimen/preview_translate_y\"\r\n            app:lottie_autoPlay=\"false\"\r\n            app:lottie_loop=\"true\" />\r\n```\r\n\r\n```\r\nif (res.animated) {\r\n\tprintln(\"animated resource:\")\r\n\tval compositionCancellable = LottieCompositionFactory.fromZipStream(\r\n\t\tZipInputStream(getPath(res), res.getResCacheKey()\r\n\t)\r\n\tprintln(\"Old composition: \"+binding.resPreviewLAV.composition)\r\n\tcompositionCancellable.addListener {\r\n\t\tprintln(\"compositionCancellable success\")\r\n\t\tbinding.resPreviewLAV.setComposition(it)\r\n\t\tbinding.resPreviewLAV.playAnimation()\r\n\t}.addFailureListener {\r\n\t\tprintln(\"Fail in lottie\")\r\n\t\tit.printStackTrace()\r\n\t}\r\n} else {\r\n\tprintln(\"static resource:\")\r\n\tGlide.with(this).load(getStaticPath(res))\r\n\t\t.fitCenter().centerInside().into(binding.resPreviewLAV)\r\n}\r\n```\r\n\r\nLogcat with //comments\r\n\r\n> I: Updated preview: ResModel(animated=true)\r\n> I: animated resource:\r\n> I: Old composition: null\r\n> I: compositionCancellable success\r\n> //correct animation showed\r\n> I: Updated preview: ResModel(animated=false)\r\n> I: static resource:\r\n> //correct static image showed\r\n> I: Updated preview: ResModel(animated=true)\r\n> //Same object of animated ResModel as no. 1\r\n> I: animated resource:\r\n> //UNSET - is it normal for cached animation?\r\n> I: Old composition: LottieComposition:\r\n> I: \tUNSET\r\n> I: \t\tParents: UNSET->UNSET->UNSET\t\r\n> I: \tUNSET\r\n> I: \t\tParents: UNSET->UNSET\t\r\n> I: \tUNSET\r\n> I: \t\tParents: UNSET->UNSET\t\r\n> I: \t\tShapes:\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@24f3fe5, com.airbnb.lottie.model.animatable.AnimatableTransform@1542aba]}\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@bb70d6b, com.airbnb.lottie.model.animatable.AnimatableTransform@ec980c8]}, ShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@3b8f561]}, ShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@a8a3886]}, com.airbnb.lottie.model.animatable.AnimatableTransform@7b71547]}\r\n> I: \tUNSET\r\n> I: \t\tParents: UNSET->UNSET->UNSET\t\r\n> I: \t\tShapes:\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@d59e174]}\r\n> I: \tUNSET\r\n> I: \t\tParents: UNSET->UNSET->UNSET\t\r\n> I: \t\tShapes:\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@5ae869d]}\r\n> I: \tUNSET\r\n> I: \t\tParents: UNSET->UNSET->UNSET\t\r\n> I: \t\tShapes:\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@2c15712, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@ec5bee3]}\r\n> I: \tUNSET\r\n> I: \t\tParents: UNSET->UNSET->UNSET->UNSET\t\r\n> I: \t\tShapes:\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@eda0e0, com.airbnb.lottie.model.animatable.AnimatableTransform@971ef99]}\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@5d9d25e, com.airbnb.lottie.model.animatable.AnimatableTransform@e8b663f]}\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@e3beb0c]}\r\n> I: \tUNSET\r\n> I: \t\tParents: UNSET->UNSET->UNSET\t\r\n> I: \t\tShapes:\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@868ec55]}\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@b6cb66a, com.airbnb.lottie.model.animatable.AnimatableTransform@cda275b]}\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@c42abf8, com.airbnb.lottie.model.animatable.AnimatableTransform@298f8d1]}\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@997cf36, com.airbnb.lottie.model.animatable.AnimatableTransform@89de37]}\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@1f28fa4, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@8e3510d]}\r\n> I: \tUNSET\r\n> I: \t\tParents: UNSET->UNSET->UNSET\t\r\n> I: \t\tShapes:\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@889a8c2, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@c1426d3]}\r\n> I: \tUNSET\r\n> I: \t\tParents: UNSET->UNSET->UNSET->UNSET\t\r\n> I: \t\tShapes:\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@29b0210, com.airbnb.lottie.model.animatable.AnimatableTransform@f00f109]}\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@2cd8f0e, com.airbnb.lottie.model.animatable.AnimatableTransform@5f05d2f]}\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@5162f3c]}\r\n> I: \tUNSET\r\n> I: \t\tParents: UNSET->UNSET->UNSET\t\r\n> I: \t\tShapes:\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@13e94c5]}\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@e578e1a, com.airbnb.lottie.model.animatable.AnimatableTransform@aaf9d4b]}\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@1b50328, com.airbnb.lottie.model.animatable.AnimatableTransform@9f8b841]}\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@a5071e6, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@4d8c327]}\r\n> I: \tUNSET\r\n> I: \t\tParents: UNSET->UNSET->UNSET\t\r\n> I: \t\tShapes:\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@2eb29d4, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@2d7977d]}\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@da1c672, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@6846ac3]}\r\n> I: \tUNSET\r\n> I: \t\tParents: UNSET->UNSET->UNSET\t\r\n> I: \t\tShapes:\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@4bb0f40]}\r\n> I: \tUNSET\r\n> I: \t\tParents: UNSET->UNSET->UNSET\t\r\n> I: \t\tShapes:\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@dcb2e79, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@241d7be]}\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@b8f01f, com.airbnb.lottie.model.animatable.AnimatableTransform@ee1df6c]}\r\n> I: \tUNSET\r\n> I: \t\tParents: UNSET\t\r\n> I: \t\tShapes:\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@1c73935, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@93fb1ca]}\r\n> I: \tUNSET\r\n> I: \t\tParents: UNSET\t\r\n> I: \t\tShapes:\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@4866f3b, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@5c38658]}\r\n> I: \tUNSET\r\n> I: \tUNSET\r\n> I: \t\tParents: UNSET\t\r\n> I: \t\tShapes:\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@73f33b1, com.airbnb.lottie.model.animatable.AnimatableTransform@38f2096]}, ShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@9e2c417, com.airbnb.lottie.model.animatable.AnimatableTransform@e16b004]}, com.airbnb.lottie.model.animatable.AnimatableTransform@6259ed]}\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, com.airbnb.lottie.model.content.ShapeStroke@b94b022, com.airbnb.lottie.model.animatable.AnimatableTransform@8458ab3]}\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@f50c870]}\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@917a7e9]}\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@b71ac6e]}\r\n> I: \t\t\tShapeGroup{name='null' Shapes: [ShapePath{name=null, index=0}, ShapeFill{color=, fillEnabled=false}, com.airbnb.lottie.model.animatable.AnimatableTransform@d041f0f]}\r\n> I: compositionCancellable success\r\n> I: compositionCancellable success\r\n> //no animation, previous static image stay in LAV. Listener called twice sometimes, sometimes one.\r\n> W: A resource failed to call end. \r\n> W: A resource failed to call close. \r\n> //Is it from lottie?\r\n> \r\n\r\n","closed_by":{"login":"gpeal","id":1307745,"node_id":"MDQ6VXNlcjEzMDc3NDU=","avatar_url":"https://avatars.githubusercontent.com/u/1307745?v=4","gravatar_id":"","url":"https://api.github.com/users/gpeal","html_url":"https://github.com/gpeal","followers_url":"https://api.github.com/users/gpeal/followers","following_url":"https://api.github.com/users/gpeal/following{/other_user}","gists_url":"https://api.github.com/users/gpeal/gists{/gist_id}","starred_url":"https://api.github.com/users/gpeal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gpeal/subscriptions","organizations_url":"https://api.github.com/users/gpeal/orgs","repos_url":"https://api.github.com/users/gpeal/repos","events_url":"https://api.github.com/users/gpeal/events{/privacy}","received_events_url":"https://api.github.com/users/gpeal/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/airbnb/lottie-android/issues/1696/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/airbnb/lottie-android/issues/1696/timeline","performed_via_github_app":null,"state_reason":"completed"}