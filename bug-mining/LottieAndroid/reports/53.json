{"url":"https://api.github.com/repos/airbnb/lottie-android/issues/273","repository_url":"https://api.github.com/repos/airbnb/lottie-android","labels_url":"https://api.github.com/repos/airbnb/lottie-android/issues/273/labels{/name}","comments_url":"https://api.github.com/repos/airbnb/lottie-android/issues/273/comments","events_url":"https://api.github.com/repos/airbnb/lottie-android/issues/273/events","html_url":"https://github.com/airbnb/lottie-android/issues/273","id":225675737,"node_id":"MDU6SXNzdWUyMjU2NzU3Mzc=","number":273,"title":"2 Bugs and resolve methods about views with mask and margin and linearGradient with tranform ","user":{"login":"zhuyakk","id":4438179,"node_id":"MDQ6VXNlcjQ0MzgxNzk=","avatar_url":"https://avatars.githubusercontent.com/u/4438179?v=4","gravatar_id":"","url":"https://api.github.com/users/zhuyakk","html_url":"https://github.com/zhuyakk","followers_url":"https://api.github.com/users/zhuyakk/followers","following_url":"https://api.github.com/users/zhuyakk/following{/other_user}","gists_url":"https://api.github.com/users/zhuyakk/gists{/gist_id}","starred_url":"https://api.github.com/users/zhuyakk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhuyakk/subscriptions","organizations_url":"https://api.github.com/users/zhuyakk/orgs","repos_url":"https://api.github.com/users/zhuyakk/repos","events_url":"https://api.github.com/users/zhuyakk/events{/privacy}","received_events_url":"https://api.github.com/users/zhuyakk/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2017-05-02T12:08:40Z","updated_at":"2017-05-09T15:54:38Z","closed_at":"2017-05-09T15:54:38Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"\r\n[gradient.aep.zip](https://github.com/airbnb/lottie-android/files/970356/gradient.aep.zip)\r\n[Bug1] Animation displays incompletely.\r\n1.there is a mask in ae\r\n2.lottieAnimationView has a margin or it's parents has a margin\r\nresolve method: in BaseLayer.java draw()\r\nchange \r\n`rect.set(0, 0, canvas.getWidth(), canvas.getHeight());`\r\nto \r\n`rect.set(0,0, screenWidth, screenHeight);`\r\n\r\n[Bug2] LinearGradient with a TransformKeyframeAnimation can't show with Lottie2.0.0-beta4\r\nresolve method:\r\nin GradientFillContent.java getLinearGradient()\r\nchange     \r\n```\r\n   int x0 = (int) (boundsRect.left + boundsRect.width() / 2 + startPoint.x);\r\n    int y0 = (int) (boundsRect.top + boundsRect.height() / 2 + startPoint.y);\r\n    int x1 = (int) (boundsRect.left + boundsRect.width() / 2 + endPoint.x);\r\n    int y1 = (int) (boundsRect.top + boundsRect.height() / 2 + endPoint.y);\r\n```\r\nto\r\n```\r\n    int x0 = (int)startPoint.x;\r\n    int y0 = (int)startPoint.y;\r\n    int x1 = (int)endPoint.x;\r\n    int y1 = (int)endPoint.y;\r\n```\r\nand \r\nchange\r\n```\r\n    if (gradient != null) {\r\n      return gradient;\r\n    }\r\n```\r\nto \r\n```\r\n    if (gradient != null) {\r\n      gradient.setLocalMatrix(new Matrix());\r\n      return gradient;\r\n    }\r\n```\r\nand in draw() \r\nchange \r\n`paint.setShader(getLinearGradient());`\r\nto \r\n```\r\nLinearGradient shader = getLinearGradient();\r\nMatrix shaderMatrix = new Matrix();\r\nshader.getLocalMatrix(shaderMatrix);\r\nshaderMatrix.preConcat(parentMatrix);\r\nshader.setLocalMatrix(shaderMatrix);\r\npaint.setShader(shader);\r\n```\r\n\r\nI look forward if there is better resolve method for this.\r\nThank you.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  ","closed_by":{"login":"gpeal","id":1307745,"node_id":"MDQ6VXNlcjEzMDc3NDU=","avatar_url":"https://avatars.githubusercontent.com/u/1307745?v=4","gravatar_id":"","url":"https://api.github.com/users/gpeal","html_url":"https://github.com/gpeal","followers_url":"https://api.github.com/users/gpeal/followers","following_url":"https://api.github.com/users/gpeal/following{/other_user}","gists_url":"https://api.github.com/users/gpeal/gists{/gist_id}","starred_url":"https://api.github.com/users/gpeal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gpeal/subscriptions","organizations_url":"https://api.github.com/users/gpeal/orgs","repos_url":"https://api.github.com/users/gpeal/repos","events_url":"https://api.github.com/users/gpeal/events{/privacy}","received_events_url":"https://api.github.com/users/gpeal/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/airbnb/lottie-android/issues/273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/airbnb/lottie-android/issues/273/timeline","performed_via_github_app":null,"state_reason":"completed"}