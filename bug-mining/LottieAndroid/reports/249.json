{"url":"https://api.github.com/repos/airbnb/lottie-android/issues/1970","repository_url":"https://api.github.com/repos/airbnb/lottie-android","labels_url":"https://api.github.com/repos/airbnb/lottie-android/issues/1970/labels{/name}","comments_url":"https://api.github.com/repos/airbnb/lottie-android/issues/1970/comments","events_url":"https://api.github.com/repos/airbnb/lottie-android/issues/1970/events","html_url":"https://github.com/airbnb/lottie-android/issues/1970","id":1085538635,"node_id":"I_kwDOBC8mW85AtAFL","number":1970,"title":"Compose LottieAnimation warning \"Animation contains merge paths but they are disabled\" even when enabledMergePaths true.","user":{"login":"jasco","id":682988,"node_id":"MDQ6VXNlcjY4Mjk4OA==","avatar_url":"https://avatars.githubusercontent.com/u/682988?v=4","gravatar_id":"","url":"https://api.github.com/users/jasco","html_url":"https://github.com/jasco","followers_url":"https://api.github.com/users/jasco/followers","following_url":"https://api.github.com/users/jasco/following{/other_user}","gists_url":"https://api.github.com/users/jasco/gists{/gist_id}","starred_url":"https://api.github.com/users/jasco/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasco/subscriptions","organizations_url":"https://api.github.com/users/jasco/orgs","repos_url":"https://api.github.com/users/jasco/repos","events_url":"https://api.github.com/users/jasco/events{/privacy}","received_events_url":"https://api.github.com/users/jasco/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1460035932,"node_id":"MDU6TGFiZWwxNDYwMDM1OTMy","url":"https://api.github.com/repos/airbnb/lottie-android/labels/Non-Rendering%20Bug","name":"Non-Rendering Bug","color":"186199","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-12-21T07:53:12Z","updated_at":"2024-11-15T02:26:40Z","closed_at":"2022-01-16T22:31:56Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Using com.airbnb.android:lottie-compose:4.2.2.\r\n\r\nClient composable code:\r\n```\r\nval composition by rememberLottieComposition(LottieCompositionSpec.Asset(\"myasset\"))\r\nLottieAnimation(\r\n    modifier = modifier,\r\n    composition = composition,\r\n    enableMergePaths = true,\r\n)\r\n```\r\n\r\nIn logcat I observe the warning `Animation contains merge paths but they are disabled.`\r\n\r\nLooking at the stacktrace, shown below, this occurs because `LottieDrawable.setComposition` is invoked before `LottieDrawable.enableMergePathsForKitKatAndAbove` has been called in `LottieAnimation` (`invoke:95, LottieAnimationKt$LottieAnimation$2 (com.airbnb.lottie.compose)`). \r\n\r\nFrom what I can tell this is inconsequential because `enableMergePathsForKitKatAndAbove`  calls `buildCompositionLayer`, which eventually calls through to `MergePaths` again, but on the surface it would appear that enabling the merge path before setting the composition might eliminate the warning as well as an extra call to `buildCompositionLayer`.\r\n\r\n```\r\ntoContent:62, MergePaths (com.airbnb.lottie.model.content)\r\ncontentsFromModels:37, ContentGroup (com.airbnb.lottie.animation.content)\r\n<init>:68, ContentGroup (com.airbnb.lottie.animation.content)\r\ntoContent:35, ShapeGroup (com.airbnb.lottie.model.content)\r\ncontentsFromModels:37, ContentGroup (com.airbnb.lottie.animation.content)\r\n<init>:68, ContentGroup (com.airbnb.lottie.animation.content)\r\n<init>:31, ShapeLayer (com.airbnb.lottie.model.layer)\r\nforModel:58, BaseLayer (com.airbnb.lottie.model.layer)\r\n<init>:56, CompositionLayer (com.airbnb.lottie.model.layer)\r\nforModel:61, BaseLayer (com.airbnb.lottie.model.layer)\r\n<init>:56, CompositionLayer (com.airbnb.lottie.model.layer)\r\nbuildCompositionLayer:318, LottieDrawable (com.airbnb.lottie)\r\nsetComposition:217, LottieDrawable (com.airbnb.lottie)\r\ninvoke:95, LottieAnimationKt$LottieAnimation$2 (com.airbnb.lottie.compose)\r\ninvoke:80, LottieAnimationKt$LottieAnimation$2 (com.airbnb.lottie.compose)\r\ndraw:101, DrawBackgroundModifier (androidx.compose.ui.draw)\r\nperformDraw:102, ModifiedDrawNode (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\nperformDraw:98, ModifiedLayoutNode (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\nperformDraw:68, DelegatingLayoutNodeWrapper (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\nperformDraw:98, ModifiedLayoutNode (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\ndraw$ui_release:814, LayoutNode (androidx.compose.ui.node)\r\nperformDraw:105, InnerPlaceable (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\nperformDraw:68, DelegatingLayoutNodeWrapper (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\nperformDraw:98, ModifiedLayoutNode (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\ndraw$ui_release:814, LayoutNode (androidx.compose.ui.node)\r\nperformDraw:105, InnerPlaceable (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\ndraw$ui_release:814, LayoutNode (androidx.compose.ui.node)\r\nperformDraw:105, InnerPlaceable (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\nperformDraw:98, ModifiedLayoutNode (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\nperformDraw:98, ModifiedLayoutNode (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\nperformDraw:68, DelegatingLayoutNodeWrapper (androidx.compose.ui.node)\r\ninvoke:255, LayoutNodeWrapper$invoke$1 (androidx.compose.ui.node)\r\ninvoke:254, LayoutNodeWrapper$invoke$1 (androidx.compose.ui.node)\r\nobserveReads:128, SnapshotStateObserver (androidx.compose.runtime.snapshots)\r\nobserveReads$ui_release:75, OwnerSnapshotObserver (androidx.compose.ui.node)\r\ninvoke:254, LayoutNodeWrapper (androidx.compose.ui.node)\r\ninvoke:54, LayoutNodeWrapper (androidx.compose.ui.node)\r\nrecord:156, RenderNodeApi29 (androidx.compose.ui.platform)\r\nupdateDisplayList:243, RenderNodeLayer (androidx.compose.ui.platform)\r\ndrawLayer:224, RenderNodeLayer (androidx.compose.ui.platform)\r\ndraw:239, LayoutNodeWrapper (androidx.compose.ui.node)\r\ndraw$ui_release:814, LayoutNode (androidx.compose.ui.node)\r\nperformDraw:105, InnerPlaceable (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\nperformDraw:98, ModifiedLayoutNode (androidx.compose.ui.node)\r\ninvoke:255, LayoutNodeWrapper$invoke$1 (androidx.compose.ui.node)\r\ninvoke:254, LayoutNodeWrapper$invoke$1 (androidx.compose.ui.node)\r\nobserveReads:128, SnapshotStateObserver (androidx.compose.runtime.snapshots)\r\nobserveReads$ui_release:75, OwnerSnapshotObserver (androidx.compose.ui.node)\r\ninvoke:254, LayoutNodeWrapper (androidx.compose.ui.node)\r\ninvoke:54, LayoutNodeWrapper (androidx.compose.ui.node)\r\nrecord:156, RenderNodeApi29 (androidx.compose.ui.platform)\r\nupdateDisplayList:243, RenderNodeLayer (androidx.compose.ui.platform)\r\ndrawLayer:224, RenderNodeLayer (androidx.compose.ui.platform)\r\ndraw:239, LayoutNodeWrapper (androidx.compose.ui.node)\r\nperformDraw:98, ModifiedLayoutNode (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\nperformDraw:68, DelegatingLayoutNodeWrapper (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\nperformDraw:68, DelegatingLayoutNodeWrapper (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\nperformDraw:68, DelegatingLayoutNodeWrapper (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\nperformDraw:68, DelegatingLayoutNodeWrapper (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\nperformDraw:68, DelegatingLayoutNodeWrapper (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\ndraw$ui_release:814, LayoutNode (androidx.compose.ui.node)\r\nperformDraw:105, InnerPlaceable (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\nperformDraw:98, ModifiedLayoutNode (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\ndraw$ui_release:814, LayoutNode (androidx.compose.ui.node)\r\nperformDraw:105, InnerPlaceable (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\nperformDraw:68, DelegatingLayoutNodeWrapper (androidx.compose.ui.node)\r\ndraw:244, LayoutNodeWrapper (androidx.compose.ui.node)\r\nperformDraw:68, DelegatingLayoutNodeWrapper (androidx.compose.ui.node)\r\ninvoke:255, LayoutNodeWrapper$invoke$1 (androidx.compose.ui.node)\r\ninvoke:254, LayoutNodeWrapper$invoke$1 (androidx.compose.ui.node)\r\nobserve:115, Snapshot$Companion (androidx.compose.runtime.snapshots)\r\nobserveReads:123, SnapshotStateObserver (androidx.compose.runtime.snapshots)\r\nobserveReads$ui_release:75, OwnerSnapshotObserver (androidx.compose.ui.node)\r\ninvoke:254, LayoutNodeWrapper (androidx.compose.ui.node)\r\ninvoke:54, LayoutNodeWrapper (androidx.compose.ui.node)\r\nrecord:156, RenderNodeApi29 (androidx.compose.ui.platform)\r\nupdateDisplayList:243, RenderNodeLayer (androidx.compose.ui.platform)\r\ndispatchDraw:677, AndroidComposeView (androidx.compose.ui.platform)\r\ndraw:22353, View (android.view)\r\nupdateDisplayListIfDirty:21226, View (android.view)\r\nrecreateChildDisplayList:4500, ViewGroup (android.view)\r\ndispatchGetDisplayList:4473, ViewGroup (android.view)\r\nupdateDisplayListIfDirty:21186, View (android.view)\r\nrecreateChildDisplayList:4500, ViewGroup (android.view)\r\ndispatchGetDisplayList:4473, ViewGroup (android.view)\r\nupdateDisplayListIfDirty:21186, View (android.view)\r\nrecreateChildDisplayList:4500, ViewGroup (android.view)\r\ndispatchGetDisplayList:4473, ViewGroup (android.view)\r\nupdateDisplayListIfDirty:21186, View (android.view)\r\nrecreateChildDisplayList:4500, ViewGroup (android.view)\r\ndispatchGetDisplayList:4473, ViewGroup (android.view)\r\nupdateDisplayListIfDirty:21186, View (android.view)\r\nupdateViewTreeDisplayList:559, ThreadedRenderer (android.view)\r\nupdateRootDisplayList:565, ThreadedRenderer (android.view)\r\ndraw:642, ThreadedRenderer (android.view)\r\ndraw:4101, ViewRootImpl (android.view)\r\nperformDraw:3828, ViewRootImpl (android.view)\r\nperformTraversals:3099, ViewRootImpl (android.view)\r\ndoTraversal:1952, ViewRootImpl (android.view)\r\nrun:8171, ViewRootImpl$TraversalRunnable (android.view)\r\nrun:972, Choreographer$CallbackRecord (android.view)\r\ndoCallbacks:796, Choreographer (android.view)\r\ndoFrame:731, Choreographer (android.view)\r\nrun:957, Choreographer$FrameDisplayEventReceiver (android.view)\r\nhandleCallback:938, Handler (android.os)\r\ndispatchMessage:99, Handler (android.os)\r\nloop:223, Looper (android.os)\r\nmain:7656, ActivityThread (android.app)\r\ninvoke:-1, Method (java.lang.reflect)\r\nrun:592, RuntimeInit$MethodAndArgsCaller (com.android.internal.os)\r\nmain:947, ZygoteInit (com.android.internal.os)\r\n```\r\n","closed_by":{"login":"gpeal","id":1307745,"node_id":"MDQ6VXNlcjEzMDc3NDU=","avatar_url":"https://avatars.githubusercontent.com/u/1307745?v=4","gravatar_id":"","url":"https://api.github.com/users/gpeal","html_url":"https://github.com/gpeal","followers_url":"https://api.github.com/users/gpeal/followers","following_url":"https://api.github.com/users/gpeal/following{/other_user}","gists_url":"https://api.github.com/users/gpeal/gists{/gist_id}","starred_url":"https://api.github.com/users/gpeal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gpeal/subscriptions","organizations_url":"https://api.github.com/users/gpeal/orgs","repos_url":"https://api.github.com/users/gpeal/repos","events_url":"https://api.github.com/users/gpeal/events{/privacy}","received_events_url":"https://api.github.com/users/gpeal/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/airbnb/lottie-android/issues/1970/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/airbnb/lottie-android/issues/1970/timeline","performed_via_github_app":null,"state_reason":"completed"}