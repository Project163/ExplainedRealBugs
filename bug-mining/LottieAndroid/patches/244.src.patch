diff --git a/lottie-compose/src/main/java/com/airbnb/lottie/compose/LottieAnimatable.kt b/lottie-compose/src/main/java/com/airbnb/lottie/compose/LottieAnimatable.kt
index 051aa216..9d9467fa 100644
--- a/lottie-compose/src/main/java/com/airbnb/lottie/compose/LottieAnimatable.kt
+++ b/lottie-compose/src/main/java/com/airbnb/lottie/compose/LottieAnimatable.kt
@@ -1,6 +1,7 @@
 package com.airbnb.lottie.compose
 
 import androidx.compose.animation.core.AnimationConstants
+import androidx.compose.animation.core.withInfiniteAnimationFrameNanos
 import androidx.compose.foundation.MutatorMutex
 import androidx.compose.runtime.Composable
 import androidx.compose.runtime.Stable
@@ -9,7 +10,6 @@ import androidx.compose.runtime.getValue
 import androidx.compose.runtime.mutableStateOf
 import androidx.compose.runtime.remember
 import androidx.compose.runtime.setValue
-import androidx.compose.runtime.withFrameNanos
 import com.airbnb.lottie.LottieComposition
 import kotlinx.coroutines.CancellationException
 import kotlinx.coroutines.NonCancellable
@@ -247,8 +247,10 @@ private class LottieAnimatableImpl : LottieAnimatable {
         }
     }
 
-    private suspend fun doFrame(iterations: Int): Boolean = withFrameNanos { frameNanos ->
-        val composition = composition ?: return@withFrameNanos true
+    // We use withInfiniteAnimationFrameNanos because it allows tests to add a CoroutineContext
+    // element that will cancel infinite transitions instead of preventing composition from ever going idle.
+    private suspend fun doFrame(iterations: Int): Boolean = withInfiniteAnimationFrameNanos { frameNanos ->
+        val composition = composition ?: return@withInfiniteAnimationFrameNanos true
         val dNanos = if (lastFrameNanos == AnimationConstants.UnspecifiedTime) 0L else (frameNanos - lastFrameNanos)
         lastFrameNanos = frameNanos
 
@@ -269,7 +271,7 @@ private class LottieAnimatableImpl : LottieAnimatable {
             if (iteration + dIterations > iterations) {
                 progress = endProgress
                 iteration = iterations
-                return@withFrameNanos false
+                return@withInfiniteAnimationFrameNanos false
             }
             iteration += dIterations
             val progressPastEndRem = progressPastEndOfIteration - (dIterations - 1) * durationProgress
diff --git a/sample-compose/build.gradle b/sample-compose/build.gradle
index e1945ad1..198740c2 100644
--- a/sample-compose/build.gradle
+++ b/sample-compose/build.gradle
@@ -12,6 +12,7 @@ android {
     targetSdk 30
     versionCode 1
     versionName VERSION_NAME
+    testInstrumentationRunner "androidx.test.runner.AndroidJUnitRunner"
   }
   buildTypes {
     release {
@@ -40,6 +41,10 @@ android {
   composeOptions {
     kotlinCompilerExtensionVersion composeVersion
   }
+  packagingOptions {
+    exclude 'META-INF/AL2.0'
+    exclude 'META-INF/LGPL2.1'
+  }
 }
 
 kapt {
@@ -72,4 +77,8 @@ dependencies {
   implementation "com.google.accompanist:accompanist-pager-indicators:0.18.0"
   implementation 'com.airbnb.android:mavericks:2.3.0'
   implementation 'com.airbnb.android:mavericks-compose:2.1.0-alpha02'
+
+  debugImplementation "androidx.compose.ui:ui-test-manifest:$composeVersion"
+
+  androidTestImplementation "androidx.compose.ui:ui-test-junit4:$composeVersion"
 }
diff --git a/sample-compose/src/androidTest/java/com/airbnb/lottie/samples/InfiniteAnimationTest.kt b/sample-compose/src/androidTest/java/com/airbnb/lottie/samples/InfiniteAnimationTest.kt
new file mode 100644
index 00000000..624c1229
--- /dev/null
+++ b/sample-compose/src/androidTest/java/com/airbnb/lottie/samples/InfiniteAnimationTest.kt
@@ -0,0 +1,57 @@
+package com.airbnb.lottie.samples
+
+import androidx.compose.foundation.layout.Box
+import androidx.compose.foundation.layout.fillMaxSize
+import androidx.compose.foundation.layout.padding
+import androidx.compose.material.Text
+import androidx.compose.runtime.getValue
+import androidx.compose.ui.Alignment
+import androidx.compose.ui.Modifier
+import androidx.compose.ui.test.assertIsDisplayed
+import androidx.compose.ui.test.junit4.createAndroidComposeRule
+import androidx.compose.ui.test.onNodeWithText
+import androidx.compose.ui.unit.dp
+import com.airbnb.lottie.LottieCompositionFactory
+import com.airbnb.lottie.compose.LottieAnimation
+import com.airbnb.lottie.compose.LottieConstants
+import com.airbnb.lottie.compose.animateLottieCompositionAsState
+import com.airbnb.lottie.sample.compose.ComposeActivity
+import com.airbnb.lottie.sample.compose.R
+import org.junit.Rule
+import org.junit.Test
+
+class InfiniteAnimationTest {
+
+    @get:Rule
+    val composeTestRule = createAndroidComposeRule(ComposeActivity::class.java)
+
+    @Test
+    fun testInfiniteAnimation() {
+        val composition = LottieCompositionFactory.fromRawResSync(composeTestRule.activity, R.raw.heart).value!!
+        composeTestRule.setContent {
+            val progress by animateLottieCompositionAsState(composition, iterations = LottieConstants.IterateForever)
+            Box(
+                modifier = Modifier
+                    .fillMaxSize()
+            ) {
+                LottieAnimation(
+                    composition,
+                    progress,
+                )
+                Text(
+                    "Composition Loaded!",
+                    modifier = Modifier
+                        .align(Alignment.TopCenter)
+                        .padding(
+                            top = 16.dp
+                        )
+                )
+            }
+        }
+
+
+        composeTestRule
+            .onNodeWithText("Composition Loaded!")
+            .assertIsDisplayed()
+    }
+}
\ No newline at end of file
