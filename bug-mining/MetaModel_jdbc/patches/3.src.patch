diff --git a/jdbc/src/main/java/org/apache/metamodel/jdbc/dialects/SQLServerQueryRewriter.java b/jdbc/src/main/java/org/apache/metamodel/jdbc/dialects/SQLServerQueryRewriter.java
index ebecb9ab..d83d6d29 100644
--- a/jdbc/src/main/java/org/apache/metamodel/jdbc/dialects/SQLServerQueryRewriter.java
+++ b/jdbc/src/main/java/org/apache/metamodel/jdbc/dialects/SQLServerQueryRewriter.java
@@ -56,7 +56,11 @@ public class SQLServerQueryRewriter extends DefaultQueryRewriter {
 
         Integer maxRows = query.getMaxRows();
         if (maxRows != null) {
-            result = "SELECT TOP " + maxRows + " " + result.substring(7);
+            if (query.getSelectClause().isDistinct()) {
+                result = "SELECT DISTINCT TOP " + maxRows + " " + result.substring("SELECT DISTINCT ".length());
+            } else {
+                result = "SELECT TOP " + maxRows + " " + result.substring("SELECT ".length());
+            }
         }
 
         return result;
diff --git a/jdbc/src/test/java/org/apache/metamodel/dialects/SQLServerQueryRewriterTest.java b/jdbc/src/test/java/org/apache/metamodel/dialects/SQLServerQueryRewriterTest.java
index fa754911..fd554862 100644
--- a/jdbc/src/test/java/org/apache/metamodel/dialects/SQLServerQueryRewriterTest.java
+++ b/jdbc/src/test/java/org/apache/metamodel/dialects/SQLServerQueryRewriterTest.java
@@ -35,56 +35,56 @@ import org.apache.metamodel.util.TimeComparator;
 
 public class SQLServerQueryRewriterTest extends TestCase {
 
-	private MutableTable table;
-	private MutableColumn column;
-	private IQueryRewriter qr = new SQLServerQueryRewriter(null);
+    private MutableTable table;
+    private MutableColumn column;
+    private IQueryRewriter qr = new SQLServerQueryRewriter(null);
 
-	@Override
-	protected void setUp() throws Exception {
-		super.setUp();
-		table = new MutableTable("foo");
-		table.setSchema(new MutableSchema("MY_SCHEMA"));
-		table.setQuote("\"");
-		column = new MutableColumn("bar");
-		column.setQuote("\"");
-		column.setTable(table);
-	}
+    @Override
+    protected void setUp() throws Exception {
+        super.setUp();
+        table = new MutableTable("foo");
+        table.setSchema(new MutableSchema("MY_SCHEMA"));
+        table.setQuote("\"");
+        column = new MutableColumn("bar");
+        column.setQuote("\"");
+        column.setTable(table);
+    }
 
-	public void testRewriteFromItem() throws Exception {
-		assertEquals("foo",
-				qr.rewriteFromItem(new FromItem(new MutableTable("foo"))));
-	}
+    public void testRewriteFromItem() throws Exception {
+        assertEquals("foo", qr.rewriteFromItem(new FromItem(new MutableTable("foo"))));
+    }
 
-	public void testAliasing() throws Exception {
-		Query q = new Query().from(table).select(column);
+    public void testAliasing() throws Exception {
+        Query q = new Query().from(table).select(column);
 
-		assertEquals("SELECT MY_SCHEMA.\"foo\".\"bar\" FROM MY_SCHEMA.\"foo\"",
-				qr.rewriteQuery(q));
-	}
+        assertEquals("SELECT MY_SCHEMA.\"foo\".\"bar\" FROM MY_SCHEMA.\"foo\"", qr.rewriteQuery(q));
+    }
 
-	public void testSelectMaxRowsRewriting() throws Exception {
-		Query q = new Query().from(table).select(column).setMaxRows(20);
+    public void testSelectMaxRowsRewriting() throws Exception {
+        Query q = new Query().from(table).select(column).setMaxRows(20);
 
-		assertEquals(
-				"SELECT TOP 20 MY_SCHEMA.\"foo\".\"bar\" FROM MY_SCHEMA.\"foo\"",
-				qr.rewriteQuery(q));
-	}
-	
-	public void testRewriteFilterItem() {
+        assertEquals("SELECT TOP 20 MY_SCHEMA.\"foo\".\"bar\" FROM MY_SCHEMA.\"foo\"", qr.rewriteQuery(q));
+    }
 
-		MutableColumn timestampColumn = new MutableColumn("timestamp");
-		timestampColumn.setType(ColumnType.TIMESTAMP);
-		timestampColumn.setNativeType("DATETIME");
-		Query q = new Query()
-				.from(table)
-				.select(column)
-				.select(timestampColumn)
-				.where(new FilterItem(new SelectItem(timestampColumn),
-						OperatorType.LESS_THAN, TimeComparator.toDate("2014-06-28 14:06:00")));
+    public void testRewriteFilterItem() {
 
-		assertEquals(
-				"SELECT MY_SCHEMA.\"foo\".\"bar\", timestamp FROM MY_SCHEMA.\"foo\" WHERE timestamp < CAST('2014-06-28 14:06:00' AS DATETIME)",
-				qr.rewriteQuery(q));
+        MutableColumn timestampColumn = new MutableColumn("timestamp");
+        timestampColumn.setType(ColumnType.TIMESTAMP);
+        timestampColumn.setNativeType("DATETIME");
+        Query q = new Query()
+                .from(table)
+                .select(column)
+                .select(timestampColumn)
+                .where(new FilterItem(new SelectItem(timestampColumn), OperatorType.LESS_THAN, TimeComparator
+                        .toDate("2014-06-28 14:06:00")));
 
-	}
+        assertEquals(
+                "SELECT MY_SCHEMA.\"foo\".\"bar\", timestamp FROM MY_SCHEMA.\"foo\" WHERE timestamp < CAST('2014-06-28 14:06:00' AS DATETIME)",
+                qr.rewriteQuery(q));
+    }
+
+    public void testSelectMaxRowsWithDistinctRewriting() throws Exception {
+        Query q = new Query().from(table).selectDistinct().select(column).setMaxRows(20);
+        assertEquals("SELECT DISTINCT TOP 20 MY_SCHEMA.\"foo\".\"bar\" FROM MY_SCHEMA.\"foo\"", qr.rewriteQuery(q));
+    }
 }
\ No newline at end of file
