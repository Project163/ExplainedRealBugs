{"url":"https://api.github.com/repos/Textualize/rich/issues/3729","repository_url":"https://api.github.com/repos/Textualize/rich","labels_url":"https://api.github.com/repos/Textualize/rich/issues/3729/labels{/name}","comments_url":"https://api.github.com/repos/Textualize/rich/issues/3729/comments","events_url":"https://api.github.com/repos/Textualize/rich/issues/3729/events","html_url":"https://github.com/Textualize/rich/issues/3729","id":3049225549,"node_id":"I_kwDODSlIsc61v31N","number":3729,"title":"[BUG] Incorrect type hint for `RichHandler.tracebacks_code_width`","user":{"login":"thcrt","id":110127860,"node_id":"U_kgDOBpBq9A","avatar_url":"https://avatars.githubusercontent.com/u/110127860?v=4","gravatar_id":"","url":"https://api.github.com/users/thcrt","html_url":"https://github.com/thcrt","followers_url":"https://api.github.com/users/thcrt/followers","following_url":"https://api.github.com/users/thcrt/following{/other_user}","gists_url":"https://api.github.com/users/thcrt/gists{/gist_id}","starred_url":"https://api.github.com/users/thcrt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thcrt/subscriptions","organizations_url":"https://api.github.com/users/thcrt/orgs","repos_url":"https://api.github.com/users/thcrt/repos","events_url":"https://api.github.com/users/thcrt/events{/privacy}","received_events_url":"https://api.github.com/users/thcrt/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2200581776,"node_id":"MDU6TGFiZWwyMjAwNTgxNzc2","url":"https://api.github.com/repos/Textualize/rich/labels/Needs%20triage","name":"Needs triage","color":"bfdadc","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2025-05-08T14:43:15Z","updated_at":"2025-06-19T15:01:41Z","closed_at":"2025-06-19T15:01:34Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"The `__init__` method for `RichHandler` defines the `tracebacks_code_width` parameter as follows:\n\nhttps://github.com/Textualize/rich/blob/8732dc52db3836302657696cd71486dfb61777c7/rich/logging.py#L79-L79\n\nThis type hint (`int`) is incorrect. According to the [docs](https://rich.readthedocs.io/en/latest/reference/logging.html#rich.logging.RichHandler):\n\n> **tracebacks_code_width** _([int](https://docs.python.org/3/library/functions.html#int), optional)_ – Number of code characters used to render tracebacks, or None for full width. Defaults to 88.\n\nTesting this, it is indeed possible to pass `tracebacks_code_width=None`, which produces the expected result when run.\n\nSo, the type hint should be `int | None` or alternatively `Optional[int]`. Otherwise type checkers complain:\n\n![Argument of type \"None\" cannot be assigned to parameter \"tracebacks_code_width\" of type \"int\" in function \"__init__\"       \"None\" is not assignable to \"int\"](https://github.com/user-attachments/assets/1618a4ae-f5e9-4a23-8535-9d3d47e80932)\n\n---\n\n<sub>\n\n- [X] I've checked [docs](https://rich.readthedocs.io/en/latest/introduction.html) and [closed issues](https://github.com/Textualize/rich/issues?q=is%3Aissue+is%3Aclosed) for possible solutions.\n- [X] I can't find my issue in the [FAQ](https://github.com/Textualize/rich/blob/master/FAQ.md).\n\n</sub>\n\n<details>\n<summary>Platform details (click to expand)</summary>\n\n```\n╭───────────────────────── <class 'rich.console.Console'> ─────────────────────────╮\n│ A high level console interface.                                                  │\n│                                                                                  │\n│ ╭──────────────────────────────────────────────────────────────────────────────╮ │\n│ │ <console width=254 ColorSystem.TRUECOLOR>                                    │ │\n│ ╰──────────────────────────────────────────────────────────────────────────────╯ │\n│                                                                                  │\n│     color_system = 'truecolor'                                                   │\n│         encoding = 'utf-8'                                                       │\n│             file = <_io.TextIOWrapper name='<stdout>' mode='w' encoding='utf-8'> │\n│           height = 18                                                            │\n│    is_alt_screen = False                                                         │\n│ is_dumb_terminal = False                                                         │\n│   is_interactive = True                                                          │\n│       is_jupyter = False                                                         │\n│      is_terminal = True                                                          │\n│   legacy_windows = False                                                         │\n│         no_color = False                                                         │\n│          options = ConsoleOptions(                                               │\n│                        size=ConsoleDimensions(width=254, height=18),             │\n│                        legacy_windows=False,                                     │\n│                        min_width=1,                                              │\n│                        max_width=254,                                            │\n│                        is_terminal=True,                                         │\n│                        encoding='utf-8',                                         │\n│                        max_height=18,                                            │\n│                        justify=None,                                             │\n│                        overflow=None,                                            │\n│                        no_wrap=False,                                            │\n│                        highlight=None,                                           │\n│                        markup=None,                                              │\n│                        height=None                                               │\n│                    )                                                             │\n│            quiet = False                                                         │\n│           record = False                                                         │\n│         safe_box = True                                                          │\n│             size = ConsoleDimensions(width=254, height=18)                       │\n│        soft_wrap = False                                                         │\n│           stderr = False                                                         │\n│            style = None                                                          │\n│         tab_size = 8                                                             │\n│            width = 254                                                           │\n╰──────────────────────────────────────────────────────────────────────────────────╯\n╭─── <class 'rich._windows.WindowsConsoleFeatures'> ────╮\n│ Windows features available.                           │\n│                                                       │\n│ ╭───────────────────────────────────────────────────╮ │\n│ │ WindowsConsoleFeatures(vt=False, truecolor=False) │ │\n│ ╰───────────────────────────────────────────────────╯ │\n│                                                       │\n│ truecolor = False                                     │\n│        vt = False                                     │\n╰───────────────────────────────────────────────────────╯\n╭────── Environment Variables ───────╮\n│ {                                  │\n│     'CLICOLOR': None,              │\n│     'COLORTERM': 'truecolor',      │\n│     'COLUMNS': None,               │\n│     'JPY_PARENT_PID': None,        │\n│     'JUPYTER_COLUMNS': None,       │\n│     'JUPYTER_LINES': None,         │\n│     'LINES': None,                 │\n│     'NO_COLOR': None,              │\n│     'TERM_PROGRAM': 'vscode',      │\n│     'TERM': 'xterm-256color',      │\n│     'TTY_COMPATIBLE': None,        │\n│     'VSCODE_VERBOSE_LOGGING': None │\n│ }                                  │\n╰────────────────────────────────────╯\nplatform=\"Linux\"\n```\n\n</details>\n\n\n","closed_by":{"login":"willmcgugan","id":554369,"node_id":"MDQ6VXNlcjU1NDM2OQ==","avatar_url":"https://avatars.githubusercontent.com/u/554369?v=4","gravatar_id":"","url":"https://api.github.com/users/willmcgugan","html_url":"https://github.com/willmcgugan","followers_url":"https://api.github.com/users/willmcgugan/followers","following_url":"https://api.github.com/users/willmcgugan/following{/other_user}","gists_url":"https://api.github.com/users/willmcgugan/gists{/gist_id}","starred_url":"https://api.github.com/users/willmcgugan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willmcgugan/subscriptions","organizations_url":"https://api.github.com/users/willmcgugan/orgs","repos_url":"https://api.github.com/users/willmcgugan/repos","events_url":"https://api.github.com/users/willmcgugan/events{/privacy}","received_events_url":"https://api.github.com/users/willmcgugan/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Textualize/rich/issues/3729/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Textualize/rich/issues/3729/timeline","performed_via_github_app":null,"state_reason":"completed"}