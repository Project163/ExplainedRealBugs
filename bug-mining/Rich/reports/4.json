{"url":"https://api.github.com/repos/Textualize/rich/issues/3104","repository_url":"https://api.github.com/repos/Textualize/rich","labels_url":"https://api.github.com/repos/Textualize/rich/issues/3104/labels{/name}","comments_url":"https://api.github.com/repos/Textualize/rich/issues/3104/comments","events_url":"https://api.github.com/repos/Textualize/rich/issues/3104/events","html_url":"https://github.com/Textualize/rich/issues/3104","id":1867234800,"node_id":"I_kwDODSlIsc5vS73w","number":3104,"title":"[BUG] `font-family` ignored in `html_export` due to user agent stylesheet for `<code>`","user":{"login":"AaronBeaudoin","id":26592486,"node_id":"MDQ6VXNlcjI2NTkyNDg2","avatar_url":"https://avatars.githubusercontent.com/u/26592486?v=4","gravatar_id":"","url":"https://api.github.com/users/AaronBeaudoin","html_url":"https://github.com/AaronBeaudoin","followers_url":"https://api.github.com/users/AaronBeaudoin/followers","following_url":"https://api.github.com/users/AaronBeaudoin/following{/other_user}","gists_url":"https://api.github.com/users/AaronBeaudoin/gists{/gist_id}","starred_url":"https://api.github.com/users/AaronBeaudoin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AaronBeaudoin/subscriptions","organizations_url":"https://api.github.com/users/AaronBeaudoin/orgs","repos_url":"https://api.github.com/users/AaronBeaudoin/repos","events_url":"https://api.github.com/users/AaronBeaudoin/events{/privacy}","received_events_url":"https://api.github.com/users/AaronBeaudoin/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2200581776,"node_id":"MDU6TGFiZWwyMjAwNTgxNzc2","url":"https://api.github.com/repos/Textualize/rich/labels/Needs%20triage","name":"Needs triage","color":"bfdadc","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2023-08-25T15:15:42Z","updated_at":"2023-11-07T17:04:44Z","closed_at":"2023-11-07T17:04:34Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"- [X] I've checked [docs](https://rich.readthedocs.io/en/latest/introduction.html) and [closed issues](https://github.com/Textualize/rich/issues?q=is%3Aissue+is%3Aclosed) for possible solutions.\r\n- [X] I can't find my issue in the [FAQ](https://github.com/Textualize/rich/blob/master/FAQ.md).\r\n\r\n**Describe the bug**\r\n\r\nRun this code:\r\n\r\n```py\r\nimport rich.console\r\n\r\ntry:\r\n    test = 1\r\n    raise Exception()\r\nexcept Exception:\r\n    console = rich.console.Console(record=True)\r\n    console.print_exception(show_locals=True)\r\n    html = console.export_html(inline_styles=True)\r\n    with open(\"test.html\", \"w\") as html_file:\r\n        html_file.write(html)\r\n```\r\n\r\nYou will get an `test.html` output file. Open it in Chrome.\r\n\r\nI'm on macOS, and it shows up like this:\r\n\r\n![image](https://github.com/Textualize/rich/assets/26592486/4b124132-b7a9-4156-bfd9-8912c65f2764)\r\n\r\n\r\nNotice the lines are not aligned properly on the right side. Here is why:\r\n\r\n![image](https://github.com/Textualize/rich/assets/26592486/8d6e13e6-2124-46e2-972d-1d4a31256615)\r\n\r\nAs you can see, Chrome's user agent stylesheet causes the `<code>` element to reset the `font-family` on the `<pre>` element back to `monospace`. All we need is to have Rich add a `font-family: inherit;` on the `<code>` element and everything is fine:\r\n\r\n![image](https://github.com/Textualize/rich/assets/26592486/ed1c2e6e-7d89-4d39-8301-cc92679458d9)\r\n\r\n**Platform**\r\n<details>\r\n<summary>Click to expand</summary>\r\n\r\nWhat platform (Win/Linux/Mac) are you running on? What terminal software are you using?\r\nMac with Chrome\r\n\r\n```\r\n❯ python -m rich.diagnose\r\n╭───────────────────────── <class 'rich.console.Console'> ─────────────────────────╮\r\n│ A high level console interface.                                                  │\r\n│                                                                                  │\r\n│ ╭──────────────────────────────────────────────────────────────────────────────╮ │\r\n│ │ <console width=148 ColorSystem.TRUECOLOR>                                    │ │\r\n│ ╰──────────────────────────────────────────────────────────────────────────────╯ │\r\n│                                                                                  │\r\n│     color_system = 'truecolor'                                                   │\r\n│         encoding = 'utf-8'                                                       │\r\n│             file = <_io.TextIOWrapper name='<stdout>' mode='w' encoding='utf-8'> │\r\n│           height = 87                                                            │\r\n│    is_alt_screen = False                                                         │\r\n│ is_dumb_terminal = False                                                         │\r\n│   is_interactive = True                                                          │\r\n│       is_jupyter = False                                                         │\r\n│      is_terminal = True                                                          │\r\n│   legacy_windows = False                                                         │\r\n│         no_color = False                                                         │\r\n│          options = ConsoleOptions(                                               │\r\n│                        size=ConsoleDimensions(width=148, height=87),             │\r\n│                        legacy_windows=False,                                     │\r\n│                        min_width=1,                                              │\r\n│                        max_width=148,                                            │\r\n│                        is_terminal=True,                                         │\r\n│                        encoding='utf-8',                                         │\r\n│                        max_height=87,                                            │\r\n│                        justify=None,                                             │\r\n│                        overflow=None,                                            │\r\n│                        no_wrap=False,                                            │\r\n│                        highlight=None,                                           │\r\n│                        markup=None,                                              │\r\n│                        height=None                                               │\r\n│                    )                                                             │\r\n│            quiet = False                                                         │\r\n│           record = False                                                         │\r\n│         safe_box = True                                                          │\r\n│             size = ConsoleDimensions(width=148, height=87)                       │\r\n│        soft_wrap = False                                                         │\r\n│           stderr = False                                                         │\r\n│            style = None                                                          │\r\n│         tab_size = 8                                                             │\r\n│            width = 148                                                           │\r\n╰──────────────────────────────────────────────────────────────────────────────────╯\r\n╭─── <class 'rich._windows.WindowsConsoleFeatures'> ────╮\r\n│ Windows features available.                           │\r\n│                                                       │\r\n│ ╭───────────────────────────────────────────────────╮ │\r\n│ │ WindowsConsoleFeatures(vt=False, truecolor=False) │ │\r\n│ ╰───────────────────────────────────────────────────╯ │\r\n│                                                       │\r\n│ truecolor = False                                     │\r\n│        vt = False                                     │\r\n╰───────────────────────────────────────────────────────╯\r\n╭────── Environment Variables ───────╮\r\n│ {                                  │\r\n│     'TERM': 'xterm-256color',      │\r\n│     'COLORTERM': 'truecolor',      │\r\n│     'CLICOLOR': None,              │\r\n│     'NO_COLOR': None,              │\r\n│     'TERM_PROGRAM': 'vscode',      │\r\n│     'COLUMNS': None,               │\r\n│     'LINES': None,                 │\r\n│     'JUPYTER_COLUMNS': None,       │\r\n│     'JUPYTER_LINES': None,         │\r\n│     'JPY_PARENT_PID': None,        │\r\n│     'VSCODE_VERBOSE_LOGGING': None │\r\n│ }                                  │\r\n╰────────────────────────────────────╯\r\nplatform=\"Darwin\"\r\n\r\n❯ python -m pip freeze | grep rich\r\nrich==13.4.2\r\n```\r\n\r\n</details>\r\n","closed_by":{"login":"darrenburns","id":5740731,"node_id":"MDQ6VXNlcjU3NDA3MzE=","avatar_url":"https://avatars.githubusercontent.com/u/5740731?v=4","gravatar_id":"","url":"https://api.github.com/users/darrenburns","html_url":"https://github.com/darrenburns","followers_url":"https://api.github.com/users/darrenburns/followers","following_url":"https://api.github.com/users/darrenburns/following{/other_user}","gists_url":"https://api.github.com/users/darrenburns/gists{/gist_id}","starred_url":"https://api.github.com/users/darrenburns/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/darrenburns/subscriptions","organizations_url":"https://api.github.com/users/darrenburns/orgs","repos_url":"https://api.github.com/users/darrenburns/repos","events_url":"https://api.github.com/users/darrenburns/events{/privacy}","received_events_url":"https://api.github.com/users/darrenburns/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/Textualize/rich/issues/3104/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/Textualize/rich/issues/3104/timeline","performed_via_github_app":null,"state_reason":"completed"}