<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:54:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[EMAIL-138] Czech/Slovak diacritic marks in the file name of the attached file screw whole sent email</title>
                <link>https://issues.apache.org/jira/browse/EMAIL-138</link>
                <project id="12310474" key="EMAIL">Commons Email</project>
                    <description>&lt;p&gt;Czech/Slovak diacritic marks in the file name of the attached file screw whole sent email. Email will arrive but it&apos;s content will be messy. An example of a filename which does this is &quot;nazev&#345;&#353;&#269;&#269;&#353;&#353;&#283;.txt&quot;. Optionally put some text in email and in file. I tried HtmlEmail.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows 7, JDK 7 (6 compatible).&lt;/p&gt;</environment>
        <key id="12712598">EMAIL-138</key>
            <summary>Czech/Slovak diacritic marks in the file name of the attached file screw whole sent email</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="4" iconUrl="https://issues.apache.org/jira/images/icons/statuses/reopened.png" description="This issue was once resolved, but the resolution was deemed incorrect. From here issues are either marked assigned or resolved.">Reopened</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="sgoeschl">Siegfried Goeschl</assignee>
                                    <reporter username="qed">qed</reporter>
                        <labels>
                            <label>diacritic</label>
                    </labels>
                <created>Tue, 6 May 2014 15:21:03 +0000</created>
                <updated>Tue, 7 Dec 2021 09:29:32 +0000</updated>
                                            <version>1.3.2</version>
                                    <fixVersion>1.3.3</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13990933" author="tn" created="Tue, 6 May 2014 18:19:09 +0000"  >&lt;p&gt;The filename is not correctly encoded in case of non-ascii names.&lt;/p&gt;

&lt;p&gt;As a work-around you can do the following:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;HtmlEmail email = ...
File fileToAttach = ...

EmailAttachment attachment = new EmailAttachment();
attachment.setName(MimeUtility.encodeText(fileToAttach.getName()));
attachment.setDescription(&quot;blabla&quot;);
attachment.setPath(fileToAttach.getAbsolutePath());
email.attach(attachment);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13991092" author="tn" created="Tue, 6 May 2014 20:32:26 +0000"  >&lt;p&gt;Fixed in r1592866.&lt;/p&gt;

&lt;p&gt;Thanks for the report!&lt;/p&gt;</comment>
                            <comment id="14258103" author="nitulkukadia" created="Wed, 24 Dec 2014 08:30:58 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tn&quot; class=&quot;user-hover&quot; rel=&quot;tn&quot;&gt;tn&lt;/a&gt; or &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=qed&quot; class=&quot;user-hover&quot; rel=&quot;qed&quot;&gt;qed&lt;/a&gt; , I found that the solution provided for this fix works only for systems which have default system encoding set to UTF-8.&lt;/p&gt;

&lt;p&gt;You should use &lt;b&gt;MimeUtility.encodeText(fileToAttach.getName()), &quot;UTF-8&quot;, null)&lt;/b&gt; to resolve this issue.&lt;br/&gt;
Thanks&lt;/p&gt;</comment>
                            <comment id="14258318" author="qed" created="Wed, 24 Dec 2014 15:01:01 +0000"  >&lt;p&gt;@Nit: If it is as you say, then this issue shall be reopened. My tests were successful. I think my default codepage is Cp1250 for java. No problems reported so far. So if you have tested bugfix in 1.3.3 and it is as you say, please, report new issue.&lt;/p&gt;</comment>
                            <comment id="14259089" author="tn" created="Fri, 26 Dec 2014 14:37:20 +0000"  >&lt;p&gt;I have tried to reproduce the problem now with different system charsets (property mail.mime.charset):&lt;/p&gt;

&lt;p&gt;for ISO-8859-15:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Content-Disposition: attachment;
filename=&quot;=?ISO-8859-15?Q?Test_Attachment_-_a&amp;gt;=E4,_o&amp;gt;=F6,_u&amp;gt;=FC,_au&amp;gt;=E4u?=&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;for UTF-8:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Content-Disposition: attachment;
filename=&quot;=?utf-8?Q?Test_Attachment_-_a&amp;gt;=C3=A4,_o&amp;gt;=C3=B6,_u&amp;gt;=C3=BC,_au&amp;gt;=C3=A4u?=&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So you can see that the respective charset is used during the encoding of the filename and also part of the resulting mime message. When opening the resulting email with thunderbird, the correct filename is displayed.&lt;/p&gt;

&lt;p&gt;Can you more precisely specify the problem you are seeing?&lt;/p&gt;</comment>
                            <comment id="15076673" author="sgoeschl" created="Sat, 2 Jan 2016 21:22:59 +0000"  >&lt;p&gt;Hi folks, doing some JIRA grooming - any updates on the issues?&lt;/p&gt;</comment>
                            <comment id="15933898" author="sebb@apache.org" created="Tue, 21 Mar 2017 00:51:39 +0000"  >&lt;p&gt;Associated commit:&lt;/p&gt;

&lt;p&gt;URL:&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/r1592866&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1592866&lt;/a&gt;&lt;br/&gt;
Log: &lt;a href=&quot;https://issues.apache.org/jira/browse/EMAIL-138&quot; title=&quot;Czech/Slovak diacritic marks in the file name of the attached file screw whole sent email&quot; class=&quot;issue-link&quot; data-issue-key=&quot;EMAIL-138&quot;&gt;EMAIL-138&lt;/a&gt; Filenames of attachments were not properly encoded. Thanks to qed.  &lt;/p&gt;

&lt;p&gt;Added: &lt;br/&gt;
commons/proper/email/trunk/src/test/resources/eml/html-attachment-encoded-filename.eml &lt;br/&gt;
Modified:&lt;br/&gt;
commons/proper/email/trunk/src/changes/changes.xml&lt;br/&gt;
commons/proper/email/trunk/src/main/java/org/apache/commons/mail/MultiPartEmail.java&lt;br/&gt;
commons/proper/email/trunk/src/test/java/org/apache/commons/mail/SendWithAttachmentsTest.java&lt;br/&gt;
commons/proper/email/trunk/src/test/java/org/apache/commons/mail/util/MimeMessageParserTest.java &lt;/p&gt;</comment>
                            <comment id="15933919" author="sebb@apache.org" created="Tue, 21 Mar 2017 01:03:21 +0000"  >&lt;p&gt;AFAICT, the filename should not be encoded by Commons Email.&lt;/p&gt;

&lt;p&gt;See the Javadoc for MimeBodyPart#setFileName(String) &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Commons Email is a wrapper for JavaMail, so it should not be doing its own encoding. Encoding should be left to JavaMail.&lt;/p&gt;

&lt;p&gt;I think this &apos;fix&apos; needs to be reverted.&lt;/p&gt;

&lt;p&gt;However the Commons Javadoc should be updated to point to &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://javamail.java.net/nonav/docs/api/javax/mail/internet/MimeBodyPart.html#setFileName-java.lang.String-&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://javamail.java.net/nonav/docs/api/javax/mail/internet/MimeBodyPart.html#setFileName-java.lang.String-&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16410086" author="vrozkovec" created="Thu, 22 Mar 2018 18:38:03 +0000"  >&lt;p&gt;I am also in favor of reverting as JavaMail can encode the filename, if need be.&lt;/p&gt;

&lt;p&gt;This change broke some of my e-mail attachments which cannot be displayed in gmail now, Thunderbird is ok, though.&lt;/p&gt;

&lt;p&gt;Here is relevant source part of the message that shows how is the name and filename encoded that gmail has troubles with:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;------=_Part_4_279180659.1521739053595&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Content-Type: application/octet-stream; name=&quot;=?UTF-8?Q?Nabidka=5F120001=5F2012-04-14=5F201?= =?UTF-8?Q?2-\&quot;; name*1=\&quot;05-03=5FTestovac=C3=AD_nab=C3=ADdka.pdf?=&quot;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Content-Transfer-Encoding: base64&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Content-Disposition: attachment; filename=&quot;=?UTF-8?Q?Nabidka=5F120001=5F2012-04-14=5F201?= =?UTF-8?Q?2-\&quot;; filename*1=\&quot;05-03=5FTestovac=C3=AD_nab=C3=ADdka.pdf?=&quot;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Content-Description: &quot;Some description&quot;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;And here how it shows in gmail. The file sent is valid pdf file.&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12915740/12915740_Gmail+attachments.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Proper filename should be: Nabidka_120001_2012-04-14_2012-05-03_Testovac&#237; nab&#237;dka.pdf&lt;/p&gt;

&lt;p&gt;I had to hack around this behavior by attaching file first by&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&#160;&#160;&#160; public MultiPartEmail attach(&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; final DataSource ds,&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; final String name,&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; final String description)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; throws EmailException&lt;/tt&gt;&lt;br/&gt;
{{&#160;&#160;&#160; }}&lt;/p&gt;

&lt;p&gt;then via reflection get the &quot;container&quot; property of the ImageHtmlEmail and get body part that was added as the last one and setting the filename directly, without using MimeUtility.encodeText(name).&lt;/p&gt;

&lt;p&gt;Attachments display correctly now.&lt;/p&gt;</comment>
                            <comment id="16800571" author="vrozkovec" created="Mon, 25 Mar 2019 10:47:55 +0000"  >&lt;p&gt;Hi, any news on this? Had same problem again, attachment name was encoded wrongly if it contained diacritics, and it was required to use this hack again:&lt;/p&gt;

&lt;p&gt;ImageHtmlEmail email;&lt;/p&gt;

&lt;p&gt;//attach file&lt;br/&gt;
email.attach(new FileDataSource(file, filename, name);&lt;/p&gt;

&lt;p&gt;//get container by reflection&lt;br/&gt;
MimeMultipart mp = (MimeMultipart)PropertyResolver.getValue(&quot;container&quot;, email);&lt;/p&gt;

&lt;p&gt;//set original, unencoded filename - it will be encoded corectly by Java mail&lt;br/&gt;
mp.getBodyPart(mp.getCount() - 1).setFileName(filename);&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17019274" author="mhug" created="Mon, 20 Jan 2020 07:30:24 +0000"  >&lt;p&gt;Could this please be prioritized?&lt;/p&gt;

&lt;p&gt;Just with a quick glance over the issues here I see several people strugling with the same thing (&lt;a href=&quot;https://issues.apache.org/jira/browse/EMAIL-189&quot; title=&quot;if Korean language is included in attachment file name, attachment file name is broken.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;EMAIL-189&quot;&gt;EMAIL-189&lt;/a&gt;,&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/EMAIL-181&quot; title=&quot;the filename of the attachment is not right if the filename has Chinese Characters&quot; class=&quot;issue-link&quot; data-issue-key=&quot;EMAIL-181&quot;&gt;EMAIL-181&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;There is even an open PR to fix this exact issue, since October of 2019&#160;&lt;a href=&quot;https://github.com/apache/commons-email/pull/10&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-email/pull/10&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17052569" author="sgoeschl" created="Thu, 5 Mar 2020 22:36:12 +0000"  >&lt;p&gt;I try to have a look at it over the weekend - &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mhug&quot; class=&quot;user-hover&quot; rel=&quot;mhug&quot;&gt;mhug&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vrozkovec&quot; class=&quot;user-hover&quot; rel=&quot;vrozkovec&quot;&gt;vrozkovec&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=qed&quot; class=&quot;user-hover&quot; rel=&quot;qed&quot;&gt;qed&lt;/a&gt; are you able to test that quickly when the fix is applied on a feature branch? &lt;/p&gt;</comment>
                            <comment id="17067404" author="sgoeschl" created="Thu, 26 Mar 2020 06:52:32 +0000"  >&lt;p&gt;I added an additional test to `EmailLiveTest` and can confirm that the attachments with Czech/Slovak name are correctly rendered&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12915740" name="Gmail attachments.png" size="12779" author="vrozkovec" created="Thu, 22 Mar 2018 18:31:43 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>390914</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 33 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1vbx3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>391149</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>