<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:53:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[EMAIL-91] Incorrect SMTP Port number shown in error message when an email fails to send due to a blocked port and SSL is used.</title>
                <link>https://issues.apache.org/jira/browse/EMAIL-91</link>
                <project id="12310474" key="EMAIL">Commons Email</project>
                    <description>&lt;p&gt;An incorrect error message is being returned from the email class when a message fails to send due to a blocked port and SSL is specified.  Specificaly, the port number in the error message is incorrect; it will show the stmp port that is set on the object (normally 25), when it should be showing the port that was set in the session when the session was created &lt;span class=&quot;error&quot;&gt;&amp;#91;465 when SSL is used&amp;#93;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;This issue is only visible to the user if the email fails to send because the SSL port is blocked.&lt;/p&gt;

&lt;p&gt;The following code reproduces the issue:&lt;br/&gt;
	public void testErrorMessage(){&lt;br/&gt;
		HtmlEmail email = new HtmlEmail();&lt;br/&gt;
		try &lt;/p&gt;
{
			email.addTo(&quot;abc@d.com&quot;);
			email.setSubject(&quot;Testing Apache Error message &quot;);
			email.setFrom(&quot;abc@d.com&quot;);
			email.setMsg(&quot;Sending through gmail&quot;);
			email.setSSL(true);
			email.setHostName(&quot;anyhost.com&quot;);
			email.send();
		}
&lt;p&gt; catch (EmailException e) &lt;/p&gt;
{
			e.printStackTrace();
		}
&lt;p&gt;	}&lt;/p&gt;

&lt;p&gt;If port 465 is blocked, then you wil ge the following stacktrace:&lt;/p&gt;

&lt;p&gt;org.apache.commons.mail.EmailException: Sending the email to the following server failed : anyhost.com:25&lt;br/&gt;
	at org.apache.commons.mail.Email.sendMimeMessage(Email.java:1138)&lt;br/&gt;
	at org.apache.commons.mail.Email.send(Email.java:1163)&lt;br/&gt;
	at EmailTester.testErrorMessage(EmailTester.java:27)&lt;br/&gt;
	at EmailTester.main(EmailTester.java:14)&lt;br/&gt;
Caused by: javax.mail.MessagingException: Could not connect to SMTP host: anyhost.com, port: 465;&lt;br/&gt;
  nested exception is:&lt;br/&gt;
	java.net.ConnectException: Connection refused: connect&lt;br/&gt;
	at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1391)&lt;br/&gt;
	at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:412)&lt;br/&gt;
	at javax.mail.Service.connect(Service.java:288)&lt;br/&gt;
                      ...&lt;/p&gt;

&lt;p&gt;Note that the port is listed correctly in the inner exception, but it is incorrect in the topmost exception.&lt;/p&gt;

&lt;p&gt;I have fixed this issue in my sandbox, and will attach the patch to this issue.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows XP, JRE 1.6.0_16, JavaMail 1.4.1, Commons Email 1.2 &lt;span class=&quot;error&quot;&gt;&amp;#91;latest from svn&amp;#93;&lt;/span&gt;, jaf 1.1.1&lt;/p&gt;</environment>
        <key id="12440113">EMAIL-91</key>
            <summary>Incorrect SMTP Port number shown in error message when an email fails to send due to a blocked port and SSL is used.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sgoeschl">Siegfried Goeschl</assignee>
                                    <reporter username="kevin_lester">Kevin Lester</reporter>
                        <labels>
                    </labels>
                <created>Sun, 8 Nov 2009 00:59:20 +0000</created>
                <updated>Fri, 11 Jan 2013 15:47:40 +0000</updated>
                            <resolved>Thu, 13 May 2010 17:14:49 +0000</resolved>
                                    <version>1.0</version>
                    <version>1.1</version>
                    <version>1.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="86400">24h</timeoriginalestimate>
                            <timeestimate seconds="86400">24h</timeestimate>
                                        <comments>
                            <comment id="12774699" author="kevin_lester" created="Sun, 8 Nov 2009 01:07:00 +0000"  >&lt;p&gt;This patch addresses this issue by modifying the getSmtpPort, getSslSmtpPort, and getHostName methods.  These methods currently look in the Email object&apos;s instance variables to get the port, ssl port, and hostname values.  If the values are not set in the instance variables, then it looks for them in the session.&lt;/p&gt;

&lt;p&gt;I have modified these methods to do the lookup in the reverse order: first they look in the session, then they look in the instance variables.  So these methods should now return the exact values that were used when the email tried to send.&lt;/p&gt;

&lt;p&gt;This patch was taken against the latest code, and all unit tests pass.&lt;/p&gt;</comment>
                            <comment id="12867180" author="sgoeschl" created="Thu, 13 May 2010 17:06:58 +0000"  >&lt;p&gt;Corrected patch (issue-91a_patch.txt)&lt;/p&gt;</comment>
                            <comment id="12867183" author="sgoeschl" created="Thu, 13 May 2010 17:14:49 +0000"  >&lt;p&gt;Applied the corrected patch and made local tests&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12624665">EMAIL-123</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12424277" name="issue-91_patch.txt" size="1962" author="kevin_lester" created="Sun, 8 Nov 2009 01:07:00 +0000"/>
                            <attachment id="12444407" name="issue-91a_patch.txt" size="2777" author="sgoeschl" created="Thu, 13 May 2010 17:06:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56899</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 28 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0tmzb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>171032</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>