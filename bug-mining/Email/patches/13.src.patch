diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index c33e8b8..a07e8a3 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -23,7 +23,13 @@
 
   <body>
     <release version="1.3-SNAPSHOT" date="as in SVN">
-      <action dev="sgoeschl" type="add" issue="EMAIL-91" date="2010-05-13" due-to="Kevin Lester">
+      <action dev="sgoeschl" type="fix" issue="EMAIL-95" date="2010-05-13">
+       Calling buildMimeMessage() before invoking send() caused
+       duplicated mime parts for HtmlEmail. The implementation now enforces
+       that an email can be only used once and throw an exception when
+       multiple invocations of buildMimeMessage() are detected.
+      </action>
+      <action dev="sgoeschl" type="fix" issue="EMAIL-91" date="2010-05-13" due-to="Kevin Lester">
         Incorrect SMTP Port number shown in error message when an email fails
         to send due to a blocked port and SSL is used.
       </action>        
diff --git a/src/java/org/apache/commons/mail/Email.java b/src/java/org/apache/commons/mail/Email.java
index 59baeeb..18fd277 100644
--- a/src/java/org/apache/commons/mail/Email.java
+++ b/src/java/org/apache/commons/mail/Email.java
@@ -1084,13 +1084,23 @@ public abstract class Email
     public abstract Email setMsg(String msg) throws EmailException;
 
     /**
-     * Build the internal MimeMessage to be sent.
+     * Does the work of actually building the MimeMessage. Please note that
+     * a user rarely calls this method directly and only if he/she is
+     * interested in the sending the underlying MimeMessage without
+     * commons-email.
      *
-     * @throws EmailException if there was an error.
+     * @exception EmailException if there was an error.
      * @since 1.0
      */
     public void buildMimeMessage() throws EmailException
     {
+        if(this.message != null)
+        {
+            // EMAIL-95 we assume that an email is not reused therefore invoking
+            // buildMimeMessage() more than once is illegal.
+            throw new IllegalStateException("The MimeMessage is already built.");
+        }
+        
         try
         {
             this.getMailSession();
@@ -1325,14 +1335,14 @@ public abstract class Email
      */
     public String getHostName()
     {
-        if (this.session != null && EmailUtils.isNotEmpty(this.session.getProperty(MAIL_HOST)))
-        {
-            return this.session.getProperty(MAIL_HOST);   
-        } 
-        else if (EmailUtils.isNotEmpty(this.hostName))
+        if (EmailUtils.isNotEmpty(this.hostName))
         {
             return this.hostName;
         }
+        else if (this.session != null)
+        {
+            return this.session.getProperty(MAIL_HOST);
+        }
         return null;
     }
 
@@ -1343,14 +1353,14 @@ public abstract class Email
      */
     public String getSmtpPort()
     {
-        if (this.session != null && EmailUtils.isNotEmpty(this.session.getProperty(MAIL_PORT)))
-        {
-            return this.session.getProperty(MAIL_PORT);
-        } 
-        else if (EmailUtils.isNotEmpty(this.smtpPort))
+        if (EmailUtils.isNotEmpty(this.smtpPort))
         {
             return this.smtpPort;
         }
+        else if (this.session != null)
+        {
+            return this.session.getProperty(MAIL_PORT);
+        }
         return null;
     }
 
@@ -1427,14 +1437,14 @@ public abstract class Email
      */
     public String getSslSmtpPort()
     {
-        if (this.session != null && EmailUtils.isNotEmpty(this.session.getProperty(MAIL_SMTP_SOCKET_FACTORY_PORT)))
-        {
-            return this.session.getProperty(MAIL_SMTP_SOCKET_FACTORY_PORT);
-        }
         if (EmailUtils.isNotEmpty(this.sslSmtpPort))
         {
             return this.sslSmtpPort;
         }
+        else if (this.session != null)
+        {
+            return this.session.getProperty(MAIL_SMTP_SOCKET_FACTORY_PORT);
+        }
         return null;
     }
 
diff --git a/src/java/org/apache/commons/mail/HtmlEmail.java b/src/java/org/apache/commons/mail/HtmlEmail.java
index 2847e71..e4df0a4 100644
--- a/src/java/org/apache/commons/mail/HtmlEmail.java
+++ b/src/java/org/apache/commons/mail/HtmlEmail.java
@@ -495,11 +495,14 @@ public class HtmlEmail extends MultiPartEmail
     }
 
     /**
-     * Does the work of actually building the email.
+     * Does the work of actually building the MimeMessage. Please note that
+     * a user rarely calls this method directly and only if he/she is
+     * interested in the sending the underlying MimeMessage without
+     * commons-email.
      *
      * @exception EmailException if there was an error.
      * @since 1.0
-     */
+     */    
     public void buildMimeMessage() throws EmailException
     {
         try
diff --git a/src/java/org/apache/commons/mail/MultiPartEmail.java b/src/java/org/apache/commons/mail/MultiPartEmail.java
index 2e6401f..05aea3d 100644
--- a/src/java/org/apache/commons/mail/MultiPartEmail.java
+++ b/src/java/org/apache/commons/mail/MultiPartEmail.java
@@ -216,12 +216,14 @@ public class MultiPartEmail extends Email
     }
 
     /**
-     * Builds the actual MimeMessage
+     * Does the work of actually building the MimeMessage. Please note that
+     * a user rarely calls this method directly and only if he/she is
+     * interested in the sending the underlying MimeMessage without
+     * commons-email.
      *
-     * @throws EmailException see javax.mail.internet.MimeBodyPart
-     *  for definitions
+     * @exception EmailException if there was an error.
      * @since 1.0
-     */
+     */    
     public void buildMimeMessage() throws EmailException
     {
         try
diff --git a/src/test/org/apache/commons/mail/HtmlEmailTest.java b/src/test/org/apache/commons/mail/HtmlEmailTest.java
index 1d3e3dd..3b0343c 100644
--- a/src/test/org/apache/commons/mail/HtmlEmailTest.java
+++ b/src/test/org/apache/commons/mail/HtmlEmailTest.java
@@ -554,4 +554,47 @@ public class HtmlEmailTest extends BaseEmailTestCase
         assertTrue(this.email.getHtmlMsg().contains("3DTZC268X93337.zip"));
         assertFalse(this.email.getHtmlMsg().contains("3DTZC268X93337..zip"));
     }
+
+    /**
+     * According to EMAIL-95 calling buildMimeMessage() before calling send()
+     * causes duplicate mime parts - now we throw an exception
+     *
+     * @throws Exception
+     */
+    public void testCallingBuildMimeMessageBeforeSent() throws Exception {
+
+        String htmlMsg = "<b>Hello World</b>";
+
+        this.email = new MockHtmlEmailConcrete();
+        this.email.setHostName(this.strTestMailServer);
+        this.email.setSmtpPort(this.getMailServerPort());
+        this.email.setFrom(this.strTestMailFrom);
+        this.email.addTo(this.strTestMailTo);
+        this.email.setCharset(Email.ISO_8859_1);
+
+        if (this.strTestUser != null && this.strTestPasswd != null)
+        {
+            this.email.setAuthentication(
+                this.strTestUser,
+                this.strTestPasswd);
+        }
+
+        String strSubject = "testCallingBuildMimeMessageBeforeSent";
+        this.email.setSubject(strSubject);
+        this.email.setHtmlMsg(htmlMsg);
+
+        // this should NOT be called when sending a message
+        this.email.buildMimeMessage();
+
+        try
+        {
+            this.email.send();
+        }
+        catch(IllegalStateException e)
+        {
+            return;
+        }
+
+        fail("Expecting an exception when calling buildMimeMessage() before send() ...");
+    }
 }
