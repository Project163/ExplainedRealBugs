diff --git a/src/java/org/apache/commons/mail/Email.java b/src/java/org/apache/commons/mail/Email.java
index ac04953..56d3f14 100644
--- a/src/java/org/apache/commons/mail/Email.java
+++ b/src/java/org/apache/commons/mail/Email.java
@@ -1239,10 +1239,11 @@ public abstract class Email
         {
             return this.hostName;
         }
-        else
+        else if (this.session != null)
         {
             return this.session.getProperty(MAIL_HOST);
         }
+        return null;
     }
 
     /**
@@ -1256,10 +1257,11 @@ public abstract class Email
         {
             return this.smtpPort;
         }
-        else
+        else if (this.session != null)
         {
             return this.session.getProperty(MAIL_PORT);
         }
+        return null;
     }
 
     /**
@@ -1339,10 +1341,11 @@ public abstract class Email
         {
             return this.sslSmtpPort;
         }
-        else
+        else if (this.session != null)
         {
             return this.session.getProperty(MAIL_SMTP_SOCKET_FACTORY_PORT);
         }
+        return null;
     }
 
     /**
diff --git a/xdocs/changes.xml b/xdocs/changes.xml
index 49f853d..f722fb5 100644
--- a/xdocs/changes.xml
+++ b/xdocs/changes.xml
@@ -24,6 +24,12 @@
   <body>
 
     <release version="1.2-SNAPSHOT" date="as in SVN">
+      <action dev="sgoeschl" type="fix" issue="EMAIL-71" date="2009-02-22" due-to="Teemu Lang, Corey Scott">
+        If setHostName() has not been called, getHostName() tries to return
+        this.session.getProperty(MAIL_HOST). If mail session has not been
+          created yet, this will throw a NullPointerException. Now getHostName()
+          checks that this.session is not null before trying to access it.      
+      </action>
       <action dev="sgoeschl" type="fix" issue="EMAIL-81" date="2009-02-22" due-to="Travis Reader, Corey Scott">
         Add getTo and getReplyTo to Email class.
       </action>
