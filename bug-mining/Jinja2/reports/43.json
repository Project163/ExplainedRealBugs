{"url":"https://api.github.com/repos/pallets/jinja/issues/642","repository_url":"https://api.github.com/repos/pallets/jinja","labels_url":"https://api.github.com/repos/pallets/jinja/issues/642/labels{/name}","comments_url":"https://api.github.com/repos/pallets/jinja/issues/642/comments","events_url":"https://api.github.com/repos/pallets/jinja/issues/642/events","html_url":"https://github.com/pallets/jinja/issues/642","id":199377266,"node_id":"MDU6SXNzdWUxOTkzNzcyNjY=","number":642,"title":"2.9.1 incompatibility with flask admin","user":{"login":"bolkedebruin","id":4282712,"node_id":"MDQ6VXNlcjQyODI3MTI=","avatar_url":"https://avatars.githubusercontent.com/u/4282712?v=4","gravatar_id":"","url":"https://api.github.com/users/bolkedebruin","html_url":"https://github.com/bolkedebruin","followers_url":"https://api.github.com/users/bolkedebruin/followers","following_url":"https://api.github.com/users/bolkedebruin/following{/other_user}","gists_url":"https://api.github.com/users/bolkedebruin/gists{/gist_id}","starred_url":"https://api.github.com/users/bolkedebruin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bolkedebruin/subscriptions","organizations_url":"https://api.github.com/users/bolkedebruin/orgs","repos_url":"https://api.github.com/users/bolkedebruin/repos","events_url":"https://api.github.com/users/bolkedebruin/events{/privacy}","received_events_url":"https://api.github.com/users/bolkedebruin/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":12,"created_at":"2017-01-07T18:39:17Z","updated_at":"2020-11-13T21:23:26Z","closed_at":"2017-01-08T01:19:20Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"We have jinja2 in Airflow and it throws an error that seems tied to our usage of flask-admin:\r\n\r\n```\r\n======================================================================\r\nERROR: test_dag_views (tests.WebUiTests)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/home/travis/build/apache/incubator-airflow/tests/core.py\", line 1423, in test_dag_views\r\n    '/admin/airflow/graph?dag_id=example_bash_operator')\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/werkzeug/test.py\", line 778, in get\r\n    return self.open(*args, **kw)\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/flask/testing.py\", line 127, in open\r\n    follow_redirects=follow_redirects)\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/werkzeug/test.py\", line 751, in open\r\n    response = self.run_wsgi_app(environ, buffered=buffered)\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/werkzeug/test.py\", line 668, in run_wsgi_app\r\n    rv = run_wsgi_app(self.application, environ, buffered=buffered)\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/werkzeug/test.py\", line 871, in run_wsgi_app\r\n    app_rv = app(environ, start_response)\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/flask/app.py\", line 1994, in __call__\r\n    return self.wsgi_app(environ, start_response)\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/flask/app.py\", line 1985, in wsgi_app\r\n    response = self.handle_exception(e)\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/flask/app.py\", line 1540, in handle_exception\r\n    reraise(exc_type, exc_value, tb)\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/flask/app.py\", line 1982, in wsgi_app\r\n    response = self.full_dispatch_request()\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/flask/app.py\", line 1614, in full_dispatch_request\r\n    rv = self.handle_user_exception(e)\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/flask/app.py\", line 1517, in handle_user_exception\r\n    reraise(exc_type, exc_value, tb)\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/flask/app.py\", line 1612, in full_dispatch_request\r\n    rv = self.dispatch_request()\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/flask/app.py\", line 1598, in dispatch_request\r\n    return self.view_functions[rule.endpoint](**req.view_args)\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/flask_admin/base.py\", line 69, in inner\r\n    return self._run_view(f, *args, **kwargs)\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/flask_admin/base.py\", line 368, in _run_view\r\n    return fn(self, *args, **kwargs)\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/flask_login.py\", line 755, in decorated_view\r\n    return func(*args, **kwargs)\r\n  File \"/home/travis/build/apache/incubator-airflow/airflow/www/utils.py\", line 221, in view_func\r\n    return f(*args, **kwargs)\r\n  File \"/home/travis/build/apache/incubator-airflow/airflow/www/utils.py\", line 125, in wrapper\r\n    return f(*args, **kwargs)\r\n  File \"/home/travis/build/apache/incubator-airflow/airflow/www/views.py\", line 1438, in graph\r\n    edges=json.dumps(edges, indent=2),)\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/flask_admin/base.py\", line 308, in render\r\n    return render_template(template, **kwargs)\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/flask/templating.py\", line 134, in render_template\r\n    context, ctx.app)\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/flask/templating.py\", line 116, in _render\r\n    rv = template.render(context)\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/jinja2/environment.py\", line 1008, in render\r\n    return self.environment.handle_exception(exc_info, True)\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/jinja2/environment.py\", line 780, in handle_exception\r\n    reraise(exc_type, exc_value, tb)\r\n  File \"/home/travis/build/apache/incubator-airflow/airflow/www/templates/airflow/graph.html\", line 19, in top-level template code\r\n    {% import 'admin/lib.html' as lib with context %}\r\n  File \"/home/travis/build/apache/incubator-airflow/.tox/py27-cdh-airflow_backend_sqlite/lib/python2.7/site-packages/jinja2/environment.py\", line 551, in _compile\r\n    return compile(source, filename, 'exec')\r\nSyntaxError: duplicate argument 'l_1_caller' in function definition (lib.html, line 255)\r\n```","closed_by":{"login":"mitsuhiko","id":7396,"node_id":"MDQ6VXNlcjczOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7396?v=4","gravatar_id":"","url":"https://api.github.com/users/mitsuhiko","html_url":"https://github.com/mitsuhiko","followers_url":"https://api.github.com/users/mitsuhiko/followers","following_url":"https://api.github.com/users/mitsuhiko/following{/other_user}","gists_url":"https://api.github.com/users/mitsuhiko/gists{/gist_id}","starred_url":"https://api.github.com/users/mitsuhiko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mitsuhiko/subscriptions","organizations_url":"https://api.github.com/users/mitsuhiko/orgs","repos_url":"https://api.github.com/users/mitsuhiko/repos","events_url":"https://api.github.com/users/mitsuhiko/events{/privacy}","received_events_url":"https://api.github.com/users/mitsuhiko/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pallets/jinja/issues/642/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pallets/jinja/issues/642/timeline","performed_via_github_app":null,"state_reason":"completed"}