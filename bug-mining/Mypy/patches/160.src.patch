diff --git a/mypy/semanal.py b/mypy/semanal.py
index 684d1f060..6e77fea2f 100644
--- a/mypy/semanal.py
+++ b/mypy/semanal.py
@@ -3807,7 +3807,7 @@ class SemanticAnalyzer(NodeVisitor[None],
 
     def visit_nonlocal_decl(self, d: NonlocalDecl) -> None:
         self.statement = d
-        if not self.is_func_scope():
+        if self.is_module_scope():
             self.fail("nonlocal declaration not allowed at module level", d)
         else:
             for name in d.names:
diff --git a/test-data/unit/semanal-basic.test b/test-data/unit/semanal-basic.test
index bb829dd9a..4b60ab99f 100644
--- a/test-data/unit/semanal-basic.test
+++ b/test-data/unit/semanal-basic.test
@@ -382,6 +382,29 @@ MypyFile:1(
           ExpressionStmt:6(
             NameExpr(x [l])))))))
 
+[case testNonlocalClass]
+def f() -> None:
+    a = 0
+    class C:
+        nonlocal a
+        a = 1
+[out]
+MypyFile:1(
+  FuncDef:1(
+    f
+    def ()
+    Block:1(
+      AssignmentStmt:2(
+        NameExpr(a* [l])
+        IntExpr(0))
+      ClassDef:3(
+        C
+        NonlocalDecl:4(
+          a)
+        AssignmentStmt:5(
+          NameExpr(a* [m])
+          IntExpr(1))))))
+
 [case testMultipleNamesInNonlocalDecl]
 def g():
     x, y = None, None
