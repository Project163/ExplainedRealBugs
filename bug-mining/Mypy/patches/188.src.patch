diff --git a/mypy/stubtest.py b/mypy/stubtest.py
index ff59a8f68..718a6cfa6 100644
--- a/mypy/stubtest.py
+++ b/mypy/stubtest.py
@@ -1597,6 +1597,8 @@ def test_stubs(args: _Arguments, use_builtins_fixtures: bool = False) -> int:
     options = Options()
     options.incremental = False
     options.custom_typeshed_dir = args.custom_typeshed_dir
+    if options.custom_typeshed_dir:
+        options.abs_custom_typeshed_dir = os.path.abspath(args.custom_typeshed_dir)
     options.config_file = args.mypy_config_file
     options.use_builtins_fixtures = use_builtins_fixtures
 
