{"url":"https://api.github.com/repos/python/mypy/issues/14915","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/14915/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/14915/comments","events_url":"https://api.github.com/repos/python/mypy/issues/14915/events","html_url":"https://github.com/python/mypy/issues/14915","id":1629237697,"node_id":"I_kwDOAGuhRc5hHDHB","number":14915,"title":"Default \"--soft-error-limit\" behavior causes tons of headache for mypy newbies with large code bases","user":{"login":"sveinugu","id":3090622,"node_id":"MDQ6VXNlcjMwOTA2MjI=","avatar_url":"https://avatars.githubusercontent.com/u/3090622?v=4","gravatar_id":"","url":"https://api.github.com/users/sveinugu","html_url":"https://github.com/sveinugu","followers_url":"https://api.github.com/users/sveinugu/followers","following_url":"https://api.github.com/users/sveinugu/following{/other_user}","gists_url":"https://api.github.com/users/sveinugu/gists{/gist_id}","starred_url":"https://api.github.com/users/sveinugu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sveinugu/subscriptions","organizations_url":"https://api.github.com/users/sveinugu/orgs","repos_url":"https://api.github.com/users/sveinugu/repos","events_url":"https://api.github.com/users/sveinugu/events{/privacy}","received_events_url":"https://api.github.com/users/sveinugu/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":21488356,"node_id":"MDU6TGFiZWwyMTQ4ODM1Ng==","url":"https://api.github.com/repos/python/mypy/labels/bug","name":"bug","color":"f9d0c4","default":true,"description":"mypy got something wrong"},{"id":608992726,"node_id":"MDU6TGFiZWw2MDg5OTI3MjY=","url":"https://api.github.com/repos/python/mypy/labels/topic-usability","name":"topic-usability","color":"d4c5f9","default":false,"description":null},{"id":932016981,"node_id":"MDU6TGFiZWw5MzIwMTY5ODE=","url":"https://api.github.com/repos/python/mypy/labels/good-first-issue","name":"good-first-issue","color":"3dc136","default":false,"description":""},{"id":3945122249,"node_id":"LA_kwDOAGuhRc7rJcnJ","url":"https://api.github.com/repos/python/mypy/labels/topic-configuration","name":"topic-configuration","color":"17E2A3","default":false,"description":"Configuration files and flags"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2023-03-17T12:31:48Z","updated_at":"2023-04-28T14:36:31Z","closed_at":"2023-04-26T00:09:20Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Bug Report**\r\n\r\nWhile not strictly a bug, I would argue that there is a \"bug\" in the logic behind the decision to add a default `--soft-error-limit` of `200` (added in https://github.com/python/mypy/pull/10579). The idea was to make it easier to identify missing stubs as the root cause for a flood of errors, especially useful when settings are strict. However, I would assume that strict settings are typically used by `mypy` experts while newbies would typically start with the default settings and gradually work their way up to strict settings (if at all). So while the default values of the strictness settings favor newbies, I think the default behavior of `--soft-error-limits` inconsistently (and unhelpfully) favors experts at the expense of newbies.\r\n\r\nFurthermore, this error limit applies to all errors, regardless of whether they are caused by missing stubs or not. This leads to very confusing error outputs for large code bases that are in the process of being typed by `mypy` newbies. Since Python typing already is a complicated heap of **(insert word here)**, even for devs with  tons of experience in non-typed Python, I would think it is of importance for the `mypy` project to try to lower the threshold for adoption by newbies as much as possible. However, the default setting of `--soft-error-limit` does the opposite: It is counterintuitive that `mypy` by default has an error limit that silences errors.\r\n\r\nThe default behavior is especially confusing when `mypy` is used in the context of an IDE such as PyCharm (also mentioned by @ilevkivskyi in this comment https://github.com/python/mypy/pull/10579#discussion_r645623803). In this case, the error messages are filtered by module name so that the note `(Skipping most remaining errors due to unresolved imports or missing stubs; fix these first)` will appear in a random module and most probably not be read by the user. In my personal experience, trying to debug the discrepancy between the inline `mypy` errors and the lack of the same errors in the global view made me in the end want to pull out my last few remaining strands of hair rather than continue the hunt. This particular discrepancy was one of the worst issues I have ever tried to debug, as there were no patterns to which errors were silenced. Debugging, on the other hand, is typically done by trying to find the pattern that cause the bug to appear:\r\n\r\n> **Example debugging session**: In my particular debugging approach, I tried figuring out why an inline error in a particular module was silenced in a global mypy run by carrying out a binary search of including/excluding modules to locate the exact reason for the silencing, while `grep`-ing the output on the specific module I selected. `grep`-ing of course silenced the real error message (however it did appear in my module of interest once in a while, but with no apparent pattern). In the end I had a set of unrelated modules where, for some unexplained reason, removing any one of them from the `mypy` run would \"un-silence\" the error for the module of interest. In the end, I concluded that there was no pattern, there had to be a limit somewhere. Googling the note text mentioned above also did not directly lead me to the answer, that also took a while. I am sure other approaches to debugging this issue can be equally or more confusing, as exemplified in issues https://github.com/python/mypy/issues/10956 and https://github.com/python/mypy/issues/14389.\r\n\r\n\r\n**To Reproduce**\r\n\r\nAs a `mypy` newbie, run `mypy` on a large code base that have been partially or fully typed, but where detailed fixing of `mypy` errors have been postponed due to the priority of developing actual features. To increase the pain level to the maximum, do this in PyCharm or other IDE where errors are filtered by module. Then:\r\n\r\n1. Be motivated that there are not more than around 200 errors in the whole code base!\r\n2. Start fixing errors in a module of choice\r\n3. Discover that the inline errors from the module do not appear in the global view\r\n4. Try to debug the discrepancy: choose your favorite debugging method and whatever pattern seems most likely to you as the cause\r\n5. Discover that the more you debug, the less sense you are able to make of the issue\r\n6. Start questioning your own sanity!\r\n7. Alternatively, start questioning the sanity of the `mypy` library\r\n8. (If you endure wasting hours of your precious time): Find the actual cause of the bug. Set `--soft-error-limit=-1` and witness the total number of errors multiply\r\n9. Despair at the real number of errors you need to fix!\r\n\r\n**Expected Behavior**\r\n\r\n1. All errors are reported by default\r\n2. (Alternatively) All errors not caused by missing stubs are reported by default\r\n3. If `--soft-error-limit` is set, a note should be added at the __very end__ of the error output that __also__ mentions the actual config/command-line setting to tweak\r\n4. A config setting `soft_error_limit` should be added that corresponds to the command-line flag\r\n5. Log output at `verbosity=1` should, for each module, log whether any errors were silenced due to the setting\r\n\r\n**Actual Behavior**\r\n\r\nNo more than 200 errors are reported (in my case only 139 errors and 41 notes were reported, for some reason). Errors are randomly silenced in global runs for no apparent reason and with no easily noticed error messages. Reading the log at `verbosity=1` gives no clue to the reason why errors are silenced.\r\n\r\n**Your Environment**\r\n\r\n<!-- Include as many relevant details about the environment you experienced the bug in -->\r\n\r\n- Mypy version used: 1.1.1\r\n- Mypy command-line flags: `--show-column-numbers --follow-imports silent` (default for PyCharm `mypy` plugin)\r\n- Mypy configuration options from `mypy.ini` (and other config files): \r\nmypy_path = \"src:tests\"\r\n- Python version used: 3.10\r\n\r\n<!-- You can freely edit this text, please remove all the lines you believe are unnecessary. -->\r\n","closed_by":{"login":"hauntsaninja","id":12621235,"node_id":"MDQ6VXNlcjEyNjIxMjM1","avatar_url":"https://avatars.githubusercontent.com/u/12621235?v=4","gravatar_id":"","url":"https://api.github.com/users/hauntsaninja","html_url":"https://github.com/hauntsaninja","followers_url":"https://api.github.com/users/hauntsaninja/followers","following_url":"https://api.github.com/users/hauntsaninja/following{/other_user}","gists_url":"https://api.github.com/users/hauntsaninja/gists{/gist_id}","starred_url":"https://api.github.com/users/hauntsaninja/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hauntsaninja/subscriptions","organizations_url":"https://api.github.com/users/hauntsaninja/orgs","repos_url":"https://api.github.com/users/hauntsaninja/repos","events_url":"https://api.github.com/users/hauntsaninja/events{/privacy}","received_events_url":"https://api.github.com/users/hauntsaninja/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python/mypy/issues/14915/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/mypy/issues/14915/timeline","performed_via_github_app":null,"state_reason":"completed"}