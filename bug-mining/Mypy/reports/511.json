{"url":"https://api.github.com/repos/python/mypy/issues/18265","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/18265/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/18265/comments","events_url":"https://api.github.com/repos/python/mypy/issues/18265/events","html_url":"https://github.com/python/mypy/issues/18265","id":2724900667,"node_id":"I_kwDOAGuhRc6iaq87","number":18265,"title":"Generic type falling back to object - possibly related to `type[ Union ]`?","user":{"login":"JakeSummers","id":5657503,"node_id":"MDQ6VXNlcjU2NTc1MDM=","avatar_url":"https://avatars.githubusercontent.com/u/5657503?v=4","gravatar_id":"","url":"https://api.github.com/users/JakeSummers","html_url":"https://github.com/JakeSummers","followers_url":"https://api.github.com/users/JakeSummers/followers","following_url":"https://api.github.com/users/JakeSummers/following{/other_user}","gists_url":"https://api.github.com/users/JakeSummers/gists{/gist_id}","starred_url":"https://api.github.com/users/JakeSummers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JakeSummers/subscriptions","organizations_url":"https://api.github.com/users/JakeSummers/orgs","repos_url":"https://api.github.com/users/JakeSummers/repos","events_url":"https://api.github.com/users/JakeSummers/events{/privacy}","received_events_url":"https://api.github.com/users/JakeSummers/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":21488356,"node_id":"MDU6TGFiZWwyMTQ4ODM1Ng==","url":"https://api.github.com/repos/python/mypy/labels/bug","name":"bug","color":"f9d0c4","default":true,"description":"mypy got something wrong"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2024-12-08T01:53:56Z","updated_at":"2025-01-13T17:38:57Z","closed_at":"2025-01-13T17:38:57Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Bug Report**\r\n\r\nThe following code produces a type error but it shouldn't.  \r\n\r\n* Gist URL: https://gist.github.com/mypy-play/b4d24f9b14f909a7d6550ff738cd4fb1\r\n* Playground URL: https://mypy-play.net/?mypy=latest&python=3.12&gist=b4d24f9b14f909a7d6550ff738cd4fb1\r\n\r\n```python\r\nfrom dataclasses import dataclass\r\nfrom typing import TypeVar, Mapping, reveal_type\r\n\r\n\r\n@dataclass\r\nclass A:\r\n    foo: str = \"a\"\r\n\r\n@dataclass\r\nclass B:\r\n    bar: str = \"b\"\r\n\r\nlookup_table: Mapping[str, type[A] | type[B]] = {\r\n    \"a\": A,\r\n    \"b\": B\r\n}\r\n\r\nreveal_type(lookup_table)  # note: Revealed type is \"typing.Mapping[builtins.str, Union[type[simple.A], type[simple.B]]]\"\r\n\r\nT = TypeVar(\"T\")\r\n\r\ndef load(lookup_table: Mapping[str, type[T]], lookup_key:str) -> T:\r\n    con: type[T] = lookup_table[lookup_key]\r\n    instance: T = con()\r\n    return instance\r\n\r\nexample_a: A | B = load(lookup_table, \"a\")  # error: Incompatible types in assignment (expression has type \"object\", variable has type \"A | B\")\r\nprint(example_a)\r\n```\r\n\r\nError: \r\n\r\n```\r\nerror: Incompatible types in assignment (expression has type \"object\", variable has type \"A | B\")  [assignment]\r\n```\r\n\r\n**Your Environment**\r\n\r\n<!-- Include as many relevant details about the environment you experienced the bug in -->\r\n\r\n- Mypy version used: `1.13.0` (latest on `mypy Playground`)\r\n- Mypy command-line flags: None.  \r\n- Python version used: 3.11, 3.12, 3.13\r\n\r\n","closed_by":{"login":"JukkaL","id":1107911,"node_id":"MDQ6VXNlcjExMDc5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1107911?v=4","gravatar_id":"","url":"https://api.github.com/users/JukkaL","html_url":"https://github.com/JukkaL","followers_url":"https://api.github.com/users/JukkaL/followers","following_url":"https://api.github.com/users/JukkaL/following{/other_user}","gists_url":"https://api.github.com/users/JukkaL/gists{/gist_id}","starred_url":"https://api.github.com/users/JukkaL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JukkaL/subscriptions","organizations_url":"https://api.github.com/users/JukkaL/orgs","repos_url":"https://api.github.com/users/JukkaL/repos","events_url":"https://api.github.com/users/JukkaL/events{/privacy}","received_events_url":"https://api.github.com/users/JukkaL/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python/mypy/issues/18265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/mypy/issues/18265/timeline","performed_via_github_app":null,"state_reason":"completed"}