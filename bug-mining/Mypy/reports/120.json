{"url":"https://api.github.com/repos/python/mypy/issues/12451","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/12451/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/12451/comments","events_url":"https://api.github.com/repos/python/mypy/issues/12451/events","html_url":"https://github.com/python/mypy/issues/12451","id":1180891259,"node_id":"I_kwDOAGuhRc5GYvh7","number":12451,"title":"[self-tests] failure against Python 3.10.3","user":{"login":"stanislavlevin","id":31205609,"node_id":"MDQ6VXNlcjMxMjA1NjA5","avatar_url":"https://avatars.githubusercontent.com/u/31205609?v=4","gravatar_id":"","url":"https://api.github.com/users/stanislavlevin","html_url":"https://github.com/stanislavlevin","followers_url":"https://api.github.com/users/stanislavlevin/followers","following_url":"https://api.github.com/users/stanislavlevin/following{/other_user}","gists_url":"https://api.github.com/users/stanislavlevin/gists{/gist_id}","starred_url":"https://api.github.com/users/stanislavlevin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stanislavlevin/subscriptions","organizations_url":"https://api.github.com/users/stanislavlevin/orgs","repos_url":"https://api.github.com/users/stanislavlevin/repos","events_url":"https://api.github.com/users/stanislavlevin/events{/privacy}","received_events_url":"https://api.github.com/users/stanislavlevin/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":21488356,"node_id":"MDU6TGFiZWwyMTQ4ODM1Ng==","url":"https://api.github.com/repos/python/mypy/labels/bug","name":"bug","color":"f9d0c4","default":true,"description":"mypy got something wrong"},{"id":937709516,"node_id":"MDU6TGFiZWw5Mzc3MDk1MTY=","url":"https://api.github.com/repos/python/mypy/labels/topic-tests","name":"topic-tests","color":"c2e0c6","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-03-25T14:51:07Z","updated_at":"2022-03-25T15:54:04Z","closed_at":"2022-03-25T15:54:04Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Bug Report**\r\n\r\n1 test of `mypy`'s test suite fails against Python 3.10.3 with:\r\n```\r\n=================================== FAILURES ===================================\r\n_________________________________ testBlocker __________________________________\r\n[gw13] linux -- Python 3.10.3 /usr/src/RPM/BUILD/python3-module-mypy-0.942/.tox/py3/bin/python\r\ndata: /usr/src/RPM/BUILD/python3-module-mypy-0.942/test-data/unit/cmdline.test:1238:\r\n../../RPM/BUILD/python3-module-mypy-0.942/mypy/test/testcmdline.py:43: in run_case\r\n    test_python_cmdline(testcase, step)\r\n../../RPM/BUILD/python3-module-mypy-0.942/mypy/test/testcmdline.py:105: in test_python_cmdline\r\n    assert_string_arrays_equal(expected_out, out,\r\nE   AssertionError: Invalid output (/usr/src/RPM/BUILD/python3-module-mypy-0.942/test-data/unit/cmdline.test, line 1238)\r\n----------------------------- Captured stderr call -----------------------------\r\nExpected:\r\n  pkg/x.py:1: error: invalid syntax. Perhaps you forgot a comma? (diff)\r\n  Found 1 error in 1 file (errors prevented further checking)\r\n  == Return code: 2\r\nActual:\r\n  pkg/x.py:1: error: invalid syntax             (diff)\r\n  Found 1 error in 1 file (errors prevented further checking)\r\n  == Return code: 2\r\n\r\nAlignment of first line difference:\r\n  E: ...: error: invalid syntax. Perhaps you forgot a comma?\r\n  A: ...: error: invalid syntax\r\n                               ^\r\n=========================== short test summary info ============================\r\nFAILED mypy/test/testcmdline.py::PythonCmdlineSuite::cmdline.test::testBlocker\r\n```\r\n\r\n**To Reproduce**\r\n`python -m pytest 'mypy/test/testcmdline.py::PythonCmdlineSuite::cmdline.test::testBlocker'`\r\n\r\n**Expected Behavior**\r\n\r\nAll tests should pass.\r\n\r\n**Your Environment**\r\n\r\n- Mypy version used: 0.942\r\n- Python version used: 3.10.3\r\n- Operating system and version: ALTLinux\r\n\r\nI think this is due to this change:\r\nhttps://docs.python.org/3/whatsnew/changelog.html#id3\r\n> [bpo-46240](https://bugs.python.org/issue46240): Correct the error message for unclosed parentheses when the tokenizer doesnâ€™t reach the end of the source when the error is reported.\r\n\r\nhttps://bugs.python.org/issue46240\r\n\r\nFor example, Python 3.10.0:\r\n```console\r\n[someuser somedir]$ echo 'public static void main(String[] args)' | python3 -\r\n  File \"<stdin>\", line 1\r\n    public static void main(String[] args)\r\n                                  ^^^^^^^\r\nSyntaxError: invalid syntax. Perhaps you forgot a comma?\r\n```\r\n\r\nand Python 3.10.3:\r\n```console\r\n[someuser somedir]$ echo 'public static void main(String[] args)' | python3 -\r\n  File \"<stdin>\", line 1\r\n    public static void main(String[] args)\r\n           ^^^^^^\r\nSyntaxError: invalid syntax\r\n```","closed_by":{"login":"JelleZijlstra","id":906600,"node_id":"MDQ6VXNlcjkwNjYwMA==","avatar_url":"https://avatars.githubusercontent.com/u/906600?v=4","gravatar_id":"","url":"https://api.github.com/users/JelleZijlstra","html_url":"https://github.com/JelleZijlstra","followers_url":"https://api.github.com/users/JelleZijlstra/followers","following_url":"https://api.github.com/users/JelleZijlstra/following{/other_user}","gists_url":"https://api.github.com/users/JelleZijlstra/gists{/gist_id}","starred_url":"https://api.github.com/users/JelleZijlstra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JelleZijlstra/subscriptions","organizations_url":"https://api.github.com/users/JelleZijlstra/orgs","repos_url":"https://api.github.com/users/JelleZijlstra/repos","events_url":"https://api.github.com/users/JelleZijlstra/events{/privacy}","received_events_url":"https://api.github.com/users/JelleZijlstra/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python/mypy/issues/12451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/mypy/issues/12451/timeline","performed_via_github_app":null,"state_reason":"completed"}