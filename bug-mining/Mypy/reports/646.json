{"url":"https://api.github.com/repos/python/mypy/issues/19896","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/19896/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/19896/comments","events_url":"https://api.github.com/repos/python/mypy/issues/19896/events","html_url":"https://github.com/python/mypy/issues/19896","id":3438237349,"node_id":"I_kwDOAGuhRc7M71al","number":19896,"title":"More precise return types form TypedDict.get","user":{"login":"randolf-scholz","id":39696536,"node_id":"MDQ6VXNlcjM5Njk2NTM2","avatar_url":"https://avatars.githubusercontent.com/u/39696536?v=4","gravatar_id":"","url":"https://api.github.com/users/randolf-scholz","html_url":"https://github.com/randolf-scholz","followers_url":"https://api.github.com/users/randolf-scholz/followers","following_url":"https://api.github.com/users/randolf-scholz/following{/other_user}","gists_url":"https://api.github.com/users/randolf-scholz/gists{/gist_id}","starred_url":"https://api.github.com/users/randolf-scholz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/randolf-scholz/subscriptions","organizations_url":"https://api.github.com/users/randolf-scholz/orgs","repos_url":"https://api.github.com/users/randolf-scholz/repos","events_url":"https://api.github.com/users/randolf-scholz/events{/privacy}","received_events_url":"https://api.github.com/users/randolf-scholz/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":21488358,"node_id":"MDU6TGFiZWwyMTQ4ODM1OA==","url":"https://api.github.com/repos/python/mypy/labels/feature","name":"feature","color":"84b6eb","default":false,"description":null},{"id":488169816,"node_id":"MDU6TGFiZWw0ODgxNjk4MTY=","url":"https://api.github.com/repos/python/mypy/labels/topic-typed-dict","name":"topic-typed-dict","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2025-09-21T13:06:53Z","updated_at":"2025-10-14T14:50:23Z","closed_at":"2025-10-14T14:50:23Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"https://mypy-play.net/?mypy=latest&python=3.12&gist=2af067d4175540de3e8fbda389983bed\n\n```python\nfrom typing import TypedDict, Required, NotRequired\n\nclass D(TypedDict):\n    x: Required[int]\n    y: NotRequired[int]\n\ndef test(d: D, s: str) -> None:\n    reveal_type(d.get(\"x\"))     # int | None        \n    reveal_type(d.get(\"x\", 1))  # int    \n    reveal_type(d.get(\"x\", s))  # int | str\n\n    reveal_type(d.get(\"y\"))     # int | None \n    reveal_type(d.get(\"y\", 1))  # int\n    reveal_type(d.get(\"y\", s))  # int | str\n```\n\nBoth `d.get(\"x\")` and `d.get(\"x\", s)` could give the more precise `int`: Since the key `\"x'` is required, the default is irrelevant. This is how [`pyright` handles it](https://pyright-play.net/?pyrightVersion=1.1.403&strict=true&code=GYJw9gtgBALgngBwJYDsDmUkQWEMoAqiApgCYAiSAxjADRQBKxAjgK5Ihn0ByYMTbDmQBQwqgBsAhgGdpUcgAoiCMpRoBKAFzCouqAA9NjFu06kA2qhgBdHXrhHe-E0ItXbw0sWCxi0mAqkRuT00kb%2BIOpQALQAfFC8KMTaelCcAG7EkuIA%2BvAqgQB0aMQBAET6ZepRqQDEmCgwdroZWbn5xEUl5ZX0AIzVuvVWzWnEmdl5JF2lChVloYNQw42iqa2THTPlcFU1eiv4AD4JYElQoxvt06TFs2W7-UuHl%2BNtUwW33XOPUNLPDWOfxgIGEQA) as well.\n\nMoreover, it would be nice if `reveal_type(d.get)` would give an appropriate overload signature.\n\n```\n# mypy\nRevealed type is \"Overload(\n    def (builtins.str) -> builtins.object,\n    def (builtins.str, default: builtins.object) -> builtins.object,\n    def [_T] (builtins.str, default: _T`475) -> builtins.object\n)\"\n# pyright:\nType of \"d.get\" is \"Overload[\n    (k: Literal['x']) -> int,\n    (k: Literal['x'], default: Any) -> int,\n    (k: Literal['y']) -> (int | None),\n    (k: Literal['y'], default: int | __TDefault@D) -> (int | __TDefault@D),\n    (k: str) -> (Any | None),\n    (k: str, default: Any | __TDefault@D) -> (Any | __TDefault@D)\n]\"\n```\n\n\n\n\n","closed_by":{"login":"ilevkivskyi","id":12005495,"node_id":"MDQ6VXNlcjEyMDA1NDk1","avatar_url":"https://avatars.githubusercontent.com/u/12005495?v=4","gravatar_id":"","url":"https://api.github.com/users/ilevkivskyi","html_url":"https://github.com/ilevkivskyi","followers_url":"https://api.github.com/users/ilevkivskyi/followers","following_url":"https://api.github.com/users/ilevkivskyi/following{/other_user}","gists_url":"https://api.github.com/users/ilevkivskyi/gists{/gist_id}","starred_url":"https://api.github.com/users/ilevkivskyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilevkivskyi/subscriptions","organizations_url":"https://api.github.com/users/ilevkivskyi/orgs","repos_url":"https://api.github.com/users/ilevkivskyi/repos","events_url":"https://api.github.com/users/ilevkivskyi/events{/privacy}","received_events_url":"https://api.github.com/users/ilevkivskyi/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python/mypy/issues/19896/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/mypy/issues/19896/timeline","performed_via_github_app":null,"state_reason":"completed"}