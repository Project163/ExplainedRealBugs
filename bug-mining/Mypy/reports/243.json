{"url":"https://api.github.com/repos/python/mypy/issues/12392","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/12392/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/12392/comments","events_url":"https://api.github.com/repos/python/mypy/issues/12392/events","html_url":"https://github.com/python/mypy/issues/12392","id":1174611682,"node_id":"I_kwDOAGuhRc5GAybi","number":12392,"title":"False-positive errors when using `type[T]` (or `Type[T]`) in a PEP 604 type alias","user":{"login":"AlexWaygood","id":66076021,"node_id":"MDQ6VXNlcjY2MDc2MDIx","avatar_url":"https://avatars.githubusercontent.com/u/66076021?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexWaygood","html_url":"https://github.com/AlexWaygood","followers_url":"https://api.github.com/users/AlexWaygood/followers","following_url":"https://api.github.com/users/AlexWaygood/following{/other_user}","gists_url":"https://api.github.com/users/AlexWaygood/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexWaygood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexWaygood/subscriptions","organizations_url":"https://api.github.com/users/AlexWaygood/orgs","repos_url":"https://api.github.com/users/AlexWaygood/repos","events_url":"https://api.github.com/users/AlexWaygood/events{/privacy}","received_events_url":"https://api.github.com/users/AlexWaygood/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":21488356,"node_id":"MDU6TGFiZWwyMTQ4ODM1Ng==","url":"https://api.github.com/repos/python/mypy/labels/bug","name":"bug","color":"f9d0c4","default":true,"description":"mypy got something wrong"},{"id":936639327,"node_id":"MDU6TGFiZWw5MzY2MzkzMjc=","url":"https://api.github.com/repos/python/mypy/labels/false-positive","name":"false-positive","color":"fc2092","default":false,"description":"mypy gave an error on correct code"},{"id":3945088755,"node_id":"LA_kwDOAGuhRc7rJUbz","url":"https://api.github.com/repos/python/mypy/labels/topic-pep-604","name":"topic-pep-604","color":"79D320","default":false,"description":"PEP 604 (union | operator)"},{"id":3945135234,"node_id":"LA_kwDOAGuhRc7rJfyC","url":"https://api.github.com/repos/python/mypy/labels/topic-type-alias","name":"topic-type-alias","color":"51FABE","default":false,"description":"TypeAlias and other type alias issues"},{"id":3987483894,"node_id":"LA_kwDOAGuhRc7trCz2","url":"https://api.github.com/repos/python/mypy/labels/affects-typeshed","name":"affects-typeshed","color":"E6C11F","default":false,"description":"Anything that blocks a typeshed change"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2022-03-20T16:52:44Z","updated_at":"2023-01-08T19:25:55Z","closed_at":"2022-11-25T10:06:55Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Bug Report**\r\n\r\nThe following two snippets (one using `builtins.type`, the other using `typing.Type`) both work fine at runtime on 3.10+.  They should be accepted as valid type alias definitions on Python 3.10+ (and should be accepted in stub files regardless of Python version). However, mypy raises false-positive errors for both. The errors do not go away if you use `typing.TypeAlias`:\r\n\r\n```python\r\nfrom typing import Type, TypeAlias\r\n\r\nA = type[int] | str  # error: Value of type \"Type[type]\" is not indexable\r\nB = Type[int] | str  # error: Unsupported left operand type for | (\"object\")\r\nC: TypeAlias = type[int] | str  # error: Value of type \"Type[type]\" is not indexable\r\nD: TypeAlias = Type[int] | str  # error: Unsupported left operand type for | (\"object\")\r\n```\r\n\r\nThe order of the types in the union makes no difference when using `type[T]`: the following two variants still produce errors:\r\n\r\n```python\r\nE = str | type[int]  # error: Value of type \"Type[type]\" is not indexable\r\nF: TypeAlias = str | type[int]  # error: Value of type \"Type[type]\" is not indexable\r\n```\r\n\r\nHowever, the order of the types in the union _does_ matter if you're using `typing.Type[T]`:\r\n\r\n```python\r\nB = Type[int] | str  # error: Unsupported left operand type for | (\"object\")\r\nD: TypeAlias = Type[int] | str  # error: Unsupported left operand type for | (\"object\")\r\nG = str | Type[int]  # no error\r\n```\r\n\r\nInterestingly, the bug can only be reproduced if `type` or `Type` is the outermost object in the type alias. Neither of the following two snippets causes mypy errors:\r\n\r\n```python\r\nE = list[type[int] | str]\r\nF = type[int | str]\r\n```\r\n\r\nMypy is also happy with `type[T]` or `Type[T]` being used in old-style `typing.Union` type aliases:\r\n\r\n```python\r\nfrom typing import Union\r\nG = Union[type[int], str]\r\n```\r\n\r\n**To Reproduce**\r\n\r\nMypy playground link [here](https://mypy-play.net/?mypy=latest&python=3.10&gist=490eed5cf7e5fd60b7b13f3eb31d6003).\r\n\r\n**Expected Behavior**\r\n\r\nNo error should be reported.\r\n\r\nCc. @JelleZijlstra","closed_by":{"login":"JukkaL","id":1107911,"node_id":"MDQ6VXNlcjExMDc5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1107911?v=4","gravatar_id":"","url":"https://api.github.com/users/JukkaL","html_url":"https://github.com/JukkaL","followers_url":"https://api.github.com/users/JukkaL/followers","following_url":"https://api.github.com/users/JukkaL/following{/other_user}","gists_url":"https://api.github.com/users/JukkaL/gists{/gist_id}","starred_url":"https://api.github.com/users/JukkaL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JukkaL/subscriptions","organizations_url":"https://api.github.com/users/JukkaL/orgs","repos_url":"https://api.github.com/users/JukkaL/repos","events_url":"https://api.github.com/users/JukkaL/events{/privacy}","received_events_url":"https://api.github.com/users/JukkaL/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python/mypy/issues/12392/reactions","total_count":7,"+1":6,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"timeline_url":"https://api.github.com/repos/python/mypy/issues/12392/timeline","performed_via_github_app":null,"state_reason":"completed"}