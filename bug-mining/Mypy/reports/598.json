{"url":"https://api.github.com/repos/python/mypy/issues/19071","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/19071/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/19071/comments","events_url":"https://api.github.com/repos/python/mypy/issues/19071/events","html_url":"https://github.com/python/mypy/issues/19071","id":3054400537,"node_id":"I_kwDOAGuhRc62DnQZ","number":19071,"title":"stubtest crash with special unicode characters","user":{"login":"Avasam","id":1350584,"node_id":"MDQ6VXNlcjEzNTA1ODQ=","avatar_url":"https://avatars.githubusercontent.com/u/1350584?v=4","gravatar_id":"","url":"https://api.github.com/users/Avasam","html_url":"https://github.com/Avasam","followers_url":"https://api.github.com/users/Avasam/followers","following_url":"https://api.github.com/users/Avasam/following{/other_user}","gists_url":"https://api.github.com/users/Avasam/gists{/gist_id}","starred_url":"https://api.github.com/users/Avasam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Avasam/subscriptions","organizations_url":"https://api.github.com/users/Avasam/orgs","repos_url":"https://api.github.com/users/Avasam/repos","events_url":"https://api.github.com/users/Avasam/events{/privacy}","received_events_url":"https://api.github.com/users/Avasam/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":379446833,"node_id":"MDU6TGFiZWwzNzk0NDY4MzM=","url":"https://api.github.com/repos/python/mypy/labels/crash","name":"crash","color":"b60205","default":false,"description":null},{"id":3201597780,"node_id":"MDU6TGFiZWwzMjAxNTk3Nzgw","url":"https://api.github.com/repos/python/mypy/labels/topic-stubtest","name":"topic-stubtest","color":"A13BA2","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2025-05-10T17:38:41Z","updated_at":"2025-06-20T23:27:44Z","closed_at":"2025-06-20T23:27:44Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\n  Use this form only if mypy reports an \"INTERNAL ERROR\" and/or gives a traceback.\n  Please include the traceback and all other messages below (use `mypy --show-traceback`).\n-->\n\n**Crash Report**\n\nI tried running stubtest on typeshed's networkx stubs\n\n**Traceback**\n\n```\nnetworkx... Note: networkx is not currently tested on win32 in typeshed's CI.\n(49.63 s) fail\n\n**********************************************************************\n\nCommands run:\n\nC:\\Users\\Avasam\\AppData\\Local\\Temp\\stubtest-y0dwwp7i\\Scripts\\pip.exe install networkx[]==3.4.2 mypy==1.15.0 numpy>=1.20 pandas\nMYPYPATH=stubs\\networkx C:\\Users\\Avasam\\AppData\\Local\\Temp\\stubtest-y0dwwp7i\\Scripts\\python.exe -m mypy.stubtest --mypy-config-file C:\\Users\\Avasam\\AppData\\Local\\Temp\\tmpyz4as0cw --custom-typeshed-dir . networkx --allowlist stubs\\networkx\\@tests\\stubtest_allowlist.txt\n\n**********************************************************************\n\nCommand output:\n\nerror: networkx.readwrite.text.AsciiDirectedGlyphs.vertical_edge is not present in stub\nStub: in file E:\\Users\\Avasam\\Documents\\Git\\typeshed\\stubs\\networkx\\networkx\\readwrite\\text.pyi\nMISSING\nRuntime:\n'!'\n\nerror: networkx.readwrite.text.AsciiUndirectedGlyphs.vertical_edge is not present in stub\nStub: in file E:\\Users\\Avasam\\Documents\\Git\\typeshed\\stubs\\networkx\\networkx\\readwrite\\text.pyi\nMISSING\nRuntime:\n'|'\n\nTraceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"C:\\Users\\Avasam\\AppData\\Local\\Temp\\stubtest-y0dwwp7i\\Lib\\site-packages\\mypy\\stubtest.py\", line 2127, in <module>\n    sys.exit(main())\n             ~~~~^^\n  File \"C:\\Users\\Avasam\\AppData\\Local\\Temp\\stubtest-y0dwwp7i\\Lib\\site-packages\\mypy\\stubtest.py\", line 2123, in main\n    return test_stubs(parse_options(sys.argv[1:]))\n  File \"C:\\Users\\Avasam\\AppData\\Local\\Temp\\stubtest-y0dwwp7i\\Lib\\site-packages\\mypy\\stubtest.py\", line 2015, in test_stubs\n    print(error.get_description(concise=args.concise))\n    ~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\Avasam\\AppData\\Roaming\\uv\\data\\python\\cpython-3.13.1-windows-x86_64-none\\Lib\\encodings\\cp1252.py\", line 19, in encode\n    return codecs.charmap_encode(input,self.errors,encoding_table)[0]\n           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nUnicodeEncodeError: 'charmap' codec can't encode character '\\u257d' in position 263: character maps to <undefined>\n\n**********************************************************************\n\nPython version: Python 3.13.1 (main, Dec 19 2024, 14:38:48) [MSC v.1942 64 bit (AMD64)]\n\nRan with the following environment:\nmypy==1.15.0\nmypy_extensions==1.1.0\nnetworkx==3.4.2\nnumpy==2.2.5\npandas==2.2.3\npip==25.1.1\npython-dateutil==2.9.0.post0\npytz==2025.2\nsix==1.17.0\ntyping_extensions==4.13.2\ntzdata==2025.2\n```\n\n**To Reproduce**\n\n1. Clone type shed at commit ee5fcf264bcfddb14259f9f20601781f84834f29\n2. Comment out line `networkx.readwrite.text.*` in `stubs/networkx/@tests/stubtest_allowlist.txt`\n3. Run `./tests/stubtest_third_party.py networkx`\n\n**Your Environment**\n\n<!-- Include as many relevant details about the environment you experienced the bug in -->\n\n- Mypy version used: `mypy 1.15.0 (compiled: yes)`\n- Mypy command-line flags: `python.exe -m mypy.stubtest --mypy-config-file C:\\Users\\Avasam\\AppData\\Local\\Temp\\tmpyz4as0cw --custom-typeshed-dir . networkx --allowlist stubs\\networkx\\@tests\\stubtest_allowlist.txt`\n- Mypy configuration options from `mypy.ini` (and other config files): None afaik\n- Python version used: Python 3.13.1\n- Operating system and version: Version\t10.0.19045 Build 19045\n\nCould be related to https://github.com/python/mypy/issues/11031","closed_by":{"login":"ilevkivskyi","id":12005495,"node_id":"MDQ6VXNlcjEyMDA1NDk1","avatar_url":"https://avatars.githubusercontent.com/u/12005495?v=4","gravatar_id":"","url":"https://api.github.com/users/ilevkivskyi","html_url":"https://github.com/ilevkivskyi","followers_url":"https://api.github.com/users/ilevkivskyi/followers","following_url":"https://api.github.com/users/ilevkivskyi/following{/other_user}","gists_url":"https://api.github.com/users/ilevkivskyi/gists{/gist_id}","starred_url":"https://api.github.com/users/ilevkivskyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilevkivskyi/subscriptions","organizations_url":"https://api.github.com/users/ilevkivskyi/orgs","repos_url":"https://api.github.com/users/ilevkivskyi/repos","events_url":"https://api.github.com/users/ilevkivskyi/events{/privacy}","received_events_url":"https://api.github.com/users/ilevkivskyi/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python/mypy/issues/19071/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/mypy/issues/19071/timeline","performed_via_github_app":null,"state_reason":"completed"}