{"url":"https://api.github.com/repos/python/mypy/issues/14987","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/14987/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/14987/comments","events_url":"https://api.github.com/repos/python/mypy/issues/14987/events","html_url":"https://github.com/python/mypy/issues/14987","id":1649402494,"node_id":"I_kwDOAGuhRc5iT-J-","number":14987,"title":"False positive `unreachable` when variable is set and reset inside loop","user":{"login":"adebrecht661","id":51383174,"node_id":"MDQ6VXNlcjUxMzgzMTc0","avatar_url":"https://avatars.githubusercontent.com/u/51383174?v=4","gravatar_id":"","url":"https://api.github.com/users/adebrecht661","html_url":"https://github.com/adebrecht661","followers_url":"https://api.github.com/users/adebrecht661/followers","following_url":"https://api.github.com/users/adebrecht661/following{/other_user}","gists_url":"https://api.github.com/users/adebrecht661/gists{/gist_id}","starred_url":"https://api.github.com/users/adebrecht661/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adebrecht661/subscriptions","organizations_url":"https://api.github.com/users/adebrecht661/orgs","repos_url":"https://api.github.com/users/adebrecht661/repos","events_url":"https://api.github.com/users/adebrecht661/events{/privacy}","received_events_url":"https://api.github.com/users/adebrecht661/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":21488356,"node_id":"MDU6TGFiZWwyMTQ4ODM1Ng==","url":"https://api.github.com/repos/python/mypy/labels/bug","name":"bug","color":"f9d0c4","default":true,"description":"mypy got something wrong"}],"state":"closed","locked":false,"assignee":{"login":"tyralla","id":25983587,"node_id":"MDQ6VXNlcjI1OTgzNTg3","avatar_url":"https://avatars.githubusercontent.com/u/25983587?v=4","gravatar_id":"","url":"https://api.github.com/users/tyralla","html_url":"https://github.com/tyralla","followers_url":"https://api.github.com/users/tyralla/followers","following_url":"https://api.github.com/users/tyralla/following{/other_user}","gists_url":"https://api.github.com/users/tyralla/gists{/gist_id}","starred_url":"https://api.github.com/users/tyralla/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tyralla/subscriptions","organizations_url":"https://api.github.com/users/tyralla/orgs","repos_url":"https://api.github.com/users/tyralla/repos","events_url":"https://api.github.com/users/tyralla/events{/privacy}","received_events_url":"https://api.github.com/users/tyralla/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"tyralla","id":25983587,"node_id":"MDQ6VXNlcjI1OTgzNTg3","avatar_url":"https://avatars.githubusercontent.com/u/25983587?v=4","gravatar_id":"","url":"https://api.github.com/users/tyralla","html_url":"https://github.com/tyralla","followers_url":"https://api.github.com/users/tyralla/followers","following_url":"https://api.github.com/users/tyralla/following{/other_user}","gists_url":"https://api.github.com/users/tyralla/gists{/gist_id}","starred_url":"https://api.github.com/users/tyralla/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tyralla/subscriptions","organizations_url":"https://api.github.com/users/tyralla/orgs","repos_url":"https://api.github.com/users/tyralla/repos","events_url":"https://api.github.com/users/tyralla/events{/privacy}","received_events_url":"https://api.github.com/users/tyralla/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":6,"created_at":"2023-03-31T13:56:30Z","updated_at":"2025-07-07T19:42:27Z","closed_at":"2025-07-07T19:42:27Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Bug Report**\r\n\r\nmypy warns about the right side of a condition being unreachable when a variable is reset in an outer loop, then set again inside the inner loop.\r\n\r\n**To Reproduce**\r\n\r\n```python\r\nfrom typing import Optional\r\n\r\ntest: Optional[float] = None\r\nreveal_type(test)  # Revealed type: Union[builtins.float, None]\r\n\r\nfor i in range(10):\r\n    test = None\r\n    reveal_type(test)  # Revealed type: None (???)\r\n    for k in range(10):\r\n        if test is None or k > test:\r\n           test = k\r\n```\r\n\r\n**Expected Behavior**\r\n\r\nNo error.\r\n\r\n**Actual Behavior**\r\n\r\nmypy outputs `error: Right operand of \"or\"  is never evaluated`. This is clearly because the type of `test` is re-evaluated at some point, even though it was declared with a type and no statement narrows that type.\r\n\r\nThis appears related to #7204, #8721, #8865, #13973, #14120, except it can't be solved by declaring the type of the variable before the loop in which it's updated (because that violates `no-redef`).\r\n\r\nNote: I'm not sure why anyone would want to actually do this in practice. But I thought it might provide a useful test case.\r\n\r\n**Your Environment**\r\n\r\n- Mypy version used: 1.1.1\r\n- Mypy command-line flags: --disable-error-code name-defined, plus a few others that I don't believe could possibly have any relevance.\r\n- Mypy configuration options from `mypy.ini` (and other config files): None\r\n- Python version used: 3.10.10","closed_by":{"login":"ilevkivskyi","id":12005495,"node_id":"MDQ6VXNlcjEyMDA1NDk1","avatar_url":"https://avatars.githubusercontent.com/u/12005495?v=4","gravatar_id":"","url":"https://api.github.com/users/ilevkivskyi","html_url":"https://github.com/ilevkivskyi","followers_url":"https://api.github.com/users/ilevkivskyi/followers","following_url":"https://api.github.com/users/ilevkivskyi/following{/other_user}","gists_url":"https://api.github.com/users/ilevkivskyi/gists{/gist_id}","starred_url":"https://api.github.com/users/ilevkivskyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilevkivskyi/subscriptions","organizations_url":"https://api.github.com/users/ilevkivskyi/orgs","repos_url":"https://api.github.com/users/ilevkivskyi/repos","events_url":"https://api.github.com/users/ilevkivskyi/events{/privacy}","received_events_url":"https://api.github.com/users/ilevkivskyi/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python/mypy/issues/14987/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/mypy/issues/14987/timeline","performed_via_github_app":null,"state_reason":"completed"}