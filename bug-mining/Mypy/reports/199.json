{"url":"https://api.github.com/repos/python/mypy/issues/13580","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/13580/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/13580/comments","events_url":"https://api.github.com/repos/python/mypy/issues/13580/events","html_url":"https://github.com/python/mypy/issues/13580","id":1358703221,"node_id":"I_kwDOAGuhRc5Q_Cp1","number":13580,"title":"Mypy uses pip for --install-types but does not list pip in requirements","user":{"login":"dvzrv","id":432519,"node_id":"MDQ6VXNlcjQzMjUxOQ==","avatar_url":"https://avatars.githubusercontent.com/u/432519?v=4","gravatar_id":"","url":"https://api.github.com/users/dvzrv","html_url":"https://github.com/dvzrv","followers_url":"https://api.github.com/users/dvzrv/followers","following_url":"https://api.github.com/users/dvzrv/following{/other_user}","gists_url":"https://api.github.com/users/dvzrv/gists{/gist_id}","starred_url":"https://api.github.com/users/dvzrv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dvzrv/subscriptions","organizations_url":"https://api.github.com/users/dvzrv/orgs","repos_url":"https://api.github.com/users/dvzrv/repos","events_url":"https://api.github.com/users/dvzrv/events{/privacy}","received_events_url":"https://api.github.com/users/dvzrv/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":21488356,"node_id":"MDU6TGFiZWwyMTQ4ODM1Ng==","url":"https://api.github.com/repos/python/mypy/labels/bug","name":"bug","color":"f9d0c4","default":true,"description":"mypy got something wrong"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-09-01T11:36:01Z","updated_at":"2022-09-30T19:41:24Z","closed_at":"2022-09-30T19:41:24Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\r\n  If you're new to mypy and you're not sure whether what you're experiencing is a mypy bug, please see the \"Question and Help\" form\r\n  instead.\r\n  Please also consider:\r\n\r\n  - checking our common issues page: https://mypy.readthedocs.io/en/stable/common_issues.html\r\n  - searching our issue tracker: https://github.com/python/mypy/issues to see if\r\n    it's already been reported\r\n  - asking on gitter chat: https://gitter.im/python/typing\r\n-->\r\n\r\n**Bug Report**\r\n\r\n<!--\r\nNote: If the problem you are reporting is about a specific library function, then the typeshed tracker is better suited\r\nfor this report: https://github.com/python/typeshed/issues\r\n-->\r\n\r\nOn Linux distributions packages such as mypy may be built using PEP517 methods by now. Packagers use a project's list of requirements to figure out what is required during build, test and runtime.\r\nThe same is true for minimal venvs in which only the specific set of packages are installed that are required to run a specific thing (e.g. mypy).\r\nMypy requires pip for `mypy --install-types` but does not list pip in its requirements. This leads to virtual environments that can not plainly list mypy as dependency and run `mypy --install-types`. The same is the case for users of given Linux distributions, that install mypy via their package manager (and do not install pip directly or via some other transitive dependency).\r\n\r\n**To Reproduce**\r\n\r\n1. On Arch Linux install mypy, but not pip (e.g. on a fresh system): `pacman -S mypy`\r\n2. In a project that e.g. uses `aiofiles`, run `mypy --install-types -p my_project`\r\n\r\nThe same behavior can be gotten by creating a minimal project using e.g. pdm and adding only packages that do not require pip themselves.\r\nWhen adding mypy there and doing a `pdm run mypy --install-types -p my_project` the same issue as above occurs.\r\n\r\n**Expected Behavior**\r\n\r\n<!--\r\n  How did you expect your project to behave?\r\n  It’s fine if you’re not sure your understanding is correct.\r\n  Write down what you thought would happen. If you just expected no errors, you can delete this section.\r\n-->\r\n\r\nPip is a requirement of mypy and therefore already available when running `mypy --install-types`.\r\n\r\n**Actual Behavior**\r\n\r\n<!--\r\n  Did something go wrong?\r\n  Is something broken, or not behaving as you expected?\r\n-->\r\n\r\n```\r\nmypy --install-types -p repod\r\nrepod/repo/management/outputpackage.py:7: error: Library stubs not installed for \"aiofiles\" (or incompatible with Python 3.10)  [import]\r\nrepod/repo/management/outputpackage.py:7: note: Hint: \"python3 -m pip install types-aiofiles\"\r\nrepod/repo/management/outputpackage.py:7: note: (or run \"mypy --install-types\" to install all missing stub packages)\r\nrepod/repo/management/outputpackage.py:7: note: See https://mypy.readthedocs.io/en/stable/running_mypy.html#missing-imports\r\nFound 1 error in 1 file (checked 26 source files)\r\n\r\nInstalling missing stub packages:\r\n/usr/bin/python -m pip install types-aiofiles\r\n\r\nInstall? [yN] y\r\n\r\n/usr/bin/python: No module named pip\r\n\r\nnote: Run mypy again for up-to-date results with installed types\r\n```\r\n\r\n**Your Environment**\r\n\r\n<!-- Include as many relevant details about the environment you experienced the bug in -->\r\n\r\n- Mypy version used: 971\r\n- Mypy command-line flags: `--install-types`\r\n- Mypy configuration options from `mypy.ini` (and other config files): not relevant for this issue\r\n- Python version used: 3.10.6\r\n- Operating system and version: Arch Linux\r\n\r\n<!--\r\nYou can freely edit this text, please remove all the lines\r\nyou believe are unnecessary.\r\n-->\r\n","closed_by":{"login":"hauntsaninja","id":12621235,"node_id":"MDQ6VXNlcjEyNjIxMjM1","avatar_url":"https://avatars.githubusercontent.com/u/12621235?v=4","gravatar_id":"","url":"https://api.github.com/users/hauntsaninja","html_url":"https://github.com/hauntsaninja","followers_url":"https://api.github.com/users/hauntsaninja/followers","following_url":"https://api.github.com/users/hauntsaninja/following{/other_user}","gists_url":"https://api.github.com/users/hauntsaninja/gists{/gist_id}","starred_url":"https://api.github.com/users/hauntsaninja/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hauntsaninja/subscriptions","organizations_url":"https://api.github.com/users/hauntsaninja/orgs","repos_url":"https://api.github.com/users/hauntsaninja/repos","events_url":"https://api.github.com/users/hauntsaninja/events{/privacy}","received_events_url":"https://api.github.com/users/hauntsaninja/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python/mypy/issues/13580/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/mypy/issues/13580/timeline","performed_via_github_app":null,"state_reason":"completed"}