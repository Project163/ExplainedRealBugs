{"url":"https://api.github.com/repos/python/mypy/issues/11331","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/11331/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/11331/comments","events_url":"https://api.github.com/repos/python/mypy/issues/11331/events","html_url":"https://github.com/python/mypy/issues/11331","id":1026140863,"node_id":"I_kwDOAGuhRc49Kaq_","number":11331,"title":"The `[unreachable]` check fails for module scope code and allows unreachable raising of Exceptions","user":{"login":"harahu","id":6145801,"node_id":"MDQ6VXNlcjYxNDU4MDE=","avatar_url":"https://avatars.githubusercontent.com/u/6145801?v=4","gravatar_id":"","url":"https://api.github.com/users/harahu","html_url":"https://github.com/harahu","followers_url":"https://api.github.com/users/harahu/followers","following_url":"https://api.github.com/users/harahu/following{/other_user}","gists_url":"https://api.github.com/users/harahu/gists{/gist_id}","starred_url":"https://api.github.com/users/harahu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/harahu/subscriptions","organizations_url":"https://api.github.com/users/harahu/orgs","repos_url":"https://api.github.com/users/harahu/repos","events_url":"https://api.github.com/users/harahu/events{/privacy}","received_events_url":"https://api.github.com/users/harahu/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":21488356,"node_id":"MDU6TGFiZWwyMTQ4ODM1Ng==","url":"https://api.github.com/repos/python/mypy/labels/bug","name":"bug","color":"f9d0c4","default":true,"description":"mypy got something wrong"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-10-14T08:57:50Z","updated_at":"2021-10-31T22:00:55Z","closed_at":"2021-10-31T22:00:55Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\r\n  If you're new to mypy and you're not sure whether what you're experiencing is a mypy bug, please see the \"Question and Help\" form\r\n  instead.\r\n-->\r\n\r\n**Bug Report**\r\n\r\n<!--\r\nNote: If the problem you are reporting is about a specific library function, then the typeshed tracker is better suited\r\nfor this report: https://github.com/python/typeshed/issues\r\n-->\r\n\r\nThere are seemingly trivial cases of unreachable code not being detected at module level, or when the code consists of `raise` statements.\r\n\r\n**To Reproduce**\r\n\r\n```py\r\nfrom typing import Final\r\nfrom typing import NoReturn\r\n\r\n\r\ndef foo() -> NoReturn:\r\n    raise Exception(\"foo\")\r\n\r\n\r\ndef bar() -> NoReturn:\r\n    foo()\r\n\r\n    # Should trigger [unreachable] but doesn't\r\n    raise Exception(\"I shouldn't pass static analysis\")\r\n\r\n\r\ndef baz() -> NoReturn:\r\n    raise Exception(\"baz\")\r\n\r\n    # Should trigger [unreachable] but doesn't\r\n    raise Exception(\"I shouldn't pass static analysis\")\r\n\r\n\r\ndef qux() -> None:\r\n    foo()\r\n\r\n    # Should trigger [unreachable] but doesn't\r\n    raise Exception(\"I shouldn't pass static analysis\")\r\n\r\n\r\nfoo()\r\n\r\n# Should trigger [unreachable] but doesn't\r\nraise Exception(\"foo\")\r\n\r\n# Should trigger [unreachable] but doesn't(!)\r\nMEANING: Final[int] = 42\r\n\r\n\r\n```\r\n\r\n**Expected Behavior**\r\n\r\n<!--\r\n  How did you expect your project to behave?\r\n  It’s fine if you’re not sure your understanding is correct.\r\n  Write down what you thought would happen. If you just expected no errors, you can delete this section.\r\n-->\r\n\r\nAs seen in my example, I would expect the optional `[unreachable]` check to detect the following examples of unreachable code:\r\n- General module level code following an exception being raised directly, or a `NoReturn` callable being called.\r\n- Unreachable exception raising (occurring after some prior exception having been raised)\r\n\r\n**Actual Behavior**\r\n\r\n<!--\r\n  Did something go wrong?\r\n  Is something broken, or not behaving as you expected?\r\n-->\r\n\r\nThe example above type checks with `warn_unreachable = True`.\r\n\r\n**Your Environment**\r\n\r\n<!-- Include as many relevant details about the environment you experienced the bug in -->\r\n\r\n- Mypy version used: `0.910`\r\n- Mypy command-line flags: n/a\r\n- Mypy configuration options from `mypy.ini` (and other config files):\r\n```\r\n[mypy]\r\npython_version = 3.8\r\npretty = True\r\nwarn_redundant_casts = True\r\nwarn_unused_ignores = True\r\nignore_missing_imports = True\r\nstrict_optional = True\r\nno_implicit_optional = True\r\nshow_error_context = True\r\nshow_column_numbers = True\r\ndisallow_untyped_calls = True\r\ndisallow_untyped_defs = True\r\nwarn_return_any = True\r\nwarn_unreachable = True\r\nshow_none_errors = True\r\nshow_error_codes = True\r\nfollow_imports = normal\r\nnamespace_packages = True\r\nexplicit_package_bases = True\r\n```\r\n- Python version used: `3.8.10`\r\n- Operating system and version:\r\n`Ubuntu 21.04`\r\n\r\n<!--\r\nYou can freely edit this text, please remove all the lines\r\nyou believe are unnecessary.\r\n-->\r\n","closed_by":{"login":"hauntsaninja","id":12621235,"node_id":"MDQ6VXNlcjEyNjIxMjM1","avatar_url":"https://avatars.githubusercontent.com/u/12621235?v=4","gravatar_id":"","url":"https://api.github.com/users/hauntsaninja","html_url":"https://github.com/hauntsaninja","followers_url":"https://api.github.com/users/hauntsaninja/followers","following_url":"https://api.github.com/users/hauntsaninja/following{/other_user}","gists_url":"https://api.github.com/users/hauntsaninja/gists{/gist_id}","starred_url":"https://api.github.com/users/hauntsaninja/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hauntsaninja/subscriptions","organizations_url":"https://api.github.com/users/hauntsaninja/orgs","repos_url":"https://api.github.com/users/hauntsaninja/repos","events_url":"https://api.github.com/users/hauntsaninja/events{/privacy}","received_events_url":"https://api.github.com/users/hauntsaninja/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python/mypy/issues/11331/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/mypy/issues/11331/timeline","performed_via_github_app":null,"state_reason":"completed"}