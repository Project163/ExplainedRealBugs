{"url":"https://api.github.com/repos/python/mypy/issues/13141","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/13141/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/13141/comments","events_url":"https://api.github.com/repos/python/mypy/issues/13141/events","html_url":"https://github.com/python/mypy/issues/13141","id":1306770589,"node_id":"I_kwDOAGuhRc5N47yd","number":13141,"title":"Use consistent order for messages from mypy daemon","user":{"login":"JukkaL","id":1107911,"node_id":"MDQ6VXNlcjExMDc5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1107911?v=4","gravatar_id":"","url":"https://api.github.com/users/JukkaL","html_url":"https://github.com/JukkaL","followers_url":"https://api.github.com/users/JukkaL/followers","following_url":"https://api.github.com/users/JukkaL/following{/other_user}","gists_url":"https://api.github.com/users/JukkaL/gists{/gist_id}","starred_url":"https://api.github.com/users/JukkaL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JukkaL/subscriptions","organizations_url":"https://api.github.com/users/JukkaL/orgs","repos_url":"https://api.github.com/users/JukkaL/repos","events_url":"https://api.github.com/users/JukkaL/events{/privacy}","received_events_url":"https://api.github.com/users/JukkaL/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":21488358,"node_id":"MDU6TGFiZWwyMTQ4ODM1OA==","url":"https://api.github.com/repos/python/mypy/labels/feature","name":"feature","color":"84b6eb","default":false,"description":null},{"id":608992726,"node_id":"MDU6TGFiZWw2MDg5OTI3MjY=","url":"https://api.github.com/repos/python/mypy/labels/topic-usability","name":"topic-usability","color":"d4c5f9","default":false,"description":null},{"id":737783866,"node_id":"MDU6TGFiZWw3Mzc3ODM4NjY=","url":"https://api.github.com/repos/python/mypy/labels/topic-daemon","name":"topic-daemon","color":"b60205","default":false,"description":"dmypy"},{"id":932016981,"node_id":"MDU6TGFiZWw5MzIwMTY5ODE=","url":"https://api.github.com/repos/python/mypy/labels/good-first-issue","name":"good-first-issue","color":"3dc136","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-07-16T10:24:33Z","updated_at":"2022-09-30T14:26:28Z","closed_at":"2022-09-30T14:26:28Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"If mypy daemon generates errors in multiple files, successive daemon runs can change the order of messages even if they are otherwise identical (e.g. the first run produces messages from `mod1` first followed by messages from `mod2`, and the second runs produces errors from `mod2` first and `mod1` next). Try to keep the order of error messages consistent across runs, since the varying order can be distracting when you are trying to fix errors one by one.\r\n\r\nSuggested approach:\r\n* Store the order of files where we reported errors after each daemon run as a list\r\n* If we had errors in the previous run, sort the errors in the next run so that the order of files matches the previous run (and errors in additional files are at the end, for example)\r\n\r\nErrors are already sorted consistently within a single file, but not across multiple files.\r\n\r\nAnother way would be to sort the messages by the file before reporting them, but this would be a bigger change conceptually and might have some issues (e.g. can't stream errors during the initial run). Preserving the order of errors from the immediate previous run shouldn't cause any additional issues. Related issue: #2144\r\n\r\nTest cases to cover:\r\n* Initial, non-daemon run generates errors.\r\n* Two successive incremental runs generate errors.\r\n* There is a successful run between runs that generate errors. In this case the errors can be reported in an arbitrary order.\r\n\r\n","closed_by":{"login":"JukkaL","id":1107911,"node_id":"MDQ6VXNlcjExMDc5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1107911?v=4","gravatar_id":"","url":"https://api.github.com/users/JukkaL","html_url":"https://github.com/JukkaL","followers_url":"https://api.github.com/users/JukkaL/followers","following_url":"https://api.github.com/users/JukkaL/following{/other_user}","gists_url":"https://api.github.com/users/JukkaL/gists{/gist_id}","starred_url":"https://api.github.com/users/JukkaL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JukkaL/subscriptions","organizations_url":"https://api.github.com/users/JukkaL/orgs","repos_url":"https://api.github.com/users/JukkaL/repos","events_url":"https://api.github.com/users/JukkaL/events{/privacy}","received_events_url":"https://api.github.com/users/JukkaL/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python/mypy/issues/13141/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":2,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/mypy/issues/13141/timeline","performed_via_github_app":null,"state_reason":"completed"}