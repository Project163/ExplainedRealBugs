{"url":"https://api.github.com/repos/python/mypy/issues/11871","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/11871/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/11871/comments","events_url":"https://api.github.com/repos/python/mypy/issues/11871/events","html_url":"https://github.com/python/mypy/issues/11871","id":1090757115,"node_id":"I_kwDOAGuhRc5BA6H7","number":11871,"title":"support pep 673 Self type","user":{"login":"zzzeek","id":128223,"node_id":"MDQ6VXNlcjEyODIyMw==","avatar_url":"https://avatars.githubusercontent.com/u/128223?v=4","gravatar_id":"","url":"https://api.github.com/users/zzzeek","html_url":"https://github.com/zzzeek","followers_url":"https://api.github.com/users/zzzeek/followers","following_url":"https://api.github.com/users/zzzeek/following{/other_user}","gists_url":"https://api.github.com/users/zzzeek/gists{/gist_id}","starred_url":"https://api.github.com/users/zzzeek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zzzeek/subscriptions","organizations_url":"https://api.github.com/users/zzzeek/orgs","repos_url":"https://api.github.com/users/zzzeek/repos","events_url":"https://api.github.com/users/zzzeek/events{/privacy}","received_events_url":"https://api.github.com/users/zzzeek/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":21488358,"node_id":"MDU6TGFiZWwyMTQ4ODM1OA==","url":"https://api.github.com/repos/python/mypy/labels/feature","name":"feature","color":"84b6eb","default":false,"description":null},{"id":3542336145,"node_id":"LA_kwDOAGuhRc7TI8KR","url":"https://api.github.com/repos/python/mypy/labels/meta","name":"meta","color":"D62A71","default":false,"description":"Issues tracking a broad area of work"},{"id":3945357842,"node_id":"LA_kwDOAGuhRc7rKWIS","url":"https://api.github.com/repos/python/mypy/labels/topic-self-types","name":"topic-self-types","color":"d4c5f9","default":false,"description":"Types for self"},{"id":3987483894,"node_id":"LA_kwDOAGuhRc7trCz2","url":"https://api.github.com/repos/python/mypy/labels/affects-typeshed","name":"affects-typeshed","color":"E6C11F","default":false,"description":"Anything that blocks a typeshed change"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":16,"created_at":"2021-12-29T21:28:05Z","updated_at":"2022-11-15T22:03:38Z","closed_at":"2022-11-15T22:03:38Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Feature**\r\n\r\nSupport the pep-673 Self type\r\n\r\npep is at: https://www.python.org/dev/peps/pep-0673/\r\n\r\na rough idea of it is that this code:\r\n\r\n```py\r\nfrom typing import Self\r\n\r\nclass Widget:\r\n    def add_thing(self, value: str) -> Self:\r\n        self.value = value\r\n        return self\r\n\r\n```\r\n\r\nis quasi-equivalent to:\r\n\r\n```py\r\n\r\nfrom typing import TypeVar\r\n\r\nTWidget = TypeVar(\"TWidget\", bound=\"Widget\")\r\n\r\nclass Widget:\r\n    def add_thing(self: TWidget, value: str) -> TWidget:\r\n        self.value = value\r\n        return self\r\n\r\n```\r\n\r\n**Pitch**\r\n\r\nthe appeal of the pep is that for the very common pattern of method-chained object construction, methods can easily indicate they return an object of the same type upon which the method is being invoked.  For example if I made `class SubWidget(Widget)`, the `SubWidget.add_thing()` method reports `SubWidget` as the return type automatically.   The pattern using TypeVar seems to be more or less equivlant, but is more verbose requiring the declaration of TypeVar objects per class hierarchy as well as that it has to be explicitly present on the \"self\" parameter in methods.\r\n\r\nWe are looking for this feature to make our job of integrating typing into SQLAlchemy an easier job.  it seems to be a fairly straightforward translation between two idioms.\r\n\r\n\r\ncc @caselit\r\n\r\n","closed_by":{"login":"ilevkivskyi","id":12005495,"node_id":"MDQ6VXNlcjEyMDA1NDk1","avatar_url":"https://avatars.githubusercontent.com/u/12005495?v=4","gravatar_id":"","url":"https://api.github.com/users/ilevkivskyi","html_url":"https://github.com/ilevkivskyi","followers_url":"https://api.github.com/users/ilevkivskyi/followers","following_url":"https://api.github.com/users/ilevkivskyi/following{/other_user}","gists_url":"https://api.github.com/users/ilevkivskyi/gists{/gist_id}","starred_url":"https://api.github.com/users/ilevkivskyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilevkivskyi/subscriptions","organizations_url":"https://api.github.com/users/ilevkivskyi/orgs","repos_url":"https://api.github.com/users/ilevkivskyi/repos","events_url":"https://api.github.com/users/ilevkivskyi/events{/privacy}","received_events_url":"https://api.github.com/users/ilevkivskyi/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python/mypy/issues/11871/reactions","total_count":29,"+1":27,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":2},"timeline_url":"https://api.github.com/repos/python/mypy/issues/11871/timeline","performed_via_github_app":null,"state_reason":"completed"}