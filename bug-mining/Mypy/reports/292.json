{"url":"https://api.github.com/repos/python/mypy/issues/14871","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/14871/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/14871/comments","events_url":"https://api.github.com/repos/python/mypy/issues/14871/events","html_url":"https://github.com/python/mypy/issues/14871","id":1619917225,"node_id":"I_kwDOAGuhRc5gjfmp","number":14871,"title":"mypy 1.1.1 no longer respects `# type: ignore[attr-defined]` when importing from `typing`","user":{"login":"leycec","id":217028,"node_id":"MDQ6VXNlcjIxNzAyOA==","avatar_url":"https://avatars.githubusercontent.com/u/217028?v=4","gravatar_id":"","url":"https://api.github.com/users/leycec","html_url":"https://github.com/leycec","followers_url":"https://api.github.com/users/leycec/followers","following_url":"https://api.github.com/users/leycec/following{/other_user}","gists_url":"https://api.github.com/users/leycec/gists{/gist_id}","starred_url":"https://api.github.com/users/leycec/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leycec/subscriptions","organizations_url":"https://api.github.com/users/leycec/orgs","repos_url":"https://api.github.com/users/leycec/repos","events_url":"https://api.github.com/users/leycec/events{/privacy}","received_events_url":"https://api.github.com/users/leycec/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":21488356,"node_id":"MDU6TGFiZWwyMTQ4ODM1Ng==","url":"https://api.github.com/repos/python/mypy/labels/bug","name":"bug","color":"f9d0c4","default":true,"description":"mypy got something wrong"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2023-03-11T07:28:45Z","updated_at":"2023-03-12T20:46:27Z","closed_at":"2023-03-11T19:42:12Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Springtime salutations, wonderful mypy devs! The Sun shines bright, the Canadian nights are still as cold as an icepick, and the bugs infest every corner of my codebase.\r\n\r\n<!--\r\nIf you're not sure whether what you're experiencing is a mypy bug, please see the \"Question and Help\" form instead.\r\nPlease consider:\r\n\r\n- checking our common issues page: https://mypy.readthedocs.io/en/stable/common_issues.html\r\n- searching our issue tracker: https://github.com/python/mypy/issues to see if it's already been reported\r\n- asking on gitter chat: https://gitter.im/python/typing\r\n-->\r\n\r\n**Bug Report**\r\n\r\n<!--\r\nIf you're reporting a problem with a specific library function, the typeshed tracker is better suited for this report: https://github.com/python/typeshed/issues\r\n\r\nIf the project you encountered the issue in is open source, please provide a link to the project.\r\n-->\r\n\r\nmypy ≤ 1.0.0 correctly respected `# type: ignore[attr-defined]` comments when importing `typing` attributes *not* available in the current version of Python.\r\n\r\nmypy ≥ 1.1.1 no longer does so, instead emitting an erroneous warning referring to an irrelevant error code (i.e., `\"misc\"`) as well as one warning for each such attribute. Examples follow or my middle name isn't \"Beardy Bald Guy\".\r\n\r\n**To Reproduce**\r\n\r\n```python\r\nfrom typing import (  # type: ignore[attr-defined]\r\n    LiteralString as LiteralString,  # pyright: ignore[reportGeneralTypeIssues]\r\n    Never as Never,  # pyright: ignore[reportGeneralTypeIssues]\r\n    NotRequired as NotRequired,  # pyright: ignore[reportGeneralTypeIssues]\r\n    Required as Required,  # pyright: ignore[reportGeneralTypeIssues]\r\n    Self as Self,  # pyright: ignore[reportGeneralTypeIssues]\r\n    TypeVarTuple as TypeVarTuple,  # pyright: ignore[reportGeneralTypeIssues]\r\n    Unpack as Unpack,  # pyright: ignore[reportGeneralTypeIssues]\r\n    assert_never as assert_never,  # pyright: ignore[reportGeneralTypeIssues]\r\n    assert_type as assert_type,  # pyright: ignore[reportGeneralTypeIssues]\r\n    clear_overloads as clear_overloads,  # pyright: ignore[reportGeneralTypeIssues]\r\n    dataclass_transform as dataclass_transform,  # pyright: ignore[reportGeneralTypeIssues]\r\n    reveal_type as reveal_type,  # pyright: ignore[reportGeneralTypeIssues]\r\n    get_overloads as get_overloads,  # pyright: ignore[reportGeneralTypeIssues]\r\n    reveal_type as reveal_type,  # pyright: ignore[reportGeneralTypeIssues]\r\n)\r\n```\r\n\r\nThe above code is copied verbatim from the @beartype codebase, which I maintain for the good of QA-kind. The above code used to pass muster under both mypy and pyright. Now, only pyright remains happy:\r\n\r\n```\r\n$ pyright\r\nLoading configuration file at /home/leycec/py/beartype/pyrightconfig.json\r\nAssuming Python version 3.11\r\nAssuming Python platform Linux\r\nSearching for source files\r\nFound 223 source files\r\npyright 1.1.298\r\n0 errors, 0 warnings, 0 informations \r\nCompleted in 10.842sec\r\n\r\n$ python3.11 -m mypy\r\nSuccess: no issues found in 223 source files\r\n\r\n$ python3.10 -m mypy\r\nbeartype/typing/__init__.py:192: note: Use `from typing_extensions import LiteralString` instead\r\nbeartype/typing/__init__.py:192: note: Error code \"misc\" not covered by \"type: ignore\" comment\r\nbeartype/typing/__init__.py:192: note: See https://mypy.readthedocs.io/en/stable/runtime_troubles.html#using-new-additions-to-the-typing-module\r\nbeartype/typing/__init__.py:192: note: Use `from typing_extensions import Never` instead\r\nbeartype/typing/__init__.py:192: note: Use `from typing_extensions import NotRequired` instead\r\nbeartype/typing/__init__.py:192: note: Use `from typing_extensions import Required` instead\r\nbeartype/typing/__init__.py:192: note: Use `from typing_extensions import Self` instead\r\nbeartype/typing/__init__.py:192: note: Use `from typing_extensions import TypeVarTuple` instead\r\nbeartype/typing/__init__.py:192: note: Use `from typing_extensions import Unpack` instead\r\nbeartype/typing/__init__.py:192: note: Use `from typing_extensions import assert_never` instead\r\nbeartype/typing/__init__.py:192: note: Use `from typing_extensions import assert_type` instead\r\nbeartype/typing/__init__.py:192: note: Use `from typing_extensions import clear_overloads` instead\r\nbeartype/typing/__init__.py:192: note: Use `from typing_extensions import dataclass_transform` instead\r\nbeartype/typing/__init__.py:192: note: Use `from typing_extensions import reveal_type` instead\r\nbeartype/typing/__init__.py:192: note: Use `from typing_extensions import get_overloads` instead\r\nSuccess: no issues found in 223 source files\r\n```\r\n\r\nAll is no longer well here. @beartype's userbase will now be assaulted with spurious warnings they can do absolutely nothing about. Even I can't do anything about these warnings! And I'm the @beartype guy.\r\n\r\nMoreover, these warnings are arguably harmful with respect to runtime typing. The `typing_extensions` module may be an unconditional improvement over the `typing` module with respect to *static* typing – but that definitely doesn't extend to *runtime* typing. Why? Because the runtime API of type hints defined by the `typing_extensions` module **substantially differs in non-standard and non-trivial ways** from that defined by the `typing` module. It's effectively infeasible for runtime type-checkers to support both. Ergo, runtime type-checkers typically only support type hints defined by the `typing` module.\r\n\r\n@beartype breaks this trend a bit. We actively support a subset of type hints defined by the `typing_extensions` module (e.g., `typing_extensions.Literal[...]`), despite those type hints providing a non-standard runtime API – but that's only a subset and that's only because Microsoft themselves vociferously complained on our issue tracker about this. What Microsoft wants, one gives to Microsoft.\r\n\r\n**Expected Behavior**\r\n\r\n<!--\r\nHow did you expect mypy to behave? It’s fine if you’re not sure your understanding is correct.\r\nWrite down what you thought would happen. If you expected no errors, delete this section.\r\n-->\r\n\r\nSilence! Sweet, blessed silence!\r\n\r\n**Actual Behavior**\r\n\r\n<!-- What went wrong? Paste mypy's output. -->\r\n\r\nLoudness! Horrid, accursed loudness! <sup>Please see above.</sup>\r\n\r\n**Your Environment**\r\n\r\n<!-- Include as many relevant details about the environment you experienced the bug in -->\r\n\r\n- Mypy version used: mypy 1.1.1\r\n- Mypy command-line flags: None.\r\n- Mypy configuration options from `mypy.ini` (and other config files): None.\r\n- Python version used: Python 3.11, 3.10, 3.9, 3.8, and 3.7. Literally everything that has yet to hit EOL.\r\n\r\n<!-- You can freely edit this text, please remove all the lines you believe are unnecessary. -->\r\n\r\nThanks so much for all the tremendous volunteerism over these many, long years. You are dedication incarnate. Much :heart: from the snow-encrusted Canadian wilderness.\r\n\r\n— @leycec, the @beartype guy","closed_by":{"login":"JelleZijlstra","id":906600,"node_id":"MDQ6VXNlcjkwNjYwMA==","avatar_url":"https://avatars.githubusercontent.com/u/906600?v=4","gravatar_id":"","url":"https://api.github.com/users/JelleZijlstra","html_url":"https://github.com/JelleZijlstra","followers_url":"https://api.github.com/users/JelleZijlstra/followers","following_url":"https://api.github.com/users/JelleZijlstra/following{/other_user}","gists_url":"https://api.github.com/users/JelleZijlstra/gists{/gist_id}","starred_url":"https://api.github.com/users/JelleZijlstra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JelleZijlstra/subscriptions","organizations_url":"https://api.github.com/users/JelleZijlstra/orgs","repos_url":"https://api.github.com/users/JelleZijlstra/repos","events_url":"https://api.github.com/users/JelleZijlstra/events{/privacy}","received_events_url":"https://api.github.com/users/JelleZijlstra/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python/mypy/issues/14871/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/mypy/issues/14871/timeline","performed_via_github_app":null,"state_reason":"completed"}