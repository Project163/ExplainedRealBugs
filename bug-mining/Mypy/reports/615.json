{"url":"https://api.github.com/repos/python/mypy/issues/19559","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/19559/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/19559/comments","events_url":"https://api.github.com/repos/python/mypy/issues/19559/events","html_url":"https://github.com/python/mypy/issues/19559","id":3283269627,"node_id":"I_kwDOAGuhRc7Dsrf7","number":19559,"title":"Generic dataclass with TypeVarTuple crashes Mypy","user":{"login":"sojmadmi","id":65964435,"node_id":"MDQ6VXNlcjY1OTY0NDM1","avatar_url":"https://avatars.githubusercontent.com/u/65964435?v=4","gravatar_id":"","url":"https://api.github.com/users/sojmadmi","html_url":"https://github.com/sojmadmi","followers_url":"https://api.github.com/users/sojmadmi/followers","following_url":"https://api.github.com/users/sojmadmi/following{/other_user}","gists_url":"https://api.github.com/users/sojmadmi/gists{/gist_id}","starred_url":"https://api.github.com/users/sojmadmi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sojmadmi/subscriptions","organizations_url":"https://api.github.com/users/sojmadmi/orgs","repos_url":"https://api.github.com/users/sojmadmi/repos","events_url":"https://api.github.com/users/sojmadmi/events{/privacy}","received_events_url":"https://api.github.com/users/sojmadmi/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":379446833,"node_id":"MDU6TGFiZWwzNzk0NDY4MzM=","url":"https://api.github.com/repos/python/mypy/labels/crash","name":"crash","color":"b60205","default":false,"description":null},{"id":7057647935,"node_id":"LA_kwDOAGuhRc8AAAABpKspPw","url":"https://api.github.com/repos/python/mypy/labels/topic-pep-695","name":"topic-pep-695","color":"5BB174","default":false,"description":"Issues related to PEP 695 syntax"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2025-08-01T09:47:25Z","updated_at":"2025-08-02T00:27:03Z","closed_at":"2025-08-02T00:27:02Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\n  Use this form only if mypy reports an \"INTERNAL ERROR\" and/or gives a traceback.\n  Please include the traceback and all other messages below (use `mypy --show-traceback`).\n-->\n\n**Crash Report**\n\nMypy crashes with `NotImplementedError` when defining a dataclass parametrized by two generics where one of them is a TypeVarTuple.\n\n\n**Traceback**\n\n```\nversion: 1.18.0+dev.07d4a1bf9c73f39d6c05d6665c1fafc8f12c3e77\nTraceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/mypy-test/mypy/mypy/__main__.py\", line 37, in <module>\n    console_entry()\n  File \"/mypy-test/mypy/mypy/__main__.py\", line 15, in console_entry\n    main()\n  File \"/mypy-test/mypy/mypy/main.py\", line 127, in main\n    res, messages, blockers = run_build(sources, options, fscache, t0, stdout, stderr)\n  File \"/mypy-test/mypy/mypy/main.py\", line 211, in run_build\n    res = build.build(sources, options, None, flush_errors, fscache, stdout, stderr)\n  File \"/mypy-test/mypy/mypy/build.py\", line 191, in build\n    result = _build(\n  File \"/mypy-test/mypy/mypy/build.py\", line 267, in _build\n    graph = dispatch(sources, manager, stdout)\n  File \"/mypy-test/mypy/mypy/build.py\", line 2939, in dispatch\n    process_graph(graph, manager)\n  File \"/mypy-test/mypy/mypy/build.py\", line 3337, in process_graph\n    process_stale_scc(graph, scc, manager)\n  File \"/mypy-test/mypy/mypy/build.py\", line 3438, in process_stale_scc\n    graph[id].type_check_first_pass()\n  File \"/mypy-test/mypy/mypy/build.py\", line 2311, in type_check_first_pass\n    self.type_checker().check_first_pass()\n  File \"/mypy-test/mypy/mypy/checker.py\", line 483, in check_first_pass\n    self.accept(d)\n  File \"/mypy-test/mypy/mypy/checker.py\", line 594, in accept\n    stmt.accept(self)\n    ~~~~~~~~~~~^^^^^^\n  File \"/mypy-test/mypy/mypy/nodes.py\", line 1249, in accept\n    return visitor.visit_class_def(self)\n           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^\n  File \"/mypy-test/mypy/mypy/checker.py\", line 2658, in visit_class_def\n    infer_class_variances(defn.info)\n    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^\n  File \"/mypy-test/mypy/mypy/subtypes.py\", line 2266, in infer_class_variances\n    if not infer_variance(info, i):\n           ~~~~~~~~~~~~~~^^^^^^^^^\n  File \"/mypy-test/mypy/mypy/subtypes.py\", line 2215, in infer_variance\n    typ = find_member(member, self_type, self_type)\n  File \"/mypy-test/mypy/mypy/subtypes.py\", line 1352, in find_member\n    return analyze_instance_member_access(name, itype, mx, info)\n  File \"/mypy-test/mypy/mypy/checkmember.py\", line 379, in analyze_instance_member_access\n    member_type = expand_type_by_instance(signature, typ)\n  File \"/mypy-test/mypy/mypy/expandtype.py\", line 115, in expand_type_by_instance\n    return expand_type(typ, variables)\n  File \"/mypy-test/mypy/mypy/expandtype.py\", line 70, in expand_type\n    return typ.accept(ExpandTypeVisitor(env))\n           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/mypy-test/mypy/mypy/types.py\", line 2030, in accept\n    return visitor.visit_callable_type(self)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^\n  File \"/mypy-test/mypy/mypy/expandtype.py\", line 421, in visit_callable_type\n    ret_type=t.ret_type.accept(self),\n             ~~~~~~~~~~~~~~~~~^^^^^^\n  File \"/mypy-test/mypy/mypy/types.py\", line 1490, in accept\n    return visitor.visit_instance(self)\n           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^\n  File \"/mypy-test/mypy/mypy/expandtype.py\", line 216, in visit_instance\n    args = self.expand_type_tuple_with_unpack(t.args)\n  File \"/mypy-test/mypy/mypy/expandtype.py\", line 456, in expand_type_tuple_with_unpack\n    items.append(item.accept(self))\n                 ~~~~~~~~~~~^^^^^^\n  File \"/mypy-test/mypy/mypy/types.py\", line 901, in accept\n    return visitor.visit_type_var_tuple(self)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^\n  File \"/mypy-test/mypy/mypy/expandtype.py\", line 298, in visit_type_var_tuple\n    raise NotImplementedError\nNotImplementedError: \n../../mypy_debug.py:6: : note: use --pdb to drop into pdb\n```\n\n**To Reproduce**\n\n```python\nfrom collections.abc import Callable\nfrom dataclasses import dataclass\n\n\n@dataclass\nclass Test[*Ts, R]:\n    a: Callable[[*Ts], R]\n```\n\n**Your Environment**\n\n<!-- Include as many relevant details about the environment you experienced the bug in -->\n\n- Mypy version used: 1.17.1 and master - 1.18.0+dev.07d4a1bf9c73f39d6c05d6665c1fafc8f12c3e77\n- Mypy command-line flags:\n- Mypy configuration options from `mypy.ini` (and other config files): python_version = 3.13\n- Python version used: 3.13.3\n- Operating system and version: Red Hat Enterprise Linux 9.5 (Plow)\n\n<!--\nYou can freely edit this text, please remove all the lines\nyou believe are unnecessary.\n-->\n","closed_by":{"login":"ilevkivskyi","id":12005495,"node_id":"MDQ6VXNlcjEyMDA1NDk1","avatar_url":"https://avatars.githubusercontent.com/u/12005495?v=4","gravatar_id":"","url":"https://api.github.com/users/ilevkivskyi","html_url":"https://github.com/ilevkivskyi","followers_url":"https://api.github.com/users/ilevkivskyi/followers","following_url":"https://api.github.com/users/ilevkivskyi/following{/other_user}","gists_url":"https://api.github.com/users/ilevkivskyi/gists{/gist_id}","starred_url":"https://api.github.com/users/ilevkivskyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilevkivskyi/subscriptions","organizations_url":"https://api.github.com/users/ilevkivskyi/orgs","repos_url":"https://api.github.com/users/ilevkivskyi/repos","events_url":"https://api.github.com/users/ilevkivskyi/events{/privacy}","received_events_url":"https://api.github.com/users/ilevkivskyi/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python/mypy/issues/19559/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/mypy/issues/19559/timeline","performed_via_github_app":null,"state_reason":"completed"}