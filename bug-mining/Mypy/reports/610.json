{"url":"https://api.github.com/repos/python/mypy/issues/19425","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/19425/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/19425/comments","events_url":"https://api.github.com/repos/python/mypy/issues/19425/events","html_url":"https://github.com/python/mypy/issues/19425","id":3222797318,"node_id":"I_kwDOAGuhRc7AF_wG","number":19425,"title":"AssertionError raised after #19248","user":{"login":"SemMulder","id":4629399,"node_id":"MDQ6VXNlcjQ2MjkzOTk=","avatar_url":"https://avatars.githubusercontent.com/u/4629399?v=4","gravatar_id":"","url":"https://api.github.com/users/SemMulder","html_url":"https://github.com/SemMulder","followers_url":"https://api.github.com/users/SemMulder/followers","following_url":"https://api.github.com/users/SemMulder/following{/other_user}","gists_url":"https://api.github.com/users/SemMulder/gists{/gist_id}","starred_url":"https://api.github.com/users/SemMulder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SemMulder/subscriptions","organizations_url":"https://api.github.com/users/SemMulder/orgs","repos_url":"https://api.github.com/users/SemMulder/repos","events_url":"https://api.github.com/users/SemMulder/events{/privacy}","received_events_url":"https://api.github.com/users/SemMulder/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":21488356,"node_id":"MDU6TGFiZWwyMTQ4ODM1Ng==","url":"https://api.github.com/repos/python/mypy/labels/bug","name":"bug","color":"f9d0c4","default":true,"description":"mypy got something wrong"},{"id":737783866,"node_id":"MDU6TGFiZWw3Mzc3ODM4NjY=","url":"https://api.github.com/repos/python/mypy/labels/topic-daemon","name":"topic-daemon","color":"b60205","default":false,"description":"dmypy"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2025-07-11T12:45:04Z","updated_at":"2025-07-18T14:41:42Z","closed_at":"2025-07-18T14:41:42Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\nIf you're not sure whether what you're experiencing is a mypy bug, please see the \"Question and Help\" form instead.\nPlease consider:\n\n- checking our common issues page: https://mypy.readthedocs.io/en/stable/common_issues.html\n- searching our issue tracker: https://github.com/python/mypy/issues to see if it's already been reported\n- asking on gitter chat: https://gitter.im/python/typing\n-->\n\n**Bug Report**\n\n<!--\nIf you're reporting a problem with a specific library function, the typeshed tracker is better suited for this report: https://github.com/python/typeshed/issues\n\nIf the project you encountered the issue in is open source, please provide a link to the project.\n-->\n\nAfter upgrading to 1.16.1 we are seeing occasional `AssertionError`s being logged:\n\n```console\n$ mypy\nmypy 1.16.1 (compiled: yes)\nException ignored in PyObject_HasAttr(); consider using PyObject_HasAttrWithError(), PyObject_GetOptionalAttr() or PyObject_GetAttr():\nTraceback (most recent call last):\n  File \"mypy/nodes.py\", line 615, in setter\nAssertionError: \n... (repeated many times)\n```\n\nIt seems like the code introduced in https://github.com/python/mypy/pull/19248 to fix https://github.com/python/mypy/issues/19224 makes an assert which is not always true. It seems like the worry expressed in a [comment](https://github.com/python/mypy/pull/19248#pullrequestreview-2907639889) on that PR was justified ;).\n\n**To Reproduce**\n\nWe haven't managed to find a reliable reproducer yet. Switching between branches in our repo and invoking `mypy`, sometimes triggers it, but sometimes doesn't.\n\n**Expected Behavior**\n\n<!--\nHow did you expect mypy to behave? It’s fine if you’re not sure your understanding is correct.\nWrite down what you thought would happen. If you expected no errors, delete this section.\n-->\n\nNo errors.\n\n**Actual Behavior**\n\n<!-- What went wrong? Paste mypy's output. -->\n\nErrors.\n\n**Your Environment**\n\n<!-- Include as many relevant details about the environment you experienced the bug in -->\n\n- Mypy version used: 1.6.1\n- Mypy command-line flags: `dmypy run -- --cache-dir .mypy_cache/not_recently_touched <explicitly specified list of .py files>`\n- Mypy configuration options from `mypy.ini` (and other config files):\n```toml\n[tool.mypy]\nplugins = [\n  \"pydantic.mypy\",\n  \"pydantic.v1.mypy\",\n  \"sqlalchemy.ext.mypy.plugin\",\n  \"mypy.plugins.proper_plugin\", \n  <a custom mypy plugin>\n]\npython_version = \"3.13\"\nshow_error_codes = true\nstrict = true\n\nenable_error_code = [\n  \"ignore-without-code\",\n  \"redundant-expr\",\n  \"redundant-self\",\n  \"truthy-bool\",\n  \"truthy-iterable\",\n]\nno_implicit_optional = true\nwarn_unreachable = true\n\n[[tool.mypy.overrides]]\nignore_missing_imports = true\nmodule = [\n    \"asyncpg.*\",\n]\n```\n- Python version used:\n\n```console\n$ python --version\nPython 3.13.3\n```","closed_by":{"login":"JukkaL","id":1107911,"node_id":"MDQ6VXNlcjExMDc5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1107911?v=4","gravatar_id":"","url":"https://api.github.com/users/JukkaL","html_url":"https://github.com/JukkaL","followers_url":"https://api.github.com/users/JukkaL/followers","following_url":"https://api.github.com/users/JukkaL/following{/other_user}","gists_url":"https://api.github.com/users/JukkaL/gists{/gist_id}","starred_url":"https://api.github.com/users/JukkaL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JukkaL/subscriptions","organizations_url":"https://api.github.com/users/JukkaL/orgs","repos_url":"https://api.github.com/users/JukkaL/repos","events_url":"https://api.github.com/users/JukkaL/events{/privacy}","received_events_url":"https://api.github.com/users/JukkaL/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python/mypy/issues/19425/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/mypy/issues/19425/timeline","performed_via_github_app":null,"state_reason":"completed"}