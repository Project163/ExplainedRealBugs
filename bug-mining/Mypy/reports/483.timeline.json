[{"id":15269162729,"node_id":"LE_lADOAGuhRc6eIRwSzwAAAAOOHO7p","url":"https://api.github.com/repos/python/mypy/issues/events/15269162729","actor":{"login":"AlexWaygood","id":66076021,"node_id":"MDQ6VXNlcjY2MDc2MDIx","avatar_url":"https://avatars.githubusercontent.com/u/66076021?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexWaygood","html_url":"https://github.com/AlexWaygood","followers_url":"https://api.github.com/users/AlexWaygood/followers","following_url":"https://api.github.com/users/AlexWaygood/following{/other_user}","gists_url":"https://api.github.com/users/AlexWaygood/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexWaygood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexWaygood/subscriptions","organizations_url":"https://api.github.com/users/AlexWaygood/orgs","repos_url":"https://api.github.com/users/AlexWaygood/repos","events_url":"https://api.github.com/users/AlexWaygood/events{/privacy}","received_events_url":"https://api.github.com/users/AlexWaygood/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-11-12T18:19:58Z","label":{"name":"bug","color":"f9d0c4"},"performed_via_github_app":null},{"actor":{"login":"AlexWaygood","id":66076021,"node_id":"MDQ6VXNlcjY2MDc2MDIx","avatar_url":"https://avatars.githubusercontent.com/u/66076021?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexWaygood","html_url":"https://github.com/AlexWaygood","followers_url":"https://api.github.com/users/AlexWaygood/followers","following_url":"https://api.github.com/users/AlexWaygood/following{/other_user}","gists_url":"https://api.github.com/users/AlexWaygood/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexWaygood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexWaygood/subscriptions","organizations_url":"https://api.github.com/users/AlexWaygood/orgs","repos_url":"https://api.github.com/users/AlexWaygood/repos","events_url":"https://api.github.com/users/AlexWaygood/events{/privacy}","received_events_url":"https://api.github.com/users/AlexWaygood/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-12T18:20:23Z","updated_at":"2024-11-12T18:20:23Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/python/typeshed/issues/11637","repository_url":"https://api.github.com/repos/python/typeshed","labels_url":"https://api.github.com/repos/python/typeshed/issues/11637/labels{/name}","comments_url":"https://api.github.com/repos/python/typeshed/issues/11637/comments","events_url":"https://api.github.com/repos/python/typeshed/issues/11637/events","html_url":"https://github.com/python/typeshed/pull/11637","id":2197657992,"node_id":"PR_kwDOAeOl_85qOnij","number":11637,"title":"Make slice generic","user":{"login":"Sachaa-Thanasius","id":111999343,"node_id":"U_kgDOBqz5bw","avatar_url":"https://avatars.githubusercontent.com/u/111999343?v=4","gravatar_id":"","url":"https://api.github.com/users/Sachaa-Thanasius","html_url":"https://github.com/Sachaa-Thanasius","followers_url":"https://api.github.com/users/Sachaa-Thanasius/followers","following_url":"https://api.github.com/users/Sachaa-Thanasius/following{/other_user}","gists_url":"https://api.github.com/users/Sachaa-Thanasius/gists{/gist_id}","starred_url":"https://api.github.com/users/Sachaa-Thanasius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Sachaa-Thanasius/subscriptions","organizations_url":"https://api.github.com/users/Sachaa-Thanasius/orgs","repos_url":"https://api.github.com/users/Sachaa-Thanasius/repos","events_url":"https://api.github.com/users/Sachaa-Thanasius/events{/privacy}","received_events_url":"https://api.github.com/users/Sachaa-Thanasius/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":40,"created_at":"2024-03-20T14:18:15Z","updated_at":"2024-11-12T18:20:23Z","closed_at":"2024-10-24T15:40:29Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":31696383,"node_id":"MDEwOlJlcG9zaXRvcnkzMTY5NjM4Mw==","name":"typeshed","full_name":"python/typeshed","private":false,"owner":{"login":"python","id":1525981,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE1MjU5ODE=","avatar_url":"https://avatars.githubusercontent.com/u/1525981?v=4","gravatar_id":"","url":"https://api.github.com/users/python","html_url":"https://github.com/python","followers_url":"https://api.github.com/users/python/followers","following_url":"https://api.github.com/users/python/following{/other_user}","gists_url":"https://api.github.com/users/python/gists{/gist_id}","starred_url":"https://api.github.com/users/python/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/python/subscriptions","organizations_url":"https://api.github.com/users/python/orgs","repos_url":"https://api.github.com/users/python/repos","events_url":"https://api.github.com/users/python/events{/privacy}","received_events_url":"https://api.github.com/users/python/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/python/typeshed","description":"Collection of library stubs for Python, with static types","fork":false,"url":"https://api.github.com/repos/python/typeshed","forks_url":"https://api.github.com/repos/python/typeshed/forks","keys_url":"https://api.github.com/repos/python/typeshed/keys{/key_id}","collaborators_url":"https://api.github.com/repos/python/typeshed/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/python/typeshed/teams","hooks_url":"https://api.github.com/repos/python/typeshed/hooks","issue_events_url":"https://api.github.com/repos/python/typeshed/issues/events{/number}","events_url":"https://api.github.com/repos/python/typeshed/events","assignees_url":"https://api.github.com/repos/python/typeshed/assignees{/user}","branches_url":"https://api.github.com/repos/python/typeshed/branches{/branch}","tags_url":"https://api.github.com/repos/python/typeshed/tags","blobs_url":"https://api.github.com/repos/python/typeshed/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/python/typeshed/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/python/typeshed/git/refs{/sha}","trees_url":"https://api.github.com/repos/python/typeshed/git/trees{/sha}","statuses_url":"https://api.github.com/repos/python/typeshed/statuses/{sha}","languages_url":"https://api.github.com/repos/python/typeshed/languages","stargazers_url":"https://api.github.com/repos/python/typeshed/stargazers","contributors_url":"https://api.github.com/repos/python/typeshed/contributors","subscribers_url":"https://api.github.com/repos/python/typeshed/subscribers","subscription_url":"https://api.github.com/repos/python/typeshed/subscription","commits_url":"https://api.github.com/repos/python/typeshed/commits{/sha}","git_commits_url":"https://api.github.com/repos/python/typeshed/git/commits{/sha}","comments_url":"https://api.github.com/repos/python/typeshed/comments{/number}","issue_comment_url":"https://api.github.com/repos/python/typeshed/issues/comments{/number}","contents_url":"https://api.github.com/repos/python/typeshed/contents/{+path}","compare_url":"https://api.github.com/repos/python/typeshed/compare/{base}...{head}","merges_url":"https://api.github.com/repos/python/typeshed/merges","archive_url":"https://api.github.com/repos/python/typeshed/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/python/typeshed/downloads","issues_url":"https://api.github.com/repos/python/typeshed/issues{/number}","pulls_url":"https://api.github.com/repos/python/typeshed/pulls{/number}","milestones_url":"https://api.github.com/repos/python/typeshed/milestones{/number}","notifications_url":"https://api.github.com/repos/python/typeshed/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/python/typeshed/labels{/name}","releases_url":"https://api.github.com/repos/python/typeshed/releases{/id}","deployments_url":"https://api.github.com/repos/python/typeshed/deployments","created_at":"2015-03-05T04:51:28Z","updated_at":"2025-11-08T16:43:58Z","pushed_at":"2025-11-08T16:43:53Z","git_url":"git://github.com/python/typeshed.git","ssh_url":"git@github.com:python/typeshed.git","clone_url":"https://github.com/python/typeshed.git","svn_url":"https://github.com/python/typeshed","homepage":"","size":29634,"stargazers_count":4915,"watchers_count":4915,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":1931,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":332,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["python","stub","types","typing"],"visibility":"public","forks":1931,"open_issues":332,"watchers":4915,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/python/typeshed/pulls/11637","html_url":"https://github.com/python/typeshed/pull/11637","diff_url":"https://github.com/python/typeshed/pull/11637.diff","patch_url":"https://github.com/python/typeshed/pull/11637.patch","merged_at":"2024-10-24T15:40:29Z"},"body":"Mainly doing this out of curiosity to see the primer hits.\r\n\r\nEDIT: Would close #8647.\r\n","reactions":{"url":"https://api.github.com/repos/python/typeshed/issues/11637/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":2,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/typeshed/issues/11637/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/python/mypy/issues/comments/2471265741","html_url":"https://github.com/python/mypy/issues/18149#issuecomment-2471265741","issue_url":"https://api.github.com/repos/python/mypy/issues/18149","id":2471265741,"node_id":"IC_kwDOAGuhRc6TTIXN","user":{"login":"randolf-scholz","id":39696536,"node_id":"MDQ6VXNlcjM5Njk2NTM2","avatar_url":"https://avatars.githubusercontent.com/u/39696536?v=4","gravatar_id":"","url":"https://api.github.com/users/randolf-scholz","html_url":"https://github.com/randolf-scholz","followers_url":"https://api.github.com/users/randolf-scholz/followers","following_url":"https://api.github.com/users/randolf-scholz/following{/other_user}","gists_url":"https://api.github.com/users/randolf-scholz/gists{/gist_id}","starred_url":"https://api.github.com/users/randolf-scholz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/randolf-scholz/subscriptions","organizations_url":"https://api.github.com/users/randolf-scholz/orgs","repos_url":"https://api.github.com/users/randolf-scholz/repos","events_url":"https://api.github.com/users/randolf-scholz/events{/privacy}","received_events_url":"https://api.github.com/users/randolf-scholz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-12T18:24:34Z","updated_at":"2024-11-12T18:25:10Z","body":"I think this is because since python 3.12, slice is hashable, hence it satisfies both overloads and mypy performs a join of the return types. When you run with 3.11 the error disappears:\r\n\r\nhttps://mypy-play.net/?mypy=master&python=3.11&gist=339ba7f72c9048770ce15d6dc75207a1","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/python/mypy/issues/comments/2471265741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"randolf-scholz","id":39696536,"node_id":"MDQ6VXNlcjM5Njk2NTM2","avatar_url":"https://avatars.githubusercontent.com/u/39696536?v=4","gravatar_id":"","url":"https://api.github.com/users/randolf-scholz","html_url":"https://github.com/randolf-scholz","followers_url":"https://api.github.com/users/randolf-scholz/followers","following_url":"https://api.github.com/users/randolf-scholz/following{/other_user}","gists_url":"https://api.github.com/users/randolf-scholz/gists{/gist_id}","starred_url":"https://api.github.com/users/randolf-scholz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/randolf-scholz/subscriptions","organizations_url":"https://api.github.com/users/randolf-scholz/orgs","repos_url":"https://api.github.com/users/randolf-scholz/repos","events_url":"https://api.github.com/users/randolf-scholz/events{/privacy}","received_events_url":"https://api.github.com/users/randolf-scholz/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/python/mypy/issues/comments/2471312011","html_url":"https://github.com/python/mypy/issues/18149#issuecomment-2471312011","issue_url":"https://api.github.com/repos/python/mypy/issues/18149","id":2471312011,"node_id":"IC_kwDOAGuhRc6TTTqL","user":{"login":"randolf-scholz","id":39696536,"node_id":"MDQ6VXNlcjM5Njk2NTM2","avatar_url":"https://avatars.githubusercontent.com/u/39696536?v=4","gravatar_id":"","url":"https://api.github.com/users/randolf-scholz","html_url":"https://github.com/randolf-scholz","followers_url":"https://api.github.com/users/randolf-scholz/followers","following_url":"https://api.github.com/users/randolf-scholz/following{/other_user}","gists_url":"https://api.github.com/users/randolf-scholz/gists{/gist_id}","starred_url":"https://api.github.com/users/randolf-scholz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/randolf-scholz/subscriptions","organizations_url":"https://api.github.com/users/randolf-scholz/orgs","repos_url":"https://api.github.com/users/randolf-scholz/repos","events_url":"https://api.github.com/users/randolf-scholz/events{/privacy}","received_events_url":"https://api.github.com/users/randolf-scholz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-12T18:49:44Z","updated_at":"2024-11-12T18:54:24Z","body":"@AlexWaygood Uhh, I just discovered that it actually seems to be related to the bug #2410 we just encountered in typeshed as well, because when you use non-literal slices it also disappears!\r\n\r\n```python\r\nfrom typing import assert_type, overload, Hashable\r\n\r\nclass Foo: ...\r\n\r\nclass DataFrame:\r\n    @overload\r\n    def __getitem__(self, key: slice, /) -> \"DataFrame\": ...\r\n    @overload\r\n    def __getitem__(self, key: Hashable, /) -> Foo: ...\r\n\r\n\r\ndf = DataFrame()\r\nassert_type(df[1:], DataFrame)  # ❌\r\nassert_type(df[:2], DataFrame)  # ❌\r\nassert_type(df[slice(1, None)], DataFrame)  # ✅\r\nassert_type(df[slice(None, 2)], DataFrame)  # ✅\r\n```\r\n\r\nhttps://mypy-play.net/?mypy=master&python=3.12&gist=935d2927539dbe01d6727037ace98469\r\n\r\n\r\n----\r\n\r\nI was wondering about this because according to https://mypy.readthedocs.io/en/stable/more_types.html#type-checking-calls-to-overloads, no join operation should happen. I guess there is some legacy code responsible for dealing with literal slices in `__getitem__` that's going haywire?\r\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/python/mypy/issues/comments/2471312011/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":2,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"randolf-scholz","id":39696536,"node_id":"MDQ6VXNlcjM5Njk2NTM2","avatar_url":"https://avatars.githubusercontent.com/u/39696536?v=4","gravatar_id":"","url":"https://api.github.com/users/randolf-scholz","html_url":"https://github.com/randolf-scholz","followers_url":"https://api.github.com/users/randolf-scholz/followers","following_url":"https://api.github.com/users/randolf-scholz/following{/other_user}","gists_url":"https://api.github.com/users/randolf-scholz/gists{/gist_id}","starred_url":"https://api.github.com/users/randolf-scholz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/randolf-scholz/subscriptions","organizations_url":"https://api.github.com/users/randolf-scholz/orgs","repos_url":"https://api.github.com/users/randolf-scholz/repos","events_url":"https://api.github.com/users/randolf-scholz/events{/privacy}","received_events_url":"https://api.github.com/users/randolf-scholz/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":15269505248,"node_id":"MEE_lADOAGuhRc6eIRwSzwAAAAOOIijg","url":"https://api.github.com/repos/python/mypy/issues/events/15269505248","actor":{"login":"AlexWaygood","id":66076021,"node_id":"MDQ6VXNlcjY2MDc2MDIx","avatar_url":"https://avatars.githubusercontent.com/u/66076021?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexWaygood","html_url":"https://github.com/AlexWaygood","followers_url":"https://api.github.com/users/AlexWaygood/followers","following_url":"https://api.github.com/users/AlexWaygood/following{/other_user}","gists_url":"https://api.github.com/users/AlexWaygood/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexWaygood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexWaygood/subscriptions","organizations_url":"https://api.github.com/users/AlexWaygood/orgs","repos_url":"https://api.github.com/users/AlexWaygood/repos","events_url":"https://api.github.com/users/AlexWaygood/events{/privacy}","received_events_url":"https://api.github.com/users/AlexWaygood/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-11-12T18:49:46Z","performed_via_github_app":null},{"id":15269505260,"node_id":"SE_lADOAGuhRc6eIRwSzwAAAAOOIijs","url":"https://api.github.com/repos/python/mypy/issues/events/15269505260","actor":{"login":"AlexWaygood","id":66076021,"node_id":"MDQ6VXNlcjY2MDc2MDIx","avatar_url":"https://avatars.githubusercontent.com/u/66076021?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexWaygood","html_url":"https://github.com/AlexWaygood","followers_url":"https://api.github.com/users/AlexWaygood/followers","following_url":"https://api.github.com/users/AlexWaygood/following{/other_user}","gists_url":"https://api.github.com/users/AlexWaygood/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexWaygood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexWaygood/subscriptions","organizations_url":"https://api.github.com/users/AlexWaygood/orgs","repos_url":"https://api.github.com/users/AlexWaygood/repos","events_url":"https://api.github.com/users/AlexWaygood/events{/privacy}","received_events_url":"https://api.github.com/users/AlexWaygood/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-11-12T18:49:46Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/python/mypy/issues/comments/2471379772","html_url":"https://github.com/python/mypy/issues/18149#issuecomment-2471379772","issue_url":"https://api.github.com/repos/python/mypy/issues/18149","id":2471379772,"node_id":"IC_kwDOAGuhRc6TTkM8","user":{"login":"brianschubert","id":25313350,"node_id":"MDQ6VXNlcjI1MzEzMzUw","avatar_url":"https://avatars.githubusercontent.com/u/25313350?v=4","gravatar_id":"","url":"https://api.github.com/users/brianschubert","html_url":"https://github.com/brianschubert","followers_url":"https://api.github.com/users/brianschubert/followers","following_url":"https://api.github.com/users/brianschubert/following{/other_user}","gists_url":"https://api.github.com/users/brianschubert/gists{/gist_id}","starred_url":"https://api.github.com/users/brianschubert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brianschubert/subscriptions","organizations_url":"https://api.github.com/users/brianschubert/orgs","repos_url":"https://api.github.com/users/brianschubert/repos","events_url":"https://api.github.com/users/brianschubert/events{/privacy}","received_events_url":"https://api.github.com/users/brianschubert/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-12T19:26:22Z","updated_at":"2024-11-12T19:51:05Z","body":"> I guess there is some legacy code responsible for dealing with literal slices in `__getitem__` that's going haywire?\r\n\r\n~Indeed, this is actually hardcoded into the expression checker:~ Nevermind, I had my wires crossed about what this issue was about, sorry for the noise!\r\n\r\n[https://github.com/python/mypy/blob/2ebc690279c7e20ed8bec006787030c5ba57c40e/mypy/checkexpr.py#L5609-L5619.](https://github.com/python/mypy/blob/2ebc690279c7e20ed8bec006787030c5ba57c40e/mypy/checkexpr.py#L5609-L5619)","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/python/mypy/issues/comments/2471379772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"brianschubert","id":25313350,"node_id":"MDQ6VXNlcjI1MzEzMzUw","avatar_url":"https://avatars.githubusercontent.com/u/25313350?v=4","gravatar_id":"","url":"https://api.github.com/users/brianschubert","html_url":"https://github.com/brianschubert","followers_url":"https://api.github.com/users/brianschubert/followers","following_url":"https://api.github.com/users/brianschubert/following{/other_user}","gists_url":"https://api.github.com/users/brianschubert/gists{/gist_id}","starred_url":"https://api.github.com/users/brianschubert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brianschubert/subscriptions","organizations_url":"https://api.github.com/users/brianschubert/orgs","repos_url":"https://api.github.com/users/brianschubert/repos","events_url":"https://api.github.com/users/brianschubert/events{/privacy}","received_events_url":"https://api.github.com/users/brianschubert/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/python/mypy/issues/comments/2471468490","html_url":"https://github.com/python/mypy/issues/18149#issuecomment-2471468490","issue_url":"https://api.github.com/repos/python/mypy/issues/18149","id":2471468490,"node_id":"IC_kwDOAGuhRc6TT53K","user":{"login":"brianschubert","id":25313350,"node_id":"MDQ6VXNlcjI1MzEzMzUw","avatar_url":"https://avatars.githubusercontent.com/u/25313350?v=4","gravatar_id":"","url":"https://api.github.com/users/brianschubert","html_url":"https://github.com/brianschubert","followers_url":"https://api.github.com/users/brianschubert/followers","following_url":"https://api.github.com/users/brianschubert/following{/other_user}","gists_url":"https://api.github.com/users/brianschubert/gists{/gist_id}","starred_url":"https://api.github.com/users/brianschubert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brianschubert/subscriptions","organizations_url":"https://api.github.com/users/brianschubert/orgs","repos_url":"https://api.github.com/users/brianschubert/repos","events_url":"https://api.github.com/users/brianschubert/events{/privacy}","received_events_url":"https://api.github.com/users/brianschubert/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-12T20:05:08Z","updated_at":"2024-11-13T13:30:08Z","body":"Actually, my previous comment wasn't as far from the mark as I thought :laughing: \r\n\r\nThe difference between slice expressions and non-literal slices does come down to the hardcoded analysis in the expression checker, specifically the return:\r\n\r\nhttps://github.com/python/mypy/blob/2ebc690279c7e20ed8bec006787030c5ba57c40e/mypy/checkexpr.py#L5619\r\n\r\nThis erases any type information and makes all slice expressions be treated as `slice[Any, Any, Any]`. Manually passing a slice of type `slice[Any, Any, Any]` indeed has the same behavior:\r\n```python\r\ndf = DataFrame()\r\nx: slice[Any, Any, Any]\r\nassert_type(df[x], DataFrame)  # E: Expression is of type \"Any\", not \"DataFrame\"\r\n```\r\nI'm not fully sure why passing `slice[Any, Any, Any]` causes the overload return type to resolve to `Any`, but I think it may have to do with the way [`infer_overload_return_type`](https://github.com/python/mypy/blob/2ebc690279c7e20ed8bec006787030c5ba57c40e/mypy/checkexpr.py#L2838) resolves ambiguous overloads, specifically now that this check will resolve to True:\r\nhttps://github.com/python/mypy/blob/2ebc690279c7e20ed8bec006787030c5ba57c40e/mypy/checkexpr.py#L2862\r\nso this branch can no longer be taken:\r\nhttps://github.com/python/mypy/blob/2ebc690279c7e20ed8bec006787030c5ba57c40e/mypy/checkexpr.py#L2882-L2884\r\n\r\nI think the fix would be to just properly infer the generic type arguments for slice expressions. Naively that could look something like the following, though we'd probably want to make it match the behavior of `slice.__new__` in typeshed.\r\n```diff\r\n--- a/mypy/checkexpr.py\r\n+++ b/mypy/checkexpr.py\r\n@@ -5612,11 +5612,15 @@ class ExpressionChecker(ExpressionVisitor[Type]):\r\n         except KeyError:\r\n             supports_index = self.chk.named_type(\"builtins.int\")  # thanks, fixture life\r\n         expected = make_optional_type(supports_index)\r\n+        type_args = []\r\n         for index in [e.begin_index, e.end_index, e.stride]:\r\n             if index:\r\n                 t = self.accept(index)\r\n                 self.chk.check_subtype(t, expected, index, message_registry.INVALID_SLICE_INDEX)\r\n-        return self.named_type(\"builtins.slice\")\r\n+                type_args.append(t)\r\n+            else:\r\n+                type_args.append(NoneType())\r\n+        return self.chk.named_generic_type(\"builtins.slice\", type_args)\r\n```","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/python/mypy/issues/comments/2471468490/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null,"event":"commented","actor":{"login":"brianschubert","id":25313350,"node_id":"MDQ6VXNlcjI1MzEzMzUw","avatar_url":"https://avatars.githubusercontent.com/u/25313350?v=4","gravatar_id":"","url":"https://api.github.com/users/brianschubert","html_url":"https://github.com/brianschubert","followers_url":"https://api.github.com/users/brianschubert/followers","following_url":"https://api.github.com/users/brianschubert/following{/other_user}","gists_url":"https://api.github.com/users/brianschubert/gists{/gist_id}","starred_url":"https://api.github.com/users/brianschubert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brianschubert/subscriptions","organizations_url":"https://api.github.com/users/brianschubert/orgs","repos_url":"https://api.github.com/users/brianschubert/repos","events_url":"https://api.github.com/users/brianschubert/events{/privacy}","received_events_url":"https://api.github.com/users/brianschubert/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"brianschubert","id":25313350,"node_id":"MDQ6VXNlcjI1MzEzMzUw","avatar_url":"https://avatars.githubusercontent.com/u/25313350?v=4","gravatar_id":"","url":"https://api.github.com/users/brianschubert","html_url":"https://github.com/brianschubert","followers_url":"https://api.github.com/users/brianschubert/followers","following_url":"https://api.github.com/users/brianschubert/following{/other_user}","gists_url":"https://api.github.com/users/brianschubert/gists{/gist_id}","starred_url":"https://api.github.com/users/brianschubert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brianschubert/subscriptions","organizations_url":"https://api.github.com/users/brianschubert/orgs","repos_url":"https://api.github.com/users/brianschubert/repos","events_url":"https://api.github.com/users/brianschubert/events{/privacy}","received_events_url":"https://api.github.com/users/brianschubert/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-11-18T00:18:10Z","updated_at":"2024-11-18T00:18:10Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/python/mypy/issues/18160","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/18160/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/18160/comments","events_url":"https://api.github.com/repos/python/mypy/issues/18160/events","html_url":"https://github.com/python/mypy/pull/18160","id":2666765090,"node_id":"PR_kwDOAGuhRc6CLQ_o","number":18160,"title":"Infer generic type arguments for slice expressions","user":{"login":"brianschubert","id":25313350,"node_id":"MDQ6VXNlcjI1MzEzMzUw","avatar_url":"https://avatars.githubusercontent.com/u/25313350?v=4","gravatar_id":"","url":"https://api.github.com/users/brianschubert","html_url":"https://github.com/brianschubert","followers_url":"https://api.github.com/users/brianschubert/followers","following_url":"https://api.github.com/users/brianschubert/following{/other_user}","gists_url":"https://api.github.com/users/brianschubert/gists{/gist_id}","starred_url":"https://api.github.com/users/brianschubert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brianschubert/subscriptions","organizations_url":"https://api.github.com/users/brianschubert/orgs","repos_url":"https://api.github.com/users/brianschubert/repos","events_url":"https://api.github.com/users/brianschubert/events{/privacy}","received_events_url":"https://api.github.com/users/brianschubert/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2024-11-18T00:18:09Z","updated_at":"2024-11-19T08:26:02Z","closed_at":"2024-11-19T08:26:02Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":7053637,"node_id":"MDEwOlJlcG9zaXRvcnk3MDUzNjM3","name":"mypy","full_name":"python/mypy","private":false,"owner":{"login":"python","id":1525981,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE1MjU5ODE=","avatar_url":"https://avatars.githubusercontent.com/u/1525981?v=4","gravatar_id":"","url":"https://api.github.com/users/python","html_url":"https://github.com/python","followers_url":"https://api.github.com/users/python/followers","following_url":"https://api.github.com/users/python/following{/other_user}","gists_url":"https://api.github.com/users/python/gists{/gist_id}","starred_url":"https://api.github.com/users/python/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/python/subscriptions","organizations_url":"https://api.github.com/users/python/orgs","repos_url":"https://api.github.com/users/python/repos","events_url":"https://api.github.com/users/python/events{/privacy}","received_events_url":"https://api.github.com/users/python/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/python/mypy","description":"Optional static typing for Python","fork":false,"url":"https://api.github.com/repos/python/mypy","forks_url":"https://api.github.com/repos/python/mypy/forks","keys_url":"https://api.github.com/repos/python/mypy/keys{/key_id}","collaborators_url":"https://api.github.com/repos/python/mypy/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/python/mypy/teams","hooks_url":"https://api.github.com/repos/python/mypy/hooks","issue_events_url":"https://api.github.com/repos/python/mypy/issues/events{/number}","events_url":"https://api.github.com/repos/python/mypy/events","assignees_url":"https://api.github.com/repos/python/mypy/assignees{/user}","branches_url":"https://api.github.com/repos/python/mypy/branches{/branch}","tags_url":"https://api.github.com/repos/python/mypy/tags","blobs_url":"https://api.github.com/repos/python/mypy/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/python/mypy/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/python/mypy/git/refs{/sha}","trees_url":"https://api.github.com/repos/python/mypy/git/trees{/sha}","statuses_url":"https://api.github.com/repos/python/mypy/statuses/{sha}","languages_url":"https://api.github.com/repos/python/mypy/languages","stargazers_url":"https://api.github.com/repos/python/mypy/stargazers","contributors_url":"https://api.github.com/repos/python/mypy/contributors","subscribers_url":"https://api.github.com/repos/python/mypy/subscribers","subscription_url":"https://api.github.com/repos/python/mypy/subscription","commits_url":"https://api.github.com/repos/python/mypy/commits{/sha}","git_commits_url":"https://api.github.com/repos/python/mypy/git/commits{/sha}","comments_url":"https://api.github.com/repos/python/mypy/comments{/number}","issue_comment_url":"https://api.github.com/repos/python/mypy/issues/comments{/number}","contents_url":"https://api.github.com/repos/python/mypy/contents/{+path}","compare_url":"https://api.github.com/repos/python/mypy/compare/{base}...{head}","merges_url":"https://api.github.com/repos/python/mypy/merges","archive_url":"https://api.github.com/repos/python/mypy/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/python/mypy/downloads","issues_url":"https://api.github.com/repos/python/mypy/issues{/number}","pulls_url":"https://api.github.com/repos/python/mypy/pulls{/number}","milestones_url":"https://api.github.com/repos/python/mypy/milestones{/number}","notifications_url":"https://api.github.com/repos/python/mypy/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/python/mypy/labels{/name}","releases_url":"https://api.github.com/repos/python/mypy/releases{/id}","deployments_url":"https://api.github.com/repos/python/mypy/deployments","created_at":"2012-12-07T13:30:23Z","updated_at":"2025-11-09T16:41:25Z","pushed_at":"2025-11-08T23:13:28Z","git_url":"git://github.com/python/mypy.git","ssh_url":"git@github.com:python/mypy.git","clone_url":"https://github.com/python/mypy.git","svn_url":"https://github.com/python/mypy","homepage":"https://www.mypy-lang.org/","size":76085,"stargazers_count":19971,"watchers_count":19971,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":3042,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":3097,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["linter","python","typechecker","types","typing"],"visibility":"public","forks":3042,"open_issues":3097,"watchers":19971,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/python/mypy/pulls/18160","html_url":"https://github.com/python/mypy/pull/18160","diff_url":"https://github.com/python/mypy/pull/18160.diff","patch_url":"https://github.com/python/mypy/pull/18160.patch","merged_at":"2024-11-19T08:26:02Z"},"body":"Fixes  #18149\r\n\r\nSlices were made generic in https://github.com/python/typeshed/pull/11637. Currently, all slice expressions are inferred to have type `slice[Any, Any, Any]`. This PR fills in the generic type arguments more appropriately using start/stop/stride expression types.\r\n\r\nGiven\r\n```python\r\nclass Foo:\r\n    def __getitem__[T](self, item: T) -> T: return item\r\n\r\nx = Foo()\r\nreveal_type(x[1:])\r\n```\r\nBefore:\r\n```none\r\nmain.py:5: note: Revealed type is \"builtins.slice[Any, Any, Any]\"\r\n```\r\nAfter:\r\n```none\r\nmain.py:5: note: Revealed type is \"builtins.slice[builtins.int, None, None]\"\r\n```","reactions":{"url":"https://api.github.com/repos/python/mypy/issues/18160/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/mypy/issues/18160/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":15345589564,"node_id":"CE_lADOAGuhRc6eIRwSzwAAAAOSqx08","url":"https://api.github.com/repos/python/mypy/issues/events/15345589564","actor":{"login":"hauntsaninja","id":12621235,"node_id":"MDQ6VXNlcjEyNjIxMjM1","avatar_url":"https://avatars.githubusercontent.com/u/12621235?v=4","gravatar_id":"","url":"https://api.github.com/users/hauntsaninja","html_url":"https://github.com/hauntsaninja","followers_url":"https://api.github.com/users/hauntsaninja/followers","following_url":"https://api.github.com/users/hauntsaninja/following{/other_user}","gists_url":"https://api.github.com/users/hauntsaninja/gists{/gist_id}","starred_url":"https://api.github.com/users/hauntsaninja/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hauntsaninja/subscriptions","organizations_url":"https://api.github.com/users/hauntsaninja/orgs","repos_url":"https://api.github.com/users/hauntsaninja/repos","events_url":"https://api.github.com/users/hauntsaninja/events{/privacy}","received_events_url":"https://api.github.com/users/hauntsaninja/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2024-11-19T08:26:03Z","state_reason":null,"performed_via_github_app":null},{"id":15345589626,"node_id":"CE_lADOAGuhRc6eIRwSzwAAAAOSqx16","url":"https://api.github.com/repos/python/mypy/issues/events/15345589626","actor":{"login":"hauntsaninja","id":12621235,"node_id":"MDQ6VXNlcjEyNjIxMjM1","avatar_url":"https://avatars.githubusercontent.com/u/12621235?v=4","gravatar_id":"","url":"https://api.github.com/users/hauntsaninja","html_url":"https://github.com/hauntsaninja","followers_url":"https://api.github.com/users/hauntsaninja/followers","following_url":"https://api.github.com/users/hauntsaninja/following{/other_user}","gists_url":"https://api.github.com/users/hauntsaninja/gists{/gist_id}","starred_url":"https://api.github.com/users/hauntsaninja/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hauntsaninja/subscriptions","organizations_url":"https://api.github.com/users/hauntsaninja/orgs","repos_url":"https://api.github.com/users/hauntsaninja/repos","events_url":"https://api.github.com/users/hauntsaninja/events{/privacy}","received_events_url":"https://api.github.com/users/hauntsaninja/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"6759dbd5bbcca4501748dc52d93d5a50060a825a","commit_url":"https://api.github.com/repos/python/mypy/commits/6759dbd5bbcca4501748dc52d93d5a50060a825a","created_at":"2024-11-19T08:26:03Z","state_reason":null,"performed_via_github_app":null},{"id":15353592369,"node_id":"REFE_lADOAGuhRc6eIRwSzwAAAAOTJTox","url":"https://api.github.com/repos/python/mypy/issues/events/15353592369","actor":{"login":"dabreadman","id":43485369,"node_id":"MDQ6VXNlcjQzNDg1MzY5","avatar_url":"https://avatars.githubusercontent.com/u/43485369?v=4","gravatar_id":"","url":"https://api.github.com/users/dabreadman","html_url":"https://github.com/dabreadman","followers_url":"https://api.github.com/users/dabreadman/followers","following_url":"https://api.github.com/users/dabreadman/following{/other_user}","gists_url":"https://api.github.com/users/dabreadman/gists{/gist_id}","starred_url":"https://api.github.com/users/dabreadman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dabreadman/subscriptions","organizations_url":"https://api.github.com/users/dabreadman/orgs","repos_url":"https://api.github.com/users/dabreadman/repos","events_url":"https://api.github.com/users/dabreadman/events{/privacy}","received_events_url":"https://api.github.com/users/dabreadman/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"6759dbd5bbcca4501748dc52d93d5a50060a825a","commit_url":"https://api.github.com/repos/THIS-IS-NOT-A-BACKUP/mypy/commits/6759dbd5bbcca4501748dc52d93d5a50060a825a","created_at":"2024-11-19T18:15:34Z","performed_via_github_app":null},{"actor":{"login":"Dr-Irv","id":15113894,"node_id":"MDQ6VXNlcjE1MTEzODk0","avatar_url":"https://avatars.githubusercontent.com/u/15113894?v=4","gravatar_id":"","url":"https://api.github.com/users/Dr-Irv","html_url":"https://github.com/Dr-Irv","followers_url":"https://api.github.com/users/Dr-Irv/followers","following_url":"https://api.github.com/users/Dr-Irv/following{/other_user}","gists_url":"https://api.github.com/users/Dr-Irv/gists{/gist_id}","starred_url":"https://api.github.com/users/Dr-Irv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Dr-Irv/subscriptions","organizations_url":"https://api.github.com/users/Dr-Irv/orgs","repos_url":"https://api.github.com/users/Dr-Irv/repos","events_url":"https://api.github.com/users/Dr-Irv/events{/privacy}","received_events_url":"https://api.github.com/users/Dr-Irv/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-01T18:16:57Z","updated_at":"2024-12-01T18:16:57Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/python/mypy/issues/18225","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/18225/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/18225/comments","events_url":"https://api.github.com/repos/python/mypy/issues/18225/events","html_url":"https://github.com/python/mypy/issues/18225","id":2709604930,"node_id":"I_kwDOAGuhRc6hgUpC","number":18225,"title":"slice behavior difference in mypy 1.14+dev and 1.13","user":{"login":"Dr-Irv","id":15113894,"node_id":"MDQ6VXNlcjE1MTEzODk0","avatar_url":"https://avatars.githubusercontent.com/u/15113894?v=4","gravatar_id":"","url":"https://api.github.com/users/Dr-Irv","html_url":"https://github.com/Dr-Irv","followers_url":"https://api.github.com/users/Dr-Irv/followers","following_url":"https://api.github.com/users/Dr-Irv/following{/other_user}","gists_url":"https://api.github.com/users/Dr-Irv/gists{/gist_id}","starred_url":"https://api.github.com/users/Dr-Irv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Dr-Irv/subscriptions","organizations_url":"https://api.github.com/users/Dr-Irv/orgs","repos_url":"https://api.github.com/users/Dr-Irv/repos","events_url":"https://api.github.com/users/Dr-Irv/events{/privacy}","received_events_url":"https://api.github.com/users/Dr-Irv/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":21488356,"node_id":"MDU6TGFiZWwyMTQ4ODM1Ng==","url":"https://api.github.com/repos/python/mypy/labels/bug","name":"bug","color":"f9d0c4","default":true,"description":"mypy got something wrong"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":13,"created_at":"2024-12-01T18:16:56Z","updated_at":"2024-12-02T20:17:00Z","closed_at":"2024-12-02T20:16:59Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":7053637,"node_id":"MDEwOlJlcG9zaXRvcnk3MDUzNjM3","name":"mypy","full_name":"python/mypy","private":false,"owner":{"login":"python","id":1525981,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE1MjU5ODE=","avatar_url":"https://avatars.githubusercontent.com/u/1525981?v=4","gravatar_id":"","url":"https://api.github.com/users/python","html_url":"https://github.com/python","followers_url":"https://api.github.com/users/python/followers","following_url":"https://api.github.com/users/python/following{/other_user}","gists_url":"https://api.github.com/users/python/gists{/gist_id}","starred_url":"https://api.github.com/users/python/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/python/subscriptions","organizations_url":"https://api.github.com/users/python/orgs","repos_url":"https://api.github.com/users/python/repos","events_url":"https://api.github.com/users/python/events{/privacy}","received_events_url":"https://api.github.com/users/python/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/python/mypy","description":"Optional static typing for Python","fork":false,"url":"https://api.github.com/repos/python/mypy","forks_url":"https://api.github.com/repos/python/mypy/forks","keys_url":"https://api.github.com/repos/python/mypy/keys{/key_id}","collaborators_url":"https://api.github.com/repos/python/mypy/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/python/mypy/teams","hooks_url":"https://api.github.com/repos/python/mypy/hooks","issue_events_url":"https://api.github.com/repos/python/mypy/issues/events{/number}","events_url":"https://api.github.com/repos/python/mypy/events","assignees_url":"https://api.github.com/repos/python/mypy/assignees{/user}","branches_url":"https://api.github.com/repos/python/mypy/branches{/branch}","tags_url":"https://api.github.com/repos/python/mypy/tags","blobs_url":"https://api.github.com/repos/python/mypy/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/python/mypy/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/python/mypy/git/refs{/sha}","trees_url":"https://api.github.com/repos/python/mypy/git/trees{/sha}","statuses_url":"https://api.github.com/repos/python/mypy/statuses/{sha}","languages_url":"https://api.github.com/repos/python/mypy/languages","stargazers_url":"https://api.github.com/repos/python/mypy/stargazers","contributors_url":"https://api.github.com/repos/python/mypy/contributors","subscribers_url":"https://api.github.com/repos/python/mypy/subscribers","subscription_url":"https://api.github.com/repos/python/mypy/subscription","commits_url":"https://api.github.com/repos/python/mypy/commits{/sha}","git_commits_url":"https://api.github.com/repos/python/mypy/git/commits{/sha}","comments_url":"https://api.github.com/repos/python/mypy/comments{/number}","issue_comment_url":"https://api.github.com/repos/python/mypy/issues/comments{/number}","contents_url":"https://api.github.com/repos/python/mypy/contents/{+path}","compare_url":"https://api.github.com/repos/python/mypy/compare/{base}...{head}","merges_url":"https://api.github.com/repos/python/mypy/merges","archive_url":"https://api.github.com/repos/python/mypy/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/python/mypy/downloads","issues_url":"https://api.github.com/repos/python/mypy/issues{/number}","pulls_url":"https://api.github.com/repos/python/mypy/pulls{/number}","milestones_url":"https://api.github.com/repos/python/mypy/milestones{/number}","notifications_url":"https://api.github.com/repos/python/mypy/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/python/mypy/labels{/name}","releases_url":"https://api.github.com/repos/python/mypy/releases{/id}","deployments_url":"https://api.github.com/repos/python/mypy/deployments","created_at":"2012-12-07T13:30:23Z","updated_at":"2025-11-09T16:41:25Z","pushed_at":"2025-11-08T23:13:28Z","git_url":"git://github.com/python/mypy.git","ssh_url":"git@github.com:python/mypy.git","clone_url":"https://github.com/python/mypy.git","svn_url":"https://github.com/python/mypy","homepage":"https://www.mypy-lang.org/","size":76085,"stargazers_count":19971,"watchers_count":19971,"language":"Python","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":3042,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":3097,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["linter","python","typechecker","types","typing"],"visibility":"public","forks":3042,"open_issues":3097,"watchers":19971,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"We test `pandas-stubs` with the nightly version of mypy.  It reveals an issue with how a method that returns `slice` is annotated.  With `pandas-stubs`, we get an error like this with the development version of `mypy`:\r\n\r\n```text\r\ntests/test_frame.py:2401: error: Expression is of type \"tuple[Index[int], slice[None, None, None]]\", not \"tuple[Index[int], slice[Any, Any, Any]]\"  [assert-type]\r\n```\r\n\r\nIn this case, the `assert_type()` call of `assert_type(pd.IndexSlice[ind, :], tuple[\"pd.Index[int]\", slice])` works with mypy 1.13, fails with the 1.14 dev version.\r\n\r\nThis is due to a change in `typeshed` where `slice` has become generic.  I think that change in `typeshed` is bundled with the 1.14+dev version of mypy, not the released version 1.13.\r\n\r\nA simpler example is below.  Not sure if this is a `mypy` or a `typeshed` issue.\r\n\r\n**Bug Report**\r\n\r\nmypy 1.14+dev infers a different value for `slice` than 1.13\r\n\r\n**To Reproduce**\r\nRequires 2 files.\r\n\r\nFirst, there is `retslice.pyi`:\r\n```python\r\nfrom typing import TypeAlias, TypeVar\r\n\r\nclass Index:\r\n    ...\r\n\r\n_IndexSliceTuple: TypeAlias = tuple[\r\n    Index | int | float | str | slice , ...\r\n]\r\n\r\n_IndexSliceUnion: TypeAlias = slice | _IndexSliceTuple\r\n\r\n_IndexSliceUnionT = TypeVar(\"_IndexSliceUnionT\", bound=_IndexSliceUnion)\r\n\r\nclass _IndexSlice:\r\n    def __getitem__(self, arg: _IndexSliceUnionT) -> _IndexSliceUnionT: ...\r\n\r\nIndexSlice: _IndexSlice\r\n```\r\n\r\nThen there is `mypyslice.py` :\r\n```python\r\nfrom typing import assert_type\r\nfrom retslice import IndexSlice, Index\r\n\r\nfoo = IndexSlice[Index(), :]\r\nassert_type(foo, tuple[Index, slice])\r\n```\r\n\r\n**Expected Behavior**\r\n\r\nNo errors reported by mypy 1.14+dev\r\n\r\n**Actual Behavior**\r\n\r\n```text\r\nmypyslice.py:5: error: Expression is of type \"tuple[Index, slice[None, None, None]]\", not \"tuple[Index, slice[Any, Any, Any]]\"  [assert-type]\r\n```\r\n\r\n**Your Environment**\r\n\r\n- Mypy version used:  v1.14.0%2Bdev.9405bfd9205ea369c11150907764fa46c03cb1f7\r\n- Mypy command-line flags:  None\r\n- Mypy configuration options from `mypy.ini` (and other config files):  None\r\n- Python version used:  3.13\r\n\r\nMay be related to #18149 ","reactions":{"url":"https://api.github.com/repos/python/mypy/issues/18225/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/mypy/issues/18225/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"}]