{"url":"https://api.github.com/repos/python/mypy/issues/20059","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/20059/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/20059/comments","events_url":"https://api.github.com/repos/python/mypy/issues/20059/events","html_url":"https://github.com/python/mypy/issues/20059","id":3512531440,"node_id":"I_kwDOAGuhRc7RXPnw","number":20059,"title":"Complex paraspec handling cause Internal error (IndexError: list index out of range) at `check_override`","user":{"login":"Taiquan-Liu","id":91654980,"node_id":"U_kgDOBXaLRA","avatar_url":"https://avatars.githubusercontent.com/u/91654980?v=4","gravatar_id":"","url":"https://api.github.com/users/Taiquan-Liu","html_url":"https://github.com/Taiquan-Liu","followers_url":"https://api.github.com/users/Taiquan-Liu/followers","following_url":"https://api.github.com/users/Taiquan-Liu/following{/other_user}","gists_url":"https://api.github.com/users/Taiquan-Liu/gists{/gist_id}","starred_url":"https://api.github.com/users/Taiquan-Liu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Taiquan-Liu/subscriptions","organizations_url":"https://api.github.com/users/Taiquan-Liu/orgs","repos_url":"https://api.github.com/users/Taiquan-Liu/repos","events_url":"https://api.github.com/users/Taiquan-Liu/events{/privacy}","received_events_url":"https://api.github.com/users/Taiquan-Liu/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":379446833,"node_id":"MDU6TGFiZWwzNzk0NDY4MzM=","url":"https://api.github.com/repos/python/mypy/labels/crash","name":"crash","color":"b60205","default":false,"description":null},{"id":3945137363,"node_id":"LA_kwDOAGuhRc7rJgTT","url":"https://api.github.com/repos/python/mypy/labels/topic-inheritance","name":"topic-inheritance","color":"63CF11","default":false,"description":"Inheritance and incompatible overrides"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2025-10-14T06:23:18Z","updated_at":"2025-11-08T23:13:29Z","closed_at":"2025-11-08T23:13:29Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\n  Use this form only if mypy reports an \"INTERNAL ERROR\" and/or gives a traceback.\n  Please include the traceback and all other messages below (use `mypy --show-traceback`).\n-->\n\n**Crash Report**\n\n\n\n**Traceback**\n\n```python-traceback\n# mypy --show-traceback app/utils/testing/test_client.py\napp/utils/testing/test_client.py:24: error: INTERNAL ERROR -- Please try using mypy master on GitHub:\nhttps://mypy.readthedocs.io/en/stable/common_issues.html#using-a-development-mypy-build\nPlease report a bug at https://github.com/python/mypy/issues\nversion: 1.18.2\nTraceback (most recent call last):\n  File \"mypy/checker.py\", line 641, in accept\n  File \"mypy/nodes.py\", line 1122, in accept\n  File \"mypy/checker.py\", line 5414, in visit_decorator\n  File \"mypy/checker.py\", line 5470, in visit_decorator_inner\n  File \"mypy/checker.py\", line 2208, in check_method_override\n  File \"mypy/checker.py\", line 2246, in check_method_or_accessor_override_for_base\n  File \"mypy/checker.py\", line 2388, in check_method_override_for_base_with_name\n  File \"mypy/checker.py\", line 2579, in check_override\nIndexError: list index out of range\napp/utils/testing/test_client.py:24: : note: use --pdb to drop into pdb\n```\n\n**To Reproduce**\n\nWe have a helper decorator like this:\n```Python\ndef infer_signature(f: Callable[P, R]) -> Callable[[InferredFunction], Callable[P, R]]:\n    \"\"\"\n    When overriding a method from a base class it's sometimes not practical to copy\n    its full signature to the subclass â€” especially in cases where the overriding method\n    doesn't rely on the actual signature. It would be very inconvenient to update the\n    overriding method signature every time the overriden method is updated.\n\n    This decorator helps with being able to use `*args, **kwargs` as the signature but\n    still being able to use IDE code completion for the overriden method.\n\n    Example:\n    >>> class BaseClass:\n    >>>     def method(self, very: int, long: str, signature: float):\n    >>>         ...\n    >>>\n    >>> class Subclass(BaseClass):\n    >>>     @infer_signature(BaseClass.method)\n    >>>     def method(self, *args, **kwargs):  # type: ignore[no-untyped-def]\n    >>>         print(args, kwargs)\n    >>>         return super(*args, **kwargs)\n    \"\"\"\n    return lambda _: _  # type: ignore[return-value]\n```\nwhich is used like this\n```Python\nfrom starlette.testclient import TestClient\nfrom app.utils.typing import infer_signature\n\nclass CustomTestClient(TestClient):\n    @infer_signature(TestClient.get)\n    def get(self, *args, **kwargs):  # type: ignore[no-untyped-def]\n        kwargs.pop(\"json\", None)\n        kwargs.pop(\"data\", None)\n        return super().get(*args, **kwargs)\n\n    @infer_signature(TestClient.delete)\n    def delete(self, *args, **kwargs):  # type: ignore[no-untyped-def]\n        kwargs.pop(\"json\", None)\n        kwargs.pop(\"data\", None)\n        return super().delete(*args, **kwargs)\n```\nAnd the mypy error happens in the latter example.\n\n**Your Environment**\n\n<!-- Include as many relevant details about the environment you experienced the bug in -->\n\n- Mypy version used: 1.18.2\n- Mypy command-line flags:\n- Mypy configuration options from `mypy.ini` (and other config files):\n```\n[mypy]\nplugins = pydantic.mypy, sqlalchemy.ext.mypy.plugin\ndisallow_any_generics = True\ndisallow_any_unimported = False\ndisallow_subclassing_any = True\ndisallow_untyped_calls = True\ndisallow_untyped_defs = True\ndisallow_incomplete_defs = True\ncheck_untyped_defs = True\ndisallow_untyped_decorators = True\nno_implicit_optional = True\nwarn_redundant_casts = True\nwarn_unused_ignores = True\nimplicit_reexport = True\nstrict_equality = True\nshow_error_codes = True\n```\n- Python version used: 3.13.8\n- Operating system and version:\n```\nPRETTY_NAME=\"Debian GNU/Linux 12 (bookworm)\"\nNAME=\"Debian GNU/Linux\"\nVERSION_ID=\"12\"\nVERSION=\"12 (bookworm)\"\nVERSION_CODENAME=bookworm\nID=debian\nHOME_URL=\"https://www.debian.org/\"\nSUPPORT_URL=\"https://www.debian.org/support\"\nBUG_REPORT_URL=\"https://bugs.debian.org/\"\n```\n\n","closed_by":{"login":"ilevkivskyi","id":12005495,"node_id":"MDQ6VXNlcjEyMDA1NDk1","avatar_url":"https://avatars.githubusercontent.com/u/12005495?v=4","gravatar_id":"","url":"https://api.github.com/users/ilevkivskyi","html_url":"https://github.com/ilevkivskyi","followers_url":"https://api.github.com/users/ilevkivskyi/followers","following_url":"https://api.github.com/users/ilevkivskyi/following{/other_user}","gists_url":"https://api.github.com/users/ilevkivskyi/gists{/gist_id}","starred_url":"https://api.github.com/users/ilevkivskyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilevkivskyi/subscriptions","organizations_url":"https://api.github.com/users/ilevkivskyi/orgs","repos_url":"https://api.github.com/users/ilevkivskyi/repos","events_url":"https://api.github.com/users/ilevkivskyi/events{/privacy}","received_events_url":"https://api.github.com/users/ilevkivskyi/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python/mypy/issues/20059/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/mypy/issues/20059/timeline","performed_via_github_app":null,"state_reason":"completed"}