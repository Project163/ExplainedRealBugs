{"url":"https://api.github.com/repos/python/mypy/issues/14783","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/14783/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/14783/comments","events_url":"https://api.github.com/repos/python/mypy/issues/14783/events","html_url":"https://github.com/python/mypy/issues/14783","id":1599994139,"node_id":"I_kwDOAGuhRc5fXfkb","number":14783,"title":"Crash on a project using lots of generics","user":{"login":"magwas","id":756838,"node_id":"MDQ6VXNlcjc1NjgzOA==","avatar_url":"https://avatars.githubusercontent.com/u/756838?v=4","gravatar_id":"","url":"https://api.github.com/users/magwas","html_url":"https://github.com/magwas","followers_url":"https://api.github.com/users/magwas/followers","following_url":"https://api.github.com/users/magwas/following{/other_user}","gists_url":"https://api.github.com/users/magwas/gists{/gist_id}","starred_url":"https://api.github.com/users/magwas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/magwas/subscriptions","organizations_url":"https://api.github.com/users/magwas/orgs","repos_url":"https://api.github.com/users/magwas/repos","events_url":"https://api.github.com/users/magwas/events{/privacy}","received_events_url":"https://api.github.com/users/magwas/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":379446833,"node_id":"MDU6TGFiZWwzNzk0NDY4MzM=","url":"https://api.github.com/repos/python/mypy/labels/crash","name":"crash","color":"b60205","default":false,"description":null},{"id":3853123536,"node_id":"LA_kwDOAGuhRc7lqf_Q","url":"https://api.github.com/repos/python/mypy/labels/topic-paramspec","name":"topic-paramspec","color":"CA9FD9","default":false,"description":"PEP 612, ParamSpec, Concatenate"},{"id":3945373534,"node_id":"LA_kwDOAGuhRc7rKZ9e","url":"https://api.github.com/repos/python/mypy/labels/topic-overlap","name":"topic-overlap","color":"0052cc","default":false,"description":"Overlapping equality check"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2023-02-26T09:57:31Z","updated_at":"2023-02-27T18:23:00Z","closed_at":"2023-02-27T18:23:00Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\r\n  Use this form only if mypy reports an \"INTERNAL ERROR\" and/or gives a traceback.\r\n  Please include the traceback and all other messages below (use `mypy --show-traceback`).\r\n-->\r\n\r\n**Crash Report**\r\n\r\nsource code of the project is at commit 2f2947e4401a3f8d69fa6c77e0108ad110f8af0f of \r\nhttps://github.com/kode-konveyor/cdd-python\r\n\r\nBTW, have you ever thought about adopting the principles of the type system of TypeScript?\r\nThey got it quite right. Typing generics in python is still quite a challenge even with 3.11.\r\nSee type: ignore comments in the project.\r\n\r\n**Traceback**\r\n\r\n```\r\n$ mypy --show-traceback\r\nsrc/shall/ShallEntity.py:13: error: Unused \"type: ignore\" comment\r\ntest/MeanWhileContract.py:13: error: INTERNAL ERROR -- Please try using mypy master on GitHub:\r\nhttps://mypy.readthedocs.io/en/stable/common_issues.html#using-a-development-mypy-build\r\nPlease report a bug at https://github.com/python/mypy/issues\r\nversion: 1.2.0+dev.284142d6e29d4588107f5c68f95c43986a2e26e5\r\nTraceback (most recent call last):\r\n  File \"/home/mag/.local/bin/mypy\", line 8, in <module>\r\n    sys.exit(console_entry())\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/__main__.py\", line 15, in console_entry\r\n    main()\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/main.py\", line 95, in main\r\n    res, messages, blockers = run_build(sources, options, fscache, t0, stdout, stderr)\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/main.py\", line 174, in run_build\r\n    res = build.build(sources, options, None, flush_errors, fscache, stdout, stderr)\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/build.py\", line 194, in build\r\n    result = _build(\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/build.py\", line 277, in _build\r\n    graph = dispatch(sources, manager, stdout)\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/build.py\", line 2923, in dispatch\r\n    process_graph(graph, manager)\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/build.py\", line 3320, in process_graph\r\n    process_stale_scc(graph, scc, manager)\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/build.py\", line 3421, in process_stale_scc\r\n    graph[id].type_check_first_pass()\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/build.py\", line 2317, in type_check_first_pass\r\n    self.type_checker().check_first_pass()\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/checker.py\", line 474, in check_first_pass\r\n    self.accept(d)\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/checker.py\", line 582, in accept\r\n    stmt.accept(self)\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/nodes.py\", line 774, in accept\r\n    return visitor.visit_func_def(self)\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/checker.py\", line 959, in visit_func_def\r\n    self._visit_func_def(defn)\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/checker.py\", line 963, in _visit_func_def\r\n    self.check_func_item(defn, name=defn.name)\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/checker.py\", line 1035, in check_func_item\r\n    self.check_func_def(defn, typ, name, allow_empty)\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/checker.py\", line 1215, in check_func_def\r\n    self.accept(item.body)\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/checker.py\", line 582, in accept\r\n    stmt.accept(self)\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/nodes.py\", line 1204, in accept\r\n    return visitor.visit_block(self)\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/checker.py\", line 2607, in visit_block\r\n    self.accept(s)\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/checker.py\", line 582, in accept\r\n    stmt.accept(self)\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/nodes.py\", line 1400, in accept\r\n    return visitor.visit_return_stmt(self)\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/checker.py\", line 4127, in visit_return_stmt\r\n    self.check_return_stmt(s)\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/checker.py\", line 4161, in check_return_stmt\r\n    self.expr_checker.accept(\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/checkexpr.py\", line 4881, in accept\r\n    typ = node.accept(self)\r\n          ^^^^^^^^^^^^^^^^^\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/nodes.py\", line 2053, in accept\r\n    return visitor.visit_comparison_expr(self)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/checkexpr.py\", line 3045, in visit_comparison_expr\r\n    if self.dangerous_comparison(left_type, right_type):\r\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/checkexpr.py\", line 3171, in dangerous_comparison\r\n    return self.dangerous_comparison(left.args[0], right.args[0])\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/checkexpr.py\", line 3180, in dangerous_comparison\r\n    return not is_overlapping_types(left, right, ignore_promotions=False)\r\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/meet.py\", line 404, in is_overlapping_types\r\n    return are_tuples_overlapping(left, right, ignore_promotions=ignore_promotions)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/meet.py\", line 585, in are_tuples_overlapping\r\n    return all(\r\n           ^^^^\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/meet.py\", line 586, in <genexpr>\r\n    is_overlapping_types(\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/meet.py\", line 505, in is_overlapping_types\r\n    if all(\r\n       ^^^^\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/meet.py\", line 506, in <genexpr>\r\n    _is_overlapping_types(left_arg, right_arg)\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/meet.py\", line 279, in _is_overlapping_types\r\n    return is_overlapping_types(\r\n           ^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/mag/.local/lib/python3.11/site-packages/mypy/meet.py\", line 519, in is_overlapping_types\r\n    assert type(left) != type(right), f\"{type(left)} vs {type(right)}\"\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\r\nAssertionError: <class 'mypy.types.Parameters'> vs <class 'mypy.types.Parameters'>\r\ntest/MeanWhileContract.py:13: : note: use --pdb to drop into pdb\r\n```\r\n\r\n**To Reproduce**\r\n\r\n(Write what you did to reproduce the crash.  Full source code is\r\nappreciated.  We also very much appreciate it if you try to narrow the\r\nsource down to a small stand-alone example.)\r\n\r\n**Your Environment**\r\n\r\n<!-- Include as many relevant details about the environment you experienced the bug in -->\r\n\r\n- Mypy version used: just built from git repo (1.2.0+dev.284142d6e29d4588107f5c68f95c43986a2e26e5)\r\n- Mypy command-line flags: --show-traceback\r\n- Mypy configuration options from `mypy.ini` (and other config files):\r\n```\r\n[mypy]\r\nstrict = True\r\nexplicit_package_bases = True\r\nnamespace_packages = True\r\n#mypy_path = src:test\r\nfiles = src,test\r\nmypy_path = $MYPY_CONFIG_FILE_DIR/src:$MYPY_CONFIG_FILE_DIR/test\r\n```\r\n- Python version used: 3.11.2-4 from debian sid\r\n- Operating system and version: Debian bullseye with some sid.\r\n\r\n<!--\r\nYou can freely edit this text, please remove all the lines\r\nyou believe are unnecessary.\r\n-->\r\n","closed_by":{"login":"JukkaL","id":1107911,"node_id":"MDQ6VXNlcjExMDc5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1107911?v=4","gravatar_id":"","url":"https://api.github.com/users/JukkaL","html_url":"https://github.com/JukkaL","followers_url":"https://api.github.com/users/JukkaL/followers","following_url":"https://api.github.com/users/JukkaL/following{/other_user}","gists_url":"https://api.github.com/users/JukkaL/gists{/gist_id}","starred_url":"https://api.github.com/users/JukkaL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JukkaL/subscriptions","organizations_url":"https://api.github.com/users/JukkaL/orgs","repos_url":"https://api.github.com/users/JukkaL/repos","events_url":"https://api.github.com/users/JukkaL/events{/privacy}","received_events_url":"https://api.github.com/users/JukkaL/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python/mypy/issues/14783/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/mypy/issues/14783/timeline","performed_via_github_app":null,"state_reason":"completed"}