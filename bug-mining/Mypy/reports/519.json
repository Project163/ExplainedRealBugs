{"url":"https://api.github.com/repos/python/mypy/issues/18488","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/18488/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/18488/comments","events_url":"https://api.github.com/repos/python/mypy/issues/18488/events","html_url":"https://github.com/python/mypy/issues/18488","id":2797748691,"node_id":"I_kwDOAGuhRc6mwkHT","number":18488,"title":"[regression] isinstance complains about parametrized generics with any use of TypeAlias","user":{"login":"wesleywright","id":4690880,"node_id":"MDQ6VXNlcjQ2OTA4ODA=","avatar_url":"https://avatars.githubusercontent.com/u/4690880?v=4","gravatar_id":"","url":"https://api.github.com/users/wesleywright","html_url":"https://github.com/wesleywright","followers_url":"https://api.github.com/users/wesleywright/followers","following_url":"https://api.github.com/users/wesleywright/following{/other_user}","gists_url":"https://api.github.com/users/wesleywright/gists{/gist_id}","starred_url":"https://api.github.com/users/wesleywright/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wesleywright/subscriptions","organizations_url":"https://api.github.com/users/wesleywright/orgs","repos_url":"https://api.github.com/users/wesleywright/repos","events_url":"https://api.github.com/users/wesleywright/events{/privacy}","received_events_url":"https://api.github.com/users/wesleywright/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":21488356,"node_id":"MDU6TGFiZWwyMTQ4ODM1Ng==","url":"https://api.github.com/repos/python/mypy/labels/bug","name":"bug","color":"f9d0c4","default":true,"description":"mypy got something wrong"},{"id":3945135234,"node_id":"LA_kwDOAGuhRc7rJfyC","url":"https://api.github.com/repos/python/mypy/labels/topic-type-alias","name":"topic-type-alias","color":"51FABE","default":false,"description":"TypeAlias and other type alias issues"},{"id":3945299893,"node_id":"LA_kwDOAGuhRc7rKH-1","url":"https://api.github.com/repos/python/mypy/labels/topic-runtime-semantics","name":"topic-runtime-semantics","color":"001D2C","default":false,"description":"mypy doesn't model runtime semantics correctly"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2025-01-19T17:49:37Z","updated_at":"2025-01-23T04:07:04Z","closed_at":"2025-01-23T04:07:04Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Bug Report**\n\nAny attempt to call `isinstance` with a variable annotated as a `TypeAlias` seems to result in the error message `error: Parameterized generics cannot be used with class or instance checks`, even if the aliased type is non-generic. mypy_primer points at https://github.com/python/mypy/pull/18173 as the breaking commit, but that PR seems to have been intended to deal with type aliases of generic types; it seems that we're treating _all_ `TypeAlias`-based aliases as generic types, which AFAICT is broader than intended. \n\n**To Reproduce**\n\n[MyPy playground link](https://mypy-play.net/?mypy=master&python=3.12&gist=dedafca242fde5949bad614b4668806f), using current master\n\n```python\nfrom typing import Any, TypeAlias\n\nclass Foo:\n    pass\n\nAlias: TypeAlias = Foo\n\ndef is_foo(x: Any) -> bool:\n    return isinstance(x, Alias)\n```\n\n**Expected Behavior**\n\nMyPy finds no errors, matching the runtime behavior. Pyright and mypy 1.4 both find no errors in my minimal example.\n\n**Actual Behavior**\n\nPer the playground link:\n\n```\nmain.py:9: error: Parameterized generics cannot be used with class or instance checks  [misc]\nFound 1 error in 1 file (checked 1 source file)\n```\n\n**Your Environment**\n\nI found this when dogfooding mypy master commit c4e2eb79905d7b381db8caed161cebb04622ebc2 against Dropbox's internal Python repo, but mypy_primer also reproduces the same thing, as does mypy playground. ","closed_by":{"login":"hauntsaninja","id":12621235,"node_id":"MDQ6VXNlcjEyNjIxMjM1","avatar_url":"https://avatars.githubusercontent.com/u/12621235?v=4","gravatar_id":"","url":"https://api.github.com/users/hauntsaninja","html_url":"https://github.com/hauntsaninja","followers_url":"https://api.github.com/users/hauntsaninja/followers","following_url":"https://api.github.com/users/hauntsaninja/following{/other_user}","gists_url":"https://api.github.com/users/hauntsaninja/gists{/gist_id}","starred_url":"https://api.github.com/users/hauntsaninja/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hauntsaninja/subscriptions","organizations_url":"https://api.github.com/users/hauntsaninja/orgs","repos_url":"https://api.github.com/users/hauntsaninja/repos","events_url":"https://api.github.com/users/hauntsaninja/events{/privacy}","received_events_url":"https://api.github.com/users/hauntsaninja/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python/mypy/issues/18488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/mypy/issues/18488/timeline","performed_via_github_app":null,"state_reason":"completed"}