{"url":"https://api.github.com/repos/python/mypy/issues/16935","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/16935/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/16935/comments","events_url":"https://api.github.com/repos/python/mypy/issues/16935/events","html_url":"https://github.com/python/mypy/issues/16935","id":2147766262,"node_id":"I_kwDOAGuhRc6ABE_2","number":16935,"title":"Tuple types don't work with higher level typing","user":{"login":"fjarri","id":30720,"node_id":"MDQ6VXNlcjMwNzIw","avatar_url":"https://avatars.githubusercontent.com/u/30720?v=4","gravatar_id":"","url":"https://api.github.com/users/fjarri","html_url":"https://github.com/fjarri","followers_url":"https://api.github.com/users/fjarri/followers","following_url":"https://api.github.com/users/fjarri/following{/other_user}","gists_url":"https://api.github.com/users/fjarri/gists{/gist_id}","starred_url":"https://api.github.com/users/fjarri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fjarri/subscriptions","organizations_url":"https://api.github.com/users/fjarri/orgs","repos_url":"https://api.github.com/users/fjarri/repos","events_url":"https://api.github.com/users/fjarri/events{/privacy}","received_events_url":"https://api.github.com/users/fjarri/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":21488356,"node_id":"MDU6TGFiZWwyMTQ4ODM1Ng==","url":"https://api.github.com/repos/python/mypy/labels/bug","name":"bug","color":"f9d0c4","default":true,"description":"mypy got something wrong"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2024-02-21T21:44:47Z","updated_at":"2024-06-03T04:38:45Z","closed_at":"2024-06-03T04:38:45Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"mypy 1.8.0, python 3.10.10\r\n\r\nSo tuple types get matched and checked normally in simple situations like this:\r\n```python\r\na: tuple[int, int] = (2, \"a\")\r\n# Incompatible types in assignment ...\r\n```\r\n\r\nBut imagine I want to define a function that takes a type and returns a value of that type (e.g. by deserializing something as the given type):\r\n```python\r\nfrom typing import Tuple, TypeVar, Type, List\r\n\r\n_T = TypeVar(\"_T\")\r\n\r\ndef structure(structure_into: Type[_T], obj: str) -> _T:\r\n    raise NotImplementedError\r\n```\r\n\r\nThis works with builtin types, or with generics like `List`:\r\n```\r\nreveal_type(structure(int, \"a\"))\r\n# Revealed type is \"builtins.int\"\r\nreveal_type(structure(List[int], \"a\"))\r\n# Revealed type is \"builtins.list[builtins.int]\"\r\n```\r\n\r\n... but not with tuples:\r\n```python\r\nreveal_type(structure(Tuple[int, int], \"a\"))\r\n# note: Revealed type is \"Never\"\r\n# error: Argument 1 to \"structure\" has incompatible type \"object\"; expected \"type[Never]\"  [arg-type]\r\n```\r\n\r\nTrying to reveal the type of `Tuple` itself leads to strange results too (compared to `List[...]`):\r\n```\r\nreveal_type(Tuple[int, int])\r\n# Revealed type is \"builtins.object\"\r\nreveal_type(tuple[int, int])\r\n# Revealed type is \"def [_T_co] (typing.Iterable[_T_co`1] =) -> builtins.tuple[_T_co`1, ...]\"\r\n```\r\n\r\nSo the question is, why does `Tuple` get a special treatment, and is there a way to make it behave like other generics?","closed_by":{"login":"JelleZijlstra","id":906600,"node_id":"MDQ6VXNlcjkwNjYwMA==","avatar_url":"https://avatars.githubusercontent.com/u/906600?v=4","gravatar_id":"","url":"https://api.github.com/users/JelleZijlstra","html_url":"https://github.com/JelleZijlstra","followers_url":"https://api.github.com/users/JelleZijlstra/followers","following_url":"https://api.github.com/users/JelleZijlstra/following{/other_user}","gists_url":"https://api.github.com/users/JelleZijlstra/gists{/gist_id}","starred_url":"https://api.github.com/users/JelleZijlstra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JelleZijlstra/subscriptions","organizations_url":"https://api.github.com/users/JelleZijlstra/orgs","repos_url":"https://api.github.com/users/JelleZijlstra/repos","events_url":"https://api.github.com/users/JelleZijlstra/events{/privacy}","received_events_url":"https://api.github.com/users/JelleZijlstra/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python/mypy/issues/16935/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/mypy/issues/16935/timeline","performed_via_github_app":null,"state_reason":"completed"}