{"url":"https://api.github.com/repos/python/mypy/issues/18256","repository_url":"https://api.github.com/repos/python/mypy","labels_url":"https://api.github.com/repos/python/mypy/issues/18256/labels{/name}","comments_url":"https://api.github.com/repos/python/mypy/issues/18256/comments","events_url":"https://api.github.com/repos/python/mypy/issues/18256/events","html_url":"https://github.com/python/mypy/issues/18256","id":2723010876,"node_id":"I_kwDOAGuhRc6iTdk8","number":18256,"title":"Add --strict-bytes flag to disable promotions to bytes","user":{"login":"JukkaL","id":1107911,"node_id":"MDQ6VXNlcjExMDc5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1107911?v=4","gravatar_id":"","url":"https://api.github.com/users/JukkaL","html_url":"https://github.com/JukkaL","followers_url":"https://api.github.com/users/JukkaL/followers","following_url":"https://api.github.com/users/JukkaL/following{/other_user}","gists_url":"https://api.github.com/users/JukkaL/gists{/gist_id}","starred_url":"https://api.github.com/users/JukkaL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JukkaL/subscriptions","organizations_url":"https://api.github.com/users/JukkaL/orgs","repos_url":"https://api.github.com/users/JukkaL/repos","events_url":"https://api.github.com/users/JukkaL/events{/privacy}","received_events_url":"https://api.github.com/users/JukkaL/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":21488358,"node_id":"MDU6TGFiZWwyMTQ4ODM1OA==","url":"https://api.github.com/repos/python/mypy/labels/feature","name":"feature","color":"84b6eb","default":false,"description":null},{"id":513232516,"node_id":"MDU6TGFiZWw1MTMyMzI1MTY=","url":"https://api.github.com/repos/python/mypy/labels/priority-0-high","name":"priority-0-high","color":"fbca04","default":false,"description":null},{"id":932016981,"node_id":"MDU6TGFiZWw5MzIwMTY5ODE=","url":"https://api.github.com/repos/python/mypy/labels/good-first-issue","name":"good-first-issue","color":"3dc136","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2024-12-06T13:01:26Z","updated_at":"2025-05-08T01:03:08Z","closed_at":"2024-12-10T12:13:55Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Feature**\r\n\r\nWe currently have the undocumented flags `--disable-bytearray-promotion` and `--disable-memoryview-promotion` that turn off promotions from `bytearray`/`memoryview` to `bytes`. These are a bit unwieldy, and I'm proposing that we add a new flag called `--strict-bytes` that enables both of these flags, and make it an officially documented feature. In mypy 2.0 we'd switch `--strict-bytes` on by default.\r\n\r\nAdditional details:\r\n * This should be documented.\r\n * Also support `--no-strict-bytes` for the inverse. This allows users to prepare for mypy 2.0 even if they aren't ready to turn on the flag.\r\n * This probably shouldn't be a per-module option, since migration to the new behavior appears to be fairly easy even for large codebases.\r\n * We'll still keep the old undocumented flags for now, but they might be removed in the future.\r\n\r\n**Pitch**\r\n\r\nCurrently `bytearray` and `memoryview` are assignable to `bytes`, which is incorrect, but this has been tricky to fix mostly due to stub quality. Stubs seem to have improved enough for this to be practical now -- any anyway switching the default would give more incentives to fix stubs.\r\n\r\nThe new flag is shorter and easier to remember, and it combines both of the features so it's simpler. The naming is also arguably consistent with `--strict-equality` and friends. In my experience dropping the `memoryview` promotion rarely causes trouble, so having it as a separate flag doesn't seem important.","closed_by":{"login":"JukkaL","id":1107911,"node_id":"MDQ6VXNlcjExMDc5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1107911?v=4","gravatar_id":"","url":"https://api.github.com/users/JukkaL","html_url":"https://github.com/JukkaL","followers_url":"https://api.github.com/users/JukkaL/followers","following_url":"https://api.github.com/users/JukkaL/following{/other_user}","gists_url":"https://api.github.com/users/JukkaL/gists{/gist_id}","starred_url":"https://api.github.com/users/JukkaL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JukkaL/subscriptions","organizations_url":"https://api.github.com/users/JukkaL/orgs","repos_url":"https://api.github.com/users/JukkaL/repos","events_url":"https://api.github.com/users/JukkaL/events{/privacy}","received_events_url":"https://api.github.com/users/JukkaL/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/python/mypy/issues/18256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/python/mypy/issues/18256/timeline","performed_via_github_app":null,"state_reason":"completed"}