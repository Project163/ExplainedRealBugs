diff --git a/src/main/java/org/apache/jdbm/BTreeMap.java b/src/main/java/org/apache/jdbm/BTreeMap.java
index 8355f40..fba1bf2 100644
--- a/src/main/java/org/apache/jdbm/BTreeMap.java
+++ b/src/main/java/org/apache/jdbm/BTreeMap.java
@@ -31,7 +31,7 @@ import java.util.concurrent.ConcurrentNavigableMap;
  */
 class BTreeMap<K, V> extends AbstractMap<K, V> implements ConcurrentNavigableMap<K, V> {
 
-    protected final BTree<K, V> tree;
+    protected BTree<K, V> tree;
 
     protected final K fromKey;
 
diff --git a/src/main/java/org/apache/jdbm/DBAbstract.java b/src/main/java/org/apache/jdbm/DBAbstract.java
index 5c1ba0a..0e32c88 100644
--- a/src/main/java/org/apache/jdbm/DBAbstract.java
+++ b/src/main/java/org/apache/jdbm/DBAbstract.java
@@ -564,4 +564,27 @@ abstract class DBAbstract implements DB {
         }
 
     }
+
+    synchronized public void   rollback() {
+        try {
+        for(WeakReference<Object> o:collections.values()){
+            Object c =  o.get();
+            if(c != null && c instanceof BTreeMap){
+                //reload tree
+                BTreeMap m = (BTreeMap) c;
+                m.tree = fetch(m.tree.getRecid());
+            }
+            if(c != null && c instanceof BTreeSet){
+                //reload tree
+                BTreeSet m = (BTreeSet) c;
+                m.map.tree = fetch(m.map.tree.getRecid());
+            }
+
+
+        }
+        } catch (IOException e) {
+            throw new IOError(e);
+        }
+
+    }
 }
diff --git a/src/main/java/org/apache/jdbm/DBStore.java b/src/main/java/org/apache/jdbm/DBStore.java
index f1e2689..357c741 100644
--- a/src/main/java/org/apache/jdbm/DBStore.java
+++ b/src/main/java/org/apache/jdbm/DBStore.java
@@ -463,6 +463,8 @@ class DBStore
             _physMgr.rollback();
             _logicMgr.rollback();
             _pageman.rollback();
+
+            super.rollback();
         } catch (IOException e) {
             throw new IOError(e);
         }
diff --git a/src/test/java/org/apache/jdbm/RollbackTest.java b/src/test/java/org/apache/jdbm/RollbackTest.java
new file mode 100644
index 0000000..1170dc9
--- /dev/null
+++ b/src/test/java/org/apache/jdbm/RollbackTest.java
@@ -0,0 +1,91 @@
+package org.apache.jdbm;
+
+import java.io.IOException;
+import java.util.List;
+import java.util.Map;
+import java.util.Set;
+
+public class RollbackTest extends TestCaseWithTestFile{
+
+    public void test_treemap() throws IOException {
+        DB db = newDBCache();
+        Map<Integer, String> map = db.createTreeMap("collectionName");
+
+        map.put(1, "one");
+        map.put(2, "two");
+
+        assertEquals(2, map.size());
+        db.commit(); //persist changes into disk
+
+        map.put(3, "three");
+        assertEquals(3, map.size());
+        db.rollback(); //revert recent changes
+        assertEquals(2, map.size());
+    }
+
+    public void test_hashmap() throws IOException {
+        DB db = newDBCache();
+        Map<Integer, String> map = db.createHashMap("collectionName");
+
+        map.put(1, "one");
+        map.put(2, "two");
+
+        assertEquals(2, map.size());
+        db.commit(); //persist changes into disk
+
+        map.put(3, "three");
+        assertEquals(3, map.size());
+        db.rollback(); //revert recent changes
+        assertEquals(2, map.size());
+    }
+
+    public void test_treeset() throws IOException {
+        DB db = newDBCache();
+        Set<Integer> c = db.createTreeSet("collectionName");
+
+        c.add(1);
+        c.add(2);
+
+        assertEquals(2, c.size());
+        db.commit(); //persist changes into disk
+
+        c.add(3);
+        assertEquals(3, c.size());
+        db.rollback(); //revert recent changes
+        assertEquals(2, c.size());
+    }
+
+
+    public void test_hashset() throws IOException {
+        DB db = newDBCache();
+        Set<Integer> c = db.createHashSet("collectionName");
+
+        c.add(1);
+        c.add(2);
+
+        assertEquals(2, c.size());
+        db.commit(); //persist changes into disk
+
+        c.add(3);
+        assertEquals(3, c.size());
+        db.rollback(); //revert recent changes
+        assertEquals(2, c.size());
+    }
+
+    public void test_linkedlist() throws IOException {
+        DB db = newDBCache();
+        List<Integer> c = db.createLinkedList("collectionName");
+
+        c.add(1);
+        c.add(2);
+
+        assertEquals(2, c.size());
+        db.commit(); //persist changes into disk
+
+        c.add(3);
+        assertEquals(3, c.size());
+        db.rollback(); //revert recent changes
+        assertEquals(2, c.size());
+    }
+
+}
