{"url":"https://api.github.com/repos/SFML/SFML/issues/2630","repository_url":"https://api.github.com/repos/SFML/SFML","labels_url":"https://api.github.com/repos/SFML/SFML/issues/2630/labels{/name}","comments_url":"https://api.github.com/repos/SFML/SFML/issues/2630/comments","events_url":"https://api.github.com/repos/SFML/SFML/issues/2630/events","html_url":"https://github.com/SFML/SFML/issues/2630","id":1825617595,"node_id":"I_kwDOABdDzM5s0La7","number":2630,"title":"Using antialiasing with RenderWindow + RenderTextures -> Only the 1st RenderTexture is drawn","user":{"login":"danieljpetersen","id":5576311,"node_id":"MDQ6VXNlcjU1NzYzMTE=","avatar_url":"https://avatars.githubusercontent.com/u/5576311?v=4","gravatar_id":"","url":"https://api.github.com/users/danieljpetersen","html_url":"https://github.com/danieljpetersen","followers_url":"https://api.github.com/users/danieljpetersen/followers","following_url":"https://api.github.com/users/danieljpetersen/following{/other_user}","gists_url":"https://api.github.com/users/danieljpetersen/gists{/gist_id}","starred_url":"https://api.github.com/users/danieljpetersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danieljpetersen/subscriptions","organizations_url":"https://api.github.com/users/danieljpetersen/orgs","repos_url":"https://api.github.com/users/danieljpetersen/repos","events_url":"https://api.github.com/users/danieljpetersen/events{/privacy}","received_events_url":"https://api.github.com/users/danieljpetersen/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":85849,"node_id":"MDU6TGFiZWw4NTg0OQ==","url":"https://api.github.com/repos/SFML/SFML/labels/bug","name":"bug","color":"ff4242","default":true,"description":null},{"id":85856,"node_id":"MDU6TGFiZWw4NTg1Ng==","url":"https://api.github.com/repos/SFML/SFML/labels/m:sfml-graphics","name":"m:sfml-graphics","color":"cccccc","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"binary1248","id":949359,"node_id":"MDQ6VXNlcjk0OTM1OQ==","avatar_url":"https://avatars.githubusercontent.com/u/949359?v=4","gravatar_id":"","url":"https://api.github.com/users/binary1248","html_url":"https://github.com/binary1248","followers_url":"https://api.github.com/users/binary1248/followers","following_url":"https://api.github.com/users/binary1248/following{/other_user}","gists_url":"https://api.github.com/users/binary1248/gists{/gist_id}","starred_url":"https://api.github.com/users/binary1248/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/binary1248/subscriptions","organizations_url":"https://api.github.com/users/binary1248/orgs","repos_url":"https://api.github.com/users/binary1248/repos","events_url":"https://api.github.com/users/binary1248/events{/privacy}","received_events_url":"https://api.github.com/users/binary1248/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"binary1248","id":949359,"node_id":"MDQ6VXNlcjk0OTM1OQ==","avatar_url":"https://avatars.githubusercontent.com/u/949359?v=4","gravatar_id":"","url":"https://api.github.com/users/binary1248","html_url":"https://github.com/binary1248","followers_url":"https://api.github.com/users/binary1248/followers","following_url":"https://api.github.com/users/binary1248/following{/other_user}","gists_url":"https://api.github.com/users/binary1248/gists{/gist_id}","starred_url":"https://api.github.com/users/binary1248/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/binary1248/subscriptions","organizations_url":"https://api.github.com/users/binary1248/orgs","repos_url":"https://api.github.com/users/binary1248/repos","events_url":"https://api.github.com/users/binary1248/events{/privacy}","received_events_url":"https://api.github.com/users/binary1248/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/SFML/SFML/milestones/13","html_url":"https://github.com/SFML/SFML/milestone/13","labels_url":"https://api.github.com/repos/SFML/SFML/milestones/13/labels","id":1194243,"node_id":"MDk6TWlsZXN0b25lMTE5NDI0Mw==","number":13,"title":"3.0","description":"Next major version, SFML 3","creator":{"login":"Bromeon","id":708488,"node_id":"MDQ6VXNlcjcwODQ4OA==","avatar_url":"https://avatars.githubusercontent.com/u/708488?v=4","gravatar_id":"","url":"https://api.github.com/users/Bromeon","html_url":"https://github.com/Bromeon","followers_url":"https://api.github.com/users/Bromeon/followers","following_url":"https://api.github.com/users/Bromeon/following{/other_user}","gists_url":"https://api.github.com/users/Bromeon/gists{/gist_id}","starred_url":"https://api.github.com/users/Bromeon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bromeon/subscriptions","organizations_url":"https://api.github.com/users/Bromeon/orgs","repos_url":"https://api.github.com/users/Bromeon/repos","events_url":"https://api.github.com/users/Bromeon/events{/privacy}","received_events_url":"https://api.github.com/users/Bromeon/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":1094,"state":"closed","created_at":"2015-07-06T06:56:33Z","updated_at":"2025-07-17T21:59:55Z","due_on":null,"closed_at":"2024-12-21T00:00:13Z"},"comments":3,"created_at":"2023-07-28T03:04:47Z","updated_at":"2023-10-08T17:37:19Z","closed_at":"2023-10-08T17:37:19Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Using 2 RenderTextures in conjunction with setting antialiasing on RenderTextures + setting antialiasing on RenderWindow causes the second RenderTexture to not draw correctly, provided a specific order of display() and draw(). \r\n\r\nHere's a brief outline of the steps involved, but see the code example to get a better idea\r\n* Set antialiasing on RenderWindow\r\n* Set antialiasing on 2 RenderTextures\r\n* Call display on first RenderTexture, draw the first RenderTexture to window\r\n* Call display on second RenderTexture, draw second RenderTexture to window\r\n* The first RenderTexture will draw correctly, the second will not draw.\r\n\r\nNote that if the two display calls are grouped together before any window->draw(...) calls, the bug does not occur. The order must be like: RenderTexture1->display(), window->draw(renderTexture1); RenderTexture2->display(), window->draw(renderTexture2); \r\n\r\nBoth [Bambo](https://github.com/Bambo-Borris) (Windows 11 64 bit with 30 series Nvidia card) and [metaquarx](https://github.com/metaquarx) (Linux, unsure what GPU) have reproduced the bug. I'm on Linux with an AMD laptop. It's been tested and occurs on both 2.6 and 3.0.\r\n\r\nAlso note that I have not tested more combinations. For example, I have not tested things like setting AA on the window and rendertexture1 but not aa on renderTexture2, nor have I tested things like using more than two render textures.\r\n\r\nThe textures themselves save to disk as the correct image, it's a matter of rendering them to the screen. Though thinking about it I haven't checked if it actually has AA when you save it to disk.\r\n\r\nHere's a reproducable example. Note that you'll need a \"texture.png\" next to the binary, ideally 800x600. I've attached an image you may want to use after the example. There's also a flag you can set at the top of the code to disable / enable setting AA on the render textures, thus enabling / disabling the issue. \r\n\r\n```\r\n\r\n#include <SFML/System.hpp>\r\n#include <SFML/Graphics.hpp>\r\n#include <SFML/Window.hpp>\r\n#include <array>\r\n\r\n////////////////////////////////////////////////////////////\r\n\r\n// change this to 1 to trigger the bug\r\n#define TRIGGER_THE_BUG 1\r\n\r\nint main()\r\n{\r\n    const float screenWidth = 800.0f;\r\n    const float screenHeight = 600.0f;\r\n\r\n    sf::RenderWindow window(sf::VideoMode({(unsigned int)screenWidth, (unsigned int)screenHeight}), \"Window\", sf::Style::Default, sf::ContextSettings(0, 0, 4));\r\n    window.setVerticalSyncEnabled(true);\r\n\r\n    sf::Texture beautifulTexture;\r\n    (void)beautifulTexture.loadFromFile(\"texture.png\");\r\n    std::array<sf::RenderTexture, 2> renderTextures {\r\n        sf::RenderTexture(),\r\n        sf::RenderTexture()\r\n    };\r\n\r\n    int renderTextureAALevel = 0;\r\n#if TRIGGER_THE_BUG == 1\r\n    renderTextureAALevel = 4;\r\n#endif\r\n\r\n    (void)renderTextures[0].create({(unsigned int)screenWidth, (unsigned int)screenHeight}, sf::ContextSettings(0, 0, renderTextureAALevel));\r\n    (void)renderTextures[1].create({(unsigned int)screenWidth, (unsigned int)screenHeight}, sf::ContextSettings(0, 0, renderTextureAALevel));\r\n\r\n    auto drawToRenderTextures =[&]() {\r\n        renderTextures[0].clear();\r\n        renderTextures[1].clear();\r\n\r\n        sf::Sprite sprite(beautifulTexture);\r\n        renderTextures[0].draw(sprite);\r\n\r\n        sprite.setColor(sf::Color::Green); // tint it green so we have some visual distinction between the two renderTextures\r\n        renderTextures[1].draw(sprite);\r\n    };\r\n\r\n    std::array<sf::VertexArray, 2> vertexArrays;\r\n    vertexArrays[0].setPrimitiveType(sf::PrimitiveType::Triangles);\r\n    vertexArrays[1].setPrimitiveType(sf::PrimitiveType::Triangles);\r\n\r\n    auto makeVertexArrays = [&]() {\r\n        vertexArrays[0].clear();\r\n        vertexArrays[1].clear();\r\n\r\n        float xCenter = screenWidth / 2;\r\n\r\n        // left half of screen\r\n        vertexArrays[0].append(sf::Vertex({0,0}, {0,0}));\r\n        vertexArrays[0].append(sf::Vertex({xCenter,0}, {xCenter,0}));\r\n        vertexArrays[0].append(sf::Vertex({0,screenHeight}, {0,screenHeight}));\r\n\r\n        vertexArrays[0].append(sf::Vertex({0,screenHeight}, {0,screenHeight}));\r\n        vertexArrays[0].append(sf::Vertex({xCenter,0}, {xCenter,0}));\r\n        vertexArrays[0].append(sf::Vertex({xCenter,screenHeight}, {xCenter,screenHeight}));\r\n\r\n        // right half of screen\r\n        vertexArrays[1].append(sf::Vertex({xCenter,0}, {xCenter,0}));\r\n        vertexArrays[1].append(sf::Vertex({screenWidth,0}, {screenWidth,0}));\r\n        vertexArrays[1].append(sf::Vertex({xCenter,screenHeight}, {xCenter,screenHeight}));\r\n\r\n        vertexArrays[1].append(sf::Vertex({xCenter,screenHeight}, {xCenter,screenHeight}));\r\n        vertexArrays[1].append(sf::Vertex({screenWidth,0}, {screenWidth,0}));\r\n        vertexArrays[1].append(sf::Vertex({screenWidth,screenHeight}, {screenWidth,screenHeight}));\r\n    };\r\n\r\n    while (window.isOpen())\r\n    {\r\n        sf::Event event;\r\n        while (window.pollEvent(event))\r\n        {\r\n            if (event.type == sf::Event::Closed)\r\n                window.close();\r\n        }\r\n\r\n        window.clear();\r\n\r\n        makeVertexArrays();\r\n        drawToRenderTextures();\r\n\r\n        // NOTE -- The order of display and draw calls are part of the equation.\r\n        // If We call display() on both render textures and then call draws,\r\n        // there is no bug even with the macro defined to 1.\r\n\r\n        renderTextures[0].display();\r\n        window.draw(vertexArrays[0], &renderTextures[0].getTexture());\r\n\r\n        renderTextures[1].display();\r\n        window.draw(vertexArrays[1], &renderTextures[1].getTexture());\r\n\r\n        /*  EG If the following shit were the code rather than the above, it would work\r\n        renderTextures[0].display();\r\n        renderTextures[1].display();\r\n\r\n        window.draw(vertexArrays[0], &renderTextures[0].getTexture());\r\n        window.draw(vertexArrays[1], &renderTextures[1].getTexture());\r\n        //*/\r\n\r\n        window.display();\r\n    }\r\n\r\n    return 0;\r\n}\r\n\r\n```\r\n\r\nTest Image you can place next to the binary\r\n![texture](https://github.com/SFML/SFML/assets/5576311/3d9031f2-9f3e-4c7f-b96e-dcb4d69973bf)\r\n\r\nHere is the expected output\r\n![correct](https://github.com/SFML/SFML/assets/5576311/20cd77bd-bfad-4e5b-887e-d2e234a9317a)\r\n\r\nHere is the buggy output\r\n![buggy](https://github.com/SFML/SFML/assets/5576311/055063a2-552e-4d02-880b-9c435f8aa446)\r\n","closed_by":{"login":"ChrisThrasher","id":39244355,"node_id":"MDQ6VXNlcjM5MjQ0MzU1","avatar_url":"https://avatars.githubusercontent.com/u/39244355?v=4","gravatar_id":"","url":"https://api.github.com/users/ChrisThrasher","html_url":"https://github.com/ChrisThrasher","followers_url":"https://api.github.com/users/ChrisThrasher/followers","following_url":"https://api.github.com/users/ChrisThrasher/following{/other_user}","gists_url":"https://api.github.com/users/ChrisThrasher/gists{/gist_id}","starred_url":"https://api.github.com/users/ChrisThrasher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ChrisThrasher/subscriptions","organizations_url":"https://api.github.com/users/ChrisThrasher/orgs","repos_url":"https://api.github.com/users/ChrisThrasher/repos","events_url":"https://api.github.com/users/ChrisThrasher/events{/privacy}","received_events_url":"https://api.github.com/users/ChrisThrasher/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/SFML/SFML/issues/2630/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/SFML/SFML/issues/2630/timeline","performed_via_github_app":null,"state_reason":"completed"}