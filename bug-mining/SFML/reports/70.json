{"url":"https://api.github.com/repos/SFML/SFML/issues/1831","repository_url":"https://api.github.com/repos/SFML/SFML","labels_url":"https://api.github.com/repos/SFML/SFML/issues/1831/labels{/name}","comments_url":"https://api.github.com/repos/SFML/SFML/issues/1831/comments","events_url":"https://api.github.com/repos/SFML/SFML/issues/1831/events","html_url":"https://github.com/SFML/SFML/issues/1831","id":1026495792,"node_id":"I_kwDOABdDzM49LxUw","number":1831,"title":"High CPU usage from SoundStream after removal of Audio Device","user":{"login":"Biohazard90","id":5513441,"node_id":"MDQ6VXNlcjU1MTM0NDE=","avatar_url":"https://avatars.githubusercontent.com/u/5513441?v=4","gravatar_id":"","url":"https://api.github.com/users/Biohazard90","html_url":"https://github.com/Biohazard90","followers_url":"https://api.github.com/users/Biohazard90/followers","following_url":"https://api.github.com/users/Biohazard90/following{/other_user}","gists_url":"https://api.github.com/users/Biohazard90/gists{/gist_id}","starred_url":"https://api.github.com/users/Biohazard90/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Biohazard90/subscriptions","organizations_url":"https://api.github.com/users/Biohazard90/orgs","repos_url":"https://api.github.com/users/Biohazard90/repos","events_url":"https://api.github.com/users/Biohazard90/events{/privacy}","received_events_url":"https://api.github.com/users/Biohazard90/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":85849,"node_id":"MDU6TGFiZWw4NTg0OQ==","url":"https://api.github.com/repos/SFML/SFML/labels/bug","name":"bug","color":"ff4242","default":true,"description":null},{"id":85858,"node_id":"MDU6TGFiZWw4NTg1OA==","url":"https://api.github.com/repos/SFML/SFML/labels/m:sfml-audio","name":"m:sfml-audio","color":"cccccc","default":false,"description":null},{"id":100769559,"node_id":"MDU6TGFiZWwxMDA3Njk1NTk=","url":"https://api.github.com/repos/SFML/SFML/labels/p:windows","name":"p:windows","color":"888888","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/SFML/SFML/milestones/21","html_url":"https://github.com/SFML/SFML/milestone/21","labels_url":"https://api.github.com/repos/SFML/SFML/milestones/21/labels","id":10144833,"node_id":"MI_kwDOABdDzM4AmsxB","number":21,"title":"2.6.2","description":"Bugfix milestone, for things missed in SFML 2.6","creator":{"login":"eXpl0it3r","id":920861,"node_id":"MDQ6VXNlcjkyMDg2MQ==","avatar_url":"https://avatars.githubusercontent.com/u/920861?v=4","gravatar_id":"","url":"https://api.github.com/users/eXpl0it3r","html_url":"https://github.com/eXpl0it3r","followers_url":"https://api.github.com/users/eXpl0it3r/followers","following_url":"https://api.github.com/users/eXpl0it3r/following{/other_user}","gists_url":"https://api.github.com/users/eXpl0it3r/gists{/gist_id}","starred_url":"https://api.github.com/users/eXpl0it3r/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eXpl0it3r/subscriptions","organizations_url":"https://api.github.com/users/eXpl0it3r/orgs","repos_url":"https://api.github.com/users/eXpl0it3r/repos","events_url":"https://api.github.com/users/eXpl0it3r/events{/privacy}","received_events_url":"https://api.github.com/users/eXpl0it3r/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":49,"state":"closed","created_at":"2023-11-04T13:20:22Z","updated_at":"2024-11-12T23:06:54Z","due_on":null,"closed_at":"2024-11-12T23:06:54Z"},"comments":8,"created_at":"2021-10-14T14:51:03Z","updated_at":"2023-11-15T21:34:35Z","closed_at":"2022-04-06T09:50:17Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Subject of the issue\r\n\r\nWhen an audio device is removed while it is being used by a SoundStream, the playback loop will produce error messages without yielding execution resulting in 100% usage on one CPU core.\r\n\r\n## Your environment\r\n\r\n* Windows 10 x64\r\n* SFML 2.5.1\r\n* VS2019 x86\r\n* Static runtime\r\n\r\n## Steps to reproduce\r\n\r\n* Play an sf::Music object\r\n* Open the sound device settings in Windows and disable the device that is currently being used as a default device.\r\n\r\n## Expected behavior\r\n\r\nThe music should stop and CPU usage should not change.\r\n\r\n## Actual behavior\r\n\r\nThe CPU usage on one core rises to 100%. The code producing the problem: https://github.com/SFML/SFML/blob/master/src/SFML/Audio/SoundStream.cpp#L335\r\n\r\nSound playback should be stopped or execution should be yielded while errors are occurring due to the device having been removed.\r\n\r\nI don't know if any other momentary errors are expected from alGetSourcei. If alGetSourcei is supposed to never fail, then it would make sense to stop playback entirely instead of continuing and yielding.\r\n\r\nAlso: SFML doesn't seem to handle audio device changes at all. It would be great if SFML would be able to switch the audio device internally when the user switches the default device in Windows.\r\n","closed_by":{"login":"eXpl0it3r","id":920861,"node_id":"MDQ6VXNlcjkyMDg2MQ==","avatar_url":"https://avatars.githubusercontent.com/u/920861?v=4","gravatar_id":"","url":"https://api.github.com/users/eXpl0it3r","html_url":"https://github.com/eXpl0it3r","followers_url":"https://api.github.com/users/eXpl0it3r/followers","following_url":"https://api.github.com/users/eXpl0it3r/following{/other_user}","gists_url":"https://api.github.com/users/eXpl0it3r/gists{/gist_id}","starred_url":"https://api.github.com/users/eXpl0it3r/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eXpl0it3r/subscriptions","organizations_url":"https://api.github.com/users/eXpl0it3r/orgs","repos_url":"https://api.github.com/users/eXpl0it3r/repos","events_url":"https://api.github.com/users/eXpl0it3r/events{/privacy}","received_events_url":"https://api.github.com/users/eXpl0it3r/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/SFML/SFML/issues/1831/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/SFML/SFML/issues/1831/timeline","performed_via_github_app":null,"state_reason":"completed"}