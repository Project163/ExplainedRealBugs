<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sun Nov 09 05:51:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CLI-317] NullPointerException thrown by CommandLineParser.parse()</title>
                <link>https://issues.apache.org/jira/browse/CLI-317</link>
                <project id="12310463" key="CLI">Commons CLI</project>
                    <description>&lt;ol&gt;
	&lt;li&gt;First at all, your &lt;b&gt;testAmbiguousLongWithoutEqualSingleDash&lt;/b&gt; does not lead to a AmbiguousOptionException&lt;/li&gt;
&lt;/ol&gt;


&lt;ol&gt;
	&lt;li&gt;For this same test, if I replace the deprecated OptionBuilder with Option.Builder as follows
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
options.addOption(Option.builder().option(&lt;span class=&quot;code-quote&quot;&gt;&quot;f&quot;&lt;/span&gt;).longOpt(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;).optionalArg(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;).build());
options.addOption(Option.builder().option(&lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;).longOpt(&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;).optionalArg(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;).build());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;the test leads to a NPE&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.NullPointerException
	at xx.DefaultParser.handleShortAndLongOption(DefaultParser.java:476)
	at xx.DefaultParser.handleToken(DefaultParser.java:535)
	at xx.DefaultParser.parse(DefaultParser.java:714)
	at xx.DefaultParser.parse(DefaultParser.java:677)
	at xx.DefaultParser.parse(DefaultParser.java:654)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&lt;em&gt;Note&lt;/em&gt;&#160; : tested with Github code (January 22, 2023)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13520965">CLI-317</key>
            <summary>NullPointerException thrown by CommandLineParser.parse()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="PhBastiani">Philippe Bastiani</reporter>
                        <labels>
                            <label>exception</label>
                    </labels>
                <created>Mon, 23 Jan 2023 09:52:16 +0000</created>
                <updated>Sun, 20 Aug 2023 05:06:52 +0000</updated>
                            <resolved>Sat, 19 Aug 2023 13:29:37 +0000</resolved>
                                    <version>1.5.0</version>
                                    <fixVersion>1.6.0</fixVersion>
                                    <component>Parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17681310" author="garydgregory" created="Fri, 27 Jan 2023 12:46:24 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=PhBastiani&quot; class=&quot;user-hover&quot; rel=&quot;PhBastiani&quot;&gt;PhBastiani&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thank you for your report.&lt;/p&gt;

&lt;p&gt;The most expedient way to move this forward and avoid confusion would be to create a standalone test method or class anyone can paste in the git master code base. To this effect, please attach a patch/diff or create a PR on GitHub for a failing test.&lt;/p&gt;

&lt;p&gt;TY&lt;/p&gt;</comment>
                            <comment id="17749254" author="JIRAUSER301594" created="Mon, 31 Jul 2023 15:59:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=PhBastiani&quot; class=&quot;user-hover&quot; rel=&quot;PhBastiani&quot;&gt;PhBastiani&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;Should it really throw an exception?&lt;/p&gt;

&lt;p&gt;It has to consider bar as a value for the option foo. Correct?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17749753" author="JIRAUSER301594" created="Tue, 1 Aug 2023 13:37:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggregory&quot; class=&quot;user-hover&quot; rel=&quot;ggregory&quot;&gt;ggregory&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;In the deprecated OptionBuilder(), hasOptionalArg() is setting the argCount to 1 where as the Option.builder().optionalArg(boolean flag) isn&apos;t setting the argCount if the flag is true. This is most probably causing the NullPointerException.&lt;/p&gt;

&lt;p&gt;Please confirm if the argCount isn&apos;t set intentionally. If that is unintentional, I&apos;ll create a new Jira issue regarding the optionalArg method. You can assign me that Jira and I will fix it and raise PR. If that is intentional, I can upgrade this particular test case to new Option.builder() and fix the NullPointerException&lt;/p&gt;</comment>
                            <comment id="17750057" author="garydgregory" created="Wed, 2 Aug 2023 01:21:28 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;Would you please provide a complete test method?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17750340" author="JIRAUSER301594" created="Wed, 2 Aug 2023 13:47:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggregory&quot; class=&quot;user-hover&quot; rel=&quot;ggregory&quot;&gt;ggregory&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;The below one is throwing NullPointerException&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testAmbiguousLongWithoutEqualSingleDash() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args = {&lt;span class=&quot;code-quote&quot;&gt;&quot;-b&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;-foobar&quot;&lt;/span&gt;};

&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Options options = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Options();
&#160; &#160; &#160; &#160; options.addOption(Option.builder().option(&lt;span class=&quot;code-quote&quot;&gt;&quot;f&quot;&lt;/span&gt;).longOpt(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;).optionalArg(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;).build());
&#160; &#160; &#160; &#160; options.addOption(Option.builder().option(&lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;).longOpt(&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;).optionalArg(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;).build());


&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; CommandLine cl = parser.parse(options, args);

&#160; &#160; &#160; &#160; assertTrue(cl.hasOption(&lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;));
&#160; &#160; &#160; &#160; assertTrue(cl.hasOption(&lt;span class=&quot;code-quote&quot;&gt;&quot;f&quot;&lt;/span&gt;));
&#160; &#160; &#160; &#160; assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;, cl.getOptionValue(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;));
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;In &lt;b&gt;DefaultParser.handleShortAndLongOption&lt;/b&gt; method, line 484, we aren&apos;t checking if &lt;b&gt;currentOption&lt;/b&gt; is &lt;b&gt;NULL&lt;/b&gt; and directly calling &lt;b&gt;currentOption.addValueForProcessing&lt;/b&gt; method. This is the reason for NullPointerException&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17751301" author="JIRAUSER301594" created="Sat, 5 Aug 2023 10:47:46 +0000"  >&lt;p&gt;HI &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggregory&quot; class=&quot;user-hover&quot; rel=&quot;ggregory&quot;&gt;ggregory&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;Any update on this issue?&lt;/p&gt;</comment>
                            <comment id="17753813" author="garydgregory" created="Sun, 13 Aug 2023 19:46:15 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sruteeshp&quot; class=&quot;user-hover&quot; rel=&quot;sruteeshp&quot;&gt;sruteeshp&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=PhBastiani&quot; class=&quot;user-hover&quot; rel=&quot;PhBastiani&quot;&gt;PhBastiani&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thank you for your patience!&lt;/p&gt;

&lt;p&gt;I added &lt;tt&gt;ParserTestCase#testAmbiguousLongWithoutEqualSingleDash2()&lt;/tt&gt;, local tests and the GitHub builds are green.&lt;/p&gt;

&lt;p&gt;Please try git master or a snapshot build from &lt;a href=&quot;https://repository.apache.org/content/repositories/snapshots/commons-cli/commons-cli/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/repositories/snapshots/commons-cli/commons-cli/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If you get an exception, post the stack trace.&lt;/p&gt;

&lt;p&gt;Unless I am missing something...&lt;/p&gt;

&lt;p&gt;TY!&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17754851" author="JIRAUSER301594" created="Wed, 16 Aug 2023 04:19:12 +0000"  >&lt;p&gt;Hello Gary&lt;/p&gt;

&lt;p&gt;You forgot to add Test annotation to src/test/java/org/apache/commons/cli/ &lt;a href=&quot;http://ParserTestCase.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ParserTestCase.java&lt;/a&gt;  testAmbiguousLongWithoutEqualSingleDash2() &lt;/p&gt;

&lt;p&gt;I have forked the repo, made some changes and the build is failed&lt;/p&gt;

&lt;p&gt;Go through the following repo (&lt;a href=&quot;https://issues.apache.org/jira/browse/CLI-317&quot; title=&quot;NullPointerException thrown by CommandLineParser.parse()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CLI-317&quot;&gt;&lt;del&gt;CLI-317&lt;/del&gt;&lt;/a&gt;-NPE branch):&lt;/p&gt;

&lt;p&gt; &lt;a href=&quot;https://github.com/kumarp149/commons-cli/commits/CLI-317-NPE&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/kumarp149/commons-cli/commits/CLI-317-NPE&lt;/a&gt; &lt;/p&gt;

&lt;p&gt;Go through the following github action:&lt;br/&gt;
 &lt;a href=&quot;https://github.com/kumarp149/commons-cli/actions/runs/5874485562&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/kumarp149/commons-cli/actions/runs/5874485562&lt;/a&gt; &lt;/p&gt;


&lt;p&gt;The build is failing with NPE. Kindly check once&lt;/p&gt;</comment>
                            <comment id="17755092" author="garydgregory" created="Wed, 16 Aug 2023 14:40:49 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sruteeshp&quot; class=&quot;user-hover&quot; rel=&quot;sruteeshp&quot;&gt;sruteeshp&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;You&apos;re right, the &lt;tt&gt;Test&lt;/tt&gt; annotation is missing but the next as it is now fails for a different reason, which may reveal a different issue. The point is that the NPE has been fixed in git master.&lt;/p&gt;</comment>
                            <comment id="17755134" author="JIRAUSER301594" created="Wed, 16 Aug 2023 15:00:41 +0000"  >&lt;p&gt;HI &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggregory&quot; class=&quot;user-hover&quot; rel=&quot;ggregory&quot;&gt;ggregory&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;I think, test case with CommandLineParser is still giving NPE while the ones with GnuParser and PosixParser are giving IllegalArgumentException&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Kindly check it once&lt;/p&gt;</comment>
                            <comment id="17756309" author="garydgregory" created="Sat, 19 Aug 2023 12:54:32 +0000"  >&lt;p&gt;The build passes for me locally based on the head of git master but the test &lt;tt&gt;AbstractParserTestCase.testAmbiguousLongWithoutEqualSingleDash2()&lt;/tt&gt; is not run.&lt;/p&gt;

&lt;p&gt;Please test git master again, I just pushed some updates.&lt;/p&gt;

&lt;p&gt;Do note that &lt;tt&gt;testAmbiguousLongWithoutEqualSingleDash()&lt;/tt&gt; is disabled in all subclasses of &lt;tt&gt;AbstractParserTestCase&lt;/tt&gt; except &lt;tt&gt;DefaultParserTest&lt;/tt&gt;, so I did the same for the &quot;2&quot; version of the test method.&lt;/p&gt;

&lt;p&gt;This is also in snapshot builds: &#160;&lt;a href=&quot;https://repository.apache.org/content/repositories/snapshots/commons-cli/commons-cli/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/repositories/snapshots/commons-cli/commons-cli/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17756442" author="JIRAUSER301594" created="Sun, 20 Aug 2023 05:06:52 +0000"  >&lt;p&gt;HI &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggregory&quot; class=&quot;user-hover&quot; rel=&quot;ggregory&quot;&gt;ggregory&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;The issue seems resolved now as the argCount is initialized to 1 for optionalArg true&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 12 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1fals:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>