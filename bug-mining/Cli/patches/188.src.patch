diff --git a/src/main/java/org/apache/commons/cli/DefaultParser.java b/src/main/java/org/apache/commons/cli/DefaultParser.java
index c7de0a28..f8230811 100644
--- a/src/main/java/org/apache/commons/cli/DefaultParser.java
+++ b/src/main/java/org/apache/commons/cli/DefaultParser.java
@@ -136,7 +136,7 @@ public class DefaultParser implements CommandLineParser
      *
      * @param properties The value properties to be processed.
      */
-    private void handleProperties(Properties properties)
+    private void handleProperties(Properties properties) throws ParseException
     {
         if (properties == null)
         {
@@ -169,7 +169,8 @@ public class DefaultParser implements CommandLineParser
                     continue;
                 }
                 
-                cmd.addOption(opt);
+                handleOption(opt);
+                currentOption = null;
             }
         }
     }
diff --git a/src/main/java/org/apache/commons/cli/Parser.java b/src/main/java/org/apache/commons/cli/Parser.java
index c106932a..eecfb821 100644
--- a/src/main/java/org/apache/commons/cli/Parser.java
+++ b/src/main/java/org/apache/commons/cli/Parser.java
@@ -249,7 +249,7 @@ public abstract class Parser implements CommandLineParser
      *
      * @param properties The value properties to be processed.
      */
-    protected void processProperties(Properties properties)
+    protected void processProperties(Properties properties) throws ParseException
     {
         if (properties == null)
         {
@@ -291,6 +291,7 @@ public abstract class Parser implements CommandLineParser
                 }
 
                 cmd.addOption(opt);
+                updateRequiredOptions(opt);
             }
         }
     }
@@ -376,7 +377,27 @@ public abstract class Parser implements CommandLineParser
 
         // get the option represented by arg
         Option opt = (Option) getOptions().getOption(arg).clone();
+        
+        // update the required options and groups
+        updateRequiredOptions(opt);
+        
+        // if the option takes an argument value
+        if (opt.hasArg())
+        {
+            processArgs(opt, iter);
+        }
+        
+        // set the option on the command line
+        cmd.addOption(opt);
+    }
 
+    /**
+     * Removes the option or its group from the list of expected elements.
+     * 
+     * @param opt
+     */
+    private void updateRequiredOptions(Option opt) throws ParseException
+    {
         // if the option is a required option remove the option from
         // the requiredOptions list
         if (opt.isRequired())
@@ -397,14 +418,5 @@ public abstract class Parser implements CommandLineParser
 
             group.setSelected(opt);
         }
-
-        // if the option takes an argument value
-        if (opt.hasArg())
-        {
-            processArgs(opt, iter);
-        }
-
-        // set the option on the command line
-        cmd.addOption(opt);
     }
 }
diff --git a/src/test/java/org/apache/commons/cli/ParserTestCase.java b/src/test/java/org/apache/commons/cli/ParserTestCase.java
index 30373d15..effebdb1 100644
--- a/src/test/java/org/apache/commons/cli/ParserTestCase.java
+++ b/src/test/java/org/apache/commons/cli/ParserTestCase.java
@@ -986,4 +986,16 @@ public abstract class ParserTestCase extends TestCase
         assertEquals( "ink", cmd.getOptionValue("i") );
         assertTrue( !cmd.hasOption("fake") );
     }
+
+    public void testPropertyOptionRequired() throws Exception
+    {
+        Options opts = new Options();
+        opts.addOption(OptionBuilder.isRequired().create("f"));
+        
+        Properties properties = new Properties();
+        properties.setProperty("f", "true");
+        
+        CommandLine cmd = parse(parser, opts, null, properties);
+        assertTrue(cmd.hasOption("f"));
+    }
 }
