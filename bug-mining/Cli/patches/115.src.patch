diff --git a/src/java/org/apache/commons/cli/PosixParser.java b/src/java/org/apache/commons/cli/PosixParser.java
index fe01ceb6..a93b73f5 100644
--- a/src/java/org/apache/commons/cli/PosixParser.java
+++ b/src/java/org/apache/commons/cli/PosixParser.java
@@ -108,17 +108,22 @@ public class PosixParser extends Parser {
             // get the next command line token
             String token = (String) iter.next();
 
-            // handle SPECIAL TOKEN
+            // handle long option --foo or --foo=bar
             if (token.startsWith("--"))
             {
-                if (token.indexOf('=') != -1)
+                int pos = token.indexOf('=');
+                String opt = pos == -1 ? token : token.substring(0, pos); // --foo
+
+                if (!options.hasOption(opt) && stopAtNonOption)
                 {
-                    tokens.add(token.substring(0, token.indexOf('=')));
-                    tokens.add(token.substring(token.indexOf('=') + 1, token.length()));
+                    process(token);
                 }
                 else
                 {
-                    tokens.add(token);
+                    tokens.add(opt);
+                    if (pos != -1) {
+                        tokens.add(token.substring(pos + 1));
+                    }
                 }
             }
 
diff --git a/src/test/org/apache/commons/cli/PosixParserTest.java b/src/test/org/apache/commons/cli/PosixParserTest.java
index b487f2f3..95cf6672 100644
--- a/src/test/org/apache/commons/cli/PosixParserTest.java
+++ b/src/test/org/apache/commons/cli/PosixParserTest.java
@@ -156,6 +156,19 @@ public class PosixParserTest extends TestCase
         assertTrue("Confirm  3 extra args: " + cl.getArgList().size(), cl.getArgList().size() == 3);
     }
 
+    public void testStop3() throws Exception
+    {
+        String[] args = new String[]{"--zop==1",
+                                     "-abtoast",
+                                     "--b=bar"};
+
+        CommandLine cl = parser.parse(options, args, true);
+
+        assertFalse("Confirm -a is not set", cl.hasOption("a"));
+        assertFalse("Confirm -b is not set", cl.hasOption("b"));
+        assertTrue("Confirm  3 extra args: " + cl.getArgList().size(), cl.getArgList().size() == 3);
+    }
+
     public void testStopBursting() throws Exception
     {
         String[] args = new String[] { "-azc" };
