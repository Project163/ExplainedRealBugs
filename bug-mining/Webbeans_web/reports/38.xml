<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:15:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OWB-669] Bean fail over is not in sync with specs</title>
                <link>https://issues.apache.org/jira/browse/OWB-669</link>
                <project id="12310844" key="OWB">OpenWebBeans</project>
                    <description>&lt;p&gt;The current fail over logic is not in sync with the servlet specs as discussed with mark:&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/openwebbeans-dev/201204.mbox/%3C1335357714.89803.YahooMailNeo@web171502.mail.ir2.yahoo.com%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mail-archives.apache.org/mod_mbox/openwebbeans-dev/201204.mbox/%3C1335357714.89803.YahooMailNeo@web171502.mail.ir2.yahoo.com%3E&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The fail over logic should be moved from the ServletRequestListener to an Filter/Valve.&lt;/p&gt;
</description>
                <environment>Tomcat 7.0.22+, Memcached Session Manager, OWB 1.1.3/4</environment>
        <key id="12555140">OWB-669</key>
            <summary>Bean fail over is not in sync with specs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="struberg">Mark Struberg</assignee>
                                    <reporter username="tandraschko">Thomas Andraschko</reporter>
                        <labels>
                    </labels>
                <created>Mon, 14 May 2012 14:33:41 +0000</created>
                <updated>Sun, 30 Sep 2012 10:06:11 +0000</updated>
                            <resolved>Wed, 8 Aug 2012 22:10:46 +0000</resolved>
                                    <version>1.1.3</version>
                    <version>1.1.4</version>
                                    <fixVersion>1.1.5</fixVersion>
                                    <component>Context and Scopes</component>
                    <component>Simple Web Beans</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13274616" author="tandraschko" created="Mon, 14 May 2012 14:35:27 +0000"  >&lt;p&gt;I implemented a filter + reverted a change from mark.&lt;br/&gt;
Works without problems in my environemnt now.&lt;/p&gt;</comment>
                            <comment id="13280186" author="struberg" created="Mon, 21 May 2012 14:43:53 +0000"  >&lt;p&gt;The filter is fine, but we must not use the SessionContextManager directly! This is a (dirty) implementation detail of the web plugin and should not be used for other aspects.&lt;/p&gt;</comment>
                            <comment id="13280194" author="tandraschko" created="Mon, 21 May 2012 14:56:10 +0000"  >&lt;p&gt;I don&apos;t know but with your change, the failover was broken! I would not change it again if it would work &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13280198" author="struberg" created="Mon, 21 May 2012 15:05:24 +0000"  >&lt;p&gt;I&apos;m not a fan of fiddling around in sources until they magically work. This usually leads to tons of unused source which is unmaintainable. I&apos;ll fix this properly, rest assured&lt;/p&gt;</comment>
                            <comment id="13280483" author="tandraschko" created="Mon, 21 May 2012 21:02:12 +0000"  >&lt;p&gt;OFC you are right but you have also done some &quot;fiddling&quot; which destroyed the failover mechanism.&lt;/p&gt;

&lt;p&gt;It worked in the old version before your changes, so i reverted your changes to &quot;fix&quot; it. I don&apos;t know much about OWB internals and i currently don&apos;t have that much time to understand the difference between SessionContextManager and ContextsService, so this is just a patch to fix the failover.&lt;/p&gt;

&lt;p&gt;Do not take it amiss.&lt;/p&gt;

&lt;p&gt;If your changes are done, just ping me. I will test it.&lt;/p&gt;
</comment>
                            <comment id="13280799" author="struberg" created="Tue, 22 May 2012 08:18:58 +0000"  >&lt;p&gt;yes, no worries. I see what you mean. It&apos;s just that I consider the original code as quite a mess &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I&apos;m currently working on this stuff again and I&apos;m available on IRC.&lt;/p&gt;</comment>
                            <comment id="13280885" author="struberg" created="Tue, 22 May 2012 11:21:22 +0000"  >&lt;p&gt;Mea culpa, Thomas! Your change was indeed needed. I confused the eviction part (which I now cleaned up) with the restore logic. &lt;br/&gt;
I&apos;ve now applied your patch with some minor cleanup - again thanks a lot for helping!&lt;/p&gt;

&lt;p&gt;Btw, Activating that stuff is still a big of a mess. What do you folks think about adding a JNDI configuration for enabling the FailOver. That way people would not need to have any openwebbeans.properties with &quot;org.apache.webbeans.web.failover.issupportfailover=true&quot; anymore, but could enable this via JNDI on the production tomcat.&lt;/p&gt;

&lt;p&gt;The filter could automatically be installed in the openwebbeans-tomcat6 and 7 ContextLifecycleListener via context.addFilterDef and context.addFilterMap.&lt;/p&gt;</comment>
                            <comment id="13411970" author="struberg" created="Wed, 11 Jul 2012 20:39:26 +0000"  >&lt;p&gt;I&apos;ve looked at the automatic Filter registration. Looks like this is a chicken-egg problem. OpenWebBeans is not yet started at the time we need to register the FailOverFilter. &lt;/p&gt;

&lt;p&gt;Thus it&apos;s hard to ask OWB for the configuration and better let the user manually add this feature.&lt;/p&gt;</comment>
                            <comment id="13416929" author="pavel.arnost" created="Wed, 18 Jul 2012 07:52:56 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I&apos;m using FailOverFilter from Thomas&apos;s patch and session passivation works quite well on Tomcat 7.0.29. But in DefaultOwbFailOverService.restoreBeans method I found &quot;session.removeAttribute(getFailOverAttributeName());&quot; call after beans are restored - what&apos;s the purpose of that? Because now, when sessions are passivated in Filter, when I reload/restart Tomcat two times, I lost all sessions if I don&apos;t &quot;refresh&quot; (passivate) them with HTTP requests.&lt;/p&gt;

&lt;p&gt;Regards,&lt;br/&gt;
Pavel&lt;/p&gt;</comment>
                            <comment id="13416931" author="struberg" created="Wed, 18 Jul 2012 08:00:07 +0000"  >&lt;p&gt;good question. Reopening the Issue until this got clarified.&lt;/p&gt;</comment>
                            <comment id="13417237" author="struberg" created="Wed, 18 Jul 2012 16:46:19 +0000"  >&lt;p&gt;Pavel, it sounds like there is a hook missing which triggers the FailOver mechanism if HttpSessionActivationListener#sessionWillActivate gets invoked. Did you add the FailOverBagWrapper as servlet listener in your web.xml?&lt;/p&gt;</comment>
                            <comment id="13417327" author="pavel.arnost" created="Wed, 18 Jul 2012 18:08:31 +0000"  >&lt;p&gt;Hi, no, I didn&apos;t know that I should do that. Nevertheless, after I have added:&lt;/p&gt;

&lt;p&gt;    &amp;lt;listener&amp;gt;&lt;br/&gt;
        &amp;lt;listener-class&amp;gt;org.apache.webbeans.web.failover.FailOverBagWrapper&amp;lt;/listener-class&amp;gt;&lt;br/&gt;
    &amp;lt;/listener&amp;gt;&lt;/p&gt;

&lt;p&gt;to web.xml, situation is the same. After two redeploys, the session is lost.&lt;/p&gt;

&lt;p&gt;Do you think the problem is in a session activation? I think the problem is in fact that serialized beans are removed from session attribute after first redeploy and are not passivated before second redeploy.&lt;/p&gt;</comment>
                            <comment id="13431451" author="struberg" created="Wed, 8 Aug 2012 22:10:38 +0000"  >&lt;p&gt;The underlying issue might have to do with sessionId rewriting. In any case it&apos;s a different bug than the one of this report.&lt;br/&gt;
Pavel, I&apos;ll close this issue. Can you please open a new bug report for your problem?&lt;br/&gt;
Otherwise I cannot mark the first part as ready for 1.1.5&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310051">
                    <name>Supercedes</name>
                                            <outwardlinks description="supercedes">
                                        <issuelink>
            <issuekey id="12542710">OWB-646</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12526764" name="OWB-669.patch" size="6278" author="tandraschko" created="Mon, 14 May 2012 14:35:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239390</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 15 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i088mn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>45997</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>