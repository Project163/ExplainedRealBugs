<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:15:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OWB-385] implement passivation of managed beans in ServletContextListener</title>
                <link>https://issues.apache.org/jira/browse/OWB-385</link>
                <project id="12310844" key="OWB">OpenWebBeans</project>
                    <description>&lt;p&gt;Message-ID: &amp;lt;267326.60362.qm@web38203.mail.mud.yahoo.com&amp;gt;&lt;/p&gt;

&lt;p&gt;Currently we have no support for those callbacks for managed beans. Also includes AroundTimeout method.&lt;/p&gt;

&lt;p&gt;Motivation&lt;br/&gt;
----------------------&lt;br/&gt;
Actually we have 2 methods in  WebBeansConfigurationListener. Currently our session and conversation context does not provided actiovation/passivation. What we have to do is that we update below lifecycle callbacks to put all session and conversation context instances into the session in the &quot;sessionWillPassivate&quot; and call passivate callback, and reverse it on &quot;sessionDidActivate&quot;.&lt;/p&gt;

&lt;p&gt;Those areas needs some contributions &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;   /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;{@inheritDoc}&lt;br/&gt;
    */&lt;br/&gt;
   @Override&lt;br/&gt;
   public void sessionDidActivate(HttpSessionEvent event)&lt;br/&gt;
   {
       //TODO activation
      //Gets all passivated instances from passivated session and restore our session and conversation context.
   }&lt;br/&gt;
&lt;br/&gt;
   /**&lt;br/&gt;
    * {@inheritDoc}
&lt;p&gt;    */&lt;br/&gt;
   @Override&lt;br/&gt;
   public void sessionWillPassivate(HttpSessionEvent event)&lt;/p&gt;
   {
       //TODO Passivation
      //Gets all instances from the Session and ConversationContexts
       and add those into the session that is under passivation therefore our bean instances
       are correctly passivated
   }
&lt;p&gt;Thanks;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12465494">OWB-385</key>
            <summary>implement passivation of managed beans in ServletContextListener</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yingwang">Ying Wang</assignee>
                                    <reporter username="covener">Eric Covener</reporter>
                        <labels>
                    </labels>
                <created>Wed, 26 May 2010 18:31:05 +0000</created>
                <updated>Tue, 7 Sep 2010 09:56:10 +0000</updated>
                            <resolved>Mon, 30 Aug 2010 08:11:23 +0000</resolved>
                                    <version>1.0.0-alpha-1</version>
                                    <fixVersion>1.0.0-alpha-2</fixVersion>
                                    <component>Context and Scopes</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="216000">60h</timeoriginalestimate>
                            <timeestimate seconds="216000">60h</timeestimate>
                                        <comments>
                            <comment id="12893030" author="yingwang" created="Wed, 28 Jul 2010 01:42:42 +0000"  >&lt;p&gt;My plan is to first add basic failover/passivation support for conversation , session scope beans. Then continue improving it to handle build-in beans and other senarios. &lt;/p&gt;</comment>
                            <comment id="12893092" author="struberg" created="Wed, 28 Jul 2010 07:22:54 +0000"  >&lt;p&gt;which paragraph in the spec defines this behaviour?&lt;/p&gt;</comment>
                            <comment id="12893188" author="yingwang" created="Wed, 28 Jul 2010 14:37:00 +0000"  >&lt;p&gt;6.6.1 and 6.6.3 define the beans and scopes, including session scope and conversation scope that passivating capable.  My idea is to provide an SPI and a default implementation, which allow vendors to replace it with their own service to support failover and passivation for those beans. &lt;/p&gt;</comment>
                            <comment id="12893192" author="struberg" created="Wed, 28 Jul 2010 14:49:29 +0000"  >&lt;p&gt;I honestly do not yet see the problem you like to solve &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
What do you like to achieve by adding your solution?&lt;/p&gt;

&lt;p&gt;We need to tweak our SessionContext and ConversationContext of course, but that&apos;s a completely different story.&lt;/p&gt;</comment>
                            <comment id="12893213" author="yingwang" created="Wed, 28 Jul 2010 15:32:17 +0000"  >&lt;p&gt;The main target is to, at application level to config(enable/disable), allow a service to failover managed bean instances to other JVMs in a cluster environment or passivate them to other storage.  Also some owb contexts/managers needs to  be improved to support this (serialization related). &lt;/p&gt;</comment>
                            <comment id="12893218" author="struberg" created="Wed, 28 Jul 2010 15:49:07 +0000"  >&lt;p&gt;ok I c. I think we have to put a lot of work into real cluster support. I&apos;d prefer to store our beans in the Session and let the container perform session distribution instead of doing this ourselfs. Because swapping beans only partially might be hard to do right.&lt;/p&gt;</comment>
                            <comment id="12894661" author="yingwang" created="Mon, 2 Aug 2010 19:19:29 +0000"  >&lt;p&gt;Hi Guys, please review the changes under this bug. Basic failover /passivation service is added (not enabled by default) if the container is support session failover.  I did not have a chance to make changes for build-in beans yet. Will do it later. &lt;/p&gt;</comment>
                            <comment id="12894833" author="gerdogdu" created="Tue, 3 Aug 2010 06:24:33 +0000"  >&lt;p&gt;Fantastic work YING, I will try it this evening! Thanks a lot!&lt;/p&gt;</comment>
                            <comment id="12895189" author="struberg" created="Wed, 4 Aug 2010 08:55:35 +0000"  >&lt;p&gt;please allow me a few questions:&lt;/p&gt;

&lt;p&gt;1.) please use a simple svn diff on the commandline for creating patchfiles. Eclipse generated patchfiles are most times horribly broken!&lt;/p&gt;

&lt;p&gt;2.) why do we need to use Externalizable over Serializable? We do just transport in java modus and not in our own format or XML and stuff.&lt;/p&gt;

&lt;p&gt;3.) did it compile? I get  &lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; You have 43 Checkstyle violations.&lt;/p&gt;</comment>
                            <comment id="12895196" author="struberg" created="Wed, 4 Aug 2010 09:56:11 +0000"  >&lt;p&gt;another question:&lt;br/&gt;
Generally all the Session will get serialized at once and not single beans. Replacing single beans would imo be completely uncontrolable and most probably lead to inconsistencies.&lt;/p&gt;

&lt;p&gt;There are 2 common scenarios for such a clustering&lt;/p&gt;

&lt;p&gt;1.) using session replication via memcached &lt;a href=&quot;http://code.google.com/p/memcached-session-manager/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://code.google.com/p/memcached-session-manager/&lt;/a&gt;&lt;br/&gt;
2.) run a EE cluster like geronimo&lt;/p&gt;

&lt;p&gt;In both cases, the session will always get passivated as a &lt;em&gt;whole&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;So isn&apos;t a simle HttpSessionActivationListener which just moves the current threads SessionContext and ConversationContext into the Session and back enough?&lt;/p&gt;</comment>
                            <comment id="12895202" author="struberg" created="Wed, 4 Aug 2010 10:17:04 +0000"  >&lt;p&gt;not sure if this issue basically boils down to being a duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/OWB-338&quot; title=&quot;our internal SessionContext and ConversationContext must support Session serialization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OWB-338&quot;&gt;&lt;del&gt;OWB-338&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12895893" author="yingwang" created="Fri, 6 Aug 2010 00:40:02 +0000"  >&lt;p&gt;Sorry, fogot checkstyle. the second patch fixed CS issues and 2 minor bugs in the code. Please try this one. The reasons of using Externalizable are:&lt;/p&gt;

&lt;p&gt;1. Java ObjectStreams will not work for proxies. So we use a wrapper to do the work by using javassit object streams.&lt;br/&gt;
2.  For performance reason, we just need to transfer passivation id instead of beans. (some fields of bean class is hard to be serialized).  &lt;br/&gt;
3. the failover bag holds a sessioncontext and a map of conversationcontexts. It does not handle each individual beans.&lt;/p&gt;

&lt;p&gt;To enable, please define:&lt;/p&gt;

&lt;p&gt;org.apache.webbeans.spi.FailOverService=org.apache.webbeans.web.failover.DefaultOwbFailOverService&lt;br/&gt;
org.apache.webbeans.web.failover.issupportfailover=true&lt;br/&gt;
org.apache.webbeans.web.failover.issupportpassivation=true&lt;/p&gt;

&lt;p&gt;In my test, I have one proxy server =&amp;gt;1 cluster of 2 servers. access the application through the proxy server, then kill the server served the requests, then continue accessing the app, both session scope/conversation bean instances are failovered to the other server.&lt;/p&gt;


</comment>
                            <comment id="12895968" author="gerdogdu" created="Fri, 6 Aug 2010 06:33:54 +0000"  >&lt;p&gt;YING, could you commit the code ?&lt;/p&gt;</comment>
                            <comment id="12896026" author="struberg" created="Fri, 6 Aug 2010 12:34:09 +0000"  >&lt;p&gt;yes, please go on. Looks much better now!&lt;br/&gt;
I don&apos;t particularly like things like &lt;br/&gt;
        catch (Throwable e) &lt;/p&gt;
        {
            e.printStackTrace();
        }
&lt;p&gt;without any further handling, but we can fix this later on.&lt;/p&gt;</comment>
                            <comment id="12906728" author="struberg" created="Tue, 7 Sep 2010 09:56:10 +0000"  >&lt;p&gt;closed with release OpenWebBeans-1.0.0-alpha-2&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12460247">OWB-338</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12451064" name="owb-385-1.patch" size="33361" author="yingwang" created="Mon, 2 Aug 2010 19:19:29 +0000"/>
                            <attachment id="12451398" name="owb-385-2.patch" size="35102" author="yingwang" created="Fri, 6 Aug 2010 00:40:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>162762</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 11 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0873j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>45749</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>