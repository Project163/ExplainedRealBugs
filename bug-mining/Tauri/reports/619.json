{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/13456","repository_url":"https://api.github.com/repos/tauri-apps/tauri","labels_url":"https://api.github.com/repos/tauri-apps/tauri/issues/13456/labels{/name}","comments_url":"https://api.github.com/repos/tauri-apps/tauri/issues/13456/comments","events_url":"https://api.github.com/repos/tauri-apps/tauri/issues/13456/events","html_url":"https://github.com/tauri-apps/tauri/issues/13456","id":3070360662,"node_id":"I_kwDOC7lts863AfxW","number":13456,"title":"[bug] \"library 'app' not found\" when building for any iOS simulator on macOS x86_64","user":{"login":"diegum","id":5099384,"node_id":"MDQ6VXNlcjUwOTkzODQ=","avatar_url":"https://avatars.githubusercontent.com/u/5099384?v=4","gravatar_id":"","url":"https://api.github.com/users/diegum","html_url":"https://github.com/diegum","followers_url":"https://api.github.com/users/diegum/followers","following_url":"https://api.github.com/users/diegum/following{/other_user}","gists_url":"https://api.github.com/users/diegum/gists{/gist_id}","starred_url":"https://api.github.com/users/diegum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/diegum/subscriptions","organizations_url":"https://api.github.com/users/diegum/orgs","repos_url":"https://api.github.com/users/diegum/repos","events_url":"https://api.github.com/users/diegum/events{/privacy}","received_events_url":"https://api.github.com/users/diegum/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1449401604,"node_id":"MDU6TGFiZWwxNDQ5NDAxNjA0","url":"https://api.github.com/repos/tauri-apps/tauri/labels/type:%20bug","name":"type: bug","color":"B60205","default":false,"description":""},{"id":4288483270,"node_id":"LA_kwDOC7lts87_nQ_G","url":"https://api.github.com/repos/tauri-apps/tauri/labels/status:%20needs%20triage","name":"status: needs triage","color":"059372","default":false,"description":"This issue needs to triage, applied to new issues"},{"id":4901406421,"node_id":"LA_kwDOC7lts88AAAABJCWG1Q","url":"https://api.github.com/repos/tauri-apps/tauri/labels/platform:%20iOS","name":"platform: iOS","color":"fef2c0","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"lucasfernog","id":20051258,"node_id":"MDQ6VXNlcjIwMDUxMjU4","avatar_url":"https://avatars.githubusercontent.com/u/20051258?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasfernog","html_url":"https://github.com/lucasfernog","followers_url":"https://api.github.com/users/lucasfernog/followers","following_url":"https://api.github.com/users/lucasfernog/following{/other_user}","gists_url":"https://api.github.com/users/lucasfernog/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasfernog/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasfernog/subscriptions","organizations_url":"https://api.github.com/users/lucasfernog/orgs","repos_url":"https://api.github.com/users/lucasfernog/repos","events_url":"https://api.github.com/users/lucasfernog/events{/privacy}","received_events_url":"https://api.github.com/users/lucasfernog/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"lucasfernog","id":20051258,"node_id":"MDQ6VXNlcjIwMDUxMjU4","avatar_url":"https://avatars.githubusercontent.com/u/20051258?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasfernog","html_url":"https://github.com/lucasfernog","followers_url":"https://api.github.com/users/lucasfernog/followers","following_url":"https://api.github.com/users/lucasfernog/following{/other_user}","gists_url":"https://api.github.com/users/lucasfernog/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasfernog/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasfernog/subscriptions","organizations_url":"https://api.github.com/users/lucasfernog/orgs","repos_url":"https://api.github.com/users/lucasfernog/repos","events_url":"https://api.github.com/users/lucasfernog/events{/privacy}","received_events_url":"https://api.github.com/users/lucasfernog/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":12,"created_at":"2025-05-17T05:07:47Z","updated_at":"2025-08-28T21:16:44Z","closed_at":"2025-08-28T21:16:44Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nWhen trying to run a brand new Tauri project on any iOS simulator on a macOS x86_64 host, it will fail to archive the .ipa. The cause is a missing arm64 `libapp.a` when it should actually look for the x86_64 counterpart.\n\nIndeed, on a macOS x86_64 host, all simulator images are x86_64. The build process correctly creates an x86_64 `libapp.a` static library under `./src-tauri/gen/apple/Externals/x86_64/debug/`\n\nThe build completes successfully, but the archiving phase fails when attempting to link a non-existing `libapp.a` from `./src-tauri/gen/apple/Externals/arm64/debug` (`arm64` instead of `x86-64`).\n\nIf I weren't building for the simulator, looking for an `arm64`library would make sense because actual iOS devices are `arm` architectures. But any iOS simulator on an x86_64 macOS host does require an `x86_64` `libapp.a` just like the one built in the previous phase.\n\nMy only workaround for this is to temporarily erase `arm64` from `VALID_ARCHS` on the Build Settings page for the project target:\n\n```\n-                               VALID_ARCHS = \"arm64  x86_64\";\n+                               VALID_ARCHS = x86_64;\n```\n\nBut it's just a patch: I'll need it back when building for a physical iOS device or for the App Store.\n\n### Reproduction\n\n1. Create a plain vanilla Tauri project on an Intel macOS. Get into its directory\n```\n$ npm create tauri-app@latest\n$ cd <project directory>\n```\n\n2. Proceed with the regular project initialization\n```\n$ npm install\n$ npm run tauri ios init\n```\n\n3. So far, so good. Now run it on any simulator:\n```\n$ npm run tauri ios dev\n\n> pijarolata-hervida@0.1.0 tauri\n> tauri ios dev\n\n/usr/local/bin/ios-deploy\n        Info package `ios-deploy` present: true\nDetected iOS simulators:\n  [0] iPad (A16) (iOS 18.5)\n  [1] iPad (A16) (iOS 18.4)\n  [2] iPad Air 11-inch (M3) (iOS 18.5)\n  ...\n  [20] iPhone 16e (iOS 18.5)\n  [21] iPhone 16e (iOS 18.4)\n  Enter an index for a simulator above.\nSimulator: 9\n        Info Starting simulator iPad Pro 13-inch (M4)\n     Running BeforeDevCommand (`npm run dev`)\n...\nBuilding app...\nCommand line invocation:\n    /opt/xcode/16.3/Xcode.app/Contents/Developer/usr/bin/xcodebuild -allowProvisioningUpdates -destination id=5E14CA7A-3404-4B76-8AE2-1717801638A6 -scheme pijarolata-hervida_iOS -workspace /Users/zatanna/Development/pijarolata-hervida/src-tauri/gen/apple/pijarolata-hervida.xcodeproj/project.xcworkspace/ -sdk iphonesimulator -configuration debug build\n...\n\n** BUILD SUCCEEDED **\n\nArchiving app...\n--- xcodebuild: WARNING: Using the first of multiple matching destinations:\n{ platform:iOS Simulator, id:dvtdevice-DVTiOSDeviceSimulatorPlaceholder-iphonesimulator:placeholder, name:Any iOS Simulator Device }\n{ platform:iOS Simulator, arch:x86_64, id:FA97BDCB-E643-4758-AB7D-601E69EEE7C2, OS:18.4, name:iPad (A16) }\n{ platform:iOS Simulator, arch:x86_64, id:8EA31F5E-6D2B-4016-9F97-336B0C8EED1E, OS:18.5, name:iPad (A16) }\n{ platform:iOS Simulator, arch:x86_64, id:C0C05E3D-6C5B-4E63-8C07-CAB23AFE2D91, OS:18.4, name:iPad Air 11-inch (M3) }\n...\n{ platform:iOS Simulator, arch:x86_64, id:F16C9A2F-7EDB-4C2D-A04B-D6EA2C31720F, OS:18.4, name:iPhone 16e }\n{ platform:iOS Simulator, arch:x86_64, id:8DF5971A-ADD9-4A9A-A21F-F35358DFF70F, OS:18.5, name:iPhone 16e }\n{ platform:iOS, id:dvtdevice-DVTiPhonePlaceholder-iphoneos:placeholder, name:Any iOS Device }\n        Info connection; remote_addr=127.0.0.1:52335 conn_id=1\nld: library 'app' not found\nclang++: error: linker command failed with exit code 1 (use -v to see invocation)\nnote: Run script build phase 'Build Rust Code' will be run during every build because the option to run the script phase \"Based on dependency analysis\" is unchecked. (in target 'pijarolata-hervida_iOS' from project 'pijarolata-hervida')\n** ARCHIVE FAILED **\n\nFailed to archive via `xcodebuild`: command [\"xcodebuild\"] exited with code 65: command [\"xcodebuild\"] exited with code 65\n       Error Failed to archive via `xcodebuild`: command [\"xcodebuild\"] exited with code 65: command [\"xcodebuild\"] exited with code 65\n```\n\n### Expected behavior\n\nThe app archiving ends OK and the app gets launched on the simulator:\n\n```\nArchiving app...\n--- xcodebuild: WARNING: Using the first of multiple matching destinations:\n{ platform:iOS Simulator, id:dvtdevice-DVTiOSDeviceSimulatorPlaceholder-iphonesimulator:placeholder, name:Any iOS Simulator Device }\n{ platform:iOS Simulator, arch:x86_64, id:FA97BDCB-E643-4758-AB7D-601E69EEE7C2, OS:18.4, name:iPad (A16) }\n{ platform:iOS Simulator, arch:x86_64, id:8EA31F5E-6D2B-4016-9F97-336B0C8EED1E, OS:18.5, name:iPad (A16) }\n{ platform:iOS Simulator, arch:x86_64, id:C0C05E3D-6C5B-4E63-8C07-CAB23AFE2D91, OS:18.4, name:iPad Air 11-inch (M3) }\n...\n{ platform:iOS Simulator, arch:x86_64, id:F16C9A2F-7EDB-4C2D-A04B-D6EA2C31720F, OS:18.4, name:iPhone 16e }\n{ platform:iOS Simulator, arch:x86_64, id:8DF5971A-ADD9-4A9A-A21F-F35358DFF70F, OS:18.5, name:iPhone 16e }\n{ platform:iOS, id:dvtdevice-DVTiPhonePlaceholder-iphoneos:placeholder, name:Any iOS Device }\n        Info connection; remote_addr=127.0.0.1:52335 conn_id=1\nDeploying app to device...\ncom.pijarolata-hervida.app: 30924\n        Info Watching /Users/zatanna/Development/pijarolata-hervida/src-tauri for changes...\ngetpwuid_r did not find a match for uid 501\nFiltering the log data using \"subsystem == \"com.pijarolata-hervida.app\"\"\n```\n\n### Full `tauri info` output\n\n```text\n$  npm run tauri info             \n\n> pijarolata-hervida@0.1.0 tauri\n> tauri info\n\n\n[âœ”] Environment\n    - OS: Mac OS 15.5.0 x86_64 (X64)\n    âœ” Xcode Command Line Tools: installed\n    âœ” rustc: 1.87.0 (17067e9ac 2025-05-09)\n    âœ” cargo: 1.87.0 (99624be96 2025-05-06)\n    âœ” rustup: 1.28.2 (e4f3ad6f8 2025-04-28)\n    âœ” Rust toolchain: stable-x86_64-apple-darwin (default)\n    - node: 22.15.1\n    - npm: 10.9.2\n\n[-] Packages\n    - tauri ðŸ¦€: 2.5.1\n    - tauri-build ðŸ¦€: 2.2.0\n    - wry ðŸ¦€: 0.51.2\n    - tao ðŸ¦€: 0.33.0\n    - @tauri-apps/api îœ˜: 2.5.0\n    - @tauri-apps/cli îœ˜: 2.5.0\n\n[-] Plugins\n    - tauri-plugin-opener ðŸ¦€: 2.2.6\n    - @tauri-apps/plugin-opener îœ˜: 2.2.6\n\n[-] App\n    - build-type: bundle\n    - CSP: unset\n    - frontendDist: ../dist\n    - devUrl: http://localhost:1420/\n    - framework: Vue.js\n    - bundler: Vite\n\n[-] iOS\n    - Developer Teams: Diego Dagum (ID: 2LTM2LDD9P)\n```\n\n### Stack trace\n\n```text\nThere's none. This issue happens at build time.\n```\n\n### Additional context\n\nOdds are that this issue only happens on Intel macOS and not on its Silicon sibling. On Silicon Macs, both target and host are on a similar `arm64` architecture. There wouldn't be conflict, then.","closed_by":{"login":"lucasfernog","id":20051258,"node_id":"MDQ6VXNlcjIwMDUxMjU4","avatar_url":"https://avatars.githubusercontent.com/u/20051258?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasfernog","html_url":"https://github.com/lucasfernog","followers_url":"https://api.github.com/users/lucasfernog/followers","following_url":"https://api.github.com/users/lucasfernog/following{/other_user}","gists_url":"https://api.github.com/users/lucasfernog/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasfernog/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasfernog/subscriptions","organizations_url":"https://api.github.com/users/lucasfernog/orgs","repos_url":"https://api.github.com/users/lucasfernog/repos","events_url":"https://api.github.com/users/lucasfernog/events{/privacy}","received_events_url":"https://api.github.com/users/lucasfernog/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/13456/reactions","total_count":4,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tauri-apps/tauri/issues/13456/timeline","performed_via_github_app":null,"state_reason":"completed"}