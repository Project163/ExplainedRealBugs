{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/3061","repository_url":"https://api.github.com/repos/tauri-apps/tauri","labels_url":"https://api.github.com/repos/tauri-apps/tauri/issues/3061/labels{/name}","comments_url":"https://api.github.com/repos/tauri-apps/tauri/issues/3061/comments","events_url":"https://api.github.com/repos/tauri-apps/tauri/issues/3061/events","html_url":"https://github.com/tauri-apps/tauri/issues/3061","id":1078013457,"node_id":"I_kwDOC7lts85AQS4R","number":3061,"title":"Change `SetupHook` from `Box<dyn Fn(...)...>` to `Box<dyn FnOnce(...)...>`","user":{"login":"itsjunetime","id":61218022,"node_id":"MDQ6VXNlcjYxMjE4MDIy","avatar_url":"https://avatars.githubusercontent.com/u/61218022?v=4","gravatar_id":"","url":"https://api.github.com/users/itsjunetime","html_url":"https://github.com/itsjunetime","followers_url":"https://api.github.com/users/itsjunetime/followers","following_url":"https://api.github.com/users/itsjunetime/following{/other_user}","gists_url":"https://api.github.com/users/itsjunetime/gists{/gist_id}","starred_url":"https://api.github.com/users/itsjunetime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itsjunetime/subscriptions","organizations_url":"https://api.github.com/users/itsjunetime/orgs","repos_url":"https://api.github.com/users/itsjunetime/repos","events_url":"https://api.github.com/users/itsjunetime/events{/privacy}","received_events_url":"https://api.github.com/users/itsjunetime/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":3307089819,"node_id":"MDU6TGFiZWwzMzA3MDg5ODE5","url":"https://api.github.com/repos/tauri-apps/tauri/labels/type:%20feature%20request","name":"type: feature request","color":"446DBA","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-12-13T02:26:23Z","updated_at":"2021-12-27T13:50:39Z","closed_at":"2021-12-27T13:50:39Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Is your feature request related to a problem? Please describe.**\r\nThe `SetupHook` type utilizes `Fn()` instead of `FnOnce()`, even though it is only run once. This prevents users from moving values into the setup closure on `tauri::Builder`, and makes it so that users have to utilize extra workarounds to achieve the result that they're looking for.\r\n\r\n**Describe the solution you'd like**\r\nChange the `SetupHook` type to `Box<dyn FnOnce(&mut App<R>) -> Result<(), Box<dyn std::error::Error + Send>> + Send>`, and change the `F` generic parameter in `tauri::Builder::setup` to `FnOnce(&mut App<R>) -> Result<(), Box<dyn std::error::Error + Send>> + Send + 'static`. As far as I can tell (and have tested), this should be totally possible, since `setup` is only run once, [here](https://github.com/tauri-apps/tauri/blob/next/core/tauri/src/app.rs#L1088).\r\n\r\n**Describe alternatives you've considered**\r\nAs far as I know, there aren't really any alternatives within tauri to produce the same result without this proposed solution. If there are any that I'm not thinking of, I'd love to hear and consider them.\r\n\r\n**Additional context**\r\nNothing that I know of.\r\n\r\nIf I am incorrect in any assumptions here or not clear enough in any part of it, please let me know :) I would also be happy to submit a PR with the needed changes if this change is desired.","closed_by":{"login":"lucasfernog","id":20051258,"node_id":"MDQ6VXNlcjIwMDUxMjU4","avatar_url":"https://avatars.githubusercontent.com/u/20051258?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasfernog","html_url":"https://github.com/lucasfernog","followers_url":"https://api.github.com/users/lucasfernog/followers","following_url":"https://api.github.com/users/lucasfernog/following{/other_user}","gists_url":"https://api.github.com/users/lucasfernog/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasfernog/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasfernog/subscriptions","organizations_url":"https://api.github.com/users/lucasfernog/orgs","repos_url":"https://api.github.com/users/lucasfernog/repos","events_url":"https://api.github.com/users/lucasfernog/events{/privacy}","received_events_url":"https://api.github.com/users/lucasfernog/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/3061/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tauri-apps/tauri/issues/3061/timeline","performed_via_github_app":null,"state_reason":"completed"}