{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/10746","repository_url":"https://api.github.com/repos/tauri-apps/tauri","labels_url":"https://api.github.com/repos/tauri-apps/tauri/issues/10746/labels{/name}","comments_url":"https://api.github.com/repos/tauri-apps/tauri/issues/10746/comments","events_url":"https://api.github.com/repos/tauri-apps/tauri/issues/10746/events","html_url":"https://github.com/tauri-apps/tauri/issues/10746","id":2482572694,"node_id":"I_kwDOC7lts86T-Q2W","number":10746,"title":"[bug][linux][v2] App window is not properly focused on creation since v2","user":{"login":"vemonet","id":3778439,"node_id":"MDQ6VXNlcjM3Nzg0Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/3778439?v=4","gravatar_id":"","url":"https://api.github.com/users/vemonet","html_url":"https://github.com/vemonet","followers_url":"https://api.github.com/users/vemonet/followers","following_url":"https://api.github.com/users/vemonet/following{/other_user}","gists_url":"https://api.github.com/users/vemonet/gists{/gist_id}","starred_url":"https://api.github.com/users/vemonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vemonet/subscriptions","organizations_url":"https://api.github.com/users/vemonet/orgs","repos_url":"https://api.github.com/users/vemonet/repos","events_url":"https://api.github.com/users/vemonet/events{/privacy}","received_events_url":"https://api.github.com/users/vemonet/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1449401604,"node_id":"MDU6TGFiZWwxNDQ5NDAxNjA0","url":"https://api.github.com/repos/tauri-apps/tauri/labels/type:%20bug","name":"type: bug","color":"B60205","default":false,"description":""},{"id":3310698084,"node_id":"MDU6TGFiZWwzMzEwNjk4MDg0","url":"https://api.github.com/repos/tauri-apps/tauri/labels/platform:%20Linux","name":"platform: Linux","color":"fef2c0","default":false,"description":""},{"id":4288483270,"node_id":"LA_kwDOC7lts87_nQ_G","url":"https://api.github.com/repos/tauri-apps/tauri/labels/status:%20needs%20triage","name":"status: needs triage","color":"059372","default":false,"description":"This issue needs to triage, applied to new issues"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2024-08-23T08:08:48Z","updated_at":"2024-11-13T19:04:48Z","closed_at":"2024-11-04T11:58:48Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nHi, I upgraded from v1 to the latest v2 RC, and the window is not focused anymore on creation, even though I have set `focus: true` in the `tauri.conf.json`\r\n\r\nI also added those permissions to the `capabilities/main.json`:\r\n\r\n```json\r\n    \"core:window:default\",\r\n    \"core:window:allow-set-focus\",\r\n```\r\n\r\nNote that tauri v2 docs still mention `focus` in the window config: https://v2.tauri.app/reference/config/#windowconfig\n\n### Reproduction\n\nRelevant project where I use tauri: https://github.com/vemonet/EmojiMart\r\n\r\nMinimal repro:\r\n1. Initialize new tauri project for solidjs: `npm create tauri-app@latest -- --rc`\r\n2. Enable focus in `tauri.conf.json`\r\n\r\n```json\r\n{\r\n  \"app\": {\r\n    \"windows\": [\r\n      {\r\n        \"title\": \"new-tauri-app\",\r\n        \"width\": 800,\r\n        \"height\": 600,\r\n        \"focus\": true\r\n      }\r\n    ],\r\n}\r\n```\r\n\r\n3. Enable permissions to close window in `src-tauri/capabilities/default.json`\r\n\r\n```json\r\n{\r\n  \"$schema\": \"../gen/schemas/desktop-schema.json\",\r\n  \"identifier\": \"default\",\r\n  \"description\": \"Capability for the main window\",\r\n  \"windows\": [\"main\"],\r\n  \"permissions\": [\r\n    \"shell:allow-open\",\r\n    \"core:window:default\",\r\n    \"core:window:allow-close\",\r\n    \"core:window:allow-set-focus\"\r\n  ]\r\n}\r\n```\r\n\r\n4. Add code to close window when hitting esc key (to find out if the window is focused or not) in `src/App.tsx`\r\n```ts\r\nimport { getCurrentWindow } from \"@tauri-apps/api/window\";\r\n\r\nfunction App() {\r\n  // ...\r\n  onMount(() => {\r\n    document.addEventListener('keypress', (event: any) => {\r\n      if (event.code === 'Escape') getCurrentWindow().close()\r\n    })\r\n  })\r\n  // ...\r\n}\r\n```\r\n\r\n5. Start the app in dev with `npm run tauri dev`\r\n6. Try to hit esc after the window pop (without clicking on the window or hitting tab): the window does not close, because it is not focused properly. If you click on the window or hit tab then the window is focused and esc will properly close hit.\n\n### Expected behavior\n\nWhen the tauri app window pops it should be fully focus without the need to click on it or hit tab (which was the behavior in tauri v1)\n\n### Full `tauri info` output\n\n```text\n[✔] Environment\r\n    - OS: Ubuntu 22.04 X64\r\n    ✔ webkit2gtk-4.1: 2.44.2\r\n    ✔ rsvg2: 2.52.5\r\n    ✔ rustc: 1.80.1 (3f5fd8dd4 2024-08-06)\r\n    ✔ cargo: 1.80.1 (376290515 2024-07-16)\r\n    ✔ rustup: 1.27.1 (54dd3d00f 2024-04-24)\r\n    ✔ Rust toolchain: stable-x86_64-unknown-linux-gnu (default)\r\n    - node: 20.17.0\r\n    - yarn: 1.22.22\r\n    - npm: 10.8.2\r\n\r\n[-] Packages\r\n    - tauri [RUST]: 2.0.0-rc.6\r\n    - tauri-build [RUST]: 2.0.0-rc.6\r\n    - wry [RUST]: 0.42.0\r\n    - tao [RUST]: 0.29.1\r\n    - @tauri-apps/api [NPM]: 2.0.0-rc.3\r\n    - @tauri-apps/cli [NPM]: 2.0.0-rc.7\r\n\r\n[-] App\r\n    - build-type: bundle\r\n    - CSP: unset\r\n    - frontendDist: ../build\r\n    - devUrl: http://localhost:5173/\r\n    - framework: Svelte\r\n    - bundler: Vite\n```\n\n\n### Stack trace\n\n_No response_\n\n### Additional context\n\n_No response_","closed_by":{"login":"amrbashir","id":48618675,"node_id":"MDQ6VXNlcjQ4NjE4Njc1","avatar_url":"https://avatars.githubusercontent.com/u/48618675?v=4","gravatar_id":"","url":"https://api.github.com/users/amrbashir","html_url":"https://github.com/amrbashir","followers_url":"https://api.github.com/users/amrbashir/followers","following_url":"https://api.github.com/users/amrbashir/following{/other_user}","gists_url":"https://api.github.com/users/amrbashir/gists{/gist_id}","starred_url":"https://api.github.com/users/amrbashir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amrbashir/subscriptions","organizations_url":"https://api.github.com/users/amrbashir/orgs","repos_url":"https://api.github.com/users/amrbashir/repos","events_url":"https://api.github.com/users/amrbashir/events{/privacy}","received_events_url":"https://api.github.com/users/amrbashir/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/10746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tauri-apps/tauri/issues/10746/timeline","performed_via_github_app":null,"state_reason":"completed"}