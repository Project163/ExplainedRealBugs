{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/7273","repository_url":"https://api.github.com/repos/tauri-apps/tauri","labels_url":"https://api.github.com/repos/tauri-apps/tauri/issues/7273/labels{/name}","comments_url":"https://api.github.com/repos/tauri-apps/tauri/issues/7273/comments","events_url":"https://api.github.com/repos/tauri-apps/tauri/issues/7273/events","html_url":"https://github.com/tauri-apps/tauri/issues/7273","id":1766718612,"node_id":"I_kwDOC7lts85pTfyU","number":7273,"title":"[bug] two windows showing from dev command","user":{"login":"simonhyll","id":79983560,"node_id":"MDQ6VXNlcjc5OTgzNTYw","avatar_url":"https://avatars.githubusercontent.com/u/79983560?v=4","gravatar_id":"","url":"https://api.github.com/users/simonhyll","html_url":"https://github.com/simonhyll","followers_url":"https://api.github.com/users/simonhyll/followers","following_url":"https://api.github.com/users/simonhyll/following{/other_user}","gists_url":"https://api.github.com/users/simonhyll/gists{/gist_id}","starred_url":"https://api.github.com/users/simonhyll/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simonhyll/subscriptions","organizations_url":"https://api.github.com/users/simonhyll/orgs","repos_url":"https://api.github.com/users/simonhyll/repos","events_url":"https://api.github.com/users/simonhyll/events{/privacy}","received_events_url":"https://api.github.com/users/simonhyll/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1449401604,"node_id":"MDU6TGFiZWwxNDQ5NDAxNjA0","url":"https://api.github.com/repos/tauri-apps/tauri/labels/type:%20bug","name":"type: bug","color":"B60205","default":false,"description":""},{"id":4288483270,"node_id":"LA_kwDOC7lts87_nQ_G","url":"https://api.github.com/repos/tauri-apps/tauri/labels/status:%20needs%20triage","name":"status: needs triage","color":"059372","default":false,"description":"This issue needs to triage, applied to new issues"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2023-06-21T05:34:49Z","updated_at":"2023-06-28T00:28:16Z","closed_at":"2023-06-28T00:28:16Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\r\n\r\nA user reported an issue in the Discord server about having 2 windows popping up for them. After quite a bit of debugging we discovered that the cause of the issue was that the CLI is trying to connect to Github to fetch the metadata.json file to check if there's a newer version available. Because they live in India with the Jio ISP they aren't allowed to connect to Github however they want. The issue seems to be that when they launch one dev command it takes like 15-20 seconds or so for it to exit, and the culprit appears to be the update checking. When they connect to a VPN the issue goes away. That's right, they get 2 windows popping up, and the fix it connecting to a VPN. Logic üëçüèª\r\n\r\nThe issue appears to be caused by an orphaned process as a result of improper handling of abrupt closing of the app. If they sit patiently and wait for it to exit, there's no issue. It only happens when they exit the app prematurely with ctrl + c.\r\n\r\n### Reproduction\r\n\r\nThere shouldn't be anything special about the project setup, the issue is in the CLI. So set up a basic CTA project and run it as per usual. The trick is that the user in question with the issue is in a country where the ISP doesn't allow connecting to Github however they want, so they had to use a VPN solution for it. So not entirely sure how to replicate it if you're not in one of those countries. Maybe VPN into one of those countries.\r\n1. Move to India\r\n2. Get internet from the ISP \"Jio\"\r\n3. `yarn create tauri-app`\r\n4. `yarn tauri dev`\r\n5. ctrl + c out of the app because it takes like 20 seconds for it to exit\r\n6. `yarn tauri dev`\r\n\r\nYou should now be seeing 2 windows.\r\n\r\n### Expected behavior\r\n\r\nOne window should appear, not two. The update checking should've exited immediately and not been the cause of some orphaned process in the background causing issues.\r\n\r\nMy suggestion for resolving this is moving the functionality away from the `dev` command entirely, split it off into a dedicated `check-updates` command instead.\r\n\r\nIn addition to this we still need to add some more proper handling of the update checker so that there's no orphaned processes. If the dev command had exited properly in the first place this issue probably wouldn't have surfaced.\r\n\r\n### Platform and versions\r\n\r\n```text\r\nyarn run v1.22.19\r\n$ tauri info\r\n\r\n[‚úî] Environment\r\n    - OS: Windows 10.0.22621 X64\r\n    ‚úî WebView2: 114.0.1823.51\r\n    ‚úî MSVC: Visual Studio Community 2022\r\n    ‚úî rustc: 1.70.0-nightly (9df3a39fb 2023-04-11)\r\n    ‚úî Cargo: 1.70.0-nightly (7bf43f028 2023-04-10)\r\n    ‚úî rustup: 1.25.2 (17db695f1 2023-02-01)\r\n    ‚úî Rust toolchain: nightly-x86_64-pc-windows-msvc (default)\r\n    - node: 18.15.0\r\n    - yarn: 1.22.19\r\n    - npm: 9.5.0\r\n\r\n[-] Packages\r\n    - tauri [RUST]: 1.4.1\r\n    - tauri-build [RUST]: 1.4.0\r\n    - wry [RUST]: 0.24.3\r\n    - tao [RUST]: 0.16.2\r\n    - @tauri-apps/api [NPM]: 1.4.0\r\n    - @tauri-apps/cli [NPM]: 1.4.0\r\n\r\n[-] App\r\n    - build-type: bundle\r\n    - CSP: unset\r\n    - distDir: ../dist\r\n    - devPath: http://localhost:1420/\r\n    - framework: Svelte\r\n    - bundler: Vite\r\nDone in 10.31s.\r\n```\r\n\r\n\r\n### Stack trace\r\n\r\n_No response_\r\n\r\n### Additional context\r\n\r\nThe affected user goes by the name \"Best\" with handle \"bestc\" in the Discord server.\r\n\r\n### Workaround\r\n\r\nIf you're affected by this you can try the debug version of the CLI instead since it shouldn't be checking for updates. Or you can get a VPN.\r\n`cargo install tauri-cli --debug`","closed_by":{"login":"amrbashir","id":48618675,"node_id":"MDQ6VXNlcjQ4NjE4Njc1","avatar_url":"https://avatars.githubusercontent.com/u/48618675?v=4","gravatar_id":"","url":"https://api.github.com/users/amrbashir","html_url":"https://github.com/amrbashir","followers_url":"https://api.github.com/users/amrbashir/followers","following_url":"https://api.github.com/users/amrbashir/following{/other_user}","gists_url":"https://api.github.com/users/amrbashir/gists{/gist_id}","starred_url":"https://api.github.com/users/amrbashir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amrbashir/subscriptions","organizations_url":"https://api.github.com/users/amrbashir/orgs","repos_url":"https://api.github.com/users/amrbashir/repos","events_url":"https://api.github.com/users/amrbashir/events{/privacy}","received_events_url":"https://api.github.com/users/amrbashir/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/7273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tauri-apps/tauri/issues/7273/timeline","performed_via_github_app":null,"state_reason":"completed"}