{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/11614","repository_url":"https://api.github.com/repos/tauri-apps/tauri","labels_url":"https://api.github.com/repos/tauri-apps/tauri/issues/11614/labels{/name}","comments_url":"https://api.github.com/repos/tauri-apps/tauri/issues/11614/comments","events_url":"https://api.github.com/repos/tauri-apps/tauri/issues/11614/events","html_url":"https://github.com/tauri-apps/tauri/issues/11614","id":2640785545,"node_id":"I_kwDOC7lts86dZzCJ","number":11614,"title":"[bug] \"forbidden path\" when calling `exists` with absolute resource path for non-existing file","user":{"login":"Phippe","id":34287258,"node_id":"MDQ6VXNlcjM0Mjg3MjU4","avatar_url":"https://avatars.githubusercontent.com/u/34287258?v=4","gravatar_id":"","url":"https://api.github.com/users/Phippe","html_url":"https://github.com/Phippe","followers_url":"https://api.github.com/users/Phippe/followers","following_url":"https://api.github.com/users/Phippe/following{/other_user}","gists_url":"https://api.github.com/users/Phippe/gists{/gist_id}","starred_url":"https://api.github.com/users/Phippe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Phippe/subscriptions","organizations_url":"https://api.github.com/users/Phippe/orgs","repos_url":"https://api.github.com/users/Phippe/repos","events_url":"https://api.github.com/users/Phippe/events{/privacy}","received_events_url":"https://api.github.com/users/Phippe/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1449401604,"node_id":"MDU6TGFiZWwxNDQ5NDAxNjA0","url":"https://api.github.com/repos/tauri-apps/tauri/labels/type:%20bug","name":"type: bug","color":"B60205","default":false,"description":""},{"id":4288483270,"node_id":"LA_kwDOC7lts87_nQ_G","url":"https://api.github.com/repos/tauri-apps/tauri/labels/status:%20needs%20triage","name":"status: needs triage","color":"059372","default":false,"description":"This issue needs to triage, applied to new issues"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2024-11-07T11:46:41Z","updated_at":"2025-06-11T13:39:04Z","closed_at":"2024-11-19T22:50:11Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nI'm in the process of making my app compatible with Tauri 2.0 after upgrading to it recently. I'm trying to access files in the resource folder by fist calling `path.exists` like this:\r\n\r\n```ts\r\nlet filePath = await path.join(await path.resourceDir(), \"some_folder\", \"file.xlsx\");\r\nlet fileExists = await exists(filePath);\r\n```\r\n\r\nThis looked pretty much the same on Tauri 1.x and worked, but now on Tauri 2.0 I'm getting an exception:\r\n`forbidden path: D:\\path_to_repo\\src-tauri\\target\\debug\\some_folder\\file.xlsx`\r\n\r\nTwo weird things about all this:\r\n\r\n- This exception only happens if the file does not exist. If it exists, then the code above simply returns `true` as you would expect.\r\n- If I'm calling it with `baseDir` specified (`await exists(filePath, {baseDir: BaseDirectory.Resource})`), it doesn't result in an exception, but instead `exists` always returns `false` (I guess that makes sense now that I think about it).\r\n\r\nAlthough I'm not 100% sure how the new permission system works yet, I think my app should have the correct permissions to interact with the file:\r\n\r\n```json\r\n{\r\n  \"permissions\": [\r\n    \"fs:default\",\r\n    \"fs:allow-desktop-read-recursive\",\r\n    \"fs:allow-desktop-meta-recursive\",\r\n    \"fs:allow-resource-read-recursive\",\r\n    \"fs:allow-resource-meta-recursive\"\r\n  ]\r\n}\r\n```\r\n\r\nIn the end, using a base directory, this code worked:\r\n\r\n```ts\r\nlet filePath = await path.join(\"some_folder\", \"file.xlsx\");\r\nlet fileExists = await exists(filePath, {baseDir: BaseDirectory.Resource});\r\n```\r\n\r\nIn order to check whether it is a permission issue or not, I ran the same code for desktop files and experienced no issues doing that. All the results were correct and no exception happened.\n\n### Reproduction\n\nHere are the various tests I did, always for both an existing and a non-existing file. First are the resource accesses with the mentioned exception and the wrong results, followed by the desktop accesses with all correct results.\r\n\r\n```ts\r\nlet filePath = \"\";\r\n\r\n\r\n// Accessing resource\r\nconsole.log(\"\\n-----------------------\");\r\n\r\n// Relative path, using join and baseDir\r\nfilePath = await path.join(\"some_folder\", \"existing_file.xlsx\");\r\nconsole.log(filePath, await exists(filePath, {baseDir: BaseDirectory.Resource})); // true\r\nfilePath = await path.join(\"some_folder\", \"non_existing_file.xlsx\");\r\nconsole.log(filePath, await exists(filePath, {baseDir: BaseDirectory.Resource})); // false\r\n\r\n// Absolute path, using join, but no baseDir\r\nfilePath = await path.join(await path.resourceDir(), \"some_folder\", \"existing_file.xlsx\");\r\nconsole.log(filePath, await exists(filePath)); // true\r\nfilePath = await path.join(await path.resourceDir(), \"some_folder\", \"non_existing_file.xlsx\");\r\nconsole.log(filePath, await exists(filePath)); // exception, forbidden path\r\n\r\n// Absolute path, using join and baseDir\r\nfilePath = await path.join(await path.resourceDir(), \"some_folder\", \"existing_file.xlsx\");\r\nconsole.log(filePath, await exists(filePath, {baseDir: BaseDirectory.Resource})); // false, wrong result\r\nfilePath = await path.join(await path.resourceDir(), \"some_folder\", \"non_existing_file.xlsx\");\r\nconsole.log(filePath, await exists(filePath, {baseDir: BaseDirectory.Resource})); // false, probably \"wrong\" result\r\n\r\n\r\n// Now accessing desktop instead of resource\r\nconsole.log(\"\\n-----------------------\");\r\n\r\n// Relative path, using join and baseDir\r\nfilePath = await path.join(\"some_folder\", \"existing_file.xlsx\");\r\nconsole.log(filePath, await exists(filePath, {baseDir: BaseDirectory.Desktop})); // true\r\nfilePath = await path.join(\"some_folder\", \"non_existing_file.xlsx\");\r\nconsole.log(filePath, await exists(filePath, {baseDir: BaseDirectory.Desktop})); // false\r\n\r\n// Absolute path, using join, but no baseDir\r\nfilePath = await path.join(await path.desktopDir(), \"some_folder\", \"existing_file.xlsx\");\r\nconsole.log(filePath, await exists(filePath)); // true\r\nfilePath = await path.join(await path.desktopDir(), \"some_folder\", \"non_existing_file.xlsx\");\r\nconsole.log(filePath, await exists(filePath)); // false\r\n\r\n// Absolute path, using join and baseDir\r\nfilePath = await path.join(await path.desktopDir(), \"some_folder\", \"existing_file.xlsx\");\r\nconsole.log(filePath, await exists(filePath, {baseDir: BaseDirectory.Desktop})); // true\r\nfilePath = await path.join(await path.desktopDir(), \"some_folder\", \"non_existing_file.xlsx\");\r\nconsole.log(filePath, await exists(filePath, {baseDir: BaseDirectory.Desktop})); // false\r\n```\n\n### Expected behavior\n\nNo exception for this one:\r\n\r\n```ts\r\nlet filePath = await path.join(await path.resourceDir(), \"some_folder\", \"non_existing_file.xlsx\"); // non-existing file\r\nlet fileExists = await exists(filePath);\r\n```\r\n\r\nCorrect results for this one. Not that important, since the access technically shouldn't give correct results (you're appending the whole path to the base path), but it did work for the desktop directory, so...\r\n\r\n```ts\r\nlet filePath = await path.join(await path.resourceDir(), \"some_folder\", \"file.xlsx\"); // either existing or non-existing file\r\nlet fileExists = await exists(filePath, {baseDir: BaseDirectory.Resource});\r\n```\r\n\r\n\n\n### Full `tauri info` output\n\n```text\n[âœ”] Environment\r\n    - OS: Windows 10.0.22621 x86_64 (X64)\r\n    âœ” WebView2: 130.0.2849.56\r\n    âœ” MSVC: Visual Studio Community 2022\r\n    âœ” rustc: 1.82.0 (f6e511eec 2024-10-15)\r\n    âœ” cargo: 1.82.0 (8f40fc59f 2024-08-21)\r\n    âœ” rustup: 1.27.1 (54dd3d00f 2024-04-24)\r\n    âœ” Rust toolchain: stable-x86_64-pc-windows-msvc (default)\r\n    - node: 20.11.1\r\n    - pnpm: 8.15.5\r\n    - yarn: 1.22.21\r\n    - npm: 10.5.0\r\n\r\n[-] Packages\r\n    - tauri ðŸ¦€: 2.0.6\r\n    - tauri-build ðŸ¦€: 2.0.2\r\n    - wry ðŸ¦€: 0.46.3\r\n    - tao ðŸ¦€: 0.30.5\r\n    - @tauri-apps/api îœ˜: 2.0.3\r\n    - @tauri-apps/cli îœ˜: 2.0.5\r\n\r\n[-] Plugins\r\n    - tauri-plugin-fs ðŸ¦€: 2.0.3\r\n    - @tauri-apps/plugin-fs îœ˜: 2.0.2\r\n    - tauri-plugin-log ðŸ¦€: 2.0.2\r\n    - @tauri-apps/plugin-log îœ˜: 2.0.0\r\n    - tauri-plugin-window-state ðŸ¦€: 2.0.2\r\n    - @tauri-apps/plugin-window-state îœ˜: 2.0.0\r\n    - tauri-plugin-dialog ðŸ¦€: 2.0.3\r\n    - @tauri-apps/plugin-dialog îœ˜: 2.0.1\r\n    - tauri-plugin-shell ðŸ¦€: 2.0.2\r\n    - @tauri-apps/plugin-shell îœ˜: 2.0.1\r\n\r\n[-] App\r\n    - build-type: bundle\r\n    - CSP: unset\r\n    - frontendDist: ../dist\r\n    - devUrl: http://localhost:1420/\r\n    - framework: Vue.js\r\n    - bundler: Vite\n```\n\n\n### Stack trace\n\n_No response_\n\n### Additional context\n\n_No response_","closed_by":{"login":"amrbashir","id":48618675,"node_id":"MDQ6VXNlcjQ4NjE4Njc1","avatar_url":"https://avatars.githubusercontent.com/u/48618675?v=4","gravatar_id":"","url":"https://api.github.com/users/amrbashir","html_url":"https://github.com/amrbashir","followers_url":"https://api.github.com/users/amrbashir/followers","following_url":"https://api.github.com/users/amrbashir/following{/other_user}","gists_url":"https://api.github.com/users/amrbashir/gists{/gist_id}","starred_url":"https://api.github.com/users/amrbashir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amrbashir/subscriptions","organizations_url":"https://api.github.com/users/amrbashir/orgs","repos_url":"https://api.github.com/users/amrbashir/repos","events_url":"https://api.github.com/users/amrbashir/events{/privacy}","received_events_url":"https://api.github.com/users/amrbashir/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/11614/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tauri-apps/tauri/issues/11614/timeline","performed_via_github_app":null,"state_reason":"completed"}