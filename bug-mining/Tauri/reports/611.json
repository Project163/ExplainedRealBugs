{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/13461","repository_url":"https://api.github.com/repos/tauri-apps/tauri","labels_url":"https://api.github.com/repos/tauri-apps/tauri/issues/13461/labels{/name}","comments_url":"https://api.github.com/repos/tauri-apps/tauri/issues/13461/comments","events_url":"https://api.github.com/repos/tauri-apps/tauri/issues/13461/events","html_url":"https://github.com/tauri-apps/tauri/issues/13461","id":3070994024,"node_id":"I_kwDOC7lts863C6Zo","number":13461,"title":"[bug] android crashes when `url` is set on a `WebviewWindow`","user":{"login":"Vexcited","id":59152884,"node_id":"MDQ6VXNlcjU5MTUyODg0","avatar_url":"https://avatars.githubusercontent.com/u/59152884?v=4","gravatar_id":"","url":"https://api.github.com/users/Vexcited","html_url":"https://github.com/Vexcited","followers_url":"https://api.github.com/users/Vexcited/followers","following_url":"https://api.github.com/users/Vexcited/following{/other_user}","gists_url":"https://api.github.com/users/Vexcited/gists{/gist_id}","starred_url":"https://api.github.com/users/Vexcited/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Vexcited/subscriptions","organizations_url":"https://api.github.com/users/Vexcited/orgs","repos_url":"https://api.github.com/users/Vexcited/repos","events_url":"https://api.github.com/users/Vexcited/events{/privacy}","received_events_url":"https://api.github.com/users/Vexcited/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1449401604,"node_id":"MDU6TGFiZWwxNDQ5NDAxNjA0","url":"https://api.github.com/repos/tauri-apps/tauri/labels/type:%20bug","name":"type: bug","color":"B60205","default":false,"description":""},{"id":4288483270,"node_id":"LA_kwDOC7lts87_nQ_G","url":"https://api.github.com/repos/tauri-apps/tauri/labels/status:%20needs%20triage","name":"status: needs triage","color":"059372","default":false,"description":"This issue needs to triage, applied to new issues"},{"id":4901407158,"node_id":"LA_kwDOC7lts88AAAABJCWJtg","url":"https://api.github.com/repos/tauri-apps/tauri/labels/platform:%20Android","name":"platform: Android","color":"fef2c0","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2025-05-17T18:49:49Z","updated_at":"2025-07-09T20:08:39Z","closed_at":"2025-07-09T20:08:39Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nWhen setting an `url` on a `WebwiewWindow`, the app immediately crashes on Android.\nIt also happens when using the builder like this, during the `.setup()` in `tauri::Builder::default()` : \n\n```rust\nlet app_url = Url::parse(\"https://ecole-directe.plus/login\").unwrap();\nlet app_url_external = WebviewUrl::External(app_url);\nlet mut win = WebviewWindowBuilder::new(app, \"main\", app_url_external);\n// ...\n```\n\n### Reproduction\n\n- Create any project with `pnpm create tauri-app`\n- Run `pnpm tauri android init`\n- Update `src-tauri/tauri.conf.json` properties to set an external URL on `devUrl`, `frontendDist` and `windows[0].url` like the following, for example : \n```json\n{\n  \"$schema\": \"https://schema.tauri.app/config/2\",\n  \"productName\": \"tauri-app\",\n  \"version\": \"0.1.0\",\n  \"identifier\": \"com.tauri-app.app\",\n  \"build\": {\n    \"beforeDevCommand\": \"\",\n    \"devUrl\": \"https://ecole-directe.plus/login\",\n    \"beforeBuildCommand\": \"\",\n    \"frontendDist\": \"https://ecole-directe.plus/login\"\n  },\n  \"app\": {\n    \"withGlobalTauri\": true,\n    \"windows\": [\n      {\n        \"title\": \"tauri-app\",\n        \"url\": \"https://ecole-directe.plus/login\",\n        \"width\": 800,\n        \"height\": 600\n      }\n    ],\n    \"security\": {\n      \"csp\": null\n    }\n  },\n  \"bundle\": {\n    \"active\": true,\n    \"targets\": \"all\",\n    \"icon\": [\n      \"icons/32x32.png\",\n      \"icons/128x128.png\",\n      \"icons/128x128@2x.png\",\n      \"icons/icon.icns\",\n      \"icons/icon.ico\"\n    ]\n  }\n}\n```\n\n- Run `pnpm tauri android dev`\n- See the app crash on start !\n\n### Expected behavior\n\nThe app should not crash.\n\n### Full `tauri info` output\n\n```text\n[âœ”] Environment\n    - OS: Mac OS 15.5.0 arm64 (X64)\n    âœ” Xcode Command Line Tools: installed\n    âœ” rustc: 1.86.0 (05f9846f8 2025-03-31)\n    âœ” cargo: 1.86.0 (adf9b6ad1 2025-02-28)\n    âœ” rustup: 1.28.1 (f9edccde0 2025-03-05)\n    âœ” Rust toolchain: stable-aarch64-apple-darwin (default)\n    - node: 23.11.0\n    - pnpm: 10.9.0\n    - yarn: 1.22.22\n    - npm: 11.3.0\n    - bun: 1.2.13\n\n[-] Packages\n    - tauri ðŸ¦€: 2.5.1\n    - tauri-build ðŸ¦€: 2.2.0\n    - wry ðŸ¦€: 0.51.2\n    - tao ðŸ¦€: 0.33.0\n    - @tauri-apps/api îœ˜: 2.5.0\n    - @tauri-apps/cli îœ˜: 2.5.0\n\n[-] Plugins\n    - tauri-plugin-opener ðŸ¦€: 2.2.6\n    - @tauri-apps/plugin-opener îœ˜: 2.2.6\n\n[-] App\n    - build-type: bundle\n    - CSP: unset\n    - frontendDist: https://ecole-directe.plus/login\n    - devUrl: https://ecole-directe.plus/login\n    - bundler: Vite\n```\n\n### Stack trace\n\n```text\n05-17 20:39:40.868 15866 15913 I RustStdoutStderr: \n05-17 20:39:40.868 15866 15913 I RustStdoutStderr: thread '<unnamed>' panicked at /Users/vexcited/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tauri-2.5.1/src/manager/webview.rs:437:35:\n05-17 20:39:40.868 15866 15913 I RustStdoutStderr: called `Result::unwrap()` on an `Err` value: ()\n05-17 20:39:40.868 15866 15913 I RustStdoutStderr: note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\n```\n\n### Additional context\n\n`webview.rs:437`\n\n```rust\nWebviewUrl::External(url) => {\n  let config_url = app_manager.get_url(pending.webview_attributes.use_https_scheme);\n  let is_local = config_url.make_relative(url).is_some();\n  let mut url = url.clone();\n  if is_local && PROXY_DEV_SERVER {\n    url.set_scheme(\"tauri\").unwrap(); // LINE 437 !! Crashes when setting the scheme ?\n    url.set_host(Some(\"localhost\")).unwrap();\n  }\n  url\n}\n```","closed_by":{"login":"lucasfernog","id":20051258,"node_id":"MDQ6VXNlcjIwMDUxMjU4","avatar_url":"https://avatars.githubusercontent.com/u/20051258?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasfernog","html_url":"https://github.com/lucasfernog","followers_url":"https://api.github.com/users/lucasfernog/followers","following_url":"https://api.github.com/users/lucasfernog/following{/other_user}","gists_url":"https://api.github.com/users/lucasfernog/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasfernog/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasfernog/subscriptions","organizations_url":"https://api.github.com/users/lucasfernog/orgs","repos_url":"https://api.github.com/users/lucasfernog/repos","events_url":"https://api.github.com/users/lucasfernog/events{/privacy}","received_events_url":"https://api.github.com/users/lucasfernog/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/13461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tauri-apps/tauri/issues/13461/timeline","performed_via_github_app":null,"state_reason":"completed"}