{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/6944","repository_url":"https://api.github.com/repos/tauri-apps/tauri","labels_url":"https://api.github.com/repos/tauri-apps/tauri/issues/6944/labels{/name}","comments_url":"https://api.github.com/repos/tauri-apps/tauri/issues/6944/comments","events_url":"https://api.github.com/repos/tauri-apps/tauri/issues/6944/events","html_url":"https://github.com/tauri-apps/tauri/issues/6944","id":1705723943,"node_id":"I_kwDOC7lts85lq0gn","number":6944,"title":"[feat] Less strict MSRV enforcement","user":{"login":"FabianLars","id":30730186,"node_id":"MDQ6VXNlcjMwNzMwMTg2","avatar_url":"https://avatars.githubusercontent.com/u/30730186?v=4","gravatar_id":"","url":"https://api.github.com/users/FabianLars","html_url":"https://github.com/FabianLars","followers_url":"https://api.github.com/users/FabianLars/followers","following_url":"https://api.github.com/users/FabianLars/following{/other_user}","gists_url":"https://api.github.com/users/FabianLars/gists{/gist_id}","starred_url":"https://api.github.com/users/FabianLars/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FabianLars/subscriptions","organizations_url":"https://api.github.com/users/FabianLars/orgs","repos_url":"https://api.github.com/users/FabianLars/repos","events_url":"https://api.github.com/users/FabianLars/events{/privacy}","received_events_url":"https://api.github.com/users/FabianLars/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":3307089819,"node_id":"MDU6TGFiZWwzMzA3MDg5ODE5","url":"https://api.github.com/repos/tauri-apps/tauri/labels/type:%20feature%20request","name":"type: feature request","color":"446DBA","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"wusyong","id":8409985,"node_id":"MDQ6VXNlcjg0MDk5ODU=","avatar_url":"https://avatars.githubusercontent.com/u/8409985?v=4","gravatar_id":"","url":"https://api.github.com/users/wusyong","html_url":"https://github.com/wusyong","followers_url":"https://api.github.com/users/wusyong/followers","following_url":"https://api.github.com/users/wusyong/following{/other_user}","gists_url":"https://api.github.com/users/wusyong/gists{/gist_id}","starred_url":"https://api.github.com/users/wusyong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wusyong/subscriptions","organizations_url":"https://api.github.com/users/wusyong/orgs","repos_url":"https://api.github.com/users/wusyong/repos","events_url":"https://api.github.com/users/wusyong/events{/privacy}","received_events_url":"https://api.github.com/users/wusyong/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"wusyong","id":8409985,"node_id":"MDQ6VXNlcjg0MDk5ODU=","avatar_url":"https://avatars.githubusercontent.com/u/8409985?v=4","gravatar_id":"","url":"https://api.github.com/users/wusyong","html_url":"https://github.com/wusyong","followers_url":"https://api.github.com/users/wusyong/followers","following_url":"https://api.github.com/users/wusyong/following{/other_user}","gists_url":"https://api.github.com/users/wusyong/gists{/gist_id}","starred_url":"https://api.github.com/users/wusyong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wusyong/subscriptions","organizations_url":"https://api.github.com/users/wusyong/orgs","repos_url":"https://api.github.com/users/wusyong/repos","events_url":"https://api.github.com/users/wusyong/events{/privacy}","received_events_url":"https://api.github.com/users/wusyong/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":3,"created_at":"2023-05-11T12:24:47Z","updated_at":"2023-05-16T11:27:17Z","closed_at":"2023-05-16T11:27:17Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### tldr: Let's unpin our dependencies :)\r\n\r\nFor context the discord discussion i started that lead to this request: https://discord.com/channels/616186924390023171/986184168998330371/1106155646769954867\r\n\r\nNote that this request is not about the MSRV itself, though imo we should consider something like \"last 1 year of rust releases\" in V1, which means we could upgrade to 1.61 in a week. (i don't think 1 year is the healthiest approach, but we can take a more drastic change in v2 instead).\r\n\r\n----\r\n\r\n### Problem\r\n\r\nSince v1.0 we regularly had to lock dependencies on minor and patch versions because they upgraded their MSRV to a more recent version than what we promised to our users. In v1.3 we even had to pin `time` to 0.3.15. After one week we already had at least 2 users facing issues because of this. In this case\r\n1) was caused by `gix` requiring a min time version of 0.3.19\r\n2) was caused by user-side code being written with APIs from more recent time versions in tauri v1.2 who then tried to upgrade to v1.3\r\n\r\nAs time goes on we will have to lock more and more dependencies, causing more and more issues for end-users, just because we tried to make it easy for users that actually required a low MSRV (if we're being honest there probably isn't even one that needs a MSRV _that_ low but whatever).\r\n\r\n### Suggested solution\r\n\r\nGoing forward i think our approach should be a bit less \"forceful\":\r\n- No more dependency minor/patch pinning\r\n- Our code should still adhere to our MSRV, so no std apis introduced in newer Rust versions than what our MSRV allows\r\n- Set the **minimum** version of our dependencies to a version that is compatible to our MSRV. Of course we can't use apis of these crates that were introduced in a version that raised their MSRV too high.\r\n  - Taking `time` as an example the minimum version should be less or equal to `0.3.15` since that's the last version with a compatible MSRV - in this case `0.3` would be enough.\r\n\r\nThis way end-users can actually \"choose\" which MSRV they want:\r\n- If they want the latest of everything and their toolchain is always up to date, then they don't need to care about anything.\r\n- If they want to adhere to Tauri's MSRV for example, they have to make sure all their other dependencies have a compatible MSRV themselves, or with https://github.com/rust-lang/cargo/issues/9930 i guess cargo can potentially take care of that too.\r\n  - For example they could run `cargo update --package time --precise 0.3.15` to update their lockfile to make all dependencies use that version of `time`. Of course this requires that other crates also have to set appropriate _minimum_ dependency versions, **but this is not and should not be our problem**.\r\n\r\n----\r\n\r\nOne issue with this approach is that we'll likely have to start committing `Cargo.lock`, primarily to make sure the MSRV workflow keeps working, but i guess this could potentially \"soft lock\" the dependencies for users too which _should_ be a good thing in this context since that _should_ mean cargo will try to adhere to the lockfile and give users a MSRV compatible version until they run `cargo update` - this needs confirmation but this is what comments in and around the linked issue above sounded like to me.\r\n\r\nAlternatively there's https://doc.rust-lang.org/cargo/reference/unstable.html#minimal-versions which we _may_ be able to use too if we don't want to commit a lock file.\r\n\r\n----\r\n\r\nThis issue was written in the heat of the moment so i may update it later.","closed_by":{"login":"wusyong","id":8409985,"node_id":"MDQ6VXNlcjg0MDk5ODU=","avatar_url":"https://avatars.githubusercontent.com/u/8409985?v=4","gravatar_id":"","url":"https://api.github.com/users/wusyong","html_url":"https://github.com/wusyong","followers_url":"https://api.github.com/users/wusyong/followers","following_url":"https://api.github.com/users/wusyong/following{/other_user}","gists_url":"https://api.github.com/users/wusyong/gists{/gist_id}","starred_url":"https://api.github.com/users/wusyong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wusyong/subscriptions","organizations_url":"https://api.github.com/users/wusyong/orgs","repos_url":"https://api.github.com/users/wusyong/repos","events_url":"https://api.github.com/users/wusyong/events{/privacy}","received_events_url":"https://api.github.com/users/wusyong/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/6944/reactions","total_count":6,"+1":6,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tauri-apps/tauri/issues/6944/timeline","performed_via_github_app":null,"state_reason":"completed"}