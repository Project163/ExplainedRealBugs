{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/9707","repository_url":"https://api.github.com/repos/tauri-apps/tauri","labels_url":"https://api.github.com/repos/tauri-apps/tauri/issues/9707/labels{/name}","comments_url":"https://api.github.com/repos/tauri-apps/tauri/issues/9707/comments","events_url":"https://api.github.com/repos/tauri-apps/tauri/issues/9707/events","html_url":"https://github.com/tauri-apps/tauri/issues/9707","id":2286028783,"node_id":"I_kwDOC7lts86IQgfv","number":9707,"title":"[bug] Inconsistent handling of app identifiers containing hyphens when building for Android ","user":{"login":"Almost-Senseless-Coder","id":109462027,"node_id":"U_kgDOBoZCCw","avatar_url":"https://avatars.githubusercontent.com/u/109462027?v=4","gravatar_id":"","url":"https://api.github.com/users/Almost-Senseless-Coder","html_url":"https://github.com/Almost-Senseless-Coder","followers_url":"https://api.github.com/users/Almost-Senseless-Coder/followers","following_url":"https://api.github.com/users/Almost-Senseless-Coder/following{/other_user}","gists_url":"https://api.github.com/users/Almost-Senseless-Coder/gists{/gist_id}","starred_url":"https://api.github.com/users/Almost-Senseless-Coder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Almost-Senseless-Coder/subscriptions","organizations_url":"https://api.github.com/users/Almost-Senseless-Coder/orgs","repos_url":"https://api.github.com/users/Almost-Senseless-Coder/repos","events_url":"https://api.github.com/users/Almost-Senseless-Coder/events{/privacy}","received_events_url":"https://api.github.com/users/Almost-Senseless-Coder/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1449401604,"node_id":"MDU6TGFiZWwxNDQ5NDAxNjA0","url":"https://api.github.com/repos/tauri-apps/tauri/labels/type:%20bug","name":"type: bug","color":"B60205","default":false,"description":""},{"id":4288483270,"node_id":"LA_kwDOC7lts87_nQ_G","url":"https://api.github.com/repos/tauri-apps/tauri/labels/status:%20needs%20triage","name":"status: needs triage","color":"059372","default":false,"description":"This issue needs to triage, applied to new issues"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2024-05-08T16:49:41Z","updated_at":"2024-08-23T07:22:11Z","closed_at":"2024-08-21T16:46:26Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nLike most app development frameworks, Tauri uses reverse domain notation for the app identifiers.\r\n\r\nTauri only allows letters (`a-z`, `A-Z`), digits (`0-9`) and hyphens (`-`) in app identifiers. However, Android only allows underscores (`_`) in app identifiers, not hyphens; iOS, on the other hand, does allow hyphens, but no underscores.\r\n\r\nRight now, this means that running `cargo tauri android init` panics if the app identifier contains hyphens or alternatively only contains of two parts (I think the latter is unintended, anyway).\r\n\r\nTo illustrate, let's assume I have an app identifier like `tech.almost-senseless.jack-point`. Trying to build this app for Android fails with a panic due to the hyphen in `almost-senseless`. Renaming it to `tech.almostsenseless.jack-point` or `tech.almost-senseless` works fine, though: In the first case, the generated Android package name and identifier would be `tech.almostsenseless.jack_point`, and in the latter case it would be `tech.jack_point`.\r\n\r\nEvidently, the last part of the app identifier gets silently dropped and replaced with the product name, and in the product name, hyphens get replaced with underscores.\r\n\r\nThis has the side effect that running `cargo tauri android init` when the app identifier is `com.tauri.dev` works, by the way, because it becomes `com.tauri.jack_point` - I think that's not intended that way, is it?\r\n\r\nSo my problem boils down to that\r\n\r\n- Having hyphens in your app identifier shouldn't lead to a panic; rather, the hyphens should get replaced with underscores in the generated Android project.\r\n- The handling of the identifier should be more consistent, with the last part not getting silently dropped and replaced with the product name.\n\n### Reproduction\n\n- Create a Tauri project from any template, for instance using `cargo create-tauri-app --beta`. Please make sure mobile support was enabled.\r\n- Open `tauri.conf.json` and change the identifier to `com.some-domain.some-app`.\r\n- Run `cargo tauri android init`.\n\n### Expected behavior\n\nThe command should complete successfully, generating an Android project with the identifier `com.some_domain.some_app`.\n\n### Full `tauri info` output\n\n```text\nWARNING: no lock files found, defaulting to npm\r\n\r\n[✔] Environment\r\n    - OS: Windows 10.0.22631 X64\r\n    ✔ WebView2: 124.0.2478.80\r\n    ✔ MSVC: Visual Studio Community 2022\r\n    ✔ rustc: 1.80.0-nightly (e82c861d7 2024-05-04)\r\n    ✔ cargo: 1.80.0-nightly (05364cb2f 2024-05-03)\r\n    ✔ rustup: 1.27.0 (bbb9276d2 2024-03-08)\r\n    ✔ Rust toolchain: nightly-x86_64-pc-windows-msvc (environment override by RUSTUP_TOOLCHAIN)\r\n    - node: 20.11.0\r\n    - npm: 10.5.0\r\n\r\n[-] Packages\r\n    - tauri [RUST]: 2.0.0-beta.17\r\n    - tauri-build [RUST]: 2.0.0-beta.13\r\n    - wry [RUST]: 0.39.3\r\n    - tao [RUST]: 0.27.1\r\n    - tauri-cli [RUST]: 2.0.0-beta.16\r\n    - @tauri-apps/api : not installed!\r\n    - @tauri-apps/cli [NPM]: 2.0.0-beta.16\r\n\r\n[-] App\r\n    - build-type: bundle\r\n    - CSP: unset\r\n    - frontendDist: ../dist\r\n    - devUrl: http://localhost:1420/\r\n```\n```\n\n\n### Stack trace\n\n```text\nthread 'main' panicked at C:\\Users\\timjb\\.cargo\\registry\\src\\index.crates.io-6f17d22bba15001f\\tauri-cli-2.0.0-beta.16\\src\\mobile\\mod.rs:322:6:\r\ncalled `Result::unwrap()` on an `Err` value: DomainInvalid { domain: \"almost-senseless.tech\", cause: NotAsciiAlphanumeric { bad_chars: ['-'] } }\n```\n\n\n### Additional context\n\n_No response_","closed_by":{"login":"lucasfernog","id":20051258,"node_id":"MDQ6VXNlcjIwMDUxMjU4","avatar_url":"https://avatars.githubusercontent.com/u/20051258?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasfernog","html_url":"https://github.com/lucasfernog","followers_url":"https://api.github.com/users/lucasfernog/followers","following_url":"https://api.github.com/users/lucasfernog/following{/other_user}","gists_url":"https://api.github.com/users/lucasfernog/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasfernog/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasfernog/subscriptions","organizations_url":"https://api.github.com/users/lucasfernog/orgs","repos_url":"https://api.github.com/users/lucasfernog/repos","events_url":"https://api.github.com/users/lucasfernog/events{/privacy}","received_events_url":"https://api.github.com/users/lucasfernog/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/9707/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tauri-apps/tauri/issues/9707/timeline","performed_via_github_app":null,"state_reason":"completed"}