{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/4632","repository_url":"https://api.github.com/repos/tauri-apps/tauri","labels_url":"https://api.github.com/repos/tauri-apps/tauri/issues/4632/labels{/name}","comments_url":"https://api.github.com/repos/tauri-apps/tauri/issues/4632/comments","events_url":"https://api.github.com/repos/tauri-apps/tauri/issues/4632/events","html_url":"https://github.com/tauri-apps/tauri/issues/4632","id":1299703672,"node_id":"I_kwDOC7lts85Nd-d4","number":4632,"title":"[bug] When using a global `build.target-dir` for Cargo, `cargo tauri dev` panics at 'failed to rename app'.","user":{"login":"dsaghliani","id":27930151,"node_id":"MDQ6VXNlcjI3OTMwMTUx","avatar_url":"https://avatars.githubusercontent.com/u/27930151?v=4","gravatar_id":"","url":"https://api.github.com/users/dsaghliani","html_url":"https://github.com/dsaghliani","followers_url":"https://api.github.com/users/dsaghliani/followers","following_url":"https://api.github.com/users/dsaghliani/following{/other_user}","gists_url":"https://api.github.com/users/dsaghliani/gists{/gist_id}","starred_url":"https://api.github.com/users/dsaghliani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dsaghliani/subscriptions","organizations_url":"https://api.github.com/users/dsaghliani/orgs","repos_url":"https://api.github.com/users/dsaghliani/repos","events_url":"https://api.github.com/users/dsaghliani/events{/privacy}","received_events_url":"https://api.github.com/users/dsaghliani/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1449401604,"node_id":"MDU6TGFiZWwxNDQ5NDAxNjA0","url":"https://api.github.com/repos/tauri-apps/tauri/labels/type:%20bug","name":"type: bug","color":"B60205","default":false,"description":""},{"id":3176728874,"node_id":"MDU6TGFiZWwzMTc2NzI4ODc0","url":"https://api.github.com/repos/tauri-apps/tauri/labels/scope:%20cli.rs","name":"scope: cli.rs","color":"D4C5F9","default":false,"description":"The tauri-cli rust crate"},{"id":3307098206,"node_id":"MDU6TGFiZWwzMzA3MDk4MjA2","url":"https://api.github.com/repos/tauri-apps/tauri/labels/priority:%202%20medium","name":"priority: 2 medium","color":"E844A1","default":false,"description":""},{"id":3410829358,"node_id":"LA_kwDOC7lts87LTSAu","url":"https://api.github.com/repos/tauri-apps/tauri/labels/status:%20backlog","name":"status: backlog","color":"059372","default":false,"description":"Issue is ready and we can work on it"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2022-07-09T15:11:56Z","updated_at":"2022-08-21T13:42:29Z","closed_at":"2022-08-21T13:42:29Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\r\n\r\nWhen using a global `target-dir` for all projects (instead of storing the builds in the project folder, Cargo writes to `~/.cargo_builds`), `cargo tauri dev` panics, because \"no such file or directory\" exists. At a guess, the build script doesn't expand to the full path and ends up looking for a local `.cargo_builds`.\r\n\r\n### Reproduction\r\n\r\n1. Go to the Cargo installation (on Linux, `~/.cargo`).\r\n2. Create `config.toml` if it doesn't already exist.\r\n3. Add the following inside:\r\n\r\n```\r\n[build]\r\ntarget-dir = \".cargo_builds\"\r\n```\r\n\r\n4. Create a sample front end. In my case, I used Vite with Svelte.\r\n5. Initialize the Tauri back end.\r\n6. Configure the build settings in `src-tauri/tauri.conf.json`.\r\n7. Run `cargo tauri dev`.\r\n\r\n### Expected behavior\r\n\r\nThe project should build and a Tauri app window should open. This happens when **not** using a global `target-dir`.\r\n\r\n### Platform and versions\r\n\r\n```shell\r\nEnvironment\r\n  › OS: Pop!_OS 22.04 X64\r\n  › Node.js: 18.2.0\r\n  › npm: 8.9.0\r\n  › pnpm: Not installed!\r\n  › yarn: Not installed!\r\n  › rustup: 1.24.3\r\n  › rustc: 1.61.0\r\n  › cargo: 1.61.0\r\n  › Rust toolchain: stable-x86_64-unknown-linux-gnu \r\n\r\nPackages\r\n  › @tauri-apps/cli [NPM]: 1.0.3\r\n  › @tauri-apps/api [NPM]: Not installed!\r\n  › tauri [RUST]: 1.0.3,\r\n  › tauri-build [RUST]: 1.0.3,\r\n  › tao [RUST]: 0.12.1,\r\n  › wry [RUST]: 0.19.0,\r\n\r\nApp\r\n  › build-type: bundle\r\n  › CSP: unset\r\n  › distDir: ../dist\r\n  › devPath: http://localhost:3000/\r\n  › framework: Svelte\r\n\r\nApp directory structure\r\n  ├─ src-tauri\r\n  ├─ node_modules\r\n  ├─ public\r\n  ├─ .vscode\r\n  ├─ dist\r\n  └─ src\r\n```\r\n\r\n\r\n### Stack trace\r\n\r\n```shell\r\nthread '<unnamed>' panicked at 'failed to rename app: failed to rename `.cargo_builds/debug/app` to `.cargo_builds/debug/ff-filter-svelte`\r\n\r\nCaused by:\r\n    No such file or directory (os error 2)', /home/dsaghliani/.cargo/registry/src/github.com-1ecc6299db9ec823/tauri-cli-1.0.3/src/interface/rust.rs:340:58\r\nstack backtrace:\r\n   0:     0x56540dc488e1 - std::backtrace_rs::backtrace::libunwind::trace::h22893a5306c091b4\r\n                               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/std/src/../../backtrace/src/backtrace/libunwind.rs:93:5\r\n   1:     0x56540dc488e1 - std::backtrace_rs::backtrace::trace_unsynchronized::h29c3bc6f9e91819d\r\n                               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/std/src/../../backtrace/src/backtrace/mod.rs:66:5\r\n   2:     0x56540dc488e1 - std::sys_common::backtrace::_print_fmt::he497d8a0ec903793\r\n                               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/std/src/sys_common/backtrace.rs:66:5\r\n   3:     0x56540dc488e1 - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h9c2a9d2774d81873\r\n                               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/std/src/sys_common/backtrace.rs:45:22\r\n   4:     0x56540da69dbc - core::fmt::write::hba4337c43d992f49\r\n                               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/core/src/fmt/mod.rs:1194:17\r\n   5:     0x56540dc1aa54 - std::io::Write::write_fmt::heb73de6e02cfabed\r\n                               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/std/src/io/mod.rs:1655:15\r\n   6:     0x56540dc4b39a - std::sys_common::backtrace::_print::h63c8b24acdd8e8ce\r\n                               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/std/src/sys_common/backtrace.rs:48:5\r\n   7:     0x56540dc4b39a - std::sys_common::backtrace::print::h426700d6240cdcc2\r\n                               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/std/src/sys_common/backtrace.rs:35:9\r\n   8:     0x56540dc4b39a - std::panicking::default_hook::{{closure}}::hc9a76eed0b18f82b\r\n                               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/std/src/panicking.rs:295:22\r\n   9:     0x56540dc4b049 - std::panicking::default_hook::h2e88d02087fae196\r\n                               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/std/src/panicking.rs:314:9\r\n  10:     0x56540dc4bf3a - std::panicking::rust_panic_with_hook::habfdcc2e90f9fd4c\r\n                               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/std/src/panicking.rs:698:17\r\n  11:     0x56540dc4be52 - std::panicking::begin_panic_handler::{{closure}}::he054b2a83a51d2cd\r\n                               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/std/src/panicking.rs:588:13\r\n  12:     0x56540dc4bdc6 - std::sys_common::backtrace::__rust_end_short_backtrace::ha48b94ab49b30915\r\n                               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/std/src/sys_common/backtrace.rs:138:18\r\n  13:     0x56540dc4bd82 - rust_begin_unwind\r\n                               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/std/src/panicking.rs:584:5\r\n  14:     0x56540d9d5582 - core::panicking::panic_fmt::h366d3a309ae17c94\r\n                               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/core/src/panicking.rs:143:14\r\n  15:     0x56540d9d5782 - core::result::unwrap_failed::hddd78f4658ac7d0f\r\n                               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/core/src/result.rs:1785:5\r\n  16:     0x56540dcef5b1 - tauri_cli::interface::rust::Rust::run_dev::{{closure}}::he4c69b810725a924\r\n  17:     0x56540dceea5e - std::sys_common::backtrace::__rust_begin_short_backtrace::hd6fc1b3325984561\r\n  18:     0x56540dce6102 - core::ops::function::FnOnce::call_once{{vtable.shim}}::h59cc13437e0b1ac9\r\n  19:     0x56540dc4df05 - <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once::ha99802c2c52ada61\r\n                               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/alloc/src/boxed.rs:1861:9\r\n  20:     0x56540dc4df05 - <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once::ha39aea1c57e28a15\r\n                               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/alloc/src/boxed.rs:1861:9\r\n  21:     0x56540dc4df05 - std::sys::unix::thread::Thread::new::thread_start::h9f8e3d72b1f7662f\r\n                               at /rustc/fe5b13d681f25ee6474be29d748c65adcd91f69e/library/std/src/sys/unix/thread.rs:108:17\r\n  22:     0x7fd3a7b4bb43 - <unknown>\r\n  23:     0x7fd3a7bdda00 - <unknown>\r\n  24:                0x0 - <unknown>\r\n```\r\n\r\n\r\n### Additional context\r\n\r\n_No response_","closed_by":{"login":"lucasfernog","id":20051258,"node_id":"MDQ6VXNlcjIwMDUxMjU4","avatar_url":"https://avatars.githubusercontent.com/u/20051258?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasfernog","html_url":"https://github.com/lucasfernog","followers_url":"https://api.github.com/users/lucasfernog/followers","following_url":"https://api.github.com/users/lucasfernog/following{/other_user}","gists_url":"https://api.github.com/users/lucasfernog/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasfernog/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasfernog/subscriptions","organizations_url":"https://api.github.com/users/lucasfernog/orgs","repos_url":"https://api.github.com/users/lucasfernog/repos","events_url":"https://api.github.com/users/lucasfernog/events{/privacy}","received_events_url":"https://api.github.com/users/lucasfernog/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/4632/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tauri-apps/tauri/issues/4632/timeline","performed_via_github_app":null,"state_reason":"completed"}