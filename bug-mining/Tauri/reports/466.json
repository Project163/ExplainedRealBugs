{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/8798","repository_url":"https://api.github.com/repos/tauri-apps/tauri","labels_url":"https://api.github.com/repos/tauri-apps/tauri/issues/8798/labels{/name}","comments_url":"https://api.github.com/repos/tauri-apps/tauri/issues/8798/comments","events_url":"https://api.github.com/repos/tauri-apps/tauri/issues/8798/events","html_url":"https://github.com/tauri-apps/tauri/issues/8798","id":2121112213,"node_id":"I_kwDOC7lts85-bZqV","number":8798,"title":"[feat] conditionally add capabilities","user":{"login":"lucasfernog","id":20051258,"node_id":"MDQ6VXNlcjIwMDUxMjU4","avatar_url":"https://avatars.githubusercontent.com/u/20051258?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasfernog","html_url":"https://github.com/lucasfernog","followers_url":"https://api.github.com/users/lucasfernog/followers","following_url":"https://api.github.com/users/lucasfernog/following{/other_user}","gists_url":"https://api.github.com/users/lucasfernog/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasfernog/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasfernog/subscriptions","organizations_url":"https://api.github.com/users/lucasfernog/orgs","repos_url":"https://api.github.com/users/lucasfernog/repos","events_url":"https://api.github.com/users/lucasfernog/events{/privacy}","received_events_url":"https://api.github.com/users/lucasfernog/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":3307089819,"node_id":"MDU6TGFiZWwzMzA3MDg5ODE5","url":"https://api.github.com/repos/tauri-apps/tauri/labels/type:%20feature%20request","name":"type: feature request","color":"446DBA","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2024-02-06T15:49:59Z","updated_at":"2024-02-19T14:13:37Z","closed_at":"2024-02-19T14:13:37Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the problem\r\n\r\nThe current capability design automatically pulls every capability file and resolves to the app runtime authority. While this is a good approach for developer experience, it is static and does not support more dynamic applications such as:\r\n- nightly releases including new features\r\n- feature-flag based multi application mode (for instance an admin vs user shared app that uses Cargo features to toggle what is compiled)\r\n- debug-only plugins (like developer productivity tools)\r\n\r\n### Describe the solution you'd like\r\n\r\nwe should add an option to define capabilities in Rust code. Ideally this should still be done at compile time. Since the current capabilities resolution is done in the Context generation, we could extend it to allow defining capabilities conditionally:\r\n\r\n```rust\r\ntauri::generate_context!(\r\n  capabilities = [\r\n\t  #[cfg(debug_assertions)]\r\n\t  \"./capabilities/debug.json\",\r\n\t  #[cfg(feature = \"admin\")]\r\n\t  \"./capabilities/admin.json\",\r\n  ]\r\n)\r\n```\r\n\r\n#8797 implements the first step for this feature, without that change users need to define conditionally added capabilities in a separate folder otherwise they would be enabled automatically.\r\n\r\n### Alternatives considered\r\n\r\nWe could also allow defining the capability at runtime instead, but I'll open a separate issue for that one.\r\n\r\n### Additional context\r\n\r\n_No response_","closed_by":{"login":"lucasfernog","id":20051258,"node_id":"MDQ6VXNlcjIwMDUxMjU4","avatar_url":"https://avatars.githubusercontent.com/u/20051258?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasfernog","html_url":"https://github.com/lucasfernog","followers_url":"https://api.github.com/users/lucasfernog/followers","following_url":"https://api.github.com/users/lucasfernog/following{/other_user}","gists_url":"https://api.github.com/users/lucasfernog/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasfernog/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasfernog/subscriptions","organizations_url":"https://api.github.com/users/lucasfernog/orgs","repos_url":"https://api.github.com/users/lucasfernog/repos","events_url":"https://api.github.com/users/lucasfernog/events{/privacy}","received_events_url":"https://api.github.com/users/lucasfernog/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/8798/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tauri-apps/tauri/issues/8798/timeline","performed_via_github_app":null,"state_reason":"completed"}