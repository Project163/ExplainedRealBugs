{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/3870","repository_url":"https://api.github.com/repos/tauri-apps/tauri","labels_url":"https://api.github.com/repos/tauri-apps/tauri/issues/3870/labels{/name}","comments_url":"https://api.github.com/repos/tauri-apps/tauri/issues/3870/comments","events_url":"https://api.github.com/repos/tauri-apps/tauri/issues/3870/events","html_url":"https://github.com/tauri-apps/tauri/issues/3870","id":1196142675,"node_id":"I_kwDOC7lts85HS7BT","number":3870,"title":"[feat] Use configured target triple for filename","user":{"login":"Pierstoval","id":3369266,"node_id":"MDQ6VXNlcjMzNjkyNjY=","avatar_url":"https://avatars.githubusercontent.com/u/3369266?v=4","gravatar_id":"","url":"https://api.github.com/users/Pierstoval","html_url":"https://github.com/Pierstoval","followers_url":"https://api.github.com/users/Pierstoval/followers","following_url":"https://api.github.com/users/Pierstoval/following{/other_user}","gists_url":"https://api.github.com/users/Pierstoval/gists{/gist_id}","starred_url":"https://api.github.com/users/Pierstoval/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Pierstoval/subscriptions","organizations_url":"https://api.github.com/users/Pierstoval/orgs","repos_url":"https://api.github.com/users/Pierstoval/repos","events_url":"https://api.github.com/users/Pierstoval/events{/privacy}","received_events_url":"https://api.github.com/users/Pierstoval/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":3176728874,"node_id":"MDU6TGFiZWwzMTc2NzI4ODc0","url":"https://api.github.com/repos/tauri-apps/tauri/labels/scope:%20cli.rs","name":"scope: cli.rs","color":"D4C5F9","default":false,"description":"The tauri-cli rust crate"},{"id":3307089819,"node_id":"MDU6TGFiZWwzMzA3MDg5ODE5","url":"https://api.github.com/repos/tauri-apps/tauri/labels/type:%20feature%20request","name":"type: feature request","color":"446DBA","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2022-04-07T14:34:58Z","updated_at":"2022-05-04T14:03:58Z","closed_at":"2022-05-03T16:57:13Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the problem\r\n\r\nFor now, when compiling a project, the final filename for the binary depends on the OS, as stated in the `build.rs` file here for instance:\r\n\r\nhttps://github.com/tauri-apps/tauri/blob/82c7855bf83326eafcad861642edd117684fa506/tooling/cli/src/build.rs#L211-L225\r\n\r\nI could successfully manage to cross-compile the project by using [cross-rs/cross](https://github.com/cross-rs/cross) as runner instead of Cargo, with this command:\r\n\r\n```\r\n$ cargo-tauri build --target=x86_64-pc-windows-gnu --runner=$HOME/.cargo/bin/cross\r\n```\r\n\r\n(executed in Ubuntu 20.04 in WSL 2 on a Windows 10 machine)\r\n\r\nThe binary is built, I can even run it (but only if I copy `WebView2Loader.dll` next to the `.exe` file, which is another subject).\r\n\r\nHowever, the build command still fails like this:\r\n\r\n```\r\n‚ùØ cargo-tauri build --target=x86_64-pc-windows-gnu --runner=$HOME/.cargo/bin/cross                                                                                                                                                       16:26:15\r\n   Compiling my-project-name v0.1.0 (/project)\r\n    Finished release [optimized] target(s) in 46.73s\r\nError: failed to rename `/var/www/my-project/src-tauri/target/x86_64-pc-windows-gnu/release/my-project-name` to `/var/www/my-project/src-tauri/target/x86_64-pc-windows-gnu/release/my-project-name`\r\n\r\nCaused by:\r\n    No such file or directory (os error 2)\r\n```\r\n\r\nThe reason is that the `my-project-name` file doesn't exist: it was built for Windows, so it is instead named `my-project-name.exe`.\r\n\r\n### Describe the solution you'd like\r\n\r\nThe solution to make it work seems (according to the code I read in the tauri build process) that the `build.rs` code linked above should change behavior:\r\n\r\nInstead of using something like this to determine the file name:\r\n```\r\n    #[cfg(windows)]\r\n    let product_path = out_dir.join(format!(\"{}.exe\", product_name));\r\n```\r\n\r\nTauri should instead rely on determining whether it has to add `.exe` (or if it has to convert it to \"kebab case\" as of the linux-specific code we can see later in the file) depending on the **target triple** rather than what OS is building the project.\r\n\r\nI don't really know if this is feasible, especially considering the amount of different target triples (there's a [list of target triples](https://github.com/cross-rs/cross#supported-targets) in the Cross repository), but I guess it might benefit future cross-compilation-based features.\r\n\r\n### Alternatives considered\r\n\r\nFor now, the only alternative is to \"just ignore\" the error with shell features, which is not optimal since one has to add other shell commands to see if the project has _actually_ been successfully built or not.\r\n\r\n### Additional context\r\n\r\n_No response_","closed_by":{"login":"lucasfernog","id":20051258,"node_id":"MDQ6VXNlcjIwMDUxMjU4","avatar_url":"https://avatars.githubusercontent.com/u/20051258?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasfernog","html_url":"https://github.com/lucasfernog","followers_url":"https://api.github.com/users/lucasfernog/followers","following_url":"https://api.github.com/users/lucasfernog/following{/other_user}","gists_url":"https://api.github.com/users/lucasfernog/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasfernog/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasfernog/subscriptions","organizations_url":"https://api.github.com/users/lucasfernog/orgs","repos_url":"https://api.github.com/users/lucasfernog/repos","events_url":"https://api.github.com/users/lucasfernog/events{/privacy}","received_events_url":"https://api.github.com/users/lucasfernog/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/3870/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tauri-apps/tauri/issues/3870/timeline","performed_via_github_app":null,"state_reason":"completed"}