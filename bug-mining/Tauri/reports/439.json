{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/8177","repository_url":"https://api.github.com/repos/tauri-apps/tauri","labels_url":"https://api.github.com/repos/tauri-apps/tauri/issues/8177/labels{/name}","comments_url":"https://api.github.com/repos/tauri-apps/tauri/issues/8177/comments","events_url":"https://api.github.com/repos/tauri-apps/tauri/issues/8177/events","html_url":"https://github.com/tauri-apps/tauri/issues/8177","id":1978432182,"node_id":"I_kwDOC7lts8517Hq2","number":8177,"title":"[bug] Event emit crashes app with high call rate","user":{"login":"i-c-b","id":133848861,"node_id":"U_kgDOB_pfHQ","avatar_url":"https://avatars.githubusercontent.com/u/133848861?v=4","gravatar_id":"","url":"https://api.github.com/users/i-c-b","html_url":"https://github.com/i-c-b","followers_url":"https://api.github.com/users/i-c-b/followers","following_url":"https://api.github.com/users/i-c-b/following{/other_user}","gists_url":"https://api.github.com/users/i-c-b/gists{/gist_id}","starred_url":"https://api.github.com/users/i-c-b/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/i-c-b/subscriptions","organizations_url":"https://api.github.com/users/i-c-b/orgs","repos_url":"https://api.github.com/users/i-c-b/repos","events_url":"https://api.github.com/users/i-c-b/events{/privacy}","received_events_url":"https://api.github.com/users/i-c-b/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1449401604,"node_id":"MDU6TGFiZWwxNDQ5NDAxNjA0","url":"https://api.github.com/repos/tauri-apps/tauri/labels/type:%20bug","name":"type: bug","color":"B60205","default":false,"description":""},{"id":3307096872,"node_id":"MDU6TGFiZWwzMzA3MDk2ODcy","url":"https://api.github.com/repos/tauri-apps/tauri/labels/priority:%201%20high","name":"priority: 1 high","color":"E844A1","default":false,"description":""},{"id":4288483270,"node_id":"LA_kwDOC7lts87_nQ_G","url":"https://api.github.com/repos/tauri-apps/tauri/labels/status:%20needs%20triage","name":"status: needs triage","color":"059372","default":false,"description":"This issue needs to triage, applied to new issues"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":36,"created_at":"2023-11-06T07:00:51Z","updated_at":"2024-05-08T17:13:36Z","closed_at":null,"author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nToo many calls to [`tauri::Window::emit`](<https://docs.rs/tauri/latest/tauri/window/struct.Window.html#method.emit>) in a short amount of time causes the app to crash.\n\n### Reproduction\n\nInitial testing was conducted using a [minimal reproduction](<https://github.com/i-c-b/tauri-download-test>) with the `upload` plugin and downloading the latest [daily Blender build](<https://builder.blender.org/download/daily/archive/>). It was later narrowed down to be related to the event system and an [event flooder](<https://github.com/i-c-b/tauri-event-flood>) was created which exhibits the same behaviour on a more consistent basis with 100,000 or more calls.\n\n### Expected behavior\n\n_No response_\n\n### Platform and versions\n\n```text\n[✔] Environment\r\n    - OS: Windows 10.0.22000 X64\r\n    ✔ WebView2: 119.0.2151.44\r\n    ✔ MSVC: Visual Studio Community 2022\r\n    ✔ rustc: 1.72.0 (5680fa18f 2023-08-23)\r\n    ✔ cargo: 1.72.0 (103a7ff2e 2023-08-15)\r\n    ✔ rustup: 1.26.0 (5af9b9484 2023-04-05)\r\n    ✔ Rust toolchain: stable-x86_64-pc-windows-msvc (default)\r\n    - node: 20.9.0\r\n    - pnpm: 8.10.2\r\n    - yarn: 1.22.19\r\n    - npm: 10.1.0\r\n\r\n[-] Packages\r\n    - tauri [RUST]: 1.5.2\r\n    - tauri-build [RUST]: 1.5.0\r\n    - wry [RUST]: 0.24.4\r\n    - tao [RUST]: 0.16.5\r\n    - @tauri-apps/api [NPM]: 1.5.1\r\n    - @tauri-apps/cli [NPM]: 1.5.6\r\n\r\n[-] App\r\n    - build-type: bundle\r\n    - CSP: unset\r\n    - distDir: ../dist\r\n    - devPath: http://localhost:1420/\r\n    - bundler: Vite\n```\n\n\n### Stack trace\n\n_No response_\n\n### Additional context\n\nThis issue was previously discussed on [Discord](<https://discord.com/channels/616186924390023171/1166423822061285419>). @FabianLars demonstrated a mitigation for the `upload` plugin by reducing the frequency of calls to `emit` on the [`download-throttled-events` branch](<https://github.com/tauri-apps/plugins-workspace/tree/download-throttled-events/plugins/upload>) which led to reduced crashing but didn't eliminate it entirely. The impact this issue has on the `upload` plugin would be reduced in environments with slow drives and fast networks as there is more time between messages and fewer overall messages.","closed_by":{"login":"lucasfernog","id":20051258,"node_id":"MDQ6VXNlcjIwMDUxMjU4","avatar_url":"https://avatars.githubusercontent.com/u/20051258?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasfernog","html_url":"https://github.com/lucasfernog","followers_url":"https://api.github.com/users/lucasfernog/followers","following_url":"https://api.github.com/users/lucasfernog/following{/other_user}","gists_url":"https://api.github.com/users/lucasfernog/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasfernog/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasfernog/subscriptions","organizations_url":"https://api.github.com/users/lucasfernog/orgs","repos_url":"https://api.github.com/users/lucasfernog/repos","events_url":"https://api.github.com/users/lucasfernog/events{/privacy}","received_events_url":"https://api.github.com/users/lucasfernog/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/8177/reactions","total_count":11,"+1":6,"-1":0,"laugh":0,"hooray":0,"confused":1,"heart":0,"rocket":0,"eyes":4},"timeline_url":"https://api.github.com/repos/tauri-apps/tauri/issues/8177/timeline","performed_via_github_app":null,"state_reason":"reopened"}