{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/6594","repository_url":"https://api.github.com/repos/tauri-apps/tauri","labels_url":"https://api.github.com/repos/tauri-apps/tauri/issues/6594/labels{/name}","comments_url":"https://api.github.com/repos/tauri-apps/tauri/issues/6594/comments","events_url":"https://api.github.com/repos/tauri-apps/tauri/issues/6594/events","html_url":"https://github.com/tauri-apps/tauri/issues/6594","id":1647856810,"node_id":"I_kwDOC7lts85iOEyq","number":6594,"title":"[bug] `window.__TAURI_IPC__ is not a function` when not using a dev server","user":{"login":"Berrysoft","id":37586447,"node_id":"MDQ6VXNlcjM3NTg2NDQ3","avatar_url":"https://avatars.githubusercontent.com/u/37586447?v=4","gravatar_id":"","url":"https://api.github.com/users/Berrysoft","html_url":"https://github.com/Berrysoft","followers_url":"https://api.github.com/users/Berrysoft/followers","following_url":"https://api.github.com/users/Berrysoft/following{/other_user}","gists_url":"https://api.github.com/users/Berrysoft/gists{/gist_id}","starred_url":"https://api.github.com/users/Berrysoft/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Berrysoft/subscriptions","organizations_url":"https://api.github.com/users/Berrysoft/orgs","repos_url":"https://api.github.com/users/Berrysoft/repos","events_url":"https://api.github.com/users/Berrysoft/events{/privacy}","received_events_url":"https://api.github.com/users/Berrysoft/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1449401604,"node_id":"MDU6TGFiZWwxNDQ5NDAxNjA0","url":"https://api.github.com/repos/tauri-apps/tauri/labels/type:%20bug","name":"type: bug","color":"B60205","default":false,"description":""},{"id":4288483270,"node_id":"LA_kwDOC7lts87_nQ_G","url":"https://api.github.com/repos/tauri-apps/tauri/labels/status:%20needs%20triage","name":"status: needs triage","color":"059372","default":false,"description":"This issue needs to triage, applied to new issues"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2023-03-30T15:30:30Z","updated_at":"2023-04-05T16:06:34Z","closed_at":"2023-04-05T15:46:45Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Describe the bug\n\nI would like to debug on Android without dev server to see how a release build works like. I can see that it gets the right js script from the asset manager, but `__TAURI_IPC__` is not injected.\r\n\r\nBy the way, the release build of the same app exits abormally just after starts.\n\n### Reproduction\n\n```\r\nnpm run build\r\ncargo tauri android dev --feature custom-protocol\r\n```\n\n### Expected behavior\n\nIt should work.\n\n### Platform and versions\n\n```text\nEnvironment\r\n  › OS: Windows 10.0.22621 X64\r\n  › Webview2: 111.0.1661.54\r\n  › MSVC: \r\n      - Visual Studio Community 2022\r\n  › Node.js: 18.15.0\r\n  › npm: 9.5.0\r\n  › pnpm: Not installed!\r\n  › yarn: Not installed!\r\n  › rustup: 1.25.2\r\n  › rustc: 1.70.0-nightly\r\n  › cargo: 1.70.0-nightly\r\n  › Rust toolchain: nightly-x86_64-pc-windows-msvc \r\n\r\nPackages\r\n  › @tauri-apps/cli [NPM]: 2.0.0-alpha.4\r\n  › @tauri-apps/api [NPM]: 2.0.0-alpha.1\r\n  › tauri [RUST]: 2.0.0-alpha.4 (no manifest),\r\n  › tauri-build [RUST]: 2.0.0-alpha.2 (no manifest),\r\n  › tao [RUST]: 0.18.3 (no manifest),\r\n  › wry [RUST]: 0.27.1 (no manifest),\r\n\r\nApp\r\n  › distDir: ../dist\r\n  › devPath: http://localhost:5173/\r\n  › framework: Vue.js\r\n  › bundler: Vite\r\n\r\nApp directory structure\r\n  ├─ dist\r\n  ├─ node_modules\r\n  ├─ public\r\n  ├─ src\r\n  └─ src-tauri\n```\n\n\n### Stack trace\n\n```text\n03-30 22:55:20.977  9079  9079 W Tauri/Console: File: http://127.0.0.1:37361/assets/index.217dae30.js - Line 1 - Msg: Could not find \"window.__TAURI_METADATA__\". The \"appWindow\" value will reference the \"main\" window label.\r\n03-30 22:55:20.977  9079  9079 W Tauri/Console: Note that this is not an issue if running this frontend on a browser instead of a Tauri window.\r\n03-30 22:55:21.046  9079  9079 E Tauri/Console: File: http://127.0.0.1:37361/assets/index.217dae30.js - Line 1 - Msg: TypeError: window.__TAURI_IPC__ is not a function\r\n03-30 22:55:21.053  9079  9079 E Tauri/Console: File: http://127.0.0.1:37361/assets/index.217dae30.js - Line 1 - Msg: TypeError: window.__TAURI_IPC__ is not a function\n```\n\n\n### Additional context\n\nI redirect the dist url to a custom axum server, and the server searches the files from the asset manager. I'm sure that it resolves the right asset files.\r\n\r\nI also tries the same app and build features on Windows, and it works well.","closed_by":{"login":"lucasfernog","id":20051258,"node_id":"MDQ6VXNlcjIwMDUxMjU4","avatar_url":"https://avatars.githubusercontent.com/u/20051258?v=4","gravatar_id":"","url":"https://api.github.com/users/lucasfernog","html_url":"https://github.com/lucasfernog","followers_url":"https://api.github.com/users/lucasfernog/followers","following_url":"https://api.github.com/users/lucasfernog/following{/other_user}","gists_url":"https://api.github.com/users/lucasfernog/gists{/gist_id}","starred_url":"https://api.github.com/users/lucasfernog/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lucasfernog/subscriptions","organizations_url":"https://api.github.com/users/lucasfernog/orgs","repos_url":"https://api.github.com/users/lucasfernog/repos","events_url":"https://api.github.com/users/lucasfernog/events{/privacy}","received_events_url":"https://api.github.com/users/lucasfernog/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/tauri-apps/tauri/issues/6594/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tauri-apps/tauri/issues/6594/timeline","performed_via_github_app":null,"state_reason":"completed"}