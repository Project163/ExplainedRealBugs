diff --git a/wicket-request/src/main/java/org/apache/wicket/request/Url.java b/wicket-request/src/main/java/org/apache/wicket/request/Url.java
index 11f6b47bc0..e950f6f90a 100755
--- a/wicket-request/src/main/java/org/apache/wicket/request/Url.java
+++ b/wicket-request/src/main/java/org/apache/wicket/request/Url.java
@@ -1219,17 +1219,21 @@ public class Url implements Serializable
 			// drop '.' from path
 			if (".".equals(segment))
 			{
-				continue;
+				// skip
+			}
+			else if ("..".equals(segment) && url.segments.isEmpty() == false)
+			{
+				url.segments.remove(url.segments.size() - 1);
 			}
-
 			// skip segment if following segment is a '..'
-			if ((i + 1) < segments.size() && "..".equals(segments.get(i + 1)))
+			else if ((i + 1) < segments.size() && "..".equals(segments.get(i + 1)))
 			{
 				i++;
-				continue;
 			}
-
-			url.segments.add(segment);
+			else
+			{
+				url.segments.add(segment);
+			}
 		}
 		return url;
 	}
diff --git a/wicket-request/src/test/java/org/apache/wicket/request/UrlTest.java b/wicket-request/src/test/java/org/apache/wicket/request/UrlTest.java
index 46f298124d..409fbcf12a 100644
--- a/wicket-request/src/test/java/org/apache/wicket/request/UrlTest.java
+++ b/wicket-request/src/test/java/org/apache/wicket/request/UrlTest.java
@@ -816,7 +816,11 @@ public class UrlTest extends Assert
 		assertEquals("a///", Url.parse("a///").canonical().getPath());
 		assertEquals("a//b/c", Url.parse("a//b/c").canonical().getPath());
 		assertEquals("foo/test", Url.parse("foo/bar/../baz/../test").canonical().getPath());
-//		assertEquals("a/d", Url.parse("a/b/c/../../d").canonical().getPath());
+		assertEquals("a/d", Url.parse("a/b/c/../../d").canonical().getPath());
+		assertEquals("a/d", Url.parse("../../a/b/../c/../d").canonical().getPath());
+		assertEquals("a/d", Url.parse("../../a/b/../c/../d/.").canonical().getPath());
+		assertEquals("a", Url.parse("../../a/b/../c/../d/..").canonical().getPath());
+		assertEquals("", Url.parse("../../a/b/../c/../d/../..").canonical().getPath());
 	}
 
 	@Test
