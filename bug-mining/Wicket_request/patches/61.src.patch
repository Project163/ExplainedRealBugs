diff --git a/wicket-request/src/main/java/org/apache/wicket/request/Url.java b/wicket-request/src/main/java/org/apache/wicket/request/Url.java
index 6742aa46ed..39df118d4c 100755
--- a/wicket-request/src/main/java/org/apache/wicket/request/Url.java
+++ b/wicket-request/src/main/java/org/apache/wicket/request/Url.java
@@ -1136,4 +1136,65 @@ public final class Url implements Serializable
 	{
 		return getQueryString(getCharset());
 	}
+	
+	
+	/**
+	 * Try to reduce url by eliminating '..' and '.' from the path where appropriate
+	 * (this is somehow similar to {@link java.io.File#getCanonicalPath()}).
+	 * Either by different / unexpected browser behavior or by malicious attacks it 
+	 * can happen that these kind of redundant urls are processed by wicket. These urls 
+	 * can cause some trouble when mapping the request.
+	 * <p/> 
+	 * <strong>example:</strong>
+	 * 
+	 * the url
+	 * 
+	 * <pre>  /example/..;jsessionid=234792?0</pre> 
+	 * 
+	 * will not get normalized by the browser due to the ';jsessionid' string that 
+	 * gets appended by the servlet container. After wicket strips the 
+	 * jsessionid part the resulting internal url will be
+	 * 
+	 * <pre>  /example/..</pre>
+	 * 
+	 * instead of
+	 * 
+	 * <pre>  /</pre>
+	 * 
+	 * <p/>
+	 * 
+	 * This code correlates to 
+	 * <a href="https://issues.apache.org/jira/browse/WICKET-4303">WICKET-4303</a>
+	 *
+	 * @param url
+	 *         unprocessed url
+	 *
+	 * @return canonical url
+	 */
+	public Url canonical()
+	{
+		Url url = new Url(this);
+		url.segments.clear();
+
+		for (int i = 0; i < this.segments.size(); i++)
+		{
+			final String segment = this.segments.get(i);
+
+			// drop '.' from path  
+			if (".".equals(segment))
+			{
+				continue;
+			}
+
+			// skip segment if following segment is a '..'
+			if ((i + 1) < this.segments.size() && "..".equals(this.segments.get(i + 1)))
+			{
+				i++;
+				continue;
+			}
+
+			url.segments.add(segment);
+		}
+		return url;
+	}
 }
diff --git a/wicket-request/src/test/java/org/apache/wicket/request/UrlTest.java b/wicket-request/src/test/java/org/apache/wicket/request/UrlTest.java
index 018ab2b7b8..f4562ec8a9 100644
--- a/wicket-request/src/test/java/org/apache/wicket/request/UrlTest.java
+++ b/wicket-request/src/test/java/org/apache/wicket/request/UrlTest.java
@@ -592,4 +592,19 @@ public class UrlTest extends Assert
 		assertEquals(port, url.getPort());
 		assertEquals(Arrays.asList(segments), url.getSegments());
 	}
+
+	@Test
+	public void compact()
+	{
+		assertEquals("", Url.parse("").canonical().getPath());
+		assertEquals("/", Url.parse("/").canonical().getPath());
+		assertEquals("/a", Url.parse("/a").canonical().getPath());
+		assertEquals("a/", Url.parse("a/").canonical().getPath());
+		assertEquals("", Url.parse("example/..").canonical().getPath());
+		assertEquals("..", Url.parse("example/../..").canonical().getPath());
+		assertEquals("..", Url.parse("example/.././..").canonical().getPath());
+		assertEquals("a///", Url.parse("a///").canonical().getPath());
+		assertEquals("a//b/c", Url.parse("a//b/c").canonical().getPath());
+		assertEquals("foo/test", Url.parse("foo/bar/../baz/../test").canonical().getPath());
+	}
 }
