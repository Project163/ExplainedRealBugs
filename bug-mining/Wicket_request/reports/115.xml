<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:27:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-5698] WebApplication#unmount() unmounts the whole compound mapper if some of its inner ones matches</title>
                <link>https://issues.apache.org/jira/browse/WICKET-5698</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;From dev@ mailing lists: &lt;a href=&quot;http://markmail.org/message/wmdgbrhvrvaeygvr&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://markmail.org/message/wmdgbrhvrvaeygvr&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WebApplication.unmount() calls getRootRequestMapperAsCompound(), and &lt;br/&gt;
calls unmount() on that.&lt;/p&gt;

&lt;p&gt;getRootRequestMapperAsCompound() checks if the root request mapper is a &lt;br/&gt;
compound, if not, wraps it in a compound, sets the compound as root and &lt;br/&gt;
returns the compound.&lt;/p&gt;

&lt;p&gt;CompoundRequestMapper.unmount() identifies which of the mappers added &lt;br/&gt;
directly to the compound handle the url, and removes them.&lt;/p&gt;

&lt;p&gt;The problem:&lt;br/&gt;
If the original root mapper was a single wrapper, or layer of wrappers, &lt;br/&gt;
with the actual mounted mapper wrapped some levels down, then the whole &lt;br/&gt;
wrapper is removed, not just the specific MountedMapper that is wrapped. &lt;br/&gt;
This has the effect of removing every single mapper, leaving root mapper &lt;br/&gt;
as an empty compound.&lt;/p&gt;

&lt;p&gt;I would like to attempt to provide a patch to fix this, but would like &lt;br/&gt;
guidance on the approach. I have come up with three approaches:&lt;/p&gt;

&lt;p&gt;1. Introduce interface IWrappedRequestMapper. This will be an interface &lt;br/&gt;
which has one method: IRequestMapper getWrappedRequestMapper(). We can &lt;br/&gt;
then have all wrapper mappers implement this and work down the tree to &lt;br/&gt;
find the correct MountedMapper (wicket 6) to remove.&lt;/p&gt;

&lt;p&gt;2. Have WebApplication hold a reference to a specific &lt;br/&gt;
CompoundRequestMapper, and have all mount()/unmount() operations add and &lt;br/&gt;
remove from this mapper. This compound would need to be added to the &lt;br/&gt;
default list during init. This makes it complicated to work out how to &lt;br/&gt;
do things like have CryptoMapper not apply to mounted pages.&lt;/p&gt;

&lt;p&gt;3. Add method unmount() to IRequestMapper, so that wrappers can &lt;br/&gt;
delegate. This obviously can only be done in wicket 7, but we&apos;re making &lt;br/&gt;
mounting a problem of every single request mapper, when not even &lt;br/&gt;
Application cares about mounting.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12740391">WICKET-5698</key>
            <summary>WebApplication#unmount() unmounts the whole compound mapper if some of its inner ones matches</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jesselong">Jesse Long</assignee>
                                    <reporter username="mgrigorov">Martin Tzvetanov Grigorov</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 Sep 2014 12:10:58 +0000</created>
                <updated>Mon, 29 Sep 2014 21:40:37 +0000</updated>
                            <resolved>Mon, 29 Sep 2014 21:40:37 +0000</resolved>
                                    <version>7.0.0-M3</version>
                    <version>6.17.0</version>
                                    <fixVersion>6.18.0</fixVersion>
                    <fixVersion>7.0.0-M4</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14143021" author="jira-bot" created="Mon, 22 Sep 2014 08:38:55 +0000"  >&lt;p&gt;Commit f45ce896d02aeda3c09d56bc4ceac425929973a1 in wicket&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mgrigorov&quot; class=&quot;user-hover&quot; rel=&quot;mgrigorov&quot;&gt;mgrigorov&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=f45ce89&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=f45ce89&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5698&quot; title=&quot;WebApplication#unmount() unmounts the whole compound mapper if some of its inner ones matches&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5698&quot;&gt;&lt;del&gt;WICKET-5698&lt;/del&gt;&lt;/a&gt; WebApplication#unmount() unmounts the whole compound mapper if some of its inner ones matches&lt;/p&gt;</comment>
                            <comment id="14143022" author="jira-bot" created="Mon, 22 Sep 2014 08:42:00 +0000"  >&lt;p&gt;Commit 6b906d53a917257454cc5f10c5b1d91b321ce8ed in wicket&apos;s branch refs/heads/wicket-6.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mgrigorov&quot; class=&quot;user-hover&quot; rel=&quot;mgrigorov&quot;&gt;mgrigorov&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=6b906d5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=6b906d5&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5698&quot; title=&quot;WebApplication#unmount() unmounts the whole compound mapper if some of its inner ones matches&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5698&quot;&gt;&lt;del&gt;WICKET-5698&lt;/del&gt;&lt;/a&gt; WebApplication#unmount() unmounts the whole compound mapper if some of its inner ones matches&lt;/p&gt;

&lt;p&gt;(cherry picked from commit f45ce896d02aeda3c09d56bc4ceac425929973a1)&lt;/p&gt;</comment>
                            <comment id="14143190" author="mgrigorov" created="Mon, 22 Sep 2014 13:26:37 +0000"  >&lt;p&gt;Reopening because compound -&amp;gt; wrapper -&amp;gt; compound -&amp;gt; mapper is not covered.&lt;/p&gt;</comment>
                            <comment id="14143192" author="mgrigorov" created="Mon, 22 Sep 2014 13:27:21 +0000"  >&lt;p&gt;Attaching Jesse Long&apos;s patch from dev@ mail thread.&lt;/p&gt;</comment>
                            <comment id="14144035" author="jesselong" created="Mon, 22 Sep 2014 23:34:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5698&quot; title=&quot;WebApplication#unmount() unmounts the whole compound mapper if some of its inner ones matches&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5698&quot;&gt;&lt;del&gt;WICKET-5698&lt;/del&gt;&lt;/a&gt;-2.patch - A neatened up version of the patch, with tests.&lt;/p&gt;

&lt;p&gt;Summary of patch:&lt;/p&gt;

&lt;p&gt;Add new interface IWrappedRequestMapper to mark wrapping request mappers.&lt;/p&gt;

&lt;p&gt;Implement IWrappedRequestMapper where appropriate.&lt;/p&gt;

&lt;p&gt;Remove ICompoundRequestMapper#unmount(), as WebApplication now takes responsibility for this.&lt;/p&gt;

&lt;p&gt;Remove package private CompoundRequestMapper#size() which was only used in now non-existant tests.&lt;/p&gt;

&lt;p&gt;Implement mapper tree traversing unmount in WebApplication.&lt;/p&gt;

&lt;p&gt;Create WebApplicationTest to test unmounting.&lt;/p&gt;</comment>
                            <comment id="14144070" author="jesselong" created="Mon, 22 Sep 2014 23:58:04 +0000"  >&lt;p&gt;Lets do that without ConcurrentModificationExceptions&lt;/p&gt;</comment>
                            <comment id="14146052" author="mgrigorov" created="Wed, 24 Sep 2014 08:27:07 +0000"  >&lt;p&gt;We already have org.apache.wicket.request.IRequestHandlerDelegate.&lt;br/&gt;
To keep it consistent in the naming I suggest to rename IWrappedRequestMapper to IRequestMapperDelegate&lt;/p&gt;</comment>
                            <comment id="14146073" author="mgrigorov" created="Wed, 24 Sep 2014 08:45:12 +0000"  >&lt;p&gt;in WebApplication.java:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;/*
 * Only attempt to unmount &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; root request mapper is either a compound, or wraps a compound to avoid
 * leaving the application with no mappers installed.
 */
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;leaving an empty compound mapper is no much better than no mapper at all. But it is OK this way.&lt;/p&gt;</comment>
                            <comment id="14146086" author="mgrigorov" created="Wed, 24 Sep 2014 08:53:24 +0000"  >&lt;p&gt;Looks good to me!&lt;br/&gt;
It is just the name of IWrappedRequestMapper that bothers me. Maybe it is more accurate than IRequestHandlerDelegate but the consistency is more important IMO.&lt;/p&gt;</comment>
                            <comment id="14146143" author="jesselong" created="Wed, 24 Sep 2014 09:51:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5698&quot; title=&quot;WebApplication#unmount() unmounts the whole compound mapper if some of its inner ones matches&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5698&quot;&gt;&lt;del&gt;WICKET-5698&lt;/del&gt;&lt;/a&gt;-3.patch&lt;/p&gt;

&lt;p&gt;I agree that IRequestMapperDelegate is a slightly less accurate name, but that consistency is more important in this case. I have attached an updated patch.&lt;/p&gt;

&lt;p&gt;As a side effect of the rename, protected final CryptoMapper#getWrappedMapper() has been renamed to #getDelegateMapper(). Slight further incompatibility with Wicket 6, felt only by subclasses of CryptoMapper.&lt;/p&gt;</comment>
                            <comment id="14146158" author="mgrigorov" created="Wed, 24 Sep 2014 10:05:38 +0000"  >&lt;p&gt;We can keep the old method as deprecated and remove it in Wicket 8.&lt;br/&gt;
This is what the migration-friendly libraries do &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14152314" author="jira-bot" created="Mon, 29 Sep 2014 21:19:21 +0000"  >&lt;p&gt;Commit d06f84d1b87011e5c152c5fb3f05ae50c1c58cda in wicket&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jesselong&quot; class=&quot;user-hover&quot; rel=&quot;jesselong&quot;&gt;jesselong&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=d06f84d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=d06f84d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5698&quot; title=&quot;WebApplication#unmount() unmounts the whole compound mapper if some of its inner ones matches&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5698&quot;&gt;&lt;del&gt;WICKET-5698&lt;/del&gt;&lt;/a&gt; WebApplication#unmount() unmounts the whole compound mapper if some of its inner ones matches&lt;/p&gt;</comment>
                            <comment id="14152332" author="jira-bot" created="Mon, 29 Sep 2014 21:34:20 +0000"  >&lt;p&gt;Commit ed07f6b38ff29d3ff46357db8252656ca2cc2b97 in wicket&apos;s branch refs/heads/wicket-6.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jesselong&quot; class=&quot;user-hover&quot; rel=&quot;jesselong&quot;&gt;jesselong&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=ed07f6b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=wicket.git;h=ed07f6b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-5698&quot; title=&quot;WebApplication#unmount() unmounts the whole compound mapper if some of its inner ones matches&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-5698&quot;&gt;&lt;del&gt;WICKET-5698&lt;/del&gt;&lt;/a&gt; WebApplication#unmount() unmounts the whole compound mapper if some of its inner ones matches&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12670545" name="WICKET-5698-2.patch" size="29315" author="jesselong" created="Mon, 22 Sep 2014 23:58:04 +0000"/>
                            <attachment id="12670942" name="WICKET-5698-3.patch" size="29315" author="jesselong" created="Wed, 24 Sep 2014 09:51:35 +0000"/>
                            <attachment id="12670415" name="WICKET-5698.patch" size="17114" author="mgrigorov" created="Mon, 22 Sep 2014 13:27:21 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 7 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1zvmv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>