<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 22:26:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[WICKET-3161] Can not create cookies</title>
                <link>https://issues.apache.org/jira/browse/WICKET-3161</link>
                <project id="12310561" key="WICKET">Wicket</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I&apos;m migrating to wicket 1.5-M3 and I&apos;ve encountered a problem. I can not create cookies (I presume that I can&apos;t delete them either).&lt;br/&gt;
I&apos;ve looked through the source code and this is what I found:&lt;/p&gt;

&lt;p&gt;I add the cookie to the response and I end up with a nice HeaderBufferingWebResponse which contains BufferedWebResponse$AddCookieAction.&lt;br/&gt;
But then redirectTo(Url, RequestCycle) from WebPageRenderer class is called. Here is the method:&lt;/p&gt;

&lt;p&gt;       private void redirectTo(Url url, RequestCycle requestCycle)&lt;/p&gt;
	{
		WebResponse response = (WebResponse)requestCycle.getResponse();
		String relativeUrl = requestCycle.getUrlRenderer().renderUrl(url);
		response.reset();
		response.sendRedirect(relativeUrl);
	}
&lt;p&gt;response.reset(); - removes all actions from the request.&lt;br/&gt;
So after this method my request has got only BufferedWebResponse$SendRedirectAction.&lt;/p&gt;</description>
                <environment>Windows 7, Intel i7</environment>
        <key id="12479758">WICKET-3161</key>
            <summary>Can not create cookies</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pete">Peter Ertl</assignee>
                                    <reporter username="istoykov">Ivaylo Stoykov</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Nov 2010 23:02:52 +0000</created>
                <updated>Sun, 14 Nov 2010 10:23:40 +0000</updated>
                            <resolved>Sat, 13 Nov 2010 12:17:57 +0000</resolved>
                                    <version>1.5-M3</version>
                                    <fixVersion>1.5-RC1</fixVersion>
                                    <component>wicket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12931345" author="mgrigorov" created="Fri, 12 Nov 2010 08:18:32 +0000"  >&lt;p&gt;Hi Ivaylo,&lt;/p&gt;

&lt;p&gt;Which render strategy do you use in your application ? (do you use getRequestCycleSettings().setRenderStragegy())&lt;/p&gt;

&lt;p&gt;The purpose of the Action&apos;s is to cache the actual behavior for the response after the redirect. I.e. you set a cookie to the response, at the end of the request cycle this response is saved in org.apache.wicket.protocol.http.WebApplication.storeBufferedResponse(String, Url, BufferedWebResponse), then a redirect (without the cookie) is being made, and when the redirect comes back org.apache.wicket.request.mapper.BufferedResponseMapper.hasBufferedResponse(Url) will see there is a cached response and will use it without re-doing the whole request cycle processing, and now the cookie action will be executed.&lt;/p&gt;

&lt;p&gt;This code has been changed between 1.5-M2.1 and M3 so it indeed could be broken.&lt;br/&gt;
Can you create a quickstart application so we can debug it more easily ?&lt;br/&gt;
Thanks!&lt;/p&gt;</comment>
                            <comment id="12931361" author="istoykov" created="Fri, 12 Nov 2010 10:36:45 +0000"  >&lt;p&gt;Hi Martin,&lt;/p&gt;

&lt;p&gt;I don&apos;t set a render strategy, so I should be using REDIRECT_TO_BUFFER which is the default.&lt;br/&gt;
I&apos;m attaching a quickstart.&lt;/p&gt;</comment>
                            <comment id="12931647" author="pete" created="Sat, 13 Nov 2010 09:36:45 +0000"  >&lt;p&gt;Removing reset() will not change anything&lt;/p&gt;

&lt;p&gt;The set-cookie action gets lost when redirecting_to_buffer to redirect to a clean url after invoking the link listener, in WebPageRenderer in approx. line 123 in trunk&lt;/p&gt;


&lt;p&gt;		// keep the original response&lt;br/&gt;
		final Response originalResponse = requestCycle.getResponse();&lt;/p&gt;

&lt;p&gt;		// buffered web response for page &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;
			&lt;ul&gt;
				&lt;li&gt;(the set-cookie action in originalResponse, which is of type HeaderBufferingWebResponse, is dropped here) ****&lt;br/&gt;
		BufferedWebResponse response = new BufferedWebResponse((WebResponse)originalResponse);&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;		// keep the original base URL&lt;br/&gt;
		Url originalBaseUrl = requestCycle.getUrlRenderer().setBaseUrl(targetUrl);&lt;/p&gt;

&lt;p&gt;copying originalResponse over to response does not copy over the set cookie action.&lt;/p&gt;

&lt;p&gt;still investigating further on this...&lt;/p&gt;</comment>
                            <comment id="12931662" author="pete" created="Sat, 13 Nov 2010 12:17:57 +0000"  >&lt;p&gt;I am confident that this issue is fixed but I am not very happy about the solution. Please feel free to improve it or send me feedback.&lt;/p&gt;

&lt;p&gt;I also added a test case in wicket source to test for existance of cookies that were set during a link listener event.&lt;/p&gt;

&lt;p&gt;General question to wicket devs: Is it ok to &quot;resolve issue&quot; if I am not happy with a solution but the issue is fixed?&lt;/p&gt;</comment>
                            <comment id="12931671" author="hudson" created="Sat, 13 Nov 2010 12:54:02 +0000"  >&lt;p&gt;Integrated in Apache Wicket 1.5.x #507 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Apache%20Wicket%201.5.x/507/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Apache%20Wicket%201.5.x/507/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-3161&quot; title=&quot;Can not create cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-3161&quot;&gt;&lt;del&gt;WICKET-3161&lt;/del&gt;&lt;/a&gt;: added missing apache license headers&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-3161&quot; title=&quot;Can not create cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-3161&quot;&gt;&lt;del&gt;WICKET-3161&lt;/del&gt;&lt;/a&gt;: improve naming&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-3161&quot; title=&quot;Can not create cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-3161&quot;&gt;&lt;del&gt;WICKET-3161&lt;/del&gt;&lt;/a&gt;: added test case&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-3161&quot; title=&quot;Can not create cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-3161&quot;&gt;&lt;del&gt;WICKET-3161&lt;/del&gt;&lt;/a&gt;: cookies that are set during a buffered web response will not be transferred over redirecting. &lt;/p&gt;

&lt;p&gt;The solution to this issue is not what I consider pretty so please take time to review and feel free to improve it.&lt;/p&gt;

&lt;p&gt;Sorry for the last commit message (I intended to create a path but was clicking too fast)&lt;/p&gt;

&lt;p&gt;The previous commit is part of &lt;a href=&quot;https://issues.apache.org/jira/browse/WICKET-3161&quot; title=&quot;Can not create cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WICKET-3161&quot;&gt;&lt;del&gt;WICKET-3161&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12931804" author="hudson" created="Sun, 14 Nov 2010 10:23:40 +0000"  >&lt;p&gt;Integrated in Apache Wicket 1.5.x #511 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Apache%20Wicket%201.5.x/511/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Apache%20Wicket%201.5.x/511/&lt;/a&gt;)&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12459432" name="quickstart.zip" size="13910" author="istoykov" created="Fri, 12 Nov 2010 10:37:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>203974</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 1 week, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0aojj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>60249</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>