{"url":"https://api.github.com/repos/mockito/mockito/issues/2401","repository_url":"https://api.github.com/repos/mockito/mockito","labels_url":"https://api.github.com/repos/mockito/mockito/issues/2401/labels{/name}","comments_url":"https://api.github.com/repos/mockito/mockito/issues/2401/comments","events_url":"https://api.github.com/repos/mockito/mockito/issues/2401/events","html_url":"https://github.com/mockito/mockito/issues/2401","id":978021158,"node_id":"MDU6SXNzdWU5NzgwMjExNTg=","number":2401,"title":"Introducing the Ability to Mock Construction of Generic Types","user":{"login":"brandon1024","id":22732449,"node_id":"MDQ6VXNlcjIyNzMyNDQ5","avatar_url":"https://avatars.githubusercontent.com/u/22732449?v=4","gravatar_id":"","url":"https://api.github.com/users/brandon1024","html_url":"https://github.com/brandon1024","followers_url":"https://api.github.com/users/brandon1024/followers","following_url":"https://api.github.com/users/brandon1024/following{/other_user}","gists_url":"https://api.github.com/users/brandon1024/gists{/gist_id}","starred_url":"https://api.github.com/users/brandon1024/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brandon1024/subscriptions","organizations_url":"https://api.github.com/users/brandon1024/orgs","repos_url":"https://api.github.com/users/brandon1024/repos","events_url":"https://api.github.com/users/brandon1024/events{/privacy}","received_events_url":"https://api.github.com/users/brandon1024/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-08-24T12:01:26Z","updated_at":"2025-09-20T08:52:50Z","closed_at":"2025-09-20T08:52:50Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\r\n> Hey,\r\n>\r\n> First thanks for reporting, in order to help us to classify issue can you make sure the following check boxes are checked ?\r\n>\r\n> If this is about mockito usage, the better way is to reach out to\r\n>\r\n>  - stackoverflow : https://stackoverflow.com/questions/tagged/mockito\r\n>  - the mailing-list  : https://groups.google.com/forum/#!forum/mockito / mockito@googlegroups.com\r\n>    (Note mailing-list is moderated to avoid spam)\r\n>\r\n> _This block can be removed_\r\n> _Something wrong in the template fix it here `.github/ISSUE_TEMPLATE.md`\r\n\r\n\r\ncheck that\r\n\r\n - [ ] The mockito message in the stacktrace have useful information, but it didn't help\r\n - [ ] The problematic code (if that's possible) is copied here;\r\n       Note that some configuration are impossible to mock via Mockito\r\n - [ ] Provide versions (mockito / jdk / os / any other relevant information)\r\n - [ ] Provide a [Short, Self Contained, Correct (Compilable), Example](http://sscce.org) of the issue\r\n       (same as any question on stackoverflow.com)\r\n - [ ] Read the [contributing guide](https://github.com/mockito/mockito/blob/main/.github/CONTRIBUTING.md)\r\n-->\r\n\r\nFirst of all, thank you for building an awesome testing library!\r\n\r\nI have recently started playing with mocked object construction. It's fantastic that this functionality is now available through plain ol' Mockito. It makes for some pretty elegant tests, especially when combined with `@Mock` using the `MockitoExtension`.\r\n\r\nOne limitation I've encountered is around mocking the constructions of parameterized types.\r\n\r\nHere's what I'd like to accomplish:\r\n```\r\n@ExtendWith(MockitoExtension.class)\r\nclass DefaultKafkaConsumerTest {\r\n\r\n    @Mock\r\n    private MockedConstruction<KafkaConsumer<String, String>> kafkaConsumerMockedConstruction;\r\n\r\n    @Test\r\n    void testMyThing() {\r\n        new DefaultKafkaConsumer<String, String>();\r\n        final KafkaConsumer<String, String> mockConsumer = kafkaConsumerMockedConstruction.constructed().get(0);\r\n        // ... assert\r\n    }\r\n```\r\n\r\nUnfortunately, this doesn't seem to work, as indicated by this message:\r\n```\r\nMockito cannot infer a static mock from a raw type for kafkaConsumerMockedConstruction\r\n\r\nInstead of @Mock MockedConstruction you need to specify a parameterized type\r\nFor example, if you would like to mock Sample.class, specify\r\n\r\n@Mock MockedConstruction<Sample>\r\n\r\nas the type parameter. If the type is itself parameterized, it should be specified as raw type.\r\n```\r\n\r\nAs suggested, I've updated my tests as follows:\r\n```\r\n@ExtendWith(MockitoExtension.class)\r\nclass DefaultKafkaConsumerTest {\r\n\r\n    @Mock\r\n    private MockedConstruction<KafkaConsumer> kafkaConsumerMockedConstruction;\r\n\r\n    @Test\r\n    void testMyThing() {\r\n        new DefaultKafkaConsumer<String, String>();\r\n\r\n        @SuppressWarnings(\"unchecked\")\r\n        final KafkaConsumer<String, String> mockConsumer = kafkaConsumerMockedConstruction.constructed().get(0);\r\n        // ... assert\r\n    }\r\n```\r\n\r\nI'm less fond of suppressing warnings everywhere. I've extracted the unchecked operation into a helper method, but I think that just covers up the problem.\r\n\r\nI'm curious to understand the technical reason why the MockedConstruction generic parameter has to be a raw type. It's interesting that I can create generic mocks and argument captors, but I can't do this through mocked construction.\r\n\r\nThanks for your time!","closed_by":{"login":"TimvdLippe","id":5948271,"node_id":"MDQ6VXNlcjU5NDgyNzE=","avatar_url":"https://avatars.githubusercontent.com/u/5948271?v=4","gravatar_id":"","url":"https://api.github.com/users/TimvdLippe","html_url":"https://github.com/TimvdLippe","followers_url":"https://api.github.com/users/TimvdLippe/followers","following_url":"https://api.github.com/users/TimvdLippe/following{/other_user}","gists_url":"https://api.github.com/users/TimvdLippe/gists{/gist_id}","starred_url":"https://api.github.com/users/TimvdLippe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TimvdLippe/subscriptions","organizations_url":"https://api.github.com/users/TimvdLippe/orgs","repos_url":"https://api.github.com/users/TimvdLippe/repos","events_url":"https://api.github.com/users/TimvdLippe/events{/privacy}","received_events_url":"https://api.github.com/users/TimvdLippe/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mockito/mockito/issues/2401/reactions","total_count":11,"+1":11,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mockito/mockito/issues/2401/timeline","performed_via_github_app":null,"state_reason":"completed"}