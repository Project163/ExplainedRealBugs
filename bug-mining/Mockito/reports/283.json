{"url":"https://api.github.com/repos/mockito/mockito/issues/3077","repository_url":"https://api.github.com/repos/mockito/mockito","labels_url":"https://api.github.com/repos/mockito/mockito/issues/3077/labels{/name}","comments_url":"https://api.github.com/repos/mockito/mockito/issues/3077/comments","events_url":"https://api.github.com/repos/mockito/mockito/issues/3077/events","html_url":"https://github.com/mockito/mockito/issues/3077","id":1837065232,"node_id":"I_kwDOAF62v85tf2QQ","number":3077,"title":"Unused stubbings are not reported when filters are used","user":{"login":"C0urante","id":8636148,"node_id":"MDQ6VXNlcjg2MzYxNDg=","avatar_url":"https://avatars.githubusercontent.com/u/8636148?v=4","gravatar_id":"","url":"https://api.github.com/users/C0urante","html_url":"https://github.com/C0urante","followers_url":"https://api.github.com/users/C0urante/followers","following_url":"https://api.github.com/users/C0urante/following{/other_user}","gists_url":"https://api.github.com/users/C0urante/gists{/gist_id}","starred_url":"https://api.github.com/users/C0urante/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/C0urante/subscriptions","organizations_url":"https://api.github.com/users/C0urante/orgs","repos_url":"https://api.github.com/users/C0urante/repos","events_url":"https://api.github.com/users/C0urante/events{/privacy}","received_events_url":"https://api.github.com/users/C0urante/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2023-08-04T16:45:32Z","updated_at":"2023-08-08T05:41:13Z","closed_at":"2023-08-08T05:41:13Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Unused stubbings are not reported when a filter is used during the test run. This is documented clearly in the [StrictRunner class](https://github.com/mockito/mockito/blob/f5ad9e9f9a338bcea6180fc474a562acc13f2c84/src/main/java/org/mockito/internal/runners/StrictRunner.java#L47-L52):\r\n\r\n```java\r\n// only report when:\r\n// 1. if all tests from given test have ran (filter requested is false)\r\n//   Otherwise we would report unnecessary stubs even if the user runs just single test\r\n// from the class\r\n// 2. tests are successful (we don't want to add an extra failure on top of any existing\r\n// failure, to avoid confusion)\r\n```\r\n\r\nOnly reporting unused stubbings when all tests are run is reasonable. However, the logic for detecting this case is a little too coarse-grained, since even no-op filters end up disabling the reporting of unused stubbings. This can be troublesome when, for example, JUnit categories are used to distinguish between unit and integration tests.\r\n\r\nIt'd be nice if we could detect when filters actually prevent one or more tests from being run, and only skip reporting unused stubbings in those cases.\r\n\r\n\r\nCreated based off of https://github.com/gradle/gradle/issues/10694, specifically [this comment](https://github.com/gradle/gradle/issues/10694#issuecomment-1374911274).\r\n\r\nThis affects a project currently using Mockito version 4.11.0, but I've just verified that it also affects version 5.2.0.","closed_by":{"login":"TimvdLippe","id":5948271,"node_id":"MDQ6VXNlcjU5NDgyNzE=","avatar_url":"https://avatars.githubusercontent.com/u/5948271?v=4","gravatar_id":"","url":"https://api.github.com/users/TimvdLippe","html_url":"https://github.com/TimvdLippe","followers_url":"https://api.github.com/users/TimvdLippe/followers","following_url":"https://api.github.com/users/TimvdLippe/following{/other_user}","gists_url":"https://api.github.com/users/TimvdLippe/gists{/gist_id}","starred_url":"https://api.github.com/users/TimvdLippe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TimvdLippe/subscriptions","organizations_url":"https://api.github.com/users/TimvdLippe/orgs","repos_url":"https://api.github.com/users/TimvdLippe/repos","events_url":"https://api.github.com/users/TimvdLippe/events{/privacy}","received_events_url":"https://api.github.com/users/TimvdLippe/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mockito/mockito/issues/3077/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mockito/mockito/issues/3077/timeline","performed_via_github_app":null,"state_reason":"completed"}