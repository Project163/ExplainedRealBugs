diff --git a/build.gradle b/build.gradle
index 432ec8fce..a5b95813b 100644
--- a/build.gradle
+++ b/build.gradle
@@ -65,7 +65,7 @@ test {
 }
 
 dependencies {
-    compile 'net.bytebuddy:byte-buddy:1.5.3'
+    compile 'net.bytebuddy:byte-buddy:1.5.4'
     compile 'net.bytebuddy:byte-buddy-agent:1.5.3'
 
     provided "junit:junit:4.12", "org.hamcrest:hamcrest-core:1.3"
diff --git a/src/main/java/org/mockito/internal/creation/bytebuddy/InlineBytecodeGenerator.java b/src/main/java/org/mockito/internal/creation/bytebuddy/InlineBytecodeGenerator.java
index 170453cdb..43f74cbac 100644
--- a/src/main/java/org/mockito/internal/creation/bytebuddy/InlineBytecodeGenerator.java
+++ b/src/main/java/org/mockito/internal/creation/bytebuddy/InlineBytecodeGenerator.java
@@ -6,10 +6,19 @@ package org.mockito.internal.creation.bytebuddy;
 
 import net.bytebuddy.ByteBuddy;
 import net.bytebuddy.asm.Advice;
+import net.bytebuddy.asm.AsmVisitorWrapper;
 import net.bytebuddy.description.method.MethodDescription;
+import net.bytebuddy.description.method.MethodList;
+import net.bytebuddy.description.method.ParameterDescription;
+import net.bytebuddy.description.type.TypeDescription;
 import net.bytebuddy.dynamic.ClassFileLocator;
 import net.bytebuddy.dynamic.scaffold.TypeValidation;
 import net.bytebuddy.implementation.Implementation;
+import net.bytebuddy.jar.asm.ClassVisitor;
+import net.bytebuddy.jar.asm.MethodVisitor;
+import net.bytebuddy.jar.asm.Opcodes;
+import net.bytebuddy.matcher.ElementMatchers;
+import net.bytebuddy.pool.TypePool;
 import net.bytebuddy.utility.RandomString;
 import org.mockito.exceptions.base.MockitoException;
 import org.mockito.internal.util.concurrent.WeakConcurrentMap;
@@ -139,10 +148,9 @@ public class InlineBytecodeGenerator implements BytecodeGenerator, ClassFileTran
             return null;
         } else {
             try {
-                // Note: The VM seems to erase parameter names from the provided class file. We therefore first attempt to read the
-                // class file from the class loader. This might revert transformations applied by previous agents.
-                return byteBuddy.redefine(classBeingRedefined, new ClassFileLocator.Compound(ClassFileLocator.ForClassLoader.of(loader),
-                        ClassFileLocator.Simple.of(classBeingRedefined.getName(), classfileBuffer)))
+                return byteBuddy.redefine(classBeingRedefined, ClassFileLocator.Simple.of(classBeingRedefined.getName(), classfileBuffer))
+                        // Note: The VM erases parameter meta data from the provided class file (bug). We just add this information manually.
+                        .visit(new ParameterWritingVisitorWrapper(classBeingRedefined))
                         .visit(Advice.withCustomMapping()
                                 .bind(MockMethodAdvice.Identifier.class, identifier)
                                 .to(MockMethodAdvice.class).on(isVirtual()
@@ -161,4 +169,47 @@ public class InlineBytecodeGenerator implements BytecodeGenerator, ClassFileTran
             }
         }
     }
+
+    private static class ParameterWritingVisitorWrapper extends AsmVisitorWrapper.AbstractBase {
+
+        private final Class<?> type;
+
+        private ParameterWritingVisitorWrapper(Class<?> type) {
+            this.type = type;
+        }
+
+        @Override
+        public ClassVisitor wrap(TypeDescription instrumentedType,
+                                 ClassVisitor classVisitor,
+                                 Implementation.Context implementationContext,
+                                 TypePool typePool,
+                                 int writerFlags,
+                                 int readerFlags) {
+            return new ParameterAddingClassVisitor(classVisitor, new TypeDescription.ForLoadedType(type));
+        }
+
+        private static class ParameterAddingClassVisitor extends ClassVisitor {
+
+            private final TypeDescription typeDescription;
+
+            private ParameterAddingClassVisitor(ClassVisitor cv, TypeDescription typeDescription) {
+                super(Opcodes.ASM5, cv);
+                this.typeDescription = typeDescription;
+            }
+
+            @Override
+            public MethodVisitor visitMethod(int access, String name, String desc, String signature, String[] exceptions) {
+                MethodVisitor methodVisitor = super.visitMethod(access, name, desc, signature, exceptions);
+                MethodList<?> methodList = typeDescription.getDeclaredMethods().filter((name.equals(MethodDescription.CONSTRUCTOR_INTERNAL_NAME)
+                        ? isConstructor()
+                        : ElementMatchers.<MethodDescription>named(name)).and(hasDescriptor(desc)));
+                if (methodList.size() == 1 && methodList.getOnly().getParameters().hasExplicitMetaData()) {
+                    for (ParameterDescription parameterDescription : methodList.getOnly().getParameters()) {
+                        methodVisitor.visitParameter(parameterDescription.getName(), parameterDescription.getModifiers());
+                    }
+                }
+                return methodVisitor;
+            }
+        }
+    }
 }
diff --git a/src/test/java/org/mockito/internal/creation/bytebuddy/InlineByteBuddyMockMakerTest.java b/src/test/java/org/mockito/internal/creation/bytebuddy/InlineByteBuddyMockMakerTest.java
index e377b9e54..d60f6ff31 100644
--- a/src/test/java/org/mockito/internal/creation/bytebuddy/InlineByteBuddyMockMakerTest.java
+++ b/src/test/java/org/mockito/internal/creation/bytebuddy/InlineByteBuddyMockMakerTest.java
@@ -1,5 +1,9 @@
 package org.mockito.internal.creation.bytebuddy;
 
+import net.bytebuddy.ByteBuddy;
+import net.bytebuddy.description.modifier.Visibility;
+import net.bytebuddy.description.type.TypeDescription;
+import net.bytebuddy.implementation.StubMethod;
 import org.junit.Test;
 import org.mockito.exceptions.base.MockitoException;
 import org.mockito.internal.creation.MockSettingsImpl;
@@ -16,10 +20,13 @@ import java.util.Observable;
 import java.util.Observer;
 import java.util.regex.Pattern;
 
+import static net.bytebuddy.matcher.ElementMatchers.named;
 import static org.assertj.core.api.Assertions.assertThat;
 import static org.assertj.core.api.Assertions.fail;
+import static org.hamcrest.core.Is.is;
 
 public class InlineByteBuddyMockMakerTest extends AbstractByteBuddyMockMakerTest<InlineByteBuddyMockMaker> {
+
     public InlineByteBuddyMockMakerTest() {
         super(new InlineByteBuddyMockMaker());
     }
@@ -190,7 +197,9 @@ public class InlineByteBuddyMockMakerTest extends AbstractByteBuddyMockMakerTest
     @Test
     public void is_type_mockable_allows_anonymous() {
         Observer anonymous = new Observer() {
-            @Override public void update(Observable o, Object arg) { }
+            @Override
+            public void update(Observable o, Object arg) {
+            }
         };
         MockMaker.TypeMockability mockable = mockMaker.isTypeMockable(anonymous.getClass());
         assertThat(mockable.mockable()).isTrue();
@@ -211,6 +220,26 @@ public class InlineByteBuddyMockMakerTest extends AbstractByteBuddyMockMakerTest
         assertThat(mockable.nonMockableReason()).isEqualTo("");
     }
 
+    @Test
+    public void test_parameters_retention() throws Exception {
+        Class<?> typeWithParameters = new ByteBuddy()
+                .subclass(Object.class)
+                .defineMethod("foo", void.class, Visibility.PUBLIC)
+                .withParameter(String.class, "bar")
+                .intercept(StubMethod.INSTANCE)
+                .make()
+                .load(null)
+                .getLoaded();
+
+        MockCreationSettings<?> settings = settingsFor(typeWithParameters);
+        @SuppressWarnings("unchecked")
+        Object proxy = mockMaker.createMock(settings, new MockHandlerImpl(settings));
+
+        assertThat(proxy.getClass()).isEqualTo(typeWithParameters);
+        assertThat(new TypeDescription.ForLoadedType(typeWithParameters).getDeclaredMethods().filter(named("foo"))
+                .getOnly().getParameters().getOnly().getName()).isEqualTo("bar");
+    }
+
     private static <T> MockCreationSettings<T> settingsFor(Class<T> type, Class<?>... extraInterfaces) {
         MockSettingsImpl<T> mockSettings = new MockSettingsImpl<T>();
         mockSettings.setTypeToMock(type);
@@ -252,6 +281,7 @@ public class InlineByteBuddyMockMakerTest extends AbstractByteBuddyMockMakerTest
     }
 
     private static class NonFinalMethod {
+
         public String foo() {
             return "foo";
         }
