diff --git a/mockito-core/src/main/java/org/mockito/internal/debugging/LocationFactory.java b/mockito-core/src/main/java/org/mockito/internal/debugging/LocationFactory.java
index 3d936ae76..3b0d0a4ae 100644
--- a/mockito-core/src/main/java/org/mockito/internal/debugging/LocationFactory.java
+++ b/mockito-core/src/main/java/org/mockito/internal/debugging/LocationFactory.java
@@ -4,6 +4,8 @@
  */
 package org.mockito.internal.debugging;
 
+import org.mockito.internal.util.AndroidPlatform;
+import org.mockito.internal.util.Platform;
 import org.mockito.invocation.Location;
 
 public final class LocationFactory {
@@ -24,6 +26,9 @@ public final class LocationFactory {
     }
 
     private static Factory createLocationFactory() {
+        if (Platform.isAndroid() && !AndroidPlatform.isStackWalkerUsable()) {
+            return new Java8LocationFactory();
+        }
         try {
             // On some platforms, like Android, the StackWalker APIs may not be
             // available, in this case we have to fallback to Java 8 style of stack
diff --git a/mockito-core/src/main/java/org/mockito/internal/util/AndroidPlatform.java b/mockito-core/src/main/java/org/mockito/internal/util/AndroidPlatform.java
new file mode 100644
index 000000000..5a0ffbcd2
--- /dev/null
+++ b/mockito-core/src/main/java/org/mockito/internal/util/AndroidPlatform.java
@@ -0,0 +1,33 @@
+/*
+ * Copyright (c) 2025 Mockito contributors
+ * This program is made available under the terms of the MIT License.
+ */
+package org.mockito.internal.util;
+
+public class AndroidPlatform {
+
+    private static int getSdkInt() {
+        try {
+            return Class.forName("android.os.Build$VERSION").getField("SDK_INT").getInt(null);
+        } catch (ReflectiveOperationException e) {
+            return 0;
+        }
+    }
+
+    private static int getExtensionVersion(int sdk) {
+        try {
+            return (int)
+                    Class.forName("android.os.ext.SdkExtensions")
+                            .getMethod("getExtensionVersion", int.class)
+                            .invoke(null, sdk);
+        } catch (ReflectiveOperationException e) {
+            return 0;
+        }
+    }
+
+    public static boolean isStackWalkerUsable() {
+        // StackWalker on Android had a bug that is fixed in Android Baklava (36)
+        // or SDK extension train M2025-05 (17) and later. See https://r.android.com/3548340.
+        return getSdkInt() >= 36 || getSdkInt() >= 31 && getExtensionVersion(31) >= 17;
+    }
+}
diff --git a/mockito-integration-tests/android-tests/src/androidTest/java/org/mockitousage/androidtest/AaaMustRunFirstLocationTests.kt b/mockito-integration-tests/android-tests/src/androidTest/java/org/mockitousage/androidtest/AaaMustRunFirstLocationTests.kt
new file mode 100644
index 000000000..c7e497581
--- /dev/null
+++ b/mockito-integration-tests/android-tests/src/androidTest/java/org/mockitousage/androidtest/AaaMustRunFirstLocationTests.kt
@@ -0,0 +1,26 @@
+package org.mockitousage.androidtest
+
+import androidx.test.ext.junit.runners.AndroidJUnit4
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mockito.Mockito.mock
+import org.mockito.Mockito.withSettings
+import org.mockito.internal.creation.proxy.ProxyMockMaker
+
+@RunWith(AndroidJUnit4::class)
+class AaaMustRunFirstLocationTests {
+
+    /**
+     *  Regression test for https://github.com/mockito/mockito/issues/3171 and
+     *  https://github.com/linkedin/dexmaker/issues/190.
+     *
+     *  Bug only triggers if the first time LocationImpl is used is with ProxyMockMaker, therefore
+     *  this test must be the first to run.
+     */
+    @Test
+    fun mockAndUseInterfaceWithProxyMockMaker() {
+        val basicInterface = mock(BasicInterface::class.java,
+            withSettings().mockMaker(ProxyMockMaker::class.java.name))
+        basicInterface.interfaceMethod()
+    }
+}
