{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/467","repository_url":"https://api.github.com/repos/launchbadge/sqlx","labels_url":"https://api.github.com/repos/launchbadge/sqlx/issues/467/labels{/name}","comments_url":"https://api.github.com/repos/launchbadge/sqlx/issues/467/comments","events_url":"https://api.github.com/repos/launchbadge/sqlx/issues/467/events","html_url":"https://github.com/launchbadge/sqlx/issues/467","id":648445272,"node_id":"MDU6SXNzdWU2NDg0NDUyNzI=","number":467,"title":"[sqlite] 0.4-pre sqlx:query doesn't correctly bind positional params","user":{"login":"clintfred","id":19213143,"node_id":"MDQ6VXNlcjE5MjEzMTQz","avatar_url":"https://avatars.githubusercontent.com/u/19213143?v=4","gravatar_id":"","url":"https://api.github.com/users/clintfred","html_url":"https://github.com/clintfred","followers_url":"https://api.github.com/users/clintfred/followers","following_url":"https://api.github.com/users/clintfred/following{/other_user}","gists_url":"https://api.github.com/users/clintfred/gists{/gist_id}","starred_url":"https://api.github.com/users/clintfred/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintfred/subscriptions","organizations_url":"https://api.github.com/users/clintfred/orgs","repos_url":"https://api.github.com/users/clintfred/repos","events_url":"https://api.github.com/users/clintfred/events{/privacy}","received_events_url":"https://api.github.com/users/clintfred/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1757378993,"node_id":"MDU6TGFiZWwxNzU3Mzc4OTkz","url":"https://api.github.com/repos/launchbadge/sqlx/labels/bug","name":"bug","color":"e11d21","default":true,"description":""},{"id":1930438434,"node_id":"MDU6TGFiZWwxOTMwNDM4NDM0","url":"https://api.github.com/repos/launchbadge/sqlx/labels/db:sqlite","name":"db:sqlite","color":"a1cc4d","default":false,"description":"Related to SQLite"},{"id":1944323731,"node_id":"MDU6TGFiZWwxOTQ0MzIzNzMx","url":"https://api.github.com/repos/launchbadge/sqlx/labels/E-medium","name":"E-medium","color":"d8c0f9","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-06-30T19:42:31Z","updated_at":"2020-07-03T05:52:41Z","closed_at":"2020-07-03T05:52:41Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I have an insert statement that works with `0.3.5`, but fails on `git=\"https://github.com/launchbadge/sqlx\", rev=\"e4005bb\"`\r\n\r\n### Schema\r\n```\r\n     \"CREATE TABLE LOG_EVENTS (\r\n          _id             INTEGER PRIMARY KEY AUTOINCREMENT,\r\n          ray_id          TEXT NOT NULL,\r\n          created_ms      DATETIME DEFAULT current_timestamp,\r\n          send_attempts   INTEGER,\r\n          data            TEXT,\r\n          UNIQUE(ray_id, created_ms)\r\n          )\"\r\n```\r\n\r\n### Insert Code (same for both versions)\r\n\r\n```rust\r\nsqlx::query(\r\n                        \"INSERT INTO LOG_EVENTS (send_attempts, ray_id, data) VALUES (?1, ?2, ?3)\",\r\n                    )\r\n                    .bind(7 as i32)\r\n                    .bind(ray_id)\r\n                    .bind(base64::encode(data))\r\n                    .execute(&mut conn)\r\n                    .await;\r\n```\r\n\r\nOn 0.4-pre I get a lots of failures on the UNIQUE constraint because `7` is being put into the `ray_id` column. I can see this by selecting the successfully inserted data using `sqlite3` It also looks like the `ray_id` might be ending up in the `data` column`\r\n\r\n```\r\nsqlite> select * from LOG_EVENTS limit 10;\r\n_id|ray_id|created_ms|send_attempts|data\r\n1|7|2020-06-30 19:39:09|7|qrPEgVfpwpcL5K9X\r\n```","closed_by":{"login":"mehcode","id":753919,"node_id":"MDQ6VXNlcjc1MzkxOQ==","avatar_url":"https://avatars.githubusercontent.com/u/753919?v=4","gravatar_id":"","url":"https://api.github.com/users/mehcode","html_url":"https://github.com/mehcode","followers_url":"https://api.github.com/users/mehcode/followers","following_url":"https://api.github.com/users/mehcode/following{/other_user}","gists_url":"https://api.github.com/users/mehcode/gists{/gist_id}","starred_url":"https://api.github.com/users/mehcode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mehcode/subscriptions","organizations_url":"https://api.github.com/users/mehcode/orgs","repos_url":"https://api.github.com/users/mehcode/repos","events_url":"https://api.github.com/users/mehcode/events{/privacy}","received_events_url":"https://api.github.com/users/mehcode/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/467/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/launchbadge/sqlx/issues/467/timeline","performed_via_github_app":null,"state_reason":"completed"}