{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/122","repository_url":"https://api.github.com/repos/launchbadge/sqlx","labels_url":"https://api.github.com/repos/launchbadge/sqlx/issues/122/labels{/name}","comments_url":"https://api.github.com/repos/launchbadge/sqlx/issues/122/comments","events_url":"https://api.github.com/repos/launchbadge/sqlx/issues/122/events","html_url":"https://github.com/launchbadge/sqlx/issues/122","id":576636985,"node_id":"MDU6SXNzdWU1NzY2MzY5ODU=","number":122,"title":"Validate and specify PoolConnection's behavior in the face of unexpected drops and general panics","user":{"login":"abonander","id":3198595,"node_id":"MDQ6VXNlcjMxOTg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3198595?v=4","gravatar_id":"","url":"https://api.github.com/users/abonander","html_url":"https://github.com/abonander","followers_url":"https://api.github.com/users/abonander/followers","following_url":"https://api.github.com/users/abonander/following{/other_user}","gists_url":"https://api.github.com/users/abonander/gists{/gist_id}","starred_url":"https://api.github.com/users/abonander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abonander/subscriptions","organizations_url":"https://api.github.com/users/abonander/orgs","repos_url":"https://api.github.com/users/abonander/repos","events_url":"https://api.github.com/users/abonander/events{/privacy}","received_events_url":"https://api.github.com/users/abonander/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-03-06T01:26:25Z","updated_at":"2020-03-15T00:42:26Z","closed_at":"2020-03-15T00:42:26Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Context: https://github.com/launchbadge/sqlx/pull/110#issuecomment-595541254\r\n\r\n`PoolConnection` should probably be sure to clear the inner connection's buffer before releasing it back to the pool, and maybe on panic just kill the connection entirely (because e.g. it could be in an unclosed transaction).\r\n\r\nCurrently it does... none of that, which is actually a bit concerning (I wrote it so I take full responsibility): https://github.com/launchbadge/sqlx/blob/80f402b7e61734a186a9a67bd95f74ad2103271c/sqlx-core/src/pool/conn.rs#L72-L81\r\n\r\n","closed_by":{"login":"mehcode","id":753919,"node_id":"MDQ6VXNlcjc1MzkxOQ==","avatar_url":"https://avatars.githubusercontent.com/u/753919?v=4","gravatar_id":"","url":"https://api.github.com/users/mehcode","html_url":"https://github.com/mehcode","followers_url":"https://api.github.com/users/mehcode/followers","following_url":"https://api.github.com/users/mehcode/following{/other_user}","gists_url":"https://api.github.com/users/mehcode/gists{/gist_id}","starred_url":"https://api.github.com/users/mehcode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mehcode/subscriptions","organizations_url":"https://api.github.com/users/mehcode/orgs","repos_url":"https://api.github.com/users/mehcode/repos","events_url":"https://api.github.com/users/mehcode/events{/privacy}","received_events_url":"https://api.github.com/users/mehcode/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/122/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/launchbadge/sqlx/issues/122/timeline","performed_via_github_app":null,"state_reason":"completed"}