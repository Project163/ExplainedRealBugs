[{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/comments/1144352464","html_url":"https://github.com/launchbadge/sqlx/issues/1158#issuecomment-1144352464","issue_url":"https://api.github.com/repos/launchbadge/sqlx/issues/1158","id":1144352464,"node_id":"IC_kwDODb6dM85ENW7Q","user":{"login":"mdtusz","id":6494463,"node_id":"MDQ6VXNlcjY0OTQ0NjM=","avatar_url":"https://avatars.githubusercontent.com/u/6494463?v=4","gravatar_id":"","url":"https://api.github.com/users/mdtusz","html_url":"https://github.com/mdtusz","followers_url":"https://api.github.com/users/mdtusz/followers","following_url":"https://api.github.com/users/mdtusz/following{/other_user}","gists_url":"https://api.github.com/users/mdtusz/gists{/gist_id}","starred_url":"https://api.github.com/users/mdtusz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdtusz/subscriptions","organizations_url":"https://api.github.com/users/mdtusz/orgs","repos_url":"https://api.github.com/users/mdtusz/repos","events_url":"https://api.github.com/users/mdtusz/events{/privacy}","received_events_url":"https://api.github.com/users/mdtusz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-02T02:29:59Z","updated_at":"2022-06-02T02:29:59Z","body":"Even without changing the names, I've been running into the issue of `sqlx migrate info` showing that there's checksum mismatches despite the \"old\" migrations not being modified at all since they were applied. Even if I nuke my local database and recreate it from scratch, `sqlx migrate info` will report checksum mismatches :thinking:\r\n\r\nRubber-duck edit:\r\n\r\nAfter looking into this a bit, it seems that the checksum reported for the local migration when the check is run is comparing with the `foo_migration.down.sql` file rather than the `foo_migration.up.sql` file.\r\n\r\nTo test this on your own, run `sha384sum path/to/your_migration.down.sql` and it should match the checksum specified in the `sqlx migrate info` output. I believe the fix will be to check the `migration.type` and ignore the checksum mismatch if the migration being iterated through is not a `MigrationType::Simple` or `MigrationType::ReversibleUp`.\r\n\r\n[Relevant code here](https://github.com/launchbadge/sqlx/blob/2849468e571992ef8521af57cb849662e81f9a3f/sqlx-cli/src/migrate.rs#L132-L143)\r\n\r\nI'll make a fix and open a PR to resolve this. It shouldn't require any changes to stored data as it's entirely within the CLI - the checksums stored are correct. ","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/comments/1144352464/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mdtusz","id":6494463,"node_id":"MDQ6VXNlcjY0OTQ0NjM=","avatar_url":"https://avatars.githubusercontent.com/u/6494463?v=4","gravatar_id":"","url":"https://api.github.com/users/mdtusz","html_url":"https://github.com/mdtusz","followers_url":"https://api.github.com/users/mdtusz/followers","following_url":"https://api.github.com/users/mdtusz/following{/other_user}","gists_url":"https://api.github.com/users/mdtusz/gists{/gist_id}","starred_url":"https://api.github.com/users/mdtusz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdtusz/subscriptions","organizations_url":"https://api.github.com/users/mdtusz/orgs","repos_url":"https://api.github.com/users/mdtusz/repos","events_url":"https://api.github.com/users/mdtusz/events{/privacy}","received_events_url":"https://api.github.com/users/mdtusz/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":6724764009,"node_id":"REFE_lADODb6dM84y2YWozwAAAAGQ08Fp","url":"https://api.github.com/repos/launchbadge/sqlx/issues/events/6724764009","actor":{"login":"mdtusz","id":6494463,"node_id":"MDQ6VXNlcjY0OTQ0NjM=","avatar_url":"https://avatars.githubusercontent.com/u/6494463?v=4","gravatar_id":"","url":"https://api.github.com/users/mdtusz","html_url":"https://github.com/mdtusz","followers_url":"https://api.github.com/users/mdtusz/followers","following_url":"https://api.github.com/users/mdtusz/following{/other_user}","gists_url":"https://api.github.com/users/mdtusz/gists{/gist_id}","starred_url":"https://api.github.com/users/mdtusz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdtusz/subscriptions","organizations_url":"https://api.github.com/users/mdtusz/orgs","repos_url":"https://api.github.com/users/mdtusz/repos","events_url":"https://api.github.com/users/mdtusz/events{/privacy}","received_events_url":"https://api.github.com/users/mdtusz/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"291d3c54a32f5bfa0ccaf4130e3bfeb5e6876961","commit_url":"https://api.github.com/repos/mdtusz/sqlx/commits/291d3c54a32f5bfa0ccaf4130e3bfeb5e6876961","created_at":"2022-06-02T02:52:08Z","performed_via_github_app":null},{"id":6725004918,"node_id":"REFE_lADODb6dM84y2YWozwAAAAGQ1252","url":"https://api.github.com/repos/launchbadge/sqlx/issues/events/6725004918","actor":{"login":"mdtusz","id":6494463,"node_id":"MDQ6VXNlcjY0OTQ0NjM=","avatar_url":"https://avatars.githubusercontent.com/u/6494463?v=4","gravatar_id":"","url":"https://api.github.com/users/mdtusz","html_url":"https://github.com/mdtusz","followers_url":"https://api.github.com/users/mdtusz/followers","following_url":"https://api.github.com/users/mdtusz/following{/other_user}","gists_url":"https://api.github.com/users/mdtusz/gists{/gist_id}","starred_url":"https://api.github.com/users/mdtusz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdtusz/subscriptions","organizations_url":"https://api.github.com/users/mdtusz/orgs","repos_url":"https://api.github.com/users/mdtusz/repos","events_url":"https://api.github.com/users/mdtusz/events{/privacy}","received_events_url":"https://api.github.com/users/mdtusz/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"07865b294134180ef4bd11b21d218aa6468052da","commit_url":"https://api.github.com/repos/mdtusz/sqlx/commits/07865b294134180ef4bd11b21d218aa6468052da","created_at":"2022-06-02T03:14:29Z","performed_via_github_app":null},{"actor":{"login":"mdtusz","id":6494463,"node_id":"MDQ6VXNlcjY0OTQ0NjM=","avatar_url":"https://avatars.githubusercontent.com/u/6494463?v=4","gravatar_id":"","url":"https://api.github.com/users/mdtusz","html_url":"https://github.com/mdtusz","followers_url":"https://api.github.com/users/mdtusz/followers","following_url":"https://api.github.com/users/mdtusz/following{/other_user}","gists_url":"https://api.github.com/users/mdtusz/gists{/gist_id}","starred_url":"https://api.github.com/users/mdtusz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdtusz/subscriptions","organizations_url":"https://api.github.com/users/mdtusz/orgs","repos_url":"https://api.github.com/users/mdtusz/repos","events_url":"https://api.github.com/users/mdtusz/events{/privacy}","received_events_url":"https://api.github.com/users/mdtusz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-02T03:24:16Z","updated_at":"2022-06-02T03:24:16Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/1888","repository_url":"https://api.github.com/repos/launchbadge/sqlx","labels_url":"https://api.github.com/repos/launchbadge/sqlx/issues/1888/labels{/name}","comments_url":"https://api.github.com/repos/launchbadge/sqlx/issues/1888/comments","events_url":"https://api.github.com/repos/launchbadge/sqlx/issues/1888/events","html_url":"https://github.com/launchbadge/sqlx/pull/1888","id":1257634421,"node_id":"PR_kwDODb6dM8448rXn","number":1888,"title":"Fix migration checksum comparison during `migrate info`","user":{"login":"mdtusz","id":6494463,"node_id":"MDQ6VXNlcjY0OTQ0NjM=","avatar_url":"https://avatars.githubusercontent.com/u/6494463?v=4","gravatar_id":"","url":"https://api.github.com/users/mdtusz","html_url":"https://github.com/mdtusz","followers_url":"https://api.github.com/users/mdtusz/followers","following_url":"https://api.github.com/users/mdtusz/following{/other_user}","gists_url":"https://api.github.com/users/mdtusz/gists{/gist_id}","starred_url":"https://api.github.com/users/mdtusz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdtusz/subscriptions","organizations_url":"https://api.github.com/users/mdtusz/orgs","repos_url":"https://api.github.com/users/mdtusz/repos","events_url":"https://api.github.com/users/mdtusz/events{/privacy}","received_events_url":"https://api.github.com/users/mdtusz/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-06-02T03:24:16Z","updated_at":"2022-06-10T22:29:02Z","closed_at":"2022-06-10T19:07:23Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":230595891,"node_id":"MDEwOlJlcG9zaXRvcnkyMzA1OTU4OTE=","name":"sqlx","full_name":"launchbadge/sqlx","private":false,"owner":{"login":"launchbadge","id":10077001,"node_id":"MDEyOk9yZ2FuaXphdGlvbjEwMDc3MDAx","avatar_url":"https://avatars.githubusercontent.com/u/10077001?v=4","gravatar_id":"","url":"https://api.github.com/users/launchbadge","html_url":"https://github.com/launchbadge","followers_url":"https://api.github.com/users/launchbadge/followers","following_url":"https://api.github.com/users/launchbadge/following{/other_user}","gists_url":"https://api.github.com/users/launchbadge/gists{/gist_id}","starred_url":"https://api.github.com/users/launchbadge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/launchbadge/subscriptions","organizations_url":"https://api.github.com/users/launchbadge/orgs","repos_url":"https://api.github.com/users/launchbadge/repos","events_url":"https://api.github.com/users/launchbadge/events{/privacy}","received_events_url":"https://api.github.com/users/launchbadge/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/launchbadge/sqlx","description":"ðŸ§° The Rust SQL Toolkit. An async, pure Rust SQL crate featuring compile-time checked queries without a DSL. Supports PostgreSQL, MySQL, and SQLite.","fork":false,"url":"https://api.github.com/repos/launchbadge/sqlx","forks_url":"https://api.github.com/repos/launchbadge/sqlx/forks","keys_url":"https://api.github.com/repos/launchbadge/sqlx/keys{/key_id}","collaborators_url":"https://api.github.com/repos/launchbadge/sqlx/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/launchbadge/sqlx/teams","hooks_url":"https://api.github.com/repos/launchbadge/sqlx/hooks","issue_events_url":"https://api.github.com/repos/launchbadge/sqlx/issues/events{/number}","events_url":"https://api.github.com/repos/launchbadge/sqlx/events","assignees_url":"https://api.github.com/repos/launchbadge/sqlx/assignees{/user}","branches_url":"https://api.github.com/repos/launchbadge/sqlx/branches{/branch}","tags_url":"https://api.github.com/repos/launchbadge/sqlx/tags","blobs_url":"https://api.github.com/repos/launchbadge/sqlx/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/launchbadge/sqlx/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/launchbadge/sqlx/git/refs{/sha}","trees_url":"https://api.github.com/repos/launchbadge/sqlx/git/trees{/sha}","statuses_url":"https://api.github.com/repos/launchbadge/sqlx/statuses/{sha}","languages_url":"https://api.github.com/repos/launchbadge/sqlx/languages","stargazers_url":"https://api.github.com/repos/launchbadge/sqlx/stargazers","contributors_url":"https://api.github.com/repos/launchbadge/sqlx/contributors","subscribers_url":"https://api.github.com/repos/launchbadge/sqlx/subscribers","subscription_url":"https://api.github.com/repos/launchbadge/sqlx/subscription","commits_url":"https://api.github.com/repos/launchbadge/sqlx/commits{/sha}","git_commits_url":"https://api.github.com/repos/launchbadge/sqlx/git/commits{/sha}","comments_url":"https://api.github.com/repos/launchbadge/sqlx/comments{/number}","issue_comment_url":"https://api.github.com/repos/launchbadge/sqlx/issues/comments{/number}","contents_url":"https://api.github.com/repos/launchbadge/sqlx/contents/{+path}","compare_url":"https://api.github.com/repos/launchbadge/sqlx/compare/{base}...{head}","merges_url":"https://api.github.com/repos/launchbadge/sqlx/merges","archive_url":"https://api.github.com/repos/launchbadge/sqlx/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/launchbadge/sqlx/downloads","issues_url":"https://api.github.com/repos/launchbadge/sqlx/issues{/number}","pulls_url":"https://api.github.com/repos/launchbadge/sqlx/pulls{/number}","milestones_url":"https://api.github.com/repos/launchbadge/sqlx/milestones{/number}","notifications_url":"https://api.github.com/repos/launchbadge/sqlx/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/launchbadge/sqlx/labels{/name}","releases_url":"https://api.github.com/repos/launchbadge/sqlx/releases{/id}","deployments_url":"https://api.github.com/repos/launchbadge/sqlx/deployments","created_at":"2019-12-28T10:40:57Z","updated_at":"2025-11-10T07:15:41Z","pushed_at":"2025-10-29T18:37:49Z","git_url":"git://github.com/launchbadge/sqlx.git","ssh_url":"git@github.com:launchbadge/sqlx.git","clone_url":"https://github.com/launchbadge/sqlx.git","svn_url":"https://github.com/launchbadge/sqlx","homepage":"","size":9641,"stargazers_count":15938,"watchers_count":15938,"language":"Rust","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":1502,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":701,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["async","await","mariadb","mysql","postgres","postgresql","rust","sql","sqlite"],"visibility":"public","forks":1502,"open_issues":701,"watchers":15938,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/launchbadge/sqlx/pulls/1888","html_url":"https://github.com/launchbadge/sqlx/pull/1888","diff_url":"https://github.com/launchbadge/sqlx/pull/1888.diff","patch_url":"https://github.com/launchbadge/sqlx/pull/1888.patch","merged_at":"2022-06-10T19:07:23Z"},"body":"When running `sqlx migrate info`, the applied migrations checksums are\r\ncompared against the checksums of the local migration files. While the\r\nchecksums of applied migrations are stored correctly in the database as\r\nsha384sum values, the `migrate info` command was incorrectly comparing\r\nthese against the checksums of down-migrations in cases where reversible\r\nmigrations are being used (e.g. when migrations end in `.up.sql` and\r\n`.down.sql`).\r\n\r\nThis fixes the issue by skipping over any migrations with the\r\n`MigrationType::ReversibleDown` type, using the same idiom as is used\r\nwhen running migrations (with `migrate run`).\r\n\r\nIssue introduced in #1680\r\nPartially resolves #1158","reactions":{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/1888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/launchbadge/sqlx/issues/1888/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":6741300679,"node_id":"REFE_lADODb6dM84y2YWozwAAAAGR0BXH","url":"https://api.github.com/repos/launchbadge/sqlx/issues/events/6741300679","actor":{"login":"mdtusz","id":6494463,"node_id":"MDQ6VXNlcjY0OTQ0NjM=","avatar_url":"https://avatars.githubusercontent.com/u/6494463?v=4","gravatar_id":"","url":"https://api.github.com/users/mdtusz","html_url":"https://github.com/mdtusz","followers_url":"https://api.github.com/users/mdtusz/followers","following_url":"https://api.github.com/users/mdtusz/following{/other_user}","gists_url":"https://api.github.com/users/mdtusz/gists{/gist_id}","starred_url":"https://api.github.com/users/mdtusz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdtusz/subscriptions","organizations_url":"https://api.github.com/users/mdtusz/orgs","repos_url":"https://api.github.com/users/mdtusz/repos","events_url":"https://api.github.com/users/mdtusz/events{/privacy}","received_events_url":"https://api.github.com/users/mdtusz/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"53276c7d74c01550e8a9fe9b922713997e942754","commit_url":"https://api.github.com/repos/mdtusz/sqlx/commits/53276c7d74c01550e8a9fe9b922713997e942754","created_at":"2022-06-04T06:38:25Z","performed_via_github_app":null},{"id":6741303162,"node_id":"REFE_lADODb6dM84y2YWozwAAAAGR0B96","url":"https://api.github.com/repos/launchbadge/sqlx/issues/events/6741303162","actor":{"login":"mdtusz","id":6494463,"node_id":"MDQ6VXNlcjY0OTQ0NjM=","avatar_url":"https://avatars.githubusercontent.com/u/6494463?v=4","gravatar_id":"","url":"https://api.github.com/users/mdtusz","html_url":"https://github.com/mdtusz","followers_url":"https://api.github.com/users/mdtusz/followers","following_url":"https://api.github.com/users/mdtusz/following{/other_user}","gists_url":"https://api.github.com/users/mdtusz/gists{/gist_id}","starred_url":"https://api.github.com/users/mdtusz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdtusz/subscriptions","organizations_url":"https://api.github.com/users/mdtusz/orgs","repos_url":"https://api.github.com/users/mdtusz/repos","events_url":"https://api.github.com/users/mdtusz/events{/privacy}","received_events_url":"https://api.github.com/users/mdtusz/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"94b3375833874a9d9185480ae857d2063d16e0c2","commit_url":"https://api.github.com/repos/mdtusz/sqlx/commits/94b3375833874a9d9185480ae857d2063d16e0c2","created_at":"2022-06-04T06:41:27Z","performed_via_github_app":null},{"id":6788183343,"node_id":"CE_lADODb6dM84y2YWozwAAAAGUm3Uv","url":"https://api.github.com/repos/launchbadge/sqlx/issues/events/6788183343","actor":{"login":"abonander","id":3198595,"node_id":"MDQ6VXNlcjMxOTg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3198595?v=4","gravatar_id":"","url":"https://api.github.com/users/abonander","html_url":"https://github.com/abonander","followers_url":"https://api.github.com/users/abonander/followers","following_url":"https://api.github.com/users/abonander/following{/other_user}","gists_url":"https://api.github.com/users/abonander/gists{/gist_id}","starred_url":"https://api.github.com/users/abonander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abonander/subscriptions","organizations_url":"https://api.github.com/users/abonander/orgs","repos_url":"https://api.github.com/users/abonander/repos","events_url":"https://api.github.com/users/abonander/events{/privacy}","received_events_url":"https://api.github.com/users/abonander/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-06-10T19:07:23Z","state_reason":null,"performed_via_github_app":null},{"id":6788183527,"node_id":"REFE_lADODb6dM84y2YWozwAAAAGUm3Xn","url":"https://api.github.com/repos/launchbadge/sqlx/issues/events/6788183527","actor":{"login":"abonander","id":3198595,"node_id":"MDQ6VXNlcjMxOTg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3198595?v=4","gravatar_id":"","url":"https://api.github.com/users/abonander","html_url":"https://github.com/abonander","followers_url":"https://api.github.com/users/abonander/followers","following_url":"https://api.github.com/users/abonander/following{/other_user}","gists_url":"https://api.github.com/users/abonander/gists{/gist_id}","starred_url":"https://api.github.com/users/abonander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abonander/subscriptions","organizations_url":"https://api.github.com/users/abonander/orgs","repos_url":"https://api.github.com/users/abonander/repos","events_url":"https://api.github.com/users/abonander/events{/privacy}","received_events_url":"https://api.github.com/users/abonander/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"664d5766553c894aecbbaa39166014044554f9a4","commit_url":"https://api.github.com/repos/launchbadge/sqlx/commits/664d5766553c894aecbbaa39166014044554f9a4","created_at":"2022-06-10T19:07:26Z","performed_via_github_app":null}]