[{"id":8602913462,"node_id":"LE_lADODb6dM85fTA9IzwAAAAIAxgq2","url":"https://api.github.com/repos/launchbadge/sqlx/issues/events/8602913462","actor":{"login":"MartinKavik","id":18517402,"node_id":"MDQ6VXNlcjE4NTE3NDAy","avatar_url":"https://avatars.githubusercontent.com/u/18517402?v=4","gravatar_id":"","url":"https://api.github.com/users/MartinKavik","html_url":"https://github.com/MartinKavik","followers_url":"https://api.github.com/users/MartinKavik/followers","following_url":"https://api.github.com/users/MartinKavik/following{/other_user}","gists_url":"https://api.github.com/users/MartinKavik/gists{/gist_id}","starred_url":"https://api.github.com/users/MartinKavik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MartinKavik/subscriptions","organizations_url":"https://api.github.com/users/MartinKavik/orgs","repos_url":"https://api.github.com/users/MartinKavik/repos","events_url":"https://api.github.com/users/MartinKavik/events{/privacy}","received_events_url":"https://api.github.com/users/MartinKavik/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-02-24T15:12:34Z","label":{"name":"bug","color":"e11d21"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/comments/1452648349","html_url":"https://github.com/launchbadge/sqlx/issues/2372#issuecomment-1452648349","issue_url":"https://api.github.com/repos/launchbadge/sqlx/issues/2372","id":1452648349,"node_id":"IC_kwDODb6dM85Wlaed","user":{"login":"DominicWrege","id":7389000,"node_id":"MDQ6VXNlcjczODkwMDA=","avatar_url":"https://avatars.githubusercontent.com/u/7389000?v=4","gravatar_id":"","url":"https://api.github.com/users/DominicWrege","html_url":"https://github.com/DominicWrege","followers_url":"https://api.github.com/users/DominicWrege/followers","following_url":"https://api.github.com/users/DominicWrege/following{/other_user}","gists_url":"https://api.github.com/users/DominicWrege/gists{/gist_id}","starred_url":"https://api.github.com/users/DominicWrege/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DominicWrege/subscriptions","organizations_url":"https://api.github.com/users/DominicWrege/orgs","repos_url":"https://api.github.com/users/DominicWrege/repos","events_url":"https://api.github.com/users/DominicWrege/events{/privacy}","received_events_url":"https://api.github.com/users/DominicWrege/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T22:30:13Z","updated_at":"2023-03-02T22:30:13Z","body":"Since postgres 15.2 my application grows in terms of memory consumption (2.5Â GB)","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/comments/1452648349/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"DominicWrege","id":7389000,"node_id":"MDQ6VXNlcjczODkwMDA=","avatar_url":"https://avatars.githubusercontent.com/u/7389000?v=4","gravatar_id":"","url":"https://api.github.com/users/DominicWrege","html_url":"https://github.com/DominicWrege","followers_url":"https://api.github.com/users/DominicWrege/followers","following_url":"https://api.github.com/users/DominicWrege/following{/other_user}","gists_url":"https://api.github.com/users/DominicWrege/gists{/gist_id}","starred_url":"https://api.github.com/users/DominicWrege/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DominicWrege/subscriptions","organizations_url":"https://api.github.com/users/DominicWrege/orgs","repos_url":"https://api.github.com/users/DominicWrege/repos","events_url":"https://api.github.com/users/DominicWrege/events{/privacy}","received_events_url":"https://api.github.com/users/DominicWrege/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/comments/1452675062","html_url":"https://github.com/launchbadge/sqlx/issues/2372#issuecomment-1452675062","issue_url":"https://api.github.com/repos/launchbadge/sqlx/issues/2372","id":1452675062,"node_id":"IC_kwDODb6dM85Wlg_2","user":{"login":"abonander","id":3198595,"node_id":"MDQ6VXNlcjMxOTg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3198595?v=4","gravatar_id":"","url":"https://api.github.com/users/abonander","html_url":"https://github.com/abonander","followers_url":"https://api.github.com/users/abonander/followers","following_url":"https://api.github.com/users/abonander/following{/other_user}","gists_url":"https://api.github.com/users/abonander/gists{/gist_id}","starred_url":"https://api.github.com/users/abonander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abonander/subscriptions","organizations_url":"https://api.github.com/users/abonander/orgs","repos_url":"https://api.github.com/users/abonander/repos","events_url":"https://api.github.com/users/abonander/events{/privacy}","received_events_url":"https://api.github.com/users/abonander/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-02T22:53:14Z","updated_at":"2023-03-03T01:43:56Z","body":"It's not a leak but it is perhaps suboptimal behavior.\r\n\r\nIt has nothing to do with prepared statement caching; it's simply because we push whole messages to the stream's write buffer, growing it if necessary, but once those messages are flushed the excess capacity is retained because it's likely for that capacity to be needed again soon.\r\n\r\nEnsuring we always push whole messages to the buffer helps prevent issues with cancellation, as we should never send a truncated or garbled message that might confuse the server.\r\n\r\nHowever, if you're just using the pool directly it's unlikely that it will use the same connection twice in a row, so you have the issue of duplicating this excess allocation on potentially every query. That's likely why you're hitting OOM conditions.\r\n\r\nAs a temporary fix, you could `.acquire()` a connection from the pool, use it for this query, then `.detach()` and `.close()` it:\r\n\r\n```rust\r\nlet mut conn = pool.acquire().await?;\r\n\r\nsqlx::query!(\"INSERT INTO test_table VALUES ($1)\", data)\r\n    .execute(&mut *conn)\r\n    .await?;\r\n\r\nconn.detach().close().await?;\r\n```\r\n\r\nThis _may_ be error-prone if you're running with `max_connections` close to the Postgres server's connection limit (100) as the pool may open a new connection while this one is still being closed. We should probably add a direct `.close()` method to `PoolConnection` for situations like this.\r\n\r\nYou could also push smaller chunks with separate queries in a transaction.\r\n\r\nYou could use [`copy_in_raw()`](https://docs.rs/sqlx/latest/sqlx/struct.Pool.html#method.copy_in_raw) and feed the binary data directly to the database, although avoid doing one [`.send()`](https://docs.rs/sqlx/latest/sqlx/postgres/struct.PgCopyIn.html#method.send) call with the full thing as that would have the same problem. The `COPY IN` statement and binary format are documented here: https://www.postgresql.org/docs/current/sql-copy.html\r\n\r\nIt's a shame we don't have an API for [large objects](https://www.postgresql.org/docs/15/largeobjects.html) because I think that'd be the ideal thing to use here. You could use [the server-side functions](https://www.postgresql.org/docs/15/lo-funcs.html) though.\r\n\r\nAs for a real solution, I'm not sure. We certainly _could_ be smarter about how we manage the connection buffers, perhaps tracking the actual capacity we're using over time and shrinking it if it's not being used. That logic could probably live [here](https://github.com/launchbadge/sqlx/blob/main/sqlx-core/src/io/write_and_flush.rs#L19), though we likely don't want to do that _every_ flush as that could cause a lot of thrashing in the allocator.\r\n\r\nWe could add a `.shrink_buffers()` method to the `Connection` trait so the application can suggest when to free up memory, although again if you're calling that too often then the overhead of hitting allocator could become significant.\r\n\r\nThe buffering itself could be smarter such that we don't push whole messages to a single `Vec<u8>` but that would be a significant refactor.","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/comments/1452675062/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"abonander","id":3198595,"node_id":"MDQ6VXNlcjMxOTg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3198595?v=4","gravatar_id":"","url":"https://api.github.com/users/abonander","html_url":"https://github.com/abonander","followers_url":"https://api.github.com/users/abonander/followers","following_url":"https://api.github.com/users/abonander/following{/other_user}","gists_url":"https://api.github.com/users/abonander/gists{/gist_id}","starred_url":"https://api.github.com/users/abonander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abonander/subscriptions","organizations_url":"https://api.github.com/users/abonander/orgs","repos_url":"https://api.github.com/users/abonander/repos","events_url":"https://api.github.com/users/abonander/events{/privacy}","received_events_url":"https://api.github.com/users/abonander/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/comments/1454131436","html_url":"https://github.com/launchbadge/sqlx/issues/2372#issuecomment-1454131436","issue_url":"https://api.github.com/repos/launchbadge/sqlx/issues/2372","id":1454131436,"node_id":"IC_kwDODb6dM85WrEjs","user":{"login":"MartinKavik","id":18517402,"node_id":"MDQ6VXNlcjE4NTE3NDAy","avatar_url":"https://avatars.githubusercontent.com/u/18517402?v=4","gravatar_id":"","url":"https://api.github.com/users/MartinKavik","html_url":"https://github.com/MartinKavik","followers_url":"https://api.github.com/users/MartinKavik/followers","following_url":"https://api.github.com/users/MartinKavik/following{/other_user}","gists_url":"https://api.github.com/users/MartinKavik/gists{/gist_id}","starred_url":"https://api.github.com/users/MartinKavik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MartinKavik/subscriptions","organizations_url":"https://api.github.com/users/MartinKavik/orgs","repos_url":"https://api.github.com/users/MartinKavik/repos","events_url":"https://api.github.com/users/MartinKavik/events{/privacy}","received_events_url":"https://api.github.com/users/MartinKavik/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T21:08:12Z","updated_at":"2023-03-03T21:08:12Z","body":"@abonander Thanks for detailed and interesting response!\r\n\r\n---\r\n\r\n> You could also push smaller chunks with separate queries in a transaction.\r\n\r\nYes, it was my first workaround but I didn't like the changed app code.\r\n\r\n---\r\n\r\n> However, if you're just using the pool directly\r\n\r\n`sqlx` is hidden under the [SeaORM](https://github.com/SeaQL/sea-orm) layer in my case so basically no direct access is possible.\r\n\r\n---\r\n\r\n> As for a real solution, I'm not sure. We certainly could be smarter about how we manage the connection buffers, perhaps tracking the actual capacity we're using over time and shrinking it if it's not being used. That logic could probably live [here](https://github.com/launchbadge/sqlx/blob/main/sqlx-core/src/io/write_and_flush.rs#L19), though we likely don't want to do that every flush as that could cause a lot of thrashing in the allocator.\r\n\r\nI was \"playing\" with the code in `write_and_flush.rs` but changing capacity of the buffer didn't come to my mind for some reasons :facepalm: \r\n\r\nI've tested my app with slightly modified code in that file:\r\n```rust\r\n// ...\r\nimpl<'a, S> Drop for WriteAndFlush<'a, S> {\r\n    fn drop(&mut self) {\r\n        let buf_vec = self.buf.get_mut();\r\n        // clear the buffer regardless of whether the flush succeeded or not\r\n        buf_vec.clear();\r\n        buf_vec.shrink_to(512); \r\n    }\r\n}\r\n```\r\nand so far it seems to work as expected :+1: \r\n`512` seems to be the default capacity and it's enough for almost all queries according my manual testing with my app.\r\n\r\nIf anybody want to test it, the change is in my fork, in the branch created from the tag 0.6.2:\r\n```toml\r\n[patch.crates-io]\r\nsqlx-core = { git = \"https://github.com/MartinKavik/sqlx\", branch = \"fix/buf_limit_512_from_v062\" }\r\n```\r\n\r\nI can image I/we can just add that `.shrink_to` call with `512` constant replaced with a configurable (env?) variable to resolve this issue until proper solution is designed because it seems to be a bit edge-case but still a blocking edge-case for people like me. What do you think? ","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/comments/1454131436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MartinKavik","id":18517402,"node_id":"MDQ6VXNlcjE4NTE3NDAy","avatar_url":"https://avatars.githubusercontent.com/u/18517402?v=4","gravatar_id":"","url":"https://api.github.com/users/MartinKavik","html_url":"https://github.com/MartinKavik","followers_url":"https://api.github.com/users/MartinKavik/followers","following_url":"https://api.github.com/users/MartinKavik/following{/other_user}","gists_url":"https://api.github.com/users/MartinKavik/gists{/gist_id}","starred_url":"https://api.github.com/users/MartinKavik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MartinKavik/subscriptions","organizations_url":"https://api.github.com/users/MartinKavik/orgs","repos_url":"https://api.github.com/users/MartinKavik/repos","events_url":"https://api.github.com/users/MartinKavik/events{/privacy}","received_events_url":"https://api.github.com/users/MartinKavik/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":8663504223,"node_id":"MEE_lADODb6dM85fTA9IzwAAAAIEYpVf","url":"https://api.github.com/repos/launchbadge/sqlx/issues/events/8663504223","actor":{"login":"abonander","id":3198595,"node_id":"MDQ6VXNlcjMxOTg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3198595?v=4","gravatar_id":"","url":"https://api.github.com/users/abonander","html_url":"https://github.com/abonander","followers_url":"https://api.github.com/users/abonander/followers","following_url":"https://api.github.com/users/abonander/following{/other_user}","gists_url":"https://api.github.com/users/abonander/gists{/gist_id}","starred_url":"https://api.github.com/users/abonander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abonander/subscriptions","organizations_url":"https://api.github.com/users/abonander/orgs","repos_url":"https://api.github.com/users/abonander/repos","events_url":"https://api.github.com/users/abonander/events{/privacy}","received_events_url":"https://api.github.com/users/abonander/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2023-03-03T21:08:13Z","performed_via_github_app":null},{"id":8663504230,"node_id":"SE_lADODb6dM85fTA9IzwAAAAIEYpVm","url":"https://api.github.com/repos/launchbadge/sqlx/issues/events/8663504230","actor":{"login":"abonander","id":3198595,"node_id":"MDQ6VXNlcjMxOTg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3198595?v=4","gravatar_id":"","url":"https://api.github.com/users/abonander","html_url":"https://github.com/abonander","followers_url":"https://api.github.com/users/abonander/followers","following_url":"https://api.github.com/users/abonander/following{/other_user}","gists_url":"https://api.github.com/users/abonander/gists{/gist_id}","starred_url":"https://api.github.com/users/abonander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abonander/subscriptions","organizations_url":"https://api.github.com/users/abonander/orgs","repos_url":"https://api.github.com/users/abonander/repos","events_url":"https://api.github.com/users/abonander/events{/privacy}","received_events_url":"https://api.github.com/users/abonander/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2023-03-03T21:08:13Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/comments/1454136173","html_url":"https://github.com/launchbadge/sqlx/issues/2372#issuecomment-1454136173","issue_url":"https://api.github.com/repos/launchbadge/sqlx/issues/2372","id":1454136173,"node_id":"IC_kwDODb6dM85WrFtt","user":{"login":"abonander","id":3198595,"node_id":"MDQ6VXNlcjMxOTg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3198595?v=4","gravatar_id":"","url":"https://api.github.com/users/abonander","html_url":"https://github.com/abonander","followers_url":"https://api.github.com/users/abonander/followers","following_url":"https://api.github.com/users/abonander/following{/other_user}","gists_url":"https://api.github.com/users/abonander/gists{/gist_id}","starred_url":"https://api.github.com/users/abonander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abonander/subscriptions","organizations_url":"https://api.github.com/users/abonander/orgs","repos_url":"https://api.github.com/users/abonander/repos","events_url":"https://api.github.com/users/abonander/events{/privacy}","received_events_url":"https://api.github.com/users/abonander/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T21:12:36Z","updated_at":"2023-03-03T21:13:09Z","body":"I'm adding a `.shrink_buffers()` method to `Connection` but it's going to have to land in 0.7.0 because we're in the middle of an alpha cycle for that release.\r\n\r\nThe default buffer size is `8192`, that's pretty much what all of Tokio, `async-std` and `std` use for their buffered I/O.","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/comments/1454136173/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"abonander","id":3198595,"node_id":"MDQ6VXNlcjMxOTg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3198595?v=4","gravatar_id":"","url":"https://api.github.com/users/abonander","html_url":"https://github.com/abonander","followers_url":"https://api.github.com/users/abonander/followers","following_url":"https://api.github.com/users/abonander/following{/other_user}","gists_url":"https://api.github.com/users/abonander/gists{/gist_id}","starred_url":"https://api.github.com/users/abonander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abonander/subscriptions","organizations_url":"https://api.github.com/users/abonander/orgs","repos_url":"https://api.github.com/users/abonander/repos","events_url":"https://api.github.com/users/abonander/events{/privacy}","received_events_url":"https://api.github.com/users/abonander/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/comments/1454138306","html_url":"https://github.com/launchbadge/sqlx/issues/2372#issuecomment-1454138306","issue_url":"https://api.github.com/repos/launchbadge/sqlx/issues/2372","id":1454138306,"node_id":"IC_kwDODb6dM85WrGPC","user":{"login":"abonander","id":3198595,"node_id":"MDQ6VXNlcjMxOTg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3198595?v=4","gravatar_id":"","url":"https://api.github.com/users/abonander","html_url":"https://github.com/abonander","followers_url":"https://api.github.com/users/abonander/followers","following_url":"https://api.github.com/users/abonander/following{/other_user}","gists_url":"https://api.github.com/users/abonander/gists{/gist_id}","starred_url":"https://api.github.com/users/abonander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abonander/subscriptions","organizations_url":"https://api.github.com/users/abonander/orgs","repos_url":"https://api.github.com/users/abonander/repos","events_url":"https://api.github.com/users/abonander/events{/privacy}","received_events_url":"https://api.github.com/users/abonander/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-03T21:14:30Z","updated_at":"2023-03-03T21:14:39Z","body":"I don't want to hardcode a shrink call to the buffer every time it's flushed because that could cause a lot of unnecessary thrashing in the global allocator, it could especially cause fragmentation issues in an allocator like `glibc`'s.","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/comments/1454138306/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"abonander","id":3198595,"node_id":"MDQ6VXNlcjMxOTg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3198595?v=4","gravatar_id":"","url":"https://api.github.com/users/abonander","html_url":"https://github.com/abonander","followers_url":"https://api.github.com/users/abonander/followers","following_url":"https://api.github.com/users/abonander/following{/other_user}","gists_url":"https://api.github.com/users/abonander/gists{/gist_id}","starred_url":"https://api.github.com/users/abonander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abonander/subscriptions","organizations_url":"https://api.github.com/users/abonander/orgs","repos_url":"https://api.github.com/users/abonander/repos","events_url":"https://api.github.com/users/abonander/events{/privacy}","received_events_url":"https://api.github.com/users/abonander/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":8664591281,"node_id":"REFE_lADODb6dM85fTA9IzwAAAAIEcyux","url":"https://api.github.com/repos/launchbadge/sqlx/issues/events/8664591281","actor":{"login":"abonander","id":3198595,"node_id":"MDQ6VXNlcjMxOTg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3198595?v=4","gravatar_id":"","url":"https://api.github.com/users/abonander","html_url":"https://github.com/abonander","followers_url":"https://api.github.com/users/abonander/followers","following_url":"https://api.github.com/users/abonander/following{/other_user}","gists_url":"https://api.github.com/users/abonander/gists{/gist_id}","starred_url":"https://api.github.com/users/abonander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abonander/subscriptions","organizations_url":"https://api.github.com/users/abonander/orgs","repos_url":"https://api.github.com/users/abonander/repos","events_url":"https://api.github.com/users/abonander/events{/privacy}","received_events_url":"https://api.github.com/users/abonander/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"1a0519f22927422a253ef9b991c1315cbabb987a","commit_url":"https://api.github.com/repos/launchbadge/sqlx/commits/1a0519f22927422a253ef9b991c1315cbabb987a","created_at":"2023-03-04T00:09:12Z","performed_via_github_app":null},{"actor":{"login":"abonander","id":3198595,"node_id":"MDQ6VXNlcjMxOTg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3198595?v=4","gravatar_id":"","url":"https://api.github.com/users/abonander","html_url":"https://github.com/abonander","followers_url":"https://api.github.com/users/abonander/followers","following_url":"https://api.github.com/users/abonander/following{/other_user}","gists_url":"https://api.github.com/users/abonander/gists{/gist_id}","starred_url":"https://api.github.com/users/abonander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abonander/subscriptions","organizations_url":"https://api.github.com/users/abonander/orgs","repos_url":"https://api.github.com/users/abonander/repos","events_url":"https://api.github.com/users/abonander/events{/privacy}","received_events_url":"https://api.github.com/users/abonander/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-04T00:09:19Z","updated_at":"2023-03-04T00:09:19Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/2379","repository_url":"https://api.github.com/repos/launchbadge/sqlx","labels_url":"https://api.github.com/repos/launchbadge/sqlx/issues/2379/labels{/name}","comments_url":"https://api.github.com/repos/launchbadge/sqlx/issues/2379/comments","events_url":"https://api.github.com/repos/launchbadge/sqlx/issues/2379/events","html_url":"https://github.com/launchbadge/sqlx/pull/2379","id":1609447054,"node_id":"PR_kwDODb6dM85LRMXm","number":2379,"title":"feat: add `Connection::shrink_buffers`, `PoolConnection::close`","user":{"login":"abonander","id":3198595,"node_id":"MDQ6VXNlcjMxOTg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3198595?v=4","gravatar_id":"","url":"https://api.github.com/users/abonander","html_url":"https://github.com/abonander","followers_url":"https://api.github.com/users/abonander/followers","following_url":"https://api.github.com/users/abonander/following{/other_user}","gists_url":"https://api.github.com/users/abonander/gists{/gist_id}","starred_url":"https://api.github.com/users/abonander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abonander/subscriptions","organizations_url":"https://api.github.com/users/abonander/orgs","repos_url":"https://api.github.com/users/abonander/repos","events_url":"https://api.github.com/users/abonander/events{/privacy}","received_events_url":"https://api.github.com/users/abonander/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-03-04T00:09:19Z","updated_at":"2023-03-04T00:50:28Z","closed_at":"2023-03-04T00:50:27Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":230595891,"node_id":"MDEwOlJlcG9zaXRvcnkyMzA1OTU4OTE=","name":"sqlx","full_name":"launchbadge/sqlx","private":false,"owner":{"login":"launchbadge","id":10077001,"node_id":"MDEyOk9yZ2FuaXphdGlvbjEwMDc3MDAx","avatar_url":"https://avatars.githubusercontent.com/u/10077001?v=4","gravatar_id":"","url":"https://api.github.com/users/launchbadge","html_url":"https://github.com/launchbadge","followers_url":"https://api.github.com/users/launchbadge/followers","following_url":"https://api.github.com/users/launchbadge/following{/other_user}","gists_url":"https://api.github.com/users/launchbadge/gists{/gist_id}","starred_url":"https://api.github.com/users/launchbadge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/launchbadge/subscriptions","organizations_url":"https://api.github.com/users/launchbadge/orgs","repos_url":"https://api.github.com/users/launchbadge/repos","events_url":"https://api.github.com/users/launchbadge/events{/privacy}","received_events_url":"https://api.github.com/users/launchbadge/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/launchbadge/sqlx","description":"ðŸ§° The Rust SQL Toolkit. An async, pure Rust SQL crate featuring compile-time checked queries without a DSL. Supports PostgreSQL, MySQL, and SQLite.","fork":false,"url":"https://api.github.com/repos/launchbadge/sqlx","forks_url":"https://api.github.com/repos/launchbadge/sqlx/forks","keys_url":"https://api.github.com/repos/launchbadge/sqlx/keys{/key_id}","collaborators_url":"https://api.github.com/repos/launchbadge/sqlx/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/launchbadge/sqlx/teams","hooks_url":"https://api.github.com/repos/launchbadge/sqlx/hooks","issue_events_url":"https://api.github.com/repos/launchbadge/sqlx/issues/events{/number}","events_url":"https://api.github.com/repos/launchbadge/sqlx/events","assignees_url":"https://api.github.com/repos/launchbadge/sqlx/assignees{/user}","branches_url":"https://api.github.com/repos/launchbadge/sqlx/branches{/branch}","tags_url":"https://api.github.com/repos/launchbadge/sqlx/tags","blobs_url":"https://api.github.com/repos/launchbadge/sqlx/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/launchbadge/sqlx/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/launchbadge/sqlx/git/refs{/sha}","trees_url":"https://api.github.com/repos/launchbadge/sqlx/git/trees{/sha}","statuses_url":"https://api.github.com/repos/launchbadge/sqlx/statuses/{sha}","languages_url":"https://api.github.com/repos/launchbadge/sqlx/languages","stargazers_url":"https://api.github.com/repos/launchbadge/sqlx/stargazers","contributors_url":"https://api.github.com/repos/launchbadge/sqlx/contributors","subscribers_url":"https://api.github.com/repos/launchbadge/sqlx/subscribers","subscription_url":"https://api.github.com/repos/launchbadge/sqlx/subscription","commits_url":"https://api.github.com/repos/launchbadge/sqlx/commits{/sha}","git_commits_url":"https://api.github.com/repos/launchbadge/sqlx/git/commits{/sha}","comments_url":"https://api.github.com/repos/launchbadge/sqlx/comments{/number}","issue_comment_url":"https://api.github.com/repos/launchbadge/sqlx/issues/comments{/number}","contents_url":"https://api.github.com/repos/launchbadge/sqlx/contents/{+path}","compare_url":"https://api.github.com/repos/launchbadge/sqlx/compare/{base}...{head}","merges_url":"https://api.github.com/repos/launchbadge/sqlx/merges","archive_url":"https://api.github.com/repos/launchbadge/sqlx/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/launchbadge/sqlx/downloads","issues_url":"https://api.github.com/repos/launchbadge/sqlx/issues{/number}","pulls_url":"https://api.github.com/repos/launchbadge/sqlx/pulls{/number}","milestones_url":"https://api.github.com/repos/launchbadge/sqlx/milestones{/number}","notifications_url":"https://api.github.com/repos/launchbadge/sqlx/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/launchbadge/sqlx/labels{/name}","releases_url":"https://api.github.com/repos/launchbadge/sqlx/releases{/id}","deployments_url":"https://api.github.com/repos/launchbadge/sqlx/deployments","created_at":"2019-12-28T10:40:57Z","updated_at":"2025-11-10T07:15:41Z","pushed_at":"2025-10-29T18:37:49Z","git_url":"git://github.com/launchbadge/sqlx.git","ssh_url":"git@github.com:launchbadge/sqlx.git","clone_url":"https://github.com/launchbadge/sqlx.git","svn_url":"https://github.com/launchbadge/sqlx","homepage":"","size":9641,"stargazers_count":15938,"watchers_count":15938,"language":"Rust","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":1502,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":701,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["async","await","mariadb","mysql","postgres","postgresql","rust","sql","sqlite"],"visibility":"public","forks":1502,"open_issues":701,"watchers":15938,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/launchbadge/sqlx/pulls/2379","html_url":"https://github.com/launchbadge/sqlx/pull/2379","diff_url":"https://github.com/launchbadge/sqlx/pull/2379.diff","patch_url":"https://github.com/launchbadge/sqlx/pull/2379.patch","merged_at":"2023-03-04T00:50:27Z"},"body":"BREAKING: adds new required method to `Connection` trait.\r\n\r\ncloses #2372","reactions":{"url":"https://api.github.com/repos/launchbadge/sqlx/issues/2379/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/launchbadge/sqlx/issues/2379/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":8664724607,"node_id":"CE_lADODb6dM85fTA9IzwAAAAIEdTR_","url":"https://api.github.com/repos/launchbadge/sqlx/issues/events/8664724607","actor":{"login":"abonander","id":3198595,"node_id":"MDQ6VXNlcjMxOTg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3198595?v=4","gravatar_id":"","url":"https://api.github.com/users/abonander","html_url":"https://github.com/abonander","followers_url":"https://api.github.com/users/abonander/followers","following_url":"https://api.github.com/users/abonander/following{/other_user}","gists_url":"https://api.github.com/users/abonander/gists{/gist_id}","starred_url":"https://api.github.com/users/abonander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abonander/subscriptions","organizations_url":"https://api.github.com/users/abonander/orgs","repos_url":"https://api.github.com/users/abonander/repos","events_url":"https://api.github.com/users/abonander/events{/privacy}","received_events_url":"https://api.github.com/users/abonander/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2023-03-04T00:50:29Z","state_reason":null,"performed_via_github_app":null},{"id":8664724653,"node_id":"REFE_lADODb6dM85fTA9IzwAAAAIEdTSt","url":"https://api.github.com/repos/launchbadge/sqlx/issues/events/8664724653","actor":{"login":"abonander","id":3198595,"node_id":"MDQ6VXNlcjMxOTg1OTU=","avatar_url":"https://avatars.githubusercontent.com/u/3198595?v=4","gravatar_id":"","url":"https://api.github.com/users/abonander","html_url":"https://github.com/abonander","followers_url":"https://api.github.com/users/abonander/followers","following_url":"https://api.github.com/users/abonander/following{/other_user}","gists_url":"https://api.github.com/users/abonander/gists{/gist_id}","starred_url":"https://api.github.com/users/abonander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abonander/subscriptions","organizations_url":"https://api.github.com/users/abonander/orgs","repos_url":"https://api.github.com/users/abonander/repos","events_url":"https://api.github.com/users/abonander/events{/privacy}","received_events_url":"https://api.github.com/users/abonander/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"c4b835c23a09390130500c87455fa76e7a768de5","commit_url":"https://api.github.com/repos/launchbadge/sqlx/commits/c4b835c23a09390130500c87455fa76e7a768de5","created_at":"2023-03-04T00:50:30Z","performed_via_github_app":null},{"id":8894787181,"node_id":"REFE_lADODb6dM85fTA9IzwAAAAISK65t","url":"https://api.github.com/repos/launchbadge/sqlx/issues/events/8894787181","actor":{"login":"Aandreba","id":4247991,"node_id":"MDQ6VXNlcjQyNDc5OTE=","avatar_url":"https://avatars.githubusercontent.com/u/4247991?v=4","gravatar_id":"","url":"https://api.github.com/users/Aandreba","html_url":"https://github.com/Aandreba","followers_url":"https://api.github.com/users/Aandreba/followers","following_url":"https://api.github.com/users/Aandreba/following{/other_user}","gists_url":"https://api.github.com/users/Aandreba/gists{/gist_id}","starred_url":"https://api.github.com/users/Aandreba/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Aandreba/subscriptions","organizations_url":"https://api.github.com/users/Aandreba/orgs","repos_url":"https://api.github.com/users/Aandreba/repos","events_url":"https://api.github.com/users/Aandreba/events{/privacy}","received_events_url":"https://api.github.com/users/Aandreba/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"225d0c2b0b371652821581b27670869f6f47bcc2","commit_url":"https://api.github.com/repos/Aandreba/sqlx/commits/225d0c2b0b371652821581b27670869f6f47bcc2","created_at":"2023-03-31T07:14:20Z","performed_via_github_app":null}]