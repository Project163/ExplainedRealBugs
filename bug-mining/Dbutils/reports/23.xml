<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:49:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DBUTILS-117] Error handling possible getParameterMetaData() results</title>
                <link>https://issues.apache.org/jira/browse/DBUTILS-117</link>
                <project id="12310470" key="DBUTILS">Commons DbUtils</project>
                    <description>&lt;p&gt;Error in fillStatement method of AbstractQueryRunner class.&lt;br/&gt;
There is no try...catch statement near pmd = stmt.getParameterMetaData();&lt;br/&gt;
So method fails instead of automaticallye turning pmdKnownBroken to true.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12682375">DBUTILS-117</key>
            <summary>Error handling possible getParameterMetaData() results</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="wadimx">Vadim Smirnov</reporter>
                        <labels>
                            <label>easyfix</label>
                            <label>newbie</label>
                    </labels>
                <created>Tue, 3 Dec 2013 12:54:14 +0000</created>
                <updated>Mon, 29 Jan 2018 17:29:36 +0000</updated>
                            <resolved>Thu, 4 Jun 2015 23:58:31 +0000</resolved>
                                    <version>1.5</version>
                                    <fixVersion>1.6</fixVersion>
                                        <due></due>
                            <votes>3</votes>
                                    <watches>10</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="3600">1h</timeoriginalestimate>
                            <timeestimate seconds="3600">1h</timeestimate>
                                        <comments>
                            <comment id="14063563" author="carabolic" created="Wed, 16 Jul 2014 14:50:02 +0000"  >&lt;p&gt;I&apos;ve had the same issue, when using Oracle DB 12 and DbUtils 1.5/1.6-SNAPSHOT (see attached stacktrace).&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.sql.SQLSyntaxErrorException: ORA-00904: &quot;A&quot;.&quot;TABLE_NAME&quot;: invalid identifier

	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:461)
	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:394)
	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:386)
	at oracle.jdbc.driver.T4CTTIfun.processError(T4CTTIfun.java:1039)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:681)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:256)
	at oracle.jdbc.driver.T4C8Odscrarr.doODNY(T4C8Odscrarr.java:93)
	at oracle.jdbc.driver.T4CPreparedStatement.doDescribe(T4CPreparedStatement.java:958)
	at oracle.jdbc.driver.OracleStatement.describe(OracleStatement.java:7290)
	at oracle.jdbc.driver.OracleResultSetMetaData.&amp;lt;init&amp;gt;(OracleResultSetMetaData.java:58)
	at oracle.jdbc.driver.OracleStatement.getResultSetMetaData(OracleStatement.java:7243)
	at oracle.jdbc.driver.OraclePreparedStatement.getMetaData(OraclePreparedStatement.java:5718)
	at oracle.jdbc.driver.OraclePreparedStatementWrapper.getMetaData(OraclePreparedStatementWrapper.java:5291)
	at oracle.jdbc.driver.OracleParameterMetaData.getParameterMetaData(OracleParameterMetaData.java:76)
	at oracle.jdbc.driver.OraclePreparedStatement.getParameterMetaData(OraclePreparedStatement.java:18509)
	at oracle.jdbc.driver.OraclePreparedStatementWrapper.getParameterMetaData(OraclePreparedStatementWrapper.java:5449)
	at org.apache.commons.dbutils.AbstractQueryRunner.fillStatement(AbstractQueryRunner.java:222)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As a change I have wrapped call to &lt;tt&gt;ParameterMetaData.getParameterCount()&lt;/tt&gt; in a try-catch-block and set &lt;tt&gt;pmdKnownBroken&lt;/tt&gt; to &lt;tt&gt;true&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Please let me know if anythings needs to be changed.&lt;/p&gt;</comment>
                            <comment id="14063567" author="carabolic" created="Wed, 16 Jul 2014 14:51:40 +0000"  >&lt;p&gt;First patch&lt;/p&gt;

&lt;p&gt;Wraps the &lt;tt&gt;getParameterMetaData()&lt;/tt&gt; in try-catch-block and sets &lt;tt&gt;pmdKnownBroken&lt;/tt&gt; accordingly.&lt;/p&gt;</comment>
                            <comment id="14063754" author="britter" created="Wed, 16 Jul 2014 17:24:43 +0000"  >&lt;p&gt;The problem here is, that the SQLException from &lt;tt&gt;Statement.getParameterMetaData()&lt;/tt&gt; may be thrown for different reasons, for example if the Statement has already been closed. How do we make the distinction?&lt;/p&gt;</comment>
                            <comment id="14064741" author="carabolic" created="Thu, 17 Jul 2014 09:26:34 +0000"  >&lt;p&gt;Yes you&apos;re right. But it already does that at the near bottom of &lt;tt&gt;AbstractQueryRunner#fillStatement(PreparedStatement, Object...)&lt;/tt&gt; where it tries to get the parameter types.&lt;/p&gt;

&lt;p&gt;I don&apos;t really see a problem with the proposed approach. Even in the event of a &lt;tt&gt;SQLException&lt;/tt&gt; that is legit, i.e. not related to broken &lt;tt&gt;ParameterMetaData&lt;/tt&gt;, it will be re-thrown eventually. The real magic happens in the call to &lt;tt&gt;stmt.setObject(...)&lt;/tt&gt; and if there is something wrong with the connection this will cause a proper &lt;tt&gt;SQLException&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="14066177" author="britter" created="Fri, 18 Jul 2014 09:00:44 +0000"  >&lt;p&gt;Nice assement! We&apos;re currently releasing 1.6, so this won&apos;t make it into the release, but I have no problem with including this in 1.7 or 1.6.1. However, it would be nice if you could provide some junit tests for your patch.&lt;/p&gt;

&lt;p&gt;Best regards, and thanks for your interest in this component!&lt;br/&gt;
Benedikt&lt;/p&gt;</comment>
                            <comment id="14076153" author="carabolic" created="Mon, 28 Jul 2014 11:49:55 +0000"  >&lt;p&gt;Thanks for the nice words. Too bad it won&apos;t make it into 1.6, but I can live with SNAPSHOT.&lt;/p&gt;

&lt;p&gt;The problem with unit tests is, that the reported defect is highly driver dependent. Naturally I have a unit test, but I could only reproduce it with Oracle 12c, thus it needs a real connection. Is there already some way to mock a connection? Should I create a new &lt;tt&gt;AbstractQueryRunnerTest&lt;/tt&gt; class along with &lt;tt&gt;MockPreparedStatement&lt;/tt&gt; that produces an &lt;tt&gt;SQLException&lt;/tt&gt; on &lt;tt&gt;getParameterMetaData()&lt;/tt&gt;?&lt;/p&gt;

&lt;p&gt;I&apos;d be more than happy to provide everything that is needed to properly fix this issue but I might need some advice on how to proceed from here.&lt;/p&gt;</comment>
                            <comment id="14076190" author="carabolic" created="Mon, 28 Jul 2014 12:45:45 +0000"  >&lt;p&gt;Ok I figured it out. I was looking for &lt;tt&gt;AbstractQueryRunnerTest.java&lt;/tt&gt; when actually all test logic is in &lt;tt&gt;QueryRunnerTest.java&lt;/tt&gt;, my bad.&lt;/p&gt;

&lt;p&gt;I have now created two new junit test cases (see &lt;tt&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DBUTILS-117&quot; title=&quot;Error handling possible getParameterMetaData() results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBUTILS-117&quot;&gt;&lt;del&gt;DBUTILS-117&lt;/del&gt;&lt;/a&gt;-tests.java&lt;/tt&gt;). What do you think?&lt;/p&gt;</comment>
                            <comment id="14242849" author="terefang" created="Thu, 11 Dec 2014 17:56:10 +0000"  >&lt;p&gt;using the Crate.io jdbc driver i get:&lt;/p&gt;

&lt;p&gt;Exception in thread &quot;main&quot; java.lang.NullPointerException&lt;br/&gt;
	at org.apache.commons.dbutils.AbstractQueryRunner.fillStatement(AbstractQueryRunner.java:226)&lt;/p&gt;

&lt;p&gt;i would propose the followinf fix:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!pmdKnownBroken) {
            pmd = stmt.getParameterMetaData();
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(pmd!=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
             &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; stmtCount = pmd.getParameterCount();
             &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; paramsCount = params == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; ? 0 : params.length;
 
             &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (stmtCount != paramsCount) {
                 &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SQLException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Wrong number of parameters: expected &quot;&lt;/span&gt;
                         + stmtCount + &lt;span class=&quot;code-quote&quot;&gt;&quot;, was given &quot;&lt;/span&gt; + paramsCount);
             }
            }
            &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
                        pmdKnownBroken = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
            }
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14243822" author="britter" created="Fri, 12 Dec 2014 07:29:34 +0000"  >&lt;blockquote&gt;&lt;p&gt;using the Crate.io jdbc driver&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This looks more like a missing feature in the PreparedStatement implementation of crate.io (&lt;a href=&quot;https://github.com/crate/crate-jdbc/blob/master/src/main/java/io/crate/client/jdbc/CratePreparedStatement.java#L439&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/crate/crate-jdbc/blob/master/src/main/java/io/crate/client/jdbc/CratePreparedStatement.java#L439&lt;/a&gt;). I propose, that you report a feature request there. The JavaDoc of PreparedStatement doesn&apos;t state that it is legal for a PreparedStatement to return null from getParameterMetaData().&lt;/p&gt;</comment>
                            <comment id="14244015" author="sebb@apache.org" created="Fri, 12 Dec 2014 11:39:49 +0000"  >&lt;p&gt;However, nor does the Javadoc state that null is not allowed.&lt;/p&gt;

&lt;p&gt;It only says it throws:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;SQLException - if a database access error occurs or this method is called on a closed PreparedStatement&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;So what should the library do if it does not support the method?&lt;br/&gt;
It would be ambiguous to return a ParameterMetaData with a count of 0, because then one cannot distinguish it from a statement which has no parameters.&lt;/p&gt;

&lt;p&gt;Note that there is example code &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; which explicitly checks for null. I&apos;m sure there are others.&lt;/p&gt;

&lt;p&gt;Whether null is explicitly allowed or not, clearly it is considered a possibility, so I agree the code should check for it.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://www.java2s.com/Code/JavaAPI/java.sql/PreparedStatementgetParameterMetaData.htm&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.java2s.com/Code/JavaAPI/java.sql/PreparedStatementgetParameterMetaData.htm&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14244054" author="terefang" created="Fri, 12 Dec 2014 12:29:50 +0000"  >&lt;p&gt;thanks Sebb but also ...&lt;/p&gt;

&lt;p&gt;if getParameterMetaData() would throw an SQL-(Unsupported-)Exception the handling would also have to be fixed.&lt;/p&gt;

&lt;p&gt;the crate driver marks itself as jdbc-incomplient anyway in &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;, which prompts me to expect null pointers.&lt;/p&gt;

&lt;p&gt;also jdbc-spec-level 2.0/3.0/4.0 cannot be checked with ease so its either try/catch or check for null pointer.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/crate/crate-jdbc/blob/master/src/main/java/io/crate/client/jdbc/CrateDriver.java#L92&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/crate/crate-jdbc/blob/master/src/main/java/io/crate/client/jdbc/CrateDriver.java#L92&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14246061" author="britter" created="Sun, 14 Dec 2014 18:59:27 +0000"  >&lt;blockquote&gt;&lt;p&gt;So what should the library do if it does not support the method?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I would expect the driver to throw &lt;a href=&quot;https://docs.oracle.com/javase/7/docs/api/java/sql/SQLFeatureNotSupportedException.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;SQLFeatureNotSupportedException&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I&apos;m tempted to close this as won&apos;t fix. We simply can not checked for null on every place where an incomplete jdbc implementation my return null.&lt;/p&gt;</comment>
                            <comment id="14246549" author="sebb@apache.org" created="Mon, 15 Dec 2014 10:57:05 +0000"  >&lt;blockquote&gt;&lt;p&gt;I would expect the driver to throw SQLFeatureNotSupportedException.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is a subclass of SQLException.&lt;/p&gt;

&lt;p&gt;However the Javadoc for getParameterData() states:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;SQLException - if a database access error occurs or this method is called on a closed PreparedStatement&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Is an unsupported feature really a database access error?&lt;/p&gt;

&lt;p&gt;So the Javadoc for getParameterData() is inconclusive. It does not say what should happen if the method is not supported.&lt;/p&gt;

&lt;p&gt;Therefore I think Commons should take steps to support implementations if it can easily do so.&lt;br/&gt;
It already supports SQLFeatureNotSupportedException because it catches SQLException.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Though whether that is the correct thing to so is another matter, as there are other reasons for SQLException that are nothing to do with lack of support for getParameterData(), i.e. it may incorrectly assume it is not supported&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;It&apos;s clear from existing published code that returning null is an expected response, so I think DBUtils should support that.&lt;br/&gt;
It&apos;s a very simple change. What harm can it do?&lt;/p&gt;</comment>
                            <comment id="14246668" author="britter" created="Mon, 15 Dec 2014 14:21:36 +0000"  >&lt;p&gt;Sure we can add a safety need. I just don&apos;t want to get in a mode, where we implement work arounds for missing driver features. Sebb, do you want to take care of this then?&lt;/p&gt;</comment>
                            <comment id="14246777" author="sebb@apache.org" created="Mon, 15 Dec 2014 16:05:35 +0000"  >&lt;p&gt;I agree that working around random bugs in driver implementations is not sustainable. However in this case it seems to be common behaviour for drivers, and there is no indication that the behaviour is disallowed; nor is the fix difficult, nor does it have side effects. I will fix it.&lt;/p&gt;</comment>
                            <comment id="14246785" author="sebb@apache.org" created="Mon, 15 Dec 2014 16:13:50 +0000"  >&lt;p&gt;Fix the NPE issue:&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/r1645683&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1645683&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DBUTILS-117&quot; title=&quot;Error handling possible getParameterMetaData() results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBUTILS-117&quot;&gt;&lt;del&gt;DBUTILS-117&lt;/del&gt;&lt;/a&gt; Error handling possible getParameterMetaData() results&lt;/p&gt;

&lt;p&gt;Modified:&lt;br/&gt;
    commons/proper/dbutils/trunk/src/changes/changes.xml&lt;br/&gt;
    commons/proper/dbutils/trunk/src/main/java/org/apache/commons/dbutils/AbstractQueryRunner.java&lt;/p&gt;</comment>
                            <comment id="14246805" author="sebb@apache.org" created="Mon, 15 Dec 2014 16:29:39 +0000"  >&lt;p&gt;However, the original issue (as per the description) remains.&lt;/p&gt;

&lt;p&gt;The initial call to getParameterMetaData() needs to allow for catching at least SQLFeatureNotSupportedException, possibly other types of SQLE as well.&lt;br/&gt;
The example quoted in the description was SQLSyntaxErrorException (which seems a bit odd).&lt;/p&gt;

&lt;p&gt;Should the code catch every SQLEx ? Ideally not, as that might mask genuine errors.&lt;/p&gt;</comment>
                            <comment id="14246976" author="sebb@apache.org" created="Mon, 15 Dec 2014 18:34:53 +0000"  >&lt;p&gt;Looks like the SQLSyntaxErrorException is caused by an Oracle bug in ojdbc7 &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;I don&apos;t think we should allow for that; it&apos;s easy enough for the user to set pmdKnownbroken to true in such cases.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://stackoverflow.com/questions/22629438/sqlsyntaxerrorexception-when-using-like-with-ojdbc7-jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/22629438/sqlsyntaxerrorexception-when-using-like-with-ojdbc7-jar&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14246991" author="sebb@apache.org" created="Mon, 15 Dec 2014 18:39:51 +0000"  >&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/r1645716&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1645716&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DBUTILS-117&quot; title=&quot;Error handling possible getParameterMetaData() results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBUTILS-117&quot;&gt;&lt;del&gt;DBUTILS-117&lt;/del&gt;&lt;/a&gt; Error handling possible getParameterMetaData() results&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;handle SQLFeatureNotSupportedException&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Modified:&lt;br/&gt;
    commons/proper/dbutils/trunk/src/changes/changes.xml&lt;br/&gt;
    commons/proper/dbutils/trunk/src/main/java/org/apache/commons/dbutils/AbstractQueryRunner.java&lt;/p&gt;</comment>
                            <comment id="14499117" author="thecarlhall" created="Fri, 17 Apr 2015 01:48:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sebb%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;sebb@apache.org&quot;&gt;sebb@apache.org&lt;/a&gt;, do you feel like this issue is as resolved as it will get given the changes you&apos;ve made already?&lt;/p&gt;</comment>
                            <comment id="14563197" author="alexander kirsch" created="Thu, 28 May 2015 16:23:48 +0000"  >&lt;p&gt;Just for your interest. We faced a lot of Problems with the Oracle 12c JDBC driver which did not occur with the Oracle 11g JDBC Driver. &lt;/p&gt;

&lt;p&gt;PreparedStatement.getParameterMetaData();&lt;/p&gt;

&lt;p&gt;caused a lot of problems. Some of this problems fixed by Oracle with Patch 20692348 for Version 12.1.0.2. We still have Problems with java.sql.ParameterMetaData.getParameterCount() which do not always return the right number of parameters if the parameters are surrounded bei round parenthesis.&lt;/p&gt;</comment>
                            <comment id="14573848" author="sebb@apache.org" created="Thu, 4 Jun 2015 23:58:31 +0000"  >&lt;p&gt;Assuming fixed.&lt;/p&gt;</comment>
                            <comment id="15423081" author="robert.huffman@gmail.com" created="Tue, 16 Aug 2016 17:13:30 +0000"  >&lt;p&gt;There is a problem on Maven Central. I am running into this defect using commons-dbutils 1.6 from Maven Central.&lt;/p&gt;

&lt;p&gt;If you look on the GitHub mirror, the call to getParameterMetaData in AbstractQueryRunner.fillStatement is surrounded by a try/catch.&lt;/p&gt;

&lt;p&gt;However, if you look at the sources jar on Maven Central  the source does not match. There is no try/catch in fillStatement. See &lt;a href=&quot;http://repo1.maven.org/maven2/commons-dbutils/commons-dbutils/1.6/commons-dbutils-1.6-sources.jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://repo1.maven.org/maven2/commons-dbutils/commons-dbutils/1.6/commons-dbutils-1.6-sources.jar&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="15423510" author="garydgregory" created="Tue, 16 Aug 2016 22:26:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhuffman&quot; class=&quot;user-hover&quot; rel=&quot;rhuffman&quot;&gt;rhuffman&lt;/a&gt;:&lt;/p&gt;

&lt;p&gt;In version 1.6, there is no try-catch around &lt;tt&gt;getParameterMetaData()&lt;/tt&gt;, please see  &lt;a href=&quot;https://svn.apache.org/repos/asf/commons/proper/dbutils/tags/DBUTILS_1_6/src/main/java/org/apache/commons/dbutils/AbstractQueryRunner.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/repos/asf/commons/proper/dbutils/tags/DBUTILS_1_6/src/main/java/org/apache/commons/dbutils/AbstractQueryRunner.java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Gary&lt;/p&gt;</comment>
                            <comment id="15423869" author="robert.huffman@gmail.com" created="Wed, 17 Aug 2016 04:40:40 +0000"  >&lt;p&gt;Yeah, I finally put that together after I posted. I was confused by the&lt;br/&gt;
branching (or lack thereof) on the GitHub mirror. I made the bad assumption&lt;br/&gt;
that the branch &apos;trunk&apos; is the last &apos;released&apos; version.&lt;/p&gt;



&lt;p&gt;On Tue, Aug 16, 2016 at 3:27 PM, Gary Gregory (JIRA) &amp;lt;jira@apache.org&amp;gt;&lt;/p&gt;
</comment>
                            <comment id="15692949" author="fabrice.dutron@gmail.com" created="Thu, 24 Nov 2016 10:48:02 +0000"  >&lt;p&gt;I have the same type of problem with getParameterMetaData method on oracle7.jar release 12.1.0.2 and DbUtil release 1.6.&lt;/p&gt;

&lt;p&gt;I have a table with a &quot;f&quot; inside and Oracle does not like this and my dba does not want to change the table name...&lt;/p&gt;

&lt;p&gt;There is an Oracle bug open for this bug (number 19583576) but it should only be corrected in the 12.2 release. Indeed if I do this : &lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java -classpath ./ojdbc7-12.1.0.2.jar oracle.jdbc.driver.OracleParameterMetaDataParser &quot;SELECT   PRU_PER_ID , PRU_PRF_ID  FROM sys_profil_users where pru_tts_created_by = :param0_String and pru_tts_updated_by = :param1_String&quot;
SQL:SELECT   PRU_PER_ID , PRU_PRF_ID  FROM sys_profil_users where pru_tts_created_by = :param0_String and pru_tts_updated_by = :param1_String
  SqlKind:SELECT, Parameter Count=2
  Parameter SQL: SELECT pru_tts_updated_by FROM sys_prof
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We can see that the table name is limited to &quot;sys_prof&quot; !&lt;/p&gt;

&lt;p&gt;When I use DbUtil, this generate me a &quot;ORA-00942: table or view does not exist&quot; error when calling the getParameterMetaData method.&lt;/p&gt;

&lt;p&gt;When I check the code of my 1.6 release of DbUtil I do not have the try catch. I use the pom :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;scm&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;connection&amp;gt;&lt;/span&gt;scm:svn:http://svn.apache.org/repos/asf/commons/proper/dbutils/tags/DBUTILS_1_6&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/connection&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;developerConnection&amp;gt;&lt;/span&gt;scm:svn:https://svn.apache.org/repos/asf/commons/proper/dbutils/tags/DBUTILS_1_6&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/developerConnection&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;url&amp;gt;&lt;/span&gt;http://svn.apache.org/viewvc/commons/proper/dbutils/tags/DBUTILS_1_6&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/url&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/scm&amp;gt;&lt;/span&gt;
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If I look into the magnifest of the jar file :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Manifest-Version: 1.0
Export-Package: org.apache.commons.dbutils;version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.6&quot;&lt;/span&gt;,org.apache.co
 mmons.dbutils.handlers;version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.6&quot;&lt;/span&gt;,org.apache.commons.dbutils.wrapp
 ers;version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.6&quot;&lt;/span&gt;
Implementation-Title: Apache Commons DbUtils
Built-By: britter
Tool: Bnd-2.1.0.20130426-122213
Implementation-Vendor: The Apache Software Foundation
Implementation-Vendor-Id: org.apache
Specification-Title: Apache Commons DbUtils
Bundle-License: http:&lt;span class=&quot;code-comment&quot;&gt;//www.apache.org/licenses/LICENSE-2.0.txt
&lt;/span&gt;Bundle-SymbolicName: org.apache.commons.dbutils
X-Compile-Target-JDK: 1.6
Implementation-Version: 1.6
Specification-Vendor: The Apache Software Foundation
Bundle-Name: Apache Commons DbUtils
Created-By: Apache Maven Bundle Plugin
X-Compile-Source-JDK: 1.6
Bundle-Vendor: The Apache Software Foundation
Build-Jdk: 1.7.0_60
Bundle-Version: 1.6.0
Bnd-LastModified: 1405538584171
Bundle-ManifestVersion: 2
Bundle-Description: The Apache Commons DbUtils &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; is a set of  Ja
 va utility classes &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; easing JDBC development.
Bundle-DocURL: http:&lt;span class=&quot;code-comment&quot;&gt;//commons.apache.org/proper/commons-dbutils/
&lt;/span&gt;Import-Package: javax.sql
Include-Resource: META-INF/LICENSE.txt=LICENSE.txt,META-INF/NOTICE.txt
 =NOTICE.txt
Specification-Version: 1.6
Implementation-Build: UNKNOWN_BRANCH@r??????; 2014-07-16 19:23:00+0000
Archiver-Version: Plexus Archiver
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So, my first question : what should I do in order to have the version with the try catch ?&lt;/p&gt;

&lt;p&gt;&amp;#8212; &lt;/p&gt;

&lt;p&gt;Maybe the junit tests of dbUtil are made on a list of database drivers. I mean, some tests against the oracle7 12.1.0.2 driver should says &quot;Do not go&quot; &lt;/p&gt;

&lt;p&gt;So my secound question : are there somewhere tests like this ? Or do you mock the driver implementation ?&lt;/p&gt;

&lt;p&gt;&amp;#8212;&lt;br/&gt;
I saw that there is two others releases in the pipe, 1.7 and 2.0 and I saw nowhere else some db framework block by these oracle driver metadata problems. &lt;/p&gt;

&lt;p&gt;Last question : Do you plan to publish them in the near future and does these releases are still dependant of the metadata provided by the driver ?&lt;/p&gt;

&lt;p&gt;Sorry to have been so long, regards&lt;br/&gt;
Fabrice&lt;/p&gt;
</comment>
                            <comment id="15693773" author="fabrice.dutron@gmail.com" created="Thu, 24 Nov 2016 17:02:57 +0000"  >&lt;p&gt;I answer to myself :&lt;br/&gt;
&lt;b&gt;Question 1&lt;/b&gt; : I find the try catch in the master but this catch only an exception of type SQLFeatureNotSupportedException which is an answer to drivers well done but not bugged like Oracle one.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Question 3&lt;/b&gt; :&lt;br/&gt;
In fact I did not see that the user could specify the pmdKnownBroken parameter in the constructor of the AbstractQuerryRunner. With this parameter enabled, I think that we are working in the mode where we are not dependent with the metadata provider. Until now, all is working but it seems to be less secure with this parameter not enabled. The code impacted is the following :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; &lt;span class=&quot;code-comment&quot;&gt;// VARCHAR works with many drivers regardless
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// of the actual column type. Oddly, NULL and
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// OTHER don&lt;span class=&quot;code-quote&quot;&gt;&apos;t work with Oracle&apos;&lt;/span&gt;s drivers.
&lt;/span&gt;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; sqlType = Types.VARCHAR;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!pmdKnownBroken) {
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
        sqlType = pmd.getParameterType(i + 1);
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (SQLException e) {
        pmdKnownBroken = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
    }
}
stmt.setNull(i + 1, sqlType);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;&lt;p&gt;//VARCHAR works with many drivers regardless of the actual column type. Oddly, NULL and OTHER don&apos;t work with Oracle&apos;s drivers.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Not sur to well understand what&apos;s this mean...&lt;/p&gt;</comment>
                            <comment id="16343676" author="mightydash" created="Mon, 29 Jan 2018 17:29:36 +0000"  >&lt;p&gt;Following code also triggers the error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; QueryRunner().update(tenantDB, &lt;span class=&quot;code-quote&quot;&gt;&quot;execute as user = &lt;span class=&quot;code-quote&quot;&gt;&apos;MY_USER&apos;&lt;/span&gt;&quot;&lt;/span&gt;);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;Driver:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;&amp;lt;dependency&amp;gt;
     &amp;lt;groupId&amp;gt;com.microsoft.sqlserver&amp;lt;/groupId&amp;gt;
     &amp;lt;artifactId&amp;gt;mssql-jdbc&amp;lt;/artifactId&amp;gt;
     &amp;lt;version&amp;gt;6.2.2.jre8&amp;lt;/version&amp;gt;
 &amp;lt;/dependency&amp;gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Exception thrown:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
com.microsoft.sqlserver.jdbc.SQLServerException: Incorrect syntax near the keyword &lt;span class=&quot;code-quote&quot;&gt;&apos;as&apos;&lt;/span&gt;.
SQLState = S0001
vendorCode = 156&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt; Work around:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; QueryRunner(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;).update(tenantDB, &lt;span class=&quot;code-quote&quot;&gt;&quot;execute as user = &lt;span class=&quot;code-quote&quot;&gt;&apos;MY_USER&apos;&lt;/span&gt;&quot;&lt;/span&gt;);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12758808">DBUTILS-122</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12658126" name="DBUTILS-117-tests.patch" size="1242" author="carabolic" created="Mon, 28 Jul 2014 12:46:28 +0000"/>
                            <attachment id="12656044" name="DBUTILS-117.patch" size="923" author="carabolic" created="Wed, 16 Jul 2014 14:51:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>361632</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 41 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1qc6v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>361930</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>