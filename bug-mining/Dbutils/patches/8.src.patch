diff --git a/src/java/org/apache/commons/dbutils/BeanProcessor.java b/src/java/org/apache/commons/dbutils/BeanProcessor.java
index bb54d97..f5768b0 100644
--- a/src/java/org/apache/commons/dbutils/BeanProcessor.java
+++ b/src/java/org/apache/commons/dbutils/BeanProcessor.java
@@ -390,7 +390,10 @@ public class BeanProcessor {
         Arrays.fill(columnToProperty, PROPERTY_NOT_FOUND);
 
         for (int col = 1; col <= cols; col++) {
-            String columnName = rsmd.getColumnName(col);
+            String columnName = rsmd.getColumnLabel(col);
+            if (null == columnName || 0 == columnName.length()) {
+              columnName = rsmd.getColumnName(col);
+            }
             for (int i = 0; i < props.length; i++) {
 
                 if (columnName.equalsIgnoreCase(props[i].getName())) {
diff --git a/src/test/org/apache/commons/dbutils/BeanProcessorTest.java b/src/test/org/apache/commons/dbutils/BeanProcessorTest.java
index 6944a85..eae146b 100644
--- a/src/test/org/apache/commons/dbutils/BeanProcessorTest.java
+++ b/src/test/org/apache/commons/dbutils/BeanProcessorTest.java
@@ -16,6 +16,9 @@
  */
 package org.apache.commons.dbutils;
 
+import java.beans.Introspector;
+import java.beans.PropertyDescriptor;
+import java.sql.ResultSetMetaData;
 import java.sql.SQLException;
 
 public class BeanProcessorTest extends BaseTestCase {
@@ -25,14 +28,58 @@ public class BeanProcessorTest extends BaseTestCase {
     public void testProcess() throws SQLException {
         TestBean b = null;
         assertTrue(this.rs.next());
-        b = (TestBean) beanProc.toBean(this.rs, TestBean.class);
+        b = beanProc.toBean(this.rs, TestBean.class);
         assertEquals(13.0, b.getColumnProcessorDoubleTest(), 0);
-        
+
         assertTrue(this.rs.next());
-        b = (TestBean) beanProc.toBean(this.rs, TestBean.class);
+        b = beanProc.toBean(this.rs, TestBean.class);
         assertEquals(13.0, b.getColumnProcessorDoubleTest(), 0);
 
         assertFalse(this.rs.next());
     }
 
+    public static class MapColumnToPropertiesBean {
+        private String one;
+
+        private String two;
+
+        private String three;
+
+        public String getOne() {
+            return one;
+        }
+
+        public void setOne(String one) {
+            this.one = one;
+        }
+
+        public String getTwo() {
+            return two;
+        }
+
+        public void setTwo(String two) {
+            this.two = two;
+        }
+
+        public String getThree() {
+            return three;
+        }
+
+        public void setThree(String three) {
+            this.three = three;
+        }
+    }
+
+    public void testMapColumnToProperties() throws Exception {
+        String[] columnNames = { "test", "test", "three" };
+        String[] columnLabels = { "one", "two", null };
+        ResultSetMetaData rsmd = ProxyFactory.instance().createResultSetMetaData(
+                new MockResultSetMetaData(columnNames, columnLabels));
+        PropertyDescriptor[] props = Introspector.getBeanInfo(MapColumnToPropertiesBean.class).getPropertyDescriptors();
+
+        int[] columns = beanProc.mapColumnsToProperties(rsmd, props);
+        for (int i = 1; i < columns.length; i++) {
+            assertTrue(columns[i] != BeanProcessor.PROPERTY_NOT_FOUND);
+        }
+    }
 }
diff --git a/src/test/org/apache/commons/dbutils/MockResultSetMetaData.java b/src/test/org/apache/commons/dbutils/MockResultSetMetaData.java
index 8edb821..b152bb8 100644
--- a/src/test/org/apache/commons/dbutils/MockResultSetMetaData.java
+++ b/src/test/org/apache/commons/dbutils/MockResultSetMetaData.java
@@ -27,6 +27,7 @@ import java.sql.ResultSetMetaData;
 public class MockResultSetMetaData implements InvocationHandler {
 
     private String[] columnNames = null;
+    private String[] columnLabels = null;
 
     /**
      * Create a <code>MockResultSetMetaData</code> proxy object.  This is 
@@ -46,6 +47,14 @@ public class MockResultSetMetaData implements InvocationHandler {
     public MockResultSetMetaData(String[] columnNames) {
         super();
         this.columnNames = columnNames;
+        this.columnLabels = new String[columnNames.length];
+
+    }
+    
+    public MockResultSetMetaData(String[] columnNames, String[] columnLabels) {
+        super();
+        this.columnNames = columnNames;
+        this.columnLabels = columnLabels;
 
     }
 
@@ -58,11 +67,16 @@ public class MockResultSetMetaData implements InvocationHandler {
             return new Integer(this.columnNames.length);
 
         } else if (
-            methodName.equals("getColumnName")
-                || methodName.equals("getColumnLabel")) {
+                methodName.equals("getColumnName")) {
+
+                int col = ((Integer) args[0]).intValue() - 1;
+                return this.columnNames[col];
+
+        } else if (
+        		methodName.equals("getColumnLabel")) {
 
-            int col = ((Integer) args[0]).intValue() - 1;
-            return this.columnNames[col];
+                int col = ((Integer) args[0]).intValue() - 1;
+                return this.columnLabels[col];
 
         } else if (methodName.equals("hashCode")) {
             return new Integer(System.identityHashCode(proxy));
