diff --git a/protobuf/src/main/java/com/fasterxml/jackson/dataformat/protobuf/ProtobufParser.java b/protobuf/src/main/java/com/fasterxml/jackson/dataformat/protobuf/ProtobufParser.java
index ec7a329a..f1caaa3b 100644
--- a/protobuf/src/main/java/com/fasterxml/jackson/dataformat/protobuf/ProtobufParser.java
+++ b/protobuf/src/main/java/com/fasterxml/jackson/dataformat/protobuf/ProtobufParser.java
@@ -2382,8 +2382,8 @@ public class ProtobufParser extends ParserMinimalBase
             return _slow32();
         }
         final byte[] b = _inputBuffer;
-        int v = (b[ptr] & 0xFF) + ((b[ptr+1]) << 8)
-                + ((b[ptr+2] & 0xFF) << 16) + (b[ptr+3] << 24);
+        int v = (b[ptr] & 0xFF) + ((b[ptr+1] & 0xFF) << 8)
+                + ((b[ptr+2] & 0xFF) << 16) + ((b[ptr+3] & 0xFF) << 24);
         _inputPtr = ptr+4;
         return v;
     }
diff --git a/protobuf/src/test/java/com/fasterxml/jackson/dataformat/protobuf/ProtobufTestBase.java b/protobuf/src/test/java/com/fasterxml/jackson/dataformat/protobuf/ProtobufTestBase.java
index deab00bb..6589970b 100644
--- a/protobuf/src/test/java/com/fasterxml/jackson/dataformat/protobuf/ProtobufTestBase.java
+++ b/protobuf/src/test/java/com/fasterxml/jackson/dataformat/protobuf/ProtobufTestBase.java
@@ -485,9 +485,9 @@ public abstract class ProtobufTestBase extends TestCase
         }
     }
 
-    protected void assertToken(JsonToken expToken, JsonParser jp)
+    protected void assertToken(JsonToken expToken, JsonParser p)
     {
-        assertToken(expToken, jp.getCurrentToken());
+        assertToken(expToken, p.getCurrentToken());
     }
 
     protected void assertType(Object ob, Class<?> expType)
diff --git a/protobuf/src/test/java/com/fasterxml/jackson/dataformat/protobuf/WritePrimitiveArrayTest.java b/protobuf/src/test/java/com/fasterxml/jackson/dataformat/protobuf/WritePrimitiveArrayTest.java
index 795656cf..62d35d43 100644
--- a/protobuf/src/test/java/com/fasterxml/jackson/dataformat/protobuf/WritePrimitiveArrayTest.java
+++ b/protobuf/src/test/java/com/fasterxml/jackson/dataformat/protobuf/WritePrimitiveArrayTest.java
@@ -48,6 +48,16 @@ public class WritePrimitiveArrayTest extends ProtobufTestBase
             +" repeated double values = 1 [packed=true];\n"
             +"}\n"
     ;
+
+    final protected static String PROTOC_FLOAT_ARRAY_SPARSE = "message Floats {\n"
+            +" repeated float values = 1;\n"
+            +"}\n"
+    ;
+
+    final protected static String PROTOC_FLOAT_ARRAY_PACKED = "message Floats {\n"
+            +" repeated float values = 1 [packed=true];\n"
+            +"}\n"
+    ;
     
     static class IntArray {
         public int[] values;
@@ -75,8 +85,17 @@ public class WritePrimitiveArrayTest extends ProtobufTestBase
             values = v;
         }
     }
-    
-    final ObjectMapper MAPPER = new ObjectMapper(new ProtobufFactory());
+
+    static class FloatArray {
+        public float[] values;
+
+        protected FloatArray() { }
+        public FloatArray(float... v) {
+            values = v;
+        }
+    }
+
+    final ObjectMapper MAPPER = new ProtobufMapper();
 
     public WritePrimitiveArrayTest() throws Exception { }
 
@@ -205,9 +224,9 @@ public class WritePrimitiveArrayTest extends ProtobufTestBase
     {
         ProtobufSchema schema = ProtobufSchemaLoader.std.parse(PROTOC_DOUBLE_ARRAY_SPARSE);
         final ObjectWriter w = MAPPER.writer(schema);
-        DoubleArray input = new DoubleArray(0.25, -2.5, 1000.125);
+        DoubleArray input = new DoubleArray(0.25, -2.5, 1000.125, 1234567891234567890.5);
         byte[] bytes = w.writeValueAsBytes(input);
-        assertEquals(27, bytes.length);
+        assertEquals(36, bytes.length);
 
         DoubleArray result = MAPPER.readerFor(DoubleArray.class).with(schema)
                 .readValue(bytes);
@@ -218,9 +237,9 @@ public class WritePrimitiveArrayTest extends ProtobufTestBase
     {
         ProtobufSchema schema = ProtobufSchemaLoader.std.parse(PROTOC_DOUBLE_ARRAY_PACKED);
         final ObjectWriter w = MAPPER.writer(schema);
-        DoubleArray input = new DoubleArray(-0.5, 89245.25, 0.625);
+        DoubleArray input = new DoubleArray(-0.5, 89245.25, 0.625, 1234567891234567890.5);
         byte[] bytes = w.writeValueAsBytes(input);
-        assertEquals(26, bytes.length);
+        assertEquals(34, bytes.length);
 
         DoubleArray result = MAPPER.readerFor(DoubleArray.class).with(schema)
                 .readValue(bytes);
@@ -237,4 +256,48 @@ public class WritePrimitiveArrayTest extends ProtobufTestBase
             }
         }
     }
+
+    /*
+    /**********************************************************
+    /* Test methods, floating-point arrays
+    /**********************************************************
+     */
+
+    public void testfloatArraySparse() throws Exception
+    {
+        ProtobufSchema schema = ProtobufSchemaLoader.std.parse(PROTOC_FLOAT_ARRAY_SPARSE);
+        final ObjectWriter w = MAPPER.writer(schema);
+        FloatArray input = new FloatArray(0.25f, -2.5f, 55555555.5f);
+        byte[] bytes = w.writeValueAsBytes(input);
+        assertEquals(15, bytes.length);
+
+        FloatArray result = MAPPER.readerFor(FloatArray.class).with(schema)
+                .readValue(bytes);
+        _assertEquals(input.values, result.values);
+    }
+
+    public void testfloatArrayPacked() throws Exception
+    {
+        ProtobufSchema schema = ProtobufSchemaLoader.std.parse(PROTOC_FLOAT_ARRAY_PACKED);
+        final ObjectWriter w = MAPPER.writer(schema);
+        FloatArray input = new FloatArray(-0.5f, 89245.25f, 55555555.5f);
+        byte[] bytes = w.writeValueAsBytes(input);
+        assertEquals(14, bytes.length);
+
+        FloatArray result = MAPPER.readerFor(FloatArray.class).with(schema)
+                .readValue(bytes);
+        _assertEquals(input.values, result.values);
+    }
+
+    private void _assertEquals(float[] exp, float[] act)
+    {
+        assertEquals(exp.length, act.length);
+        for (int i = 0; i < exp.length; ++i) {
+            // note: caller ensures it only uses values that reliably round-trip
+            if (exp[i] != act[i]) {
+                fail("Entry #"+i+" wrong: expected "+exp[i]+", got "+act[i]);
+            }
+        }
+    }
+
 }
