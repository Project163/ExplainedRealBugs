diff --git a/protobuf/src/main/java/com/fasterxml/jackson/dataformat/protobuf/schema/ProtobufField.java b/protobuf/src/main/java/com/fasterxml/jackson/dataformat/protobuf/schema/ProtobufField.java
index e3690e34..310b6fe3 100644
--- a/protobuf/src/main/java/com/fasterxml/jackson/dataformat/protobuf/schema/ProtobufField.java
+++ b/protobuf/src/main/java/com/fasterxml/jackson/dataformat/protobuf/schema/ProtobufField.java
@@ -94,7 +94,6 @@ public class ProtobufField
             name = "UNKNOWN";
         } else {
             id = nativeField.tag();
-            typedTag = (id << 3) + wireType;
             name = nativeField.name();
             switch (nativeField.label()) {
             case REPEATED:
@@ -115,6 +114,14 @@ public class ProtobufField
              */
             packed = _findBooleanOption(nativeField, "packed");
             deprecated = _findBooleanOption(nativeField, "deprecated");
+
+            // 13-Apr-2017, tatu: [databind#79] Need to write length-prefixed for packed arrays
+            if (repeated && packed) {
+                typedTag = (id << 3) + WireType.LENGTH_PREFIXED;
+            } else {
+                typedTag = (id << 3) + wireType;
+            }
+        
         }
         isObject = (type == FieldType.MESSAGE);
     }
@@ -191,9 +198,9 @@ public class ProtobufField
     }
 
     public final boolean isValidFor(int typeTag) {
-        return (typeTag == type.getWireType()
+        return (typeTag == wireType)
                 // 13-Apr-2017, tatu: to fix [dataformats-binary#76]
-                || packed && repeated && typeTag == WireType.LENGTH_PREFIXED);
+                || (packed && repeated && typeTag == WireType.LENGTH_PREFIXED);
     }
 
     @Override
diff --git a/protobuf/src/test/java/com/fasterxml/jackson/dataformat/protobuf/WritePrimitiveArrayTest.java b/protobuf/src/test/java/com/fasterxml/jackson/dataformat/protobuf/WritePrimitiveArrayTest.java
index 795656cf..c3b6eb1c 100644
--- a/protobuf/src/test/java/com/fasterxml/jackson/dataformat/protobuf/WritePrimitiveArrayTest.java
+++ b/protobuf/src/test/java/com/fasterxml/jackson/dataformat/protobuf/WritePrimitiveArrayTest.java
@@ -106,7 +106,7 @@ public class WritePrimitiveArrayTest extends ProtobufTestBase
         byte[] bytes = w.writeValueAsBytes(new IntArray(3, -1, 2));
         // 1 byte for typed tag, 1 byte for length, 3 x 1 byte per value -> 5
         assertEquals(5, bytes.length);
-        assertEquals(0x8, bytes[0]); // zig-zagged vint (0) value, field 1
+        assertEquals(0x0A, bytes[0]); // packed (2) value, field 1
         assertEquals(0x3, bytes[1]); // length for array, 3 bytes
         assertEquals(0x6, bytes[2]); // zig-zagged value for 3
         assertEquals(0x1, bytes[3]); // zig-zagged value for -1
