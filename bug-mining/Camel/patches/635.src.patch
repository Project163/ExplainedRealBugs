diff --git a/camel-core/src/main/java/org/apache/camel/component/file/FileConsumer.java b/camel-core/src/main/java/org/apache/camel/component/file/FileConsumer.java
index fda9568baab..288aba7bdef 100644
--- a/camel-core/src/main/java/org/apache/camel/component/file/FileConsumer.java
+++ b/camel-core/src/main/java/org/apache/camel/component/file/FileConsumer.java
@@ -64,8 +64,10 @@ public class FileConsumer extends GenericFileConsumer<File> {
                 }
             } else if (file.isFile()) {
                 if (isValidFile(gf, false)) {
-                    if (isInProgress(file, files)) {
-                        log.trace("Skipping as file is already in progress: " + file);
+                    if (isInProgress(gf)) {
+                        if (log.isTraceEnabled()) {
+                            log.trace("Skipping as file is already in progress: " + gf.getFileName());
+                        }
                     } else {
                         // matched file so add
                         fileList.add(gf);
@@ -77,27 +79,6 @@ public class FileConsumer extends GenericFileConsumer<File> {
         }
     }
 
-    /**
-     * Is the given file already in progress.
-     *
-     * @param target  the target file
-     * @param files   the list of files found in the current directory
-     * @return <tt>true</tt> if the file is already in progress
-     */
-    protected boolean isInProgress(File target, File[] files) {
-        for (File file : files) {
-            String name = file.getName();
-            if (name.endsWith(FileComponent.DEFAULT_LOCK_FILE_POSTFIX)) {
-                String before = ObjectHelper.before(name, FileComponent.DEFAULT_LOCK_FILE_POSTFIX);
-                if (target.getName().equals(before)) {
-                    return true;
-                }
-            }
-        }
-
-        return false;
-    }
-
     /**
      * Creates a new GenericFile<File> based on the given file.
      *
diff --git a/camel-core/src/main/java/org/apache/camel/component/file/GenericFileConsumer.java b/camel-core/src/main/java/org/apache/camel/component/file/GenericFileConsumer.java
index 0ec65190713..c16f576dd6e 100644
--- a/camel-core/src/main/java/org/apache/camel/component/file/GenericFileConsumer.java
+++ b/camel-core/src/main/java/org/apache/camel/component/file/GenericFileConsumer.java
@@ -121,6 +121,13 @@ public abstract class GenericFileConsumer<T> extends ScheduledPollConsumer imple
             // process the current exchange
             processExchange(exchange);
         }
+
+        // remove the file from the in progress list in case the batch was limited by max messages per poll
+        for (int index = 0; index < exchanges.size() && isRunAllowed(); index++) {
+            GenericFileExchange<T> exchange = (GenericFileExchange<T>) exchanges.poll();
+            String key = exchange.getGenericFile().getFileName();
+            endpoint.getInProgressRepository().remove(key);
+        }
     }
 
     /**
@@ -231,7 +238,7 @@ public abstract class GenericFileConsumer<T> extends ScheduledPollConsumer imple
      * </ul>
      * And then <tt>true</tt> for directories.
      *
-     * @param file        the remote file
+     * @param file        the file
      * @param isDirectory wether the file is a directory or a file
      * @return <tt>true</tt> if the remote file is matched, <tt>false</tt> if not
      */
@@ -284,6 +291,17 @@ public abstract class GenericFileConsumer<T> extends ScheduledPollConsumer imple
         return true;
     }
 
+    /**
+     * Is the given file already in progress.
+     *
+     * @param file the file
+     * @return <tt>true</tt> if the file is already in progress
+     */
+    protected boolean isInProgress(GenericFile<T> file) {
+        String key = file.getFileName();
+        return !endpoint.getInProgressRepository().add(key);
+    }
+
     private void evaluteFileExpression() {
         if (fileExpressionResult == null) {
             // create a dummy exchange as Exchange is needed for expression evaluation
@@ -292,5 +310,4 @@ public abstract class GenericFileConsumer<T> extends ScheduledPollConsumer imple
         }
     }
 
-
 }
diff --git a/camel-core/src/main/java/org/apache/camel/component/file/GenericFileEndpoint.java b/camel-core/src/main/java/org/apache/camel/component/file/GenericFileEndpoint.java
index fd6b7185f25..74a03ba0196 100644
--- a/camel-core/src/main/java/org/apache/camel/component/file/GenericFileEndpoint.java
+++ b/camel-core/src/main/java/org/apache/camel/component/file/GenericFileEndpoint.java
@@ -30,6 +30,7 @@ import org.apache.camel.Expression;
 import org.apache.camel.Message;
 import org.apache.camel.Processor;
 import org.apache.camel.impl.ScheduledPollEndpoint;
+import org.apache.camel.processor.idempotent.MemoryIdempotentRepository;
 import org.apache.camel.spi.FactoryFinder;
 import org.apache.camel.spi.IdempotentRepository;
 import org.apache.camel.spi.Language;
@@ -52,6 +53,7 @@ public abstract class GenericFileEndpoint<T> extends ScheduledPollEndpoint {
     protected GenericFileProcessStrategy<T> processStrategy;
     protected GenericFileConfiguration configuration;
 
+    protected IdempotentRepository<String> inProgressRepository = new MemoryIdempotentRepository();
     protected String localWorkDirectory;
     protected boolean autoCreate = true;
     protected int bufferSize = 128 * 1024;
@@ -393,6 +395,14 @@ public abstract class GenericFileEndpoint<T> extends ScheduledPollEndpoint {
         this.maxMessagesPerPoll = maxMessagesPerPoll;
     }
 
+    public IdempotentRepository<String> getInProgressRepository() {
+        return inProgressRepository;
+    }
+
+    public void setInProgressRepository(IdempotentRepository<String> inProgressRepository) {
+        this.inProgressRepository = inProgressRepository;
+    }
+
     /**
      * Configures the given message with the file which sets the body to the
      * file object.
diff --git a/camel-core/src/main/java/org/apache/camel/component/file/GenericFileOnCompletion.java b/camel-core/src/main/java/org/apache/camel/component/file/GenericFileOnCompletion.java
index 1c1769b9922..323d20ff6f7 100644
--- a/camel-core/src/main/java/org/apache/camel/component/file/GenericFileOnCompletion.java
+++ b/camel-core/src/main/java/org/apache/camel/component/file/GenericFileOnCompletion.java
@@ -92,8 +92,10 @@ public class GenericFileOnCompletion<T> implements Synchronization {
             if (!committed) {
                 processStrategyRollback(processStrategy, exchange, file);
             }
-        }
 
+            // remove file from the in progress list as its no longer in progress
+            endpoint.getInProgressRepository().remove(file.getFileName());
+        }
     }
 
     /**
diff --git a/camel-core/src/test/java/org/apache/camel/component/file/stress/FileAsyncStressTest.java b/camel-core/src/test/java/org/apache/camel/component/file/stress/FileAsyncStressTest.java
new file mode 100644
index 00000000000..41a41e82675
--- /dev/null
+++ b/camel-core/src/test/java/org/apache/camel/component/file/stress/FileAsyncStressTest.java
@@ -0,0 +1,72 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.camel.component.file.stress;
+
+import java.util.Random;
+
+import org.apache.camel.ContextTestSupport;
+import org.apache.camel.Exchange;
+import org.apache.camel.Processor;
+import org.apache.camel.builder.RouteBuilder;
+import org.apache.camel.component.mock.MockEndpoint;
+
+/**
+ * @version $Revision$
+ */
+public class FileAsyncStressTest extends ContextTestSupport {
+
+    private int files = 150;
+
+    @Override
+    protected void setUp() throws Exception {
+        super.setUp();
+        deleteDirectory("target/filestress");
+        for (int i = 0; i < files; i++) {
+            template.sendBodyAndHeader("file:target/filestress", "Hello World", Exchange.FILE_NAME, i + ".txt");
+        }
+    }
+
+    public void testAsyncStress() throws Exception {
+        MockEndpoint mock = getMockEndpoint("mock:result");
+        mock.expectedMinimumMessageCount(100);
+
+        assertMockEndpointsSatisfied();
+    }
+
+    @Override
+    protected RouteBuilder createRouteBuilder() throws Exception {
+        return new RouteBuilder() {
+            @Override
+            public void configure() throws Exception {
+                // leverage the fact that we can limit to max 25 files per poll
+                // this will result in polling again and potentially picking up files
+                // that already are in progress
+                from("file:target/filestress?maxMessagesPerPoll=50")
+                    .threads(10)
+                    .process(new Processor() {
+                        public void process(Exchange exchange) throws Exception {
+                            // simulate some work with random time to complete
+                            Random ran = new Random();
+                            int delay = ran.nextInt(500) + 10;
+                            Thread.sleep(delay);
+                        }
+                    }).to("mock:result");
+            }
+        };
+    }
+
+}
\ No newline at end of file
