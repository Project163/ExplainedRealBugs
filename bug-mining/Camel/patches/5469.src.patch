diff --git a/tooling/openapi-rest-dsl-generator/src/main/java/org/apache/camel/generator/openapi/OperationVisitor.java b/tooling/openapi-rest-dsl-generator/src/main/java/org/apache/camel/generator/openapi/OperationVisitor.java
index 31b3bcda7cc..c8fc1e74381 100644
--- a/tooling/openapi-rest-dsl-generator/src/main/java/org/apache/camel/generator/openapi/OperationVisitor.java
+++ b/tooling/openapi-rest-dsl-generator/src/main/java/org/apache/camel/generator/openapi/OperationVisitor.java
@@ -17,9 +17,12 @@
 package org.apache.camel.generator.openapi;
 
 import java.util.ArrayList;
+import java.util.Collection;
 import java.util.Collections;
+import java.util.LinkedHashSet;
 import java.util.List;
 import java.util.Map.Entry;
+import java.util.Set;
 
 import io.apicurio.datamodels.core.util.ReferenceUtil;
 import io.apicurio.datamodels.openapi.models.OasOperation;
@@ -147,7 +150,7 @@ class OperationVisitor<T> {
         return emitter;
     }
 
-    CodeEmitter<T> emit(final String method, final List<String> values) {
+    CodeEmitter<T> emit(final String method, final Collection<String> values) {
         if (values == null || values.isEmpty()) {
             return emitter;
         }
@@ -170,31 +173,33 @@ class OperationVisitor<T> {
 
             emit("id", operation.operationId);
             emit("description", operation.description);
-            List<String> operationLevelConsumes = new ArrayList<>();
+            Set<String> operationLevelConsumes = new LinkedHashSet<>();
             if (operation instanceof Oas20Operation) {
-                operationLevelConsumes = ((Oas20Operation) operation).consumes;
+                Oas20Operation oas20Operation = (Oas20Operation) operation;
+                if (oas20Operation.consumes != null) {
+                    operationLevelConsumes.addAll(oas20Operation.consumes);
+                }
             } else if (operation instanceof Oas30Operation) {
-                final Oas30Operation oas30Operation = (Oas30Operation) operation;
+                Oas30Operation oas30Operation = (Oas30Operation) operation;
                 if (oas30Operation.requestBody != null
                         && oas30Operation.requestBody.content != null) {
-                    for (final String ct : oas30Operation.requestBody.content.keySet()) {
-                        operationLevelConsumes.add(ct);
-                    }
+                    operationLevelConsumes.addAll(oas30Operation.requestBody.content.keySet());
                 }
 
             }
             emit("consumes", operationLevelConsumes);
-            List<String> operationLevelProduces = new ArrayList<>();
+            Set<String> operationLevelProduces = new LinkedHashSet<>();
             if (operation instanceof Oas20Operation) {
-                operationLevelProduces = ((Oas20Operation) operation).produces;
+                Oas20Operation oas20Operation = (Oas20Operation) operation;
+                if (oas20Operation.produces != null) {
+                    operationLevelProduces.addAll(oas20Operation.produces);
+                }
             } else if (operation instanceof Oas30Operation) {
                 final Oas30Operation oas30Operation = (Oas30Operation) operation;
                 if (oas30Operation.responses != null) {
-                    for (final OasResponse response : oas30Operation.responses.getResponses()) {
-                        final Oas30Response oas30Response = (Oas30Response) response;
-                        for (final String ct : oas30Response.content.keySet()) {
-                            operationLevelProduces.add(ct);
-                        }
+                    for (OasResponse response : oas30Operation.responses.getResponses()) {
+                        Oas30Response oas30Response = (Oas30Response) response;
+                        operationLevelProduces.addAll(oas30Response.content.keySet());
                     }
                 }
             }
diff --git a/tooling/openapi-rest-dsl-generator/src/test/java/org/apache/camel/generator/openapi/RestDslXmlGeneratorV3SimpleTest.java b/tooling/openapi-rest-dsl-generator/src/test/java/org/apache/camel/generator/openapi/RestDslXmlGeneratorV3SimpleTest.java
new file mode 100644
index 00000000000..79bc7bdd58a
--- /dev/null
+++ b/tooling/openapi-rest-dsl-generator/src/test/java/org/apache/camel/generator/openapi/RestDslXmlGeneratorV3SimpleTest.java
@@ -0,0 +1,60 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.camel.generator.openapi;
+
+import java.io.InputStream;
+import java.net.URI;
+import java.nio.charset.StandardCharsets;
+import java.nio.file.Files;
+import java.nio.file.Paths;
+
+import com.fasterxml.jackson.databind.JsonNode;
+import com.fasterxml.jackson.databind.ObjectMapper;
+import io.apicurio.datamodels.Library;
+import io.apicurio.datamodels.openapi.models.OasDocument;
+import org.apache.camel.CamelContext;
+import org.apache.camel.impl.DefaultCamelContext;
+import org.junit.jupiter.api.BeforeAll;
+import org.junit.jupiter.api.Test;
+
+import static org.assertj.core.api.Assertions.assertThat;
+
+public class RestDslXmlGeneratorV3SimpleTest {
+
+    static OasDocument document;
+
+    @BeforeAll
+    public static void readOpenApiDoc() throws Exception {
+        final ObjectMapper mapper = new ObjectMapper();
+        try (InputStream is = RestDslXmlGeneratorV3SimpleTest.class.getResourceAsStream("openapi-spec-simple.json")) {
+            final JsonNode node = mapper.readTree(is);
+            document = (OasDocument) Library.readDocument(node);
+        }
+    }
+
+    @Test
+    public void shouldGenerateXmlWithDefaults() throws Exception {
+        final CamelContext context = new DefaultCamelContext();
+
+        final String xml = RestDslGenerator.toXml(document).generate(context);
+        final URI file = RestDslGeneratorTest.class.getResource("/OpenApiV3PetstoreSimpleXml.txt").toURI();
+        final String expectedContent = new String(Files.readAllBytes(Paths.get(file)), StandardCharsets.UTF_8);
+
+        assertThat(xml).isXmlEqualTo(expectedContent);
+    }
+
+}
diff --git a/tooling/openapi-rest-dsl-generator/src/test/resources/OpenApiV3PetstoreSimpleXml.txt b/tooling/openapi-rest-dsl-generator/src/test/resources/OpenApiV3PetstoreSimpleXml.txt
new file mode 100644
index 00000000000..5381ff80343
--- /dev/null
+++ b/tooling/openapi-rest-dsl-generator/src/test/resources/OpenApiV3PetstoreSimpleXml.txt
@@ -0,0 +1,8 @@
+<?xml version="1.0" encoding="UTF-8"?><rests xmlns="http://camel.apache.org/schema/spring">
+    <rest>
+        <put consumes="application/json,text/xml" produces="application/json,text/xml" uri="/pet">
+            <param name="body" required="true" type="body"/>
+            <to uri="direct:rest1"/>      
+        </put> 
+    </rest> 
+</rests>
\ No newline at end of file
diff --git a/tooling/openapi-rest-dsl-generator/src/test/resources/org/apache/camel/generator/openapi/openapi-spec-simple.json b/tooling/openapi-rest-dsl-generator/src/test/resources/org/apache/camel/generator/openapi/openapi-spec-simple.json
new file mode 100644
index 00000000000..66c999fb469
--- /dev/null
+++ b/tooling/openapi-rest-dsl-generator/src/test/resources/org/apache/camel/generator/openapi/openapi-spec-simple.json
@@ -0,0 +1,142 @@
+{
+    "openapi": "3.0.2",
+    "info": {
+        "title": "OpenApi Simple PetStore",
+        "version": "1.0.0",
+        "description": "Minimal example for testing."
+    },
+    "paths": {
+        "/pet": {
+            "put": {
+                "requestBody": {
+                    "content": {
+                        "application/json": {
+                            "schema": {
+                                "$ref": "#/components/schemas/Pet"
+                            }
+                        },
+                        "text/xml": {
+                            "schema": {
+                                "$ref": "#/components/schemas/Pet"
+                            }
+                        }
+                    },
+                    "required": true
+                },
+                "responses": {
+                    "200": {
+                        "content": {
+                            "application/json": {
+                                "schema": {
+                                    "$ref": "#/components/schemas/Pet"
+                                }
+                            },
+                            "text/xml": {
+                                "schema": {
+                                    "$ref": "#/components/schemas/Pet"
+                                }
+                            }
+                        },
+                        "description": "Updated pet."
+                    },
+                    "201": {
+                        "content": {
+                            "application/json": {
+                                "schema": {
+                                    "$ref": "#/components/schemas/Pet"
+                                }
+                            }
+                        },
+                        "description": "Created pet."
+                    }
+                }
+            }
+        }
+    },
+    "components": {
+        "schemas": {
+            "Pet": {
+                "required": [
+                    "name",
+                    "photoUrls"
+                ],
+                "type": "object",
+                "properties": {
+                    "id": {
+                        "format": "int64",
+                        "type": "integer"
+                    },
+                    "category": {
+                        "$ref": "#/components/schemas/Category"
+                    },
+                    "name": {
+                        "type": "string",
+                        "example": "doggie"
+                    },
+                    "photoUrls": {
+                        "type": "array",
+                        "items": {
+                            "type": "string"
+                        },
+                        "xml": {
+                            "name": "photoUrl",
+                            "wrapped": true
+                        }
+                    },
+                    "tags": {
+                        "type": "array",
+                        "items": {
+                            "$ref": "#/components/schemas/Tag"
+                        },
+                        "xml": {
+                            "name": "tag",
+                            "wrapped": true
+                        }
+                    },
+                    "status": {
+                        "description": "pet status in the store",
+                        "enum": [
+                            "available",
+                            "pending",
+                            "sold"
+                        ],
+                        "type": "string"
+                    }
+                },
+                "xml": {
+                    "name": "Pet"
+                }
+            },
+            "Category": {
+                "type": "object",
+                "properties": {
+                    "id": {
+                        "format": "int64",
+                        "type": "integer"
+                    },
+                    "name": {
+                        "type": "string"
+                    }
+                },
+                "xml": {
+                    "name": "Category"
+                }
+            },
+            "Tag": {
+                "type": "object",
+                "properties": {
+                    "id": {
+                        "format": "int64",
+                        "type": "integer"
+                    },
+                    "name": {
+                        "type": "string"
+                    }
+                },
+                "xml": {
+                    "name": "Tag"
+                }
+            }
+        }
+    }
+}
\ No newline at end of file
