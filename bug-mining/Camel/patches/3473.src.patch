diff --git a/camel-core/src/main/java/org/apache/camel/processor/idempotent/FileIdempotentRepository.java b/camel-core/src/main/java/org/apache/camel/processor/idempotent/FileIdempotentRepository.java
index 301fb0d8c68..2451daf8eb9 100644
--- a/camel-core/src/main/java/org/apache/camel/processor/idempotent/FileIdempotentRepository.java
+++ b/camel-core/src/main/java/org/apache/camel/processor/idempotent/FileIdempotentRepository.java
@@ -290,7 +290,9 @@ public class FileIdempotentRepository extends ServiceSupport implements Idempote
         if (!fileStore.exists()) {
             LOG.debug("Creating filestore: {}", fileStore);
             File parent = fileStore.getParentFile();
-            parent.mkdirs();
+            if (parent != null) {
+                parent.mkdirs();
+            }
             boolean created = FileUtil.createNewFile(fileStore);
             if (!created) {
                 throw new IOException("Cannot create filestore: " + fileStore);
diff --git a/camel-core/src/test/java/org/apache/camel/processor/FileIdempotentConsumerCreateRepoTest.java b/camel-core/src/test/java/org/apache/camel/processor/FileIdempotentConsumerCreateRepoTest.java
index 9198b952669..698f8b0aeec 100644
--- a/camel-core/src/test/java/org/apache/camel/processor/FileIdempotentConsumerCreateRepoTest.java
+++ b/camel-core/src/test/java/org/apache/camel/processor/FileIdempotentConsumerCreateRepoTest.java
@@ -21,6 +21,8 @@ import java.io.File;
 import static java.util.UUID.randomUUID;
 
 import org.apache.camel.spi.IdempotentRepository;
+import org.apache.camel.util.FileUtil;
+import org.junit.After;
 import org.junit.Assert;
 import org.junit.Test;
 
@@ -28,11 +30,25 @@ import static org.apache.camel.processor.idempotent.FileIdempotentRepository.fil
 
 public class FileIdempotentConsumerCreateRepoTest extends Assert {
 
+    File store;
+
     @Test
     public void shouldCreateParentOfRepositoryFileStore() throws Exception {
-        // Given
         File parentDirectory = new File("target/repositoryParent_" + randomUUID());
-        File store = new File(parentDirectory, "store");
+        store = new File(parentDirectory, "store");
+        assertStoreExists(store);
+    }
+
+    @Test
+    public void shouldUseCurrentDirIfHasNoParentFile() throws Exception {
+        String storeFileName = "store" + randomUUID();
+        store = new File(storeFileName);
+        assertStoreExists(store);
+    }
+
+
+    private void assertStoreExists(File store) throws Exception {
+        // Given
         IdempotentRepository<String> repo = fileIdempotentRepository(store);
 
         // must start repo
@@ -47,4 +63,8 @@ public class FileIdempotentConsumerCreateRepoTest extends Assert {
         repo.stop();
     }
 
+    @After
+    public void after() {
+        FileUtil.deleteFile(this.store);
+    }
 }
\ No newline at end of file
