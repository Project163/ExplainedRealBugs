diff --git a/core/camel-base/src/main/java/org/apache/camel/impl/engine/DefaultPackageScanResourceResolver.java b/core/camel-base/src/main/java/org/apache/camel/impl/engine/DefaultPackageScanResourceResolver.java
index 8ffb3184f34..f78c604baa7 100644
--- a/core/camel-base/src/main/java/org/apache/camel/impl/engine/DefaultPackageScanResourceResolver.java
+++ b/core/camel-base/src/main/java/org/apache/camel/impl/engine/DefaultPackageScanResourceResolver.java
@@ -26,6 +26,8 @@ import java.net.URISyntaxException;
 import java.net.URL;
 import java.net.URLConnection;
 import java.net.URLDecoder;
+import java.nio.file.Files;
+import java.nio.file.Path;
 import java.util.ArrayList;
 import java.util.Enumeration;
 import java.util.LinkedHashSet;
@@ -33,6 +35,7 @@ import java.util.List;
 import java.util.Set;
 import java.util.jar.JarEntry;
 import java.util.jar.JarInputStream;
+import java.util.stream.Stream;
 
 import org.apache.camel.CamelContextAware;
 import org.apache.camel.NonManagedService;
@@ -79,28 +82,23 @@ public class DefaultPackageScanResourceResolver extends BasePackageScanResolver
         return answer;
     }
 
-    protected void findInFileSystem(File dir, Set<InputStream> resources, String subPattern) {
-        if (dir.exists() && dir.isDirectory()) {
-            File[] files = dir.listFiles();
-            if (files != null) {
-                for (File file : files) {
-                    if (file.isDirectory() && !file.getName().startsWith(".")) {
-                        // skip hidden directories
-                        findInFileSystem(file, resources, subPattern);
-                    } else if (file.isFile()) {
-                        boolean match = PATH_MATCHER.match(subPattern, file.getName());
-                        log.debug("Found resource: {} matching pattern: {} -> {}", file.getName(), subPattern, match);
-                        if (match) {
-                            try {
-                                // the input stream will be closed later
-                                resources.add(new FileInputStream(file));
-                            } catch (FileNotFoundException e) {
-                                // ignore
-                            }
-                        }
-                    }
+    protected void findInFileSystem(File dir, Set<InputStream> resources, String subPattern) throws Exception {
+        try (Stream<Path> path = Files.walk(dir.toPath())) {
+            path.filter(f -> {
+                if (f.toFile().isFile()) {
+                    String shortName = f.toFile().getName();
+                    boolean match = PATH_MATCHER.match(subPattern, shortName);
+                    log.debug("Found resource: {} matching pattern: {} -> {}", shortName, subPattern, match);
+                    return match;
                 }
-            }
+                return false;
+            }).forEach(f -> {
+                try {
+                    resources.add(new FileInputStream(f.toFile()));
+                } catch (FileNotFoundException e) {
+                    // ignore
+                }
+            });
         }
     }
 
