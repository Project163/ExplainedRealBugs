diff --git a/components/camel-microprofile-metrics/src/main/java/org/apache/camel/component/microprofile/metrics/route/policy/MicroProfileMetricsRoutePolicy.java b/components/camel-microprofile-metrics/src/main/java/org/apache/camel/component/microprofile/metrics/route/policy/MicroProfileMetricsRoutePolicy.java
index 09cbeb27f27..a966cbe4e1a 100644
--- a/components/camel-microprofile-metrics/src/main/java/org/apache/camel/component/microprofile/metrics/route/policy/MicroProfileMetricsRoutePolicy.java
+++ b/components/camel-microprofile-metrics/src/main/java/org/apache/camel/component/microprofile/metrics/route/policy/MicroProfileMetricsRoutePolicy.java
@@ -92,7 +92,7 @@ public class MicroProfileMetricsRoutePolicy extends RoutePolicySupport implement
     @Override
     public void onInit(Route route) {
         super.onInit(route);
-        MetricRegistry metricRegistry = getMetricRegistry();
+
         if (metricRegistry == null) {
             metricRegistry = MicroProfileMetricsHelper.getMetricRegistry(route.getCamelContext());
         }
diff --git a/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/event/notifier/exchange/MicroProfileMetricsExchangeEventNotifierTest.java b/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/event/notifier/exchange/MicroProfileMetricsExchangeEventNotifierTest.java
index d695db2e78e..a1b900111d0 100644
--- a/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/event/notifier/exchange/MicroProfileMetricsExchangeEventNotifierTest.java
+++ b/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/event/notifier/exchange/MicroProfileMetricsExchangeEventNotifierTest.java
@@ -113,7 +113,6 @@ public class MicroProfileMetricsExchangeEventNotifierTest extends MicroProfileMe
     protected CamelContext createCamelContext() throws Exception {
         eventNotifier = new MicroProfileMetricsExchangeEventNotifier();
         eventNotifier.setNamingStrategy((exchange, endpoint) -> endpoint.getEndpointUri());
-        eventNotifier.setMetricRegistry(metricRegistry);
 
         CamelContext camelContext = super.createCamelContext();
         camelContext.getManagementStrategy().addEventNotifier(eventNotifier);
diff --git a/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/event/notifier/route/MicroProfileMetricsRouteEventNotifierTest.java b/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/event/notifier/route/MicroProfileMetricsRouteEventNotifierTest.java
index 8159cf5ce5c..46c211fd16e 100644
--- a/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/event/notifier/route/MicroProfileMetricsRouteEventNotifierTest.java
+++ b/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/event/notifier/route/MicroProfileMetricsRouteEventNotifierTest.java
@@ -70,7 +70,6 @@ public class MicroProfileMetricsRouteEventNotifierTest extends MicroProfileMetri
     @Override
     protected CamelContext createCamelContext() throws Exception {
         eventNotifier = new MicroProfileMetricsRouteEventNotifier();
-        eventNotifier.setMetricRegistry(metricRegistry);
 
         CamelContext camelContext = super.createCamelContext();
         camelContext.getManagementStrategy().addEventNotifier(eventNotifier);
diff --git a/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/message/history/MicroProfileMetricsExceptionInRouteMessageHistoryTest.java b/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/message/history/MicroProfileMetricsExceptionInRouteMessageHistoryTest.java
index e621d282505..d5a4b215a67 100644
--- a/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/message/history/MicroProfileMetricsExceptionInRouteMessageHistoryTest.java
+++ b/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/message/history/MicroProfileMetricsExceptionInRouteMessageHistoryTest.java
@@ -87,11 +87,8 @@ public class MicroProfileMetricsExceptionInRouteMessageHistoryTest extends Micro
 
     @Override
     protected CamelContext createCamelContext() throws Exception {
-        MicroProfileMetricsMessageHistoryFactory factory = new MicroProfileMetricsMessageHistoryFactory();
-        factory.setMetricRegistry(metricRegistry);
-
         CamelContext context = super.createCamelContext();
-        context.setMessageHistoryFactory(factory);
+        context.setMessageHistoryFactory(new MicroProfileMetricsMessageHistoryFactory());
         return context;
     }
 }
diff --git a/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/message/history/MicroProfileMetricsMessageHistoryTest.java b/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/message/history/MicroProfileMetricsMessageHistoryTest.java
index 9bcfd16ae7b..5f335bec85f 100644
--- a/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/message/history/MicroProfileMetricsMessageHistoryTest.java
+++ b/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/message/history/MicroProfileMetricsMessageHistoryTest.java
@@ -114,7 +114,6 @@ public class MicroProfileMetricsMessageHistoryTest extends MicroProfileMetricsTe
     @Override
     protected CamelContext createCamelContext() throws Exception {
         factory = new MicroProfileMetricsMessageHistoryFactory();
-        factory.setMetricRegistry(metricRegistry);
 
         CamelContext context = super.createCamelContext();
         context.setMessageHistoryFactory(factory);
diff --git a/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/route/policy/MicroProfileMetricsRoutePolicyMulticastSubRouteTest.java b/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/route/policy/MicroProfileMetricsRoutePolicyMulticastSubRouteTest.java
index b67baf6d2d2..9ee30eeebb6 100644
--- a/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/route/policy/MicroProfileMetricsRoutePolicyMulticastSubRouteTest.java
+++ b/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/route/policy/MicroProfileMetricsRoutePolicyMulticastSubRouteTest.java
@@ -66,11 +66,8 @@ public class MicroProfileMetricsRoutePolicyMulticastSubRouteTest extends MicroPr
 
     @Override
     protected CamelContext createCamelContext() throws Exception {
-        MicroProfileMetricsRoutePolicyFactory factory = new MicroProfileMetricsRoutePolicyFactory();
-        factory.setMetricRegistry(metricRegistry);
-
         CamelContext camelContext = super.createCamelContext();
-        camelContext.addRoutePolicyFactory(factory);
+        camelContext.addRoutePolicyFactory(new MicroProfileMetricsRoutePolicyFactory());
         return camelContext;
     }
 }
diff --git a/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/route/policy/MicroProfileMetricsRoutePolicySubRouteTest.java b/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/route/policy/MicroProfileMetricsRoutePolicySubRouteTest.java
index 3243ccc1817..56ff4591e3b 100644
--- a/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/route/policy/MicroProfileMetricsRoutePolicySubRouteTest.java
+++ b/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/route/policy/MicroProfileMetricsRoutePolicySubRouteTest.java
@@ -62,11 +62,8 @@ public class MicroProfileMetricsRoutePolicySubRouteTest extends MicroProfileMetr
 
     @Override
     protected CamelContext createCamelContext() throws Exception {
-        MicroProfileMetricsRoutePolicyFactory factory = new MicroProfileMetricsRoutePolicyFactory();
-        factory.setMetricRegistry(metricRegistry);
-
         CamelContext camelContext = super.createCamelContext();
-        camelContext.addRoutePolicyFactory(factory);
+        camelContext.addRoutePolicyFactory(new MicroProfileMetricsRoutePolicyFactory());
         return camelContext;
     }
 }
diff --git a/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/route/policy/MicroProfileMetricsRoutePolicyTest.java b/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/route/policy/MicroProfileMetricsRoutePolicyTest.java
index 8a7379f843c..191abd87392 100644
--- a/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/route/policy/MicroProfileMetricsRoutePolicyTest.java
+++ b/components/camel-microprofile-metrics/src/test/java/org/apache/camel/component/microprofile/metrics/route/policy/MicroProfileMetricsRoutePolicyTest.java
@@ -20,6 +20,7 @@ import java.util.Arrays;
 
 import io.smallrye.metrics.TagsUtils;
 import org.apache.camel.CamelContext;
+import org.apache.camel.builder.AdviceWithRouteBuilder;
 import org.apache.camel.builder.RouteBuilder;
 import org.apache.camel.component.microprofile.metrics.MicroProfileMetricsHelper;
 import org.apache.camel.component.microprofile.metrics.MicroProfileMetricsTestSupport;
@@ -100,6 +101,14 @@ public class MicroProfileMetricsRoutePolicyTest extends MicroProfileMetricsTestS
         assertEquals(6, countRouteMetrics("bar"));
     }
 
+    @Test
+    public void adviceWithTest() throws Exception {
+        AdviceWithRouteBuilder.adviceWith(context, "foo", advisor -> {
+            advisor.replaceFromWith("direct:replaced");
+        });
+        assertEquals(6, countRouteMetrics("foo"));
+    }
+
     private long countRouteMetrics(String routeId) {
         return metricRegistry.getMetricIDs()
                 .stream()
@@ -166,11 +175,8 @@ public class MicroProfileMetricsRoutePolicyTest extends MicroProfileMetricsTestS
 
     @Override
     protected CamelContext createCamelContext() throws Exception {
-        MicroProfileMetricsRoutePolicyFactory factory = new MicroProfileMetricsRoutePolicyFactory();
-        factory.setMetricRegistry(metricRegistry);
-
         CamelContext camelContext = super.createCamelContext();
-        camelContext.addRoutePolicyFactory(factory);
+        camelContext.addRoutePolicyFactory(new MicroProfileMetricsRoutePolicyFactory());
         return camelContext;
     }
 }
