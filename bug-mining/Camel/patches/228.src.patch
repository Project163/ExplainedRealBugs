diff --git a/camel-core/src/main/java/org/apache/camel/component/bean/BeanProcessor.java b/camel-core/src/main/java/org/apache/camel/component/bean/BeanProcessor.java
index d4d38b77dad..ebe294ad5d9 100644
--- a/camel-core/src/main/java/org/apache/camel/component/bean/BeanProcessor.java
+++ b/camel-core/src/main/java/org/apache/camel/component/bean/BeanProcessor.java
@@ -108,7 +108,7 @@ public class BeanProcessor extends ServiceSupport implements Processor {
         }
         try {
             Object value = invocation.proceed();
-            if (value != null) {
+            if (value != null && exchange.getPattern().isOutCapable()) {
                 exchange.getOut().setBody(value);
             }
         } catch (InvocationTargetException e) {
diff --git a/camel-core/src/main/java/org/apache/camel/language/bean/BeanExpression.java b/camel-core/src/main/java/org/apache/camel/language/bean/BeanExpression.java
index 0aeeae86ef9..140e65615b1 100644
--- a/camel-core/src/main/java/org/apache/camel/language/bean/BeanExpression.java
+++ b/camel-core/src/main/java/org/apache/camel/language/bean/BeanExpression.java
@@ -17,6 +17,7 @@
 package org.apache.camel.language.bean;
 
 import org.apache.camel.Exchange;
+import org.apache.camel.ExchangePattern;
 import org.apache.camel.component.bean.BeanProcessor;
 import org.apache.camel.component.bean.RegistryBean;
 import org.apache.camel.impl.ExpressionSupport;
@@ -51,6 +52,10 @@ public class BeanExpression<E extends Exchange> extends ExpressionSupport<E> {
         }
         try {
             Exchange newExchange = exchange.copy();
+            // check the exchange pattern
+            if (!newExchange.getPattern().isOutCapable()) {
+                newExchange.setPattern(ExchangePattern.InOut);
+            }
             processor.process(newExchange);
             return newExchange.getOut(true).getBody();
         } catch (Exception e) {
diff --git a/camel-core/src/main/java/org/apache/camel/util/ResolverUtil.java b/camel-core/src/main/java/org/apache/camel/util/ResolverUtil.java
index 229541ca071..bd2496cf44e 100644
--- a/camel-core/src/main/java/org/apache/camel/util/ResolverUtil.java
+++ b/camel-core/src/main/java/org/apache/camel/util/ResolverUtil.java
@@ -280,9 +280,15 @@ public class ResolverUtil<T> {
 
     protected void find(Test test, String packageName, ClassLoader loader) {
         if (LOG.isTraceEnabled()) {
-            LOG.trace("Searching for: " + test + " in package: " + packageName + " using classloader: " + loader);
+            LOG.trace("Searching for: " + test + " in package: " + packageName + " using classloader: " 
+                    + loader.getClass().getName());
+        }
+        if (loader.getClass().getName().endsWith(
+                "org.apache.felix.framework.searchpolicy.ContentClassLoader")) {
+            //this classloader is in OSGI env which is not URLClassloader, we should resort to the
+            //BundleDelegatingClassLoader in OSGI, so just return
+            return;
         }
-
         try {
             Method mth = loader.getClass().getMethod("getBundle", new Class[] {});
             if (mth != null) {
diff --git a/camel-core/src/main/java/org/apache/camel/util/WebSphereResolverUtil.java b/camel-core/src/main/java/org/apache/camel/util/WebSphereResolverUtil.java
index 7c5bdc55e4d..5048001333a 100644
--- a/camel-core/src/main/java/org/apache/camel/util/WebSphereResolverUtil.java
+++ b/camel-core/src/main/java/org/apache/camel/util/WebSphereResolverUtil.java
@@ -1,12 +1,24 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
 package org.apache.camel.util;
 
+import java.io.IOException;
 import java.net.URL;
-import java.net.MalformedURLException;
 import java.util.Enumeration;
-import java.util.ArrayList;
-import java.util.List;
-import java.util.Vector;
-import java.io.IOException;
 
 import org.apache.camel.impl.converter.AnnotationTypeConverterLoader;
 
@@ -40,7 +52,7 @@ public class WebSphereResolverUtil extends ResolverUtil {
     protected Enumeration<URL> getResources(ClassLoader loader, String packageName) throws IOException {
         // try super first, just in vase
         Enumeration<URL> enumeration = super.getResources(loader, packageName);
-        if (! enumeration.hasMoreElements()) {
+        if (!enumeration.hasMoreElements()) {
             LOG.trace("Using WebSphere workaround to load the camel jars with the annotated converters.");
             // Special WebSphere trick to load a file that exists in the JAR and then let it go from there.
             // The trick is that we just need the URL's for the .jars that contains the type
diff --git a/camel-core/src/test/java/org/apache/camel/component/bean/NewInstanceTest.java b/camel-core/src/test/java/org/apache/camel/component/bean/NewInstanceTest.java
index adc33e819ef..a6b3a4f0d99 100644
--- a/camel-core/src/test/java/org/apache/camel/component/bean/NewInstanceTest.java
+++ b/camel-core/src/test/java/org/apache/camel/component/bean/NewInstanceTest.java
@@ -20,6 +20,7 @@ import javax.naming.Context;
 
 import org.apache.camel.Body;
 import org.apache.camel.ContextTestSupport;
+import org.apache.camel.ExchangePattern;
 import org.apache.camel.builder.RouteBuilder;
 import org.apache.camel.component.mock.MockEndpoint;
 import org.apache.camel.processor.BeanRouteTest;
@@ -38,13 +39,13 @@ public class NewInstanceTest extends ContextTestSupport {
         MockEndpoint endpoint = getMockEndpoint("mock:result");
         endpoint.expectedBodiesReceived(1, 2);
 
-        template.sendBody("direct:start", "first");
+        template.sendBody("direct:start", ExchangePattern.InOut, "first");
 
         // lets simulate spring's factory bean stuff
         jndiContext.unbind("myBean");
         jndiContext.bind("myBean", new MyBean());
 
-        template.sendBody("direct:start", "second");
+        template.sendBody("direct:start", ExchangePattern.InOut, "second");
 
         assertMockEndpointsSatisifed();
     }
diff --git a/camel-core/src/test/java/org/apache/camel/component/direct/DirectNoToTypeTest.java b/camel-core/src/test/java/org/apache/camel/component/direct/DirectNoToTypeTest.java
index d1889003183..0ed5c587c22 100644
--- a/camel-core/src/test/java/org/apache/camel/component/direct/DirectNoToTypeTest.java
+++ b/camel-core/src/test/java/org/apache/camel/component/direct/DirectNoToTypeTest.java
@@ -17,8 +17,8 @@
 package org.apache.camel.component.direct;
 
 import org.apache.camel.ContextTestSupport;
-import org.apache.camel.Processor;
 import org.apache.camel.Exchange;
+import org.apache.camel.Processor;
 import org.apache.camel.builder.RouteBuilder;
 
 /**
@@ -43,5 +43,5 @@ public class DirectNoToTypeTest extends ContextTestSupport {
             }
         };
     }
-    
+
 }
diff --git a/camel-core/src/test/java/org/apache/camel/language/BeanTest.java b/camel-core/src/test/java/org/apache/camel/language/BeanTest.java
index 0e963e416f9..675a9f23ea1 100644
--- a/camel-core/src/test/java/org/apache/camel/language/BeanTest.java
+++ b/camel-core/src/test/java/org/apache/camel/language/BeanTest.java
@@ -19,14 +19,17 @@ package org.apache.camel.language;
 import javax.naming.Context;
 
 import org.apache.camel.Exchange;
+import org.apache.camel.ExchangePattern;
 import org.apache.camel.Header;
 import org.apache.camel.LanguageTestSupport;
 import org.apache.camel.Message;
+import org.apache.camel.impl.DefaultExchange;
 
 /**
  * @version $Revision$
  */
 public class BeanTest extends LanguageTestSupport {
+
     public void testSimpleExpressions() throws Exception {
         assertExpression("foo.cheese", "abc");
     }
diff --git a/camel-core/src/test/java/org/apache/camel/processor/MethodFilterTest.java b/camel-core/src/test/java/org/apache/camel/processor/MethodFilterTest.java
index d5e18c562aa..031bf03dc51 100644
--- a/camel-core/src/test/java/org/apache/camel/processor/MethodFilterTest.java
+++ b/camel-core/src/test/java/org/apache/camel/processor/MethodFilterTest.java
@@ -19,6 +19,7 @@ package org.apache.camel.processor;
 import javax.naming.Context;
 
 import org.apache.camel.ContextTestSupport;
+import org.apache.camel.ExchangePattern;
 import org.apache.camel.Header;
 import org.apache.camel.builder.RouteBuilder;
 
@@ -30,7 +31,7 @@ public class MethodFilterTest extends ContextTestSupport {
         String body = "<person name='James' city='London'/>";
         getMockEndpoint("mock:result").expectedBodiesReceived(body);
 
-        template.sendBodyAndHeader("direct:start", body, "foo", "London");
+        template.sendBodyAndHeader("direct:start", ExchangePattern.InOut, body, "foo", "London");
 
         assertMockEndpointsSatisifed();
     }
@@ -39,7 +40,7 @@ public class MethodFilterTest extends ContextTestSupport {
         String body = "<person name='Hiram' city='Tampa'/>";
         getMockEndpoint("mock:result").expectedMessageCount(0);
 
-        template.sendBodyAndHeader("direct:start", body, "foo", "Tampa");
+        template.sendBodyAndHeader("direct:start", ExchangePattern.InOut, body, "foo", "Tampa");
 
         assertMockEndpointsSatisifed();
     }
diff --git a/components/camel-jms/src/main/java/org/apache/camel/component/jms/JmsBinding.java b/components/camel-jms/src/main/java/org/apache/camel/component/jms/JmsBinding.java
index 6697cf9f2e8..3d126cfc528 100644
--- a/components/camel-jms/src/main/java/org/apache/camel/component/jms/JmsBinding.java
+++ b/components/camel-jms/src/main/java/org/apache/camel/component/jms/JmsBinding.java
@@ -17,15 +17,16 @@
 package org.apache.camel.component.jms;
 
 import java.io.Serializable;
+import java.math.BigDecimal;
+import java.math.BigInteger;
 import java.util.Arrays;
+import java.util.Date;
 import java.util.Enumeration;
 import java.util.HashMap;
 import java.util.HashSet;
 import java.util.Map;
 import java.util.Set;
-import java.util.Date;
-import java.math.BigDecimal;
-import java.math.BigInteger;
+
 import javax.jms.BytesMessage;
 import javax.jms.Destination;
 import javax.jms.JMSException;
@@ -36,7 +37,6 @@ import javax.jms.Session;
 import javax.jms.StreamMessage;
 import javax.jms.TextMessage;
 import javax.xml.transform.TransformerException;
-
 import org.w3c.dom.Node;
 
 import org.apache.camel.CamelContext;
@@ -48,6 +48,8 @@ import org.apache.camel.util.ObjectHelper;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 
+
+
 /**
  * A Strategy used to convert between a Camel {@link JmsExchange} and {@link JmsMessage}
  * to and from a JMS {@link Message}
diff --git a/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/DummyOrder.java b/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/DummyOrder.java
index 83a4910f926..258272dc61a 100644
--- a/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/DummyOrder.java
+++ b/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/DummyOrder.java
@@ -1,3 +1,19 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
 package org.apache.camel.component.jms.issues;
 
 import java.io.Serializable;
@@ -67,10 +83,13 @@ public class DummyOrder implements Serializable {
     }
 
     public String toString() {
-        return "DummyOrder{" +
-            "orderId=" + orderId +
-            ", itemId=" + itemId +
-            ", quantity=" + quantity +
-            '}';
+        return "DummyOrder{"
+            + "orderId="
+            + orderId
+            + ", itemId="
+            + itemId
+            + ", quantity="
+            + quantity
+            + '}';
     }
 }
diff --git a/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/JmsBeanMethodHeaderTest.java b/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/JmsBeanMethodHeaderTest.java
index 4f176ec9972..67400581774 100644
--- a/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/JmsBeanMethodHeaderTest.java
+++ b/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/JmsBeanMethodHeaderTest.java
@@ -23,6 +23,7 @@ import org.apache.activemq.ActiveMQConnectionFactory;
 import org.apache.camel.Body;
 import org.apache.camel.CamelContext;
 import org.apache.camel.ContextTestSupport;
+import org.apache.camel.ExchangePattern;
 import org.apache.camel.builder.RouteBuilder;
 import org.apache.camel.component.bean.BeanProcessor;
 import org.apache.camel.component.mock.MockEndpoint;
@@ -59,7 +60,7 @@ public class JmsBeanMethodHeaderTest extends ContextTestSupport {
         MockEndpoint mock = getMockEndpoint("mock:approve");
         mock.expectedBodiesReceived("Yes");
 
-        template.sendBodyAndHeader("direct:approve", "James",
+        template.sendBodyAndHeader("direct:approve", ExchangePattern.InOut, "James",
             BeanProcessor.METHOD_NAME, "approveLoan");
 
         mock.assertIsSatisfied();
@@ -69,7 +70,7 @@ public class JmsBeanMethodHeaderTest extends ContextTestSupport {
         MockEndpoint mock = getMockEndpoint("mock:approve");
         mock.expectedBodiesReceived("Yes");
 
-        template.sendBodyAndHeader("activemq:approve", "James",
+        template.sendBodyAndHeader("activemq:approve", ExchangePattern.InOut, "James",
             BeanProcessor.METHOD_NAME, "approveLoan");
 
         mock.assertIsSatisfied();
@@ -80,7 +81,7 @@ public class JmsBeanMethodHeaderTest extends ContextTestSupport {
         MockEndpoint mock = getMockEndpoint("mock:approve");
         mock.expectedBodiesReceived("No");
 
-        template.sendBodyAndHeader("activemq:queue", "James",
+        template.sendBodyAndHeader("activemq:queue", ExchangePattern.InOut, "James",
             BeanProcessor.METHOD_NAME, "approveSuperLoan");
 
         mock.assertIsSatisfied();
diff --git a/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/JmsConcurrentConsumersTest.java b/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/JmsConcurrentConsumersTest.java
index 3ff49782daa..a958c39acaa 100644
--- a/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/JmsConcurrentConsumersTest.java
+++ b/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/JmsConcurrentConsumersTest.java
@@ -18,6 +18,7 @@ package org.apache.camel.component.jms.issues;
 
 import java.util.concurrent.CountDownLatch;
 import java.util.concurrent.TimeUnit;
+
 import javax.jms.ConnectionFactory;
 
 import org.apache.activemq.ActiveMQConnectionFactory;
@@ -26,9 +27,9 @@ import org.apache.camel.ContextTestSupport;
 import org.apache.camel.Exchange;
 import org.apache.camel.Processor;
 import org.apache.camel.builder.RouteBuilder;
-import static org.apache.camel.component.jms.JmsComponent.jmsComponent;
 import org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor;
 
+import static org.apache.camel.component.jms.JmsComponent.jmsComponent;
 /**
  * Concurrent consumer with JMSReply test.
  */
diff --git a/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/JmsHeaderAsObjectTest.java b/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/JmsHeaderAsObjectTest.java
index 612de391e2a..31d8fe1a8d8 100644
--- a/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/JmsHeaderAsObjectTest.java
+++ b/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/JmsHeaderAsObjectTest.java
@@ -1,17 +1,31 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
 package org.apache.camel.component.jms.issues;
 
 import java.util.HashMap;
 import java.util.Map;
 
-import static org.apache.activemq.camel.component.ActiveMQComponent.activeMQComponent;
 import org.apache.camel.CamelContext;
 import org.apache.camel.ContextTestSupport;
 import org.apache.camel.builder.RouteBuilder;
 import org.apache.camel.component.mock.MockEndpoint;
 
-/**
- *
- */
+import static org.apache.activemq.camel.component.ActiveMQComponent.activeMQComponent;
+
 public class JmsHeaderAsObjectTest extends ContextTestSupport {
 
     public void testSendHeaderAsPrimitiveOnly() throws Exception {
diff --git a/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/JmsRedeliveryWithInitialRedeliveryDelayTest.java b/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/JmsRedeliveryWithInitialRedeliveryDelayTest.java
index f7bec551df2..52bd354220b 100644
--- a/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/JmsRedeliveryWithInitialRedeliveryDelayTest.java
+++ b/components/camel-jms/src/test/java/org/apache/camel/component/jms/issues/JmsRedeliveryWithInitialRedeliveryDelayTest.java
@@ -1,3 +1,19 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
 package org.apache.camel.component.jms.issues;
 
 import org.apache.camel.CamelContext;
diff --git a/components/camel-jms/src/test/java/org/apache/camel/component/jms/temp/TemporaryQueueRouteTest.java b/components/camel-jms/src/test/java/org/apache/camel/component/jms/temp/TemporaryQueueRouteTest.java
index 55f5cf5cda4..39e9a884ef2 100644
--- a/components/camel-jms/src/test/java/org/apache/camel/component/jms/temp/TemporaryQueueRouteTest.java
+++ b/components/camel-jms/src/test/java/org/apache/camel/component/jms/temp/TemporaryQueueRouteTest.java
@@ -26,6 +26,7 @@ import org.apache.activemq.command.ActiveMQTempQueue;
 import org.apache.camel.CamelContext;
 import org.apache.camel.ContextTestSupport;
 import org.apache.camel.Exchange;
+import org.apache.camel.ExchangePattern;
 import org.apache.camel.Message;
 import org.apache.camel.builder.RouteBuilder;
 import org.apache.camel.component.jms.BrowsableQueueTest;
@@ -51,7 +52,7 @@ public class TemporaryQueueRouteTest extends ContextTestSupport {
         MockEndpoint endpoint = getMockEndpoint("mock:result");
         endpoint.expectedBodiesReceived("Result");
 
-        template.sendBody(endpointUri, expectedBody);
+        template.sendBody(endpointUri, ExchangePattern.InOut, expectedBody);
 
         endpoint.assertIsSatisfied();
 
diff --git a/components/camel-spring/src/test/java/org/apache/camel/spring/bind/BeanAsEndpointTest.java b/components/camel-spring/src/test/java/org/apache/camel/spring/bind/BeanAsEndpointTest.java
index 5871182ed0c..c88f53f68f5 100644
--- a/components/camel-spring/src/test/java/org/apache/camel/spring/bind/BeanAsEndpointTest.java
+++ b/components/camel-spring/src/test/java/org/apache/camel/spring/bind/BeanAsEndpointTest.java
@@ -16,6 +16,7 @@
  */
 package org.apache.camel.spring.bind;
 
+import org.apache.camel.ExchangePattern;
 import org.apache.camel.component.mock.MockEndpoint;
 import org.apache.camel.spring.SpringTestSupport;
 import org.springframework.context.support.ClassPathXmlApplicationContext;
@@ -30,7 +31,7 @@ public class BeanAsEndpointTest extends SpringTestSupport {
         MockEndpoint mock = resolveMandatoryEndpoint("mock:results", MockEndpoint.class);
         mock.expectedBodiesReceived("Hello James!");
 
-        template.sendBody("direct:start", body);
+        template.sendBody("direct:start", ExchangePattern.InOut, body);
 
         mock.assertIsSatisfied();
     }
diff --git a/components/camel-spring/src/test/java/org/apache/camel/spring/config/MyFailureProcessor.java b/components/camel-spring/src/test/java/org/apache/camel/spring/config/MyFailureProcessor.java
index 6da251b28f9..722f5added5 100644
--- a/components/camel-spring/src/test/java/org/apache/camel/spring/config/MyFailureProcessor.java
+++ b/components/camel-spring/src/test/java/org/apache/camel/spring/config/MyFailureProcessor.java
@@ -16,8 +16,8 @@
  */
 package org.apache.camel.spring.config;
 
-import org.apache.camel.Processor;
 import org.apache.camel.Exchange;
+import org.apache.camel.Processor;
 
 /**
  * For unit test.
@@ -27,5 +27,5 @@ public class MyFailureProcessor implements Processor {
     public void process(Exchange exchange) throws Exception {
         throw new IllegalArgumentException("Unit test - this is thrown by intention");
     }
-    
+
 }
