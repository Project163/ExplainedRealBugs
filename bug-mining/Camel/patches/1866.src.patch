diff --git a/components/camel-stream/src/main/java/org/apache/camel/component/stream/StreamEndpoint.java b/components/camel-stream/src/main/java/org/apache/camel/component/stream/StreamEndpoint.java
index d7dfa94dde9..0f7cbcd8e65 100644
--- a/components/camel-stream/src/main/java/org/apache/camel/component/stream/StreamEndpoint.java
+++ b/components/camel-stream/src/main/java/org/apache/camel/component/stream/StreamEndpoint.java
@@ -29,17 +29,20 @@ import org.slf4j.LoggerFactory;
 public class StreamEndpoint extends DefaultEndpoint {
     private static final transient Logger LOG = LoggerFactory.getLogger(StreamEndpoint.class);
 
+    private String url;
+
     private String fileName;
     private boolean scanStream;
     private boolean retry;
     private long scanStreamDelay;
-    private String url;
     private long delay;
     private String encoding;
     private String promptMessage;
     private long promptDelay;
     private long initialPromptDelay = 2000;
     private int groupLines;
+    private int autoCloseCount = 0;
+    
     private Charset charset;
     private GroupStrategy groupStrategy = new DefaultGroupStrategy();
 
@@ -163,6 +166,14 @@ public class StreamEndpoint extends DefaultEndpoint {
         this.groupLines = groupLines;
     }
     
+    public int getAutoCloseCount() {
+        return autoCloseCount;
+    }
+
+    public void setAutoCloseCount(int autoCloseCount) {
+        this.autoCloseCount = autoCloseCount;
+    }
+
     public Charset getCharset() {
         return charset;
     }
@@ -185,5 +196,4 @@ public class StreamEndpoint extends DefaultEndpoint {
 
         return Charset.forName(encoding);
     }
-
 }
diff --git a/components/camel-stream/src/main/java/org/apache/camel/component/stream/StreamProducer.java b/components/camel-stream/src/main/java/org/apache/camel/component/stream/StreamProducer.java
index ee34d2b7320..3a36e58a8ad 100644
--- a/components/camel-stream/src/main/java/org/apache/camel/component/stream/StreamProducer.java
+++ b/components/camel-stream/src/main/java/org/apache/camel/component/stream/StreamProducer.java
@@ -28,6 +28,7 @@ import java.net.URLConnection;
 import java.nio.charset.Charset;
 import java.util.Arrays;
 import java.util.List;
+import java.util.concurrent.atomic.AtomicInteger;
 
 import org.apache.camel.CamelExchangeException;
 import org.apache.camel.Exchange;
@@ -49,6 +50,8 @@ public class StreamProducer extends DefaultProducer {
     private static final List<String> TYPES_LIST = Arrays.asList(TYPES.split(","));
     private StreamEndpoint endpoint;
     private String uri;
+    private OutputStream outputStream;
+    private AtomicInteger count = new AtomicInteger();
 
     public StreamProducer(StreamEndpoint endpoint, String uri) throws Exception {
         super(endpoint);
@@ -56,26 +59,25 @@ public class StreamProducer extends DefaultProducer {
         validateUri(uri);
     }
 
+    @Override
+    protected void doStart() throws Exception {
+        super.doStart();
+    }
+
+    @Override
+    protected void doStop() throws Exception {
+        super.doStop();
+        closeStream(true);
+    }
+
     public void process(Exchange exchange) throws Exception {
         delay(endpoint.getDelay());
-        OutputStream outputStream = System.out;         
-        boolean isSystemStream = false;
-        if ("out".equals(uri)) {
-            isSystemStream = true;
-            outputStream = System.out;
-        } else if ("err".equals(uri)) {
-            isSystemStream = true;
-            outputStream = System.err;
-        } else if ("file".equals(uri)) {
-            outputStream = resolveStreamFromFile();
-        } else if ("header".equals(uri)) {
-            outputStream = resolveStreamFromHeader(exchange.getIn().getHeader("stream"), exchange);
-        } else if ("url".equals(uri)) {
-            outputStream = resolveStreamFromUrl();
-        }
 
-        writeToStream(outputStream, exchange);
-        closeStream(outputStream, isSystemStream);
+        synchronized(this) {
+            openStream(exchange);
+            writeToStream(outputStream, exchange);
+            closeStream(false);
+        }
     }
 
     private OutputStream resolveStreamFromUrl() throws IOException {
@@ -110,7 +112,7 @@ public class StreamProducer extends DefaultProducer {
         Thread.sleep(ms);
     }
 
-    private void writeToStream(OutputStream outputStream, Exchange exchange) throws IOException, CamelExchangeException {
+    private synchronized void writeToStream(OutputStream outputStream, Exchange exchange) throws IOException, CamelExchangeException {
         Object body = exchange.getIn().getBody();
 
         // if not a string then try as byte array first
@@ -136,10 +138,52 @@ public class StreamProducer extends DefaultProducer {
         bw.flush();
     }
 
-    private void closeStream(OutputStream outputStream, boolean isSystemStream) throws Exception {
-        // important: do not close the writer on a standard system.out etc.
-        if (outputStream != null && !isSystemStream) {
+    private synchronized void openStream() throws Exception {
+        if (outputStream != null) {
+            return;
+        }
+
+        if ("out".equals(uri)) {
+            outputStream = System.out;
+        } else if ("err".equals(uri)) {
+            outputStream = System.err;
+        } else if ("file".equals(uri)) {
+            outputStream = resolveStreamFromFile();
+        } else if ("url".equals(uri)) {
+            outputStream = resolveStreamFromUrl();
+        }
+        count.set(outputStream == null ? 0 : endpoint.getAutoCloseCount());
+        LOG.debug("Opened stream '{}'", endpoint.getEndpointKey());
+    }
+
+    private synchronized void openStream(final Exchange exchange) throws Exception {
+        if (outputStream != null) {
+            return;
+        }
+        if ("header".equals(uri)) {
+            outputStream = resolveStreamFromHeader(exchange.getIn().getHeader("stream"), exchange);
+            LOG.debug("Opened stream '{}'", endpoint.getEndpointKey());
+        } else {
+            openStream();
+        }
+    }
+
+    private synchronized void closeStream(boolean force) throws Exception {
+        if (outputStream == null) {
+            return;
+        }
+
+        // never close a standard stream (system.out or system.err)
+        // always close a 'header' stream (unless it's a system stream)
+        boolean systemStream = outputStream != System.out || outputStream != System.err;
+        boolean headerStream = "header".equals(uri) && !systemStream;
+        boolean reachedLimit = endpoint.getAutoCloseCount() > 0 && count.decrementAndGet() <= 0;
+        boolean expiredStream = force || headerStream || reachedLimit;  // evaluation order is important!
+
+        if (expiredStream) {
             outputStream.close();
+            outputStream = null;
+            LOG.debug("Closed stream '{}'", endpoint.getEndpointKey());
         }
     }
 
@@ -163,4 +207,3 @@ public class StreamProducer extends DefaultProducer {
         }
     }
 }
-
diff --git a/components/camel-stream/src/test/java/org/apache/camel/component/stream/StreamFileTest.java b/components/camel-stream/src/test/java/org/apache/camel/component/stream/StreamFileTest.java
index 7b792bda856..31d46b6bf6d 100644
--- a/components/camel-stream/src/test/java/org/apache/camel/component/stream/StreamFileTest.java
+++ b/components/camel-stream/src/test/java/org/apache/camel/component/stream/StreamFileTest.java
@@ -83,20 +83,21 @@ public class StreamFileTest extends CamelTestSupport {
     @Test
     public void testFileProducer() throws Exception {
         MockEndpoint mock = getMockEndpoint("mock:result");
-        mock.expectedBodiesReceived("Hadrian", "Camel");
+        mock.expectedMessageCount(3);
         
         context.addRoutes(new RouteBuilder() {
             @Override
             public void configure() throws Exception {
                 from("direct:start").routeId("produce")
-                    .to("stream:file?fileName=target/stream/StreamFileTest.txt");
-                from("file://target/stream?fileName=StreamFileTest.txt").routeId("consume").autoStartup(false)
+                    .to("stream:file?fileName=target/stream/StreamFileTest.txt&autoCloseCount=2");
+                from("file://target/stream?fileName=StreamFileTest.txt&noop=true").routeId("consume").autoStartup(false)
                     .split().tokenize("\n").to("mock:result");
             }
         });
         context.start();
 
         template.sendBody("direct:start", "Hadrian");
+        template.sendBody("direct:start", "Apache");
         template.sendBody("direct:start", "Camel");
         
         context.startRoute("consume");
