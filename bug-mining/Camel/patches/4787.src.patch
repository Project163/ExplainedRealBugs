diff --git a/components/camel-directvm/src/main/java/org/apache/camel/component/directvm/DirectVmProcessor.java b/components/camel-directvm/src/main/java/org/apache/camel/component/directvm/DirectVmProcessor.java
index 964f87fdfa3..6cc8c5a796a 100644
--- a/components/camel-directvm/src/main/java/org/apache/camel/component/directvm/DirectVmProcessor.java
+++ b/components/camel-directvm/src/main/java/org/apache/camel/component/directvm/DirectVmProcessor.java
@@ -88,6 +88,14 @@ public final class DirectVmProcessor extends DelegateAsyncProcessor {
         Exchange newExchange = ExchangeHelper.copyExchangeAndSetCamelContext(exchange, endpoint.getCamelContext(), false);
         // set the from endpoint
         newExchange.setFromEndpoint(endpoint);
+        // The StreamCache created by the child routes must not be 
+        // closed by the unit of work of the child route, but by the unit of 
+        // work of the parent route or grand parent route or grand grand parent route ...(in case of nesting).
+        // Set therefore the unit of work of the  parent route as stream cache unit of work, 
+        // if it is not already set.
+        if (newExchange.getProperty(Exchange.STREAM_CACHE_UNIT_OF_WORK) == null) {
+            newExchange.setProperty(Exchange.STREAM_CACHE_UNIT_OF_WORK, exchange.getUnitOfWork());
+        }
         return newExchange;
     }
 
diff --git a/core/camel-core/src/test/java/org/apache/camel/processor/StreamCachingInOutTest.java b/core/camel-core/src/test/java/org/apache/camel/processor/StreamCachingInOutTest.java
index 36adc4d7cc1..78caf8a3321 100644
--- a/core/camel-core/src/test/java/org/apache/camel/processor/StreamCachingInOutTest.java
+++ b/core/camel-core/src/test/java/org/apache/camel/processor/StreamCachingInOutTest.java
@@ -40,13 +40,28 @@ public class StreamCachingInOutTest extends ContextTestSupport {
         assertEquals(c.assertExchangeReceived(0).getIn().getBody(String.class), "James,Guillaume,Hiram,Rob,Roman");
     }
 
+    @Test
+    public void testStreamCachingPerRouteWithDirecVM() throws Exception {
+        MockEndpoint e = getMockEndpoint("mock:e");
+        e.expectedMessageCount(1);
+
+        InputStream message = getTestFileStream();
+        template.sendBody("direct:e", message);
+
+        assertMockEndpointsSatisfied();
+        assertEquals(e.assertExchangeReceived(0).getIn().getBody(String.class), "James,Guillaume,Hiram,Rob,Roman");
+    }
+
     @Override
     protected RouteBuilder createRouteBuilder() throws Exception {
         return new RouteBuilder() {
             @Override
             public void configure() throws Exception {
-                from("direct:c").noStreamCaching().to("direct:d").to("mock:c");
+                context.getStreamCachingStrategy().setSpoolThreshold(1);
+                from("direct:c").noStreamCaching().to("direct:d").convertBodyTo(String.class).to("mock:c");
                 from("direct:d").streamCaching().process(new TestProcessor());
+                from("direct:e").noStreamCaching().to("direct-vm:f").convertBodyTo(String.class).to("mock:e");
+                from("direct-vm:f").streamCaching().process(new TestProcessor());
             }
         };
     }
