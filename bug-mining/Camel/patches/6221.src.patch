diff --git a/dsl/camel-jbang/camel-jbang-core/src/main/java/org/apache/camel/dsl/jbang/core/commands/ExportBaseCommand.java b/dsl/camel-jbang/camel-jbang-core/src/main/java/org/apache/camel/dsl/jbang/core/commands/ExportBaseCommand.java
index ac841439c4d..6d5a1db382d 100644
--- a/dsl/camel-jbang/camel-jbang-core/src/main/java/org/apache/camel/dsl/jbang/core/commands/ExportBaseCommand.java
+++ b/dsl/camel-jbang/camel-jbang-core/src/main/java/org/apache/camel/dsl/jbang/core/commands/ExportBaseCommand.java
@@ -146,6 +146,8 @@ abstract class ExportBaseCommand extends CamelCommand {
 
     protected Integer runSilently() throws Exception {
         Run run = new Run(getMain());
+        // need to declare the profile to use for run
+        run.profile = profile;
         Integer code = run.runSilent();
         return code;
     }
diff --git a/dsl/camel-jbang/camel-jbang-core/src/main/java/org/apache/camel/dsl/jbang/core/commands/Run.java b/dsl/camel-jbang/camel-jbang-core/src/main/java/org/apache/camel/dsl/jbang/core/commands/Run.java
index ee35e34fe5d..137b308fc84 100644
--- a/dsl/camel-jbang/camel-jbang-core/src/main/java/org/apache/camel/dsl/jbang/core/commands/Run.java
+++ b/dsl/camel-jbang/camel-jbang-core/src/main/java/org/apache/camel/dsl/jbang/core/commands/Run.java
@@ -111,7 +111,7 @@ class Run extends CamelCommand {
     String repos;
 
     @Option(names = { "--fresh" }, description = "Make sure we use fresh (i.e. non-cached) resources")
-    private boolean fresh;
+    boolean fresh;
 
     @Option(names = {"--download"}, defaultValue = "true", description = "Whether to allow automatic downloaded JAR dependencies, over the internet, that Camel requires.")
     boolean download = true;
diff --git a/dsl/camel-kamelet-main/src/main/java/org/apache/camel/main/KameletMain.java b/dsl/camel-kamelet-main/src/main/java/org/apache/camel/main/KameletMain.java
index 75fe7e2beed..6752b76fba5 100644
--- a/dsl/camel-kamelet-main/src/main/java/org/apache/camel/main/KameletMain.java
+++ b/dsl/camel-kamelet-main/src/main/java/org/apache/camel/main/KameletMain.java
@@ -344,11 +344,6 @@ public class KameletMain extends MainCommandLineSupport {
         }
 
         try {
-            // properties functions
-            org.apache.camel.component.properties.PropertiesComponent pc
-                    = (org.apache.camel.component.properties.PropertiesComponent) answer.getPropertiesComponent();
-            pc.setPropertiesFunctionResolver(new DependencyDownloaderPropertiesFunctionResolver(answer));
-
             // dependencies from CLI
             Object dependencies = getInitialProperties().get("camel.jbang.dependencies");
             if (dependencies != null) {
@@ -376,6 +371,18 @@ public class KameletMain extends MainCommandLineSupport {
         return answer;
     }
 
+    @Override
+    protected void configurePropertiesService(CamelContext camelContext) throws Exception {
+        super.configurePropertiesService(camelContext);
+
+        // properties functions, which can download
+        if (download) {
+            org.apache.camel.component.properties.PropertiesComponent pc
+                    = (org.apache.camel.component.properties.PropertiesComponent) camelContext.getPropertiesComponent();
+            pc.setPropertiesFunctionResolver(new DependencyDownloaderPropertiesFunctionResolver(camelContext));
+        }
+    }
+
     @Override
     protected void autoconfigure(CamelContext camelContext) throws Exception {
         // create classloader that may include additional JARs
