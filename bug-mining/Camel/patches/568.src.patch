diff --git a/components/camel-csv/src/main/java/org/apache/camel/dataformat/csv/CsvDataFormat.java b/components/camel-csv/src/main/java/org/apache/camel/dataformat/csv/CsvDataFormat.java
index fbc0a80cda1..dd93e7f59f0 100644
--- a/components/camel-csv/src/main/java/org/apache/camel/dataformat/csv/CsvDataFormat.java
+++ b/components/camel-csv/src/main/java/org/apache/camel/dataformat/csv/CsvDataFormat.java
@@ -29,6 +29,7 @@ import java.util.Set;
 import org.apache.camel.Exchange;
 import org.apache.camel.spi.DataFormat;
 import org.apache.camel.util.ExchangeHelper;
+import org.apache.camel.util.ObjectHelper;
 import org.apache.commons.csv.CSVParser;
 import org.apache.commons.csv.CSVStrategy;
 import org.apache.commons.csv.writer.CSVConfig;
@@ -36,27 +37,33 @@ import org.apache.commons.csv.writer.CSVField;
 import org.apache.commons.csv.writer.CSVWriter;
 
 /**
+ * CSV Data format.
+ * <p/>
+ * By default, columns are autogenerated in the resulting CSV. Subsequent
+ * messages use the previously created columns with new fields being added at
+ * the end of the line. Thus, field order is the same from message to message.
+ * Autogeneration can be disabled. In this case, only the fields defined in
+ * csvConfig are written on the output.
+ *
  * @version $Revision$
  */
 public class CsvDataFormat implements DataFormat {
     private CSVStrategy strategy = CSVStrategy.DEFAULT_STRATEGY;
     private CSVConfig config = new CSVConfig();
+    private boolean autogenColumns = true;
 
     public void marshal(Exchange exchange, Object object, OutputStream outputStream) throws Exception {
+        ObjectHelper.notNull(config, "config");
+
         Map map = ExchangeHelper.convertToMandatoryType(exchange, Map.class, object);
         OutputStreamWriter out = new OutputStreamWriter(outputStream);
         try {
-            CSVConfig conf = getConfig();
-            // lets add fields
-            Set set = map.keySet();
-            for (Object value : set) {
-                if (value != null) {
-                    String text = value.toString();
-                    CSVField field = new CSVField(text);
-                    conf.addField(field);
-                }
+            if (autogenColumns) {
+                // no specific config has been set so lets add fields
+                Set set = map.keySet();
+                updateFieldsInConfig(set, exchange);
             }
-            CSVWriter writer = new CSVWriter(conf);
+            CSVWriter writer = new CSVWriter(config);
             writer.setWriter(out);
             writer.writeRecord(map);
         } finally {
@@ -87,13 +94,6 @@ public class CsvDataFormat implements DataFormat {
         }
     }
 
-    public CSVConfig getConfig() {
-        if (config == null) {
-            config = createConfig();
-        }
-        return config;
-    }
-
     public void setConfig(CSVConfig config) {
         this.config = config;
     }
@@ -106,7 +106,34 @@ public class CsvDataFormat implements DataFormat {
         this.strategy = strategy;
     }
 
+    public boolean isAutogenColumns() {
+        return autogenColumns;
+    }
+
+    /**
+     * Auto generate columns.
+     *
+     * @param autogenColumns set to false to disallow column autogeneration (default true)
+     */
+    public void setAutogenColumns(boolean autogenColumns) {
+        this.autogenColumns = autogenColumns;
+    }
+
     protected CSVConfig createConfig() {
         return new CSVConfig();
     }
+
+    private synchronized void updateFieldsInConfig(Set set, Exchange exchange) {
+        for (Object value : set) {
+            if (value != null) {
+                String text = exchange.getContext().getTypeConverter().convertTo(String.class, value);
+                // do not add field twice
+                if (config.getField(text) == null) {
+                    CSVField field = new CSVField(text);
+                    config.addField(field);
+                }
+            }
+        }
+    }
+
 }
diff --git a/components/camel-csv/src/test/java/org/apache/camel/dataformat/csv/CsvRouteTest.java b/components/camel-csv/src/test/java/org/apache/camel/dataformat/csv/CsvRouteTest.java
index 8c06b3677ac..dfe12c53a2b 100644
--- a/components/camel-csv/src/test/java/org/apache/camel/dataformat/csv/CsvRouteTest.java
+++ b/components/camel-csv/src/test/java/org/apache/camel/dataformat/csv/CsvRouteTest.java
@@ -36,11 +36,14 @@ import java.util.HashMap;
 import java.util.List;
 import java.util.Map;
 
+import java.util.regex.Pattern;
 import org.apache.camel.ContextTestSupport;
 import org.apache.camel.Exchange;
 import org.apache.camel.Message;
 import org.apache.camel.builder.RouteBuilder;
 import org.apache.camel.component.mock.MockEndpoint;
+import org.apache.commons.csv.writer.CSVConfig;
+import org.apache.commons.csv.writer.CSVField;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 
@@ -77,6 +80,80 @@ public class CsvRouteTest extends ContextTestSupport {
         }
     }
 
+    public void testMultipleMessages() throws Exception {
+        MockEndpoint resultEndpoint = resolveMandatoryEndpoint("mock:resultMulti",
+                                                               MockEndpoint.class);
+        resultEndpoint.expectedMessageCount(2);
+        Map body1 = new HashMap();
+        body1.put("foo", "abc");
+        body1.put("bar", 123);
+
+        Map body2 = new HashMap();
+        body2.put("foo", "def");
+        body2.put("bar", 456);
+        body2.put("baz", 789);
+
+        template.sendBody("direct:startMulti", body1);
+        template.sendBody("direct:startMulti", body2);
+
+        resultEndpoint.assertIsSatisfied();
+        List<Exchange> list = resultEndpoint.getReceivedExchanges();
+        Message in1 = list.get(0).getIn();
+        String text1 = in1.getBody(String.class);
+
+        log.debug("Received " + text1);
+        assertTrue("First CSV body has wrong value",
+                   Pattern.matches("(abc,123)|(123,abc)", text1.trim()));
+
+        Message in2 = list.get(1).getIn();
+        String text2 = in2.getBody(String.class);
+
+        log.debug("Received " + text2);
+
+        // fields should keep the same order from one call to the other
+        if (text1.trim().equals("abc,123")) {
+            assertEquals("Second CSV body has wrong value",
+                         "def,456,789", text2.trim());
+        } else {
+            assertEquals("Second CSV body has wrong value",
+                         "456,def,789", text2.trim());
+        }
+    }
+
+    public void testPresetConfig() throws Exception {
+        MockEndpoint resultEndpoint = resolveMandatoryEndpoint("mock:resultMultiCustom",
+                                                               MockEndpoint.class);
+        resultEndpoint.expectedMessageCount(2);
+        Map body1 = new HashMap();
+        body1.put("foo", "abc");
+        body1.put("bar", 123);
+
+        Map body2 = new HashMap();
+        body2.put("foo", "def");
+        body2.put("bar", 456);
+        body2.put("baz", 789);
+        body2.put("buz", "000");
+
+        template.sendBody("direct:startMultiCustom", body1);
+        template.sendBody("direct:startMultiCustom", body2);
+
+        List<Exchange> list = resultEndpoint.getReceivedExchanges();
+        Message in1 = list.get(0).getIn();
+        String text1 = in1.getBody(String.class);
+
+        log.debug("Received " + text1);
+        assertEquals("First CSV body has wrong value",
+                     "abc;;123", text1.trim());
+
+        Message in2 = list.get(1).getIn();
+        String text2 = in2.getBody(String.class);
+
+        log.debug("Received " + text2);
+        assertEquals("Second CSV body has wrong value",
+                     "def;789;456", text2.trim());
+
+    }
+
     public void testUnMarshal() throws Exception {
         MockEndpoint endpoint = getMockEndpoint("mock:daltons");
         endpoint.expectedMessageCount(1);
@@ -100,6 +177,23 @@ public class CsvRouteTest extends ContextTestSupport {
                     to("mock:result");
                 // END SNIPPET: marshalRoute
 
+                from("direct:startMulti").
+                    marshal().csv().
+                    to("mock:resultMulti");
+
+                CsvDataFormat customCsv = new CsvDataFormat();
+                CSVConfig custom = new CSVConfig();
+                custom.setDelimiter(';');
+                custom.addField(new CSVField("foo"));
+                custom.addField(new CSVField("baz"));
+                custom.addField(new CSVField("bar"));
+                customCsv.setConfig(custom);
+                customCsv.setAutogenColumns(false);
+
+                from("direct:startMultiCustom").
+                    marshal(customCsv).
+                    to("mock:resultMultiCustom");
+
                 // START SNIPPET: unmarshalRoute
                 from("file:src/test/resources/?fileName=daltons.csv&noop=true").
                     unmarshal().csv().
