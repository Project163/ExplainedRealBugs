diff --git a/components/camel-file/src/main/java/org/apache/camel/component/file/FileSendDynamicAware.java b/components/camel-file/src/main/java/org/apache/camel/component/file/FileSendDynamicAware.java
index 0bbc97eb27b..837fef3bba8 100644
--- a/components/camel-file/src/main/java/org/apache/camel/component/file/FileSendDynamicAware.java
+++ b/components/camel-file/src/main/java/org/apache/camel/component/file/FileSendDynamicAware.java
@@ -16,91 +16,8 @@
  */
 package org.apache.camel.component.file;
 
-import java.util.LinkedHashMap;
-import java.util.Map;
-
-import org.apache.camel.Exchange;
-import org.apache.camel.Processor;
-import org.apache.camel.runtimecatalog.RuntimeCamelCatalog;
-import org.apache.camel.spi.SendDynamicAware;
 import org.apache.camel.spi.annotations.SendDynamic;
-import org.apache.camel.util.URISupport;
 
 @SendDynamic("file")
-public class FileSendDynamicAware implements SendDynamicAware {
-
-    private String scheme;
-
-    @Override
-    public void setScheme(String scheme) {
-        this.scheme = scheme;
-    }
-
-    @Override
-    public String getScheme() {
-        return scheme;
-    }
-
-    @Override
-    public DynamicAwareEntry prepare(Exchange exchange, String uri, String originalUri) throws Exception {
-        RuntimeCamelCatalog catalog = exchange.getContext().getExtension(RuntimeCamelCatalog.class);
-        Map<String, String> properties = catalog.endpointProperties(uri);
-        Map<String, String> lenient = catalog.endpointLenientProperties(uri);
-        return new DynamicAwareEntry(uri, originalUri, properties, lenient);
-    }
-
-    @Override
-    public String resolveStaticUri(Exchange exchange, DynamicAwareEntry entry) throws Exception {
-        boolean move = entry.getProperties().containsKey("move");
-        boolean moveFailed = entry.getProperties().containsKey("moveFailed");
-        boolean preMove = entry.getProperties().containsKey("preMove");
-        boolean moveExisting = entry.getProperties().containsKey("moveExisting");
-        // if any of the above are in use, then they should not be pre evaluated
-        // and we need to rebuild a new uri with them as-is
-        if (move || moveFailed || preMove || moveExisting) {
-            Map<String, String> params = new LinkedHashMap<>(entry.getProperties());
-
-            Map<String, Object> originalParams = URISupport.parseQuery(entry.getOriginalUri());
-            if (move) {
-                Object val = originalParams.get("move");
-                if (val != null) {
-                    params.put("move", val.toString());
-                }
-            }
-            if (moveFailed) {
-                Object val = originalParams.get("moveFailed");
-                if (val != null) {
-                    params.put("moveFailed", val.toString());
-                }
-            }
-            if (preMove) {
-                Object val = originalParams.get("preMove");
-                if (val != null) {
-                    params.put("preMove", val.toString());
-                }
-            }
-            if (moveExisting) {
-                Object val = originalParams.get("moveExisting");
-                if (val != null) {
-                    params.put("moveExisting", val.toString());
-                }
-            }
-
-            RuntimeCamelCatalog catalog = exchange.getContext().getExtension(RuntimeCamelCatalog.class);
-            String newUri = catalog.asEndpointUri(scheme, params, false);
-            return newUri;
-        } else {
-            return entry.getUri();
-        }
-    }
-
-    @Override
-    public Processor createPreProcessor(Exchange exchange, DynamicAwareEntry entry) throws Exception {
-        return null;
-    }
-
-    @Override
-    public Processor createPostProcessor(Exchange exchange, DynamicAwareEntry entry) throws Exception {
-        return null;
-    }
+public class FileSendDynamicAware extends GenericFileSendDynamicAware {
 }
diff --git a/components/camel-file/src/main/java/org/apache/camel/component/file/GenericFileSendDynamicAware.java b/components/camel-file/src/main/java/org/apache/camel/component/file/GenericFileSendDynamicAware.java
new file mode 100644
index 00000000000..2d5474573b3
--- /dev/null
+++ b/components/camel-file/src/main/java/org/apache/camel/component/file/GenericFileSendDynamicAware.java
@@ -0,0 +1,103 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.camel.component.file;
+
+import java.util.LinkedHashMap;
+import java.util.Map;
+
+import org.apache.camel.Exchange;
+import org.apache.camel.Processor;
+import org.apache.camel.runtimecatalog.RuntimeCamelCatalog;
+import org.apache.camel.spi.SendDynamicAware;
+import org.apache.camel.util.URISupport;
+
+public abstract class GenericFileSendDynamicAware implements SendDynamicAware {
+
+    private String scheme;
+
+    @Override
+    public void setScheme(String scheme) {
+        this.scheme = scheme;
+    }
+
+    @Override
+    public String getScheme() {
+        return scheme;
+    }
+
+    @Override
+    public DynamicAwareEntry prepare(Exchange exchange, String uri, String originalUri) throws Exception {
+        RuntimeCamelCatalog catalog = exchange.getContext().getExtension(RuntimeCamelCatalog.class);
+        Map<String, String> properties = catalog.endpointProperties(uri);
+        Map<String, String> lenient = catalog.endpointLenientProperties(uri);
+        return new DynamicAwareEntry(uri, originalUri, properties, lenient);
+    }
+
+    @Override
+    public String resolveStaticUri(Exchange exchange, DynamicAwareEntry entry) throws Exception {
+        boolean move = entry.getProperties().containsKey("move");
+        boolean moveFailed = entry.getProperties().containsKey("moveFailed");
+        boolean preMove = entry.getProperties().containsKey("preMove");
+        boolean moveExisting = entry.getProperties().containsKey("moveExisting");
+        // if any of the above are in use, then they should not be pre evaluated
+        // and we need to rebuild a new uri with them as-is
+        if (move || moveFailed || preMove || moveExisting) {
+            Map<String, String> params = new LinkedHashMap<>(entry.getProperties());
+
+            Map<String, Object> originalParams = URISupport.parseQuery(entry.getOriginalUri());
+            if (move) {
+                Object val = originalParams.get("move");
+                if (val != null) {
+                    params.put("move", val.toString());
+                }
+            }
+            if (moveFailed) {
+                Object val = originalParams.get("moveFailed");
+                if (val != null) {
+                    params.put("moveFailed", val.toString());
+                }
+            }
+            if (preMove) {
+                Object val = originalParams.get("preMove");
+                if (val != null) {
+                    params.put("preMove", val.toString());
+                }
+            }
+            if (moveExisting) {
+                Object val = originalParams.get("moveExisting");
+                if (val != null) {
+                    params.put("moveExisting", val.toString());
+                }
+            }
+
+            RuntimeCamelCatalog catalog = exchange.getContext().getExtension(RuntimeCamelCatalog.class);
+            return catalog.asEndpointUri(scheme, params, false);
+        } else {
+            return entry.getUri();
+        }
+    }
+
+    @Override
+    public Processor createPreProcessor(Exchange exchange, DynamicAwareEntry entry) throws Exception {
+        return null;
+    }
+
+    @Override
+    public Processor createPostProcessor(Exchange exchange, DynamicAwareEntry entry) throws Exception {
+        return null;
+    }
+}
diff --git a/components/camel-ftp/src/main/java/org/apache/camel/component/file/remote/FtpSendDynamicAware.java b/components/camel-ftp/src/main/java/org/apache/camel/component/file/remote/FtpSendDynamicAware.java
new file mode 100644
index 00000000000..7d20b29035c
--- /dev/null
+++ b/components/camel-ftp/src/main/java/org/apache/camel/component/file/remote/FtpSendDynamicAware.java
@@ -0,0 +1,24 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.camel.component.file.remote;
+
+import org.apache.camel.component.file.GenericFileSendDynamicAware;
+import org.apache.camel.spi.annotations.SendDynamic;
+
+@SendDynamic("ftp")
+public class FtpSendDynamicAware extends GenericFileSendDynamicAware {
+}
diff --git a/components/camel-ftp/src/main/java/org/apache/camel/component/file/remote/FtpsSendDynamicAware.java b/components/camel-ftp/src/main/java/org/apache/camel/component/file/remote/FtpsSendDynamicAware.java
new file mode 100644
index 00000000000..9dcf64e559b
--- /dev/null
+++ b/components/camel-ftp/src/main/java/org/apache/camel/component/file/remote/FtpsSendDynamicAware.java
@@ -0,0 +1,24 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.camel.component.file.remote;
+
+import org.apache.camel.component.file.GenericFileSendDynamicAware;
+import org.apache.camel.spi.annotations.SendDynamic;
+
+@SendDynamic("ftps")
+public class FtpsSendDynamicAware extends GenericFileSendDynamicAware {
+}
diff --git a/components/camel-ftp/src/main/java/org/apache/camel/component/file/remote/SftpSendDynamicAware.java b/components/camel-ftp/src/main/java/org/apache/camel/component/file/remote/SftpSendDynamicAware.java
new file mode 100644
index 00000000000..82a6e31a187
--- /dev/null
+++ b/components/camel-ftp/src/main/java/org/apache/camel/component/file/remote/SftpSendDynamicAware.java
@@ -0,0 +1,24 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.camel.component.file.remote;
+
+import org.apache.camel.component.file.GenericFileSendDynamicAware;
+import org.apache.camel.spi.annotations.SendDynamic;
+
+@SendDynamic("sftp")
+public class SftpSendDynamicAware extends GenericFileSendDynamicAware {
+}
diff --git a/components/camel-ftp/src/test/java/org/apache/camel/component/file/remote/FtpProducerToDMoveExistingTest.java b/components/camel-ftp/src/test/java/org/apache/camel/component/file/remote/FtpProducerToDMoveExistingTest.java
new file mode 100644
index 00000000000..a3f1597c471
--- /dev/null
+++ b/components/camel-ftp/src/test/java/org/apache/camel/component/file/remote/FtpProducerToDMoveExistingTest.java
@@ -0,0 +1,64 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.camel.component.file.remote;
+
+import java.util.HashMap;
+import java.util.Map;
+
+import org.apache.camel.Exchange;
+import org.apache.camel.builder.RouteBuilder;
+import org.junit.Test;
+
+/**
+ *
+ */
+public class FtpProducerToDMoveExistingTest extends FtpServerTestSupport {
+
+    private String getFtpUrl() {
+        return "ftp://admin@localhost:" + getPort() + "/${header.myDir}?password=admin&fileExist=Move&moveExisting=old-${file:onlyname}";
+    }
+
+    @Test
+    public void testMoveExisting() throws Exception {
+        getMockEndpoint("mock:result").expectedMessageCount(2);
+
+        Map<String, Object> headers = new HashMap<>();
+        headers.put("myDir", "out");
+        headers.put(Exchange.FILE_NAME, "hello.txt");
+        template.sendBodyAndHeaders("direct:start", "Hello World", headers);
+        template.sendBodyAndHeaders("direct:start", "Bye World", headers);
+
+        assertMockEndpointsSatisfied();
+
+        assertFileExists(FTP_ROOT_DIR + "/out/old-hello.txt");
+        assertFileExists(FTP_ROOT_DIR + "/out/hello.txt");
+    }
+
+    @Override
+    protected RouteBuilder createRouteBuilder() throws Exception {
+        return new RouteBuilder() {
+            @Override
+            public void configure() throws Exception {
+                from("direct:start")
+                    .toD(getFtpUrl())
+                    .to("mock:result");
+            }
+        };
+    }
+
+
+}
diff --git a/components/camel-test/src/main/java/org/apache/camel/test/junit4/TestSupport.java b/components/camel-test/src/main/java/org/apache/camel/test/junit4/TestSupport.java
index 2b7a0d622ea..bdf360be75c 100644
--- a/components/camel-test/src/main/java/org/apache/camel/test/junit4/TestSupport.java
+++ b/components/camel-test/src/main/java/org/apache/camel/test/junit4/TestSupport.java
@@ -424,6 +424,7 @@ public abstract class TestSupport extends Assert {
     public static void assertFileExists(String filename) {
         File file = new File(filename);
         assertTrue("File " + filename + " should exist", file.exists());
+        assertTrue("File " + filename + " should be a file", file.isFile());
     }
 
     /**
diff --git a/core/camel-core/src/test/java/org/apache/camel/component/file/FileProducerToDMoveExistingTest.java b/core/camel-core/src/test/java/org/apache/camel/component/file/FileProducerToDMoveExistingTest.java
index 972b3129b77..cb66d3aae25 100644
--- a/core/camel-core/src/test/java/org/apache/camel/component/file/FileProducerToDMoveExistingTest.java
+++ b/core/camel-core/src/test/java/org/apache/camel/component/file/FileProducerToDMoveExistingTest.java
@@ -44,9 +44,8 @@ public class FileProducerToDMoveExistingTest extends ContextTestSupport {
 
         assertMockEndpointsSatisfied();
 
-        Thread.sleep(100);
-
         assertFileExists("target/out/old-hello.txt");
+        assertFileExists("target/out/hello.txt");
     }
 
     @Override
