diff --git a/components/camel-xmpp/pom.xml b/components/camel-xmpp/pom.xml
index 4b91633f25b..6d580ac6f70 100644
--- a/components/camel-xmpp/pom.xml
+++ b/components/camel-xmpp/pom.xml
@@ -93,6 +93,11 @@
       <artifactId>junit</artifactId>
       <scope>test</scope>
     </dependency>
+    <dependency>
+      <groupId>log4j</groupId>
+      <artifactId>log4j</artifactId>
+      <scope>test</scope>
+    </dependency>
   </dependencies>
 
   <build>
diff --git a/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/RuntimeXmppException.java b/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/RuntimeXmppException.java
deleted file mode 100644
index f55f0ebdd32..00000000000
--- a/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/RuntimeXmppException.java
+++ /dev/null
@@ -1,37 +0,0 @@
-/**
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.camel.component.xmpp;
-
-import org.apache.camel.RuntimeCamelException;
-import org.jivesoftware.smack.XMPPException;
-
-/**
- * A runtime exception thrown if sending or receiving from XMPP fails
- *
- * @version $Revision:520964 $
- */
-public class RuntimeXmppException extends RuntimeCamelException {
-
-    public RuntimeXmppException(XMPPException cause) {
-        super(cause);
-    }
-
-    public RuntimeXmppException(String message, XMPPException cause) {
-        super(message, cause);
-    }
-
-}
diff --git a/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppConsumer.java b/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppConsumer.java
index 0744cd9df44..afee6c7479e 100644
--- a/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppConsumer.java
+++ b/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppConsumer.java
@@ -24,6 +24,7 @@ import org.jivesoftware.smack.Chat;
 import org.jivesoftware.smack.MessageListener;
 import org.jivesoftware.smack.PacketListener;
 import org.jivesoftware.smack.SmackConfiguration;
+import org.jivesoftware.smack.XMPPConnection;
 import org.jivesoftware.smack.packet.Message;
 import org.jivesoftware.smack.packet.Packet;
 import org.jivesoftware.smackx.muc.DiscussionHistory;
@@ -37,8 +38,8 @@ import org.jivesoftware.smackx.muc.MultiUserChat;
 public class XmppConsumer extends DefaultConsumer implements PacketListener, MessageListener {
     private static final transient Log LOG = LogFactory.getLog(XmppConsumer.class);
     private final XmppEndpoint endpoint;
-    private Chat privateChat;
     private MultiUserChat muc;
+    private XMPPConnection connection;
 
     public XmppConsumer(XmppEndpoint endpoint, Processor processor) {
         super(endpoint, processor);
@@ -47,17 +48,25 @@ public class XmppConsumer extends DefaultConsumer implements PacketListener, Mes
 
     @Override
     protected void doStart() throws Exception {
+        connection = endpoint.createConnection();
+
         if (endpoint.getRoom() == null) {
-            privateChat = endpoint.getConnection().getChatManager().createChat(endpoint.getParticipant(), this);
-            LOG.info("Open chat to " + privateChat.getParticipant());
+            Chat privateChat = connection.getChatManager().createChat(endpoint.getParticipant(), this);
+            if (LOG.isInfoEnabled()) {
+                LOG.info("Open private chat to: " + privateChat.getParticipant());
+            }
         } else {
-            muc = new MultiUserChat(endpoint.getConnection(), endpoint.resolveRoom());
+            muc = new MultiUserChat(connection, endpoint.resolveRoom(connection));
             muc.addMessageListener(this);
             DiscussionHistory history = new DiscussionHistory();
             history.setMaxChars(0); // we do not want any historical messages
+
             muc.join(endpoint.getNickname(), null, history, SmackConfiguration.getPacketReplyTimeout());
-            LOG.info("Joined room: " + muc.getRoom());
+            if (LOG.isInfoEnabled()) {
+                LOG.info("Joined room: " + muc.getRoom() + " as: " + endpoint.getNickname());
+            }
         }
+
         super.doStart();
     }
 
@@ -65,9 +74,20 @@ public class XmppConsumer extends DefaultConsumer implements PacketListener, Mes
     protected void doStop() throws Exception {
         super.doStop();
         if (muc != null) {
+            if (LOG.isInfoEnabled()) {
+                LOG.info("Leaving room: " + muc.getRoom());
+            }
+            muc.removeMessageListener(this);
             muc.leave();
             muc = null;
         }
+        if (connection != null) {
+            if (LOG.isDebugEnabled()) {
+                LOG.debug("Disconnecting from: " + XmppEndpoint.getConnectionMessage(connection));
+            }
+            connection.disconnect();
+            connection = null;
+        }
     }
 
     public void processPacket(Packet packet) {
@@ -81,7 +101,7 @@ public class XmppConsumer extends DefaultConsumer implements PacketListener, Mes
         try {
             getProcessor().process(exchange);
         } catch (Exception e) {
-            LOG.error("Error while processing message", e);
+            LOG.error("Error while processing XMPP message", e);
         }
     }
 
diff --git a/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppEndpoint.java b/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppEndpoint.java
index afb9b3ec0c0..f4f97f7cfd9 100644
--- a/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppEndpoint.java
+++ b/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppEndpoint.java
@@ -27,6 +27,7 @@ import org.apache.camel.Producer;
 import org.apache.camel.impl.DefaultEndpoint;
 import org.apache.camel.impl.DefaultHeaderFilterStrategy;
 import org.apache.camel.spi.HeaderFilterStrategy;
+import org.apache.camel.util.ObjectHelper;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.jivesoftware.smack.AccountManager;
@@ -45,7 +46,6 @@ public class XmppEndpoint extends DefaultEndpoint implements HeaderFilterStrateg
     private static final transient Log LOG = LogFactory.getLog(XmppEndpoint.class);
     private HeaderFilterStrategy headerFilterStrategy = new DefaultHeaderFilterStrategy();
     private XmppBinding binding;
-    private XMPPConnection connection;
     private String host;
     private int port;
     private String user;
@@ -110,6 +110,80 @@ public class XmppEndpoint extends DefaultEndpoint implements HeaderFilterStrateg
         return true;
     }
     
+    public XMPPConnection createConnection() throws XMPPException {
+        XMPPConnection connection;
+
+        if (port > 0) {
+            if (getServiceName() == null) {
+                connection = new XMPPConnection(new ConnectionConfiguration(host, port));
+            } else {
+                connection = new XMPPConnection(new ConnectionConfiguration(host, port, getServiceName()));
+            }
+        } else {
+            connection = new XMPPConnection(host);
+        }
+
+        connection.connect();
+
+        if (login && !connection.isAuthenticated()) {
+            if (user != null) {
+                if (LOG.isDebugEnabled()) {
+                    LOG.debug("Logging in to XMPP as user: " + user + " on connection: " + getConnectionMessage(connection));
+                }
+                if (password == null) {
+                    LOG.warn("No password configured for user: " + user + " on connection: " + getConnectionMessage(connection));
+                }
+
+                if (createAccount) {
+                    AccountManager accountManager = new AccountManager(connection);
+                    accountManager.createAccount(user, password);
+                }
+                if (resource != null) {
+                    connection.login(user, password, resource);
+                } else {
+                    connection.login(user, password);
+                }
+            } else {
+                if (LOG.isDebugEnabled()) {
+                    LOG.debug("Logging in anonymously to XMPP on connection: "  + getConnectionMessage(connection));
+                }
+                connection.loginAnonymously();
+            }
+
+            // presence is not needed to be sent after login
+        }
+
+        return connection;
+    }
+
+    /*
+     * If there is no "@" symbol in the room, find the chat service JID and
+     * return fully qualified JID for the room as room@conference.server.domain
+     */
+    public String resolveRoom(XMPPConnection connection) throws XMPPException {
+        ObjectHelper.notEmpty(room, "room");
+
+        if (room.indexOf('@', 0) != -1) {
+            return room;
+        }
+
+        Iterator<String> iterator = MultiUserChat.getServiceNames(connection).iterator();
+        if (!iterator.hasNext()) {
+            throw new XMPPException("Cannot find Multi User Chat service on connection: " + getConnectionMessage(connection));
+        }
+
+        String chatServer = iterator.next();
+        if (LOG.isDebugEnabled()) {
+            LOG.debug("Detected chat server: " + chatServer);
+        }
+
+        return room + "@" + chatServer;
+    }
+
+    public static String getConnectionMessage(XMPPConnection connetion) {
+        return connetion.getHost() + ":" + connetion.getPort() + "/" + connetion.getServiceName();
+    }
+
     // Properties
     // -------------------------------------------------------------------------
     public XmppBinding getBinding() {
@@ -215,17 +289,6 @@ public class XmppEndpoint extends DefaultEndpoint implements HeaderFilterStrateg
         return serviceName;
     }    
     
-    public XMPPConnection getConnection() throws XMPPException {
-        if (connection == null) {
-            connection = createConnection();
-        }
-        return connection;
-    }
-
-    public void setConnection(XMPPConnection connection) {
-        this.connection = connection;
-    }
-
     public HeaderFilterStrategy getHeaderFilterStrategy() {
         return headerFilterStrategy;
     }
@@ -236,69 +299,5 @@ public class XmppEndpoint extends DefaultEndpoint implements HeaderFilterStrateg
 
     // Implementation methods
     // -------------------------------------------------------------------------
-    protected XMPPConnection createConnection() throws XMPPException {
-        XMPPConnection connection;
-        if (port > 0) {            
-            if (getServiceName() == null) {
-                connection = new XMPPConnection(new ConnectionConfiguration(host, port));
-            } else {
-                connection = new XMPPConnection(new ConnectionConfiguration(host, port, getServiceName()));
-            }
-        } else {
-            connection = new XMPPConnection(host);
-        }
-
-        connection.connect();
-
-        if (login && !connection.isAuthenticated()) {
-            if (user != null) {
-                LOG.info("Logging in to XMPP as user: " + user + " on connection: " + connection);
-                if (password == null) {
-                    LOG.warn("No password configured for user: " + user);
-                }
-
-                if (createAccount) {
-                    AccountManager accountManager = new AccountManager(connection);
-                    accountManager.createAccount(user, password);
-                }
-                if (resource != null) {
-                    connection.login(user, password, resource);
-                } else {
-                    connection.login(user, password);
-                }
-            } else {
-                LOG.info("Logging in anonymously to XMPP on connection: " + connection);
-                connection.loginAnonymously();
-            }
-
-            // presence is not needed to be sent after login
-        }
-
-        return connection;
-    }
-
-    /*
-     * If there is no "@" symbol in the room, find the chat service JID and
-     * return fully qualified JID for the room as room@conference.server.domain
-     */
-    public String resolveRoom() throws XMPPException {
-        if (room == null) {
-            throw new IllegalArgumentException("room is not specified");
-        }
-
-        if (room.indexOf('@', 0) != -1) {
-            return room;
-        }
-
-        XMPPConnection conn = getConnection();
-        Iterator<String> iterator = MultiUserChat.getServiceNames(conn).iterator();
-        if (!iterator.hasNext()) {
-            throw new XMPPException("Cannot find Multi User Chat service");
-        }
-        String chatServer = iterator.next();
-        LOG.info("Detected chat server: " + chatServer);
-
-        return room + "@" + chatServer;
-    }
 
 }
diff --git a/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppExchange.java b/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppExchange.java
index b351a2b8671..9461096f623 100644
--- a/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppExchange.java
+++ b/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppExchange.java
@@ -16,11 +16,9 @@
  */
 package org.apache.camel.component.xmpp;
 
-import org.apache.camel.CamelContext;
 import org.apache.camel.Exchange;
 import org.apache.camel.ExchangePattern;
 import org.apache.camel.impl.DefaultExchange;
-
 import org.jivesoftware.smack.packet.Message;
 
 /**
diff --git a/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppGroupChatProducer.java b/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppGroupChatProducer.java
index 35efe78ca62..56b1878b47d 100644
--- a/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppGroupChatProducer.java
+++ b/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppGroupChatProducer.java
@@ -16,12 +16,13 @@
  */
 package org.apache.camel.component.xmpp;
 
-import org.apache.camel.CamelException;
 import org.apache.camel.Exchange;
+import org.apache.camel.RuntimeExchangeException;
 import org.apache.camel.impl.DefaultProducer;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.jivesoftware.smack.SmackConfiguration;
+import org.jivesoftware.smack.XMPPConnection;
 import org.jivesoftware.smack.XMPPException;
 import org.jivesoftware.smack.packet.Message;
 import org.jivesoftware.smackx.muc.DiscussionHistory;
@@ -33,66 +34,86 @@ import org.jivesoftware.smackx.muc.MultiUserChat;
 public class XmppGroupChatProducer extends DefaultProducer {
     private static final transient Log LOG = LogFactory.getLog(XmppGroupChatProducer.class);
     private final XmppEndpoint endpoint;
-    private final String room;
+    private XMPPConnection connection;
     private MultiUserChat chat;
+    private String room;
 
-    public XmppGroupChatProducer(XmppEndpoint endpoint) throws XMPPException, CamelException {
+    public XmppGroupChatProducer(XmppEndpoint endpoint) throws XMPPException {
         super(endpoint);
         this.endpoint = endpoint;
-        this.room = endpoint.resolveRoom();
-        if (room == null) {
-            throw new IllegalArgumentException("No room property specified");
-        }
     }
 
     public void process(Exchange exchange) {
-        // TODO it would be nice if we could reuse the message from the exchange
         Message message = chat.createMessage();
         message.setTo(room);
         message.setFrom(endpoint.getUser());
 
         endpoint.getBinding().populateXmppMessage(message, exchange);
-        if (LOG.isDebugEnabled()) {
-            LOG.debug("Sending XMPP message: " + message.getBody());
-        }
         try {
+            // make sure we are connected
+            if (!connection.isConnected()) {
+                if (LOG.isDebugEnabled()) {
+                    LOG.debug("Reconnecting to: " + XmppEndpoint.getConnectionMessage(connection));
+                }
+                connection.connect();
+            }
+
+            if (LOG.isDebugEnabled()) {
+                LOG.debug("Sending XMPP message: " + message.getBody());
+            }
             chat.sendMessage(message);
+            // must invoke nextMessage to consume the response from the server
+            // otherwise the client local queue will fill up (CAMEL-1467)
+            chat.nextMessage();
         } catch (XMPPException e) {
-            throw new RuntimeXmppException(e);
+            throw new RuntimeExchangeException("Cannot send XMPP message: " + message, exchange, e);
         }
     }
 
     @Override
     protected void doStart() throws Exception {
+        if (connection == null) {
+            connection = endpoint.createConnection();
+        }
+
         if (chat == null) {
-            chat = new MultiUserChat(endpoint.getConnection(), room);
+            room = endpoint.resolveRoom(connection);
+            chat = new MultiUserChat(connection, room);
             DiscussionHistory history = new DiscussionHistory();
             history.setMaxChars(0); // we do not want any historical messages
-            chat.join(this.endpoint.getNickname(), null, history, SmackConfiguration.getPacketReplyTimeout());
+            chat.join(endpoint.getNickname(), null, history, SmackConfiguration.getPacketReplyTimeout());
+            if (LOG.isInfoEnabled()) {
+                LOG.info("Joined room: " + room + " as: " + endpoint.getNickname());
+            }
         }
+
         super.doStart();
     }
 
     @Override
     protected void doStop() throws Exception {
         if (chat != null) {
+            if (LOG.isInfoEnabled()) {
+                LOG.info("Leaving room: " + room);
+            }
             chat.leave();
             chat = null;
         }
+        if (connection != null) {
+            if (LOG.isDebugEnabled()) {
+                LOG.debug("Disconnecting from: " + XmppEndpoint.getConnectionMessage(connection));
+            }
+            connection.disconnect();
+            connection = null;
+        }
         super.doStop();
     }
 
     // Properties
     // -------------------------------------------------------------------------
-    public MultiUserChat getChat() {
-        return chat;
-    }
-
-    public void setChat(MultiUserChat chat) {
-        this.chat = chat;
-    }
 
     public String getRoom() {
         return room;
     }
+
 }
diff --git a/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppPrivateChatProducer.java b/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppPrivateChatProducer.java
index 437cbe77983..9ca350e3098 100644
--- a/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppPrivateChatProducer.java
+++ b/components/camel-xmpp/src/main/java/org/apache/camel/component/xmpp/XmppPrivateChatProducer.java
@@ -17,12 +17,15 @@
 package org.apache.camel.component.xmpp;
 
 import org.apache.camel.Exchange;
+import org.apache.camel.RuntimeExchangeException;
 import org.apache.camel.impl.DefaultProducer;
+import org.apache.camel.util.ObjectHelper;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.jivesoftware.smack.Chat;
 import org.jivesoftware.smack.ChatManager;
 import org.jivesoftware.smack.MessageListener;
+import org.jivesoftware.smack.XMPPConnection;
 import org.jivesoftware.smack.XMPPException;
 import org.jivesoftware.smack.packet.Message;
 
@@ -32,64 +35,80 @@ import org.jivesoftware.smack.packet.Message;
 public class XmppPrivateChatProducer extends DefaultProducer {
     private static final transient Log LOG = LogFactory.getLog(XmppPrivateChatProducer.class);
     private final XmppEndpoint endpoint;
+    private XMPPConnection connection;
     private final String participant;
 
-
     public XmppPrivateChatProducer(XmppEndpoint endpoint, String participant) {
         super(endpoint);
         this.endpoint = endpoint;
         this.participant = participant;
-        if (participant == null) {
-            throw new IllegalArgumentException("No participant property specified");
-        }
+        ObjectHelper.notEmpty(participant, "participant");
     }
 
     public void process(Exchange exchange) {
         String threadId = exchange.getExchangeId();
 
         try {
-            ChatManager chatManager = endpoint.getConnection().getChatManager();
-            Chat chat = chatManager.getThreadChat(threadId);
+            if (connection == null) {
+                connection = endpoint.createConnection();
+            }
 
-            if (chat == null) {
-                chat = chatManager.createChat(getParticipant(), threadId, new MessageListener() {
-                    public void processMessage(Chat chat, Message message) {
-                        // not here to do conversation
-                    }
-                });
+            // make sure we are connected
+            if (!connection.isConnected()) {
+                if (LOG.isDebugEnabled()) {
+                    LOG.debug("Reconnecting to: " + XmppEndpoint.getConnectionMessage(connection));
+                }
+                connection.connect();
             }
+        } catch (XMPPException e) {
+            throw new RuntimeExchangeException("Cannot connect to: "
+                    + XmppEndpoint.getConnectionMessage(connection), exchange, e);
+        }
 
-            // TODO it would be nice if we could reuse the message from the exchange
-            Message message = new Message();
+        ChatManager chatManager = connection.getChatManager();
+        Chat chat = chatManager.getThreadChat(threadId);
+        if (chat == null) {
+            chat = chatManager.createChat(getParticipant(), threadId, new MessageListener() {
+                public void processMessage(Chat chat, Message message) {
+                    // not here to do conversation
+                }
+            });
+        }
+
+        Message message = null;
+        try {
+            message = new Message();
             message.setTo(participant);
             message.setThread(threadId);
             message.setType(Message.Type.normal);
 
             endpoint.getBinding().populateXmppMessage(message, exchange);
+
             if (LOG.isDebugEnabled()) {
-                LOG.debug(">>>> message: " + message.getBody());
+                LOG.debug("Sending XMPP message: " + message.getBody());
             }
-
             chat.sendMessage(message);
         } catch (XMPPException e) {
-            throw new RuntimeXmppException(e);
+            throw new RuntimeExchangeException("Cannot send XMPP message: " + message
+                    + " to: " + XmppEndpoint.getConnectionMessage(connection), exchange, e);
         }
     }
 
-    @Override
-    protected void doStart() throws Exception {
-        super.doStart();
-    }
-
     @Override
     protected void doStop() throws Exception {
+        if (connection != null) {
+            if (LOG.isDebugEnabled()) {
+                LOG.debug("Disconnecting from: " + XmppEndpoint.getConnectionMessage(connection));
+            }
+            connection.disconnect();
+            connection = null;
+        }
         super.doStop();
     }
 
     // Properties
     // -------------------------------------------------------------------------
 
-
     public String getParticipant() {
         return participant;
     }
diff --git a/components/camel-xmpp/src/test/resources/log4j.properties b/components/camel-xmpp/src/test/resources/log4j.properties
new file mode 100644
index 00000000000..ccb67b319b6
--- /dev/null
+++ b/components/camel-xmpp/src/test/resources/log4j.properties
@@ -0,0 +1,36 @@
+## ---------------------------------------------------------------------------
+## Licensed to the Apache Software Foundation (ASF) under one or more
+## contributor license agreements.  See the NOTICE file distributed with
+## this work for additional information regarding copyright ownership.
+## The ASF licenses this file to You under the Apache License, Version 2.0
+## (the "License"); you may not use this file except in compliance with
+## the License.  You may obtain a copy of the License at
+##
+## http://www.apache.org/licenses/LICENSE-2.0
+##
+## Unless required by applicable law or agreed to in writing, software
+## distributed under the License is distributed on an "AS IS" BASIS,
+## WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+## See the License for the specific language governing permissions and
+## limitations under the License.
+## ---------------------------------------------------------------------------
+
+#
+# The logging properties used during tests..
+#
+log4j.rootLogger=INFO, file
+
+log4j.logger.org.apache.camel.component.xmpp=DEBUG
+#log4j.logger.org.apache.camel=DEBUG
+
+# CONSOLE appender not used by default
+log4j.appender.out=org.apache.log4j.ConsoleAppender
+log4j.appender.out.layout=org.apache.log4j.PatternLayout
+log4j.appender.out.layout.ConversionPattern=%d [%-15.15t] %-5p %-30.30c{1} - %m%n
+
+# File appender
+log4j.appender.file=org.apache.log4j.FileAppender
+log4j.appender.file.layout=org.apache.log4j.PatternLayout
+log4j.appender.file.layout.ConversionPattern=%d [%-15.15t] %-5p %-30.30c{1} - %m%n
+log4j.appender.file.file=target/camel-xmpp-test.log
+log4j.appender.file.append=true
