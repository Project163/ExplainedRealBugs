diff --git a/camel-core/src/main/java/org/apache/camel/component/file/GenericFileConsumer.java b/camel-core/src/main/java/org/apache/camel/component/file/GenericFileConsumer.java
index 09e15d49522..0ec65190713 100644
--- a/camel-core/src/main/java/org/apache/camel/component/file/GenericFileConsumer.java
+++ b/camel-core/src/main/java/org/apache/camel/component/file/GenericFileConsumer.java
@@ -206,13 +206,13 @@ public abstract class GenericFileConsumer<T> extends ScheduledPollConsumer imple
     protected boolean isValidFile(GenericFile<T> file, boolean isDirectory) {
         if (!isMatched(file, isDirectory)) {
             if (log.isTraceEnabled()) {
-                log.trace("Remote file did not match. Will skip this remote file: " + file);
+                log.trace("File did not match. Will skip this file: " + file);
             }
             return false;
         } else if (endpoint.isIdempotent() && endpoint.getIdempotentRepository().contains(file.getFileName())) {
             // only use the filename as the key as the file could be moved into a done folder
             if (log.isTraceEnabled()) {
-                log.trace("RemoteFileConsumer is idempotent and the file has been consumed before. Will skip this remote file: " + file);
+                log.trace("This consumer is idempotent and the file has been consumed before. Will skip this file: " + file);
             }
             return false;
         }
diff --git a/camel-core/src/main/java/org/apache/camel/model/IdempotentConsumerDefinition.java b/camel-core/src/main/java/org/apache/camel/model/IdempotentConsumerDefinition.java
index afdb5729ad6..f8f2da2b6a3 100644
--- a/camel-core/src/main/java/org/apache/camel/model/IdempotentConsumerDefinition.java
+++ b/camel-core/src/main/java/org/apache/camel/model/IdempotentConsumerDefinition.java
@@ -39,6 +39,8 @@ import org.apache.camel.spi.RouteContext;
 public class IdempotentConsumerDefinition extends ExpressionNode {
     @XmlAttribute
     private String messageIdRepositoryRef;
+    @XmlAttribute
+    private Boolean eager = Boolean.TRUE;
     @XmlTransient
     private IdempotentRepository idempotentRepository;
 
@@ -92,6 +94,19 @@ public class IdempotentConsumerDefinition extends ExpressionNode {
         return this;
     }
 
+    /**
+     * Sets whether to eagerly add the key to the idempotent repository or wait until the exchange
+     * is complete. Eager is default enabled.
+     *
+     * @param eager  <tt>true</tt> to add the key before processing, <tt>false</tt> to wait until
+     * the exchange is complete.
+     * @return builder
+     */
+    public IdempotentConsumerDefinition eager(boolean eager) {
+        setEager(eager);
+        return this;
+    }
+
     public String getMessageIdRepositoryRef() {
         return messageIdRepositoryRef;
     }
@@ -108,12 +123,20 @@ public class IdempotentConsumerDefinition extends ExpressionNode {
         this.idempotentRepository = idempotentRepository;
     }
 
+    public Boolean isEager() {
+        return eager;
+    }
+
+    public void setEager(Boolean eager) {
+        this.eager = eager;
+    }
+
     @Override
     public Processor createProcessor(RouteContext routeContext) throws Exception {
         Processor childProcessor = routeContext.createProcessor(this);
         IdempotentRepository idempotentRepository = resolveMessageIdRepository(routeContext);
-        return new IdempotentConsumer(getExpression().createExpression(routeContext), idempotentRepository,
-                                      childProcessor);
+        Expression expression = getExpression().createExpression(routeContext);
+        return new IdempotentConsumer(expression, idempotentRepository, eager, childProcessor);
     }
 
     /**
diff --git a/camel-core/src/main/java/org/apache/camel/processor/idempotent/FileIdempotentRepository.java b/camel-core/src/main/java/org/apache/camel/processor/idempotent/FileIdempotentRepository.java
index a8a0caac03b..43ec2c5037b 100644
--- a/camel-core/src/main/java/org/apache/camel/processor/idempotent/FileIdempotentRepository.java
+++ b/camel-core/src/main/java/org/apache/camel/processor/idempotent/FileIdempotentRepository.java
@@ -148,6 +148,11 @@ public class FileIdempotentRepository implements IdempotentRepository<String> {
         }
     }
 
+    public boolean confirm(String key) {
+        // noop
+        return true;
+    }
+
     public File getFileStore() {
         return fileStore;
     }
diff --git a/camel-core/src/main/java/org/apache/camel/processor/idempotent/IdempotentConsumer.java b/camel-core/src/main/java/org/apache/camel/processor/idempotent/IdempotentConsumer.java
index ddf2a14c740..560705a5776 100644
--- a/camel-core/src/main/java/org/apache/camel/processor/idempotent/IdempotentConsumer.java
+++ b/camel-core/src/main/java/org/apache/camel/processor/idempotent/IdempotentConsumer.java
@@ -31,8 +31,7 @@ import org.apache.commons.logging.LogFactory;
 
 /**
  * An implementation of the <a
- * href="http://camel.apache.org/idempotent-consumer.html">Idempotent
- * Consumer</a> pattern.
+ * href="http://camel.apache.org/idempotent-consumer.html">Idempotent Consumer</a> pattern.
  * 
  * @version $Revision$
  */
@@ -41,17 +40,19 @@ public class IdempotentConsumer extends ServiceSupport implements Processor, Nav
     private final Expression messageIdExpression;
     private final Processor processor;
     private final IdempotentRepository idempotentRepository;
+    private final boolean eager;
 
-    public IdempotentConsumer(Expression messageIdExpression, IdempotentRepository idempotentRepository, Processor processor) {
+    public IdempotentConsumer(Expression messageIdExpression, IdempotentRepository idempotentRepository,
+                              boolean eager, Processor processor) {
         this.messageIdExpression = messageIdExpression;
         this.idempotentRepository = idempotentRepository;
+        this.eager = eager;
         this.processor = processor;
     }
 
     @Override
     public String toString() {
-        return "IdempotentConsumer[expression=" + messageIdExpression + ", repository=" + idempotentRepository
-               + ", processor=" + processor + "]";
+        return "IdempotentConsumer[" + messageIdExpression + " -> " + processor + "]";
     }
 
     @SuppressWarnings("unchecked")
@@ -61,18 +62,26 @@ public class IdempotentConsumer extends ServiceSupport implements Processor, Nav
             throw new NoMessageIdException(exchange, messageIdExpression);
         }
 
-        // add the key to the repository
-        boolean newKey = idempotentRepository.add(messageId);
+        boolean newKey;
+        if (eager) {
+            // add the key to the repository
+            newKey = idempotentRepository.add(messageId);
+        } else {
+            // check if we alrady have the key
+            newKey = !idempotentRepository.contains(messageId);
+        }
+
         if (!newKey) {
             // we already have this key so its a duplicate message
             onDuplicateMessage(exchange, messageId);
-        } else {
-            // register our on completion callback
-            exchange.addOnCompletion(new IdempotentOnCompletion(idempotentRepository, messageId));
-
-            // process the exchange
-            processor.process(exchange);
+            return;
         }
+
+        // register our on completion callback
+        exchange.addOnCompletion(new IdempotentOnCompletion(idempotentRepository, messageId, eager));
+
+        // process the exchange
+        processor.process(exchange);
     }
 
     public List<Processor> next() {
diff --git a/camel-core/src/main/java/org/apache/camel/processor/idempotent/IdempotentOnCompletion.java b/camel-core/src/main/java/org/apache/camel/processor/idempotent/IdempotentOnCompletion.java
index 8a09f66e0bb..9abce2f6753 100644
--- a/camel-core/src/main/java/org/apache/camel/processor/idempotent/IdempotentOnCompletion.java
+++ b/camel-core/src/main/java/org/apache/camel/processor/idempotent/IdempotentOnCompletion.java
@@ -31,17 +31,17 @@ import org.apache.commons.logging.LogFactory;
  * @version $Revision$
  */
 public class IdempotentOnCompletion implements Synchronization {
-
     private static final transient Log LOG = LogFactory.getLog(IdempotentOnCompletion.class);
-    private final IdempotentRepository<String> idempotentRepository;
+    private final IdempotentRepository idempotentRepository;
     private final String messageId;
+    private final boolean eager;
 
-    public IdempotentOnCompletion(IdempotentRepository<String> idempotentRepository, String messageId) {
+    public IdempotentOnCompletion(IdempotentRepository idempotentRepository, String messageId, boolean eager) {
         this.idempotentRepository = idempotentRepository;
         this.messageId = messageId;
+        this.eager = eager;
     }
 
-    @SuppressWarnings("unchecked")
     public void onComplete(Exchange exchange) {
         onCompletedMessage(exchange, messageId);
     }
@@ -57,8 +57,13 @@ public class IdempotentOnCompletion implements Synchronization {
      * @param exchange the exchange
      * @param messageId the message ID of this exchange
      */
+    @SuppressWarnings("unchecked")
     protected void onCompletedMessage(Exchange exchange, String messageId) {
-        // noop
+        if (!eager) {
+            // if not eager we should add the key when its complete
+            idempotentRepository.add(messageId);
+        }
+        idempotentRepository.confirm(messageId);
     }
 
     /**
@@ -68,6 +73,7 @@ public class IdempotentOnCompletion implements Synchronization {
      * @param exchange the exchange
      * @param messageId the message ID of this exchange
      */
+    @SuppressWarnings("unchecked")
     protected void onFailedMessage(Exchange exchange, String messageId) {
         idempotentRepository.remove(messageId);
         if (LOG.isDebugEnabled()) {
@@ -79,4 +85,5 @@ public class IdempotentOnCompletion implements Synchronization {
     public String toString() {
         return "IdempotentOnCompletion[" + messageId + ']';
     }
+
 }
diff --git a/camel-core/src/main/java/org/apache/camel/processor/idempotent/MemoryIdempotentRepository.java b/camel-core/src/main/java/org/apache/camel/processor/idempotent/MemoryIdempotentRepository.java
index e0ecaa64ae9..606c9d73a85 100644
--- a/camel-core/src/main/java/org/apache/camel/processor/idempotent/MemoryIdempotentRepository.java
+++ b/camel-core/src/main/java/org/apache/camel/processor/idempotent/MemoryIdempotentRepository.java
@@ -94,6 +94,11 @@ public class MemoryIdempotentRepository implements IdempotentRepository<String>
         }
     }
 
+    public boolean confirm(String key) {
+        // noop
+        return true;
+    }
+
     public Map<String, Object> getCache() {
         return cache;
     }
diff --git a/camel-core/src/main/java/org/apache/camel/spi/IdempotentRepository.java b/camel-core/src/main/java/org/apache/camel/spi/IdempotentRepository.java
index c97e429a984..a0626201e5f 100644
--- a/camel-core/src/main/java/org/apache/camel/spi/IdempotentRepository.java
+++ b/camel-core/src/main/java/org/apache/camel/spi/IdempotentRepository.java
@@ -44,9 +44,20 @@ public interface IdempotentRepository<E> {
 
     /**
      * Removes the key from the repository.
+     * <p/>
+     * Is usually invoked if the exchange failed.
      *
      * @param key the key of the message for duplicate test
      * @return <tt>true</tt> if the key was removed
      */
     boolean remove(E key);
+
+    /**
+     * Confirms the key, after the exchange has been processed sucesfully.
+     *
+     * @param key the key of the message for duplicate test
+     * @return <tt>true</tt> if the key was confirmed
+     */
+    boolean confirm(E key);
+
 }
diff --git a/camel-core/src/test/java/org/apache/camel/component/file/FileConsumerIdempotentRefTest.java b/camel-core/src/test/java/org/apache/camel/component/file/FileConsumerIdempotentRefTest.java
index 54ba41aa629..7f59f31fb04 100644
--- a/camel-core/src/test/java/org/apache/camel/component/file/FileConsumerIdempotentRefTest.java
+++ b/camel-core/src/test/java/org/apache/camel/component/file/FileConsumerIdempotentRefTest.java
@@ -99,6 +99,10 @@ public class FileConsumerIdempotentRefTest extends ContextTestSupport {
         public boolean remove(String key) {
             return true;
         }
+
+        public boolean confirm(String key) {
+            return true;
+        }
     }
     
 }
\ No newline at end of file
diff --git a/camel-core/src/test/java/org/apache/camel/processor/IdempotentConsumerEagerTest.java b/camel-core/src/test/java/org/apache/camel/processor/IdempotentConsumerEagerTest.java
new file mode 100644
index 00000000000..8b66bc5de7b
--- /dev/null
+++ b/camel-core/src/test/java/org/apache/camel/processor/IdempotentConsumerEagerTest.java
@@ -0,0 +1,171 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.camel.processor;
+
+import org.apache.camel.ContextTestSupport;
+import org.apache.camel.Endpoint;
+import org.apache.camel.Exchange;
+import org.apache.camel.Message;
+import org.apache.camel.Processor;
+import org.apache.camel.builder.RouteBuilder;
+import org.apache.camel.component.mock.MockEndpoint;
+import org.apache.camel.processor.idempotent.MemoryIdempotentRepository;
+import org.apache.camel.spi.IdempotentRepository;
+
+/**
+ * @version $Revision$
+ */
+public class IdempotentConsumerEagerTest extends ContextTestSupport {
+    protected Endpoint startEndpoint;
+    protected MockEndpoint resultEndpoint;
+
+    @Override
+    public boolean isUseRouteBuilder() {
+        return false;
+    }
+
+    public void testDuplicateMessagesAreFilteredOut() throws Exception {
+        context.addRoutes(new RouteBuilder() {
+            @Override
+            public void configure() throws Exception {
+                from("direct:start").idempotentConsumer(
+                        header("messageId"), MemoryIdempotentRepository.memoryIdempotentRepository(200)
+                ).eager(false).to("mock:result");
+            }
+        });
+        context.start();
+
+        resultEndpoint.expectedBodiesReceived("one", "two", "three");
+
+        sendMessage("1", "one");
+        sendMessage("2", "two");
+        sendMessage("1", "one");
+        sendMessage("2", "two");
+        sendMessage("1", "one");
+        sendMessage("3", "three");
+
+        assertMockEndpointsSatisfied();
+    }
+
+    public void testFailedExchangesNotAdded() throws Exception {
+        context.addRoutes(new RouteBuilder() {
+            @Override
+            public void configure() throws Exception {
+                errorHandler(deadLetterChannel("mock:error").maximumRedeliveries(2).delay(0).logStackTrace(false));
+
+                from("direct:start").idempotentConsumer(
+                        header("messageId"), MemoryIdempotentRepository.memoryIdempotentRepository(200)
+                ).eager(false).process(new Processor() {
+                    public void process(Exchange exchange) throws Exception {
+                        String id = exchange.getIn().getHeader("messageId", String.class);
+                        if (id.equals("2")) {
+                            throw new IllegalArgumentException("Damm I cannot handle id 2");
+                        }
+                    }
+                }).to("mock:result");
+            }
+        });
+        context.start();
+
+        // we send in 2 messages with id 2 that fails
+        getMockEndpoint("mock:error").expectedMessageCount(2);
+        resultEndpoint.expectedBodiesReceived("one", "three");
+
+        sendMessage("1", "one");
+        sendMessage("2", "two");
+        sendMessage("1", "one");
+        sendMessage("2", "two");
+        sendMessage("1", "one");
+        sendMessage("3", "three");
+
+        assertMockEndpointsSatisfied();
+    }
+
+    public void testNotEager() throws Exception {
+        context.addRoutes(new RouteBuilder() {
+            @Override
+            public void configure() throws Exception {
+                final IdempotentRepository repo = MemoryIdempotentRepository.memoryIdempotentRepository(200);
+
+                from("direct:start").idempotentConsumer(header("messageId"), repo).eager(false).
+                        process(new Processor() {
+                            public void process(Exchange exchange) throws Exception {
+                                String id = exchange.getIn().getHeader("messageId", String.class);
+                                // should not contain
+                                assertFalse("Should not eager add to repo", repo.contains(id));
+                            }
+                        }).to("mock:result");
+            }
+        });
+        context.start();
+
+        resultEndpoint.expectedBodiesReceived("one", "two", "three");
+
+        sendMessage("1", "one");
+        sendMessage("2", "two");
+        sendMessage("3", "three");
+
+        assertMockEndpointsSatisfied();
+    }
+
+    public void testEager() throws Exception {
+        context.addRoutes(new RouteBuilder() {
+            @Override
+            public void configure() throws Exception {
+                final IdempotentRepository repo = MemoryIdempotentRepository.memoryIdempotentRepository(200);
+
+                from("direct:start").idempotentConsumer(header("messageId"), repo).eager(true).
+                        process(new Processor() {
+                            public void process(Exchange exchange) throws Exception {
+                                String id = exchange.getIn().getHeader("messageId", String.class);
+                                // should contain
+                                assertTrue("Should eager add to repo", repo.contains(id));
+                            }
+                        }).to("mock:result");
+            }
+        });
+        context.start();
+
+        resultEndpoint.expectedBodiesReceived("one", "two", "three");
+
+        sendMessage("1", "one");
+        sendMessage("2", "two");
+        sendMessage("3", "three");
+
+        assertMockEndpointsSatisfied();
+    }
+
+    protected void sendMessage(final Object messageId, final Object body) {
+        template.send(startEndpoint, new Processor() {
+            public void process(Exchange exchange) {
+                // now lets fire in a message
+                Message in = exchange.getIn();
+                in.setBody(body);
+                in.setHeader("messageId", messageId);
+            }
+        });
+    }
+
+    @Override
+    protected void setUp() throws Exception {
+        super.setUp();
+
+        startEndpoint = resolveMandatoryEndpoint("direct:start");
+        resultEndpoint = getMockEndpoint("mock:result");
+    }
+
+}
\ No newline at end of file
diff --git a/components/camel-jpa/src/main/java/org/apache/camel/processor/idempotent/jpa/JpaMessageIdRepository.java b/components/camel-jpa/src/main/java/org/apache/camel/processor/idempotent/jpa/JpaMessageIdRepository.java
index eb8e57d4ca5..1e65d0b99b8 100644
--- a/components/camel-jpa/src/main/java/org/apache/camel/processor/idempotent/jpa/JpaMessageIdRepository.java
+++ b/components/camel-jpa/src/main/java/org/apache/camel/processor/idempotent/jpa/JpaMessageIdRepository.java
@@ -115,4 +115,9 @@ public class JpaMessageIdRepository implements IdempotentRepository<String> {
         return rc.booleanValue();
     }
 
+    public boolean confirm(String s) {
+        // noop
+        return true;
+    }
+
 }
