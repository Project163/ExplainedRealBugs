diff --git a/camel-core/src/main/java/org/apache/camel/impl/DefaultLifecycleStrategy.java b/camel-core/src/main/java/org/apache/camel/impl/DefaultLifecycleStrategy.java
index c9b78a9236f..122cb71fa82 100644
--- a/camel-core/src/main/java/org/apache/camel/impl/DefaultLifecycleStrategy.java
+++ b/camel-core/src/main/java/org/apache/camel/impl/DefaultLifecycleStrategy.java
@@ -16,13 +16,21 @@
  */
 package org.apache.camel.impl;
 
+import java.util.ArrayList;
 import java.util.Collection;
+import java.util.List;
 
 import org.apache.camel.CamelContext;
 import org.apache.camel.Endpoint;
 import org.apache.camel.Exchange;
 import org.apache.camel.Route;
 import org.apache.camel.Service;
+import org.apache.camel.builder.DeadLetterChannelBuilder;
+import org.apache.camel.management.InstrumentationErrorHandlerWrappingStrategy;
+import org.apache.camel.management.InstrumentationProcessor;
+import org.apache.camel.model.ExceptionType;
+import org.apache.camel.model.ProcessorType;
+import org.apache.camel.model.RouteType;
 import org.apache.camel.spi.LifecycleStrategy;
 import org.apache.camel.spi.RouteContext;
 
@@ -48,6 +56,21 @@ public class DefaultLifecycleStrategy implements LifecycleStrategy {
     }
 
     public void onRouteContextCreate(RouteContext routeContext) {
-        // do nothing
+
+        RouteType routeType = routeContext.getRoute();
+        if (routeType.getInputs() != null && !routeType.getInputs().isEmpty()) {
+            // configure the outputs
+            List<ProcessorType<?>> outputs = new ArrayList<ProcessorType<?>>(routeType.getOutputs());
+
+            // clearing the outputs
+            routeType.clearOutput();
+
+            // add the output configure the outputs with the routeType
+            for (ProcessorType<?> processorType : outputs) {
+                routeType.addOutput(processorType);
+            }
+
+        }
+
     }
 }
diff --git a/camel-core/src/main/java/org/apache/camel/management/InstrumentationLifecycleStrategy.java b/camel-core/src/main/java/org/apache/camel/management/InstrumentationLifecycleStrategy.java
index f474fda175b..64ee3e5c843 100644
--- a/camel-core/src/main/java/org/apache/camel/management/InstrumentationLifecycleStrategy.java
+++ b/camel-core/src/main/java/org/apache/camel/management/InstrumentationLifecycleStrategy.java
@@ -180,7 +180,7 @@ public class InstrumentationLifecycleStrategy implements LifecycleStrategy {
                 PerformanceCounter pc = new PerformanceCounter();
                 agent.register(pc, name);
 
-                // add to map now that it has ben registered
+                // add to map now that it has been registered
                 counterMap.put(processor, pc);
             } catch (MalformedObjectNameException e) {
                 LOG.warn("Could not create MBean name: " + name, e);
diff --git a/camel-core/src/main/java/org/apache/camel/model/ProcessorType.java b/camel-core/src/main/java/org/apache/camel/model/ProcessorType.java
index 45a4ac7d531..bc05985b318 100644
--- a/camel-core/src/main/java/org/apache/camel/model/ProcessorType.java
+++ b/camel-core/src/main/java/org/apache/camel/model/ProcessorType.java
@@ -279,7 +279,7 @@ public abstract class ProcessorType<Type extends ProcessorType> extends Optional
     }
 
     /**
-     * Creates an {@link org.apache.camel.processor.idempotent.IdempotentConsumer} 
+     * Creates an {@link org.apache.camel.processor.idempotent.IdempotentConsumer}
      * to avoid duplicate messages
      */
     public IdempotentConsumerType idempotentConsumer(Expression messageIdExpression,
@@ -1599,7 +1599,7 @@ public abstract class ProcessorType<Type extends ProcessorType> extends Optional
         if (errorHandlerRef != null) {
             return new ErrorHandlerBuilderRef(errorHandlerRef);
         }
-        if (isInheritErrorHandler()) {            
+        if (isInheritErrorHandler()) {
             return new DeadLetterChannelBuilder();
         } else {
             return new NoErrorHandlerBuilder();
diff --git a/camel-core/src/test/java/org/apache/camel/builder/ContextErrorHandlerTest.java b/camel-core/src/test/java/org/apache/camel/builder/ContextErrorHandlerTest.java
index 70a74064247..e4618b5f59a 100644
--- a/camel-core/src/test/java/org/apache/camel/builder/ContextErrorHandlerTest.java
+++ b/camel-core/src/test/java/org/apache/camel/builder/ContextErrorHandlerTest.java
@@ -90,14 +90,13 @@ public class ContextErrorHandlerTest extends ContextTestSupport {
         RouteBuilder builder = new RouteBuilder() {
             public void configure() {
                 from("seda:a").to("seda:b");
+                from("direct:c").to("direct:d");
             }
         };
 
         List<Route> list = getRouteList(builder);
-        assertEquals("Number routes created" + list, 1, list.size());
+        assertEquals("Number routes created" + list, 2, list.size());
         for (Route route : list) {
-            Endpoint key = route.getEndpoint();
-            assertEquals("From endpoint", "seda:a", key.getEndpointUri());
 
             EventDrivenConsumerRoute consumerRoute = assertIsInstanceOf(EventDrivenConsumerRoute.class, route);
             Processor processor = consumerRoute.getProcessor();
diff --git a/components/camel-spring/src/test/java/org/apache/camel/spring/config/ErrorHandlerTest.java b/components/camel-spring/src/test/java/org/apache/camel/spring/config/ErrorHandlerTest.java
index 1e9da2e0d1b..8fc441fd28c 100644
--- a/components/camel-spring/src/test/java/org/apache/camel/spring/config/ErrorHandlerTest.java
+++ b/components/camel-spring/src/test/java/org/apache/camel/spring/config/ErrorHandlerTest.java
@@ -36,16 +36,15 @@ public class ErrorHandlerTest extends SpringTestSupport {
     public void testEndpointConfiguration() throws Exception {
         CamelContext context = getMandatoryBean(CamelContext.class, "camel");
         List<Route> list = context.getRoutes();
-        assertEquals("Number routes created" + list, 1, list.size());
+        assertEquals("Number routes created" + list, 2, list.size());
         for (Route route : list) {
-            Endpoint key = route.getEndpoint();
-            assertEquals("From endpoint", "seda:a", key.getEndpointUri());
 
             EventDrivenConsumerRoute consumerRoute = assertIsInstanceOf(EventDrivenConsumerRoute.class, route);
             Processor processor = consumerRoute.getProcessor();
             processor = unwrap(processor);
 
             DeadLetterChannel deadLetterChannel = assertIsInstanceOf(DeadLetterChannel.class, processor);
+            System.out.println("The deadLetterChannel is " + deadLetterChannel);
 
             RedeliveryPolicy redeliveryPolicy = deadLetterChannel.getRedeliveryPolicy();
 
diff --git a/components/camel-spring/src/test/java/org/apache/camel/spring/processor/SpringSetHeaderWithChildProcessorTest.java b/components/camel-spring/src/test/java/org/apache/camel/spring/processor/SpringSetHeaderWithChildProcessorTest.java
deleted file mode 100644
index e69de29bb2d..00000000000
diff --git a/components/camel-spring/src/test/java/org/apache/camel/spring/processor/SpringXPathHeaderTest.java b/components/camel-spring/src/test/java/org/apache/camel/spring/processor/SpringXPathHeaderTest.java
index a7a0a5ebd72..69b6a8486ca 100644
--- a/components/camel-spring/src/test/java/org/apache/camel/spring/processor/SpringXPathHeaderTest.java
+++ b/components/camel-spring/src/test/java/org/apache/camel/spring/processor/SpringXPathHeaderTest.java
@@ -1,10 +1,28 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
 package org.apache.camel.spring.processor;
 
-import org.apache.camel.ContextTestSupport;
+
 import org.apache.camel.CamelContext;
-import static org.apache.camel.spring.processor.SpringTestHelper.createSpringCamelContext;
+import org.apache.camel.ContextTestSupport;
 import org.apache.camel.component.mock.MockEndpoint;
 
+import static org.apache.camel.spring.processor.SpringTestHelper.createSpringCamelContext;
 /**
  * Spring basesd XPathHeaderTest.
  */
diff --git a/components/camel-spring/src/test/resources/org/apache/camel/spring/config/errorHandler.xml b/components/camel-spring/src/test/resources/org/apache/camel/spring/config/errorHandler.xml
index a72c65264f1..b6e0792ddbd 100644
--- a/components/camel-spring/src/test/resources/org/apache/camel/spring/config/errorHandler.xml
+++ b/components/camel-spring/src/test/resources/org/apache/camel/spring/config/errorHandler.xml
@@ -25,10 +25,15 @@
 
   <camelContext id="camel" errorHandlerRef="deadLetterErrorHandler"
    xmlns="http://activemq.apache.org/camel/schema/spring">
+    <jmxAgent id="agent" disabled="true"/>
     <route>
       <from uri="seda:a"/>
       <to uri="seda:b"/>
     </route>
+    <route>
+       <from uri="direct:c"/>
+       <to uri="direct:d"/>
+    </route>
   </camelContext>
 
   <bean id="deadLetterErrorHandler"
