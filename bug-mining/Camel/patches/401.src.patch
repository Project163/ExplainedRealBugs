diff --git a/components/camel-sql/pom.xml b/components/camel-sql/pom.xml
index 20ba7316830..964ab31a275 100755
--- a/components/camel-sql/pom.xml
+++ b/components/camel-sql/pom.xml
@@ -67,6 +67,11 @@
 			<artifactId>junit</artifactId>
 			<scope>test</scope>
 		</dependency>
+        <dependency>
+            <groupId>log4j</groupId>
+            <artifactId>log4j</artifactId>
+            <scope>test</scope>
+        </dependency>
 	    <dependency>
 	      <groupId>hsqldb</groupId>
 	      <artifactId>hsqldb</artifactId>
diff --git a/components/camel-sql/src/main/java/org/apache/camel/component/sql/SqlComponent.java b/components/camel-sql/src/main/java/org/apache/camel/component/sql/SqlComponent.java
index 9026a4429cc..8df0fb3a42b 100755
--- a/components/camel-sql/src/main/java/org/apache/camel/component/sql/SqlComponent.java
+++ b/components/camel-sql/src/main/java/org/apache/camel/component/sql/SqlComponent.java
@@ -28,7 +28,6 @@ import org.apache.camel.impl.DefaultComponent;
  * @version $Revision:520964 $
  */
 public class SqlComponent extends DefaultComponent {
-
     private DataSource dataSource;
 
     public SqlComponent() {
@@ -39,12 +38,20 @@ public class SqlComponent extends DefaultComponent {
     }
 
     @Override
-    protected Endpoint createEndpoint(String uri, String remaining, Map parameters)
-        throws Exception {
+    protected Endpoint createEndpoint(String uri, String remaining, Map parameters) throws Exception {
+        String dataSourceRef = getAndRemoveParameter(parameters, "dataSourceRef", String.class);
+        if (dataSourceRef != null) {
+            dataSource = getCamelContext().getRegistry().lookup(dataSourceRef, DataSource.class);
+            if (dataSource == null) {
+                throw new IllegalArgumentException("DataSource " + dataSourceRef + " not found in registry");
+            }
+        }
+        
         return new SqlEndpoint(uri, remaining.replaceAll("#", "?"), this, dataSource, parameters);
     }
 
     public void setDataSource(DataSource dataSource) {
         this.dataSource = dataSource;
     }
+
 }
diff --git a/components/camel-sql/src/main/java/org/apache/camel/component/sql/SqlEndpoint.java b/components/camel-sql/src/main/java/org/apache/camel/component/sql/SqlEndpoint.java
index 48cbf207c84..534c6d63fb5 100644
--- a/components/camel-sql/src/main/java/org/apache/camel/component/sql/SqlEndpoint.java
+++ b/components/camel-sql/src/main/java/org/apache/camel/component/sql/SqlEndpoint.java
@@ -32,13 +32,9 @@ import org.springframework.jdbc.core.JdbcTemplate;
  * SQL Endpoint. Endpoint URI should contain valid SQL statement, but instead of
  * question marks (that are parameter placeholders), sharp signs should be used.
  * This is because in camel question mark has other meaning.
- *
- * @author romkal
  */
 public class SqlEndpoint extends DefaultEndpoint {
-
     private JdbcTemplate jdbcTemplate;
-
     private String query;
 
     public SqlEndpoint(String uri, String query, Component component, DataSource dataSource, Map parameters) throws Exception {
@@ -55,7 +51,7 @@ public class SqlEndpoint extends DefaultEndpoint {
     }
     
     public Consumer createConsumer(Processor processor) throws Exception {
-        throw new UnsupportedOperationException("Not yet implemented");
+        throw new UnsupportedOperationException("Not implemented");
     }
 
     public Producer createProducer() throws Exception {
diff --git a/components/camel-sql/src/test/java/org/apache/camel/component/sql/SqlDataSourceRefTest.java b/components/camel-sql/src/test/java/org/apache/camel/component/sql/SqlDataSourceRefTest.java
new file mode 100755
index 00000000000..0fde7f83ca5
--- /dev/null
+++ b/components/camel-sql/src/test/java/org/apache/camel/component/sql/SqlDataSourceRefTest.java
@@ -0,0 +1,92 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.camel.component.sql;
+
+import javax.sql.DataSource;
+import java.util.List;
+import java.util.Map;
+
+import org.apache.camel.ContextTestSupport;
+import org.apache.camel.builder.RouteBuilder;
+import org.apache.camel.component.mock.MockEndpoint;
+import org.apache.camel.impl.JndiRegistry;
+import org.springframework.jdbc.core.JdbcTemplate;
+import org.springframework.jdbc.datasource.SingleConnectionDataSource;
+
+/**
+ * @version $Revision$
+ */
+public class SqlDataSourceRefTest extends ContextTestSupport {
+    protected String driverClass = "org.hsqldb.jdbcDriver";
+    protected String url = "jdbc:hsqldb:mem:camel_jdbc";
+    protected String user = "sa";
+    protected String password = "";
+    private JdbcTemplate jdbcTemplate;
+
+    @Override
+    protected JndiRegistry createRegistry() throws Exception {
+        JndiRegistry jndi = super.createRegistry();
+        jndi.bind("jdbc/myDataSource", createDataSource());
+        return jndi;
+    }
+
+    public void testSimpleBody() throws Exception {
+        MockEndpoint mock = getMockEndpoint("mock:result");
+        mock.expectedMessageCount(1);
+        template.sendBody("direct:simple", "GPL");
+        mock.assertIsSatisfied();
+        List received = assertIsInstanceOf(List.class, mock.getReceivedExchanges().get(0).getIn().getBody());
+        Map row = assertIsInstanceOf(Map.class, received.get(0));
+        assertEquals("Linux", row.get("PROJECT"));
+    }
+
+    protected void setUp() throws Exception {
+        Class.forName(driverClass);
+        super.setUp();
+
+        jdbcTemplate = new JdbcTemplate(createDataSource());
+        jdbcTemplate.execute("create table projects (id integer primary key,"
+                             + "project varchar(10), license varchar(5))");
+        jdbcTemplate.execute("insert into projects values (1, 'Camel', 'ASF')");
+        jdbcTemplate.execute("insert into projects values (2, 'AMQ', 'ASF')");
+        jdbcTemplate.execute("insert into projects values (3, 'Linux', 'GPL')");
+    }
+
+    protected void tearDown() throws Exception {
+        super.tearDown();
+        JdbcTemplate jdbcTemplate = new JdbcTemplate(createDataSource());
+        jdbcTemplate.execute("drop table projects");
+    }
+
+    private DataSource createDataSource() {
+        return new SingleConnectionDataSource(url, user, password, true);
+    }
+
+    @Override
+    protected RouteBuilder createRouteBuilder() throws Exception {
+        return new RouteBuilder() {
+            public void configure() {
+                // START SNIPPET: e1
+                from("direct:simple")
+                    .to("sql:select * from projects where license = # order by id?dataSourceRef=jdbc/myDataSource")
+                    .to("mock:result");
+                // END SNIPPET: e1
+            }
+        };
+    }
+
+}
\ No newline at end of file
