diff --git a/components/camel-tarfile/src/main/java/org/apache/camel/dataformat/tarfile/TarFileDataFormat.java b/components/camel-tarfile/src/main/java/org/apache/camel/dataformat/tarfile/TarFileDataFormat.java
index 0444f0a42bc..2589795637b 100644
--- a/components/camel-tarfile/src/main/java/org/apache/camel/dataformat/tarfile/TarFileDataFormat.java
+++ b/components/camel-tarfile/src/main/java/org/apache/camel/dataformat/tarfile/TarFileDataFormat.java
@@ -90,7 +90,7 @@ public class TarFileDataFormat extends ServiceSupport implements DataFormat, Dat
         }
 
         String newFilename = filename + ".tar";
-        exchange.getOut().setHeader(FILE_NAME, newFilename);
+        exchange.getMessage().setHeader(FILE_NAME, newFilename);
     }
 
     @Override
@@ -107,8 +107,10 @@ public class TarFileDataFormat extends ServiceSupport implements DataFormat, Dat
             try {
                 TarArchiveEntry entry = tis.getNextTarEntry();
                 if (entry != null) {
-                    exchange.getOut().setHeader(FILE_NAME, entry.getName());
+                    exchange.getMessage().setHeader(FILE_NAME, entry.getName());
                     IOHelper.copy(tis, osb);
+                } else {
+                    throw new IllegalStateException("Unable to untar the file, it may be corrupted.");
                 }
 
                 entry = tis.getNextTarEntry();
diff --git a/components/camel-tarfile/src/test/java/org/apache/camel/dataformat/tarfile/TarFileDataFormatTest.java b/components/camel-tarfile/src/test/java/org/apache/camel/dataformat/tarfile/TarFileDataFormatTest.java
index 9b55902d9d1..64f3c4f5b3d 100644
--- a/components/camel-tarfile/src/test/java/org/apache/camel/dataformat/tarfile/TarFileDataFormatTest.java
+++ b/components/camel-tarfile/src/test/java/org/apache/camel/dataformat/tarfile/TarFileDataFormatTest.java
@@ -27,6 +27,7 @@ import java.nio.file.Paths;
 import java.util.Iterator;
 import java.util.concurrent.TimeUnit;
 
+import org.apache.camel.CamelExecutionException;
 import org.apache.camel.Exchange;
 import org.apache.camel.Processor;
 import org.apache.camel.builder.NotifyBuilder;
@@ -122,6 +123,11 @@ public class TarFileDataFormatTest extends CamelTestSupport {
         assertMockEndpointsSatisfied();
     }
 
+    @Test(expected = CamelExecutionException.class)
+    public void testUntarWithCorruptedTarFile() throws Exception {
+        template.sendBody("direct:corruptUntar", new File("src/test/resources/data/corrupt.tar"));
+    }
+
     @Test
     public void testTarAndUntar() throws Exception {
         MockEndpoint mock = getMockEndpoint("mock:tarAndUntar");
@@ -292,6 +298,7 @@ public class TarFileDataFormatTest extends CamelTestSupport {
                 from("direct:tarToFile").marshal(tar).to("file:" + TEST_DIR.getPath()).to("mock:tarToFile");
                 from("direct:dslTar").marshal(tar).to("mock:dslTar");
                 from("direct:dslUntar").unmarshal(tar).to("mock:dslUntar");
+                from("direct:corruptUntar").unmarshal(tar).to("mock:corruptUntar");
             }
         };
     }
diff --git a/components/camel-tarfile/src/test/resources/data/corrupt.tar b/components/camel-tarfile/src/test/resources/data/corrupt.tar
new file mode 100644
index 00000000000..fc744046421
--- /dev/null
+++ b/components/camel-tarfile/src/test/resources/data/corrupt.tar
@@ -0,0 +1 @@
+I am corrupted
\ No newline at end of file
