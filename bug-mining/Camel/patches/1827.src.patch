diff --git a/components/camel-netty/src/main/java/org/apache/camel/component/netty/ClientPipelineFactory.java b/components/camel-netty/src/main/java/org/apache/camel/component/netty/ClientPipelineFactory.java
index 2338a05ef26..bf8b6d57375 100644
--- a/components/camel-netty/src/main/java/org/apache/camel/component/netty/ClientPipelineFactory.java
+++ b/components/camel-netty/src/main/java/org/apache/camel/component/netty/ClientPipelineFactory.java
@@ -18,28 +18,28 @@ package org.apache.camel.component.netty;
 
 import org.jboss.netty.channel.ChannelPipeline;
 import org.jboss.netty.channel.ChannelPipelineFactory;
-import org.jboss.netty.channel.Channels;
 
+/**
+ * Factory to create {@link ChannelPipeline} for clients, eg {@link NettyProducer}.
+ * <p/>
+ * Implementators should use implement the {@link #getPipeline(NettyProducer)} method.
+ *
+ * @see ChannelPipelineFactory
+ */
 public abstract class ClientPipelineFactory implements ChannelPipelineFactory {
-    protected NettyProducer producer;
 
     public ClientPipelineFactory() {
     }
 
-    public ClientPipelineFactory(NettyProducer producer) {
-        this.producer = producer;
-    }
-    
-    public ChannelPipeline getPipeline() throws Exception {
-        ChannelPipeline channelPipeline = Channels.pipeline();
-        return channelPipeline;
-    }
-
-    public NettyProducer getProducer() {
-        return producer;
-    }
+    /**
+     * Returns a newly created {@link ChannelPipeline}.
+     *
+     * @param producer the netty producer
+     */
+    public abstract ChannelPipeline getPipeline(NettyProducer producer) throws Exception;
 
-    public void setProducer(NettyProducer producer) {
-        this.producer = producer;
+    @Override
+    public ChannelPipeline getPipeline() throws Exception {
+        throw new UnsupportedOperationException("use getPipeline(NettyProducer) instead");
     }
 }
diff --git a/components/camel-netty/src/main/java/org/apache/camel/component/netty/DefaultClientPipelineFactory.java b/components/camel-netty/src/main/java/org/apache/camel/component/netty/DefaultClientPipelineFactory.java
index f5ffbf597b4..84a56b961ee 100644
--- a/components/camel-netty/src/main/java/org/apache/camel/component/netty/DefaultClientPipelineFactory.java
+++ b/components/camel-netty/src/main/java/org/apache/camel/component/netty/DefaultClientPipelineFactory.java
@@ -33,15 +33,12 @@ import org.slf4j.LoggerFactory;
 public class DefaultClientPipelineFactory extends ClientPipelineFactory {
     private static final transient Logger LOG = LoggerFactory.getLogger(DefaultClientPipelineFactory.class);
 
-    public DefaultClientPipelineFactory(NettyProducer producer) {
-        super(producer);
-    }
-
-    public ChannelPipeline getPipeline() throws Exception {
+    @Override
+    public ChannelPipeline getPipeline(NettyProducer producer) throws Exception {
         // create a new pipeline
         ChannelPipeline channelPipeline = Channels.pipeline();
 
-        SslHandler sslHandler = configureClientSSLOnDemand();
+        SslHandler sslHandler = configureClientSSLOnDemand(producer);
         if (sslHandler != null) {
             LOG.debug("Client SSL handler configured and added to the ChannelPipeline");
             channelPipeline.addLast("ssl", sslHandler);
@@ -63,7 +60,7 @@ public class DefaultClientPipelineFactory extends ClientPipelineFactory {
         return channelPipeline;
     }
 
-    private SslHandler configureClientSSLOnDemand() throws Exception {
+    private SslHandler configureClientSSLOnDemand(NettyProducer producer) throws Exception {
         if (!producer.getConfiguration().isSsl()) {
             return null;
         }
diff --git a/components/camel-netty/src/main/java/org/apache/camel/component/netty/DefaultServerPipelineFactory.java b/components/camel-netty/src/main/java/org/apache/camel/component/netty/DefaultServerPipelineFactory.java
index b5e7c83fc57..5b138cf7c9a 100644
--- a/components/camel-netty/src/main/java/org/apache/camel/component/netty/DefaultServerPipelineFactory.java
+++ b/components/camel-netty/src/main/java/org/apache/camel/component/netty/DefaultServerPipelineFactory.java
@@ -17,7 +17,6 @@
 package org.apache.camel.component.netty;
 
 import java.util.List;
-
 import javax.net.ssl.SSLContext;
 import javax.net.ssl.SSLEngine;
 
@@ -25,25 +24,20 @@ import org.apache.camel.component.netty.handlers.ServerChannelHandler;
 import org.apache.camel.component.netty.ssl.SSLEngineFactory;
 import org.jboss.netty.channel.ChannelDownstreamHandler;
 import org.jboss.netty.channel.ChannelPipeline;
-import org.jboss.netty.channel.ChannelPipelineFactory;
 import org.jboss.netty.channel.ChannelUpstreamHandler;
 import org.jboss.netty.channel.Channels;
 import org.jboss.netty.handler.ssl.SslHandler;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
-public class DefaultServerPipelineFactory implements ChannelPipelineFactory {
+public class DefaultServerPipelineFactory extends ServerPipelineFactory {
     private static final transient Logger LOG = LoggerFactory.getLogger(DefaultServerPipelineFactory.class);
-    private NettyConsumer consumer;
-        
-    public DefaultServerPipelineFactory(NettyConsumer consumer) {
-        this.consumer = consumer; 
-    }    
 
-    public ChannelPipeline getPipeline() throws Exception {
+    @Override
+    public ChannelPipeline getPipeline(NettyConsumer consumer) throws Exception {
         ChannelPipeline channelPipeline = Channels.pipeline();
 
-        SslHandler sslHandler = configureServerSSLOnDemand();
+        SslHandler sslHandler = configureServerSSLOnDemand(consumer);
         if (sslHandler != null) {
             LOG.debug("Server SSL handler configured and added as an interceptor against the ChannelPipeline");
             channelPipeline.addLast("ssl", sslHandler);            
@@ -64,7 +58,7 @@ public class DefaultServerPipelineFactory implements ChannelPipelineFactory {
         return channelPipeline;
     }
     
-    private SslHandler configureServerSSLOnDemand() throws Exception {
+    private SslHandler configureServerSSLOnDemand(NettyConsumer consumer) throws Exception {
         if (!consumer.getConfiguration().isSsl()) {
             return null;
         }
diff --git a/components/camel-netty/src/main/java/org/apache/camel/component/netty/NettyCamelState.java b/components/camel-netty/src/main/java/org/apache/camel/component/netty/NettyCamelState.java
index 9523d0a4d0d..d77d916f106 100644
--- a/components/camel-netty/src/main/java/org/apache/camel/component/netty/NettyCamelState.java
+++ b/components/camel-netty/src/main/java/org/apache/camel/component/netty/NettyCamelState.java
@@ -20,7 +20,11 @@ import org.apache.camel.AsyncCallback;
 import org.apache.camel.Exchange;
 
 /**
- *
+ * Stores state for {@link NettyProducer} when sending messages.
+ * <p/>
+ * This allows the {@link org.apache.camel.component.netty.handlers.ClientChannelHandler} to access
+ * this state, which is needed so we can get hold of the current {@link Exchange} and the
+ * {@link AsyncCallback} so we can continue routing the message in the Camel routing engine.
  */
 public final class NettyCamelState {
 
diff --git a/components/camel-netty/src/main/java/org/apache/camel/component/netty/NettyConsumer.java b/components/camel-netty/src/main/java/org/apache/camel/component/netty/NettyConsumer.java
index d8821c146aa..d4550d204ad 100644
--- a/components/camel-netty/src/main/java/org/apache/camel/component/netty/NettyConsumer.java
+++ b/components/camel-netty/src/main/java/org/apache/camel/component/netty/NettyConsumer.java
@@ -26,6 +26,7 @@ import org.jboss.netty.bootstrap.ConnectionlessBootstrap;
 import org.jboss.netty.bootstrap.ServerBootstrap;
 import org.jboss.netty.channel.Channel;
 import org.jboss.netty.channel.ChannelFactory;
+import org.jboss.netty.channel.ChannelPipeline;
 import org.jboss.netty.channel.FixedReceiveBufferSizePredictorFactory;
 import org.jboss.netty.channel.group.ChannelGroup;
 import org.jboss.netty.channel.group.ChannelGroupFuture;
@@ -45,6 +46,7 @@ public class NettyConsumer extends DefaultConsumer {
     private DatagramChannelFactory datagramChannelFactory;
     private ServerBootstrap serverBootstrap;
     private ConnectionlessBootstrap connectionlessServerBootstrap;
+    private ServerPipelineFactory pipelineFactory;
     private Channel channel;
     private ExecutorService bossExecutor;
     private ExecutorService workerExecutor;
@@ -63,9 +65,16 @@ public class NettyConsumer extends DefaultConsumer {
 
     @Override
     protected void doStart() throws Exception {
+        super.doStart();
+
         LOG.debug("Netty consumer binding to: {}", configuration.getAddress());
 
-        super.doStart();
+        // setup pipeline factory
+        pipelineFactory = configuration.getServerPipelineFactory();
+        if (pipelineFactory == null) {
+            pipelineFactory = new DefaultServerPipelineFactory();
+        }
+
         if (isTcp()) {
             initializeTCPServerSocketCommunicationLayer();
         } else {
@@ -97,9 +106,9 @@ public class NettyConsumer extends DefaultConsumer {
             context.getExecutorServiceManager().shutdownNow(workerExecutor);
         }
 
-        super.doStop();
-
         LOG.info("Netty consumer unbound from: " + configuration.getAddress());
+
+        super.doStop();
     }
 
     public CamelContext getContext() {
@@ -165,18 +174,16 @@ public class NettyConsumer extends DefaultConsumer {
                                                                configuration.getWorkerCount());
         }
         serverBootstrap = new ServerBootstrap(channelFactory);
-        if (configuration.getServerPipelineFactory() != null) {
-            configuration.getServerPipelineFactory().setConsumer(this);
-            serverBootstrap.setPipelineFactory(configuration.getServerPipelineFactory());
-        } else {
-            serverBootstrap.setPipelineFactory(new DefaultServerPipelineFactory(this));
-        }
         serverBootstrap.setOption("child.keepAlive", configuration.isKeepAlive());
         serverBootstrap.setOption("child.tcpNoDelay", configuration.isTcpNoDelay());
         serverBootstrap.setOption("reuseAddress", configuration.isReuseAddress());
         serverBootstrap.setOption("child.reuseAddress", configuration.isReuseAddress());
         serverBootstrap.setOption("child.connectTimeoutMillis", configuration.getConnectTimeout());
 
+        // must get the pipeline from the factory when opening a new connection
+        ChannelPipeline serverPipeline = pipelineFactory.getPipeline(this);
+        serverBootstrap.setPipeline(serverPipeline);
+
         channel = serverBootstrap.bind(new InetSocketAddress(configuration.getHost(), configuration.getPort()));
         // to keep track of all channels in use
         allChannels.add(channel);
@@ -190,12 +197,6 @@ public class NettyConsumer extends DefaultConsumer {
             datagramChannelFactory = new NioDatagramChannelFactory(workerExecutor, configuration.getWorkerCount());
         }
         connectionlessServerBootstrap = new ConnectionlessBootstrap(datagramChannelFactory);
-        if (configuration.getServerPipelineFactory() != null) {
-            configuration.getServerPipelineFactory().setConsumer(this);
-            connectionlessServerBootstrap.setPipelineFactory(configuration.getServerPipelineFactory());
-        } else {
-            connectionlessServerBootstrap.setPipelineFactory(new DefaultServerPipelineFactory(this));
-        }
         connectionlessServerBootstrap.setOption("child.keepAlive", configuration.isKeepAlive());
         connectionlessServerBootstrap.setOption("child.tcpNoDelay", configuration.isTcpNoDelay());
         connectionlessServerBootstrap.setOption("reuseAddress", configuration.isReuseAddress());
@@ -210,6 +211,10 @@ public class NettyConsumer extends DefaultConsumer {
                 new FixedReceiveBufferSizePredictorFactory(configuration.getReceiveBufferSizePredictor()));
         }
 
+        // must get the pipeline from the factory when opening a new connection
+        ChannelPipeline serverPipeline = pipelineFactory.getPipeline(this);
+        connectionlessServerBootstrap.setPipeline(serverPipeline);
+
         channel = connectionlessServerBootstrap.bind(new InetSocketAddress(configuration.getHost(), configuration.getPort()));
         // to keep track of all channels in use
         allChannels.add(channel);
diff --git a/components/camel-netty/src/main/java/org/apache/camel/component/netty/NettyProducer.java b/components/camel-netty/src/main/java/org/apache/camel/component/netty/NettyProducer.java
index 6a13343a0df..2dad41ba389 100644
--- a/components/camel-netty/src/main/java/org/apache/camel/component/netty/NettyProducer.java
+++ b/components/camel-netty/src/main/java/org/apache/camel/component/netty/NettyProducer.java
@@ -54,6 +54,7 @@ public class NettyProducer extends DefaultAsyncProducer implements ServicePoolAw
     private NettyConfiguration configuration;
     private ChannelFactory channelFactory;
     private DatagramChannelFactory datagramChannelFactory;
+    private ClientPipelineFactory pipelineFactory;
     private CamelLogger noReplyLogger;
     private ExecutorService bossExecutor;
     private ExecutorService workerExecutor;
@@ -92,6 +93,12 @@ public class NettyProducer extends DefaultAsyncProducer implements ServicePoolAw
     protected void doStart() throws Exception {
         super.doStart();
 
+        // setup pipeline factory
+        pipelineFactory = configuration.getClientPipelineFactory();
+        if (pipelineFactory == null) {
+            pipelineFactory = new DefaultClientPipelineFactory();
+        }
+
         if (isTcp()) {
             setupTCPCommunication();
         } else {
@@ -260,16 +267,8 @@ public class NettyProducer extends DefaultAsyncProducer implements ServicePoolAw
         ChannelFuture answer;
         ChannelPipeline clientPipeline;
 
-        if (configuration.getClientPipelineFactory() != null) {
-            // initialize user defined client pipeline factory
-            configuration.getClientPipelineFactory().setProducer(this);
-            clientPipeline = configuration.getClientPipelineFactory().getPipeline();
-        } else {
-            // initialize client pipeline factory
-            ClientPipelineFactory clientPipelineFactory = new DefaultClientPipelineFactory(this);
-            // must get the pipeline from the factory when opening a new connection
-            clientPipeline = clientPipelineFactory.getPipeline();
-        }
+        // must get the pipeline from the factory when opening a new connection
+        clientPipeline = pipelineFactory.getPipeline(this);
 
         if (isTcp()) {
             ClientBootstrap clientBootstrap = new ClientBootstrap(channelFactory);
@@ -283,7 +282,6 @@ public class NettyProducer extends DefaultAsyncProducer implements ServicePoolAw
             answer = clientBootstrap.connect(new InetSocketAddress(configuration.getHost(), configuration.getPort()));
             return answer;
         } else {
-            // TODO: Is this correct for a UDP client
             ConnectionlessBootstrap connectionlessClientBootstrap = new ConnectionlessBootstrap(datagramChannelFactory);
             connectionlessClientBootstrap.setOption("child.keepAlive", configuration.isKeepAlive());
             connectionlessClientBootstrap.setOption("child.tcpNoDelay", configuration.isTcpNoDelay());
@@ -295,7 +293,9 @@ public class NettyProducer extends DefaultAsyncProducer implements ServicePoolAw
 
             // set the pipeline on the bootstrap
             connectionlessClientBootstrap.setPipeline(clientPipeline);
-            connectionlessClientBootstrap.bind(new InetSocketAddress(0));
+            // bind and store channel so we can close it when stopping
+            Channel channel = connectionlessClientBootstrap.bind(new InetSocketAddress(0));
+            ALL_CHANNELS.add(channel);
             answer = connectionlessClientBootstrap.connect(new InetSocketAddress(configuration.getHost(), configuration.getPort()));
             return answer;
         }
diff --git a/components/camel-netty/src/main/java/org/apache/camel/component/netty/ServerPipelineFactory.java b/components/camel-netty/src/main/java/org/apache/camel/component/netty/ServerPipelineFactory.java
index 1cd71c44a86..b13424ceb5c 100644
--- a/components/camel-netty/src/main/java/org/apache/camel/component/netty/ServerPipelineFactory.java
+++ b/components/camel-netty/src/main/java/org/apache/camel/component/netty/ServerPipelineFactory.java
@@ -18,29 +18,26 @@ package org.apache.camel.component.netty;
 
 import org.jboss.netty.channel.ChannelPipeline;
 import org.jboss.netty.channel.ChannelPipelineFactory;
-import org.jboss.netty.channel.Channels;
 
+/**
+ * Factory to create {@link ChannelPipeline} for clients, eg {@link NettyConsumer}.
+ * <p/>
+ * Implementators should use implement the {@link #getPipeline(NettyConsumer)} method.
+ *
+ * @see ChannelPipelineFactory
+ */
 public abstract class ServerPipelineFactory implements ChannelPipelineFactory {
-    protected NettyConsumer consumer;
-      
-    public ServerPipelineFactory() {
-    }
-    
-    public ServerPipelineFactory(NettyConsumer consumer) {
-        this.consumer = consumer; 
-    }    
 
-    public ChannelPipeline getPipeline() throws Exception {
-        ChannelPipeline channelPipeline = Channels.pipeline();
-        return channelPipeline;
-    }
+    /**
+     * Returns a newly created {@link ChannelPipeline}.
+     *
+     * @param consumer the netty consumer
+     */
+    public abstract ChannelPipeline getPipeline(NettyConsumer consumer) throws Exception;
 
-    public NettyConsumer getConsumer() {
-        return consumer;
+    @Override
+    public ChannelPipeline getPipeline() throws Exception {
+        throw new UnsupportedOperationException("use getPipeline(NettyConsumer) instead");
     }
 
-    public void setConsumer(NettyConsumer consumer) {
-        this.consumer = consumer;
-    }
-    
 }
diff --git a/components/camel-netty/src/test/java/org/apache/camel/component/netty/NettyCustomPipelineFactoryAsynchTest.java b/components/camel-netty/src/test/java/org/apache/camel/component/netty/NettyCustomPipelineFactoryAsynchTest.java
index 42d796c6ee6..7c4e5479915 100644
--- a/components/camel-netty/src/test/java/org/apache/camel/component/netty/NettyCustomPipelineFactoryAsynchTest.java
+++ b/components/camel-netty/src/test/java/org/apache/camel/component/netty/NettyCustomPipelineFactoryAsynchTest.java
@@ -81,15 +81,16 @@ public class NettyCustomPipelineFactoryAsynchTest extends BaseNettyTest {
         context.stop();
         
         assertEquals("Forrest Gump: We was always taking long walks, and we was always looking for a guy named 'Charlie'", response);
-        assertEquals(true, clientPipelineFactory.isfactoryInvoked());
-        assertEquals(true, serverPipelineFactory.isfactoryInvoked());
+        assertEquals(true, clientPipelineFactory.isFactoryInvoked());
+        assertEquals(true, serverPipelineFactory.isFactoryInvoked());
     } 
     
     public class TestClientChannelPipelineFactory extends ClientPipelineFactory {
         private int maxLineSize = 1024;
         private boolean invoked;
-        
-        public ChannelPipeline getPipeline() throws Exception {
+
+        @Override
+        public ChannelPipeline getPipeline(NettyProducer producer) throws Exception {
             invoked = true;
             
             ChannelPipeline channelPipeline = Channels.pipeline();
@@ -102,7 +103,7 @@ public class NettyCustomPipelineFactoryAsynchTest extends BaseNettyTest {
             return channelPipeline;
         }
         
-        public boolean isfactoryInvoked() {
+        public boolean isFactoryInvoked() {
             return invoked;
         }
     }
@@ -110,8 +111,9 @@ public class NettyCustomPipelineFactoryAsynchTest extends BaseNettyTest {
     public class TestServerChannelPipelineFactory extends ServerPipelineFactory {
         private int maxLineSize = 1024;
         private boolean invoked;
-        
-        public ChannelPipeline getPipeline() throws Exception {
+
+        @Override
+        public ChannelPipeline getPipeline(NettyConsumer consumer) throws Exception {
             invoked = true;
             
             ChannelPipeline channelPipeline = Channels.pipeline();
@@ -124,7 +126,7 @@ public class NettyCustomPipelineFactoryAsynchTest extends BaseNettyTest {
             return channelPipeline;
         }
         
-        public boolean isfactoryInvoked() {
+        public boolean isFactoryInvoked() {
             return invoked;
         }
         
diff --git a/components/camel-netty/src/test/java/org/apache/camel/component/netty/NettyCustomPipelineFactorySynchTest.java b/components/camel-netty/src/test/java/org/apache/camel/component/netty/NettyCustomPipelineFactorySynchTest.java
index 4f6f738d1a0..3d87895524e 100644
--- a/components/camel-netty/src/test/java/org/apache/camel/component/netty/NettyCustomPipelineFactorySynchTest.java
+++ b/components/camel-netty/src/test/java/org/apache/camel/component/netty/NettyCustomPipelineFactorySynchTest.java
@@ -81,15 +81,16 @@ public class NettyCustomPipelineFactorySynchTest extends BaseNettyTest {
         context.stop();
         
         assertEquals("Forrest Gump: We was always taking long walks, and we was always looking for a guy named 'Charlie'", response);
-        assertEquals(true, clientPipelineFactory.isfactoryInvoked());
-        assertEquals(true, serverPipelineFactory.isfactoryInvoked());
+        assertEquals(true, clientPipelineFactory.isFactoryInvoked());
+        assertEquals(true, serverPipelineFactory.isFactoryInvoked());
     } 
     
     public class TestClientChannelPipelineFactory extends ClientPipelineFactory {
         private int maxLineSize = 1024;
         private boolean invoked;
-        
-        public ChannelPipeline getPipeline() throws Exception {
+
+        @Override
+        public ChannelPipeline getPipeline(NettyProducer producer) throws Exception {
             invoked = true;
             
             ChannelPipeline channelPipeline = Channels.pipeline();
@@ -102,7 +103,7 @@ public class NettyCustomPipelineFactorySynchTest extends BaseNettyTest {
             return channelPipeline;
         }
         
-        public boolean isfactoryInvoked() {
+        public boolean isFactoryInvoked() {
             return invoked;
         }
     }
@@ -110,8 +111,9 @@ public class NettyCustomPipelineFactorySynchTest extends BaseNettyTest {
     public class TestServerChannelPipelineFactory extends ServerPipelineFactory {
         private int maxLineSize = 1024;
         private boolean invoked;
-        
-        public ChannelPipeline getPipeline() throws Exception {
+
+        @Override
+        public ChannelPipeline getPipeline(NettyConsumer consumer) throws Exception {
             invoked = true;
             
             ChannelPipeline channelPipeline = Channels.pipeline();
@@ -124,7 +126,7 @@ public class NettyCustomPipelineFactorySynchTest extends BaseNettyTest {
             return channelPipeline;
         }
         
-        public boolean isfactoryInvoked() {
+        public boolean isFactoryInvoked() {
             return invoked;
         }
     }
