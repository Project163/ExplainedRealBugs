diff --git a/components/camel-hdfs/src/main/java/org/apache/camel/component/hdfs/HdfsConfiguration.java b/components/camel-hdfs/src/main/java/org/apache/camel/component/hdfs/HdfsConfiguration.java
index 79d4cf786c7..729fb58d9ac 100644
--- a/components/camel-hdfs/src/main/java/org/apache/camel/component/hdfs/HdfsConfiguration.java
+++ b/components/camel-hdfs/src/main/java/org/apache/camel/component/hdfs/HdfsConfiguration.java
@@ -33,6 +33,7 @@ public class HdfsConfiguration {
     private String path;
     private boolean overwrite = true;
     private boolean append;
+    private boolean wantAppend;
     private int bufferSize = HdfsConstants.DEFAULT_BUFFERSIZE;
     private short replication = HdfsConstants.DEFAULT_REPLICATION;
     private long blockSize = HdfsConstants.DEFAULT_BLOCKSIZE;
@@ -192,6 +193,7 @@ public class HdfsConfiguration {
 
         overwrite = getBoolean(hdfsSettings, "overwrite", overwrite);
         append = getBoolean(hdfsSettings, "append", append);
+        wantAppend = append;
         bufferSize = getInteger(hdfsSettings, "bufferSize", bufferSize);
         replication = getShort(hdfsSettings, "replication", replication);
         blockSize = getLong(hdfsSettings, "blockSize", blockSize);
@@ -254,6 +256,10 @@ public class HdfsConfiguration {
         return append;
     }
 
+    public boolean isWantAppend() {
+        return wantAppend;
+    }
+
     public void setAppend(boolean append) {
         this.append = append;
     }
diff --git a/components/camel-hdfs/src/main/java/org/apache/camel/component/hdfs/HdfsOutputStream.java b/components/camel-hdfs/src/main/java/org/apache/camel/component/hdfs/HdfsOutputStream.java
index 2bfffb6189a..a2314219b1c 100644
--- a/components/camel-hdfs/src/main/java/org/apache/camel/component/hdfs/HdfsOutputStream.java
+++ b/components/camel-hdfs/src/main/java/org/apache/camel/component/hdfs/HdfsOutputStream.java
@@ -48,10 +48,11 @@ public class HdfsOutputStream implements Closeable {
         HdfsInfo info = new HdfsInfo(ret.actualPath);
 
         ret.suffixedPath = ret.actualPath + '.' + configuration.getOpenedSuffix();
-        if (configuration.isAppend()) {
+        if (configuration.isWantAppend() || configuration.isAppend()) {
             if (!info.getFileSystem().exists(new Path(ret.actualPath))) {
                 configuration.setAppend(false);
             } else {
+                configuration.setAppend(true);
                 info = new HdfsInfo(ret.suffixedPath);
                 info.getFileSystem().rename(new Path(ret.actualPath), new Path(ret.suffixedPath));
             }
diff --git a/components/camel-hdfs/src/main/java/org/apache/camel/component/hdfs/HdfsProducer.java b/components/camel-hdfs/src/main/java/org/apache/camel/component/hdfs/HdfsProducer.java
index e96e49bb841..329e9d97384 100644
--- a/components/camel-hdfs/src/main/java/org/apache/camel/component/hdfs/HdfsProducer.java
+++ b/components/camel-hdfs/src/main/java/org/apache/camel/component/hdfs/HdfsProducer.java
@@ -181,8 +181,23 @@ public class HdfsProducer extends DefaultProducer {
             ostream = HdfsOutputStream.createOutputStream(actualPath.toString(), config);
         }
 
+        String path = ostream.getActualPath();
+        log.trace("Writing body to hdfs-file {}", path);
         ostream.append(key, body, exchange.getContext().getTypeConverter());
+
         idle.set(false);
+
+        // if no idle checker then we need to explicit close the stream after usage
+        if (scheduler == null) {
+            try {
+                ostream.close();
+                ostream = null;
+            } catch (IOException e) {
+                // ignore
+            }
+        }
+
+        log.debug("Wrote body to hdfs-file {}", path);
     }
 
     private StringBuilder newFileName() {
@@ -215,6 +230,7 @@ public class HdfsProducer extends DefaultProducer {
             if (System.currentTimeMillis() - ostream.getLastAccess() > strategy.value && !idle.get() && !ostream.isBusy().get()) {
                 idle.set(true);
                 try {
+                    HdfsProducer.this.log.trace("Closing stream as idle");
                     ostream.close();
                 } catch (IOException e) {
                     // ignore
diff --git a/components/camel-hdfs/src/test/java/org/apache/camel/component/hdfs/FromFileToHdfsTest.java b/components/camel-hdfs/src/test/java/org/apache/camel/component/hdfs/FromFileToHdfsTest.java
new file mode 100644
index 00000000000..d0f86c324a6
--- /dev/null
+++ b/components/camel-hdfs/src/test/java/org/apache/camel/component/hdfs/FromFileToHdfsTest.java
@@ -0,0 +1,115 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.camel.component.hdfs;
+
+import java.io.File;
+
+import org.apache.camel.Exchange;
+import org.apache.camel.builder.NotifyBuilder;
+import org.apache.camel.builder.RouteBuilder;
+import org.apache.camel.test.junit4.CamelTestSupport;
+import org.apache.hadoop.conf.Configuration;
+import org.apache.hadoop.fs.FileSystem;
+import org.apache.hadoop.fs.Path;
+import org.junit.Before;
+import org.junit.Test;
+
+/**
+ *
+ */
+public class FromFileToHdfsTest extends CamelTestSupport {
+
+    private static final Path TEMP_DIR = new Path(new File("target/outbox/").getAbsolutePath());
+
+    //Hadoop doesn't run on IBM JDK
+    private static final boolean SKIP = System.getProperty("java.vendor").contains("IBM");
+
+    @Before
+    public void setUp() throws Exception {
+        if (SKIP) {
+            return;
+        }
+        deleteDirectory("target/inbox");
+        deleteDirectory("target/outbox");
+        super.setUp();
+    }
+
+    @Override
+    public void tearDown() throws Exception {
+        if (SKIP) {
+            return;
+        }
+
+        super.tearDown();
+        Configuration conf = new Configuration();
+        Path dir = new Path("target/outbox");
+        FileSystem fs = FileSystem.get(dir.toUri(), conf);
+        fs.delete(dir, true);
+    }
+
+    @Test
+    public void testFileToHdfs() throws Exception {
+        if (SKIP) {
+            return;
+        }
+
+        NotifyBuilder notify = new NotifyBuilder(context).whenDone(1).create();
+
+        template.sendBodyAndHeader("file:target/inbox", "Hello World", Exchange.FILE_NAME, "hello.txt");
+
+        notify.matchesMockWaitTime();
+
+        File delete = new File("target/inbox/hello.txt");
+        assertTrue("File should be deleted " + delete, !delete.exists());
+
+        File create = new File(TEMP_DIR + "/output.txt");
+        assertTrue("File should be created " + create, create.exists());
+    }
+
+    @Test
+    public void testTwoFilesToHdfs() throws Exception {
+        if (SKIP) {
+            return;
+        }
+
+        NotifyBuilder notify = new NotifyBuilder(context).whenDone(2).create();
+
+        template.sendBodyAndHeader("file:target/inbox", "Hello World", Exchange.FILE_NAME, "hello.txt");
+        template.sendBodyAndHeader("file:target/inbox", "Bye World", Exchange.FILE_NAME, "bye.txt");
+
+        notify.matchesMockWaitTime();
+
+        File delete = new File("target/inbox/hello.txt");
+        assertTrue("File should be deleted " + delete, !delete.exists());
+        delete = new File("target/inbox/bye.txt");
+        assertTrue("File should be deleted " + delete, !delete.exists());
+
+        File create = new File(TEMP_DIR + "/output.txt");
+        assertTrue("File should be created " + create, create.exists());
+    }
+
+    @Override
+    protected RouteBuilder createRouteBuilder() throws Exception {
+        return new RouteBuilder() {
+            @Override
+            public void configure() throws Exception {
+                from("file:target/inbox?delete=true")
+                    .to("hdfs:///" + TEMP_DIR.toUri() + "/output.txt?fileSystemType=LOCAL");
+            }
+        };
+    }
+}
diff --git a/components/camel-hdfs/src/test/java/org/apache/camel/component/hdfs/HdfsProducerFileWriteTest.java b/components/camel-hdfs/src/test/java/org/apache/camel/component/hdfs/HdfsProducerFileWriteTest.java
deleted file mode 100644
index 51cd81eb7ec..00000000000
--- a/components/camel-hdfs/src/test/java/org/apache/camel/component/hdfs/HdfsProducerFileWriteTest.java
+++ /dev/null
@@ -1,289 +0,0 @@
-/**
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.camel.component.hdfs;
-
-import java.io.ByteArrayOutputStream;
-import java.io.File;
-import java.io.InputStream;
-import java.net.URL;
-import java.nio.ByteBuffer;
-
-import org.apache.camel.builder.NotifyBuilder;
-import org.apache.camel.builder.RouteBuilder;
-import org.apache.camel.test.junit4.CamelTestSupport;
-import org.apache.hadoop.conf.Configuration;
-import org.apache.hadoop.fs.FileSystem;
-import org.apache.hadoop.fs.Path;
-import org.apache.hadoop.io.BytesWritable;
-import org.apache.hadoop.io.IOUtils;
-import org.apache.hadoop.io.MapFile;
-import org.apache.hadoop.io.SequenceFile;
-import org.apache.hadoop.io.Text;
-import org.apache.hadoop.io.Writable;
-import org.apache.hadoop.util.ReflectionUtils;
-import org.junit.Before;
-import org.junit.Test;
-
-public class HdfsProducerFileWriteTest extends CamelTestSupport {
-    //Hadoop doesn't run on IBM JDK
-    private static final boolean SKIP = isJavaVendor("IBM");
-
-    @Before
-    public void setUp() throws Exception {
-        if (SKIP) {
-            return;
-        }
-        super.setUp();
-        deleteDirectory("target/test");
-    }
-    
-    @Test
-    public void testSimpleWriteFile() throws Exception {
-        if (SKIP) {
-            return;
-        }
-
-        final Path file = new Path(new File("target/test/test-camel-simple-write-file").getAbsolutePath());
-
-        deleteDirectory("target/file-batch1");
-        context.addRoutes(new RouteBuilder() {
-            @Override
-            public void configure() throws Exception {
-                from("file://target/file-batch1?sortBy=file:name")
-                        .to("hdfs:///" + file.toUri() + "?fileSystemType=LOCAL");
-            }
-        });
-
-        context.start();
-
-        NotifyBuilder nb = new NotifyBuilder(context).whenDone(10).create();
-
-        for (int i = 0; i < 10; ++i) {
-            template.sendBodyAndHeader("file://target/file-batch1/", "CIAO", "CamelFileName", "CIAO" + i);
-        }
-
-        assertTrue("Timeout waiting for match" + nb.toString(), nb.matchesMockWaitTime());
-        context.stop();
-
-        InputStream in = null;
-        try {
-            in = new URL("file:///" + file.toUri()).openStream();
-            ByteArrayOutputStream bos = new ByteArrayOutputStream();
-            IOUtils.copyBytes(in, bos, 4096, false);
-            assertEquals(40, bos.size());
-        } finally {
-            IOUtils.closeStream(in);
-        }
-    }
-
-    @Test
-    public void testSequenceWriteFile() throws Exception {
-        if (SKIP) {
-            return;
-        }
-
-        final Path file = new Path(new File("target/test/test-camel-simple-write-file1").getAbsolutePath());
-        deleteDirectory("target/file-batch2");
-
-        context.addRoutes(new RouteBuilder() {
-            @Override
-            public void configure() throws Exception {
-                from("file://target/file-batch2?sortBy=file:name")
-                        .to("hdfs:///" + file.toUri() + "?fileSystemType=LOCAL&fileType=SEQUENCE_FILE");
-            }
-        });
-
-        context.start();
-
-        NotifyBuilder nb = new NotifyBuilder(context).whenDone(10).create();
-
-        for (int i = 0; i < 10; ++i) {
-            template.sendBodyAndHeader("file://target/file-batch2", "CIAO", "CamelFileName", "CIAO" + i);
-        }
-
-        assertTrue("Timeout waiting for match" + nb.toString(), nb.matchesMockWaitTime());
-        context.stop();
-
-        Configuration conf = new Configuration();
-        Path file1 = new Path("file:///" + file.toUri());
-        FileSystem fs1 = FileSystem.get(file1.toUri(), conf);
-        SequenceFile.Reader reader = new SequenceFile.Reader(fs1, file1, conf);
-        Writable key = (Writable) ReflectionUtils.newInstance(reader.getKeyClass(), conf);
-        BytesWritable value = (BytesWritable) ReflectionUtils.newInstance(reader.getValueClass(), conf);
-        int i = 0;
-        while (reader.next(key, value)) {
-            String str = new String(value.getBytes(), 0, value.getLength());
-            assertEquals("CIAO", str);
-            i++;
-        }
-        assertEquals(10, i);
-    }
-
-    @Test
-    public void testSequenceKeyWriteFile() throws Exception {
-        if (SKIP) {
-            return;
-        }
-
-        final Path file = new Path(new File("target/test/test-camel-simple-write-file2").getAbsolutePath());
-        deleteDirectory("target/file-batch3");
-
-        context.addRoutes(new RouteBuilder() {
-            @Override
-            public void configure() throws Exception {
-                from("file://target/file-batch3?sortBy=file:name")
-                        .setHeader("KEY").simple("${in.header.CamelFileName}")
-                        .to("hdfs:///" + file.toUri() + "?fileSystemType=LOCAL&keyType=TEXT&fileType=SEQUENCE_FILE");
-            }
-        });
-
-        context.start();
-
-        NotifyBuilder nb = new NotifyBuilder(context).whenDone(10).create();
-
-        for (int i = 0; i < 10; ++i) {
-            template.sendBodyAndHeader("file://target/file-batch3", "CIAO", "CamelFileName", "CIAO" + i);
-        }
-
-        assertTrue("Timeout waiting for match" + nb.toString(), nb.matchesMockWaitTime());
-        context.stop();
-
-        Configuration conf = new Configuration();
-        Path file1 = new Path("file:///" + file.toUri());
-        FileSystem fs1 = FileSystem.get(file1.toUri(), conf);
-        SequenceFile.Reader reader = new SequenceFile.Reader(fs1, file1, conf);
-        Text key = (Text) ReflectionUtils.newInstance(reader.getKeyClass(), conf);
-        BytesWritable value = (BytesWritable) ReflectionUtils.newInstance(reader.getValueClass(), conf);
-        int i = 0;
-        while (reader.next(key, value)) {
-            String str = new String(value.getBytes(), 0, value.getLength());
-            assertEquals("CIAO", str);
-            assertEquals("CIAO" + i, key.toString());
-            i++;
-        }
-        assertEquals(10, i);
-    }
-
-    @Test
-    public void testMapKeyWriteFile() throws Exception {
-        if (SKIP) {
-            return;
-        }
-
-        final Path file = new Path(new File("target/test/test-camel-simple-write-file3").getAbsolutePath());
-        deleteDirectory("target/file-batch4");
-
-        context.addRoutes(new RouteBuilder() {
-            @Override
-            public void configure() throws Exception {
-                from("file://target/file-batch4?sortBy=file:name")
-                        .setHeader("KEY").simple("${in.header.CamelFileName}")
-                        .to("hdfs:///" + file.toUri() + "?fileSystemType=LOCAL&keyType=TEXT&fileType=MAP_FILE");
-            }
-        });
-
-        context.start();
-
-        NotifyBuilder nb = new NotifyBuilder(context).whenDone(10).create();
-
-        for (int i = 0; i < 10; ++i) {
-            template.sendBodyAndHeader("file://target/file-batch4", "CIAO" + i, "CamelFileName", "CIAO" + i);
-        }
-
-        assertTrue("Timeout waiting for match" + nb.toString(), nb.matchesMockWaitTime());
-        context.stop();
-
-        Configuration conf = new Configuration();
-        Path file1 = new Path("file:///" + file.toUri());
-        FileSystem fs1 = FileSystem.get(file1.toUri(), conf);
-        MapFile.Reader reader = new MapFile.Reader(fs1, "target/test/test-camel-simple-write-file3", conf);
-        for (int i = 0; i < 10; ++i) {
-            Text key = new Text("CIAO" + i);
-            BytesWritable value = new BytesWritable();
-            reader.get(key, value);
-            String str = new String(value.getBytes(), 0, value.getLength());
-            assertEquals("CIAO" + i, str);
-            assertEquals("CIAO" + i, key.toString());
-        }
-    }
-
-
-    @Test
-    public void testSequenceKeyWriteBigFile() throws Exception {
-        if (SKIP) {
-            return;
-        }
-
-        final Path file = new Path(new File("target/test/test-camel-simple-write-file4").getAbsolutePath());
-        deleteDirectory("target/file-batch5");
-
-        context.addRoutes(new RouteBuilder() {
-            @Override
-            public void configure() throws Exception {
-                from("file://target/file-batch5?sortBy=file:name")
-                        .to("hdfs:///" + file.toUri() + "?fileSystemType=LOCAL&fileType=SEQUENCE_FILE&splitStrategy=IDLE:100&checkIdleInterval=10");
-            }
-        });
-
-        context.start();
-
-        NotifyBuilder nb = new NotifyBuilder(context).whenDone(1).create();
-
-        ByteBuffer bb = ByteBuffer.allocate(8 * 1024 * 1024);
-        for (int i = 0; i < 8 * 1024 * 512; ++i) {
-            bb.putChar('A');
-        }
-        for (int i = 0; i < 1; ++i) {
-            template.sendBodyAndHeader("file://target/file-batch5", bb, "CamelFileName", "CIAO" + i);
-        }
-
-        assertTrue("Timeout waiting for match" + nb.toString(), nb.matchesMockWaitTime());
-        context.stop();
-
-        Configuration conf = new Configuration();
-        Path file1 = new Path("file:///" + file.toUri() + '/' + HdfsConstants.DEFAULT_SEGMENT_PREFIX + 0);
-        FileSystem fs1 = FileSystem.get(file1.toUri(), conf);
-        SequenceFile.Reader reader = new SequenceFile.Reader(fs1, file1, conf);
-        Writable key = (Writable) ReflectionUtils.newInstance(reader.getKeyClass(), conf);
-        BytesWritable value = (BytesWritable) ReflectionUtils.newInstance(reader.getValueClass(), conf);
-        int i = 0;
-        while (reader.next(key, value)) {
-            assertEquals(value.getLength(), 8 * 1024 * 1024);
-            i++;
-        }
-        assertEquals(1, i);
-    }
-
-    @Override
-    public void tearDown() throws Exception {
-        if (SKIP) {
-            return;
-        }
-
-        super.tearDown();
-        Configuration conf = new Configuration();
-        Path dir = new Path("target/test");
-        FileSystem fs = FileSystem.get(dir.toUri(), conf);
-        fs.delete(dir, true);
-    }
-
-    @Override
-    public boolean isUseRouteBuilder() {
-        return false;
-    }
-
-}
diff --git a/components/camel-hdfs/src/test/java/org/apache/camel/component/hdfs/HdfsProducerTest.java b/components/camel-hdfs/src/test/java/org/apache/camel/component/hdfs/HdfsProducerTest.java
index 55e14117a4c..d8f960d2923 100644
--- a/components/camel-hdfs/src/test/java/org/apache/camel/component/hdfs/HdfsProducerTest.java
+++ b/components/camel-hdfs/src/test/java/org/apache/camel/component/hdfs/HdfsProducerTest.java
@@ -58,22 +58,16 @@ public class HdfsProducerTest extends CamelTestSupport {
         if (SKIP) {
             return;
         }
-        for (int i = 0; i < 10; ++i) {
-            template.sendBody("direct:start1", "PAPPO" + i);
-        }
-        stopCamelContext();
+        template.sendBody("direct:start1", "PAPPO");
+
         Configuration conf = new Configuration();
         Path file1 = new Path("file:///" + TEMP_DIR.toUri() + "test-camel1");
         FileSystem fs1 = FileSystem.get(file1.toUri(), conf);
         SequenceFile.Reader reader = new SequenceFile.Reader(fs1, file1, conf);
         Writable key = (Writable) ReflectionUtils.newInstance(reader.getKeyClass(), conf);
         Writable value = (Writable) ReflectionUtils.newInstance(reader.getValueClass(), conf);
-        int i = 0;
-        while (reader.next(key, value)) {
-            Text txt = (Text) value;
-            assertTrue(("PAPPO" + i).equals(txt.toString()));
-            ++i;
-        }
+        reader.next(key, value);
+        assertEquals("PAPPO", value.toString());
     }
 
     @Test
@@ -83,7 +77,7 @@ public class HdfsProducerTest extends CamelTestSupport {
         }
         Boolean aBoolean = true;
         template.sendBody("direct:write_boolean", aBoolean);
-        stopCamelContext();
+
         Configuration conf = new Configuration();
         Path file1 = new Path("file:///" + TEMP_DIR.toUri() + "test-camel-boolean");
         FileSystem fs1 = FileSystem.get(file1.toUri(), conf);
@@ -102,7 +96,7 @@ public class HdfsProducerTest extends CamelTestSupport {
         }
         byte aByte = 8;
         template.sendBody("direct:write_byte", aByte);
-        stopCamelContext();
+
         Configuration conf = new Configuration();
         Path file1 = new Path("file:///" + TEMP_DIR.toUri() + "test-camel-byte");
         FileSystem fs1 = FileSystem.get(file1.toUri(), conf);
@@ -121,7 +115,7 @@ public class HdfsProducerTest extends CamelTestSupport {
         }
         int anInt = 1234;
         template.sendBody("direct:write_int", anInt);
-        stopCamelContext();
+
         Configuration conf = new Configuration();
         Path file1 = new Path("file:///" + TEMP_DIR.toUri() + "test-camel-int");
         FileSystem fs1 = FileSystem.get(file1.toUri(), conf);
@@ -140,7 +134,7 @@ public class HdfsProducerTest extends CamelTestSupport {
         }
         float aFloat = 12.34f;
         template.sendBody("direct:write_float", aFloat);
-        stopCamelContext();
+
         Configuration conf = new Configuration();
         Path file1 = new Path("file:///" + TEMP_DIR.toUri() + "test-camel-float");
         FileSystem fs1 = FileSystem.get(file1.toUri(), conf);
@@ -159,7 +153,7 @@ public class HdfsProducerTest extends CamelTestSupport {
         }
         Double aDouble = 12.34D;
         template.sendBody("direct:write_double", aDouble);
-        stopCamelContext();
+
         Configuration conf = new Configuration();
         Path file1 = new Path("file:///" + TEMP_DIR.toUri() + "test-camel-double");
         FileSystem fs1 = FileSystem.get(file1.toUri(), conf);
@@ -178,7 +172,7 @@ public class HdfsProducerTest extends CamelTestSupport {
         }
         long aLong = 1234567890;
         template.sendBody("direct:write_long", aLong);
-        stopCamelContext();
+
         Configuration conf = new Configuration();
         Path file1 = new Path("file:///" + TEMP_DIR.toUri() + "test-camel-long");
         FileSystem fs1 = FileSystem.get(file1.toUri(), conf);
@@ -197,7 +191,7 @@ public class HdfsProducerTest extends CamelTestSupport {
         }
         String txt = "CIAO MONDO !";
         template.sendBody("direct:write_text1", txt);
-        stopCamelContext();
+
         Configuration conf = new Configuration();
         Path file1 = new Path("file:///" + TEMP_DIR.toUri() + "test-camel-text1");
         FileSystem fs1 = FileSystem.get(file1.toUri(), conf);
@@ -217,7 +211,7 @@ public class HdfsProducerTest extends CamelTestSupport {
         String txtKey = "THEKEY";
         String txtValue = "CIAO MONDO !";
         template.sendBodyAndHeader("direct:write_text2", txtValue, "KEY", txtKey);
-        stopCamelContext();
+
         Configuration conf = new Configuration();
         Path file1 = new Path("file:///" + TEMP_DIR.toUri() + "test-camel-text2");
         FileSystem fs1 = FileSystem.get(file1.toUri(), conf);
@@ -237,7 +231,7 @@ public class HdfsProducerTest extends CamelTestSupport {
         String txtKey = "THEKEY";
         String txtValue = "CIAO MONDO !";
         template.sendBodyAndHeader("direct:write_text3", txtValue, "KEY", txtKey);
-        stopCamelContext();
+
         Configuration conf = new Configuration();
         Path file1 = new Path("file:///" + TEMP_DIR.toUri() + "test-camel-text3");
         FileSystem fs1 = FileSystem.get(file1.toUri(), conf);
@@ -256,7 +250,7 @@ public class HdfsProducerTest extends CamelTestSupport {
         }
         String txtValue = "CIAO MONDO !";
         template.sendBody("direct:write_text4", txtValue);
-        stopCamelContext();
+
         Configuration conf = new Configuration();
         Path file1 = new Path("file:///" + TEMP_DIR.toUri() + "test-camel-text4");
         FileSystem fs1 = FileSystem.get(file1.toUri(), conf);
@@ -274,7 +268,7 @@ public class HdfsProducerTest extends CamelTestSupport {
         String txtKey = "THEKEY";
         String txtValue = "CIAO MONDO !";
         template.sendBodyAndHeader("direct:write_text5", txtValue, "KEY", txtKey);
-        stopCamelContext();
+
         Configuration conf = new Configuration();
         Path file1 = new Path("file:///" + TEMP_DIR.toUri() + "test-camel-text5");
         FileSystem fs1 = FileSystem.get(file1.toUri(), conf);
@@ -292,7 +286,8 @@ public class HdfsProducerTest extends CamelTestSupport {
             return;
         }
         super.tearDown();
-        Thread.sleep(100);
+
+        Thread.sleep(250);
         Configuration conf = new Configuration();
         Path dir = new Path("target/test");
         FileSystem fs = FileSystem.get(dir.toUri(), conf);
diff --git a/components/camel-hdfs/src/test/java/org/apache/camel/component/hdfs/integration/HdfsAppendTest.java b/components/camel-hdfs/src/test/java/org/apache/camel/component/hdfs/integration/HdfsAppendTest.java
index 4797e570964..57fac15b64b 100644
--- a/components/camel-hdfs/src/test/java/org/apache/camel/component/hdfs/integration/HdfsAppendTest.java
+++ b/components/camel-hdfs/src/test/java/org/apache/camel/component/hdfs/integration/HdfsAppendTest.java
@@ -63,7 +63,6 @@ public class HdfsAppendTest extends CamelTestSupport {
         for (int i = 0; i < 10; ++i) {
             template.sendBody("direct:start1", "PIPPO");
         }
-        stopCamelContext();
 
         Configuration conf = new Configuration();
         Path file = new Path("hdfs://localhost:9000/tmp/test/test-camel-simple-write-file1");
@@ -82,7 +81,8 @@ public class HdfsAppendTest extends CamelTestSupport {
     @Override
     public void tearDown() throws Exception {
         super.tearDown();
-        Thread.sleep(100);
+
+        Thread.sleep(250);
         Configuration conf = new Configuration();
         Path dir = new Path("hdfs://localhost:9000/tmp/test");
         FileSystem fs = FileSystem.get(dir.toUri(), conf);
diff --git a/components/camel-hdfs/src/test/java/org/apache/camel/component/hdfs/integration/HdfsProducerConsumerIntegrationTest.java b/components/camel-hdfs/src/test/java/org/apache/camel/component/hdfs/integration/HdfsProducerConsumerIntegrationTest.java
index 75b836726b8..1392c1854c7 100644
--- a/components/camel-hdfs/src/test/java/org/apache/camel/component/hdfs/integration/HdfsProducerConsumerIntegrationTest.java
+++ b/components/camel-hdfs/src/test/java/org/apache/camel/component/hdfs/integration/HdfsProducerConsumerIntegrationTest.java
@@ -25,7 +25,6 @@ import org.apache.camel.test.junit4.CamelTestSupport;
 import org.apache.hadoop.conf.Configuration;
 import org.apache.hadoop.fs.FileSystem;
 import org.apache.hadoop.fs.Path;
-
 import org.junit.After;
 import org.junit.Ignore;
 import org.junit.Test;
@@ -69,7 +68,8 @@ public class HdfsProducerConsumerIntegrationTest extends CamelTestSupport {
     @After
     public void tearDown() throws Exception {
         super.tearDown();
-        Thread.sleep(100);
+
+        Thread.sleep(250);
         Configuration conf = new Configuration();
         Path dir = new Path("hdfs://localhost:9000/tmp/test");
         FileSystem fs = FileSystem.get(dir.toUri(), conf);
