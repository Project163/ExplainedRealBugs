diff --git a/examples/camel-example-cdi/README.txt b/examples/camel-example-cdi/README.txt
index c92b952a979..a44f33b3638 100644
--- a/examples/camel-example-cdi/README.txt
+++ b/examples/camel-example-cdi/README.txt
@@ -21,22 +21,6 @@ You can see the routing rules by looking at the java code in the
 When we launch the example using the camel maven plugin, a local CDI container
 is created and started.
 
-Additionally there are maven profiles being defined by this example (see pom.xml for details)
-which allow to test using arquillian the project in weld container, jboss-as, ...
-
-To run the example with Arquillian & JBossAS 7.x managed, type
-  mvn test -Parquillian-jbossas-managed
-  
-And for Arquillian & Weld
-  mvn test -Parquillian-weld-ee-embedded
-
-Please note that both the JBoss as well as Weld maven artifacts are pretty
-big in size so be patient as maven downloads them into your local repository for
-the first time.
-
-This example is documented at
-  http://camel.apache.org/cdi-example.html
-
 If you hit any problems please talk to us on the Camel Forums
   http://camel.apache.org/discussion-forums.html
   
diff --git a/examples/camel-example-cdi/pom.xml b/examples/camel-example-cdi/pom.xml
index 21278eb16f1..248877a8e4d 100644
--- a/examples/camel-example-cdi/pom.xml
+++ b/examples/camel-example-cdi/pom.xml
@@ -14,327 +14,79 @@
     the specific language governing permissions and limitations under the
     License.
   -->
-<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
-    <modelVersion>4.0.0</modelVersion>
-
-    <parent>
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+  <modelVersion>4.0.0</modelVersion>
+
+  <parent>
+    <groupId>org.apache.camel</groupId>
+    <artifactId>examples</artifactId>
+    <version>2.16-SNAPSHOT</version>
+  </parent>
+
+  <artifactId>camel-example-cdi</artifactId>
+  <packaging>jar</packaging>
+  <name>Camel :: Example :: CDI</name>
+  <description>An example showing how to work with Camel and CDI for dependency injection</description>
+
+  <dependencies>
+
+    <dependency>
+      <groupId>org.apache.camel</groupId>
+      <artifactId>camel-cdi</artifactId>
+    </dependency>
+
+    <!-- the various CDI/JEE annotations -->
+    <dependency>
+      <groupId>javax.inject</groupId>
+      <artifactId>javax.inject</artifactId>
+      <version>1</version>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.geronimo.specs</groupId>
+      <artifactId>geronimo-ejb_3.1_spec</artifactId>
+      <version>1.0.2</version>
+    </dependency>
+    <dependency>
+      <groupId>javax.enterprise</groupId>
+      <artifactId>cdi-api</artifactId>
+      <version>1.2</version>
+    </dependency>
+
+    <!-- lets use deltaspike & weld -->
+    <dependency>
+      <groupId>org.apache.deltaspike.cdictrl</groupId>
+      <artifactId>deltaspike-cdictrl-weld</artifactId>
+      <version>${deltaspike-version}</version>
+    </dependency>
+    <dependency>
+      <groupId>org.jboss.weld.se</groupId>
+      <artifactId>weld-se-core</artifactId>
+      <version>${weld2-version}</version>
+    </dependency>
+
+    <!-- logging -->
+    <dependency>
+      <groupId>org.slf4j</groupId>
+      <artifactId>slf4j-log4j12</artifactId>
+    </dependency>
+
+  </dependencies>
+
+  <build>
+
+    <plugins>
+      <!-- allows the routes to be run via 'mvn camel:run' -->
+      <plugin>
         <groupId>org.apache.camel</groupId>
-        <artifactId>examples</artifactId>
-        <version>2.16-SNAPSHOT</version>
-    </parent>
-
-    <artifactId>camel-example-cdi</artifactId>
-    <packaging>war</packaging>
-    <name>Camel :: Example :: CDI</name>
-    <description>An example showing how to work with Camel and CDI for dependency injection</description>
-
-	  <!-- TODO this example is packaged as WAR why the osgi imports? -->
-    <!-- TODO: remove the arquillian tests - this should be a simple example -->
-    <properties>
-        <camel.osgi.export>org.apache.camel.example.cdi.*</camel.osgi.export>
-        <camel.osgi.import>
-            javax.ejb,
-            javax.inject,
-            org.apache.camel,
-            org.apache.camel.builder,
-            org.apache.camel.model,
-            org.apache.camel.cdi,
-            org.apache.activemq.broker,
-            org.apache.activemq.camel.component,
-            org.apache.activemq.pool,
-            org.apache.activemq.xbean
-        </camel.osgi.import>
-        <!-- avoid to import the bunch of spring related package -->
-        <camel.osgi.dynamic>org.springframework.*</camel.osgi.dynamic>
-    </properties>
-
-    <dependencies>
-
-        <dependency>
-            <groupId>org.apache.camel</groupId>
-            <artifactId>camel-cdi</artifactId>
-        </dependency>
-
-        <!-- we make use of the javax.ejb.Startup API while running the example -->
-        <!-- embedded inside glassfish/jbossas (see the 2 profiles below) -->
-        <dependency>
-            <groupId>org.apache.geronimo.specs</groupId>
-            <artifactId>geronimo-ejb_3.1_spec</artifactId>
-            <version>${geronimo-ejb_3.1_spec-version}</version>
-            <scope>provided</scope>
-        </dependency>
-
-        <!-- logging -->
-        <dependency>
-            <groupId>org.slf4j</groupId>
-            <artifactId>slf4j-log4j12</artifactId>
-        </dependency>
-
-        <!-- for testing -->
-        <dependency>
-            <groupId>junit</groupId>
-            <artifactId>junit</artifactId>
-            <scope>test</scope>
-        </dependency>
-        <dependency>
-            <groupId>org.jboss.arquillian.junit</groupId>
-            <artifactId>arquillian-junit-container</artifactId>
-            <version>${arquillian-junit-container-version}</version>
-            <scope>test</scope>
-        </dependency>
-        <dependency>
-            <groupId>org.jboss.shrinkwrap.resolver</groupId>
-            <artifactId>shrinkwrap-resolver-impl-maven</artifactId>
-            <version>2.0.0-alpha-4</version>
-            <scope>test</scope>
-        </dependency>
-    </dependencies>
-
-    <build>
-        <plugins>
-            <!-- allows the routes to be run via 'mvn camel:run' -->
-            <plugin>
-                <groupId>org.apache.camel</groupId>
-                <artifactId>camel-maven-plugin</artifactId>
-                <version>${project.version}</version>
-                <configuration>
-                    <useCDI>true</useCDI>
-                </configuration>
-                <dependencies>
-                    <!-- lets use deltaspike & weld -->
-                    <dependency>
-                        <groupId>org.apache.deltaspike.cdictrl</groupId>
-                        <artifactId>deltaspike-cdictrl-weld</artifactId>
-                        <version>${deltaspike-version}</version>
-                    </dependency>
-                    <dependency>
-                        <groupId>org.jboss.weld.se</groupId>
-                        <artifactId>weld-se-core</artifactId>
-                        <version>${weld2-version}</version>
-                    </dependency>
-                </dependencies>
-            </plugin>
-
-            <plugin>
-                <groupId>org.apache.maven.plugins</groupId>
-                <artifactId>maven-war-plugin</artifactId>
-                <configuration>
-                    <webResources>
-                        <!-- place the legal files under the META-INF folder -->
-                        <resource>
-                            <directory>src/main/resources/META-INF</directory>
-                            <targetPath>META-INF</targetPath>
-                            <includes>
-                                <include>*.txt</include>
-                            </includes>
-                        </resource>
-                        <!-- place beans.xml where it's expected to be, that's under the path WEB-INF/beans.xml -->
-                        <resource>
-                            <directory>src/main/resources/META-INF</directory>
-                            <targetPath>WEB-INF</targetPath>
-                            <includes>
-                                <include>beans.xml</include>
-                            </includes>
-                        </resource>
-                    </webResources>
-                    <!-- exclude beans.xml from the root of the WAR -->
-                    <packagingExcludes>beans.xml</packagingExcludes>
-                    <failOnMissingWebXml>false</failOnMissingWebXml>
-                </configuration>
-            </plugin>
-        </plugins>
-    </build>
-
-    <profiles>
-        <profile>
-            <id>arquillian-weld-ee-embedded</id>
-            <activation>
-                <activeByDefault>true</activeByDefault>
-            </activation>
-            <dependencies>
-                <dependency>
-                    <groupId>org.jboss.spec</groupId>
-                    <artifactId>jboss-javaee-6.0</artifactId>
-                    <version>${jboss-javaee-6-version}</version>
-                    <type>pom</type>
-                    <scope>provided</scope>
-                </dependency>
-                <dependency>
-                    <groupId>org.jboss.arquillian.container</groupId>
-                    <artifactId>arquillian-weld-ee-embedded-1.1</artifactId>
-                    <version>${arquillian-weld-ee-embedded-version}</version>
-                    <scope>test</scope>
-                </dependency>
-                <dependency>
-                    <groupId>org.jboss.weld</groupId>
-                    <artifactId>weld-core</artifactId>
-                    <version>${weld2-version}</version>
-                    <scope>test</scope>
-                </dependency>
-            </dependencies>
-            <build>
-                <plugins>
-                    <plugin>
-                        <!-- lets re-enable IntegrationTeeest -->
-                        <groupId>org.apache.maven.plugins</groupId>
-                        <artifactId>maven-surefire-plugin</artifactId>
-                        <configuration>
-                            <systemPropertyVariables>
-                                <arquillian.launch>weld-ee-embedded</arquillian.launch>
-                                <arquillian>weld-ee-embedded</arquillian>
-                            </systemPropertyVariables>
-                            <includes>
-                                <!--<include>**/*Test.java</include>-->
-                            </includes>
-                            <excludes>
-                                <exclude>**/*Test*.java</exclude>
-                                <exclude>**/*JBoss*.java</exclude>
-                            </excludes>
-                        </configuration>
-                    </plugin>
-                </plugins>
-
-            </build>
-        </profile>
-
-        <profile>
-            <id>arquillian-jbossas-managed</id>
-            <properties>
-                <jboss-arquillian-version>7.1.1.Final</jboss-arquillian-version>
-                <arquillian-version>1.0.0.CR6</arquillian-version>
-                <maven.test.skip>false</maven.test.skip>
-            </properties>
-            <dependencies>
-                <dependency>
-                    <groupId>org.jboss.spec</groupId>
-                    <artifactId>jboss-javaee-6.0</artifactId>
-                    <version>${jboss-javaee-6-version}</version>
-                    <type>pom</type>
-                    <scope>provided</scope>
-                </dependency>
-                <dependency>
-                    <groupId>org.jboss.as</groupId>
-                    <artifactId>jboss-as-arquillian-container-managed</artifactId>
-                    <version>${jboss-arquillian-version}</version>
-                    <scope>test</scope>
-                </dependency>
-                <dependency>
-                    <groupId>org.jboss.arquillian.protocol</groupId>
-                    <artifactId>arquillian-protocol-servlet</artifactId>
-                    <version>${arquillian-version}</version>
-                    <scope>test</scope>
-                </dependency>
-                <dependency>
-                    <groupId>org.jboss.shrinkwrap.resolver</groupId>
-                    <artifactId>shrinkwrap-resolver-impl-maven</artifactId>
-                    <version>2.0.0-alpha-4</version>
-                    <scope>test</scope>
-                </dependency>
-            </dependencies>
-            <build>
-                <plugins>
-                    <plugin>
-                        <artifactId>maven-dependency-plugin</artifactId>
-                        <executions>
-                            <execution>
-                                <id>unpack</id>
-                                <phase>process-test-classes</phase>
-                                <goals>
-                                    <goal>unpack</goal>
-                                </goals>
-                                <configuration>
-                                    <artifactItems>
-                                        <artifactItem>
-                                            <groupId>org.jboss.as</groupId>
-                                            <artifactId>jboss-as-dist</artifactId>
-                                            <version>${jboss-arquillian-version}</version>
-                                            <type>zip</type>
-                                            <overWrite>false</overWrite>
-                                            <outputDirectory>target</outputDirectory>
-                                        </artifactItem>
-                                    </artifactItems>
-                                </configuration>
-                            </execution>
-                        </executions>
-                    </plugin>
-                    <plugin>
-                        <!-- lets re-enable IntegrationTeeest -->
-                        <groupId>org.apache.maven.plugins</groupId>
-                        <artifactId>maven-surefire-plugin</artifactId>
-                        <configuration>
-                            <systemPropertyVariables>
-                                <arquillian.launch>jbossas-managed</arquillian.launch>
-                                <arquillian>jbossas-managed</arquillian>
-                            </systemPropertyVariables>
-                            <includes>
-                                <include>**/*Test.java</include>
-                            </includes>
-                            <excludes>
-                                <exclude>**/*Weld*.java</exclude>
-                            </excludes>
-                        </configuration>
-                    </plugin>
-                </plugins>
-            </build>
-        </profile>
-
-        <!--
-        <profile>
-            <id>glassfish</id>
-            <properties>
-                <embedded-glassfish-plugin-version>3.1.2.2</embedded-glassfish-plugin-version>
-                <maven.test.skip>true</maven.test.skip>
-            </properties>
-            <build>
-                <plugins>
-                    <plugin>
-                        <groupId>org.glassfish.embedded</groupId>
-                        <artifactId>maven-embedded-glassfish-plugin</artifactId>
-                        <version>${embedded-glassfish-plugin-version}</version>
-                        <configuration>
-                            <goalPrefix>glassfish</goalPrefix>
-                            <app>target/${project.artifactId}-${project.version}.war</app>
-                            <port>8080</port>
-                            <contextRoot>${project.name}</contextRoot>
-                        </configuration>
-                        <executions>
-                            <execution>
-                                <phase>package</phase>
-                                <goals>
-                                    <goal>run</goal>
-                                </goals>
-                            </execution>
-                        </executions>
-                    </plugin>
-                </plugins>
-            </build>
-        </profile>
+        <artifactId>camel-maven-plugin</artifactId>
+        <version>${project.version}</version>
+        <configuration>
+          <useCDI>true</useCDI>
+        </configuration>
+      </plugin>
+    </plugins>
 
-        <profile>
-            <id>jboss</id>
-            <properties>
-                <jboss-plugin-version>7.2.Final</jboss-plugin-version>
-                <maven.test.skip>true</maven.test.skip>
-            </properties>
-            <build>
-                <plugins>
-                    <plugin>
-                        <groupId>org.jboss.as.plugins</groupId>
-                        <artifactId>jboss-as-maven-plugin</artifactId>
-                        <version>${jboss-plugin-version}</version>
-                        <executions>
-                            <execution>
-                                <phase>package</phase>
-                                <goals>
-                                    <goal>run</goal>
-                                </goals>
-                            </execution>
-                        </executions>
-                    </plugin>
-                </plugins>
-            </build>
-        </profile>
-         -->
+  </build>
 
-    </profiles>
 </project>
diff --git a/examples/camel-example-cdi/src/test/java/org/apache/camel/example/cdi/ArchiveUtil.java b/examples/camel-example-cdi/src/test/java/org/apache/camel/example/cdi/ArchiveUtil.java
deleted file mode 100644
index 0cdd8e43d07..00000000000
--- a/examples/camel-example-cdi/src/test/java/org/apache/camel/example/cdi/ArchiveUtil.java
+++ /dev/null
@@ -1,73 +0,0 @@
-/**
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.camel.example.cdi;
-
-import java.io.File;
-import org.apache.camel.cdi.CdiCamelContext;
-import org.apache.camel.cdi.internal.CamelExtension;
-import org.jboss.arquillian.container.test.api.TargetsContainer;
-import org.jboss.shrinkwrap.api.Archive;
-import org.jboss.shrinkwrap.api.ShrinkWrap;
-import org.jboss.shrinkwrap.api.asset.EmptyAsset;
-import org.jboss.shrinkwrap.api.spec.JavaArchive;
-import org.jboss.shrinkwrap.api.spec.WebArchive;
-import org.jboss.shrinkwrap.resolver.api.maven.Maven;
-
-
-/**
- *  Util class used to create Jar or War archive used by Arquillian
- */
-public final class ArchiveUtil {
-
-    private ArchiveUtil() {
-
-    }
-
-    @TargetsContainer("")
-    public static Archive<?> createJarArchive(String[] packages) {
-
-        JavaArchive jar =  ShrinkWrap.create(JavaArchive.class)
-                .addPackage(CdiCamelContext.class.getPackage())
-                .addPackage(CamelExtension.class.getPackage())
-                .addPackages(false, packages)
-                .addAsManifestResource(EmptyAsset.INSTANCE, "beans.xml");
-
-        // System.out.println(jar.toString(true));
-
-        return jar;
-    }
-
-    @TargetsContainer("")
-    public static Archive<?> createWarArchive(String[] packages) {
-
-        JavaArchive jarTest = ShrinkWrap.create(JavaArchive.class)
-                .addPackages(false, packages)
-                .addAsManifestResource(EmptyAsset.INSTANCE, "beans.xml");
-
-        File[] libs = Maven.resolver()
-                .loadPomFromFile("pom.xml")
-                .resolve("org.apache.camel:camel-core", "org.apache.camel:camel-cdi")
-                .withTransitivity()
-                .as(File.class);
-
-        return ShrinkWrap
-                .create(WebArchive.class, "test.war")
-                .addAsLibrary(jarTest)
-                .addAsLibraries(libs);
-    }
-
-}
diff --git a/examples/camel-example-cdi/src/test/java/org/apache/camel/example/cdi/one/DeploymentFactory.java b/examples/camel-example-cdi/src/test/java/org/apache/camel/example/cdi/one/DeploymentFactory.java
deleted file mode 100644
index 7282d1f40b3..00000000000
--- a/examples/camel-example-cdi/src/test/java/org/apache/camel/example/cdi/one/DeploymentFactory.java
+++ /dev/null
@@ -1,53 +0,0 @@
-/**
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.camel.example.cdi.one;
-
-import org.apache.camel.example.cdi.ArchiveUtil;
-import org.jboss.arquillian.container.test.api.Deployment;
-import org.jboss.shrinkwrap.api.Archive;
-
-/**
- *  Factory to create archive according to the container selected
- */
-public class DeploymentFactory {
-
-    private static final String WELD_EMBEDDED_CONTAINER = "weld-ee-embedded";
-    private static final String JBOSSAS_MANAGED_CONTAINER = "jbossas-managed";
-
-    protected DeploymentFactory() {
-
-    }
-
-    @Deployment
-    public static Archive<?> createArchive() {
-
-        String deploymentType = System.getProperty("arquillian");
-        Archive<?> archive = null;
-
-        // TODO FIND A BETTER WAY TO PASS PACKAGES
-        String[] packages = {"org.apache.camel.example.cdi", "org.apache.camel.example.cdi.one"};
-
-        if (deploymentType.equals(WELD_EMBEDDED_CONTAINER)) {
-            archive = ArchiveUtil.createJarArchive(packages);
-
-        } else if (deploymentType.equals(JBOSSAS_MANAGED_CONTAINER)) {
-            archive =  ArchiveUtil.createWarArchive(packages);
-        }
-        return archive;
-    }
-
-}
diff --git a/examples/camel-example-cdi/src/test/java/org/apache/camel/example/cdi/one/IntegrationTest.java b/examples/camel-example-cdi/src/test/java/org/apache/camel/example/cdi/one/IntegrationTest.java
deleted file mode 100644
index 9933d4c4910..00000000000
--- a/examples/camel-example-cdi/src/test/java/org/apache/camel/example/cdi/one/IntegrationTest.java
+++ /dev/null
@@ -1,81 +0,0 @@
-/**
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.camel.example.cdi.one;
-
-import javax.enterprise.context.ApplicationScoped;
-import javax.enterprise.inject.Produces;
-import javax.inject.Inject;
-import org.apache.camel.Endpoint;
-import org.apache.camel.builder.RouteBuilder;
-import org.apache.camel.cdi.ContextName;
-import org.apache.camel.cdi.Mock;
-import org.apache.camel.component.mock.MockEndpoint;
-import org.apache.camel.example.cdi.MyRoutes;
-import org.jboss.arquillian.junit.Arquillian;
-import org.junit.Ignore;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-import org.slf4j.Logger;
-import org.slf4j.LoggerFactory;
-
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.assertTrue;
-
-// TODO: This should be refactored, to unit test the MyRoutes from the src/main/java
-// we should not add new routes and whatnot. This is an example for end-users to use as best practice
-// so we should show them how to unit test their routes from their main source code
-
-@RunWith(Arquillian.class)
-public class IntegrationTest extends DeploymentFactory {
-
-    static boolean routeConfigured;
-    private static final Logger LOG = LoggerFactory.getLogger(IntegrationTest.class);
-
-    @Inject
-    MyRoutes config;
-
-    @Inject
-    @Mock
-    MockEndpoint result;
-
-    @Produces
-    @ApplicationScoped
-    @ContextName
-    public RouteBuilder createRoute() {
-        return new RouteBuilder() {
-            public void configure() {
-                routeConfigured = true;
-                Endpoint resultEndpoint = config.getResultEndpoint();
-                LOG.info("consuming from output: " + resultEndpoint + " to endpoint: " + result);
-
-                from(resultEndpoint).to(result);
-            }
-        };
-    }
-
-    @Test
-    @Ignore("Does not work")
-    public void integrationTest() throws Exception {
-        assertNotNull("config not injected!", config);
-        assertNotNull("MockEndpoint result not injected!", result);
-        assertTrue("RouteBuilder has not been configured!", routeConfigured);
-
-        result.expectedMessageCount(2);
-        result.assertIsSatisfied();
-    }
-
-}
diff --git a/examples/camel-example-cdi/src/test/java/org/apache/camel/example/cdi/two/DeploymentFactory.java b/examples/camel-example-cdi/src/test/java/org/apache/camel/example/cdi/two/DeploymentFactory.java
deleted file mode 100644
index 48d35254273..00000000000
--- a/examples/camel-example-cdi/src/test/java/org/apache/camel/example/cdi/two/DeploymentFactory.java
+++ /dev/null
@@ -1,54 +0,0 @@
-/**
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.camel.example.cdi.two;
-
-import org.apache.camel.example.cdi.ArchiveUtil;
-import org.jboss.arquillian.container.test.api.Deployment;
-import org.jboss.shrinkwrap.api.Archive;
-
-/**
- *  Factory to select appropriate archive according to container
- */
-public class DeploymentFactory {
-
-    private static final String WELD_EMBEDDED_CONTAINER = "weld-ee-embedded";
-    private static final String JBOSSAS_MANAGED_CONTAINER = "jbossas-managed";
-
-    protected DeploymentFactory() {
-
-    }
-
-    @Deployment
-    public static Archive<?> createArchive() {
-
-        String deploymentType = System.getProperty("arquillian");
-        Archive<?> archive = null;
-
-        // TODO FIND A BETTER WAY TO PASS PACKAGES
-        String[] packages = {"org.apache.camel.example.cdi", "org.apache.camel.example.cdi.two"};
-
-        if (deploymentType.equals(WELD_EMBEDDED_CONTAINER)) {
-            archive = ArchiveUtil.createJarArchive(packages);
-
-        } else if (deploymentType.equals(JBOSSAS_MANAGED_CONTAINER)) {
-            archive =  ArchiveUtil.createWarArchive(packages);
-        }
-        return archive;
-    }
-
-}
-
diff --git a/examples/camel-example-cdi/src/test/java/org/apache/camel/example/cdi/two/SeparateRouteBuilderIntegrationTest.java b/examples/camel-example-cdi/src/test/java/org/apache/camel/example/cdi/two/SeparateRouteBuilderIntegrationTest.java
deleted file mode 100644
index c39cf7da5b3..00000000000
--- a/examples/camel-example-cdi/src/test/java/org/apache/camel/example/cdi/two/SeparateRouteBuilderIntegrationTest.java
+++ /dev/null
@@ -1,45 +0,0 @@
-/**
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.camel.example.cdi.two;
-
-import javax.inject.Inject;
-import org.jboss.arquillian.junit.Arquillian;
-import org.junit.Test;
-import org.junit.runner.RunWith;
-
-import static org.junit.Assert.assertNotNull;
-
-// TODO: This should be refactored, to unit test the MyRoutes from the src/main/java
-// we should not add new routes and whatnot. This is an example for end-users to use as best practice
-// so we should show them how to unit test their routes from their main source code
-
-/**
- * Lets use a separate {@link org.apache.camel.example.cdi.two.TestRouteBuilder} to test the routes
- */
-@RunWith(Arquillian.class)
-public class SeparateRouteBuilderIntegrationTest extends DeploymentFactory {
-
-    @Inject
-    TestRouteBuilder testRouteBuilder;
-
-    @Test
-    public void integrationTest() throws Exception {
-        assertNotNull("testRouteBuilder not injected!", testRouteBuilder);
-
-        testRouteBuilder.assertIsSatisfied();
-    }
-}
diff --git a/examples/camel-example-cdi/src/test/java/org/apache/camel/example/cdi/two/TestRouteBuilder.java b/examples/camel-example-cdi/src/test/java/org/apache/camel/example/cdi/two/TestRouteBuilder.java
deleted file mode 100644
index bfb201761cb..00000000000
--- a/examples/camel-example-cdi/src/test/java/org/apache/camel/example/cdi/two/TestRouteBuilder.java
+++ /dev/null
@@ -1,64 +0,0 @@
-/**
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.camel.example.cdi.two;
-
-import javax.enterprise.context.ApplicationScoped;
-import javax.inject.Inject;
-
-import org.apache.camel.Endpoint;
-import org.apache.camel.builder.RouteBuilder;
-import org.apache.camel.cdi.ContextName;
-import org.apache.camel.cdi.Mock;
-import org.apache.camel.component.mock.MockEndpoint;
-import org.apache.camel.example.cdi.MyRoutes;
-
-import org.slf4j.Logger;
-import org.slf4j.LoggerFactory;
-
-import static org.junit.Assert.assertNotNull;
-import static org.junit.Assert.assertTrue;
-
-@ApplicationScoped
-@ContextName
-public class TestRouteBuilder extends RouteBuilder {
-    private static final Logger LOG = LoggerFactory.getLogger(TestRouteBuilder.class);
-
-    @Inject
-    MyRoutes config;
-
-    @Inject
-    @Mock
-    MockEndpoint result;
-
-    boolean routeConfigured;
-
-    @Override
-    public void configure() throws Exception {
-        routeConfigured = true;
-        Endpoint resultEndpoint = config.getResultEndpoint();
-        LOG.info("consuming from output: " + resultEndpoint + " to : " + result);
-
-        from(resultEndpoint).to(result);
-    }
-
-    public void assertIsSatisfied() {
-        assertTrue("TestRouteBuilder has not been configured!" + routeConfigured, routeConfigured);
-        assertNotNull("MockEndpoint result not injected!", result);
-
-        result.expectedMessageCount(2);
-    }
-}
diff --git a/examples/camel-example-cdi/src/test/resources/arquillian.xml b/examples/camel-example-cdi/src/test/resources/arquillian.xml
deleted file mode 100644
index b9134fe7199..00000000000
--- a/examples/camel-example-cdi/src/test/resources/arquillian.xml
+++ /dev/null
@@ -1,30 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!--
-    Licensed to the Apache Software Foundation (ASF) under one or more
-    contributor license agreements. See the NOTICE file distributed with
-    this work for additional information regarding copyright ownership.
-    The ASF licenses this file to You under the Apache License, Version
-    2.0 (the "License"); you may not use this file except in compliance
-    with the License. You may obtain a copy of the License at
-
-    http://www.apache.org/licenses/LICENSE-2.0 Unless required by
-    applicable law or agreed to in writing, software distributed under the
-    License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
-    CONDITIONS OF ANY KIND, either express or implied. See the License for
-    the specific language governing permissions and limitations under the
-    License.
-  -->
-<arquillian xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
-            xmlns="http://jboss.org/schema/arquillian"
-            xsi:schemaLocation="
-              http://jboss.org/schema/arquillian http://jboss.org/schema/arquillian/arquillian_1_0.xsd">
-
-    <container qualifier="weld-ee-embedded"/>
-
-    <container qualifier="jbossas-managed">
-        <configuration>
-            <property name="jbossHome">target/jboss-as-7.1.1.Final</property>
-        </configuration>
-    </container>
-
-</arquillian>
\ No newline at end of file
diff --git a/examples/camel-example-cdi/src/test/resources/log4j.properties b/examples/camel-example-cdi/src/test/resources/log4j.properties
deleted file mode 100644
index a7b4f6f9af7..00000000000
--- a/examples/camel-example-cdi/src/test/resources/log4j.properties
+++ /dev/null
@@ -1,40 +0,0 @@
-## ---------------------------------------------------------------------------
-## Licensed to the Apache Software Foundation (ASF) under one or more
-## contributor license agreements.  See the NOTICE file distributed with
-## this work for additional information regarding copyright ownership.
-## The ASF licenses this file to You under the Apache License, Version 2.0
-## (the "License"); you may not use this file except in compliance with
-## the License.  You may obtain a copy of the License at
-## 
-## http://www.apache.org/licenses/LICENSE-2.0
-## 
-## Unless required by applicable law or agreed to in writing, software
-## distributed under the License is distributed on an "AS IS" BASIS,
-## WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-## See the License for the specific language governing permissions and
-## limitations under the License.
-## ---------------------------------------------------------------------------
-
-#
-# The logging properties used during tests..
-#
-log4j.rootLogger=INFO, file
-
-#log4j.logger.org.apache.camel.component.cdi=DEBUG
-#log4j.logger.org.apache.openwebbeans=DEBUG
-
-# CONSOLE appender not used by default
-log4j.appender.out=org.apache.log4j.ConsoleAppender
-log4j.appender.out.layout=org.apache.log4j.PatternLayout
-log4j.appender.out.layout.ConversionPattern=%d [%-15.15t] %-5p %-30.30c{1} - %m%n
-# MDC
-#log4j.appender.out.layout.ConversionPattern=%d [%-15.15t] %-5p %-30.30c{1} - %-10.10X{camel.breadcrumbId} - %-10.10X{camel.exchangeId} - %-10.10X{camel.correlationId} - %-10.10X{camel.routeId} - %m%n
-
-# File appender
-log4j.appender.file=org.apache.log4j.FileAppender
-log4j.appender.file.layout=org.apache.log4j.PatternLayout
-log4j.appender.file.file=target/camel-example-cdi-test.log
-log4j.appender.file.append=true
-log4j.appender.file.layout.ConversionPattern=%d [%-15.15t] %-5p %-30.30c{1} - %m%n
-# MDC
-#log4j.appender.file.layout.ConversionPattern=%d [%-15.15t] %-5p %-30.30c{1} - %-10.10X{camel.breadcrumbId} - %-10.10X{camel.exchangeId} - %-10.10X{camel.correlationId} - %-10.10X{camel.routeId} - %m%n
diff --git a/tooling/maven/camel-maven-plugin/src/main/java/org/apache/camel/maven/RunMojo.java b/tooling/maven/camel-maven-plugin/src/main/java/org/apache/camel/maven/RunMojo.java
index fba33ec64ea..dcf39e15629 100644
--- a/tooling/maven/camel-maven-plugin/src/main/java/org/apache/camel/maven/RunMojo.java
+++ b/tooling/maven/camel-maven-plugin/src/main/java/org/apache/camel/maven/RunMojo.java
@@ -744,18 +744,30 @@ public class RunMojo extends AbstractExecMojo {
                     path.add(artifact.getFile().toURI().toURL());
 
                     // add the transient dependencies of this artifact
-                    Set<Artifact> deps = resolveExecutableDependencies(artifact);
-                    for (Artifact dep : deps) {
-
-                        // we must skip org.apache.aries.blueprint.core:, otherwise we get duplicate blueprint extenders
-                        if (dep.getArtifactId().equals("org.apache.aries.blueprint.core")) {
-                            getLog().debug("Skipping org.apache.aries.blueprint.core -> " + dep.getGroupId() + "/" + dep.getArtifactId() + "/" + dep.getVersion());
-                            continue;
+                    Set<Artifact> deps = resolveExecutableDependencies(artifact, true);
+                    if (deps != null) {
+                        for (Artifact dep : deps) {
+
+                            // we must skip org.apache.aries.blueprint.core:, otherwise we get duplicate blueprint extenders
+                            if (dep.getArtifactId().equals("org.apache.aries.blueprint.core")) {
+                                getLog().debug("Skipping org.apache.aries.blueprint.core -> " + dep.getGroupId() + "/" + dep.getArtifactId() + "/" + dep.getVersion());
+                                continue;
+                            }
+
+                            // we skip test scoped
+                            if ("test".equals(dep.getScope())) {
+                                getLog().debug("Skipping test scoped -> " + dep.getGroupId() + "/" + dep.getArtifactId() + "/" + dep.getVersion());
+                                continue;
+                            }
+                            if ("provided".equals(dep.getScope())) {
+                                getLog().debug("Skipping provided scoped -> " + dep.getGroupId() + "/" + dep.getArtifactId() + "/" + dep.getVersion());
+                                continue;
+                            }
+
+                            getLog().debug("Adding extra plugin dependency artifact: " + dep.getArtifactId()
+                                    + " to classpath");
+                            path.add(dep.getFile().toURI().toURL());
                         }
-
-                        getLog().debug("Adding extra plugin dependency artifact: " + dep.getArtifactId()
-                                + " to classpath");
-                        path.add(dep.getFile().toURI().toURL());
                     }
                 }
             }
@@ -888,7 +900,7 @@ public class RunMojo extends AbstractExecMojo {
                 getLog().debug("Selected plugin Dependencies will be included.");
                 Artifact executableArtifact = this.findExecutableArtifact();
                 Artifact executablePomArtifact = this.getExecutablePomArtifact(executableArtifact);
-                relevantDependencies = this.resolveExecutableDependencies(executablePomArtifact);
+                relevantDependencies = this.resolveExecutableDependencies(executablePomArtifact, false);
             }
         } else {
             relevantDependencies = Collections.emptySet();
@@ -935,9 +947,9 @@ public class RunMojo extends AbstractExecMojo {
         return executableTool;
     }
 
-    private Set<Artifact> resolveExecutableDependencies(Artifact executablePomArtifact) throws MojoExecutionException {
+    private Set<Artifact> resolveExecutableDependencies(Artifact executablePomArtifact, boolean ignoreFailures) throws MojoExecutionException {
 
-        Set<Artifact> executableDependencies;
+        Set<Artifact> executableDependencies = null;
         try {
             MavenProject executableProject = this.projectBuilder.buildFromRepository(executablePomArtifact,
                                                                                      this.remoteRepositories,
@@ -966,8 +978,12 @@ public class RunMojo extends AbstractExecMojo {
             executableDependencies = CastUtils.cast(result.getArtifacts());
 
         } catch (Exception ex) {
-            throw new MojoExecutionException("Encountered problems resolving dependencies of the executable "
-                                             + "in preparation for its execution.", ex);
+            if (ignoreFailures) {
+                getLog().debug("Ignoring maven resolving dependencies failure " + ex.getMessage());
+            } else {
+                throw new MojoExecutionException("Encountered problems resolving dependencies of the executable "
+                        + "in preparation for its execution.", ex);
+            }
         }
 
         return executableDependencies;
