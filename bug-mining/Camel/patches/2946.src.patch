diff --git a/camel-core/src/main/java/org/apache/camel/processor/idempotent/IdempotentConsumer.java b/camel-core/src/main/java/org/apache/camel/processor/idempotent/IdempotentConsumer.java
index 100a660eadb..d3afe7a732d 100644
--- a/camel-core/src/main/java/org/apache/camel/processor/idempotent/IdempotentConsumer.java
+++ b/camel-core/src/main/java/org/apache/camel/processor/idempotent/IdempotentConsumer.java
@@ -80,7 +80,9 @@ public class IdempotentConsumer extends ServiceSupport implements AsyncProcessor
     public boolean process(Exchange exchange, AsyncCallback callback) {
         final String messageId = messageIdExpression.evaluate(exchange, String.class);
         if (messageId == null) {
-            throw new NoMessageIdException(exchange, messageIdExpression);
+            exchange.setException(new NoMessageIdException(exchange, messageIdExpression));
+            callback.done(true);
+            return true;
         }
 
         boolean newKey;
diff --git a/camel-core/src/test/java/org/apache/camel/processor/IdempotentConsumerNoMessageIdTest.java b/camel-core/src/test/java/org/apache/camel/processor/IdempotentConsumerNoMessageIdTest.java
index fbac601c5b0..06d738b88d1 100644
--- a/camel-core/src/test/java/org/apache/camel/processor/IdempotentConsumerNoMessageIdTest.java
+++ b/camel-core/src/test/java/org/apache/camel/processor/IdempotentConsumerNoMessageIdTest.java
@@ -16,35 +16,69 @@
  */
 package org.apache.camel.processor;
 
-import org.apache.camel.CamelExecutionException;
 import org.apache.camel.ContextTestSupport;
+import org.apache.camel.Endpoint;
+import org.apache.camel.Exchange;
+import org.apache.camel.Message;
+import org.apache.camel.Processor;
 import org.apache.camel.builder.RouteBuilder;
+import org.apache.camel.component.mock.MockEndpoint;
 import org.apache.camel.processor.idempotent.MemoryIdempotentRepository;
-import org.apache.camel.processor.idempotent.NoMessageIdException;
 
 /**
  * @version 
  */
 public class IdempotentConsumerNoMessageIdTest extends ContextTestSupport {
+    protected Endpoint startEndpoint;
+    protected MockEndpoint resultEndpoint;
 
-    public void testNoMessageId() throws Exception {
-        try {
-            template.sendBody("direct:start", "Hello World");
-            fail("Should have thrown an exception");
-        } catch (CamelExecutionException e) {
-            assertIsInstanceOf(NoMessageIdException.class, e.getCause());
-        }
+    @Override
+    public boolean isUseRouteBuilder() {
+        return false;
     }
 
-    @Override
-    protected RouteBuilder createRouteBuilder() throws Exception {
-        return new RouteBuilder() {
+    public void testNoMessageId() throws Exception {
+        context.addRoutes(new RouteBuilder() {
             @Override
             public void configure() throws Exception {
+                errorHandler(deadLetterChannel("mock:dead"));
+
                 from("direct:start").idempotentConsumer(
                         header("messageId"), MemoryIdempotentRepository.memoryIdempotentRepository(200)
                 ).to("mock:result");
             }
-        };
+        });
+        context.start();
+
+        resultEndpoint.expectedBodiesReceived("one", "two");
+
+        getMockEndpoint("mock:dead").expectedBodiesReceived("Hello World");
+
+        sendMessage("1", "one");
+        template.sendBody("direct:start", "Hello World");
+        sendMessage("2", "two");
+        sendMessage("1", "one");
+
+        assertMockEndpointsSatisfied();
     }
-}
\ No newline at end of file
+
+    protected void sendMessage(final Object messageId, final Object body) {
+        template.send(startEndpoint, new Processor() {
+            public void process(Exchange exchange) {
+                // now lets fire in a message
+                Message in = exchange.getIn();
+                in.setBody(body);
+                in.setHeader("messageId", messageId);
+            }
+        });
+    }
+
+    @Override
+    protected void setUp() throws Exception {
+        super.setUp();
+
+        startEndpoint = resolveMandatoryEndpoint("direct:start");
+        resultEndpoint = getMockEndpoint("mock:result");
+    }
+
+}
