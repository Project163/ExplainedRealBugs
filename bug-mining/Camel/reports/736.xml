<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:34:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-1927] FileConsumer preMove setting causes filename to be left in in progress repository.</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-1927</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;If the FileConsumer preMove setting is used, then files are picked up the first time only, as the original file name is added to the in progress repository, whereas the new file name is removed from the in progress repository (though nothing is actually removed as the new file name is not in the in progress repository).&lt;/p&gt;

&lt;p&gt;This causes a few problems:&lt;/p&gt;

&lt;p&gt;i) If the maxMessagePerPoll is used, then messages not processed the first time are never picked up again.&lt;br/&gt;
ii) If the intention is to reprocess the same file, or a new file with the same name, then it will never be picked up again after the first time.&lt;br/&gt;
iii)  As the wrong file names are removed from the in progress repository, it results in a slow memory leak in the in progress repository.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12487092">CAMEL-1927</key>
            <summary>FileConsumer preMove setting causes filename to be left in in progress repository.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="alexl">Alexander Lee</reporter>
                        <labels>
                    </labels>
                <created>Sat, 22 Aug 2009 06:20:47 +0000</created>
                <updated>Thu, 3 Jun 2010 07:23:50 +0000</updated>
                            <resolved>Mon, 24 Aug 2009 05:35:46 +0000</resolved>
                                    <version>2.0-M3</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12952357" author="davsclaus" created="Sun, 23 Aug 2009 14:01:20 +0000"  >&lt;p&gt;Well spotted. Lets get this fixed in the next release.&lt;/p&gt;

&lt;p&gt;Patches is welcome with unit tests &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12952398" author="alexander.lee@conceptgate.com" created="Sun, 23 Aug 2009 23:37:57 +0000"  >&lt;p&gt;Hi Claus,&lt;/p&gt;

&lt;p&gt;Haven&apos;t worked around it yet, not sure I know how it should be done as the code which sets the filename in the in progress repository is in a separate place to the code that removes it, and the rename strategy is invoked in between.  You could set the file name in the in progress repository after the strategy is invoked but this might break something else.&lt;/p&gt;

&lt;p&gt;I do like Camel, however I&apos;m surprised how inheritance/composition based the components are rather than following the pipeline architecture that Camel itself enables.  For instance renaming could be a &quot;processor&quot; which the File component itself used as part of an initial pipeline.  This would make the architecture more simple yet much more powerful.  So I would see the File component being made up of a very simple timer with the second step as a file listing processor, and so on, with the required functionality pipelined in.  Things like idempotent or in progress repositories could be listeners to the Exchange object (for any changes in name etc.), added at the start and removed on completion or error.  Settings on the File component would then just decide whether a given processor was added to the initial flow/route or not.  I would see it working something like this:&lt;/p&gt;


&lt;p&gt;File Component (itself a Route/Flow - or the start of one)&lt;br/&gt;
--------------&lt;/p&gt;

&lt;p&gt;Timer Endpoint -&amp;gt; File listing Processor -&amp;gt; Splitter (on filename) -&amp;gt; Seda/Direct Queue -&amp;gt; In Progress Repository Processor -&amp;gt; Idempotent Repository Processor -&amp;gt; File Renaming Processor -&amp;gt; File Reader Processor (into exchange body) -&amp;gt; etc.&lt;/p&gt;


&lt;p&gt;So you would then be able to add functionality to the File component with less chance of breaking something else as each processor would be decoupled from the next and each processor in a component only has to concentrate on doing one thing well.  This would also allow the processors to be reused by other developers and add functionality like the in progress or idempotent repository to their own flows/routes.&lt;/p&gt;

&lt;p&gt;This is another thing which sort of puzzles me is that there are a lot of endpoints out of the box with Camel, but not many, if any processors.  If I want File renaming, deleting, moving functionality as part of my flow/route, then I shouldn&apos;t need to write this myself.  At the moment I&apos;m trying to get around this by breaking my route into parts, so where I need file renaming functionality I end one route, and use new route with a File endpoint to pick up a file and rename it, and then from there another route to pick up the file again and do something with it.  But this would all be simpler if there were file renaming processors, etc. out of the box and this would add value to the Camel API.  In many cases it&apos;s as if I want some functionality from an end point, but in the middle of my route/flow.  Of course I can and have written some of these myself, but the next guy shouldn&apos;t have to.&lt;/p&gt;


&lt;p&gt;Regards,&lt;br/&gt;
Alexander&lt;/p&gt;



</comment>
                            <comment id="12952391" author="davsclaus" created="Mon, 24 Aug 2009 05:35:35 +0000"  >&lt;p&gt;The issue is in related when you use &lt;tt&gt;preMove&lt;/tt&gt; and change the actual name of the file such as prepending &lt;tt&gt;work-&lt;/tt&gt; or the likes to the file name.&lt;br/&gt;
However if you use &lt;tt&gt;preMove&lt;/tt&gt; to move the file to another directory then the name is correctly removed from the repo.&lt;/p&gt;
</comment>
                            <comment id="12952397" author="davsclaus" created="Mon, 24 Aug 2009 05:35:46 +0000"  >&lt;p&gt;trunk: 807078.&lt;/p&gt;</comment>
                            <comment id="12952363" author="davsclaus" created="Mon, 24 Aug 2009 05:36:45 +0000"  >&lt;p&gt;Alexander such details is best to discuss at the camel developer mailinglist.&lt;/p&gt;</comment>
                            <comment id="12956433" author="davsclaus" created="Thu, 3 Jun 2010 07:23:50 +0000"  >&lt;p&gt;Closing old resolved issues&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>76691</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 25 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01lfj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7241</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>